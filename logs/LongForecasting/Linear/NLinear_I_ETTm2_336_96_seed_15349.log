Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='NLinear', model_id='ETTm2_336_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=15349, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTm2_336_96_NLinear_ETTm2_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15349>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34129
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.3350345
	speed: 0.0046s/iter; left time: 98.2200s
	iters: 200, epoch: 1 | loss: 0.2802438
	speed: 0.0046s/iter; left time: 96.9910s
	iters: 300, epoch: 1 | loss: 1.0022653
	speed: 0.0050s/iter; left time: 104.2640s
	iters: 400, epoch: 1 | loss: 0.2313084
	speed: 0.0047s/iter; left time: 97.9629s
	iters: 500, epoch: 1 | loss: 0.3433749
	speed: 0.0041s/iter; left time: 85.1577s
	iters: 600, epoch: 1 | loss: 0.5536698
	speed: 0.0043s/iter; left time: 88.1008s
	iters: 700, epoch: 1 | loss: 0.3303574
	speed: 0.0042s/iter; left time: 87.4455s
	iters: 800, epoch: 1 | loss: 0.4506003
	speed: 0.0051s/iter; left time: 105.3389s
	iters: 900, epoch: 1 | loss: 0.9143300
	speed: 0.0049s/iter; left time: 99.0422s
	iters: 1000, epoch: 1 | loss: 0.2662914
	speed: 0.0031s/iter; left time: 62.1944s
Epoch: 1 cost time: 4.744133949279785
Epoch: 1, Steps: 1066 | Train Loss: 0.5216784 Vali Loss: 0.1920260 Test Loss: 0.2564599
Validation loss decreased (inf --> 0.192026).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.3081500
	speed: 0.0216s/iter; left time: 436.2988s
	iters: 200, epoch: 2 | loss: 0.2738032
	speed: 0.0045s/iter; left time: 90.0586s
	iters: 300, epoch: 2 | loss: 0.3881682
	speed: 0.0045s/iter; left time: 89.2539s
	iters: 400, epoch: 2 | loss: 0.6594988
	speed: 0.0039s/iter; left time: 76.8388s
	iters: 500, epoch: 2 | loss: 0.2647463
	speed: 0.0038s/iter; left time: 74.0815s
	iters: 600, epoch: 2 | loss: 0.2784938
	speed: 0.0047s/iter; left time: 93.0216s
	iters: 700, epoch: 2 | loss: 0.3523859
	speed: 0.0048s/iter; left time: 93.2779s
	iters: 800, epoch: 2 | loss: 0.1832980
	speed: 0.0044s/iter; left time: 86.0963s
	iters: 900, epoch: 2 | loss: 0.2155752
	speed: 0.0046s/iter; left time: 89.4313s
	iters: 1000, epoch: 2 | loss: 0.8756745
	speed: 0.0042s/iter; left time: 81.3014s
Epoch: 2 cost time: 4.693711519241333
Epoch: 2, Steps: 1066 | Train Loss: 0.5447711 Vali Loss: 0.1632015 Test Loss: 0.2162971
Validation loss decreased (0.192026 --> 0.163202).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.2856857
	speed: 0.0222s/iter; left time: 424.0174s
	iters: 200, epoch: 3 | loss: 0.4780991
	speed: 0.0040s/iter; left time: 75.1963s
	iters: 300, epoch: 3 | loss: 0.1651032
	speed: 0.0031s/iter; left time: 58.3667s
	iters: 400, epoch: 3 | loss: 0.1709451
	speed: 0.0048s/iter; left time: 90.9840s
	iters: 500, epoch: 3 | loss: 0.1955917
	speed: 0.0054s/iter; left time: 100.7911s
	iters: 600, epoch: 3 | loss: 0.3229579
	speed: 0.0040s/iter; left time: 74.5421s
	iters: 700, epoch: 3 | loss: 0.2265967
	speed: 0.0037s/iter; left time: 68.4181s
	iters: 800, epoch: 3 | loss: 0.1989305
	speed: 0.0049s/iter; left time: 90.3170s
	iters: 900, epoch: 3 | loss: 0.2298062
	speed: 0.0049s/iter; left time: 90.3478s
	iters: 1000, epoch: 3 | loss: 0.3534938
	speed: 0.0046s/iter; left time: 84.2556s
Epoch: 3 cost time: 4.703195333480835
Epoch: 3, Steps: 1066 | Train Loss: 0.2761854 Vali Loss: 0.1648402 Test Loss: 0.2369685
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.2925787
	speed: 0.0187s/iter; left time: 336.5907s
	iters: 200, epoch: 4 | loss: 0.2275099
	speed: 0.0045s/iter; left time: 79.9368s
	iters: 300, epoch: 4 | loss: 0.2090687
	speed: 0.0047s/iter; left time: 83.6347s
	iters: 400, epoch: 4 | loss: 0.4766617
	speed: 0.0047s/iter; left time: 82.5890s
	iters: 500, epoch: 4 | loss: 0.1757392
	speed: 0.0045s/iter; left time: 78.5986s
	iters: 600, epoch: 4 | loss: 0.1820719
	speed: 0.0041s/iter; left time: 72.0701s
	iters: 700, epoch: 4 | loss: 0.1832559
	speed: 0.0034s/iter; left time: 58.7153s
	iters: 800, epoch: 4 | loss: 0.1250907
	speed: 0.0029s/iter; left time: 50.0636s
	iters: 900, epoch: 4 | loss: 0.1417775
	speed: 0.0039s/iter; left time: 66.8786s
	iters: 1000, epoch: 4 | loss: 0.5735857
	speed: 0.0038s/iter; left time: 65.4189s
Epoch: 4 cost time: 4.297449588775635
Epoch: 4, Steps: 1066 | Train Loss: 0.2372405 Vali Loss: 0.1273491 Test Loss: 0.1786695
Validation loss decreased (0.163202 --> 0.127349).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.1640951
	speed: 0.0229s/iter; left time: 389.1104s
	iters: 200, epoch: 5 | loss: 0.3103126
	speed: 0.0052s/iter; left time: 87.1508s
	iters: 300, epoch: 5 | loss: 0.1215827
	speed: 0.0048s/iter; left time: 80.4829s
	iters: 400, epoch: 5 | loss: 0.1980894
	speed: 0.0045s/iter; left time: 75.1232s
	iters: 500, epoch: 5 | loss: 0.1929004
	speed: 0.0044s/iter; left time: 73.5215s
	iters: 600, epoch: 5 | loss: 0.2479283
	speed: 0.0043s/iter; left time: 69.9718s
	iters: 700, epoch: 5 | loss: 0.2724085
	speed: 0.0044s/iter; left time: 72.2982s
	iters: 800, epoch: 5 | loss: 0.2614877
	speed: 0.0046s/iter; left time: 74.1749s
	iters: 900, epoch: 5 | loss: 0.1258276
	speed: 0.0037s/iter; left time: 60.5886s
	iters: 1000, epoch: 5 | loss: 0.1859939
	speed: 0.0035s/iter; left time: 56.8420s
Epoch: 5 cost time: 4.720320224761963
Epoch: 5, Steps: 1066 | Train Loss: 0.2220327 Vali Loss: 0.1212434 Test Loss: 0.1718711
Validation loss decreased (0.127349 --> 0.121243).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.1868986
	speed: 0.0175s/iter; left time: 277.6034s
	iters: 200, epoch: 6 | loss: 0.3253560
	speed: 0.0041s/iter; left time: 65.3823s
	iters: 300, epoch: 6 | loss: 0.1189276
	speed: 0.0045s/iter; left time: 70.1388s
	iters: 400, epoch: 6 | loss: 0.1961335
	speed: 0.0050s/iter; left time: 77.3798s
	iters: 500, epoch: 6 | loss: 0.1343580
	speed: 0.0038s/iter; left time: 58.2543s
	iters: 600, epoch: 6 | loss: 0.1836046
	speed: 0.0040s/iter; left time: 60.9484s
	iters: 700, epoch: 6 | loss: 0.1903249
	speed: 0.0037s/iter; left time: 57.2381s
	iters: 800, epoch: 6 | loss: 0.1710111
	speed: 0.0039s/iter; left time: 59.1019s
	iters: 900, epoch: 6 | loss: 0.2139857
	speed: 0.0045s/iter; left time: 67.6371s
	iters: 1000, epoch: 6 | loss: 0.2401959
	speed: 0.0040s/iter; left time: 59.5143s
Epoch: 6 cost time: 4.388184547424316
Epoch: 6, Steps: 1066 | Train Loss: 0.2138415 Vali Loss: 0.1174299 Test Loss: 0.1655602
Validation loss decreased (0.121243 --> 0.117430).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.2291546
	speed: 0.0190s/iter; left time: 282.0407s
	iters: 200, epoch: 7 | loss: 0.2751840
	speed: 0.0048s/iter; left time: 70.9744s
	iters: 300, epoch: 7 | loss: 0.1338997
	speed: 0.0045s/iter; left time: 66.2828s
	iters: 400, epoch: 7 | loss: 0.1933947
	speed: 0.0045s/iter; left time: 65.0789s
	iters: 500, epoch: 7 | loss: 0.1526920
	speed: 0.0044s/iter; left time: 64.0782s
	iters: 600, epoch: 7 | loss: 0.1069577
	speed: 0.0038s/iter; left time: 54.5785s
	iters: 700, epoch: 7 | loss: 0.1694224
	speed: 0.0040s/iter; left time: 56.3379s
	iters: 800, epoch: 7 | loss: 0.3578109
	speed: 0.0043s/iter; left time: 61.3326s
	iters: 900, epoch: 7 | loss: 0.1987938
	speed: 0.0048s/iter; left time: 67.7406s
	iters: 1000, epoch: 7 | loss: 0.2147555
	speed: 0.0040s/iter; left time: 56.3172s
Epoch: 7 cost time: 4.6055543422698975
Epoch: 7, Steps: 1066 | Train Loss: 0.2089144 Vali Loss: 0.1187212 Test Loss: 0.1678157
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.2072852
	speed: 0.0167s/iter; left time: 229.5429s
	iters: 200, epoch: 8 | loss: 0.1890472
	speed: 0.0045s/iter; left time: 61.6486s
	iters: 300, epoch: 8 | loss: 0.1305598
	speed: 0.0043s/iter; left time: 58.4394s
	iters: 400, epoch: 8 | loss: 0.3212999
	speed: 0.0046s/iter; left time: 61.5444s
	iters: 500, epoch: 8 | loss: 0.3120152
	speed: 0.0033s/iter; left time: 44.2183s
	iters: 600, epoch: 8 | loss: 0.1442531
	speed: 0.0040s/iter; left time: 52.4016s
	iters: 700, epoch: 8 | loss: 0.2948886
	speed: 0.0044s/iter; left time: 57.3770s
	iters: 800, epoch: 8 | loss: 0.1607909
	speed: 0.0051s/iter; left time: 66.2427s
	iters: 900, epoch: 8 | loss: 0.2283612
	speed: 0.0046s/iter; left time: 59.7899s
	iters: 1000, epoch: 8 | loss: 0.2085507
	speed: 0.0047s/iter; left time: 59.9268s
Epoch: 8 cost time: 4.587802410125732
Epoch: 8, Steps: 1066 | Train Loss: 0.2073064 Vali Loss: 0.1173745 Test Loss: 0.1649421
Validation loss decreased (0.117430 --> 0.117374).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.2756568
	speed: 0.0209s/iter; left time: 265.5683s
	iters: 200, epoch: 9 | loss: 0.2470850
	speed: 0.0041s/iter; left time: 51.5329s
	iters: 300, epoch: 9 | loss: 0.2033418
	speed: 0.0051s/iter; left time: 63.5932s
	iters: 400, epoch: 9 | loss: 0.4225115
	speed: 0.0043s/iter; left time: 53.5799s
	iters: 500, epoch: 9 | loss: 0.2511753
	speed: 0.0039s/iter; left time: 48.4345s
	iters: 600, epoch: 9 | loss: 0.1808567
	speed: 0.0041s/iter; left time: 49.5487s
	iters: 700, epoch: 9 | loss: 0.1041765
	speed: 0.0050s/iter; left time: 60.9488s
	iters: 800, epoch: 9 | loss: 0.1242931
	speed: 0.0052s/iter; left time: 62.7822s
	iters: 900, epoch: 9 | loss: 0.1430389
	speed: 0.0044s/iter; left time: 51.8011s
	iters: 1000, epoch: 9 | loss: 0.1528858
	speed: 0.0052s/iter; left time: 61.2316s
Epoch: 9 cost time: 4.769229173660278
Epoch: 9, Steps: 1066 | Train Loss: 0.2059461 Vali Loss: 0.1156055 Test Loss: 0.1630869
Validation loss decreased (0.117374 --> 0.115606).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.1663939
	speed: 0.0203s/iter; left time: 236.2886s
	iters: 200, epoch: 10 | loss: 0.2044470
	speed: 0.0050s/iter; left time: 57.0914s
	iters: 300, epoch: 10 | loss: 0.1771322
	speed: 0.0048s/iter; left time: 55.1257s
	iters: 400, epoch: 10 | loss: 0.2470771
	speed: 0.0051s/iter; left time: 57.7677s
	iters: 500, epoch: 10 | loss: 0.1825706
	speed: 0.0036s/iter; left time: 40.2245s
	iters: 600, epoch: 10 | loss: 0.1310029
	speed: 0.0042s/iter; left time: 46.5109s
	iters: 700, epoch: 10 | loss: 0.1499021
	speed: 0.0051s/iter; left time: 55.8879s
	iters: 800, epoch: 10 | loss: 0.1622170
	speed: 0.0049s/iter; left time: 53.9991s
	iters: 900, epoch: 10 | loss: 0.2526067
	speed: 0.0040s/iter; left time: 42.7668s
	iters: 1000, epoch: 10 | loss: 0.1647788
	speed: 0.0040s/iter; left time: 42.4121s
Epoch: 10 cost time: 4.828369379043579
Epoch: 10, Steps: 1066 | Train Loss: 0.2053829 Vali Loss: 0.1153418 Test Loss: 0.1626930
Validation loss decreased (0.115606 --> 0.115342).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.0948843
	speed: 0.0217s/iter; left time: 229.2910s
	iters: 200, epoch: 11 | loss: 0.1882439
	speed: 0.0046s/iter; left time: 48.4174s
	iters: 300, epoch: 11 | loss: 0.1974122
	speed: 0.0041s/iter; left time: 42.3944s
	iters: 400, epoch: 11 | loss: 0.1638519
	speed: 0.0049s/iter; left time: 49.7660s
	iters: 500, epoch: 11 | loss: 0.2932471
	speed: 0.0051s/iter; left time: 51.4411s
	iters: 600, epoch: 11 | loss: 0.2231462
	speed: 0.0045s/iter; left time: 45.6771s
	iters: 700, epoch: 11 | loss: 0.3674960
	speed: 0.0040s/iter; left time: 39.5725s
	iters: 800, epoch: 11 | loss: 0.1830993
	speed: 0.0047s/iter; left time: 46.3524s
	iters: 900, epoch: 11 | loss: 0.1668593
	speed: 0.0051s/iter; left time: 49.9052s
	iters: 1000, epoch: 11 | loss: 0.3598834
	speed: 0.0046s/iter; left time: 44.0543s
Epoch: 11 cost time: 4.951190948486328
Epoch: 11, Steps: 1066 | Train Loss: 0.2046351 Vali Loss: 0.1154029 Test Loss: 0.1627190
EarlyStopping counter: 1 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.1624012
	speed: 0.0184s/iter; left time: 174.3648s
	iters: 200, epoch: 12 | loss: 0.1180897
	speed: 0.0044s/iter; left time: 41.2440s
	iters: 300, epoch: 12 | loss: 0.2407837
	speed: 0.0044s/iter; left time: 41.1949s
	iters: 400, epoch: 12 | loss: 0.1021450
	speed: 0.0049s/iter; left time: 44.6929s
	iters: 500, epoch: 12 | loss: 0.1106615
	speed: 0.0054s/iter; left time: 49.1456s
	iters: 600, epoch: 12 | loss: 0.2785618
	speed: 0.0054s/iter; left time: 48.2134s
	iters: 700, epoch: 12 | loss: 0.2197017
	speed: 0.0048s/iter; left time: 42.5857s
	iters: 800, epoch: 12 | loss: 0.2351709
	speed: 0.0051s/iter; left time: 44.6786s
	iters: 900, epoch: 12 | loss: 0.1404126
	speed: 0.0049s/iter; left time: 42.9090s
	iters: 1000, epoch: 12 | loss: 0.1362863
	speed: 0.0050s/iter; left time: 42.8032s
Epoch: 12 cost time: 5.181076288223267
Epoch: 12, Steps: 1066 | Train Loss: 0.2046439 Vali Loss: 0.1156139 Test Loss: 0.1632366
EarlyStopping counter: 2 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.1155736
	speed: 0.0213s/iter; left time: 179.2382s
	iters: 200, epoch: 13 | loss: 0.1672181
	speed: 0.0046s/iter; left time: 38.0922s
	iters: 300, epoch: 13 | loss: 0.2731618
	speed: 0.0051s/iter; left time: 41.8856s
	iters: 400, epoch: 13 | loss: 0.2923955
	speed: 0.0047s/iter; left time: 38.4692s
	iters: 500, epoch: 13 | loss: 0.1509117
	speed: 0.0047s/iter; left time: 37.4954s
	iters: 600, epoch: 13 | loss: 0.7807475
	speed: 0.0046s/iter; left time: 36.2530s
	iters: 700, epoch: 13 | loss: 0.1330846
	speed: 0.0038s/iter; left time: 29.9850s
	iters: 800, epoch: 13 | loss: 0.2080413
	speed: 0.0040s/iter; left time: 30.5551s
	iters: 900, epoch: 13 | loss: 0.2787200
	speed: 0.0038s/iter; left time: 28.6851s
	iters: 1000, epoch: 13 | loss: 0.2163974
	speed: 0.0046s/iter; left time: 34.4827s
Epoch: 13 cost time: 4.664362668991089
Epoch: 13, Steps: 1066 | Train Loss: 0.2045344 Vali Loss: 0.1153272 Test Loss: 0.1627480
Validation loss decreased (0.115342 --> 0.115327).  Saving model ...
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 14 | loss: 0.1392386
	speed: 0.0195s/iter; left time: 143.8197s
	iters: 200, epoch: 14 | loss: 0.1207265
	speed: 0.0049s/iter; left time: 35.3136s
	iters: 300, epoch: 14 | loss: 0.2791459
	speed: 0.0046s/iter; left time: 32.7555s
	iters: 400, epoch: 14 | loss: 0.1583963
	speed: 0.0049s/iter; left time: 34.3149s
	iters: 500, epoch: 14 | loss: 0.1460460
	speed: 0.0043s/iter; left time: 29.8713s
	iters: 600, epoch: 14 | loss: 0.4836150
	speed: 0.0038s/iter; left time: 26.0916s
	iters: 700, epoch: 14 | loss: 0.1530711
	speed: 0.0039s/iter; left time: 26.2439s
	iters: 800, epoch: 14 | loss: 0.2067368
	speed: 0.0040s/iter; left time: 26.6521s
	iters: 900, epoch: 14 | loss: 0.2253558
	speed: 0.0038s/iter; left time: 24.7614s
	iters: 1000, epoch: 14 | loss: 0.2578005
	speed: 0.0043s/iter; left time: 27.5860s
Epoch: 14 cost time: 4.647725343704224
Epoch: 14, Steps: 1066 | Train Loss: 0.2044424 Vali Loss: 0.1153673 Test Loss: 0.1628933
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 15 | loss: 0.1463400
	speed: 0.0189s/iter; left time: 118.7272s
	iters: 200, epoch: 15 | loss: 0.1690234
	speed: 0.0030s/iter; left time: 18.9006s
	iters: 300, epoch: 15 | loss: 0.1815274
	speed: 0.0040s/iter; left time: 24.1021s
	iters: 400, epoch: 15 | loss: 0.1693393
	speed: 0.0042s/iter; left time: 24.9475s
	iters: 500, epoch: 15 | loss: 0.5461655
	speed: 0.0044s/iter; left time: 25.9580s
	iters: 600, epoch: 15 | loss: 0.2289162
	speed: 0.0039s/iter; left time: 22.7242s
	iters: 700, epoch: 15 | loss: 0.1794559
	speed: 0.0044s/iter; left time: 24.9431s
	iters: 800, epoch: 15 | loss: 0.1160379
	speed: 0.0039s/iter; left time: 22.0630s
	iters: 900, epoch: 15 | loss: 0.1308286
	speed: 0.0036s/iter; left time: 19.7342s
	iters: 1000, epoch: 15 | loss: 0.2680986
	speed: 0.0048s/iter; left time: 25.7447s
Epoch: 15 cost time: 4.279541254043579
Epoch: 15, Steps: 1066 | Train Loss: 0.2044002 Vali Loss: 0.1153630 Test Loss: 0.1628694
EarlyStopping counter: 2 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 16 | loss: 0.3258825
	speed: 0.0236s/iter; left time: 123.6338s
	iters: 200, epoch: 16 | loss: 0.1683126
	speed: 0.0033s/iter; left time: 16.9323s
	iters: 300, epoch: 16 | loss: 0.2621974
	speed: 0.0033s/iter; left time: 16.7122s
	iters: 400, epoch: 16 | loss: 0.1166004
	speed: 0.0044s/iter; left time: 21.7950s
	iters: 500, epoch: 16 | loss: 0.3415347
	speed: 0.0039s/iter; left time: 18.7061s
	iters: 600, epoch: 16 | loss: 0.2962929
	speed: 0.0045s/iter; left time: 21.1025s
	iters: 700, epoch: 16 | loss: 0.1723000
	speed: 0.0039s/iter; left time: 17.9219s
	iters: 800, epoch: 16 | loss: 0.2400558
	speed: 0.0036s/iter; left time: 16.3667s
	iters: 900, epoch: 16 | loss: 0.1471860
	speed: 0.0039s/iter; left time: 17.1839s
	iters: 1000, epoch: 16 | loss: 0.4649459
	speed: 0.0039s/iter; left time: 16.8563s
Epoch: 16 cost time: 4.023666858673096
Epoch: 16, Steps: 1066 | Train Loss: 0.2043608 Vali Loss: 0.1153190 Test Loss: 0.1628326
Validation loss decreased (0.115327 --> 0.115319).  Saving model ...
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 17 | loss: 0.1086969
	speed: 0.0166s/iter; left time: 68.9858s
	iters: 200, epoch: 17 | loss: 0.1871143
	speed: 0.0039s/iter; left time: 15.7800s
	iters: 300, epoch: 17 | loss: 0.0882757
	speed: 0.0038s/iter; left time: 15.1086s
	iters: 400, epoch: 17 | loss: 0.2035701
	speed: 0.0041s/iter; left time: 15.8851s
	iters: 500, epoch: 17 | loss: 0.2030693
	speed: 0.0046s/iter; left time: 17.4382s
	iters: 600, epoch: 17 | loss: 0.1285375
	speed: 0.0039s/iter; left time: 14.1486s
	iters: 700, epoch: 17 | loss: 0.2561537
	speed: 0.0039s/iter; left time: 13.8794s
	iters: 800, epoch: 17 | loss: 0.1113188
	speed: 0.0047s/iter; left time: 16.2162s
	iters: 900, epoch: 17 | loss: 0.1243868
	speed: 0.0047s/iter; left time: 15.7569s
	iters: 1000, epoch: 17 | loss: 0.1052638
	speed: 0.0047s/iter; left time: 15.2802s
Epoch: 17 cost time: 4.534034729003906
Epoch: 17, Steps: 1066 | Train Loss: 0.2043994 Vali Loss: 0.1153500 Test Loss: 0.1628291
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 18 | loss: 0.1269886
	speed: 0.0207s/iter; left time: 64.0467s
	iters: 200, epoch: 18 | loss: 0.4739223
	speed: 0.0040s/iter; left time: 11.9974s
	iters: 300, epoch: 18 | loss: 0.2248594
	speed: 0.0046s/iter; left time: 13.4283s
	iters: 400, epoch: 18 | loss: 0.2294876
	speed: 0.0047s/iter; left time: 13.1833s
	iters: 500, epoch: 18 | loss: 0.2538354
	speed: 0.0048s/iter; left time: 12.8543s
	iters: 600, epoch: 18 | loss: 0.2451222
	speed: 0.0040s/iter; left time: 10.4220s
	iters: 700, epoch: 18 | loss: 0.1329723
	speed: 0.0042s/iter; left time: 10.3781s
	iters: 800, epoch: 18 | loss: 0.3297074
	speed: 0.0053s/iter; left time: 12.8071s
	iters: 900, epoch: 18 | loss: 0.2014351
	speed: 0.0049s/iter; left time: 11.3702s
	iters: 1000, epoch: 18 | loss: 0.1500809
	speed: 0.0048s/iter; left time: 10.5332s
Epoch: 18 cost time: 4.944225311279297
Epoch: 18, Steps: 1066 | Train Loss: 0.2043830 Vali Loss: 0.1153461 Test Loss: 0.1628219
EarlyStopping counter: 2 out of 5
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 19 | loss: 0.2944246
	speed: 0.0174s/iter; left time: 35.4429s
	iters: 200, epoch: 19 | loss: 0.2391842
	speed: 0.0036s/iter; left time: 6.9008s
	iters: 300, epoch: 19 | loss: 0.2178150
	speed: 0.0036s/iter; left time: 6.5128s
	iters: 400, epoch: 19 | loss: 0.1303780
	speed: 0.0036s/iter; left time: 6.2011s
	iters: 500, epoch: 19 | loss: 0.1557019
	speed: 0.0037s/iter; left time: 5.9768s
	iters: 600, epoch: 19 | loss: 0.1743709
	speed: 0.0038s/iter; left time: 5.7513s
	iters: 700, epoch: 19 | loss: 0.1004386
	speed: 0.0035s/iter; left time: 4.9439s
	iters: 800, epoch: 19 | loss: 0.1511875
	speed: 0.0035s/iter; left time: 4.7034s
	iters: 900, epoch: 19 | loss: 0.1823490
	speed: 0.0039s/iter; left time: 4.7508s
	iters: 1000, epoch: 19 | loss: 0.1314164
	speed: 0.0039s/iter; left time: 4.4074s
Epoch: 19 cost time: 3.89444637298584
Epoch: 19, Steps: 1066 | Train Loss: 0.2043684 Vali Loss: 0.1153431 Test Loss: 0.1628197
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 20 | loss: 0.2112163
	speed: 0.0150s/iter; left time: 14.5084s
	iters: 200, epoch: 20 | loss: 0.1790311
	speed: 0.0034s/iter; left time: 2.9742s
	iters: 300, epoch: 20 | loss: 0.1363848
	speed: 0.0033s/iter; left time: 2.5004s
	iters: 400, epoch: 20 | loss: 0.1685536
	speed: 0.0030s/iter; left time: 2.0023s
	iters: 500, epoch: 20 | loss: 0.1275821
	speed: 0.0028s/iter; left time: 1.5593s
	iters: 600, epoch: 20 | loss: 0.3160916
	speed: 0.0027s/iter; left time: 1.2562s
	iters: 700, epoch: 20 | loss: 0.1736929
	speed: 0.0027s/iter; left time: 0.9957s
	iters: 800, epoch: 20 | loss: 0.1831335
	speed: 0.0033s/iter; left time: 0.8758s
	iters: 900, epoch: 20 | loss: 0.1875201
	speed: 0.0034s/iter; left time: 0.5611s
	iters: 1000, epoch: 20 | loss: 0.4311191
	speed: 0.0034s/iter; left time: 0.2273s
Epoch: 20 cost time: 3.2970845699310303
Epoch: 20, Steps: 1066 | Train Loss: 0.2043604 Vali Loss: 0.1153416 Test Loss: 0.1628189
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.9073486328125e-08
>>>>>>>testing : ETTm2_336_96_NLinear_ETTm2_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15349<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.16304469108581543, mae:0.25089603662490845
