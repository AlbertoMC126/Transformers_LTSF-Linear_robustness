Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='Linear', model_id='ETTm2_336_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=336, root_path='./dataset/', save_pred_values=False, seed=12890, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTm2_336_336_Linear_ETTm2_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed12890>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33889
val 11185
test 11185
	iters: 100, epoch: 1 | loss: 0.2763368
	speed: 0.0095s/iter; left time: 200.4885s
	iters: 200, epoch: 1 | loss: 0.6079201
	speed: 0.0092s/iter; left time: 192.2005s
	iters: 300, epoch: 1 | loss: 0.7135614
	speed: 0.0080s/iter; left time: 167.9363s
	iters: 400, epoch: 1 | loss: 0.4383273
	speed: 0.0080s/iter; left time: 166.1565s
	iters: 500, epoch: 1 | loss: 0.5505705
	speed: 0.0076s/iter; left time: 158.1711s
	iters: 600, epoch: 1 | loss: 0.3255175
	speed: 0.0078s/iter; left time: 161.1912s
	iters: 700, epoch: 1 | loss: 0.4790028
	speed: 0.0079s/iter; left time: 161.3900s
	iters: 800, epoch: 1 | loss: 0.4423358
	speed: 0.0082s/iter; left time: 166.9528s
	iters: 900, epoch: 1 | loss: 0.9908156
	speed: 0.0083s/iter; left time: 169.1969s
	iters: 1000, epoch: 1 | loss: 0.5175215
	speed: 0.0079s/iter; left time: 160.2901s
Epoch: 1 cost time: 8.743642091751099
Epoch: 1, Steps: 1059 | Train Loss: 0.6056710 Vali Loss: 0.3528493 Test Loss: 0.6251159
Validation loss decreased (inf --> 0.352849).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.9914750
	speed: 0.0305s/iter; left time: 610.0878s
	iters: 200, epoch: 2 | loss: 0.8557300
	speed: 0.0084s/iter; left time: 166.7701s
	iters: 300, epoch: 2 | loss: 1.2930810
	speed: 0.0093s/iter; left time: 184.8473s
	iters: 400, epoch: 2 | loss: 0.6415096
	speed: 0.0085s/iter; left time: 168.0445s
	iters: 500, epoch: 2 | loss: 0.6084572
	speed: 0.0077s/iter; left time: 151.3167s
	iters: 600, epoch: 2 | loss: 0.3473117
	speed: 0.0086s/iter; left time: 167.1539s
	iters: 700, epoch: 2 | loss: 0.5034679
	speed: 0.0094s/iter; left time: 182.4196s
	iters: 800, epoch: 2 | loss: 0.6810626
	speed: 0.0085s/iter; left time: 164.6618s
	iters: 900, epoch: 2 | loss: 0.3250722
	speed: 0.0087s/iter; left time: 167.8331s
	iters: 1000, epoch: 2 | loss: 0.6346965
	speed: 0.0082s/iter; left time: 157.0962s
Epoch: 2 cost time: 8.876782894134521
Epoch: 2, Steps: 1059 | Train Loss: 0.5843486 Vali Loss: 0.5010039 Test Loss: 1.0086870
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.5056575
	speed: 0.0322s/iter; left time: 610.3373s
	iters: 200, epoch: 3 | loss: 0.5160928
	speed: 0.0092s/iter; left time: 174.1660s
	iters: 300, epoch: 3 | loss: 0.3381904
	speed: 0.0093s/iter; left time: 173.5875s
	iters: 400, epoch: 3 | loss: 0.7300333
	speed: 0.0083s/iter; left time: 154.5298s
	iters: 500, epoch: 3 | loss: 0.2428435
	speed: 0.0076s/iter; left time: 141.8795s
	iters: 600, epoch: 3 | loss: 0.3235481
	speed: 0.0072s/iter; left time: 133.7060s
	iters: 700, epoch: 3 | loss: 0.5393472
	speed: 0.0088s/iter; left time: 161.4819s
	iters: 800, epoch: 3 | loss: 0.4553432
	speed: 0.0080s/iter; left time: 146.1092s
	iters: 900, epoch: 3 | loss: 0.3647435
	speed: 0.0087s/iter; left time: 157.9272s
	iters: 1000, epoch: 3 | loss: 0.3636600
	speed: 0.0088s/iter; left time: 159.2880s
Epoch: 3 cost time: 8.921412229537964
Epoch: 3, Steps: 1059 | Train Loss: 0.4403893 Vali Loss: 0.3820046 Test Loss: 0.8617575
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.2885966
	speed: 0.0318s/iter; left time: 568.9871s
	iters: 200, epoch: 4 | loss: 0.8082541
	speed: 0.0083s/iter; left time: 147.5723s
	iters: 300, epoch: 4 | loss: 0.3207605
	speed: 0.0079s/iter; left time: 139.0025s
	iters: 400, epoch: 4 | loss: 0.4296647
	speed: 0.0076s/iter; left time: 133.8395s
	iters: 500, epoch: 4 | loss: 0.6544869
	speed: 0.0077s/iter; left time: 134.4905s
	iters: 600, epoch: 4 | loss: 0.3021834
	speed: 0.0087s/iter; left time: 151.2786s
	iters: 700, epoch: 4 | loss: 0.4118483
	speed: 0.0086s/iter; left time: 148.7968s
	iters: 800, epoch: 4 | loss: 0.3245939
	speed: 0.0068s/iter; left time: 116.3982s
	iters: 900, epoch: 4 | loss: 0.2386755
	speed: 0.0094s/iter; left time: 161.5229s
	iters: 1000, epoch: 4 | loss: 0.3936562
	speed: 0.0095s/iter; left time: 160.7175s
Epoch: 4 cost time: 8.72347354888916
Epoch: 4, Steps: 1059 | Train Loss: 0.3951066 Vali Loss: 0.3662525 Test Loss: 0.7669747
EarlyStopping counter: 3 out of 5
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.3535508
	speed: 0.0354s/iter; left time: 596.4868s
	iters: 200, epoch: 5 | loss: 0.3669507
	speed: 0.0083s/iter; left time: 139.5781s
	iters: 300, epoch: 5 | loss: 0.4193336
	speed: 0.0083s/iter; left time: 138.5423s
	iters: 400, epoch: 5 | loss: 0.2676036
	speed: 0.0089s/iter; left time: 147.4732s
	iters: 500, epoch: 5 | loss: 0.6431938
	speed: 0.0087s/iter; left time: 143.6197s
	iters: 600, epoch: 5 | loss: 0.3180024
	speed: 0.0095s/iter; left time: 154.8274s
	iters: 700, epoch: 5 | loss: 0.2491338
	speed: 0.0079s/iter; left time: 128.7102s
	iters: 800, epoch: 5 | loss: 0.2884990
	speed: 0.0078s/iter; left time: 125.7376s
	iters: 900, epoch: 5 | loss: 0.3851712
	speed: 0.0083s/iter; left time: 133.0132s
	iters: 1000, epoch: 5 | loss: 0.2368458
	speed: 0.0077s/iter; left time: 122.5091s
Epoch: 5 cost time: 8.862661123275757
Epoch: 5, Steps: 1059 | Train Loss: 0.3748856 Vali Loss: 0.2484532 Test Loss: 0.3843712
Validation loss decreased (0.352849 --> 0.248453).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.5937378
	speed: 0.0312s/iter; left time: 492.0263s
	iters: 200, epoch: 6 | loss: 0.4260440
	speed: 0.0078s/iter; left time: 122.5489s
	iters: 300, epoch: 6 | loss: 0.3007512
	speed: 0.0080s/iter; left time: 124.7354s
	iters: 400, epoch: 6 | loss: 0.4483545
	speed: 0.0083s/iter; left time: 127.8404s
	iters: 500, epoch: 6 | loss: 0.6560202
	speed: 0.0081s/iter; left time: 124.7632s
	iters: 600, epoch: 6 | loss: 0.3054046
	speed: 0.0084s/iter; left time: 127.6574s
	iters: 700, epoch: 6 | loss: 0.2789390
	speed: 0.0095s/iter; left time: 144.3053s
	iters: 800, epoch: 6 | loss: 0.4850038
	speed: 0.0094s/iter; left time: 141.6851s
	iters: 900, epoch: 6 | loss: 0.2606377
	speed: 0.0091s/iter; left time: 136.7132s
	iters: 1000, epoch: 6 | loss: 0.2772430
	speed: 0.0082s/iter; left time: 121.7063s
Epoch: 6 cost time: 8.854721069335938
Epoch: 6, Steps: 1059 | Train Loss: 0.3618308 Vali Loss: 0.2974283 Test Loss: 0.5729679
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.5602558
	speed: 0.0304s/iter; left time: 447.7349s
	iters: 200, epoch: 7 | loss: 0.4086942
	speed: 0.0073s/iter; left time: 106.2132s
	iters: 300, epoch: 7 | loss: 0.1601599
	speed: 0.0078s/iter; left time: 113.4557s
	iters: 400, epoch: 7 | loss: 0.2136042
	speed: 0.0086s/iter; left time: 123.3792s
	iters: 500, epoch: 7 | loss: 0.2780296
	speed: 0.0087s/iter; left time: 125.2417s
	iters: 600, epoch: 7 | loss: 0.3096661
	speed: 0.0078s/iter; left time: 110.8591s
	iters: 700, epoch: 7 | loss: 0.2394400
	speed: 0.0074s/iter; left time: 104.7446s
	iters: 800, epoch: 7 | loss: 0.2347544
	speed: 0.0094s/iter; left time: 131.6139s
	iters: 900, epoch: 7 | loss: 0.3177244
	speed: 0.0077s/iter; left time: 107.2167s
	iters: 1000, epoch: 7 | loss: 0.3498641
	speed: 0.0084s/iter; left time: 116.3300s
Epoch: 7 cost time: 8.486046075820923
Epoch: 7, Steps: 1059 | Train Loss: 0.3554736 Vali Loss: 0.2787642 Test Loss: 0.5067444
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.2895747
	speed: 0.0336s/iter; left time: 458.9322s
	iters: 200, epoch: 8 | loss: 0.2362947
	speed: 0.0088s/iter; left time: 119.4555s
	iters: 300, epoch: 8 | loss: 0.5295433
	speed: 0.0081s/iter; left time: 108.5066s
	iters: 400, epoch: 8 | loss: 0.3344208
	speed: 0.0082s/iter; left time: 110.0701s
	iters: 500, epoch: 8 | loss: 0.5621941
	speed: 0.0070s/iter; left time: 92.2308s
	iters: 600, epoch: 8 | loss: 0.2591004
	speed: 0.0072s/iter; left time: 95.3599s
	iters: 700, epoch: 8 | loss: 0.2959692
	speed: 0.0083s/iter; left time: 108.0723s
	iters: 800, epoch: 8 | loss: 0.3452621
	speed: 0.0095s/iter; left time: 122.9757s
	iters: 900, epoch: 8 | loss: 0.2282000
	speed: 0.0085s/iter; left time: 109.9067s
	iters: 1000, epoch: 8 | loss: 0.2295946
	speed: 0.0091s/iter; left time: 115.5885s
Epoch: 8 cost time: 8.777649641036987
Epoch: 8, Steps: 1059 | Train Loss: 0.3521770 Vali Loss: 0.2516274 Test Loss: 0.4290755
EarlyStopping counter: 3 out of 5
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.3886406
	speed: 0.0307s/iter; left time: 386.8931s
	iters: 200, epoch: 9 | loss: 0.4223654
	speed: 0.0071s/iter; left time: 89.3409s
	iters: 300, epoch: 9 | loss: 0.3401596
	speed: 0.0069s/iter; left time: 85.2916s
	iters: 400, epoch: 9 | loss: 0.2580295
	speed: 0.0069s/iter; left time: 85.1674s
	iters: 500, epoch: 9 | loss: 0.2859274
	speed: 0.0072s/iter; left time: 87.7988s
	iters: 600, epoch: 9 | loss: 0.2182589
	speed: 0.0061s/iter; left time: 74.0184s
	iters: 700, epoch: 9 | loss: 0.3224110
	speed: 0.0074s/iter; left time: 89.2212s
	iters: 800, epoch: 9 | loss: 0.2936676
	speed: 0.0071s/iter; left time: 84.7034s
	iters: 900, epoch: 9 | loss: 0.3813803
	speed: 0.0071s/iter; left time: 83.9801s
	iters: 1000, epoch: 9 | loss: 0.3242704
	speed: 0.0076s/iter; left time: 89.5215s
Epoch: 9 cost time: 7.52898907661438
Epoch: 9, Steps: 1059 | Train Loss: 0.3503762 Vali Loss: 0.3187561 Test Loss: 0.6435144
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.2273515
	speed: 0.0377s/iter; left time: 435.6341s
	iters: 200, epoch: 10 | loss: 0.6082402
	speed: 0.0081s/iter; left time: 92.6699s
	iters: 300, epoch: 10 | loss: 0.6677264
	speed: 0.0078s/iter; left time: 88.1228s
	iters: 400, epoch: 10 | loss: 0.3875142
	speed: 0.0075s/iter; left time: 83.8327s
	iters: 500, epoch: 10 | loss: 0.5166057
	speed: 0.0082s/iter; left time: 91.4302s
	iters: 600, epoch: 10 | loss: 0.4042309
	speed: 0.0075s/iter; left time: 82.9506s
	iters: 700, epoch: 10 | loss: 0.2204153
	speed: 0.0065s/iter; left time: 70.7775s
	iters: 800, epoch: 10 | loss: 0.2718598
	speed: 0.0074s/iter; left time: 80.2168s
	iters: 900, epoch: 10 | loss: 0.4113427
	speed: 0.0072s/iter; left time: 76.9551s
	iters: 1000, epoch: 10 | loss: 0.3097114
	speed: 0.0071s/iter; left time: 75.8510s
Epoch: 10 cost time: 7.925870180130005
Epoch: 10, Steps: 1059 | Train Loss: 0.3493091 Vali Loss: 0.2749546 Test Loss: 0.5004037
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTm2_336_336_Linear_ETTm2_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed12890<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
mse:0.3847331404685974, mae:0.4115215241909027
