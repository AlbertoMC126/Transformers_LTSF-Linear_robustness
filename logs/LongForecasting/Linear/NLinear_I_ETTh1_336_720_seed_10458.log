Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTh1', data_path='ETTh1.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='NLinear', model_id='ETTh1_336_720', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=720, root_path='./dataset/', save_pred_values=False, seed=10458, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTh1_336_720_NLinear_ETTh1_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed10458>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7585
val 2161
test 2161
	iters: 100, epoch: 1 | loss: 0.5813222
	speed: 0.0208s/iter; left time: 96.4026s
	iters: 200, epoch: 1 | loss: 0.5586678
	speed: 0.0207s/iter; left time: 94.0492s
Epoch: 1 cost time: 4.821578025817871
Epoch: 1, Steps: 237 | Train Loss: 0.6760439 Vali Loss: 1.7609050 Test Loss: 0.5531158
Validation loss decreased (inf --> 1.760905).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.6349320
	speed: 0.0361s/iter; left time: 158.8951s
	iters: 200, epoch: 2 | loss: 0.6692863
	speed: 0.0177s/iter; left time: 76.0257s
Epoch: 2 cost time: 4.308050155639648
Epoch: 2, Steps: 237 | Train Loss: 0.6419735 Vali Loss: 1.9100806 Test Loss: 0.5486239
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.5571880
	speed: 0.0350s/iter; left time: 145.7410s
	iters: 200, epoch: 3 | loss: 0.5802650
	speed: 0.0186s/iter; left time: 75.7622s
Epoch: 3 cost time: 4.362236499786377
Epoch: 3, Steps: 237 | Train Loss: 0.5904663 Vali Loss: 1.6502224 Test Loss: 0.4945068
Validation loss decreased (1.760905 --> 1.650222).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.5586325
	speed: 0.0311s/iter; left time: 122.3885s
	iters: 200, epoch: 4 | loss: 0.5888368
	speed: 0.0181s/iter; left time: 69.4657s
Epoch: 4 cost time: 4.265158653259277
Epoch: 4, Steps: 237 | Train Loss: 0.5650342 Vali Loss: 1.5405105 Test Loss: 0.4672959
Validation loss decreased (1.650222 --> 1.540511).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.5337704
	speed: 0.0363s/iter; left time: 134.0231s
	iters: 200, epoch: 5 | loss: 0.5789661
	speed: 0.0174s/iter; left time: 62.6359s
Epoch: 5 cost time: 4.299056768417358
Epoch: 5, Steps: 237 | Train Loss: 0.5541371 Vali Loss: 1.5282413 Test Loss: 0.4582216
Validation loss decreased (1.540511 --> 1.528241).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.4793738
	speed: 0.0336s/iter; left time: 116.2107s
	iters: 200, epoch: 6 | loss: 0.6232391
	speed: 0.0191s/iter; left time: 64.0330s
Epoch: 6 cost time: 4.483936786651611
Epoch: 6, Steps: 237 | Train Loss: 0.5476239 Vali Loss: 1.5316288 Test Loss: 0.4579763
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.4708251
	speed: 0.0306s/iter; left time: 98.4214s
	iters: 200, epoch: 7 | loss: 0.5179260
	speed: 0.0172s/iter; left time: 53.6007s
Epoch: 7 cost time: 4.089468240737915
Epoch: 7, Steps: 237 | Train Loss: 0.5445487 Vali Loss: 1.5256306 Test Loss: 0.4561207
Validation loss decreased (1.528241 --> 1.525631).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.6027325
	speed: 0.0325s/iter; left time: 96.9392s
	iters: 200, epoch: 8 | loss: 0.5671210
	speed: 0.0207s/iter; left time: 59.5488s
Epoch: 8 cost time: 4.576146364212036
Epoch: 8, Steps: 237 | Train Loss: 0.5426666 Vali Loss: 1.5154158 Test Loss: 0.4546081
Validation loss decreased (1.525631 --> 1.515416).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.5749906
	speed: 0.0350s/iter; left time: 96.1361s
	iters: 200, epoch: 9 | loss: 0.4874172
	speed: 0.0198s/iter; left time: 52.2923s
Epoch: 9 cost time: 4.579540014266968
Epoch: 9, Steps: 237 | Train Loss: 0.5416740 Vali Loss: 1.5169432 Test Loss: 0.4542507
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.5940546
	speed: 0.0326s/iter; left time: 81.8805s
	iters: 200, epoch: 10 | loss: 0.5777373
	speed: 0.0172s/iter; left time: 41.5205s
Epoch: 10 cost time: 4.097447395324707
Epoch: 10, Steps: 237 | Train Loss: 0.5411896 Vali Loss: 1.5184219 Test Loss: 0.4536835
EarlyStopping counter: 2 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.5645303
	speed: 0.0305s/iter; left time: 69.2761s
	iters: 200, epoch: 11 | loss: 0.5442638
	speed: 0.0187s/iter; left time: 40.5255s
Epoch: 11 cost time: 4.246999025344849
Epoch: 11, Steps: 237 | Train Loss: 0.5408794 Vali Loss: 1.5169137 Test Loss: 0.4535432
EarlyStopping counter: 3 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.5627701
	speed: 0.0315s/iter; left time: 64.0949s
	iters: 200, epoch: 12 | loss: 0.5821314
	speed: 0.0186s/iter; left time: 35.9094s
Epoch: 12 cost time: 4.07544207572937
Epoch: 12, Steps: 237 | Train Loss: 0.5407284 Vali Loss: 1.5166887 Test Loss: 0.4534860
EarlyStopping counter: 4 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.5074351
	speed: 0.0313s/iter; left time: 56.2044s
	iters: 200, epoch: 13 | loss: 0.5239902
	speed: 0.0165s/iter; left time: 27.9285s
Epoch: 13 cost time: 3.8057587146759033
Epoch: 13, Steps: 237 | Train Loss: 0.5406333 Vali Loss: 1.5146371 Test Loss: 0.4534753
Validation loss decreased (1.515416 --> 1.514637).  Saving model ...
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.5984914
	speed: 0.0297s/iter; left time: 46.2899s
	iters: 200, epoch: 14 | loss: 0.5250709
	speed: 0.0161s/iter; left time: 23.4720s
Epoch: 14 cost time: 3.7976725101470947
Epoch: 14, Steps: 237 | Train Loss: 0.5405089 Vali Loss: 1.5176455 Test Loss: 0.4534442
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.5571122
	speed: 0.0278s/iter; left time: 36.7943s
	iters: 200, epoch: 15 | loss: 0.5390013
	speed: 0.0154s/iter; left time: 18.8578s
Epoch: 15 cost time: 3.620724678039551
Epoch: 15, Steps: 237 | Train Loss: 0.5405713 Vali Loss: 1.5165637 Test Loss: 0.4534372
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.6102257
	speed: 0.0272s/iter; left time: 29.5153s
	iters: 200, epoch: 16 | loss: 0.5302193
	speed: 0.0139s/iter; left time: 13.6697s
Epoch: 16 cost time: 3.331955909729004
Epoch: 16, Steps: 237 | Train Loss: 0.5404693 Vali Loss: 1.5167927 Test Loss: 0.4534389
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 17 | loss: 0.5267441
	speed: 0.0255s/iter; left time: 21.6354s
	iters: 200, epoch: 17 | loss: 0.5804377
	speed: 0.0126s/iter; left time: 9.4478s
Epoch: 17 cost time: 3.1132748126983643
Epoch: 17, Steps: 237 | Train Loss: 0.5405540 Vali Loss: 1.5167521 Test Loss: 0.4534348
EarlyStopping counter: 4 out of 5
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 18 | loss: 0.5431480
	speed: 0.0249s/iter; left time: 15.2304s
	iters: 200, epoch: 18 | loss: 0.4730706
	speed: 0.0132s/iter; left time: 6.7770s
Epoch: 18 cost time: 3.1459107398986816
Epoch: 18, Steps: 237 | Train Loss: 0.5405071 Vali Loss: 1.5171506 Test Loss: 0.4534346
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTh1_336_720_NLinear_ETTh1_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed10458<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
mse:0.45236608386039734, mae:0.45972466468811035
