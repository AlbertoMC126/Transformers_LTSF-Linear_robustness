Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='Linear', model_id='ETTm2_336_192', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=192, root_path='./dataset/', save_pred_values=False, seed=3144, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTm2_336_192_Linear_ETTm2_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3144>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34033
val 11329
test 11329
	iters: 100, epoch: 1 | loss: 0.2756721
	speed: 0.0063s/iter; left time: 133.7864s
	iters: 200, epoch: 1 | loss: 0.2500911
	speed: 0.0055s/iter; left time: 116.4723s
	iters: 300, epoch: 1 | loss: 0.5427502
	speed: 0.0058s/iter; left time: 121.4057s
	iters: 400, epoch: 1 | loss: 0.3133670
	speed: 0.0068s/iter; left time: 141.7014s
	iters: 500, epoch: 1 | loss: 0.4286125
	speed: 0.0059s/iter; left time: 122.9048s
	iters: 600, epoch: 1 | loss: 0.4434821
	speed: 0.0035s/iter; left time: 71.9004s
	iters: 700, epoch: 1 | loss: 0.4236929
	speed: 0.0050s/iter; left time: 103.5039s
	iters: 800, epoch: 1 | loss: 0.3737856
	speed: 0.0062s/iter; left time: 126.9077s
	iters: 900, epoch: 1 | loss: 0.6057029
	speed: 0.0055s/iter; left time: 111.0985s
	iters: 1000, epoch: 1 | loss: 0.3634794
	speed: 0.0052s/iter; left time: 105.4032s
Epoch: 1 cost time: 5.909228563308716
Epoch: 1, Steps: 1063 | Train Loss: 0.5200058 Vali Loss: 0.6521803 Test Loss: 1.2009909
Validation loss decreased (inf --> 0.652180).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.2812361
	speed: 0.0239s/iter; left time: 479.4590s
	iters: 200, epoch: 2 | loss: 0.2712289
	speed: 0.0064s/iter; left time: 128.2543s
	iters: 300, epoch: 2 | loss: 0.4383776
	speed: 0.0060s/iter; left time: 119.9954s
	iters: 400, epoch: 2 | loss: 0.4048102
	speed: 0.0058s/iter; left time: 115.0775s
	iters: 500, epoch: 2 | loss: 0.3860854
	speed: 0.0062s/iter; left time: 121.5469s
	iters: 600, epoch: 2 | loss: 0.5550343
	speed: 0.0065s/iter; left time: 128.2317s
	iters: 700, epoch: 2 | loss: 0.3888354
	speed: 0.0066s/iter; left time: 128.5124s
	iters: 800, epoch: 2 | loss: 0.4163955
	speed: 0.0065s/iter; left time: 125.3111s
	iters: 900, epoch: 2 | loss: 0.4505127
	speed: 0.0059s/iter; left time: 114.1397s
	iters: 1000, epoch: 2 | loss: 0.3049484
	speed: 0.0053s/iter; left time: 101.5978s
Epoch: 2 cost time: 6.4791178703308105
Epoch: 2, Steps: 1063 | Train Loss: 0.4859085 Vali Loss: 0.3972881 Test Loss: 0.8286332
Validation loss decreased (0.652180 --> 0.397288).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.3754434
	speed: 0.0252s/iter; left time: 479.4048s
	iters: 200, epoch: 3 | loss: 0.3007580
	speed: 0.0053s/iter; left time: 100.7932s
	iters: 300, epoch: 3 | loss: 0.2331301
	speed: 0.0053s/iter; left time: 100.5459s
	iters: 400, epoch: 3 | loss: 0.1867981
	speed: 0.0053s/iter; left time: 98.9636s
	iters: 500, epoch: 3 | loss: 0.2352440
	speed: 0.0055s/iter; left time: 103.0518s
	iters: 600, epoch: 3 | loss: 0.2216096
	speed: 0.0063s/iter; left time: 116.0389s
	iters: 700, epoch: 3 | loss: 0.4056683
	speed: 0.0060s/iter; left time: 110.2413s
	iters: 800, epoch: 3 | loss: 0.2454115
	speed: 0.0057s/iter; left time: 104.0370s
	iters: 900, epoch: 3 | loss: 0.7181428
	speed: 0.0056s/iter; left time: 102.5310s
	iters: 1000, epoch: 3 | loss: 0.2125568
	speed: 0.0055s/iter; left time: 99.0172s
Epoch: 3 cost time: 5.93902063369751
Epoch: 3, Steps: 1063 | Train Loss: 0.3432252 Vali Loss: 0.5272450 Test Loss: 1.2968427
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.4331833
	speed: 0.0258s/iter; left time: 463.6443s
	iters: 200, epoch: 4 | loss: 0.3838588
	speed: 0.0069s/iter; left time: 122.5738s
	iters: 300, epoch: 4 | loss: 0.1547619
	speed: 0.0067s/iter; left time: 119.2944s
	iters: 400, epoch: 4 | loss: 0.3087350
	speed: 0.0066s/iter; left time: 116.6730s
	iters: 500, epoch: 4 | loss: 0.2406253
	speed: 0.0061s/iter; left time: 107.3648s
	iters: 600, epoch: 4 | loss: 0.1907626
	speed: 0.0063s/iter; left time: 110.8231s
	iters: 700, epoch: 4 | loss: 0.2226216
	speed: 0.0069s/iter; left time: 119.0485s
	iters: 800, epoch: 4 | loss: 0.1798147
	speed: 0.0060s/iter; left time: 103.2572s
	iters: 900, epoch: 4 | loss: 0.3704011
	speed: 0.0055s/iter; left time: 94.6528s
	iters: 1000, epoch: 4 | loss: 0.9311869
	speed: 0.0064s/iter; left time: 109.4400s
Epoch: 4 cost time: 6.807475566864014
Epoch: 4, Steps: 1063 | Train Loss: 0.3147204 Vali Loss: 0.3407850 Test Loss: 0.7080535
Validation loss decreased (0.397288 --> 0.340785).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.1643675
	speed: 0.0239s/iter; left time: 403.4333s
	iters: 200, epoch: 5 | loss: 0.2909997
	speed: 0.0061s/iter; left time: 103.0493s
	iters: 300, epoch: 5 | loss: 0.1773430
	speed: 0.0062s/iter; left time: 104.1474s
	iters: 400, epoch: 5 | loss: 0.3484262
	speed: 0.0061s/iter; left time: 100.8690s
	iters: 500, epoch: 5 | loss: 0.2004636
	speed: 0.0063s/iter; left time: 103.3464s
	iters: 600, epoch: 5 | loss: 0.3505945
	speed: 0.0055s/iter; left time: 89.8230s
	iters: 700, epoch: 5 | loss: 0.2095553
	speed: 0.0062s/iter; left time: 101.2848s
	iters: 800, epoch: 5 | loss: 0.3105493
	speed: 0.0065s/iter; left time: 105.1139s
	iters: 900, epoch: 5 | loss: 0.3986157
	speed: 0.0048s/iter; left time: 76.8778s
	iters: 1000, epoch: 5 | loss: 0.1840887
	speed: 0.0038s/iter; left time: 61.3147s
Epoch: 5 cost time: 6.048205852508545
Epoch: 5, Steps: 1063 | Train Loss: 0.2948347 Vali Loss: 0.1991082 Test Loss: 0.3057201
Validation loss decreased (0.340785 --> 0.199108).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.5070109
	speed: 0.0222s/iter; left time: 351.6978s
	iters: 200, epoch: 6 | loss: 0.2532206
	speed: 0.0057s/iter; left time: 90.1030s
	iters: 300, epoch: 6 | loss: 0.3077795
	speed: 0.0057s/iter; left time: 89.0181s
	iters: 400, epoch: 6 | loss: 0.1911885
	speed: 0.0061s/iter; left time: 95.3277s
	iters: 500, epoch: 6 | loss: 0.2530464
	speed: 0.0062s/iter; left time: 95.7995s
	iters: 600, epoch: 6 | loss: 0.2583585
	speed: 0.0044s/iter; left time: 67.9916s
	iters: 700, epoch: 6 | loss: 0.3475823
	speed: 0.0047s/iter; left time: 72.1131s
	iters: 800, epoch: 6 | loss: 0.4177347
	speed: 0.0048s/iter; left time: 73.2112s
	iters: 900, epoch: 6 | loss: 0.5620990
	speed: 0.0058s/iter; left time: 86.7048s
	iters: 1000, epoch: 6 | loss: 0.2586225
	speed: 0.0053s/iter; left time: 79.3632s
Epoch: 6 cost time: 5.821206092834473
Epoch: 6, Steps: 1063 | Train Loss: 0.2857999 Vali Loss: 0.2677014 Test Loss: 0.5628612
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.1856338
	speed: 0.0250s/iter; left time: 369.4278s
	iters: 200, epoch: 7 | loss: 0.2088020
	speed: 0.0056s/iter; left time: 81.5002s
	iters: 300, epoch: 7 | loss: 0.1719765
	speed: 0.0059s/iter; left time: 86.6715s
	iters: 400, epoch: 7 | loss: 0.5874469
	speed: 0.0058s/iter; left time: 83.8566s
	iters: 500, epoch: 7 | loss: 0.5115019
	speed: 0.0059s/iter; left time: 84.6314s
	iters: 600, epoch: 7 | loss: 0.1865997
	speed: 0.0056s/iter; left time: 79.6991s
	iters: 700, epoch: 7 | loss: 0.3763875
	speed: 0.0051s/iter; left time: 72.1696s
	iters: 800, epoch: 7 | loss: 0.2155450
	speed: 0.0051s/iter; left time: 72.0990s
	iters: 900, epoch: 7 | loss: 0.2403022
	speed: 0.0051s/iter; left time: 71.6279s
	iters: 1000, epoch: 7 | loss: 0.6162719
	speed: 0.0050s/iter; left time: 69.4197s
Epoch: 7 cost time: 5.785409927368164
Epoch: 7, Steps: 1063 | Train Loss: 0.2803804 Vali Loss: 0.2430087 Test Loss: 0.4887844
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.2836573
	speed: 0.0223s/iter; left time: 305.6540s
	iters: 200, epoch: 8 | loss: 0.2108464
	speed: 0.0058s/iter; left time: 78.4577s
	iters: 300, epoch: 8 | loss: 0.3018713
	speed: 0.0057s/iter; left time: 77.0931s
	iters: 400, epoch: 8 | loss: 0.3508329
	speed: 0.0052s/iter; left time: 69.8983s
	iters: 500, epoch: 8 | loss: 0.3335772
	speed: 0.0053s/iter; left time: 70.0885s
	iters: 600, epoch: 8 | loss: 0.1645345
	speed: 0.0036s/iter; left time: 47.8562s
	iters: 700, epoch: 8 | loss: 0.1744047
	speed: 0.0054s/iter; left time: 70.7614s
	iters: 800, epoch: 8 | loss: 0.1547980
	speed: 0.0055s/iter; left time: 72.1306s
	iters: 900, epoch: 8 | loss: 0.2422612
	speed: 0.0058s/iter; left time: 75.2206s
	iters: 1000, epoch: 8 | loss: 0.1749387
	speed: 0.0054s/iter; left time: 69.1067s
Epoch: 8 cost time: 5.614333868026733
Epoch: 8, Steps: 1063 | Train Loss: 0.2775745 Vali Loss: 0.2014153 Test Loss: 0.3600134
EarlyStopping counter: 3 out of 5
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.3632440
	speed: 0.0268s/iter; left time: 339.4066s
	iters: 200, epoch: 9 | loss: 0.2376151
	speed: 0.0055s/iter; left time: 68.8305s
	iters: 300, epoch: 9 | loss: 0.2598637
	speed: 0.0050s/iter; left time: 61.6686s
	iters: 400, epoch: 9 | loss: 0.4768935
	speed: 0.0050s/iter; left time: 61.2081s
	iters: 500, epoch: 9 | loss: 0.2735324
	speed: 0.0051s/iter; left time: 62.5109s
	iters: 600, epoch: 9 | loss: 0.2287451
	speed: 0.0055s/iter; left time: 66.5319s
	iters: 700, epoch: 9 | loss: 0.1536794
	speed: 0.0055s/iter; left time: 66.5545s
	iters: 800, epoch: 9 | loss: 0.2019283
	speed: 0.0051s/iter; left time: 61.4892s
	iters: 900, epoch: 9 | loss: 0.2671931
	speed: 0.0045s/iter; left time: 53.8215s
	iters: 1000, epoch: 9 | loss: 0.2647685
	speed: 0.0043s/iter; left time: 50.5796s
Epoch: 9 cost time: 5.538180351257324
Epoch: 9, Steps: 1063 | Train Loss: 0.2759283 Vali Loss: 0.2125200 Test Loss: 0.3887044
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.6705695
	speed: 0.0242s/iter; left time: 280.3084s
	iters: 200, epoch: 10 | loss: 0.7295673
	speed: 0.0062s/iter; left time: 70.7113s
	iters: 300, epoch: 10 | loss: 0.1951597
	speed: 0.0067s/iter; left time: 76.3208s
	iters: 400, epoch: 10 | loss: 0.2153409
	speed: 0.0059s/iter; left time: 66.4743s
	iters: 500, epoch: 10 | loss: 0.2014246
	speed: 0.0054s/iter; left time: 60.9270s
	iters: 600, epoch: 10 | loss: 0.1800821
	speed: 0.0054s/iter; left time: 59.7966s
	iters: 700, epoch: 10 | loss: 0.2309612
	speed: 0.0063s/iter; left time: 68.7398s
	iters: 800, epoch: 10 | loss: 0.1796941
	speed: 0.0046s/iter; left time: 50.3305s
	iters: 900, epoch: 10 | loss: 0.2409693
	speed: 0.0054s/iter; left time: 57.7808s
	iters: 1000, epoch: 10 | loss: 0.3769903
	speed: 0.0063s/iter; left time: 66.8423s
Epoch: 10 cost time: 6.195770740509033
Epoch: 10, Steps: 1063 | Train Loss: 0.2747701 Vali Loss: 0.2012232 Test Loss: 0.3535454
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTm2_336_192_Linear_ETTm2_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3144<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
mse:0.30611854791641235, mae:0.3732636868953705
