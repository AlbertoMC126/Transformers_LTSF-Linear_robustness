Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='Linear', model_id='weather_336_720', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=720, root_path='./dataset/', save_pred_values=False, seed=15349, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : weather_336_720_Linear_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15349>>>>>>>>>>>>>>>>>>>>>>>>>>
train 35832
val 4551
test 9820
	iters: 100, epoch: 1 | loss: 0.7259130
	speed: 0.0532s/iter; left time: 2375.6457s
	iters: 200, epoch: 1 | loss: 0.8356534
	speed: 0.0522s/iter; left time: 2328.2036s
	iters: 300, epoch: 1 | loss: 0.8810208
	speed: 0.0487s/iter; left time: 2164.3405s
	iters: 400, epoch: 1 | loss: 0.5157106
	speed: 0.0481s/iter; left time: 2135.7594s
	iters: 500, epoch: 1 | loss: 0.8521362
	speed: 0.0486s/iter; left time: 2152.0715s
	iters: 600, epoch: 1 | loss: 0.8683655
	speed: 0.0544s/iter; left time: 2404.4380s
	iters: 700, epoch: 1 | loss: 0.7377652
	speed: 0.0458s/iter; left time: 2020.4263s
	iters: 800, epoch: 1 | loss: 0.9793423
	speed: 0.0517s/iter; left time: 2272.5016s
	iters: 900, epoch: 1 | loss: 0.5939822
	speed: 0.0512s/iter; left time: 2246.0091s
	iters: 1000, epoch: 1 | loss: 0.7516165
	speed: 0.0515s/iter; left time: 2255.1186s
	iters: 1100, epoch: 1 | loss: 2.3437951
	speed: 0.0513s/iter; left time: 2239.2348s
	iters: 1200, epoch: 1 | loss: 0.6035329
	speed: 0.0502s/iter; left time: 2185.8723s
	iters: 1300, epoch: 1 | loss: 0.5438637
	speed: 0.0519s/iter; left time: 2256.7722s
	iters: 1400, epoch: 1 | loss: 3.5561304
	speed: 0.0493s/iter; left time: 2138.1374s
	iters: 1500, epoch: 1 | loss: 0.5728827
	speed: 0.0550s/iter; left time: 2378.9574s
	iters: 1600, epoch: 1 | loss: 0.6391193
	speed: 0.0514s/iter; left time: 2217.3650s
	iters: 1700, epoch: 1 | loss: 0.9082009
	speed: 0.0459s/iter; left time: 1975.6730s
	iters: 1800, epoch: 1 | loss: 0.5523113
	speed: 0.0490s/iter; left time: 2105.5044s
	iters: 1900, epoch: 1 | loss: 0.6807079
	speed: 0.0521s/iter; left time: 2231.9827s
	iters: 2000, epoch: 1 | loss: 0.7520378
	speed: 0.0557s/iter; left time: 2381.0139s
	iters: 2100, epoch: 1 | loss: 0.9200873
	speed: 0.0544s/iter; left time: 2322.0635s
	iters: 2200, epoch: 1 | loss: 1.0799257
	speed: 0.0450s/iter; left time: 1914.7081s
Epoch: 1 cost time: 113.07963705062866
Epoch: 1, Steps: 2239 | Train Loss: 1.3118058 Vali Loss: 0.7401794 Test Loss: 0.4058273
Validation loss decreased (inf --> 0.740179).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.5475782
	speed: 0.1473s/iter; left time: 6252.7153s
	iters: 200, epoch: 2 | loss: 1.5297589
	speed: 0.0489s/iter; left time: 2068.7051s
	iters: 300, epoch: 2 | loss: 0.9471452
	speed: 0.0527s/iter; left time: 2226.7311s
	iters: 400, epoch: 2 | loss: 0.7000647
	speed: 0.0481s/iter; left time: 2028.2433s
	iters: 500, epoch: 2 | loss: 0.7972547
	speed: 0.0504s/iter; left time: 2117.0923s
	iters: 600, epoch: 2 | loss: 0.7961772
	speed: 0.0513s/iter; left time: 2150.1825s
	iters: 700, epoch: 2 | loss: 0.6718364
	speed: 0.0493s/iter; left time: 2063.7772s
	iters: 800, epoch: 2 | loss: 0.7798294
	speed: 0.0479s/iter; left time: 1998.5295s
	iters: 900, epoch: 2 | loss: 0.6519379
	speed: 0.0487s/iter; left time: 2029.3973s
	iters: 1000, epoch: 2 | loss: 1.9800582
	speed: 0.0516s/iter; left time: 2141.8895s
	iters: 1100, epoch: 2 | loss: 0.5062995
	speed: 0.0499s/iter; left time: 2069.9139s
	iters: 1200, epoch: 2 | loss: 0.6788892
	speed: 0.0513s/iter; left time: 2118.9004s
	iters: 1300, epoch: 2 | loss: 0.7942676
	speed: 0.0512s/iter; left time: 2110.2931s
	iters: 1400, epoch: 2 | loss: 0.8138761
	speed: 0.0512s/iter; left time: 2107.4476s
	iters: 1500, epoch: 2 | loss: 0.6399615
	speed: 0.0485s/iter; left time: 1991.7349s
	iters: 1600, epoch: 2 | loss: 1.6289107
	speed: 0.0510s/iter; left time: 2088.0066s
	iters: 1700, epoch: 2 | loss: 0.9031767
	speed: 0.0485s/iter; left time: 1982.0032s
	iters: 1800, epoch: 2 | loss: 0.6639992
	speed: 0.0494s/iter; left time: 2011.3785s
	iters: 1900, epoch: 2 | loss: 0.9517367
	speed: 0.0497s/iter; left time: 2019.1504s
	iters: 2000, epoch: 2 | loss: 0.5122632
	speed: 0.0515s/iter; left time: 2088.9278s
	iters: 2100, epoch: 2 | loss: 1.6363844
	speed: 0.0497s/iter; left time: 2009.8906s
	iters: 2200, epoch: 2 | loss: 0.5823343
	speed: 0.0426s/iter; left time: 1718.3450s
Epoch: 2 cost time: 110.71825408935547
Epoch: 2, Steps: 2239 | Train Loss: 1.0654720 Vali Loss: 0.7623323 Test Loss: 0.3918272
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.6104386
	speed: 0.1418s/iter; left time: 5699.4715s
	iters: 200, epoch: 3 | loss: 1.0511972
	speed: 0.0511s/iter; left time: 2047.2786s
	iters: 300, epoch: 3 | loss: 0.7720787
	speed: 0.0535s/iter; left time: 2140.2902s
	iters: 400, epoch: 3 | loss: 0.8949028
	speed: 0.0545s/iter; left time: 2174.9599s
	iters: 500, epoch: 3 | loss: 0.4345372
	speed: 0.0483s/iter; left time: 1923.6225s
	iters: 600, epoch: 3 | loss: 0.9304870
	speed: 0.0518s/iter; left time: 2056.9890s
	iters: 700, epoch: 3 | loss: 0.7455377
	speed: 0.0497s/iter; left time: 1966.4689s
	iters: 800, epoch: 3 | loss: 0.9422022
	speed: 0.0518s/iter; left time: 2045.9113s
	iters: 900, epoch: 3 | loss: 0.5482334
	speed: 0.0486s/iter; left time: 1913.5779s
	iters: 1000, epoch: 3 | loss: 0.5302843
	speed: 0.0488s/iter; left time: 1918.7844s
	iters: 1100, epoch: 3 | loss: 0.5132622
	speed: 0.0496s/iter; left time: 1944.4174s
	iters: 1200, epoch: 3 | loss: 1.3935182
	speed: 0.0497s/iter; left time: 1942.0169s
	iters: 1300, epoch: 3 | loss: 0.5796067
	speed: 0.0527s/iter; left time: 2056.0650s
	iters: 1400, epoch: 3 | loss: 0.7819759
	speed: 0.0498s/iter; left time: 1939.0662s
	iters: 1500, epoch: 3 | loss: 0.6067733
	speed: 0.0483s/iter; left time: 1872.4513s
	iters: 1600, epoch: 3 | loss: 0.7361584
	speed: 0.0525s/iter; left time: 2033.6736s
	iters: 1700, epoch: 3 | loss: 1.7855655
	speed: 0.0530s/iter; left time: 2047.0404s
	iters: 1800, epoch: 3 | loss: 0.4491874
	speed: 0.0501s/iter; left time: 1927.3488s
	iters: 1900, epoch: 3 | loss: 0.4637851
	speed: 0.0461s/iter; left time: 1769.5182s
	iters: 2000, epoch: 3 | loss: 0.7186351
	speed: 0.0495s/iter; left time: 1897.5629s
	iters: 2100, epoch: 3 | loss: 0.7587401
	speed: 0.0519s/iter; left time: 1982.8603s
	iters: 2200, epoch: 3 | loss: 1.2028962
	speed: 0.0431s/iter; left time: 1643.5387s
Epoch: 3 cost time: 111.80053997039795
Epoch: 3, Steps: 2239 | Train Loss: 0.7931109 Vali Loss: 0.6530869 Test Loss: 0.3584618
Validation loss decreased (0.740179 --> 0.653087).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.4540845
	speed: 0.1550s/iter; left time: 5884.8928s
	iters: 200, epoch: 4 | loss: 0.4593055
	speed: 0.0486s/iter; left time: 1841.6875s
	iters: 300, epoch: 4 | loss: 0.5792504
	speed: 0.0504s/iter; left time: 1904.7617s
	iters: 400, epoch: 4 | loss: 0.5107476
	speed: 0.0486s/iter; left time: 1828.6826s
	iters: 500, epoch: 4 | loss: 2.1152630
	speed: 0.0501s/iter; left time: 1880.8061s
	iters: 600, epoch: 4 | loss: 0.7479078
	speed: 0.0548s/iter; left time: 2054.2273s
	iters: 700, epoch: 4 | loss: 0.6036758
	speed: 0.0520s/iter; left time: 1941.6475s
	iters: 800, epoch: 4 | loss: 0.5788465
	speed: 0.0520s/iter; left time: 1938.8632s
	iters: 900, epoch: 4 | loss: 0.5763992
	speed: 0.0514s/iter; left time: 1909.2790s
	iters: 1000, epoch: 4 | loss: 0.3973001
	speed: 0.0499s/iter; left time: 1851.1922s
	iters: 1100, epoch: 4 | loss: 0.5108109
	speed: 0.0528s/iter; left time: 1951.9842s
	iters: 1200, epoch: 4 | loss: 0.4779416
	speed: 0.0508s/iter; left time: 1873.2628s
	iters: 1300, epoch: 4 | loss: 0.5688449
	speed: 0.0536s/iter; left time: 1972.2612s
	iters: 1400, epoch: 4 | loss: 0.6409652
	speed: 0.0475s/iter; left time: 1742.4325s
	iters: 1500, epoch: 4 | loss: 0.7258109
	speed: 0.0505s/iter; left time: 1847.7040s
	iters: 1600, epoch: 4 | loss: 0.5513042
	speed: 0.0508s/iter; left time: 1853.3386s
	iters: 1700, epoch: 4 | loss: 0.5356957
	speed: 0.0482s/iter; left time: 1753.3958s
	iters: 1800, epoch: 4 | loss: 0.4097068
	speed: 0.0525s/iter; left time: 1903.2940s
	iters: 1900, epoch: 4 | loss: 0.5782189
	speed: 0.0529s/iter; left time: 1911.9136s
	iters: 2000, epoch: 4 | loss: 0.4547201
	speed: 0.0490s/iter; left time: 1766.9821s
	iters: 2100, epoch: 4 | loss: 1.2124244
	speed: 0.0497s/iter; left time: 1787.6062s
	iters: 2200, epoch: 4 | loss: 0.5711800
	speed: 0.0390s/iter; left time: 1398.8748s
Epoch: 4 cost time: 111.69758558273315
Epoch: 4, Steps: 2239 | Train Loss: 0.6489252 Vali Loss: 0.6470932 Test Loss: 0.3409414
Validation loss decreased (0.653087 --> 0.647093).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.4041030
	speed: 0.1651s/iter; left time: 5897.4182s
	iters: 200, epoch: 5 | loss: 0.5317712
	speed: 0.0514s/iter; left time: 1830.8510s
	iters: 300, epoch: 5 | loss: 0.9213442
	speed: 0.0528s/iter; left time: 1876.8723s
	iters: 400, epoch: 5 | loss: 0.4989297
	speed: 0.0523s/iter; left time: 1854.4898s
	iters: 500, epoch: 5 | loss: 0.8947058
	speed: 0.0512s/iter; left time: 1809.1083s
	iters: 600, epoch: 5 | loss: 0.5250622
	speed: 0.0501s/iter; left time: 1765.7789s
	iters: 700, epoch: 5 | loss: 0.7451174
	speed: 0.0525s/iter; left time: 1844.1103s
	iters: 800, epoch: 5 | loss: 0.4518136
	speed: 0.0549s/iter; left time: 1924.2060s
	iters: 900, epoch: 5 | loss: 0.5144744
	speed: 0.0558s/iter; left time: 1949.0490s
	iters: 1000, epoch: 5 | loss: 0.7343572
	speed: 0.0479s/iter; left time: 1669.8335s
	iters: 1100, epoch: 5 | loss: 0.7125659
	speed: 0.0504s/iter; left time: 1750.6851s
	iters: 1200, epoch: 5 | loss: 0.6789342
	speed: 0.0518s/iter; left time: 1794.6622s
	iters: 1300, epoch: 5 | loss: 0.4326936
	speed: 0.0517s/iter; left time: 1785.6471s
	iters: 1400, epoch: 5 | loss: 0.5607649
	speed: 0.0514s/iter; left time: 1769.4499s
	iters: 1500, epoch: 5 | loss: 0.7752001
	speed: 0.0503s/iter; left time: 1727.1859s
	iters: 1600, epoch: 5 | loss: 0.5750690
	speed: 0.0476s/iter; left time: 1628.9683s
	iters: 1700, epoch: 5 | loss: 0.4137101
	speed: 0.0535s/iter; left time: 1825.8180s
	iters: 1800, epoch: 5 | loss: 0.7154859
	speed: 0.0517s/iter; left time: 1759.4521s
	iters: 1900, epoch: 5 | loss: 0.5056484
	speed: 0.0493s/iter; left time: 1674.0247s
	iters: 2000, epoch: 5 | loss: 0.5263030
	speed: 0.0488s/iter; left time: 1652.0380s
	iters: 2100, epoch: 5 | loss: 0.8008293
	speed: 0.0393s/iter; left time: 1325.8463s
	iters: 2200, epoch: 5 | loss: 0.5209631
	speed: 0.0378s/iter; left time: 1269.8985s
Epoch: 5 cost time: 111.52234363555908
Epoch: 5, Steps: 2239 | Train Loss: 0.6101814 Vali Loss: 0.6069355 Test Loss: 0.3292086
Validation loss decreased (0.647093 --> 0.606936).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.6612734
	speed: 0.1740s/iter; left time: 5825.1537s
	iters: 200, epoch: 6 | loss: 0.4842938
	speed: 0.0540s/iter; left time: 1804.4036s
	iters: 300, epoch: 6 | loss: 0.6473075
	speed: 0.0512s/iter; left time: 1703.2820s
	iters: 400, epoch: 6 | loss: 0.7192468
	speed: 0.0488s/iter; left time: 1618.7143s
	iters: 500, epoch: 6 | loss: 0.5820869
	speed: 0.0458s/iter; left time: 1513.9868s
	iters: 600, epoch: 6 | loss: 0.3666663
	speed: 0.0510s/iter; left time: 1681.1222s
	iters: 700, epoch: 6 | loss: 0.4378818
	speed: 0.0508s/iter; left time: 1671.5257s
	iters: 800, epoch: 6 | loss: 0.4118822
	speed: 0.0486s/iter; left time: 1592.6756s
	iters: 900, epoch: 6 | loss: 0.4334733
	speed: 0.0501s/iter; left time: 1636.6362s
	iters: 1000, epoch: 6 | loss: 0.7471668
	speed: 0.0507s/iter; left time: 1650.4907s
	iters: 1100, epoch: 6 | loss: 1.0819362
	speed: 0.0495s/iter; left time: 1606.8342s
	iters: 1200, epoch: 6 | loss: 0.4413760
	speed: 0.0508s/iter; left time: 1646.4468s
	iters: 1300, epoch: 6 | loss: 0.4246148
	speed: 0.0477s/iter; left time: 1539.9130s
	iters: 1400, epoch: 6 | loss: 0.5255070
	speed: 0.0535s/iter; left time: 1721.5239s
	iters: 1500, epoch: 6 | loss: 0.3797209
	speed: 0.0500s/iter; left time: 1604.6807s
	iters: 1600, epoch: 6 | loss: 0.4972425
	speed: 0.0461s/iter; left time: 1473.3007s
	iters: 1700, epoch: 6 | loss: 0.5840116
	speed: 0.0457s/iter; left time: 1456.3615s
	iters: 1800, epoch: 6 | loss: 0.9328363
	speed: 0.0484s/iter; left time: 1539.4140s
	iters: 1900, epoch: 6 | loss: 0.7631115
	speed: 0.0485s/iter; left time: 1535.2397s
	iters: 2000, epoch: 6 | loss: 0.6976081
	speed: 0.0489s/iter; left time: 1542.9904s
	iters: 2100, epoch: 6 | loss: 0.7963588
	speed: 0.0430s/iter; left time: 1352.4367s
	iters: 2200, epoch: 6 | loss: 0.4573595
	speed: 0.0361s/iter; left time: 1133.6482s
Epoch: 6 cost time: 108.01506876945496
Epoch: 6, Steps: 2239 | Train Loss: 0.5932376 Vali Loss: 0.5894870 Test Loss: 0.3221643
Validation loss decreased (0.606936 --> 0.589487).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.9616570
	speed: 0.1713s/iter; left time: 5351.9558s
	iters: 200, epoch: 7 | loss: 0.5183883
	speed: 0.0499s/iter; left time: 1553.9215s
	iters: 300, epoch: 7 | loss: 0.4438009
	speed: 0.0512s/iter; left time: 1589.8178s
	iters: 400, epoch: 7 | loss: 0.5991605
	speed: 0.0495s/iter; left time: 1530.7621s
	iters: 500, epoch: 7 | loss: 0.4289553
	speed: 0.0516s/iter; left time: 1593.1800s
	iters: 600, epoch: 7 | loss: 0.4459910
	speed: 0.0536s/iter; left time: 1647.2359s
	iters: 700, epoch: 7 | loss: 0.5296705
	speed: 0.0508s/iter; left time: 1558.3276s
	iters: 800, epoch: 7 | loss: 0.4842114
	speed: 0.0541s/iter; left time: 1651.1350s
	iters: 900, epoch: 7 | loss: 0.9437810
	speed: 0.0492s/iter; left time: 1497.8965s
	iters: 1000, epoch: 7 | loss: 0.5440204
	speed: 0.0513s/iter; left time: 1557.5954s
	iters: 1100, epoch: 7 | loss: 0.4740907
	speed: 0.0501s/iter; left time: 1516.6140s
	iters: 1200, epoch: 7 | loss: 0.4300998
	speed: 0.0490s/iter; left time: 1478.4338s
	iters: 1300, epoch: 7 | loss: 0.4915347
	speed: 0.0495s/iter; left time: 1487.9091s
	iters: 1400, epoch: 7 | loss: 0.4654384
	speed: 0.0522s/iter; left time: 1564.5097s
	iters: 1500, epoch: 7 | loss: 0.6871340
	speed: 0.0444s/iter; left time: 1326.1455s
	iters: 1600, epoch: 7 | loss: 0.4786776
	speed: 0.0488s/iter; left time: 1450.7917s
	iters: 1700, epoch: 7 | loss: 0.4130315
	speed: 0.0487s/iter; left time: 1442.7454s
	iters: 1800, epoch: 7 | loss: 0.5243251
	speed: 0.0480s/iter; left time: 1417.4516s
	iters: 1900, epoch: 7 | loss: 0.5832477
	speed: 0.0475s/iter; left time: 1397.7792s
	iters: 2000, epoch: 7 | loss: 0.6396936
	speed: 0.0502s/iter; left time: 1474.4863s
	iters: 2100, epoch: 7 | loss: 0.3620635
	speed: 0.0444s/iter; left time: 1299.5729s
	iters: 2200, epoch: 7 | loss: 0.6061818
	speed: 0.0363s/iter; left time: 1056.9289s
Epoch: 7 cost time: 109.94735288619995
Epoch: 7, Steps: 2239 | Train Loss: 0.5866923 Vali Loss: 0.5995136 Test Loss: 0.3226412
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.5139174
	speed: 0.1831s/iter; left time: 5310.3817s
	iters: 200, epoch: 8 | loss: 0.3466355
	speed: 0.0530s/iter; left time: 1533.5458s
	iters: 300, epoch: 8 | loss: 0.5696072
	speed: 0.0453s/iter; left time: 1304.9990s
	iters: 400, epoch: 8 | loss: 0.4913434
	speed: 0.0546s/iter; left time: 1566.2113s
	iters: 500, epoch: 8 | loss: 0.6827561
	speed: 0.0468s/iter; left time: 1339.1167s
	iters: 600, epoch: 8 | loss: 1.0095395
	speed: 0.0522s/iter; left time: 1488.2575s
	iters: 700, epoch: 8 | loss: 0.4765595
	speed: 0.0523s/iter; left time: 1486.4745s
	iters: 800, epoch: 8 | loss: 0.4345459
	speed: 0.0500s/iter; left time: 1415.3671s
	iters: 900, epoch: 8 | loss: 0.7088237
	speed: 0.0500s/iter; left time: 1410.2261s
	iters: 1000, epoch: 8 | loss: 0.4193570
	speed: 0.0472s/iter; left time: 1325.3560s
	iters: 1100, epoch: 8 | loss: 0.3827085
	speed: 0.0485s/iter; left time: 1358.3666s
	iters: 1200, epoch: 8 | loss: 1.0733682
	speed: 0.0526s/iter; left time: 1469.0623s
	iters: 1300, epoch: 8 | loss: 0.5058914
	speed: 0.0499s/iter; left time: 1386.8743s
	iters: 1400, epoch: 8 | loss: 0.4766718
	speed: 0.0501s/iter; left time: 1388.0747s
	iters: 1500, epoch: 8 | loss: 0.7999230
	speed: 0.0539s/iter; left time: 1488.6662s
	iters: 1600, epoch: 8 | loss: 0.4707357
	speed: 0.0536s/iter; left time: 1474.1680s
	iters: 1700, epoch: 8 | loss: 0.3907381
	speed: 0.0467s/iter; left time: 1281.2394s
	iters: 1800, epoch: 8 | loss: 0.7880246
	speed: 0.0510s/iter; left time: 1393.3754s
	iters: 1900, epoch: 8 | loss: 0.7024945
	speed: 0.0495s/iter; left time: 1348.1009s
	iters: 2000, epoch: 8 | loss: 0.6821845
	speed: 0.0455s/iter; left time: 1234.0113s
	iters: 2100, epoch: 8 | loss: 1.4625711
	speed: 0.0395s/iter; left time: 1065.7895s
	iters: 2200, epoch: 8 | loss: 0.6342160
	speed: 0.0380s/iter; left time: 1021.7019s
Epoch: 8 cost time: 109.64458727836609
Epoch: 8, Steps: 2239 | Train Loss: 0.5828155 Vali Loss: 0.6002322 Test Loss: 0.3202282
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.6197026
	speed: 0.1833s/iter; left time: 4905.5841s
	iters: 200, epoch: 9 | loss: 0.4357709
	speed: 0.0460s/iter; left time: 1226.2334s
	iters: 300, epoch: 9 | loss: 0.4016356
	speed: 0.0516s/iter; left time: 1370.8314s
	iters: 400, epoch: 9 | loss: 0.3755902
	speed: 0.0502s/iter; left time: 1328.1271s
	iters: 500, epoch: 9 | loss: 0.4430206
	speed: 0.0507s/iter; left time: 1336.1335s
	iters: 600, epoch: 9 | loss: 0.7873266
	speed: 0.0481s/iter; left time: 1264.5070s
	iters: 700, epoch: 9 | loss: 0.5574496
	speed: 0.0537s/iter; left time: 1406.3050s
	iters: 800, epoch: 9 | loss: 0.6148141
	speed: 0.0504s/iter; left time: 1313.0116s
	iters: 900, epoch: 9 | loss: 0.4406241
	speed: 0.0522s/iter; left time: 1354.7177s
	iters: 1000, epoch: 9 | loss: 0.5060408
	speed: 0.0497s/iter; left time: 1285.2096s
	iters: 1100, epoch: 9 | loss: 1.0547055
	speed: 0.0541s/iter; left time: 1393.1035s
	iters: 1200, epoch: 9 | loss: 0.7109761
	speed: 0.0488s/iter; left time: 1251.9606s
	iters: 1300, epoch: 9 | loss: 0.3912701
	speed: 0.0497s/iter; left time: 1271.9308s
	iters: 1400, epoch: 9 | loss: 0.4648167
	speed: 0.0502s/iter; left time: 1279.1255s
	iters: 1500, epoch: 9 | loss: 0.4355598
	speed: 0.0484s/iter; left time: 1228.6155s
	iters: 1600, epoch: 9 | loss: 0.7633345
	speed: 0.0481s/iter; left time: 1214.3677s
	iters: 1700, epoch: 9 | loss: 0.6265544
	speed: 0.0481s/iter; left time: 1210.8463s
	iters: 1800, epoch: 9 | loss: 0.7732073
	speed: 0.0503s/iter; left time: 1259.8929s
	iters: 1900, epoch: 9 | loss: 0.8763477
	speed: 0.0455s/iter; left time: 1136.4763s
	iters: 2000, epoch: 9 | loss: 0.4224313
	speed: 0.0418s/iter; left time: 1039.3616s
	iters: 2100, epoch: 9 | loss: 0.7536067
	speed: 0.0373s/iter; left time: 925.0074s
	iters: 2200, epoch: 9 | loss: 0.4542589
	speed: 0.0383s/iter; left time: 945.0815s
Epoch: 9 cost time: 108.13997983932495
Epoch: 9, Steps: 2239 | Train Loss: 0.5809510 Vali Loss: 0.5945818 Test Loss: 0.3161009
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.9384010
	speed: 0.1943s/iter; left time: 4765.5670s
	iters: 200, epoch: 10 | loss: 3.4209259
	speed: 0.0482s/iter; left time: 1178.0833s
	iters: 300, epoch: 10 | loss: 0.6763763
	speed: 0.0526s/iter; left time: 1280.6659s
	iters: 400, epoch: 10 | loss: 0.5940890
	speed: 0.0538s/iter; left time: 1304.0971s
	iters: 500, epoch: 10 | loss: 0.4225117
	speed: 0.0546s/iter; left time: 1316.8266s
	iters: 600, epoch: 10 | loss: 0.3903677
	speed: 0.0533s/iter; left time: 1281.9116s
	iters: 700, epoch: 10 | loss: 0.4257629
	speed: 0.0474s/iter; left time: 1134.2475s
	iters: 800, epoch: 10 | loss: 0.4181482
	speed: 0.0512s/iter; left time: 1220.8137s
	iters: 900, epoch: 10 | loss: 0.3837964
	speed: 0.0516s/iter; left time: 1225.6263s
	iters: 1000, epoch: 10 | loss: 0.4390272
	speed: 0.0526s/iter; left time: 1243.6448s
	iters: 1100, epoch: 10 | loss: 0.5520293
	speed: 0.0450s/iter; left time: 1059.5886s
	iters: 1200, epoch: 10 | loss: 0.4575166
	speed: 0.0455s/iter; left time: 1065.8509s
	iters: 1300, epoch: 10 | loss: 0.4450008
	speed: 0.0477s/iter; left time: 1113.9568s
	iters: 1400, epoch: 10 | loss: 0.4989342
	speed: 0.0483s/iter; left time: 1122.2119s
	iters: 1500, epoch: 10 | loss: 0.5208601
	speed: 0.0481s/iter; left time: 1113.2948s
	iters: 1600, epoch: 10 | loss: 0.4468642
	speed: 0.0520s/iter; left time: 1198.2365s
	iters: 1700, epoch: 10 | loss: 0.7582256
	speed: 0.0519s/iter; left time: 1189.1609s
	iters: 1800, epoch: 10 | loss: 0.6305030
	speed: 0.0500s/iter; left time: 1140.6339s
	iters: 1900, epoch: 10 | loss: 0.7497869
	speed: 0.0460s/iter; left time: 1044.7359s
	iters: 2000, epoch: 10 | loss: 0.4373222
	speed: 0.0387s/iter; left time: 874.9602s
	iters: 2100, epoch: 10 | loss: 0.4135798
	speed: 0.0398s/iter; left time: 895.8448s
	iters: 2200, epoch: 10 | loss: 0.4552412
	speed: 0.0425s/iter; left time: 952.5025s
Epoch: 10 cost time: 108.91709017753601
Epoch: 10, Steps: 2239 | Train Loss: 0.5799310 Vali Loss: 0.5926478 Test Loss: 0.3177145
EarlyStopping counter: 4 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.3917278
	speed: 0.1893s/iter; left time: 4218.5811s
	iters: 200, epoch: 11 | loss: 0.4287188
	speed: 0.0507s/iter; left time: 1125.5126s
	iters: 300, epoch: 11 | loss: 0.5447726
	speed: 0.0493s/iter; left time: 1089.5564s
	iters: 400, epoch: 11 | loss: 0.6600413
	speed: 0.0491s/iter; left time: 1079.2749s
	iters: 500, epoch: 11 | loss: 0.4311783
	speed: 0.0477s/iter; left time: 1044.9505s
	iters: 600, epoch: 11 | loss: 0.5095854
	speed: 0.0530s/iter; left time: 1154.2773s
	iters: 700, epoch: 11 | loss: 0.3977371
	speed: 0.0445s/iter; left time: 964.3061s
	iters: 800, epoch: 11 | loss: 0.4340991
	speed: 0.0499s/iter; left time: 1078.3352s
	iters: 900, epoch: 11 | loss: 0.5873838
	speed: 0.0496s/iter; left time: 1066.8378s
	iters: 1000, epoch: 11 | loss: 0.7224197
	speed: 0.0441s/iter; left time: 943.1256s
	iters: 1100, epoch: 11 | loss: 0.6295397
	speed: 0.0504s/iter; left time: 1072.6025s
	iters: 1200, epoch: 11 | loss: 0.7205355
	speed: 0.0485s/iter; left time: 1027.2904s
	iters: 1300, epoch: 11 | loss: 0.5442228
	speed: 0.0489s/iter; left time: 1030.5635s
	iters: 1400, epoch: 11 | loss: 0.4338646
	speed: 0.0505s/iter; left time: 1060.1648s
	iters: 1500, epoch: 11 | loss: 0.6724284
	speed: 0.0487s/iter; left time: 1017.2627s
	iters: 1600, epoch: 11 | loss: 0.4060555
	speed: 0.0509s/iter; left time: 1058.3318s
	iters: 1700, epoch: 11 | loss: 0.5017554
	speed: 0.0546s/iter; left time: 1130.2552s
	iters: 1800, epoch: 11 | loss: 0.7260878
	speed: 0.0493s/iter; left time: 1014.5800s
	iters: 1900, epoch: 11 | loss: 0.3472656
	speed: 0.0436s/iter; left time: 892.8823s
	iters: 2000, epoch: 11 | loss: 0.4248173
	speed: 0.0388s/iter; left time: 791.8160s
	iters: 2100, epoch: 11 | loss: 0.6049119
	speed: 0.0409s/iter; left time: 829.9169s
	iters: 2200, epoch: 11 | loss: 0.7355627
	speed: 0.0427s/iter; left time: 862.7314s
Epoch: 11 cost time: 107.53679895401001
Epoch: 11, Steps: 2239 | Train Loss: 0.5794668 Vali Loss: 0.5927050 Test Loss: 0.3179556
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : weather_336_720_Linear_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15349<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9820
mse:0.3221021592617035, mae:0.3648938834667206
