Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='DLinear', model_id='traffic_336_192', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=192, root_path='./dataset/', save_pred_values=False, seed=3144, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_336_192_DLinear_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3144>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11753
val 1565
test 3317
	iters: 100, epoch: 1 | loss: 0.5261542
	speed: 0.4194s/iter; left time: 6115.1552s
	iters: 200, epoch: 1 | loss: 0.5965897
	speed: 0.4004s/iter; left time: 5797.7768s
	iters: 300, epoch: 1 | loss: 0.5766318
	speed: 0.3975s/iter; left time: 5715.9016s
	iters: 400, epoch: 1 | loss: 0.7118315
	speed: 0.4023s/iter; left time: 5744.7749s
	iters: 500, epoch: 1 | loss: 0.6224226
	speed: 0.4011s/iter; left time: 5688.4841s
	iters: 600, epoch: 1 | loss: 0.5686743
	speed: 0.3967s/iter; left time: 5586.4027s
	iters: 700, epoch: 1 | loss: 0.6139964
	speed: 0.3950s/iter; left time: 5521.9042s
Epoch: 1 cost time: 295.0109806060791
Epoch: 1, Steps: 734 | Train Loss: 0.5876283 Vali Loss: 0.8136010 Test Loss: 0.9546664
Validation loss decreased (inf --> 0.813601).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.5292406
	speed: 0.8935s/iter; left time: 12372.6158s
	iters: 200, epoch: 2 | loss: 0.5979279
	speed: 0.4117s/iter; left time: 5659.5693s
	iters: 300, epoch: 2 | loss: 0.6413705
	speed: 0.3969s/iter; left time: 5416.1742s
	iters: 400, epoch: 2 | loss: 0.5960201
	speed: 0.3977s/iter; left time: 5387.1291s
	iters: 500, epoch: 2 | loss: 0.5784950
	speed: 0.4028s/iter; left time: 5416.0428s
	iters: 600, epoch: 2 | loss: 0.5748082
	speed: 0.3979s/iter; left time: 5310.1439s
	iters: 700, epoch: 2 | loss: 0.5994973
	speed: 0.3948s/iter; left time: 5229.8214s
Epoch: 2 cost time: 293.91599321365356
Epoch: 2, Steps: 734 | Train Loss: 0.5859022 Vali Loss: 0.8070880 Test Loss: 0.9525569
Validation loss decreased (0.813601 --> 0.807088).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.3768880
	speed: 0.8960s/iter; left time: 11749.8565s
	iters: 200, epoch: 3 | loss: 0.3333563
	speed: 0.4094s/iter; left time: 5327.0195s
	iters: 300, epoch: 3 | loss: 0.3468375
	speed: 0.4097s/iter; left time: 5289.8711s
	iters: 400, epoch: 3 | loss: 0.3384490
	speed: 0.3994s/iter; left time: 5117.9316s
	iters: 500, epoch: 3 | loss: 0.3450022
	speed: 0.3992s/iter; left time: 5074.8846s
	iters: 600, epoch: 3 | loss: 0.3380794
	speed: 0.4086s/iter; left time: 5153.0930s
	iters: 700, epoch: 3 | loss: 0.3580535
	speed: 0.3946s/iter; left time: 4937.4567s
Epoch: 3 cost time: 296.40236592292786
Epoch: 3, Steps: 734 | Train Loss: 0.3595254 Vali Loss: 0.4997177 Test Loss: 0.6072150
Validation loss decreased (0.807088 --> 0.499718).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.2649436
	speed: 0.9010s/iter; left time: 11153.0738s
	iters: 200, epoch: 4 | loss: 0.2801307
	speed: 0.4033s/iter; left time: 4952.6901s
	iters: 300, epoch: 4 | loss: 0.2961137
	speed: 0.4001s/iter; left time: 4872.8991s
	iters: 400, epoch: 4 | loss: 0.2793057
	speed: 0.4016s/iter; left time: 4850.6965s
	iters: 500, epoch: 4 | loss: 0.2802335
	speed: 0.3981s/iter; left time: 4768.3051s
	iters: 600, epoch: 4 | loss: 0.2894669
	speed: 0.4019s/iter; left time: 4774.3383s
	iters: 700, epoch: 4 | loss: 0.2815903
	speed: 0.3947s/iter; left time: 4648.9729s
Epoch: 4 cost time: 293.9291687011719
Epoch: 4, Steps: 734 | Train Loss: 0.2944154 Vali Loss: 0.4218579 Test Loss: 0.5141429
Validation loss decreased (0.499718 --> 0.421858).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.2591606
	speed: 0.8897s/iter; left time: 10360.9467s
	iters: 200, epoch: 5 | loss: 0.3057948
	speed: 0.4039s/iter; left time: 4663.2517s
	iters: 300, epoch: 5 | loss: 0.2728023
	speed: 0.3976s/iter; left time: 4550.8074s
	iters: 400, epoch: 5 | loss: 0.2741314
	speed: 0.4112s/iter; left time: 4665.3933s
	iters: 500, epoch: 5 | loss: 0.2536406
	speed: 0.3991s/iter; left time: 4487.4202s
	iters: 600, epoch: 5 | loss: 0.2746987
	speed: 0.3955s/iter; left time: 4407.8463s
	iters: 700, epoch: 5 | loss: 0.2606193
	speed: 0.3980s/iter; left time: 4396.2880s
Epoch: 5 cost time: 294.35879039764404
Epoch: 5, Steps: 734 | Train Loss: 0.2676947 Vali Loss: 0.3859541 Test Loss: 0.4764398
Validation loss decreased (0.421858 --> 0.385954).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.2249243
	speed: 0.8894s/iter; left time: 9704.0776s
	iters: 200, epoch: 6 | loss: 0.2660471
	speed: 0.4015s/iter; left time: 4340.1593s
	iters: 300, epoch: 6 | loss: 0.2371998
	speed: 0.4016s/iter; left time: 4301.2451s
	iters: 400, epoch: 6 | loss: 0.2416075
	speed: 0.4023s/iter; left time: 4269.1886s
	iters: 500, epoch: 6 | loss: 0.2336295
	speed: 0.4021s/iter; left time: 4226.0144s
	iters: 600, epoch: 6 | loss: 0.2752854
	speed: 0.3983s/iter; left time: 4147.0571s
	iters: 700, epoch: 6 | loss: 0.2497057
	speed: 0.3962s/iter; left time: 4085.3646s
Epoch: 6 cost time: 293.8955571651459
Epoch: 6, Steps: 734 | Train Loss: 0.2540180 Vali Loss: 0.3709665 Test Loss: 0.4558574
Validation loss decreased (0.385954 --> 0.370966).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.2740871
	speed: 0.8891s/iter; left time: 9048.6896s
	iters: 200, epoch: 7 | loss: 0.2463191
	speed: 0.3993s/iter; left time: 4024.0890s
	iters: 300, epoch: 7 | loss: 0.2332218
	speed: 0.3946s/iter; left time: 3936.7831s
	iters: 400, epoch: 7 | loss: 0.2658041
	speed: 0.3962s/iter; left time: 3913.6403s
	iters: 500, epoch: 7 | loss: 0.2482630
	speed: 0.3994s/iter; left time: 3905.2788s
	iters: 600, epoch: 7 | loss: 0.2415809
	speed: 0.4037s/iter; left time: 3907.0519s
	iters: 700, epoch: 7 | loss: 0.2186449
	speed: 0.3986s/iter; left time: 3817.2256s
Epoch: 7 cost time: 292.6701753139496
Epoch: 7, Steps: 734 | Train Loss: 0.2466255 Vali Loss: 0.3625333 Test Loss: 0.4479381
Validation loss decreased (0.370966 --> 0.362533).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.2229234
	speed: 0.9058s/iter; left time: 8553.5201s
	iters: 200, epoch: 8 | loss: 0.2121951
	speed: 0.4011s/iter; left time: 3747.7262s
	iters: 300, epoch: 8 | loss: 0.2440538
	speed: 0.3966s/iter; left time: 3665.8147s
	iters: 400, epoch: 8 | loss: 0.2471533
	speed: 0.4005s/iter; left time: 3661.5944s
	iters: 500, epoch: 8 | loss: 0.2393948
	speed: 0.3967s/iter; left time: 3587.0547s
	iters: 600, epoch: 8 | loss: 0.2735297
	speed: 0.4048s/iter; left time: 3619.9448s
	iters: 700, epoch: 8 | loss: 0.2612962
	speed: 0.4030s/iter; left time: 3563.9023s
Epoch: 8 cost time: 294.78199315071106
Epoch: 8, Steps: 734 | Train Loss: 0.2425631 Vali Loss: 0.3591452 Test Loss: 0.4431557
Validation loss decreased (0.362533 --> 0.359145).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.2150016
	speed: 0.8959s/iter; left time: 7802.3346s
	iters: 200, epoch: 9 | loss: 0.2592441
	speed: 0.4058s/iter; left time: 3493.7760s
	iters: 300, epoch: 9 | loss: 0.2440243
	speed: 0.4005s/iter; left time: 3407.6923s
	iters: 400, epoch: 9 | loss: 0.2379532
	speed: 0.3958s/iter; left time: 3328.2867s
	iters: 500, epoch: 9 | loss: 0.2621358
	speed: 0.3955s/iter; left time: 3286.1033s
	iters: 600, epoch: 9 | loss: 0.2378264
	speed: 0.3979s/iter; left time: 3266.3412s
	iters: 700, epoch: 9 | loss: 0.2775353
	speed: 0.4013s/iter; left time: 3254.0183s
Epoch: 9 cost time: 294.54914236068726
Epoch: 9, Steps: 734 | Train Loss: 0.2402608 Vali Loss: 0.3571254 Test Loss: 0.4411164
Validation loss decreased (0.359145 --> 0.357125).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.2395960
	speed: 0.8997s/iter; left time: 7175.2104s
	iters: 200, epoch: 10 | loss: 0.2468258
	speed: 0.4099s/iter; left time: 3228.2053s
	iters: 300, epoch: 10 | loss: 0.2364846
	speed: 0.3952s/iter; left time: 3072.7371s
	iters: 400, epoch: 10 | loss: 0.2377167
	speed: 0.3935s/iter; left time: 3020.4205s
	iters: 500, epoch: 10 | loss: 0.2220217
	speed: 0.3967s/iter; left time: 3005.3729s
	iters: 600, epoch: 10 | loss: 0.2424583
	speed: 0.4009s/iter; left time: 2996.5098s
	iters: 700, epoch: 10 | loss: 0.2182907
	speed: 0.3974s/iter; left time: 2931.0139s
Epoch: 10 cost time: 292.9703760147095
Epoch: 10, Steps: 734 | Train Loss: 0.2390330 Vali Loss: 0.3565838 Test Loss: 0.4400168
Validation loss decreased (0.357125 --> 0.356584).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.2479545
	speed: 0.9019s/iter; left time: 6530.5915s
	iters: 200, epoch: 11 | loss: 0.2585562
	speed: 0.4019s/iter; left time: 2869.9327s
	iters: 300, epoch: 11 | loss: 0.2646589
	speed: 0.4016s/iter; left time: 2827.3217s
	iters: 400, epoch: 11 | loss: 0.2382082
	speed: 0.3929s/iter; left time: 2727.0997s
	iters: 500, epoch: 11 | loss: 0.2596631
	speed: 0.3972s/iter; left time: 2717.3913s
	iters: 600, epoch: 11 | loss: 0.2727479
	speed: 0.3997s/iter; left time: 2694.2349s
	iters: 700, epoch: 11 | loss: 0.2584401
	speed: 0.3949s/iter; left time: 2622.3847s
Epoch: 11 cost time: 292.7255575656891
Epoch: 11, Steps: 734 | Train Loss: 0.2383082 Vali Loss: 0.3555491 Test Loss: 0.4394887
Validation loss decreased (0.356584 --> 0.355549).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.2335650
	speed: 0.9050s/iter; left time: 5889.0558s
	iters: 200, epoch: 12 | loss: 0.2374835
	speed: 0.4023s/iter; left time: 2577.5279s
	iters: 300, epoch: 12 | loss: 0.2463706
	speed: 0.3968s/iter; left time: 2502.7453s
	iters: 400, epoch: 12 | loss: 0.2539224
	speed: 0.3993s/iter; left time: 2478.3624s
	iters: 500, epoch: 12 | loss: 0.2200959
	speed: 0.3954s/iter; left time: 2415.0085s
	iters: 600, epoch: 12 | loss: 0.2237585
	speed: 0.3929s/iter; left time: 2359.9256s
	iters: 700, epoch: 12 | loss: 0.2533746
	speed: 0.3992s/iter; left time: 2358.0139s
Epoch: 12 cost time: 292.7612693309784
Epoch: 12, Steps: 734 | Train Loss: 0.2380071 Vali Loss: 0.3561543 Test Loss: 0.4393088
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.2542076
	speed: 0.8206s/iter; left time: 4737.2498s
	iters: 200, epoch: 13 | loss: 0.2381961
	speed: 0.3979s/iter; left time: 2257.5360s
	iters: 300, epoch: 13 | loss: 0.2247121
	speed: 0.3950s/iter; left time: 2201.1178s
	iters: 400, epoch: 13 | loss: 0.2427375
	speed: 0.3956s/iter; left time: 2165.0468s
	iters: 500, epoch: 13 | loss: 0.2274011
	speed: 0.4044s/iter; left time: 2172.7663s
	iters: 600, epoch: 13 | loss: 0.2378524
	speed: 0.3996s/iter; left time: 2107.2690s
	iters: 700, epoch: 13 | loss: 0.2079377
	speed: 0.3958s/iter; left time: 2047.3175s
Epoch: 13 cost time: 292.11094665527344
Epoch: 13, Steps: 734 | Train Loss: 0.2377743 Vali Loss: 0.3558298 Test Loss: 0.4392303
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 14 | loss: 0.2314890
	speed: 0.8295s/iter; left time: 4180.0013s
	iters: 200, epoch: 14 | loss: 0.2758475
	speed: 0.3964s/iter; left time: 1957.7453s
	iters: 300, epoch: 14 | loss: 0.2241699
	speed: 0.3965s/iter; left time: 1918.4275s
	iters: 400, epoch: 14 | loss: 0.2487344
	speed: 0.3960s/iter; left time: 1876.4632s
	iters: 500, epoch: 14 | loss: 0.2450594
	speed: 0.3948s/iter; left time: 1831.2578s
	iters: 600, epoch: 14 | loss: 0.2344205
	speed: 0.3996s/iter; left time: 1813.6095s
	iters: 700, epoch: 14 | loss: 0.2323893
	speed: 0.3926s/iter; left time: 1742.7990s
Epoch: 14 cost time: 290.8289623260498
Epoch: 14, Steps: 734 | Train Loss: 0.2376719 Vali Loss: 0.3559204 Test Loss: 0.4392135
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 15 | loss: 0.2511884
	speed: 0.8230s/iter; left time: 3542.9900s
	iters: 200, epoch: 15 | loss: 0.2450770
	speed: 0.4004s/iter; left time: 1683.6178s
	iters: 300, epoch: 15 | loss: 0.2631149
	speed: 0.3954s/iter; left time: 1622.9636s
	iters: 400, epoch: 15 | loss: 0.2388404
	speed: 0.3980s/iter; left time: 1594.0679s
	iters: 500, epoch: 15 | loss: 0.2106251
	speed: 0.3965s/iter; left time: 1548.3386s
	iters: 600, epoch: 15 | loss: 0.2163070
	speed: 0.3960s/iter; left time: 1506.7414s
	iters: 700, epoch: 15 | loss: 0.2353154
	speed: 0.4064s/iter; left time: 1505.6308s
Epoch: 15 cost time: 292.40031003952026
Epoch: 15, Steps: 734 | Train Loss: 0.2376293 Vali Loss: 0.3556858 Test Loss: 0.4392156
EarlyStopping counter: 4 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 16 | loss: 0.2413562
	speed: 0.8151s/iter; left time: 2910.8746s
	iters: 200, epoch: 16 | loss: 0.2347290
	speed: 0.4048s/iter; left time: 1404.9042s
	iters: 300, epoch: 16 | loss: 0.2313438
	speed: 0.3964s/iter; left time: 1336.3726s
	iters: 400, epoch: 16 | loss: 0.2271987
	speed: 0.3979s/iter; left time: 1301.5707s
	iters: 500, epoch: 16 | loss: 0.2371890
	speed: 0.3995s/iter; left time: 1266.7791s
	iters: 600, epoch: 16 | loss: 0.2505300
	speed: 0.3977s/iter; left time: 1221.4365s
	iters: 700, epoch: 16 | loss: 0.2439678
	speed: 0.4033s/iter; left time: 1198.2907s
Epoch: 16 cost time: 293.1236786842346
Epoch: 16, Steps: 734 | Train Loss: 0.2375931 Vali Loss: 0.3554582 Test Loss: 0.4392113
Validation loss decreased (0.355549 --> 0.355458).  Saving model ...
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 17 | loss: 0.2695290
	speed: 0.8971s/iter; left time: 2545.1969s
	iters: 200, epoch: 17 | loss: 0.2275287
	speed: 0.4017s/iter; left time: 1099.4109s
	iters: 300, epoch: 17 | loss: 0.2349642
	speed: 0.4011s/iter; left time: 1057.7009s
	iters: 400, epoch: 17 | loss: 0.2163743
	speed: 0.3949s/iter; left time: 1001.9596s
	iters: 500, epoch: 17 | loss: 0.2338245
	speed: 0.4124s/iter; left time: 1005.0134s
	iters: 600, epoch: 17 | loss: 0.2559405
	speed: 0.3988s/iter; left time: 932.0545s
	iters: 700, epoch: 17 | loss: 0.2381822
	speed: 0.3948s/iter; left time: 883.2399s
Epoch: 17 cost time: 294.03773641586304
Epoch: 17, Steps: 734 | Train Loss: 0.2375658 Vali Loss: 0.3554425 Test Loss: 0.4392108
Validation loss decreased (0.355458 --> 0.355442).  Saving model ...
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 18 | loss: 0.2088251
	speed: 0.9012s/iter; left time: 1895.1519s
	iters: 200, epoch: 18 | loss: 0.2292414
	speed: 0.4051s/iter; left time: 811.3465s
	iters: 300, epoch: 18 | loss: 0.2187986
	speed: 0.4018s/iter; left time: 764.5774s
	iters: 400, epoch: 18 | loss: 0.2281795
	speed: 0.3954s/iter; left time: 712.8228s
	iters: 500, epoch: 18 | loss: 0.2606557
	speed: 0.3974s/iter; left time: 676.7774s
	iters: 600, epoch: 18 | loss: 0.2599284
	speed: 0.3990s/iter; left time: 639.5695s
	iters: 700, epoch: 18 | loss: 0.2332111
	speed: 0.3973s/iter; left time: 597.1106s
Epoch: 18 cost time: 293.34479904174805
Epoch: 18, Steps: 734 | Train Loss: 0.2375787 Vali Loss: 0.3554029 Test Loss: 0.4392099
Validation loss decreased (0.355442 --> 0.355403).  Saving model ...
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 19 | loss: 0.2418525
	speed: 0.9092s/iter; left time: 1244.6310s
	iters: 200, epoch: 19 | loss: 0.2234101
	speed: 0.4031s/iter; left time: 511.5586s
	iters: 300, epoch: 19 | loss: 0.2395594
	speed: 0.3947s/iter; left time: 461.4274s
	iters: 400, epoch: 19 | loss: 0.2299269
	speed: 0.3975s/iter; left time: 424.9023s
	iters: 500, epoch: 19 | loss: 0.2407202
	speed: 0.3952s/iter; left time: 382.9447s
	iters: 600, epoch: 19 | loss: 0.2578049
	speed: 0.3962s/iter; left time: 344.3273s
	iters: 700, epoch: 19 | loss: 0.2465101
	speed: 0.4124s/iter; left time: 317.1225s
Epoch: 19 cost time: 295.2148787975311
Epoch: 19, Steps: 734 | Train Loss: 0.2375396 Vali Loss: 0.3557824 Test Loss: 0.4392097
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 20 | loss: 0.2560731
	speed: 0.8205s/iter; left time: 521.0242s
	iters: 200, epoch: 20 | loss: 0.2428755
	speed: 0.4035s/iter; left time: 215.8623s
	iters: 300, epoch: 20 | loss: 0.2231511
	speed: 0.3925s/iter; left time: 170.7266s
	iters: 400, epoch: 20 | loss: 0.2385903
	speed: 0.3928s/iter; left time: 131.5926s
	iters: 500, epoch: 20 | loss: 0.2100994
	speed: 0.4021s/iter; left time: 94.4987s
	iters: 600, epoch: 20 | loss: 0.2316511
	speed: 0.3943s/iter; left time: 53.2355s
	iters: 700, epoch: 20 | loss: 0.2683436
	speed: 0.3958s/iter; left time: 13.8542s
Epoch: 20 cost time: 291.1380259990692
Epoch: 20, Steps: 734 | Train Loss: 0.2375459 Vali Loss: 0.3555710 Test Loss: 0.4392094
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.9073486328125e-08
>>>>>>>testing : traffic_336_192_DLinear_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3144<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3317
mse:0.4389035403728485, mae:0.3042837679386139
