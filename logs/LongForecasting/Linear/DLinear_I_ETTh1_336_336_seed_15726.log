Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTh1', data_path='ETTh1.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='DLinear', model_id='ETTh1_336_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=336, root_path='./dataset/', save_pred_values=False, seed=15726, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTh1_336_336_DLinear_ETTh1_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15726>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7969
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 0.5129222
	speed: 0.0170s/iter; left time: 83.2024s
	iters: 200, epoch: 1 | loss: 0.5475972
	speed: 0.0152s/iter; left time: 72.5401s
Epoch: 1 cost time: 4.050234079360962
Epoch: 1, Steps: 249 | Train Loss: 0.5589919 Vali Loss: 1.4260627 Test Loss: 0.5809180
Validation loss decreased (inf --> 1.426063).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.5189326
	speed: 0.0337s/iter; left time: 155.9459s
	iters: 200, epoch: 2 | loss: 0.5634270
	speed: 0.0184s/iter; left time: 83.3104s
Epoch: 2 cost time: 4.259577751159668
Epoch: 2, Steps: 249 | Train Loss: 0.5362832 Vali Loss: 1.5024873 Test Loss: 0.5391352
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.4855579
	speed: 0.0323s/iter; left time: 141.7851s
	iters: 200, epoch: 3 | loss: 0.5178108
	speed: 0.0166s/iter; left time: 71.0734s
Epoch: 3 cost time: 4.19974946975708
Epoch: 3, Steps: 249 | Train Loss: 0.4650975 Vali Loss: 1.2122408 Test Loss: 0.5044829
Validation loss decreased (1.426063 --> 1.212241).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.4344576
	speed: 0.0346s/iter; left time: 142.9762s
	iters: 200, epoch: 4 | loss: 0.4532119
	speed: 0.0174s/iter; left time: 70.1304s
Epoch: 4 cost time: 4.247751474380493
Epoch: 4, Steps: 249 | Train Loss: 0.4360777 Vali Loss: 1.2281674 Test Loss: 0.4538558
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.4258229
	speed: 0.0326s/iter; left time: 126.7559s
	iters: 200, epoch: 5 | loss: 0.4172335
	speed: 0.0173s/iter; left time: 65.3535s
Epoch: 5 cost time: 4.152568578720093
Epoch: 5, Steps: 249 | Train Loss: 0.4221919 Vali Loss: 1.1737380 Test Loss: 0.4520412
Validation loss decreased (1.212241 --> 1.173738).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.3514585
	speed: 0.0339s/iter; left time: 123.2721s
	iters: 200, epoch: 6 | loss: 0.4365097
	speed: 0.0159s/iter; left time: 56.3006s
Epoch: 6 cost time: 4.070743560791016
Epoch: 6, Steps: 249 | Train Loss: 0.4147879 Vali Loss: 1.1443405 Test Loss: 0.4515970
Validation loss decreased (1.173738 --> 1.144341).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.3929693
	speed: 0.0314s/iter; left time: 106.3336s
	iters: 200, epoch: 7 | loss: 0.4246871
	speed: 0.0178s/iter; left time: 58.5469s
Epoch: 7 cost time: 4.186190128326416
Epoch: 7, Steps: 249 | Train Loss: 0.4106864 Vali Loss: 1.1599211 Test Loss: 0.4455267
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.4155061
	speed: 0.0359s/iter; left time: 112.6003s
	iters: 200, epoch: 8 | loss: 0.4151242
	speed: 0.0168s/iter; left time: 51.1558s
Epoch: 8 cost time: 4.246393918991089
Epoch: 8, Steps: 249 | Train Loss: 0.4084616 Vali Loss: 1.1394274 Test Loss: 0.4447441
Validation loss decreased (1.144341 --> 1.139427).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.4138376
	speed: 0.0331s/iter; left time: 95.5589s
	iters: 200, epoch: 9 | loss: 0.4041909
	speed: 0.0172s/iter; left time: 48.0687s
Epoch: 9 cost time: 4.08138632774353
Epoch: 9, Steps: 249 | Train Loss: 0.4073127 Vali Loss: 1.1393601 Test Loss: 0.4441919
Validation loss decreased (1.139427 --> 1.139360).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.4017141
	speed: 0.0322s/iter; left time: 84.9166s
	iters: 200, epoch: 10 | loss: 0.3955780
	speed: 0.0156s/iter; left time: 39.5268s
Epoch: 10 cost time: 4.047875881195068
Epoch: 10, Steps: 249 | Train Loss: 0.4066747 Vali Loss: 1.1343719 Test Loss: 0.4462214
Validation loss decreased (1.139360 --> 1.134372).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.4638978
	speed: 0.0328s/iter; left time: 78.4066s
	iters: 200, epoch: 11 | loss: 0.4086028
	speed: 0.0153s/iter; left time: 35.1240s
Epoch: 11 cost time: 3.92170786857605
Epoch: 11, Steps: 249 | Train Loss: 0.4063395 Vali Loss: 1.1388786 Test Loss: 0.4455586
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.3752547
	speed: 0.0332s/iter; left time: 71.0326s
	iters: 200, epoch: 12 | loss: 0.4073402
	speed: 0.0152s/iter; left time: 31.0380s
Epoch: 12 cost time: 3.8319613933563232
Epoch: 12, Steps: 249 | Train Loss: 0.4061471 Vali Loss: 1.1376631 Test Loss: 0.4450752
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.4409029
	speed: 0.0311s/iter; left time: 58.8872s
	iters: 200, epoch: 13 | loss: 0.4500079
	speed: 0.0156s/iter; left time: 28.0583s
Epoch: 13 cost time: 3.7951924800872803
Epoch: 13, Steps: 249 | Train Loss: 0.4060471 Vali Loss: 1.1387589 Test Loss: 0.4452610
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.4150578
	speed: 0.0294s/iter; left time: 48.3405s
	iters: 200, epoch: 14 | loss: 0.4176526
	speed: 0.0126s/iter; left time: 19.3960s
Epoch: 14 cost time: 3.2026073932647705
Epoch: 14, Steps: 249 | Train Loss: 0.4060062 Vali Loss: 1.1374148 Test Loss: 0.4453174
EarlyStopping counter: 4 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.3840811
	speed: 0.0199s/iter; left time: 27.7961s
	iters: 200, epoch: 15 | loss: 0.3957427
	speed: 0.0132s/iter; left time: 17.0945s
Epoch: 15 cost time: 2.9605772495269775
Epoch: 15, Steps: 249 | Train Loss: 0.4059823 Vali Loss: 1.1359928 Test Loss: 0.4453513
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTh1_336_336_DLinear_ETTh1_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15726<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2545
mse:0.4457315504550934, mae:0.44129496812820435
