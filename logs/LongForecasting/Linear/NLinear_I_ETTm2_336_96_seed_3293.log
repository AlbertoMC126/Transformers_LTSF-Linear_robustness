Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='NLinear', model_id='ETTm2_336_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=3293, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTm2_336_96_NLinear_ETTm2_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3293>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34129
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.2510047
	speed: 0.0047s/iter; left time: 98.6904s
	iters: 200, epoch: 1 | loss: 0.3463125
	speed: 0.0053s/iter; left time: 111.9412s
	iters: 300, epoch: 1 | loss: 0.7507663
	speed: 0.0053s/iter; left time: 111.6618s
	iters: 400, epoch: 1 | loss: 0.4300117
	speed: 0.0051s/iter; left time: 106.5004s
	iters: 500, epoch: 1 | loss: 0.3756273
	speed: 0.0040s/iter; left time: 82.4506s
	iters: 600, epoch: 1 | loss: 0.2381050
	speed: 0.0041s/iter; left time: 84.1641s
	iters: 700, epoch: 1 | loss: 0.2894723
	speed: 0.0050s/iter; left time: 102.0863s
	iters: 800, epoch: 1 | loss: 0.5325322
	speed: 0.0049s/iter; left time: 100.8251s
	iters: 900, epoch: 1 | loss: 0.1680593
	speed: 0.0043s/iter; left time: 87.8101s
	iters: 1000, epoch: 1 | loss: 0.8831874
	speed: 0.0038s/iter; left time: 77.8829s
Epoch: 1 cost time: 4.93213415145874
Epoch: 1, Steps: 1066 | Train Loss: 0.5086287 Vali Loss: 0.2338161 Test Loss: 0.3219710
Validation loss decreased (inf --> 0.233816).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 1.2419593
	speed: 0.0176s/iter; left time: 354.7774s
	iters: 200, epoch: 2 | loss: 0.3476237
	speed: 0.0049s/iter; left time: 97.9221s
	iters: 300, epoch: 2 | loss: 0.2492546
	speed: 0.0053s/iter; left time: 105.1746s
	iters: 400, epoch: 2 | loss: 0.4767109
	speed: 0.0047s/iter; left time: 93.5719s
	iters: 500, epoch: 2 | loss: 0.3681051
	speed: 0.0044s/iter; left time: 86.3294s
	iters: 600, epoch: 2 | loss: 0.2425897
	speed: 0.0049s/iter; left time: 96.5596s
	iters: 700, epoch: 2 | loss: 0.2620885
	speed: 0.0054s/iter; left time: 105.0104s
	iters: 800, epoch: 2 | loss: 0.3200154
	speed: 0.0053s/iter; left time: 103.6175s
	iters: 900, epoch: 2 | loss: 0.4575921
	speed: 0.0043s/iter; left time: 83.4200s
	iters: 1000, epoch: 2 | loss: 0.3565623
	speed: 0.0044s/iter; left time: 84.3823s
Epoch: 2 cost time: 5.092712163925171
Epoch: 2, Steps: 1066 | Train Loss: 0.5369000 Vali Loss: 0.2516293 Test Loss: 0.3599318
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.5423627
	speed: 0.0239s/iter; left time: 456.0864s
	iters: 200, epoch: 3 | loss: 0.2128221
	speed: 0.0050s/iter; left time: 94.6021s
	iters: 300, epoch: 3 | loss: 0.1781633
	speed: 0.0049s/iter; left time: 93.1315s
	iters: 400, epoch: 3 | loss: 0.2078410
	speed: 0.0049s/iter; left time: 92.6877s
	iters: 500, epoch: 3 | loss: 0.3284555
	speed: 0.0047s/iter; left time: 87.4646s
	iters: 600, epoch: 3 | loss: 0.1377713
	speed: 0.0049s/iter; left time: 90.1927s
	iters: 700, epoch: 3 | loss: 0.2854783
	speed: 0.0041s/iter; left time: 75.8051s
	iters: 800, epoch: 3 | loss: 0.2290933
	speed: 0.0039s/iter; left time: 72.2685s
	iters: 900, epoch: 3 | loss: 0.3405790
	speed: 0.0042s/iter; left time: 75.9403s
	iters: 1000, epoch: 3 | loss: 0.3030607
	speed: 0.0044s/iter; left time: 80.3955s
Epoch: 3 cost time: 4.885145902633667
Epoch: 3, Steps: 1066 | Train Loss: 0.2705454 Vali Loss: 0.1566513 Test Loss: 0.2204835
Validation loss decreased (0.233816 --> 0.156651).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.1481667
	speed: 0.0212s/iter; left time: 382.1970s
	iters: 200, epoch: 4 | loss: 0.1160463
	speed: 0.0037s/iter; left time: 66.7106s
	iters: 300, epoch: 4 | loss: 0.1634833
	speed: 0.0036s/iter; left time: 64.3409s
	iters: 400, epoch: 4 | loss: 0.1394541
	speed: 0.0037s/iter; left time: 65.0862s
	iters: 500, epoch: 4 | loss: 0.2367211
	speed: 0.0045s/iter; left time: 78.7832s
	iters: 600, epoch: 4 | loss: 0.1792987
	speed: 0.0043s/iter; left time: 75.5241s
	iters: 700, epoch: 4 | loss: 0.2909675
	speed: 0.0039s/iter; left time: 67.6553s
	iters: 800, epoch: 4 | loss: 0.3096298
	speed: 0.0039s/iter; left time: 67.2220s
	iters: 900, epoch: 4 | loss: 0.1837488
	speed: 0.0039s/iter; left time: 67.5582s
	iters: 1000, epoch: 4 | loss: 0.1793741
	speed: 0.0038s/iter; left time: 65.9233s
Epoch: 4 cost time: 4.230153799057007
Epoch: 4, Steps: 1066 | Train Loss: 0.2344688 Vali Loss: 0.1260366 Test Loss: 0.1820467
Validation loss decreased (0.156651 --> 0.126037).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.1721412
	speed: 0.0215s/iter; left time: 364.6495s
	iters: 200, epoch: 5 | loss: 0.1510184
	speed: 0.0040s/iter; left time: 66.7538s
	iters: 300, epoch: 5 | loss: 0.2014900
	speed: 0.0042s/iter; left time: 70.5962s
	iters: 400, epoch: 5 | loss: 0.1739996
	speed: 0.0044s/iter; left time: 73.9658s
	iters: 500, epoch: 5 | loss: 0.1211288
	speed: 0.0040s/iter; left time: 66.0920s
	iters: 600, epoch: 5 | loss: 0.1312455
	speed: 0.0047s/iter; left time: 78.0063s
	iters: 700, epoch: 5 | loss: 0.2811576
	speed: 0.0047s/iter; left time: 77.2484s
	iters: 800, epoch: 5 | loss: 0.1593601
	speed: 0.0049s/iter; left time: 79.1717s
	iters: 900, epoch: 5 | loss: 0.3507079
	speed: 0.0045s/iter; left time: 72.9186s
	iters: 1000, epoch: 5 | loss: 0.1441555
	speed: 0.0051s/iter; left time: 82.2224s
Epoch: 5 cost time: 4.715170621871948
Epoch: 5, Steps: 1066 | Train Loss: 0.2224922 Vali Loss: 0.1194875 Test Loss: 0.1680354
Validation loss decreased (0.126037 --> 0.119488).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.2068018
	speed: 0.0194s/iter; left time: 308.3795s
	iters: 200, epoch: 6 | loss: 0.1926270
	speed: 0.0043s/iter; left time: 67.4766s
	iters: 300, epoch: 6 | loss: 0.1634217
	speed: 0.0041s/iter; left time: 64.0277s
	iters: 400, epoch: 6 | loss: 0.1775582
	speed: 0.0044s/iter; left time: 67.8209s
	iters: 500, epoch: 6 | loss: 0.0869858
	speed: 0.0043s/iter; left time: 65.8872s
	iters: 600, epoch: 6 | loss: 0.2202719
	speed: 0.0039s/iter; left time: 59.7258s
	iters: 700, epoch: 6 | loss: 0.2284643
	speed: 0.0045s/iter; left time: 68.9925s
	iters: 800, epoch: 6 | loss: 0.2221029
	speed: 0.0047s/iter; left time: 71.7015s
	iters: 900, epoch: 6 | loss: 0.3144991
	speed: 0.0044s/iter; left time: 65.8096s
	iters: 1000, epoch: 6 | loss: 0.1199658
	speed: 0.0042s/iter; left time: 63.4119s
Epoch: 6 cost time: 4.4580278396606445
Epoch: 6, Steps: 1066 | Train Loss: 0.2142584 Vali Loss: 0.1173573 Test Loss: 0.1670346
Validation loss decreased (0.119488 --> 0.117357).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.1237751
	speed: 0.0197s/iter; left time: 291.9925s
	iters: 200, epoch: 7 | loss: 0.1178458
	speed: 0.0046s/iter; left time: 67.5948s
	iters: 300, epoch: 7 | loss: 0.2972697
	speed: 0.0048s/iter; left time: 70.3781s
	iters: 400, epoch: 7 | loss: 0.1604568
	speed: 0.0046s/iter; left time: 66.2340s
	iters: 500, epoch: 7 | loss: 0.0927927
	speed: 0.0042s/iter; left time: 61.1999s
	iters: 600, epoch: 7 | loss: 0.2837910
	speed: 0.0048s/iter; left time: 68.6167s
	iters: 700, epoch: 7 | loss: 0.1484126
	speed: 0.0046s/iter; left time: 65.3543s
	iters: 800, epoch: 7 | loss: 0.3469500
	speed: 0.0044s/iter; left time: 62.0087s
	iters: 900, epoch: 7 | loss: 0.2255221
	speed: 0.0045s/iter; left time: 63.2899s
	iters: 1000, epoch: 7 | loss: 0.1048162
	speed: 0.0048s/iter; left time: 66.4225s
Epoch: 7 cost time: 4.921485662460327
Epoch: 7, Steps: 1066 | Train Loss: 0.2095838 Vali Loss: 0.1164985 Test Loss: 0.1648749
Validation loss decreased (0.117357 --> 0.116499).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.3009163
	speed: 0.0186s/iter; left time: 256.0081s
	iters: 200, epoch: 8 | loss: 0.1878619
	speed: 0.0053s/iter; left time: 72.1196s
	iters: 300, epoch: 8 | loss: 0.2203794
	speed: 0.0048s/iter; left time: 64.9804s
	iters: 400, epoch: 8 | loss: 0.2430959
	speed: 0.0042s/iter; left time: 55.8896s
	iters: 500, epoch: 8 | loss: 0.5207894
	speed: 0.0038s/iter; left time: 51.3489s
	iters: 600, epoch: 8 | loss: 0.1915174
	speed: 0.0033s/iter; left time: 44.2851s
	iters: 700, epoch: 8 | loss: 0.1379754
	speed: 0.0043s/iter; left time: 56.7192s
	iters: 800, epoch: 8 | loss: 0.1204421
	speed: 0.0045s/iter; left time: 59.0624s
	iters: 900, epoch: 8 | loss: 0.2097277
	speed: 0.0039s/iter; left time: 50.2809s
	iters: 1000, epoch: 8 | loss: 0.0922751
	speed: 0.0042s/iter; left time: 53.8750s
Epoch: 8 cost time: 4.5524232387542725
Epoch: 8, Steps: 1066 | Train Loss: 0.2072327 Vali Loss: 0.1156451 Test Loss: 0.1649925
Validation loss decreased (0.116499 --> 0.115645).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.1728624
	speed: 0.0187s/iter; left time: 237.1802s
	iters: 200, epoch: 9 | loss: 0.2301889
	speed: 0.0040s/iter; left time: 49.7426s
	iters: 300, epoch: 9 | loss: 0.1451938
	speed: 0.0045s/iter; left time: 56.0989s
	iters: 400, epoch: 9 | loss: 0.1479098
	speed: 0.0046s/iter; left time: 57.4200s
	iters: 500, epoch: 9 | loss: 0.2123065
	speed: 0.0049s/iter; left time: 59.8668s
	iters: 600, epoch: 9 | loss: 0.2286337
	speed: 0.0039s/iter; left time: 47.8025s
	iters: 700, epoch: 9 | loss: 0.1523815
	speed: 0.0045s/iter; left time: 54.6606s
	iters: 800, epoch: 9 | loss: 0.1254845
	speed: 0.0048s/iter; left time: 57.2331s
	iters: 900, epoch: 9 | loss: 0.1044809
	speed: 0.0050s/iter; left time: 59.4705s
	iters: 1000, epoch: 9 | loss: 0.2553939
	speed: 0.0050s/iter; left time: 58.9884s
Epoch: 9 cost time: 4.853205680847168
Epoch: 9, Steps: 1066 | Train Loss: 0.2058469 Vali Loss: 0.1153786 Test Loss: 0.1630336
Validation loss decreased (0.115645 --> 0.115379).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.1926633
	speed: 0.0198s/iter; left time: 230.1794s
	iters: 200, epoch: 10 | loss: 0.1441511
	speed: 0.0050s/iter; left time: 57.7501s
	iters: 300, epoch: 10 | loss: 0.1835549
	speed: 0.0046s/iter; left time: 52.8251s
	iters: 400, epoch: 10 | loss: 0.1259850
	speed: 0.0042s/iter; left time: 47.5733s
	iters: 500, epoch: 10 | loss: 0.3682220
	speed: 0.0045s/iter; left time: 50.5225s
	iters: 600, epoch: 10 | loss: 0.1548966
	speed: 0.0041s/iter; left time: 46.0658s
	iters: 700, epoch: 10 | loss: 0.4575161
	speed: 0.0038s/iter; left time: 41.6820s
	iters: 800, epoch: 10 | loss: 0.1348945
	speed: 0.0041s/iter; left time: 44.2960s
	iters: 900, epoch: 10 | loss: 0.2533225
	speed: 0.0047s/iter; left time: 50.4538s
	iters: 1000, epoch: 10 | loss: 0.2920679
	speed: 0.0043s/iter; left time: 45.9441s
Epoch: 10 cost time: 4.683941602706909
Epoch: 10, Steps: 1066 | Train Loss: 0.2051366 Vali Loss: 0.1154866 Test Loss: 0.1631813
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.2437852
	speed: 0.0191s/iter; left time: 202.0125s
	iters: 200, epoch: 11 | loss: 0.1072050
	speed: 0.0037s/iter; left time: 38.7056s
	iters: 300, epoch: 11 | loss: 0.2990962
	speed: 0.0042s/iter; left time: 43.2054s
	iters: 400, epoch: 11 | loss: 0.0967759
	speed: 0.0045s/iter; left time: 45.7907s
	iters: 500, epoch: 11 | loss: 0.2690181
	speed: 0.0037s/iter; left time: 37.6973s
	iters: 600, epoch: 11 | loss: 0.1132374
	speed: 0.0051s/iter; left time: 50.8359s
	iters: 700, epoch: 11 | loss: 0.1610390
	speed: 0.0043s/iter; left time: 42.6388s
	iters: 800, epoch: 11 | loss: 0.3702231
	speed: 0.0028s/iter; left time: 27.9066s
	iters: 900, epoch: 11 | loss: 0.1805557
	speed: 0.0034s/iter; left time: 33.2139s
	iters: 1000, epoch: 11 | loss: 0.1766178
	speed: 0.0037s/iter; left time: 36.2287s
Epoch: 11 cost time: 4.220935583114624
Epoch: 11, Steps: 1066 | Train Loss: 0.2047482 Vali Loss: 0.1155854 Test Loss: 0.1628912
EarlyStopping counter: 2 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.3526178
	speed: 0.0204s/iter; left time: 194.0194s
	iters: 200, epoch: 12 | loss: 0.2294180
	speed: 0.0046s/iter; left time: 42.8593s
	iters: 300, epoch: 12 | loss: 0.2240614
	speed: 0.0042s/iter; left time: 38.7602s
	iters: 400, epoch: 12 | loss: 0.2792645
	speed: 0.0037s/iter; left time: 33.5671s
	iters: 500, epoch: 12 | loss: 0.1425502
	speed: 0.0033s/iter; left time: 29.5914s
	iters: 600, epoch: 12 | loss: 0.1323277
	speed: 0.0042s/iter; left time: 37.5991s
	iters: 700, epoch: 12 | loss: 0.2280396
	speed: 0.0043s/iter; left time: 37.8716s
	iters: 800, epoch: 12 | loss: 0.1251222
	speed: 0.0039s/iter; left time: 34.6522s
	iters: 900, epoch: 12 | loss: 0.1287225
	speed: 0.0036s/iter; left time: 31.2151s
	iters: 1000, epoch: 12 | loss: 0.1149075
	speed: 0.0039s/iter; left time: 33.5628s
Epoch: 12 cost time: 4.2433764934539795
Epoch: 12, Steps: 1066 | Train Loss: 0.2046361 Vali Loss: 0.1154941 Test Loss: 0.1630437
EarlyStopping counter: 3 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.1642866
	speed: 0.0179s/iter; left time: 150.4791s
	iters: 200, epoch: 13 | loss: 0.2321058
	speed: 0.0044s/iter; left time: 36.2471s
	iters: 300, epoch: 13 | loss: 0.3314766
	speed: 0.0044s/iter; left time: 35.9606s
	iters: 400, epoch: 13 | loss: 0.1347331
	speed: 0.0044s/iter; left time: 35.9581s
	iters: 500, epoch: 13 | loss: 0.2080606
	speed: 0.0045s/iter; left time: 36.0502s
	iters: 600, epoch: 13 | loss: 0.0900391
	speed: 0.0050s/iter; left time: 39.9771s
	iters: 700, epoch: 13 | loss: 0.2251632
	speed: 0.0046s/iter; left time: 36.1738s
	iters: 800, epoch: 13 | loss: 0.1894191
	speed: 0.0040s/iter; left time: 30.5465s
	iters: 900, epoch: 13 | loss: 0.1136295
	speed: 0.0040s/iter; left time: 30.4397s
	iters: 1000, epoch: 13 | loss: 0.1578768
	speed: 0.0040s/iter; left time: 30.1195s
Epoch: 13 cost time: 4.6053783893585205
Epoch: 13, Steps: 1066 | Train Loss: 0.2045015 Vali Loss: 0.1155960 Test Loss: 0.1631724
EarlyStopping counter: 4 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 14 | loss: 0.1647728
	speed: 0.0187s/iter; left time: 137.3583s
	iters: 200, epoch: 14 | loss: 0.1776595
	speed: 0.0040s/iter; left time: 28.9934s
	iters: 300, epoch: 14 | loss: 0.2458610
	speed: 0.0045s/iter; left time: 31.9358s
	iters: 400, epoch: 14 | loss: 0.1904119
	speed: 0.0047s/iter; left time: 33.4230s
	iters: 500, epoch: 14 | loss: 0.2487510
	speed: 0.0050s/iter; left time: 34.7454s
	iters: 600, epoch: 14 | loss: 0.2299813
	speed: 0.0049s/iter; left time: 33.8345s
	iters: 700, epoch: 14 | loss: 0.1554997
	speed: 0.0048s/iter; left time: 32.2683s
	iters: 800, epoch: 14 | loss: 0.2703246
	speed: 0.0047s/iter; left time: 31.3946s
	iters: 900, epoch: 14 | loss: 0.2682733
	speed: 0.0046s/iter; left time: 30.1275s
	iters: 1000, epoch: 14 | loss: 0.3732090
	speed: 0.0045s/iter; left time: 28.9543s
Epoch: 14 cost time: 4.9018943309783936
Epoch: 14, Steps: 1066 | Train Loss: 0.2045030 Vali Loss: 0.1154294 Test Loss: 0.1628968
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTm2_336_96_NLinear_ETTm2_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3293<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.16325612366199493, mae:0.2513614296913147
