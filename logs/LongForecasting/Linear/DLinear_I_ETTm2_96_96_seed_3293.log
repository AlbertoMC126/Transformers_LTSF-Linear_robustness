Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='DLinear', model_id='ETTm2_96_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=3293, seq_len=96, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTm2_96_96_DLinear_ETTm2_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3293>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34369
data_set:  <data_provider.data_loader.Dataset_ETT_minute object at 0x000002AFF2D10550>
val 11425
data_set:  <data_provider.data_loader.Dataset_ETT_minute object at 0x000002AFC0317DD8>
test 11425
data_set:  <data_provider.data_loader.Dataset_ETT_minute object at 0x000002AFF2D10208>
Total number of trainable parameters: 130368
Total number of parameters: 130368
	iters: 100, epoch: 1 | loss: 0.7034131
	speed: 0.0050s/iter; left time: 106.5244s
	iters: 200, epoch: 1 | loss: 0.2561978
	speed: 0.0053s/iter; left time: 112.6208s
	iters: 300, epoch: 1 | loss: 0.2171259
	speed: 0.0046s/iter; left time: 97.6468s
	iters: 400, epoch: 1 | loss: 0.2405314
	speed: 0.0060s/iter; left time: 126.8559s
	iters: 500, epoch: 1 | loss: 0.4584799
	speed: 0.0045s/iter; left time: 94.8582s
	iters: 600, epoch: 1 | loss: 0.1830234
	speed: 0.0053s/iter; left time: 110.1301s
	iters: 700, epoch: 1 | loss: 0.2579281
	speed: 0.0054s/iter; left time: 112.0331s
	iters: 800, epoch: 1 | loss: 0.2145253
	speed: 0.0055s/iter; left time: 113.5366s
	iters: 900, epoch: 1 | loss: 0.1848021
	speed: 0.0050s/iter; left time: 103.1997s
	iters: 1000, epoch: 1 | loss: 0.1999934
	speed: 0.0057s/iter; left time: 117.5668s
Epoch: 1 cost time: 5.718044996261597
Epoch: 1, Steps: 1074 | Train Loss: 0.2790897 Vali Loss: 0.3145030 Test Loss: 0.5903826
Validation loss decreased (inf --> 0.314503).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.2062463
	speed: 0.0267s/iter; left time: 541.6301s
	iters: 200, epoch: 2 | loss: 0.1557858
	speed: 0.0051s/iter; left time: 103.5642s
	iters: 300, epoch: 2 | loss: 0.2354713
	speed: 0.0047s/iter; left time: 95.1780s
	iters: 400, epoch: 2 | loss: 0.3505837
	speed: 0.0052s/iter; left time: 103.5938s
	iters: 500, epoch: 2 | loss: 0.2863034
	speed: 0.0063s/iter; left time: 124.5161s
	iters: 600, epoch: 2 | loss: 0.3309137
	speed: 0.0064s/iter; left time: 125.8217s
	iters: 700, epoch: 2 | loss: 0.1608940
	speed: 0.0046s/iter; left time: 89.9720s
	iters: 800, epoch: 2 | loss: 0.2131045
	speed: 0.0053s/iter; left time: 104.7927s
	iters: 900, epoch: 2 | loss: 0.6808574
	speed: 0.0050s/iter; left time: 98.0727s
	iters: 1000, epoch: 2 | loss: 0.3625241
	speed: 0.0050s/iter; left time: 97.0081s
Epoch: 2 cost time: 5.621044158935547
Epoch: 2, Steps: 1074 | Train Loss: 0.2736703 Vali Loss: 0.2472691 Test Loss: 0.4659192
Validation loss decreased (0.314503 --> 0.247269).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.1645716
	speed: 0.0274s/iter; left time: 527.2536s
	iters: 200, epoch: 3 | loss: 0.1704217
	speed: 0.0060s/iter; left time: 115.2350s
	iters: 300, epoch: 3 | loss: 0.3789403
	speed: 0.0056s/iter; left time: 105.6993s
	iters: 400, epoch: 3 | loss: 0.1457248
	speed: 0.0050s/iter; left time: 95.4259s
	iters: 500, epoch: 3 | loss: 0.2995945
	speed: 0.0053s/iter; left time: 99.0610s
	iters: 600, epoch: 3 | loss: 0.1815090
	speed: 0.0053s/iter; left time: 99.4251s
	iters: 700, epoch: 3 | loss: 0.1771239
	speed: 0.0060s/iter; left time: 111.2262s
	iters: 800, epoch: 3 | loss: 0.1743630
	speed: 0.0054s/iter; left time: 99.4554s
	iters: 900, epoch: 3 | loss: 0.2738718
	speed: 0.0065s/iter; left time: 120.6300s
	iters: 1000, epoch: 3 | loss: 0.2965624
	speed: 0.0057s/iter; left time: 104.5380s
Epoch: 3 cost time: 6.075882434844971
Epoch: 3, Steps: 1074 | Train Loss: 0.2431952 Vali Loss: 0.2131661 Test Loss: 0.4356476
Validation loss decreased (0.247269 --> 0.213166).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.1599507
	speed: 0.0266s/iter; left time: 483.8095s
	iters: 200, epoch: 4 | loss: 0.1795762
	speed: 0.0051s/iter; left time: 91.9346s
	iters: 300, epoch: 4 | loss: 0.2427730
	speed: 0.0062s/iter; left time: 111.2584s
	iters: 400, epoch: 4 | loss: 0.4741336
	speed: 0.0043s/iter; left time: 76.6244s
	iters: 500, epoch: 4 | loss: 0.1206017
	speed: 0.0056s/iter; left time: 98.6467s
	iters: 600, epoch: 4 | loss: 0.3387209
	speed: 0.0060s/iter; left time: 106.5790s
	iters: 700, epoch: 4 | loss: 0.1947839
	speed: 0.0052s/iter; left time: 91.1245s
	iters: 800, epoch: 4 | loss: 0.2076564
	speed: 0.0044s/iter; left time: 77.1800s
	iters: 900, epoch: 4 | loss: 0.2108226
	speed: 0.0056s/iter; left time: 97.6557s
	iters: 1000, epoch: 4 | loss: 0.7165191
	speed: 0.0046s/iter; left time: 80.1598s
Epoch: 4 cost time: 5.646668910980225
Epoch: 4, Steps: 1074 | Train Loss: 0.2301977 Vali Loss: 0.1659803 Test Loss: 0.2945108
Validation loss decreased (0.213166 --> 0.165980).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.4379104
	speed: 0.0255s/iter; left time: 435.0645s
	iters: 200, epoch: 5 | loss: 0.1128454
	speed: 0.0053s/iter; left time: 90.6804s
	iters: 300, epoch: 5 | loss: 0.3954904
	speed: 0.0069s/iter; left time: 117.3124s
	iters: 400, epoch: 5 | loss: 0.1525542
	speed: 0.0045s/iter; left time: 75.9891s
	iters: 500, epoch: 5 | loss: 0.1402525
	speed: 0.0060s/iter; left time: 99.3373s
	iters: 600, epoch: 5 | loss: 0.2067083
	speed: 0.0046s/iter; left time: 76.5481s
	iters: 700, epoch: 5 | loss: 0.1540475
	speed: 0.0066s/iter; left time: 108.0124s
	iters: 800, epoch: 5 | loss: 0.1274654
	speed: 0.0053s/iter; left time: 86.2251s
	iters: 900, epoch: 5 | loss: 0.1316442
	speed: 0.0050s/iter; left time: 81.8559s
	iters: 1000, epoch: 5 | loss: 0.2195351
	speed: 0.0050s/iter; left time: 80.8176s
Epoch: 5 cost time: 5.8618128299713135
Epoch: 5, Steps: 1074 | Train Loss: 0.2238897 Vali Loss: 0.1383571 Test Loss: 0.2148580
Validation loss decreased (0.165980 --> 0.138357).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.2939820
	speed: 0.0289s/iter; left time: 462.0003s
	iters: 200, epoch: 6 | loss: 0.1260083
	speed: 0.0046s/iter; left time: 73.7204s
	iters: 300, epoch: 6 | loss: 0.3018076
	speed: 0.0051s/iter; left time: 79.9642s
	iters: 400, epoch: 6 | loss: 0.1315168
	speed: 0.0065s/iter; left time: 102.0678s
	iters: 500, epoch: 6 | loss: 0.1240152
	speed: 0.0060s/iter; left time: 93.7145s
	iters: 600, epoch: 6 | loss: 0.1705090
	speed: 0.0049s/iter; left time: 75.5050s
	iters: 700, epoch: 6 | loss: 0.1503642
	speed: 0.0051s/iter; left time: 79.2223s
	iters: 800, epoch: 6 | loss: 0.3702387
	speed: 0.0038s/iter; left time: 57.6648s
	iters: 900, epoch: 6 | loss: 0.2541501
	speed: 0.0053s/iter; left time: 81.1196s
	iters: 1000, epoch: 6 | loss: 0.2972832
	speed: 0.0050s/iter; left time: 75.2415s
Epoch: 6 cost time: 5.680030107498169
Epoch: 6, Steps: 1074 | Train Loss: 0.2201985 Vali Loss: 0.1515235 Test Loss: 0.2631230
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.1285757
	speed: 0.0248s/iter; left time: 370.6056s
	iters: 200, epoch: 7 | loss: 0.1414796
	speed: 0.0068s/iter; left time: 101.3299s
	iters: 300, epoch: 7 | loss: 0.1718701
	speed: 0.0059s/iter; left time: 87.5644s
	iters: 400, epoch: 7 | loss: 0.2318179
	speed: 0.0066s/iter; left time: 97.1600s
	iters: 500, epoch: 7 | loss: 0.2582925
	speed: 0.0060s/iter; left time: 86.9803s
	iters: 600, epoch: 7 | loss: 0.2003571
	speed: 0.0068s/iter; left time: 97.9142s
	iters: 700, epoch: 7 | loss: 0.2354516
	speed: 0.0054s/iter; left time: 77.4401s
	iters: 800, epoch: 7 | loss: 0.1052158
	speed: 0.0056s/iter; left time: 79.5837s
	iters: 900, epoch: 7 | loss: 0.1690768
	speed: 0.0047s/iter; left time: 66.0959s
	iters: 1000, epoch: 7 | loss: 0.3340678
	speed: 0.0058s/iter; left time: 81.8988s
Epoch: 7 cost time: 6.383347034454346
Epoch: 7, Steps: 1074 | Train Loss: 0.2186544 Vali Loss: 0.1798318 Test Loss: 0.3345473
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.1683775
	speed: 0.0242s/iter; left time: 335.6853s
	iters: 200, epoch: 8 | loss: 0.3591843
	speed: 0.0052s/iter; left time: 72.0779s
	iters: 300, epoch: 8 | loss: 0.2303919
	speed: 0.0051s/iter; left time: 69.4806s
	iters: 400, epoch: 8 | loss: 0.2282929
	speed: 0.0066s/iter; left time: 89.7284s
	iters: 500, epoch: 8 | loss: 0.1002331
	speed: 0.0050s/iter; left time: 67.1061s
	iters: 600, epoch: 8 | loss: 0.1461389
	speed: 0.0047s/iter; left time: 63.3706s
	iters: 700, epoch: 8 | loss: 0.2763829
	speed: 0.0044s/iter; left time: 58.9913s
	iters: 800, epoch: 8 | loss: 0.1985499
	speed: 0.0056s/iter; left time: 73.4995s
	iters: 900, epoch: 8 | loss: 0.3077687
	speed: 0.0058s/iter; left time: 75.5025s
	iters: 1000, epoch: 8 | loss: 0.1806774
	speed: 0.0052s/iter; left time: 67.1750s
Epoch: 8 cost time: 5.6623218059539795
Epoch: 8, Steps: 1074 | Train Loss: 0.2176127 Vali Loss: 0.1410409 Test Loss: 0.2264413
EarlyStopping counter: 3 out of 5
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.1864902
	speed: 0.0228s/iter; left time: 291.8440s
	iters: 200, epoch: 9 | loss: 0.1569419
	speed: 0.0053s/iter; left time: 66.7979s
	iters: 300, epoch: 9 | loss: 0.3413484
	speed: 0.0046s/iter; left time: 58.3467s
	iters: 400, epoch: 9 | loss: 0.4686902
	speed: 0.0041s/iter; left time: 51.6825s
	iters: 500, epoch: 9 | loss: 0.1189714
	speed: 0.0039s/iter; left time: 48.5868s
	iters: 600, epoch: 9 | loss: 0.2264577
	speed: 0.0061s/iter; left time: 75.1462s
	iters: 700, epoch: 9 | loss: 0.1597911
	speed: 0.0047s/iter; left time: 57.1592s
	iters: 800, epoch: 9 | loss: 0.3014746
	speed: 0.0051s/iter; left time: 62.0393s
	iters: 900, epoch: 9 | loss: 0.2448931
	speed: 0.0053s/iter; left time: 63.9511s
	iters: 1000, epoch: 9 | loss: 0.2281509
	speed: 0.0049s/iter; left time: 57.9949s
Epoch: 9 cost time: 5.226221561431885
Epoch: 9, Steps: 1074 | Train Loss: 0.2169293 Vali Loss: 0.1553417 Test Loss: 0.2676587
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.1333552
	speed: 0.0223s/iter; left time: 261.2966s
	iters: 200, epoch: 10 | loss: 0.1646192
	speed: 0.0056s/iter; left time: 65.3498s
	iters: 300, epoch: 10 | loss: 0.2614462
	speed: 0.0048s/iter; left time: 55.8022s
	iters: 400, epoch: 10 | loss: 0.1487834
	speed: 0.0051s/iter; left time: 58.4784s
	iters: 500, epoch: 10 | loss: 0.2525054
	speed: 0.0054s/iter; left time: 61.3368s
	iters: 600, epoch: 10 | loss: 0.3601668
	speed: 0.0050s/iter; left time: 56.1324s
	iters: 700, epoch: 10 | loss: 0.4584935
	speed: 0.0049s/iter; left time: 54.1278s
	iters: 800, epoch: 10 | loss: 0.2238502
	speed: 0.0052s/iter; left time: 57.0755s
	iters: 900, epoch: 10 | loss: 0.1185120
	speed: 0.0044s/iter; left time: 48.1041s
	iters: 1000, epoch: 10 | loss: 0.2293733
	speed: 0.0046s/iter; left time: 49.5052s
Epoch: 10 cost time: 5.3622145652771
Epoch: 10, Steps: 1074 | Train Loss: 0.2165957 Vali Loss: 0.1613428 Test Loss: 0.2879921
EarlyStopping counter: 5 out of 5
Early stopping
Total training time: 72.9087 seconds
>>>>>>>testing : ETTm2_96_96_DLinear_ETTm2_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3293<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
data_set:  <data_provider.data_loader.Dataset_ETT_minute object at 0x000002AFF2D03860>
mse:0.2153141349554062, mae:0.3020482063293457
