Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTh1', data_path='ETTh1.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='Linear', model_id='ETTh1_336_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=336, root_path='./dataset/', save_pred_values=False, seed=15349, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTh1_336_336_Linear_ETTh1_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15349>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7969
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 0.5069955
	speed: 0.0087s/iter; left time: 42.6394s
	iters: 200, epoch: 1 | loss: 0.4346413
	speed: 0.0091s/iter; left time: 43.3202s
Epoch: 1 cost time: 2.132887125015259
Epoch: 1, Steps: 249 | Train Loss: 0.5272449 Vali Loss: 1.2713059 Test Loss: 0.5316535
Validation loss decreased (inf --> 1.271306).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.5538428
	speed: 0.0152s/iter; left time: 70.6067s
	iters: 200, epoch: 2 | loss: 0.5440030
	speed: 0.0086s/iter; left time: 38.8052s
Epoch: 2 cost time: 2.0552327632904053
Epoch: 2, Steps: 249 | Train Loss: 0.5000444 Vali Loss: 1.2893356 Test Loss: 0.5227345
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.4295416
	speed: 0.0189s/iter; left time: 82.9061s
	iters: 200, epoch: 3 | loss: 0.4843394
	speed: 0.0089s/iter; left time: 38.1628s
Epoch: 3 cost time: 2.240386486053467
Epoch: 3, Steps: 249 | Train Loss: 0.4493862 Vali Loss: 1.2339801 Test Loss: 0.4743882
Validation loss decreased (1.271306 --> 1.233980).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.4506105
	speed: 0.0177s/iter; left time: 73.3469s
	iters: 200, epoch: 4 | loss: 0.3742585
	speed: 0.0089s/iter; left time: 36.0884s
Epoch: 4 cost time: 2.281094551086426
Epoch: 4, Steps: 249 | Train Loss: 0.4289874 Vali Loss: 1.2028501 Test Loss: 0.4550844
Validation loss decreased (1.233980 --> 1.202850).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.3999320
	speed: 0.0201s/iter; left time: 78.0528s
	iters: 200, epoch: 5 | loss: 0.4070522
	speed: 0.0087s/iter; left time: 32.9366s
Epoch: 5 cost time: 2.242572069168091
Epoch: 5, Steps: 249 | Train Loss: 0.4190310 Vali Loss: 1.1506931 Test Loss: 0.4557015
Validation loss decreased (1.202850 --> 1.150693).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.4334732
	speed: 0.0189s/iter; left time: 68.6260s
	iters: 200, epoch: 6 | loss: 0.3957018
	speed: 0.0083s/iter; left time: 29.3546s
Epoch: 6 cost time: 2.1937575340270996
Epoch: 6, Steps: 249 | Train Loss: 0.4140392 Vali Loss: 1.1666945 Test Loss: 0.4463246
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.4029466
	speed: 0.0158s/iter; left time: 53.4328s
	iters: 200, epoch: 7 | loss: 0.4189189
	speed: 0.0063s/iter; left time: 20.8473s
Epoch: 7 cost time: 1.674104928970337
Epoch: 7, Steps: 249 | Train Loss: 0.4110397 Vali Loss: 1.1421148 Test Loss: 0.4457880
Validation loss decreased (1.150693 --> 1.142115).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.4299034
	speed: 0.0164s/iter; left time: 51.4162s
	iters: 200, epoch: 8 | loss: 0.3996416
	speed: 0.0081s/iter; left time: 24.5755s
Epoch: 8 cost time: 2.064540386199951
Epoch: 8, Steps: 249 | Train Loss: 0.4093432 Vali Loss: 1.1367631 Test Loss: 0.4478063
Validation loss decreased (1.142115 --> 1.136763).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.4367093
	speed: 0.0164s/iter; left time: 47.2930s
	iters: 200, epoch: 9 | loss: 0.3656883
	speed: 0.0087s/iter; left time: 24.1816s
Epoch: 9 cost time: 2.0842432975769043
Epoch: 9, Steps: 249 | Train Loss: 0.4084202 Vali Loss: 1.1440939 Test Loss: 0.4454088
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.3875907
	speed: 0.0189s/iter; left time: 49.8877s
	iters: 200, epoch: 10 | loss: 0.4162682
	speed: 0.0090s/iter; left time: 22.9417s
Epoch: 10 cost time: 2.2858800888061523
Epoch: 10, Steps: 249 | Train Loss: 0.4080243 Vali Loss: 1.1347109 Test Loss: 0.4475435
Validation loss decreased (1.136763 --> 1.134711).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.3440665
	speed: 0.0184s/iter; left time: 44.0157s
	iters: 200, epoch: 11 | loss: 0.4331216
	speed: 0.0079s/iter; left time: 18.0718s
Epoch: 11 cost time: 2.023449182510376
Epoch: 11, Steps: 249 | Train Loss: 0.4077530 Vali Loss: 1.1403551 Test Loss: 0.4457961
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.3984161
	speed: 0.0157s/iter; left time: 33.6833s
	iters: 200, epoch: 12 | loss: 0.4519744
	speed: 0.0075s/iter; left time: 15.3856s
Epoch: 12 cost time: 1.8665266036987305
Epoch: 12, Steps: 249 | Train Loss: 0.4076533 Vali Loss: 1.1384505 Test Loss: 0.4459608
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.3929199
	speed: 0.0165s/iter; left time: 31.3126s
	iters: 200, epoch: 13 | loss: 0.3617256
	speed: 0.0081s/iter; left time: 14.5439s
Epoch: 13 cost time: 2.0723819732666016
Epoch: 13, Steps: 249 | Train Loss: 0.4075570 Vali Loss: 1.1363859 Test Loss: 0.4458634
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.4302856
	speed: 0.0149s/iter; left time: 24.4882s
	iters: 200, epoch: 14 | loss: 0.3606601
	speed: 0.0055s/iter; left time: 8.5390s
Epoch: 14 cost time: 1.51041579246521
Epoch: 14, Steps: 249 | Train Loss: 0.4075230 Vali Loss: 1.1396482 Test Loss: 0.4458565
EarlyStopping counter: 4 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.4074602
	speed: 0.0119s/iter; left time: 16.6020s
	iters: 200, epoch: 15 | loss: 0.4035939
	speed: 0.0062s/iter; left time: 7.9957s
Epoch: 15 cost time: 1.5032551288604736
Epoch: 15, Steps: 249 | Train Loss: 0.4075000 Vali Loss: 1.1382428 Test Loss: 0.4459350
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTh1_336_336_Linear_ETTh1_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15349<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2545
mse:0.4470835030078888, mae:0.4428323209285736
