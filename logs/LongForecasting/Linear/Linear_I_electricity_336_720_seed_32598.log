Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='Linear', model_id='Electricity_336_720', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=720, root_path='./dataset/', save_pred_values=False, seed=32598, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : Electricity_336_720_Linear_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed32598>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17357
val 1913
test 4541
	iters: 100, epoch: 1 | loss: 0.3057567
	speed: 0.1181s/iter; left time: 2548.2558s
	iters: 200, epoch: 1 | loss: 0.3011225
	speed: 0.0993s/iter; left time: 2134.0978s
	iters: 300, epoch: 1 | loss: 0.2909263
	speed: 0.0961s/iter; left time: 2055.1831s
	iters: 400, epoch: 1 | loss: 0.2861118
	speed: 0.0934s/iter; left time: 1988.5018s
	iters: 500, epoch: 1 | loss: 0.2884474
	speed: 0.0933s/iter; left time: 1977.1262s
	iters: 600, epoch: 1 | loss: 0.2704186
	speed: 0.0942s/iter; left time: 1984.9513s
	iters: 700, epoch: 1 | loss: 0.3188021
	speed: 0.0938s/iter; left time: 1967.7219s
	iters: 800, epoch: 1 | loss: 0.2748468
	speed: 0.0933s/iter; left time: 1948.4074s
	iters: 900, epoch: 1 | loss: 0.2956419
	speed: 0.0935s/iter; left time: 1942.2253s
	iters: 1000, epoch: 1 | loss: 0.2884259
	speed: 0.0941s/iter; left time: 1946.2378s
Epoch: 1 cost time: 104.95081424713135
Epoch: 1, Steps: 1084 | Train Loss: 0.2932118 Vali Loss: 0.2456290 Test Loss: 0.2805056
Validation loss decreased (inf --> 0.245629).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.2836979
	speed: 0.4024s/iter; left time: 8247.4301s
	iters: 200, epoch: 2 | loss: 0.3116442
	speed: 0.1016s/iter; left time: 2072.8732s
	iters: 300, epoch: 2 | loss: 0.2589715
	speed: 0.0951s/iter; left time: 1930.7938s
	iters: 400, epoch: 2 | loss: 0.2626340
	speed: 0.0961s/iter; left time: 1940.8698s
	iters: 500, epoch: 2 | loss: 0.3097689
	speed: 0.0960s/iter; left time: 1929.9466s
	iters: 600, epoch: 2 | loss: 0.3402835
	speed: 0.0969s/iter; left time: 1937.7294s
	iters: 700, epoch: 2 | loss: 0.2570619
	speed: 0.0962s/iter; left time: 1914.0806s
	iters: 800, epoch: 2 | loss: 0.2475322
	speed: 0.0962s/iter; left time: 1905.3511s
	iters: 900, epoch: 2 | loss: 0.2893747
	speed: 0.0961s/iter; left time: 1892.0877s
	iters: 1000, epoch: 2 | loss: 0.3126326
	speed: 0.0967s/iter; left time: 1894.1263s
Epoch: 2 cost time: 105.2144546508789
Epoch: 2, Steps: 1084 | Train Loss: 0.2848039 Vali Loss: 0.2510504 Test Loss: 0.2924044
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.2109145
	speed: 0.3814s/iter; left time: 7404.1465s
	iters: 200, epoch: 3 | loss: 0.2266369
	speed: 0.0964s/iter; left time: 1861.7100s
	iters: 300, epoch: 3 | loss: 0.2240553
	speed: 0.0966s/iter; left time: 1856.6786s
	iters: 400, epoch: 3 | loss: 0.2582417
	speed: 0.0953s/iter; left time: 1822.2826s
	iters: 500, epoch: 3 | loss: 0.2077942
	speed: 0.0952s/iter; left time: 1809.1324s
	iters: 600, epoch: 3 | loss: 0.2338896
	speed: 0.0964s/iter; left time: 1822.7233s
	iters: 700, epoch: 3 | loss: 0.2645760
	speed: 0.0959s/iter; left time: 1803.7328s
	iters: 800, epoch: 3 | loss: 0.2359051
	speed: 0.0956s/iter; left time: 1788.3419s
	iters: 900, epoch: 3 | loss: 0.3346862
	speed: 0.0958s/iter; left time: 1782.9828s
	iters: 1000, epoch: 3 | loss: 0.2423300
	speed: 0.0953s/iter; left time: 1763.8845s
Epoch: 3 cost time: 104.54415035247803
Epoch: 3, Steps: 1084 | Train Loss: 0.2356507 Vali Loss: 0.2014479 Test Loss: 0.2355321
Validation loss decreased (0.245629 --> 0.201448).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.2281117
	speed: 0.4028s/iter; left time: 7382.8312s
	iters: 200, epoch: 4 | loss: 0.2049038
	speed: 0.0947s/iter; left time: 1726.8651s
	iters: 300, epoch: 4 | loss: 0.2237171
	speed: 0.0949s/iter; left time: 1721.0716s
	iters: 400, epoch: 4 | loss: 0.2071518
	speed: 0.0951s/iter; left time: 1714.3876s
	iters: 500, epoch: 4 | loss: 0.2428914
	speed: 0.1008s/iter; left time: 1807.6352s
	iters: 600, epoch: 4 | loss: 0.1890054
	speed: 0.1071s/iter; left time: 1909.5865s
	iters: 700, epoch: 4 | loss: 0.2306280
	speed: 0.1075s/iter; left time: 1905.8125s
	iters: 800, epoch: 4 | loss: 0.2062524
	speed: 0.1072s/iter; left time: 1889.2880s
	iters: 900, epoch: 4 | loss: 0.2549154
	speed: 0.1091s/iter; left time: 1912.7484s
	iters: 1000, epoch: 4 | loss: 0.2318450
	speed: 0.1024s/iter; left time: 1785.1467s
Epoch: 4 cost time: 110.63583207130432
Epoch: 4, Steps: 1084 | Train Loss: 0.2161236 Vali Loss: 0.1961163 Test Loss: 0.2371301
Validation loss decreased (0.201448 --> 0.196116).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.2220686
	speed: 0.4020s/iter; left time: 6931.8720s
	iters: 200, epoch: 5 | loss: 0.1849107
	speed: 0.0949s/iter; left time: 1626.5761s
	iters: 300, epoch: 5 | loss: 0.1868360
	speed: 0.0960s/iter; left time: 1635.9745s
	iters: 400, epoch: 5 | loss: 0.1988209
	speed: 0.0955s/iter; left time: 1618.6823s
	iters: 500, epoch: 5 | loss: 0.2240842
	speed: 0.0965s/iter; left time: 1625.9646s
	iters: 600, epoch: 5 | loss: 0.1970263
	speed: 0.0962s/iter; left time: 1610.3469s
	iters: 700, epoch: 5 | loss: 0.1834692
	speed: 0.0960s/iter; left time: 1597.4818s
	iters: 800, epoch: 5 | loss: 0.2138776
	speed: 0.0953s/iter; left time: 1577.1973s
	iters: 900, epoch: 5 | loss: 0.2168014
	speed: 0.0952s/iter; left time: 1566.3719s
	iters: 1000, epoch: 5 | loss: 0.2382632
	speed: 0.0988s/iter; left time: 1615.4196s
Epoch: 5 cost time: 104.56758737564087
Epoch: 5, Steps: 1084 | Train Loss: 0.2065301 Vali Loss: 0.1770061 Test Loss: 0.2127625
Validation loss decreased (0.196116 --> 0.177006).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.2244702
	speed: 0.4019s/iter; left time: 6495.0487s
	iters: 200, epoch: 6 | loss: 0.2080700
	speed: 0.0951s/iter; left time: 1527.6930s
	iters: 300, epoch: 6 | loss: 0.1893719
	speed: 0.0958s/iter; left time: 1528.9583s
	iters: 400, epoch: 6 | loss: 0.2468878
	speed: 0.0961s/iter; left time: 1524.1881s
	iters: 500, epoch: 6 | loss: 0.2066345
	speed: 0.0963s/iter; left time: 1517.1687s
	iters: 600, epoch: 6 | loss: 0.1742389
	speed: 0.0953s/iter; left time: 1492.9323s
	iters: 700, epoch: 6 | loss: 0.1986197
	speed: 0.0953s/iter; left time: 1482.3530s
	iters: 800, epoch: 6 | loss: 0.1878874
	speed: 0.0958s/iter; left time: 1480.4186s
	iters: 900, epoch: 6 | loss: 0.1763027
	speed: 0.1009s/iter; left time: 1550.0366s
	iters: 1000, epoch: 6 | loss: 0.2050288
	speed: 0.1017s/iter; left time: 1552.3627s
Epoch: 6 cost time: 106.10380458831787
Epoch: 6, Steps: 1084 | Train Loss: 0.2012687 Vali Loss: 0.1718002 Test Loss: 0.2055393
Validation loss decreased (0.177006 --> 0.171800).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.1759498
	speed: 0.4018s/iter; left time: 6058.6847s
	iters: 200, epoch: 7 | loss: 0.1933616
	speed: 0.0959s/iter; left time: 1437.0212s
	iters: 300, epoch: 7 | loss: 0.2078083
	speed: 0.0956s/iter; left time: 1422.6261s
	iters: 400, epoch: 7 | loss: 0.1687962
	speed: 0.0947s/iter; left time: 1399.1039s
	iters: 500, epoch: 7 | loss: 0.1800309
	speed: 0.0951s/iter; left time: 1395.8645s
	iters: 600, epoch: 7 | loss: 0.2035104
	speed: 0.0941s/iter; left time: 1371.8397s
	iters: 700, epoch: 7 | loss: 0.2056547
	speed: 0.0947s/iter; left time: 1370.6989s
	iters: 800, epoch: 7 | loss: 0.2086052
	speed: 0.1001s/iter; left time: 1438.5635s
	iters: 900, epoch: 7 | loss: 0.1942518
	speed: 0.0998s/iter; left time: 1425.0019s
	iters: 1000, epoch: 7 | loss: 0.1891542
	speed: 0.1008s/iter; left time: 1429.3672s
Epoch: 7 cost time: 104.97005915641785
Epoch: 7, Steps: 1084 | Train Loss: 0.1983966 Vali Loss: 0.1717911 Test Loss: 0.2059307
Validation loss decreased (0.171800 --> 0.171791).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.2171175
	speed: 0.3959s/iter; left time: 5539.3102s
	iters: 200, epoch: 8 | loss: 0.1929552
	speed: 0.0973s/iter; left time: 1351.8413s
	iters: 300, epoch: 8 | loss: 0.1726555
	speed: 0.0954s/iter; left time: 1315.4941s
	iters: 400, epoch: 8 | loss: 0.1964807
	speed: 0.0950s/iter; left time: 1300.1944s
	iters: 500, epoch: 8 | loss: 0.1867405
	speed: 0.0967s/iter; left time: 1314.3366s
	iters: 600, epoch: 8 | loss: 0.1823222
	speed: 0.0963s/iter; left time: 1299.9085s
	iters: 700, epoch: 8 | loss: 0.2172914
	speed: 0.0980s/iter; left time: 1311.9844s
	iters: 800, epoch: 8 | loss: 0.1899943
	speed: 0.1009s/iter; left time: 1340.9795s
	iters: 900, epoch: 8 | loss: 0.2024183
	speed: 0.0998s/iter; left time: 1317.2413s
	iters: 1000, epoch: 8 | loss: 0.1971816
	speed: 0.0990s/iter; left time: 1296.2793s
Epoch: 8 cost time: 105.6856791973114
Epoch: 8, Steps: 1084 | Train Loss: 0.1969328 Vali Loss: 0.1695884 Test Loss: 0.2027620
Validation loss decreased (0.171791 --> 0.169588).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.2416613
	speed: 0.3953s/iter; left time: 5103.4605s
	iters: 200, epoch: 9 | loss: 0.2282879
	speed: 0.0961s/iter; left time: 1230.8435s
	iters: 300, epoch: 9 | loss: 0.2244964
	speed: 0.0956s/iter; left time: 1215.4986s
	iters: 400, epoch: 9 | loss: 0.2028913
	speed: 0.0962s/iter; left time: 1212.9343s
	iters: 500, epoch: 9 | loss: 0.1854440
	speed: 0.0970s/iter; left time: 1213.4608s
	iters: 600, epoch: 9 | loss: 0.1906888
	speed: 0.0954s/iter; left time: 1184.0542s
	iters: 700, epoch: 9 | loss: 0.2037439
	speed: 0.1012s/iter; left time: 1245.9732s
	iters: 800, epoch: 9 | loss: 0.2079963
	speed: 0.1038s/iter; left time: 1267.7163s
	iters: 900, epoch: 9 | loss: 0.1694571
	speed: 0.1013s/iter; left time: 1226.3529s
	iters: 1000, epoch: 9 | loss: 0.1793569
	speed: 0.0957s/iter; left time: 1148.6697s
Epoch: 9 cost time: 106.03268504142761
Epoch: 9, Steps: 1084 | Train Loss: 0.1960857 Vali Loss: 0.1687530 Test Loss: 0.2024862
Validation loss decreased (0.169588 --> 0.168753).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.1930447
	speed: 0.3914s/iter; left time: 4627.9216s
	iters: 200, epoch: 10 | loss: 0.1774031
	speed: 0.0954s/iter; left time: 1118.9656s
	iters: 300, epoch: 10 | loss: 0.2599163
	speed: 0.0960s/iter; left time: 1115.4207s
	iters: 400, epoch: 10 | loss: 0.1748591
	speed: 0.0967s/iter; left time: 1114.3655s
	iters: 500, epoch: 10 | loss: 0.2073664
	speed: 0.0943s/iter; left time: 1077.0711s
	iters: 600, epoch: 10 | loss: 0.1972212
	speed: 0.0989s/iter; left time: 1120.0059s
	iters: 700, epoch: 10 | loss: 0.1697606
	speed: 0.1011s/iter; left time: 1135.0964s
	iters: 800, epoch: 10 | loss: 0.1887723
	speed: 0.1038s/iter; left time: 1154.6854s
	iters: 900, epoch: 10 | loss: 0.2074534
	speed: 0.0952s/iter; left time: 1049.2111s
	iters: 1000, epoch: 10 | loss: 0.1830061
	speed: 0.0951s/iter; left time: 1038.5962s
Epoch: 10 cost time: 105.41957879066467
Epoch: 10, Steps: 1084 | Train Loss: 0.1956615 Vali Loss: 0.1680129 Test Loss: 0.2016490
Validation loss decreased (0.168753 --> 0.168013).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.1997912
	speed: 0.3963s/iter; left time: 4256.7332s
	iters: 200, epoch: 11 | loss: 0.1805307
	speed: 0.0959s/iter; left time: 1020.7445s
	iters: 300, epoch: 11 | loss: 0.1641024
	speed: 0.0963s/iter; left time: 1014.7105s
	iters: 400, epoch: 11 | loss: 0.2014555
	speed: 0.0960s/iter; left time: 1002.8246s
	iters: 500, epoch: 11 | loss: 0.2290930
	speed: 0.1011s/iter; left time: 1045.4214s
	iters: 600, epoch: 11 | loss: 0.2018857
	speed: 0.1027s/iter; left time: 1052.1473s
	iters: 700, epoch: 11 | loss: 0.2124476
	speed: 0.1006s/iter; left time: 1020.5784s
	iters: 800, epoch: 11 | loss: 0.1995273
	speed: 0.0966s/iter; left time: 970.3879s
	iters: 900, epoch: 11 | loss: 0.1762291
	speed: 0.0952s/iter; left time: 945.8887s
	iters: 1000, epoch: 11 | loss: 0.1871036
	speed: 0.0959s/iter; left time: 944.1948s
Epoch: 11 cost time: 105.8778600692749
Epoch: 11, Steps: 1084 | Train Loss: 0.1954382 Vali Loss: 0.1683008 Test Loss: 0.2020167
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.1994928
	speed: 0.3684s/iter; left time: 3558.0178s
	iters: 200, epoch: 12 | loss: 0.1657811
	speed: 0.0955s/iter; left time: 912.9651s
	iters: 300, epoch: 12 | loss: 0.2145388
	speed: 0.0952s/iter; left time: 900.4234s
	iters: 400, epoch: 12 | loss: 0.1688269
	speed: 0.0964s/iter; left time: 902.2671s
	iters: 500, epoch: 12 | loss: 0.1956296
	speed: 0.1017s/iter; left time: 941.8534s
	iters: 600, epoch: 12 | loss: 0.2033562
	speed: 0.1016s/iter; left time: 930.7204s
	iters: 700, epoch: 12 | loss: 0.1868637
	speed: 0.1013s/iter; left time: 917.5239s
	iters: 800, epoch: 12 | loss: 0.1697308
	speed: 0.0953s/iter; left time: 853.3766s
	iters: 900, epoch: 12 | loss: 0.1764137
	speed: 0.0955s/iter; left time: 845.4015s
	iters: 1000, epoch: 12 | loss: 0.2363477
	speed: 0.0959s/iter; left time: 839.9286s
Epoch: 12 cost time: 105.49593949317932
Epoch: 12, Steps: 1084 | Train Loss: 0.1953280 Vali Loss: 0.1681076 Test Loss: 0.2015170
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.1740302
	speed: 0.3671s/iter; left time: 3146.7352s
	iters: 200, epoch: 13 | loss: 0.1865318
	speed: 0.0949s/iter; left time: 804.1716s
	iters: 300, epoch: 13 | loss: 0.1753731
	speed: 0.0945s/iter; left time: 791.0114s
	iters: 400, epoch: 13 | loss: 0.1905750
	speed: 0.0967s/iter; left time: 799.8164s
	iters: 500, epoch: 13 | loss: 0.1766477
	speed: 0.1035s/iter; left time: 845.9777s
	iters: 600, epoch: 13 | loss: 0.2256261
	speed: 0.1000s/iter; left time: 807.2135s
	iters: 700, epoch: 13 | loss: 0.2307735
	speed: 0.0958s/iter; left time: 763.9619s
	iters: 800, epoch: 13 | loss: 0.1726293
	speed: 0.0954s/iter; left time: 750.8166s
	iters: 900, epoch: 13 | loss: 0.1825035
	speed: 0.0954s/iter; left time: 741.5057s
	iters: 1000, epoch: 13 | loss: 0.2151153
	speed: 0.0952s/iter; left time: 730.2685s
Epoch: 13 cost time: 104.72707009315491
Epoch: 13, Steps: 1084 | Train Loss: 0.1952555 Vali Loss: 0.1681819 Test Loss: 0.2015154
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.2114739
	speed: 0.3702s/iter; left time: 2772.3662s
	iters: 200, epoch: 14 | loss: 0.1911840
	speed: 0.0962s/iter; left time: 711.0956s
	iters: 300, epoch: 14 | loss: 0.2039520
	speed: 0.0970s/iter; left time: 707.0649s
	iters: 400, epoch: 14 | loss: 0.2011213
	speed: 0.1011s/iter; left time: 726.5270s
	iters: 500, epoch: 14 | loss: 0.2258362
	speed: 0.1024s/iter; left time: 726.0797s
	iters: 600, epoch: 14 | loss: 0.1895974
	speed: 0.0989s/iter; left time: 690.8778s
	iters: 700, epoch: 14 | loss: 0.1953463
	speed: 0.0961s/iter; left time: 662.0180s
	iters: 800, epoch: 14 | loss: 0.1742763
	speed: 0.0955s/iter; left time: 648.4059s
	iters: 900, epoch: 14 | loss: 0.1799020
	speed: 0.0960s/iter; left time: 642.3686s
	iters: 1000, epoch: 14 | loss: 0.2381281
	speed: 0.0957s/iter; left time: 630.6308s
Epoch: 14 cost time: 105.60790157318115
Epoch: 14, Steps: 1084 | Train Loss: 0.1952122 Vali Loss: 0.1681542 Test Loss: 0.2015202
EarlyStopping counter: 4 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.1974289
	speed: 0.3693s/iter; left time: 2365.4516s
	iters: 200, epoch: 15 | loss: 0.1695795
	speed: 0.0952s/iter; left time: 600.0741s
	iters: 300, epoch: 15 | loss: 0.1803111
	speed: 0.1011s/iter; left time: 627.1538s
	iters: 400, epoch: 15 | loss: 0.1755888
	speed: 0.1044s/iter; left time: 637.1384s
	iters: 500, epoch: 15 | loss: 0.1921604
	speed: 0.1022s/iter; left time: 613.6631s
	iters: 600, epoch: 15 | loss: 0.2119967
	speed: 0.0958s/iter; left time: 565.9921s
	iters: 700, epoch: 15 | loss: 0.2021330
	speed: 0.0946s/iter; left time: 549.2766s
	iters: 800, epoch: 15 | loss: 0.2038747
	speed: 0.0948s/iter; left time: 540.7466s
	iters: 900, epoch: 15 | loss: 0.2047925
	speed: 0.0950s/iter; left time: 532.6333s
	iters: 1000, epoch: 15 | loss: 0.2035269
	speed: 0.0947s/iter; left time: 521.4424s
Epoch: 15 cost time: 105.50987648963928
Epoch: 15, Steps: 1084 | Train Loss: 0.1951989 Vali Loss: 0.1681311 Test Loss: 0.2015258
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : Electricity_336_720_Linear_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed32598<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4541
mse:0.20155063271522522, mae:0.29792317748069763
