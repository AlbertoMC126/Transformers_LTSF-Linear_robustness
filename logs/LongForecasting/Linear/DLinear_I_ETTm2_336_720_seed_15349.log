Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='DLinear', model_id='ETTm2_336_720', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=720, root_path='./dataset/', save_pred_values=False, seed=15349, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTm2_336_720_DLinear_ETTm2_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15349>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33505
val 10801
test 10801
	iters: 100, epoch: 1 | loss: 0.6603736
	speed: 0.0353s/iter; left time: 736.2300s
	iters: 200, epoch: 1 | loss: 0.4387310
	speed: 0.0371s/iter; left time: 770.0450s
	iters: 300, epoch: 1 | loss: 0.8654993
	speed: 0.0389s/iter; left time: 802.6992s
	iters: 400, epoch: 1 | loss: 0.4991051
	speed: 0.0369s/iter; left time: 758.7843s
	iters: 500, epoch: 1 | loss: 1.1837251
	speed: 0.0372s/iter; left time: 760.0815s
	iters: 600, epoch: 1 | loss: 0.7769407
	speed: 0.0383s/iter; left time: 779.2587s
	iters: 700, epoch: 1 | loss: 1.2663137
	speed: 0.0363s/iter; left time: 735.5169s
	iters: 800, epoch: 1 | loss: 0.9044201
	speed: 0.0370s/iter; left time: 745.8287s
	iters: 900, epoch: 1 | loss: 0.8049586
	speed: 0.0348s/iter; left time: 697.7001s
	iters: 1000, epoch: 1 | loss: 0.6049560
	speed: 0.0357s/iter; left time: 711.6585s
Epoch: 1 cost time: 38.406978130340576
Epoch: 1, Steps: 1047 | Train Loss: 0.7719532 Vali Loss: 0.7749529 Test Loss: 1.6749051
Validation loss decreased (inf --> 0.774953).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.6635193
	speed: 0.1132s/iter; left time: 2241.0830s
	iters: 200, epoch: 2 | loss: 0.8646333
	speed: 0.0370s/iter; left time: 728.7222s
	iters: 300, epoch: 2 | loss: 0.9339933
	speed: 0.0371s/iter; left time: 726.7453s
	iters: 400, epoch: 2 | loss: 0.7586800
	speed: 0.0372s/iter; left time: 725.2610s
	iters: 500, epoch: 2 | loss: 0.7366768
	speed: 0.0376s/iter; left time: 729.2910s
	iters: 600, epoch: 2 | loss: 0.9815699
	speed: 0.0374s/iter; left time: 721.7975s
	iters: 700, epoch: 2 | loss: 0.5725616
	speed: 0.0372s/iter; left time: 714.8673s
	iters: 800, epoch: 2 | loss: 0.7513892
	speed: 0.0351s/iter; left time: 670.3209s
	iters: 900, epoch: 2 | loss: 0.6693879
	speed: 0.0386s/iter; left time: 732.9892s
	iters: 1000, epoch: 2 | loss: 0.7841351
	speed: 0.0380s/iter; left time: 718.8289s
Epoch: 2 cost time: 38.68912363052368
Epoch: 2, Steps: 1047 | Train Loss: 0.7924329 Vali Loss: 0.4938908 Test Loss: 0.8819830
Validation loss decreased (0.774953 --> 0.493891).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.4513189
	speed: 0.1126s/iter; left time: 2110.7643s
	iters: 200, epoch: 3 | loss: 0.8848550
	speed: 0.0337s/iter; left time: 628.1011s
	iters: 300, epoch: 3 | loss: 0.4609140
	speed: 0.0366s/iter; left time: 679.7216s
	iters: 400, epoch: 3 | loss: 0.4198648
	speed: 0.0350s/iter; left time: 646.3140s
	iters: 500, epoch: 3 | loss: 0.5359277
	speed: 0.0378s/iter; left time: 692.6673s
	iters: 600, epoch: 3 | loss: 0.4236267
	speed: 0.0354s/iter; left time: 645.8671s
	iters: 700, epoch: 3 | loss: 0.4279066
	speed: 0.0381s/iter; left time: 691.0116s
	iters: 800, epoch: 3 | loss: 0.5091395
	speed: 0.0351s/iter; left time: 633.6259s
	iters: 900, epoch: 3 | loss: 0.3465966
	speed: 0.0357s/iter; left time: 640.1505s
	iters: 1000, epoch: 3 | loss: 0.3251378
	speed: 0.0349s/iter; left time: 622.1165s
Epoch: 3 cost time: 37.44166421890259
Epoch: 3, Steps: 1047 | Train Loss: 0.5677428 Vali Loss: 0.7209299 Test Loss: 1.7607249
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.3996474
	speed: 0.1159s/iter; left time: 2052.3060s
	iters: 200, epoch: 4 | loss: 0.3737240
	speed: 0.0371s/iter; left time: 653.4528s
	iters: 300, epoch: 4 | loss: 0.5608274
	speed: 0.0354s/iter; left time: 620.1852s
	iters: 400, epoch: 4 | loss: 0.6272773
	speed: 0.0360s/iter; left time: 626.0699s
	iters: 500, epoch: 4 | loss: 0.3926624
	speed: 0.0377s/iter; left time: 652.2037s
	iters: 600, epoch: 4 | loss: 0.5013869
	speed: 0.0378s/iter; left time: 649.9484s
	iters: 700, epoch: 4 | loss: 0.6714369
	speed: 0.0354s/iter; left time: 606.1112s
	iters: 800, epoch: 4 | loss: 0.6622282
	speed: 0.0371s/iter; left time: 630.8444s
	iters: 900, epoch: 4 | loss: 0.4794894
	speed: 0.0369s/iter; left time: 623.9955s
	iters: 1000, epoch: 4 | loss: 0.7363642
	speed: 0.0370s/iter; left time: 621.8540s
Epoch: 4 cost time: 38.11926794052124
Epoch: 4, Steps: 1047 | Train Loss: 0.5125681 Vali Loss: 0.4595323 Test Loss: 0.9614196
Validation loss decreased (0.493891 --> 0.459532).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.5945992
	speed: 0.1166s/iter; left time: 1941.3869s
	iters: 200, epoch: 5 | loss: 0.4327952
	speed: 0.0366s/iter; left time: 606.3664s
	iters: 300, epoch: 5 | loss: 0.6956662
	speed: 0.0356s/iter; left time: 586.4011s
	iters: 400, epoch: 5 | loss: 0.4453409
	speed: 0.0375s/iter; left time: 613.8272s
	iters: 500, epoch: 5 | loss: 0.4177942
	speed: 0.0372s/iter; left time: 604.9212s
	iters: 600, epoch: 5 | loss: 0.3921857
	speed: 0.0373s/iter; left time: 603.0623s
	iters: 700, epoch: 5 | loss: 0.7972447
	speed: 0.0347s/iter; left time: 557.3347s
	iters: 800, epoch: 5 | loss: 0.8759655
	speed: 0.0380s/iter; left time: 606.3379s
	iters: 900, epoch: 5 | loss: 0.4850147
	speed: 0.0370s/iter; left time: 585.8059s
	iters: 1000, epoch: 5 | loss: 0.4339353
	speed: 0.0375s/iter; left time: 590.7052s
Epoch: 5 cost time: 38.29121804237366
Epoch: 5, Steps: 1047 | Train Loss: 0.4828528 Vali Loss: 0.4196593 Test Loss: 0.8123810
Validation loss decreased (0.459532 --> 0.419659).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.4239742
	speed: 0.1107s/iter; left time: 1727.4244s
	iters: 200, epoch: 6 | loss: 0.7620303
	speed: 0.0375s/iter; left time: 580.7653s
	iters: 300, epoch: 6 | loss: 0.6163663
	speed: 0.0369s/iter; left time: 568.1153s
	iters: 400, epoch: 6 | loss: 0.3574276
	speed: 0.0392s/iter; left time: 599.3500s
	iters: 500, epoch: 6 | loss: 0.4630356
	speed: 0.0363s/iter; left time: 551.7054s
	iters: 600, epoch: 6 | loss: 0.4286591
	speed: 0.0364s/iter; left time: 549.8489s
	iters: 700, epoch: 6 | loss: 0.6445929
	speed: 0.0351s/iter; left time: 526.5182s
	iters: 800, epoch: 6 | loss: 0.6583779
	speed: 0.0357s/iter; left time: 532.7103s
	iters: 900, epoch: 6 | loss: 0.3658654
	speed: 0.0388s/iter; left time: 574.1032s
	iters: 1000, epoch: 6 | loss: 0.6549707
	speed: 0.0367s/iter; left time: 539.1335s
Epoch: 6 cost time: 38.077465295791626
Epoch: 6, Steps: 1047 | Train Loss: 0.4683058 Vali Loss: 0.4139057 Test Loss: 0.7993892
Validation loss decreased (0.419659 --> 0.413906).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.4625165
	speed: 0.1134s/iter; left time: 1651.2661s
	iters: 200, epoch: 7 | loss: 0.8387817
	speed: 0.0374s/iter; left time: 540.0487s
	iters: 300, epoch: 7 | loss: 0.4042385
	speed: 0.0376s/iter; left time: 539.8594s
	iters: 400, epoch: 7 | loss: 0.6164547
	speed: 0.0391s/iter; left time: 556.9255s
	iters: 500, epoch: 7 | loss: 0.7786589
	speed: 0.0373s/iter; left time: 528.7663s
	iters: 600, epoch: 7 | loss: 0.2751105
	speed: 0.0360s/iter; left time: 505.5989s
	iters: 700, epoch: 7 | loss: 0.4251254
	speed: 0.0364s/iter; left time: 507.6982s
	iters: 800, epoch: 7 | loss: 0.3780317
	speed: 0.0369s/iter; left time: 511.7421s
	iters: 900, epoch: 7 | loss: 0.3562067
	speed: 0.0369s/iter; left time: 507.4187s
	iters: 1000, epoch: 7 | loss: 0.4124304
	speed: 0.0367s/iter; left time: 501.5325s
Epoch: 7 cost time: 38.31452679634094
Epoch: 7, Steps: 1047 | Train Loss: 0.4589370 Vali Loss: 0.3719278 Test Loss: 0.6998894
Validation loss decreased (0.413906 --> 0.371928).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.7364901
	speed: 0.1136s/iter; left time: 1535.1132s
	iters: 200, epoch: 8 | loss: 0.4536779
	speed: 0.0355s/iter; left time: 476.4867s
	iters: 300, epoch: 8 | loss: 0.3287975
	speed: 0.0363s/iter; left time: 483.1632s
	iters: 400, epoch: 8 | loss: 0.4303428
	speed: 0.0354s/iter; left time: 467.7547s
	iters: 500, epoch: 8 | loss: 0.4602465
	speed: 0.0357s/iter; left time: 467.5322s
	iters: 600, epoch: 8 | loss: 0.2190306
	speed: 0.0337s/iter; left time: 437.8938s
	iters: 700, epoch: 8 | loss: 0.5062222
	speed: 0.0379s/iter; left time: 489.9175s
	iters: 800, epoch: 8 | loss: 0.2523546
	speed: 0.0381s/iter; left time: 487.6167s
	iters: 900, epoch: 8 | loss: 0.2952001
	speed: 0.0365s/iter; left time: 463.5484s
	iters: 1000, epoch: 8 | loss: 0.2758755
	speed: 0.0344s/iter; left time: 434.1124s
Epoch: 8 cost time: 37.40044283866882
Epoch: 8, Steps: 1047 | Train Loss: 0.4542154 Vali Loss: 0.3867071 Test Loss: 0.7435950
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.2756754
	speed: 0.1164s/iter; left time: 1450.5946s
	iters: 200, epoch: 9 | loss: 0.5478840
	speed: 0.0347s/iter; left time: 429.0254s
	iters: 300, epoch: 9 | loss: 0.7953432
	speed: 0.0337s/iter; left time: 413.4476s
	iters: 400, epoch: 9 | loss: 0.3361498
	speed: 0.0371s/iter; left time: 450.7556s
	iters: 500, epoch: 9 | loss: 0.5746652
	speed: 0.0382s/iter; left time: 460.4829s
	iters: 600, epoch: 9 | loss: 0.4684206
	speed: 0.0363s/iter; left time: 434.7582s
	iters: 700, epoch: 9 | loss: 0.6518947
	speed: 0.0383s/iter; left time: 454.6106s
	iters: 800, epoch: 9 | loss: 0.3787872
	speed: 0.0331s/iter; left time: 389.8307s
	iters: 900, epoch: 9 | loss: 0.5685915
	speed: 0.0377s/iter; left time: 439.2457s
	iters: 1000, epoch: 9 | loss: 0.6040099
	speed: 0.0340s/iter; left time: 393.5776s
Epoch: 9 cost time: 37.08724236488342
Epoch: 9, Steps: 1047 | Train Loss: 0.4514667 Vali Loss: 0.3619964 Test Loss: 0.6747977
Validation loss decreased (0.371928 --> 0.361996).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.4936678
	speed: 0.1155s/iter; left time: 1318.3993s
	iters: 200, epoch: 10 | loss: 0.3766269
	speed: 0.0345s/iter; left time: 390.7798s
	iters: 300, epoch: 10 | loss: 0.3866724
	speed: 0.0353s/iter; left time: 396.1106s
	iters: 400, epoch: 10 | loss: 0.4211396
	speed: 0.0342s/iter; left time: 380.7230s
	iters: 500, epoch: 10 | loss: 0.6115555
	speed: 0.0358s/iter; left time: 394.3963s
	iters: 600, epoch: 10 | loss: 0.5101773
	speed: 0.0349s/iter; left time: 381.0674s
	iters: 700, epoch: 10 | loss: 0.3929303
	speed: 0.0377s/iter; left time: 408.3564s
	iters: 800, epoch: 10 | loss: 0.3171563
	speed: 0.0349s/iter; left time: 373.6704s
	iters: 900, epoch: 10 | loss: 0.5347115
	speed: 0.0351s/iter; left time: 372.2781s
	iters: 1000, epoch: 10 | loss: 0.5609585
	speed: 0.0351s/iter; left time: 369.1393s
Epoch: 10 cost time: 36.37614035606384
Epoch: 10, Steps: 1047 | Train Loss: 0.4503297 Vali Loss: 0.4186452 Test Loss: 0.8658978
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.5094394
	speed: 0.1099s/iter; left time: 1139.6666s
	iters: 200, epoch: 11 | loss: 0.4250851
	speed: 0.0324s/iter; left time: 333.1201s
	iters: 300, epoch: 11 | loss: 0.7748432
	speed: 0.0349s/iter; left time: 355.0180s
	iters: 400, epoch: 11 | loss: 0.3521635
	speed: 0.0362s/iter; left time: 364.6602s
	iters: 500, epoch: 11 | loss: 0.5047668
	speed: 0.0359s/iter; left time: 358.3733s
	iters: 600, epoch: 11 | loss: 0.2675498
	speed: 0.0352s/iter; left time: 347.4235s
	iters: 700, epoch: 11 | loss: 0.3917592
	speed: 0.0361s/iter; left time: 352.7350s
	iters: 800, epoch: 11 | loss: 0.5453022
	speed: 0.0356s/iter; left time: 344.6621s
	iters: 900, epoch: 11 | loss: 0.5363048
	speed: 0.0330s/iter; left time: 315.8948s
	iters: 1000, epoch: 11 | loss: 0.3223431
	speed: 0.0332s/iter; left time: 314.8743s
Epoch: 11 cost time: 35.60588359832764
Epoch: 11, Steps: 1047 | Train Loss: 0.4493728 Vali Loss: 0.4047149 Test Loss: 0.8163147
EarlyStopping counter: 2 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.3186647
	speed: 0.1030s/iter; left time: 960.0212s
	iters: 200, epoch: 12 | loss: 0.3564026
	speed: 0.0285s/iter; left time: 263.2361s
	iters: 300, epoch: 12 | loss: 0.7507962
	speed: 0.0333s/iter; left time: 303.5914s
	iters: 400, epoch: 12 | loss: 0.6471484
	speed: 0.0325s/iter; left time: 293.6538s
	iters: 500, epoch: 12 | loss: 0.2672980
	speed: 0.0306s/iter; left time: 272.6320s
	iters: 600, epoch: 12 | loss: 0.3641484
	speed: 0.0306s/iter; left time: 270.2734s
	iters: 700, epoch: 12 | loss: 0.5521395
	speed: 0.0301s/iter; left time: 262.3024s
	iters: 800, epoch: 12 | loss: 0.2785337
	speed: 0.0300s/iter; left time: 258.8387s
	iters: 900, epoch: 12 | loss: 0.3720740
	speed: 0.0299s/iter; left time: 254.4765s
	iters: 1000, epoch: 12 | loss: 0.7363194
	speed: 0.0302s/iter; left time: 254.7981s
Epoch: 12 cost time: 31.831425428390503
Epoch: 12, Steps: 1047 | Train Loss: 0.4489250 Vali Loss: 0.4093122 Test Loss: 0.8276232
EarlyStopping counter: 3 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.5775048
	speed: 0.1009s/iter; left time: 834.9013s
	iters: 200, epoch: 13 | loss: 0.3993293
	speed: 0.0262s/iter; left time: 214.1898s
	iters: 300, epoch: 13 | loss: 0.4891458
	speed: 0.0295s/iter; left time: 237.9095s
	iters: 400, epoch: 13 | loss: 0.6093350
	speed: 0.0287s/iter; left time: 228.7399s
	iters: 500, epoch: 13 | loss: 0.4659121
	speed: 0.0294s/iter; left time: 231.9441s
	iters: 600, epoch: 13 | loss: 0.4788242
	speed: 0.0283s/iter; left time: 219.9322s
	iters: 700, epoch: 13 | loss: 0.4646946
	speed: 0.0282s/iter; left time: 216.6411s
	iters: 800, epoch: 13 | loss: 0.4102921
	speed: 0.0287s/iter; left time: 217.6655s
	iters: 900, epoch: 13 | loss: 0.2842835
	speed: 0.0287s/iter; left time: 214.9007s
	iters: 1000, epoch: 13 | loss: 0.5253488
	speed: 0.0288s/iter; left time: 212.5453s
Epoch: 13 cost time: 29.547741651535034
Epoch: 13, Steps: 1047 | Train Loss: 0.4486574 Vali Loss: 0.4122538 Test Loss: 0.8362466
EarlyStopping counter: 4 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 14 | loss: 0.3525392
	speed: 0.0993s/iter; left time: 718.2316s
	iters: 200, epoch: 14 | loss: 0.3213688
	speed: 0.0264s/iter; left time: 187.9607s
	iters: 300, epoch: 14 | loss: 0.6619822
	speed: 0.0269s/iter; left time: 188.8791s
	iters: 400, epoch: 14 | loss: 0.6818510
	speed: 0.0272s/iter; left time: 188.6328s
	iters: 500, epoch: 14 | loss: 0.3144295
	speed: 0.0270s/iter; left time: 184.3849s
	iters: 600, epoch: 14 | loss: 0.5812541
	speed: 0.0272s/iter; left time: 182.7937s
	iters: 700, epoch: 14 | loss: 0.3540321
	speed: 0.0274s/iter; left time: 181.6786s
	iters: 800, epoch: 14 | loss: 0.4369695
	speed: 0.0270s/iter; left time: 175.9953s
	iters: 900, epoch: 14 | loss: 0.4387347
	speed: 0.0271s/iter; left time: 174.3771s
	iters: 1000, epoch: 14 | loss: 0.4977963
	speed: 0.0272s/iter; left time: 171.9786s
Epoch: 14 cost time: 28.13098692893982
Epoch: 14, Steps: 1047 | Train Loss: 0.4485334 Vali Loss: 0.4080176 Test Loss: 0.8245016
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTm2_336_720_DLinear_ETTm2_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15349<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10801
mse:0.6753749847412109, mae:0.5347656011581421
