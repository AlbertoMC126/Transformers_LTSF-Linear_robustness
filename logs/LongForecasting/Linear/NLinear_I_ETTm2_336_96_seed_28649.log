Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='NLinear', model_id='ETTm2_336_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=28649, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTm2_336_96_NLinear_ETTm2_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed28649>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34129
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.4734020
	speed: 0.0044s/iter; left time: 93.5509s
	iters: 200, epoch: 1 | loss: 0.4411350
	speed: 0.0045s/iter; left time: 95.7237s
	iters: 300, epoch: 1 | loss: 0.3789926
	speed: 0.0038s/iter; left time: 80.3001s
	iters: 400, epoch: 1 | loss: 0.1816673
	speed: 0.0036s/iter; left time: 75.1590s
	iters: 500, epoch: 1 | loss: 1.3163054
	speed: 0.0039s/iter; left time: 81.4102s
	iters: 600, epoch: 1 | loss: 0.3687707
	speed: 0.0042s/iter; left time: 87.0282s
	iters: 700, epoch: 1 | loss: 0.2444545
	speed: 0.0046s/iter; left time: 95.3051s
	iters: 800, epoch: 1 | loss: 0.2272966
	speed: 0.0041s/iter; left time: 83.3276s
	iters: 900, epoch: 1 | loss: 0.3027036
	speed: 0.0042s/iter; left time: 85.6305s
	iters: 1000, epoch: 1 | loss: 1.1385953
	speed: 0.0047s/iter; left time: 94.6960s
Epoch: 1 cost time: 4.467928886413574
Epoch: 1, Steps: 1066 | Train Loss: 0.4842045 Vali Loss: 0.3401507 Test Loss: 0.5025322
Validation loss decreased (inf --> 0.340151).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.5335990
	speed: 0.0187s/iter; left time: 376.5977s
	iters: 200, epoch: 2 | loss: 0.4863710
	speed: 0.0044s/iter; left time: 88.6968s
	iters: 300, epoch: 2 | loss: 0.6096992
	speed: 0.0042s/iter; left time: 83.2125s
	iters: 400, epoch: 2 | loss: 0.1562986
	speed: 0.0040s/iter; left time: 79.4317s
	iters: 500, epoch: 2 | loss: 0.2713687
	speed: 0.0043s/iter; left time: 85.7911s
	iters: 600, epoch: 2 | loss: 0.3202933
	speed: 0.0045s/iter; left time: 87.8579s
	iters: 700, epoch: 2 | loss: 0.6505390
	speed: 0.0049s/iter; left time: 94.8951s
	iters: 800, epoch: 2 | loss: 0.7045215
	speed: 0.0054s/iter; left time: 104.4735s
	iters: 900, epoch: 2 | loss: 1.6234717
	speed: 0.0049s/iter; left time: 94.5574s
	iters: 1000, epoch: 2 | loss: 0.3354864
	speed: 0.0049s/iter; left time: 94.9383s
Epoch: 2 cost time: 4.975772380828857
Epoch: 2, Steps: 1066 | Train Loss: 0.5687568 Vali Loss: 0.1647763 Test Loss: 0.2378633
Validation loss decreased (0.340151 --> 0.164776).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.4272260
	speed: 0.0231s/iter; left time: 441.0516s
	iters: 200, epoch: 3 | loss: 0.1256380
	speed: 0.0042s/iter; left time: 79.1838s
	iters: 300, epoch: 3 | loss: 0.2390682
	speed: 0.0038s/iter; left time: 71.2116s
	iters: 400, epoch: 3 | loss: 0.2894726
	speed: 0.0039s/iter; left time: 73.6890s
	iters: 500, epoch: 3 | loss: 0.4207193
	speed: 0.0038s/iter; left time: 71.0269s
	iters: 600, epoch: 3 | loss: 0.3660017
	speed: 0.0045s/iter; left time: 83.5220s
	iters: 700, epoch: 3 | loss: 0.2341982
	speed: 0.0045s/iter; left time: 84.1249s
	iters: 800, epoch: 3 | loss: 0.2507885
	speed: 0.0048s/iter; left time: 88.2760s
	iters: 900, epoch: 3 | loss: 0.8129153
	speed: 0.0042s/iter; left time: 75.9259s
	iters: 1000, epoch: 3 | loss: 0.5274326
	speed: 0.0038s/iter; left time: 68.9366s
Epoch: 3 cost time: 4.517148494720459
Epoch: 3, Steps: 1066 | Train Loss: 0.2652675 Vali Loss: 0.1512065 Test Loss: 0.2107688
Validation loss decreased (0.164776 --> 0.151206).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.1757477
	speed: 0.0198s/iter; left time: 357.2586s
	iters: 200, epoch: 4 | loss: 0.1403136
	speed: 0.0046s/iter; left time: 83.2608s
	iters: 300, epoch: 4 | loss: 0.4284246
	speed: 0.0044s/iter; left time: 78.5995s
	iters: 400, epoch: 4 | loss: 0.2889984
	speed: 0.0038s/iter; left time: 67.3920s
	iters: 500, epoch: 4 | loss: 0.2260893
	speed: 0.0043s/iter; left time: 75.2503s
	iters: 600, epoch: 4 | loss: 0.3493761
	speed: 0.0047s/iter; left time: 81.8324s
	iters: 700, epoch: 4 | loss: 0.1680194
	speed: 0.0050s/iter; left time: 87.3394s
	iters: 800, epoch: 4 | loss: 0.1566054
	speed: 0.0047s/iter; left time: 81.7648s
	iters: 900, epoch: 4 | loss: 0.1307123
	speed: 0.0044s/iter; left time: 75.3183s
	iters: 1000, epoch: 4 | loss: 0.3613079
	speed: 0.0048s/iter; left time: 82.7125s
Epoch: 4 cost time: 4.818536758422852
Epoch: 4, Steps: 1066 | Train Loss: 0.2382189 Vali Loss: 0.1333766 Test Loss: 0.1880263
Validation loss decreased (0.151206 --> 0.133377).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.3340115
	speed: 0.0191s/iter; left time: 323.7895s
	iters: 200, epoch: 5 | loss: 0.2038281
	speed: 0.0039s/iter; left time: 66.4528s
	iters: 300, epoch: 5 | loss: 0.2958680
	speed: 0.0045s/iter; left time: 75.0714s
	iters: 400, epoch: 5 | loss: 0.2383044
	speed: 0.0043s/iter; left time: 72.3408s
	iters: 500, epoch: 5 | loss: 0.4939412
	speed: 0.0042s/iter; left time: 70.3671s
	iters: 600, epoch: 5 | loss: 0.1552568
	speed: 0.0046s/iter; left time: 76.2044s
	iters: 700, epoch: 5 | loss: 0.1840024
	speed: 0.0042s/iter; left time: 68.4015s
	iters: 800, epoch: 5 | loss: 0.4070618
	speed: 0.0049s/iter; left time: 79.8220s
	iters: 900, epoch: 5 | loss: 0.2049398
	speed: 0.0051s/iter; left time: 82.6053s
	iters: 1000, epoch: 5 | loss: 0.2558787
	speed: 0.0046s/iter; left time: 73.8622s
Epoch: 5 cost time: 4.746320962905884
Epoch: 5, Steps: 1066 | Train Loss: 0.2229584 Vali Loss: 0.1315128 Test Loss: 0.1891410
Validation loss decreased (0.133377 --> 0.131513).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.3054979
	speed: 0.0191s/iter; left time: 303.4751s
	iters: 200, epoch: 6 | loss: 0.1475374
	speed: 0.0039s/iter; left time: 62.0966s
	iters: 300, epoch: 6 | loss: 0.2355649
	speed: 0.0039s/iter; left time: 61.8225s
	iters: 400, epoch: 6 | loss: 0.1581629
	speed: 0.0040s/iter; left time: 62.8317s
	iters: 500, epoch: 6 | loss: 0.2856769
	speed: 0.0041s/iter; left time: 64.1893s
	iters: 600, epoch: 6 | loss: 0.1637376
	speed: 0.0045s/iter; left time: 68.6437s
	iters: 700, epoch: 6 | loss: 0.2814148
	speed: 0.0041s/iter; left time: 61.9782s
	iters: 800, epoch: 6 | loss: 0.2487857
	speed: 0.0041s/iter; left time: 61.5326s
	iters: 900, epoch: 6 | loss: 0.1813916
	speed: 0.0042s/iter; left time: 62.9294s
	iters: 1000, epoch: 6 | loss: 0.2687741
	speed: 0.0042s/iter; left time: 62.6919s
Epoch: 6 cost time: 4.445183515548706
Epoch: 6, Steps: 1066 | Train Loss: 0.2135729 Vali Loss: 0.1183162 Test Loss: 0.1661757
Validation loss decreased (0.131513 --> 0.118316).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.1609885
	speed: 0.0194s/iter; left time: 287.9704s
	iters: 200, epoch: 7 | loss: 0.1797960
	speed: 0.0045s/iter; left time: 66.8515s
	iters: 300, epoch: 7 | loss: 0.3658011
	speed: 0.0041s/iter; left time: 60.1405s
	iters: 400, epoch: 7 | loss: 0.1554423
	speed: 0.0045s/iter; left time: 65.8049s
	iters: 500, epoch: 7 | loss: 0.2364018
	speed: 0.0042s/iter; left time: 60.1836s
	iters: 600, epoch: 7 | loss: 0.1285654
	speed: 0.0039s/iter; left time: 56.5837s
	iters: 700, epoch: 7 | loss: 0.2644169
	speed: 0.0038s/iter; left time: 53.6283s
	iters: 800, epoch: 7 | loss: 0.1521743
	speed: 0.0041s/iter; left time: 57.5259s
	iters: 900, epoch: 7 | loss: 0.2237010
	speed: 0.0040s/iter; left time: 55.8195s
	iters: 1000, epoch: 7 | loss: 0.1281242
	speed: 0.0038s/iter; left time: 53.5319s
Epoch: 7 cost time: 4.379554271697998
Epoch: 7, Steps: 1066 | Train Loss: 0.2099784 Vali Loss: 0.1167369 Test Loss: 0.1665055
Validation loss decreased (0.118316 --> 0.116737).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.1784274
	speed: 0.0190s/iter; left time: 260.7760s
	iters: 200, epoch: 8 | loss: 0.2036680
	speed: 0.0049s/iter; left time: 66.5659s
	iters: 300, epoch: 8 | loss: 0.1745476
	speed: 0.0049s/iter; left time: 66.4391s
	iters: 400, epoch: 8 | loss: 0.2172755
	speed: 0.0048s/iter; left time: 64.5056s
	iters: 500, epoch: 8 | loss: 0.2874437
	speed: 0.0054s/iter; left time: 71.6043s
	iters: 600, epoch: 8 | loss: 0.1611080
	speed: 0.0052s/iter; left time: 68.3160s
	iters: 700, epoch: 8 | loss: 0.1564009
	speed: 0.0053s/iter; left time: 69.6449s
	iters: 800, epoch: 8 | loss: 0.1651811
	speed: 0.0047s/iter; left time: 61.8183s
	iters: 900, epoch: 8 | loss: 0.1537544
	speed: 0.0044s/iter; left time: 56.3755s
	iters: 1000, epoch: 8 | loss: 0.1556322
	speed: 0.0045s/iter; left time: 57.9008s
Epoch: 8 cost time: 5.196842908859253
Epoch: 8, Steps: 1066 | Train Loss: 0.2072638 Vali Loss: 0.1162490 Test Loss: 0.1631873
Validation loss decreased (0.116737 --> 0.116249).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.2038811
	speed: 0.0225s/iter; left time: 286.1304s
	iters: 200, epoch: 9 | loss: 0.1733416
	speed: 0.0045s/iter; left time: 56.9606s
	iters: 300, epoch: 9 | loss: 0.1293785
	speed: 0.0041s/iter; left time: 51.7211s
	iters: 400, epoch: 9 | loss: 0.4750507
	speed: 0.0043s/iter; left time: 53.2955s
	iters: 500, epoch: 9 | loss: 0.1428406
	speed: 0.0040s/iter; left time: 48.7202s
	iters: 600, epoch: 9 | loss: 0.1912195
	speed: 0.0044s/iter; left time: 53.8931s
	iters: 700, epoch: 9 | loss: 0.2201986
	speed: 0.0044s/iter; left time: 53.7202s
	iters: 800, epoch: 9 | loss: 0.3296597
	speed: 0.0053s/iter; left time: 63.4220s
	iters: 900, epoch: 9 | loss: 0.1591628
	speed: 0.0053s/iter; left time: 63.5347s
	iters: 1000, epoch: 9 | loss: 0.1115217
	speed: 0.0048s/iter; left time: 56.1400s
Epoch: 9 cost time: 4.886255502700806
Epoch: 9, Steps: 1066 | Train Loss: 0.2061859 Vali Loss: 0.1155103 Test Loss: 0.1626334
Validation loss decreased (0.116249 --> 0.115510).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.1920571
	speed: 0.0212s/iter; left time: 246.7807s
	iters: 200, epoch: 10 | loss: 0.1372355
	speed: 0.0046s/iter; left time: 53.5333s
	iters: 300, epoch: 10 | loss: 0.2373837
	speed: 0.0045s/iter; left time: 51.0786s
	iters: 400, epoch: 10 | loss: 0.1231501
	speed: 0.0048s/iter; left time: 54.1751s
	iters: 500, epoch: 10 | loss: 0.2419477
	speed: 0.0040s/iter; left time: 45.2448s
	iters: 600, epoch: 10 | loss: 0.1943701
	speed: 0.0034s/iter; left time: 37.4788s
	iters: 700, epoch: 10 | loss: 0.2419578
	speed: 0.0044s/iter; left time: 48.6490s
	iters: 800, epoch: 10 | loss: 0.1996902
	speed: 0.0048s/iter; left time: 52.2311s
	iters: 900, epoch: 10 | loss: 0.1142893
	speed: 0.0047s/iter; left time: 50.9280s
	iters: 1000, epoch: 10 | loss: 0.1388140
	speed: 0.0047s/iter; left time: 50.3096s
Epoch: 10 cost time: 4.713677883148193
Epoch: 10, Steps: 1066 | Train Loss: 0.2052813 Vali Loss: 0.1159447 Test Loss: 0.1636042
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.1723170
	speed: 0.0208s/iter; left time: 219.5575s
	iters: 200, epoch: 11 | loss: 0.1815547
	speed: 0.0045s/iter; left time: 46.9881s
	iters: 300, epoch: 11 | loss: 0.1074767
	speed: 0.0045s/iter; left time: 46.7280s
	iters: 400, epoch: 11 | loss: 0.2222014
	speed: 0.0046s/iter; left time: 46.8168s
	iters: 500, epoch: 11 | loss: 0.1726977
	speed: 0.0041s/iter; left time: 41.1521s
	iters: 600, epoch: 11 | loss: 0.1512686
	speed: 0.0043s/iter; left time: 42.9883s
	iters: 700, epoch: 11 | loss: 0.1408671
	speed: 0.0036s/iter; left time: 35.6604s
	iters: 800, epoch: 11 | loss: 0.1239280
	speed: 0.0037s/iter; left time: 36.3928s
	iters: 900, epoch: 11 | loss: 0.1899376
	speed: 0.0038s/iter; left time: 36.7279s
	iters: 1000, epoch: 11 | loss: 0.1446982
	speed: 0.0039s/iter; left time: 38.0644s
Epoch: 11 cost time: 4.443934917449951
Epoch: 11, Steps: 1066 | Train Loss: 0.2048950 Vali Loss: 0.1154980 Test Loss: 0.1629441
Validation loss decreased (0.115510 --> 0.115498).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.2080483
	speed: 0.0199s/iter; left time: 188.9871s
	iters: 200, epoch: 12 | loss: 0.1508279
	speed: 0.0047s/iter; left time: 44.3625s
	iters: 300, epoch: 12 | loss: 0.1853240
	speed: 0.0039s/iter; left time: 36.5293s
	iters: 400, epoch: 12 | loss: 0.1545232
	speed: 0.0042s/iter; left time: 38.5326s
	iters: 500, epoch: 12 | loss: 0.1396437
	speed: 0.0047s/iter; left time: 42.7791s
	iters: 600, epoch: 12 | loss: 0.3206796
	speed: 0.0052s/iter; left time: 46.5940s
	iters: 700, epoch: 12 | loss: 0.1406158
	speed: 0.0047s/iter; left time: 41.5185s
	iters: 800, epoch: 12 | loss: 0.1765757
	speed: 0.0049s/iter; left time: 42.8316s
	iters: 900, epoch: 12 | loss: 0.4745447
	speed: 0.0047s/iter; left time: 41.0830s
	iters: 1000, epoch: 12 | loss: 0.2645156
	speed: 0.0052s/iter; left time: 44.8659s
Epoch: 12 cost time: 5.007892370223999
Epoch: 12, Steps: 1066 | Train Loss: 0.2046432 Vali Loss: 0.1155782 Test Loss: 0.1632090
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.0978923
	speed: 0.0183s/iter; left time: 154.2042s
	iters: 200, epoch: 13 | loss: 0.2152717
	speed: 0.0043s/iter; left time: 35.5934s
	iters: 300, epoch: 13 | loss: 0.2006426
	speed: 0.0040s/iter; left time: 32.9160s
	iters: 400, epoch: 13 | loss: 0.1780610
	speed: 0.0042s/iter; left time: 34.0604s
	iters: 500, epoch: 13 | loss: 0.1934303
	speed: 0.0037s/iter; left time: 30.0435s
	iters: 600, epoch: 13 | loss: 0.3730501
	speed: 0.0044s/iter; left time: 34.8914s
	iters: 700, epoch: 13 | loss: 0.2523537
	speed: 0.0045s/iter; left time: 35.5609s
	iters: 800, epoch: 13 | loss: 0.2980137
	speed: 0.0045s/iter; left time: 34.6258s
	iters: 900, epoch: 13 | loss: 0.0942274
	speed: 0.0046s/iter; left time: 35.1949s
	iters: 1000, epoch: 13 | loss: 0.1837173
	speed: 0.0047s/iter; left time: 35.0851s
Epoch: 13 cost time: 4.571127653121948
Epoch: 13, Steps: 1066 | Train Loss: 0.2045180 Vali Loss: 0.1156738 Test Loss: 0.1633918
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 14 | loss: 0.3207050
	speed: 0.0207s/iter; left time: 152.2870s
	iters: 200, epoch: 14 | loss: 0.1630980
	speed: 0.0051s/iter; left time: 37.2748s
	iters: 300, epoch: 14 | loss: 0.1675049
	speed: 0.0053s/iter; left time: 37.8207s
	iters: 400, epoch: 14 | loss: 0.1746432
	speed: 0.0049s/iter; left time: 34.4764s
	iters: 500, epoch: 14 | loss: 0.1083861
	speed: 0.0044s/iter; left time: 30.9853s
	iters: 600, epoch: 14 | loss: 0.2027326
	speed: 0.0041s/iter; left time: 28.3441s
	iters: 700, epoch: 14 | loss: 0.1757228
	speed: 0.0039s/iter; left time: 26.3236s
	iters: 800, epoch: 14 | loss: 0.2548819
	speed: 0.0040s/iter; left time: 26.3855s
	iters: 900, epoch: 14 | loss: 0.2181701
	speed: 0.0040s/iter; left time: 26.0083s
	iters: 1000, epoch: 14 | loss: 0.1366118
	speed: 0.0044s/iter; left time: 28.1678s
Epoch: 14 cost time: 4.761531352996826
Epoch: 14, Steps: 1066 | Train Loss: 0.2044834 Vali Loss: 0.1155536 Test Loss: 0.1631252
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 15 | loss: 0.1773624
	speed: 0.0207s/iter; left time: 130.2503s
	iters: 200, epoch: 15 | loss: 0.1539864
	speed: 0.0048s/iter; left time: 29.4549s
	iters: 300, epoch: 15 | loss: 0.1439240
	speed: 0.0046s/iter; left time: 27.9244s
	iters: 400, epoch: 15 | loss: 0.1613813
	speed: 0.0044s/iter; left time: 26.6380s
	iters: 500, epoch: 15 | loss: 0.2304914
	speed: 0.0045s/iter; left time: 26.2417s
	iters: 600, epoch: 15 | loss: 0.1708808
	speed: 0.0046s/iter; left time: 26.8880s
	iters: 700, epoch: 15 | loss: 0.1107870
	speed: 0.0046s/iter; left time: 26.3312s
	iters: 800, epoch: 15 | loss: 0.2084645
	speed: 0.0043s/iter; left time: 24.0671s
	iters: 900, epoch: 15 | loss: 0.1967934
	speed: 0.0042s/iter; left time: 23.3084s
	iters: 1000, epoch: 15 | loss: 0.2322321
	speed: 0.0043s/iter; left time: 23.3690s
Epoch: 15 cost time: 4.863542079925537
Epoch: 15, Steps: 1066 | Train Loss: 0.2044378 Vali Loss: 0.1154577 Test Loss: 0.1629575
Validation loss decreased (0.115498 --> 0.115458).  Saving model ...
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 16 | loss: 0.1139018
	speed: 0.0204s/iter; left time: 106.6853s
	iters: 200, epoch: 16 | loss: 0.1774715
	speed: 0.0044s/iter; left time: 22.6373s
	iters: 300, epoch: 16 | loss: 0.1448254
	speed: 0.0044s/iter; left time: 22.2873s
	iters: 400, epoch: 16 | loss: 0.1002447
	speed: 0.0049s/iter; left time: 24.0266s
	iters: 500, epoch: 16 | loss: 0.1887735
	speed: 0.0051s/iter; left time: 24.8314s
	iters: 600, epoch: 16 | loss: 0.2026590
	speed: 0.0051s/iter; left time: 23.9017s
	iters: 700, epoch: 16 | loss: 0.2126065
	speed: 0.0039s/iter; left time: 18.0059s
	iters: 800, epoch: 16 | loss: 0.2047407
	speed: 0.0038s/iter; left time: 17.0819s
	iters: 900, epoch: 16 | loss: 0.1967753
	speed: 0.0040s/iter; left time: 17.6886s
	iters: 1000, epoch: 16 | loss: 0.2118511
	speed: 0.0046s/iter; left time: 20.0958s
Epoch: 16 cost time: 4.755876302719116
Epoch: 16, Steps: 1066 | Train Loss: 0.2044725 Vali Loss: 0.1154514 Test Loss: 0.1629472
Validation loss decreased (0.115458 --> 0.115451).  Saving model ...
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 17 | loss: 0.2415621
	speed: 0.0224s/iter; left time: 93.2779s
	iters: 200, epoch: 17 | loss: 0.4708634
	speed: 0.0047s/iter; left time: 19.1528s
	iters: 300, epoch: 17 | loss: 0.1193983
	speed: 0.0051s/iter; left time: 20.0647s
	iters: 400, epoch: 17 | loss: 0.1984624
	speed: 0.0043s/iter; left time: 16.4387s
	iters: 500, epoch: 17 | loss: 0.1068411
	speed: 0.0040s/iter; left time: 14.8718s
	iters: 600, epoch: 17 | loss: 0.0986261
	speed: 0.0039s/iter; left time: 14.3762s
	iters: 700, epoch: 17 | loss: 0.1425865
	speed: 0.0039s/iter; left time: 13.9748s
	iters: 800, epoch: 17 | loss: 0.1113491
	speed: 0.0043s/iter; left time: 15.0727s
	iters: 900, epoch: 17 | loss: 0.5146272
	speed: 0.0040s/iter; left time: 13.3376s
	iters: 1000, epoch: 17 | loss: 0.2306850
	speed: 0.0039s/iter; left time: 12.6682s
Epoch: 17 cost time: 4.525481700897217
Epoch: 17, Steps: 1066 | Train Loss: 0.2043801 Vali Loss: 0.1154504 Test Loss: 0.1629442
Validation loss decreased (0.115451 --> 0.115450).  Saving model ...
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 18 | loss: 0.1316952
	speed: 0.0179s/iter; left time: 55.3971s
	iters: 200, epoch: 18 | loss: 0.2210712
	speed: 0.0044s/iter; left time: 13.2034s
	iters: 300, epoch: 18 | loss: 0.1233277
	speed: 0.0040s/iter; left time: 11.5670s
	iters: 400, epoch: 18 | loss: 0.2379973
	speed: 0.0046s/iter; left time: 12.9314s
	iters: 500, epoch: 18 | loss: 0.1241069
	speed: 0.0045s/iter; left time: 12.0454s
	iters: 600, epoch: 18 | loss: 0.2713061
	speed: 0.0051s/iter; left time: 13.1471s
	iters: 700, epoch: 18 | loss: 0.1699562
	speed: 0.0050s/iter; left time: 12.6092s
	iters: 800, epoch: 18 | loss: 0.4603253
	speed: 0.0050s/iter; left time: 12.0909s
	iters: 900, epoch: 18 | loss: 0.1815748
	speed: 0.0052s/iter; left time: 11.9123s
	iters: 1000, epoch: 18 | loss: 0.3331551
	speed: 0.0037s/iter; left time: 8.2242s
Epoch: 18 cost time: 4.795124053955078
Epoch: 18, Steps: 1066 | Train Loss: 0.2044098 Vali Loss: 0.1154519 Test Loss: 0.1629429
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 19 | loss: 0.1202234
	speed: 0.0160s/iter; left time: 32.4373s
	iters: 200, epoch: 19 | loss: 0.1596946
	speed: 0.0036s/iter; left time: 6.9360s
	iters: 300, epoch: 19 | loss: 0.1412921
	speed: 0.0037s/iter; left time: 6.7302s
	iters: 400, epoch: 19 | loss: 0.1437703
	speed: 0.0042s/iter; left time: 7.3652s
	iters: 500, epoch: 19 | loss: 0.1186378
	speed: 0.0042s/iter; left time: 6.8723s
	iters: 600, epoch: 19 | loss: 0.1918634
	speed: 0.0039s/iter; left time: 5.9374s
	iters: 700, epoch: 19 | loss: 0.1457601
	speed: 0.0039s/iter; left time: 5.6174s
	iters: 800, epoch: 19 | loss: 0.1836967
	speed: 0.0039s/iter; left time: 5.1481s
	iters: 900, epoch: 19 | loss: 0.2276079
	speed: 0.0039s/iter; left time: 4.7476s
	iters: 1000, epoch: 19 | loss: 0.2707090
	speed: 0.0038s/iter; left time: 4.2714s
Epoch: 19 cost time: 4.096799612045288
Epoch: 19, Steps: 1066 | Train Loss: 0.2044570 Vali Loss: 0.1154468 Test Loss: 0.1629435
Validation loss decreased (0.115450 --> 0.115447).  Saving model ...
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 20 | loss: 0.1303497
	speed: 0.0123s/iter; left time: 11.9361s
	iters: 200, epoch: 20 | loss: 0.1103087
	speed: 0.0028s/iter; left time: 2.4276s
	iters: 300, epoch: 20 | loss: 0.2128876
	speed: 0.0027s/iter; left time: 2.0939s
	iters: 400, epoch: 20 | loss: 0.1040372
	speed: 0.0027s/iter; left time: 1.8009s
	iters: 500, epoch: 20 | loss: 0.1396555
	speed: 0.0027s/iter; left time: 1.5554s
	iters: 600, epoch: 20 | loss: 0.3407756
	speed: 0.0027s/iter; left time: 1.2656s
	iters: 700, epoch: 20 | loss: 0.1916761
	speed: 0.0029s/iter; left time: 1.0533s
	iters: 800, epoch: 20 | loss: 0.4701596
	speed: 0.0027s/iter; left time: 0.7182s
	iters: 900, epoch: 20 | loss: 0.1745549
	speed: 0.0027s/iter; left time: 0.4533s
	iters: 1000, epoch: 20 | loss: 0.1729841
	speed: 0.0026s/iter; left time: 0.1775s
Epoch: 20 cost time: 2.955936908721924
Epoch: 20, Steps: 1066 | Train Loss: 0.2044336 Vali Loss: 0.1154534 Test Loss: 0.1629428
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.9073486328125e-08
>>>>>>>testing : ETTm2_336_96_NLinear_ETTm2_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed28649<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.16318702697753906, mae:0.25107914209365845
