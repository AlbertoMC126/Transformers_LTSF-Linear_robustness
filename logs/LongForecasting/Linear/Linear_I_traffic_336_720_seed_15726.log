Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='Linear', model_id='traffic_336_720', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=720, root_path='./dataset/', save_pred_values=False, seed=15726, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_336_720_Linear_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15726>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11225
val 1037
test 2789
	iters: 100, epoch: 1 | loss: 0.4736598
	speed: 0.3434s/iter; left time: 4780.9973s
	iters: 200, epoch: 1 | loss: 0.5151064
	speed: 0.3278s/iter; left time: 4530.8315s
	iters: 300, epoch: 1 | loss: 0.4783047
	speed: 0.3284s/iter; left time: 4505.8913s
	iters: 400, epoch: 1 | loss: 0.5052466
	speed: 0.3279s/iter; left time: 4466.9729s
	iters: 500, epoch: 1 | loss: 0.5106847
	speed: 0.3279s/iter; left time: 4433.7933s
	iters: 600, epoch: 1 | loss: 0.4960280
	speed: 0.3281s/iter; left time: 4403.8187s
	iters: 700, epoch: 1 | loss: 0.5103820
	speed: 0.3276s/iter; left time: 4363.9401s
Epoch: 1 cost time: 231.67650985717773
Epoch: 1, Steps: 701 | Train Loss: 0.5139286 Vali Loss: 0.6921636 Test Loss: 0.8071557
Validation loss decreased (inf --> 0.692164).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.5230148
	speed: 0.6243s/iter; left time: 8252.6818s
	iters: 200, epoch: 2 | loss: 0.5124176
	speed: 0.3295s/iter; left time: 4323.1567s
	iters: 300, epoch: 2 | loss: 0.4798888
	speed: 0.3284s/iter; left time: 4276.0512s
	iters: 400, epoch: 2 | loss: 0.5149068
	speed: 0.3277s/iter; left time: 4234.2017s
	iters: 500, epoch: 2 | loss: 0.4776779
	speed: 0.3273s/iter; left time: 4195.8665s
	iters: 600, epoch: 2 | loss: 0.5218522
	speed: 0.3284s/iter; left time: 4176.8720s
	iters: 700, epoch: 2 | loss: 0.5049614
	speed: 0.3278s/iter; left time: 4136.6387s
Epoch: 2 cost time: 230.7623884677887
Epoch: 2, Steps: 701 | Train Loss: 0.5078348 Vali Loss: 0.6903151 Test Loss: 0.7986546
Validation loss decreased (0.692164 --> 0.690315).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.3527621
	speed: 0.6229s/iter; left time: 7797.4644s
	iters: 200, epoch: 3 | loss: 0.3637912
	speed: 0.3337s/iter; left time: 4143.8546s
	iters: 300, epoch: 3 | loss: 0.3860648
	speed: 0.3294s/iter; left time: 4057.8467s
	iters: 400, epoch: 3 | loss: 0.3392747
	speed: 0.3292s/iter; left time: 4023.0126s
	iters: 500, epoch: 3 | loss: 0.3870704
	speed: 0.3277s/iter; left time: 3970.9938s
	iters: 600, epoch: 3 | loss: 0.3437451
	speed: 0.3282s/iter; left time: 3944.2979s
	iters: 700, epoch: 3 | loss: 0.3679588
	speed: 0.3282s/iter; left time: 3912.1839s
Epoch: 3 cost time: 231.42237448692322
Epoch: 3, Steps: 701 | Train Loss: 0.3615993 Vali Loss: 0.5217820 Test Loss: 0.6072817
Validation loss decreased (0.690315 --> 0.521782).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.3083017
	speed: 0.6238s/iter; left time: 7372.0963s
	iters: 200, epoch: 4 | loss: 0.3001857
	speed: 0.3329s/iter; left time: 3900.8730s
	iters: 300, epoch: 4 | loss: 0.2998247
	speed: 0.3283s/iter; left time: 3814.5180s
	iters: 400, epoch: 4 | loss: 0.3055539
	speed: 0.3292s/iter; left time: 3792.1683s
	iters: 500, epoch: 4 | loss: 0.3163204
	speed: 0.3290s/iter; left time: 3756.0063s
	iters: 600, epoch: 4 | loss: 0.3255433
	speed: 0.3285s/iter; left time: 3717.5070s
	iters: 700, epoch: 4 | loss: 0.3011702
	speed: 0.3286s/iter; left time: 3686.5376s
Epoch: 4 cost time: 231.45568919181824
Epoch: 4, Steps: 701 | Train Loss: 0.3119698 Vali Loss: 0.4663881 Test Loss: 0.5364466
Validation loss decreased (0.521782 --> 0.466388).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.2986611
	speed: 0.6230s/iter; left time: 6925.6720s
	iters: 200, epoch: 5 | loss: 0.3256763
	speed: 0.3338s/iter; left time: 3677.7606s
	iters: 300, epoch: 5 | loss: 0.2639780
	speed: 0.3327s/iter; left time: 3632.5056s
	iters: 400, epoch: 5 | loss: 0.2805563
	speed: 0.3301s/iter; left time: 3570.4150s
	iters: 500, epoch: 5 | loss: 0.2690598
	speed: 0.3298s/iter; left time: 3534.4865s
	iters: 600, epoch: 5 | loss: 0.2972792
	speed: 0.3306s/iter; left time: 3510.3821s
	iters: 700, epoch: 5 | loss: 0.2967750
	speed: 0.3300s/iter; left time: 3470.7316s
Epoch: 5 cost time: 232.42130541801453
Epoch: 5, Steps: 701 | Train Loss: 0.2903209 Vali Loss: 0.4413823 Test Loss: 0.5099418
Validation loss decreased (0.466388 --> 0.441382).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.2683765
	speed: 0.6183s/iter; left time: 6440.0360s
	iters: 200, epoch: 6 | loss: 0.2736325
	speed: 0.3316s/iter; left time: 3420.4789s
	iters: 300, epoch: 6 | loss: 0.2735550
	speed: 0.3294s/iter; left time: 3365.6122s
	iters: 400, epoch: 6 | loss: 0.2715005
	speed: 0.3289s/iter; left time: 3326.6899s
	iters: 500, epoch: 6 | loss: 0.2919298
	speed: 0.3290s/iter; left time: 3295.6311s
	iters: 600, epoch: 6 | loss: 0.2728646
	speed: 0.3306s/iter; left time: 3278.0466s
	iters: 700, epoch: 6 | loss: 0.2963023
	speed: 0.3318s/iter; left time: 3257.0597s
Epoch: 6 cost time: 231.52644276618958
Epoch: 6, Steps: 701 | Train Loss: 0.2789212 Vali Loss: 0.4302409 Test Loss: 0.4953045
Validation loss decreased (0.441382 --> 0.430241).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.2666761
	speed: 0.6246s/iter; left time: 6067.5261s
	iters: 200, epoch: 7 | loss: 0.2912878
	speed: 0.3345s/iter; left time: 3216.4006s
	iters: 300, epoch: 7 | loss: 0.2839427
	speed: 0.3317s/iter; left time: 3156.2315s
	iters: 400, epoch: 7 | loss: 0.2696170
	speed: 0.3283s/iter; left time: 3090.8025s
	iters: 500, epoch: 7 | loss: 0.2673205
	speed: 0.3281s/iter; left time: 3056.1808s
	iters: 600, epoch: 7 | loss: 0.2774298
	speed: 0.3284s/iter; left time: 3026.4557s
	iters: 700, epoch: 7 | loss: 0.2671807
	speed: 0.3283s/iter; left time: 2992.0845s
Epoch: 7 cost time: 231.78743648529053
Epoch: 7, Steps: 701 | Train Loss: 0.2727117 Vali Loss: 0.4264070 Test Loss: 0.4896125
Validation loss decreased (0.430241 --> 0.426407).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.2565182
	speed: 0.6234s/iter; left time: 5619.5919s
	iters: 200, epoch: 8 | loss: 0.2534989
	speed: 0.3340s/iter; left time: 2977.1752s
	iters: 300, epoch: 8 | loss: 0.2665392
	speed: 0.3296s/iter; left time: 2905.3290s
	iters: 400, epoch: 8 | loss: 0.2795893
	speed: 0.3286s/iter; left time: 2863.2283s
	iters: 500, epoch: 8 | loss: 0.2722631
	speed: 0.3280s/iter; left time: 2825.4900s
	iters: 600, epoch: 8 | loss: 0.2626121
	speed: 0.3288s/iter; left time: 2799.0772s
	iters: 700, epoch: 8 | loss: 0.2728101
	speed: 0.3275s/iter; left time: 2755.8843s
Epoch: 8 cost time: 231.38418650627136
Epoch: 8, Steps: 701 | Train Loss: 0.2694042 Vali Loss: 0.4226851 Test Loss: 0.4857267
Validation loss decreased (0.426407 --> 0.422685).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.2495994
	speed: 0.6172s/iter; left time: 5130.6851s
	iters: 200, epoch: 9 | loss: 0.2576028
	speed: 0.3314s/iter; left time: 2721.8127s
	iters: 300, epoch: 9 | loss: 0.2640996
	speed: 0.3279s/iter; left time: 2660.0409s
	iters: 400, epoch: 9 | loss: 0.2682963
	speed: 0.3281s/iter; left time: 2628.9250s
	iters: 500, epoch: 9 | loss: 0.2628151
	speed: 0.3285s/iter; left time: 2599.2561s
	iters: 600, epoch: 9 | loss: 0.2824847
	speed: 0.3287s/iter; left time: 2568.3324s
	iters: 700, epoch: 9 | loss: 0.2411431
	speed: 0.3282s/iter; left time: 2531.4665s
Epoch: 9 cost time: 230.5570158958435
Epoch: 9, Steps: 701 | Train Loss: 0.2675066 Vali Loss: 0.4209720 Test Loss: 0.4841228
Validation loss decreased (0.422685 --> 0.420972).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.2737441
	speed: 0.6209s/iter; left time: 4726.1559s
	iters: 200, epoch: 10 | loss: 0.2799182
	speed: 0.3335s/iter; left time: 2505.2092s
	iters: 300, epoch: 10 | loss: 0.2652673
	speed: 0.3309s/iter; left time: 2452.9196s
	iters: 400, epoch: 10 | loss: 0.2778914
	speed: 0.3286s/iter; left time: 2402.8300s
	iters: 500, epoch: 10 | loss: 0.2784960
	speed: 0.3288s/iter; left time: 2371.5706s
	iters: 600, epoch: 10 | loss: 0.2648504
	speed: 0.3291s/iter; left time: 2340.3980s
	iters: 700, epoch: 10 | loss: 0.2621469
	speed: 0.3289s/iter; left time: 2306.3280s
Epoch: 10 cost time: 231.66185784339905
Epoch: 10, Steps: 701 | Train Loss: 0.2664904 Vali Loss: 0.4206934 Test Loss: 0.4836041
Validation loss decreased (0.420972 --> 0.420693).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.2625259
	speed: 0.6239s/iter; left time: 4311.7394s
	iters: 200, epoch: 11 | loss: 0.2517353
	speed: 0.3320s/iter; left time: 2261.0144s
	iters: 300, epoch: 11 | loss: 0.2773165
	speed: 0.3295s/iter; left time: 2211.5293s
	iters: 400, epoch: 11 | loss: 0.2813518
	speed: 0.3287s/iter; left time: 2173.0130s
	iters: 500, epoch: 11 | loss: 0.2688897
	speed: 0.3292s/iter; left time: 2143.4096s
	iters: 600, epoch: 11 | loss: 0.2570627
	speed: 0.3295s/iter; left time: 2112.1688s
	iters: 700, epoch: 11 | loss: 0.3015190
	speed: 0.3293s/iter; left time: 2077.9327s
Epoch: 11 cost time: 231.68802905082703
Epoch: 11, Steps: 701 | Train Loss: 0.2659190 Vali Loss: 0.4200672 Test Loss: 0.4833037
Validation loss decreased (0.420693 --> 0.420067).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.2663701
	speed: 0.6241s/iter; left time: 3875.5562s
	iters: 200, epoch: 12 | loss: 0.2638318
	speed: 0.3336s/iter; left time: 2038.0914s
	iters: 300, epoch: 12 | loss: 0.2561494
	speed: 0.3312s/iter; left time: 1990.2687s
	iters: 400, epoch: 12 | loss: 0.2863836
	speed: 0.3319s/iter; left time: 1961.3173s
	iters: 500, epoch: 12 | loss: 0.2526794
	speed: 0.3302s/iter; left time: 1918.7137s
	iters: 600, epoch: 12 | loss: 0.2396398
	speed: 0.3301s/iter; left time: 1884.7039s
	iters: 700, epoch: 12 | loss: 0.2716396
	speed: 0.3295s/iter; left time: 1848.6061s
Epoch: 12 cost time: 232.49129843711853
Epoch: 12, Steps: 701 | Train Loss: 0.2656161 Vali Loss: 0.4197673 Test Loss: 0.4830629
Validation loss decreased (0.420067 --> 0.419767).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.2802794
	speed: 0.6254s/iter; left time: 3445.4734s
	iters: 200, epoch: 13 | loss: 0.2565221
	speed: 0.3335s/iter; left time: 1803.9519s
	iters: 300, epoch: 13 | loss: 0.2526067
	speed: 0.3318s/iter; left time: 1761.5187s
	iters: 400, epoch: 13 | loss: 0.2657390
	speed: 0.3299s/iter; left time: 1718.5412s
	iters: 500, epoch: 13 | loss: 0.2504595
	speed: 0.3303s/iter; left time: 1687.2826s
	iters: 600, epoch: 13 | loss: 0.2618817
	speed: 0.3321s/iter; left time: 1663.4953s
	iters: 700, epoch: 13 | loss: 0.2865996
	speed: 0.3319s/iter; left time: 1629.4893s
Epoch: 13 cost time: 232.55673599243164
Epoch: 13, Steps: 701 | Train Loss: 0.2654485 Vali Loss: 0.4200963 Test Loss: 0.4830157
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 14 | loss: 0.2607745
	speed: 0.6139s/iter; left time: 2951.5891s
	iters: 200, epoch: 14 | loss: 0.2493500
	speed: 0.3306s/iter; left time: 1556.5096s
	iters: 300, epoch: 14 | loss: 0.2637763
	speed: 0.3306s/iter; left time: 1523.2151s
	iters: 400, epoch: 14 | loss: 0.2538489
	speed: 0.3311s/iter; left time: 1492.6362s
	iters: 500, epoch: 14 | loss: 0.2938900
	speed: 0.3307s/iter; left time: 1457.5452s
	iters: 600, epoch: 14 | loss: 0.2577871
	speed: 0.3314s/iter; left time: 1427.7475s
	iters: 700, epoch: 14 | loss: 0.2557983
	speed: 0.3312s/iter; left time: 1393.5062s
Epoch: 14 cost time: 231.9838843345642
Epoch: 14, Steps: 701 | Train Loss: 0.2653866 Vali Loss: 0.4196918 Test Loss: 0.4829654
Validation loss decreased (0.419767 --> 0.419692).  Saving model ...
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 15 | loss: 0.2937483
	speed: 0.6246s/iter; left time: 2565.1401s
	iters: 200, epoch: 15 | loss: 0.2575054
	speed: 0.3346s/iter; left time: 1340.6972s
	iters: 300, epoch: 15 | loss: 0.2701886
	speed: 0.3312s/iter; left time: 1294.1462s
	iters: 400, epoch: 15 | loss: 0.2651657
	speed: 0.3311s/iter; left time: 1260.5683s
	iters: 500, epoch: 15 | loss: 0.2541021
	speed: 0.3304s/iter; left time: 1224.7463s
	iters: 600, epoch: 15 | loss: 0.2470428
	speed: 0.3308s/iter; left time: 1193.3048s
	iters: 700, epoch: 15 | loss: 0.2694565
	speed: 0.3307s/iter; left time: 1159.6371s
Epoch: 15 cost time: 232.71951031684875
Epoch: 15, Steps: 701 | Train Loss: 0.2653734 Vali Loss: 0.4199110 Test Loss: 0.4829760
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 16 | loss: 0.2771376
	speed: 0.6156s/iter; left time: 2096.8800s
	iters: 200, epoch: 16 | loss: 0.2557007
	speed: 0.3310s/iter; left time: 1094.4185s
	iters: 300, epoch: 16 | loss: 0.2531030
	speed: 0.3321s/iter; left time: 1064.8303s
	iters: 400, epoch: 16 | loss: 0.2644440
	speed: 0.3309s/iter; left time: 1027.6431s
	iters: 500, epoch: 16 | loss: 0.2611765
	speed: 0.3305s/iter; left time: 993.3487s
	iters: 600, epoch: 16 | loss: 0.2756760
	speed: 0.3315s/iter; left time: 963.4687s
	iters: 700, epoch: 16 | loss: 0.2633304
	speed: 0.3304s/iter; left time: 927.1509s
Epoch: 16 cost time: 232.1425495147705
Epoch: 16, Steps: 701 | Train Loss: 0.2653364 Vali Loss: 0.4202376 Test Loss: 0.4829765
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 17 | loss: 0.2738850
	speed: 0.6148s/iter; left time: 1663.1157s
	iters: 200, epoch: 17 | loss: 0.2524403
	speed: 0.3325s/iter; left time: 866.1705s
	iters: 300, epoch: 17 | loss: 0.2540539
	speed: 0.3312s/iter; left time: 829.6231s
	iters: 400, epoch: 17 | loss: 0.2581682
	speed: 0.3310s/iter; left time: 796.0608s
	iters: 500, epoch: 17 | loss: 0.2821523
	speed: 0.3312s/iter; left time: 763.3093s
	iters: 600, epoch: 17 | loss: 0.2849562
	speed: 0.3314s/iter; left time: 730.6834s
	iters: 700, epoch: 17 | loss: 0.2785275
	speed: 0.3309s/iter; left time: 696.5082s
Epoch: 17 cost time: 232.49414730072021
Epoch: 17, Steps: 701 | Train Loss: 0.2653122 Vali Loss: 0.4196115 Test Loss: 0.4829769
Validation loss decreased (0.419692 --> 0.419612).  Saving model ...
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 18 | loss: 0.2655573
	speed: 0.6380s/iter; left time: 1278.5572s
	iters: 200, epoch: 18 | loss: 0.2653379
	speed: 0.4112s/iter; left time: 782.8834s
	iters: 300, epoch: 18 | loss: 0.2544242
	speed: 0.4412s/iter; left time: 795.8960s
	iters: 400, epoch: 18 | loss: 0.2501496
	speed: 0.3310s/iter; left time: 564.0166s
	iters: 500, epoch: 18 | loss: 0.2445375
	speed: 0.3301s/iter; left time: 529.4417s
	iters: 600, epoch: 18 | loss: 0.2582040
	speed: 0.3300s/iter; left time: 496.3520s
	iters: 700, epoch: 18 | loss: 0.2525325
	speed: 0.3315s/iter; left time: 465.4864s
Epoch: 18 cost time: 252.8745460510254
Epoch: 18, Steps: 701 | Train Loss: 0.2653081 Vali Loss: 0.4197173 Test Loss: 0.4829774
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 19 | loss: 0.2931886
	speed: 0.6163s/iter; left time: 803.0159s
	iters: 200, epoch: 19 | loss: 0.2515851
	speed: 0.3308s/iter; left time: 397.9323s
	iters: 300, epoch: 19 | loss: 0.2879111
	speed: 0.3302s/iter; left time: 364.2642s
	iters: 400, epoch: 19 | loss: 0.2544025
	speed: 0.3311s/iter; left time: 332.0501s
	iters: 500, epoch: 19 | loss: 0.2777384
	speed: 0.3308s/iter; left time: 298.7332s
	iters: 600, epoch: 19 | loss: 0.2782499
	speed: 0.3296s/iter; left time: 264.6824s
	iters: 700, epoch: 19 | loss: 0.2605351
	speed: 0.3296s/iter; left time: 231.7295s
Epoch: 19 cost time: 231.75954461097717
Epoch: 19, Steps: 701 | Train Loss: 0.2653085 Vali Loss: 0.4201162 Test Loss: 0.4829770
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 20 | loss: 0.2462646
	speed: 0.6141s/iter; left time: 369.6808s
	iters: 200, epoch: 20 | loss: 0.2803450
	speed: 0.3298s/iter; left time: 165.5450s
	iters: 300, epoch: 20 | loss: 0.2891157
	speed: 0.3300s/iter; left time: 132.6508s
	iters: 400, epoch: 20 | loss: 0.2767831
	speed: 0.3309s/iter; left time: 99.9328s
	iters: 500, epoch: 20 | loss: 0.2648526
	speed: 0.3298s/iter; left time: 66.6145s
	iters: 600, epoch: 20 | loss: 0.2625272
	speed: 0.3297s/iter; left time: 33.6245s
	iters: 700, epoch: 20 | loss: 0.2412485
	speed: 0.3298s/iter; left time: 0.6596s
Epoch: 20 cost time: 231.28009676933289
Epoch: 20, Steps: 701 | Train Loss: 0.2653050 Vali Loss: 0.4201707 Test Loss: 0.4829770
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.9073486328125e-08
>>>>>>>testing : traffic_336_720_Linear_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15726<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2789
mse:0.4827897846698761, mae:0.33051052689552307
