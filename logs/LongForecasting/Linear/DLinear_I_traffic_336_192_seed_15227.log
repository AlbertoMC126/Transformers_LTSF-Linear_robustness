Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='DLinear', model_id='traffic_336_192', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=192, root_path='./dataset/', save_pred_values=False, seed=15227, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_336_192_DLinear_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15227>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11753
val 1565
test 3317
	iters: 100, epoch: 1 | loss: 0.5477065
	speed: 0.4327s/iter; left time: 6309.1002s
	iters: 200, epoch: 1 | loss: 0.5382060
	speed: 0.4300s/iter; left time: 6227.4483s
	iters: 300, epoch: 1 | loss: 0.5966271
	speed: 0.4188s/iter; left time: 6023.2604s
	iters: 400, epoch: 1 | loss: 0.5800471
	speed: 0.4261s/iter; left time: 6085.0545s
	iters: 500, epoch: 1 | loss: 0.5986615
	speed: 0.4352s/iter; left time: 6171.0820s
	iters: 600, epoch: 1 | loss: 0.5623413
	speed: 0.4204s/iter; left time: 5919.2246s
	iters: 700, epoch: 1 | loss: 0.6457949
	speed: 0.4246s/iter; left time: 5936.5325s
Epoch: 1 cost time: 313.82376980781555
Epoch: 1, Steps: 734 | Train Loss: 0.5892225 Vali Loss: 0.8113351 Test Loss: 0.9495951
Validation loss decreased (inf --> 0.811335).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.6519986
	speed: 0.9173s/iter; left time: 12701.3517s
	iters: 200, epoch: 2 | loss: 0.5994077
	speed: 0.4368s/iter; left time: 6004.1484s
	iters: 300, epoch: 2 | loss: 0.5817156
	speed: 0.4183s/iter; left time: 5708.4191s
	iters: 400, epoch: 2 | loss: 0.5409598
	speed: 0.4167s/iter; left time: 5645.1087s
	iters: 500, epoch: 2 | loss: 0.5716857
	speed: 0.4494s/iter; left time: 6042.9913s
	iters: 600, epoch: 2 | loss: 0.5689991
	speed: 0.4201s/iter; left time: 5607.5522s
	iters: 700, epoch: 2 | loss: 0.5888216
	speed: 0.4201s/iter; left time: 5564.7427s
Epoch: 2 cost time: 312.79202365875244
Epoch: 2, Steps: 734 | Train Loss: 0.5819527 Vali Loss: 0.8446227 Test Loss: 0.9771537
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.3395859
	speed: 0.8498s/iter; left time: 11142.7997s
	iters: 200, epoch: 3 | loss: 0.3504565
	speed: 0.4268s/iter; left time: 5554.3188s
	iters: 300, epoch: 3 | loss: 0.3460200
	speed: 0.4260s/iter; left time: 5500.7554s
	iters: 400, epoch: 3 | loss: 0.3742160
	speed: 0.4168s/iter; left time: 5340.3835s
	iters: 500, epoch: 3 | loss: 0.3531803
	speed: 0.4338s/iter; left time: 5514.4371s
	iters: 600, epoch: 3 | loss: 0.3650309
	speed: 0.4285s/iter; left time: 5404.6318s
	iters: 700, epoch: 3 | loss: 0.3650900
	speed: 0.4226s/iter; left time: 5288.2759s
Epoch: 3 cost time: 311.7612943649292
Epoch: 3, Steps: 734 | Train Loss: 0.3592179 Vali Loss: 0.4948159 Test Loss: 0.6049302
Validation loss decreased (0.811335 --> 0.494816).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.3081718
	speed: 0.9252s/iter; left time: 11453.4204s
	iters: 200, epoch: 4 | loss: 0.2823220
	speed: 0.4212s/iter; left time: 5171.4208s
	iters: 300, epoch: 4 | loss: 0.3123848
	speed: 0.4295s/iter; left time: 5230.5797s
	iters: 400, epoch: 4 | loss: 0.2801478
	speed: 0.4196s/iter; left time: 5067.7630s
	iters: 500, epoch: 4 | loss: 0.2863519
	speed: 0.4259s/iter; left time: 5102.4152s
	iters: 600, epoch: 4 | loss: 0.2940049
	speed: 0.4326s/iter; left time: 5139.2876s
	iters: 700, epoch: 4 | loss: 0.2948152
	speed: 0.4205s/iter; left time: 4952.6199s
Epoch: 4 cost time: 311.62765622138977
Epoch: 4, Steps: 734 | Train Loss: 0.2947780 Vali Loss: 0.4206079 Test Loss: 0.5165815
Validation loss decreased (0.494816 --> 0.420608).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.2289147
	speed: 0.9211s/iter; left time: 10725.7472s
	iters: 200, epoch: 5 | loss: 0.2850465
	speed: 0.4233s/iter; left time: 4886.5474s
	iters: 300, epoch: 5 | loss: 0.2807421
	speed: 0.4323s/iter; left time: 4948.0181s
	iters: 400, epoch: 5 | loss: 0.2485503
	speed: 0.4174s/iter; left time: 4735.2296s
	iters: 500, epoch: 5 | loss: 0.2502271
	speed: 0.4170s/iter; left time: 4689.1398s
	iters: 600, epoch: 5 | loss: 0.2746904
	speed: 0.4417s/iter; left time: 4922.5475s
	iters: 700, epoch: 5 | loss: 0.2524549
	speed: 0.4167s/iter; left time: 4601.9835s
Epoch: 5 cost time: 311.49183440208435
Epoch: 5, Steps: 734 | Train Loss: 0.2677300 Vali Loss: 0.3852705 Test Loss: 0.4760079
Validation loss decreased (0.420608 --> 0.385270).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.2706915
	speed: 0.9243s/iter; left time: 10084.8863s
	iters: 200, epoch: 6 | loss: 0.2367251
	speed: 0.4195s/iter; left time: 4535.1357s
	iters: 300, epoch: 6 | loss: 0.2258090
	speed: 0.4282s/iter; left time: 4586.5445s
	iters: 400, epoch: 6 | loss: 0.2350750
	speed: 0.4250s/iter; left time: 4510.0399s
	iters: 500, epoch: 6 | loss: 0.3000926
	speed: 0.4189s/iter; left time: 4402.8011s
	iters: 600, epoch: 6 | loss: 0.2352449
	speed: 0.4333s/iter; left time: 4510.6368s
	iters: 700, epoch: 6 | loss: 0.2426236
	speed: 0.4236s/iter; left time: 4367.3012s
Epoch: 6 cost time: 312.07514667510986
Epoch: 6, Steps: 734 | Train Loss: 0.2539505 Vali Loss: 0.3704852 Test Loss: 0.4583192
Validation loss decreased (0.385270 --> 0.370485).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.2688290
	speed: 0.9345s/iter; left time: 9510.4552s
	iters: 200, epoch: 7 | loss: 0.2198514
	speed: 0.4202s/iter; left time: 4233.9866s
	iters: 300, epoch: 7 | loss: 0.2662467
	speed: 0.4203s/iter; left time: 4193.3591s
	iters: 400, epoch: 7 | loss: 0.2539540
	speed: 0.4292s/iter; left time: 4239.6287s
	iters: 500, epoch: 7 | loss: 0.2308227
	speed: 0.4191s/iter; left time: 4097.7634s
	iters: 600, epoch: 7 | loss: 0.2361970
	speed: 0.4254s/iter; left time: 4116.4455s
	iters: 700, epoch: 7 | loss: 0.2528478
	speed: 0.4333s/iter; left time: 4149.5429s
Epoch: 7 cost time: 312.5247142314911
Epoch: 7, Steps: 734 | Train Loss: 0.2466500 Vali Loss: 0.3641677 Test Loss: 0.4482214
Validation loss decreased (0.370485 --> 0.364168).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.2389219
	speed: 0.9204s/iter; left time: 8691.2269s
	iters: 200, epoch: 8 | loss: 0.2613763
	speed: 0.4216s/iter; left time: 3939.2667s
	iters: 300, epoch: 8 | loss: 0.2528234
	speed: 0.4197s/iter; left time: 3879.2930s
	iters: 400, epoch: 8 | loss: 0.2435168
	speed: 0.4323s/iter; left time: 3952.1166s
	iters: 500, epoch: 8 | loss: 0.2413392
	speed: 0.4182s/iter; left time: 3781.8617s
	iters: 600, epoch: 8 | loss: 0.2384706
	speed: 0.4201s/iter; left time: 3756.5597s
	iters: 700, epoch: 8 | loss: 0.2233916
	speed: 0.4456s/iter; left time: 3940.5430s
Epoch: 8 cost time: 312.78995871543884
Epoch: 8, Steps: 734 | Train Loss: 0.2425345 Vali Loss: 0.3591186 Test Loss: 0.4430553
Validation loss decreased (0.364168 --> 0.359119).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.2506197
	speed: 0.9196s/iter; left time: 8008.5548s
	iters: 200, epoch: 9 | loss: 0.2478323
	speed: 0.4219s/iter; left time: 3632.3314s
	iters: 300, epoch: 9 | loss: 0.2641061
	speed: 0.4208s/iter; left time: 3580.5988s
	iters: 400, epoch: 9 | loss: 0.2560622
	speed: 0.4282s/iter; left time: 3600.4446s
	iters: 500, epoch: 9 | loss: 0.2479620
	speed: 0.4212s/iter; left time: 3499.7284s
	iters: 600, epoch: 9 | loss: 0.2547313
	speed: 0.4186s/iter; left time: 3436.6781s
	iters: 700, epoch: 9 | loss: 0.2580106
	speed: 0.4415s/iter; left time: 3580.0668s
Epoch: 9 cost time: 312.43906354904175
Epoch: 9, Steps: 734 | Train Loss: 0.2402580 Vali Loss: 0.3567431 Test Loss: 0.4407739
Validation loss decreased (0.359119 --> 0.356743).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.2304221
	speed: 0.9240s/iter; left time: 7369.1015s
	iters: 200, epoch: 10 | loss: 0.2426188
	speed: 0.4240s/iter; left time: 3338.7265s
	iters: 300, epoch: 10 | loss: 0.2193057
	speed: 0.4178s/iter; left time: 3248.3654s
	iters: 400, epoch: 10 | loss: 0.2416671
	speed: 0.4189s/iter; left time: 3214.8926s
	iters: 500, epoch: 10 | loss: 0.2479276
	speed: 0.4222s/iter; left time: 3197.8278s
	iters: 600, epoch: 10 | loss: 0.2251271
	speed: 0.4218s/iter; left time: 3153.2255s
	iters: 700, epoch: 10 | loss: 0.2462577
	speed: 0.4183s/iter; left time: 3084.8009s
Epoch: 10 cost time: 309.31069469451904
Epoch: 10, Steps: 734 | Train Loss: 0.2389881 Vali Loss: 0.3563928 Test Loss: 0.4399190
Validation loss decreased (0.356743 --> 0.356393).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.2361353
	speed: 0.9130s/iter; left time: 6611.0638s
	iters: 200, epoch: 11 | loss: 0.2441531
	speed: 0.4242s/iter; left time: 3029.1079s
	iters: 300, epoch: 11 | loss: 0.2355144
	speed: 0.4186s/iter; left time: 2947.2436s
	iters: 400, epoch: 11 | loss: 0.2404866
	speed: 0.4186s/iter; left time: 2905.5929s
	iters: 500, epoch: 11 | loss: 0.2437106
	speed: 0.4200s/iter; left time: 2873.1808s
	iters: 600, epoch: 11 | loss: 0.2476094
	speed: 0.4146s/iter; left time: 2794.7909s
	iters: 700, epoch: 11 | loss: 0.2335599
	speed: 0.4158s/iter; left time: 2761.4374s
Epoch: 11 cost time: 307.65305042266846
Epoch: 11, Steps: 734 | Train Loss: 0.2383454 Vali Loss: 0.3559177 Test Loss: 0.4394464
Validation loss decreased (0.356393 --> 0.355918).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.2369584
	speed: 0.9125s/iter; left time: 5937.7612s
	iters: 200, epoch: 12 | loss: 0.2467410
	speed: 0.4268s/iter; left time: 2734.4073s
	iters: 300, epoch: 12 | loss: 0.2393354
	speed: 0.4203s/iter; left time: 2650.5671s
	iters: 400, epoch: 12 | loss: 0.2227408
	speed: 0.4182s/iter; left time: 2595.7812s
	iters: 500, epoch: 12 | loss: 0.2470905
	speed: 0.4192s/iter; left time: 2559.7905s
	iters: 600, epoch: 12 | loss: 0.2367443
	speed: 0.4215s/iter; left time: 2531.6622s
	iters: 700, epoch: 12 | loss: 0.2552692
	speed: 0.4170s/iter; left time: 2463.4751s
Epoch: 12 cost time: 308.6648979187012
Epoch: 12, Steps: 734 | Train Loss: 0.2379454 Vali Loss: 0.3559582 Test Loss: 0.4392586
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.2344467
	speed: 0.8432s/iter; left time: 4867.6329s
	iters: 200, epoch: 13 | loss: 0.2648473
	speed: 0.4197s/iter; left time: 2381.2267s
	iters: 300, epoch: 13 | loss: 0.2295569
	speed: 0.4251s/iter; left time: 2369.2363s
	iters: 400, epoch: 13 | loss: 0.2397537
	speed: 0.4183s/iter; left time: 2289.1295s
	iters: 500, epoch: 13 | loss: 0.2492104
	speed: 0.4185s/iter; left time: 2248.5748s
	iters: 600, epoch: 13 | loss: 0.2407135
	speed: 0.4195s/iter; left time: 2212.2802s
	iters: 700, epoch: 13 | loss: 0.2612985
	speed: 0.4166s/iter; left time: 2155.1395s
Epoch: 13 cost time: 307.5132505893707
Epoch: 13, Steps: 734 | Train Loss: 0.2377778 Vali Loss: 0.3555788 Test Loss: 0.4391874
Validation loss decreased (0.355918 --> 0.355579).  Saving model ...
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 14 | loss: 0.2446381
	speed: 0.9206s/iter; left time: 4638.7403s
	iters: 200, epoch: 14 | loss: 0.2392453
	speed: 0.4189s/iter; left time: 2069.1363s
	iters: 300, epoch: 14 | loss: 0.2173104
	speed: 0.4245s/iter; left time: 2054.3307s
	iters: 400, epoch: 14 | loss: 0.2454256
	speed: 0.4210s/iter; left time: 1995.2948s
	iters: 500, epoch: 14 | loss: 0.2101678
	speed: 0.4169s/iter; left time: 1934.0009s
	iters: 600, epoch: 14 | loss: 0.2775535
	speed: 0.4199s/iter; left time: 1905.7318s
	iters: 700, epoch: 14 | loss: 0.2681452
	speed: 0.4161s/iter; left time: 1846.9084s
Epoch: 14 cost time: 307.87238597869873
Epoch: 14, Steps: 734 | Train Loss: 0.2376535 Vali Loss: 0.3556220 Test Loss: 0.4391668
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 15 | loss: 0.2402603
	speed: 0.8437s/iter; left time: 3632.0751s
	iters: 200, epoch: 15 | loss: 0.2401983
	speed: 0.4161s/iter; left time: 1749.6103s
	iters: 300, epoch: 15 | loss: 0.2364944
	speed: 0.4221s/iter; left time: 1732.8171s
	iters: 400, epoch: 15 | loss: 0.2447568
	speed: 0.4217s/iter; left time: 1689.1086s
	iters: 500, epoch: 15 | loss: 0.2425333
	speed: 0.4205s/iter; left time: 1642.0756s
	iters: 600, epoch: 15 | loss: 0.2366785
	speed: 0.4182s/iter; left time: 1591.1906s
	iters: 700, epoch: 15 | loss: 0.2708651
	speed: 0.4183s/iter; left time: 1549.6490s
Epoch: 15 cost time: 307.52401089668274
Epoch: 15, Steps: 734 | Train Loss: 0.2376289 Vali Loss: 0.3556878 Test Loss: 0.4391635
EarlyStopping counter: 2 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 16 | loss: 0.2242232
	speed: 0.8400s/iter; left time: 2999.5489s
	iters: 200, epoch: 16 | loss: 0.2330433
	speed: 0.4149s/iter; left time: 1440.2568s
	iters: 300, epoch: 16 | loss: 0.2459255
	speed: 0.4178s/iter; left time: 1408.4193s
	iters: 400, epoch: 16 | loss: 0.2407555
	speed: 0.4254s/iter; left time: 1391.6419s
	iters: 500, epoch: 16 | loss: 0.2315226
	speed: 0.4204s/iter; left time: 1332.9763s
	iters: 600, epoch: 16 | loss: 0.2344647
	speed: 0.4158s/iter; left time: 1277.0506s
	iters: 700, epoch: 16 | loss: 0.2202147
	speed: 0.4224s/iter; left time: 1255.0324s
Epoch: 16 cost time: 307.69767904281616
Epoch: 16, Steps: 734 | Train Loss: 0.2375868 Vali Loss: 0.3556632 Test Loss: 0.4391623
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 17 | loss: 0.2508784
	speed: 0.8474s/iter; left time: 2404.0290s
	iters: 200, epoch: 17 | loss: 0.2459780
	speed: 0.4189s/iter; left time: 1146.4671s
	iters: 300, epoch: 17 | loss: 0.2465942
	speed: 0.4179s/iter; left time: 1102.0892s
	iters: 400, epoch: 17 | loss: 0.2398575
	speed: 0.4210s/iter; left time: 1068.1622s
	iters: 500, epoch: 17 | loss: 0.2350981
	speed: 0.4257s/iter; left time: 1037.3240s
	iters: 600, epoch: 17 | loss: 0.2253375
	speed: 0.4182s/iter; left time: 977.2281s
	iters: 700, epoch: 17 | loss: 0.2421178
	speed: 0.4310s/iter; left time: 964.1584s
Epoch: 17 cost time: 311.3184688091278
Epoch: 17, Steps: 734 | Train Loss: 0.2375809 Vali Loss: 0.3555694 Test Loss: 0.4391626
Validation loss decreased (0.355579 --> 0.355569).  Saving model ...
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 18 | loss: 0.2568842
	speed: 0.9290s/iter; left time: 1953.6936s
	iters: 200, epoch: 18 | loss: 0.2256737
	speed: 0.4152s/iter; left time: 831.5558s
	iters: 300, epoch: 18 | loss: 0.2506256
	speed: 0.4150s/iter; left time: 789.8100s
	iters: 400, epoch: 18 | loss: 0.2185225
	speed: 0.4174s/iter; left time: 752.5450s
	iters: 500, epoch: 18 | loss: 0.2522340
	speed: 0.4242s/iter; left time: 722.4004s
	iters: 600, epoch: 18 | loss: 0.2439430
	speed: 0.4212s/iter; left time: 675.2228s
	iters: 700, epoch: 18 | loss: 0.2586618
	speed: 0.4190s/iter; left time: 629.8020s
Epoch: 18 cost time: 307.3235249519348
Epoch: 18, Steps: 734 | Train Loss: 0.2375771 Vali Loss: 0.3554759 Test Loss: 0.4391622
Validation loss decreased (0.355569 --> 0.355476).  Saving model ...
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 19 | loss: 0.2191184
	speed: 0.9100s/iter; left time: 1245.7549s
	iters: 200, epoch: 19 | loss: 0.2491215
	speed: 0.4157s/iter; left time: 527.5132s
	iters: 300, epoch: 19 | loss: 0.2499782
	speed: 0.4148s/iter; left time: 484.8761s
	iters: 400, epoch: 19 | loss: 0.2337367
	speed: 0.4162s/iter; left time: 444.9352s
	iters: 500, epoch: 19 | loss: 0.2368428
	speed: 0.4213s/iter; left time: 408.2370s
	iters: 600, epoch: 19 | loss: 0.2198130
	speed: 0.4229s/iter; left time: 367.4809s
	iters: 700, epoch: 19 | loss: 0.2391075
	speed: 0.4182s/iter; left time: 321.5823s
Epoch: 19 cost time: 307.38334798812866
Epoch: 19, Steps: 734 | Train Loss: 0.2375613 Vali Loss: 0.3558770 Test Loss: 0.4391621
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 20 | loss: 0.2333598
	speed: 0.8596s/iter; left time: 545.8714s
	iters: 200, epoch: 20 | loss: 0.2353574
	speed: 0.4163s/iter; left time: 222.7167s
	iters: 300, epoch: 20 | loss: 0.2409018
	speed: 0.4153s/iter; left time: 180.6345s
	iters: 400, epoch: 20 | loss: 0.2441621
	speed: 0.4166s/iter; left time: 139.5543s
	iters: 500, epoch: 20 | loss: 0.2774633
	speed: 0.4205s/iter; left time: 98.8177s
	iters: 600, epoch: 20 | loss: 0.2424483
	speed: 0.4218s/iter; left time: 56.9483s
	iters: 700, epoch: 20 | loss: 0.2237478
	speed: 0.4192s/iter; left time: 14.6716s
Epoch: 20 cost time: 307.79804396629333
Epoch: 20, Steps: 734 | Train Loss: 0.2375641 Vali Loss: 0.3554751 Test Loss: 0.4391621
Validation loss decreased (0.355476 --> 0.355475).  Saving model ...
Updating learning rate to 1.9073486328125e-08
>>>>>>>testing : traffic_336_192_DLinear_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15227<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3317
mse:0.43885746598243713, mae:0.3042638599872589
