Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='DLinear', model_id='traffic_336_720', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=720, root_path='./dataset/', save_pred_values=False, seed=3293, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_336_720_DLinear_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3293>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11225
val 1037
test 2789
	iters: 100, epoch: 1 | loss: 0.5831941
	speed: 0.5818s/iter; left time: 8099.3570s
	iters: 200, epoch: 1 | loss: 0.6282319
	speed: 0.5748s/iter; left time: 7944.2960s
	iters: 300, epoch: 1 | loss: 0.6175474
	speed: 0.5597s/iter; left time: 7679.9080s
	iters: 400, epoch: 1 | loss: 0.6367791
	speed: 0.5694s/iter; left time: 7756.3829s
	iters: 500, epoch: 1 | loss: 0.6389014
	speed: 0.5613s/iter; left time: 7589.8120s
	iters: 600, epoch: 1 | loss: 0.6157200
	speed: 0.5742s/iter; left time: 7706.3108s
	iters: 700, epoch: 1 | loss: 0.6055517
	speed: 0.5596s/iter; left time: 7454.6407s
Epoch: 1 cost time: 399.04381227493286
Epoch: 1, Steps: 701 | Train Loss: 0.6186436 Vali Loss: 0.8583428 Test Loss: 0.9924480
Validation loss decreased (inf --> 0.858343).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.6019741
	speed: 1.0800s/iter; left time: 14277.8881s
	iters: 200, epoch: 2 | loss: 0.6180169
	speed: 0.5720s/iter; left time: 7504.1814s
	iters: 300, epoch: 2 | loss: 0.6006479
	speed: 0.5632s/iter; left time: 7333.1786s
	iters: 400, epoch: 2 | loss: 0.5842890
	speed: 0.5847s/iter; left time: 7553.6990s
	iters: 500, epoch: 2 | loss: 0.6480857
	speed: 0.5660s/iter; left time: 7255.5477s
	iters: 600, epoch: 2 | loss: 0.6291326
	speed: 0.5920s/iter; left time: 7530.6479s
	iters: 700, epoch: 2 | loss: 0.6033763
	speed: 0.5602s/iter; left time: 7069.2069s
Epoch: 2 cost time: 400.86654782295227
Epoch: 2, Steps: 701 | Train Loss: 0.6120436 Vali Loss: 0.8982874 Test Loss: 1.0526360
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.3759788
	speed: 0.9844s/iter; left time: 12324.0586s
	iters: 200, epoch: 3 | loss: 0.3798275
	speed: 0.5590s/iter; left time: 6942.0211s
	iters: 300, epoch: 3 | loss: 0.3757009
	speed: 0.5693s/iter; left time: 7012.6248s
	iters: 400, epoch: 3 | loss: 0.3645805
	speed: 0.5940s/iter; left time: 7257.7091s
	iters: 500, epoch: 3 | loss: 0.3908075
	speed: 0.5786s/iter; left time: 7012.0533s
	iters: 600, epoch: 3 | loss: 0.3942845
	speed: 0.5579s/iter; left time: 6705.3926s
	iters: 700, epoch: 3 | loss: 0.3867650
	speed: 0.5722s/iter; left time: 6819.6747s
Epoch: 3 cost time: 400.8476905822754
Epoch: 3, Steps: 701 | Train Loss: 0.3909384 Vali Loss: 0.5686282 Test Loss: 0.6614491
Validation loss decreased (0.858343 --> 0.568628).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.3245518
	speed: 1.0941s/iter; left time: 12929.9751s
	iters: 200, epoch: 4 | loss: 0.3005308
	speed: 0.5674s/iter; left time: 6649.2947s
	iters: 300, epoch: 4 | loss: 0.3194918
	speed: 0.5755s/iter; left time: 6685.5954s
	iters: 400, epoch: 4 | loss: 0.3196867
	speed: 0.5711s/iter; left time: 6577.7914s
	iters: 500, epoch: 4 | loss: 0.3253040
	speed: 0.5734s/iter; left time: 6546.8902s
	iters: 600, epoch: 4 | loss: 0.3472477
	speed: 0.5611s/iter; left time: 6350.8303s
	iters: 700, epoch: 4 | loss: 0.3144753
	speed: 0.5723s/iter; left time: 6420.1896s
Epoch: 4 cost time: 400.0407347679138
Epoch: 4, Steps: 701 | Train Loss: 0.3246275 Vali Loss: 0.4832904 Test Loss: 0.5584971
Validation loss decreased (0.568628 --> 0.483290).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.2885310
	speed: 1.0990s/iter; left time: 12217.8936s
	iters: 200, epoch: 5 | loss: 0.3023724
	speed: 0.5738s/iter; left time: 6321.1125s
	iters: 300, epoch: 5 | loss: 0.2890379
	speed: 0.5691s/iter; left time: 6212.9084s
	iters: 400, epoch: 5 | loss: 0.2878661
	speed: 0.5789s/iter; left time: 6262.1710s
	iters: 500, epoch: 5 | loss: 0.2895796
	speed: 0.5682s/iter; left time: 6089.4298s
	iters: 600, epoch: 5 | loss: 0.3222447
	speed: 0.5804s/iter; left time: 6162.5515s
	iters: 700, epoch: 5 | loss: 0.3043160
	speed: 0.5660s/iter; left time: 5952.0994s
Epoch: 5 cost time: 401.2452735900879
Epoch: 5, Steps: 701 | Train Loss: 0.2965240 Vali Loss: 0.4519297 Test Loss: 0.5243068
Validation loss decreased (0.483290 --> 0.451930).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.2528636
	speed: 1.0956s/iter; left time: 11411.7685s
	iters: 200, epoch: 6 | loss: 0.2632416
	speed: 0.5787s/iter; left time: 5969.3785s
	iters: 300, epoch: 6 | loss: 0.2761745
	speed: 0.5700s/iter; left time: 5822.8801s
	iters: 400, epoch: 6 | loss: 0.2715079
	speed: 0.5793s/iter; left time: 5859.9831s
	iters: 500, epoch: 6 | loss: 0.2954430
	speed: 0.5719s/iter; left time: 5728.2364s
	iters: 600, epoch: 6 | loss: 0.2769994
	speed: 0.5760s/iter; left time: 5712.0777s
	iters: 700, epoch: 6 | loss: 0.3177122
	speed: 0.5680s/iter; left time: 5575.0406s
Epoch: 6 cost time: 402.044132232666
Epoch: 6, Steps: 701 | Train Loss: 0.2822715 Vali Loss: 0.4358650 Test Loss: 0.5027710
Validation loss decreased (0.451930 --> 0.435865).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.2781726
	speed: 1.0893s/iter; left time: 10583.0037s
	iters: 200, epoch: 7 | loss: 0.2663240
	speed: 0.5740s/iter; left time: 5518.7280s
	iters: 300, epoch: 7 | loss: 0.3018194
	speed: 0.5701s/iter; left time: 5424.4176s
	iters: 400, epoch: 7 | loss: 0.2745388
	speed: 0.5715s/iter; left time: 5380.2056s
	iters: 500, epoch: 7 | loss: 0.2397011
	speed: 0.5767s/iter; left time: 5371.7610s
	iters: 600, epoch: 7 | loss: 0.2768001
	speed: 0.5642s/iter; left time: 5199.0497s
	iters: 700, epoch: 7 | loss: 0.2730476
	speed: 0.5721s/iter; left time: 5214.5709s
Epoch: 7 cost time: 400.529132604599
Epoch: 7, Steps: 701 | Train Loss: 0.2747206 Vali Loss: 0.4273705 Test Loss: 0.4920348
Validation loss decreased (0.435865 --> 0.427371).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.2949079
	speed: 1.1021s/iter; left time: 9933.8802s
	iters: 200, epoch: 8 | loss: 0.2389898
	speed: 0.5730s/iter; left time: 5107.3264s
	iters: 300, epoch: 8 | loss: 0.2764389
	speed: 0.5743s/iter; left time: 5062.2473s
	iters: 400, epoch: 8 | loss: 0.2786004
	speed: 0.5670s/iter; left time: 4940.8932s
	iters: 500, epoch: 8 | loss: 0.2815633
	speed: 0.5774s/iter; left time: 4973.6491s
	iters: 600, epoch: 8 | loss: 0.2750632
	speed: 0.5622s/iter; left time: 4786.3814s
	iters: 700, epoch: 8 | loss: 0.2583344
	speed: 0.5795s/iter; left time: 4875.9631s
Epoch: 8 cost time: 401.6601824760437
Epoch: 8, Steps: 701 | Train Loss: 0.2705064 Vali Loss: 0.4233865 Test Loss: 0.4867926
Validation loss decreased (0.427371 --> 0.423386).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.2535522
	speed: 1.1025s/iter; left time: 9164.8042s
	iters: 200, epoch: 9 | loss: 0.2413396
	speed: 0.5740s/iter; left time: 4714.0136s
	iters: 300, epoch: 9 | loss: 0.2984054
	speed: 0.5731s/iter; left time: 4649.4476s
	iters: 400, epoch: 9 | loss: 0.2531155
	speed: 0.5747s/iter; left time: 4605.0017s
	iters: 500, epoch: 9 | loss: 0.2642916
	speed: 0.5710s/iter; left time: 4518.0093s
	iters: 600, epoch: 9 | loss: 0.2500427
	speed: 0.5752s/iter; left time: 4494.2427s
	iters: 700, epoch: 9 | loss: 0.2573763
	speed: 0.5670s/iter; left time: 4373.1440s
Epoch: 9 cost time: 401.30174493789673
Epoch: 9, Steps: 701 | Train Loss: 0.2681896 Vali Loss: 0.4222643 Test Loss: 0.4853850
Validation loss decreased (0.423386 --> 0.422264).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.2572263
	speed: 1.0960s/iter; left time: 8343.1004s
	iters: 200, epoch: 10 | loss: 0.2749452
	speed: 0.5764s/iter; left time: 4330.0105s
	iters: 300, epoch: 10 | loss: 0.2370300
	speed: 0.5684s/iter; left time: 4213.2563s
	iters: 400, epoch: 10 | loss: 0.2575328
	speed: 0.5811s/iter; left time: 4248.7436s
	iters: 500, epoch: 10 | loss: 0.2691924
	speed: 0.5708s/iter; left time: 4116.9341s
	iters: 600, epoch: 10 | loss: 0.2596057
	speed: 0.5729s/iter; left time: 4074.2414s
	iters: 700, epoch: 10 | loss: 0.2602899
	speed: 0.5667s/iter; left time: 3973.8540s
Epoch: 10 cost time: 401.07808017730713
Epoch: 10, Steps: 701 | Train Loss: 0.2669276 Vali Loss: 0.4211689 Test Loss: 0.4842715
Validation loss decreased (0.422264 --> 0.421169).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.3018216
	speed: 1.0973s/iter; left time: 7583.4269s
	iters: 200, epoch: 11 | loss: 0.2830404
	speed: 0.5780s/iter; left time: 3936.7570s
	iters: 300, epoch: 11 | loss: 0.2653704
	speed: 0.5703s/iter; left time: 3827.5739s
	iters: 400, epoch: 11 | loss: 0.2646442
	speed: 0.5804s/iter; left time: 3836.8652s
	iters: 500, epoch: 11 | loss: 0.2579456
	speed: 0.5751s/iter; left time: 3744.2505s
	iters: 600, epoch: 11 | loss: 0.2515177
	speed: 0.5692s/iter; left time: 3648.9976s
	iters: 700, epoch: 11 | loss: 0.2575218
	speed: 0.5761s/iter; left time: 3635.6541s
Epoch: 11 cost time: 402.3142764568329
Epoch: 11, Steps: 701 | Train Loss: 0.2661952 Vali Loss: 0.4211048 Test Loss: 0.4833252
Validation loss decreased (0.421169 --> 0.421105).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.2671467
	speed: 1.1143s/iter; left time: 6919.6202s
	iters: 200, epoch: 12 | loss: 0.2798383
	speed: 0.5695s/iter; left time: 3479.8894s
	iters: 300, epoch: 12 | loss: 0.2643559
	speed: 0.5801s/iter; left time: 3486.1341s
	iters: 400, epoch: 12 | loss: 0.2417879
	speed: 0.5690s/iter; left time: 3362.9316s
	iters: 500, epoch: 12 | loss: 0.2521634
	speed: 0.5806s/iter; left time: 3373.0379s
	iters: 600, epoch: 12 | loss: 0.2515533
	speed: 0.5697s/iter; left time: 3252.8123s
	iters: 700, epoch: 12 | loss: 0.2819994
	speed: 0.5776s/iter; left time: 3240.6119s
Epoch: 12 cost time: 404.1356420516968
Epoch: 12, Steps: 701 | Train Loss: 0.2658222 Vali Loss: 0.4204156 Test Loss: 0.4833413
Validation loss decreased (0.421105 --> 0.420416).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.2649729
	speed: 1.1341s/iter; left time: 6247.7079s
	iters: 200, epoch: 13 | loss: 0.2564971
	speed: 0.5678s/iter; left time: 3071.0839s
	iters: 300, epoch: 13 | loss: 0.2659913
	speed: 0.5773s/iter; left time: 3064.8541s
	iters: 400, epoch: 13 | loss: 0.2674809
	speed: 0.5647s/iter; left time: 2941.4857s
	iters: 500, epoch: 13 | loss: 0.2590839
	speed: 0.5802s/iter; left time: 2964.0823s
	iters: 600, epoch: 13 | loss: 0.2538648
	speed: 0.5730s/iter; left time: 2870.3140s
	iters: 700, epoch: 13 | loss: 0.2582249
	speed: 0.5692s/iter; left time: 2794.1026s
Epoch: 13 cost time: 403.84707522392273
Epoch: 13, Steps: 701 | Train Loss: 0.2656361 Vali Loss: 0.4203940 Test Loss: 0.4832327
Validation loss decreased (0.420416 --> 0.420394).  Saving model ...
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 14 | loss: 0.2769053
	speed: 1.1079s/iter; left time: 5326.8118s
	iters: 200, epoch: 14 | loss: 0.2674476
	speed: 0.5727s/iter; left time: 2696.3871s
	iters: 300, epoch: 14 | loss: 0.2746369
	speed: 0.5662s/iter; left time: 2608.8606s
	iters: 400, epoch: 14 | loss: 0.2873849
	speed: 0.5733s/iter; left time: 2584.4256s
	iters: 500, epoch: 14 | loss: 0.2432274
	speed: 0.5627s/iter; left time: 2480.4787s
	iters: 600, epoch: 14 | loss: 0.2960952
	speed: 0.5748s/iter; left time: 2476.4297s
	iters: 700, epoch: 14 | loss: 0.2582593
	speed: 0.5644s/iter; left time: 2375.1938s
Epoch: 14 cost time: 400.197101354599
Epoch: 14, Steps: 701 | Train Loss: 0.2655321 Vali Loss: 0.4200669 Test Loss: 0.4832152
Validation loss decreased (0.420394 --> 0.420067).  Saving model ...
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 15 | loss: 0.2717836
	speed: 1.0961s/iter; left time: 4501.5727s
	iters: 200, epoch: 15 | loss: 0.2463757
	speed: 0.5759s/iter; left time: 2307.7023s
	iters: 300, epoch: 15 | loss: 0.2523484
	speed: 0.5676s/iter; left time: 2217.5048s
	iters: 400, epoch: 15 | loss: 0.2814651
	speed: 0.5752s/iter; left time: 2189.5980s
	iters: 500, epoch: 15 | loss: 0.2632391
	speed: 0.5675s/iter; left time: 2103.6230s
	iters: 600, epoch: 15 | loss: 0.2734761
	speed: 0.5659s/iter; left time: 2041.0923s
	iters: 700, epoch: 15 | loss: 0.2532459
	speed: 0.5661s/iter; left time: 1985.3582s
Epoch: 15 cost time: 399.0626585483551
Epoch: 15, Steps: 701 | Train Loss: 0.2654389 Vali Loss: 0.4205745 Test Loss: 0.4832115
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 16 | loss: 0.2484550
	speed: 0.9898s/iter; left time: 3371.2349s
	iters: 200, epoch: 16 | loss: 0.2644944
	speed: 0.5623s/iter; left time: 1858.9164s
	iters: 300, epoch: 16 | loss: 0.2457383
	speed: 0.5756s/iter; left time: 1845.5224s
	iters: 400, epoch: 16 | loss: 0.2663661
	speed: 0.5651s/iter; left time: 1755.2114s
	iters: 500, epoch: 16 | loss: 0.2868491
	speed: 0.5719s/iter; left time: 1719.2703s
	iters: 600, epoch: 16 | loss: 0.2552208
	speed: 0.5651s/iter; left time: 1642.1929s
	iters: 700, epoch: 16 | loss: 0.2776979
	speed: 0.5720s/iter; left time: 1605.0844s
Epoch: 16 cost time: 399.41359281539917
Epoch: 16, Steps: 701 | Train Loss: 0.2654452 Vali Loss: 0.4199272 Test Loss: 0.4832115
Validation loss decreased (0.420067 --> 0.419927).  Saving model ...
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 17 | loss: 0.2721688
	speed: 1.0986s/iter; left time: 2971.7798s
	iters: 200, epoch: 17 | loss: 0.2441094
	speed: 0.5633s/iter; left time: 1467.3594s
	iters: 300, epoch: 17 | loss: 0.2598401
	speed: 0.5713s/iter; left time: 1431.1625s
	iters: 400, epoch: 17 | loss: 0.2651427
	speed: 0.5610s/iter; left time: 1349.1164s
	iters: 500, epoch: 17 | loss: 0.2573068
	speed: 0.5682s/iter; left time: 1309.7746s
	iters: 600, epoch: 17 | loss: 0.2743105
	speed: 0.5698s/iter; left time: 1256.4175s
	iters: 700, epoch: 17 | loss: 0.2667026
	speed: 0.5766s/iter; left time: 1213.7537s
Epoch: 17 cost time: 399.1738975048065
Epoch: 17, Steps: 701 | Train Loss: 0.2654365 Vali Loss: 0.4203209 Test Loss: 0.4832131
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 18 | loss: 0.2647406
	speed: 0.9915s/iter; left time: 1987.0439s
	iters: 200, epoch: 18 | loss: 0.2630597
	speed: 0.5722s/iter; left time: 1089.4505s
	iters: 300, epoch: 18 | loss: 0.2712334
	speed: 0.5720s/iter; left time: 1031.8749s
	iters: 400, epoch: 18 | loss: 0.2598722
	speed: 0.5803s/iter; left time: 988.8566s
	iters: 500, epoch: 18 | loss: 0.2817269
	speed: 0.5619s/iter; left time: 901.3403s
	iters: 600, epoch: 18 | loss: 0.2678333
	speed: 0.5702s/iter; left time: 857.5067s
	iters: 700, epoch: 18 | loss: 0.2629464
	speed: 0.5611s/iter; left time: 787.7877s
Epoch: 18 cost time: 399.83186316490173
Epoch: 18, Steps: 701 | Train Loss: 0.2654022 Vali Loss: 0.4202409 Test Loss: 0.4832108
EarlyStopping counter: 2 out of 5
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 19 | loss: 0.2605059
	speed: 0.9875s/iter; left time: 1286.6994s
	iters: 200, epoch: 19 | loss: 0.2727589
	speed: 0.5692s/iter; left time: 684.7521s
	iters: 300, epoch: 19 | loss: 0.2685392
	speed: 0.5739s/iter; left time: 633.0139s
	iters: 400, epoch: 19 | loss: 0.2675399
	speed: 0.5691s/iter; left time: 570.8560s
	iters: 500, epoch: 19 | loss: 0.2776374
	speed: 0.5758s/iter; left time: 519.9618s
	iters: 600, epoch: 19 | loss: 0.2648467
	speed: 0.5672s/iter; left time: 455.4922s
	iters: 700, epoch: 19 | loss: 0.2736016
	speed: 0.5791s/iter; left time: 407.1198s
Epoch: 19 cost time: 400.56016874313354
Epoch: 19, Steps: 701 | Train Loss: 0.2654269 Vali Loss: 0.4205139 Test Loss: 0.4832105
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 20 | loss: 0.2742117
	speed: 1.0046s/iter; left time: 604.7432s
	iters: 200, epoch: 20 | loss: 0.2600544
	speed: 0.5681s/iter; left time: 285.2102s
	iters: 300, epoch: 20 | loss: 0.2610214
	speed: 0.5773s/iter; left time: 232.0687s
	iters: 400, epoch: 20 | loss: 0.2694822
	speed: 0.5668s/iter; left time: 171.1833s
	iters: 500, epoch: 20 | loss: 0.2713661
	speed: 0.5781s/iter; left time: 116.7857s
	iters: 600, epoch: 20 | loss: 0.2787108
	speed: 0.5654s/iter; left time: 57.6696s
	iters: 700, epoch: 20 | loss: 0.2791080
	speed: 0.5755s/iter; left time: 1.1510s
Epoch: 20 cost time: 402.2796025276184
Epoch: 20, Steps: 701 | Train Loss: 0.2653928 Vali Loss: 0.4200438 Test Loss: 0.4832106
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.9073486328125e-08
>>>>>>>testing : traffic_336_720_DLinear_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3293<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2789
mse:0.4830241799354553, mae:0.33073511719703674
