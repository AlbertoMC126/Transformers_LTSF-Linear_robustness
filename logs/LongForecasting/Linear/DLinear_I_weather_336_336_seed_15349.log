Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='DLinear', model_id='weather_336_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=336, root_path='./dataset/', save_pred_values=False, seed=15349, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : weather_336_336_DLinear_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15349>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36216
val 4935
test 10204
	iters: 100, epoch: 1 | loss: 1.1268824
	speed: 0.0455s/iter; left time: 2054.5792s
	iters: 200, epoch: 1 | loss: 2.2532337
	speed: 0.0449s/iter; left time: 2021.8244s
	iters: 300, epoch: 1 | loss: 0.5244776
	speed: 0.0441s/iter; left time: 1981.8945s
	iters: 400, epoch: 1 | loss: 0.7058384
	speed: 0.0432s/iter; left time: 1939.6992s
	iters: 500, epoch: 1 | loss: 0.6134387
	speed: 0.0446s/iter; left time: 1996.0820s
	iters: 600, epoch: 1 | loss: 1.1058751
	speed: 0.0484s/iter; left time: 2162.8847s
	iters: 700, epoch: 1 | loss: 1.1146166
	speed: 0.0460s/iter; left time: 2048.5962s
	iters: 800, epoch: 1 | loss: 0.5375612
	speed: 0.0470s/iter; left time: 2087.8503s
	iters: 900, epoch: 1 | loss: 1.6572461
	speed: 0.0454s/iter; left time: 2015.4208s
	iters: 1000, epoch: 1 | loss: 1.1809716
	speed: 0.0427s/iter; left time: 1890.8385s
	iters: 1100, epoch: 1 | loss: 0.6399570
	speed: 0.0465s/iter; left time: 2052.0115s
	iters: 1200, epoch: 1 | loss: 2.9521220
	speed: 0.0464s/iter; left time: 2046.5659s
	iters: 1300, epoch: 1 | loss: 0.5040087
	speed: 0.0446s/iter; left time: 1961.0253s
	iters: 1400, epoch: 1 | loss: 4.2331362
	speed: 0.0470s/iter; left time: 2059.4488s
	iters: 1500, epoch: 1 | loss: 0.6136084
	speed: 0.0448s/iter; left time: 1958.4144s
	iters: 1600, epoch: 1 | loss: 0.7246284
	speed: 0.0482s/iter; left time: 2104.9700s
	iters: 1700, epoch: 1 | loss: 0.4809482
	speed: 0.0463s/iter; left time: 2016.7075s
	iters: 1800, epoch: 1 | loss: 0.9328430
	speed: 0.0451s/iter; left time: 1958.3427s
	iters: 1900, epoch: 1 | loss: 1.0275228
	speed: 0.0456s/iter; left time: 1979.2849s
	iters: 2000, epoch: 1 | loss: 2.2584369
	speed: 0.0456s/iter; left time: 1974.4959s
	iters: 2100, epoch: 1 | loss: 0.6025901
	speed: 0.0441s/iter; left time: 1905.4268s
	iters: 2200, epoch: 1 | loss: 0.8156641
	speed: 0.0451s/iter; left time: 1943.9395s
Epoch: 1 cost time: 102.81144332885742
Epoch: 1, Steps: 2263 | Train Loss: 1.0511816 Vali Loss: 0.7683835 Test Loss: 0.3294617
Validation loss decreased (inf --> 0.768384).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 1.2227107
	speed: 0.1506s/iter; left time: 6459.8287s
	iters: 200, epoch: 2 | loss: 0.6642756
	speed: 0.0441s/iter; left time: 1889.4991s
	iters: 300, epoch: 2 | loss: 0.6498079
	speed: 0.0443s/iter; left time: 1891.0261s
	iters: 400, epoch: 2 | loss: 0.5378945
	speed: 0.0461s/iter; left time: 1961.9735s
	iters: 500, epoch: 2 | loss: 0.7067202
	speed: 0.0458s/iter; left time: 1945.0845s
	iters: 600, epoch: 2 | loss: 0.4701471
	speed: 0.0457s/iter; left time: 1938.8216s
	iters: 700, epoch: 2 | loss: 0.5619233
	speed: 0.0428s/iter; left time: 1812.4073s
	iters: 800, epoch: 2 | loss: 0.5058494
	speed: 0.0468s/iter; left time: 1974.4426s
	iters: 900, epoch: 2 | loss: 0.4818171
	speed: 0.0450s/iter; left time: 1895.9313s
	iters: 1000, epoch: 2 | loss: 0.6866914
	speed: 0.0456s/iter; left time: 1916.0114s
	iters: 1100, epoch: 2 | loss: 0.5154656
	speed: 0.0446s/iter; left time: 1866.5663s
	iters: 1200, epoch: 2 | loss: 0.4710317
	speed: 0.0454s/iter; left time: 1899.1146s
	iters: 1300, epoch: 2 | loss: 0.6054244
	speed: 0.0428s/iter; left time: 1784.1371s
	iters: 1400, epoch: 2 | loss: 2.5152469
	speed: 0.0439s/iter; left time: 1824.1382s
	iters: 1500, epoch: 2 | loss: 0.5399885
	speed: 0.0419s/iter; left time: 1737.3976s
	iters: 1600, epoch: 2 | loss: 0.5113186
	speed: 0.0458s/iter; left time: 1897.4385s
	iters: 1700, epoch: 2 | loss: 3.2935212
	speed: 0.0468s/iter; left time: 1931.2392s
	iters: 1800, epoch: 2 | loss: 0.6626822
	speed: 0.0454s/iter; left time: 1870.1813s
	iters: 1900, epoch: 2 | loss: 0.5756266
	speed: 0.0444s/iter; left time: 1823.2022s
	iters: 2000, epoch: 2 | loss: 0.8254386
	speed: 0.0456s/iter; left time: 1868.8711s
	iters: 2100, epoch: 2 | loss: 0.5803360
	speed: 0.0450s/iter; left time: 1841.1704s
	iters: 2200, epoch: 2 | loss: 3.4748452
	speed: 0.0461s/iter; left time: 1880.3066s
Epoch: 2 cost time: 101.71518898010254
Epoch: 2, Steps: 2263 | Train Loss: 1.1798819 Vali Loss: 0.7597050 Test Loss: 0.3480210
Validation loss decreased (0.768384 --> 0.759705).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.5221530
	speed: 0.1546s/iter; left time: 6283.0247s
	iters: 200, epoch: 3 | loss: 0.9702615
	speed: 0.0449s/iter; left time: 1820.7157s
	iters: 300, epoch: 3 | loss: 0.5096754
	speed: 0.0460s/iter; left time: 1858.7014s
	iters: 400, epoch: 3 | loss: 0.5746533
	speed: 0.0470s/iter; left time: 1897.1557s
	iters: 500, epoch: 3 | loss: 1.0522038
	speed: 0.0464s/iter; left time: 1867.7105s
	iters: 600, epoch: 3 | loss: 0.6757256
	speed: 0.0454s/iter; left time: 1822.9111s
	iters: 700, epoch: 3 | loss: 0.8586116
	speed: 0.0445s/iter; left time: 1782.2710s
	iters: 800, epoch: 3 | loss: 0.5573834
	speed: 0.0456s/iter; left time: 1821.4671s
	iters: 900, epoch: 3 | loss: 0.3518340
	speed: 0.0464s/iter; left time: 1847.8770s
	iters: 1000, epoch: 3 | loss: 2.4986672
	speed: 0.0462s/iter; left time: 1836.1514s
	iters: 1100, epoch: 3 | loss: 0.4054161
	speed: 0.0441s/iter; left time: 1746.1958s
	iters: 1200, epoch: 3 | loss: 0.4136589
	speed: 0.0465s/iter; left time: 1840.2204s
	iters: 1300, epoch: 3 | loss: 0.3304464
	speed: 0.0440s/iter; left time: 1734.1814s
	iters: 1400, epoch: 3 | loss: 0.4991434
	speed: 0.0469s/iter; left time: 1846.1003s
	iters: 1500, epoch: 3 | loss: 0.5383830
	speed: 0.0480s/iter; left time: 1882.9023s
	iters: 1600, epoch: 3 | loss: 0.4521958
	speed: 0.0467s/iter; left time: 1828.9176s
	iters: 1700, epoch: 3 | loss: 1.5599474
	speed: 0.0442s/iter; left time: 1724.7602s
	iters: 1800, epoch: 3 | loss: 0.4282141
	speed: 0.0443s/iter; left time: 1723.6281s
	iters: 1900, epoch: 3 | loss: 1.8660685
	speed: 0.0449s/iter; left time: 1741.9410s
	iters: 2000, epoch: 3 | loss: 1.0485914
	speed: 0.0475s/iter; left time: 1841.3289s
	iters: 2100, epoch: 3 | loss: 0.4337312
	speed: 0.0466s/iter; left time: 1799.0611s
	iters: 2200, epoch: 3 | loss: 0.4508261
	speed: 0.0461s/iter; left time: 1777.3907s
Epoch: 3 cost time: 103.15728211402893
Epoch: 3, Steps: 2263 | Train Loss: 0.7838254 Vali Loss: 0.5809507 Test Loss: 0.2743787
Validation loss decreased (0.759705 --> 0.580951).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.3430307
	speed: 0.1484s/iter; left time: 5693.4995s
	iters: 200, epoch: 4 | loss: 0.5520509
	speed: 0.0444s/iter; left time: 1699.1924s
	iters: 300, epoch: 4 | loss: 0.4058465
	speed: 0.0466s/iter; left time: 1778.2205s
	iters: 400, epoch: 4 | loss: 0.3538034
	speed: 0.0459s/iter; left time: 1748.8017s
	iters: 500, epoch: 4 | loss: 0.7717392
	speed: 0.0436s/iter; left time: 1654.4978s
	iters: 600, epoch: 4 | loss: 0.4549079
	speed: 0.0434s/iter; left time: 1643.5691s
	iters: 700, epoch: 4 | loss: 0.3239892
	speed: 0.0431s/iter; left time: 1628.4650s
	iters: 800, epoch: 4 | loss: 0.4504310
	speed: 0.0453s/iter; left time: 1708.3568s
	iters: 900, epoch: 4 | loss: 0.4817090
	speed: 0.0429s/iter; left time: 1610.2111s
	iters: 1000, epoch: 4 | loss: 0.5043097
	speed: 0.0451s/iter; left time: 1689.1806s
	iters: 1100, epoch: 4 | loss: 0.3286111
	speed: 0.0454s/iter; left time: 1696.3081s
	iters: 1200, epoch: 4 | loss: 0.3323326
	speed: 0.0451s/iter; left time: 1681.6113s
	iters: 1300, epoch: 4 | loss: 0.4843135
	speed: 0.0435s/iter; left time: 1618.4962s
	iters: 1400, epoch: 4 | loss: 0.5791363
	speed: 0.0461s/iter; left time: 1708.2452s
	iters: 1500, epoch: 4 | loss: 0.6426775
	speed: 0.0447s/iter; left time: 1652.8924s
	iters: 1600, epoch: 4 | loss: 0.9764931
	speed: 0.0434s/iter; left time: 1601.1787s
	iters: 1700, epoch: 4 | loss: 0.3720139
	speed: 0.0462s/iter; left time: 1700.4483s
	iters: 1800, epoch: 4 | loss: 0.5036849
	speed: 0.0447s/iter; left time: 1640.8244s
	iters: 1900, epoch: 4 | loss: 0.7080840
	speed: 0.0437s/iter; left time: 1598.1360s
	iters: 2000, epoch: 4 | loss: 0.5631660
	speed: 0.0457s/iter; left time: 1665.9320s
	iters: 2100, epoch: 4 | loss: 0.5290234
	speed: 0.0455s/iter; left time: 1653.6899s
	iters: 2200, epoch: 4 | loss: 0.3219971
	speed: 0.0463s/iter; left time: 1681.0459s
Epoch: 4 cost time: 101.37408757209778
Epoch: 4, Steps: 2263 | Train Loss: 0.5848946 Vali Loss: 0.5329508 Test Loss: 0.2601011
Validation loss decreased (0.580951 --> 0.532951).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.4246618
	speed: 0.1534s/iter; left time: 5539.9572s
	iters: 200, epoch: 5 | loss: 0.3119139
	speed: 0.0436s/iter; left time: 1570.8881s
	iters: 300, epoch: 5 | loss: 0.3621641
	speed: 0.0467s/iter; left time: 1677.0521s
	iters: 400, epoch: 5 | loss: 0.4918749
	speed: 0.0474s/iter; left time: 1695.7542s
	iters: 500, epoch: 5 | loss: 0.9421622
	speed: 0.0461s/iter; left time: 1645.0731s
	iters: 600, epoch: 5 | loss: 0.5283004
	speed: 0.0484s/iter; left time: 1723.0614s
	iters: 700, epoch: 5 | loss: 0.3128546
	speed: 0.0460s/iter; left time: 1633.6226s
	iters: 800, epoch: 5 | loss: 0.3674723
	speed: 0.0457s/iter; left time: 1616.5503s
	iters: 900, epoch: 5 | loss: 0.9010688
	speed: 0.0454s/iter; left time: 1603.7601s
	iters: 1000, epoch: 5 | loss: 0.3988595
	speed: 0.0441s/iter; left time: 1551.1397s
	iters: 1100, epoch: 5 | loss: 0.7701223
	speed: 0.0435s/iter; left time: 1528.9097s
	iters: 1200, epoch: 5 | loss: 0.4711798
	speed: 0.0455s/iter; left time: 1592.6007s
	iters: 1300, epoch: 5 | loss: 0.3780778
	speed: 0.0440s/iter; left time: 1537.1312s
	iters: 1400, epoch: 5 | loss: 1.4094739
	speed: 0.0429s/iter; left time: 1491.9256s
	iters: 1500, epoch: 5 | loss: 0.4592678
	speed: 0.0456s/iter; left time: 1584.1296s
	iters: 1600, epoch: 5 | loss: 0.5209541
	speed: 0.0438s/iter; left time: 1514.4014s
	iters: 1700, epoch: 5 | loss: 0.3935116
	speed: 0.0458s/iter; left time: 1580.6164s
	iters: 1800, epoch: 5 | loss: 1.0191072
	speed: 0.0463s/iter; left time: 1592.4439s
	iters: 1900, epoch: 5 | loss: 0.3983325
	speed: 0.0443s/iter; left time: 1521.2236s
	iters: 2000, epoch: 5 | loss: 0.3788278
	speed: 0.0450s/iter; left time: 1540.9148s
	iters: 2100, epoch: 5 | loss: 0.6513242
	speed: 0.0468s/iter; left time: 1597.0539s
	iters: 2200, epoch: 5 | loss: 0.4309964
	speed: 0.0451s/iter; left time: 1534.9294s
Epoch: 5 cost time: 101.96604800224304
Epoch: 5, Steps: 2263 | Train Loss: 0.5301018 Vali Loss: 0.5173463 Test Loss: 0.2468625
Validation loss decreased (0.532951 --> 0.517346).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.4650904
	speed: 0.1499s/iter; left time: 5074.0849s
	iters: 200, epoch: 6 | loss: 0.4437248
	speed: 0.0438s/iter; left time: 1478.8950s
	iters: 300, epoch: 6 | loss: 0.4332235
	speed: 0.0448s/iter; left time: 1508.8222s
	iters: 400, epoch: 6 | loss: 0.3757836
	speed: 0.0452s/iter; left time: 1516.5654s
	iters: 500, epoch: 6 | loss: 0.3572160
	speed: 0.0458s/iter; left time: 1532.1946s
	iters: 600, epoch: 6 | loss: 0.5366597
	speed: 0.0441s/iter; left time: 1470.9287s
	iters: 700, epoch: 6 | loss: 0.4182844
	speed: 0.0460s/iter; left time: 1528.3972s
	iters: 800, epoch: 6 | loss: 1.0416272
	speed: 0.0465s/iter; left time: 1541.1302s
	iters: 900, epoch: 6 | loss: 0.4445453
	speed: 0.0444s/iter; left time: 1466.4915s
	iters: 1000, epoch: 6 | loss: 0.5697876
	speed: 0.0469s/iter; left time: 1545.0607s
	iters: 1100, epoch: 6 | loss: 0.4271770
	speed: 0.0454s/iter; left time: 1490.7066s
	iters: 1200, epoch: 6 | loss: 0.4104500
	speed: 0.0442s/iter; left time: 1446.2998s
	iters: 1300, epoch: 6 | loss: 0.6435898
	speed: 0.0457s/iter; left time: 1490.7217s
	iters: 1400, epoch: 6 | loss: 0.4380857
	speed: 0.0473s/iter; left time: 1539.3148s
	iters: 1500, epoch: 6 | loss: 0.8754905
	speed: 0.0435s/iter; left time: 1410.2487s
	iters: 1600, epoch: 6 | loss: 0.6464525
	speed: 0.0445s/iter; left time: 1440.2826s
	iters: 1700, epoch: 6 | loss: 1.4006528
	speed: 0.0436s/iter; left time: 1407.1466s
	iters: 1800, epoch: 6 | loss: 0.9647430
	speed: 0.0441s/iter; left time: 1418.2942s
	iters: 1900, epoch: 6 | loss: 0.3175229
	speed: 0.0438s/iter; left time: 1403.3867s
	iters: 2000, epoch: 6 | loss: 0.4645761
	speed: 0.0426s/iter; left time: 1359.9561s
	iters: 2100, epoch: 6 | loss: 0.5137647
	speed: 0.0444s/iter; left time: 1415.0845s
	iters: 2200, epoch: 6 | loss: 0.8464571
	speed: 0.0457s/iter; left time: 1450.5221s
Epoch: 6 cost time: 100.87091565132141
Epoch: 6, Steps: 2263 | Train Loss: 0.5102231 Vali Loss: 0.5125529 Test Loss: 0.2530135
Validation loss decreased (0.517346 --> 0.512553).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.5392553
	speed: 0.1556s/iter; left time: 4915.5041s
	iters: 200, epoch: 7 | loss: 0.4898943
	speed: 0.0431s/iter; left time: 1357.6164s
	iters: 300, epoch: 7 | loss: 0.4250962
	speed: 0.0457s/iter; left time: 1434.3673s
	iters: 400, epoch: 7 | loss: 0.2960667
	speed: 0.0463s/iter; left time: 1447.4295s
	iters: 500, epoch: 7 | loss: 0.4896464
	speed: 0.0462s/iter; left time: 1439.4573s
	iters: 600, epoch: 7 | loss: 0.4980716
	speed: 0.0440s/iter; left time: 1368.6044s
	iters: 700, epoch: 7 | loss: 0.4883782
	speed: 0.0454s/iter; left time: 1408.1441s
	iters: 800, epoch: 7 | loss: 0.6571245
	speed: 0.0470s/iter; left time: 1450.8198s
	iters: 900, epoch: 7 | loss: 0.3650382
	speed: 0.0452s/iter; left time: 1391.9406s
	iters: 1000, epoch: 7 | loss: 0.3495356
	speed: 0.0455s/iter; left time: 1395.5842s
	iters: 1100, epoch: 7 | loss: 0.3608124
	speed: 0.0451s/iter; left time: 1379.9977s
	iters: 1200, epoch: 7 | loss: 0.4327618
	speed: 0.0446s/iter; left time: 1359.0063s
	iters: 1300, epoch: 7 | loss: 0.4686356
	speed: 0.0433s/iter; left time: 1315.9167s
	iters: 1400, epoch: 7 | loss: 0.4597083
	speed: 0.0444s/iter; left time: 1343.4968s
	iters: 1500, epoch: 7 | loss: 0.4055914
	speed: 0.0419s/iter; left time: 1264.9222s
	iters: 1600, epoch: 7 | loss: 0.3928182
	speed: 0.0465s/iter; left time: 1397.8878s
	iters: 1700, epoch: 7 | loss: 0.3382764
	speed: 0.0439s/iter; left time: 1317.4886s
	iters: 1800, epoch: 7 | loss: 0.4296071
	speed: 0.0458s/iter; left time: 1367.2841s
	iters: 1900, epoch: 7 | loss: 0.4327497
	speed: 0.0447s/iter; left time: 1332.4553s
	iters: 2000, epoch: 7 | loss: 0.4228228
	speed: 0.0458s/iter; left time: 1358.0597s
	iters: 2100, epoch: 7 | loss: 0.5066315
	speed: 0.0433s/iter; left time: 1279.8999s
	iters: 2200, epoch: 7 | loss: 0.4935053
	speed: 0.0446s/iter; left time: 1314.1983s
Epoch: 7 cost time: 100.88296151161194
Epoch: 7, Steps: 2263 | Train Loss: 0.5017847 Vali Loss: 0.4988657 Test Loss: 0.2443188
Validation loss decreased (0.512553 --> 0.498866).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.4887347
	speed: 0.1528s/iter; left time: 4478.9535s
	iters: 200, epoch: 8 | loss: 0.3435524
	speed: 0.0452s/iter; left time: 1320.9836s
	iters: 300, epoch: 8 | loss: 0.9350960
	speed: 0.0474s/iter; left time: 1380.0525s
	iters: 400, epoch: 8 | loss: 0.3428498
	speed: 0.0462s/iter; left time: 1340.5897s
	iters: 500, epoch: 8 | loss: 0.6024616
	speed: 0.0437s/iter; left time: 1263.5894s
	iters: 600, epoch: 8 | loss: 0.4320456
	speed: 0.0474s/iter; left time: 1365.3415s
	iters: 700, epoch: 8 | loss: 1.0072880
	speed: 0.0468s/iter; left time: 1344.2570s
	iters: 800, epoch: 8 | loss: 0.4469120
	speed: 0.0458s/iter; left time: 1309.8867s
	iters: 900, epoch: 8 | loss: 0.3965386
	speed: 0.0471s/iter; left time: 1341.9024s
	iters: 1000, epoch: 8 | loss: 0.4346791
	speed: 0.0425s/iter; left time: 1206.8331s
	iters: 1100, epoch: 8 | loss: 0.4483148
	speed: 0.0452s/iter; left time: 1278.9819s
	iters: 1200, epoch: 8 | loss: 0.5512750
	speed: 0.0474s/iter; left time: 1337.7583s
	iters: 1300, epoch: 8 | loss: 0.3550558
	speed: 0.0441s/iter; left time: 1241.3159s
	iters: 1400, epoch: 8 | loss: 0.9768804
	speed: 0.0445s/iter; left time: 1246.3325s
	iters: 1500, epoch: 8 | loss: 0.4789948
	speed: 0.0453s/iter; left time: 1264.7311s
	iters: 1600, epoch: 8 | loss: 0.3773311
	speed: 0.0454s/iter; left time: 1262.8350s
	iters: 1700, epoch: 8 | loss: 0.3281295
	speed: 0.0444s/iter; left time: 1231.6428s
	iters: 1800, epoch: 8 | loss: 0.4077290
	speed: 0.0469s/iter; left time: 1294.2252s
	iters: 1900, epoch: 8 | loss: 0.4564748
	speed: 0.0437s/iter; left time: 1202.0523s
	iters: 2000, epoch: 8 | loss: 0.2911134
	speed: 0.0461s/iter; left time: 1264.7984s
	iters: 2100, epoch: 8 | loss: 0.3757558
	speed: 0.0476s/iter; left time: 1301.0884s
	iters: 2200, epoch: 8 | loss: 0.3399961
	speed: 0.0440s/iter; left time: 1197.2583s
Epoch: 8 cost time: 102.27041745185852
Epoch: 8, Steps: 2263 | Train Loss: 0.4976336 Vali Loss: 0.4999498 Test Loss: 0.2443988
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.4695789
	speed: 0.1537s/iter; left time: 4157.7419s
	iters: 200, epoch: 9 | loss: 0.3627066
	speed: 0.0440s/iter; left time: 1186.4433s
	iters: 300, epoch: 9 | loss: 0.3743843
	speed: 0.0448s/iter; left time: 1203.2783s
	iters: 400, epoch: 9 | loss: 0.3398265
	speed: 0.0463s/iter; left time: 1240.1115s
	iters: 500, epoch: 9 | loss: 0.7978226
	speed: 0.0453s/iter; left time: 1208.5328s
	iters: 600, epoch: 9 | loss: 0.2969756
	speed: 0.0474s/iter; left time: 1258.3538s
	iters: 700, epoch: 9 | loss: 0.3681467
	speed: 0.0460s/iter; left time: 1216.3386s
	iters: 800, epoch: 9 | loss: 0.3408495
	speed: 0.0463s/iter; left time: 1219.1618s
	iters: 900, epoch: 9 | loss: 0.3918052
	speed: 0.0472s/iter; left time: 1239.9906s
	iters: 1000, epoch: 9 | loss: 0.4468205
	speed: 0.0452s/iter; left time: 1183.1958s
	iters: 1100, epoch: 9 | loss: 1.0401261
	speed: 0.0459s/iter; left time: 1195.6023s
	iters: 1200, epoch: 9 | loss: 0.4587297
	speed: 0.0454s/iter; left time: 1179.6074s
	iters: 1300, epoch: 9 | loss: 0.3485752
	speed: 0.0455s/iter; left time: 1177.2595s
	iters: 1400, epoch: 9 | loss: 0.6077799
	speed: 0.0450s/iter; left time: 1158.1540s
	iters: 1500, epoch: 9 | loss: 0.3846335
	speed: 0.0452s/iter; left time: 1159.4965s
	iters: 1600, epoch: 9 | loss: 1.0528727
	speed: 0.0492s/iter; left time: 1257.9927s
	iters: 1700, epoch: 9 | loss: 0.4141332
	speed: 0.0479s/iter; left time: 1218.3727s
	iters: 1800, epoch: 9 | loss: 0.4115510
	speed: 0.0450s/iter; left time: 1140.7329s
	iters: 1900, epoch: 9 | loss: 0.4106256
	speed: 0.0455s/iter; left time: 1148.6893s
	iters: 2000, epoch: 9 | loss: 0.4675304
	speed: 0.0436s/iter; left time: 1097.7205s
	iters: 2100, epoch: 9 | loss: 0.4857534
	speed: 0.0435s/iter; left time: 1089.7966s
	iters: 2200, epoch: 9 | loss: 0.4280279
	speed: 0.0456s/iter; left time: 1136.8574s
Epoch: 9 cost time: 102.65384292602539
Epoch: 9, Steps: 2263 | Train Loss: 0.4955433 Vali Loss: 0.4899997 Test Loss: 0.2414191
Validation loss decreased (0.498866 --> 0.490000).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.3015554
	speed: 0.1591s/iter; left time: 3943.7777s
	iters: 200, epoch: 10 | loss: 0.3178598
	speed: 0.0451s/iter; left time: 1113.5053s
	iters: 300, epoch: 10 | loss: 0.3343656
	speed: 0.0454s/iter; left time: 1116.7697s
	iters: 400, epoch: 10 | loss: 0.3878169
	speed: 0.0453s/iter; left time: 1109.8774s
	iters: 500, epoch: 10 | loss: 0.3737509
	speed: 0.0426s/iter; left time: 1039.4423s
	iters: 600, epoch: 10 | loss: 0.4854178
	speed: 0.0461s/iter; left time: 1119.4868s
	iters: 700, epoch: 10 | loss: 0.3877361
	speed: 0.0438s/iter; left time: 1058.7061s
	iters: 800, epoch: 10 | loss: 0.3486502
	speed: 0.0421s/iter; left time: 1015.2079s
	iters: 900, epoch: 10 | loss: 0.4116174
	speed: 0.0467s/iter; left time: 1119.5141s
	iters: 1000, epoch: 10 | loss: 0.4690392
	speed: 0.0448s/iter; left time: 1070.9126s
	iters: 1100, epoch: 10 | loss: 0.4039755
	speed: 0.0445s/iter; left time: 1058.7822s
	iters: 1200, epoch: 10 | loss: 0.3867912
	speed: 0.0444s/iter; left time: 1051.1326s
	iters: 1300, epoch: 10 | loss: 0.4314092
	speed: 0.0451s/iter; left time: 1065.2596s
	iters: 1400, epoch: 10 | loss: 0.3046759
	speed: 0.0465s/iter; left time: 1092.8688s
	iters: 1500, epoch: 10 | loss: 0.3266876
	speed: 0.0449s/iter; left time: 1050.7345s
	iters: 1600, epoch: 10 | loss: 0.4772109
	speed: 0.0429s/iter; left time: 998.6137s
	iters: 1700, epoch: 10 | loss: 0.4159599
	speed: 0.0434s/iter; left time: 1007.0538s
	iters: 1800, epoch: 10 | loss: 0.3738046
	speed: 0.0433s/iter; left time: 1000.0299s
	iters: 1900, epoch: 10 | loss: 0.3277802
	speed: 0.0462s/iter; left time: 1062.6600s
	iters: 2000, epoch: 10 | loss: 0.3932693
	speed: 0.0460s/iter; left time: 1052.4577s
	iters: 2100, epoch: 10 | loss: 0.3992739
	speed: 0.0455s/iter; left time: 1036.3493s
	iters: 2200, epoch: 10 | loss: 0.3211653
	speed: 0.0436s/iter; left time: 988.8032s
Epoch: 10 cost time: 100.60417890548706
Epoch: 10, Steps: 2263 | Train Loss: 0.4944317 Vali Loss: 0.4935028 Test Loss: 0.2403651
EarlyStopping counter: 1 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.4330769
	speed: 0.1530s/iter; left time: 3446.1814s
	iters: 200, epoch: 11 | loss: 0.4720964
	speed: 0.0443s/iter; left time: 993.0986s
	iters: 300, epoch: 11 | loss: 0.4200004
	speed: 0.0428s/iter; left time: 955.7533s
	iters: 400, epoch: 11 | loss: 0.3095494
	speed: 0.0435s/iter; left time: 966.6152s
	iters: 500, epoch: 11 | loss: 1.0013871
	speed: 0.0450s/iter; left time: 995.9830s
	iters: 600, epoch: 11 | loss: 0.3034238
	speed: 0.0464s/iter; left time: 1022.0437s
	iters: 700, epoch: 11 | loss: 0.5570643
	speed: 0.0472s/iter; left time: 1035.9212s
	iters: 800, epoch: 11 | loss: 0.2958803
	speed: 0.0433s/iter; left time: 944.5627s
	iters: 900, epoch: 11 | loss: 0.4246912
	speed: 0.0451s/iter; left time: 980.9200s
	iters: 1000, epoch: 11 | loss: 0.4936825
	speed: 0.0414s/iter; left time: 895.5914s
	iters: 1100, epoch: 11 | loss: 0.4023728
	speed: 0.0450s/iter; left time: 969.7703s
	iters: 1200, epoch: 11 | loss: 0.4538793
	speed: 0.0437s/iter; left time: 936.1137s
	iters: 1300, epoch: 11 | loss: 0.4128043
	speed: 0.0478s/iter; left time: 1020.6002s
	iters: 1400, epoch: 11 | loss: 0.3970583
	speed: 0.0483s/iter; left time: 1025.0784s
	iters: 1500, epoch: 11 | loss: 0.3201787
	speed: 0.0452s/iter; left time: 954.9224s
	iters: 1600, epoch: 11 | loss: 2.0033197
	speed: 0.0444s/iter; left time: 934.3042s
	iters: 1700, epoch: 11 | loss: 0.3942957
	speed: 0.0461s/iter; left time: 965.2145s
	iters: 1800, epoch: 11 | loss: 0.9198274
	speed: 0.0453s/iter; left time: 943.9699s
	iters: 1900, epoch: 11 | loss: 0.5260902
	speed: 0.0445s/iter; left time: 923.5647s
	iters: 2000, epoch: 11 | loss: 0.4199459
	speed: 0.0455s/iter; left time: 937.7898s
	iters: 2100, epoch: 11 | loss: 0.3336647
	speed: 0.0443s/iter; left time: 909.3971s
	iters: 2200, epoch: 11 | loss: 0.9897689
	speed: 0.0427s/iter; left time: 873.0949s
Epoch: 11 cost time: 100.99176573753357
Epoch: 11, Steps: 2263 | Train Loss: 0.4938647 Vali Loss: 0.4937937 Test Loss: 0.2400467
EarlyStopping counter: 2 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.8714630
	speed: 0.1457s/iter; left time: 2952.6637s
	iters: 200, epoch: 12 | loss: 0.3897836
	speed: 0.0424s/iter; left time: 855.6571s
	iters: 300, epoch: 12 | loss: 0.3691728
	speed: 0.0443s/iter; left time: 888.3797s
	iters: 400, epoch: 12 | loss: 0.3871197
	speed: 0.0442s/iter; left time: 882.1481s
	iters: 500, epoch: 12 | loss: 0.4148725
	speed: 0.0457s/iter; left time: 908.3387s
	iters: 600, epoch: 12 | loss: 0.9956086
	speed: 0.0455s/iter; left time: 899.8409s
	iters: 700, epoch: 12 | loss: 0.3641852
	speed: 0.0441s/iter; left time: 868.2030s
	iters: 800, epoch: 12 | loss: 0.3296817
	speed: 0.0452s/iter; left time: 884.8863s
	iters: 900, epoch: 12 | loss: 0.9797515
	speed: 0.0427s/iter; left time: 832.1237s
	iters: 1000, epoch: 12 | loss: 0.3071612
	speed: 0.0467s/iter; left time: 905.2438s
	iters: 1100, epoch: 12 | loss: 0.3741639
	speed: 0.0449s/iter; left time: 865.4723s
	iters: 1200, epoch: 12 | loss: 0.3902502
	speed: 0.0434s/iter; left time: 832.5021s
	iters: 1300, epoch: 12 | loss: 0.4163894
	speed: 0.0453s/iter; left time: 864.3505s
	iters: 1400, epoch: 12 | loss: 0.5198294
	speed: 0.0449s/iter; left time: 851.8875s
	iters: 1500, epoch: 12 | loss: 0.4994196
	speed: 0.0457s/iter; left time: 862.8505s
	iters: 1600, epoch: 12 | loss: 0.3312239
	speed: 0.0460s/iter; left time: 863.9212s
	iters: 1700, epoch: 12 | loss: 0.4285170
	speed: 0.0430s/iter; left time: 802.5431s
	iters: 1800, epoch: 12 | loss: 0.3290737
	speed: 0.0456s/iter; left time: 846.7108s
	iters: 1900, epoch: 12 | loss: 0.3975841
	speed: 0.0461s/iter; left time: 851.7485s
	iters: 2000, epoch: 12 | loss: 0.4610238
	speed: 0.0452s/iter; left time: 829.9411s
	iters: 2100, epoch: 12 | loss: 0.3464952
	speed: 0.0443s/iter; left time: 809.3156s
	iters: 2200, epoch: 12 | loss: 0.4182605
	speed: 0.0438s/iter; left time: 795.0829s
Epoch: 12 cost time: 100.56246519088745
Epoch: 12, Steps: 2263 | Train Loss: 0.4936158 Vali Loss: 0.4924827 Test Loss: 0.2402931
EarlyStopping counter: 3 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.8503844
	speed: 0.1550s/iter; left time: 2790.2937s
	iters: 200, epoch: 13 | loss: 0.3327211
	speed: 0.0450s/iter; left time: 804.8663s
	iters: 300, epoch: 13 | loss: 0.4468427
	speed: 0.0433s/iter; left time: 770.3110s
	iters: 400, epoch: 13 | loss: 0.3717858
	speed: 0.0408s/iter; left time: 722.5825s
	iters: 500, epoch: 13 | loss: 0.4177355
	speed: 0.0446s/iter; left time: 784.9437s
	iters: 600, epoch: 13 | loss: 0.4838887
	speed: 0.0429s/iter; left time: 750.3861s
	iters: 700, epoch: 13 | loss: 0.3110408
	speed: 0.0485s/iter; left time: 843.9531s
	iters: 800, epoch: 13 | loss: 0.4512586
	speed: 0.0441s/iter; left time: 762.8872s
	iters: 900, epoch: 13 | loss: 0.4378810
	speed: 0.0438s/iter; left time: 753.9730s
	iters: 1000, epoch: 13 | loss: 0.4894838
	speed: 0.0424s/iter; left time: 725.8492s
	iters: 1100, epoch: 13 | loss: 0.4663009
	speed: 0.0469s/iter; left time: 797.1912s
	iters: 1200, epoch: 13 | loss: 0.5470849
	speed: 0.0467s/iter; left time: 790.0528s
	iters: 1300, epoch: 13 | loss: 0.4243876
	speed: 0.0475s/iter; left time: 798.6007s
	iters: 1400, epoch: 13 | loss: 0.4231318
	speed: 0.0434s/iter; left time: 725.6578s
	iters: 1500, epoch: 13 | loss: 0.5067382
	speed: 0.0423s/iter; left time: 701.5710s
	iters: 1600, epoch: 13 | loss: 0.5543478
	speed: 0.0437s/iter; left time: 720.8886s
	iters: 1700, epoch: 13 | loss: 0.4833841
	speed: 0.0447s/iter; left time: 732.6824s
	iters: 1800, epoch: 13 | loss: 0.4603425
	speed: 0.0447s/iter; left time: 728.3627s
	iters: 1900, epoch: 13 | loss: 0.3756977
	speed: 0.0440s/iter; left time: 713.0234s
	iters: 2000, epoch: 13 | loss: 0.3234392
	speed: 0.0459s/iter; left time: 739.9130s
	iters: 2100, epoch: 13 | loss: 0.3091678
	speed: 0.0447s/iter; left time: 715.2385s
	iters: 2200, epoch: 13 | loss: 0.3998564
	speed: 0.0442s/iter; left time: 703.6577s
Epoch: 13 cost time: 100.15619587898254
Epoch: 13, Steps: 2263 | Train Loss: 0.4934819 Vali Loss: 0.4929270 Test Loss: 0.2400198
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.4938959
	speed: 0.1503s/iter; left time: 2366.3384s
	iters: 200, epoch: 14 | loss: 0.3988742
	speed: 0.0436s/iter; left time: 681.2554s
	iters: 300, epoch: 14 | loss: 0.4315295
	speed: 0.0429s/iter; left time: 667.4841s
	iters: 400, epoch: 14 | loss: 0.5406237
	speed: 0.0429s/iter; left time: 661.8850s
	iters: 500, epoch: 14 | loss: 0.3543383
	speed: 0.0440s/iter; left time: 674.9599s
	iters: 600, epoch: 14 | loss: 1.2369413
	speed: 0.0462s/iter; left time: 704.4394s
	iters: 700, epoch: 14 | loss: 0.3018775
	speed: 0.0453s/iter; left time: 686.2137s
	iters: 800, epoch: 14 | loss: 0.4562300
	speed: 0.0471s/iter; left time: 708.8076s
	iters: 900, epoch: 14 | loss: 0.3547594
	speed: 0.0476s/iter; left time: 711.1557s
	iters: 1000, epoch: 14 | loss: 0.3311318
	speed: 0.0450s/iter; left time: 668.5140s
	iters: 1100, epoch: 14 | loss: 0.3782453
	speed: 0.0455s/iter; left time: 671.1362s
	iters: 1200, epoch: 14 | loss: 0.3650487
	speed: 0.0474s/iter; left time: 694.5549s
	iters: 1300, epoch: 14 | loss: 0.3640968
	speed: 0.0452s/iter; left time: 657.6255s
	iters: 1400, epoch: 14 | loss: 0.4115838
	speed: 0.0422s/iter; left time: 608.7638s
	iters: 1500, epoch: 14 | loss: 0.4164394
	speed: 0.0460s/iter; left time: 660.0509s
	iters: 1600, epoch: 14 | loss: 0.2977402
	speed: 0.0454s/iter; left time: 645.8874s
	iters: 1700, epoch: 14 | loss: 0.3742578
	speed: 0.0456s/iter; left time: 644.5873s
	iters: 1800, epoch: 14 | loss: 0.4225059
	speed: 0.0441s/iter; left time: 618.6506s
	iters: 1900, epoch: 14 | loss: 0.8707131
	speed: 0.0424s/iter; left time: 591.5640s
	iters: 2000, epoch: 14 | loss: 0.4188224
	speed: 0.0471s/iter; left time: 652.1035s
	iters: 2100, epoch: 14 | loss: 0.4169326
	speed: 0.0415s/iter; left time: 570.7420s
	iters: 2200, epoch: 14 | loss: 0.4586699
	speed: 0.0435s/iter; left time: 593.6633s
Epoch: 14 cost time: 100.8160092830658
Epoch: 14, Steps: 2263 | Train Loss: 0.4933870 Vali Loss: 0.4927702 Test Loss: 0.2399793
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : weather_336_336_DLinear_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15349<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10204
mse:0.24148601293563843, mae:0.3013038635253906
