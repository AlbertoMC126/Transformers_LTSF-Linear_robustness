Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='NLinear', model_id='weather_96_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=15726, seq_len=96, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_96_96_NLinear_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15726>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36696
val 5175
test 10444
Total number of trainable parameters: 195552
Total number of parameters: 195552
	iters: 100, epoch: 1 | loss: 0.4884154
	speed: 0.0806s/iter; left time: 3690.5286s
	iters: 200, epoch: 1 | loss: 0.3058753
	speed: 0.0317s/iter; left time: 1448.4257s
	iters: 300, epoch: 1 | loss: 0.3310131
	speed: 0.0316s/iter; left time: 1439.9862s
	iters: 400, epoch: 1 | loss: 0.4509295
	speed: 0.0318s/iter; left time: 1444.0037s
	iters: 500, epoch: 1 | loss: 0.4987062
	speed: 0.0315s/iter; left time: 1427.9532s
	iters: 600, epoch: 1 | loss: 2.2594748
	speed: 0.0316s/iter; left time: 1428.2432s
	iters: 700, epoch: 1 | loss: 0.6888838
	speed: 0.0315s/iter; left time: 1421.4303s
	iters: 800, epoch: 1 | loss: 0.3436952
	speed: 0.0315s/iter; left time: 1417.3980s
	iters: 900, epoch: 1 | loss: 0.5398531
	speed: 0.0316s/iter; left time: 1422.4331s
	iters: 1000, epoch: 1 | loss: 0.3071851
	speed: 0.0317s/iter; left time: 1423.8419s
	iters: 1100, epoch: 1 | loss: 0.9203981
	speed: 0.0316s/iter; left time: 1416.4396s
	iters: 1200, epoch: 1 | loss: 0.4372393
	speed: 0.0318s/iter; left time: 1419.2649s
	iters: 1300, epoch: 1 | loss: 0.3273468
	speed: 0.0318s/iter; left time: 1417.9212s
	iters: 1400, epoch: 1 | loss: 2.8651335
	speed: 0.0313s/iter; left time: 1392.9810s
	iters: 1500, epoch: 1 | loss: 0.4440404
	speed: 0.0314s/iter; left time: 1391.3783s
	iters: 1600, epoch: 1 | loss: 0.3384495
	speed: 0.0315s/iter; left time: 1392.6706s
	iters: 1700, epoch: 1 | loss: 0.2964636
	speed: 0.0313s/iter; left time: 1383.4724s
	iters: 1800, epoch: 1 | loss: 0.3154167
	speed: 0.0315s/iter; left time: 1390.0729s
	iters: 1900, epoch: 1 | loss: 1.3884438
	speed: 0.0314s/iter; left time: 1379.5002s
	iters: 2000, epoch: 1 | loss: 0.3112289
	speed: 0.0313s/iter; left time: 1373.0359s
	iters: 2100, epoch: 1 | loss: 0.4644073
	speed: 0.0314s/iter; left time: 1375.0938s
	iters: 2200, epoch: 1 | loss: 0.3808375
	speed: 0.0316s/iter; left time: 1378.0755s
Epoch: 1 cost time: 77.24322986602783
Epoch: 1, Steps: 2293 | Train Loss: 0.6317806 Vali Loss: 0.5269895 Test Loss: 0.1851161
Validation loss decreased (inf --> 0.526989).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.3178377
	speed: 0.1097s/iter; left time: 4770.4372s
	iters: 200, epoch: 2 | loss: 0.3944553
	speed: 0.0318s/iter; left time: 1380.8070s
	iters: 300, epoch: 2 | loss: 0.3219970
	speed: 0.0314s/iter; left time: 1357.4952s
	iters: 400, epoch: 2 | loss: 0.2576241
	speed: 0.0314s/iter; left time: 1356.0069s
	iters: 500, epoch: 2 | loss: 0.4850162
	speed: 0.0315s/iter; left time: 1355.8239s
	iters: 600, epoch: 2 | loss: 0.3153951
	speed: 0.0317s/iter; left time: 1360.9548s
	iters: 700, epoch: 2 | loss: 0.4391293
	speed: 0.0317s/iter; left time: 1360.3868s
	iters: 800, epoch: 2 | loss: 0.4035597
	speed: 0.0317s/iter; left time: 1355.7210s
	iters: 900, epoch: 2 | loss: 0.3779240
	speed: 0.0315s/iter; left time: 1345.4811s
	iters: 1000, epoch: 2 | loss: 2.3920929
	speed: 0.0314s/iter; left time: 1336.8827s
	iters: 1100, epoch: 2 | loss: 0.3314398
	speed: 0.0317s/iter; left time: 1347.1895s
	iters: 1200, epoch: 2 | loss: 0.3389112
	speed: 0.0317s/iter; left time: 1342.0184s
	iters: 1300, epoch: 2 | loss: 6.1662188
	speed: 0.0317s/iter; left time: 1340.7820s
	iters: 1400, epoch: 2 | loss: 0.3309444
	speed: 0.0317s/iter; left time: 1338.8180s
	iters: 1500, epoch: 2 | loss: 0.4022403
	speed: 0.0316s/iter; left time: 1331.4161s
	iters: 1600, epoch: 2 | loss: 0.4023366
	speed: 0.0315s/iter; left time: 1323.3281s
	iters: 1700, epoch: 2 | loss: 0.3195006
	speed: 0.0317s/iter; left time: 1325.2435s
	iters: 1800, epoch: 2 | loss: 0.3619295
	speed: 0.0316s/iter; left time: 1321.7891s
	iters: 1900, epoch: 2 | loss: 0.4068469
	speed: 0.0314s/iter; left time: 1306.9788s
	iters: 2000, epoch: 2 | loss: 0.5145559
	speed: 0.0316s/iter; left time: 1311.8111s
	iters: 2100, epoch: 2 | loss: 0.6550169
	speed: 0.0317s/iter; left time: 1314.9793s
	iters: 2200, epoch: 2 | loss: 0.3652637
	speed: 0.0313s/iter; left time: 1296.1883s
Epoch: 2 cost time: 72.35351324081421
Epoch: 2, Steps: 2293 | Train Loss: 0.7953830 Vali Loss: 0.8361431 Test Loss: 0.1806609
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.3767701
	speed: 0.1091s/iter; left time: 4491.9982s
	iters: 200, epoch: 3 | loss: 0.5731331
	speed: 0.0316s/iter; left time: 1299.2849s
	iters: 300, epoch: 3 | loss: 0.4150307
	speed: 0.0314s/iter; left time: 1286.5216s
	iters: 400, epoch: 3 | loss: 0.4051462
	speed: 0.0318s/iter; left time: 1298.9055s
	iters: 500, epoch: 3 | loss: 0.4163923
	speed: 0.0315s/iter; left time: 1283.1419s
	iters: 600, epoch: 3 | loss: 0.2394995
	speed: 0.0317s/iter; left time: 1289.0269s
	iters: 700, epoch: 3 | loss: 0.4856674
	speed: 0.0314s/iter; left time: 1273.5862s
	iters: 800, epoch: 3 | loss: 0.4561621
	speed: 0.0316s/iter; left time: 1280.7642s
	iters: 900, epoch: 3 | loss: 0.4748313
	speed: 0.0315s/iter; left time: 1272.9262s
	iters: 1000, epoch: 3 | loss: 0.5187871
	speed: 0.0314s/iter; left time: 1265.5127s
	iters: 1100, epoch: 3 | loss: 0.3200791
	speed: 0.0318s/iter; left time: 1276.4855s
	iters: 1200, epoch: 3 | loss: 0.3745616
	speed: 0.0314s/iter; left time: 1257.8686s
	iters: 1300, epoch: 3 | loss: 0.7373089
	speed: 0.0316s/iter; left time: 1262.2446s
	iters: 1400, epoch: 3 | loss: 0.3598391
	speed: 0.0315s/iter; left time: 1254.5699s
	iters: 1500, epoch: 3 | loss: 1.1398867
	speed: 0.0314s/iter; left time: 1249.9878s
	iters: 1600, epoch: 3 | loss: 2.1857138
	speed: 0.0313s/iter; left time: 1243.0861s
	iters: 1700, epoch: 3 | loss: 0.3456150
	speed: 0.0314s/iter; left time: 1242.1649s
	iters: 1800, epoch: 3 | loss: 0.9139820
	speed: 0.0312s/iter; left time: 1233.1137s
	iters: 1900, epoch: 3 | loss: 0.3273945
	speed: 0.0314s/iter; left time: 1238.0640s
	iters: 2000, epoch: 3 | loss: 0.4672259
	speed: 0.0313s/iter; left time: 1230.8338s
	iters: 2100, epoch: 3 | loss: 0.7861344
	speed: 0.0315s/iter; left time: 1233.5892s
	iters: 2200, epoch: 3 | loss: 0.2143183
	speed: 0.0312s/iter; left time: 1220.9455s
Epoch: 3 cost time: 72.1484522819519
Epoch: 3, Steps: 2293 | Train Loss: 7.0259322 Vali Loss: 0.4270575 Test Loss: 0.1734821
Validation loss decreased (0.526989 --> 0.427058).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.3815641
	speed: 0.1109s/iter; left time: 4312.5223s
	iters: 200, epoch: 4 | loss: 0.3460867
	speed: 0.0315s/iter; left time: 1221.6265s
	iters: 300, epoch: 4 | loss: 0.3246132
	speed: 0.0314s/iter; left time: 1216.3044s
	iters: 400, epoch: 4 | loss: 0.1958556
	speed: 0.0317s/iter; left time: 1221.5636s
	iters: 500, epoch: 4 | loss: 0.4491769
	speed: 0.0314s/iter; left time: 1208.9166s
	iters: 600, epoch: 4 | loss: 0.2503456
	speed: 0.0314s/iter; left time: 1206.3314s
	iters: 700, epoch: 4 | loss: 0.2526556
	speed: 0.0313s/iter; left time: 1198.3606s
	iters: 800, epoch: 4 | loss: 0.7467760
	speed: 0.0314s/iter; left time: 1199.8896s
	iters: 900, epoch: 4 | loss: 0.3940359
	speed: 0.0316s/iter; left time: 1205.2111s
	iters: 1000, epoch: 4 | loss: 0.3775338
	speed: 0.0317s/iter; left time: 1204.3792s
	iters: 1100, epoch: 4 | loss: 0.3005037
	speed: 0.0315s/iter; left time: 1192.3197s
	iters: 1200, epoch: 4 | loss: 0.6410502
	speed: 0.0316s/iter; left time: 1193.6904s
	iters: 1300, epoch: 4 | loss: 0.2535067
	speed: 0.0318s/iter; left time: 1196.6261s
	iters: 1400, epoch: 4 | loss: 0.2615344
	speed: 0.0315s/iter; left time: 1183.6459s
	iters: 1500, epoch: 4 | loss: 0.3206407
	speed: 0.0314s/iter; left time: 1178.1945s
	iters: 1600, epoch: 4 | loss: 0.4669180
	speed: 0.0316s/iter; left time: 1181.3956s
	iters: 1700, epoch: 4 | loss: 0.4348015
	speed: 0.0316s/iter; left time: 1177.2652s
	iters: 1800, epoch: 4 | loss: 2.2119157
	speed: 0.0315s/iter; left time: 1170.1410s
	iters: 1900, epoch: 4 | loss: 0.3245161
	speed: 0.0318s/iter; left time: 1179.0434s
	iters: 2000, epoch: 4 | loss: 0.5183741
	speed: 0.0315s/iter; left time: 1164.9604s
	iters: 2100, epoch: 4 | loss: 0.2651774
	speed: 0.0316s/iter; left time: 1164.1058s
	iters: 2200, epoch: 4 | loss: 0.2675854
	speed: 0.0319s/iter; left time: 1172.1802s
Epoch: 4 cost time: 72.21481037139893
Epoch: 4, Steps: 2293 | Train Loss: 1.4101726 Vali Loss: 0.5977144 Test Loss: 0.1691255
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.3272545
	speed: 0.1088s/iter; left time: 3982.5327s
	iters: 200, epoch: 5 | loss: 0.2776144
	speed: 0.0319s/iter; left time: 1163.2188s
	iters: 300, epoch: 5 | loss: 0.6544303
	speed: 0.0316s/iter; left time: 1151.4087s
	iters: 400, epoch: 5 | loss: 0.4212474
	speed: 0.0314s/iter; left time: 1140.6198s
	iters: 500, epoch: 5 | loss: 0.3879088
	speed: 0.0315s/iter; left time: 1141.5076s
	iters: 600, epoch: 5 | loss: 0.3592735
	speed: 0.0314s/iter; left time: 1132.9159s
	iters: 700, epoch: 5 | loss: 0.5731675
	speed: 0.0318s/iter; left time: 1144.3636s
	iters: 800, epoch: 5 | loss: 0.6283535
	speed: 0.0315s/iter; left time: 1128.8899s
	iters: 900, epoch: 5 | loss: 0.5204535
	speed: 0.0315s/iter; left time: 1127.8279s
	iters: 1000, epoch: 5 | loss: 0.6738855
	speed: 0.0318s/iter; left time: 1133.3725s
	iters: 1100, epoch: 5 | loss: 0.3321318
	speed: 0.0315s/iter; left time: 1119.5685s
	iters: 1200, epoch: 5 | loss: 0.6201791
	speed: 0.0316s/iter; left time: 1122.5106s
	iters: 1300, epoch: 5 | loss: 0.2665423
	speed: 0.0315s/iter; left time: 1113.8630s
	iters: 1400, epoch: 5 | loss: 0.1889115
	speed: 0.0316s/iter; left time: 1113.4720s
	iters: 1500, epoch: 5 | loss: 0.3796539
	speed: 0.0315s/iter; left time: 1108.3732s
	iters: 1600, epoch: 5 | loss: 0.3743342
	speed: 0.0319s/iter; left time: 1119.5637s
	iters: 1700, epoch: 5 | loss: 0.2577384
	speed: 0.0316s/iter; left time: 1105.3004s
	iters: 1800, epoch: 5 | loss: 0.3597852
	speed: 0.0318s/iter; left time: 1108.1140s
	iters: 1900, epoch: 5 | loss: 0.3831397
	speed: 0.0316s/iter; left time: 1099.1734s
	iters: 2000, epoch: 5 | loss: 0.2825888
	speed: 0.0317s/iter; left time: 1099.6113s
	iters: 2100, epoch: 5 | loss: 0.2772677
	speed: 0.0318s/iter; left time: 1099.8578s
	iters: 2200, epoch: 5 | loss: 2.2779727
	speed: 0.0316s/iter; left time: 1088.5472s
Epoch: 5 cost time: 72.39701175689697
Epoch: 5, Steps: 2293 | Train Loss: 0.6038171 Vali Loss: 0.4269699 Test Loss: 0.1659144
Validation loss decreased (0.427058 --> 0.426970).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.2698300
	speed: 0.1100s/iter; left time: 3771.8813s
	iters: 200, epoch: 6 | loss: 0.6959257
	speed: 0.0317s/iter; left time: 1085.4835s
	iters: 300, epoch: 6 | loss: 0.2835174
	speed: 0.0313s/iter; left time: 1068.1668s
	iters: 400, epoch: 6 | loss: 0.4197346
	speed: 0.0315s/iter; left time: 1072.0131s
	iters: 500, epoch: 6 | loss: 0.3161286
	speed: 0.0315s/iter; left time: 1068.7104s
	iters: 600, epoch: 6 | loss: 0.3025852
	speed: 0.0316s/iter; left time: 1068.2551s
	iters: 700, epoch: 6 | loss: 0.3621666
	speed: 0.0316s/iter; left time: 1063.2524s
	iters: 800, epoch: 6 | loss: 0.4926912
	speed: 0.0314s/iter; left time: 1053.7077s
	iters: 900, epoch: 6 | loss: 0.3529567
	speed: 0.0316s/iter; left time: 1057.9343s
	iters: 1000, epoch: 6 | loss: 0.8102423
	speed: 0.0314s/iter; left time: 1047.0718s
	iters: 1100, epoch: 6 | loss: 0.3188842
	speed: 0.0316s/iter; left time: 1051.3876s
	iters: 1200, epoch: 6 | loss: 0.7380840
	speed: 0.0313s/iter; left time: 1040.2218s
	iters: 1300, epoch: 6 | loss: 0.2841922
	speed: 0.0313s/iter; left time: 1036.0320s
	iters: 1400, epoch: 6 | loss: 0.4183878
	speed: 0.0315s/iter; left time: 1040.6902s
	iters: 1500, epoch: 6 | loss: 0.2792571
	speed: 0.0315s/iter; left time: 1037.6662s
	iters: 1600, epoch: 6 | loss: 0.8942988
	speed: 0.0316s/iter; left time: 1037.8396s
	iters: 1700, epoch: 6 | loss: 4.1021371
	speed: 0.0314s/iter; left time: 1028.1500s
	iters: 1800, epoch: 6 | loss: 2.3021629
	speed: 0.0312s/iter; left time: 1018.4962s
	iters: 1900, epoch: 6 | loss: 0.5839969
	speed: 0.0312s/iter; left time: 1014.1253s
	iters: 2000, epoch: 6 | loss: 0.3039717
	speed: 0.0313s/iter; left time: 1014.3942s
	iters: 2100, epoch: 6 | loss: 0.3172615
	speed: 0.0316s/iter; left time: 1019.6413s
	iters: 2200, epoch: 6 | loss: 0.2399846
	speed: 0.0314s/iter; left time: 1010.2585s
Epoch: 6 cost time: 72.03422570228577
Epoch: 6, Steps: 2293 | Train Loss: 0.4646140 Vali Loss: 0.4238855 Test Loss: 0.1657201
Validation loss decreased (0.426970 --> 0.423885).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.3023560
	speed: 0.1092s/iter; left time: 3495.4224s
	iters: 200, epoch: 7 | loss: 0.2120028
	speed: 0.0318s/iter; left time: 1014.4060s
	iters: 300, epoch: 7 | loss: 0.3118832
	speed: 0.0315s/iter; left time: 1001.6869s
	iters: 400, epoch: 7 | loss: 0.2840928
	speed: 0.0313s/iter; left time: 993.8685s
	iters: 500, epoch: 7 | loss: 0.5451161
	speed: 0.0316s/iter; left time: 999.4280s
	iters: 600, epoch: 7 | loss: 0.2730808
	speed: 0.0316s/iter; left time: 996.5654s
	iters: 700, epoch: 7 | loss: 0.3883579
	speed: 0.0314s/iter; left time: 987.0317s
	iters: 800, epoch: 7 | loss: 0.3121698
	speed: 0.0317s/iter; left time: 991.6762s
	iters: 900, epoch: 7 | loss: 0.2925771
	speed: 0.0314s/iter; left time: 981.0073s
	iters: 1000, epoch: 7 | loss: 0.2791807
	speed: 0.0317s/iter; left time: 987.4122s
	iters: 1100, epoch: 7 | loss: 0.2578006
	speed: 0.0318s/iter; left time: 984.7684s
	iters: 1200, epoch: 7 | loss: 0.3979489
	speed: 0.0317s/iter; left time: 978.4729s
	iters: 1300, epoch: 7 | loss: 0.4087135
	speed: 0.0316s/iter; left time: 974.6393s
	iters: 1400, epoch: 7 | loss: 0.5147541
	speed: 0.0315s/iter; left time: 968.2685s
	iters: 1500, epoch: 7 | loss: 0.3588725
	speed: 0.0317s/iter; left time: 970.3482s
	iters: 1600, epoch: 7 | loss: 0.2876042
	speed: 0.0316s/iter; left time: 964.1126s
	iters: 1700, epoch: 7 | loss: 0.2873429
	speed: 0.0316s/iter; left time: 959.3521s
	iters: 1800, epoch: 7 | loss: 0.6161210
	speed: 0.0316s/iter; left time: 958.9050s
	iters: 1900, epoch: 7 | loss: 0.3675745
	speed: 0.0317s/iter; left time: 956.7484s
	iters: 2000, epoch: 7 | loss: 0.2964962
	speed: 0.0316s/iter; left time: 951.3100s
	iters: 2100, epoch: 7 | loss: 0.2327293
	speed: 0.0314s/iter; left time: 942.0151s
	iters: 2200, epoch: 7 | loss: 0.2001064
	speed: 0.0316s/iter; left time: 944.2271s
Epoch: 7 cost time: 72.26345896720886
Epoch: 7, Steps: 2293 | Train Loss: 0.4520654 Vali Loss: 0.4193308 Test Loss: 0.1651967
Validation loss decreased (0.423885 --> 0.419331).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.6473341
	speed: 0.1100s/iter; left time: 3269.2562s
	iters: 200, epoch: 8 | loss: 0.5063192
	speed: 0.0319s/iter; left time: 945.1904s
	iters: 300, epoch: 8 | loss: 0.2869225
	speed: 0.0319s/iter; left time: 940.2261s
	iters: 400, epoch: 8 | loss: 0.3921092
	speed: 0.0315s/iter; left time: 927.7962s
	iters: 500, epoch: 8 | loss: 0.2958001
	speed: 0.0318s/iter; left time: 931.9177s
	iters: 600, epoch: 8 | loss: 0.5574024
	speed: 0.0319s/iter; left time: 931.1841s
	iters: 700, epoch: 8 | loss: 0.4091728
	speed: 0.0317s/iter; left time: 922.5685s
	iters: 800, epoch: 8 | loss: 0.3119363
	speed: 0.0316s/iter; left time: 918.0157s
	iters: 900, epoch: 8 | loss: 0.3054724
	speed: 0.0315s/iter; left time: 911.4023s
	iters: 1000, epoch: 8 | loss: 0.3496980
	speed: 0.0316s/iter; left time: 908.9934s
	iters: 1100, epoch: 8 | loss: 0.3144865
	speed: 0.0314s/iter; left time: 901.7896s
	iters: 1200, epoch: 8 | loss: 0.3967584
	speed: 0.0314s/iter; left time: 898.4391s
	iters: 1300, epoch: 8 | loss: 0.2909091
	speed: 0.0317s/iter; left time: 904.4802s
	iters: 1400, epoch: 8 | loss: 0.4226695
	speed: 0.0316s/iter; left time: 898.4571s
	iters: 1500, epoch: 8 | loss: 0.3634085
	speed: 0.0316s/iter; left time: 893.2915s
	iters: 1600, epoch: 8 | loss: 0.4039407
	speed: 0.0315s/iter; left time: 889.5049s
	iters: 1700, epoch: 8 | loss: 0.5226933
	speed: 0.0316s/iter; left time: 888.1369s
	iters: 1800, epoch: 8 | loss: 0.3552830
	speed: 0.0316s/iter; left time: 885.4252s
	iters: 1900, epoch: 8 | loss: 0.2996260
	speed: 0.0315s/iter; left time: 879.6357s
	iters: 2000, epoch: 8 | loss: 0.3304595
	speed: 0.0313s/iter; left time: 871.7456s
	iters: 2100, epoch: 8 | loss: 0.3659545
	speed: 0.0316s/iter; left time: 874.6210s
	iters: 2200, epoch: 8 | loss: 0.2728998
	speed: 0.0314s/iter; left time: 868.2606s
Epoch: 8 cost time: 72.30633020401001
Epoch: 8, Steps: 2293 | Train Loss: 0.4499258 Vali Loss: 0.4234183 Test Loss: 0.1650143
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.5909252
	speed: 0.1085s/iter; left time: 2974.5796s
	iters: 200, epoch: 9 | loss: 0.6941949
	speed: 0.0317s/iter; left time: 865.6346s
	iters: 300, epoch: 9 | loss: 0.2740830
	speed: 0.0315s/iter; left time: 858.0752s
	iters: 400, epoch: 9 | loss: 0.4066033
	speed: 0.0316s/iter; left time: 857.1944s
	iters: 500, epoch: 9 | loss: 0.2451412
	speed: 0.0316s/iter; left time: 853.7147s
	iters: 600, epoch: 9 | loss: 0.5291817
	speed: 0.0314s/iter; left time: 846.5375s
	iters: 700, epoch: 9 | loss: 2.2243919
	speed: 0.0317s/iter; left time: 848.9975s
	iters: 800, epoch: 9 | loss: 0.3530815
	speed: 0.0314s/iter; left time: 840.1147s
	iters: 900, epoch: 9 | loss: 0.2542524
	speed: 0.0315s/iter; left time: 839.6158s
	iters: 1000, epoch: 9 | loss: 0.5212725
	speed: 0.0314s/iter; left time: 833.7967s
	iters: 1100, epoch: 9 | loss: 0.4616281
	speed: 0.0314s/iter; left time: 829.8312s
	iters: 1200, epoch: 9 | loss: 0.2356407
	speed: 0.0313s/iter; left time: 822.5268s
	iters: 1300, epoch: 9 | loss: 0.3254282
	speed: 0.0315s/iter; left time: 826.9369s
	iters: 1400, epoch: 9 | loss: 0.2526176
	speed: 0.0316s/iter; left time: 824.1714s
	iters: 1500, epoch: 9 | loss: 0.4692512
	speed: 0.0313s/iter; left time: 813.7788s
	iters: 1600, epoch: 9 | loss: 0.3088479
	speed: 0.0315s/iter; left time: 815.1534s
	iters: 1700, epoch: 9 | loss: 0.6680442
	speed: 0.0313s/iter; left time: 808.1876s
	iters: 1800, epoch: 9 | loss: 0.3460668
	speed: 0.0315s/iter; left time: 809.3100s
	iters: 1900, epoch: 9 | loss: 0.2780610
	speed: 0.0316s/iter; left time: 808.5947s
	iters: 2000, epoch: 9 | loss: 0.3684561
	speed: 0.0314s/iter; left time: 800.6109s
	iters: 2100, epoch: 9 | loss: 0.3072548
	speed: 0.0316s/iter; left time: 803.6383s
	iters: 2200, epoch: 9 | loss: 0.3309999
	speed: 0.0317s/iter; left time: 802.9963s
Epoch: 9 cost time: 72.13932418823242
Epoch: 9, Steps: 2293 | Train Loss: 0.4485753 Vali Loss: 0.4212664 Test Loss: 0.1645058
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.2128580
	speed: 0.1093s/iter; left time: 2745.9224s
	iters: 200, epoch: 10 | loss: 0.2157670
	speed: 0.0317s/iter; left time: 792.9789s
	iters: 300, epoch: 10 | loss: 0.3650477
	speed: 0.0313s/iter; left time: 778.9074s
	iters: 400, epoch: 10 | loss: 0.2690399
	speed: 0.0316s/iter; left time: 784.0377s
	iters: 500, epoch: 10 | loss: 0.3263682
	speed: 0.0314s/iter; left time: 777.0086s
	iters: 600, epoch: 10 | loss: 0.2026255
	speed: 0.0314s/iter; left time: 774.3475s
	iters: 700, epoch: 10 | loss: 0.2800461
	speed: 0.0318s/iter; left time: 779.0517s
	iters: 800, epoch: 10 | loss: 0.2539963
	speed: 0.0319s/iter; left time: 778.0845s
	iters: 900, epoch: 10 | loss: 0.2061986
	speed: 0.0318s/iter; left time: 772.8358s
	iters: 1000, epoch: 10 | loss: 0.2629755
	speed: 0.0318s/iter; left time: 769.2762s
	iters: 1100, epoch: 10 | loss: 0.4059972
	speed: 0.0316s/iter; left time: 762.6916s
	iters: 1200, epoch: 10 | loss: 0.4568069
	speed: 0.0316s/iter; left time: 760.2860s
	iters: 1300, epoch: 10 | loss: 0.3513656
	speed: 0.0315s/iter; left time: 752.8540s
	iters: 1400, epoch: 10 | loss: 0.3481767
	speed: 0.0317s/iter; left time: 754.7487s
	iters: 1500, epoch: 10 | loss: 0.3196538
	speed: 0.0316s/iter; left time: 749.0933s
	iters: 1600, epoch: 10 | loss: 0.2766828
	speed: 0.0316s/iter; left time: 746.7109s
	iters: 1700, epoch: 10 | loss: 0.2648536
	speed: 0.0314s/iter; left time: 737.4889s
	iters: 1800, epoch: 10 | loss: 0.5563320
	speed: 0.0317s/iter; left time: 743.2531s
	iters: 1900, epoch: 10 | loss: 0.4683554
	speed: 0.0317s/iter; left time: 738.3164s
	iters: 2000, epoch: 10 | loss: 0.3565121
	speed: 0.0316s/iter; left time: 733.2990s
	iters: 2100, epoch: 10 | loss: 0.2535507
	speed: 0.0314s/iter; left time: 726.5126s
	iters: 2200, epoch: 10 | loss: 0.2895653
	speed: 0.0316s/iter; left time: 727.9501s
Epoch: 10 cost time: 72.30866384506226
Epoch: 10, Steps: 2293 | Train Loss: 0.4479745 Vali Loss: 0.4203885 Test Loss: 0.1646333
EarlyStopping counter: 3 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.4368982
	speed: 0.1091s/iter; left time: 2491.1023s
	iters: 200, epoch: 11 | loss: 0.2413951
	speed: 0.0315s/iter; left time: 716.8387s
	iters: 300, epoch: 11 | loss: 0.3104751
	speed: 0.0314s/iter; left time: 711.4659s
	iters: 400, epoch: 11 | loss: 0.2778396
	speed: 0.0316s/iter; left time: 712.4972s
	iters: 500, epoch: 11 | loss: 0.2708123
	speed: 0.0316s/iter; left time: 709.5065s
	iters: 600, epoch: 11 | loss: 0.3580416
	speed: 0.0314s/iter; left time: 700.1456s
	iters: 700, epoch: 11 | loss: 0.2242752
	speed: 0.0316s/iter; left time: 701.5782s
	iters: 800, epoch: 11 | loss: 0.2862632
	speed: 0.0316s/iter; left time: 699.3787s
	iters: 900, epoch: 11 | loss: 0.6114626
	speed: 0.0314s/iter; left time: 692.4458s
	iters: 1000, epoch: 11 | loss: 0.2757882
	speed: 0.0317s/iter; left time: 694.2367s
	iters: 1100, epoch: 11 | loss: 0.2037289
	speed: 0.0317s/iter; left time: 691.0697s
	iters: 1200, epoch: 11 | loss: 0.5750713
	speed: 0.0317s/iter; left time: 687.8676s
	iters: 1300, epoch: 11 | loss: 0.3604150
	speed: 0.0314s/iter; left time: 680.1936s
	iters: 1400, epoch: 11 | loss: 0.3958313
	speed: 0.0317s/iter; left time: 681.9502s
	iters: 1500, epoch: 11 | loss: 0.3032248
	speed: 0.0314s/iter; left time: 673.7924s
	iters: 1600, epoch: 11 | loss: 0.2835879
	speed: 0.0317s/iter; left time: 676.5535s
	iters: 1700, epoch: 11 | loss: 0.3073973
	speed: 0.0318s/iter; left time: 676.0117s
	iters: 1800, epoch: 11 | loss: 0.2559625
	speed: 0.0314s/iter; left time: 664.5684s
	iters: 1900, epoch: 11 | loss: 0.3785544
	speed: 0.0316s/iter; left time: 663.6047s
	iters: 2000, epoch: 11 | loss: 0.2800571
	speed: 0.0316s/iter; left time: 662.3349s
	iters: 2100, epoch: 11 | loss: 2.5817454
	speed: 0.0316s/iter; left time: 658.6158s
	iters: 2200, epoch: 11 | loss: 0.3512433
	speed: 0.0315s/iter; left time: 653.0488s
Epoch: 11 cost time: 72.23643255233765
Epoch: 11, Steps: 2293 | Train Loss: 0.4476170 Vali Loss: 0.4201753 Test Loss: 0.1645369
EarlyStopping counter: 4 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.2589203
	speed: 0.1030s/iter; left time: 2114.7762s
	iters: 200, epoch: 12 | loss: 0.2892884
	speed: 0.0280s/iter; left time: 572.0000s
	iters: 300, epoch: 12 | loss: 0.1959458
	speed: 0.0275s/iter; left time: 558.6529s
	iters: 400, epoch: 12 | loss: 0.3746461
	speed: 0.0255s/iter; left time: 516.7221s
	iters: 500, epoch: 12 | loss: 0.2132088
	speed: 0.0254s/iter; left time: 511.9984s
	iters: 600, epoch: 12 | loss: 0.4096583
	speed: 0.0250s/iter; left time: 501.8787s
	iters: 700, epoch: 12 | loss: 0.2828269
	speed: 0.0253s/iter; left time: 504.7403s
	iters: 800, epoch: 12 | loss: 0.2955598
	speed: 0.0252s/iter; left time: 500.7055s
	iters: 900, epoch: 12 | loss: 0.3490306
	speed: 0.0253s/iter; left time: 498.9931s
	iters: 1000, epoch: 12 | loss: 0.7812983
	speed: 0.0250s/iter; left time: 491.7386s
	iters: 1100, epoch: 12 | loss: 0.4446379
	speed: 0.0253s/iter; left time: 494.0925s
	iters: 1200, epoch: 12 | loss: 0.3552636
	speed: 0.0252s/iter; left time: 488.9031s
	iters: 1300, epoch: 12 | loss: 0.2450186
	speed: 0.0251s/iter; left time: 486.2430s
	iters: 1400, epoch: 12 | loss: 0.4037713
	speed: 0.0254s/iter; left time: 489.5178s
	iters: 1500, epoch: 12 | loss: 0.2442297
	speed: 0.0252s/iter; left time: 481.9235s
	iters: 1600, epoch: 12 | loss: 0.2781856
	speed: 0.0252s/iter; left time: 480.4316s
	iters: 1700, epoch: 12 | loss: 0.3453371
	speed: 0.0250s/iter; left time: 474.3569s
	iters: 1800, epoch: 12 | loss: 0.3535024
	speed: 0.0253s/iter; left time: 475.9898s
	iters: 1900, epoch: 12 | loss: 0.3194658
	speed: 0.0252s/iter; left time: 472.6188s
	iters: 2000, epoch: 12 | loss: 0.3216753
	speed: 0.0251s/iter; left time: 467.8589s
	iters: 2100, epoch: 12 | loss: 0.2476060
	speed: 0.0252s/iter; left time: 466.6251s
	iters: 2200, epoch: 12 | loss: 0.2455218
	speed: 0.0252s/iter; left time: 465.0335s
Epoch: 12 cost time: 58.37426996231079
Epoch: 12, Steps: 2293 | Train Loss: 0.4474939 Vali Loss: 0.4206538 Test Loss: 0.1645063
EarlyStopping counter: 5 out of 5
Early stopping
Total training time: 916.6263 seconds
>>>>>>>testing : weather_96_96_NLinear_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15726<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
mse:0.16524474322795868, mae:0.21004457771778107
