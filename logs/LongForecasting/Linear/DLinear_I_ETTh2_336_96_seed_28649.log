Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTh2', data_path='ETTh2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.05, loss='mse', lradj='type1', model='DLinear', model_id='ETTh2_336_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=28649, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTh2_336_96_DLinear_ETTh2_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed28649>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
Total number of trainable parameters: 452928
Total number of parameters: 452928
	iters: 100, epoch: 1 | loss: 1.1531267
	speed: 0.0110s/iter; left time: 54.9861s
	iters: 200, epoch: 1 | loss: 2.0213110
	speed: 0.0114s/iter; left time: 56.1728s
Epoch: 1 cost time: 3.1225175857543945
Epoch: 1, Steps: 256 | Train Loss: 4.5793414 Vali Loss: 1.7081805 Test Loss: 4.0325513
Validation loss decreased (inf --> 1.708181).  Saving model ...
Updating learning rate to 0.05
	iters: 100, epoch: 2 | loss: 4.6512218
	speed: 0.0290s/iter; left time: 137.9534s
	iters: 200, epoch: 2 | loss: 2.4593601
	speed: 0.0110s/iter; left time: 51.4877s
Epoch: 2 cost time: 2.755746841430664
Epoch: 2, Steps: 256 | Train Loss: 4.5446297 Vali Loss: 6.5828810 Test Loss: 25.6175709
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.025
	iters: 100, epoch: 3 | loss: 0.8843740
	speed: 0.0245s/iter; left time: 110.6921s
	iters: 200, epoch: 3 | loss: 0.9884626
	speed: 0.0110s/iter; left time: 48.3902s
Epoch: 3 cost time: 2.8210315704345703
Epoch: 3, Steps: 256 | Train Loss: 1.1548306 Vali Loss: 0.6482505 Test Loss: 1.6111778
Validation loss decreased (1.708181 --> 0.648251).  Saving model ...
Updating learning rate to 0.0125
	iters: 100, epoch: 4 | loss: 0.5250514
	speed: 0.0235s/iter; left time: 100.0825s
	iters: 200, epoch: 4 | loss: 0.7054677
	speed: 0.0111s/iter; left time: 46.0151s
Epoch: 4 cost time: 2.7623162269592285
Epoch: 4, Steps: 256 | Train Loss: 0.5047238 Vali Loss: 0.5292444 Test Loss: 1.3258311
Validation loss decreased (0.648251 --> 0.529244).  Saving model ...
Updating learning rate to 0.00625
	iters: 100, epoch: 5 | loss: 0.5001932
	speed: 0.0228s/iter; left time: 90.9598s
	iters: 200, epoch: 5 | loss: 0.5904962
	speed: 0.0099s/iter; left time: 38.6190s
Epoch: 5 cost time: 2.636826753616333
Epoch: 5, Steps: 256 | Train Loss: 0.4190191 Vali Loss: 0.4644284 Test Loss: 1.1146066
Validation loss decreased (0.529244 --> 0.464428).  Saving model ...
Updating learning rate to 0.003125
	iters: 100, epoch: 6 | loss: 0.3527566
	speed: 0.0245s/iter; left time: 91.5941s
	iters: 200, epoch: 6 | loss: 0.4537886
	speed: 0.0120s/iter; left time: 43.8499s
Epoch: 6 cost time: 2.8101816177368164
Epoch: 6, Steps: 256 | Train Loss: 0.3863773 Vali Loss: 0.3542847 Test Loss: 0.6611171
Validation loss decreased (0.464428 --> 0.354285).  Saving model ...
Updating learning rate to 0.0015625
	iters: 100, epoch: 7 | loss: 0.2629017
	speed: 0.0238s/iter; left time: 83.0069s
	iters: 200, epoch: 7 | loss: 0.4484904
	speed: 0.0116s/iter; left time: 39.1046s
Epoch: 7 cost time: 2.8216986656188965
Epoch: 7, Steps: 256 | Train Loss: 0.3714628 Vali Loss: 0.3438460 Test Loss: 0.6015139
Validation loss decreased (0.354285 --> 0.343846).  Saving model ...
Updating learning rate to 0.00078125
	iters: 100, epoch: 8 | loss: 0.2980954
	speed: 0.0256s/iter; left time: 82.7093s
	iters: 200, epoch: 8 | loss: 0.2319494
	speed: 0.0107s/iter; left time: 33.3887s
Epoch: 8 cost time: 2.7632603645324707
Epoch: 8, Steps: 256 | Train Loss: 0.3628709 Vali Loss: 0.3075207 Test Loss: 0.4857073
Validation loss decreased (0.343846 --> 0.307521).  Saving model ...
Updating learning rate to 0.000390625
	iters: 100, epoch: 9 | loss: 0.3466319
	speed: 0.0254s/iter; left time: 75.4308s
	iters: 200, epoch: 9 | loss: 0.2460642
	speed: 0.0101s/iter; left time: 28.9263s
Epoch: 9 cost time: 2.6047160625457764
Epoch: 9, Steps: 256 | Train Loss: 0.3577354 Vali Loss: 0.3069992 Test Loss: 0.5083275
Validation loss decreased (0.307521 --> 0.306999).  Saving model ...
Updating learning rate to 0.0001953125
	iters: 100, epoch: 10 | loss: 0.2970876
	speed: 0.0240s/iter; left time: 65.0725s
	iters: 200, epoch: 10 | loss: 0.2926261
	speed: 0.0119s/iter; left time: 31.2605s
Epoch: 10 cost time: 2.8735663890838623
Epoch: 10, Steps: 256 | Train Loss: 0.3546564 Vali Loss: 0.2809591 Test Loss: 0.4123263
Validation loss decreased (0.306999 --> 0.280959).  Saving model ...
Updating learning rate to 9.765625e-05
	iters: 100, epoch: 11 | loss: 0.3290013
	speed: 0.0238s/iter; left time: 58.5806s
	iters: 200, epoch: 11 | loss: 0.6648456
	speed: 0.0110s/iter; left time: 25.9039s
Epoch: 11 cost time: 2.7191519737243652
Epoch: 11, Steps: 256 | Train Loss: 0.3517750 Vali Loss: 0.2674926 Test Loss: 0.3791212
Validation loss decreased (0.280959 --> 0.267493).  Saving model ...
Updating learning rate to 4.8828125e-05
	iters: 100, epoch: 12 | loss: 0.7013663
	speed: 0.0237s/iter; left time: 52.3142s
	iters: 200, epoch: 12 | loss: 0.4068301
	speed: 0.0101s/iter; left time: 21.2521s
Epoch: 12 cost time: 2.579566240310669
Epoch: 12, Steps: 256 | Train Loss: 0.3526976 Vali Loss: 0.2738781 Test Loss: 0.4044854
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.44140625e-05
	iters: 100, epoch: 13 | loss: 0.6160388
	speed: 0.0204s/iter; left time: 39.7730s
	iters: 200, epoch: 13 | loss: 0.2568745
	speed: 0.0089s/iter; left time: 16.3752s
Epoch: 13 cost time: 2.286033868789673
Epoch: 13, Steps: 256 | Train Loss: 0.3519508 Vali Loss: 0.2761207 Test Loss: 0.4112422
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.220703125e-05
	iters: 100, epoch: 14 | loss: 0.1858767
	speed: 0.0172s/iter; left time: 29.1061s
	iters: 200, epoch: 14 | loss: 0.5060732
	speed: 0.0078s/iter; left time: 12.4270s
Epoch: 14 cost time: 1.9474563598632812
Epoch: 14, Steps: 256 | Train Loss: 0.3509197 Vali Loss: 0.2762632 Test Loss: 0.4103632
EarlyStopping counter: 3 out of 5
Updating learning rate to 6.103515625e-06
	iters: 100, epoch: 15 | loss: 0.2669582
	speed: 0.0156s/iter; left time: 22.4856s
	iters: 200, epoch: 15 | loss: 0.2464819
	speed: 0.0063s/iter; left time: 8.4107s
Epoch: 15 cost time: 1.7531332969665527
Epoch: 15, Steps: 256 | Train Loss: 0.3504884 Vali Loss: 0.2771120 Test Loss: 0.4132290
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.0517578125e-06
	iters: 100, epoch: 16 | loss: 0.3609273
	speed: 0.0144s/iter; left time: 16.9970s
	iters: 200, epoch: 16 | loss: 0.4182450
	speed: 0.0059s/iter; left time: 6.3389s
Epoch: 16 cost time: 1.587939977645874
Epoch: 16, Steps: 256 | Train Loss: 0.3514623 Vali Loss: 0.2778978 Test Loss: 0.4157071
EarlyStopping counter: 5 out of 5
Early stopping
Total training time: 51.5369 seconds
>>>>>>>testing : ETTh2_336_96_DLinear_ETTh2_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed28649<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.3823155462741852, mae:0.4113853871822357
