Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='Linear', model_id='ETTm2_336_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=15726, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTm2_336_96_Linear_ETTm2_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15726>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34129
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.1914405
	speed: 0.0037s/iter; left time: 77.8815s
	iters: 200, epoch: 1 | loss: 0.4691856
	speed: 0.0044s/iter; left time: 93.3662s
	iters: 300, epoch: 1 | loss: 0.4434255
	speed: 0.0050s/iter; left time: 105.5852s
	iters: 400, epoch: 1 | loss: 0.4055847
	speed: 0.0050s/iter; left time: 104.3627s
	iters: 500, epoch: 1 | loss: 0.6065881
	speed: 0.0050s/iter; left time: 103.7339s
	iters: 600, epoch: 1 | loss: 0.3855349
	speed: 0.0050s/iter; left time: 103.3981s
	iters: 700, epoch: 1 | loss: 0.5154096
	speed: 0.0041s/iter; left time: 84.4069s
	iters: 800, epoch: 1 | loss: 0.4431233
	speed: 0.0038s/iter; left time: 77.3644s
	iters: 900, epoch: 1 | loss: 0.3611492
	speed: 0.0037s/iter; left time: 75.7618s
	iters: 1000, epoch: 1 | loss: 0.2952985
	speed: 0.0041s/iter; left time: 83.1632s
Epoch: 1 cost time: 4.621033191680908
Epoch: 1, Steps: 1066 | Train Loss: 0.4079694 Vali Loss: 0.7760268 Test Loss: 2.0482492
Validation loss decreased (inf --> 0.776027).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.2850362
	speed: 0.0164s/iter; left time: 331.0675s
	iters: 200, epoch: 2 | loss: 0.3967279
	speed: 0.0027s/iter; left time: 54.7503s
	iters: 300, epoch: 2 | loss: 0.4494954
	speed: 0.0042s/iter; left time: 83.4036s
	iters: 400, epoch: 2 | loss: 0.3225632
	speed: 0.0039s/iter; left time: 78.2673s
	iters: 500, epoch: 2 | loss: 0.5666963
	speed: 0.0045s/iter; left time: 89.2988s
	iters: 600, epoch: 2 | loss: 0.2741452
	speed: 0.0050s/iter; left time: 98.1298s
	iters: 700, epoch: 2 | loss: 0.3472879
	speed: 0.0043s/iter; left time: 83.6953s
	iters: 800, epoch: 2 | loss: 0.5233676
	speed: 0.0043s/iter; left time: 82.6925s
	iters: 900, epoch: 2 | loss: 0.3377339
	speed: 0.0042s/iter; left time: 81.7119s
	iters: 1000, epoch: 2 | loss: 0.2769651
	speed: 0.0043s/iter; left time: 82.4116s
Epoch: 2 cost time: 4.426323413848877
Epoch: 2, Steps: 1066 | Train Loss: 0.4045663 Vali Loss: 0.4495690 Test Loss: 0.9554975
Validation loss decreased (0.776027 --> 0.449569).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.2208823
	speed: 0.0174s/iter; left time: 331.3246s
	iters: 200, epoch: 3 | loss: 0.2017179
	speed: 0.0048s/iter; left time: 91.1466s
	iters: 300, epoch: 3 | loss: 0.1998413
	speed: 0.0047s/iter; left time: 89.0015s
	iters: 400, epoch: 3 | loss: 0.3228726
	speed: 0.0039s/iter; left time: 74.0351s
	iters: 500, epoch: 3 | loss: 0.2942181
	speed: 0.0037s/iter; left time: 68.9992s
	iters: 600, epoch: 3 | loss: 0.3342166
	speed: 0.0037s/iter; left time: 68.5932s
	iters: 700, epoch: 3 | loss: 0.1531752
	speed: 0.0046s/iter; left time: 84.7155s
	iters: 800, epoch: 3 | loss: 0.1640833
	speed: 0.0041s/iter; left time: 76.1385s
	iters: 900, epoch: 3 | loss: 0.1695054
	speed: 0.0042s/iter; left time: 77.3627s
	iters: 1000, epoch: 3 | loss: 0.1940104
	speed: 0.0045s/iter; left time: 81.7005s
Epoch: 3 cost time: 4.52492094039917
Epoch: 3, Steps: 1066 | Train Loss: 0.2564032 Vali Loss: 0.1970139 Test Loss: 0.3271337
Validation loss decreased (0.449569 --> 0.197014).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.2445059
	speed: 0.0187s/iter; left time: 336.5672s
	iters: 200, epoch: 4 | loss: 0.2844203
	speed: 0.0038s/iter; left time: 68.2869s
	iters: 300, epoch: 4 | loss: 0.2114052
	speed: 0.0044s/iter; left time: 79.0074s
	iters: 400, epoch: 4 | loss: 0.1694241
	speed: 0.0042s/iter; left time: 73.5593s
	iters: 500, epoch: 4 | loss: 0.2234152
	speed: 0.0042s/iter; left time: 74.1929s
	iters: 600, epoch: 4 | loss: 0.1776632
	speed: 0.0045s/iter; left time: 78.5605s
	iters: 700, epoch: 4 | loss: 0.1358988
	speed: 0.0047s/iter; left time: 82.0701s
	iters: 800, epoch: 4 | loss: 0.2108240
	speed: 0.0044s/iter; left time: 76.2500s
	iters: 900, epoch: 4 | loss: 0.1031452
	speed: 0.0042s/iter; left time: 72.6812s
	iters: 1000, epoch: 4 | loss: 0.3154791
	speed: 0.0043s/iter; left time: 73.6698s
Epoch: 4 cost time: 4.5923004150390625
Epoch: 4, Steps: 1066 | Train Loss: 0.2329299 Vali Loss: 0.1447597 Test Loss: 0.2246450
Validation loss decreased (0.197014 --> 0.144760).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.1226111
	speed: 0.0216s/iter; left time: 366.8457s
	iters: 200, epoch: 5 | loss: 0.2526941
	speed: 0.0050s/iter; left time: 84.4633s
	iters: 300, epoch: 5 | loss: 0.1723071
	speed: 0.0046s/iter; left time: 77.6240s
	iters: 400, epoch: 5 | loss: 0.2729409
	speed: 0.0042s/iter; left time: 69.4596s
	iters: 500, epoch: 5 | loss: 0.1489588
	speed: 0.0043s/iter; left time: 70.5687s
	iters: 600, epoch: 5 | loss: 0.2161622
	speed: 0.0036s/iter; left time: 59.7394s
	iters: 700, epoch: 5 | loss: 0.1779410
	speed: 0.0034s/iter; left time: 54.9593s
	iters: 800, epoch: 5 | loss: 0.1446996
	speed: 0.0036s/iter; left time: 58.4135s
	iters: 900, epoch: 5 | loss: 0.3080142
	speed: 0.0039s/iter; left time: 63.3451s
	iters: 1000, epoch: 5 | loss: 0.4070720
	speed: 0.0040s/iter; left time: 63.9066s
Epoch: 5 cost time: 4.429468393325806
Epoch: 5, Steps: 1066 | Train Loss: 0.2160423 Vali Loss: 0.1368835 Test Loss: 0.2257511
Validation loss decreased (0.144760 --> 0.136883).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.2809694
	speed: 0.0190s/iter; left time: 302.1789s
	iters: 200, epoch: 6 | loss: 0.5009265
	speed: 0.0033s/iter; left time: 51.3622s
	iters: 300, epoch: 6 | loss: 0.3401345
	speed: 0.0033s/iter; left time: 51.3096s
	iters: 400, epoch: 6 | loss: 0.4446868
	speed: 0.0031s/iter; left time: 48.4881s
	iters: 500, epoch: 6 | loss: 0.2104932
	speed: 0.0041s/iter; left time: 63.6955s
	iters: 600, epoch: 6 | loss: 0.2967093
	speed: 0.0047s/iter; left time: 72.3467s
	iters: 700, epoch: 6 | loss: 0.1781563
	speed: 0.0048s/iter; left time: 72.9809s
	iters: 800, epoch: 6 | loss: 0.2857075
	speed: 0.0048s/iter; left time: 72.5990s
	iters: 900, epoch: 6 | loss: 0.1738162
	speed: 0.0042s/iter; left time: 63.4065s
	iters: 1000, epoch: 6 | loss: 0.1739872
	speed: 0.0043s/iter; left time: 63.8616s
Epoch: 6 cost time: 4.316848516464233
Epoch: 6, Steps: 1066 | Train Loss: 0.2090040 Vali Loss: 0.1287967 Test Loss: 0.1910817
Validation loss decreased (0.136883 --> 0.128797).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.1123598
	speed: 0.0171s/iter; left time: 253.4362s
	iters: 200, epoch: 7 | loss: 0.1349368
	speed: 0.0043s/iter; left time: 63.7682s
	iters: 300, epoch: 7 | loss: 0.1592405
	speed: 0.0042s/iter; left time: 61.1759s
	iters: 400, epoch: 7 | loss: 0.2225789
	speed: 0.0048s/iter; left time: 69.7148s
	iters: 500, epoch: 7 | loss: 0.2492237
	speed: 0.0044s/iter; left time: 63.1208s
	iters: 600, epoch: 7 | loss: 0.1631421
	speed: 0.0044s/iter; left time: 63.3458s
	iters: 700, epoch: 7 | loss: 0.2511124
	speed: 0.0048s/iter; left time: 67.9857s
	iters: 800, epoch: 7 | loss: 0.1599062
	speed: 0.0041s/iter; left time: 58.3681s
	iters: 900, epoch: 7 | loss: 0.1395692
	speed: 0.0042s/iter; left time: 58.7736s
	iters: 1000, epoch: 7 | loss: 0.3061132
	speed: 0.0041s/iter; left time: 56.9825s
Epoch: 7 cost time: 4.5928192138671875
Epoch: 7, Steps: 1066 | Train Loss: 0.2040357 Vali Loss: 0.1516767 Test Loss: 0.2606834
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.2082232
	speed: 0.0179s/iter; left time: 246.4730s
	iters: 200, epoch: 8 | loss: 0.1148949
	speed: 0.0036s/iter; left time: 48.8038s
	iters: 300, epoch: 8 | loss: 0.4779459
	speed: 0.0037s/iter; left time: 49.8971s
	iters: 400, epoch: 8 | loss: 0.1479114
	speed: 0.0033s/iter; left time: 44.2801s
	iters: 500, epoch: 8 | loss: 0.1280380
	speed: 0.0035s/iter; left time: 46.1137s
	iters: 600, epoch: 8 | loss: 0.1381663
	speed: 0.0042s/iter; left time: 56.0898s
	iters: 700, epoch: 8 | loss: 0.4053763
	speed: 0.0044s/iter; left time: 57.2676s
	iters: 800, epoch: 8 | loss: 0.1433819
	speed: 0.0032s/iter; left time: 41.2663s
	iters: 900, epoch: 8 | loss: 0.1575226
	speed: 0.0032s/iter; left time: 41.3464s
	iters: 1000, epoch: 8 | loss: 0.2059002
	speed: 0.0044s/iter; left time: 56.8760s
Epoch: 8 cost time: 4.076076507568359
Epoch: 8, Steps: 1066 | Train Loss: 0.2019491 Vali Loss: 0.1327805 Test Loss: 0.2090976
EarlyStopping counter: 2 out of 5
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.2377053
	speed: 0.0203s/iter; left time: 257.3475s
	iters: 200, epoch: 9 | loss: 0.2846099
	speed: 0.0041s/iter; left time: 52.2422s
	iters: 300, epoch: 9 | loss: 0.6747487
	speed: 0.0039s/iter; left time: 49.2522s
	iters: 400, epoch: 9 | loss: 0.1104166
	speed: 0.0038s/iter; left time: 47.4651s
	iters: 500, epoch: 9 | loss: 0.0956719
	speed: 0.0042s/iter; left time: 51.4973s
	iters: 600, epoch: 9 | loss: 0.2326681
	speed: 0.0043s/iter; left time: 52.2110s
	iters: 700, epoch: 9 | loss: 0.1794525
	speed: 0.0037s/iter; left time: 44.7439s
	iters: 800, epoch: 9 | loss: 0.3320545
	speed: 0.0036s/iter; left time: 43.1982s
	iters: 900, epoch: 9 | loss: 0.1388992
	speed: 0.0037s/iter; left time: 43.7730s
	iters: 1000, epoch: 9 | loss: 0.1779027
	speed: 0.0037s/iter; left time: 43.3983s
Epoch: 9 cost time: 4.204678535461426
Epoch: 9, Steps: 1066 | Train Loss: 0.2006028 Vali Loss: 0.1295279 Test Loss: 0.2017327
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.1695404
	speed: 0.0158s/iter; left time: 183.4132s
	iters: 200, epoch: 10 | loss: 0.0977041
	speed: 0.0037s/iter; left time: 42.8805s
	iters: 300, epoch: 10 | loss: 0.2695890
	speed: 0.0038s/iter; left time: 43.1130s
	iters: 400, epoch: 10 | loss: 0.1750020
	speed: 0.0035s/iter; left time: 39.1914s
	iters: 500, epoch: 10 | loss: 0.1883915
	speed: 0.0027s/iter; left time: 30.5279s
	iters: 600, epoch: 10 | loss: 0.0913032
	speed: 0.0029s/iter; left time: 32.7133s
	iters: 700, epoch: 10 | loss: 0.1050589
	speed: 0.0031s/iter; left time: 34.6603s
	iters: 800, epoch: 10 | loss: 0.2000970
	speed: 0.0042s/iter; left time: 45.8935s
	iters: 900, epoch: 10 | loss: 0.1739156
	speed: 0.0044s/iter; left time: 47.6746s
	iters: 1000, epoch: 10 | loss: 0.3665414
	speed: 0.0043s/iter; left time: 45.8041s
Epoch: 10 cost time: 3.8790600299835205
Epoch: 10, Steps: 1066 | Train Loss: 0.1998496 Vali Loss: 0.1255623 Test Loss: 0.1897357
Validation loss decreased (0.128797 --> 0.125562).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.1640028
	speed: 0.0181s/iter; left time: 191.6281s
	iters: 200, epoch: 11 | loss: 0.1776019
	speed: 0.0035s/iter; left time: 36.9274s
	iters: 300, epoch: 11 | loss: 0.3027009
	speed: 0.0047s/iter; left time: 49.0569s
	iters: 400, epoch: 11 | loss: 0.1308739
	speed: 0.0050s/iter; left time: 51.0214s
	iters: 500, epoch: 11 | loss: 0.3019830
	speed: 0.0046s/iter; left time: 46.7595s
	iters: 600, epoch: 11 | loss: 0.1983103
	speed: 0.0049s/iter; left time: 49.6008s
	iters: 700, epoch: 11 | loss: 0.1792141
	speed: 0.0041s/iter; left time: 41.1777s
	iters: 800, epoch: 11 | loss: 0.1086742
	speed: 0.0051s/iter; left time: 50.1926s
	iters: 900, epoch: 11 | loss: 0.1599794
	speed: 0.0048s/iter; left time: 46.4048s
	iters: 1000, epoch: 11 | loss: 0.2009324
	speed: 0.0043s/iter; left time: 42.0253s
Epoch: 11 cost time: 4.7577009201049805
Epoch: 11, Steps: 1066 | Train Loss: 0.1994394 Vali Loss: 0.1343564 Test Loss: 0.2165640
EarlyStopping counter: 1 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.2468772
	speed: 0.0213s/iter; left time: 201.9999s
	iters: 200, epoch: 12 | loss: 0.1350055
	speed: 0.0042s/iter; left time: 39.0620s
	iters: 300, epoch: 12 | loss: 0.4058558
	speed: 0.0037s/iter; left time: 34.1126s
	iters: 400, epoch: 12 | loss: 0.1065547
	speed: 0.0040s/iter; left time: 36.5962s
	iters: 500, epoch: 12 | loss: 0.1247124
	speed: 0.0037s/iter; left time: 33.5885s
	iters: 600, epoch: 12 | loss: 0.2719815
	speed: 0.0036s/iter; left time: 32.6518s
	iters: 700, epoch: 12 | loss: 0.1830968
	speed: 0.0041s/iter; left time: 36.6475s
	iters: 800, epoch: 12 | loss: 0.1320229
	speed: 0.0041s/iter; left time: 36.4299s
	iters: 900, epoch: 12 | loss: 0.1585351
	speed: 0.0039s/iter; left time: 34.0016s
	iters: 1000, epoch: 12 | loss: 0.1395862
	speed: 0.0035s/iter; left time: 30.2722s
Epoch: 12 cost time: 4.201428651809692
Epoch: 12, Steps: 1066 | Train Loss: 0.1992467 Vali Loss: 0.1289846 Test Loss: 0.2021652
EarlyStopping counter: 2 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.1514403
	speed: 0.0162s/iter; left time: 136.9077s
	iters: 200, epoch: 13 | loss: 0.1355378
	speed: 0.0037s/iter; left time: 31.1655s
	iters: 300, epoch: 13 | loss: 0.1013725
	speed: 0.0046s/iter; left time: 37.8575s
	iters: 400, epoch: 13 | loss: 0.3108951
	speed: 0.0047s/iter; left time: 38.1504s
	iters: 500, epoch: 13 | loss: 0.1832955
	speed: 0.0043s/iter; left time: 34.6050s
	iters: 600, epoch: 13 | loss: 0.1511958
	speed: 0.0037s/iter; left time: 29.6569s
	iters: 700, epoch: 13 | loss: 0.1353509
	speed: 0.0030s/iter; left time: 23.1112s
	iters: 800, epoch: 13 | loss: 0.4452518
	speed: 0.0036s/iter; left time: 28.2108s
	iters: 900, epoch: 13 | loss: 0.2390318
	speed: 0.0037s/iter; left time: 28.2274s
	iters: 1000, epoch: 13 | loss: 0.3108967
	speed: 0.0041s/iter; left time: 30.5843s
Epoch: 13 cost time: 4.201991319656372
Epoch: 13, Steps: 1066 | Train Loss: 0.1990704 Vali Loss: 0.1304125 Test Loss: 0.2046801
EarlyStopping counter: 3 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 14 | loss: 0.1369261
	speed: 0.0186s/iter; left time: 137.2727s
	iters: 200, epoch: 14 | loss: 0.1866325
	speed: 0.0043s/iter; left time: 30.8708s
	iters: 300, epoch: 14 | loss: 0.2437942
	speed: 0.0037s/iter; left time: 26.7897s
	iters: 400, epoch: 14 | loss: 0.1465433
	speed: 0.0043s/iter; left time: 30.1821s
	iters: 500, epoch: 14 | loss: 0.2605879
	speed: 0.0042s/iter; left time: 29.5927s
	iters: 600, epoch: 14 | loss: 0.1637807
	speed: 0.0037s/iter; left time: 25.3516s
	iters: 700, epoch: 14 | loss: 0.1541031
	speed: 0.0042s/iter; left time: 28.0665s
	iters: 800, epoch: 14 | loss: 0.1150016
	speed: 0.0041s/iter; left time: 27.0103s
	iters: 900, epoch: 14 | loss: 0.2490880
	speed: 0.0049s/iter; left time: 31.9005s
	iters: 1000, epoch: 14 | loss: 0.1363025
	speed: 0.0042s/iter; left time: 26.8861s
Epoch: 14 cost time: 4.461699962615967
Epoch: 14, Steps: 1066 | Train Loss: 0.1990887 Vali Loss: 0.1324035 Test Loss: 0.2109235
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 15 | loss: 0.1204196
	speed: 0.0155s/iter; left time: 97.5636s
	iters: 200, epoch: 15 | loss: 0.2231596
	speed: 0.0035s/iter; left time: 21.5036s
	iters: 300, epoch: 15 | loss: 0.2790942
	speed: 0.0035s/iter; left time: 21.2900s
	iters: 400, epoch: 15 | loss: 0.2180668
	speed: 0.0035s/iter; left time: 20.8120s
	iters: 500, epoch: 15 | loss: 0.1255354
	speed: 0.0035s/iter; left time: 20.5805s
	iters: 600, epoch: 15 | loss: 0.2140133
	speed: 0.0037s/iter; left time: 21.3013s
	iters: 700, epoch: 15 | loss: 0.1076956
	speed: 0.0045s/iter; left time: 25.7520s
	iters: 800, epoch: 15 | loss: 0.1318574
	speed: 0.0037s/iter; left time: 20.7245s
	iters: 900, epoch: 15 | loss: 0.1320118
	speed: 0.0033s/iter; left time: 17.9201s
	iters: 1000, epoch: 15 | loss: 0.1917920
	speed: 0.0032s/iter; left time: 17.0006s
Epoch: 15 cost time: 3.7760064601898193
Epoch: 15, Steps: 1066 | Train Loss: 0.1990549 Vali Loss: 0.1320763 Test Loss: 0.2100009
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTm2_336_96_Linear_ETTm2_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15726<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.1901310533285141, mae:0.28300026059150696
