Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='NLinear', model_id='ETTm2_336_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=12890, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTm2_336_96_NLinear_ETTm2_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed12890>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34129
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.2655593
	speed: 0.0045s/iter; left time: 96.5223s
	iters: 200, epoch: 1 | loss: 0.5997750
	speed: 0.0031s/iter; left time: 66.3654s
	iters: 300, epoch: 1 | loss: 0.4214432
	speed: 0.0049s/iter; left time: 102.5824s
	iters: 400, epoch: 1 | loss: 0.3803479
	speed: 0.0047s/iter; left time: 99.2180s
	iters: 500, epoch: 1 | loss: 0.2841176
	speed: 0.0047s/iter; left time: 98.0674s
	iters: 600, epoch: 1 | loss: 0.3156296
	speed: 0.0047s/iter; left time: 96.8031s
	iters: 700, epoch: 1 | loss: 0.2519768
	speed: 0.0039s/iter; left time: 80.4345s
	iters: 800, epoch: 1 | loss: 1.4357314
	speed: 0.0038s/iter; left time: 77.1588s
	iters: 900, epoch: 1 | loss: 0.3255559
	speed: 0.0043s/iter; left time: 87.4683s
	iters: 1000, epoch: 1 | loss: 0.6729186
	speed: 0.0045s/iter; left time: 90.6437s
Epoch: 1 cost time: 4.589133024215698
Epoch: 1, Steps: 1066 | Train Loss: 0.5731959 Vali Loss: 0.2317298 Test Loss: 0.3151305
Validation loss decreased (inf --> 0.231730).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.2409465
	speed: 0.0227s/iter; left time: 458.2677s
	iters: 200, epoch: 2 | loss: 0.5915158
	speed: 0.0040s/iter; left time: 80.2199s
	iters: 300, epoch: 2 | loss: 0.5330127
	speed: 0.0042s/iter; left time: 83.0244s
	iters: 400, epoch: 2 | loss: 2.7375858
	speed: 0.0044s/iter; left time: 86.6228s
	iters: 500, epoch: 2 | loss: 0.4588230
	speed: 0.0047s/iter; left time: 92.8484s
	iters: 600, epoch: 2 | loss: 0.4444995
	speed: 0.0049s/iter; left time: 97.1494s
	iters: 700, epoch: 2 | loss: 2.0614498
	speed: 0.0044s/iter; left time: 86.6285s
	iters: 800, epoch: 2 | loss: 0.3000349
	speed: 0.0050s/iter; left time: 97.3805s
	iters: 900, epoch: 2 | loss: 0.3402913
	speed: 0.0030s/iter; left time: 57.6893s
	iters: 1000, epoch: 2 | loss: 0.2679094
	speed: 0.0032s/iter; left time: 62.5787s
Epoch: 2 cost time: 4.542712450027466
Epoch: 2, Steps: 1066 | Train Loss: 0.4855810 Vali Loss: 0.2220401 Test Loss: 0.3192731
Validation loss decreased (0.231730 --> 0.222040).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.5440351
	speed: 0.0221s/iter; left time: 421.9624s
	iters: 200, epoch: 3 | loss: 0.2717603
	speed: 0.0047s/iter; left time: 89.2484s
	iters: 300, epoch: 3 | loss: 0.1546352
	speed: 0.0045s/iter; left time: 84.2811s
	iters: 400, epoch: 3 | loss: 0.3042787
	speed: 0.0048s/iter; left time: 90.7593s
	iters: 500, epoch: 3 | loss: 0.1501881
	speed: 0.0036s/iter; left time: 67.2809s
	iters: 600, epoch: 3 | loss: 0.2889375
	speed: 0.0034s/iter; left time: 62.7020s
	iters: 700, epoch: 3 | loss: 0.2173078
	speed: 0.0046s/iter; left time: 85.6039s
	iters: 800, epoch: 3 | loss: 0.1221828
	speed: 0.0048s/iter; left time: 88.8548s
	iters: 900, epoch: 3 | loss: 0.1867500
	speed: 0.0043s/iter; left time: 78.4598s
	iters: 1000, epoch: 3 | loss: 0.2064939
	speed: 0.0037s/iter; left time: 68.2087s
Epoch: 3 cost time: 4.639193058013916
Epoch: 3, Steps: 1066 | Train Loss: 0.2644341 Vali Loss: 0.1573086 Test Loss: 0.2185685
Validation loss decreased (0.222040 --> 0.157309).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.1574482
	speed: 0.0193s/iter; left time: 348.3061s
	iters: 200, epoch: 4 | loss: 0.3369707
	speed: 0.0045s/iter; left time: 80.6930s
	iters: 300, epoch: 4 | loss: 0.1736486
	speed: 0.0040s/iter; left time: 70.5791s
	iters: 400, epoch: 4 | loss: 0.2418475
	speed: 0.0039s/iter; left time: 69.1645s
	iters: 500, epoch: 4 | loss: 0.2287174
	speed: 0.0038s/iter; left time: 67.8483s
	iters: 600, epoch: 4 | loss: 0.3323690
	speed: 0.0038s/iter; left time: 66.5875s
	iters: 700, epoch: 4 | loss: 0.3674206
	speed: 0.0040s/iter; left time: 69.0453s
	iters: 800, epoch: 4 | loss: 0.1675516
	speed: 0.0043s/iter; left time: 74.4889s
	iters: 900, epoch: 4 | loss: 0.2339692
	speed: 0.0050s/iter; left time: 85.8240s
	iters: 1000, epoch: 4 | loss: 0.2230203
	speed: 0.0046s/iter; left time: 78.6031s
Epoch: 4 cost time: 4.446448802947998
Epoch: 4, Steps: 1066 | Train Loss: 0.2362342 Vali Loss: 0.1293384 Test Loss: 0.1797794
Validation loss decreased (0.157309 --> 0.129338).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.2680038
	speed: 0.0173s/iter; left time: 294.1152s
	iters: 200, epoch: 5 | loss: 0.0879283
	speed: 0.0039s/iter; left time: 65.0679s
	iters: 300, epoch: 5 | loss: 0.1426980
	speed: 0.0038s/iter; left time: 63.3776s
	iters: 400, epoch: 5 | loss: 0.1670301
	speed: 0.0044s/iter; left time: 72.9576s
	iters: 500, epoch: 5 | loss: 0.5467115
	speed: 0.0046s/iter; left time: 76.0458s
	iters: 600, epoch: 5 | loss: 0.2110369
	speed: 0.0049s/iter; left time: 80.8036s
	iters: 700, epoch: 5 | loss: 0.0938427
	speed: 0.0050s/iter; left time: 81.8228s
	iters: 800, epoch: 5 | loss: 0.1649164
	speed: 0.0043s/iter; left time: 70.5557s
	iters: 900, epoch: 5 | loss: 0.1578319
	speed: 0.0050s/iter; left time: 81.1081s
	iters: 1000, epoch: 5 | loss: 0.2145102
	speed: 0.0040s/iter; left time: 64.7526s
Epoch: 5 cost time: 4.6410071849823
Epoch: 5, Steps: 1066 | Train Loss: 0.2227697 Vali Loss: 0.1456518 Test Loss: 0.2004823
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.1466285
	speed: 0.0186s/iter; left time: 294.8937s
	iters: 200, epoch: 6 | loss: 0.2272209
	speed: 0.0039s/iter; left time: 61.5849s
	iters: 300, epoch: 6 | loss: 0.2711992
	speed: 0.0039s/iter; left time: 60.7620s
	iters: 400, epoch: 6 | loss: 0.2147387
	speed: 0.0046s/iter; left time: 72.0303s
	iters: 500, epoch: 6 | loss: 0.1318720
	speed: 0.0051s/iter; left time: 78.3846s
	iters: 600, epoch: 6 | loss: 0.1317008
	speed: 0.0047s/iter; left time: 72.0856s
	iters: 700, epoch: 6 | loss: 0.2056882
	speed: 0.0047s/iter; left time: 71.5619s
	iters: 800, epoch: 6 | loss: 0.2596225
	speed: 0.0042s/iter; left time: 64.1557s
	iters: 900, epoch: 6 | loss: 0.1887510
	speed: 0.0033s/iter; left time: 49.3562s
	iters: 1000, epoch: 6 | loss: 0.2094357
	speed: 0.0044s/iter; left time: 65.5400s
Epoch: 6 cost time: 4.618535757064819
Epoch: 6, Steps: 1066 | Train Loss: 0.2146205 Vali Loss: 0.1216609 Test Loss: 0.1694607
Validation loss decreased (0.129338 --> 0.121661).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.1818325
	speed: 0.0216s/iter; left time: 320.7338s
	iters: 200, epoch: 7 | loss: 0.2165674
	speed: 0.0049s/iter; left time: 71.8580s
	iters: 300, epoch: 7 | loss: 0.3213010
	speed: 0.0045s/iter; left time: 65.8442s
	iters: 400, epoch: 7 | loss: 0.1662720
	speed: 0.0046s/iter; left time: 66.6763s
	iters: 500, epoch: 7 | loss: 0.1636054
	speed: 0.0045s/iter; left time: 64.5115s
	iters: 600, epoch: 7 | loss: 0.1916541
	speed: 0.0043s/iter; left time: 62.3136s
	iters: 700, epoch: 7 | loss: 0.2362107
	speed: 0.0043s/iter; left time: 61.0322s
	iters: 800, epoch: 7 | loss: 0.5336018
	speed: 0.0044s/iter; left time: 62.4625s
	iters: 900, epoch: 7 | loss: 0.1478547
	speed: 0.0044s/iter; left time: 62.4112s
	iters: 1000, epoch: 7 | loss: 0.2532178
	speed: 0.0044s/iter; left time: 61.1909s
Epoch: 7 cost time: 4.791553974151611
Epoch: 7, Steps: 1066 | Train Loss: 0.2098779 Vali Loss: 0.1159554 Test Loss: 0.1641935
Validation loss decreased (0.121661 --> 0.115955).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.0990834
	speed: 0.0210s/iter; left time: 289.5791s
	iters: 200, epoch: 8 | loss: 0.3318301
	speed: 0.0046s/iter; left time: 62.2850s
	iters: 300, epoch: 8 | loss: 0.2111695
	speed: 0.0050s/iter; left time: 67.9678s
	iters: 400, epoch: 8 | loss: 0.4197089
	speed: 0.0044s/iter; left time: 59.3542s
	iters: 500, epoch: 8 | loss: 0.2580793
	speed: 0.0041s/iter; left time: 54.6670s
	iters: 600, epoch: 8 | loss: 0.2298650
	speed: 0.0040s/iter; left time: 52.3768s
	iters: 700, epoch: 8 | loss: 0.2138195
	speed: 0.0050s/iter; left time: 65.8784s
	iters: 800, epoch: 8 | loss: 0.1371184
	speed: 0.0040s/iter; left time: 51.8443s
	iters: 900, epoch: 8 | loss: 0.1605209
	speed: 0.0047s/iter; left time: 60.7815s
	iters: 1000, epoch: 8 | loss: 0.3955738
	speed: 0.0045s/iter; left time: 57.6436s
Epoch: 8 cost time: 4.790795087814331
Epoch: 8, Steps: 1066 | Train Loss: 0.2070189 Vali Loss: 0.1168055 Test Loss: 0.1640470
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.1075153
	speed: 0.0211s/iter; left time: 267.9794s
	iters: 200, epoch: 9 | loss: 0.2514952
	speed: 0.0041s/iter; left time: 51.1251s
	iters: 300, epoch: 9 | loss: 0.1858773
	speed: 0.0048s/iter; left time: 59.7591s
	iters: 400, epoch: 9 | loss: 0.3993984
	speed: 0.0052s/iter; left time: 63.8294s
	iters: 500, epoch: 9 | loss: 0.1725925
	speed: 0.0052s/iter; left time: 64.4555s
	iters: 600, epoch: 9 | loss: 0.2316427
	speed: 0.0054s/iter; left time: 65.7480s
	iters: 700, epoch: 9 | loss: 0.1789366
	speed: 0.0048s/iter; left time: 57.7831s
	iters: 800, epoch: 9 | loss: 0.2073215
	speed: 0.0051s/iter; left time: 60.8042s
	iters: 900, epoch: 9 | loss: 0.2039025
	speed: 0.0044s/iter; left time: 52.2363s
	iters: 1000, epoch: 9 | loss: 0.1382053
	speed: 0.0040s/iter; left time: 46.7059s
Epoch: 9 cost time: 4.969255447387695
Epoch: 9, Steps: 1066 | Train Loss: 0.2059010 Vali Loss: 0.1153110 Test Loss: 0.1633721
Validation loss decreased (0.115955 --> 0.115311).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.2086472
	speed: 0.0194s/iter; left time: 225.0382s
	iters: 200, epoch: 10 | loss: 0.1752806
	speed: 0.0043s/iter; left time: 49.9598s
	iters: 300, epoch: 10 | loss: 0.1255137
	speed: 0.0045s/iter; left time: 50.9642s
	iters: 400, epoch: 10 | loss: 0.1622665
	speed: 0.0040s/iter; left time: 44.7739s
	iters: 500, epoch: 10 | loss: 0.3759850
	speed: 0.0034s/iter; left time: 38.0595s
	iters: 600, epoch: 10 | loss: 0.2200435
	speed: 0.0030s/iter; left time: 33.0280s
	iters: 700, epoch: 10 | loss: 0.1542563
	speed: 0.0049s/iter; left time: 53.6112s
	iters: 800, epoch: 10 | loss: 0.3141312
	speed: 0.0051s/iter; left time: 55.3999s
	iters: 900, epoch: 10 | loss: 0.1888774
	speed: 0.0046s/iter; left time: 49.4122s
	iters: 1000, epoch: 10 | loss: 0.1096061
	speed: 0.0048s/iter; left time: 51.8115s
Epoch: 10 cost time: 4.601374387741089
Epoch: 10, Steps: 1066 | Train Loss: 0.2051708 Vali Loss: 0.1151914 Test Loss: 0.1625791
Validation loss decreased (0.115311 --> 0.115191).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.2352833
	speed: 0.0196s/iter; left time: 206.7959s
	iters: 200, epoch: 11 | loss: 0.1721440
	speed: 0.0042s/iter; left time: 44.3376s
	iters: 300, epoch: 11 | loss: 0.1729206
	speed: 0.0041s/iter; left time: 42.0836s
	iters: 400, epoch: 11 | loss: 0.2255816
	speed: 0.0044s/iter; left time: 45.5588s
	iters: 500, epoch: 11 | loss: 0.1964715
	speed: 0.0049s/iter; left time: 49.9169s
	iters: 600, epoch: 11 | loss: 0.1432820
	speed: 0.0046s/iter; left time: 46.4819s
	iters: 700, epoch: 11 | loss: 0.1611808
	speed: 0.0045s/iter; left time: 44.7524s
	iters: 800, epoch: 11 | loss: 0.1424415
	speed: 0.0043s/iter; left time: 42.1122s
	iters: 900, epoch: 11 | loss: 0.3268971
	speed: 0.0045s/iter; left time: 44.1461s
	iters: 1000, epoch: 11 | loss: 0.2183788
	speed: 0.0043s/iter; left time: 41.2525s
Epoch: 11 cost time: 4.649936199188232
Epoch: 11, Steps: 1066 | Train Loss: 0.2047978 Vali Loss: 0.1156917 Test Loss: 0.1632183
EarlyStopping counter: 1 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.3231654
	speed: 0.0205s/iter; left time: 194.3042s
	iters: 200, epoch: 12 | loss: 0.1045316
	speed: 0.0044s/iter; left time: 40.8863s
	iters: 300, epoch: 12 | loss: 0.1973752
	speed: 0.0039s/iter; left time: 36.6223s
	iters: 400, epoch: 12 | loss: 0.1242863
	speed: 0.0043s/iter; left time: 39.5439s
	iters: 500, epoch: 12 | loss: 0.4091530
	speed: 0.0041s/iter; left time: 37.4131s
	iters: 600, epoch: 12 | loss: 0.2020793
	speed: 0.0046s/iter; left time: 41.5570s
	iters: 700, epoch: 12 | loss: 0.3389718
	speed: 0.0048s/iter; left time: 42.4079s
	iters: 800, epoch: 12 | loss: 0.2745762
	speed: 0.0048s/iter; left time: 41.8643s
	iters: 900, epoch: 12 | loss: 0.1665000
	speed: 0.0039s/iter; left time: 33.6053s
	iters: 1000, epoch: 12 | loss: 0.2559233
	speed: 0.0040s/iter; left time: 34.5519s
Epoch: 12 cost time: 4.582695960998535
Epoch: 12, Steps: 1066 | Train Loss: 0.2045578 Vali Loss: 0.1155172 Test Loss: 0.1630246
EarlyStopping counter: 2 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.3198959
	speed: 0.0173s/iter; left time: 146.1965s
	iters: 200, epoch: 13 | loss: 0.1640742
	speed: 0.0038s/iter; left time: 32.0666s
	iters: 300, epoch: 13 | loss: 0.1884231
	speed: 0.0039s/iter; left time: 31.7641s
	iters: 400, epoch: 13 | loss: 0.2996947
	speed: 0.0041s/iter; left time: 33.1128s
	iters: 500, epoch: 13 | loss: 0.2005416
	speed: 0.0042s/iter; left time: 33.3204s
	iters: 600, epoch: 13 | loss: 0.2415890
	speed: 0.0040s/iter; left time: 31.9688s
	iters: 700, epoch: 13 | loss: 0.1676643
	speed: 0.0052s/iter; left time: 40.5579s
	iters: 800, epoch: 13 | loss: 0.2029421
	speed: 0.0038s/iter; left time: 29.1552s
	iters: 900, epoch: 13 | loss: 0.4056044
	speed: 0.0043s/iter; left time: 32.5759s
	iters: 1000, epoch: 13 | loss: 0.1642362
	speed: 0.0041s/iter; left time: 31.1736s
Epoch: 13 cost time: 4.36431884765625
Epoch: 13, Steps: 1066 | Train Loss: 0.2044384 Vali Loss: 0.1155731 Test Loss: 0.1631713
EarlyStopping counter: 3 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 14 | loss: 0.2214003
	speed: 0.0193s/iter; left time: 142.0706s
	iters: 200, epoch: 14 | loss: 0.1728495
	speed: 0.0047s/iter; left time: 34.2227s
	iters: 300, epoch: 14 | loss: 0.2710197
	speed: 0.0043s/iter; left time: 30.7898s
	iters: 400, epoch: 14 | loss: 0.1585965
	speed: 0.0042s/iter; left time: 29.6797s
	iters: 500, epoch: 14 | loss: 0.3043666
	speed: 0.0052s/iter; left time: 35.8596s
	iters: 600, epoch: 14 | loss: 0.2686101
	speed: 0.0044s/iter; left time: 30.2059s
	iters: 700, epoch: 14 | loss: 0.1408172
	speed: 0.0035s/iter; left time: 23.8057s
	iters: 800, epoch: 14 | loss: 0.1197045
	speed: 0.0036s/iter; left time: 23.8535s
	iters: 900, epoch: 14 | loss: 0.5113391
	speed: 0.0038s/iter; left time: 25.1514s
	iters: 1000, epoch: 14 | loss: 0.1424970
	speed: 0.0029s/iter; left time: 19.0013s
Epoch: 14 cost time: 4.310608148574829
Epoch: 14, Steps: 1066 | Train Loss: 0.2044227 Vali Loss: 0.1154037 Test Loss: 0.1628870
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 15 | loss: 0.1063663
	speed: 0.0178s/iter; left time: 112.0432s
	iters: 200, epoch: 15 | loss: 0.1968303
	speed: 0.0036s/iter; left time: 22.2471s
	iters: 300, epoch: 15 | loss: 0.3068224
	speed: 0.0049s/iter; left time: 29.9521s
	iters: 400, epoch: 15 | loss: 0.1779082
	speed: 0.0044s/iter; left time: 26.5667s
	iters: 500, epoch: 15 | loss: 0.4571832
	speed: 0.0052s/iter; left time: 30.6827s
	iters: 600, epoch: 15 | loss: 0.1425312
	speed: 0.0037s/iter; left time: 21.5649s
	iters: 700, epoch: 15 | loss: 0.2860790
	speed: 0.0041s/iter; left time: 23.5286s
	iters: 800, epoch: 15 | loss: 0.2457333
	speed: 0.0037s/iter; left time: 20.5516s
	iters: 900, epoch: 15 | loss: 0.1771359
	speed: 0.0042s/iter; left time: 22.8581s
	iters: 1000, epoch: 15 | loss: 0.1517463
	speed: 0.0044s/iter; left time: 23.5953s
Epoch: 15 cost time: 4.538971900939941
Epoch: 15, Steps: 1066 | Train Loss: 0.2044152 Vali Loss: 0.1154233 Test Loss: 0.1629223
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTm2_336_96_NLinear_ETTm2_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed12890<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.16281060874462128, mae:0.2509014904499054
