Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTh1', data_path='ETTh1.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='Linear', model_id='ETTh1_336_192', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=192, root_path='./dataset/', save_pred_values=False, seed=10458, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTh1_336_192_Linear_ETTh1_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed10458>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8113
val 2689
test 2689
	iters: 100, epoch: 1 | loss: 0.4206928
	speed: 0.0058s/iter; left time: 28.7848s
	iters: 200, epoch: 1 | loss: 0.4604611
	speed: 0.0050s/iter; left time: 24.4691s
Epoch: 1 cost time: 1.3275883197784424
Epoch: 1, Steps: 253 | Train Loss: 0.4800847 Vali Loss: 1.0190578 Test Loss: 0.4915771
Validation loss decreased (inf --> 1.019058).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.4065422
	speed: 0.0122s/iter; left time: 57.3070s
	iters: 200, epoch: 2 | loss: 0.4479027
	speed: 0.0053s/iter; left time: 24.5780s
Epoch: 2 cost time: 1.4023754596710205
Epoch: 2, Steps: 253 | Train Loss: 0.4414161 Vali Loss: 1.1331446 Test Loss: 0.5178580
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.3855655
	speed: 0.0112s/iter; left time: 49.7297s
	iters: 200, epoch: 3 | loss: 0.3464934
	speed: 0.0051s/iter; left time: 22.3530s
Epoch: 3 cost time: 1.2923312187194824
Epoch: 3, Steps: 253 | Train Loss: 0.4001064 Vali Loss: 1.0980879 Test Loss: 0.4586289
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.3961366
	speed: 0.0114s/iter; left time: 47.9943s
	iters: 200, epoch: 4 | loss: 0.3847523
	speed: 0.0055s/iter; left time: 22.4379s
Epoch: 4 cost time: 1.3484742641448975
Epoch: 4, Steps: 253 | Train Loss: 0.3809200 Vali Loss: 0.9486443 Test Loss: 0.4260901
Validation loss decreased (1.019058 --> 0.948644).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.4362953
	speed: 0.0116s/iter; left time: 45.7007s
	iters: 200, epoch: 5 | loss: 0.3382936
	speed: 0.0050s/iter; left time: 19.2938s
Epoch: 5 cost time: 1.270268440246582
Epoch: 5, Steps: 253 | Train Loss: 0.3717146 Vali Loss: 0.9460879 Test Loss: 0.4245303
Validation loss decreased (0.948644 --> 0.946088).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.4104954
	speed: 0.0107s/iter; left time: 39.4810s
	iters: 200, epoch: 6 | loss: 0.4104869
	speed: 0.0058s/iter; left time: 21.0147s
Epoch: 6 cost time: 1.4545986652374268
Epoch: 6, Steps: 253 | Train Loss: 0.3657809 Vali Loss: 0.9452932 Test Loss: 0.4146773
Validation loss decreased (0.946088 --> 0.945293).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.4121148
	speed: 0.0138s/iter; left time: 47.4952s
	iters: 200, epoch: 7 | loss: 0.3048699
	speed: 0.0058s/iter; left time: 19.4673s
Epoch: 7 cost time: 1.509634017944336
Epoch: 7, Steps: 253 | Train Loss: 0.3630803 Vali Loss: 0.9393893 Test Loss: 0.4148318
Validation loss decreased (0.945293 --> 0.939389).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.3562858
	speed: 0.0127s/iter; left time: 40.6520s
	iters: 200, epoch: 8 | loss: 0.4117006
	speed: 0.0058s/iter; left time: 17.7686s
Epoch: 8 cost time: 1.3945677280426025
Epoch: 8, Steps: 253 | Train Loss: 0.3619000 Vali Loss: 0.9347582 Test Loss: 0.4152525
Validation loss decreased (0.939389 --> 0.934758).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.3463783
	speed: 0.0117s/iter; left time: 34.2318s
	iters: 200, epoch: 9 | loss: 0.3242665
	speed: 0.0063s/iter; left time: 17.7987s
Epoch: 9 cost time: 1.479691982269287
Epoch: 9, Steps: 253 | Train Loss: 0.3609193 Vali Loss: 0.9326455 Test Loss: 0.4151857
Validation loss decreased (0.934758 --> 0.932645).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.3741201
	speed: 0.0116s/iter; left time: 31.1432s
	iters: 200, epoch: 10 | loss: 0.4181942
	speed: 0.0053s/iter; left time: 13.8077s
Epoch: 10 cost time: 1.3624045848846436
Epoch: 10, Steps: 253 | Train Loss: 0.3602971 Vali Loss: 0.9329468 Test Loss: 0.4151708
EarlyStopping counter: 1 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.4091335
	speed: 0.0124s/iter; left time: 30.1746s
	iters: 200, epoch: 11 | loss: 0.3358357
	speed: 0.0050s/iter; left time: 11.7577s
Epoch: 11 cost time: 1.3442261219024658
Epoch: 11, Steps: 253 | Train Loss: 0.3602111 Vali Loss: 0.9335889 Test Loss: 0.4155017
EarlyStopping counter: 2 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.3230154
	speed: 0.0107s/iter; left time: 23.1958s
	iters: 200, epoch: 12 | loss: 0.3213323
	speed: 0.0050s/iter; left time: 10.4593s
Epoch: 12 cost time: 1.2705142498016357
Epoch: 12, Steps: 253 | Train Loss: 0.3598538 Vali Loss: 0.9324682 Test Loss: 0.4150955
Validation loss decreased (0.932645 --> 0.932468).  Saving model ...
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.3393966
	speed: 0.0109s/iter; left time: 20.9315s
	iters: 200, epoch: 13 | loss: 0.3318922
	speed: 0.0056s/iter; left time: 10.2540s
Epoch: 13 cost time: 1.344860553741455
Epoch: 13, Steps: 253 | Train Loss: 0.3597043 Vali Loss: 0.9326779 Test Loss: 0.4152440
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.3536863
	speed: 0.0124s/iter; left time: 20.7059s
	iters: 200, epoch: 14 | loss: 0.3507499
	speed: 0.0044s/iter; left time: 6.9689s
Epoch: 14 cost time: 1.1933307647705078
Epoch: 14, Steps: 253 | Train Loss: 0.3597092 Vali Loss: 0.9332662 Test Loss: 0.4152206
EarlyStopping counter: 2 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.3479564
	speed: 0.0093s/iter; left time: 13.1973s
	iters: 200, epoch: 15 | loss: 0.3356450
	speed: 0.0043s/iter; left time: 5.6878s
Epoch: 15 cost time: 1.0742430686950684
Epoch: 15, Steps: 253 | Train Loss: 0.3596823 Vali Loss: 0.9332681 Test Loss: 0.4152163
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.3972996
	speed: 0.0091s/iter; left time: 10.6239s
	iters: 200, epoch: 16 | loss: 0.3556585
	speed: 0.0037s/iter; left time: 3.9229s
Epoch: 16 cost time: 0.9261641502380371
Epoch: 16, Steps: 253 | Train Loss: 0.3596797 Vali Loss: 0.9329023 Test Loss: 0.4152213
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 17 | loss: 0.3630792
	speed: 0.0062s/iter; left time: 5.6263s
	iters: 200, epoch: 17 | loss: 0.3356258
	speed: 0.0028s/iter; left time: 2.2688s
Epoch: 17 cost time: 0.7063024044036865
Epoch: 17, Steps: 253 | Train Loss: 0.3598759 Vali Loss: 0.9331708 Test Loss: 0.4152190
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTh1_336_192_Linear_ETTh1_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed10458<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2689
mse:0.41453269124031067, mae:0.4211269021034241
