Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='DLinear', model_id='traffic_336_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=12890, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_336_96_DLinear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed12890>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11849
val 1661
test 3413
	iters: 100, epoch: 1 | loss: 0.5569061
	speed: 0.4056s/iter; left time: 5962.7047s
	iters: 200, epoch: 1 | loss: 0.5167637
	speed: 0.3878s/iter; left time: 5662.3873s
	iters: 300, epoch: 1 | loss: 0.5540687
	speed: 0.3854s/iter; left time: 5589.1359s
	iters: 400, epoch: 1 | loss: 0.5877225
	speed: 0.3837s/iter; left time: 5526.3346s
	iters: 500, epoch: 1 | loss: 0.5899460
	speed: 0.3852s/iter; left time: 5508.0768s
	iters: 600, epoch: 1 | loss: 0.5878711
	speed: 0.3839s/iter; left time: 5451.4361s
	iters: 700, epoch: 1 | loss: 0.5805789
	speed: 0.3860s/iter; left time: 5443.5369s
Epoch: 1 cost time: 287.34376311302185
Epoch: 1, Steps: 740 | Train Loss: 0.5827642 Vali Loss: 0.8014916 Test Loss: 0.9065214
Validation loss decreased (inf --> 0.801492).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.5391288
	speed: 0.8646s/iter; left time: 12070.9553s
	iters: 200, epoch: 2 | loss: 0.5530554
	speed: 0.3838s/iter; left time: 5319.9313s
	iters: 300, epoch: 2 | loss: 0.5751017
	speed: 0.3864s/iter; left time: 5316.7973s
	iters: 400, epoch: 2 | loss: 0.5815563
	speed: 0.3881s/iter; left time: 5302.1218s
	iters: 500, epoch: 2 | loss: 0.6173304
	speed: 0.3861s/iter; left time: 5235.6250s
	iters: 600, epoch: 2 | loss: 0.5652418
	speed: 0.3845s/iter; left time: 5176.0172s
	iters: 700, epoch: 2 | loss: 0.5619891
	speed: 0.3829s/iter; left time: 5115.7468s
Epoch: 2 cost time: 285.2147924900055
Epoch: 2, Steps: 740 | Train Loss: 0.5732075 Vali Loss: 0.7999298 Test Loss: 0.9358910
Validation loss decreased (0.801492 --> 0.799930).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.3202552
	speed: 0.8610s/iter; left time: 11382.6855s
	iters: 200, epoch: 3 | loss: 0.3630587
	speed: 0.3853s/iter; left time: 5055.8538s
	iters: 300, epoch: 3 | loss: 0.3317301
	speed: 0.3842s/iter; left time: 5002.3437s
	iters: 400, epoch: 3 | loss: 0.3484825
	speed: 0.3848s/iter; left time: 4971.8301s
	iters: 500, epoch: 3 | loss: 0.3472649
	speed: 0.3833s/iter; left time: 4913.8685s
	iters: 600, epoch: 3 | loss: 0.3518065
	speed: 0.3850s/iter; left time: 4897.5676s
	iters: 700, epoch: 3 | loss: 0.3506485
	speed: 0.3855s/iter; left time: 4865.8935s
Epoch: 3 cost time: 284.5997688770294
Epoch: 3, Steps: 740 | Train Loss: 0.3514268 Vali Loss: 0.4961451 Test Loss: 0.5987648
Validation loss decreased (0.799930 --> 0.496145).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.2776439
	speed: 0.8742s/iter; left time: 10910.3896s
	iters: 200, epoch: 4 | loss: 0.3189495
	speed: 0.3802s/iter; left time: 4706.7363s
	iters: 300, epoch: 4 | loss: 0.2911917
	speed: 0.3801s/iter; left time: 4668.1794s
	iters: 400, epoch: 4 | loss: 0.2881557
	speed: 0.3823s/iter; left time: 4656.9503s
	iters: 500, epoch: 4 | loss: 0.3006604
	speed: 0.3860s/iter; left time: 4663.7953s
	iters: 600, epoch: 4 | loss: 0.2920629
	speed: 0.3848s/iter; left time: 4610.2865s
	iters: 700, epoch: 4 | loss: 0.2702842
	speed: 0.3857s/iter; left time: 4582.3843s
Epoch: 4 cost time: 284.7687485218048
Epoch: 4, Steps: 740 | Train Loss: 0.2876605 Vali Loss: 0.4167683 Test Loss: 0.5000771
Validation loss decreased (0.496145 --> 0.416768).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.2534433
	speed: 0.8644s/iter; left time: 10148.4101s
	iters: 200, epoch: 5 | loss: 0.2580734
	speed: 0.3836s/iter; left time: 4464.9328s
	iters: 300, epoch: 5 | loss: 0.2446780
	speed: 0.3831s/iter; left time: 4421.2154s
	iters: 400, epoch: 5 | loss: 0.2985643
	speed: 0.3852s/iter; left time: 4407.4455s
	iters: 500, epoch: 5 | loss: 0.2735103
	speed: 0.3820s/iter; left time: 4332.0684s
	iters: 600, epoch: 5 | loss: 0.2415441
	speed: 0.3827s/iter; left time: 4302.4623s
	iters: 700, epoch: 5 | loss: 0.2985588
	speed: 0.3848s/iter; left time: 4287.1744s
Epoch: 5 cost time: 283.9493007659912
Epoch: 5, Steps: 740 | Train Loss: 0.2607637 Vali Loss: 0.3793713 Test Loss: 0.4613825
Validation loss decreased (0.416768 --> 0.379371).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.2251697
	speed: 0.8674s/iter; left time: 9542.5940s
	iters: 200, epoch: 6 | loss: 0.2203439
	speed: 0.3848s/iter; left time: 4194.2861s
	iters: 300, epoch: 6 | loss: 0.2218384
	speed: 0.3838s/iter; left time: 4145.4383s
	iters: 400, epoch: 6 | loss: 0.2175065
	speed: 0.3841s/iter; left time: 4110.3999s
	iters: 500, epoch: 6 | loss: 0.2092994
	speed: 0.3811s/iter; left time: 4039.8064s
	iters: 600, epoch: 6 | loss: 0.2512952
	speed: 0.3813s/iter; left time: 4003.6311s
	iters: 700, epoch: 6 | loss: 0.2333935
	speed: 0.3815s/iter; left time: 3967.9191s
Epoch: 6 cost time: 284.0470337867737
Epoch: 6, Steps: 740 | Train Loss: 0.2472455 Vali Loss: 0.3627831 Test Loss: 0.4420503
Validation loss decreased (0.379371 --> 0.362783).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.2269255
	speed: 0.8696s/iter; left time: 8922.8502s
	iters: 200, epoch: 7 | loss: 0.2385511
	speed: 0.3868s/iter; left time: 3930.6241s
	iters: 300, epoch: 7 | loss: 0.2189258
	speed: 0.3863s/iter; left time: 3886.7862s
	iters: 400, epoch: 7 | loss: 0.2456860
	speed: 0.3854s/iter; left time: 3838.8600s
	iters: 500, epoch: 7 | loss: 0.2660364
	speed: 0.3814s/iter; left time: 3760.6488s
	iters: 600, epoch: 7 | loss: 0.2265717
	speed: 0.3832s/iter; left time: 3739.9862s
	iters: 700, epoch: 7 | loss: 0.2067676
	speed: 0.3883s/iter; left time: 3751.0032s
Epoch: 7 cost time: 285.41149282455444
Epoch: 7, Steps: 740 | Train Loss: 0.2399168 Vali Loss: 0.3558116 Test Loss: 0.4342471
Validation loss decreased (0.362783 --> 0.355812).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.2677011
	speed: 0.8662s/iter; left time: 8247.4398s
	iters: 200, epoch: 8 | loss: 0.2935234
	speed: 0.3891s/iter; left time: 3665.2794s
	iters: 300, epoch: 8 | loss: 0.2469066
	speed: 0.3852s/iter; left time: 3590.6605s
	iters: 400, epoch: 8 | loss: 0.2179559
	speed: 0.3841s/iter; left time: 3542.1277s
	iters: 500, epoch: 8 | loss: 0.2232818
	speed: 0.3839s/iter; left time: 3501.3652s
	iters: 600, epoch: 8 | loss: 0.2576711
	speed: 0.3856s/iter; left time: 3478.8680s
	iters: 700, epoch: 8 | loss: 0.2636198
	speed: 0.3820s/iter; left time: 3407.7607s
Epoch: 8 cost time: 285.10666704177856
Epoch: 8, Steps: 740 | Train Loss: 0.2358392 Vali Loss: 0.3515866 Test Loss: 0.4300123
Validation loss decreased (0.355812 --> 0.351587).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.2369202
	speed: 0.8763s/iter; left time: 7694.7842s
	iters: 200, epoch: 9 | loss: 0.2068215
	speed: 0.3989s/iter; left time: 3462.9270s
	iters: 300, epoch: 9 | loss: 0.2103329
	speed: 0.3962s/iter; left time: 3399.4518s
	iters: 400, epoch: 9 | loss: 0.2121123
	speed: 0.3876s/iter; left time: 3286.8650s
	iters: 500, epoch: 9 | loss: 0.2291465
	speed: 0.3861s/iter; left time: 3236.1621s
	iters: 600, epoch: 9 | loss: 0.2337339
	speed: 0.3839s/iter; left time: 3179.1868s
	iters: 700, epoch: 9 | loss: 0.2295955
	speed: 0.3837s/iter; left time: 3139.4252s
Epoch: 9 cost time: 287.86932158470154
Epoch: 9, Steps: 740 | Train Loss: 0.2335879 Vali Loss: 0.3497384 Test Loss: 0.4274604
Validation loss decreased (0.351587 --> 0.349738).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.2495861
	speed: 0.8548s/iter; left time: 6873.3767s
	iters: 200, epoch: 10 | loss: 0.2380022
	speed: 0.3774s/iter; left time: 2997.3122s
	iters: 300, epoch: 10 | loss: 0.2693938
	speed: 0.3826s/iter; left time: 2999.7977s
	iters: 400, epoch: 10 | loss: 0.2188627
	speed: 0.3878s/iter; left time: 3002.0273s
	iters: 500, epoch: 10 | loss: 0.2685075
	speed: 0.3889s/iter; left time: 2971.4852s
	iters: 600, epoch: 10 | loss: 0.1991314
	speed: 0.3868s/iter; left time: 2916.9637s
	iters: 700, epoch: 10 | loss: 0.2462744
	speed: 0.3871s/iter; left time: 2880.5244s
Epoch: 10 cost time: 284.52653908729553
Epoch: 10, Steps: 740 | Train Loss: 0.2323070 Vali Loss: 0.3490422 Test Loss: 0.4266461
Validation loss decreased (0.349738 --> 0.349042).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.2283749
	speed: 0.8558s/iter; left time: 6247.9451s
	iters: 200, epoch: 11 | loss: 0.2321863
	speed: 0.3770s/iter; left time: 2714.7184s
	iters: 300, epoch: 11 | loss: 0.2252500
	speed: 0.3764s/iter; left time: 2673.0270s
	iters: 400, epoch: 11 | loss: 0.2156273
	speed: 0.3876s/iter; left time: 2713.7635s
	iters: 500, epoch: 11 | loss: 0.2504823
	speed: 0.3919s/iter; left time: 2704.5763s
	iters: 600, epoch: 11 | loss: 0.2597330
	speed: 0.3894s/iter; left time: 2648.4735s
	iters: 700, epoch: 11 | loss: 0.2229101
	speed: 0.3887s/iter; left time: 2604.5504s
Epoch: 11 cost time: 284.7010724544525
Epoch: 11, Steps: 740 | Train Loss: 0.2317129 Vali Loss: 0.3486018 Test Loss: 0.4261515
Validation loss decreased (0.349042 --> 0.348602).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.2459123
	speed: 0.8675s/iter; left time: 5691.5824s
	iters: 200, epoch: 12 | loss: 0.2525318
	speed: 0.3869s/iter; left time: 2499.9681s
	iters: 300, epoch: 12 | loss: 0.2358535
	speed: 0.3875s/iter; left time: 2464.8256s
	iters: 400, epoch: 12 | loss: 0.2571222
	speed: 0.3862s/iter; left time: 2417.7550s
	iters: 500, epoch: 12 | loss: 0.2408137
	speed: 0.3887s/iter; left time: 2394.5548s
	iters: 600, epoch: 12 | loss: 0.2220565
	speed: 0.3893s/iter; left time: 2359.4575s
	iters: 700, epoch: 12 | loss: 0.2204795
	speed: 0.3869s/iter; left time: 2306.3280s
Epoch: 12 cost time: 286.94149708747864
Epoch: 12, Steps: 740 | Train Loss: 0.2313260 Vali Loss: 0.3480276 Test Loss: 0.4259206
Validation loss decreased (0.348602 --> 0.348028).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.1842375
	speed: 0.8679s/iter; left time: 5052.1050s
	iters: 200, epoch: 13 | loss: 0.2331345
	speed: 0.3883s/iter; left time: 2221.6976s
	iters: 300, epoch: 13 | loss: 0.2017144
	speed: 0.3867s/iter; left time: 2173.4973s
	iters: 400, epoch: 13 | loss: 0.2294736
	speed: 0.3867s/iter; left time: 2135.0710s
	iters: 500, epoch: 13 | loss: 0.2422465
	speed: 0.3866s/iter; left time: 2095.6154s
	iters: 600, epoch: 13 | loss: 0.2357103
	speed: 0.3912s/iter; left time: 2081.7187s
	iters: 700, epoch: 13 | loss: 0.2124709
	speed: 0.3924s/iter; left time: 2048.6175s
Epoch: 13 cost time: 288.13640832901
Epoch: 13, Steps: 740 | Train Loss: 0.2311212 Vali Loss: 0.3483656 Test Loss: 0.4258833
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 14 | loss: 0.2274582
	speed: 0.8093s/iter; left time: 4112.0079s
	iters: 200, epoch: 14 | loss: 0.2239502
	speed: 0.3846s/iter; left time: 1915.8437s
	iters: 300, epoch: 14 | loss: 0.2412607
	speed: 0.3846s/iter; left time: 1877.3494s
	iters: 400, epoch: 14 | loss: 0.1822672
	speed: 0.3843s/iter; left time: 1837.4907s
	iters: 500, epoch: 14 | loss: 0.2033264
	speed: 0.3864s/iter; left time: 1808.9340s
	iters: 600, epoch: 14 | loss: 0.2198146
	speed: 0.3891s/iter; left time: 1782.6128s
	iters: 700, epoch: 14 | loss: 0.2181527
	speed: 0.3917s/iter; left time: 1755.2940s
Epoch: 14 cost time: 286.33702421188354
Epoch: 14, Steps: 740 | Train Loss: 0.2310451 Vali Loss: 0.3482071 Test Loss: 0.4258469
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 15 | loss: 0.2533115
	speed: 0.8172s/iter; left time: 3547.3109s
	iters: 200, epoch: 15 | loss: 0.2457468
	speed: 0.3902s/iter; left time: 1654.9121s
	iters: 300, epoch: 15 | loss: 0.2183448
	speed: 0.3875s/iter; left time: 1604.4882s
	iters: 400, epoch: 15 | loss: 0.2227396
	speed: 0.3849s/iter; left time: 1555.2704s
	iters: 500, epoch: 15 | loss: 0.1943956
	speed: 0.3846s/iter; left time: 1515.5944s
	iters: 600, epoch: 15 | loss: 0.2010499
	speed: 0.3842s/iter; left time: 1475.8664s
	iters: 700, epoch: 15 | loss: 0.2131880
	speed: 0.3871s/iter; left time: 1448.0174s
Epoch: 15 cost time: 286.33988785743713
Epoch: 15, Steps: 740 | Train Loss: 0.2309584 Vali Loss: 0.3482030 Test Loss: 0.4258416
EarlyStopping counter: 3 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 16 | loss: 0.2089585
	speed: 0.8190s/iter; left time: 2949.3561s
	iters: 200, epoch: 16 | loss: 0.2760575
	speed: 0.3885s/iter; left time: 1360.0249s
	iters: 300, epoch: 16 | loss: 0.2191374
	speed: 0.3868s/iter; left time: 1315.3726s
	iters: 400, epoch: 16 | loss: 0.2537088
	speed: 0.3876s/iter; left time: 1279.3497s
	iters: 500, epoch: 16 | loss: 0.2418688
	speed: 0.3961s/iter; left time: 1267.9778s
	iters: 600, epoch: 16 | loss: 0.2643908
	speed: 0.3866s/iter; left time: 1198.9308s
	iters: 700, epoch: 16 | loss: 0.2335384
	speed: 0.3855s/iter; left time: 1156.8720s
Epoch: 16 cost time: 288.2015907764435
Epoch: 16, Steps: 740 | Train Loss: 0.2309393 Vali Loss: 0.3484535 Test Loss: 0.4258391
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 17 | loss: 0.2669865
	speed: 0.8095s/iter; left time: 2316.0849s
	iters: 200, epoch: 17 | loss: 0.2485761
	speed: 0.3873s/iter; left time: 1069.3212s
	iters: 300, epoch: 17 | loss: 0.2305789
	speed: 0.3891s/iter; left time: 1035.3694s
	iters: 400, epoch: 17 | loss: 0.1988872
	speed: 0.3882s/iter; left time: 994.2837s
	iters: 500, epoch: 17 | loss: 0.2405504
	speed: 0.3891s/iter; left time: 957.6821s
	iters: 600, epoch: 17 | loss: 0.2464952
	speed: 0.3905s/iter; left time: 921.9816s
	iters: 700, epoch: 17 | loss: 0.2201832
	speed: 0.3864s/iter; left time: 873.7280s
Epoch: 17 cost time: 287.2280287742615
Epoch: 17, Steps: 740 | Train Loss: 0.2309099 Vali Loss: 0.3480777 Test Loss: 0.4258394
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : traffic_336_96_DLinear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed12890<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3413
mse:0.4261782169342041, mae:0.2985222041606903
