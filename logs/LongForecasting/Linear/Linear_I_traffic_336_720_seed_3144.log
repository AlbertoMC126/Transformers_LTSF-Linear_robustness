Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='Linear', model_id='traffic_336_720', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=720, root_path='./dataset/', save_pred_values=False, seed=3144, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_336_720_Linear_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3144>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11225
val 1037
test 2789
	iters: 100, epoch: 1 | loss: 0.4809511
	speed: 0.3436s/iter; left time: 4783.7180s
	iters: 200, epoch: 1 | loss: 0.5000817
	speed: 0.3303s/iter; left time: 4564.4471s
	iters: 300, epoch: 1 | loss: 0.4778856
	speed: 0.3288s/iter; left time: 4511.7914s
	iters: 400, epoch: 1 | loss: 0.5054523
	speed: 0.3283s/iter; left time: 4471.1032s
	iters: 500, epoch: 1 | loss: 0.5143684
	speed: 0.3286s/iter; left time: 4442.7339s
	iters: 600, epoch: 1 | loss: 0.5122104
	speed: 0.3290s/iter; left time: 4414.8718s
	iters: 700, epoch: 1 | loss: 0.5367965
	speed: 0.3287s/iter; left time: 4378.2840s
Epoch: 1 cost time: 232.26203274726868
Epoch: 1, Steps: 701 | Train Loss: 0.5132370 Vali Loss: 0.7041305 Test Loss: 0.8141226
Validation loss decreased (inf --> 0.704131).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.4978595
	speed: 0.6211s/iter; left time: 8210.7928s
	iters: 200, epoch: 2 | loss: 0.4976049
	speed: 0.3306s/iter; left time: 4336.8566s
	iters: 300, epoch: 2 | loss: 0.4936380
	speed: 0.3296s/iter; left time: 4291.9482s
	iters: 400, epoch: 2 | loss: 0.5082562
	speed: 0.3292s/iter; left time: 4253.7432s
	iters: 500, epoch: 2 | loss: 0.5033575
	speed: 0.3290s/iter; left time: 4217.9717s
	iters: 600, epoch: 2 | loss: 0.5337105
	speed: 0.3290s/iter; left time: 4185.2582s
	iters: 700, epoch: 2 | loss: 0.4942356
	speed: 0.3288s/iter; left time: 4149.0089s
Epoch: 2 cost time: 231.21360874176025
Epoch: 2, Steps: 701 | Train Loss: 0.5070566 Vali Loss: 0.6866919 Test Loss: 0.8065742
Validation loss decreased (0.704131 --> 0.686692).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.3575880
	speed: 0.6253s/iter; left time: 7827.7489s
	iters: 200, epoch: 3 | loss: 0.3720164
	speed: 0.3323s/iter; left time: 4126.4476s
	iters: 300, epoch: 3 | loss: 0.3448209
	speed: 0.3302s/iter; left time: 4067.4989s
	iters: 400, epoch: 3 | loss: 0.3694463
	speed: 0.3317s/iter; left time: 4053.3248s
	iters: 500, epoch: 3 | loss: 0.3594411
	speed: 0.3303s/iter; left time: 4003.4581s
	iters: 600, epoch: 3 | loss: 0.3618945
	speed: 0.3305s/iter; left time: 3971.9570s
	iters: 700, epoch: 3 | loss: 0.3493579
	speed: 0.3306s/iter; left time: 3940.7838s
Epoch: 3 cost time: 232.28647804260254
Epoch: 3, Steps: 701 | Train Loss: 0.3611750 Vali Loss: 0.5215886 Test Loss: 0.6089662
Validation loss decreased (0.686692 --> 0.521589).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.3234171
	speed: 0.6196s/iter; left time: 7322.8851s
	iters: 200, epoch: 4 | loss: 0.2994004
	speed: 0.3325s/iter; left time: 3896.4241s
	iters: 300, epoch: 4 | loss: 0.2978197
	speed: 0.3300s/iter; left time: 3833.9124s
	iters: 400, epoch: 4 | loss: 0.2937257
	speed: 0.3297s/iter; left time: 3797.5796s
	iters: 500, epoch: 4 | loss: 0.3032356
	speed: 0.3296s/iter; left time: 3763.3217s
	iters: 600, epoch: 4 | loss: 0.3154921
	speed: 0.3299s/iter; left time: 3733.4982s
	iters: 700, epoch: 4 | loss: 0.3125745
	speed: 0.3296s/iter; left time: 3697.6588s
Epoch: 4 cost time: 231.6067008972168
Epoch: 4, Steps: 701 | Train Loss: 0.3119555 Vali Loss: 0.4675253 Test Loss: 0.5417345
Validation loss decreased (0.521589 --> 0.467525).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.2883962
	speed: 0.6273s/iter; left time: 6973.4175s
	iters: 200, epoch: 5 | loss: 0.2964925
	speed: 0.3360s/iter; left time: 3701.2165s
	iters: 300, epoch: 5 | loss: 0.2839624
	speed: 0.3429s/iter; left time: 3743.5050s
	iters: 400, epoch: 5 | loss: 0.2906920
	speed: 0.3403s/iter; left time: 3681.4807s
	iters: 500, epoch: 5 | loss: 0.2884562
	speed: 0.3322s/iter; left time: 3559.6745s
	iters: 600, epoch: 5 | loss: 0.2745232
	speed: 0.3314s/iter; left time: 3518.8941s
	iters: 700, epoch: 5 | loss: 0.3023182
	speed: 0.3310s/iter; left time: 3481.2707s
Epoch: 5 cost time: 235.47654461860657
Epoch: 5, Steps: 701 | Train Loss: 0.2902590 Vali Loss: 0.4425849 Test Loss: 0.5092724
Validation loss decreased (0.467525 --> 0.442585).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.3116041
	speed: 0.6239s/iter; left time: 6498.0854s
	iters: 200, epoch: 6 | loss: 0.2845889
	speed: 0.3333s/iter; left time: 3438.2639s
	iters: 300, epoch: 6 | loss: 0.2589876
	speed: 0.3307s/iter; left time: 3378.8718s
	iters: 400, epoch: 6 | loss: 0.2824007
	speed: 0.3300s/iter; left time: 3338.1306s
	iters: 500, epoch: 6 | loss: 0.2554476
	speed: 0.3304s/iter; left time: 3309.2129s
	iters: 600, epoch: 6 | loss: 0.2785850
	speed: 0.3298s/iter; left time: 3270.3704s
	iters: 700, epoch: 6 | loss: 0.2875806
	speed: 0.3296s/iter; left time: 3235.5301s
Epoch: 6 cost time: 232.1101484298706
Epoch: 6, Steps: 701 | Train Loss: 0.2789253 Vali Loss: 0.4301292 Test Loss: 0.4946142
Validation loss decreased (0.442585 --> 0.430129).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.2933219
	speed: 0.6244s/iter; left time: 6066.3557s
	iters: 200, epoch: 7 | loss: 0.2815129
	speed: 0.3327s/iter; left time: 3199.2042s
	iters: 300, epoch: 7 | loss: 0.2648885
	speed: 0.3297s/iter; left time: 3137.1079s
	iters: 400, epoch: 7 | loss: 0.2832508
	speed: 0.3304s/iter; left time: 3110.5198s
	iters: 500, epoch: 7 | loss: 0.2906005
	speed: 0.3300s/iter; left time: 3074.3193s
	iters: 600, epoch: 7 | loss: 0.2693367
	speed: 0.3305s/iter; left time: 3045.3403s
	iters: 700, epoch: 7 | loss: 0.2625062
	speed: 0.3296s/iter; left time: 3004.2665s
Epoch: 7 cost time: 231.81455039978027
Epoch: 7, Steps: 701 | Train Loss: 0.2727615 Vali Loss: 0.4245903 Test Loss: 0.4887171
Validation loss decreased (0.430129 --> 0.424590).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.2687549
	speed: 0.6225s/iter; left time: 5611.3997s
	iters: 200, epoch: 8 | loss: 0.2856794
	speed: 0.3337s/iter; left time: 2974.9142s
	iters: 300, epoch: 8 | loss: 0.2944358
	speed: 0.3324s/iter; left time: 2929.5389s
	iters: 400, epoch: 8 | loss: 0.2539827
	speed: 0.3302s/iter; left time: 2877.6878s
	iters: 500, epoch: 8 | loss: 0.2760086
	speed: 0.3298s/iter; left time: 2841.0743s
	iters: 600, epoch: 8 | loss: 0.2463485
	speed: 0.3289s/iter; left time: 2800.1674s
	iters: 700, epoch: 8 | loss: 0.2579528
	speed: 0.3305s/iter; left time: 2780.8449s
Epoch: 8 cost time: 232.2226767539978
Epoch: 8, Steps: 701 | Train Loss: 0.2693890 Vali Loss: 0.4225262 Test Loss: 0.4857343
Validation loss decreased (0.424590 --> 0.422526).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.2783303
	speed: 0.6227s/iter; left time: 5176.2217s
	iters: 200, epoch: 9 | loss: 0.2701891
	speed: 0.3354s/iter; left time: 2754.4921s
	iters: 300, epoch: 9 | loss: 0.2674489
	speed: 0.3320s/iter; left time: 2693.6687s
	iters: 400, epoch: 9 | loss: 0.2560429
	speed: 0.3295s/iter; left time: 2640.2116s
	iters: 500, epoch: 9 | loss: 0.2799090
	speed: 0.3287s/iter; left time: 2601.3732s
	iters: 600, epoch: 9 | loss: 0.2561511
	speed: 0.3285s/iter; left time: 2566.8508s
	iters: 700, epoch: 9 | loss: 0.2692598
	speed: 0.3286s/iter; left time: 2534.3087s
Epoch: 9 cost time: 231.95941400527954
Epoch: 9, Steps: 701 | Train Loss: 0.2675167 Vali Loss: 0.4209743 Test Loss: 0.4843184
Validation loss decreased (0.422526 --> 0.420974).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.2556987
	speed: 0.6186s/iter; left time: 4708.5760s
	iters: 200, epoch: 10 | loss: 0.2638801
	speed: 0.3308s/iter; left time: 2484.7007s
	iters: 300, epoch: 10 | loss: 0.2785757
	speed: 0.3288s/iter; left time: 2437.3255s
	iters: 400, epoch: 10 | loss: 0.2784740
	speed: 0.3288s/iter; left time: 2404.1565s
	iters: 500, epoch: 10 | loss: 0.2708988
	speed: 0.3300s/iter; left time: 2380.2218s
	iters: 600, epoch: 10 | loss: 0.2554232
	speed: 0.3302s/iter; left time: 2348.6838s
	iters: 700, epoch: 10 | loss: 0.2713600
	speed: 0.3296s/iter; left time: 2310.9237s
Epoch: 10 cost time: 231.21756744384766
Epoch: 10, Steps: 701 | Train Loss: 0.2665017 Vali Loss: 0.4203644 Test Loss: 0.4831792
Validation loss decreased (0.420974 --> 0.420364).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.2497585
	speed: 0.6206s/iter; left time: 4288.8706s
	iters: 200, epoch: 11 | loss: 0.2749266
	speed: 0.3330s/iter; left time: 2268.2006s
	iters: 300, epoch: 11 | loss: 0.2569103
	speed: 0.3311s/iter; left time: 2222.0328s
	iters: 400, epoch: 11 | loss: 0.2654111
	speed: 0.3301s/iter; left time: 2182.4839s
	iters: 500, epoch: 11 | loss: 0.2524537
	speed: 0.3309s/iter; left time: 2154.2596s
	iters: 600, epoch: 11 | loss: 0.2689162
	speed: 0.3305s/iter; left time: 2119.0761s
	iters: 700, epoch: 11 | loss: 0.2507829
	speed: 0.3305s/iter; left time: 2085.9726s
Epoch: 11 cost time: 232.08417677879333
Epoch: 11, Steps: 701 | Train Loss: 0.2659199 Vali Loss: 0.4202957 Test Loss: 0.4832188
Validation loss decreased (0.420364 --> 0.420296).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.2737084
	speed: 0.6240s/iter; left time: 3875.0371s
	iters: 200, epoch: 12 | loss: 0.2669581
	speed: 0.3345s/iter; left time: 2043.5922s
	iters: 300, epoch: 12 | loss: 0.2721969
	speed: 0.3319s/iter; left time: 1994.7722s
	iters: 400, epoch: 12 | loss: 0.2709917
	speed: 0.3309s/iter; left time: 1955.8117s
	iters: 500, epoch: 12 | loss: 0.2594598
	speed: 0.3305s/iter; left time: 1920.4490s
	iters: 600, epoch: 12 | loss: 0.2636427
	speed: 0.3316s/iter; left time: 1893.3375s
	iters: 700, epoch: 12 | loss: 0.2555012
	speed: 0.3309s/iter; left time: 1856.1396s
Epoch: 12 cost time: 232.6759476661682
Epoch: 12, Steps: 701 | Train Loss: 0.2656157 Vali Loss: 0.4202262 Test Loss: 0.4829195
Validation loss decreased (0.420296 --> 0.420226).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.2601299
	speed: 0.6265s/iter; left time: 3451.5212s
	iters: 200, epoch: 13 | loss: 0.2750114
	speed: 0.3346s/iter; left time: 1809.9479s
	iters: 300, epoch: 13 | loss: 0.2577450
	speed: 0.3298s/iter; left time: 1750.8237s
	iters: 400, epoch: 13 | loss: 0.2499206
	speed: 0.3290s/iter; left time: 1713.8102s
	iters: 500, epoch: 13 | loss: 0.2525271
	speed: 0.3289s/iter; left time: 1680.1329s
	iters: 600, epoch: 13 | loss: 0.2524798
	speed: 0.3294s/iter; left time: 1650.0024s
	iters: 700, epoch: 13 | loss: 0.2697791
	speed: 0.3298s/iter; left time: 1619.1727s
Epoch: 13 cost time: 232.08408331871033
Epoch: 13, Steps: 701 | Train Loss: 0.2654848 Vali Loss: 0.4201072 Test Loss: 0.4829406
Validation loss decreased (0.420226 --> 0.420107).  Saving model ...
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 14 | loss: 0.2837030
	speed: 0.6229s/iter; left time: 2994.6965s
	iters: 200, epoch: 14 | loss: 0.2657871
	speed: 0.3322s/iter; left time: 1563.9664s
	iters: 300, epoch: 14 | loss: 0.2608737
	speed: 0.3286s/iter; left time: 1514.2473s
	iters: 400, epoch: 14 | loss: 0.2633953
	speed: 0.3290s/iter; left time: 1483.0361s
	iters: 500, epoch: 14 | loss: 0.2554409
	speed: 0.3290s/iter; left time: 1450.4051s
	iters: 600, epoch: 14 | loss: 0.2762012
	speed: 0.3292s/iter; left time: 1418.1070s
	iters: 700, epoch: 14 | loss: 0.2714222
	speed: 0.3290s/iter; left time: 1384.6109s
Epoch: 14 cost time: 231.41094613075256
Epoch: 14, Steps: 701 | Train Loss: 0.2653892 Vali Loss: 0.4204134 Test Loss: 0.4829342
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 15 | loss: 0.2712905
	speed: 0.6136s/iter; left time: 2520.1648s
	iters: 200, epoch: 15 | loss: 0.2692011
	speed: 0.3295s/iter; left time: 1320.4235s
	iters: 300, epoch: 15 | loss: 0.2607806
	speed: 0.3293s/iter; left time: 1286.4624s
	iters: 400, epoch: 15 | loss: 0.2612811
	speed: 0.3285s/iter; left time: 1250.7773s
	iters: 500, epoch: 15 | loss: 0.2884840
	speed: 0.3292s/iter; left time: 1220.3845s
	iters: 600, epoch: 15 | loss: 0.2692949
	speed: 0.3289s/iter; left time: 1186.2179s
	iters: 700, epoch: 15 | loss: 0.2701541
	speed: 0.3291s/iter; left time: 1154.0923s
Epoch: 15 cost time: 230.77716660499573
Epoch: 15, Steps: 701 | Train Loss: 0.2653457 Vali Loss: 0.4195870 Test Loss: 0.4829327
Validation loss decreased (0.420107 --> 0.419587).  Saving model ...
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 16 | loss: 0.2982339
	speed: 0.6229s/iter; left time: 2121.7637s
	iters: 200, epoch: 16 | loss: 0.2854082
	speed: 0.3326s/iter; left time: 1099.4505s
	iters: 300, epoch: 16 | loss: 0.2514194
	speed: 0.3296s/iter; left time: 1056.6275s
	iters: 400, epoch: 16 | loss: 0.2620698
	speed: 0.3290s/iter; left time: 1022.0183s
	iters: 500, epoch: 16 | loss: 0.2436667
	speed: 0.3281s/iter; left time: 986.4148s
	iters: 600, epoch: 16 | loss: 0.2543090
	speed: 0.3288s/iter; left time: 955.5405s
	iters: 700, epoch: 16 | loss: 0.2477164
	speed: 0.3283s/iter; left time: 921.2839s
Epoch: 16 cost time: 231.43529963493347
Epoch: 16, Steps: 701 | Train Loss: 0.2653328 Vali Loss: 0.4203130 Test Loss: 0.4829321
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 17 | loss: 0.2650517
	speed: 0.6151s/iter; left time: 1663.9592s
	iters: 200, epoch: 17 | loss: 0.2516915
	speed: 0.3313s/iter; left time: 863.0027s
	iters: 300, epoch: 17 | loss: 0.2665780
	speed: 0.3295s/iter; left time: 825.3298s
	iters: 400, epoch: 17 | loss: 0.2647558
	speed: 0.3287s/iter; left time: 790.5686s
	iters: 500, epoch: 17 | loss: 0.2748957
	speed: 0.3297s/iter; left time: 759.8578s
	iters: 600, epoch: 17 | loss: 0.2639623
	speed: 0.3286s/iter; left time: 724.5812s
	iters: 700, epoch: 17 | loss: 0.2434474
	speed: 0.3286s/iter; left time: 691.7560s
Epoch: 17 cost time: 231.28949761390686
Epoch: 17, Steps: 701 | Train Loss: 0.2652981 Vali Loss: 0.4202020 Test Loss: 0.4829345
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 18 | loss: 0.2792864
	speed: 0.6143s/iter; left time: 1231.0909s
	iters: 200, epoch: 18 | loss: 0.2570893
	speed: 0.3294s/iter; left time: 627.1147s
	iters: 300, epoch: 18 | loss: 0.2530119
	speed: 0.3280s/iter; left time: 591.7551s
	iters: 400, epoch: 18 | loss: 0.2550757
	speed: 0.3284s/iter; left time: 559.5834s
	iters: 500, epoch: 18 | loss: 0.2642308
	speed: 0.3289s/iter; left time: 527.5037s
	iters: 600, epoch: 18 | loss: 0.3012773
	speed: 0.3284s/iter; left time: 493.9156s
	iters: 700, epoch: 18 | loss: 0.2588925
	speed: 0.3286s/iter; left time: 461.3466s
Epoch: 18 cost time: 230.73215746879578
Epoch: 18, Steps: 701 | Train Loss: 0.2653246 Vali Loss: 0.4200129 Test Loss: 0.4829345
EarlyStopping counter: 3 out of 5
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 19 | loss: 0.2481258
	speed: 0.6114s/iter; left time: 796.6213s
	iters: 200, epoch: 19 | loss: 0.2615545
	speed: 0.3282s/iter; left time: 394.7678s
	iters: 300, epoch: 19 | loss: 0.2533007
	speed: 0.3285s/iter; left time: 362.3664s
	iters: 400, epoch: 19 | loss: 0.2716513
	speed: 0.3289s/iter; left time: 329.8711s
	iters: 500, epoch: 19 | loss: 0.2743059
	speed: 0.3285s/iter; left time: 296.6382s
	iters: 600, epoch: 19 | loss: 0.2674984
	speed: 0.3288s/iter; left time: 264.0120s
	iters: 700, epoch: 19 | loss: 0.2604307
	speed: 0.3294s/iter; left time: 231.5805s
Epoch: 19 cost time: 230.45024490356445
Epoch: 19, Steps: 701 | Train Loss: 0.2653042 Vali Loss: 0.4200835 Test Loss: 0.4829347
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 20 | loss: 0.2705269
	speed: 0.6138s/iter; left time: 369.4839s
	iters: 200, epoch: 20 | loss: 0.2694362
	speed: 0.3302s/iter; left time: 165.7702s
	iters: 300, epoch: 20 | loss: 0.2586280
	speed: 0.3280s/iter; left time: 131.8432s
	iters: 400, epoch: 20 | loss: 0.2551647
	speed: 0.3283s/iter; left time: 99.1328s
	iters: 500, epoch: 20 | loss: 0.2446838
	speed: 0.3282s/iter; left time: 66.2897s
	iters: 600, epoch: 20 | loss: 0.2817754
	speed: 0.3289s/iter; left time: 33.5489s
	iters: 700, epoch: 20 | loss: 0.2314000
	speed: 0.3293s/iter; left time: 0.6587s
Epoch: 20 cost time: 230.7275857925415
Epoch: 20, Steps: 701 | Train Loss: 0.2653137 Vali Loss: 0.4200100 Test Loss: 0.4829348
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : traffic_336_720_Linear_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3144<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2789
mse:0.48274803161621094, mae:0.3304981291294098
