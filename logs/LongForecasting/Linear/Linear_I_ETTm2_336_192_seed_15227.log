Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='Linear', model_id='ETTm2_336_192', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=192, root_path='./dataset/', save_pred_values=False, seed=15227, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTm2_336_192_Linear_ETTm2_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15227>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34033
val 11329
test 11329
	iters: 100, epoch: 1 | loss: 0.3309966
	speed: 0.0050s/iter; left time: 106.4401s
	iters: 200, epoch: 1 | loss: 0.2931687
	speed: 0.0060s/iter; left time: 126.4196s
	iters: 300, epoch: 1 | loss: 0.2947843
	speed: 0.0067s/iter; left time: 140.8996s
	iters: 400, epoch: 1 | loss: 0.2662223
	speed: 0.0057s/iter; left time: 118.7097s
	iters: 500, epoch: 1 | loss: 0.4425386
	speed: 0.0051s/iter; left time: 106.7556s
	iters: 600, epoch: 1 | loss: 0.5830990
	speed: 0.0056s/iter; left time: 116.1146s
	iters: 700, epoch: 1 | loss: 0.4064409
	speed: 0.0065s/iter; left time: 132.9062s
	iters: 800, epoch: 1 | loss: 0.2181475
	speed: 0.0067s/iter; left time: 137.9563s
	iters: 900, epoch: 1 | loss: 0.4579065
	speed: 0.0068s/iter; left time: 138.1758s
	iters: 1000, epoch: 1 | loss: 0.5561943
	speed: 0.0065s/iter; left time: 130.9350s
Epoch: 1 cost time: 6.452287673950195
Epoch: 1, Steps: 1063 | Train Loss: 0.5001152 Vali Loss: 0.3202432 Test Loss: 0.5262038
Validation loss decreased (inf --> 0.320243).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 1.2368425
	speed: 0.0254s/iter; left time: 509.8741s
	iters: 200, epoch: 2 | loss: 0.3925017
	speed: 0.0053s/iter; left time: 106.0006s
	iters: 300, epoch: 2 | loss: 0.3359887
	speed: 0.0051s/iter; left time: 102.1280s
	iters: 400, epoch: 2 | loss: 0.6592596
	speed: 0.0056s/iter; left time: 111.6609s
	iters: 500, epoch: 2 | loss: 0.5337602
	speed: 0.0059s/iter; left time: 117.0771s
	iters: 600, epoch: 2 | loss: 0.9539963
	speed: 0.0065s/iter; left time: 127.7795s
	iters: 700, epoch: 2 | loss: 0.7283580
	speed: 0.0063s/iter; left time: 123.2470s
	iters: 800, epoch: 2 | loss: 0.4230370
	speed: 0.0067s/iter; left time: 130.0457s
	iters: 900, epoch: 2 | loss: 0.4204378
	speed: 0.0064s/iter; left time: 124.0965s
	iters: 1000, epoch: 2 | loss: 1.0611484
	speed: 0.0059s/iter; left time: 112.5405s
Epoch: 2 cost time: 6.283783197402954
Epoch: 2, Steps: 1063 | Train Loss: 0.5060133 Vali Loss: 0.3540983 Test Loss: 0.7589253
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.4014701
	speed: 0.0242s/iter; left time: 460.9405s
	iters: 200, epoch: 3 | loss: 0.2478009
	speed: 0.0054s/iter; left time: 101.5514s
	iters: 300, epoch: 3 | loss: 0.1644681
	speed: 0.0050s/iter; left time: 93.3882s
	iters: 400, epoch: 3 | loss: 0.3663224
	speed: 0.0054s/iter; left time: 100.2750s
	iters: 500, epoch: 3 | loss: 0.3376667
	speed: 0.0063s/iter; left time: 116.8520s
	iters: 600, epoch: 3 | loss: 0.2455312
	speed: 0.0056s/iter; left time: 104.3520s
	iters: 700, epoch: 3 | loss: 0.3540188
	speed: 0.0055s/iter; left time: 101.4589s
	iters: 800, epoch: 3 | loss: 0.2027509
	speed: 0.0063s/iter; left time: 114.9644s
	iters: 900, epoch: 3 | loss: 0.2404564
	speed: 0.0060s/iter; left time: 109.6495s
	iters: 1000, epoch: 3 | loss: 0.3169621
	speed: 0.0062s/iter; left time: 112.6656s
Epoch: 3 cost time: 6.108378887176514
Epoch: 3, Steps: 1063 | Train Loss: 0.3514319 Vali Loss: 0.2852883 Test Loss: 0.5681369
Validation loss decreased (0.320243 --> 0.285288).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.7105479
	speed: 0.0242s/iter; left time: 435.5334s
	iters: 200, epoch: 4 | loss: 0.2233026
	speed: 0.0051s/iter; left time: 90.7895s
	iters: 300, epoch: 4 | loss: 0.4413386
	speed: 0.0061s/iter; left time: 107.7432s
	iters: 400, epoch: 4 | loss: 0.2400534
	speed: 0.0057s/iter; left time: 100.5907s
	iters: 500, epoch: 4 | loss: 0.3423394
	speed: 0.0056s/iter; left time: 97.8762s
	iters: 600, epoch: 4 | loss: 0.3254004
	speed: 0.0052s/iter; left time: 90.0311s
	iters: 700, epoch: 4 | loss: 0.3720243
	speed: 0.0059s/iter; left time: 101.8000s
	iters: 800, epoch: 4 | loss: 0.4625397
	speed: 0.0060s/iter; left time: 103.3367s
	iters: 900, epoch: 4 | loss: 0.2035790
	speed: 0.0060s/iter; left time: 102.1791s
	iters: 1000, epoch: 4 | loss: 0.2400911
	speed: 0.0056s/iter; left time: 96.2860s
Epoch: 4 cost time: 6.035261392593384
Epoch: 4, Steps: 1063 | Train Loss: 0.3139983 Vali Loss: 0.2069618 Test Loss: 0.3579053
Validation loss decreased (0.285288 --> 0.206962).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.3069715
	speed: 0.0240s/iter; left time: 406.2544s
	iters: 200, epoch: 5 | loss: 0.2165301
	speed: 0.0051s/iter; left time: 85.4512s
	iters: 300, epoch: 5 | loss: 0.3951155
	speed: 0.0064s/iter; left time: 106.1627s
	iters: 400, epoch: 5 | loss: 0.4303772
	speed: 0.0055s/iter; left time: 90.8514s
	iters: 500, epoch: 5 | loss: 0.3594993
	speed: 0.0056s/iter; left time: 91.6771s
	iters: 600, epoch: 5 | loss: 0.2930581
	speed: 0.0067s/iter; left time: 110.5966s
	iters: 700, epoch: 5 | loss: 0.4135043
	speed: 0.0064s/iter; left time: 104.9322s
	iters: 800, epoch: 5 | loss: 0.4484069
	speed: 0.0056s/iter; left time: 90.9796s
	iters: 900, epoch: 5 | loss: 0.2633494
	speed: 0.0058s/iter; left time: 93.3089s
	iters: 1000, epoch: 5 | loss: 0.2055734
	speed: 0.0050s/iter; left time: 79.7627s
Epoch: 5 cost time: 5.9942076206207275
Epoch: 5, Steps: 1063 | Train Loss: 0.2956631 Vali Loss: 0.2451033 Test Loss: 0.4478149
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.4197882
	speed: 0.0233s/iter; left time: 369.6041s
	iters: 200, epoch: 6 | loss: 0.2436115
	speed: 0.0053s/iter; left time: 83.4897s
	iters: 300, epoch: 6 | loss: 0.3204188
	speed: 0.0051s/iter; left time: 79.1685s
	iters: 400, epoch: 6 | loss: 0.3791558
	speed: 0.0053s/iter; left time: 81.6399s
	iters: 500, epoch: 6 | loss: 0.5784249
	speed: 0.0059s/iter; left time: 91.1311s
	iters: 600, epoch: 6 | loss: 0.1957934
	speed: 0.0064s/iter; left time: 97.6434s
	iters: 700, epoch: 6 | loss: 0.2450378
	speed: 0.0063s/iter; left time: 96.0499s
	iters: 800, epoch: 6 | loss: 0.2057152
	speed: 0.0064s/iter; left time: 97.3019s
	iters: 900, epoch: 6 | loss: 0.2924051
	speed: 0.0058s/iter; left time: 87.2976s
	iters: 1000, epoch: 6 | loss: 0.2886989
	speed: 0.0065s/iter; left time: 97.4482s
Epoch: 6 cost time: 6.163510084152222
Epoch: 6, Steps: 1063 | Train Loss: 0.2864831 Vali Loss: 0.2429275 Test Loss: 0.4297898
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.5301505
	speed: 0.0277s/iter; left time: 409.6384s
	iters: 200, epoch: 7 | loss: 0.1833315
	speed: 0.0067s/iter; left time: 99.0218s
	iters: 300, epoch: 7 | loss: 0.2480130
	speed: 0.0062s/iter; left time: 90.9981s
	iters: 400, epoch: 7 | loss: 0.2446729
	speed: 0.0056s/iter; left time: 81.0197s
	iters: 500, epoch: 7 | loss: 0.2314303
	speed: 0.0065s/iter; left time: 92.9559s
	iters: 600, epoch: 7 | loss: 0.1232943
	speed: 0.0052s/iter; left time: 73.9221s
	iters: 700, epoch: 7 | loss: 0.3609490
	speed: 0.0054s/iter; left time: 76.9016s
	iters: 800, epoch: 7 | loss: 0.4114917
	speed: 0.0060s/iter; left time: 84.0803s
	iters: 900, epoch: 7 | loss: 0.5009013
	speed: 0.0059s/iter; left time: 82.9528s
	iters: 1000, epoch: 7 | loss: 0.3102103
	speed: 0.0055s/iter; left time: 76.0788s
Epoch: 7 cost time: 6.327757358551025
Epoch: 7, Steps: 1063 | Train Loss: 0.2804629 Vali Loss: 0.1891388 Test Loss: 0.3176337
Validation loss decreased (0.206962 --> 0.189139).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.1790764
	speed: 0.0242s/iter; left time: 332.5476s
	iters: 200, epoch: 8 | loss: 0.4026460
	speed: 0.0054s/iter; left time: 73.1197s
	iters: 300, epoch: 8 | loss: 0.1552599
	speed: 0.0054s/iter; left time: 72.6282s
	iters: 400, epoch: 8 | loss: 0.3057153
	speed: 0.0054s/iter; left time: 72.1997s
	iters: 500, epoch: 8 | loss: 0.5894699
	speed: 0.0053s/iter; left time: 70.7738s
	iters: 600, epoch: 8 | loss: 0.1778317
	speed: 0.0063s/iter; left time: 83.1810s
	iters: 700, epoch: 8 | loss: 0.6446926
	speed: 0.0056s/iter; left time: 72.9542s
	iters: 800, epoch: 8 | loss: 0.4838107
	speed: 0.0049s/iter; left time: 64.3474s
	iters: 900, epoch: 8 | loss: 0.6791576
	speed: 0.0057s/iter; left time: 73.4982s
	iters: 1000, epoch: 8 | loss: 0.2623844
	speed: 0.0059s/iter; left time: 75.4151s
Epoch: 8 cost time: 5.890267372131348
Epoch: 8, Steps: 1063 | Train Loss: 0.2773555 Vali Loss: 0.2050770 Test Loss: 0.3581322
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.2577775
	speed: 0.0217s/iter; left time: 274.4499s
	iters: 200, epoch: 9 | loss: 0.1745326
	speed: 0.0057s/iter; left time: 71.7483s
	iters: 300, epoch: 9 | loss: 0.1935772
	speed: 0.0064s/iter; left time: 79.8493s
	iters: 400, epoch: 9 | loss: 0.5084226
	speed: 0.0064s/iter; left time: 79.3658s
	iters: 500, epoch: 9 | loss: 0.4692642
	speed: 0.0061s/iter; left time: 75.1355s
	iters: 600, epoch: 9 | loss: 0.1585074
	speed: 0.0057s/iter; left time: 69.5685s
	iters: 700, epoch: 9 | loss: 0.1488953
	speed: 0.0048s/iter; left time: 57.3820s
	iters: 800, epoch: 9 | loss: 0.2390583
	speed: 0.0052s/iter; left time: 61.9622s
	iters: 900, epoch: 9 | loss: 0.2815588
	speed: 0.0049s/iter; left time: 58.2239s
	iters: 1000, epoch: 9 | loss: 0.2390205
	speed: 0.0051s/iter; left time: 59.8860s
Epoch: 9 cost time: 5.863672494888306
Epoch: 9, Steps: 1063 | Train Loss: 0.2759266 Vali Loss: 0.1964863 Test Loss: 0.3451575
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.4159873
	speed: 0.0221s/iter; left time: 256.0331s
	iters: 200, epoch: 10 | loss: 0.2072293
	speed: 0.0054s/iter; left time: 61.6293s
	iters: 300, epoch: 10 | loss: 0.1512804
	speed: 0.0059s/iter; left time: 67.3902s
	iters: 400, epoch: 10 | loss: 0.3489115
	speed: 0.0058s/iter; left time: 65.0787s
	iters: 500, epoch: 10 | loss: 0.2768954
	speed: 0.0057s/iter; left time: 64.3652s
	iters: 600, epoch: 10 | loss: 0.4034486
	speed: 0.0056s/iter; left time: 62.2650s
	iters: 700, epoch: 10 | loss: 0.3051411
	speed: 0.0053s/iter; left time: 57.7518s
	iters: 800, epoch: 10 | loss: 0.2128136
	speed: 0.0050s/iter; left time: 54.4751s
	iters: 900, epoch: 10 | loss: 0.1860635
	speed: 0.0058s/iter; left time: 62.5203s
	iters: 1000, epoch: 10 | loss: 0.3004650
	speed: 0.0054s/iter; left time: 57.6407s
Epoch: 10 cost time: 5.812328100204468
Epoch: 10, Steps: 1063 | Train Loss: 0.2750456 Vali Loss: 0.1922229 Test Loss: 0.3254704
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.2553500
	speed: 0.0228s/iter; left time: 240.4856s
	iters: 200, epoch: 11 | loss: 0.1480815
	speed: 0.0056s/iter; left time: 58.2358s
	iters: 300, epoch: 11 | loss: 0.6535474
	speed: 0.0054s/iter; left time: 56.0195s
	iters: 400, epoch: 11 | loss: 0.2056058
	speed: 0.0062s/iter; left time: 63.4322s
	iters: 500, epoch: 11 | loss: 0.1987979
	speed: 0.0063s/iter; left time: 63.3244s
	iters: 600, epoch: 11 | loss: 0.1790250
	speed: 0.0066s/iter; left time: 66.1041s
	iters: 700, epoch: 11 | loss: 0.1885526
	speed: 0.0062s/iter; left time: 61.8306s
	iters: 800, epoch: 11 | loss: 0.2178676
	speed: 0.0061s/iter; left time: 59.8921s
	iters: 900, epoch: 11 | loss: 0.1649794
	speed: 0.0049s/iter; left time: 47.7726s
	iters: 1000, epoch: 11 | loss: 0.1529891
	speed: 0.0045s/iter; left time: 43.1628s
Epoch: 11 cost time: 5.915512561798096
Epoch: 11, Steps: 1063 | Train Loss: 0.2746342 Vali Loss: 0.2029508 Test Loss: 0.3598191
EarlyStopping counter: 4 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.2979991
	speed: 0.0189s/iter; left time: 179.3637s
	iters: 200, epoch: 12 | loss: 0.2131606
	speed: 0.0046s/iter; left time: 42.7954s
	iters: 300, epoch: 12 | loss: 0.4312526
	speed: 0.0064s/iter; left time: 59.1607s
	iters: 400, epoch: 12 | loss: 0.2834474
	speed: 0.0049s/iter; left time: 45.1981s
	iters: 500, epoch: 12 | loss: 0.1667252
	speed: 0.0051s/iter; left time: 46.2681s
	iters: 600, epoch: 12 | loss: 0.2816974
	speed: 0.0052s/iter; left time: 46.3498s
	iters: 700, epoch: 12 | loss: 0.2079183
	speed: 0.0052s/iter; left time: 45.6929s
	iters: 800, epoch: 12 | loss: 0.4678023
	speed: 0.0051s/iter; left time: 44.6291s
	iters: 900, epoch: 12 | loss: 0.3006709
	speed: 0.0050s/iter; left time: 43.0096s
	iters: 1000, epoch: 12 | loss: 0.2521834
	speed: 0.0049s/iter; left time: 42.3284s
Epoch: 12 cost time: 5.396860122680664
Epoch: 12, Steps: 1063 | Train Loss: 0.2743006 Vali Loss: 0.1909382 Test Loss: 0.3237818
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTm2_336_192_Linear_ETTm2_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15227<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
mse:0.3183189332485199, mae:0.36275655031204224
