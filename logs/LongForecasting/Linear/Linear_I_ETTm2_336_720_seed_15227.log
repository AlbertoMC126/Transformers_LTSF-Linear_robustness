Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='Linear', model_id='ETTm2_336_720', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=720, root_path='./dataset/', save_pred_values=False, seed=15227, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTm2_336_720_Linear_ETTm2_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15227>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33505
val 10801
test 10801
	iters: 100, epoch: 1 | loss: 0.6638820
	speed: 0.0176s/iter; left time: 366.8851s
	iters: 200, epoch: 1 | loss: 0.5197858
	speed: 0.0180s/iter; left time: 372.8943s
	iters: 300, epoch: 1 | loss: 0.8543628
	speed: 0.0198s/iter; left time: 408.7132s
	iters: 400, epoch: 1 | loss: 0.4234283
	speed: 0.0188s/iter; left time: 386.2516s
	iters: 500, epoch: 1 | loss: 0.4533664
	speed: 0.0193s/iter; left time: 393.9957s
	iters: 600, epoch: 1 | loss: 0.7694004
	speed: 0.0156s/iter; left time: 316.7700s
	iters: 700, epoch: 1 | loss: 1.1093112
	speed: 0.0174s/iter; left time: 352.7767s
	iters: 800, epoch: 1 | loss: 1.7148156
	speed: 0.0150s/iter; left time: 302.8527s
	iters: 900, epoch: 1 | loss: 0.6232388
	speed: 0.0180s/iter; left time: 361.1284s
	iters: 1000, epoch: 1 | loss: 0.6599079
	speed: 0.0208s/iter; left time: 415.1722s
Epoch: 1 cost time: 19.05127763748169
Epoch: 1, Steps: 1047 | Train Loss: 0.7316792 Vali Loss: 0.4350051 Test Loss: 0.8504500
Validation loss decreased (inf --> 0.435005).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.3531319
	speed: 0.0671s/iter; left time: 1328.1456s
	iters: 200, epoch: 2 | loss: 0.9381071
	speed: 0.0187s/iter; left time: 369.0433s
	iters: 300, epoch: 2 | loss: 0.4946342
	speed: 0.0208s/iter; left time: 407.1812s
	iters: 400, epoch: 2 | loss: 0.4635102
	speed: 0.0184s/iter; left time: 359.1848s
	iters: 500, epoch: 2 | loss: 0.6859353
	speed: 0.0168s/iter; left time: 325.1608s
	iters: 600, epoch: 2 | loss: 0.5902148
	speed: 0.0179s/iter; left time: 346.2115s
	iters: 700, epoch: 2 | loss: 0.6166646
	speed: 0.0188s/iter; left time: 360.4821s
	iters: 800, epoch: 2 | loss: 0.6204393
	speed: 0.0161s/iter; left time: 306.6339s
	iters: 900, epoch: 2 | loss: 0.7575791
	speed: 0.0170s/iter; left time: 323.2578s
	iters: 1000, epoch: 2 | loss: 0.8814815
	speed: 0.0190s/iter; left time: 359.4482s
Epoch: 2 cost time: 18.917574405670166
Epoch: 2, Steps: 1047 | Train Loss: 0.7187327 Vali Loss: 0.6799934 Test Loss: 1.1433911
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.5416713
	speed: 0.0640s/iter; left time: 1199.7733s
	iters: 200, epoch: 3 | loss: 0.3531038
	speed: 0.0176s/iter; left time: 328.6334s
	iters: 300, epoch: 3 | loss: 0.4923405
	speed: 0.0182s/iter; left time: 338.2997s
	iters: 400, epoch: 3 | loss: 0.5664118
	speed: 0.0195s/iter; left time: 358.7966s
	iters: 500, epoch: 3 | loss: 0.4469820
	speed: 0.0205s/iter; left time: 376.8655s
	iters: 600, epoch: 3 | loss: 0.4837290
	speed: 0.0186s/iter; left time: 339.9127s
	iters: 700, epoch: 3 | loss: 0.4795155
	speed: 0.0189s/iter; left time: 343.3392s
	iters: 800, epoch: 3 | loss: 0.9857970
	speed: 0.0203s/iter; left time: 366.9663s
	iters: 900, epoch: 3 | loss: 0.4209105
	speed: 0.0210s/iter; left time: 376.8907s
	iters: 1000, epoch: 3 | loss: 0.4368413
	speed: 0.0165s/iter; left time: 293.8048s
Epoch: 3 cost time: 19.60216736793518
Epoch: 3, Steps: 1047 | Train Loss: 0.5467696 Vali Loss: 0.4271396 Test Loss: 0.7910194
Validation loss decreased (0.435005 --> 0.427140).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.4507360
	speed: 0.0570s/iter; left time: 1008.5206s
	iters: 200, epoch: 4 | loss: 0.5303935
	speed: 0.0147s/iter; left time: 258.5786s
	iters: 300, epoch: 4 | loss: 0.4423908
	speed: 0.0181s/iter; left time: 316.2275s
	iters: 400, epoch: 4 | loss: 0.3438360
	speed: 0.0190s/iter; left time: 330.2448s
	iters: 500, epoch: 4 | loss: 0.4922251
	speed: 0.0168s/iter; left time: 290.7488s
	iters: 600, epoch: 4 | loss: 0.3665820
	speed: 0.0196s/iter; left time: 337.9683s
	iters: 700, epoch: 4 | loss: 0.3067999
	speed: 0.0194s/iter; left time: 332.1513s
	iters: 800, epoch: 4 | loss: 0.3002344
	speed: 0.0206s/iter; left time: 349.8031s
	iters: 900, epoch: 4 | loss: 0.5937352
	speed: 0.0194s/iter; left time: 327.2036s
	iters: 1000, epoch: 4 | loss: 0.5627279
	speed: 0.0167s/iter; left time: 279.8905s
Epoch: 4 cost time: 18.888872623443604
Epoch: 4, Steps: 1047 | Train Loss: 0.4979677 Vali Loss: 0.3874699 Test Loss: 0.6623231
Validation loss decreased (0.427140 --> 0.387470).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.3803142
	speed: 0.0618s/iter; left time: 1028.5079s
	iters: 200, epoch: 5 | loss: 0.6081207
	speed: 0.0182s/iter; left time: 300.9513s
	iters: 300, epoch: 5 | loss: 0.5770898
	speed: 0.0172s/iter; left time: 282.2924s
	iters: 400, epoch: 5 | loss: 0.4463599
	speed: 0.0198s/iter; left time: 324.2941s
	iters: 500, epoch: 5 | loss: 0.4412033
	speed: 0.0192s/iter; left time: 312.4614s
	iters: 600, epoch: 5 | loss: 0.5560617
	speed: 0.0191s/iter; left time: 308.3665s
	iters: 700, epoch: 5 | loss: 0.3542055
	speed: 0.0183s/iter; left time: 293.7288s
	iters: 800, epoch: 5 | loss: 0.4534829
	speed: 0.0203s/iter; left time: 323.6421s
	iters: 900, epoch: 5 | loss: 0.7608948
	speed: 0.0181s/iter; left time: 287.4942s
	iters: 1000, epoch: 5 | loss: 0.5839984
	speed: 0.0180s/iter; left time: 282.8034s
Epoch: 5 cost time: 19.32780385017395
Epoch: 5, Steps: 1047 | Train Loss: 0.4767766 Vali Loss: 0.5294845 Test Loss: 1.2824286
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.3683965
	speed: 0.0642s/iter; left time: 1001.4544s
	iters: 200, epoch: 6 | loss: 0.8740742
	speed: 0.0178s/iter; left time: 276.6217s
	iters: 300, epoch: 6 | loss: 0.4015618
	speed: 0.0192s/iter; left time: 296.0694s
	iters: 400, epoch: 6 | loss: 0.3597946
	speed: 0.0193s/iter; left time: 295.3019s
	iters: 500, epoch: 6 | loss: 0.6625918
	speed: 0.0195s/iter; left time: 295.9437s
	iters: 600, epoch: 6 | loss: 0.5738325
	speed: 0.0184s/iter; left time: 277.6008s
	iters: 700, epoch: 6 | loss: 0.3408884
	speed: 0.0190s/iter; left time: 284.6175s
	iters: 800, epoch: 6 | loss: 0.4133356
	speed: 0.0185s/iter; left time: 275.9279s
	iters: 900, epoch: 6 | loss: 0.4266333
	speed: 0.0181s/iter; left time: 267.7862s
	iters: 1000, epoch: 6 | loss: 0.7694063
	speed: 0.0180s/iter; left time: 264.3852s
Epoch: 6 cost time: 19.339090585708618
Epoch: 6, Steps: 1047 | Train Loss: 0.4654198 Vali Loss: 0.3962369 Test Loss: 0.7884057
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.2361870
	speed: 0.0599s/iter; left time: 872.4603s
	iters: 200, epoch: 7 | loss: 0.1931095
	speed: 0.0149s/iter; left time: 215.9396s
	iters: 300, epoch: 7 | loss: 0.2562222
	speed: 0.0178s/iter; left time: 254.9894s
	iters: 400, epoch: 7 | loss: 0.6519453
	speed: 0.0193s/iter; left time: 275.3346s
	iters: 500, epoch: 7 | loss: 0.4455312
	speed: 0.0167s/iter; left time: 236.4840s
	iters: 600, epoch: 7 | loss: 0.2732135
	speed: 0.0177s/iter; left time: 248.3671s
	iters: 700, epoch: 7 | loss: 0.8679572
	speed: 0.0173s/iter; left time: 241.1501s
	iters: 800, epoch: 7 | loss: 0.3067147
	speed: 0.0199s/iter; left time: 276.3483s
	iters: 900, epoch: 7 | loss: 0.5059686
	speed: 0.0189s/iter; left time: 260.3285s
	iters: 1000, epoch: 7 | loss: 0.5032761
	speed: 0.0198s/iter; left time: 269.9292s
Epoch: 7 cost time: 18.656224012374878
Epoch: 7, Steps: 1047 | Train Loss: 0.4573099 Vali Loss: 0.4421841 Test Loss: 0.9076654
EarlyStopping counter: 3 out of 5
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.3293457
	speed: 0.0594s/iter; left time: 802.8213s
	iters: 200, epoch: 8 | loss: 0.5229864
	speed: 0.0165s/iter; left time: 221.4419s
	iters: 300, epoch: 8 | loss: 0.2257773
	speed: 0.0149s/iter; left time: 198.6758s
	iters: 400, epoch: 8 | loss: 0.3602573
	speed: 0.0190s/iter; left time: 250.7348s
	iters: 500, epoch: 8 | loss: 0.5155250
	speed: 0.0189s/iter; left time: 248.0169s
	iters: 600, epoch: 8 | loss: 0.4171630
	speed: 0.0185s/iter; left time: 240.8796s
	iters: 700, epoch: 8 | loss: 0.5856184
	speed: 0.0186s/iter; left time: 240.3002s
	iters: 800, epoch: 8 | loss: 0.3830777
	speed: 0.0174s/iter; left time: 223.2573s
	iters: 900, epoch: 8 | loss: 0.2829032
	speed: 0.0155s/iter; left time: 197.5661s
	iters: 1000, epoch: 8 | loss: 0.5248908
	speed: 0.0176s/iter; left time: 221.9302s
Epoch: 8 cost time: 17.95500159263611
Epoch: 8, Steps: 1047 | Train Loss: 0.4533608 Vali Loss: 0.3994926 Test Loss: 0.8026607
EarlyStopping counter: 4 out of 5
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.4486685
	speed: 0.0654s/iter; left time: 814.9795s
	iters: 200, epoch: 9 | loss: 0.3679368
	speed: 0.0161s/iter; left time: 198.9969s
	iters: 300, epoch: 9 | loss: 0.4922416
	speed: 0.0169s/iter; left time: 207.4996s
	iters: 400, epoch: 9 | loss: 0.2738804
	speed: 0.0171s/iter; left time: 207.9367s
	iters: 500, epoch: 9 | loss: 0.6234415
	speed: 0.0184s/iter; left time: 222.3718s
	iters: 600, epoch: 9 | loss: 0.3655040
	speed: 0.0189s/iter; left time: 226.5726s
	iters: 700, epoch: 9 | loss: 0.2820418
	speed: 0.0176s/iter; left time: 209.4037s
	iters: 800, epoch: 9 | loss: 0.4946601
	speed: 0.0217s/iter; left time: 254.7273s
	iters: 900, epoch: 9 | loss: 0.2988837
	speed: 0.0208s/iter; left time: 242.9345s
	iters: 1000, epoch: 9 | loss: 0.3981299
	speed: 0.0196s/iter; left time: 226.1937s
Epoch: 9 cost time: 19.15881657600403
Epoch: 9, Steps: 1047 | Train Loss: 0.4514537 Vali Loss: 0.4185576 Test Loss: 0.8536180
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTm2_336_720_Linear_ETTm2_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15227<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10801
mse:0.662510871887207, mae:0.5371931195259094
