Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTh2', data_path='ETTh2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.05, loss='mse', lradj='type1', model='Linear', model_id='ETTh2_336_192', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=192, root_path='./dataset/', save_pred_values=False, seed=12890, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTh2_336_192_Linear_ETTh2_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed12890>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8113
val 2689
test 2689
	iters: 100, epoch: 1 | loss: 3.4247985
	speed: 0.0043s/iter; left time: 42.8752s
	iters: 200, epoch: 1 | loss: 1.5158266
	speed: 0.0044s/iter; left time: 43.5635s
	iters: 300, epoch: 1 | loss: 6.1014929
	speed: 0.0042s/iter; left time: 41.6276s
	iters: 400, epoch: 1 | loss: 8.0550756
	speed: 0.0041s/iter; left time: 39.9759s
	iters: 500, epoch: 1 | loss: 4.1707454
	speed: 0.0043s/iter; left time: 41.8421s
Epoch: 1 cost time: 2.1646132469177246
Epoch: 1, Steps: 507 | Train Loss: 7.4388820 Vali Loss: 16.7785187 Test Loss: 30.9384365
Validation loss decreased (inf --> 16.778519).  Saving model ...
Updating learning rate to 0.05
	iters: 100, epoch: 2 | loss: 75.8715439
	speed: 0.0089s/iter; left time: 84.4002s
	iters: 200, epoch: 2 | loss: 2.2639136
	speed: 0.0044s/iter; left time: 41.4153s
	iters: 300, epoch: 2 | loss: 8.5421762
	speed: 0.0043s/iter; left time: 40.5293s
	iters: 400, epoch: 2 | loss: 6.7603817
	speed: 0.0044s/iter; left time: 40.4287s
	iters: 500, epoch: 2 | loss: 2.1699359
	speed: 0.0043s/iter; left time: 39.3848s
Epoch: 2 cost time: 2.196483850479126
Epoch: 2, Steps: 507 | Train Loss: 7.8218271 Vali Loss: 1.7925009 Test Loss: 4.5184102
Validation loss decreased (16.778519 --> 1.792501).  Saving model ...
Updating learning rate to 0.025
	iters: 100, epoch: 3 | loss: 0.7222554
	speed: 0.0071s/iter; left time: 64.4573s
	iters: 200, epoch: 3 | loss: 0.9135619
	speed: 0.0043s/iter; left time: 38.3158s
	iters: 300, epoch: 3 | loss: 0.7321181
	speed: 0.0041s/iter; left time: 35.9263s
	iters: 400, epoch: 3 | loss: 1.1785418
	speed: 0.0031s/iter; left time: 27.1596s
	iters: 500, epoch: 3 | loss: 0.5263710
	speed: 0.0036s/iter; left time: 31.0604s
Epoch: 3 cost time: 1.8895232677459717
Epoch: 3, Steps: 507 | Train Loss: 1.0162436 Vali Loss: 0.8062684 Test Loss: 1.4575838
Validation loss decreased (1.792501 --> 0.806268).  Saving model ...
Updating learning rate to 0.0125
	iters: 100, epoch: 4 | loss: 0.8312404
	speed: 0.0072s/iter; left time: 61.7146s
	iters: 200, epoch: 4 | loss: 0.4050887
	speed: 0.0037s/iter; left time: 30.9015s
	iters: 300, epoch: 4 | loss: 0.9481378
	speed: 0.0044s/iter; left time: 36.4282s
	iters: 400, epoch: 4 | loss: 0.3082957
	speed: 0.0045s/iter; left time: 36.9251s
	iters: 500, epoch: 4 | loss: 1.0613699
	speed: 0.0043s/iter; left time: 35.3218s
Epoch: 4 cost time: 2.0923969745635986
Epoch: 4, Steps: 507 | Train Loss: 0.6320044 Vali Loss: 0.5862178 Test Loss: 1.1825043
Validation loss decreased (0.806268 --> 0.586218).  Saving model ...
Updating learning rate to 0.00625
	iters: 100, epoch: 5 | loss: 0.5902686
	speed: 0.0085s/iter; left time: 68.2334s
	iters: 200, epoch: 5 | loss: 0.8493344
	speed: 0.0039s/iter; left time: 31.2030s
	iters: 300, epoch: 5 | loss: 0.3784093
	speed: 0.0038s/iter; left time: 29.8507s
	iters: 400, epoch: 5 | loss: 0.3594662
	speed: 0.0037s/iter; left time: 28.6924s
	iters: 500, epoch: 5 | loss: 0.7452903
	speed: 0.0037s/iter; left time: 27.9536s
Epoch: 5 cost time: 1.9365746974945068
Epoch: 5, Steps: 507 | Train Loss: 0.5314326 Vali Loss: 0.4573611 Test Loss: 0.6986468
Validation loss decreased (0.586218 --> 0.457361).  Saving model ...
Updating learning rate to 0.003125
	iters: 100, epoch: 6 | loss: 0.2494572
	speed: 0.0074s/iter; left time: 55.1831s
	iters: 200, epoch: 6 | loss: 0.3356383
	speed: 0.0037s/iter; left time: 27.5000s
	iters: 300, epoch: 6 | loss: 1.0319548
	speed: 0.0043s/iter; left time: 31.3428s
	iters: 400, epoch: 6 | loss: 0.8954375
	speed: 0.0043s/iter; left time: 30.8656s
	iters: 500, epoch: 6 | loss: 0.6472251
	speed: 0.0043s/iter; left time: 30.2717s
Epoch: 6 cost time: 2.022843837738037
Epoch: 6, Steps: 507 | Train Loss: 0.4928211 Vali Loss: 0.3826614 Test Loss: 0.5355747
Validation loss decreased (0.457361 --> 0.382661).  Saving model ...
Updating learning rate to 0.0015625
	iters: 100, epoch: 7 | loss: 0.3336997
	speed: 0.0085s/iter; left time: 59.3003s
	iters: 200, epoch: 7 | loss: 0.4239473
	speed: 0.0036s/iter; left time: 24.9052s
	iters: 300, epoch: 7 | loss: 0.3632726
	speed: 0.0036s/iter; left time: 24.7659s
	iters: 400, epoch: 7 | loss: 0.8650771
	speed: 0.0036s/iter; left time: 24.3173s
	iters: 500, epoch: 7 | loss: 0.2340080
	speed: 0.0036s/iter; left time: 23.8926s
Epoch: 7 cost time: 1.8633148670196533
Epoch: 7, Steps: 507 | Train Loss: 0.4723036 Vali Loss: 0.4372219 Test Loss: 0.8284982
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00078125
	iters: 100, epoch: 8 | loss: 0.1944942
	speed: 0.0081s/iter; left time: 52.7925s
	iters: 200, epoch: 8 | loss: 0.7061968
	speed: 0.0041s/iter; left time: 26.4141s
	iters: 300, epoch: 8 | loss: 0.6767356
	speed: 0.0040s/iter; left time: 25.1296s
	iters: 400, epoch: 8 | loss: 0.5718638
	speed: 0.0045s/iter; left time: 27.8641s
	iters: 500, epoch: 8 | loss: 0.2733472
	speed: 0.0042s/iter; left time: 25.4826s
Epoch: 8 cost time: 2.1359212398529053
Epoch: 8, Steps: 507 | Train Loss: 0.4603293 Vali Loss: 0.3879275 Test Loss: 0.5661464
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.000390625
	iters: 100, epoch: 9 | loss: 0.2479606
	speed: 0.0088s/iter; left time: 52.7313s
	iters: 200, epoch: 9 | loss: 1.0125735
	speed: 0.0047s/iter; left time: 27.6595s
	iters: 300, epoch: 9 | loss: 0.6103143
	speed: 0.0044s/iter; left time: 25.4129s
	iters: 400, epoch: 9 | loss: 0.2431947
	speed: 0.0046s/iter; left time: 26.0941s
	iters: 500, epoch: 9 | loss: 0.5916824
	speed: 0.0047s/iter; left time: 26.2065s
Epoch: 9 cost time: 2.299741506576538
Epoch: 9, Steps: 507 | Train Loss: 0.4521121 Vali Loss: 0.4048748 Test Loss: 0.6104387
EarlyStopping counter: 3 out of 5
Updating learning rate to 0.0001953125
	iters: 100, epoch: 10 | loss: 0.2545377
	speed: 0.0093s/iter; left time: 51.1676s
	iters: 200, epoch: 10 | loss: 0.7692207
	speed: 0.0042s/iter; left time: 22.5446s
	iters: 300, epoch: 10 | loss: 0.2760897
	speed: 0.0042s/iter; left time: 22.1585s
	iters: 400, epoch: 10 | loss: 0.5235564
	speed: 0.0042s/iter; left time: 21.9143s
	iters: 500, epoch: 10 | loss: 0.3155267
	speed: 0.0046s/iter; left time: 23.5620s
Epoch: 10 cost time: 2.1802549362182617
Epoch: 10, Steps: 507 | Train Loss: 0.4490360 Vali Loss: 0.3862437 Test Loss: 0.5715206
EarlyStopping counter: 4 out of 5
Updating learning rate to 9.765625e-05
	iters: 100, epoch: 11 | loss: 0.5639073
	speed: 0.0097s/iter; left time: 48.1793s
	iters: 200, epoch: 11 | loss: 0.3297174
	speed: 0.0042s/iter; left time: 20.6666s
	iters: 300, epoch: 11 | loss: 0.7131729
	speed: 0.0043s/iter; left time: 20.6609s
	iters: 400, epoch: 11 | loss: 0.3945387
	speed: 0.0043s/iter; left time: 19.9919s
	iters: 500, epoch: 11 | loss: 0.2937482
	speed: 0.0044s/iter; left time: 20.0812s
Epoch: 11 cost time: 2.2196483612060547
Epoch: 11, Steps: 507 | Train Loss: 0.4462470 Vali Loss: 0.3876120 Test Loss: 0.5746772
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTh2_336_192_Linear_ETTh2_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed12890<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2689
mse:0.5359268188476562, mae:0.5096101760864258
