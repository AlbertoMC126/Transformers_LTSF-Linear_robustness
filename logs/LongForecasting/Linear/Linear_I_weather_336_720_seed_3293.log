Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='Linear', model_id='weather_336_720', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=720, root_path='./dataset/', save_pred_values=False, seed=3293, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : weather_336_720_Linear_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3293>>>>>>>>>>>>>>>>>>>>>>>>>>
train 35832
val 4551
test 9820
	iters: 100, epoch: 1 | loss: 0.6110961
	speed: 0.0470s/iter; left time: 2101.3063s
	iters: 200, epoch: 1 | loss: 0.5641956
	speed: 0.0490s/iter; left time: 2184.6181s
	iters: 300, epoch: 1 | loss: 1.8150402
	speed: 0.0493s/iter; left time: 2193.8287s
	iters: 400, epoch: 1 | loss: 0.8047947
	speed: 0.0515s/iter; left time: 2286.0170s
	iters: 500, epoch: 1 | loss: 2.0216925
	speed: 0.0529s/iter; left time: 2343.4676s
	iters: 600, epoch: 1 | loss: 1.3413962
	speed: 0.0529s/iter; left time: 2335.5106s
	iters: 700, epoch: 1 | loss: 0.7685326
	speed: 0.0480s/iter; left time: 2116.5094s
	iters: 800, epoch: 1 | loss: 0.8255103
	speed: 0.0494s/iter; left time: 2171.7975s
	iters: 900, epoch: 1 | loss: 0.5556445
	speed: 0.0507s/iter; left time: 2225.8256s
	iters: 1000, epoch: 1 | loss: 0.7196385
	speed: 0.0508s/iter; left time: 2225.7826s
	iters: 1100, epoch: 1 | loss: 0.6461499
	speed: 0.0466s/iter; left time: 2036.2751s
	iters: 1200, epoch: 1 | loss: 0.8081988
	speed: 0.0490s/iter; left time: 2134.0249s
	iters: 1300, epoch: 1 | loss: 2.9902964
	speed: 0.0481s/iter; left time: 2092.6613s
	iters: 1400, epoch: 1 | loss: 0.9686508
	speed: 0.0478s/iter; left time: 2072.3371s
	iters: 1500, epoch: 1 | loss: 1.1511101
	speed: 0.0516s/iter; left time: 2231.7859s
	iters: 1600, epoch: 1 | loss: 4.7086363
	speed: 0.0539s/iter; left time: 2326.5410s
	iters: 1700, epoch: 1 | loss: 0.6318762
	speed: 0.0516s/iter; left time: 2222.2604s
	iters: 1800, epoch: 1 | loss: 0.7983929
	speed: 0.0516s/iter; left time: 2217.5896s
	iters: 1900, epoch: 1 | loss: 0.8593866
	speed: 0.0497s/iter; left time: 2130.6404s
	iters: 2000, epoch: 1 | loss: 1.0609437
	speed: 0.0495s/iter; left time: 2117.2156s
	iters: 2100, epoch: 1 | loss: 1.0076890
	speed: 0.0459s/iter; left time: 1958.8667s
	iters: 2200, epoch: 1 | loss: 0.9026669
	speed: 0.0485s/iter; left time: 2063.8349s
Epoch: 1 cost time: 111.24516177177429
Epoch: 1, Steps: 2239 | Train Loss: 1.5850219 Vali Loss: 0.7684361 Test Loss: 0.4033192
Validation loss decreased (inf --> 0.768436).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.7025515
	speed: 0.1377s/iter; left time: 5843.1035s
	iters: 200, epoch: 2 | loss: 0.5742903
	speed: 0.0481s/iter; left time: 2035.0793s
	iters: 300, epoch: 2 | loss: 0.5240340
	speed: 0.0477s/iter; left time: 2013.3288s
	iters: 400, epoch: 2 | loss: 1.0792170
	speed: 0.0504s/iter; left time: 2122.1036s
	iters: 500, epoch: 2 | loss: 0.6138801
	speed: 0.0516s/iter; left time: 2169.0255s
	iters: 600, epoch: 2 | loss: 2.3662839
	speed: 0.0477s/iter; left time: 2002.3070s
	iters: 700, epoch: 2 | loss: 0.5464010
	speed: 0.0503s/iter; left time: 2104.9394s
	iters: 800, epoch: 2 | loss: 0.8094446
	speed: 0.0494s/iter; left time: 2061.4572s
	iters: 900, epoch: 2 | loss: 0.6916116
	speed: 0.0496s/iter; left time: 2067.3468s
	iters: 1000, epoch: 2 | loss: 0.6537559
	speed: 0.0499s/iter; left time: 2073.8325s
	iters: 1100, epoch: 2 | loss: 0.5796098
	speed: 0.0506s/iter; left time: 2096.3237s
	iters: 1200, epoch: 2 | loss: 0.5604775
	speed: 0.0489s/iter; left time: 2019.6378s
	iters: 1300, epoch: 2 | loss: 0.6612719
	speed: 0.0513s/iter; left time: 2116.7474s
	iters: 1400, epoch: 2 | loss: 0.9428136
	speed: 0.0471s/iter; left time: 1939.6878s
	iters: 1500, epoch: 2 | loss: 2.1191852
	speed: 0.0529s/iter; left time: 2172.1569s
	iters: 1600, epoch: 2 | loss: 4.9459772
	speed: 0.0539s/iter; left time: 2205.0763s
	iters: 1700, epoch: 2 | loss: 0.9529518
	speed: 0.0513s/iter; left time: 2095.4167s
	iters: 1800, epoch: 2 | loss: 1.0740340
	speed: 0.0502s/iter; left time: 2043.2538s
	iters: 1900, epoch: 2 | loss: 0.8838654
	speed: 0.0491s/iter; left time: 1995.8925s
	iters: 2000, epoch: 2 | loss: 0.6596785
	speed: 0.0538s/iter; left time: 2180.8131s
	iters: 2100, epoch: 2 | loss: 0.8793167
	speed: 0.0487s/iter; left time: 1971.0892s
	iters: 2200, epoch: 2 | loss: 0.5617806
	speed: 0.0499s/iter; left time: 2014.4743s
Epoch: 2 cost time: 111.24967384338379
Epoch: 2, Steps: 2239 | Train Loss: 1.2527251 Vali Loss: 0.7278002 Test Loss: 0.3759136
Validation loss decreased (0.768436 --> 0.727800).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.5950192
	speed: 0.1444s/iter; left time: 5805.8977s
	iters: 200, epoch: 3 | loss: 1.1465373
	speed: 0.0499s/iter; left time: 2000.7357s
	iters: 300, epoch: 3 | loss: 0.5922226
	speed: 0.0527s/iter; left time: 2107.3476s
	iters: 400, epoch: 3 | loss: 0.8678209
	speed: 0.0500s/iter; left time: 1994.2089s
	iters: 500, epoch: 3 | loss: 0.7034446
	speed: 0.0509s/iter; left time: 2024.4754s
	iters: 600, epoch: 3 | loss: 0.7897306
	speed: 0.0488s/iter; left time: 1936.7800s
	iters: 700, epoch: 3 | loss: 0.5437461
	speed: 0.0491s/iter; left time: 1945.5960s
	iters: 800, epoch: 3 | loss: 1.5463960
	speed: 0.0485s/iter; left time: 1915.4737s
	iters: 900, epoch: 3 | loss: 0.8003782
	speed: 0.0476s/iter; left time: 1876.3705s
	iters: 1000, epoch: 3 | loss: 0.6347061
	speed: 0.0473s/iter; left time: 1859.4213s
	iters: 1100, epoch: 3 | loss: 0.5208892
	speed: 0.0524s/iter; left time: 2055.3055s
	iters: 1200, epoch: 3 | loss: 0.5114983
	speed: 0.0505s/iter; left time: 1974.1513s
	iters: 1300, epoch: 3 | loss: 1.4928823
	speed: 0.0475s/iter; left time: 1854.2444s
	iters: 1400, epoch: 3 | loss: 0.6294068
	speed: 0.0469s/iter; left time: 1824.5584s
	iters: 1500, epoch: 3 | loss: 0.5855744
	speed: 0.0483s/iter; left time: 1873.1546s
	iters: 1600, epoch: 3 | loss: 0.5966194
	speed: 0.0502s/iter; left time: 1942.4317s
	iters: 1700, epoch: 3 | loss: 0.9499676
	speed: 0.0553s/iter; left time: 2134.2757s
	iters: 1800, epoch: 3 | loss: 0.5021217
	speed: 0.0478s/iter; left time: 1839.8046s
	iters: 1900, epoch: 3 | loss: 0.4697245
	speed: 0.0471s/iter; left time: 1807.0770s
	iters: 2000, epoch: 3 | loss: 0.5908956
	speed: 0.0496s/iter; left time: 1901.7061s
	iters: 2100, epoch: 3 | loss: 0.5601195
	speed: 0.0486s/iter; left time: 1858.2848s
	iters: 2200, epoch: 3 | loss: 0.4293239
	speed: 0.0485s/iter; left time: 1849.5575s
Epoch: 3 cost time: 109.9618034362793
Epoch: 3, Steps: 2239 | Train Loss: 0.8941469 Vali Loss: 0.6510857 Test Loss: 0.3480802
Validation loss decreased (0.727800 --> 0.651086).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.7760569
	speed: 0.1365s/iter; left time: 5183.2931s
	iters: 200, epoch: 4 | loss: 0.7617484
	speed: 0.0514s/iter; left time: 1944.4341s
	iters: 300, epoch: 4 | loss: 0.6505997
	speed: 0.0524s/iter; left time: 1980.5547s
	iters: 400, epoch: 4 | loss: 0.9045764
	speed: 0.0560s/iter; left time: 2110.5760s
	iters: 500, epoch: 4 | loss: 0.5591130
	speed: 0.0519s/iter; left time: 1948.8122s
	iters: 600, epoch: 4 | loss: 0.6997446
	speed: 0.0527s/iter; left time: 1976.1154s
	iters: 700, epoch: 4 | loss: 0.7062331
	speed: 0.0462s/iter; left time: 1725.4239s
	iters: 800, epoch: 4 | loss: 0.4128051
	speed: 0.0494s/iter; left time: 1839.5719s
	iters: 900, epoch: 4 | loss: 0.7545121
	speed: 0.0485s/iter; left time: 1802.8245s
	iters: 1000, epoch: 4 | loss: 0.8402867
	speed: 0.0484s/iter; left time: 1793.4806s
	iters: 1100, epoch: 4 | loss: 0.4821362
	speed: 0.0556s/iter; left time: 2055.2737s
	iters: 1200, epoch: 4 | loss: 0.4577110
	speed: 0.0534s/iter; left time: 1969.5625s
	iters: 1300, epoch: 4 | loss: 0.5556497
	speed: 0.0492s/iter; left time: 1809.7159s
	iters: 1400, epoch: 4 | loss: 0.4811529
	speed: 0.0516s/iter; left time: 1893.5582s
	iters: 1500, epoch: 4 | loss: 0.5132254
	speed: 0.0484s/iter; left time: 1768.0325s
	iters: 1600, epoch: 4 | loss: 0.6860009
	speed: 0.0492s/iter; left time: 1794.5257s
	iters: 1700, epoch: 4 | loss: 1.6791021
	speed: 0.0499s/iter; left time: 1815.5202s
	iters: 1800, epoch: 4 | loss: 0.8127926
	speed: 0.0518s/iter; left time: 1878.4030s
	iters: 1900, epoch: 4 | loss: 0.4776547
	speed: 0.0466s/iter; left time: 1686.7547s
	iters: 2000, epoch: 4 | loss: 0.9872769
	speed: 0.0494s/iter; left time: 1782.6740s
	iters: 2100, epoch: 4 | loss: 0.4550596
	speed: 0.0514s/iter; left time: 1846.9393s
	iters: 2200, epoch: 4 | loss: 0.5056838
	speed: 0.0474s/iter; left time: 1698.5871s
Epoch: 4 cost time: 111.90656542778015
Epoch: 4, Steps: 2239 | Train Loss: 0.7309912 Vali Loss: 0.6230019 Test Loss: 0.3275315
Validation loss decreased (0.651086 --> 0.623002).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.5682334
	speed: 0.1434s/iter; left time: 5121.5133s
	iters: 200, epoch: 5 | loss: 0.4386806
	speed: 0.0485s/iter; left time: 1726.7080s
	iters: 300, epoch: 5 | loss: 0.5417869
	speed: 0.0498s/iter; left time: 1767.9068s
	iters: 400, epoch: 5 | loss: 0.6852246
	speed: 0.0484s/iter; left time: 1714.3040s
	iters: 500, epoch: 5 | loss: 0.7024381
	speed: 0.0482s/iter; left time: 1701.8420s
	iters: 600, epoch: 5 | loss: 0.4814913
	speed: 0.0494s/iter; left time: 1740.4814s
	iters: 700, epoch: 5 | loss: 0.6316883
	speed: 0.0483s/iter; left time: 1697.5199s
	iters: 800, epoch: 5 | loss: 0.6593187
	speed: 0.0518s/iter; left time: 1812.8584s
	iters: 900, epoch: 5 | loss: 0.9506242
	speed: 0.0481s/iter; left time: 1681.0527s
	iters: 1000, epoch: 5 | loss: 0.7214219
	speed: 0.0519s/iter; left time: 1808.6550s
	iters: 1100, epoch: 5 | loss: 0.5190962
	speed: 0.0524s/iter; left time: 1819.0346s
	iters: 1200, epoch: 5 | loss: 0.4390168
	speed: 0.0480s/iter; left time: 1662.2606s
	iters: 1300, epoch: 5 | loss: 0.4192425
	speed: 0.0476s/iter; left time: 1643.1790s
	iters: 1400, epoch: 5 | loss: 0.5461248
	speed: 0.0500s/iter; left time: 1721.9920s
	iters: 1500, epoch: 5 | loss: 0.5947775
	speed: 0.0496s/iter; left time: 1701.8492s
	iters: 1600, epoch: 5 | loss: 0.5185581
	speed: 0.0464s/iter; left time: 1588.7269s
	iters: 1700, epoch: 5 | loss: 0.4850499
	speed: 0.0467s/iter; left time: 1593.0680s
	iters: 1800, epoch: 5 | loss: 0.6275335
	speed: 0.0483s/iter; left time: 1643.9963s
	iters: 1900, epoch: 5 | loss: 0.6785700
	speed: 0.0486s/iter; left time: 1649.6975s
	iters: 2000, epoch: 5 | loss: 0.6320840
	speed: 0.0477s/iter; left time: 1614.1206s
	iters: 2100, epoch: 5 | loss: 0.3969042
	speed: 0.0526s/iter; left time: 1774.8964s
	iters: 2200, epoch: 5 | loss: 0.8002158
	speed: 0.0471s/iter; left time: 1584.4444s
Epoch: 5 cost time: 109.30263710021973
Epoch: 5, Steps: 2239 | Train Loss: 0.6799734 Vali Loss: 0.6064634 Test Loss: 0.3273938
Validation loss decreased (0.623002 --> 0.606463).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.7434786
	speed: 0.1520s/iter; left time: 5091.1805s
	iters: 200, epoch: 6 | loss: 0.5103635
	speed: 0.0452s/iter; left time: 1508.4902s
	iters: 300, epoch: 6 | loss: 0.6574211
	speed: 0.0534s/iter; left time: 1776.7424s
	iters: 400, epoch: 6 | loss: 0.5165614
	speed: 0.0531s/iter; left time: 1761.5476s
	iters: 500, epoch: 6 | loss: 0.4867444
	speed: 0.0512s/iter; left time: 1695.0802s
	iters: 600, epoch: 6 | loss: 0.5133228
	speed: 0.0503s/iter; left time: 1660.1692s
	iters: 700, epoch: 6 | loss: 0.4975798
	speed: 0.0560s/iter; left time: 1841.4475s
	iters: 800, epoch: 6 | loss: 0.4244470
	speed: 0.0594s/iter; left time: 1946.0041s
	iters: 900, epoch: 6 | loss: 0.4865372
	speed: 0.0541s/iter; left time: 1767.2652s
	iters: 1000, epoch: 6 | loss: 0.5240599
	speed: 0.0545s/iter; left time: 1775.4496s
	iters: 1100, epoch: 6 | loss: 0.9972942
	speed: 0.0514s/iter; left time: 1669.5600s
	iters: 1200, epoch: 6 | loss: 0.5086164
	speed: 0.0481s/iter; left time: 1557.3708s
	iters: 1300, epoch: 6 | loss: 0.4443903
	speed: 0.0479s/iter; left time: 1544.8964s
	iters: 1400, epoch: 6 | loss: 0.9676474
	speed: 0.0465s/iter; left time: 1496.4483s
	iters: 1500, epoch: 6 | loss: 0.4773846
	speed: 0.0474s/iter; left time: 1519.2783s
	iters: 1600, epoch: 6 | loss: 0.7343841
	speed: 0.0513s/iter; left time: 1640.3227s
	iters: 1700, epoch: 6 | loss: 0.5454893
	speed: 0.0532s/iter; left time: 1695.4931s
	iters: 1800, epoch: 6 | loss: 0.6817958
	speed: 0.0488s/iter; left time: 1549.6381s
	iters: 1900, epoch: 6 | loss: 0.9680819
	speed: 0.0522s/iter; left time: 1653.3240s
	iters: 2000, epoch: 6 | loss: 0.4563293
	speed: 0.0523s/iter; left time: 1652.5509s
	iters: 2100, epoch: 6 | loss: 0.4835633
	speed: 0.0458s/iter; left time: 1440.9921s
	iters: 2200, epoch: 6 | loss: 0.5803723
	speed: 0.0433s/iter; left time: 1359.4369s
Epoch: 6 cost time: 112.36491751670837
Epoch: 6, Steps: 2239 | Train Loss: 0.6587861 Vali Loss: 0.6017993 Test Loss: 0.3261753
Validation loss decreased (0.606463 --> 0.601799).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.4845883
	speed: 0.1469s/iter; left time: 4591.7081s
	iters: 200, epoch: 7 | loss: 0.3781357
	speed: 0.0439s/iter; left time: 1366.3009s
	iters: 300, epoch: 7 | loss: 0.5079424
	speed: 0.0499s/iter; left time: 1547.8061s
	iters: 400, epoch: 7 | loss: 0.4930587
	speed: 0.0515s/iter; left time: 1593.1776s
	iters: 500, epoch: 7 | loss: 0.7759776
	speed: 0.0509s/iter; left time: 1568.8389s
	iters: 600, epoch: 7 | loss: 0.5066444
	speed: 0.0491s/iter; left time: 1510.9417s
	iters: 700, epoch: 7 | loss: 0.4114611
	speed: 0.0506s/iter; left time: 1549.7559s
	iters: 800, epoch: 7 | loss: 0.4606465
	speed: 0.0473s/iter; left time: 1445.7686s
	iters: 900, epoch: 7 | loss: 0.6494297
	speed: 0.0528s/iter; left time: 1606.7552s
	iters: 1000, epoch: 7 | loss: 0.8548703
	speed: 0.0541s/iter; left time: 1642.9244s
	iters: 1100, epoch: 7 | loss: 0.4586138
	speed: 0.0521s/iter; left time: 1574.3915s
	iters: 1200, epoch: 7 | loss: 0.4960585
	speed: 0.0515s/iter; left time: 1552.6387s
	iters: 1300, epoch: 7 | loss: 0.6412136
	speed: 0.0517s/iter; left time: 1552.9721s
	iters: 1400, epoch: 7 | loss: 0.4316348
	speed: 0.0507s/iter; left time: 1518.0456s
	iters: 1500, epoch: 7 | loss: 0.7618030
	speed: 0.0486s/iter; left time: 1450.6726s
	iters: 1600, epoch: 7 | loss: 1.1380895
	speed: 0.0491s/iter; left time: 1461.1525s
	iters: 1700, epoch: 7 | loss: 0.3931979
	speed: 0.0482s/iter; left time: 1428.9959s
	iters: 1800, epoch: 7 | loss: 0.7162459
	speed: 0.0473s/iter; left time: 1397.6071s
	iters: 1900, epoch: 7 | loss: 0.4227352
	speed: 0.0484s/iter; left time: 1425.6470s
	iters: 2000, epoch: 7 | loss: 0.4903472
	speed: 0.0506s/iter; left time: 1484.3013s
	iters: 2100, epoch: 7 | loss: 0.7824119
	speed: 0.0497s/iter; left time: 1453.2492s
	iters: 2200, epoch: 7 | loss: 0.5407643
	speed: 0.0435s/iter; left time: 1267.2262s
Epoch: 7 cost time: 109.81733059883118
Epoch: 7, Steps: 2239 | Train Loss: 0.6483440 Vali Loss: 0.5976082 Test Loss: 0.3164301
Validation loss decreased (0.601799 --> 0.597608).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.4646203
	speed: 0.1410s/iter; left time: 4090.7758s
	iters: 200, epoch: 8 | loss: 0.4519643
	speed: 0.0517s/iter; left time: 1493.3632s
	iters: 300, epoch: 8 | loss: 1.0857283
	speed: 0.0539s/iter; left time: 1552.0024s
	iters: 400, epoch: 8 | loss: 0.4701321
	speed: 0.0500s/iter; left time: 1434.9292s
	iters: 500, epoch: 8 | loss: 0.6716468
	speed: 0.0481s/iter; left time: 1375.5474s
	iters: 600, epoch: 8 | loss: 0.5815756
	speed: 0.0513s/iter; left time: 1461.1582s
	iters: 700, epoch: 8 | loss: 0.6946473
	speed: 0.0495s/iter; left time: 1407.4871s
	iters: 800, epoch: 8 | loss: 0.5102990
	speed: 0.0524s/iter; left time: 1483.1450s
	iters: 900, epoch: 8 | loss: 0.3842522
	speed: 0.0459s/iter; left time: 1294.2071s
	iters: 1000, epoch: 8 | loss: 0.4005409
	speed: 0.0473s/iter; left time: 1330.8437s
	iters: 1100, epoch: 8 | loss: 0.7707547
	speed: 0.0501s/iter; left time: 1404.0439s
	iters: 1200, epoch: 8 | loss: 0.4262490
	speed: 0.0481s/iter; left time: 1341.2085s
	iters: 1300, epoch: 8 | loss: 0.6598896
	speed: 0.0500s/iter; left time: 1389.1434s
	iters: 1400, epoch: 8 | loss: 0.4300225
	speed: 0.0493s/iter; left time: 1365.6893s
	iters: 1500, epoch: 8 | loss: 0.4550850
	speed: 0.0497s/iter; left time: 1371.3054s
	iters: 1600, epoch: 8 | loss: 0.5090229
	speed: 0.0446s/iter; left time: 1228.1894s
	iters: 1700, epoch: 8 | loss: 0.6778103
	speed: 0.0468s/iter; left time: 1281.4710s
	iters: 1800, epoch: 8 | loss: 0.5081537
	speed: 0.0513s/iter; left time: 1401.1835s
	iters: 1900, epoch: 8 | loss: 0.5802011
	speed: 0.0468s/iter; left time: 1274.5416s
	iters: 2000, epoch: 8 | loss: 0.4978448
	speed: 0.0487s/iter; left time: 1319.4526s
	iters: 2100, epoch: 8 | loss: 0.9028698
	speed: 0.0508s/iter; left time: 1371.9391s
	iters: 2200, epoch: 8 | loss: 0.5726210
	speed: 0.0490s/iter; left time: 1317.3584s
Epoch: 8 cost time: 109.40266418457031
Epoch: 8, Steps: 2239 | Train Loss: 0.6434797 Vali Loss: 0.5903438 Test Loss: 0.3175410
Validation loss decreased (0.597608 --> 0.590344).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.6189508
	speed: 0.1536s/iter; left time: 4112.6983s
	iters: 200, epoch: 9 | loss: 0.6291634
	speed: 0.0431s/iter; left time: 1148.1754s
	iters: 300, epoch: 9 | loss: 0.5345734
	speed: 0.0474s/iter; left time: 1259.7148s
	iters: 400, epoch: 9 | loss: 0.4024214
	speed: 0.0512s/iter; left time: 1354.2919s
	iters: 500, epoch: 9 | loss: 0.4791765
	speed: 0.0517s/iter; left time: 1362.2882s
	iters: 600, epoch: 9 | loss: 0.5529327
	speed: 0.0449s/iter; left time: 1178.4416s
	iters: 700, epoch: 9 | loss: 0.3646137
	speed: 0.0456s/iter; left time: 1193.8911s
	iters: 800, epoch: 9 | loss: 0.6761417
	speed: 0.0457s/iter; left time: 1191.0942s
	iters: 900, epoch: 9 | loss: 0.4051748
	speed: 0.0474s/iter; left time: 1229.9801s
	iters: 1000, epoch: 9 | loss: 0.5874915
	speed: 0.0493s/iter; left time: 1275.9375s
	iters: 1100, epoch: 9 | loss: 0.6294038
	speed: 0.0497s/iter; left time: 1281.0048s
	iters: 1200, epoch: 9 | loss: 0.4975801
	speed: 0.0484s/iter; left time: 1243.0778s
	iters: 1300, epoch: 9 | loss: 0.6962928
	speed: 0.0492s/iter; left time: 1257.4926s
	iters: 1400, epoch: 9 | loss: 0.6598688
	speed: 0.0532s/iter; left time: 1353.7573s
	iters: 1500, epoch: 9 | loss: 0.3998863
	speed: 0.0472s/iter; left time: 1198.6729s
	iters: 1600, epoch: 9 | loss: 0.4425536
	speed: 0.0433s/iter; left time: 1093.7043s
	iters: 1700, epoch: 9 | loss: 0.9038683
	speed: 0.0514s/iter; left time: 1294.3498s
	iters: 1800, epoch: 9 | loss: 0.4746757
	speed: 0.0461s/iter; left time: 1155.1626s
	iters: 1900, epoch: 9 | loss: 0.7411329
	speed: 0.0504s/iter; left time: 1257.2236s
	iters: 2000, epoch: 9 | loss: 0.4708813
	speed: 0.0471s/iter; left time: 1172.3449s
	iters: 2100, epoch: 9 | loss: 0.5142514
	speed: 0.0465s/iter; left time: 1152.1878s
	iters: 2200, epoch: 9 | loss: 0.4885651
	speed: 0.0525s/iter; left time: 1294.5829s
Epoch: 9 cost time: 107.14449286460876
Epoch: 9, Steps: 2239 | Train Loss: 0.6407358 Vali Loss: 0.5977442 Test Loss: 0.3182291
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.7301522
	speed: 0.1567s/iter; left time: 3844.3720s
	iters: 200, epoch: 10 | loss: 0.4798301
	speed: 0.0421s/iter; left time: 1027.5760s
	iters: 300, epoch: 10 | loss: 0.6640000
	speed: 0.0460s/iter; left time: 1119.8214s
	iters: 400, epoch: 10 | loss: 1.2519702
	speed: 0.0433s/iter; left time: 1049.8207s
	iters: 500, epoch: 10 | loss: 0.9110713
	speed: 0.0468s/iter; left time: 1129.2214s
	iters: 600, epoch: 10 | loss: 0.7704743
	speed: 0.0476s/iter; left time: 1143.3833s
	iters: 700, epoch: 10 | loss: 0.9569201
	speed: 0.0484s/iter; left time: 1158.5935s
	iters: 800, epoch: 10 | loss: 0.4801843
	speed: 0.0482s/iter; left time: 1149.2091s
	iters: 900, epoch: 10 | loss: 0.3610288
	speed: 0.0496s/iter; left time: 1178.1822s
	iters: 1000, epoch: 10 | loss: 0.4361619
	speed: 0.0484s/iter; left time: 1144.2344s
	iters: 1100, epoch: 10 | loss: 3.8425696
	speed: 0.0481s/iter; left time: 1132.8385s
	iters: 1200, epoch: 10 | loss: 0.4945839
	speed: 0.0478s/iter; left time: 1119.7502s
	iters: 1300, epoch: 10 | loss: 0.4074661
	speed: 0.0476s/iter; left time: 1110.8184s
	iters: 1400, epoch: 10 | loss: 0.7072913
	speed: 0.0494s/iter; left time: 1147.3782s
	iters: 1500, epoch: 10 | loss: 0.6795347
	speed: 0.0510s/iter; left time: 1178.6877s
	iters: 1600, epoch: 10 | loss: 0.4305027
	speed: 0.0524s/iter; left time: 1207.4295s
	iters: 1700, epoch: 10 | loss: 0.4305226
	speed: 0.0564s/iter; left time: 1294.1927s
	iters: 1800, epoch: 10 | loss: 0.5651919
	speed: 0.0545s/iter; left time: 1244.0145s
	iters: 1900, epoch: 10 | loss: 0.4045036
	speed: 0.0480s/iter; left time: 1090.8180s
	iters: 2000, epoch: 10 | loss: 1.1513717
	speed: 0.0511s/iter; left time: 1156.0508s
	iters: 2100, epoch: 10 | loss: 0.6412308
	speed: 0.0512s/iter; left time: 1154.6369s
	iters: 2200, epoch: 10 | loss: 0.6090336
	speed: 0.0483s/iter; left time: 1082.7662s
Epoch: 10 cost time: 108.35852074623108
Epoch: 10, Steps: 2239 | Train Loss: 0.6395769 Vali Loss: 0.5939245 Test Loss: 0.3175609
EarlyStopping counter: 2 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.5832017
	speed: 0.1581s/iter; left time: 3524.6843s
	iters: 200, epoch: 11 | loss: 0.5221947
	speed: 0.0422s/iter; left time: 936.7901s
	iters: 300, epoch: 11 | loss: 0.5130612
	speed: 0.0438s/iter; left time: 966.8889s
	iters: 400, epoch: 11 | loss: 0.4364609
	speed: 0.0471s/iter; left time: 1036.7539s
	iters: 500, epoch: 11 | loss: 0.5037534
	speed: 0.0508s/iter; left time: 1111.4426s
	iters: 600, epoch: 11 | loss: 0.3569683
	speed: 0.0508s/iter; left time: 1107.8449s
	iters: 700, epoch: 11 | loss: 1.1359665
	speed: 0.0503s/iter; left time: 1090.8978s
	iters: 800, epoch: 11 | loss: 0.5683030
	speed: 0.0494s/iter; left time: 1066.4448s
	iters: 900, epoch: 11 | loss: 0.5013816
	speed: 0.0472s/iter; left time: 1013.6113s
	iters: 1000, epoch: 11 | loss: 0.4650247
	speed: 0.0484s/iter; left time: 1035.1231s
	iters: 1100, epoch: 11 | loss: 0.7600523
	speed: 0.0512s/iter; left time: 1089.9661s
	iters: 1200, epoch: 11 | loss: 0.5849003
	speed: 0.0531s/iter; left time: 1124.4364s
	iters: 1300, epoch: 11 | loss: 0.7989918
	speed: 0.0513s/iter; left time: 1080.9480s
	iters: 1400, epoch: 11 | loss: 0.5008651
	speed: 0.0468s/iter; left time: 981.3380s
	iters: 1500, epoch: 11 | loss: 0.5514479
	speed: 0.0488s/iter; left time: 1019.7414s
	iters: 1600, epoch: 11 | loss: 0.7677283
	speed: 0.0505s/iter; left time: 1050.0672s
	iters: 1700, epoch: 11 | loss: 0.3389525
	speed: 0.0484s/iter; left time: 1000.7530s
	iters: 1800, epoch: 11 | loss: 0.4972576
	speed: 0.0457s/iter; left time: 941.2284s
	iters: 1900, epoch: 11 | loss: 0.4841409
	speed: 0.0472s/iter; left time: 966.9946s
	iters: 2000, epoch: 11 | loss: 0.5164241
	speed: 0.0479s/iter; left time: 977.4952s
	iters: 2100, epoch: 11 | loss: 0.3929120
	speed: 0.0530s/iter; left time: 1075.1618s
	iters: 2200, epoch: 11 | loss: 0.3895397
	speed: 0.0483s/iter; left time: 975.2231s
Epoch: 11 cost time: 108.01418852806091
Epoch: 11, Steps: 2239 | Train Loss: 0.6389599 Vali Loss: 0.5914744 Test Loss: 0.3158913
EarlyStopping counter: 3 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.4675205
	speed: 0.1678s/iter; left time: 3365.6857s
	iters: 200, epoch: 12 | loss: 0.4412832
	speed: 0.0400s/iter; left time: 798.8085s
	iters: 300, epoch: 12 | loss: 0.7237412
	speed: 0.0415s/iter; left time: 824.2977s
	iters: 400, epoch: 12 | loss: 0.7494932
	speed: 0.0457s/iter; left time: 901.9846s
	iters: 500, epoch: 12 | loss: 0.7521287
	speed: 0.0496s/iter; left time: 975.2917s
	iters: 600, epoch: 12 | loss: 0.4081635
	speed: 0.0476s/iter; left time: 930.9020s
	iters: 700, epoch: 12 | loss: 0.7201301
	speed: 0.0432s/iter; left time: 840.9807s
	iters: 800, epoch: 12 | loss: 0.6516920
	speed: 0.0442s/iter; left time: 854.4388s
	iters: 900, epoch: 12 | loss: 0.6285039
	speed: 0.0444s/iter; left time: 854.8578s
	iters: 1000, epoch: 12 | loss: 0.6200545
	speed: 0.0466s/iter; left time: 892.7050s
	iters: 1100, epoch: 12 | loss: 0.4793989
	speed: 0.0427s/iter; left time: 813.8118s
	iters: 1200, epoch: 12 | loss: 0.7214909
	speed: 0.0423s/iter; left time: 801.5971s
	iters: 1300, epoch: 12 | loss: 0.4598783
	speed: 0.0424s/iter; left time: 799.2367s
	iters: 1400, epoch: 12 | loss: 0.8652391
	speed: 0.0422s/iter; left time: 791.4256s
	iters: 1500, epoch: 12 | loss: 0.5150941
	speed: 0.0427s/iter; left time: 796.3587s
	iters: 1600, epoch: 12 | loss: 0.4722747
	speed: 0.0419s/iter; left time: 777.5861s
	iters: 1700, epoch: 12 | loss: 0.3841663
	speed: 0.0400s/iter; left time: 738.5297s
	iters: 1800, epoch: 12 | loss: 0.4032495
	speed: 0.0394s/iter; left time: 722.5401s
	iters: 1900, epoch: 12 | loss: 0.7254237
	speed: 0.0412s/iter; left time: 751.7643s
	iters: 2000, epoch: 12 | loss: 0.7398259
	speed: 0.0425s/iter; left time: 771.8013s
	iters: 2100, epoch: 12 | loss: 0.7753767
	speed: 0.0431s/iter; left time: 778.0867s
	iters: 2200, epoch: 12 | loss: 0.4756142
	speed: 0.0410s/iter; left time: 735.2731s
Epoch: 12 cost time: 96.19453144073486
Epoch: 12, Steps: 2239 | Train Loss: 0.6385690 Vali Loss: 0.5918128 Test Loss: 0.3174669
EarlyStopping counter: 4 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.4630987
	speed: 0.1371s/iter; left time: 2442.5374s
	iters: 200, epoch: 13 | loss: 0.3635118
	speed: 0.0379s/iter; left time: 671.7012s
	iters: 300, epoch: 13 | loss: 0.4934050
	speed: 0.0400s/iter; left time: 704.2419s
	iters: 400, epoch: 13 | loss: 0.6646711
	speed: 0.0383s/iter; left time: 671.3732s
	iters: 500, epoch: 13 | loss: 0.3942916
	speed: 0.0401s/iter; left time: 698.4600s
	iters: 600, epoch: 13 | loss: 0.9810935
	speed: 0.0429s/iter; left time: 742.2784s
	iters: 700, epoch: 13 | loss: 0.4131527
	speed: 0.0409s/iter; left time: 703.8153s
	iters: 800, epoch: 13 | loss: 0.4170039
	speed: 0.0429s/iter; left time: 734.9429s
	iters: 900, epoch: 13 | loss: 0.4324479
	speed: 0.0445s/iter; left time: 756.6102s
	iters: 1000, epoch: 13 | loss: 0.9596730
	speed: 0.0448s/iter; left time: 758.2802s
	iters: 1100, epoch: 13 | loss: 0.4242933
	speed: 0.0431s/iter; left time: 724.1276s
	iters: 1200, epoch: 13 | loss: 0.7508937
	speed: 0.0416s/iter; left time: 695.4840s
	iters: 1300, epoch: 13 | loss: 0.4313285
	speed: 0.0443s/iter; left time: 735.6792s
	iters: 1400, epoch: 13 | loss: 0.6847257
	speed: 0.0445s/iter; left time: 735.5787s
	iters: 1500, epoch: 13 | loss: 0.5087644
	speed: 0.0396s/iter; left time: 650.4720s
	iters: 1600, epoch: 13 | loss: 0.7066556
	speed: 0.0424s/iter; left time: 691.9415s
	iters: 1700, epoch: 13 | loss: 0.7915543
	speed: 0.0428s/iter; left time: 693.2036s
	iters: 1800, epoch: 13 | loss: 0.5967819
	speed: 0.0424s/iter; left time: 682.8072s
	iters: 1900, epoch: 13 | loss: 0.4079894
	speed: 0.0433s/iter; left time: 692.7562s
	iters: 2000, epoch: 13 | loss: 0.4512395
	speed: 0.0452s/iter; left time: 718.5813s
	iters: 2100, epoch: 13 | loss: 0.6799375
	speed: 0.0446s/iter; left time: 704.9930s
	iters: 2200, epoch: 13 | loss: 0.4483754
	speed: 0.0430s/iter; left time: 675.4207s
Epoch: 13 cost time: 94.17469906806946
Epoch: 13, Steps: 2239 | Train Loss: 0.6383948 Vali Loss: 0.5924335 Test Loss: 0.3174436
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : weather_336_720_Linear_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3293<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9820
mse:0.3174801170825958, mae:0.36138978600502014
