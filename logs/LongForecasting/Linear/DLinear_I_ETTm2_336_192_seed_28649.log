Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='DLinear', model_id='ETTm2_336_192', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=192, root_path='./dataset/', save_pred_values=False, seed=28649, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTm2_336_192_DLinear_ETTm2_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed28649>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34033
val 11329
test 11329
	iters: 100, epoch: 1 | loss: 0.5620948
	speed: 0.0110s/iter; left time: 232.5360s
	iters: 200, epoch: 1 | loss: 0.3587721
	speed: 0.0110s/iter; left time: 232.1581s
	iters: 300, epoch: 1 | loss: 0.2749135
	speed: 0.0119s/iter; left time: 250.3459s
	iters: 400, epoch: 1 | loss: 0.6281940
	speed: 0.0115s/iter; left time: 239.2895s
	iters: 500, epoch: 1 | loss: 0.5030889
	speed: 0.0113s/iter; left time: 234.2080s
	iters: 600, epoch: 1 | loss: 0.5126057
	speed: 0.0102s/iter; left time: 210.4003s
	iters: 700, epoch: 1 | loss: 0.6300643
	speed: 0.0106s/iter; left time: 216.9415s
	iters: 800, epoch: 1 | loss: 0.7811325
	speed: 0.0116s/iter; left time: 236.8073s
	iters: 900, epoch: 1 | loss: 0.5750121
	speed: 0.0103s/iter; left time: 209.3834s
	iters: 1000, epoch: 1 | loss: 0.7474976
	speed: 0.0108s/iter; left time: 218.6461s
Epoch: 1 cost time: 11.727097272872925
Epoch: 1, Steps: 1063 | Train Loss: 0.5623515 Vali Loss: 0.4101446 Test Loss: 0.8618963
Validation loss decreased (inf --> 0.410145).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.9291564
	speed: 0.0465s/iter; left time: 935.5403s
	iters: 200, epoch: 2 | loss: 0.4972144
	speed: 0.0098s/iter; left time: 195.0592s
	iters: 300, epoch: 2 | loss: 0.5918699
	speed: 0.0105s/iter; left time: 208.1889s
	iters: 400, epoch: 2 | loss: 1.0233927
	speed: 0.0105s/iter; left time: 208.5016s
	iters: 500, epoch: 2 | loss: 0.3267160
	speed: 0.0110s/iter; left time: 216.3148s
	iters: 600, epoch: 2 | loss: 0.4173755
	speed: 0.0103s/iter; left time: 202.6713s
	iters: 700, epoch: 2 | loss: 0.8909307
	speed: 0.0108s/iter; left time: 211.0138s
	iters: 800, epoch: 2 | loss: 0.5603402
	speed: 0.0113s/iter; left time: 219.2139s
	iters: 900, epoch: 2 | loss: 0.3920256
	speed: 0.0104s/iter; left time: 199.7655s
	iters: 1000, epoch: 2 | loss: 0.5875746
	speed: 0.0106s/iter; left time: 204.1561s
Epoch: 2 cost time: 11.095123291015625
Epoch: 2, Steps: 1063 | Train Loss: 0.5623338 Vali Loss: 0.6474329 Test Loss: 1.0169251
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.2492422
	speed: 0.0488s/iter; left time: 928.9500s
	iters: 200, epoch: 3 | loss: 0.3434827
	speed: 0.0087s/iter; left time: 164.9479s
	iters: 300, epoch: 3 | loss: 0.2377206
	speed: 0.0106s/iter; left time: 199.3029s
	iters: 400, epoch: 3 | loss: 0.2280828
	speed: 0.0120s/iter; left time: 225.0579s
	iters: 500, epoch: 3 | loss: 0.4582201
	speed: 0.0121s/iter; left time: 225.8726s
	iters: 600, epoch: 3 | loss: 0.4342093
	speed: 0.0101s/iter; left time: 187.7974s
	iters: 700, epoch: 3 | loss: 0.4495410
	speed: 0.0099s/iter; left time: 182.1431s
	iters: 800, epoch: 3 | loss: 0.4892750
	speed: 0.0096s/iter; left time: 176.2122s
	iters: 900, epoch: 3 | loss: 0.3097314
	speed: 0.0102s/iter; left time: 185.8407s
	iters: 1000, epoch: 3 | loss: 0.3535308
	speed: 0.0105s/iter; left time: 190.9970s
Epoch: 3 cost time: 11.03445553779602
Epoch: 3, Steps: 1063 | Train Loss: 0.3680627 Vali Loss: 0.3257334 Test Loss: 0.6575432
Validation loss decreased (0.410145 --> 0.325733).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.4147688
	speed: 0.0452s/iter; left time: 812.4578s
	iters: 200, epoch: 4 | loss: 0.3005458
	speed: 0.0113s/iter; left time: 201.2988s
	iters: 300, epoch: 4 | loss: 0.2799969
	speed: 0.0108s/iter; left time: 191.3243s
	iters: 400, epoch: 4 | loss: 0.5380130
	speed: 0.0099s/iter; left time: 174.6976s
	iters: 500, epoch: 4 | loss: 0.2014288
	speed: 0.0108s/iter; left time: 188.9285s
	iters: 600, epoch: 4 | loss: 0.2607341
	speed: 0.0112s/iter; left time: 194.9869s
	iters: 700, epoch: 4 | loss: 0.4538593
	speed: 0.0107s/iter; left time: 186.2525s
	iters: 800, epoch: 4 | loss: 0.2249320
	speed: 0.0101s/iter; left time: 174.8070s
	iters: 900, epoch: 4 | loss: 0.1977281
	speed: 0.0107s/iter; left time: 184.2646s
	iters: 1000, epoch: 4 | loss: 0.5889977
	speed: 0.0119s/iter; left time: 202.3476s
Epoch: 4 cost time: 11.546491622924805
Epoch: 4, Steps: 1063 | Train Loss: 0.3224420 Vali Loss: 0.2495084 Test Loss: 0.4731840
Validation loss decreased (0.325733 --> 0.249508).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.2138430
	speed: 0.0419s/iter; left time: 708.4970s
	iters: 200, epoch: 5 | loss: 0.1525997
	speed: 0.0105s/iter; left time: 176.2041s
	iters: 300, epoch: 5 | loss: 0.3076827
	speed: 0.0100s/iter; left time: 166.6622s
	iters: 400, epoch: 5 | loss: 0.2262367
	speed: 0.0086s/iter; left time: 143.2045s
	iters: 500, epoch: 5 | loss: 0.3527076
	speed: 0.0087s/iter; left time: 144.4233s
	iters: 600, epoch: 5 | loss: 0.3180758
	speed: 0.0113s/iter; left time: 184.8237s
	iters: 700, epoch: 5 | loss: 0.3459723
	speed: 0.0109s/iter; left time: 177.4824s
	iters: 800, epoch: 5 | loss: 0.2795443
	speed: 0.0104s/iter; left time: 168.7985s
	iters: 900, epoch: 5 | loss: 0.2666191
	speed: 0.0116s/iter; left time: 186.8837s
	iters: 1000, epoch: 5 | loss: 0.2776683
	speed: 0.0113s/iter; left time: 181.1078s
Epoch: 5 cost time: 11.069432735443115
Epoch: 5, Steps: 1063 | Train Loss: 0.3003845 Vali Loss: 0.2144430 Test Loss: 0.3728029
Validation loss decreased (0.249508 --> 0.214443).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.1540640
	speed: 0.0500s/iter; left time: 792.5241s
	iters: 200, epoch: 6 | loss: 0.1654407
	speed: 0.0113s/iter; left time: 178.4093s
	iters: 300, epoch: 6 | loss: 0.1780450
	speed: 0.0110s/iter; left time: 171.4868s
	iters: 400, epoch: 6 | loss: 0.3019096
	speed: 0.0107s/iter; left time: 165.6107s
	iters: 500, epoch: 6 | loss: 0.3858081
	speed: 0.0105s/iter; left time: 161.7687s
	iters: 600, epoch: 6 | loss: 0.3807594
	speed: 0.0110s/iter; left time: 168.5334s
	iters: 700, epoch: 6 | loss: 0.2320430
	speed: 0.0104s/iter; left time: 158.1165s
	iters: 800, epoch: 6 | loss: 0.1772306
	speed: 0.0086s/iter; left time: 129.6845s
	iters: 900, epoch: 6 | loss: 0.2621717
	speed: 0.0108s/iter; left time: 162.6661s
	iters: 1000, epoch: 6 | loss: 0.2392139
	speed: 0.0112s/iter; left time: 167.2783s
Epoch: 6 cost time: 11.182891368865967
Epoch: 6, Steps: 1063 | Train Loss: 0.2884390 Vali Loss: 0.2274375 Test Loss: 0.4446382
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.1734583
	speed: 0.0451s/iter; left time: 666.2968s
	iters: 200, epoch: 7 | loss: 0.3313977
	speed: 0.0102s/iter; left time: 149.0784s
	iters: 300, epoch: 7 | loss: 0.1993066
	speed: 0.0116s/iter; left time: 169.4615s
	iters: 400, epoch: 7 | loss: 0.1761863
	speed: 0.0113s/iter; left time: 163.9861s
	iters: 500, epoch: 7 | loss: 0.2333875
	speed: 0.0112s/iter; left time: 160.9539s
	iters: 600, epoch: 7 | loss: 0.1907566
	speed: 0.0121s/iter; left time: 173.1291s
	iters: 700, epoch: 7 | loss: 0.2750772
	speed: 0.0109s/iter; left time: 155.0253s
	iters: 800, epoch: 7 | loss: 0.2250592
	speed: 0.0110s/iter; left time: 155.0955s
	iters: 900, epoch: 7 | loss: 0.4934961
	speed: 0.0108s/iter; left time: 151.2306s
	iters: 1000, epoch: 7 | loss: 0.1966434
	speed: 0.0109s/iter; left time: 151.2285s
Epoch: 7 cost time: 11.72731900215149
Epoch: 7, Steps: 1063 | Train Loss: 0.2814268 Vali Loss: 0.1765821 Test Loss: 0.2735659
Validation loss decreased (0.214443 --> 0.176582).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.2006682
	speed: 0.0500s/iter; left time: 685.6677s
	iters: 200, epoch: 8 | loss: 0.2711868
	speed: 0.0112s/iter; left time: 152.9963s
	iters: 300, epoch: 8 | loss: 0.2690406
	speed: 0.0120s/iter; left time: 162.6640s
	iters: 400, epoch: 8 | loss: 0.7371936
	speed: 0.0110s/iter; left time: 148.0747s
	iters: 500, epoch: 8 | loss: 0.2474176
	speed: 0.0097s/iter; left time: 128.8126s
	iters: 600, epoch: 8 | loss: 0.2007524
	speed: 0.0100s/iter; left time: 131.8198s
	iters: 700, epoch: 8 | loss: 0.2606682
	speed: 0.0105s/iter; left time: 137.1309s
	iters: 800, epoch: 8 | loss: 0.2213598
	speed: 0.0112s/iter; left time: 145.6977s
	iters: 900, epoch: 8 | loss: 0.2438920
	speed: 0.0121s/iter; left time: 156.7325s
	iters: 1000, epoch: 8 | loss: 0.1926785
	speed: 0.0117s/iter; left time: 150.5898s
Epoch: 8 cost time: 11.771421432495117
Epoch: 8, Steps: 1063 | Train Loss: 0.2780303 Vali Loss: 0.1970383 Test Loss: 0.3426979
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.2439057
	speed: 0.0476s/iter; left time: 602.5876s
	iters: 200, epoch: 9 | loss: 0.1600174
	speed: 0.0109s/iter; left time: 137.3786s
	iters: 300, epoch: 9 | loss: 0.1864961
	speed: 0.0107s/iter; left time: 133.0601s
	iters: 400, epoch: 9 | loss: 0.3415450
	speed: 0.0115s/iter; left time: 142.0088s
	iters: 500, epoch: 9 | loss: 0.1372448
	speed: 0.0111s/iter; left time: 135.4745s
	iters: 600, epoch: 9 | loss: 0.2710372
	speed: 0.0123s/iter; left time: 149.7998s
	iters: 700, epoch: 9 | loss: 0.2015145
	speed: 0.0113s/iter; left time: 135.7863s
	iters: 800, epoch: 9 | loss: 0.3058226
	speed: 0.0108s/iter; left time: 129.6178s
	iters: 900, epoch: 9 | loss: 0.2899411
	speed: 0.0111s/iter; left time: 131.5122s
	iters: 1000, epoch: 9 | loss: 0.2502763
	speed: 0.0117s/iter; left time: 137.3552s
Epoch: 9 cost time: 11.866321563720703
Epoch: 9, Steps: 1063 | Train Loss: 0.2755518 Vali Loss: 0.1908308 Test Loss: 0.3151037
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.2370777
	speed: 0.0441s/iter; left time: 510.7307s
	iters: 200, epoch: 10 | loss: 0.1799455
	speed: 0.0104s/iter; left time: 119.2052s
	iters: 300, epoch: 10 | loss: 0.2099897
	speed: 0.0112s/iter; left time: 128.1020s
	iters: 400, epoch: 10 | loss: 0.4555283
	speed: 0.0113s/iter; left time: 127.5191s
	iters: 500, epoch: 10 | loss: 0.1396891
	speed: 0.0112s/iter; left time: 124.8338s
	iters: 600, epoch: 10 | loss: 0.5670249
	speed: 0.0114s/iter; left time: 126.3906s
	iters: 700, epoch: 10 | loss: 0.6610515
	speed: 0.0119s/iter; left time: 130.7678s
	iters: 800, epoch: 10 | loss: 0.2901045
	speed: 0.0117s/iter; left time: 127.2550s
	iters: 900, epoch: 10 | loss: 0.1565838
	speed: 0.0101s/iter; left time: 108.7208s
	iters: 1000, epoch: 10 | loss: 0.2981629
	speed: 0.0099s/iter; left time: 105.5953s
Epoch: 10 cost time: 11.565066576004028
Epoch: 10, Steps: 1063 | Train Loss: 0.2746793 Vali Loss: 0.2058161 Test Loss: 0.3681116
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.1755995
	speed: 0.0485s/iter; left time: 510.7430s
	iters: 200, epoch: 11 | loss: 0.3322575
	speed: 0.0118s/iter; left time: 122.9080s
	iters: 300, epoch: 11 | loss: 0.2610333
	speed: 0.0119s/iter; left time: 122.7395s
	iters: 400, epoch: 11 | loss: 0.3493235
	speed: 0.0118s/iter; left time: 120.4259s
	iters: 500, epoch: 11 | loss: 0.2182446
	speed: 0.0115s/iter; left time: 116.9367s
	iters: 600, epoch: 11 | loss: 0.4493975
	speed: 0.0097s/iter; left time: 97.3205s
	iters: 700, epoch: 11 | loss: 0.3415314
	speed: 0.0092s/iter; left time: 91.7692s
	iters: 800, epoch: 11 | loss: 0.3799232
	speed: 0.0111s/iter; left time: 109.3240s
	iters: 900, epoch: 11 | loss: 0.3607038
	speed: 0.0112s/iter; left time: 108.5224s
	iters: 1000, epoch: 11 | loss: 0.1283480
	speed: 0.0106s/iter; left time: 102.5051s
Epoch: 11 cost time: 11.665673971176147
Epoch: 11, Steps: 1063 | Train Loss: 0.2742099 Vali Loss: 0.1855399 Test Loss: 0.3101700
EarlyStopping counter: 4 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.2003909
	speed: 0.0487s/iter; left time: 460.9799s
	iters: 200, epoch: 12 | loss: 0.1710757
	speed: 0.0117s/iter; left time: 109.1567s
	iters: 300, epoch: 12 | loss: 0.1685652
	speed: 0.0116s/iter; left time: 107.6331s
	iters: 400, epoch: 12 | loss: 0.2274082
	speed: 0.0117s/iter; left time: 107.4948s
	iters: 500, epoch: 12 | loss: 0.1787200
	speed: 0.0100s/iter; left time: 91.0860s
	iters: 600, epoch: 12 | loss: 0.3770110
	speed: 0.0112s/iter; left time: 100.2650s
	iters: 700, epoch: 12 | loss: 0.2569438
	speed: 0.0110s/iter; left time: 97.3113s
	iters: 800, epoch: 12 | loss: 0.1502339
	speed: 0.0115s/iter; left time: 100.5094s
	iters: 900, epoch: 12 | loss: 0.1019810
	speed: 0.0106s/iter; left time: 91.4661s
	iters: 1000, epoch: 12 | loss: 0.2192694
	speed: 0.0114s/iter; left time: 97.9394s
Epoch: 12 cost time: 11.908836126327515
Epoch: 12, Steps: 1063 | Train Loss: 0.2739608 Vali Loss: 0.1942031 Test Loss: 0.3337768
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTm2_336_192_DLinear_ETTm2_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed28649<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
mse:0.2741294801235199, mae:0.33523669838905334
