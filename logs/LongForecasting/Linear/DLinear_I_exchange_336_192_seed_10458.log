Args in experiment:
Namespace(activation='gelu', batch_size=8, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='exchange_rate.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=8, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='mse', lradj='type1', model='DLinear', model_id='Exchange_336_192', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=192, root_path='./dataset/', save_pred_values=False, seed=10458, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : Exchange_336_192_DLinear_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed10458>>>>>>>>>>>>>>>>>>>>>>>>>>
train 4784
val 569
test 1326
	iters: 100, epoch: 1 | loss: 0.1952782
	speed: 0.0083s/iter; left time: 98.1087s
	iters: 200, epoch: 1 | loss: 0.2917787
	speed: 0.0072s/iter; left time: 84.8293s
	iters: 300, epoch: 1 | loss: 0.1618784
	speed: 0.0059s/iter; left time: 69.1736s
	iters: 400, epoch: 1 | loss: 0.2457918
	speed: 0.0056s/iter; left time: 65.0682s
	iters: 500, epoch: 1 | loss: 0.4712668
	speed: 0.0076s/iter; left time: 87.1301s
Epoch: 1 cost time: 4.3504674434661865
Epoch: 1, Steps: 598 | Train Loss: 0.2696719 Vali Loss: 0.6554679 Test Loss: 0.2427706
Validation loss decreased (inf --> 0.655468).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.3183182
	speed: 0.0220s/iter; left time: 247.4640s
	iters: 200, epoch: 2 | loss: 0.1612615
	speed: 0.0080s/iter; left time: 89.1658s
	iters: 300, epoch: 2 | loss: 0.2686642
	speed: 0.0084s/iter; left time: 92.6305s
	iters: 400, epoch: 2 | loss: 0.2017803
	speed: 0.0086s/iter; left time: 94.7354s
	iters: 500, epoch: 2 | loss: 0.2089858
	speed: 0.0085s/iter; left time: 92.1444s
Epoch: 2 cost time: 4.907814025878906
Epoch: 2, Steps: 598 | Train Loss: 0.2297160 Vali Loss: 0.3729331 Test Loss: 0.2145811
Validation loss decreased (0.655468 --> 0.372933).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.2257851
	speed: 0.0192s/iter; left time: 204.9260s
	iters: 200, epoch: 3 | loss: 0.1272101
	speed: 0.0077s/iter; left time: 80.9551s
	iters: 300, epoch: 3 | loss: 0.2505122
	speed: 0.0086s/iter; left time: 90.3254s
	iters: 400, epoch: 3 | loss: 0.2061494
	speed: 0.0085s/iter; left time: 88.3374s
	iters: 500, epoch: 3 | loss: 0.5223020
	speed: 0.0084s/iter; left time: 86.2350s
Epoch: 3 cost time: 4.878159999847412
Epoch: 3, Steps: 598 | Train Loss: 0.2183279 Vali Loss: 0.5314459 Test Loss: 0.1900226
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1834411
	speed: 0.0215s/iter; left time: 215.9579s
	iters: 200, epoch: 4 | loss: 0.2091949
	speed: 0.0086s/iter; left time: 86.0409s
	iters: 300, epoch: 4 | loss: 0.2412975
	speed: 0.0092s/iter; left time: 90.7908s
	iters: 400, epoch: 4 | loss: 0.4963394
	speed: 0.0084s/iter; left time: 81.5884s
	iters: 500, epoch: 4 | loss: 0.1961873
	speed: 0.0090s/iter; left time: 86.8095s
Epoch: 4 cost time: 5.252063512802124
Epoch: 4, Steps: 598 | Train Loss: 0.2132786 Vali Loss: 0.4115451 Test Loss: 0.1870572
EarlyStopping counter: 2 out of 5
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1718346
	speed: 0.0214s/iter; left time: 202.6940s
	iters: 200, epoch: 5 | loss: 0.3234153
	speed: 0.0093s/iter; left time: 87.0382s
	iters: 300, epoch: 5 | loss: 0.1430412
	speed: 0.0089s/iter; left time: 82.6149s
	iters: 400, epoch: 5 | loss: 0.3540601
	speed: 0.0083s/iter; left time: 75.9587s
	iters: 500, epoch: 5 | loss: 0.3779039
	speed: 0.0078s/iter; left time: 70.7651s
Epoch: 5 cost time: 5.054258346557617
Epoch: 5, Steps: 598 | Train Loss: 0.2108524 Vali Loss: 0.4491619 Test Loss: 0.1951463
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.2209042
	speed: 0.0195s/iter; left time: 173.2911s
	iters: 200, epoch: 6 | loss: 0.2222539
	speed: 0.0063s/iter; left time: 55.0189s
	iters: 300, epoch: 6 | loss: 0.1804258
	speed: 0.0082s/iter; left time: 71.0929s
	iters: 400, epoch: 6 | loss: 0.1633230
	speed: 0.0083s/iter; left time: 70.7477s
	iters: 500, epoch: 6 | loss: 0.2259027
	speed: 0.0079s/iter; left time: 67.1011s
Epoch: 6 cost time: 4.5673534870147705
Epoch: 6, Steps: 598 | Train Loss: 0.2098052 Vali Loss: 0.4773343 Test Loss: 0.1873083
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.2668037
	speed: 0.0189s/iter; left time: 156.4891s
	iters: 200, epoch: 7 | loss: 0.1385759
	speed: 0.0074s/iter; left time: 60.1594s
	iters: 300, epoch: 7 | loss: 0.1375874
	speed: 0.0071s/iter; left time: 57.1569s
	iters: 400, epoch: 7 | loss: 0.2127793
	speed: 0.0073s/iter; left time: 57.9857s
	iters: 500, epoch: 7 | loss: 0.1008518
	speed: 0.0075s/iter; left time: 58.9106s
Epoch: 7 cost time: 4.432461500167847
Epoch: 7, Steps: 598 | Train Loss: 0.2091680 Vali Loss: 0.4654493 Test Loss: 0.1809915
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : Exchange_336_192_DLinear_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed10458<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 1326
mse:0.2145112156867981, mae:0.3604383170604706
