Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTh1', data_path='ETTh1.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='NLinear', model_id='ETTh1_336_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=336, root_path='./dataset/', save_pred_values=False, seed=3293, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTh1_336_336_NLinear_ETTh1_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3293>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7969
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 0.5234267
	speed: 0.0083s/iter; left time: 40.5357s
	iters: 200, epoch: 1 | loss: 0.5324813
	speed: 0.0091s/iter; left time: 43.4881s
Epoch: 1 cost time: 2.1682958602905273
Epoch: 1, Steps: 249 | Train Loss: 0.5486733 Vali Loss: 1.4561937 Test Loss: 0.5216368
Validation loss decreased (inf --> 1.456194).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.5315048
	speed: 0.0204s/iter; left time: 94.4281s
	iters: 200, epoch: 2 | loss: 0.4633762
	speed: 0.0087s/iter; left time: 39.4918s
Epoch: 2 cost time: 2.2631118297576904
Epoch: 2, Steps: 249 | Train Loss: 0.5148033 Vali Loss: 1.4169428 Test Loss: 0.5423537
Validation loss decreased (1.456194 --> 1.416943).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.4246264
	speed: 0.0202s/iter; left time: 88.7377s
	iters: 200, epoch: 3 | loss: 0.4333619
	speed: 0.0088s/iter; left time: 37.7402s
Epoch: 3 cost time: 2.208425760269165
Epoch: 3, Steps: 249 | Train Loss: 0.4701454 Vali Loss: 1.3452655 Test Loss: 0.4705084
Validation loss decreased (1.416943 --> 1.345266).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.5003720
	speed: 0.0156s/iter; left time: 64.3444s
	iters: 200, epoch: 4 | loss: 0.3955266
	speed: 0.0084s/iter; left time: 33.9259s
Epoch: 4 cost time: 1.9943795204162598
Epoch: 4, Steps: 249 | Train Loss: 0.4488573 Vali Loss: 1.3149782 Test Loss: 0.4642430
Validation loss decreased (1.345266 --> 1.314978).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.4540324
	speed: 0.0163s/iter; left time: 63.2311s
	iters: 200, epoch: 5 | loss: 0.4068924
	speed: 0.0084s/iter; left time: 31.6516s
Epoch: 5 cost time: 1.9575304985046387
Epoch: 5, Steps: 249 | Train Loss: 0.4393312 Vali Loss: 1.2742877 Test Loss: 0.4466564
Validation loss decreased (1.314978 --> 1.274288).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.4491638
	speed: 0.0148s/iter; left time: 53.8170s
	iters: 200, epoch: 6 | loss: 0.4714887
	speed: 0.0074s/iter; left time: 26.3193s
Epoch: 6 cost time: 1.7743251323699951
Epoch: 6, Steps: 249 | Train Loss: 0.4338191 Vali Loss: 1.2619611 Test Loss: 0.4422785
Validation loss decreased (1.274288 --> 1.261961).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.4826304
	speed: 0.0183s/iter; left time: 61.8911s
	iters: 200, epoch: 7 | loss: 0.4536964
	speed: 0.0082s/iter; left time: 26.8707s
Epoch: 7 cost time: 2.1307361125946045
Epoch: 7, Steps: 249 | Train Loss: 0.4306991 Vali Loss: 1.2700456 Test Loss: 0.4419035
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.3809593
	speed: 0.0197s/iter; left time: 61.8469s
	iters: 200, epoch: 8 | loss: 0.3903795
	speed: 0.0093s/iter; left time: 28.2352s
Epoch: 8 cost time: 2.2970311641693115
Epoch: 8, Steps: 249 | Train Loss: 0.4289592 Vali Loss: 1.2601897 Test Loss: 0.4405938
Validation loss decreased (1.261961 --> 1.260190).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.5153361
	speed: 0.0185s/iter; left time: 53.4783s
	iters: 200, epoch: 9 | loss: 0.3708330
	speed: 0.0079s/iter; left time: 22.0092s
Epoch: 9 cost time: 1.998382329940796
Epoch: 9, Steps: 249 | Train Loss: 0.4281034 Vali Loss: 1.2638888 Test Loss: 0.4407335
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.4898890
	speed: 0.0185s/iter; left time: 48.7522s
	iters: 200, epoch: 10 | loss: 0.4327646
	speed: 0.0083s/iter; left time: 21.1603s
Epoch: 10 cost time: 2.1314496994018555
Epoch: 10, Steps: 249 | Train Loss: 0.4277141 Vali Loss: 1.2566607 Test Loss: 0.4395413
Validation loss decreased (1.260190 --> 1.256661).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.4627524
	speed: 0.0178s/iter; left time: 42.6412s
	iters: 200, epoch: 11 | loss: 0.4738691
	speed: 0.0087s/iter; left time: 19.8912s
Epoch: 11 cost time: 2.061443328857422
Epoch: 11, Steps: 249 | Train Loss: 0.4274724 Vali Loss: 1.2574667 Test Loss: 0.4396562
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.4377896
	speed: 0.0177s/iter; left time: 38.0080s
	iters: 200, epoch: 12 | loss: 0.3742388
	speed: 0.0089s/iter; left time: 18.1618s
Epoch: 12 cost time: 2.1977787017822266
Epoch: 12, Steps: 249 | Train Loss: 0.4273167 Vali Loss: 1.2592769 Test Loss: 0.4396511
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.4022117
	speed: 0.0192s/iter; left time: 36.2597s
	iters: 200, epoch: 13 | loss: 0.4332674
	speed: 0.0086s/iter; left time: 15.4973s
Epoch: 13 cost time: 2.189652919769287
Epoch: 13, Steps: 249 | Train Loss: 0.4272383 Vali Loss: 1.2604911 Test Loss: 0.4396775
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.4465664
	speed: 0.0177s/iter; left time: 29.0226s
	iters: 200, epoch: 14 | loss: 0.3988979
	speed: 0.0076s/iter; left time: 11.7250s
Epoch: 14 cost time: 1.8716826438903809
Epoch: 14, Steps: 249 | Train Loss: 0.4271406 Vali Loss: 1.2586765 Test Loss: 0.4396748
EarlyStopping counter: 4 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.3883038
	speed: 0.0155s/iter; left time: 21.5704s
	iters: 200, epoch: 15 | loss: 0.4496250
	speed: 0.0070s/iter; left time: 9.1068s
Epoch: 15 cost time: 1.7704885005950928
Epoch: 15, Steps: 249 | Train Loss: 0.4270892 Vali Loss: 1.2592486 Test Loss: 0.4396780
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTh1_336_336_NLinear_ETTh1_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3293<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2545
mse:0.438518226146698, mae:0.4358740746974945
