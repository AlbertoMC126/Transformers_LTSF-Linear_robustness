Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTh1', data_path='ETTh1.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='Linear', model_id='ETTh1_336_720', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=720, root_path='./dataset/', save_pred_values=False, seed=3144, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTh1_336_720_Linear_ETTh1_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3144>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7585
val 2161
test 2161
	iters: 100, epoch: 1 | loss: 0.5638835
	speed: 0.0180s/iter; left time: 83.5221s
	iters: 200, epoch: 1 | loss: 0.6291178
	speed: 0.0179s/iter; left time: 81.1848s
Epoch: 1 cost time: 4.105101585388184
Epoch: 1, Steps: 237 | Train Loss: 0.5985846 Vali Loss: 1.4239789 Test Loss: 0.5736881
Validation loss decreased (inf --> 1.423979).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.5977554
	speed: 0.0291s/iter; left time: 128.2300s
	iters: 200, epoch: 2 | loss: 0.5531594
	speed: 0.0168s/iter; left time: 72.1009s
Epoch: 2 cost time: 3.994760274887085
Epoch: 2, Steps: 237 | Train Loss: 0.5715117 Vali Loss: 1.5923424 Test Loss: 0.5557225
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.5348253
	speed: 0.0326s/iter; left time: 135.9065s
	iters: 200, epoch: 3 | loss: 0.4977541
	speed: 0.0172s/iter; left time: 70.0223s
Epoch: 3 cost time: 4.2173073291778564
Epoch: 3, Steps: 237 | Train Loss: 0.5225283 Vali Loss: 1.3134456 Test Loss: 0.5442648
Validation loss decreased (1.423979 --> 1.313446).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.5168536
	speed: 0.0332s/iter; left time: 130.3867s
	iters: 200, epoch: 4 | loss: 0.4940681
	speed: 0.0179s/iter; left time: 68.4506s
Epoch: 4 cost time: 4.252933979034424
Epoch: 4, Steps: 237 | Train Loss: 0.5006110 Vali Loss: 1.2903534 Test Loss: 0.4998949
Validation loss decreased (1.313446 --> 1.290353).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.5078986
	speed: 0.0328s/iter; left time: 121.2175s
	iters: 200, epoch: 5 | loss: 0.5228959
	speed: 0.0196s/iter; left time: 70.2694s
Epoch: 5 cost time: 4.17135214805603
Epoch: 5, Steps: 237 | Train Loss: 0.4899661 Vali Loss: 1.2500986 Test Loss: 0.5028687
Validation loss decreased (1.290353 --> 1.250099).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.5348740
	speed: 0.0341s/iter; left time: 117.8957s
	iters: 200, epoch: 6 | loss: 0.5178471
	speed: 0.0199s/iter; left time: 66.7506s
Epoch: 6 cost time: 4.578920125961304
Epoch: 6, Steps: 237 | Train Loss: 0.4838620 Vali Loss: 1.2510713 Test Loss: 0.4882453
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.5134759
	speed: 0.0353s/iter; left time: 113.7666s
	iters: 200, epoch: 7 | loss: 0.4151681
	speed: 0.0193s/iter; left time: 60.0633s
Epoch: 7 cost time: 4.518450736999512
Epoch: 7, Steps: 237 | Train Loss: 0.4808706 Vali Loss: 1.2490546 Test Loss: 0.4906550
Validation loss decreased (1.250099 --> 1.249055).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.4705684
	speed: 0.0327s/iter; left time: 97.5036s
	iters: 200, epoch: 8 | loss: 0.5101401
	speed: 0.0180s/iter; left time: 51.8416s
Epoch: 8 cost time: 4.297367095947266
Epoch: 8, Steps: 237 | Train Loss: 0.4791448 Vali Loss: 1.2457429 Test Loss: 0.4907033
Validation loss decreased (1.249055 --> 1.245743).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.4537866
	speed: 0.0318s/iter; left time: 87.2134s
	iters: 200, epoch: 9 | loss: 0.5016119
	speed: 0.0187s/iter; left time: 49.4039s
Epoch: 9 cost time: 4.172943115234375
Epoch: 9, Steps: 237 | Train Loss: 0.4782263 Vali Loss: 1.2406486 Test Loss: 0.4902259
Validation loss decreased (1.245743 --> 1.240649).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.4926707
	speed: 0.0340s/iter; left time: 85.2163s
	iters: 200, epoch: 10 | loss: 0.5174342
	speed: 0.0177s/iter; left time: 42.5773s
Epoch: 10 cost time: 4.21048641204834
Epoch: 10, Steps: 237 | Train Loss: 0.4778045 Vali Loss: 1.2440039 Test Loss: 0.4876734
EarlyStopping counter: 1 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.4366753
	speed: 0.0320s/iter; left time: 72.7166s
	iters: 200, epoch: 11 | loss: 0.4863160
	speed: 0.0167s/iter; left time: 36.1952s
Epoch: 11 cost time: 4.151522159576416
Epoch: 11, Steps: 237 | Train Loss: 0.4775141 Vali Loss: 1.2420856 Test Loss: 0.4868073
EarlyStopping counter: 2 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.4789304
	speed: 0.0339s/iter; left time: 69.0192s
	iters: 200, epoch: 12 | loss: 0.5017955
	speed: 0.0182s/iter; left time: 35.1164s
Epoch: 12 cost time: 4.285527944564819
Epoch: 12, Steps: 237 | Train Loss: 0.4773542 Vali Loss: 1.2442009 Test Loss: 0.4874049
EarlyStopping counter: 3 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.4850881
	speed: 0.0314s/iter; left time: 56.3819s
	iters: 200, epoch: 13 | loss: 0.5381592
	speed: 0.0165s/iter; left time: 27.9642s
Epoch: 13 cost time: 3.9164013862609863
Epoch: 13, Steps: 237 | Train Loss: 0.4772889 Vali Loss: 1.2419895 Test Loss: 0.4876127
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.4563472
	speed: 0.0281s/iter; left time: 43.8629s
	iters: 200, epoch: 14 | loss: 0.4691489
	speed: 0.0147s/iter; left time: 21.4382s
Epoch: 14 cost time: 3.5107181072235107
Epoch: 14, Steps: 237 | Train Loss: 0.4771921 Vali Loss: 1.2454636 Test Loss: 0.4874825
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTh1_336_720_Linear_ETTh1_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3144<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
mse:0.4892793297767639, mae:0.48802271485328674
