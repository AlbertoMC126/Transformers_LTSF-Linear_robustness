Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='NLinear', model_id='weather_336_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=15227, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : weather_336_96_NLinear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15227>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36456
val 5175
test 10444
	iters: 100, epoch: 1 | loss: 0.4746374
	speed: 0.0090s/iter; left time: 407.8576s
	iters: 200, epoch: 1 | loss: 2.8934610
	speed: 0.0104s/iter; left time: 469.9882s
	iters: 300, epoch: 1 | loss: 0.5071645
	speed: 0.0095s/iter; left time: 428.2483s
	iters: 400, epoch: 1 | loss: 1.4886384
	speed: 0.0103s/iter; left time: 463.9203s
	iters: 500, epoch: 1 | loss: 0.6210558
	speed: 0.0099s/iter; left time: 447.4788s
	iters: 600, epoch: 1 | loss: 0.4051755
	speed: 0.0080s/iter; left time: 360.2330s
	iters: 700, epoch: 1 | loss: 2.2395387
	speed: 0.0065s/iter; left time: 292.6822s
	iters: 800, epoch: 1 | loss: 0.6639988
	speed: 0.0094s/iter; left time: 418.5454s
	iters: 900, epoch: 1 | loss: 1.3056674
	speed: 0.0106s/iter; left time: 473.5014s
	iters: 1000, epoch: 1 | loss: 1.4446288
	speed: 0.0094s/iter; left time: 419.9206s
	iters: 1100, epoch: 1 | loss: 0.6332334
	speed: 0.0102s/iter; left time: 452.7700s
	iters: 1200, epoch: 1 | loss: 0.2497864
	speed: 0.0101s/iter; left time: 447.6613s
	iters: 1300, epoch: 1 | loss: 0.3829810
	speed: 0.0091s/iter; left time: 402.8044s
	iters: 1400, epoch: 1 | loss: 0.5309411
	speed: 0.0098s/iter; left time: 432.3414s
	iters: 1500, epoch: 1 | loss: 0.3954827
	speed: 0.0095s/iter; left time: 418.5815s
	iters: 1600, epoch: 1 | loss: 0.7824680
	speed: 0.0106s/iter; left time: 466.5244s
	iters: 1700, epoch: 1 | loss: 0.3014058
	speed: 0.0090s/iter; left time: 395.8047s
	iters: 1800, epoch: 1 | loss: 0.6991883
	speed: 0.0099s/iter; left time: 431.9253s
	iters: 1900, epoch: 1 | loss: 0.4458899
	speed: 0.0102s/iter; left time: 443.1744s
	iters: 2000, epoch: 1 | loss: 1.0379087
	speed: 0.0098s/iter; left time: 424.8074s
	iters: 2100, epoch: 1 | loss: 0.5053030
	speed: 0.0098s/iter; left time: 427.3671s
	iters: 2200, epoch: 1 | loss: 0.4261600
	speed: 0.0089s/iter; left time: 383.7644s
Epoch: 1 cost time: 21.695072650909424
Epoch: 1, Steps: 2278 | Train Loss: 2.4671286 Vali Loss: 5.3972907 Test Loss: 0.2930735
Validation loss decreased (inf --> 5.397291).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.9950677
	speed: 0.0418s/iter; left time: 1806.0444s
	iters: 200, epoch: 2 | loss: 1.2213559
	speed: 0.0086s/iter; left time: 370.5144s
	iters: 300, epoch: 2 | loss: 0.3214155
	speed: 0.0078s/iter; left time: 334.5141s
	iters: 400, epoch: 2 | loss: 0.4105561
	speed: 0.0083s/iter; left time: 357.7491s
	iters: 500, epoch: 2 | loss: 0.4009555
	speed: 0.0093s/iter; left time: 398.8268s
	iters: 600, epoch: 2 | loss: 0.3066041
	speed: 0.0094s/iter; left time: 402.0810s
	iters: 700, epoch: 2 | loss: 0.7161953
	speed: 0.0096s/iter; left time: 408.0554s
	iters: 800, epoch: 2 | loss: 0.4054657
	speed: 0.0088s/iter; left time: 373.0803s
	iters: 900, epoch: 2 | loss: 0.4192379
	speed: 0.0100s/iter; left time: 423.9631s
	iters: 1000, epoch: 2 | loss: 0.4312994
	speed: 0.0105s/iter; left time: 443.2755s
	iters: 1100, epoch: 2 | loss: 1.1648134
	speed: 0.0091s/iter; left time: 384.7876s
	iters: 1200, epoch: 2 | loss: 0.4503704
	speed: 0.0089s/iter; left time: 375.5019s
	iters: 1300, epoch: 2 | loss: 0.3822360
	speed: 0.0080s/iter; left time: 335.3701s
	iters: 1400, epoch: 2 | loss: 0.5650499
	speed: 0.0088s/iter; left time: 368.2312s
	iters: 1500, epoch: 2 | loss: 0.3017897
	speed: 0.0107s/iter; left time: 445.9354s
	iters: 1600, epoch: 2 | loss: 0.7472972
	speed: 0.0108s/iter; left time: 450.3087s
	iters: 1700, epoch: 2 | loss: 0.4018804
	speed: 0.0089s/iter; left time: 371.0698s
	iters: 1800, epoch: 2 | loss: 0.4371997
	speed: 0.0093s/iter; left time: 384.2141s
	iters: 1900, epoch: 2 | loss: 0.4255580
	speed: 0.0096s/iter; left time: 397.7728s
	iters: 2000, epoch: 2 | loss: 4.2496648
	speed: 0.0090s/iter; left time: 370.3998s
	iters: 2100, epoch: 2 | loss: 2.3104830
	speed: 0.0094s/iter; left time: 385.5568s
	iters: 2200, epoch: 2 | loss: 1.4539993
	speed: 0.0104s/iter; left time: 428.0663s
Epoch: 2 cost time: 21.426626443862915
Epoch: 2, Steps: 2278 | Train Loss: 8.7326251 Vali Loss: 3.6735821 Test Loss: 0.3078558
Validation loss decreased (5.397291 --> 3.673582).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.4638515
	speed: 0.0407s/iter; left time: 1663.2322s
	iters: 200, epoch: 3 | loss: 0.9959247
	speed: 0.0088s/iter; left time: 357.5816s
	iters: 300, epoch: 3 | loss: 0.3556194
	speed: 0.0087s/iter; left time: 354.6716s
	iters: 400, epoch: 3 | loss: 0.5894635
	speed: 0.0085s/iter; left time: 346.7541s
	iters: 500, epoch: 3 | loss: 0.3391106
	speed: 0.0093s/iter; left time: 375.6069s
	iters: 600, epoch: 3 | loss: 0.3463889
	speed: 0.0089s/iter; left time: 360.5001s
	iters: 700, epoch: 3 | loss: 0.3197754
	speed: 0.0090s/iter; left time: 361.2561s
	iters: 800, epoch: 3 | loss: 2.9400952
	speed: 0.0090s/iter; left time: 360.2558s
	iters: 900, epoch: 3 | loss: 3.2184358
	speed: 0.0101s/iter; left time: 405.5946s
	iters: 1000, epoch: 3 | loss: 0.4491961
	speed: 0.0091s/iter; left time: 364.7512s
	iters: 1100, epoch: 3 | loss: 2.7261980
	speed: 0.0082s/iter; left time: 328.0338s
	iters: 1200, epoch: 3 | loss: 0.4002717
	speed: 0.0094s/iter; left time: 373.0731s
	iters: 1300, epoch: 3 | loss: 2.0082641
	speed: 0.0098s/iter; left time: 387.2402s
	iters: 1400, epoch: 3 | loss: 13.1499052
	speed: 0.0091s/iter; left time: 362.0982s
	iters: 1500, epoch: 3 | loss: 0.4316784
	speed: 0.0081s/iter; left time: 320.9178s
	iters: 1600, epoch: 3 | loss: 0.3753535
	speed: 0.0086s/iter; left time: 339.7762s
	iters: 1700, epoch: 3 | loss: 0.4921501
	speed: 0.0086s/iter; left time: 338.8660s
	iters: 1800, epoch: 3 | loss: 0.9271187
	speed: 0.0084s/iter; left time: 329.3220s
	iters: 1900, epoch: 3 | loss: 4.0125270
	speed: 0.0097s/iter; left time: 378.5578s
	iters: 2000, epoch: 3 | loss: 0.6837811
	speed: 0.0112s/iter; left time: 438.5336s
	iters: 2100, epoch: 3 | loss: 0.8766477
	speed: 0.0098s/iter; left time: 381.4708s
	iters: 2200, epoch: 3 | loss: 0.6793708
	speed: 0.0096s/iter; left time: 373.3328s
Epoch: 3 cost time: 20.821680068969727
Epoch: 3, Steps: 2278 | Train Loss: 73.1128261 Vali Loss: 0.4440979 Test Loss: 0.1848997
Validation loss decreased (3.673582 --> 0.444098).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.5910797
	speed: 0.0380s/iter; left time: 1469.4111s
	iters: 200, epoch: 4 | loss: 0.2502978
	speed: 0.0094s/iter; left time: 363.3416s
	iters: 300, epoch: 4 | loss: 0.8521444
	speed: 0.0095s/iter; left time: 365.5083s
	iters: 400, epoch: 4 | loss: 0.7093517
	speed: 0.0089s/iter; left time: 342.5637s
	iters: 500, epoch: 4 | loss: 0.2938427
	speed: 0.0090s/iter; left time: 342.2322s
	iters: 600, epoch: 4 | loss: 0.4718748
	speed: 0.0082s/iter; left time: 311.6071s
	iters: 700, epoch: 4 | loss: 0.3655946
	speed: 0.0093s/iter; left time: 353.6494s
	iters: 800, epoch: 4 | loss: 0.4908602
	speed: 0.0101s/iter; left time: 383.2477s
	iters: 900, epoch: 4 | loss: 0.2499771
	speed: 0.0101s/iter; left time: 381.3656s
	iters: 1000, epoch: 4 | loss: 0.5225629
	speed: 0.0098s/iter; left time: 367.9903s
	iters: 1100, epoch: 4 | loss: 2.2275152
	speed: 0.0091s/iter; left time: 343.6285s
	iters: 1200, epoch: 4 | loss: 0.3344265
	speed: 0.0104s/iter; left time: 391.9171s
	iters: 1300, epoch: 4 | loss: 2.1613088
	speed: 0.0102s/iter; left time: 381.2583s
	iters: 1400, epoch: 4 | loss: 0.2676682
	speed: 0.0094s/iter; left time: 350.1425s
	iters: 1500, epoch: 4 | loss: 0.5683070
	speed: 0.0089s/iter; left time: 331.7131s
	iters: 1600, epoch: 4 | loss: 0.3421520
	speed: 0.0093s/iter; left time: 343.4969s
	iters: 1700, epoch: 4 | loss: 0.8640525
	speed: 0.0107s/iter; left time: 397.0611s
	iters: 1800, epoch: 4 | loss: 1.0595827
	speed: 0.0089s/iter; left time: 326.8219s
	iters: 1900, epoch: 4 | loss: 0.6128325
	speed: 0.0078s/iter; left time: 287.3377s
	iters: 2000, epoch: 4 | loss: 0.3491771
	speed: 0.0087s/iter; left time: 321.0834s
	iters: 2100, epoch: 4 | loss: 0.3330392
	speed: 0.0101s/iter; left time: 371.5133s
	iters: 2200, epoch: 4 | loss: 0.2113671
	speed: 0.0099s/iter; left time: 363.1992s
Epoch: 4 cost time: 21.505326509475708
Epoch: 4, Steps: 2278 | Train Loss: 15.8500939 Vali Loss: 0.4206128 Test Loss: 0.1590338
Validation loss decreased (0.444098 --> 0.420613).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.2029000
	speed: 0.0378s/iter; left time: 1373.9229s
	iters: 200, epoch: 5 | loss: 2.3789990
	speed: 0.0084s/iter; left time: 304.5636s
	iters: 300, epoch: 5 | loss: 0.2814958
	speed: 0.0091s/iter; left time: 329.0316s
	iters: 400, epoch: 5 | loss: 0.2968825
	speed: 0.0087s/iter; left time: 315.3996s
	iters: 500, epoch: 5 | loss: 0.3050335
	speed: 0.0093s/iter; left time: 335.8583s
	iters: 600, epoch: 5 | loss: 0.7426050
	speed: 0.0101s/iter; left time: 362.9159s
	iters: 700, epoch: 5 | loss: 0.2687728
	speed: 0.0092s/iter; left time: 330.6062s
	iters: 800, epoch: 5 | loss: 0.3242409
	speed: 0.0094s/iter; left time: 333.7661s
	iters: 900, epoch: 5 | loss: 0.2374307
	speed: 0.0100s/iter; left time: 353.7543s
	iters: 1000, epoch: 5 | loss: 0.4435738
	speed: 0.0113s/iter; left time: 400.6462s
	iters: 1100, epoch: 5 | loss: 0.2083120
	speed: 0.0083s/iter; left time: 293.4056s
	iters: 1200, epoch: 5 | loss: 0.3165697
	speed: 0.0073s/iter; left time: 255.9927s
	iters: 1300, epoch: 5 | loss: 0.2678206
	speed: 0.0093s/iter; left time: 325.3019s
	iters: 1400, epoch: 5 | loss: 0.2839703
	speed: 0.0095s/iter; left time: 332.6632s
	iters: 1500, epoch: 5 | loss: 0.2454631
	speed: 0.0098s/iter; left time: 343.5036s
	iters: 1600, epoch: 5 | loss: 0.2656308
	speed: 0.0086s/iter; left time: 299.4478s
	iters: 1700, epoch: 5 | loss: 2.3309548
	speed: 0.0099s/iter; left time: 344.1057s
	iters: 1800, epoch: 5 | loss: 0.3743731
	speed: 0.0092s/iter; left time: 318.0924s
	iters: 1900, epoch: 5 | loss: 0.5337569
	speed: 0.0108s/iter; left time: 373.2587s
	iters: 2000, epoch: 5 | loss: 0.2397079
	speed: 0.0103s/iter; left time: 353.8531s
	iters: 2100, epoch: 5 | loss: 2.7466021
	speed: 0.0098s/iter; left time: 338.2547s
	iters: 2200, epoch: 5 | loss: 0.3122451
	speed: 0.0101s/iter; left time: 347.0257s
Epoch: 5 cost time: 21.427499294281006
Epoch: 5, Steps: 2278 | Train Loss: 4.6604849 Vali Loss: 0.3967367 Test Loss: 0.1477571
Validation loss decreased (0.420613 --> 0.396737).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.2219336
	speed: 0.0379s/iter; left time: 1291.4753s
	iters: 200, epoch: 6 | loss: 0.5761451
	speed: 0.0105s/iter; left time: 356.8074s
	iters: 300, epoch: 6 | loss: 0.2403954
	speed: 0.0093s/iter; left time: 316.1003s
	iters: 400, epoch: 6 | loss: 2.5579283
	speed: 0.0083s/iter; left time: 278.6194s
	iters: 500, epoch: 6 | loss: 0.2806426
	speed: 0.0084s/iter; left time: 283.5415s
	iters: 600, epoch: 6 | loss: 0.2060392
	speed: 0.0091s/iter; left time: 304.5529s
	iters: 700, epoch: 6 | loss: 0.5028458
	speed: 0.0092s/iter; left time: 306.6799s
	iters: 800, epoch: 6 | loss: 0.2552782
	speed: 0.0114s/iter; left time: 378.9020s
	iters: 900, epoch: 6 | loss: 0.2884792
	speed: 0.0089s/iter; left time: 297.1355s
	iters: 1000, epoch: 6 | loss: 0.2021658
	speed: 0.0084s/iter; left time: 278.9861s
	iters: 1100, epoch: 6 | loss: 0.3791689
	speed: 0.0070s/iter; left time: 233.0915s
	iters: 1200, epoch: 6 | loss: 0.4402553
	speed: 0.0094s/iter; left time: 310.0045s
	iters: 1300, epoch: 6 | loss: 1.0219964
	speed: 0.0113s/iter; left time: 370.0227s
	iters: 1400, epoch: 6 | loss: 0.4157478
	speed: 0.0093s/iter; left time: 304.4627s
	iters: 1500, epoch: 6 | loss: 0.2785943
	speed: 0.0092s/iter; left time: 299.0438s
	iters: 1600, epoch: 6 | loss: 0.4308077
	speed: 0.0086s/iter; left time: 279.8143s
	iters: 1700, epoch: 6 | loss: 0.3814452
	speed: 0.0086s/iter; left time: 279.6519s
	iters: 1800, epoch: 6 | loss: 0.7291108
	speed: 0.0081s/iter; left time: 260.5875s
	iters: 1900, epoch: 6 | loss: 0.2383279
	speed: 0.0089s/iter; left time: 286.9733s
	iters: 2000, epoch: 6 | loss: 0.2842506
	speed: 0.0106s/iter; left time: 341.0832s
	iters: 2100, epoch: 6 | loss: 0.1845959
	speed: 0.0102s/iter; left time: 327.8558s
	iters: 2200, epoch: 6 | loss: 0.3024808
	speed: 0.0094s/iter; left time: 300.0012s
Epoch: 6 cost time: 21.027539014816284
Epoch: 6, Steps: 2278 | Train Loss: 1.5573210 Vali Loss: 0.3981322 Test Loss: 0.1456834
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.2702708
	speed: 0.0417s/iter; left time: 1326.0412s
	iters: 200, epoch: 7 | loss: 2.2745399
	speed: 0.0111s/iter; left time: 350.2825s
	iters: 300, epoch: 7 | loss: 0.6102532
	speed: 0.0094s/iter; left time: 297.6939s
	iters: 400, epoch: 7 | loss: 0.4227974
	speed: 0.0092s/iter; left time: 290.4438s
	iters: 500, epoch: 7 | loss: 0.2259604
	speed: 0.0089s/iter; left time: 278.2399s
	iters: 600, epoch: 7 | loss: 0.4397340
	speed: 0.0091s/iter; left time: 284.8294s
	iters: 700, epoch: 7 | loss: 2.0912392
	speed: 0.0095s/iter; left time: 296.4363s
	iters: 800, epoch: 7 | loss: 2.2847400
	speed: 0.0095s/iter; left time: 296.0847s
	iters: 900, epoch: 7 | loss: 0.4860928
	speed: 0.0099s/iter; left time: 307.8301s
	iters: 1000, epoch: 7 | loss: 0.1789652
	speed: 0.0077s/iter; left time: 237.8930s
	iters: 1100, epoch: 7 | loss: 0.2334741
	speed: 0.0082s/iter; left time: 251.9895s
	iters: 1200, epoch: 7 | loss: 0.2929843
	speed: 0.0088s/iter; left time: 268.9419s
	iters: 1300, epoch: 7 | loss: 0.6297645
	speed: 0.0101s/iter; left time: 309.6609s
	iters: 1400, epoch: 7 | loss: 0.3573154
	speed: 0.0091s/iter; left time: 278.4892s
	iters: 1500, epoch: 7 | loss: 0.2338108
	speed: 0.0096s/iter; left time: 292.4611s
	iters: 1600, epoch: 7 | loss: 0.4013159
	speed: 0.0092s/iter; left time: 277.7968s
	iters: 1700, epoch: 7 | loss: 0.2497326
	speed: 0.0104s/iter; left time: 313.7740s
	iters: 1800, epoch: 7 | loss: 0.2031656
	speed: 0.0097s/iter; left time: 291.4802s
	iters: 1900, epoch: 7 | loss: 0.2271436
	speed: 0.0088s/iter; left time: 263.7057s
	iters: 2000, epoch: 7 | loss: 0.1554768
	speed: 0.0092s/iter; left time: 273.5534s
	iters: 2100, epoch: 7 | loss: 0.1720988
	speed: 0.0097s/iter; left time: 288.7174s
	iters: 2200, epoch: 7 | loss: 0.5004742
	speed: 0.0097s/iter; left time: 288.1010s
Epoch: 7 cost time: 21.525264263153076
Epoch: 7, Steps: 2278 | Train Loss: 0.8944567 Vali Loss: 0.3848321 Test Loss: 0.1464504
Validation loss decreased (0.396737 --> 0.384832).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.2759459
	speed: 0.0420s/iter; left time: 1239.7546s
	iters: 200, epoch: 8 | loss: 0.1870637
	speed: 0.0090s/iter; left time: 265.6890s
	iters: 300, epoch: 8 | loss: 0.2514075
	speed: 0.0092s/iter; left time: 268.6294s
	iters: 400, epoch: 8 | loss: 0.3932833
	speed: 0.0092s/iter; left time: 268.5041s
	iters: 500, epoch: 8 | loss: 0.4214009
	speed: 0.0097s/iter; left time: 282.1374s
	iters: 600, epoch: 8 | loss: 0.4384633
	speed: 0.0095s/iter; left time: 275.3082s
	iters: 700, epoch: 8 | loss: 0.1892847
	speed: 0.0103s/iter; left time: 297.3903s
	iters: 800, epoch: 8 | loss: 0.6677933
	speed: 0.0106s/iter; left time: 306.0725s
	iters: 900, epoch: 8 | loss: 0.2665707
	speed: 0.0100s/iter; left time: 286.6551s
	iters: 1000, epoch: 8 | loss: 0.2942003
	speed: 0.0099s/iter; left time: 283.3004s
	iters: 1100, epoch: 8 | loss: 0.3028208
	speed: 0.0104s/iter; left time: 297.1870s
	iters: 1200, epoch: 8 | loss: 0.4716696
	speed: 0.0104s/iter; left time: 294.2686s
	iters: 1300, epoch: 8 | loss: 0.2159023
	speed: 0.0104s/iter; left time: 294.4711s
	iters: 1400, epoch: 8 | loss: 0.2600309
	speed: 0.0094s/iter; left time: 266.3294s
	iters: 1500, epoch: 8 | loss: 0.2250849
	speed: 0.0092s/iter; left time: 258.7290s
	iters: 1600, epoch: 8 | loss: 2.4609656
	speed: 0.0099s/iter; left time: 278.5653s
	iters: 1700, epoch: 8 | loss: 0.3989353
	speed: 0.0101s/iter; left time: 283.0816s
	iters: 1800, epoch: 8 | loss: 0.5299856
	speed: 0.0082s/iter; left time: 228.0830s
	iters: 1900, epoch: 8 | loss: 0.2420217
	speed: 0.0097s/iter; left time: 267.7828s
	iters: 2000, epoch: 8 | loss: 1.8641719
	speed: 0.0088s/iter; left time: 242.7418s
	iters: 2100, epoch: 8 | loss: 0.2346959
	speed: 0.0089s/iter; left time: 243.8458s
	iters: 2200, epoch: 8 | loss: 0.2819806
	speed: 0.0091s/iter; left time: 248.1165s
Epoch: 8 cost time: 21.953076124191284
Epoch: 8, Steps: 2278 | Train Loss: 0.6433736 Vali Loss: 0.3763646 Test Loss: 0.1437851
Validation loss decreased (0.384832 --> 0.376365).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.2206541
	speed: 0.0374s/iter; left time: 1019.3692s
	iters: 200, epoch: 9 | loss: 0.1502712
	speed: 0.0108s/iter; left time: 292.8896s
	iters: 300, epoch: 9 | loss: 1.7006797
	speed: 0.0115s/iter; left time: 309.9754s
	iters: 400, epoch: 9 | loss: 0.4023167
	speed: 0.0111s/iter; left time: 299.3442s
	iters: 500, epoch: 9 | loss: 0.6399797
	speed: 0.0081s/iter; left time: 218.2661s
	iters: 600, epoch: 9 | loss: 0.8245456
	speed: 0.0101s/iter; left time: 269.5414s
	iters: 700, epoch: 9 | loss: 0.2398334
	speed: 0.0094s/iter; left time: 250.1732s
	iters: 800, epoch: 9 | loss: 0.2403855
	speed: 0.0087s/iter; left time: 231.2178s
	iters: 900, epoch: 9 | loss: 0.2601611
	speed: 0.0084s/iter; left time: 222.9710s
	iters: 1000, epoch: 9 | loss: 0.2620136
	speed: 0.0084s/iter; left time: 222.2959s
	iters: 1100, epoch: 9 | loss: 0.3981600
	speed: 0.0082s/iter; left time: 213.9361s
	iters: 1200, epoch: 9 | loss: 0.2284789
	speed: 0.0086s/iter; left time: 224.3296s
	iters: 1300, epoch: 9 | loss: 0.2527627
	speed: 0.0079s/iter; left time: 205.0111s
	iters: 1400, epoch: 9 | loss: 0.5709780
	speed: 0.0081s/iter; left time: 210.6898s
	iters: 1500, epoch: 9 | loss: 0.3460107
	speed: 0.0082s/iter; left time: 211.4257s
	iters: 1600, epoch: 9 | loss: 0.2868060
	speed: 0.0102s/iter; left time: 262.8067s
	iters: 1700, epoch: 9 | loss: 0.5530803
	speed: 0.0077s/iter; left time: 197.6766s
	iters: 1800, epoch: 9 | loss: 0.3350769
	speed: 0.0091s/iter; left time: 232.4712s
	iters: 1900, epoch: 9 | loss: 0.2540684
	speed: 0.0091s/iter; left time: 232.2885s
	iters: 2000, epoch: 9 | loss: 0.3086857
	speed: 0.0100s/iter; left time: 252.4047s
	iters: 2100, epoch: 9 | loss: 0.3309105
	speed: 0.0085s/iter; left time: 214.7751s
	iters: 2200, epoch: 9 | loss: 0.1556413
	speed: 0.0099s/iter; left time: 248.1783s
Epoch: 9 cost time: 20.817777156829834
Epoch: 9, Steps: 2278 | Train Loss: 0.5539007 Vali Loss: 0.3799118 Test Loss: 0.1438571
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.2686525
	speed: 0.0339s/iter; left time: 846.3588s
	iters: 200, epoch: 10 | loss: 0.5214779
	speed: 0.0086s/iter; left time: 212.5875s
	iters: 300, epoch: 10 | loss: 0.2333797
	speed: 0.0101s/iter; left time: 250.6340s
	iters: 400, epoch: 10 | loss: 0.5077285
	speed: 0.0096s/iter; left time: 236.1386s
	iters: 500, epoch: 10 | loss: 0.5390844
	speed: 0.0089s/iter; left time: 217.6828s
	iters: 600, epoch: 10 | loss: 0.2685816
	speed: 0.0089s/iter; left time: 217.7422s
	iters: 700, epoch: 10 | loss: 0.2119673
	speed: 0.0092s/iter; left time: 225.1327s
	iters: 800, epoch: 10 | loss: 0.3095420
	speed: 0.0095s/iter; left time: 231.5203s
	iters: 900, epoch: 10 | loss: 0.5284371
	speed: 0.0107s/iter; left time: 258.5131s
	iters: 1000, epoch: 10 | loss: 0.4584508
	speed: 0.0103s/iter; left time: 247.8753s
	iters: 1100, epoch: 10 | loss: 0.2443457
	speed: 0.0100s/iter; left time: 239.6395s
	iters: 1200, epoch: 10 | loss: 0.4423341
	speed: 0.0109s/iter; left time: 259.1774s
	iters: 1300, epoch: 10 | loss: 0.4128069
	speed: 0.0096s/iter; left time: 229.2172s
	iters: 1400, epoch: 10 | loss: 0.2257792
	speed: 0.0091s/iter; left time: 215.2997s
	iters: 1500, epoch: 10 | loss: 0.2394105
	speed: 0.0106s/iter; left time: 250.7386s
	iters: 1600, epoch: 10 | loss: 0.3971637
	speed: 0.0100s/iter; left time: 234.3798s
	iters: 1700, epoch: 10 | loss: 0.3872897
	speed: 0.0081s/iter; left time: 189.9189s
	iters: 1800, epoch: 10 | loss: 0.2588497
	speed: 0.0092s/iter; left time: 214.9172s
	iters: 1900, epoch: 10 | loss: 0.3126287
	speed: 0.0104s/iter; left time: 241.7931s
	iters: 2000, epoch: 10 | loss: 0.1954647
	speed: 0.0106s/iter; left time: 244.2497s
	iters: 2100, epoch: 10 | loss: 0.1969656
	speed: 0.0097s/iter; left time: 223.1820s
	iters: 2200, epoch: 10 | loss: 0.3343793
	speed: 0.0106s/iter; left time: 241.9084s
Epoch: 10 cost time: 22.089106559753418
Epoch: 10, Steps: 2278 | Train Loss: 0.5181217 Vali Loss: 0.3799740 Test Loss: 0.1438441
EarlyStopping counter: 2 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.2972588
	speed: 0.0360s/iter; left time: 816.2075s
	iters: 200, epoch: 11 | loss: 0.6657328
	speed: 0.0102s/iter; left time: 229.6839s
	iters: 300, epoch: 11 | loss: 0.5154416
	speed: 0.0090s/iter; left time: 202.5989s
	iters: 400, epoch: 11 | loss: 0.2334789
	speed: 0.0099s/iter; left time: 222.1015s
	iters: 500, epoch: 11 | loss: 0.2500650
	speed: 0.0110s/iter; left time: 244.0325s
	iters: 600, epoch: 11 | loss: 0.1613859
	speed: 0.0102s/iter; left time: 225.8093s
	iters: 700, epoch: 11 | loss: 0.5236106
	speed: 0.0094s/iter; left time: 206.9616s
	iters: 800, epoch: 11 | loss: 0.2260411
	speed: 0.0073s/iter; left time: 161.4141s
	iters: 900, epoch: 11 | loss: 0.2789584
	speed: 0.0091s/iter; left time: 199.7533s
	iters: 1000, epoch: 11 | loss: 0.3044741
	speed: 0.0081s/iter; left time: 176.9267s
	iters: 1100, epoch: 11 | loss: 0.3365197
	speed: 0.0090s/iter; left time: 194.6999s
	iters: 1200, epoch: 11 | loss: 0.5114877
	speed: 0.0103s/iter; left time: 222.3647s
	iters: 1300, epoch: 11 | loss: 0.2360414
	speed: 0.0094s/iter; left time: 201.0812s
	iters: 1400, epoch: 11 | loss: 0.1951804
	speed: 0.0095s/iter; left time: 202.6850s
	iters: 1500, epoch: 11 | loss: 0.4340818
	speed: 0.0090s/iter; left time: 191.9625s
	iters: 1600, epoch: 11 | loss: 0.3185745
	speed: 0.0100s/iter; left time: 212.7101s
	iters: 1700, epoch: 11 | loss: 0.3485387
	speed: 0.0098s/iter; left time: 206.9675s
	iters: 1800, epoch: 11 | loss: 0.3718749
	speed: 0.0086s/iter; left time: 179.4005s
	iters: 1900, epoch: 11 | loss: 0.2402203
	speed: 0.0089s/iter; left time: 185.0619s
	iters: 2000, epoch: 11 | loss: 0.2667106
	speed: 0.0106s/iter; left time: 220.8796s
	iters: 2100, epoch: 11 | loss: 0.3265463
	speed: 0.0112s/iter; left time: 230.9040s
	iters: 2200, epoch: 11 | loss: 0.2007054
	speed: 0.0104s/iter; left time: 213.6821s
Epoch: 11 cost time: 21.823577642440796
Epoch: 11, Steps: 2278 | Train Loss: 0.5029134 Vali Loss: 0.3791654 Test Loss: 0.1432575
EarlyStopping counter: 3 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.4242472
	speed: 0.0431s/iter; left time: 879.5291s
	iters: 200, epoch: 12 | loss: 0.2858890
	speed: 0.0093s/iter; left time: 189.2636s
	iters: 300, epoch: 12 | loss: 0.2254063
	speed: 0.0097s/iter; left time: 196.4508s
	iters: 400, epoch: 12 | loss: 0.3364257
	speed: 0.0100s/iter; left time: 201.8738s
	iters: 500, epoch: 12 | loss: 0.3415967
	speed: 0.0114s/iter; left time: 228.4414s
	iters: 600, epoch: 12 | loss: 0.3510209
	speed: 0.0110s/iter; left time: 219.7781s
	iters: 700, epoch: 12 | loss: 0.1825766
	speed: 0.0101s/iter; left time: 199.1023s
	iters: 800, epoch: 12 | loss: 0.2697856
	speed: 0.0102s/iter; left time: 200.0486s
	iters: 900, epoch: 12 | loss: 0.2234780
	speed: 0.0100s/iter; left time: 195.6948s
	iters: 1000, epoch: 12 | loss: 0.2482616
	speed: 0.0093s/iter; left time: 182.2004s
	iters: 1100, epoch: 12 | loss: 0.2451812
	speed: 0.0088s/iter; left time: 170.9957s
	iters: 1200, epoch: 12 | loss: 2.6231821
	speed: 0.0091s/iter; left time: 176.0850s
	iters: 1300, epoch: 12 | loss: 0.4666981
	speed: 0.0097s/iter; left time: 185.7057s
	iters: 1400, epoch: 12 | loss: 0.4280926
	speed: 0.0084s/iter; left time: 161.2860s
	iters: 1500, epoch: 12 | loss: 0.3163131
	speed: 0.0096s/iter; left time: 182.9940s
	iters: 1600, epoch: 12 | loss: 0.3489380
	speed: 0.0091s/iter; left time: 172.6288s
	iters: 1700, epoch: 12 | loss: 0.2704302
	speed: 0.0073s/iter; left time: 137.7000s
	iters: 1800, epoch: 12 | loss: 0.3725492
	speed: 0.0089s/iter; left time: 165.9745s
	iters: 1900, epoch: 12 | loss: 0.3714722
	speed: 0.0096s/iter; left time: 178.6458s
	iters: 2000, epoch: 12 | loss: 0.2593654
	speed: 0.0088s/iter; left time: 163.2361s
	iters: 2100, epoch: 12 | loss: 0.3685215
	speed: 0.0107s/iter; left time: 196.2280s
	iters: 2200, epoch: 12 | loss: 0.2862364
	speed: 0.0115s/iter; left time: 210.8994s
Epoch: 12 cost time: 22.089476823806763
Epoch: 12, Steps: 2278 | Train Loss: 0.4959062 Vali Loss: 0.3780001 Test Loss: 0.1434003
EarlyStopping counter: 4 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.3719442
	speed: 0.0388s/iter; left time: 703.9768s
	iters: 200, epoch: 13 | loss: 0.2794103
	speed: 0.0098s/iter; left time: 176.3184s
	iters: 300, epoch: 13 | loss: 0.3632336
	speed: 0.0095s/iter; left time: 170.7178s
	iters: 400, epoch: 13 | loss: 0.1624562
	speed: 0.0100s/iter; left time: 177.9016s
	iters: 500, epoch: 13 | loss: 0.2833761
	speed: 0.0096s/iter; left time: 169.5837s
	iters: 600, epoch: 13 | loss: 0.4641839
	speed: 0.0102s/iter; left time: 178.9326s
	iters: 700, epoch: 13 | loss: 0.2097910
	speed: 0.0098s/iter; left time: 171.6129s
	iters: 800, epoch: 13 | loss: 0.4975217
	speed: 0.0104s/iter; left time: 181.6125s
	iters: 900, epoch: 13 | loss: 0.2450139
	speed: 0.0098s/iter; left time: 170.5423s
	iters: 1000, epoch: 13 | loss: 0.1968346
	speed: 0.0090s/iter; left time: 154.8752s
	iters: 1100, epoch: 13 | loss: 0.3041581
	speed: 0.0103s/iter; left time: 175.7310s
	iters: 1200, epoch: 13 | loss: 0.4992395
	speed: 0.0088s/iter; left time: 150.2018s
	iters: 1300, epoch: 13 | loss: 0.3885121
	speed: 0.0081s/iter; left time: 137.4851s
	iters: 1400, epoch: 13 | loss: 0.3471172
	speed: 0.0090s/iter; left time: 150.9250s
	iters: 1500, epoch: 13 | loss: 0.2478387
	speed: 0.0074s/iter; left time: 124.3071s
	iters: 1600, epoch: 13 | loss: 0.1955579
	speed: 0.0092s/iter; left time: 152.4745s
	iters: 1700, epoch: 13 | loss: 2.2525070
	speed: 0.0095s/iter; left time: 157.1895s
	iters: 1800, epoch: 13 | loss: 0.3620364
	speed: 0.0096s/iter; left time: 158.0368s
	iters: 1900, epoch: 13 | loss: 0.2768931
	speed: 0.0081s/iter; left time: 132.2397s
	iters: 2000, epoch: 13 | loss: 0.3231280
	speed: 0.0094s/iter; left time: 152.0958s
	iters: 2100, epoch: 13 | loss: 0.1575920
	speed: 0.0100s/iter; left time: 161.9240s
	iters: 2200, epoch: 13 | loss: 0.2460901
	speed: 0.0095s/iter; left time: 152.5895s
Epoch: 13 cost time: 21.50526452064514
Epoch: 13, Steps: 2278 | Train Loss: 0.4926973 Vali Loss: 0.3779532 Test Loss: 0.1434211
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : weather_336_96_NLinear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15227<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
mse:0.1438259780406952, mae:0.19348293542861938
