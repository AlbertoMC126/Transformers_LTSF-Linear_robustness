Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='Linear', model_id='traffic_336_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=336, root_path='./dataset/', save_pred_values=False, seed=3293, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_336_336_Linear_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3293>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11609
val 1421
test 3173
	iters: 100, epoch: 1 | loss: 0.4878629
	speed: 0.3237s/iter; left time: 4660.9205s
	iters: 200, epoch: 1 | loss: 0.4580836
	speed: 0.3092s/iter; left time: 4421.4092s
	iters: 300, epoch: 1 | loss: 0.4990270
	speed: 0.3069s/iter; left time: 4358.4926s
	iters: 400, epoch: 1 | loss: 0.4718299
	speed: 0.3072s/iter; left time: 4332.1076s
	iters: 500, epoch: 1 | loss: 0.4646052
	speed: 0.3076s/iter; left time: 4306.7019s
	iters: 600, epoch: 1 | loss: 0.4973448
	speed: 0.3080s/iter; left time: 4280.8955s
	iters: 700, epoch: 1 | loss: 0.5093850
	speed: 0.3077s/iter; left time: 4246.5623s
Epoch: 1 cost time: 224.84923386573792
Epoch: 1, Steps: 725 | Train Loss: 0.4954368 Vali Loss: 0.6434928 Test Loss: 0.7743238
Validation loss decreased (inf --> 0.643493).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.4781898
	speed: 0.6078s/iter; left time: 8312.4918s
	iters: 200, epoch: 2 | loss: 0.4722596
	speed: 0.3064s/iter; left time: 4160.0721s
	iters: 300, epoch: 2 | loss: 0.4812486
	speed: 0.3062s/iter; left time: 4126.9141s
	iters: 400, epoch: 2 | loss: 0.4481124
	speed: 0.3096s/iter; left time: 4141.2926s
	iters: 500, epoch: 2 | loss: 0.4703574
	speed: 0.3092s/iter; left time: 4104.8939s
	iters: 600, epoch: 2 | loss: 0.4427413
	speed: 0.3076s/iter; left time: 4053.0918s
	iters: 700, epoch: 2 | loss: 0.5035191
	speed: 0.3077s/iter; left time: 4023.9873s
Epoch: 2 cost time: 223.32940554618835
Epoch: 2, Steps: 725 | Train Loss: 0.4842939 Vali Loss: 0.6562345 Test Loss: 0.7840710
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.3116854
	speed: 0.6021s/iter; left time: 7798.1571s
	iters: 200, epoch: 3 | loss: 0.3442370
	speed: 0.3080s/iter; left time: 3958.6583s
	iters: 300, epoch: 3 | loss: 0.3256136
	speed: 0.3068s/iter; left time: 3912.5954s
	iters: 400, epoch: 3 | loss: 0.3687679
	speed: 0.3079s/iter; left time: 3894.7730s
	iters: 500, epoch: 3 | loss: 0.3518783
	speed: 0.3075s/iter; left time: 3859.6476s
	iters: 600, epoch: 3 | loss: 0.3590966
	speed: 0.3107s/iter; left time: 3868.2147s
	iters: 700, epoch: 3 | loss: 0.3404208
	speed: 0.3089s/iter; left time: 3815.5979s
Epoch: 3 cost time: 223.32606267929077
Epoch: 3, Steps: 725 | Train Loss: 0.3428190 Vali Loss: 0.4713469 Test Loss: 0.5705990
Validation loss decreased (0.643493 --> 0.471347).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.2874096
	speed: 0.6129s/iter; left time: 7493.4062s
	iters: 200, epoch: 4 | loss: 0.3228392
	speed: 0.3104s/iter; left time: 3764.3956s
	iters: 300, epoch: 4 | loss: 0.2905282
	speed: 0.3082s/iter; left time: 3706.9020s
	iters: 400, epoch: 4 | loss: 0.2818248
	speed: 0.3089s/iter; left time: 3684.5139s
	iters: 500, epoch: 4 | loss: 0.2933675
	speed: 0.3089s/iter; left time: 3653.1017s
	iters: 600, epoch: 4 | loss: 0.2745614
	speed: 0.3088s/iter; left time: 3620.6441s
	iters: 700, epoch: 4 | loss: 0.2797740
	speed: 0.3088s/iter; left time: 3590.4570s
Epoch: 4 cost time: 224.2831470966339
Epoch: 4, Steps: 725 | Train Loss: 0.2937884 Vali Loss: 0.4167800 Test Loss: 0.5096483
Validation loss decreased (0.471347 --> 0.416780).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.2423288
	speed: 0.6092s/iter; left time: 7005.8507s
	iters: 200, epoch: 5 | loss: 0.2733854
	speed: 0.3086s/iter; left time: 3518.8477s
	iters: 300, epoch: 5 | loss: 0.2801799
	speed: 0.3114s/iter; left time: 3519.0885s
	iters: 400, epoch: 5 | loss: 0.2699168
	speed: 0.3091s/iter; left time: 3462.5180s
	iters: 500, epoch: 5 | loss: 0.2658695
	speed: 0.3083s/iter; left time: 3422.0797s
	iters: 600, epoch: 5 | loss: 0.2702114
	speed: 0.3081s/iter; left time: 3389.3001s
	iters: 700, epoch: 5 | loss: 0.2804429
	speed: 0.3070s/iter; left time: 3346.6050s
Epoch: 5 cost time: 223.9253635406494
Epoch: 5, Steps: 725 | Train Loss: 0.2724201 Vali Loss: 0.3924633 Test Loss: 0.4793795
Validation loss decreased (0.416780 --> 0.392463).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.2461166
	speed: 0.6090s/iter; left time: 6562.9687s
	iters: 200, epoch: 6 | loss: 0.2759944
	speed: 0.3080s/iter; left time: 3288.5988s
	iters: 300, epoch: 6 | loss: 0.2613176
	speed: 0.3086s/iter; left time: 3263.9986s
	iters: 400, epoch: 6 | loss: 0.2757814
	speed: 0.3079s/iter; left time: 3225.7114s
	iters: 500, epoch: 6 | loss: 0.2983180
	speed: 0.3094s/iter; left time: 3210.6138s
	iters: 600, epoch: 6 | loss: 0.2646976
	speed: 0.3067s/iter; left time: 3152.0866s
	iters: 700, epoch: 6 | loss: 0.2835409
	speed: 0.3096s/iter; left time: 3150.3460s
Epoch: 6 cost time: 223.65896153450012
Epoch: 6, Steps: 725 | Train Loss: 0.2612560 Vali Loss: 0.3810737 Test Loss: 0.4655995
Validation loss decreased (0.392463 --> 0.381074).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.2590953
	speed: 0.6128s/iter; left time: 6158.9375s
	iters: 200, epoch: 7 | loss: 0.2573773
	speed: 0.3074s/iter; left time: 3059.2750s
	iters: 300, epoch: 7 | loss: 0.2664963
	speed: 0.3087s/iter; left time: 3041.1938s
	iters: 400, epoch: 7 | loss: 0.2637536
	speed: 0.3080s/iter; left time: 3002.8899s
	iters: 500, epoch: 7 | loss: 0.2384807
	speed: 0.3077s/iter; left time: 2969.9581s
	iters: 600, epoch: 7 | loss: 0.2738081
	speed: 0.3094s/iter; left time: 2955.4890s
	iters: 700, epoch: 7 | loss: 0.2487043
	speed: 0.3096s/iter; left time: 2926.1332s
Epoch: 7 cost time: 223.95171451568604
Epoch: 7, Steps: 725 | Train Loss: 0.2551961 Vali Loss: 0.3751333 Test Loss: 0.4588443
Validation loss decreased (0.381074 --> 0.375133).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.2512804
	speed: 0.6117s/iter; left time: 5704.5092s
	iters: 200, epoch: 8 | loss: 0.2295944
	speed: 0.3105s/iter; left time: 2864.7634s
	iters: 300, epoch: 8 | loss: 0.2700708
	speed: 0.3090s/iter; left time: 2820.2681s
	iters: 400, epoch: 8 | loss: 0.2467756
	speed: 0.3087s/iter; left time: 2786.5198s
	iters: 500, epoch: 8 | loss: 0.2608741
	speed: 0.3084s/iter; left time: 2752.9322s
	iters: 600, epoch: 8 | loss: 0.2656491
	speed: 0.3093s/iter; left time: 2729.6859s
	iters: 700, epoch: 8 | loss: 0.2555417
	speed: 0.3069s/iter; left time: 2678.0653s
Epoch: 8 cost time: 224.1425449848175
Epoch: 8, Steps: 725 | Train Loss: 0.2518700 Vali Loss: 0.3734191 Test Loss: 0.4559366
Validation loss decreased (0.375133 --> 0.373419).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.2572411
	speed: 0.6112s/iter; left time: 5256.7018s
	iters: 200, epoch: 9 | loss: 0.2438050
	speed: 0.3106s/iter; left time: 2640.7077s
	iters: 300, epoch: 9 | loss: 0.2332092
	speed: 0.3094s/iter; left time: 2599.2682s
	iters: 400, epoch: 9 | loss: 0.2479884
	speed: 0.3080s/iter; left time: 2556.4572s
	iters: 500, epoch: 9 | loss: 0.2451617
	speed: 0.3085s/iter; left time: 2529.9186s
	iters: 600, epoch: 9 | loss: 0.2249818
	speed: 0.3089s/iter; left time: 2502.3016s
	iters: 700, epoch: 9 | loss: 0.2699172
	speed: 0.3076s/iter; left time: 2461.1395s
Epoch: 9 cost time: 224.12574076652527
Epoch: 9, Steps: 725 | Train Loss: 0.2500757 Vali Loss: 0.3719395 Test Loss: 0.4544099
Validation loss decreased (0.373419 --> 0.371940).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.2546926
	speed: 0.6133s/iter; left time: 4830.4536s
	iters: 200, epoch: 10 | loss: 0.2295685
	speed: 0.3097s/iter; left time: 2407.8743s
	iters: 300, epoch: 10 | loss: 0.2553883
	speed: 0.3090s/iter; left time: 2372.2134s
	iters: 400, epoch: 10 | loss: 0.2784456
	speed: 0.3099s/iter; left time: 2347.8770s
	iters: 500, epoch: 10 | loss: 0.2404553
	speed: 0.3093s/iter; left time: 2311.9533s
	iters: 600, epoch: 10 | loss: 0.2446819
	speed: 0.3071s/iter; left time: 2264.9193s
	iters: 700, epoch: 10 | loss: 0.2547861
	speed: 0.3081s/iter; left time: 2241.8114s
Epoch: 10 cost time: 224.18982768058777
Epoch: 10, Steps: 725 | Train Loss: 0.2490811 Vali Loss: 0.3713914 Test Loss: 0.4537633
Validation loss decreased (0.371940 --> 0.371391).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.2336192
	speed: 0.6120s/iter; left time: 4376.5328s
	iters: 200, epoch: 11 | loss: 0.2638937
	speed: 0.3115s/iter; left time: 2196.1732s
	iters: 300, epoch: 11 | loss: 0.2574284
	speed: 0.3108s/iter; left time: 2160.6730s
	iters: 400, epoch: 11 | loss: 0.2418133
	speed: 0.3109s/iter; left time: 2129.6757s
	iters: 500, epoch: 11 | loss: 0.2747366
	speed: 0.3096s/iter; left time: 2090.2455s
	iters: 600, epoch: 11 | loss: 0.2196520
	speed: 0.3115s/iter; left time: 2071.6508s
	iters: 700, epoch: 11 | loss: 0.2511126
	speed: 0.3098s/iter; left time: 2029.6658s
Epoch: 11 cost time: 225.18940019607544
Epoch: 11, Steps: 725 | Train Loss: 0.2485512 Vali Loss: 0.3709863 Test Loss: 0.4535025
Validation loss decreased (0.371391 --> 0.370986).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.2634149
	speed: 0.6138s/iter; left time: 3943.9988s
	iters: 200, epoch: 12 | loss: 0.2430515
	speed: 0.3078s/iter; left time: 1946.9449s
	iters: 300, epoch: 12 | loss: 0.2787124
	speed: 0.3084s/iter; left time: 1920.1861s
	iters: 400, epoch: 12 | loss: 0.2398955
	speed: 0.3089s/iter; left time: 1892.3187s
	iters: 500, epoch: 12 | loss: 0.2713152
	speed: 0.3084s/iter; left time: 1858.1367s
	iters: 600, epoch: 12 | loss: 0.2652305
	speed: 0.3087s/iter; left time: 1829.6502s
	iters: 700, epoch: 12 | loss: 0.2577976
	speed: 0.3074s/iter; left time: 1790.8620s
Epoch: 12 cost time: 224.07261061668396
Epoch: 12, Steps: 725 | Train Loss: 0.2482518 Vali Loss: 0.3706390 Test Loss: 0.4533323
Validation loss decreased (0.370986 --> 0.370639).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.2480566
	speed: 0.6118s/iter; left time: 3487.8066s
	iters: 200, epoch: 13 | loss: 0.2472774
	speed: 0.3072s/iter; left time: 1720.8941s
	iters: 300, epoch: 13 | loss: 0.2267498
	speed: 0.3070s/iter; left time: 1688.7059s
	iters: 400, epoch: 13 | loss: 0.2448639
	speed: 0.3089s/iter; left time: 1668.2428s
	iters: 500, epoch: 13 | loss: 0.2364236
	speed: 0.3084s/iter; left time: 1634.6346s
	iters: 600, epoch: 13 | loss: 0.2580045
	speed: 0.3084s/iter; left time: 1604.1951s
	iters: 700, epoch: 13 | loss: 0.2401551
	speed: 0.3080s/iter; left time: 1571.0034s
Epoch: 13 cost time: 223.53131365776062
Epoch: 13, Steps: 725 | Train Loss: 0.2481082 Vali Loss: 0.3705922 Test Loss: 0.4532678
Validation loss decreased (0.370639 --> 0.370592).  Saving model ...
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 14 | loss: 0.2456766
	speed: 0.6107s/iter; left time: 3038.9615s
	iters: 200, epoch: 14 | loss: 0.2265946
	speed: 0.3098s/iter; left time: 1510.4709s
	iters: 300, epoch: 14 | loss: 0.2504705
	speed: 0.3097s/iter; left time: 1479.2663s
	iters: 400, epoch: 14 | loss: 0.2482857
	speed: 0.3097s/iter; left time: 1448.1467s
	iters: 500, epoch: 14 | loss: 0.2592116
	speed: 0.3111s/iter; left time: 1423.7276s
	iters: 600, epoch: 14 | loss: 0.2544793
	speed: 0.3105s/iter; left time: 1389.8951s
	iters: 700, epoch: 14 | loss: 0.2442349
	speed: 0.3089s/iter; left time: 1351.5502s
Epoch: 14 cost time: 224.81729936599731
Epoch: 14, Steps: 725 | Train Loss: 0.2479827 Vali Loss: 0.3706838 Test Loss: 0.4532563
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 15 | loss: 0.2576976
	speed: 0.6073s/iter; left time: 2581.5850s
	iters: 200, epoch: 15 | loss: 0.2620482
	speed: 0.3074s/iter; left time: 1275.9058s
	iters: 300, epoch: 15 | loss: 0.2325634
	speed: 0.3080s/iter; left time: 1247.9045s
	iters: 400, epoch: 15 | loss: 0.2818328
	speed: 0.3092s/iter; left time: 1221.7561s
	iters: 500, epoch: 15 | loss: 0.2534623
	speed: 0.3097s/iter; left time: 1192.5801s
	iters: 600, epoch: 15 | loss: 0.2334653
	speed: 0.3092s/iter; left time: 1159.6323s
	iters: 700, epoch: 15 | loss: 0.2497144
	speed: 0.3078s/iter; left time: 1123.6378s
Epoch: 15 cost time: 223.8073766231537
Epoch: 15, Steps: 725 | Train Loss: 0.2479789 Vali Loss: 0.3703407 Test Loss: 0.4532606
Validation loss decreased (0.370592 --> 0.370341).  Saving model ...
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 16 | loss: 0.2651565
	speed: 0.6106s/iter; left time: 2152.9187s
	iters: 200, epoch: 16 | loss: 0.2338582
	speed: 0.3113s/iter; left time: 1066.4740s
	iters: 300, epoch: 16 | loss: 0.2153435
	speed: 0.3103s/iter; left time: 1032.1320s
	iters: 400, epoch: 16 | loss: 0.2210169
	speed: 0.3080s/iter; left time: 993.6229s
	iters: 500, epoch: 16 | loss: 0.2709658
	speed: 0.3099s/iter; left time: 968.7782s
	iters: 600, epoch: 16 | loss: 0.2565135
	speed: 0.3097s/iter; left time: 937.1684s
	iters: 700, epoch: 16 | loss: 0.2365342
	speed: 0.3070s/iter; left time: 898.3610s
Epoch: 16 cost time: 224.32117080688477
Epoch: 16, Steps: 725 | Train Loss: 0.2479622 Vali Loss: 0.3706299 Test Loss: 0.4532577
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 17 | loss: 0.2693563
	speed: 0.6038s/iter; left time: 1691.3562s
	iters: 200, epoch: 17 | loss: 0.2276061
	speed: 0.3087s/iter; left time: 833.8418s
	iters: 300, epoch: 17 | loss: 0.2374500
	speed: 0.3106s/iter; left time: 807.8321s
	iters: 400, epoch: 17 | loss: 0.2337783
	speed: 0.3088s/iter; left time: 772.4125s
	iters: 500, epoch: 17 | loss: 0.2357867
	speed: 0.3087s/iter; left time: 741.2340s
	iters: 600, epoch: 17 | loss: 0.2469615
	speed: 0.3089s/iter; left time: 710.6720s
	iters: 700, epoch: 17 | loss: 0.2668180
	speed: 0.3101s/iter; left time: 682.4543s
Epoch: 17 cost time: 224.0484790802002
Epoch: 17, Steps: 725 | Train Loss: 0.2479356 Vali Loss: 0.3704101 Test Loss: 0.4532579
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 18 | loss: 0.2416323
	speed: 0.6064s/iter; left time: 1258.8820s
	iters: 200, epoch: 18 | loss: 0.2641014
	speed: 0.3082s/iter; left time: 609.0482s
	iters: 300, epoch: 18 | loss: 0.2438546
	speed: 0.3101s/iter; left time: 581.7986s
	iters: 400, epoch: 18 | loss: 0.2487279
	speed: 0.3090s/iter; left time: 548.8427s
	iters: 500, epoch: 18 | loss: 0.2505987
	speed: 0.3092s/iter; left time: 518.1854s
	iters: 600, epoch: 18 | loss: 0.2538353
	speed: 0.3101s/iter; left time: 488.6761s
	iters: 700, epoch: 18 | loss: 0.2510300
	speed: 0.3103s/iter; left time: 458.0600s
Epoch: 18 cost time: 224.32747530937195
Epoch: 18, Steps: 725 | Train Loss: 0.2479128 Vali Loss: 0.3706858 Test Loss: 0.4532581
EarlyStopping counter: 3 out of 5
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 19 | loss: 0.2488569
	speed: 0.6054s/iter; left time: 817.8608s
	iters: 200, epoch: 19 | loss: 0.2326219
	speed: 0.3097s/iter; left time: 387.4227s
	iters: 300, epoch: 19 | loss: 0.2730501
	speed: 0.3082s/iter; left time: 354.7283s
	iters: 400, epoch: 19 | loss: 0.2291028
	speed: 0.3075s/iter; left time: 323.1653s
	iters: 500, epoch: 19 | loss: 0.2766401
	speed: 0.3076s/iter; left time: 292.5142s
	iters: 600, epoch: 19 | loss: 0.2536233
	speed: 0.3093s/iter; left time: 263.2196s
	iters: 700, epoch: 19 | loss: 0.2364062
	speed: 0.3087s/iter; left time: 231.8090s
Epoch: 19 cost time: 223.6815574169159
Epoch: 19, Steps: 725 | Train Loss: 0.2479198 Vali Loss: 0.3703103 Test Loss: 0.4532580
Validation loss decreased (0.370341 --> 0.370310).  Saving model ...
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 20 | loss: 0.2744498
	speed: 0.6112s/iter; left time: 382.5844s
	iters: 200, epoch: 20 | loss: 0.2364263
	speed: 0.3100s/iter; left time: 163.0637s
	iters: 300, epoch: 20 | loss: 0.2228516
	speed: 0.3069s/iter; left time: 130.7400s
	iters: 400, epoch: 20 | loss: 0.2395751
	speed: 0.3080s/iter; left time: 100.4161s
	iters: 500, epoch: 20 | loss: 0.2678730
	speed: 0.3107s/iter; left time: 70.2082s
	iters: 600, epoch: 20 | loss: 0.2191116
	speed: 0.3071s/iter; left time: 38.6946s
	iters: 700, epoch: 20 | loss: 0.2531721
	speed: 0.3094s/iter; left time: 8.0454s
Epoch: 20 cost time: 224.01290321350098
Epoch: 20, Steps: 725 | Train Loss: 0.2478844 Vali Loss: 0.3708782 Test Loss: 0.4532580
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.9073486328125e-08
>>>>>>>testing : traffic_336_336_Linear_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3293<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3173
mse:0.4522858262062073, mae:0.3120015859603882
