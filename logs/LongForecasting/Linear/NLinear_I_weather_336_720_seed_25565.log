Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='NLinear', model_id='weather_336_720', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=720, root_path='./dataset/', save_pred_values=False, seed=25565, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : weather_336_720_NLinear_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed25565>>>>>>>>>>>>>>>>>>>>>>>>>>
train 35832
val 4551
test 9820
	iters: 100, epoch: 1 | loss: 0.5130424
	speed: 0.0539s/iter; left time: 2409.2817s
	iters: 200, epoch: 1 | loss: 0.7001735
	speed: 0.0467s/iter; left time: 2080.2765s
	iters: 300, epoch: 1 | loss: 0.6440532
	speed: 0.0526s/iter; left time: 2340.1437s
	iters: 400, epoch: 1 | loss: 5.2208252
	speed: 0.0540s/iter; left time: 2394.5270s
	iters: 500, epoch: 1 | loss: 0.7778209
	speed: 0.0519s/iter; left time: 2298.6175s
	iters: 600, epoch: 1 | loss: 0.5981484
	speed: 0.0467s/iter; left time: 2065.1256s
	iters: 700, epoch: 1 | loss: 0.7028012
	speed: 0.0517s/iter; left time: 2281.0820s
	iters: 800, epoch: 1 | loss: 1.9957716
	speed: 0.0478s/iter; left time: 2100.9112s
	iters: 900, epoch: 1 | loss: 1.3494968
	speed: 0.0452s/iter; left time: 1984.6357s
	iters: 1000, epoch: 1 | loss: 1.0062386
	speed: 0.0513s/iter; left time: 2244.0902s
	iters: 1100, epoch: 1 | loss: 0.6848718
	speed: 0.0513s/iter; left time: 2239.6687s
	iters: 1200, epoch: 1 | loss: 0.6071222
	speed: 0.0492s/iter; left time: 2143.5186s
	iters: 1300, epoch: 1 | loss: 4.5372286
	speed: 0.0509s/iter; left time: 2211.9553s
	iters: 1400, epoch: 1 | loss: 1.3079884
	speed: 0.0547s/iter; left time: 2371.6269s
	iters: 1500, epoch: 1 | loss: 0.6441984
	speed: 0.0463s/iter; left time: 2003.0058s
	iters: 1600, epoch: 1 | loss: 1.5686743
	speed: 0.0505s/iter; left time: 2181.0324s
	iters: 1700, epoch: 1 | loss: 0.9856095
	speed: 0.0491s/iter; left time: 2116.6295s
	iters: 1800, epoch: 1 | loss: 5.6212449
	speed: 0.0534s/iter; left time: 2295.7514s
	iters: 1900, epoch: 1 | loss: 0.6126958
	speed: 0.0510s/iter; left time: 2186.6686s
	iters: 2000, epoch: 1 | loss: 1.4361900
	speed: 0.0527s/iter; left time: 2252.5574s
	iters: 2100, epoch: 1 | loss: 3.8733597
	speed: 0.0468s/iter; left time: 1997.0490s
	iters: 2200, epoch: 1 | loss: 0.7491761
	speed: 0.0502s/iter; left time: 2137.9522s
Epoch: 1 cost time: 112.92980194091797
Epoch: 1, Steps: 2239 | Train Loss: 6.9061448 Vali Loss: 0.8831561 Test Loss: 0.4538109
Validation loss decreased (inf --> 0.883156).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.7282940
	speed: 0.1484s/iter; left time: 6298.1901s
	iters: 200, epoch: 2 | loss: 24.2810116
	speed: 0.0499s/iter; left time: 2114.2820s
	iters: 300, epoch: 2 | loss: 0.8281525
	speed: 0.0508s/iter; left time: 2146.1258s
	iters: 400, epoch: 2 | loss: 1.2249202
	speed: 0.0469s/iter; left time: 1976.6854s
	iters: 500, epoch: 2 | loss: 2.6863325
	speed: 0.0510s/iter; left time: 2145.7067s
	iters: 600, epoch: 2 | loss: 1.0761806
	speed: 0.0501s/iter; left time: 2099.9803s
	iters: 700, epoch: 2 | loss: 0.7302380
	speed: 0.0536s/iter; left time: 2241.2601s
	iters: 800, epoch: 2 | loss: 0.7164756
	speed: 0.0544s/iter; left time: 2270.1060s
	iters: 900, epoch: 2 | loss: 3.5503001
	speed: 0.0476s/iter; left time: 1981.8251s
	iters: 1000, epoch: 2 | loss: 0.6618124
	speed: 0.0567s/iter; left time: 2356.4736s
	iters: 1100, epoch: 2 | loss: 1.2646674
	speed: 0.0543s/iter; left time: 2250.8413s
	iters: 1200, epoch: 2 | loss: 0.7340568
	speed: 0.0545s/iter; left time: 2251.6677s
	iters: 1300, epoch: 2 | loss: 3.1933179
	speed: 0.0517s/iter; left time: 2131.5089s
	iters: 1400, epoch: 2 | loss: 2.4608080
	speed: 0.0500s/iter; left time: 2056.7883s
	iters: 1500, epoch: 2 | loss: 1.6488681
	speed: 0.0486s/iter; left time: 1993.8315s
	iters: 1600, epoch: 2 | loss: 0.6518746
	speed: 0.0532s/iter; left time: 2177.1668s
	iters: 1700, epoch: 2 | loss: 0.6622570
	speed: 0.0517s/iter; left time: 2110.6779s
	iters: 1800, epoch: 2 | loss: 3.2295482
	speed: 0.0542s/iter; left time: 2206.6675s
	iters: 1900, epoch: 2 | loss: 2.9069674
	speed: 0.0499s/iter; left time: 2029.4175s
	iters: 2000, epoch: 2 | loss: 3.0248890
	speed: 0.0526s/iter; left time: 2131.7021s
	iters: 2100, epoch: 2 | loss: 0.7916737
	speed: 0.0501s/iter; left time: 2026.4440s
	iters: 2200, epoch: 2 | loss: 0.9100206
	speed: 0.0522s/iter; left time: 2104.5991s
Epoch: 2 cost time: 114.30610513687134
Epoch: 2, Steps: 2239 | Train Loss: 41.0287251 Vali Loss: 0.8083563 Test Loss: 0.4078243
Validation loss decreased (0.883156 --> 0.808356).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.5732235
	speed: 0.1595s/iter; left time: 6412.7099s
	iters: 200, epoch: 3 | loss: 0.6511193
	speed: 0.0533s/iter; left time: 2138.2263s
	iters: 300, epoch: 3 | loss: 0.5168835
	speed: 0.0536s/iter; left time: 2143.5338s
	iters: 400, epoch: 3 | loss: 84311.7890625
	speed: 0.0518s/iter; left time: 2067.5555s
	iters: 500, epoch: 3 | loss: 0.6990404
	speed: 0.0541s/iter; left time: 2154.5912s
	iters: 600, epoch: 3 | loss: 5.2570715
	speed: 0.0540s/iter; left time: 2143.9684s
	iters: 700, epoch: 3 | loss: 0.7806720
	speed: 0.0534s/iter; left time: 2115.0944s
	iters: 800, epoch: 3 | loss: 0.5389054
	speed: 0.0495s/iter; left time: 1955.1936s
	iters: 900, epoch: 3 | loss: 1.5005064
	speed: 0.0545s/iter; left time: 2145.9345s
	iters: 1000, epoch: 3 | loss: 0.7140092
	speed: 0.0509s/iter; left time: 2001.2556s
	iters: 1100, epoch: 3 | loss: 0.4991135
	speed: 0.0532s/iter; left time: 2086.0005s
	iters: 1200, epoch: 3 | loss: 0.5967977
	speed: 0.0528s/iter; left time: 2065.6409s
	iters: 1300, epoch: 3 | loss: 1.4429114
	speed: 0.0576s/iter; left time: 2245.5221s
	iters: 1400, epoch: 3 | loss: 0.9661821
	speed: 0.0478s/iter; left time: 1859.1670s
	iters: 1500, epoch: 3 | loss: 10.5899582
	speed: 0.0545s/iter; left time: 2113.8642s
	iters: 1600, epoch: 3 | loss: 0.5819614
	speed: 0.0523s/iter; left time: 2024.8433s
	iters: 1700, epoch: 3 | loss: 1.4065222
	speed: 0.0529s/iter; left time: 2043.6302s
	iters: 1800, epoch: 3 | loss: 0.5427131
	speed: 0.0540s/iter; left time: 2080.2378s
	iters: 1900, epoch: 3 | loss: 0.6681694
	speed: 0.0515s/iter; left time: 1976.6817s
	iters: 2000, epoch: 3 | loss: 0.7370644
	speed: 0.0489s/iter; left time: 1874.3249s
	iters: 2100, epoch: 3 | loss: 0.7740045
	speed: 0.0466s/iter; left time: 1780.6095s
	iters: 2200, epoch: 3 | loss: 0.6066173
	speed: 0.0445s/iter; left time: 1693.8535s
Epoch: 3 cost time: 115.654794216156
Epoch: 3, Steps: 2239 | Train Loss: 38.6457218 Vali Loss: 0.7031554 Test Loss: 0.3528977
Validation loss decreased (0.808356 --> 0.703155).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.8452086
	speed: 0.1485s/iter; left time: 5639.2775s
	iters: 200, epoch: 4 | loss: 0.5656702
	speed: 0.0527s/iter; left time: 1995.3568s
	iters: 300, epoch: 4 | loss: 1.0138402
	speed: 0.0495s/iter; left time: 1869.4089s
	iters: 400, epoch: 4 | loss: 0.6321728
	speed: 0.0553s/iter; left time: 2083.3478s
	iters: 500, epoch: 4 | loss: 0.4660131
	speed: 0.0546s/iter; left time: 2050.9388s
	iters: 600, epoch: 4 | loss: 1.3136992
	speed: 0.0539s/iter; left time: 2017.8098s
	iters: 700, epoch: 4 | loss: 0.8510709
	speed: 0.0515s/iter; left time: 1923.4167s
	iters: 800, epoch: 4 | loss: 0.7873117
	speed: 0.0449s/iter; left time: 1673.8794s
	iters: 900, epoch: 4 | loss: 1.5328065
	speed: 0.0536s/iter; left time: 1992.9589s
	iters: 1000, epoch: 4 | loss: 0.5555245
	speed: 0.0511s/iter; left time: 1894.1638s
	iters: 1100, epoch: 4 | loss: 0.4427022
	speed: 0.0536s/iter; left time: 1979.8307s
	iters: 1200, epoch: 4 | loss: 0.4703152
	speed: 0.0522s/iter; left time: 1925.4067s
	iters: 1300, epoch: 4 | loss: 0.8980283
	speed: 0.0477s/iter; left time: 1753.0835s
	iters: 1400, epoch: 4 | loss: 0.8155510
	speed: 0.0519s/iter; left time: 1902.5187s
	iters: 1500, epoch: 4 | loss: 0.4643695
	speed: 0.0520s/iter; left time: 1900.5156s
	iters: 1600, epoch: 4 | loss: 0.6213428
	speed: 0.0476s/iter; left time: 1735.9869s
	iters: 1700, epoch: 4 | loss: 1.1484097
	speed: 0.0542s/iter; left time: 1970.7733s
	iters: 1800, epoch: 4 | loss: 0.5331383
	speed: 0.0530s/iter; left time: 1921.9068s
	iters: 1900, epoch: 4 | loss: 0.6268125
	speed: 0.0478s/iter; left time: 1727.6786s
	iters: 2000, epoch: 4 | loss: 0.6127414
	speed: 0.0501s/iter; left time: 1808.3507s
	iters: 2100, epoch: 4 | loss: 0.5174981
	speed: 0.0505s/iter; left time: 1814.8671s
	iters: 2200, epoch: 4 | loss: 0.5475597
	speed: 0.0481s/iter; left time: 1724.3328s
Epoch: 4 cost time: 113.86953926086426
Epoch: 4, Steps: 2239 | Train Loss: 4.6525496 Vali Loss: 0.6767439 Test Loss: 0.3341101
Validation loss decreased (0.703155 --> 0.676744).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.6177964
	speed: 0.1639s/iter; left time: 5854.6555s
	iters: 200, epoch: 5 | loss: 1.0086573
	speed: 0.0490s/iter; left time: 1744.5391s
	iters: 300, epoch: 5 | loss: 0.5312124
	speed: 0.0528s/iter; left time: 1876.5301s
	iters: 400, epoch: 5 | loss: 0.4723841
	speed: 0.0515s/iter; left time: 1823.8940s
	iters: 500, epoch: 5 | loss: 0.5217825
	speed: 0.0508s/iter; left time: 1795.7498s
	iters: 600, epoch: 5 | loss: 0.5991741
	speed: 0.0553s/iter; left time: 1946.2252s
	iters: 700, epoch: 5 | loss: 0.7981769
	speed: 0.0483s/iter; left time: 1695.9005s
	iters: 800, epoch: 5 | loss: 0.7676297
	speed: 0.0500s/iter; left time: 1751.6446s
	iters: 900, epoch: 5 | loss: 0.5301589
	speed: 0.0531s/iter; left time: 1854.7081s
	iters: 1000, epoch: 5 | loss: 0.5494672
	speed: 0.0514s/iter; left time: 1788.7233s
	iters: 1100, epoch: 5 | loss: 0.5641301
	speed: 0.0544s/iter; left time: 1889.8184s
	iters: 1200, epoch: 5 | loss: 0.6792115
	speed: 0.0499s/iter; left time: 1727.1618s
	iters: 1300, epoch: 5 | loss: 0.5579593
	speed: 0.0521s/iter; left time: 1798.1145s
	iters: 1400, epoch: 5 | loss: 0.6930249
	speed: 0.0529s/iter; left time: 1821.7896s
	iters: 1500, epoch: 5 | loss: 2.0815682
	speed: 0.0481s/iter; left time: 1650.1324s
	iters: 1600, epoch: 5 | loss: 0.7824004
	speed: 0.0511s/iter; left time: 1748.3645s
	iters: 1700, epoch: 5 | loss: 0.4887082
	speed: 0.0507s/iter; left time: 1730.6014s
	iters: 1800, epoch: 5 | loss: 1.2470106
	speed: 0.0544s/iter; left time: 1850.2799s
	iters: 1900, epoch: 5 | loss: 0.4229141
	speed: 0.0468s/iter; left time: 1586.2271s
	iters: 2000, epoch: 5 | loss: 0.9534929
	speed: 0.0508s/iter; left time: 1719.3322s
	iters: 2100, epoch: 5 | loss: 0.5249392
	speed: 0.0511s/iter; left time: 1724.0279s
	iters: 2200, epoch: 5 | loss: 0.5839055
	speed: 0.0419s/iter; left time: 1409.6103s
Epoch: 5 cost time: 113.34501123428345
Epoch: 5, Steps: 2239 | Train Loss: 1.3584382 Vali Loss: 0.6639551 Test Loss: 0.3274831
Validation loss decreased (0.676744 --> 0.663955).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.7882209
	speed: 0.1544s/iter; left time: 5171.5360s
	iters: 200, epoch: 6 | loss: 0.5139984
	speed: 0.0555s/iter; left time: 1851.6627s
	iters: 300, epoch: 6 | loss: 0.4533677
	speed: 0.0576s/iter; left time: 1917.9363s
	iters: 400, epoch: 6 | loss: 0.5141781
	speed: 0.0516s/iter; left time: 1711.5573s
	iters: 500, epoch: 6 | loss: 0.5113117
	speed: 0.0530s/iter; left time: 1754.7462s
	iters: 600, epoch: 6 | loss: 0.6341758
	speed: 0.0521s/iter; left time: 1718.8739s
	iters: 700, epoch: 6 | loss: 0.5281083
	speed: 0.0480s/iter; left time: 1577.6658s
	iters: 800, epoch: 6 | loss: 0.5031587
	speed: 0.0471s/iter; left time: 1545.7495s
	iters: 900, epoch: 6 | loss: 0.5907030
	speed: 0.0487s/iter; left time: 1592.8729s
	iters: 1000, epoch: 6 | loss: 0.8145213
	speed: 0.0494s/iter; left time: 1609.4984s
	iters: 1100, epoch: 6 | loss: 0.7173106
	speed: 0.0529s/iter; left time: 1719.5877s
	iters: 1200, epoch: 6 | loss: 0.5006766
	speed: 0.0527s/iter; left time: 1706.4046s
	iters: 1300, epoch: 6 | loss: 0.6598945
	speed: 0.0514s/iter; left time: 1658.8182s
	iters: 1400, epoch: 6 | loss: 0.6505527
	speed: 0.0536s/iter; left time: 1725.3535s
	iters: 1500, epoch: 6 | loss: 0.7099448
	speed: 0.0515s/iter; left time: 1652.4151s
	iters: 1600, epoch: 6 | loss: 1.3086740
	speed: 0.0484s/iter; left time: 1548.3472s
	iters: 1700, epoch: 6 | loss: 0.4821674
	speed: 0.0493s/iter; left time: 1570.7741s
	iters: 1800, epoch: 6 | loss: 0.5278748
	speed: 0.0491s/iter; left time: 1560.5486s
	iters: 1900, epoch: 6 | loss: 2.0329199
	speed: 0.0513s/iter; left time: 1626.7521s
	iters: 2000, epoch: 6 | loss: 0.9010870
	speed: 0.0469s/iter; left time: 1482.3371s
	iters: 2100, epoch: 6 | loss: 0.5675496
	speed: 0.0544s/iter; left time: 1711.6306s
	iters: 2200, epoch: 6 | loss: 1.7394825
	speed: 0.0445s/iter; left time: 1397.8652s
Epoch: 6 cost time: 113.49601578712463
Epoch: 6, Steps: 2239 | Train Loss: 0.9355117 Vali Loss: 0.6582326 Test Loss: 0.3216796
Validation loss decreased (0.663955 --> 0.658233).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 1.8353697
	speed: 0.1627s/iter; left time: 5084.3598s
	iters: 200, epoch: 7 | loss: 0.5238361
	speed: 0.0520s/iter; left time: 1618.9785s
	iters: 300, epoch: 7 | loss: 0.8278801
	speed: 0.0479s/iter; left time: 1487.6749s
	iters: 400, epoch: 7 | loss: 0.6964380
	speed: 0.0520s/iter; left time: 1607.9251s
	iters: 500, epoch: 7 | loss: 0.5019698
	speed: 0.0519s/iter; left time: 1602.2236s
	iters: 600, epoch: 7 | loss: 2.3206923
	speed: 0.0526s/iter; left time: 1616.7204s
	iters: 700, epoch: 7 | loss: 0.8191034
	speed: 0.0524s/iter; left time: 1606.6290s
	iters: 800, epoch: 7 | loss: 0.6713288
	speed: 0.0504s/iter; left time: 1539.1691s
	iters: 900, epoch: 7 | loss: 0.5446783
	speed: 0.0521s/iter; left time: 1587.4214s
	iters: 1000, epoch: 7 | loss: 1.0631293
	speed: 0.0538s/iter; left time: 1632.6291s
	iters: 1100, epoch: 7 | loss: 1.7036707
	speed: 0.0506s/iter; left time: 1530.8001s
	iters: 1200, epoch: 7 | loss: 0.4648579
	speed: 0.0505s/iter; left time: 1523.5859s
	iters: 1300, epoch: 7 | loss: 1.7952665
	speed: 0.0522s/iter; left time: 1568.9607s
	iters: 1400, epoch: 7 | loss: 0.6147564
	speed: 0.0501s/iter; left time: 1501.8407s
	iters: 1500, epoch: 7 | loss: 1.0030285
	speed: 0.0527s/iter; left time: 1573.5884s
	iters: 1600, epoch: 7 | loss: 0.5255958
	speed: 0.0499s/iter; left time: 1484.1688s
	iters: 1700, epoch: 7 | loss: 0.5364460
	speed: 0.0525s/iter; left time: 1555.4328s
	iters: 1800, epoch: 7 | loss: 0.7851492
	speed: 0.0483s/iter; left time: 1426.5422s
	iters: 1900, epoch: 7 | loss: 0.4879173
	speed: 0.0470s/iter; left time: 1383.0725s
	iters: 2000, epoch: 7 | loss: 0.4269727
	speed: 0.0501s/iter; left time: 1469.2929s
	iters: 2100, epoch: 7 | loss: 0.5003127
	speed: 0.0474s/iter; left time: 1385.5588s
	iters: 2200, epoch: 7 | loss: 0.5292577
	speed: 0.0413s/iter; left time: 1203.1217s
Epoch: 7 cost time: 112.61480736732483
Epoch: 7, Steps: 2239 | Train Loss: 0.7943323 Vali Loss: 0.6492797 Test Loss: 0.3192412
Validation loss decreased (0.658233 --> 0.649280).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 1.2952697
	speed: 0.1674s/iter; left time: 4856.7002s
	iters: 200, epoch: 8 | loss: 1.5701605
	speed: 0.0485s/iter; left time: 1401.2689s
	iters: 300, epoch: 8 | loss: 0.4822989
	speed: 0.0502s/iter; left time: 1446.8116s
	iters: 400, epoch: 8 | loss: 0.9915634
	speed: 0.0451s/iter; left time: 1294.4197s
	iters: 500, epoch: 8 | loss: 0.4706010
	speed: 0.0515s/iter; left time: 1473.9013s
	iters: 600, epoch: 8 | loss: 0.4065254
	speed: 0.0484s/iter; left time: 1378.3810s
	iters: 700, epoch: 8 | loss: 0.6965329
	speed: 0.0519s/iter; left time: 1475.5922s
	iters: 800, epoch: 8 | loss: 0.5217785
	speed: 0.0535s/iter; left time: 1514.8071s
	iters: 900, epoch: 8 | loss: 0.5420245
	speed: 0.0516s/iter; left time: 1455.0126s
	iters: 1000, epoch: 8 | loss: 0.7685594
	speed: 0.0511s/iter; left time: 1435.8491s
	iters: 1100, epoch: 8 | loss: 0.7777415
	speed: 0.0538s/iter; left time: 1506.5471s
	iters: 1200, epoch: 8 | loss: 0.6424117
	speed: 0.0516s/iter; left time: 1438.9796s
	iters: 1300, epoch: 8 | loss: 0.7493930
	speed: 0.0485s/iter; left time: 1349.4494s
	iters: 1400, epoch: 8 | loss: 0.5866326
	speed: 0.0484s/iter; left time: 1340.1312s
	iters: 1500, epoch: 8 | loss: 0.6095520
	speed: 0.0484s/iter; left time: 1335.7600s
	iters: 1600, epoch: 8 | loss: 0.4896749
	speed: 0.0500s/iter; left time: 1375.5473s
	iters: 1700, epoch: 8 | loss: 0.4431723
	speed: 0.0468s/iter; left time: 1283.4155s
	iters: 1800, epoch: 8 | loss: 0.3996638
	speed: 0.0522s/iter; left time: 1424.1343s
	iters: 1900, epoch: 8 | loss: 0.5068520
	speed: 0.0511s/iter; left time: 1390.7777s
	iters: 2000, epoch: 8 | loss: 0.7186587
	speed: 0.0532s/iter; left time: 1442.6704s
	iters: 2100, epoch: 8 | loss: 0.6561937
	speed: 0.0500s/iter; left time: 1349.1118s
	iters: 2200, epoch: 8 | loss: 0.5799733
	speed: 0.0411s/iter; left time: 1105.4734s
Epoch: 8 cost time: 111.52743434906006
Epoch: 8, Steps: 2239 | Train Loss: 0.7039799 Vali Loss: 0.6505349 Test Loss: 0.3195574
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.4246882
	speed: 0.1516s/iter; left time: 4058.5027s
	iters: 200, epoch: 9 | loss: 0.7607715
	speed: 0.0485s/iter; left time: 1292.6817s
	iters: 300, epoch: 9 | loss: 0.7778475
	speed: 0.0504s/iter; left time: 1337.9124s
	iters: 400, epoch: 9 | loss: 0.7290701
	speed: 0.0532s/iter; left time: 1408.9170s
	iters: 500, epoch: 9 | loss: 0.8000781
	speed: 0.0495s/iter; left time: 1305.6716s
	iters: 600, epoch: 9 | loss: 0.4911511
	speed: 0.0483s/iter; left time: 1268.6704s
	iters: 700, epoch: 9 | loss: 1.6226308
	speed: 0.0476s/iter; left time: 1246.7094s
	iters: 800, epoch: 9 | loss: 1.0722274
	speed: 0.0493s/iter; left time: 1285.1987s
	iters: 900, epoch: 9 | loss: 1.0412048
	speed: 0.0537s/iter; left time: 1395.5175s
	iters: 1000, epoch: 9 | loss: 0.4714009
	speed: 0.0512s/iter; left time: 1325.0102s
	iters: 1100, epoch: 9 | loss: 0.7144212
	speed: 0.0499s/iter; left time: 1285.0364s
	iters: 1200, epoch: 9 | loss: 0.4743290
	speed: 0.0526s/iter; left time: 1349.4448s
	iters: 1300, epoch: 9 | loss: 0.4144775
	speed: 0.0510s/iter; left time: 1304.6803s
	iters: 1400, epoch: 9 | loss: 0.4444039
	speed: 0.0539s/iter; left time: 1371.6420s
	iters: 1500, epoch: 9 | loss: 0.5130038
	speed: 0.0456s/iter; left time: 1156.9800s
	iters: 1600, epoch: 9 | loss: 0.7017082
	speed: 0.0490s/iter; left time: 1237.7581s
	iters: 1700, epoch: 9 | loss: 1.1348767
	speed: 0.0462s/iter; left time: 1163.6538s
	iters: 1800, epoch: 9 | loss: 0.6829628
	speed: 0.0514s/iter; left time: 1287.7821s
	iters: 1900, epoch: 9 | loss: 1.2058460
	speed: 0.0480s/iter; left time: 1198.9192s
	iters: 2000, epoch: 9 | loss: 0.4762313
	speed: 0.0512s/iter; left time: 1273.9666s
	iters: 2100, epoch: 9 | loss: 0.7554924
	speed: 0.0518s/iter; left time: 1283.4750s
	iters: 2200, epoch: 9 | loss: 0.5446278
	speed: 0.0491s/iter; left time: 1211.4669s
Epoch: 9 cost time: 111.2010760307312
Epoch: 9, Steps: 2239 | Train Loss: 0.6944763 Vali Loss: 0.6484454 Test Loss: 0.3186752
Validation loss decreased (0.649280 --> 0.648445).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.8200584
	speed: 0.1478s/iter; left time: 3625.5677s
	iters: 200, epoch: 10 | loss: 0.4866579
	speed: 0.0485s/iter; left time: 1184.0695s
	iters: 300, epoch: 10 | loss: 0.5688683
	speed: 0.0509s/iter; left time: 1238.2143s
	iters: 400, epoch: 10 | loss: 0.4894174
	speed: 0.0490s/iter; left time: 1188.0810s
	iters: 500, epoch: 10 | loss: 0.4221924
	speed: 0.0536s/iter; left time: 1293.9953s
	iters: 600, epoch: 10 | loss: 0.5643392
	speed: 0.0526s/iter; left time: 1263.0763s
	iters: 700, epoch: 10 | loss: 0.7974882
	speed: 0.0519s/iter; left time: 1242.6321s
	iters: 800, epoch: 10 | loss: 0.5273485
	speed: 0.0482s/iter; left time: 1148.0779s
	iters: 900, epoch: 10 | loss: 1.8347888
	speed: 0.0491s/iter; left time: 1165.9198s
	iters: 1000, epoch: 10 | loss: 0.9631761
	speed: 0.0505s/iter; left time: 1192.8799s
	iters: 1100, epoch: 10 | loss: 0.5499501
	speed: 0.0498s/iter; left time: 1171.1877s
	iters: 1200, epoch: 10 | loss: 0.8242279
	speed: 0.0573s/iter; left time: 1342.4920s
	iters: 1300, epoch: 10 | loss: 0.5172445
	speed: 0.0481s/iter; left time: 1121.7679s
	iters: 1400, epoch: 10 | loss: 0.5125819
	speed: 0.0569s/iter; left time: 1320.9054s
	iters: 1500, epoch: 10 | loss: 0.5018250
	speed: 0.0557s/iter; left time: 1287.3093s
	iters: 1600, epoch: 10 | loss: 0.7787575
	speed: 0.0557s/iter; left time: 1283.2715s
	iters: 1700, epoch: 10 | loss: 0.7597615
	speed: 0.0523s/iter; left time: 1198.5034s
	iters: 1800, epoch: 10 | loss: 0.4489711
	speed: 0.0525s/iter; left time: 1197.5113s
	iters: 1900, epoch: 10 | loss: 0.7522315
	speed: 0.0479s/iter; left time: 1088.5410s
	iters: 2000, epoch: 10 | loss: 2.3389566
	speed: 0.0525s/iter; left time: 1187.2808s
	iters: 2100, epoch: 10 | loss: 1.2777630
	speed: 0.0524s/iter; left time: 1179.5182s
	iters: 2200, epoch: 10 | loss: 0.4636163
	speed: 0.0433s/iter; left time: 970.8754s
Epoch: 10 cost time: 113.61330223083496
Epoch: 10, Steps: 2239 | Train Loss: 0.6899128 Vali Loss: 0.6461592 Test Loss: 0.3190782
Validation loss decreased (0.648445 --> 0.646159).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.4882872
	speed: 0.1444s/iter; left time: 3217.7225s
	iters: 200, epoch: 11 | loss: 0.6125965
	speed: 0.0471s/iter; left time: 1045.7159s
	iters: 300, epoch: 11 | loss: 0.7858082
	speed: 0.0507s/iter; left time: 1120.6068s
	iters: 400, epoch: 11 | loss: 0.4714502
	speed: 0.0513s/iter; left time: 1128.7468s
	iters: 500, epoch: 11 | loss: 0.5153738
	speed: 0.0532s/iter; left time: 1165.5586s
	iters: 600, epoch: 11 | loss: 0.9200579
	speed: 0.0534s/iter; left time: 1162.7231s
	iters: 700, epoch: 11 | loss: 0.5371872
	speed: 0.0496s/iter; left time: 1076.8375s
	iters: 800, epoch: 11 | loss: 0.7278291
	speed: 0.0528s/iter; left time: 1140.7702s
	iters: 900, epoch: 11 | loss: 0.4111469
	speed: 0.0533s/iter; left time: 1145.6418s
	iters: 1000, epoch: 11 | loss: 0.7251719
	speed: 0.0481s/iter; left time: 1029.3495s
	iters: 1100, epoch: 11 | loss: 0.4205644
	speed: 0.0522s/iter; left time: 1112.4166s
	iters: 1200, epoch: 11 | loss: 0.6941077
	speed: 0.0547s/iter; left time: 1158.1453s
	iters: 1300, epoch: 11 | loss: 0.6109211
	speed: 0.0505s/iter; left time: 1064.5189s
	iters: 1400, epoch: 11 | loss: 0.4434686
	speed: 0.0488s/iter; left time: 1024.8435s
	iters: 1500, epoch: 11 | loss: 0.5870121
	speed: 0.0473s/iter; left time: 989.0310s
	iters: 1600, epoch: 11 | loss: 0.5219647
	speed: 0.0493s/iter; left time: 1025.5168s
	iters: 1700, epoch: 11 | loss: 0.4249924
	speed: 0.0527s/iter; left time: 1090.3125s
	iters: 1800, epoch: 11 | loss: 0.4410802
	speed: 0.0519s/iter; left time: 1069.2569s
	iters: 1900, epoch: 11 | loss: 0.6697063
	speed: 0.0486s/iter; left time: 996.8675s
	iters: 2000, epoch: 11 | loss: 1.1027874
	speed: 0.0515s/iter; left time: 1050.3808s
	iters: 2100, epoch: 11 | loss: 0.4224382
	speed: 0.0495s/iter; left time: 1004.3574s
	iters: 2200, epoch: 11 | loss: 0.5399026
	speed: 0.0451s/iter; left time: 909.9819s
Epoch: 11 cost time: 111.97996020317078
Epoch: 11, Steps: 2239 | Train Loss: 0.6869006 Vali Loss: 0.6452094 Test Loss: 0.3183735
Validation loss decreased (0.646159 --> 0.645209).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.5023776
	speed: 0.1528s/iter; left time: 3063.8253s
	iters: 200, epoch: 12 | loss: 0.9199426
	speed: 0.0458s/iter; left time: 914.6984s
	iters: 300, epoch: 12 | loss: 0.7793396
	speed: 0.0494s/iter; left time: 980.7042s
	iters: 400, epoch: 12 | loss: 0.5565062
	speed: 0.0530s/iter; left time: 1046.9794s
	iters: 500, epoch: 12 | loss: 0.7677904
	speed: 0.0498s/iter; left time: 978.7930s
	iters: 600, epoch: 12 | loss: 0.4224095
	speed: 0.0535s/iter; left time: 1046.6075s
	iters: 700, epoch: 12 | loss: 1.8095845
	speed: 0.0431s/iter; left time: 839.1049s
	iters: 800, epoch: 12 | loss: 0.5694177
	speed: 0.0552s/iter; left time: 1067.8806s
	iters: 900, epoch: 12 | loss: 0.7721031
	speed: 0.0495s/iter; left time: 952.1139s
	iters: 1000, epoch: 12 | loss: 0.7158102
	speed: 0.0540s/iter; left time: 1033.4471s
	iters: 1100, epoch: 12 | loss: 0.6794209
	speed: 0.0535s/iter; left time: 1019.6887s
	iters: 1200, epoch: 12 | loss: 4.0283341
	speed: 0.0544s/iter; left time: 1031.6352s
	iters: 1300, epoch: 12 | loss: 0.5633826
	speed: 0.0539s/iter; left time: 1015.4268s
	iters: 1400, epoch: 12 | loss: 0.7377440
	speed: 0.0501s/iter; left time: 939.7452s
	iters: 1500, epoch: 12 | loss: 0.4537916
	speed: 0.0524s/iter; left time: 977.8948s
	iters: 1600, epoch: 12 | loss: 0.4898299
	speed: 0.0498s/iter; left time: 923.0073s
	iters: 1700, epoch: 12 | loss: 0.5407237
	speed: 0.0444s/iter; left time: 818.8118s
	iters: 1800, epoch: 12 | loss: 0.7326909
	speed: 0.0498s/iter; left time: 913.7160s
	iters: 1900, epoch: 12 | loss: 0.5197961
	speed: 0.0513s/iter; left time: 936.5940s
	iters: 2000, epoch: 12 | loss: 0.5200450
	speed: 0.0537s/iter; left time: 974.2743s
	iters: 2100, epoch: 12 | loss: 0.5787854
	speed: 0.0503s/iter; left time: 908.7494s
	iters: 2200, epoch: 12 | loss: 0.6220083
	speed: 0.0468s/iter; left time: 839.8796s
Epoch: 12 cost time: 112.35332322120667
Epoch: 12, Steps: 2239 | Train Loss: 0.6857709 Vali Loss: 0.6459960 Test Loss: 0.3184755
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.5365373
	speed: 0.1658s/iter; left time: 2953.5705s
	iters: 200, epoch: 13 | loss: 0.5690542
	speed: 0.0485s/iter; left time: 859.3755s
	iters: 300, epoch: 13 | loss: 0.7625678
	speed: 0.0481s/iter; left time: 847.3968s
	iters: 400, epoch: 13 | loss: 0.5088438
	speed: 0.0537s/iter; left time: 939.9815s
	iters: 500, epoch: 13 | loss: 0.5023132
	speed: 0.0521s/iter; left time: 907.6818s
	iters: 600, epoch: 13 | loss: 0.5696410
	speed: 0.0492s/iter; left time: 852.4279s
	iters: 700, epoch: 13 | loss: 0.6241429
	speed: 0.0527s/iter; left time: 907.1511s
	iters: 800, epoch: 13 | loss: 2.1623433
	speed: 0.0489s/iter; left time: 835.9814s
	iters: 900, epoch: 13 | loss: 0.4793127
	speed: 0.0518s/iter; left time: 881.3111s
	iters: 1000, epoch: 13 | loss: 0.4571221
	speed: 0.0528s/iter; left time: 892.8520s
	iters: 1100, epoch: 13 | loss: 0.5183881
	speed: 0.0488s/iter; left time: 820.6043s
	iters: 1200, epoch: 13 | loss: 0.8722675
	speed: 0.0491s/iter; left time: 820.7034s
	iters: 1300, epoch: 13 | loss: 0.5369355
	speed: 0.0482s/iter; left time: 800.4457s
	iters: 1400, epoch: 13 | loss: 0.5949538
	speed: 0.0541s/iter; left time: 893.8737s
	iters: 1500, epoch: 13 | loss: 0.4905300
	speed: 0.0548s/iter; left time: 899.0018s
	iters: 1600, epoch: 13 | loss: 0.5530130
	speed: 0.0514s/iter; left time: 838.4798s
	iters: 1700, epoch: 13 | loss: 0.5241829
	speed: 0.0524s/iter; left time: 849.1176s
	iters: 1800, epoch: 13 | loss: 0.3962016
	speed: 0.0521s/iter; left time: 839.1819s
	iters: 1900, epoch: 13 | loss: 0.4440839
	speed: 0.0522s/iter; left time: 836.2879s
	iters: 2000, epoch: 13 | loss: 0.5968725
	speed: 0.0498s/iter; left time: 792.1295s
	iters: 2100, epoch: 13 | loss: 0.6966602
	speed: 0.0461s/iter; left time: 728.9028s
	iters: 2200, epoch: 13 | loss: 0.5221210
	speed: 0.0436s/iter; left time: 684.8884s
Epoch: 13 cost time: 112.36663007736206
Epoch: 13, Steps: 2239 | Train Loss: 0.6851244 Vali Loss: 0.6457090 Test Loss: 0.3185840
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.5097007
	speed: 0.1565s/iter; left time: 2436.7152s
	iters: 200, epoch: 14 | loss: 0.4467517
	speed: 0.0472s/iter; left time: 730.5702s
	iters: 300, epoch: 14 | loss: 0.6919325
	speed: 0.0508s/iter; left time: 781.5917s
	iters: 400, epoch: 14 | loss: 1.2255795
	speed: 0.0493s/iter; left time: 753.1466s
	iters: 500, epoch: 14 | loss: 0.9722845
	speed: 0.0504s/iter; left time: 764.4710s
	iters: 600, epoch: 14 | loss: 1.1766175
	speed: 0.0529s/iter; left time: 797.3434s
	iters: 700, epoch: 14 | loss: 0.8130778
	speed: 0.0489s/iter; left time: 732.4184s
	iters: 800, epoch: 14 | loss: 0.4975912
	speed: 0.0487s/iter; left time: 724.5821s
	iters: 900, epoch: 14 | loss: 0.8370147
	speed: 0.0529s/iter; left time: 780.8410s
	iters: 1000, epoch: 14 | loss: 0.4962413
	speed: 0.0467s/iter; left time: 686.0057s
	iters: 1100, epoch: 14 | loss: 0.6556020
	speed: 0.0502s/iter; left time: 731.2450s
	iters: 1200, epoch: 14 | loss: 0.5238587
	speed: 0.0561s/iter; left time: 811.9399s
	iters: 1300, epoch: 14 | loss: 0.5883605
	speed: 0.0540s/iter; left time: 776.9128s
	iters: 1400, epoch: 14 | loss: 0.5319599
	speed: 0.0484s/iter; left time: 690.5781s
	iters: 1500, epoch: 14 | loss: 0.4610326
	speed: 0.0543s/iter; left time: 769.8025s
	iters: 1600, epoch: 14 | loss: 0.4915226
	speed: 0.0541s/iter; left time: 761.9962s
	iters: 1700, epoch: 14 | loss: 0.9242105
	speed: 0.0490s/iter; left time: 684.1469s
	iters: 1800, epoch: 14 | loss: 0.5578504
	speed: 0.0548s/iter; left time: 760.1415s
	iters: 1900, epoch: 14 | loss: 0.5767862
	speed: 0.0530s/iter; left time: 729.5820s
	iters: 2000, epoch: 14 | loss: 0.7398637
	speed: 0.0504s/iter; left time: 689.5845s
	iters: 2100, epoch: 14 | loss: 0.9823685
	speed: 0.0480s/iter; left time: 651.6347s
	iters: 2200, epoch: 14 | loss: 0.6508182
	speed: 0.0424s/iter; left time: 570.6275s
Epoch: 14 cost time: 112.0916497707367
Epoch: 14, Steps: 2239 | Train Loss: 0.6847900 Vali Loss: 0.6454036 Test Loss: 0.3185560
EarlyStopping counter: 3 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.8023268
	speed: 0.1597s/iter; left time: 2129.4895s
	iters: 200, epoch: 15 | loss: 0.4930831
	speed: 0.0461s/iter; left time: 609.5355s
	iters: 300, epoch: 15 | loss: 0.4930702
	speed: 0.0463s/iter; left time: 608.4816s
	iters: 400, epoch: 15 | loss: 0.4937828
	speed: 0.0469s/iter; left time: 610.9541s
	iters: 500, epoch: 15 | loss: 0.7580621
	speed: 0.0464s/iter; left time: 600.1011s
	iters: 600, epoch: 15 | loss: 0.4243358
	speed: 0.0480s/iter; left time: 615.7575s
	iters: 700, epoch: 15 | loss: 0.7899584
	speed: 0.0524s/iter; left time: 667.8242s
	iters: 800, epoch: 15 | loss: 0.6818547
	speed: 0.0523s/iter; left time: 660.7265s
	iters: 900, epoch: 15 | loss: 0.4321685
	speed: 0.0523s/iter; left time: 655.3955s
	iters: 1000, epoch: 15 | loss: 0.8258386
	speed: 0.0522s/iter; left time: 649.4110s
	iters: 1100, epoch: 15 | loss: 0.5872518
	speed: 0.0528s/iter; left time: 650.6956s
	iters: 1200, epoch: 15 | loss: 0.7270501
	speed: 0.0529s/iter; left time: 647.0358s
	iters: 1300, epoch: 15 | loss: 0.4473594
	speed: 0.0505s/iter; left time: 612.7309s
	iters: 1400, epoch: 15 | loss: 0.4840856
	speed: 0.0538s/iter; left time: 647.9838s
	iters: 1500, epoch: 15 | loss: 0.6426235
	speed: 0.0486s/iter; left time: 579.5664s
	iters: 1600, epoch: 15 | loss: 0.5944165
	speed: 0.0506s/iter; left time: 598.3538s
	iters: 1700, epoch: 15 | loss: 2.0082185
	speed: 0.0491s/iter; left time: 575.6230s
	iters: 1800, epoch: 15 | loss: 0.5176669
	speed: 0.0539s/iter; left time: 626.8402s
	iters: 1900, epoch: 15 | loss: 0.4175122
	speed: 0.0534s/iter; left time: 616.4121s
	iters: 2000, epoch: 15 | loss: 0.5034557
	speed: 0.0485s/iter; left time: 554.0808s
	iters: 2100, epoch: 15 | loss: 0.4395795
	speed: 0.0494s/iter; left time: 559.4056s
	iters: 2200, epoch: 15 | loss: 0.8604091
	speed: 0.0464s/iter; left time: 521.8576s
Epoch: 15 cost time: 111.20356178283691
Epoch: 15, Steps: 2239 | Train Loss: 0.6846945 Vali Loss: 0.6456234 Test Loss: 0.3185192
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.6382656
	speed: 0.1609s/iter; left time: 1785.7979s
	iters: 200, epoch: 16 | loss: 0.7572705
	speed: 0.0498s/iter; left time: 547.7518s
	iters: 300, epoch: 16 | loss: 0.5171632
	speed: 0.0488s/iter; left time: 531.5632s
	iters: 400, epoch: 16 | loss: 0.5463818
	speed: 0.0506s/iter; left time: 546.2171s
	iters: 500, epoch: 16 | loss: 0.8564724
	speed: 0.0482s/iter; left time: 515.3432s
	iters: 600, epoch: 16 | loss: 2.5357711
	speed: 0.0497s/iter; left time: 526.2908s
	iters: 700, epoch: 16 | loss: 0.5442024
	speed: 0.0474s/iter; left time: 497.1664s
	iters: 800, epoch: 16 | loss: 0.5923405
	speed: 0.0476s/iter; left time: 494.3753s
	iters: 900, epoch: 16 | loss: 0.6024306
	speed: 0.0485s/iter; left time: 499.0315s
	iters: 1000, epoch: 16 | loss: 0.6055790
	speed: 0.0460s/iter; left time: 468.7507s
	iters: 1100, epoch: 16 | loss: 0.6798271
	speed: 0.0454s/iter; left time: 458.2948s
	iters: 1200, epoch: 16 | loss: 1.0551715
	speed: 0.0393s/iter; left time: 392.5845s
	iters: 1300, epoch: 16 | loss: 0.8383709
	speed: 0.0466s/iter; left time: 460.8560s
	iters: 1400, epoch: 16 | loss: 0.8689111
	speed: 0.0512s/iter; left time: 501.2472s
	iters: 1500, epoch: 16 | loss: 0.4271048
	speed: 0.0516s/iter; left time: 500.7774s
	iters: 1600, epoch: 16 | loss: 0.9180315
	speed: 0.0507s/iter; left time: 486.4782s
	iters: 1700, epoch: 16 | loss: 0.4880583
	speed: 0.0539s/iter; left time: 511.6504s
	iters: 1800, epoch: 16 | loss: 0.4696144
	speed: 0.0521s/iter; left time: 489.4648s
	iters: 1900, epoch: 16 | loss: 0.4224673
	speed: 0.0514s/iter; left time: 477.5825s
	iters: 2000, epoch: 16 | loss: 0.7835560
	speed: 0.0502s/iter; left time: 461.9961s
	iters: 2100, epoch: 16 | loss: 0.5342802
	speed: 0.0432s/iter; left time: 392.7317s
	iters: 2200, epoch: 16 | loss: 0.5203416
	speed: 0.0423s/iter; left time: 380.4335s
Epoch: 16 cost time: 107.35631132125854
Epoch: 16, Steps: 2239 | Train Loss: 0.6845895 Vali Loss: 0.6454311 Test Loss: 0.3185006
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : weather_336_720_NLinear_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed25565<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9820
mse:0.31834542751312256, mae:0.3334644138813019
