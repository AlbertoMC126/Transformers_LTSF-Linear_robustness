Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='Linear', model_id='weather_336_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=15726, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : weather_336_96_Linear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15726>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36456
val 5175
test 10444
	iters: 100, epoch: 1 | loss: 0.2625134
	speed: 0.0110s/iter; left time: 498.5709s
	iters: 200, epoch: 1 | loss: 0.4786764
	speed: 0.0096s/iter; left time: 436.5718s
	iters: 300, epoch: 1 | loss: 0.4991899
	speed: 0.0098s/iter; left time: 442.1665s
	iters: 400, epoch: 1 | loss: 0.6312106
	speed: 0.0098s/iter; left time: 442.5904s
	iters: 500, epoch: 1 | loss: 1.6182861
	speed: 0.0100s/iter; left time: 449.3636s
	iters: 600, epoch: 1 | loss: 0.3637596
	speed: 0.0096s/iter; left time: 432.8757s
	iters: 700, epoch: 1 | loss: 0.5341578
	speed: 0.0098s/iter; left time: 440.4177s
	iters: 800, epoch: 1 | loss: 0.4425164
	speed: 0.0100s/iter; left time: 446.1861s
	iters: 900, epoch: 1 | loss: 0.3036568
	speed: 0.0093s/iter; left time: 415.4314s
	iters: 1000, epoch: 1 | loss: 0.5624228
	speed: 0.0090s/iter; left time: 400.9482s
	iters: 1100, epoch: 1 | loss: 0.3681397
	speed: 0.0085s/iter; left time: 377.7622s
	iters: 1200, epoch: 1 | loss: 0.4173515
	speed: 0.0095s/iter; left time: 420.6282s
	iters: 1300, epoch: 1 | loss: 0.3330151
	speed: 0.0094s/iter; left time: 414.1433s
	iters: 1400, epoch: 1 | loss: 0.3576401
	speed: 0.0093s/iter; left time: 410.1092s
	iters: 1500, epoch: 1 | loss: 0.7539650
	speed: 0.0095s/iter; left time: 416.7654s
	iters: 1600, epoch: 1 | loss: 0.5046657
	speed: 0.0097s/iter; left time: 427.6171s
	iters: 1700, epoch: 1 | loss: 0.6071120
	speed: 0.0092s/iter; left time: 404.5928s
	iters: 1800, epoch: 1 | loss: 3.9867735
	speed: 0.0099s/iter; left time: 431.5692s
	iters: 1900, epoch: 1 | loss: 0.4427209
	speed: 0.0091s/iter; left time: 397.5731s
	iters: 2000, epoch: 1 | loss: 0.3429205
	speed: 0.0088s/iter; left time: 381.7556s
	iters: 2100, epoch: 1 | loss: 0.3457878
	speed: 0.0084s/iter; left time: 364.0665s
	iters: 2200, epoch: 1 | loss: 0.4952050
	speed: 0.0096s/iter; left time: 414.7076s
Epoch: 1 cost time: 21.613328456878662
Epoch: 1, Steps: 2278 | Train Loss: 1.2269049 Vali Loss: 0.5326033 Test Loss: 0.2310912
Validation loss decreased (inf --> 0.532603).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.6315424
	speed: 0.0371s/iter; left time: 1600.8499s
	iters: 200, epoch: 2 | loss: 0.8257717
	speed: 0.0090s/iter; left time: 387.1704s
	iters: 300, epoch: 2 | loss: 0.3044278
	speed: 0.0098s/iter; left time: 419.9632s
	iters: 400, epoch: 2 | loss: 0.4101974
	speed: 0.0083s/iter; left time: 354.6393s
	iters: 500, epoch: 2 | loss: 3.1725497
	speed: 0.0089s/iter; left time: 380.6071s
	iters: 600, epoch: 2 | loss: 0.4996638
	speed: 0.0088s/iter; left time: 374.0848s
	iters: 700, epoch: 2 | loss: 1.0890882
	speed: 0.0095s/iter; left time: 404.5142s
	iters: 800, epoch: 2 | loss: 0.3806354
	speed: 0.0089s/iter; left time: 376.8932s
	iters: 900, epoch: 2 | loss: 0.3416149
	speed: 0.0089s/iter; left time: 378.6523s
	iters: 1000, epoch: 2 | loss: 1.9907447
	speed: 0.0092s/iter; left time: 387.7995s
	iters: 1100, epoch: 2 | loss: 0.3514456
	speed: 0.0092s/iter; left time: 387.9416s
	iters: 1200, epoch: 2 | loss: 0.2972777
	speed: 0.0087s/iter; left time: 365.3712s
	iters: 1300, epoch: 2 | loss: 0.3350198
	speed: 0.0096s/iter; left time: 401.8724s
	iters: 1400, epoch: 2 | loss: 1.9875380
	speed: 0.0093s/iter; left time: 388.1176s
	iters: 1500, epoch: 2 | loss: 0.8374959
	speed: 0.0098s/iter; left time: 409.9152s
	iters: 1600, epoch: 2 | loss: 0.3237993
	speed: 0.0084s/iter; left time: 352.0221s
	iters: 1700, epoch: 2 | loss: 0.8281676
	speed: 0.0090s/iter; left time: 372.4560s
	iters: 1800, epoch: 2 | loss: 1.4018494
	speed: 0.0096s/iter; left time: 398.8936s
	iters: 1900, epoch: 2 | loss: 0.3688867
	speed: 0.0092s/iter; left time: 380.1181s
	iters: 2000, epoch: 2 | loss: 0.5211169
	speed: 0.0087s/iter; left time: 358.6229s
	iters: 2100, epoch: 2 | loss: 0.4309841
	speed: 0.0080s/iter; left time: 328.2138s
	iters: 2200, epoch: 2 | loss: 0.4629828
	speed: 0.0095s/iter; left time: 390.5475s
Epoch: 2 cost time: 20.69421100616455
Epoch: 2, Steps: 2278 | Train Loss: 0.9604292 Vali Loss: 0.5465506 Test Loss: 0.2229854
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.1882118
	speed: 0.0401s/iter; left time: 1638.2808s
	iters: 200, epoch: 3 | loss: 0.3056189
	speed: 0.0085s/iter; left time: 347.3054s
	iters: 300, epoch: 3 | loss: 0.2614564
	speed: 0.0094s/iter; left time: 382.9147s
	iters: 400, epoch: 3 | loss: 0.2461984
	speed: 0.0089s/iter; left time: 362.5149s
	iters: 500, epoch: 3 | loss: 0.2715051
	speed: 0.0093s/iter; left time: 378.4001s
	iters: 600, epoch: 3 | loss: 1.9067233
	speed: 0.0086s/iter; left time: 348.7017s
	iters: 700, epoch: 3 | loss: 0.3442669
	speed: 0.0083s/iter; left time: 336.4036s
	iters: 800, epoch: 3 | loss: 0.3066278
	speed: 0.0080s/iter; left time: 323.6271s
	iters: 900, epoch: 3 | loss: 0.2493135
	speed: 0.0093s/iter; left time: 373.1845s
	iters: 1000, epoch: 3 | loss: 0.3501154
	speed: 0.0104s/iter; left time: 414.1959s
	iters: 1100, epoch: 3 | loss: 0.5415141
	speed: 0.0108s/iter; left time: 432.7399s
	iters: 1200, epoch: 3 | loss: 0.5169661
	speed: 0.0090s/iter; left time: 359.6412s
	iters: 1300, epoch: 3 | loss: 0.2663912
	speed: 0.0087s/iter; left time: 345.6349s
	iters: 1400, epoch: 3 | loss: 4.2110229
	speed: 0.0090s/iter; left time: 356.7152s
	iters: 1500, epoch: 3 | loss: 0.4947099
	speed: 0.0097s/iter; left time: 383.6379s
	iters: 1600, epoch: 3 | loss: 0.2292052
	speed: 0.0083s/iter; left time: 325.8440s
	iters: 1700, epoch: 3 | loss: 0.3906572
	speed: 0.0090s/iter; left time: 353.2049s
	iters: 1800, epoch: 3 | loss: 0.3149024
	speed: 0.0085s/iter; left time: 334.0285s
	iters: 1900, epoch: 3 | loss: 0.2746488
	speed: 0.0093s/iter; left time: 362.9361s
	iters: 2000, epoch: 3 | loss: 0.3617182
	speed: 0.0095s/iter; left time: 369.6198s
	iters: 2100, epoch: 3 | loss: 0.4398480
	speed: 0.0102s/iter; left time: 398.4405s
	iters: 2200, epoch: 3 | loss: 0.6245371
	speed: 0.0093s/iter; left time: 359.0270s
Epoch: 3 cost time: 20.87428069114685
Epoch: 3, Steps: 2278 | Train Loss: 0.6694381 Vali Loss: 0.4410330 Test Loss: 0.1740213
Validation loss decreased (0.532603 --> 0.441033).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.6241191
	speed: 0.0385s/iter; left time: 1489.0573s
	iters: 200, epoch: 4 | loss: 0.3015350
	speed: 0.0085s/iter; left time: 326.2197s
	iters: 300, epoch: 4 | loss: 1.4647826
	speed: 0.0085s/iter; left time: 325.5599s
	iters: 400, epoch: 4 | loss: 0.2410128
	speed: 0.0088s/iter; left time: 336.7636s
	iters: 500, epoch: 4 | loss: 0.2909645
	speed: 0.0084s/iter; left time: 319.9541s
	iters: 600, epoch: 4 | loss: 0.7652584
	speed: 0.0079s/iter; left time: 301.6685s
	iters: 700, epoch: 4 | loss: 0.6537984
	speed: 0.0089s/iter; left time: 339.6049s
	iters: 800, epoch: 4 | loss: 0.4061815
	speed: 0.0098s/iter; left time: 369.8745s
	iters: 900, epoch: 4 | loss: 0.4376596
	speed: 0.0088s/iter; left time: 332.3866s
	iters: 1000, epoch: 4 | loss: 0.2128995
	speed: 0.0099s/iter; left time: 375.0862s
	iters: 1100, epoch: 4 | loss: 0.2886544
	speed: 0.0100s/iter; left time: 377.8770s
	iters: 1200, epoch: 4 | loss: 0.4149699
	speed: 0.0088s/iter; left time: 329.8651s
	iters: 1300, epoch: 4 | loss: 0.5939909
	speed: 0.0083s/iter; left time: 312.3876s
	iters: 1400, epoch: 4 | loss: 0.3585030
	speed: 0.0086s/iter; left time: 319.8853s
	iters: 1500, epoch: 4 | loss: 0.2255624
	speed: 0.0085s/iter; left time: 314.8433s
	iters: 1600, epoch: 4 | loss: 0.2644264
	speed: 0.0098s/iter; left time: 362.9357s
	iters: 1700, epoch: 4 | loss: 4.7089901
	speed: 0.0096s/iter; left time: 354.9928s
	iters: 1800, epoch: 4 | loss: 0.3519159
	speed: 0.0092s/iter; left time: 341.4546s
	iters: 1900, epoch: 4 | loss: 0.3022862
	speed: 0.0092s/iter; left time: 338.8850s
	iters: 2000, epoch: 4 | loss: 0.2777846
	speed: 0.0095s/iter; left time: 350.5638s
	iters: 2100, epoch: 4 | loss: 0.3482134
	speed: 0.0096s/iter; left time: 351.2599s
	iters: 2200, epoch: 4 | loss: 0.3990414
	speed: 0.0094s/iter; left time: 345.0684s
Epoch: 4 cost time: 20.704935550689697
Epoch: 4, Steps: 2278 | Train Loss: 0.5179411 Vali Loss: 0.3889402 Test Loss: 0.1693153
Validation loss decreased (0.441033 --> 0.388940).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.2130226
	speed: 0.0366s/iter; left time: 1331.6467s
	iters: 200, epoch: 5 | loss: 0.2622755
	speed: 0.0090s/iter; left time: 325.0577s
	iters: 300, epoch: 5 | loss: 0.3406990
	speed: 0.0091s/iter; left time: 329.5631s
	iters: 400, epoch: 5 | loss: 0.4332180
	speed: 0.0091s/iter; left time: 327.8966s
	iters: 500, epoch: 5 | loss: 0.4486872
	speed: 0.0090s/iter; left time: 324.1668s
	iters: 600, epoch: 5 | loss: 0.3572737
	speed: 0.0093s/iter; left time: 334.3511s
	iters: 700, epoch: 5 | loss: 0.3649062
	speed: 0.0093s/iter; left time: 334.0519s
	iters: 800, epoch: 5 | loss: 0.3106208
	speed: 0.0097s/iter; left time: 346.6813s
	iters: 900, epoch: 5 | loss: 0.2495025
	speed: 0.0102s/iter; left time: 363.4026s
	iters: 1000, epoch: 5 | loss: 0.2800204
	speed: 0.0090s/iter; left time: 320.3748s
	iters: 1100, epoch: 5 | loss: 0.9430722
	speed: 0.0094s/iter; left time: 330.7561s
	iters: 1200, epoch: 5 | loss: 0.4133987
	speed: 0.0097s/iter; left time: 340.5806s
	iters: 1300, epoch: 5 | loss: 0.5977185
	speed: 0.0097s/iter; left time: 340.8396s
	iters: 1400, epoch: 5 | loss: 0.2443155
	speed: 0.0090s/iter; left time: 314.9631s
	iters: 1500, epoch: 5 | loss: 0.5915860
	speed: 0.0092s/iter; left time: 321.9737s
	iters: 1600, epoch: 5 | loss: 0.2726734
	speed: 0.0094s/iter; left time: 327.1128s
	iters: 1700, epoch: 5 | loss: 0.2244185
	speed: 0.0102s/iter; left time: 354.3687s
	iters: 1800, epoch: 5 | loss: 0.2534947
	speed: 0.0101s/iter; left time: 349.1780s
	iters: 1900, epoch: 5 | loss: 0.3862791
	speed: 0.0096s/iter; left time: 330.1369s
	iters: 2000, epoch: 5 | loss: 0.2328550
	speed: 0.0099s/iter; left time: 341.1718s
	iters: 2100, epoch: 5 | loss: 0.3774695
	speed: 0.0092s/iter; left time: 317.3939s
	iters: 2200, epoch: 5 | loss: 0.6109732
	speed: 0.0099s/iter; left time: 337.4383s
Epoch: 5 cost time: 21.514646291732788
Epoch: 5, Steps: 2278 | Train Loss: 0.4752098 Vali Loss: 0.3737347 Test Loss: 0.1492090
Validation loss decreased (0.388940 --> 0.373735).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.2359676
	speed: 0.0356s/iter; left time: 1213.7683s
	iters: 200, epoch: 6 | loss: 0.2180960
	speed: 0.0091s/iter; left time: 307.9269s
	iters: 300, epoch: 6 | loss: 0.2528687
	speed: 0.0097s/iter; left time: 329.3114s
	iters: 400, epoch: 6 | loss: 0.2248373
	speed: 0.0098s/iter; left time: 331.8057s
	iters: 500, epoch: 6 | loss: 0.1942043
	speed: 0.0094s/iter; left time: 316.7999s
	iters: 600, epoch: 6 | loss: 0.2157613
	speed: 0.0098s/iter; left time: 328.6871s
	iters: 700, epoch: 6 | loss: 0.2356552
	speed: 0.0099s/iter; left time: 332.4555s
	iters: 800, epoch: 6 | loss: 0.1717722
	speed: 0.0095s/iter; left time: 316.3631s
	iters: 900, epoch: 6 | loss: 2.1073861
	speed: 0.0087s/iter; left time: 288.5665s
	iters: 1000, epoch: 6 | loss: 0.6648037
	speed: 0.0088s/iter; left time: 292.4037s
	iters: 1100, epoch: 6 | loss: 0.3467329
	speed: 0.0087s/iter; left time: 288.2180s
	iters: 1200, epoch: 6 | loss: 0.2117710
	speed: 0.0088s/iter; left time: 290.5394s
	iters: 1300, epoch: 6 | loss: 0.3768524
	speed: 0.0099s/iter; left time: 325.6892s
	iters: 1400, epoch: 6 | loss: 0.3164921
	speed: 0.0091s/iter; left time: 299.5832s
	iters: 1500, epoch: 6 | loss: 0.2588399
	speed: 0.0088s/iter; left time: 287.5006s
	iters: 1600, epoch: 6 | loss: 0.2106687
	speed: 0.0086s/iter; left time: 279.3087s
	iters: 1700, epoch: 6 | loss: 0.4328319
	speed: 0.0087s/iter; left time: 283.7688s
	iters: 1800, epoch: 6 | loss: 0.2334718
	speed: 0.0094s/iter; left time: 304.9445s
	iters: 1900, epoch: 6 | loss: 0.2860303
	speed: 0.0089s/iter; left time: 287.8392s
	iters: 2000, epoch: 6 | loss: 0.2769618
	speed: 0.0080s/iter; left time: 256.7165s
	iters: 2100, epoch: 6 | loss: 0.3105629
	speed: 0.0088s/iter; left time: 282.5749s
	iters: 2200, epoch: 6 | loss: 0.2924854
	speed: 0.0087s/iter; left time: 278.3122s
Epoch: 6 cost time: 20.797494888305664
Epoch: 6, Steps: 2278 | Train Loss: 0.4577434 Vali Loss: 0.3752185 Test Loss: 0.1559871
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.2920453
	speed: 0.0379s/iter; left time: 1203.4575s
	iters: 200, epoch: 7 | loss: 0.3074473
	speed: 0.0086s/iter; left time: 271.2029s
	iters: 300, epoch: 7 | loss: 0.2941833
	speed: 0.0086s/iter; left time: 272.4895s
	iters: 400, epoch: 7 | loss: 0.3219357
	speed: 0.0084s/iter; left time: 264.5458s
	iters: 500, epoch: 7 | loss: 0.5798284
	speed: 0.0092s/iter; left time: 287.2875s
	iters: 600, epoch: 7 | loss: 0.2050643
	speed: 0.0086s/iter; left time: 270.5857s
	iters: 700, epoch: 7 | loss: 0.2991340
	speed: 0.0091s/iter; left time: 283.4262s
	iters: 800, epoch: 7 | loss: 0.2326799
	speed: 0.0091s/iter; left time: 283.8124s
	iters: 900, epoch: 7 | loss: 0.6360753
	speed: 0.0082s/iter; left time: 255.0792s
	iters: 1000, epoch: 7 | loss: 0.2294184
	speed: 0.0098s/iter; left time: 301.8921s
	iters: 1100, epoch: 7 | loss: 2.1544478
	speed: 0.0094s/iter; left time: 289.9243s
	iters: 1200, epoch: 7 | loss: 0.4466038
	speed: 0.0087s/iter; left time: 268.4658s
	iters: 1300, epoch: 7 | loss: 0.3816387
	speed: 0.0095s/iter; left time: 289.4902s
	iters: 1400, epoch: 7 | loss: 0.4563547
	speed: 0.0093s/iter; left time: 282.5232s
	iters: 1500, epoch: 7 | loss: 0.2917569
	speed: 0.0090s/iter; left time: 274.9783s
	iters: 1600, epoch: 7 | loss: 1.6747273
	speed: 0.0092s/iter; left time: 279.7568s
	iters: 1700, epoch: 7 | loss: 0.2379894
	speed: 0.0102s/iter; left time: 307.5326s
	iters: 1800, epoch: 7 | loss: 0.2182338
	speed: 0.0085s/iter; left time: 254.7936s
	iters: 1900, epoch: 7 | loss: 0.1719291
	speed: 0.0099s/iter; left time: 298.1093s
	iters: 2000, epoch: 7 | loss: 1.9362255
	speed: 0.0087s/iter; left time: 259.8358s
	iters: 2100, epoch: 7 | loss: 0.5687329
	speed: 0.0080s/iter; left time: 238.3855s
	iters: 2200, epoch: 7 | loss: 0.5693903
	speed: 0.0081s/iter; left time: 240.4256s
Epoch: 7 cost time: 20.44900131225586
Epoch: 7, Steps: 2278 | Train Loss: 0.4494889 Vali Loss: 0.3669457 Test Loss: 0.1448707
Validation loss decreased (0.373735 --> 0.366946).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.2799188
	speed: 0.0370s/iter; left time: 1091.8403s
	iters: 200, epoch: 8 | loss: 0.5032530
	speed: 0.0086s/iter; left time: 252.1379s
	iters: 300, epoch: 8 | loss: 0.3090774
	speed: 0.0092s/iter; left time: 269.6218s
	iters: 400, epoch: 8 | loss: 0.2703885
	speed: 0.0089s/iter; left time: 259.2738s
	iters: 500, epoch: 8 | loss: 0.2144893
	speed: 0.0091s/iter; left time: 265.1434s
	iters: 600, epoch: 8 | loss: 0.1713704
	speed: 0.0090s/iter; left time: 261.5927s
	iters: 700, epoch: 8 | loss: 0.3442228
	speed: 0.0079s/iter; left time: 229.5746s
	iters: 800, epoch: 8 | loss: 0.3519563
	speed: 0.0092s/iter; left time: 266.1488s
	iters: 900, epoch: 8 | loss: 0.3869135
	speed: 0.0084s/iter; left time: 241.3988s
	iters: 1000, epoch: 8 | loss: 0.2353465
	speed: 0.0090s/iter; left time: 258.0103s
	iters: 1100, epoch: 8 | loss: 0.3610833
	speed: 0.0083s/iter; left time: 235.8230s
	iters: 1200, epoch: 8 | loss: 0.3146065
	speed: 0.0095s/iter; left time: 271.3614s
	iters: 1300, epoch: 8 | loss: 0.3081963
	speed: 0.0084s/iter; left time: 238.1757s
	iters: 1400, epoch: 8 | loss: 0.1966393
	speed: 0.0090s/iter; left time: 253.2947s
	iters: 1500, epoch: 8 | loss: 0.2381512
	speed: 0.0087s/iter; left time: 243.6738s
	iters: 1600, epoch: 8 | loss: 0.3911532
	speed: 0.0091s/iter; left time: 256.2477s
	iters: 1700, epoch: 8 | loss: 0.4364250
	speed: 0.0088s/iter; left time: 245.9923s
	iters: 1800, epoch: 8 | loss: 0.3467128
	speed: 0.0097s/iter; left time: 269.0432s
	iters: 1900, epoch: 8 | loss: 2.1300290
	speed: 0.0093s/iter; left time: 258.9067s
	iters: 2000, epoch: 8 | loss: 0.2807326
	speed: 0.0096s/iter; left time: 264.4682s
	iters: 2100, epoch: 8 | loss: 0.3430051
	speed: 0.0096s/iter; left time: 264.3193s
	iters: 2200, epoch: 8 | loss: 0.2158498
	speed: 0.0097s/iter; left time: 265.8415s
Epoch: 8 cost time: 20.561946868896484
Epoch: 8, Steps: 2278 | Train Loss: 0.4454714 Vali Loss: 0.3654239 Test Loss: 0.1450882
Validation loss decreased (0.366946 --> 0.365424).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.2719836
	speed: 0.0383s/iter; left time: 1043.6489s
	iters: 200, epoch: 9 | loss: 0.2239038
	speed: 0.0095s/iter; left time: 257.9902s
	iters: 300, epoch: 9 | loss: 0.3141395
	speed: 0.0091s/iter; left time: 245.5933s
	iters: 400, epoch: 9 | loss: 0.2774045
	speed: 0.0086s/iter; left time: 232.6290s
	iters: 500, epoch: 9 | loss: 0.2417868
	speed: 0.0093s/iter; left time: 249.4849s
	iters: 600, epoch: 9 | loss: 0.3789827
	speed: 0.0088s/iter; left time: 235.7216s
	iters: 700, epoch: 9 | loss: 2.1547551
	speed: 0.0087s/iter; left time: 231.6456s
	iters: 800, epoch: 9 | loss: 0.1618396
	speed: 0.0089s/iter; left time: 235.7319s
	iters: 900, epoch: 9 | loss: 0.4242940
	speed: 0.0093s/iter; left time: 244.9983s
	iters: 1000, epoch: 9 | loss: 0.2217704
	speed: 0.0091s/iter; left time: 240.1024s
	iters: 1100, epoch: 9 | loss: 0.3659395
	speed: 0.0096s/iter; left time: 251.6702s
	iters: 1200, epoch: 9 | loss: 0.2514385
	speed: 0.0089s/iter; left time: 233.5907s
	iters: 1300, epoch: 9 | loss: 0.1891321
	speed: 0.0090s/iter; left time: 233.7180s
	iters: 1400, epoch: 9 | loss: 0.2627117
	speed: 0.0085s/iter; left time: 219.6967s
	iters: 1500, epoch: 9 | loss: 0.2779042
	speed: 0.0087s/iter; left time: 225.9348s
	iters: 1600, epoch: 9 | loss: 0.2869545
	speed: 0.0086s/iter; left time: 221.7603s
	iters: 1700, epoch: 9 | loss: 0.2674309
	speed: 0.0088s/iter; left time: 226.3762s
	iters: 1800, epoch: 9 | loss: 0.1878965
	speed: 0.0087s/iter; left time: 221.9106s
	iters: 1900, epoch: 9 | loss: 0.2842300
	speed: 0.0095s/iter; left time: 240.5559s
	iters: 2000, epoch: 9 | loss: 0.6267825
	speed: 0.0092s/iter; left time: 233.9199s
	iters: 2100, epoch: 9 | loss: 0.3923202
	speed: 0.0093s/iter; left time: 234.8852s
	iters: 2200, epoch: 9 | loss: 0.1629247
	speed: 0.0091s/iter; left time: 229.1671s
Epoch: 9 cost time: 20.589490175247192
Epoch: 9, Steps: 2278 | Train Loss: 0.4434341 Vali Loss: 0.3664938 Test Loss: 0.1444146
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.6871042
	speed: 0.0373s/iter; left time: 929.8009s
	iters: 200, epoch: 10 | loss: 0.2270518
	speed: 0.0094s/iter; left time: 233.4735s
	iters: 300, epoch: 10 | loss: 0.2191292
	speed: 0.0094s/iter; left time: 231.6626s
	iters: 400, epoch: 10 | loss: 0.3792029
	speed: 0.0093s/iter; left time: 229.0123s
	iters: 500, epoch: 10 | loss: 0.2774133
	speed: 0.0096s/iter; left time: 235.3224s
	iters: 600, epoch: 10 | loss: 0.2058589
	speed: 0.0089s/iter; left time: 218.6274s
	iters: 700, epoch: 10 | loss: 0.3270804
	speed: 0.0093s/iter; left time: 227.2512s
	iters: 800, epoch: 10 | loss: 0.2265258
	speed: 0.0094s/iter; left time: 226.8722s
	iters: 900, epoch: 10 | loss: 0.5870357
	speed: 0.0089s/iter; left time: 216.1359s
	iters: 1000, epoch: 10 | loss: 0.2900077
	speed: 0.0095s/iter; left time: 228.4923s
	iters: 1100, epoch: 10 | loss: 0.2499605
	speed: 0.0094s/iter; left time: 224.0320s
	iters: 1200, epoch: 10 | loss: 0.1900677
	speed: 0.0094s/iter; left time: 223.8358s
	iters: 1300, epoch: 10 | loss: 0.2018372
	speed: 0.0092s/iter; left time: 218.9879s
	iters: 1400, epoch: 10 | loss: 2.0385242
	speed: 0.0093s/iter; left time: 219.7180s
	iters: 1500, epoch: 10 | loss: 0.2479000
	speed: 0.0094s/iter; left time: 222.2792s
	iters: 1600, epoch: 10 | loss: 0.2465620
	speed: 0.0092s/iter; left time: 215.0129s
	iters: 1700, epoch: 10 | loss: 0.2057152
	speed: 0.0095s/iter; left time: 221.1363s
	iters: 1800, epoch: 10 | loss: 0.2829258
	speed: 0.0091s/iter; left time: 211.7381s
	iters: 1900, epoch: 10 | loss: 0.3426707
	speed: 0.0093s/iter; left time: 215.5614s
	iters: 2000, epoch: 10 | loss: 2.5147514
	speed: 0.0093s/iter; left time: 213.6945s
	iters: 2100, epoch: 10 | loss: 0.2979349
	speed: 0.0097s/iter; left time: 222.4148s
	iters: 2200, epoch: 10 | loss: 0.2577406
	speed: 0.0093s/iter; left time: 212.1606s
Epoch: 10 cost time: 21.230589866638184
Epoch: 10, Steps: 2278 | Train Loss: 0.4424280 Vali Loss: 0.3651540 Test Loss: 0.1445897
Validation loss decreased (0.365424 --> 0.365154).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.2468180
	speed: 0.0362s/iter; left time: 822.1738s
	iters: 200, epoch: 11 | loss: 0.7156487
	speed: 0.0088s/iter; left time: 199.2382s
	iters: 300, epoch: 11 | loss: 0.1889666
	speed: 0.0093s/iter; left time: 209.8439s
	iters: 400, epoch: 11 | loss: 0.3597726
	speed: 0.0095s/iter; left time: 211.7263s
	iters: 500, epoch: 11 | loss: 0.1917004
	speed: 0.0094s/iter; left time: 209.3784s
	iters: 600, epoch: 11 | loss: 0.3687784
	speed: 0.0093s/iter; left time: 206.5462s
	iters: 700, epoch: 11 | loss: 0.2297061
	speed: 0.0095s/iter; left time: 210.0528s
	iters: 800, epoch: 11 | loss: 0.5431070
	speed: 0.0095s/iter; left time: 207.8009s
	iters: 900, epoch: 11 | loss: 0.2335384
	speed: 0.0097s/iter; left time: 211.7965s
	iters: 1000, epoch: 11 | loss: 0.1938197
	speed: 0.0095s/iter; left time: 207.6222s
	iters: 1100, epoch: 11 | loss: 0.3128579
	speed: 0.0094s/iter; left time: 203.0264s
	iters: 1200, epoch: 11 | loss: 0.2022145
	speed: 0.0094s/iter; left time: 203.2250s
	iters: 1300, epoch: 11 | loss: 0.3621190
	speed: 0.0095s/iter; left time: 203.2460s
	iters: 1400, epoch: 11 | loss: 0.3932424
	speed: 0.0094s/iter; left time: 200.4858s
	iters: 1500, epoch: 11 | loss: 0.2554666
	speed: 0.0095s/iter; left time: 202.8873s
	iters: 1600, epoch: 11 | loss: 0.2163621
	speed: 0.0093s/iter; left time: 196.8133s
	iters: 1700, epoch: 11 | loss: 0.4418491
	speed: 0.0094s/iter; left time: 198.3316s
	iters: 1800, epoch: 11 | loss: 0.1558139
	speed: 0.0093s/iter; left time: 195.0294s
	iters: 1900, epoch: 11 | loss: 0.3784353
	speed: 0.0096s/iter; left time: 200.8036s
	iters: 2000, epoch: 11 | loss: 0.2322651
	speed: 0.0094s/iter; left time: 194.8818s
	iters: 2100, epoch: 11 | loss: 0.2237480
	speed: 0.0092s/iter; left time: 189.7307s
	iters: 2200, epoch: 11 | loss: 0.3650292
	speed: 0.0095s/iter; left time: 195.8006s
Epoch: 11 cost time: 21.41597843170166
Epoch: 11, Steps: 2278 | Train Loss: 0.4418521 Vali Loss: 0.3663053 Test Loss: 0.1451585
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.3202266
	speed: 0.0371s/iter; left time: 757.3138s
	iters: 200, epoch: 12 | loss: 0.2187510
	speed: 0.0093s/iter; left time: 188.1441s
	iters: 300, epoch: 12 | loss: 0.2592696
	speed: 0.0093s/iter; left time: 188.3672s
	iters: 400, epoch: 12 | loss: 0.2600431
	speed: 0.0096s/iter; left time: 192.0190s
	iters: 500, epoch: 12 | loss: 0.2196349
	speed: 0.0094s/iter; left time: 187.5591s
	iters: 600, epoch: 12 | loss: 0.2506214
	speed: 0.0096s/iter; left time: 191.5075s
	iters: 700, epoch: 12 | loss: 0.2276876
	speed: 0.0092s/iter; left time: 182.0833s
	iters: 800, epoch: 12 | loss: 0.2490023
	speed: 0.0092s/iter; left time: 181.4013s
	iters: 900, epoch: 12 | loss: 0.2030239
	speed: 0.0091s/iter; left time: 178.6118s
	iters: 1000, epoch: 12 | loss: 0.1727235
	speed: 0.0096s/iter; left time: 187.4554s
	iters: 1100, epoch: 12 | loss: 0.2623157
	speed: 0.0093s/iter; left time: 180.3888s
	iters: 1200, epoch: 12 | loss: 0.2918535
	speed: 0.0096s/iter; left time: 184.4785s
	iters: 1300, epoch: 12 | loss: 0.3485416
	speed: 0.0095s/iter; left time: 181.5918s
	iters: 1400, epoch: 12 | loss: 0.2205058
	speed: 0.0092s/iter; left time: 176.0569s
	iters: 1500, epoch: 12 | loss: 2.2327507
	speed: 0.0092s/iter; left time: 175.7231s
	iters: 1600, epoch: 12 | loss: 0.2791915
	speed: 0.0093s/iter; left time: 175.1634s
	iters: 1700, epoch: 12 | loss: 0.3220089
	speed: 0.0094s/iter; left time: 176.3134s
	iters: 1800, epoch: 12 | loss: 0.3023812
	speed: 0.0094s/iter; left time: 176.5563s
	iters: 1900, epoch: 12 | loss: 0.4116260
	speed: 0.0095s/iter; left time: 177.0471s
	iters: 2000, epoch: 12 | loss: 0.4805209
	speed: 0.0093s/iter; left time: 171.4250s
	iters: 2100, epoch: 12 | loss: 0.2021803
	speed: 0.0092s/iter; left time: 169.3851s
	iters: 2200, epoch: 12 | loss: 0.2264781
	speed: 0.0095s/iter; left time: 174.4600s
Epoch: 12 cost time: 21.346414804458618
Epoch: 12, Steps: 2278 | Train Loss: 0.4416096 Vali Loss: 0.3664279 Test Loss: 0.1456360
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.2666299
	speed: 0.0370s/iter; left time: 669.8759s
	iters: 200, epoch: 13 | loss: 0.2693050
	speed: 0.0091s/iter; left time: 164.3318s
	iters: 300, epoch: 13 | loss: 0.2125339
	speed: 0.0094s/iter; left time: 169.2622s
	iters: 400, epoch: 13 | loss: 0.3011855
	speed: 0.0091s/iter; left time: 162.3217s
	iters: 500, epoch: 13 | loss: 0.2039433
	speed: 0.0094s/iter; left time: 166.7400s
	iters: 600, epoch: 13 | loss: 0.3715436
	speed: 0.0094s/iter; left time: 165.8862s
	iters: 700, epoch: 13 | loss: 0.3259043
	speed: 0.0094s/iter; left time: 164.6827s
	iters: 800, epoch: 13 | loss: 0.3195933
	speed: 0.0093s/iter; left time: 162.8673s
	iters: 900, epoch: 13 | loss: 0.2645004
	speed: 0.0094s/iter; left time: 162.3712s
	iters: 1000, epoch: 13 | loss: 0.2579067
	speed: 0.0094s/iter; left time: 162.3635s
	iters: 1100, epoch: 13 | loss: 0.3498811
	speed: 0.0094s/iter; left time: 160.9294s
	iters: 1200, epoch: 13 | loss: 0.7049294
	speed: 0.0094s/iter; left time: 159.3042s
	iters: 1300, epoch: 13 | loss: 0.4094149
	speed: 0.0092s/iter; left time: 155.8378s
	iters: 1400, epoch: 13 | loss: 0.3084664
	speed: 0.0093s/iter; left time: 156.4053s
	iters: 1500, epoch: 13 | loss: 0.4057090
	speed: 0.0095s/iter; left time: 158.0855s
	iters: 1600, epoch: 13 | loss: 0.1619311
	speed: 0.0091s/iter; left time: 151.6216s
	iters: 1700, epoch: 13 | loss: 0.3877994
	speed: 0.0091s/iter; left time: 150.3205s
	iters: 1800, epoch: 13 | loss: 0.3911997
	speed: 0.0094s/iter; left time: 154.5845s
	iters: 1900, epoch: 13 | loss: 0.2173490
	speed: 0.0095s/iter; left time: 154.5923s
	iters: 2000, epoch: 13 | loss: 0.4155219
	speed: 0.0093s/iter; left time: 150.1847s
	iters: 2100, epoch: 13 | loss: 0.2395557
	speed: 0.0093s/iter; left time: 149.9644s
	iters: 2200, epoch: 13 | loss: 0.2717242
	speed: 0.0089s/iter; left time: 143.0345s
Epoch: 13 cost time: 21.219515085220337
Epoch: 13, Steps: 2278 | Train Loss: 0.4413053 Vali Loss: 0.3661970 Test Loss: 0.1453096
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.2392041
	speed: 0.0360s/iter; left time: 570.4116s
	iters: 200, epoch: 14 | loss: 0.3858790
	speed: 0.0094s/iter; left time: 148.4357s
	iters: 300, epoch: 14 | loss: 0.2115601
	speed: 0.0095s/iter; left time: 147.9729s
	iters: 400, epoch: 14 | loss: 0.2023187
	speed: 0.0094s/iter; left time: 146.1056s
	iters: 500, epoch: 14 | loss: 0.2891796
	speed: 0.0093s/iter; left time: 143.6134s
	iters: 600, epoch: 14 | loss: 0.2419306
	speed: 0.0091s/iter; left time: 139.9396s
	iters: 700, epoch: 14 | loss: 0.1979000
	speed: 0.0090s/iter; left time: 136.5610s
	iters: 800, epoch: 14 | loss: 0.2017185
	speed: 0.0096s/iter; left time: 145.1222s
	iters: 900, epoch: 14 | loss: 0.2033131
	speed: 0.0097s/iter; left time: 145.4628s
	iters: 1000, epoch: 14 | loss: 0.3000227
	speed: 0.0091s/iter; left time: 136.6056s
	iters: 1100, epoch: 14 | loss: 0.1911768
	speed: 0.0092s/iter; left time: 136.9195s
	iters: 1200, epoch: 14 | loss: 0.1665400
	speed: 0.0094s/iter; left time: 138.1365s
	iters: 1300, epoch: 14 | loss: 0.8692502
	speed: 0.0097s/iter; left time: 141.6482s
	iters: 1400, epoch: 14 | loss: 0.7370968
	speed: 0.0094s/iter; left time: 136.9868s
	iters: 1500, epoch: 14 | loss: 0.2391859
	speed: 0.0092s/iter; left time: 132.8872s
	iters: 1600, epoch: 14 | loss: 0.2742106
	speed: 0.0095s/iter; left time: 135.6223s
	iters: 1700, epoch: 14 | loss: 0.3127412
	speed: 0.0095s/iter; left time: 134.7306s
	iters: 1800, epoch: 14 | loss: 0.4078297
	speed: 0.0093s/iter; left time: 131.2335s
	iters: 1900, epoch: 14 | loss: 0.3926924
	speed: 0.0095s/iter; left time: 133.9015s
	iters: 2000, epoch: 14 | loss: 0.1742104
	speed: 0.0090s/iter; left time: 125.8448s
	iters: 2100, epoch: 14 | loss: 0.2551342
	speed: 0.0092s/iter; left time: 127.5763s
	iters: 2200, epoch: 14 | loss: 0.2134246
	speed: 0.0092s/iter; left time: 126.7615s
Epoch: 14 cost time: 21.267427444458008
Epoch: 14, Steps: 2278 | Train Loss: 0.4413877 Vali Loss: 0.3660579 Test Loss: 0.1453948
EarlyStopping counter: 4 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.4431075
	speed: 0.0370s/iter; left time: 502.6448s
	iters: 200, epoch: 15 | loss: 0.5378337
	speed: 0.0091s/iter; left time: 123.2093s
	iters: 300, epoch: 15 | loss: 0.6735460
	speed: 0.0093s/iter; left time: 124.1879s
	iters: 400, epoch: 15 | loss: 0.2343290
	speed: 0.0095s/iter; left time: 125.9528s
	iters: 500, epoch: 15 | loss: 0.3468081
	speed: 0.0099s/iter; left time: 129.9999s
	iters: 600, epoch: 15 | loss: 0.2130505
	speed: 0.0097s/iter; left time: 126.8475s
	iters: 700, epoch: 15 | loss: 0.1579686
	speed: 0.0099s/iter; left time: 127.8986s
	iters: 800, epoch: 15 | loss: 0.2117517
	speed: 0.0096s/iter; left time: 123.9843s
	iters: 900, epoch: 15 | loss: 0.2501255
	speed: 0.0104s/iter; left time: 133.0632s
	iters: 1000, epoch: 15 | loss: 0.2323463
	speed: 0.0090s/iter; left time: 113.5747s
	iters: 1100, epoch: 15 | loss: 0.2217636
	speed: 0.0090s/iter; left time: 113.6649s
	iters: 1200, epoch: 15 | loss: 0.2975704
	speed: 0.0094s/iter; left time: 117.1665s
	iters: 1300, epoch: 15 | loss: 0.2159858
	speed: 0.0091s/iter; left time: 112.8394s
	iters: 1400, epoch: 15 | loss: 0.2729979
	speed: 0.0090s/iter; left time: 110.1334s
	iters: 1500, epoch: 15 | loss: 0.4478537
	speed: 0.0090s/iter; left time: 108.9728s
	iters: 1600, epoch: 15 | loss: 0.2089863
	speed: 0.0094s/iter; left time: 112.9891s
	iters: 1700, epoch: 15 | loss: 0.1425752
	speed: 0.0090s/iter; left time: 107.9179s
	iters: 1800, epoch: 15 | loss: 0.2767920
	speed: 0.0089s/iter; left time: 105.6669s
	iters: 1900, epoch: 15 | loss: 0.2823503
	speed: 0.0094s/iter; left time: 110.1240s
	iters: 2000, epoch: 15 | loss: 0.1382954
	speed: 0.0092s/iter; left time: 107.2441s
	iters: 2100, epoch: 15 | loss: 0.3585458
	speed: 0.0089s/iter; left time: 103.3449s
	iters: 2200, epoch: 15 | loss: 0.3137029
	speed: 0.0089s/iter; left time: 101.5786s
Epoch: 15 cost time: 21.16498899459839
Epoch: 15, Steps: 2278 | Train Loss: 0.4413209 Vali Loss: 0.3663457 Test Loss: 0.1453819
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : weather_336_96_Linear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15726<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
mse:0.14463241398334503, mae:0.21083368360996246
