Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='Linear', model_id='weather_336_720', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=720, root_path='./dataset/', save_pred_values=False, seed=3144, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : weather_336_720_Linear_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3144>>>>>>>>>>>>>>>>>>>>>>>>>>
train 35832
val 4551
test 9820
	iters: 100, epoch: 1 | loss: 0.5261568
	speed: 0.0459s/iter; left time: 2052.5993s
	iters: 200, epoch: 1 | loss: 1.5006914
	speed: 0.0499s/iter; left time: 2226.0867s
	iters: 300, epoch: 1 | loss: 0.5239908
	speed: 0.0518s/iter; left time: 2305.8171s
	iters: 400, epoch: 1 | loss: 0.6812611
	speed: 0.0451s/iter; left time: 2002.8113s
	iters: 500, epoch: 1 | loss: 1.6140411
	speed: 0.0508s/iter; left time: 2249.9644s
	iters: 600, epoch: 1 | loss: 1.8302650
	speed: 0.0532s/iter; left time: 2348.9917s
	iters: 700, epoch: 1 | loss: 0.8867376
	speed: 0.0520s/iter; left time: 2290.3478s
	iters: 800, epoch: 1 | loss: 0.5430893
	speed: 0.0483s/iter; left time: 2125.9020s
	iters: 900, epoch: 1 | loss: 0.7042766
	speed: 0.0520s/iter; left time: 2279.7990s
	iters: 1000, epoch: 1 | loss: 1.1559421
	speed: 0.0511s/iter; left time: 2238.9148s
	iters: 1100, epoch: 1 | loss: 0.5665064
	speed: 0.0514s/iter; left time: 2243.7586s
	iters: 1200, epoch: 1 | loss: 0.7761003
	speed: 0.0480s/iter; left time: 2092.6114s
	iters: 1300, epoch: 1 | loss: 5.3120923
	speed: 0.0537s/iter; left time: 2335.2806s
	iters: 1400, epoch: 1 | loss: 0.7267489
	speed: 0.0510s/iter; left time: 2211.5059s
	iters: 1500, epoch: 1 | loss: 0.6659512
	speed: 0.0525s/iter; left time: 2272.8980s
	iters: 1600, epoch: 1 | loss: 0.5591462
	speed: 0.0510s/iter; left time: 2201.3325s
	iters: 1700, epoch: 1 | loss: 0.5651726
	speed: 0.0504s/iter; left time: 2170.8776s
	iters: 1800, epoch: 1 | loss: 0.5805926
	speed: 0.0491s/iter; left time: 2109.2886s
	iters: 1900, epoch: 1 | loss: 0.6456799
	speed: 0.0508s/iter; left time: 2180.3165s
	iters: 2000, epoch: 1 | loss: 0.5129081
	speed: 0.0487s/iter; left time: 2084.2174s
	iters: 2100, epoch: 1 | loss: 0.6432977
	speed: 0.0494s/iter; left time: 2106.4512s
	iters: 2200, epoch: 1 | loss: 0.6019869
	speed: 0.0498s/iter; left time: 2119.2500s
Epoch: 1 cost time: 112.14443874359131
Epoch: 1, Steps: 2239 | Train Loss: 1.3712749 Vali Loss: 0.7287909 Test Loss: 0.4354618
Validation loss decreased (inf --> 0.728791).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 7.3901072
	speed: 0.1656s/iter; left time: 7028.4418s
	iters: 200, epoch: 2 | loss: 12.4587135
	speed: 0.0508s/iter; left time: 2150.9921s
	iters: 300, epoch: 2 | loss: 0.8457505
	speed: 0.0549s/iter; left time: 2317.8158s
	iters: 400, epoch: 2 | loss: 9.4226398
	speed: 0.0518s/iter; left time: 2184.7188s
	iters: 500, epoch: 2 | loss: 0.9170560
	speed: 0.0501s/iter; left time: 2107.1394s
	iters: 600, epoch: 2 | loss: 1.2473550
	speed: 0.0498s/iter; left time: 2088.9989s
	iters: 700, epoch: 2 | loss: 0.8411095
	speed: 0.0500s/iter; left time: 2094.0193s
	iters: 800, epoch: 2 | loss: 0.9494141
	speed: 0.0494s/iter; left time: 2063.1294s
	iters: 900, epoch: 2 | loss: 0.7927840
	speed: 0.0510s/iter; left time: 2125.4620s
	iters: 1000, epoch: 2 | loss: 0.9112844
	speed: 0.0496s/iter; left time: 2060.2474s
	iters: 1100, epoch: 2 | loss: 0.6407309
	speed: 0.0484s/iter; left time: 2004.8374s
	iters: 1200, epoch: 2 | loss: 0.5635787
	speed: 0.0537s/iter; left time: 2220.4882s
	iters: 1300, epoch: 2 | loss: 0.5918394
	speed: 0.0489s/iter; left time: 2016.1450s
	iters: 1400, epoch: 2 | loss: 0.6742145
	speed: 0.0511s/iter; left time: 2102.9871s
	iters: 1500, epoch: 2 | loss: 0.7030521
	speed: 0.0506s/iter; left time: 2077.9201s
	iters: 1600, epoch: 2 | loss: 0.5660730
	speed: 0.0510s/iter; left time: 2088.2504s
	iters: 1700, epoch: 2 | loss: 1.8599540
	speed: 0.0492s/iter; left time: 2008.6542s
	iters: 1800, epoch: 2 | loss: 0.6620783
	speed: 0.0499s/iter; left time: 2033.4026s
	iters: 1900, epoch: 2 | loss: 1.9151785
	speed: 0.0498s/iter; left time: 2024.1762s
	iters: 2000, epoch: 2 | loss: 1.4823742
	speed: 0.0519s/iter; left time: 2103.1184s
	iters: 2100, epoch: 2 | loss: 0.7276593
	speed: 0.0492s/iter; left time: 1991.1528s
	iters: 2200, epoch: 2 | loss: 0.4978473
	speed: 0.0387s/iter; left time: 1561.1762s
Epoch: 2 cost time: 111.87576341629028
Epoch: 2, Steps: 2239 | Train Loss: 1.0954697 Vali Loss: 0.7283800 Test Loss: 0.3777114
Validation loss decreased (0.728791 --> 0.728380).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.5381229
	speed: 0.1592s/iter; left time: 6400.1592s
	iters: 200, epoch: 3 | loss: 0.4487256
	speed: 0.0519s/iter; left time: 2080.1221s
	iters: 300, epoch: 3 | loss: 0.8141773
	speed: 0.0511s/iter; left time: 2044.4200s
	iters: 400, epoch: 3 | loss: 0.4584025
	speed: 0.0513s/iter; left time: 2047.5133s
	iters: 500, epoch: 3 | loss: 1.5780189
	speed: 0.0517s/iter; left time: 2059.6266s
	iters: 600, epoch: 3 | loss: 0.6541311
	speed: 0.0450s/iter; left time: 1785.5866s
	iters: 700, epoch: 3 | loss: 0.5824745
	speed: 0.0482s/iter; left time: 1910.4237s
	iters: 800, epoch: 3 | loss: 0.7336857
	speed: 0.0541s/iter; left time: 2136.0534s
	iters: 900, epoch: 3 | loss: 0.8653009
	speed: 0.0536s/iter; left time: 2113.8323s
	iters: 1000, epoch: 3 | loss: 0.4855050
	speed: 0.0488s/iter; left time: 1919.7305s
	iters: 1100, epoch: 3 | loss: 0.4461436
	speed: 0.0475s/iter; left time: 1861.9372s
	iters: 1200, epoch: 3 | loss: 0.5740552
	speed: 0.0488s/iter; left time: 1908.0515s
	iters: 1300, epoch: 3 | loss: 0.5189540
	speed: 0.0483s/iter; left time: 1885.4560s
	iters: 1400, epoch: 3 | loss: 0.6122043
	speed: 0.0513s/iter; left time: 1996.5968s
	iters: 1500, epoch: 3 | loss: 0.8934925
	speed: 0.0475s/iter; left time: 1842.2262s
	iters: 1600, epoch: 3 | loss: 0.5533135
	speed: 0.0477s/iter; left time: 1845.4013s
	iters: 1700, epoch: 3 | loss: 0.5005925
	speed: 0.0492s/iter; left time: 1899.9550s
	iters: 1800, epoch: 3 | loss: 0.7025180
	speed: 0.0546s/iter; left time: 2102.1298s
	iters: 1900, epoch: 3 | loss: 0.6288592
	speed: 0.0480s/iter; left time: 1844.4915s
	iters: 2000, epoch: 3 | loss: 0.5611277
	speed: 0.0455s/iter; left time: 1742.7688s
	iters: 2100, epoch: 3 | loss: 0.6918221
	speed: 0.0481s/iter; left time: 1836.7316s
	iters: 2200, epoch: 3 | loss: 0.7695497
	speed: 0.0400s/iter; left time: 1525.2890s
Epoch: 3 cost time: 109.99488639831543
Epoch: 3, Steps: 2239 | Train Loss: 0.8069900 Vali Loss: 0.6663692 Test Loss: 0.3644079
Validation loss decreased (0.728380 --> 0.666369).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.9222074
	speed: 0.1595s/iter; left time: 6056.6048s
	iters: 200, epoch: 4 | loss: 0.6962337
	speed: 0.0482s/iter; left time: 1826.9349s
	iters: 300, epoch: 4 | loss: 0.4988693
	speed: 0.0524s/iter; left time: 1979.0455s
	iters: 400, epoch: 4 | loss: 0.8756900
	speed: 0.0503s/iter; left time: 1892.6398s
	iters: 500, epoch: 4 | loss: 0.8565109
	speed: 0.0469s/iter; left time: 1760.9934s
	iters: 600, epoch: 4 | loss: 1.0013280
	speed: 0.0452s/iter; left time: 1694.9667s
	iters: 700, epoch: 4 | loss: 0.7092813
	speed: 0.0467s/iter; left time: 1743.8031s
	iters: 800, epoch: 4 | loss: 0.5826871
	speed: 0.0495s/iter; left time: 1842.7599s
	iters: 900, epoch: 4 | loss: 0.5447652
	speed: 0.0491s/iter; left time: 1823.2147s
	iters: 1000, epoch: 4 | loss: 0.4900842
	speed: 0.0493s/iter; left time: 1825.5215s
	iters: 1100, epoch: 4 | loss: 0.4421761
	speed: 0.0475s/iter; left time: 1757.6151s
	iters: 1200, epoch: 4 | loss: 0.4964932
	speed: 0.0493s/iter; left time: 1818.5797s
	iters: 1300, epoch: 4 | loss: 0.4019514
	speed: 0.0460s/iter; left time: 1692.9664s
	iters: 1400, epoch: 4 | loss: 0.5778482
	speed: 0.0499s/iter; left time: 1829.6138s
	iters: 1500, epoch: 4 | loss: 0.7596353
	speed: 0.0501s/iter; left time: 1831.4772s
	iters: 1600, epoch: 4 | loss: 0.7628027
	speed: 0.0521s/iter; left time: 1899.7703s
	iters: 1700, epoch: 4 | loss: 0.4838338
	speed: 0.0503s/iter; left time: 1828.3553s
	iters: 1800, epoch: 4 | loss: 0.4700755
	speed: 0.0498s/iter; left time: 1807.1098s
	iters: 1900, epoch: 4 | loss: 0.6483467
	speed: 0.0481s/iter; left time: 1737.7059s
	iters: 2000, epoch: 4 | loss: 0.5462657
	speed: 0.0473s/iter; left time: 1707.0710s
	iters: 2100, epoch: 4 | loss: 0.4087959
	speed: 0.0526s/iter; left time: 1893.0593s
	iters: 2200, epoch: 4 | loss: 0.5393329
	speed: 0.0422s/iter; left time: 1512.7084s
Epoch: 4 cost time: 108.75244903564453
Epoch: 4, Steps: 2239 | Train Loss: 0.6595719 Vali Loss: 0.6408367 Test Loss: 0.3357827
Validation loss decreased (0.666369 --> 0.640837).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.4513294
	speed: 0.1554s/iter; left time: 5552.5292s
	iters: 200, epoch: 5 | loss: 0.4127523
	speed: 0.0529s/iter; left time: 1883.1290s
	iters: 300, epoch: 5 | loss: 0.7394801
	speed: 0.0493s/iter; left time: 1751.3638s
	iters: 400, epoch: 5 | loss: 1.0052162
	speed: 0.0534s/iter; left time: 1890.9738s
	iters: 500, epoch: 5 | loss: 0.7040861
	speed: 0.0509s/iter; left time: 1799.2057s
	iters: 600, epoch: 5 | loss: 0.7234405
	speed: 0.0501s/iter; left time: 1764.9830s
	iters: 700, epoch: 5 | loss: 0.4948780
	speed: 0.0512s/iter; left time: 1798.1158s
	iters: 800, epoch: 5 | loss: 0.4306865
	speed: 0.0534s/iter; left time: 1868.9781s
	iters: 900, epoch: 5 | loss: 0.5051167
	speed: 0.0473s/iter; left time: 1651.5993s
	iters: 1000, epoch: 5 | loss: 1.0891849
	speed: 0.0543s/iter; left time: 1889.8790s
	iters: 1100, epoch: 5 | loss: 0.4969347
	speed: 0.0480s/iter; left time: 1666.1194s
	iters: 1200, epoch: 5 | loss: 0.3884985
	speed: 0.0535s/iter; left time: 1850.9064s
	iters: 1300, epoch: 5 | loss: 0.7180185
	speed: 0.0573s/iter; left time: 1979.7672s
	iters: 1400, epoch: 5 | loss: 0.4192286
	speed: 0.0557s/iter; left time: 1915.9023s
	iters: 1500, epoch: 5 | loss: 0.5242814
	speed: 0.0546s/iter; left time: 1872.7327s
	iters: 1600, epoch: 5 | loss: 0.6516472
	speed: 0.0481s/iter; left time: 1646.2442s
	iters: 1700, epoch: 5 | loss: 0.4339071
	speed: 0.0518s/iter; left time: 1769.3353s
	iters: 1800, epoch: 5 | loss: 0.3844248
	speed: 0.0518s/iter; left time: 1763.5887s
	iters: 1900, epoch: 5 | loss: 0.7939150
	speed: 0.0536s/iter; left time: 1817.0225s
	iters: 2000, epoch: 5 | loss: 0.4272327
	speed: 0.0508s/iter; left time: 1717.6923s
	iters: 2100, epoch: 5 | loss: 0.4706658
	speed: 0.0436s/iter; left time: 1470.6526s
	iters: 2200, epoch: 5 | loss: 0.5378333
	speed: 0.0365s/iter; left time: 1228.9023s
Epoch: 5 cost time: 113.36988162994385
Epoch: 5, Steps: 2239 | Train Loss: 0.6186656 Vali Loss: 0.5980696 Test Loss: 0.3379541
Validation loss decreased (0.640837 --> 0.598070).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.5022423
	speed: 0.1642s/iter; left time: 5496.7673s
	iters: 200, epoch: 6 | loss: 0.5493560
	speed: 0.0486s/iter; left time: 1621.3411s
	iters: 300, epoch: 6 | loss: 0.4691544
	speed: 0.0486s/iter; left time: 1617.1826s
	iters: 400, epoch: 6 | loss: 0.5525975
	speed: 0.0444s/iter; left time: 1473.6158s
	iters: 500, epoch: 6 | loss: 0.5365763
	speed: 0.0511s/iter; left time: 1690.5698s
	iters: 600, epoch: 6 | loss: 0.7299861
	speed: 0.0478s/iter; left time: 1576.9735s
	iters: 700, epoch: 6 | loss: 0.5097785
	speed: 0.0451s/iter; left time: 1482.7157s
	iters: 800, epoch: 6 | loss: 0.5398012
	speed: 0.0516s/iter; left time: 1693.3882s
	iters: 900, epoch: 6 | loss: 0.7713747
	speed: 0.0454s/iter; left time: 1483.4428s
	iters: 1000, epoch: 6 | loss: 0.5136585
	speed: 0.0479s/iter; left time: 1559.8927s
	iters: 1100, epoch: 6 | loss: 0.7844518
	speed: 0.0480s/iter; left time: 1560.5472s
	iters: 1200, epoch: 6 | loss: 0.5651587
	speed: 0.0512s/iter; left time: 1658.7123s
	iters: 1300, epoch: 6 | loss: 0.7406060
	speed: 0.0502s/iter; left time: 1619.8828s
	iters: 1400, epoch: 6 | loss: 0.4453956
	speed: 0.0445s/iter; left time: 1433.2779s
	iters: 1500, epoch: 6 | loss: 0.3994645
	speed: 0.0439s/iter; left time: 1408.4038s
	iters: 1600, epoch: 6 | loss: 0.4804245
	speed: 0.0518s/iter; left time: 1657.6897s
	iters: 1700, epoch: 6 | loss: 0.4614862
	speed: 0.0502s/iter; left time: 1601.1589s
	iters: 1800, epoch: 6 | loss: 0.6307084
	speed: 0.0520s/iter; left time: 1652.6864s
	iters: 1900, epoch: 6 | loss: 0.5124136
	speed: 0.0490s/iter; left time: 1551.3545s
	iters: 2000, epoch: 6 | loss: 0.6769068
	speed: 0.0474s/iter; left time: 1498.5032s
	iters: 2100, epoch: 6 | loss: 0.5106899
	speed: 0.0458s/iter; left time: 1441.5443s
	iters: 2200, epoch: 6 | loss: 0.6969054
	speed: 0.0407s/iter; left time: 1276.1614s
Epoch: 6 cost time: 106.48797965049744
Epoch: 6, Steps: 2239 | Train Loss: 0.6018184 Vali Loss: 0.6089932 Test Loss: 0.3254069
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.4940166
	speed: 0.1509s/iter; left time: 4713.7572s
	iters: 200, epoch: 7 | loss: 0.4460598
	speed: 0.0543s/iter; left time: 1690.1546s
	iters: 300, epoch: 7 | loss: 0.5757656
	speed: 0.0546s/iter; left time: 1693.6411s
	iters: 400, epoch: 7 | loss: 0.4583491
	speed: 0.0505s/iter; left time: 1562.7812s
	iters: 500, epoch: 7 | loss: 0.4779296
	speed: 0.0512s/iter; left time: 1577.8590s
	iters: 600, epoch: 7 | loss: 0.4140697
	speed: 0.0519s/iter; left time: 1594.7825s
	iters: 700, epoch: 7 | loss: 0.9833545
	speed: 0.0504s/iter; left time: 1545.6523s
	iters: 800, epoch: 7 | loss: 0.4450568
	speed: 0.0506s/iter; left time: 1544.3921s
	iters: 900, epoch: 7 | loss: 0.3900599
	speed: 0.0424s/iter; left time: 1291.3701s
	iters: 1000, epoch: 7 | loss: 0.6754117
	speed: 0.0501s/iter; left time: 1519.5046s
	iters: 1100, epoch: 7 | loss: 0.4595275
	speed: 0.0483s/iter; left time: 1462.1373s
	iters: 1200, epoch: 7 | loss: 0.5625414
	speed: 0.0478s/iter; left time: 1440.5685s
	iters: 1300, epoch: 7 | loss: 0.3911964
	speed: 0.0516s/iter; left time: 1550.5290s
	iters: 1400, epoch: 7 | loss: 0.5106892
	speed: 0.0502s/iter; left time: 1503.4199s
	iters: 1500, epoch: 7 | loss: 0.7389272
	speed: 0.0472s/iter; left time: 1407.8925s
	iters: 1600, epoch: 7 | loss: 0.4267819
	speed: 0.0531s/iter; left time: 1578.2914s
	iters: 1700, epoch: 7 | loss: 0.5662748
	speed: 0.0481s/iter; left time: 1424.5578s
	iters: 1800, epoch: 7 | loss: 0.4583301
	speed: 0.0556s/iter; left time: 1643.4499s
	iters: 1900, epoch: 7 | loss: 0.4539470
	speed: 0.0551s/iter; left time: 1622.4587s
	iters: 2000, epoch: 7 | loss: 0.6643431
	speed: 0.0495s/iter; left time: 1453.8241s
	iters: 2100, epoch: 7 | loss: 0.6156217
	speed: 0.0476s/iter; left time: 1393.2488s
	iters: 2200, epoch: 7 | loss: 0.5533363
	speed: 0.0404s/iter; left time: 1177.0676s
Epoch: 7 cost time: 111.53884029388428
Epoch: 7, Steps: 2239 | Train Loss: 0.5937999 Vali Loss: 0.5906767 Test Loss: 0.3257015
Validation loss decreased (0.598070 --> 0.590677).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.5127373
	speed: 0.1574s/iter; left time: 4564.7330s
	iters: 200, epoch: 8 | loss: 0.5226324
	speed: 0.0481s/iter; left time: 1389.0476s
	iters: 300, epoch: 8 | loss: 0.3598316
	speed: 0.0474s/iter; left time: 1365.2975s
	iters: 400, epoch: 8 | loss: 0.8630320
	speed: 0.0532s/iter; left time: 1526.7635s
	iters: 500, epoch: 8 | loss: 0.5144408
	speed: 0.0534s/iter; left time: 1528.7954s
	iters: 600, epoch: 8 | loss: 0.5967616
	speed: 0.0491s/iter; left time: 1398.9200s
	iters: 700, epoch: 8 | loss: 0.6396798
	speed: 0.0482s/iter; left time: 1368.5911s
	iters: 800, epoch: 8 | loss: 0.4298989
	speed: 0.0516s/iter; left time: 1459.3704s
	iters: 900, epoch: 8 | loss: 0.4962701
	speed: 0.0521s/iter; left time: 1468.6503s
	iters: 1000, epoch: 8 | loss: 0.4785814
	speed: 0.0511s/iter; left time: 1436.5990s
	iters: 1100, epoch: 8 | loss: 0.4338384
	speed: 0.0478s/iter; left time: 1338.0006s
	iters: 1200, epoch: 8 | loss: 0.4730918
	speed: 0.0517s/iter; left time: 1443.5787s
	iters: 1300, epoch: 8 | loss: 0.5131240
	speed: 0.0522s/iter; left time: 1451.0296s
	iters: 1400, epoch: 8 | loss: 0.5064569
	speed: 0.0428s/iter; left time: 1186.3961s
	iters: 1500, epoch: 8 | loss: 0.9208190
	speed: 0.0511s/iter; left time: 1410.2844s
	iters: 1600, epoch: 8 | loss: 0.4540943
	speed: 0.0527s/iter; left time: 1448.8315s
	iters: 1700, epoch: 8 | loss: 0.6701208
	speed: 0.0526s/iter; left time: 1441.2324s
	iters: 1800, epoch: 8 | loss: 0.4227789
	speed: 0.0560s/iter; left time: 1529.8209s
	iters: 1900, epoch: 8 | loss: 0.7281397
	speed: 0.0522s/iter; left time: 1419.2250s
	iters: 2000, epoch: 8 | loss: 0.4314928
	speed: 0.0528s/iter; left time: 1432.0457s
	iters: 2100, epoch: 8 | loss: 0.4941455
	speed: 0.0429s/iter; left time: 1158.8740s
	iters: 2200, epoch: 8 | loss: 0.6981281
	speed: 0.0372s/iter; left time: 999.8121s
Epoch: 8 cost time: 110.88886213302612
Epoch: 8, Steps: 2239 | Train Loss: 0.5898263 Vali Loss: 0.5974783 Test Loss: 0.3199354
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.6444750
	speed: 0.1591s/iter; left time: 4259.0369s
	iters: 200, epoch: 9 | loss: 0.4002344
	speed: 0.0500s/iter; left time: 1334.7085s
	iters: 300, epoch: 9 | loss: 0.4388853
	speed: 0.0477s/iter; left time: 1268.3994s
	iters: 400, epoch: 9 | loss: 0.4187784
	speed: 0.0446s/iter; left time: 1181.1253s
	iters: 500, epoch: 9 | loss: 0.4642837
	speed: 0.0448s/iter; left time: 1181.8032s
	iters: 600, epoch: 9 | loss: 0.5738239
	speed: 0.0540s/iter; left time: 1417.8531s
	iters: 700, epoch: 9 | loss: 0.4616958
	speed: 0.0491s/iter; left time: 1284.3828s
	iters: 800, epoch: 9 | loss: 0.4786326
	speed: 0.0480s/iter; left time: 1252.2517s
	iters: 900, epoch: 9 | loss: 0.5771884
	speed: 0.0500s/iter; left time: 1297.6829s
	iters: 1000, epoch: 9 | loss: 0.6446487
	speed: 0.0512s/iter; left time: 1324.1737s
	iters: 1100, epoch: 9 | loss: 0.6689331
	speed: 0.0510s/iter; left time: 1314.2915s
	iters: 1200, epoch: 9 | loss: 0.4778946
	speed: 0.0458s/iter; left time: 1174.4972s
	iters: 1300, epoch: 9 | loss: 0.7258553
	speed: 0.0505s/iter; left time: 1290.8693s
	iters: 1400, epoch: 9 | loss: 0.5295852
	speed: 0.0494s/iter; left time: 1257.5866s
	iters: 1500, epoch: 9 | loss: 0.5586587
	speed: 0.0494s/iter; left time: 1253.1375s
	iters: 1600, epoch: 9 | loss: 0.4451799
	speed: 0.0504s/iter; left time: 1273.2811s
	iters: 1700, epoch: 9 | loss: 0.4338062
	speed: 0.0497s/iter; left time: 1251.9907s
	iters: 1800, epoch: 9 | loss: 0.6738114
	speed: 0.0471s/iter; left time: 1180.7289s
	iters: 1900, epoch: 9 | loss: 0.4445504
	speed: 0.0536s/iter; left time: 1338.9844s
	iters: 2000, epoch: 9 | loss: 0.5592244
	speed: 0.0566s/iter; left time: 1408.1065s
	iters: 2100, epoch: 9 | loss: 0.3569668
	speed: 0.0468s/iter; left time: 1158.3705s
	iters: 2200, epoch: 9 | loss: 0.4517106
	speed: 0.0390s/iter; left time: 961.3774s
Epoch: 9 cost time: 108.97646832466125
Epoch: 9, Steps: 2239 | Train Loss: 0.5879279 Vali Loss: 0.5912257 Test Loss: 0.3168476
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.4407813
	speed: 0.1625s/iter; left time: 3985.3174s
	iters: 200, epoch: 10 | loss: 0.4518723
	speed: 0.0492s/iter; left time: 1202.0133s
	iters: 300, epoch: 10 | loss: 0.6627884
	speed: 0.0492s/iter; left time: 1196.8011s
	iters: 400, epoch: 10 | loss: 0.7466922
	speed: 0.0558s/iter; left time: 1350.9831s
	iters: 500, epoch: 10 | loss: 0.4377004
	speed: 0.0490s/iter; left time: 1183.0135s
	iters: 600, epoch: 10 | loss: 0.4891042
	speed: 0.0483s/iter; left time: 1160.4828s
	iters: 700, epoch: 10 | loss: 0.4837619
	speed: 0.0440s/iter; left time: 1053.4178s
	iters: 800, epoch: 10 | loss: 0.5460902
	speed: 0.0475s/iter; left time: 1132.2436s
	iters: 900, epoch: 10 | loss: 0.5141987
	speed: 0.0508s/iter; left time: 1205.9941s
	iters: 1000, epoch: 10 | loss: 0.5310193
	speed: 0.0502s/iter; left time: 1185.0476s
	iters: 1100, epoch: 10 | loss: 0.5336127
	speed: 0.0484s/iter; left time: 1138.0920s
	iters: 1200, epoch: 10 | loss: 0.4642123
	speed: 0.0477s/iter; left time: 1117.4525s
	iters: 1300, epoch: 10 | loss: 0.4297641
	speed: 0.0471s/iter; left time: 1097.7120s
	iters: 1400, epoch: 10 | loss: 0.5408161
	speed: 0.0508s/iter; left time: 1181.1924s
	iters: 1500, epoch: 10 | loss: 0.6669657
	speed: 0.0501s/iter; left time: 1159.4816s
	iters: 1600, epoch: 10 | loss: 0.6979239
	speed: 0.0451s/iter; left time: 1039.2503s
	iters: 1700, epoch: 10 | loss: 0.3687930
	speed: 0.0511s/iter; left time: 1171.9916s
	iters: 1800, epoch: 10 | loss: 0.3480199
	speed: 0.0477s/iter; left time: 1089.6057s
	iters: 1900, epoch: 10 | loss: 0.4405999
	speed: 0.0520s/iter; left time: 1181.6462s
	iters: 2000, epoch: 10 | loss: 0.4197045
	speed: 0.0504s/iter; left time: 1141.5976s
	iters: 2100, epoch: 10 | loss: 0.4118526
	speed: 0.0474s/iter; left time: 1066.8534s
	iters: 2200, epoch: 10 | loss: 0.4317646
	speed: 0.0406s/iter; left time: 911.6548s
Epoch: 10 cost time: 108.41500163078308
Epoch: 10, Steps: 2239 | Train Loss: 0.5869298 Vali Loss: 0.5908591 Test Loss: 0.3189944
EarlyStopping counter: 3 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.4756247
	speed: 0.1605s/iter; left time: 3578.5178s
	iters: 200, epoch: 11 | loss: 0.4304568
	speed: 0.0464s/iter; left time: 1030.3153s
	iters: 300, epoch: 11 | loss: 0.8481029
	speed: 0.0484s/iter; left time: 1068.9000s
	iters: 400, epoch: 11 | loss: 0.4568762
	speed: 0.0525s/iter; left time: 1154.4632s
	iters: 500, epoch: 11 | loss: 0.5376045
	speed: 0.0494s/iter; left time: 1082.0717s
	iters: 600, epoch: 11 | loss: 0.5047262
	speed: 0.0520s/iter; left time: 1133.0065s
	iters: 700, epoch: 11 | loss: 0.4532999
	speed: 0.0469s/iter; left time: 1016.3589s
	iters: 800, epoch: 11 | loss: 0.4620640
	speed: 0.0522s/iter; left time: 1127.5948s
	iters: 900, epoch: 11 | loss: 0.5981751
	speed: 0.0536s/iter; left time: 1152.1796s
	iters: 1000, epoch: 11 | loss: 0.3972552
	speed: 0.0507s/iter; left time: 1084.6701s
	iters: 1100, epoch: 11 | loss: 0.6172943
	speed: 0.0531s/iter; left time: 1129.5166s
	iters: 1200, epoch: 11 | loss: 0.4945687
	speed: 0.0467s/iter; left time: 990.3105s
	iters: 1300, epoch: 11 | loss: 0.7058340
	speed: 0.0494s/iter; left time: 1041.8571s
	iters: 1400, epoch: 11 | loss: 0.3296669
	speed: 0.0501s/iter; left time: 1051.3941s
	iters: 1500, epoch: 11 | loss: 0.4369027
	speed: 0.0547s/iter; left time: 1141.8943s
	iters: 1600, epoch: 11 | loss: 0.4477103
	speed: 0.0538s/iter; left time: 1118.8401s
	iters: 1700, epoch: 11 | loss: 1.3023126
	speed: 0.0527s/iter; left time: 1089.9229s
	iters: 1800, epoch: 11 | loss: 0.4945666
	speed: 0.0490s/iter; left time: 1009.0089s
	iters: 1900, epoch: 11 | loss: 0.4431412
	speed: 0.0516s/iter; left time: 1057.0488s
	iters: 2000, epoch: 11 | loss: 0.4523711
	speed: 0.0472s/iter; left time: 963.1165s
	iters: 2100, epoch: 11 | loss: 0.6214154
	speed: 0.0425s/iter; left time: 862.2306s
	iters: 2200, epoch: 11 | loss: 0.4307774
	speed: 0.0352s/iter; left time: 710.2435s
Epoch: 11 cost time: 109.94758749008179
Epoch: 11, Steps: 2239 | Train Loss: 0.5863749 Vali Loss: 0.5905769 Test Loss: 0.3164804
Validation loss decreased (0.590677 --> 0.590577).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.9231623
	speed: 0.1534s/iter; left time: 3076.0617s
	iters: 200, epoch: 12 | loss: 0.3237557
	speed: 0.0495s/iter; left time: 987.6807s
	iters: 300, epoch: 12 | loss: 0.4578157
	speed: 0.0507s/iter; left time: 1005.9471s
	iters: 400, epoch: 12 | loss: 0.5505803
	speed: 0.0444s/iter; left time: 876.6094s
	iters: 500, epoch: 12 | loss: 0.9802907
	speed: 0.0443s/iter; left time: 870.4153s
	iters: 600, epoch: 12 | loss: 0.6501674
	speed: 0.0474s/iter; left time: 925.8964s
	iters: 700, epoch: 12 | loss: 0.6049868
	speed: 0.0507s/iter; left time: 985.4243s
	iters: 800, epoch: 12 | loss: 0.4691803
	speed: 0.0442s/iter; left time: 855.1188s
	iters: 900, epoch: 12 | loss: 0.5779698
	speed: 0.0414s/iter; left time: 797.4794s
	iters: 1000, epoch: 12 | loss: 0.4453003
	speed: 0.0418s/iter; left time: 799.9616s
	iters: 1100, epoch: 12 | loss: 0.5991296
	speed: 0.0440s/iter; left time: 837.6085s
	iters: 1200, epoch: 12 | loss: 0.4107066
	speed: 0.0426s/iter; left time: 807.2211s
	iters: 1300, epoch: 12 | loss: 0.4861118
	speed: 0.0442s/iter; left time: 832.7146s
	iters: 1400, epoch: 12 | loss: 0.4739656
	speed: 0.0428s/iter; left time: 802.5636s
	iters: 1500, epoch: 12 | loss: 0.7485564
	speed: 0.0461s/iter; left time: 859.2050s
	iters: 1600, epoch: 12 | loss: 0.4606395
	speed: 0.0423s/iter; left time: 784.3428s
	iters: 1700, epoch: 12 | loss: 0.5226774
	speed: 0.0450s/iter; left time: 831.1043s
	iters: 1800, epoch: 12 | loss: 0.8716013
	speed: 0.0402s/iter; left time: 738.2965s
	iters: 1900, epoch: 12 | loss: 0.6652067
	speed: 0.0395s/iter; left time: 721.6494s
	iters: 2000, epoch: 12 | loss: 0.6739603
	speed: 0.0394s/iter; left time: 715.8337s
	iters: 2100, epoch: 12 | loss: 0.7858795
	speed: 0.0347s/iter; left time: 626.3515s
	iters: 2200, epoch: 12 | loss: 2.6215260
	speed: 0.0352s/iter; left time: 632.6158s
Epoch: 12 cost time: 96.58855032920837
Epoch: 12, Steps: 2239 | Train Loss: 0.5860808 Vali Loss: 0.5910080 Test Loss: 0.3170037
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.8971453
	speed: 0.1398s/iter; left time: 2490.2621s
	iters: 200, epoch: 13 | loss: 0.4485869
	speed: 0.0415s/iter; left time: 735.2937s
	iters: 300, epoch: 13 | loss: 0.5760700
	speed: 0.0424s/iter; left time: 747.5650s
	iters: 400, epoch: 13 | loss: 0.5735356
	speed: 0.0431s/iter; left time: 754.6090s
	iters: 500, epoch: 13 | loss: 0.5401774
	speed: 0.0431s/iter; left time: 750.9638s
	iters: 600, epoch: 13 | loss: 0.7568749
	speed: 0.0440s/iter; left time: 761.6434s
	iters: 700, epoch: 13 | loss: 0.7424706
	speed: 0.0409s/iter; left time: 703.4089s
	iters: 800, epoch: 13 | loss: 0.4438076
	speed: 0.0401s/iter; left time: 685.6365s
	iters: 900, epoch: 13 | loss: 0.6314412
	speed: 0.0423s/iter; left time: 719.4208s
	iters: 1000, epoch: 13 | loss: 0.7844393
	speed: 0.0436s/iter; left time: 737.9073s
	iters: 1100, epoch: 13 | loss: 0.4171170
	speed: 0.0409s/iter; left time: 687.4068s
	iters: 1200, epoch: 13 | loss: 0.7777098
	speed: 0.0421s/iter; left time: 703.0295s
	iters: 1300, epoch: 13 | loss: 0.7778854
	speed: 0.0431s/iter; left time: 716.7212s
	iters: 1400, epoch: 13 | loss: 0.6907480
	speed: 0.0434s/iter; left time: 716.6128s
	iters: 1500, epoch: 13 | loss: 0.3960228
	speed: 0.0431s/iter; left time: 707.0168s
	iters: 1600, epoch: 13 | loss: 0.4429547
	speed: 0.0430s/iter; left time: 701.8190s
	iters: 1700, epoch: 13 | loss: 0.4605095
	speed: 0.0416s/iter; left time: 674.0492s
	iters: 1800, epoch: 13 | loss: 0.5530311
	speed: 0.0398s/iter; left time: 641.9291s
	iters: 1900, epoch: 13 | loss: 0.4030956
	speed: 0.0439s/iter; left time: 702.9956s
	iters: 2000, epoch: 13 | loss: 0.4537213
	speed: 0.0412s/iter; left time: 656.3022s
	iters: 2100, epoch: 13 | loss: 0.6358486
	speed: 0.0342s/iter; left time: 540.5735s
	iters: 2200, epoch: 13 | loss: 0.4536856
	speed: 0.0340s/iter; left time: 534.1075s
Epoch: 13 cost time: 92.37695336341858
Epoch: 13, Steps: 2239 | Train Loss: 0.5859091 Vali Loss: 0.5929631 Test Loss: 0.3173162
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.4948510
	speed: 0.1336s/iter; left time: 2080.9108s
	iters: 200, epoch: 14 | loss: 0.4543737
	speed: 0.0388s/iter; left time: 600.9213s
	iters: 300, epoch: 14 | loss: 0.4853458
	speed: 0.0407s/iter; left time: 625.3714s
	iters: 400, epoch: 14 | loss: 0.5334520
	speed: 0.0369s/iter; left time: 563.7063s
	iters: 500, epoch: 14 | loss: 0.8882493
	speed: 0.0366s/iter; left time: 555.1432s
	iters: 600, epoch: 14 | loss: 0.5656304
	speed: 0.0363s/iter; left time: 546.9213s
	iters: 700, epoch: 14 | loss: 0.8956434
	speed: 0.0355s/iter; left time: 531.9517s
	iters: 800, epoch: 14 | loss: 0.5765803
	speed: 0.0363s/iter; left time: 540.6490s
	iters: 900, epoch: 14 | loss: 0.4079199
	speed: 0.0372s/iter; left time: 549.4342s
	iters: 1000, epoch: 14 | loss: 0.6397012
	speed: 0.0364s/iter; left time: 533.5569s
	iters: 1100, epoch: 14 | loss: 0.4879299
	speed: 0.0372s/iter; left time: 541.5277s
	iters: 1200, epoch: 14 | loss: 0.8148254
	speed: 0.0369s/iter; left time: 534.3054s
	iters: 1300, epoch: 14 | loss: 0.4945749
	speed: 0.0363s/iter; left time: 522.0455s
	iters: 1400, epoch: 14 | loss: 0.4528947
	speed: 0.0371s/iter; left time: 528.9556s
	iters: 1500, epoch: 14 | loss: 0.6114327
	speed: 0.0360s/iter; left time: 509.9885s
	iters: 1600, epoch: 14 | loss: 0.3875621
	speed: 0.0361s/iter; left time: 507.3814s
	iters: 1700, epoch: 14 | loss: 0.7659179
	speed: 0.0366s/iter; left time: 511.8298s
	iters: 1800, epoch: 14 | loss: 0.4419873
	speed: 0.0359s/iter; left time: 498.6904s
	iters: 1900, epoch: 14 | loss: 1.0727823
	speed: 0.0361s/iter; left time: 497.6616s
	iters: 2000, epoch: 14 | loss: 0.4244385
	speed: 0.0354s/iter; left time: 484.0692s
	iters: 2100, epoch: 14 | loss: 0.8202246
	speed: 0.0330s/iter; left time: 448.3285s
	iters: 2200, epoch: 14 | loss: 0.4998431
	speed: 0.0332s/iter; left time: 447.2985s
Epoch: 14 cost time: 81.5173921585083
Epoch: 14, Steps: 2239 | Train Loss: 0.5858814 Vali Loss: 0.5927055 Test Loss: 0.3172793
EarlyStopping counter: 3 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.7259412
	speed: 0.1170s/iter; left time: 1559.7096s
	iters: 200, epoch: 15 | loss: 0.4981471
	speed: 0.0334s/iter; left time: 442.1774s
	iters: 300, epoch: 15 | loss: 0.7891195
	speed: 0.0337s/iter; left time: 442.4562s
	iters: 400, epoch: 15 | loss: 0.5436664
	speed: 0.0344s/iter; left time: 448.8894s
	iters: 500, epoch: 15 | loss: 0.4701160
	speed: 0.0340s/iter; left time: 439.3958s
	iters: 600, epoch: 15 | loss: 0.6334685
	speed: 0.0338s/iter; left time: 433.7556s
	iters: 700, epoch: 15 | loss: 0.4977019
	speed: 0.0342s/iter; left time: 435.3044s
	iters: 800, epoch: 15 | loss: 0.4555006
	speed: 0.0337s/iter; left time: 426.0064s
	iters: 900, epoch: 15 | loss: 0.5938647
	speed: 0.0344s/iter; left time: 431.8088s
	iters: 1000, epoch: 15 | loss: 0.5452833
	speed: 0.0348s/iter; left time: 432.7494s
	iters: 1100, epoch: 15 | loss: 0.4851514
	speed: 0.0347s/iter; left time: 428.6283s
	iters: 1200, epoch: 15 | loss: 0.4307119
	speed: 0.0341s/iter; left time: 417.6644s
	iters: 1300, epoch: 15 | loss: 0.6888808
	speed: 0.0343s/iter; left time: 416.3161s
	iters: 1400, epoch: 15 | loss: 0.6504475
	speed: 0.0331s/iter; left time: 398.4027s
	iters: 1500, epoch: 15 | loss: 0.5070456
	speed: 0.0342s/iter; left time: 408.7341s
	iters: 1600, epoch: 15 | loss: 0.4310520
	speed: 0.0332s/iter; left time: 392.9148s
	iters: 1700, epoch: 15 | loss: 0.4426912
	speed: 0.0328s/iter; left time: 384.8554s
	iters: 1800, epoch: 15 | loss: 0.5586703
	speed: 0.0352s/iter; left time: 410.0764s
	iters: 1900, epoch: 15 | loss: 0.4508208
	speed: 0.0335s/iter; left time: 386.6140s
	iters: 2000, epoch: 15 | loss: 0.5570654
	speed: 0.0345s/iter; left time: 394.8943s
	iters: 2100, epoch: 15 | loss: 0.4926757
	speed: 0.0322s/iter; left time: 364.5783s
	iters: 2200, epoch: 15 | loss: 0.4495273
	speed: 0.0323s/iter; left time: 362.6313s
Epoch: 15 cost time: 75.51927638053894
Epoch: 15, Steps: 2239 | Train Loss: 0.5855486 Vali Loss: 0.5923496 Test Loss: 0.3172475
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 1.0042590
	speed: 0.1208s/iter; left time: 1339.9935s
	iters: 200, epoch: 16 | loss: 0.6988974
	speed: 0.0346s/iter; left time: 380.4358s
	iters: 300, epoch: 16 | loss: 0.3867407
	speed: 0.0330s/iter; left time: 359.7777s
	iters: 400, epoch: 16 | loss: 0.4273325
	speed: 0.0322s/iter; left time: 347.1845s
	iters: 500, epoch: 16 | loss: 0.4908961
	speed: 0.0324s/iter; left time: 346.8344s
	iters: 600, epoch: 16 | loss: 0.7924165
	speed: 0.0319s/iter; left time: 337.5532s
	iters: 700, epoch: 16 | loss: 0.5171205
	speed: 0.0322s/iter; left time: 337.8268s
	iters: 800, epoch: 16 | loss: 0.6556481
	speed: 0.0327s/iter; left time: 339.7950s
	iters: 900, epoch: 16 | loss: 0.4159252
	speed: 0.0325s/iter; left time: 335.1167s
	iters: 1000, epoch: 16 | loss: 0.4675855
	speed: 0.0325s/iter; left time: 331.1291s
	iters: 1100, epoch: 16 | loss: 0.5575669
	speed: 0.0345s/iter; left time: 348.1703s
	iters: 1200, epoch: 16 | loss: 1.3612958
	speed: 0.0341s/iter; left time: 340.6280s
	iters: 1300, epoch: 16 | loss: 1.1267179
	speed: 0.0332s/iter; left time: 328.8537s
	iters: 1400, epoch: 16 | loss: 0.3995917
	speed: 0.0335s/iter; left time: 328.5274s
	iters: 1500, epoch: 16 | loss: 0.5051210
	speed: 0.0350s/iter; left time: 338.9622s
	iters: 1600, epoch: 16 | loss: 0.3901730
	speed: 0.0334s/iter; left time: 320.9448s
	iters: 1700, epoch: 16 | loss: 0.3931663
	speed: 0.0333s/iter; left time: 316.6759s
	iters: 1800, epoch: 16 | loss: 0.4508004
	speed: 0.0332s/iter; left time: 312.1507s
	iters: 1900, epoch: 16 | loss: 0.5593415
	speed: 0.0330s/iter; left time: 307.1952s
	iters: 2000, epoch: 16 | loss: 0.4241129
	speed: 0.0343s/iter; left time: 315.8059s
	iters: 2100, epoch: 16 | loss: 0.6276386
	speed: 0.0319s/iter; left time: 290.5565s
	iters: 2200, epoch: 16 | loss: 0.5119598
	speed: 0.0329s/iter; left time: 295.6748s
Epoch: 16 cost time: 74.06290006637573
Epoch: 16, Steps: 2239 | Train Loss: 0.5858320 Vali Loss: 0.5930085 Test Loss: 0.3172520
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : weather_336_720_Linear_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3144<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9820
mse:0.31641992926597595, mae:0.35906684398651123
