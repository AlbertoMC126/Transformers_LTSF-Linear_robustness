Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='Linear', model_id='ETTm2_336_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=336, root_path='./dataset/', save_pred_values=False, seed=15726, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTm2_336_336_Linear_ETTm2_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15726>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33889
val 11185
test 11185
	iters: 100, epoch: 1 | loss: 0.4319950
	speed: 0.0094s/iter; left time: 197.2832s
	iters: 200, epoch: 1 | loss: 0.4737702
	speed: 0.0090s/iter; left time: 189.0962s
	iters: 300, epoch: 1 | loss: 0.3872059
	speed: 0.0094s/iter; left time: 196.1259s
	iters: 400, epoch: 1 | loss: 0.6868003
	speed: 0.0092s/iter; left time: 191.5093s
	iters: 500, epoch: 1 | loss: 0.4717129
	speed: 0.0085s/iter; left time: 176.5567s
	iters: 600, epoch: 1 | loss: 0.7512417
	speed: 0.0092s/iter; left time: 190.2304s
	iters: 700, epoch: 1 | loss: 0.8600254
	speed: 0.0084s/iter; left time: 171.0489s
	iters: 800, epoch: 1 | loss: 1.0299610
	speed: 0.0088s/iter; left time: 178.8107s
	iters: 900, epoch: 1 | loss: 0.4356308
	speed: 0.0095s/iter; left time: 192.3019s
	iters: 1000, epoch: 1 | loss: 0.2789127
	speed: 0.0096s/iter; left time: 194.1960s
Epoch: 1 cost time: 9.553897857666016
Epoch: 1, Steps: 1059 | Train Loss: 0.6023094 Vali Loss: 0.4805031 Test Loss: 1.0345633
Validation loss decreased (inf --> 0.480503).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.4023131
	speed: 0.0347s/iter; left time: 694.1569s
	iters: 200, epoch: 2 | loss: 0.6890350
	speed: 0.0088s/iter; left time: 175.3210s
	iters: 300, epoch: 2 | loss: 0.6837140
	speed: 0.0091s/iter; left time: 180.7113s
	iters: 400, epoch: 2 | loss: 0.5064391
	speed: 0.0089s/iter; left time: 174.6076s
	iters: 500, epoch: 2 | loss: 1.0092280
	speed: 0.0087s/iter; left time: 170.9350s
	iters: 600, epoch: 2 | loss: 0.3204274
	speed: 0.0089s/iter; left time: 174.5588s
	iters: 700, epoch: 2 | loss: 0.2614051
	speed: 0.0093s/iter; left time: 180.0478s
	iters: 800, epoch: 2 | loss: 0.4607946
	speed: 0.0080s/iter; left time: 154.8553s
	iters: 900, epoch: 2 | loss: 1.3616819
	speed: 0.0082s/iter; left time: 158.0165s
	iters: 1000, epoch: 2 | loss: 0.7841076
	speed: 0.0081s/iter; left time: 155.1271s
Epoch: 2 cost time: 9.169452905654907
Epoch: 2, Steps: 1059 | Train Loss: 0.6021090 Vali Loss: 0.4201955 Test Loss: 0.6999617
Validation loss decreased (0.480503 --> 0.420196).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.2249274
	speed: 0.0358s/iter; left time: 678.1118s
	iters: 200, epoch: 3 | loss: 0.4095983
	speed: 0.0080s/iter; left time: 151.2813s
	iters: 300, epoch: 3 | loss: 0.5535650
	speed: 0.0082s/iter; left time: 154.6661s
	iters: 400, epoch: 3 | loss: 0.4455452
	speed: 0.0081s/iter; left time: 151.7636s
	iters: 500, epoch: 3 | loss: 0.3736747
	speed: 0.0086s/iter; left time: 158.9719s
	iters: 600, epoch: 3 | loss: 0.3447252
	speed: 0.0099s/iter; left time: 181.8657s
	iters: 700, epoch: 3 | loss: 0.3330490
	speed: 0.0093s/iter; left time: 170.2889s
	iters: 800, epoch: 3 | loss: 0.4600356
	speed: 0.0091s/iter; left time: 166.2368s
	iters: 900, epoch: 3 | loss: 0.3501309
	speed: 0.0086s/iter; left time: 156.3533s
	iters: 1000, epoch: 3 | loss: 0.3899620
	speed: 0.0083s/iter; left time: 149.0704s
Epoch: 3 cost time: 9.242032289505005
Epoch: 3, Steps: 1059 | Train Loss: 0.4319679 Vali Loss: 0.3755665 Test Loss: 0.7868493
Validation loss decreased (0.420196 --> 0.375567).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.1954737
	speed: 0.0351s/iter; left time: 627.7030s
	iters: 200, epoch: 4 | loss: 0.2566225
	speed: 0.0082s/iter; left time: 145.6954s
	iters: 300, epoch: 4 | loss: 0.2193073
	speed: 0.0089s/iter; left time: 157.9598s
	iters: 400, epoch: 4 | loss: 0.2042269
	speed: 0.0083s/iter; left time: 146.4473s
	iters: 500, epoch: 4 | loss: 0.4037040
	speed: 0.0088s/iter; left time: 154.6616s
	iters: 600, epoch: 4 | loss: 0.7672120
	speed: 0.0073s/iter; left time: 127.4594s
	iters: 700, epoch: 4 | loss: 0.2582081
	speed: 0.0084s/iter; left time: 146.0752s
	iters: 800, epoch: 4 | loss: 0.4090687
	speed: 0.0093s/iter; left time: 159.1787s
	iters: 900, epoch: 4 | loss: 0.3413691
	speed: 0.0088s/iter; left time: 150.0452s
	iters: 1000, epoch: 4 | loss: 0.3462296
	speed: 0.0088s/iter; left time: 150.3724s
Epoch: 4 cost time: 9.004554748535156
Epoch: 4, Steps: 1059 | Train Loss: 0.3910493 Vali Loss: 0.3355084 Test Loss: 0.6323258
Validation loss decreased (0.375567 --> 0.335508).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.4097809
	speed: 0.0365s/iter; left time: 614.9167s
	iters: 200, epoch: 5 | loss: 0.5054428
	speed: 0.0088s/iter; left time: 146.7423s
	iters: 300, epoch: 5 | loss: 0.2562263
	speed: 0.0074s/iter; left time: 122.3810s
	iters: 400, epoch: 5 | loss: 0.4008985
	speed: 0.0088s/iter; left time: 145.9741s
	iters: 500, epoch: 5 | loss: 0.3938873
	speed: 0.0088s/iter; left time: 145.1804s
	iters: 600, epoch: 5 | loss: 0.1825747
	speed: 0.0082s/iter; left time: 134.6829s
	iters: 700, epoch: 5 | loss: 0.2932098
	speed: 0.0082s/iter; left time: 133.7484s
	iters: 800, epoch: 5 | loss: 0.4482022
	speed: 0.0080s/iter; left time: 129.8358s
	iters: 900, epoch: 5 | loss: 0.3283937
	speed: 0.0082s/iter; left time: 132.0927s
	iters: 1000, epoch: 5 | loss: 0.7755154
	speed: 0.0081s/iter; left time: 128.7405s
Epoch: 5 cost time: 8.938200950622559
Epoch: 5, Steps: 1059 | Train Loss: 0.3726379 Vali Loss: 0.3081420 Test Loss: 0.6147453
Validation loss decreased (0.335508 --> 0.308142).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.4681903
	speed: 0.0315s/iter; left time: 496.9579s
	iters: 200, epoch: 6 | loss: 0.3253104
	speed: 0.0092s/iter; left time: 143.8566s
	iters: 300, epoch: 6 | loss: 0.3823764
	speed: 0.0079s/iter; left time: 123.2701s
	iters: 400, epoch: 6 | loss: 0.2737567
	speed: 0.0095s/iter; left time: 146.8464s
	iters: 500, epoch: 6 | loss: 0.2697257
	speed: 0.0081s/iter; left time: 124.3478s
	iters: 600, epoch: 6 | loss: 0.5332631
	speed: 0.0083s/iter; left time: 127.3744s
	iters: 700, epoch: 6 | loss: 0.5269402
	speed: 0.0085s/iter; left time: 129.0184s
	iters: 800, epoch: 6 | loss: 0.2479703
	speed: 0.0072s/iter; left time: 108.3429s
	iters: 900, epoch: 6 | loss: 0.4618887
	speed: 0.0066s/iter; left time: 98.7520s
	iters: 1000, epoch: 6 | loss: 0.3313226
	speed: 0.0076s/iter; left time: 112.8435s
Epoch: 6 cost time: 8.575016736984253
Epoch: 6, Steps: 1059 | Train Loss: 0.3622955 Vali Loss: 0.3353304 Test Loss: 0.6679761
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.2469607
	speed: 0.0346s/iter; left time: 509.9454s
	iters: 200, epoch: 7 | loss: 0.2953109
	speed: 0.0083s/iter; left time: 121.5362s
	iters: 300, epoch: 7 | loss: 0.2723993
	speed: 0.0084s/iter; left time: 122.2028s
	iters: 400, epoch: 7 | loss: 0.2969558
	speed: 0.0089s/iter; left time: 128.4649s
	iters: 500, epoch: 7 | loss: 0.5472087
	speed: 0.0092s/iter; left time: 132.1151s
	iters: 600, epoch: 7 | loss: 0.2130847
	speed: 0.0097s/iter; left time: 137.4674s
	iters: 700, epoch: 7 | loss: 0.1864285
	speed: 0.0085s/iter; left time: 120.5401s
	iters: 800, epoch: 7 | loss: 0.3574714
	speed: 0.0078s/iter; left time: 109.7091s
	iters: 900, epoch: 7 | loss: 0.2461834
	speed: 0.0083s/iter; left time: 115.8726s
	iters: 1000, epoch: 7 | loss: 0.3666783
	speed: 0.0076s/iter; left time: 105.3864s
Epoch: 7 cost time: 9.007016658782959
Epoch: 7, Steps: 1059 | Train Loss: 0.3560933 Vali Loss: 0.2484134 Test Loss: 0.4180078
Validation loss decreased (0.308142 --> 0.248413).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.3921970
	speed: 0.0320s/iter; left time: 436.9092s
	iters: 200, epoch: 8 | loss: 0.2583119
	speed: 0.0079s/iter; left time: 107.2105s
	iters: 300, epoch: 8 | loss: 0.2117529
	speed: 0.0075s/iter; left time: 100.5059s
	iters: 400, epoch: 8 | loss: 0.4596068
	speed: 0.0090s/iter; left time: 120.6213s
	iters: 500, epoch: 8 | loss: 0.2528222
	speed: 0.0084s/iter; left time: 111.2175s
	iters: 600, epoch: 8 | loss: 0.3013195
	speed: 0.0082s/iter; left time: 107.5636s
	iters: 700, epoch: 8 | loss: 0.3232079
	speed: 0.0084s/iter; left time: 110.0488s
	iters: 800, epoch: 8 | loss: 0.6065512
	speed: 0.0077s/iter; left time: 99.6228s
	iters: 900, epoch: 8 | loss: 0.3435774
	speed: 0.0074s/iter; left time: 94.6085s
	iters: 1000, epoch: 8 | loss: 0.3639124
	speed: 0.0081s/iter; left time: 103.5867s
Epoch: 8 cost time: 8.414477586746216
Epoch: 8, Steps: 1059 | Train Loss: 0.3523007 Vali Loss: 0.2668921 Test Loss: 0.4682886
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.2778516
	speed: 0.0340s/iter; left time: 428.1292s
	iters: 200, epoch: 9 | loss: 0.2763857
	speed: 0.0072s/iter; left time: 90.5974s
	iters: 300, epoch: 9 | loss: 0.2347216
	speed: 0.0083s/iter; left time: 102.5238s
	iters: 400, epoch: 9 | loss: 0.4637585
	speed: 0.0090s/iter; left time: 111.3770s
	iters: 500, epoch: 9 | loss: 0.7421651
	speed: 0.0083s/iter; left time: 101.1291s
	iters: 600, epoch: 9 | loss: 0.1892459
	speed: 0.0075s/iter; left time: 91.3794s
	iters: 700, epoch: 9 | loss: 0.7636548
	speed: 0.0075s/iter; left time: 90.1006s
	iters: 800, epoch: 9 | loss: 0.2581823
	speed: 0.0086s/iter; left time: 102.5654s
	iters: 900, epoch: 9 | loss: 0.1726378
	speed: 0.0083s/iter; left time: 98.0994s
	iters: 1000, epoch: 9 | loss: 0.3453117
	speed: 0.0081s/iter; left time: 95.3579s
Epoch: 9 cost time: 8.517380475997925
Epoch: 9, Steps: 1059 | Train Loss: 0.3505636 Vali Loss: 0.2715181 Test Loss: 0.4916869
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.6691516
	speed: 0.0351s/iter; left time: 405.4766s
	iters: 200, epoch: 10 | loss: 0.3325102
	speed: 0.0097s/iter; left time: 111.2221s
	iters: 300, epoch: 10 | loss: 0.1768809
	speed: 0.0098s/iter; left time: 111.3800s
	iters: 400, epoch: 10 | loss: 0.3241598
	speed: 0.0094s/iter; left time: 105.4216s
	iters: 500, epoch: 10 | loss: 0.3430559
	speed: 0.0099s/iter; left time: 110.6194s
	iters: 600, epoch: 10 | loss: 0.4827857
	speed: 0.0095s/iter; left time: 105.3391s
	iters: 700, epoch: 10 | loss: 0.2034076
	speed: 0.0093s/iter; left time: 101.7327s
	iters: 800, epoch: 10 | loss: 0.5821189
	speed: 0.0080s/iter; left time: 86.6745s
	iters: 900, epoch: 10 | loss: 0.1895888
	speed: 0.0079s/iter; left time: 85.0512s
	iters: 1000, epoch: 10 | loss: 0.3093309
	speed: 0.0079s/iter; left time: 84.0525s
Epoch: 10 cost time: 9.432224750518799
Epoch: 10, Steps: 1059 | Train Loss: 0.3492367 Vali Loss: 0.2516095 Test Loss: 0.4267070
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.1834874
	speed: 0.0335s/iter; left time: 351.7057s
	iters: 200, epoch: 11 | loss: 0.4047829
	speed: 0.0070s/iter; left time: 72.8769s
	iters: 300, epoch: 11 | loss: 0.2420643
	speed: 0.0072s/iter; left time: 74.3239s
	iters: 400, epoch: 11 | loss: 0.1936630
	speed: 0.0097s/iter; left time: 98.8245s
	iters: 500, epoch: 11 | loss: 0.3111077
	speed: 0.0088s/iter; left time: 88.7368s
	iters: 600, epoch: 11 | loss: 0.3018154
	speed: 0.0086s/iter; left time: 86.2224s
	iters: 700, epoch: 11 | loss: 0.2432028
	speed: 0.0075s/iter; left time: 73.9004s
	iters: 800, epoch: 11 | loss: 0.4248362
	speed: 0.0073s/iter; left time: 71.7930s
	iters: 900, epoch: 11 | loss: 0.4190236
	speed: 0.0075s/iter; left time: 72.8889s
	iters: 1000, epoch: 11 | loss: 0.3551785
	speed: 0.0072s/iter; left time: 68.8527s
Epoch: 11 cost time: 8.224257469177246
Epoch: 11, Steps: 1059 | Train Loss: 0.3487811 Vali Loss: 0.2846068 Test Loss: 0.5344406
EarlyStopping counter: 4 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.3874911
	speed: 0.0340s/iter; left time: 320.8203s
	iters: 200, epoch: 12 | loss: 0.2255723
	speed: 0.0078s/iter; left time: 72.4348s
	iters: 300, epoch: 12 | loss: 0.2860245
	speed: 0.0074s/iter; left time: 68.0190s
	iters: 400, epoch: 12 | loss: 0.3232650
	speed: 0.0074s/iter; left time: 67.9665s
	iters: 500, epoch: 12 | loss: 0.2183422
	speed: 0.0068s/iter; left time: 61.7305s
	iters: 600, epoch: 12 | loss: 0.2499778
	speed: 0.0056s/iter; left time: 50.4658s
	iters: 700, epoch: 12 | loss: 0.2766977
	speed: 0.0062s/iter; left time: 54.7814s
	iters: 800, epoch: 12 | loss: 0.3172790
	speed: 0.0064s/iter; left time: 56.1686s
	iters: 900, epoch: 12 | loss: 0.2459845
	speed: 0.0055s/iter; left time: 47.1332s
	iters: 1000, epoch: 12 | loss: 0.3017580
	speed: 0.0058s/iter; left time: 49.6827s
Epoch: 12 cost time: 7.1176111698150635
Epoch: 12, Steps: 1059 | Train Loss: 0.3485066 Vali Loss: 0.2894458 Test Loss: 0.5491866
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTm2_336_336_Linear_ETTm2_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15726<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
mse:0.4184093475341797, mae:0.42061516642570496
