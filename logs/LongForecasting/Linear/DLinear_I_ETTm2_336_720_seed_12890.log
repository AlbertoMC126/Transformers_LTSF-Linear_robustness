Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='DLinear', model_id='ETTm2_336_720', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=720, root_path='./dataset/', save_pred_values=False, seed=12890, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTm2_336_720_DLinear_ETTm2_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed12890>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33505
val 10801
test 10801
	iters: 100, epoch: 1 | loss: 0.4331286
	speed: 0.0362s/iter; left time: 754.5690s
	iters: 200, epoch: 1 | loss: 0.6383319
	speed: 0.0368s/iter; left time: 762.5862s
	iters: 300, epoch: 1 | loss: 0.5838244
	speed: 0.0373s/iter; left time: 769.6680s
	iters: 400, epoch: 1 | loss: 0.8519291
	speed: 0.0380s/iter; left time: 780.7483s
	iters: 500, epoch: 1 | loss: 0.7273990
	speed: 0.0351s/iter; left time: 717.5047s
	iters: 600, epoch: 1 | loss: 0.6992654
	speed: 0.0371s/iter; left time: 754.5232s
	iters: 700, epoch: 1 | loss: 0.7818985
	speed: 0.0371s/iter; left time: 751.2795s
	iters: 800, epoch: 1 | loss: 0.5590920
	speed: 0.0364s/iter; left time: 732.2928s
	iters: 900, epoch: 1 | loss: 0.6390982
	speed: 0.0385s/iter; left time: 771.9103s
	iters: 1000, epoch: 1 | loss: 0.3678833
	speed: 0.0389s/iter; left time: 776.2675s
Epoch: 1 cost time: 38.79137325286865
Epoch: 1, Steps: 1047 | Train Loss: 0.7606354 Vali Loss: 0.7842124 Test Loss: 2.0092654
Validation loss decreased (inf --> 0.784212).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.4776750
	speed: 0.1184s/iter; left time: 2343.9010s
	iters: 200, epoch: 2 | loss: 0.6219923
	speed: 0.0371s/iter; left time: 730.0794s
	iters: 300, epoch: 2 | loss: 0.7264239
	speed: 0.0374s/iter; left time: 733.1476s
	iters: 400, epoch: 2 | loss: 1.0004350
	speed: 0.0341s/iter; left time: 664.7355s
	iters: 500, epoch: 2 | loss: 1.0730342
	speed: 0.0346s/iter; left time: 671.7838s
	iters: 600, epoch: 2 | loss: 1.0965749
	speed: 0.0363s/iter; left time: 700.1874s
	iters: 700, epoch: 2 | loss: 0.8771423
	speed: 0.0372s/iter; left time: 714.0949s
	iters: 800, epoch: 2 | loss: 0.9356008
	speed: 0.0352s/iter; left time: 672.6172s
	iters: 900, epoch: 2 | loss: 0.6795666
	speed: 0.0346s/iter; left time: 656.4433s
	iters: 1000, epoch: 2 | loss: 0.8394592
	speed: 0.0368s/iter; left time: 695.3243s
Epoch: 2 cost time: 37.666035652160645
Epoch: 2, Steps: 1047 | Train Loss: 0.8066220 Vali Loss: 0.7006322 Test Loss: 1.2261477
Validation loss decreased (0.784212 --> 0.700632).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.7009994
	speed: 0.1160s/iter; left time: 2174.0524s
	iters: 200, epoch: 3 | loss: 0.4243846
	speed: 0.0341s/iter; left time: 635.7150s
	iters: 300, epoch: 3 | loss: 0.4155648
	speed: 0.0360s/iter; left time: 667.8444s
	iters: 400, epoch: 3 | loss: 0.4315255
	speed: 0.0348s/iter; left time: 641.1513s
	iters: 500, epoch: 3 | loss: 0.3967463
	speed: 0.0356s/iter; left time: 652.6718s
	iters: 600, epoch: 3 | loss: 0.3073577
	speed: 0.0369s/iter; left time: 672.6912s
	iters: 700, epoch: 3 | loss: 0.4678857
	speed: 0.0378s/iter; left time: 685.4768s
	iters: 800, epoch: 3 | loss: 0.7607399
	speed: 0.0389s/iter; left time: 701.9349s
	iters: 900, epoch: 3 | loss: 0.8665995
	speed: 0.0384s/iter; left time: 689.3229s
	iters: 1000, epoch: 3 | loss: 0.8768793
	speed: 0.0391s/iter; left time: 697.0874s
Epoch: 3 cost time: 38.25396752357483
Epoch: 3, Steps: 1047 | Train Loss: 0.5669341 Vali Loss: 0.8855392 Test Loss: 2.5795038
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.4267834
	speed: 0.1129s/iter; left time: 1999.0162s
	iters: 200, epoch: 4 | loss: 0.6632039
	speed: 0.0338s/iter; left time: 594.1895s
	iters: 300, epoch: 4 | loss: 0.3109557
	speed: 0.0361s/iter; left time: 631.5094s
	iters: 400, epoch: 4 | loss: 0.4437360
	speed: 0.0351s/iter; left time: 611.1034s
	iters: 500, epoch: 4 | loss: 0.5877653
	speed: 0.0365s/iter; left time: 631.3291s
	iters: 600, epoch: 4 | loss: 0.5549279
	speed: 0.0351s/iter; left time: 603.7989s
	iters: 700, epoch: 4 | loss: 0.9092839
	speed: 0.0385s/iter; left time: 658.7788s
	iters: 800, epoch: 4 | loss: 0.3011884
	speed: 0.0333s/iter; left time: 566.2448s
	iters: 900, epoch: 4 | loss: 0.2735764
	speed: 0.0363s/iter; left time: 614.1950s
	iters: 1000, epoch: 4 | loss: 0.5095069
	speed: 0.0360s/iter; left time: 604.9990s
Epoch: 4 cost time: 37.15463590621948
Epoch: 4, Steps: 1047 | Train Loss: 0.5117603 Vali Loss: 0.5640610 Test Loss: 1.4324139
Validation loss decreased (0.700632 --> 0.564061).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.3416141
	speed: 0.1139s/iter; left time: 1897.2152s
	iters: 200, epoch: 5 | loss: 0.5337913
	speed: 0.0383s/iter; left time: 634.4363s
	iters: 300, epoch: 5 | loss: 0.5898860
	speed: 0.0380s/iter; left time: 624.9418s
	iters: 400, epoch: 5 | loss: 0.4156626
	speed: 0.0368s/iter; left time: 601.5203s
	iters: 500, epoch: 5 | loss: 0.5986914
	speed: 0.0378s/iter; left time: 614.6728s
	iters: 600, epoch: 5 | loss: 0.9256081
	speed: 0.0365s/iter; left time: 589.8157s
	iters: 700, epoch: 5 | loss: 0.8929148
	speed: 0.0385s/iter; left time: 617.3732s
	iters: 800, epoch: 5 | loss: 0.3758181
	speed: 0.0378s/iter; left time: 603.3085s
	iters: 900, epoch: 5 | loss: 0.7234179
	speed: 0.0401s/iter; left time: 635.6016s
	iters: 1000, epoch: 5 | loss: 0.4346976
	speed: 0.0380s/iter; left time: 598.7185s
Epoch: 5 cost time: 39.21045804023743
Epoch: 5, Steps: 1047 | Train Loss: 0.4819380 Vali Loss: 0.3922614 Test Loss: 0.7550293
Validation loss decreased (0.564061 --> 0.392261).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.4271496
	speed: 0.1129s/iter; left time: 1761.8080s
	iters: 200, epoch: 6 | loss: 0.4824471
	speed: 0.0367s/iter; left time: 569.0421s
	iters: 300, epoch: 6 | loss: 0.5662120
	speed: 0.0382s/iter; left time: 588.6916s
	iters: 400, epoch: 6 | loss: 0.3972726
	speed: 0.0360s/iter; left time: 551.1400s
	iters: 500, epoch: 6 | loss: 0.2617552
	speed: 0.0381s/iter; left time: 579.6440s
	iters: 600, epoch: 6 | loss: 0.2693823
	speed: 0.0374s/iter; left time: 564.6878s
	iters: 700, epoch: 6 | loss: 0.3896528
	speed: 0.0349s/iter; left time: 524.0059s
	iters: 800, epoch: 6 | loss: 0.4349383
	speed: 0.0385s/iter; left time: 573.8723s
	iters: 900, epoch: 6 | loss: 0.4364044
	speed: 0.0376s/iter; left time: 557.3272s
	iters: 1000, epoch: 6 | loss: 0.3379755
	speed: 0.0354s/iter; left time: 521.0824s
Epoch: 6 cost time: 38.54345631599426
Epoch: 6, Steps: 1047 | Train Loss: 0.4673859 Vali Loss: 0.5215853 Test Loss: 1.2157972
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.4566361
	speed: 0.1188s/iter; left time: 1730.0762s
	iters: 200, epoch: 7 | loss: 0.5844774
	speed: 0.0354s/iter; left time: 512.1808s
	iters: 300, epoch: 7 | loss: 0.5509001
	speed: 0.0357s/iter; left time: 513.0121s
	iters: 400, epoch: 7 | loss: 0.5657949
	speed: 0.0386s/iter; left time: 549.7874s
	iters: 500, epoch: 7 | loss: 0.3009567
	speed: 0.0372s/iter; left time: 526.3217s
	iters: 600, epoch: 7 | loss: 0.3604491
	speed: 0.0353s/iter; left time: 496.0942s
	iters: 700, epoch: 7 | loss: 0.6355830
	speed: 0.0375s/iter; left time: 523.1670s
	iters: 800, epoch: 7 | loss: 0.6219040
	speed: 0.0382s/iter; left time: 528.9935s
	iters: 900, epoch: 7 | loss: 0.5290495
	speed: 0.0378s/iter; left time: 520.6085s
	iters: 1000, epoch: 7 | loss: 0.7580799
	speed: 0.0347s/iter; left time: 474.3708s
Epoch: 7 cost time: 38.233397006988525
Epoch: 7, Steps: 1047 | Train Loss: 0.4588308 Vali Loss: 0.3754829 Test Loss: 0.6991857
Validation loss decreased (0.392261 --> 0.375483).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.3711957
	speed: 0.1126s/iter; left time: 1521.9934s
	iters: 200, epoch: 8 | loss: 0.3232099
	speed: 0.0360s/iter; left time: 483.2890s
	iters: 300, epoch: 8 | loss: 0.4046919
	speed: 0.0392s/iter; left time: 521.7974s
	iters: 400, epoch: 8 | loss: 0.2627815
	speed: 0.0396s/iter; left time: 523.3901s
	iters: 500, epoch: 8 | loss: 0.5145711
	speed: 0.0384s/iter; left time: 503.6153s
	iters: 600, epoch: 8 | loss: 0.3382429
	speed: 0.0356s/iter; left time: 463.8717s
	iters: 700, epoch: 8 | loss: 0.4238015
	speed: 0.0358s/iter; left time: 461.9568s
	iters: 800, epoch: 8 | loss: 0.4308956
	speed: 0.0360s/iter; left time: 461.6811s
	iters: 900, epoch: 8 | loss: 0.4725289
	speed: 0.0365s/iter; left time: 464.2030s
	iters: 1000, epoch: 8 | loss: 0.2844974
	speed: 0.0359s/iter; left time: 452.7137s
Epoch: 8 cost time: 38.03139567375183
Epoch: 8, Steps: 1047 | Train Loss: 0.4538696 Vali Loss: 0.4079883 Test Loss: 0.8318239
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.4884151
	speed: 0.1158s/iter; left time: 1443.0842s
	iters: 200, epoch: 9 | loss: 0.4313393
	speed: 0.0370s/iter; left time: 457.4565s
	iters: 300, epoch: 9 | loss: 0.3222697
	speed: 0.0338s/iter; left time: 414.0953s
	iters: 400, epoch: 9 | loss: 0.5200747
	speed: 0.0337s/iter; left time: 409.5427s
	iters: 500, epoch: 9 | loss: 0.4448323
	speed: 0.0364s/iter; left time: 439.2497s
	iters: 600, epoch: 9 | loss: 0.5479643
	speed: 0.0368s/iter; left time: 439.9260s
	iters: 700, epoch: 9 | loss: 0.5155827
	speed: 0.0351s/iter; left time: 415.9658s
	iters: 800, epoch: 9 | loss: 0.2865423
	speed: 0.0377s/iter; left time: 443.9633s
	iters: 900, epoch: 9 | loss: 0.6907004
	speed: 0.0380s/iter; left time: 442.8430s
	iters: 1000, epoch: 9 | loss: 0.4759972
	speed: 0.0378s/iter; left time: 436.7523s
Epoch: 9 cost time: 37.65125751495361
Epoch: 9, Steps: 1047 | Train Loss: 0.4514105 Vali Loss: 0.4228612 Test Loss: 0.8526053
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.4393697
	speed: 0.1109s/iter; left time: 1266.2671s
	iters: 200, epoch: 10 | loss: 0.4026978
	speed: 0.0348s/iter; left time: 394.3350s
	iters: 300, epoch: 10 | loss: 0.3002044
	speed: 0.0351s/iter; left time: 393.4305s
	iters: 400, epoch: 10 | loss: 0.3960520
	speed: 0.0343s/iter; left time: 381.1402s
	iters: 500, epoch: 10 | loss: 0.4199065
	speed: 0.0325s/iter; left time: 358.2464s
	iters: 600, epoch: 10 | loss: 0.4160976
	speed: 0.0323s/iter; left time: 352.5734s
	iters: 700, epoch: 10 | loss: 0.3294635
	speed: 0.0309s/iter; left time: 334.5171s
	iters: 800, epoch: 10 | loss: 0.6032575
	speed: 0.0308s/iter; left time: 329.9094s
	iters: 900, epoch: 10 | loss: 0.5956698
	speed: 0.0320s/iter; left time: 339.9338s
	iters: 1000, epoch: 10 | loss: 0.5022014
	speed: 0.0325s/iter; left time: 341.4112s
Epoch: 10 cost time: 34.242671489715576
Epoch: 10, Steps: 1047 | Train Loss: 0.4500872 Vali Loss: 0.4353611 Test Loss: 0.9194221
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.4946491
	speed: 0.1129s/iter; left time: 1170.6971s
	iters: 200, epoch: 11 | loss: 0.7261235
	speed: 0.0303s/iter; left time: 311.4401s
	iters: 300, epoch: 11 | loss: 0.5324219
	speed: 0.0355s/iter; left time: 360.7532s
	iters: 400, epoch: 11 | loss: 0.3462505
	speed: 0.0316s/iter; left time: 317.9487s
	iters: 500, epoch: 11 | loss: 0.2975345
	speed: 0.0349s/iter; left time: 348.1722s
	iters: 600, epoch: 11 | loss: 0.3942297
	speed: 0.0341s/iter; left time: 336.2123s
	iters: 700, epoch: 11 | loss: 0.4602436
	speed: 0.0312s/iter; left time: 304.8219s
	iters: 800, epoch: 11 | loss: 0.2705262
	speed: 0.0346s/iter; left time: 334.4241s
	iters: 900, epoch: 11 | loss: 0.7828228
	speed: 0.0334s/iter; left time: 320.0115s
	iters: 1000, epoch: 11 | loss: 0.5844136
	speed: 0.0366s/iter; left time: 346.6258s
Epoch: 11 cost time: 35.091864824295044
Epoch: 11, Steps: 1047 | Train Loss: 0.4493357 Vali Loss: 0.4090460 Test Loss: 0.8290010
EarlyStopping counter: 4 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.3275436
	speed: 0.1157s/iter; left time: 1078.7784s
	iters: 200, epoch: 12 | loss: 0.2485128
	speed: 0.0294s/iter; left time: 271.5376s
	iters: 300, epoch: 12 | loss: 0.6091837
	speed: 0.0325s/iter; left time: 296.5656s
	iters: 400, epoch: 12 | loss: 0.7451237
	speed: 0.0328s/iter; left time: 295.7016s
	iters: 500, epoch: 12 | loss: 0.3529892
	speed: 0.0306s/iter; left time: 272.7492s
	iters: 600, epoch: 12 | loss: 0.3082962
	speed: 0.0304s/iter; left time: 268.6852s
	iters: 700, epoch: 12 | loss: 0.3803357
	speed: 0.0304s/iter; left time: 265.4436s
	iters: 800, epoch: 12 | loss: 0.5294766
	speed: 0.0307s/iter; left time: 264.9609s
	iters: 900, epoch: 12 | loss: 0.7193910
	speed: 0.0302s/iter; left time: 257.2899s
	iters: 1000, epoch: 12 | loss: 0.4838439
	speed: 0.0310s/iter; left time: 261.1167s
Epoch: 12 cost time: 31.94141960144043
Epoch: 12, Steps: 1047 | Train Loss: 0.4489967 Vali Loss: 0.4116100 Test Loss: 0.8395586
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTm2_336_720_DLinear_ETTm2_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed12890<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10801
mse:0.6996955275535583, mae:0.5502837300300598
