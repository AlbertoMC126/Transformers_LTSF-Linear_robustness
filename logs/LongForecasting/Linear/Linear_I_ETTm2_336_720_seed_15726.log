Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='Linear', model_id='ETTm2_336_720', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=720, root_path='./dataset/', save_pred_values=False, seed=15726, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTm2_336_720_Linear_ETTm2_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15726>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33505
val 10801
test 10801
	iters: 100, epoch: 1 | loss: 0.4897341
	speed: 0.0199s/iter; left time: 414.4094s
	iters: 200, epoch: 1 | loss: 0.5181982
	speed: 0.0166s/iter; left time: 344.8867s
	iters: 300, epoch: 1 | loss: 0.6969249
	speed: 0.0162s/iter; left time: 335.3502s
	iters: 400, epoch: 1 | loss: 0.6408098
	speed: 0.0183s/iter; left time: 376.4794s
	iters: 500, epoch: 1 | loss: 0.4105387
	speed: 0.0200s/iter; left time: 409.3233s
	iters: 600, epoch: 1 | loss: 1.1117384
	speed: 0.0199s/iter; left time: 405.2618s
	iters: 700, epoch: 1 | loss: 0.4632494
	speed: 0.0188s/iter; left time: 381.3127s
	iters: 800, epoch: 1 | loss: 0.6144567
	speed: 0.0186s/iter; left time: 373.6203s
	iters: 900, epoch: 1 | loss: 0.6788543
	speed: 0.0179s/iter; left time: 358.1537s
	iters: 1000, epoch: 1 | loss: 0.4786052
	speed: 0.0189s/iter; left time: 376.0458s
Epoch: 1 cost time: 19.26827907562256
Epoch: 1, Steps: 1047 | Train Loss: 0.7311645 Vali Loss: 0.8971086 Test Loss: 2.2165809
Validation loss decreased (inf --> 0.897109).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.5245103
	speed: 0.0592s/iter; left time: 1171.8341s
	iters: 200, epoch: 2 | loss: 0.6304113
	speed: 0.0181s/iter; left time: 357.2471s
	iters: 300, epoch: 2 | loss: 0.6672002
	speed: 0.0186s/iter; left time: 364.3894s
	iters: 400, epoch: 2 | loss: 0.5814950
	speed: 0.0194s/iter; left time: 377.6003s
	iters: 500, epoch: 2 | loss: 0.6726471
	speed: 0.0188s/iter; left time: 364.3747s
	iters: 600, epoch: 2 | loss: 0.5081938
	speed: 0.0192s/iter; left time: 370.7174s
	iters: 700, epoch: 2 | loss: 0.9335944
	speed: 0.0178s/iter; left time: 341.2885s
	iters: 800, epoch: 2 | loss: 0.7939247
	speed: 0.0174s/iter; left time: 333.1139s
	iters: 900, epoch: 2 | loss: 0.4532908
	speed: 0.0158s/iter; left time: 300.3012s
	iters: 1000, epoch: 2 | loss: 0.4965658
	speed: 0.0176s/iter; left time: 332.2703s
Epoch: 2 cost time: 18.839481115341187
Epoch: 2, Steps: 1047 | Train Loss: 0.7083789 Vali Loss: 0.5123710 Test Loss: 1.1185372
Validation loss decreased (0.897109 --> 0.512371).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.4671224
	speed: 0.0578s/iter; left time: 1083.9434s
	iters: 200, epoch: 3 | loss: 0.5221730
	speed: 0.0159s/iter; left time: 296.8343s
	iters: 300, epoch: 3 | loss: 0.3654168
	speed: 0.0177s/iter; left time: 328.4391s
	iters: 400, epoch: 3 | loss: 0.5245890
	speed: 0.0179s/iter; left time: 329.4475s
	iters: 500, epoch: 3 | loss: 0.3955926
	speed: 0.0171s/iter; left time: 314.2223s
	iters: 600, epoch: 3 | loss: 0.6823136
	speed: 0.0211s/iter; left time: 384.8649s
	iters: 700, epoch: 3 | loss: 0.4782816
	speed: 0.0207s/iter; left time: 374.9525s
	iters: 800, epoch: 3 | loss: 0.6211050
	speed: 0.0198s/iter; left time: 357.5058s
	iters: 900, epoch: 3 | loss: 0.5103641
	speed: 0.0179s/iter; left time: 320.3603s
	iters: 1000, epoch: 3 | loss: 0.6688832
	speed: 0.0166s/iter; left time: 296.9626s
Epoch: 3 cost time: 18.774139881134033
Epoch: 3, Steps: 1047 | Train Loss: 0.5485229 Vali Loss: 0.4030007 Test Loss: 0.7974857
Validation loss decreased (0.512371 --> 0.403001).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.3518907
	speed: 0.0625s/iter; left time: 1106.4745s
	iters: 200, epoch: 4 | loss: 0.7976263
	speed: 0.0180s/iter; left time: 316.7049s
	iters: 300, epoch: 4 | loss: 0.3306275
	speed: 0.0200s/iter; left time: 350.7273s
	iters: 400, epoch: 4 | loss: 0.3255469
	speed: 0.0214s/iter; left time: 371.9841s
	iters: 500, epoch: 4 | loss: 0.6731141
	speed: 0.0200s/iter; left time: 345.3413s
	iters: 600, epoch: 4 | loss: 0.4893955
	speed: 0.0189s/iter; left time: 324.5486s
	iters: 700, epoch: 4 | loss: 0.4207161
	speed: 0.0197s/iter; left time: 337.4514s
	iters: 800, epoch: 4 | loss: 0.8886483
	speed: 0.0203s/iter; left time: 344.3637s
	iters: 900, epoch: 4 | loss: 0.9201469
	speed: 0.0175s/iter; left time: 296.1144s
	iters: 1000, epoch: 4 | loss: 0.5034769
	speed: 0.0197s/iter; left time: 330.4510s
Epoch: 4 cost time: 20.005799770355225
Epoch: 4, Steps: 1047 | Train Loss: 0.4992883 Vali Loss: 0.4234222 Test Loss: 0.8211740
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.4423286
	speed: 0.0623s/iter; left time: 1037.1686s
	iters: 200, epoch: 5 | loss: 0.3894871
	speed: 0.0181s/iter; left time: 299.6276s
	iters: 300, epoch: 5 | loss: 0.3429809
	speed: 0.0190s/iter; left time: 313.1022s
	iters: 400, epoch: 5 | loss: 0.3153786
	speed: 0.0190s/iter; left time: 310.0985s
	iters: 500, epoch: 5 | loss: 0.3557821
	speed: 0.0192s/iter; left time: 312.7722s
	iters: 600, epoch: 5 | loss: 0.3833156
	speed: 0.0204s/iter; left time: 329.9938s
	iters: 700, epoch: 5 | loss: 0.4211378
	speed: 0.0196s/iter; left time: 314.1515s
	iters: 800, epoch: 5 | loss: 0.4784202
	speed: 0.0173s/iter; left time: 276.1856s
	iters: 900, epoch: 5 | loss: 0.3928608
	speed: 0.0198s/iter; left time: 314.6022s
	iters: 1000, epoch: 5 | loss: 0.5444716
	speed: 0.0196s/iter; left time: 308.9367s
Epoch: 5 cost time: 19.695863246917725
Epoch: 5, Steps: 1047 | Train Loss: 0.4766638 Vali Loss: 0.3556817 Test Loss: 0.5901886
Validation loss decreased (0.403001 --> 0.355682).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.4300522
	speed: 0.0620s/iter; left time: 967.1385s
	iters: 200, epoch: 6 | loss: 0.5247478
	speed: 0.0184s/iter; left time: 286.0813s
	iters: 300, epoch: 6 | loss: 0.5216208
	speed: 0.0173s/iter; left time: 267.1048s
	iters: 400, epoch: 6 | loss: 0.2752507
	speed: 0.0187s/iter; left time: 286.5770s
	iters: 500, epoch: 6 | loss: 0.4189532
	speed: 0.0182s/iter; left time: 276.1684s
	iters: 600, epoch: 6 | loss: 0.4404075
	speed: 0.0190s/iter; left time: 287.5787s
	iters: 700, epoch: 6 | loss: 0.6896428
	speed: 0.0193s/iter; left time: 289.4238s
	iters: 800, epoch: 6 | loss: 0.2918819
	speed: 0.0186s/iter; left time: 276.9659s
	iters: 900, epoch: 6 | loss: 0.5928155
	speed: 0.0194s/iter; left time: 286.8892s
	iters: 1000, epoch: 6 | loss: 0.3865179
	speed: 0.0170s/iter; left time: 250.1176s
Epoch: 6 cost time: 19.21383023262024
Epoch: 6, Steps: 1047 | Train Loss: 0.4640272 Vali Loss: 0.4324231 Test Loss: 0.8760961
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.3669613
	speed: 0.0612s/iter; left time: 890.9497s
	iters: 200, epoch: 7 | loss: 0.4615090
	speed: 0.0193s/iter; left time: 278.8935s
	iters: 300, epoch: 7 | loss: 0.8548583
	speed: 0.0200s/iter; left time: 287.5955s
	iters: 400, epoch: 7 | loss: 0.5438759
	speed: 0.0174s/iter; left time: 248.7985s
	iters: 500, epoch: 7 | loss: 0.3750077
	speed: 0.0159s/iter; left time: 225.6710s
	iters: 600, epoch: 7 | loss: 0.4648403
	speed: 0.0177s/iter; left time: 248.9299s
	iters: 700, epoch: 7 | loss: 0.5466118
	speed: 0.0188s/iter; left time: 261.8620s
	iters: 800, epoch: 7 | loss: 0.3409484
	speed: 0.0207s/iter; left time: 287.1689s
	iters: 900, epoch: 7 | loss: 0.2935161
	speed: 0.0198s/iter; left time: 272.0903s
	iters: 1000, epoch: 7 | loss: 0.4290738
	speed: 0.0183s/iter; left time: 250.4729s
Epoch: 7 cost time: 19.214064359664917
Epoch: 7, Steps: 1047 | Train Loss: 0.4575735 Vali Loss: 0.4556102 Test Loss: 1.0152147
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.5396781
	speed: 0.0666s/iter; left time: 899.6450s
	iters: 200, epoch: 8 | loss: 0.3860060
	speed: 0.0192s/iter; left time: 257.6241s
	iters: 300, epoch: 8 | loss: 0.3892137
	speed: 0.0196s/iter; left time: 260.8352s
	iters: 400, epoch: 8 | loss: 0.2443361
	speed: 0.0168s/iter; left time: 222.5582s
	iters: 500, epoch: 8 | loss: 0.5518050
	speed: 0.0186s/iter; left time: 243.5183s
	iters: 600, epoch: 8 | loss: 0.3192184
	speed: 0.0195s/iter; left time: 253.6098s
	iters: 700, epoch: 8 | loss: 0.5182900
	speed: 0.0195s/iter; left time: 252.4274s
	iters: 800, epoch: 8 | loss: 0.3278991
	speed: 0.0207s/iter; left time: 265.4666s
	iters: 900, epoch: 8 | loss: 0.6713256
	speed: 0.0167s/iter; left time: 212.1381s
	iters: 1000, epoch: 8 | loss: 0.6117193
	speed: 0.0157s/iter; left time: 197.6083s
Epoch: 8 cost time: 19.08203387260437
Epoch: 8, Steps: 1047 | Train Loss: 0.4533821 Vali Loss: 0.4146116 Test Loss: 0.8355518
EarlyStopping counter: 3 out of 5
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.3146543
	speed: 0.0580s/iter; left time: 722.5079s
	iters: 200, epoch: 9 | loss: 0.5996352
	speed: 0.0162s/iter; left time: 200.4118s
	iters: 300, epoch: 9 | loss: 0.6889079
	speed: 0.0178s/iter; left time: 218.8455s
	iters: 400, epoch: 9 | loss: 0.5689234
	speed: 0.0191s/iter; left time: 232.7307s
	iters: 500, epoch: 9 | loss: 0.4239917
	speed: 0.0187s/iter; left time: 225.5725s
	iters: 600, epoch: 9 | loss: 0.5164138
	speed: 0.0173s/iter; left time: 207.2175s
	iters: 700, epoch: 9 | loss: 0.5299304
	speed: 0.0190s/iter; left time: 224.9602s
	iters: 800, epoch: 9 | loss: 0.6611948
	speed: 0.0177s/iter; left time: 207.8532s
	iters: 900, epoch: 9 | loss: 0.5795190
	speed: 0.0176s/iter; left time: 204.8182s
	iters: 1000, epoch: 9 | loss: 0.3490958
	speed: 0.0201s/iter; left time: 232.3408s
Epoch: 9 cost time: 18.79021978378296
Epoch: 9, Steps: 1047 | Train Loss: 0.4515621 Vali Loss: 0.4244407 Test Loss: 0.8903168
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.4355415
	speed: 0.0631s/iter; left time: 720.5683s
	iters: 200, epoch: 10 | loss: 0.4815036
	speed: 0.0183s/iter; left time: 206.6981s
	iters: 300, epoch: 10 | loss: 0.3277369
	speed: 0.0173s/iter; left time: 193.8403s
	iters: 400, epoch: 10 | loss: 0.7153593
	speed: 0.0168s/iter; left time: 186.2992s
	iters: 500, epoch: 10 | loss: 0.5654612
	speed: 0.0177s/iter; left time: 194.9014s
	iters: 600, epoch: 10 | loss: 0.7269493
	speed: 0.0181s/iter; left time: 197.8834s
	iters: 700, epoch: 10 | loss: 0.5365233
	speed: 0.0161s/iter; left time: 174.6244s
	iters: 800, epoch: 10 | loss: 0.2463719
	speed: 0.0160s/iter; left time: 171.2823s
	iters: 900, epoch: 10 | loss: 0.3962579
	speed: 0.0158s/iter; left time: 167.8362s
	iters: 1000, epoch: 10 | loss: 0.2909386
	speed: 0.0151s/iter; left time: 158.4737s
Epoch: 10 cost time: 17.343571424484253
Epoch: 10, Steps: 1047 | Train Loss: 0.4501520 Vali Loss: 0.4221067 Test Loss: 0.8817614
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTm2_336_720_Linear_ETTm2_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15726<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10801
mse:0.5903859734535217, mae:0.497210294008255
