Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='Linear', model_id='traffic_336_720', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=720, root_path='./dataset/', save_pred_values=False, seed=3293, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_336_720_Linear_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3293>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11225
val 1037
test 2789
	iters: 100, epoch: 1 | loss: 0.4782717
	speed: 0.3428s/iter; left time: 4772.2998s
	iters: 200, epoch: 1 | loss: 0.4972783
	speed: 0.3265s/iter; left time: 4511.9412s
	iters: 300, epoch: 1 | loss: 0.4939072
	speed: 0.3276s/iter; left time: 4494.6921s
	iters: 400, epoch: 1 | loss: 0.5159227
	speed: 0.3267s/iter; left time: 4449.6684s
	iters: 500, epoch: 1 | loss: 0.5170978
	speed: 0.3287s/iter; left time: 4444.8169s
	iters: 600, epoch: 1 | loss: 0.5209051
	speed: 0.3326s/iter; left time: 4463.9712s
	iters: 700, epoch: 1 | loss: 0.5630205
	speed: 0.3303s/iter; left time: 4399.8604s
Epoch: 1 cost time: 232.0633454322815
Epoch: 1, Steps: 701 | Train Loss: 0.5165998 Vali Loss: 0.7038517 Test Loss: 0.8217102
Validation loss decreased (inf --> 0.703852).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.4778791
	speed: 0.6221s/iter; left time: 8224.4630s
	iters: 200, epoch: 2 | loss: 0.4907150
	speed: 0.3294s/iter; left time: 4322.1047s
	iters: 300, epoch: 2 | loss: 0.4912279
	speed: 0.3316s/iter; left time: 4317.4935s
	iters: 400, epoch: 2 | loss: 0.4931285
	speed: 0.3274s/iter; left time: 4229.6289s
	iters: 500, epoch: 2 | loss: 0.4839015
	speed: 0.3268s/iter; left time: 4189.8858s
	iters: 600, epoch: 2 | loss: 0.5216264
	speed: 0.3269s/iter; left time: 4158.2407s
	iters: 700, epoch: 2 | loss: 0.4944634
	speed: 0.3277s/iter; left time: 4136.0577s
Epoch: 2 cost time: 230.6235511302948
Epoch: 2, Steps: 701 | Train Loss: 0.5037994 Vali Loss: 0.6936097 Test Loss: 0.8003195
Validation loss decreased (0.703852 --> 0.693610).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.3583332
	speed: 0.6175s/iter; left time: 7730.1257s
	iters: 200, epoch: 3 | loss: 0.3608586
	speed: 0.3301s/iter; left time: 4099.0606s
	iters: 300, epoch: 3 | loss: 0.3977643
	speed: 0.3281s/iter; left time: 4042.4191s
	iters: 400, epoch: 3 | loss: 0.3493091
	speed: 0.3266s/iter; left time: 3991.1964s
	iters: 500, epoch: 3 | loss: 0.3589434
	speed: 0.3273s/iter; left time: 3967.1461s
	iters: 600, epoch: 3 | loss: 0.3813821
	speed: 0.3284s/iter; left time: 3946.4442s
	iters: 700, epoch: 3 | loss: 0.3560206
	speed: 0.3285s/iter; left time: 3914.8482s
Epoch: 3 cost time: 230.19796061515808
Epoch: 3, Steps: 701 | Train Loss: 0.3615961 Vali Loss: 0.5301857 Test Loss: 0.6117513
Validation loss decreased (0.693610 --> 0.530186).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.3031620
	speed: 0.6178s/iter; left time: 7301.0705s
	iters: 200, epoch: 4 | loss: 0.3013329
	speed: 0.3293s/iter; left time: 3859.3177s
	iters: 300, epoch: 4 | loss: 0.3000104
	speed: 0.3284s/iter; left time: 3814.8928s
	iters: 400, epoch: 4 | loss: 0.2909203
	speed: 0.3265s/iter; left time: 3760.9594s
	iters: 500, epoch: 4 | loss: 0.3167140
	speed: 0.3265s/iter; left time: 3728.4805s
	iters: 600, epoch: 4 | loss: 0.3242481
	speed: 0.3273s/iter; left time: 3704.0537s
	iters: 700, epoch: 4 | loss: 0.3239517
	speed: 0.3283s/iter; left time: 3682.5233s
Epoch: 4 cost time: 229.81004667282104
Epoch: 4, Steps: 701 | Train Loss: 0.3122545 Vali Loss: 0.4667338 Test Loss: 0.5393885
Validation loss decreased (0.530186 --> 0.466734).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.2781908
	speed: 0.6228s/iter; left time: 6924.2168s
	iters: 200, epoch: 5 | loss: 0.3046212
	speed: 0.3302s/iter; left time: 3637.3316s
	iters: 300, epoch: 5 | loss: 0.2845473
	speed: 0.3281s/iter; left time: 3582.2876s
	iters: 400, epoch: 5 | loss: 0.2877722
	speed: 0.3267s/iter; left time: 3534.3570s
	iters: 500, epoch: 5 | loss: 0.2939503
	speed: 0.3265s/iter; left time: 3499.4379s
	iters: 600, epoch: 5 | loss: 0.2929046
	speed: 0.3269s/iter; left time: 3471.1548s
	iters: 700, epoch: 5 | loss: 0.2903153
	speed: 0.3280s/iter; left time: 3449.6370s
Epoch: 5 cost time: 230.40883660316467
Epoch: 5, Steps: 701 | Train Loss: 0.2902507 Vali Loss: 0.4416889 Test Loss: 0.5106440
Validation loss decreased (0.466734 --> 0.441689).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.2900783
	speed: 0.6249s/iter; left time: 6509.4326s
	iters: 200, epoch: 6 | loss: 0.2878213
	speed: 0.3339s/iter; left time: 3444.9052s
	iters: 300, epoch: 6 | loss: 0.2533087
	speed: 0.3309s/iter; left time: 3380.8471s
	iters: 400, epoch: 6 | loss: 0.2704562
	speed: 0.3271s/iter; left time: 3309.0390s
	iters: 500, epoch: 6 | loss: 0.3049876
	speed: 0.3269s/iter; left time: 3273.8804s
	iters: 600, epoch: 6 | loss: 0.2877762
	speed: 0.3269s/iter; left time: 3241.8251s
	iters: 700, epoch: 6 | loss: 0.2832493
	speed: 0.3264s/iter; left time: 3204.3597s
Epoch: 6 cost time: 230.91148567199707
Epoch: 6, Steps: 701 | Train Loss: 0.2789366 Vali Loss: 0.4309359 Test Loss: 0.4956768
Validation loss decreased (0.441689 --> 0.430936).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.2816486
	speed: 0.6162s/iter; left time: 5986.4863s
	iters: 200, epoch: 7 | loss: 0.2637224
	speed: 0.3295s/iter; left time: 3168.5491s
	iters: 300, epoch: 7 | loss: 0.2659588
	speed: 0.3271s/iter; left time: 3112.3454s
	iters: 400, epoch: 7 | loss: 0.3006018
	speed: 0.3268s/iter; left time: 3077.0631s
	iters: 500, epoch: 7 | loss: 0.2772697
	speed: 0.3271s/iter; left time: 3046.9631s
	iters: 600, epoch: 7 | loss: 0.2857137
	speed: 0.3271s/iter; left time: 3014.6367s
	iters: 700, epoch: 7 | loss: 0.2921844
	speed: 0.3267s/iter; left time: 2977.9780s
Epoch: 7 cost time: 229.60122776031494
Epoch: 7, Steps: 701 | Train Loss: 0.2727383 Vali Loss: 0.4249834 Test Loss: 0.4886749
Validation loss decreased (0.430936 --> 0.424983).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.2829876
	speed: 0.6222s/iter; left time: 5608.1131s
	iters: 200, epoch: 8 | loss: 0.2588720
	speed: 0.3333s/iter; left time: 2971.2577s
	iters: 300, epoch: 8 | loss: 0.2657192
	speed: 0.3299s/iter; left time: 2907.6920s
	iters: 400, epoch: 8 | loss: 0.2614232
	speed: 0.3272s/iter; left time: 2851.2194s
	iters: 500, epoch: 8 | loss: 0.2781327
	speed: 0.3272s/iter; left time: 2818.2682s
	iters: 600, epoch: 8 | loss: 0.2697586
	speed: 0.3275s/iter; left time: 2788.7083s
	iters: 700, epoch: 8 | loss: 0.2473455
	speed: 0.3273s/iter; left time: 2753.6445s
Epoch: 8 cost time: 230.83529663085938
Epoch: 8, Steps: 701 | Train Loss: 0.2693617 Vali Loss: 0.4220950 Test Loss: 0.4854765
Validation loss decreased (0.424983 --> 0.422095).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.2793508
	speed: 0.6183s/iter; left time: 5139.8194s
	iters: 200, epoch: 9 | loss: 0.2779598
	speed: 0.3302s/iter; left time: 2712.1534s
	iters: 300, epoch: 9 | loss: 0.2539239
	speed: 0.3274s/iter; left time: 2655.9026s
	iters: 400, epoch: 9 | loss: 0.2804760
	speed: 0.3267s/iter; left time: 2617.7341s
	iters: 500, epoch: 9 | loss: 0.2626234
	speed: 0.3270s/iter; left time: 2587.7967s
	iters: 600, epoch: 9 | loss: 0.2432499
	speed: 0.3274s/iter; left time: 2557.6529s
	iters: 700, epoch: 9 | loss: 0.2730241
	speed: 0.3270s/iter; left time: 2521.8927s
Epoch: 9 cost time: 229.85888409614563
Epoch: 9, Steps: 701 | Train Loss: 0.2674934 Vali Loss: 0.4208063 Test Loss: 0.4836715
Validation loss decreased (0.422095 --> 0.420806).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.2943392
	speed: 0.6172s/iter; left time: 4697.8367s
	iters: 200, epoch: 10 | loss: 0.2726256
	speed: 0.3299s/iter; left time: 2478.2723s
	iters: 300, epoch: 10 | loss: 0.2387186
	speed: 0.3272s/iter; left time: 2425.4316s
	iters: 400, epoch: 10 | loss: 0.2767480
	speed: 0.3268s/iter; left time: 2389.3457s
	iters: 500, epoch: 10 | loss: 0.2845342
	speed: 0.3275s/iter; left time: 2362.1729s
	iters: 600, epoch: 10 | loss: 0.2928120
	speed: 0.3284s/iter; left time: 2335.2348s
	iters: 700, epoch: 10 | loss: 0.2556770
	speed: 0.3279s/iter; left time: 2299.3463s
Epoch: 10 cost time: 229.9259753227234
Epoch: 10, Steps: 701 | Train Loss: 0.2664998 Vali Loss: 0.4200574 Test Loss: 0.4832892
Validation loss decreased (0.420806 --> 0.420057).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.2826515
	speed: 0.6236s/iter; left time: 4309.3560s
	iters: 200, epoch: 11 | loss: 0.2659022
	speed: 0.3332s/iter; left time: 2269.7367s
	iters: 300, epoch: 11 | loss: 0.2653629
	speed: 0.3306s/iter; left time: 2218.5252s
	iters: 400, epoch: 11 | loss: 0.2880716
	speed: 0.3292s/iter; left time: 2176.1016s
	iters: 500, epoch: 11 | loss: 0.2736844
	speed: 0.3280s/iter; left time: 2135.2995s
	iters: 600, epoch: 11 | loss: 0.2637348
	speed: 0.3280s/iter; left time: 2102.8898s
	iters: 700, epoch: 11 | loss: 0.2517730
	speed: 0.3283s/iter; left time: 2072.1676s
Epoch: 11 cost time: 231.54614233970642
Epoch: 11, Steps: 701 | Train Loss: 0.2659337 Vali Loss: 0.4202924 Test Loss: 0.4830550
EarlyStopping counter: 1 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.2771061
	speed: 0.6124s/iter; left time: 3802.8276s
	iters: 200, epoch: 12 | loss: 0.2729402
	speed: 0.3285s/iter; left time: 2007.3482s
	iters: 300, epoch: 12 | loss: 0.2970990
	speed: 0.3283s/iter; left time: 1973.0523s
	iters: 400, epoch: 12 | loss: 0.2837749
	speed: 0.3280s/iter; left time: 1938.7505s
	iters: 500, epoch: 12 | loss: 0.2571085
	speed: 0.3279s/iter; left time: 1905.3782s
	iters: 600, epoch: 12 | loss: 0.2730196
	speed: 0.3281s/iter; left time: 1873.4970s
	iters: 700, epoch: 12 | loss: 0.2572517
	speed: 0.3280s/iter; left time: 1840.1818s
Epoch: 12 cost time: 230.12478733062744
Epoch: 12, Steps: 701 | Train Loss: 0.2656512 Vali Loss: 0.4203947 Test Loss: 0.4828334
EarlyStopping counter: 2 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.2767896
	speed: 0.6105s/iter; left time: 3363.2152s
	iters: 200, epoch: 13 | loss: 0.2373956
	speed: 0.3281s/iter; left time: 1774.4861s
	iters: 300, epoch: 13 | loss: 0.2578899
	speed: 0.3281s/iter; left time: 1741.6959s
	iters: 400, epoch: 13 | loss: 0.2509315
	speed: 0.3280s/iter; left time: 1708.3751s
	iters: 500, epoch: 13 | loss: 0.2744319
	speed: 0.3280s/iter; left time: 1675.6515s
	iters: 600, epoch: 13 | loss: 0.2638212
	speed: 0.3276s/iter; left time: 1640.7975s
	iters: 700, epoch: 13 | loss: 0.2678515
	speed: 0.3282s/iter; left time: 1611.1338s
Epoch: 13 cost time: 229.92126488685608
Epoch: 13, Steps: 701 | Train Loss: 0.2654693 Vali Loss: 0.4201396 Test Loss: 0.4829358
EarlyStopping counter: 3 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 14 | loss: 0.2458101
	speed: 0.6151s/iter; left time: 2957.2869s
	iters: 200, epoch: 14 | loss: 0.2783546
	speed: 0.3296s/iter; left time: 1551.9495s
	iters: 300, epoch: 14 | loss: 0.2755897
	speed: 0.3297s/iter; left time: 1519.1956s
	iters: 400, epoch: 14 | loss: 0.2723036
	speed: 0.3292s/iter; left time: 1483.8363s
	iters: 500, epoch: 14 | loss: 0.2639114
	speed: 0.3292s/iter; left time: 1451.0822s
	iters: 600, epoch: 14 | loss: 0.2618867
	speed: 0.3285s/iter; left time: 1415.2908s
	iters: 700, epoch: 14 | loss: 0.2447181
	speed: 0.3294s/iter; left time: 1385.9594s
Epoch: 14 cost time: 231.18283534049988
Epoch: 14, Steps: 701 | Train Loss: 0.2653683 Vali Loss: 0.4197487 Test Loss: 0.4829261
Validation loss decreased (0.420057 --> 0.419749).  Saving model ...
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 15 | loss: 0.2633361
	speed: 0.6233s/iter; left time: 2559.9369s
	iters: 200, epoch: 15 | loss: 0.2615302
	speed: 0.3320s/iter; left time: 1330.1927s
	iters: 300, epoch: 15 | loss: 0.2798834
	speed: 0.3289s/iter; left time: 1284.8228s
	iters: 400, epoch: 15 | loss: 0.3023645
	speed: 0.3296s/iter; left time: 1254.7591s
	iters: 500, epoch: 15 | loss: 0.2949340
	speed: 0.3288s/iter; left time: 1218.8500s
	iters: 600, epoch: 15 | loss: 0.2658549
	speed: 0.3284s/iter; left time: 1184.4365s
	iters: 700, epoch: 15 | loss: 0.2486713
	speed: 0.3278s/iter; left time: 1149.4979s
Epoch: 15 cost time: 231.36960625648499
Epoch: 15, Steps: 701 | Train Loss: 0.2653528 Vali Loss: 0.4197301 Test Loss: 0.4829230
Validation loss decreased (0.419749 --> 0.419730).  Saving model ...
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 16 | loss: 0.2627336
	speed: 0.6209s/iter; left time: 2114.6275s
	iters: 200, epoch: 16 | loss: 0.2836408
	speed: 0.3294s/iter; left time: 1089.0130s
	iters: 300, epoch: 16 | loss: 0.2578149
	speed: 0.3275s/iter; left time: 1049.8552s
	iters: 400, epoch: 16 | loss: 0.2691972
	speed: 0.3268s/iter; left time: 1014.9244s
	iters: 500, epoch: 16 | loss: 0.2771356
	speed: 0.3269s/iter; left time: 982.6160s
	iters: 600, epoch: 16 | loss: 0.2462472
	speed: 0.3268s/iter; left time: 949.5527s
	iters: 700, epoch: 16 | loss: 0.2631211
	speed: 0.3272s/iter; left time: 918.1364s
Epoch: 16 cost time: 229.56796193122864
Epoch: 16, Steps: 701 | Train Loss: 0.2653217 Vali Loss: 0.4200610 Test Loss: 0.4829188
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 17 | loss: 0.2471358
	speed: 0.6107s/iter; left time: 1651.8970s
	iters: 200, epoch: 17 | loss: 0.2728801
	speed: 0.3276s/iter; left time: 853.3048s
	iters: 300, epoch: 17 | loss: 0.2648756
	speed: 0.3273s/iter; left time: 819.9815s
	iters: 400, epoch: 17 | loss: 0.2981250
	speed: 0.3276s/iter; left time: 787.7954s
	iters: 500, epoch: 17 | loss: 0.2893871
	speed: 0.3274s/iter; left time: 754.7274s
	iters: 600, epoch: 17 | loss: 0.2931439
	speed: 0.3277s/iter; left time: 722.5570s
	iters: 700, epoch: 17 | loss: 0.2555919
	speed: 0.3276s/iter; left time: 689.6773s
Epoch: 17 cost time: 229.63103604316711
Epoch: 17, Steps: 701 | Train Loss: 0.2653035 Vali Loss: 0.4198785 Test Loss: 0.4829155
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 18 | loss: 0.2546178
	speed: 0.6110s/iter; left time: 1224.4019s
	iters: 200, epoch: 18 | loss: 0.2745191
	speed: 0.3276s/iter; left time: 623.7779s
	iters: 300, epoch: 18 | loss: 0.2471489
	speed: 0.3272s/iter; left time: 590.2830s
	iters: 400, epoch: 18 | loss: 0.2630505
	speed: 0.3277s/iter; left time: 558.3584s
	iters: 500, epoch: 18 | loss: 0.2626745
	speed: 0.3278s/iter; left time: 525.8673s
	iters: 600, epoch: 18 | loss: 0.2546526
	speed: 0.3274s/iter; left time: 492.3639s
	iters: 700, epoch: 18 | loss: 0.2455854
	speed: 0.3274s/iter; left time: 459.6043s
Epoch: 18 cost time: 229.58981275558472
Epoch: 18, Steps: 701 | Train Loss: 0.2652993 Vali Loss: 0.4196675 Test Loss: 0.4829153
Validation loss decreased (0.419730 --> 0.419667).  Saving model ...
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 19 | loss: 0.2630684
	speed: 0.6176s/iter; left time: 804.7687s
	iters: 200, epoch: 19 | loss: 0.2783972
	speed: 0.3305s/iter; left time: 397.5447s
	iters: 300, epoch: 19 | loss: 0.2574560
	speed: 0.3278s/iter; left time: 361.5448s
	iters: 400, epoch: 19 | loss: 0.2577219
	speed: 0.3278s/iter; left time: 328.7363s
	iters: 500, epoch: 19 | loss: 0.2634732
	speed: 0.3274s/iter; left time: 295.6698s
	iters: 600, epoch: 19 | loss: 0.2625890
	speed: 0.3276s/iter; left time: 263.0762s
	iters: 700, epoch: 19 | loss: 0.2767359
	speed: 0.3278s/iter; left time: 230.4733s
Epoch: 19 cost time: 230.1327760219574
Epoch: 19, Steps: 701 | Train Loss: 0.2653053 Vali Loss: 0.4193917 Test Loss: 0.4829151
Validation loss decreased (0.419667 --> 0.419392).  Saving model ...
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 20 | loss: 0.2742555
	speed: 0.6216s/iter; left time: 374.1880s
	iters: 200, epoch: 20 | loss: 0.2625994
	speed: 0.3323s/iter; left time: 166.8368s
	iters: 300, epoch: 20 | loss: 0.2754691
	speed: 0.3285s/iter; left time: 132.0402s
	iters: 400, epoch: 20 | loss: 0.2578511
	speed: 0.3278s/iter; left time: 98.9877s
	iters: 500, epoch: 20 | loss: 0.2654536
	speed: 0.3273s/iter; left time: 66.1082s
	iters: 600, epoch: 20 | loss: 0.2657821
	speed: 0.3276s/iter; left time: 33.4193s
	iters: 700, epoch: 20 | loss: 0.2753519
	speed: 0.3274s/iter; left time: 0.6549s
Epoch: 20 cost time: 230.72356843948364
Epoch: 20, Steps: 701 | Train Loss: 0.2653133 Vali Loss: 0.4200952 Test Loss: 0.4829149
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.9073486328125e-08
>>>>>>>testing : traffic_336_720_Linear_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3293<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2789
mse:0.4827340543270111, mae:0.33050617575645447
