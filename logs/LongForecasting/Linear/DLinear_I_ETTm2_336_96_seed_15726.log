Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='DLinear', model_id='ETTm2_336_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=15726, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTm2_336_96_DLinear_ETTm2_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15726>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34129
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.4589852
	speed: 0.0082s/iter; left time: 174.8975s
	iters: 200, epoch: 1 | loss: 0.6343663
	speed: 0.0092s/iter; left time: 193.7379s
	iters: 300, epoch: 1 | loss: 1.0185583
	speed: 0.0095s/iter; left time: 199.5432s
	iters: 400, epoch: 1 | loss: 0.5547624
	speed: 0.0090s/iter; left time: 187.5177s
	iters: 500, epoch: 1 | loss: 0.4187647
	speed: 0.0094s/iter; left time: 195.3533s
	iters: 600, epoch: 1 | loss: 0.4932859
	speed: 0.0094s/iter; left time: 194.8365s
	iters: 700, epoch: 1 | loss: 0.5288902
	speed: 0.0088s/iter; left time: 182.1244s
	iters: 800, epoch: 1 | loss: 0.6544006
	speed: 0.0080s/iter; left time: 163.8397s
	iters: 900, epoch: 1 | loss: 0.4902362
	speed: 0.0086s/iter; left time: 175.2214s
	iters: 1000, epoch: 1 | loss: 0.5848064
	speed: 0.0072s/iter; left time: 145.3355s
Epoch: 1 cost time: 9.148412942886353
Epoch: 1, Steps: 1066 | Train Loss: 0.4584276 Vali Loss: 0.4925139 Test Loss: 1.0803103
Validation loss decreased (inf --> 0.492514).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.2438883
	speed: 0.0313s/iter; left time: 630.1961s
	iters: 200, epoch: 2 | loss: 0.4771309
	speed: 0.0083s/iter; left time: 166.3061s
	iters: 300, epoch: 2 | loss: 0.5482274
	speed: 0.0075s/iter; left time: 149.3043s
	iters: 400, epoch: 2 | loss: 0.3431203
	speed: 0.0086s/iter; left time: 170.4444s
	iters: 500, epoch: 2 | loss: 0.4243316
	speed: 0.0092s/iter; left time: 181.7979s
	iters: 600, epoch: 2 | loss: 0.4144277
	speed: 0.0089s/iter; left time: 175.3227s
	iters: 700, epoch: 2 | loss: 0.3018650
	speed: 0.0076s/iter; left time: 149.4597s
	iters: 800, epoch: 2 | loss: 0.4954318
	speed: 0.0076s/iter; left time: 146.9569s
	iters: 900, epoch: 2 | loss: 0.2025643
	speed: 0.0078s/iter; left time: 150.4236s
	iters: 1000, epoch: 2 | loss: 0.3269850
	speed: 0.0072s/iter; left time: 137.9727s
Epoch: 2 cost time: 8.526061534881592
Epoch: 2, Steps: 1066 | Train Loss: 0.4289278 Vali Loss: 0.3262837 Test Loss: 0.5488415
Validation loss decreased (0.492514 --> 0.326284).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.3258218
	speed: 0.0356s/iter; left time: 680.1023s
	iters: 200, epoch: 3 | loss: 0.2328265
	speed: 0.0084s/iter; left time: 158.6167s
	iters: 300, epoch: 3 | loss: 0.2787173
	speed: 0.0080s/iter; left time: 150.5682s
	iters: 400, epoch: 3 | loss: 0.2761977
	speed: 0.0081s/iter; left time: 151.2516s
	iters: 500, epoch: 3 | loss: 0.4497082
	speed: 0.0077s/iter; left time: 143.5950s
	iters: 600, epoch: 3 | loss: 0.4554980
	speed: 0.0069s/iter; left time: 127.3737s
	iters: 700, epoch: 3 | loss: 0.5119169
	speed: 0.0084s/iter; left time: 154.4386s
	iters: 800, epoch: 3 | loss: 0.1804872
	speed: 0.0090s/iter; left time: 166.2968s
	iters: 900, epoch: 3 | loss: 0.3629371
	speed: 0.0075s/iter; left time: 137.1349s
	iters: 1000, epoch: 3 | loss: 0.2713221
	speed: 0.0083s/iter; left time: 150.4672s
Epoch: 3 cost time: 8.492048263549805
Epoch: 3, Steps: 1066 | Train Loss: 0.2855753 Vali Loss: 0.1780087 Test Loss: 0.3042527
Validation loss decreased (0.326284 --> 0.178009).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.1564780
	speed: 0.0350s/iter; left time: 630.2578s
	iters: 200, epoch: 4 | loss: 0.2118146
	speed: 0.0084s/iter; left time: 150.0326s
	iters: 300, epoch: 4 | loss: 0.3268242
	speed: 0.0083s/iter; left time: 148.4652s
	iters: 400, epoch: 4 | loss: 0.3211914
	speed: 0.0069s/iter; left time: 122.5346s
	iters: 500, epoch: 4 | loss: 0.1318562
	speed: 0.0071s/iter; left time: 125.5425s
	iters: 600, epoch: 4 | loss: 0.3751980
	speed: 0.0079s/iter; left time: 139.1822s
	iters: 700, epoch: 4 | loss: 0.2579226
	speed: 0.0089s/iter; left time: 155.2793s
	iters: 800, epoch: 4 | loss: 0.1888206
	speed: 0.0076s/iter; left time: 131.8277s
	iters: 900, epoch: 4 | loss: 0.1753488
	speed: 0.0083s/iter; left time: 143.6459s
	iters: 1000, epoch: 4 | loss: 0.2953455
	speed: 0.0078s/iter; left time: 133.3365s
Epoch: 4 cost time: 8.34942078590393
Epoch: 4, Steps: 1066 | Train Loss: 0.2397492 Vali Loss: 0.1675779 Test Loss: 0.2845633
Validation loss decreased (0.178009 --> 0.167578).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.2466162
	speed: 0.0337s/iter; left time: 570.7346s
	iters: 200, epoch: 5 | loss: 0.1491437
	speed: 0.0070s/iter; left time: 117.8366s
	iters: 300, epoch: 5 | loss: 0.2064581
	speed: 0.0082s/iter; left time: 137.2725s
	iters: 400, epoch: 5 | loss: 0.2600284
	speed: 0.0087s/iter; left time: 144.6223s
	iters: 500, epoch: 5 | loss: 0.1193452
	speed: 0.0079s/iter; left time: 131.2970s
	iters: 600, epoch: 5 | loss: 0.2160866
	speed: 0.0082s/iter; left time: 134.8294s
	iters: 700, epoch: 5 | loss: 0.3221392
	speed: 0.0084s/iter; left time: 137.6103s
	iters: 800, epoch: 5 | loss: 0.2325043
	speed: 0.0087s/iter; left time: 140.6451s
	iters: 900, epoch: 5 | loss: 0.2181545
	speed: 0.0087s/iter; left time: 140.1331s
	iters: 1000, epoch: 5 | loss: 0.2972182
	speed: 0.0084s/iter; left time: 134.4432s
Epoch: 5 cost time: 8.627073526382446
Epoch: 5, Steps: 1066 | Train Loss: 0.2197653 Vali Loss: 0.1449398 Test Loss: 0.2210095
Validation loss decreased (0.167578 --> 0.144940).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.2012426
	speed: 0.0361s/iter; left time: 574.1142s
	iters: 200, epoch: 6 | loss: 0.2103533
	speed: 0.0072s/iter; left time: 113.4284s
	iters: 300, epoch: 6 | loss: 0.1375061
	speed: 0.0079s/iter; left time: 123.3720s
	iters: 400, epoch: 6 | loss: 0.1546173
	speed: 0.0073s/iter; left time: 113.8516s
	iters: 500, epoch: 6 | loss: 0.3059207
	speed: 0.0076s/iter; left time: 117.5767s
	iters: 600, epoch: 6 | loss: 0.1244551
	speed: 0.0086s/iter; left time: 131.6109s
	iters: 700, epoch: 6 | loss: 0.4173362
	speed: 0.0092s/iter; left time: 139.9371s
	iters: 800, epoch: 6 | loss: 0.3868140
	speed: 0.0082s/iter; left time: 124.0128s
	iters: 900, epoch: 6 | loss: 0.2472762
	speed: 0.0075s/iter; left time: 113.6703s
	iters: 1000, epoch: 6 | loss: 0.1562107
	speed: 0.0082s/iter; left time: 123.3756s
Epoch: 6 cost time: 8.496310472488403
Epoch: 6, Steps: 1066 | Train Loss: 0.2104416 Vali Loss: 0.1400959 Test Loss: 0.2285022
Validation loss decreased (0.144940 --> 0.140096).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.1489762
	speed: 0.0351s/iter; left time: 520.5686s
	iters: 200, epoch: 7 | loss: 0.1228832
	speed: 0.0075s/iter; left time: 110.3159s
	iters: 300, epoch: 7 | loss: 0.2538171
	speed: 0.0084s/iter; left time: 122.8947s
	iters: 400, epoch: 7 | loss: 0.2307280
	speed: 0.0081s/iter; left time: 116.9615s
	iters: 500, epoch: 7 | loss: 0.1985500
	speed: 0.0088s/iter; left time: 127.2399s
	iters: 600, epoch: 7 | loss: 0.1528666
	speed: 0.0087s/iter; left time: 124.9550s
	iters: 700, epoch: 7 | loss: 0.1655423
	speed: 0.0082s/iter; left time: 115.9768s
	iters: 800, epoch: 7 | loss: 0.2480270
	speed: 0.0076s/iter; left time: 107.5251s
	iters: 900, epoch: 7 | loss: 0.1183477
	speed: 0.0085s/iter; left time: 118.9419s
	iters: 1000, epoch: 7 | loss: 0.1887351
	speed: 0.0094s/iter; left time: 131.0342s
Epoch: 7 cost time: 8.918346643447876
Epoch: 7, Steps: 1066 | Train Loss: 0.2051836 Vali Loss: 0.1373155 Test Loss: 0.2320234
Validation loss decreased (0.140096 --> 0.137315).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.2022559
	speed: 0.0395s/iter; left time: 542.8001s
	iters: 200, epoch: 8 | loss: 0.2007022
	speed: 0.0090s/iter; left time: 123.1000s
	iters: 300, epoch: 8 | loss: 0.2075523
	speed: 0.0093s/iter; left time: 125.4612s
	iters: 400, epoch: 8 | loss: 0.3430220
	speed: 0.0075s/iter; left time: 100.8359s
	iters: 500, epoch: 8 | loss: 0.1897640
	speed: 0.0081s/iter; left time: 107.7085s
	iters: 600, epoch: 8 | loss: 0.6193434
	speed: 0.0083s/iter; left time: 110.0756s
	iters: 700, epoch: 8 | loss: 0.1547838
	speed: 0.0075s/iter; left time: 99.2259s
	iters: 800, epoch: 8 | loss: 0.0959249
	speed: 0.0073s/iter; left time: 95.3696s
	iters: 900, epoch: 8 | loss: 0.2200281
	speed: 0.0085s/iter; left time: 109.9008s
	iters: 1000, epoch: 8 | loss: 0.1732060
	speed: 0.0071s/iter; left time: 91.0672s
Epoch: 8 cost time: 8.690702199935913
Epoch: 8, Steps: 1066 | Train Loss: 0.2018614 Vali Loss: 0.1301928 Test Loss: 0.1983233
Validation loss decreased (0.137315 --> 0.130193).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.1629606
	speed: 0.0389s/iter; left time: 493.7260s
	iters: 200, epoch: 9 | loss: 0.3383237
	speed: 0.0075s/iter; left time: 94.9577s
	iters: 300, epoch: 9 | loss: 0.1807600
	speed: 0.0080s/iter; left time: 100.3340s
	iters: 400, epoch: 9 | loss: 0.1580213
	speed: 0.0077s/iter; left time: 95.6998s
	iters: 500, epoch: 9 | loss: 0.2053424
	speed: 0.0083s/iter; left time: 102.5552s
	iters: 600, epoch: 9 | loss: 0.1659102
	speed: 0.0079s/iter; left time: 95.7151s
	iters: 700, epoch: 9 | loss: 0.3842080
	speed: 0.0081s/iter; left time: 97.9852s
	iters: 800, epoch: 9 | loss: 0.1040681
	speed: 0.0080s/iter; left time: 96.0990s
	iters: 900, epoch: 9 | loss: 0.1729036
	speed: 0.0079s/iter; left time: 93.8453s
	iters: 1000, epoch: 9 | loss: 0.1253158
	speed: 0.0080s/iter; left time: 93.9030s
Epoch: 9 cost time: 8.392736673355103
Epoch: 9, Steps: 1066 | Train Loss: 0.2002547 Vali Loss: 0.1354941 Test Loss: 0.2192855
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.3302762
	speed: 0.0336s/iter; left time: 390.3855s
	iters: 200, epoch: 10 | loss: 0.1088327
	speed: 0.0073s/iter; left time: 83.9444s
	iters: 300, epoch: 10 | loss: 0.2775505
	speed: 0.0079s/iter; left time: 90.1833s
	iters: 400, epoch: 10 | loss: 0.2237815
	speed: 0.0089s/iter; left time: 100.3524s
	iters: 500, epoch: 10 | loss: 0.2092655
	speed: 0.0088s/iter; left time: 98.4819s
	iters: 600, epoch: 10 | loss: 0.1005573
	speed: 0.0079s/iter; left time: 87.3861s
	iters: 700, epoch: 10 | loss: 0.2518755
	speed: 0.0078s/iter; left time: 86.3449s
	iters: 800, epoch: 10 | loss: 0.1706517
	speed: 0.0082s/iter; left time: 89.9506s
	iters: 900, epoch: 10 | loss: 0.1878804
	speed: 0.0094s/iter; left time: 101.2395s
	iters: 1000, epoch: 10 | loss: 0.1725852
	speed: 0.0086s/iter; left time: 92.2790s
Epoch: 10 cost time: 8.743722438812256
Epoch: 10, Steps: 1066 | Train Loss: 0.1996597 Vali Loss: 0.1252930 Test Loss: 0.1900102
Validation loss decreased (0.130193 --> 0.125293).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.0951705
	speed: 0.0359s/iter; left time: 378.6787s
	iters: 200, epoch: 11 | loss: 0.1411079
	speed: 0.0091s/iter; left time: 95.2217s
	iters: 300, epoch: 11 | loss: 0.1958085
	speed: 0.0085s/iter; left time: 88.4011s
	iters: 400, epoch: 11 | loss: 0.4432534
	speed: 0.0075s/iter; left time: 77.0910s
	iters: 500, epoch: 11 | loss: 0.1736757
	speed: 0.0073s/iter; left time: 74.6740s
	iters: 600, epoch: 11 | loss: 0.2371641
	speed: 0.0081s/iter; left time: 81.3142s
	iters: 700, epoch: 11 | loss: 0.1237269
	speed: 0.0086s/iter; left time: 85.8685s
	iters: 800, epoch: 11 | loss: 0.1332221
	speed: 0.0094s/iter; left time: 92.7150s
	iters: 900, epoch: 11 | loss: 0.3305124
	speed: 0.0085s/iter; left time: 83.0044s
	iters: 1000, epoch: 11 | loss: 0.2936057
	speed: 0.0060s/iter; left time: 58.0626s
Epoch: 11 cost time: 8.584841012954712
Epoch: 11, Steps: 1066 | Train Loss: 0.1990998 Vali Loss: 0.1266353 Test Loss: 0.1947847
EarlyStopping counter: 1 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.2042443
	speed: 0.0324s/iter; left time: 307.7087s
	iters: 200, epoch: 12 | loss: 0.1428044
	speed: 0.0080s/iter; left time: 75.2886s
	iters: 300, epoch: 12 | loss: 0.2760085
	speed: 0.0082s/iter; left time: 76.3372s
	iters: 400, epoch: 12 | loss: 0.4072487
	speed: 0.0073s/iter; left time: 66.8499s
	iters: 500, epoch: 12 | loss: 0.1023172
	speed: 0.0078s/iter; left time: 70.9576s
	iters: 600, epoch: 12 | loss: 0.2790821
	speed: 0.0076s/iter; left time: 68.1138s
	iters: 700, epoch: 12 | loss: 0.1488145
	speed: 0.0082s/iter; left time: 73.1053s
	iters: 800, epoch: 12 | loss: 0.1543809
	speed: 0.0080s/iter; left time: 70.2818s
	iters: 900, epoch: 12 | loss: 0.1852371
	speed: 0.0071s/iter; left time: 61.8496s
	iters: 1000, epoch: 12 | loss: 0.2725507
	speed: 0.0079s/iter; left time: 67.5856s
Epoch: 12 cost time: 8.277962923049927
Epoch: 12, Steps: 1066 | Train Loss: 0.1987526 Vali Loss: 0.1342928 Test Loss: 0.2162807
EarlyStopping counter: 2 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.2054675
	speed: 0.0397s/iter; left time: 334.9586s
	iters: 200, epoch: 13 | loss: 0.1401627
	speed: 0.0088s/iter; left time: 73.1476s
	iters: 300, epoch: 13 | loss: 0.2723396
	speed: 0.0075s/iter; left time: 62.1289s
	iters: 400, epoch: 13 | loss: 0.1479326
	speed: 0.0086s/iter; left time: 69.6824s
	iters: 500, epoch: 13 | loss: 0.1784391
	speed: 0.0079s/iter; left time: 63.6828s
	iters: 600, epoch: 13 | loss: 0.1381880
	speed: 0.0074s/iter; left time: 58.6137s
	iters: 700, epoch: 13 | loss: 0.1920839
	speed: 0.0081s/iter; left time: 63.4149s
	iters: 800, epoch: 13 | loss: 0.1491998
	speed: 0.0081s/iter; left time: 62.6345s
	iters: 900, epoch: 13 | loss: 0.2276489
	speed: 0.0084s/iter; left time: 64.0368s
	iters: 1000, epoch: 13 | loss: 0.2751560
	speed: 0.0091s/iter; left time: 68.4619s
Epoch: 13 cost time: 8.869492053985596
Epoch: 13, Steps: 1066 | Train Loss: 0.1985956 Vali Loss: 0.1297216 Test Loss: 0.2039936
EarlyStopping counter: 3 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 14 | loss: 0.1376025
	speed: 0.0356s/iter; left time: 262.3448s
	iters: 200, epoch: 14 | loss: 0.1349730
	speed: 0.0075s/iter; left time: 54.1452s
	iters: 300, epoch: 14 | loss: 0.1692217
	speed: 0.0076s/iter; left time: 54.4514s
	iters: 400, epoch: 14 | loss: 0.3181708
	speed: 0.0078s/iter; left time: 54.9041s
	iters: 500, epoch: 14 | loss: 0.3939489
	speed: 0.0076s/iter; left time: 53.1494s
	iters: 600, epoch: 14 | loss: 0.4759756
	speed: 0.0086s/iter; left time: 59.0618s
	iters: 700, epoch: 14 | loss: 0.1252126
	speed: 0.0079s/iter; left time: 53.7126s
	iters: 800, epoch: 14 | loss: 0.3694687
	speed: 0.0079s/iter; left time: 52.7275s
	iters: 900, epoch: 14 | loss: 0.2913238
	speed: 0.0079s/iter; left time: 51.8632s
	iters: 1000, epoch: 14 | loss: 0.2900670
	speed: 0.0078s/iter; left time: 50.6242s
Epoch: 14 cost time: 8.422122716903687
Epoch: 14, Steps: 1066 | Train Loss: 0.1985786 Vali Loss: 0.1310830 Test Loss: 0.2076673
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 15 | loss: 0.1311053
	speed: 0.0339s/iter; left time: 213.4379s
	iters: 200, epoch: 15 | loss: 0.1976158
	speed: 0.0078s/iter; left time: 48.4175s
	iters: 300, epoch: 15 | loss: 0.3634050
	speed: 0.0078s/iter; left time: 47.3301s
	iters: 400, epoch: 15 | loss: 0.2348168
	speed: 0.0079s/iter; left time: 47.2596s
	iters: 500, epoch: 15 | loss: 0.1820545
	speed: 0.0070s/iter; left time: 41.1741s
	iters: 600, epoch: 15 | loss: 0.2163554
	speed: 0.0069s/iter; left time: 39.9523s
	iters: 700, epoch: 15 | loss: 0.1729344
	speed: 0.0065s/iter; left time: 37.2036s
	iters: 800, epoch: 15 | loss: 0.1228200
	speed: 0.0065s/iter; left time: 36.2361s
	iters: 900, epoch: 15 | loss: 0.1200765
	speed: 0.0064s/iter; left time: 35.3628s
	iters: 1000, epoch: 15 | loss: 0.1580757
	speed: 0.0069s/iter; left time: 37.0234s
Epoch: 15 cost time: 7.580530881881714
Epoch: 15, Steps: 1066 | Train Loss: 0.1985866 Vali Loss: 0.1307529 Test Loss: 0.2067868
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTm2_336_96_DLinear_ETTm2_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15726<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.19040288031101227, mae:0.2821636497974396
