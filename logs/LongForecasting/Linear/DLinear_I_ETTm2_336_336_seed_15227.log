Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='DLinear', model_id='ETTm2_336_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=336, root_path='./dataset/', save_pred_values=False, seed=15227, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTm2_336_336_DLinear_ETTm2_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15227>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33889
val 11185
test 11185
	iters: 100, epoch: 1 | loss: 0.4199677
	speed: 0.0179s/iter; left time: 376.5370s
	iters: 200, epoch: 1 | loss: 0.8146473
	speed: 0.0186s/iter; left time: 389.4447s
	iters: 300, epoch: 1 | loss: 0.6119862
	speed: 0.0173s/iter; left time: 361.7456s
	iters: 400, epoch: 1 | loss: 0.4985516
	speed: 0.0162s/iter; left time: 337.3606s
	iters: 500, epoch: 1 | loss: 0.6907812
	speed: 0.0177s/iter; left time: 365.0878s
	iters: 600, epoch: 1 | loss: 0.3901647
	speed: 0.0171s/iter; left time: 351.7652s
	iters: 700, epoch: 1 | loss: 0.5587593
	speed: 0.0181s/iter; left time: 369.8450s
	iters: 800, epoch: 1 | loss: 0.3165055
	speed: 0.0164s/iter; left time: 334.2492s
	iters: 900, epoch: 1 | loss: 0.6983139
	speed: 0.0162s/iter; left time: 328.2002s
	iters: 1000, epoch: 1 | loss: 1.0800339
	speed: 0.0172s/iter; left time: 346.5780s
Epoch: 1 cost time: 18.159324884414673
Epoch: 1, Steps: 1059 | Train Loss: 0.6580605 Vali Loss: 0.5451263 Test Loss: 1.2847406
Validation loss decreased (inf --> 0.545126).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.9597407
	speed: 0.0626s/iter; left time: 1253.0478s
	iters: 200, epoch: 2 | loss: 0.4874037
	speed: 0.0161s/iter; left time: 320.6296s
	iters: 300, epoch: 2 | loss: 0.5940766
	speed: 0.0160s/iter; left time: 318.0835s
	iters: 400, epoch: 2 | loss: 0.9113637
	speed: 0.0182s/iter; left time: 358.9562s
	iters: 500, epoch: 2 | loss: 0.5014695
	speed: 0.0169s/iter; left time: 331.7117s
	iters: 600, epoch: 2 | loss: 0.3763393
	speed: 0.0162s/iter; left time: 315.4622s
	iters: 700, epoch: 2 | loss: 0.6219347
	speed: 0.0163s/iter; left time: 317.1830s
	iters: 800, epoch: 2 | loss: 0.6627644
	speed: 0.0161s/iter; left time: 310.6262s
	iters: 900, epoch: 2 | loss: 1.0781544
	speed: 0.0155s/iter; left time: 297.6044s
	iters: 1000, epoch: 2 | loss: 0.4314741
	speed: 0.0169s/iter; left time: 323.0725s
Epoch: 2 cost time: 17.398565769195557
Epoch: 2, Steps: 1059 | Train Loss: 0.6570810 Vali Loss: 1.4499902 Test Loss: 4.4170280
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.4589528
	speed: 0.0654s/iter; left time: 1240.8203s
	iters: 200, epoch: 3 | loss: 0.5353752
	speed: 0.0185s/iter; left time: 349.2322s
	iters: 300, epoch: 3 | loss: 0.7097173
	speed: 0.0182s/iter; left time: 340.6052s
	iters: 400, epoch: 3 | loss: 0.2881131
	speed: 0.0170s/iter; left time: 317.4328s
	iters: 500, epoch: 3 | loss: 0.2713752
	speed: 0.0181s/iter; left time: 335.4092s
	iters: 600, epoch: 3 | loss: 0.3386697
	speed: 0.0179s/iter; left time: 329.8418s
	iters: 700, epoch: 3 | loss: 0.4230430
	speed: 0.0174s/iter; left time: 319.0012s
	iters: 800, epoch: 3 | loss: 0.5144303
	speed: 0.0137s/iter; left time: 249.4334s
	iters: 900, epoch: 3 | loss: 0.6998451
	speed: 0.0158s/iter; left time: 286.2841s
	iters: 1000, epoch: 3 | loss: 0.5525577
	speed: 0.0159s/iter; left time: 286.7569s
Epoch: 3 cost time: 17.846245765686035
Epoch: 3, Steps: 1059 | Train Loss: 0.4617301 Vali Loss: 0.4752436 Test Loss: 1.1192864
Validation loss decreased (0.545126 --> 0.475244).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.3533099
	speed: 0.0629s/iter; left time: 1125.8167s
	iters: 200, epoch: 4 | loss: 0.2580577
	speed: 0.0160s/iter; left time: 284.6251s
	iters: 300, epoch: 4 | loss: 0.3020127
	speed: 0.0177s/iter; left time: 312.9597s
	iters: 400, epoch: 4 | loss: 0.5401741
	speed: 0.0182s/iter; left time: 320.9674s
	iters: 500, epoch: 4 | loss: 0.8972844
	speed: 0.0172s/iter; left time: 300.6479s
	iters: 600, epoch: 4 | loss: 0.3053098
	speed: 0.0175s/iter; left time: 303.8769s
	iters: 700, epoch: 4 | loss: 0.3788834
	speed: 0.0180s/iter; left time: 310.6306s
	iters: 800, epoch: 4 | loss: 0.3458993
	speed: 0.0168s/iter; left time: 289.4141s
	iters: 900, epoch: 4 | loss: 0.3830939
	speed: 0.0170s/iter; left time: 290.3856s
	iters: 1000, epoch: 4 | loss: 0.3481137
	speed: 0.0177s/iter; left time: 300.6952s
Epoch: 4 cost time: 18.174407482147217
Epoch: 4, Steps: 1059 | Train Loss: 0.4052266 Vali Loss: 0.2782335 Test Loss: 0.4240932
Validation loss decreased (0.475244 --> 0.278234).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.3002899
	speed: 0.0633s/iter; left time: 1066.0589s
	iters: 200, epoch: 5 | loss: 0.2529900
	speed: 0.0189s/iter; left time: 316.0666s
	iters: 300, epoch: 5 | loss: 0.3474047
	speed: 0.0178s/iter; left time: 296.9106s
	iters: 400, epoch: 5 | loss: 0.2402993
	speed: 0.0175s/iter; left time: 288.8980s
	iters: 500, epoch: 5 | loss: 0.3317775
	speed: 0.0175s/iter; left time: 287.8303s
	iters: 600, epoch: 5 | loss: 0.2867994
	speed: 0.0166s/iter; left time: 271.4622s
	iters: 700, epoch: 5 | loss: 0.4135113
	speed: 0.0182s/iter; left time: 295.5837s
	iters: 800, epoch: 5 | loss: 0.5874125
	speed: 0.0173s/iter; left time: 280.0687s
	iters: 900, epoch: 5 | loss: 0.5188833
	speed: 0.0170s/iter; left time: 272.7544s
	iters: 1000, epoch: 5 | loss: 0.5175329
	speed: 0.0178s/iter; left time: 283.2061s
Epoch: 5 cost time: 18.579548120498657
Epoch: 5, Steps: 1059 | Train Loss: 0.3782389 Vali Loss: 0.2971791 Test Loss: 0.5502600
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.4808961
	speed: 0.0649s/iter; left time: 1023.8338s
	iters: 200, epoch: 6 | loss: 0.2989886
	speed: 0.0163s/iter; left time: 255.9914s
	iters: 300, epoch: 6 | loss: 0.4756072
	speed: 0.0172s/iter; left time: 267.4486s
	iters: 400, epoch: 6 | loss: 0.2952112
	speed: 0.0161s/iter; left time: 249.0585s
	iters: 500, epoch: 6 | loss: 0.5145510
	speed: 0.0169s/iter; left time: 260.3946s
	iters: 600, epoch: 6 | loss: 0.5285625
	speed: 0.0177s/iter; left time: 270.1933s
	iters: 700, epoch: 6 | loss: 0.3154103
	speed: 0.0163s/iter; left time: 247.9279s
	iters: 800, epoch: 6 | loss: 0.5774542
	speed: 0.0165s/iter; left time: 248.2022s
	iters: 900, epoch: 6 | loss: 0.5288594
	speed: 0.0158s/iter; left time: 236.2786s
	iters: 1000, epoch: 6 | loss: 0.2341892
	speed: 0.0159s/iter; left time: 237.0090s
Epoch: 6 cost time: 17.59741187095642
Epoch: 6, Steps: 1059 | Train Loss: 0.3648280 Vali Loss: 0.3452377 Test Loss: 0.7296376
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.2500938
	speed: 0.0671s/iter; left time: 987.8944s
	iters: 200, epoch: 7 | loss: 0.2774187
	speed: 0.0161s/iter; left time: 235.0649s
	iters: 300, epoch: 7 | loss: 0.2244016
	speed: 0.0171s/iter; left time: 248.4467s
	iters: 400, epoch: 7 | loss: 0.3654064
	speed: 0.0176s/iter; left time: 254.5817s
	iters: 500, epoch: 7 | loss: 0.2656932
	speed: 0.0176s/iter; left time: 252.1036s
	iters: 600, epoch: 7 | loss: 0.2597632
	speed: 0.0182s/iter; left time: 258.6011s
	iters: 700, epoch: 7 | loss: 0.2365521
	speed: 0.0169s/iter; left time: 239.2583s
	iters: 800, epoch: 7 | loss: 0.3870848
	speed: 0.0179s/iter; left time: 250.7360s
	iters: 900, epoch: 7 | loss: 0.4257767
	speed: 0.0177s/iter; left time: 247.1900s
	iters: 1000, epoch: 7 | loss: 0.2213561
	speed: 0.0168s/iter; left time: 231.9654s
Epoch: 7 cost time: 18.140674591064453
Epoch: 7, Steps: 1059 | Train Loss: 0.3570891 Vali Loss: 0.3238606 Test Loss: 0.6642534
EarlyStopping counter: 3 out of 5
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.4174947
	speed: 0.0644s/iter; left time: 879.9922s
	iters: 200, epoch: 8 | loss: 0.3327030
	speed: 0.0178s/iter; left time: 241.9969s
	iters: 300, epoch: 8 | loss: 0.4086182
	speed: 0.0183s/iter; left time: 246.1223s
	iters: 400, epoch: 8 | loss: 0.3350734
	speed: 0.0161s/iter; left time: 214.6100s
	iters: 500, epoch: 8 | loss: 0.4001857
	speed: 0.0164s/iter; left time: 217.5319s
	iters: 600, epoch: 8 | loss: 0.2075810
	speed: 0.0176s/iter; left time: 231.3332s
	iters: 700, epoch: 8 | loss: 0.3090124
	speed: 0.0181s/iter; left time: 236.3251s
	iters: 800, epoch: 8 | loss: 0.2280575
	speed: 0.0149s/iter; left time: 193.2891s
	iters: 900, epoch: 8 | loss: 0.5687497
	speed: 0.0174s/iter; left time: 223.3628s
	iters: 1000, epoch: 8 | loss: 0.4705435
	speed: 0.0167s/iter; left time: 213.7718s
Epoch: 8 cost time: 17.80951762199402
Epoch: 8, Steps: 1059 | Train Loss: 0.3523492 Vali Loss: 0.2949622 Test Loss: 0.5707130
EarlyStopping counter: 4 out of 5
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.1999276
	speed: 0.0655s/iter; left time: 826.3239s
	iters: 200, epoch: 9 | loss: 0.6574157
	speed: 0.0179s/iter; left time: 224.4953s
	iters: 300, epoch: 9 | loss: 0.4077419
	speed: 0.0184s/iter; left time: 228.3947s
	iters: 400, epoch: 9 | loss: 0.1834145
	speed: 0.0171s/iter; left time: 210.6431s
	iters: 500, epoch: 9 | loss: 0.2624199
	speed: 0.0161s/iter; left time: 196.2651s
	iters: 600, epoch: 9 | loss: 0.3839945
	speed: 0.0164s/iter; left time: 199.0426s
	iters: 700, epoch: 9 | loss: 0.6602371
	speed: 0.0170s/iter; left time: 204.6536s
	iters: 800, epoch: 9 | loss: 0.2532950
	speed: 0.0157s/iter; left time: 187.5001s
	iters: 900, epoch: 9 | loss: 0.1899426
	speed: 0.0154s/iter; left time: 181.3242s
	iters: 1000, epoch: 9 | loss: 0.2728170
	speed: 0.0156s/iter; left time: 182.3552s
Epoch: 9 cost time: 17.58599352836609
Epoch: 9, Steps: 1059 | Train Loss: 0.3502478 Vali Loss: 0.2747434 Test Loss: 0.5010841
Validation loss decreased (0.278234 --> 0.274743).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.2916180
	speed: 0.0621s/iter; left time: 717.6460s
	iters: 200, epoch: 10 | loss: 0.2222791
	speed: 0.0158s/iter; left time: 180.9814s
	iters: 300, epoch: 10 | loss: 0.2151200
	speed: 0.0178s/iter; left time: 202.2722s
	iters: 400, epoch: 10 | loss: 0.2607059
	speed: 0.0166s/iter; left time: 186.9313s
	iters: 500, epoch: 10 | loss: 0.2152922
	speed: 0.0163s/iter; left time: 182.1499s
	iters: 600, epoch: 10 | loss: 0.5740969
	speed: 0.0175s/iter; left time: 193.8776s
	iters: 700, epoch: 10 | loss: 0.3704954
	speed: 0.0166s/iter; left time: 181.2529s
	iters: 800, epoch: 10 | loss: 0.5033181
	speed: 0.0157s/iter; left time: 170.5318s
	iters: 900, epoch: 10 | loss: 0.4607703
	speed: 0.0162s/iter; left time: 174.6095s
	iters: 1000, epoch: 10 | loss: 0.2177650
	speed: 0.0160s/iter; left time: 170.0182s
Epoch: 10 cost time: 17.355488777160645
Epoch: 10, Steps: 1059 | Train Loss: 0.3490551 Vali Loss: 0.2965637 Test Loss: 0.5735333
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.2108959
	speed: 0.0641s/iter; left time: 672.2835s
	iters: 200, epoch: 11 | loss: 0.2314344
	speed: 0.0165s/iter; left time: 171.4118s
	iters: 300, epoch: 11 | loss: 0.5569659
	speed: 0.0179s/iter; left time: 183.8969s
	iters: 400, epoch: 11 | loss: 0.4036337
	speed: 0.0172s/iter; left time: 175.5286s
	iters: 500, epoch: 11 | loss: 0.2988842
	speed: 0.0156s/iter; left time: 157.7258s
	iters: 600, epoch: 11 | loss: 0.2976042
	speed: 0.0155s/iter; left time: 154.4096s
	iters: 700, epoch: 11 | loss: 0.2683280
	speed: 0.0164s/iter; left time: 161.8308s
	iters: 800, epoch: 11 | loss: 0.3688552
	speed: 0.0163s/iter; left time: 159.8348s
	iters: 900, epoch: 11 | loss: 0.3238594
	speed: 0.0162s/iter; left time: 157.0309s
	iters: 1000, epoch: 11 | loss: 0.5496166
	speed: 0.0152s/iter; left time: 145.9842s
Epoch: 11 cost time: 17.09581708908081
Epoch: 11, Steps: 1059 | Train Loss: 0.3484251 Vali Loss: 0.2771940 Test Loss: 0.5145769
EarlyStopping counter: 2 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.2243890
	speed: 0.0650s/iter; left time: 613.1792s
	iters: 200, epoch: 12 | loss: 0.3167947
	speed: 0.0166s/iter; left time: 155.0231s
	iters: 300, epoch: 12 | loss: 0.2482699
	speed: 0.0148s/iter; left time: 136.2947s
	iters: 400, epoch: 12 | loss: 0.3659550
	speed: 0.0157s/iter; left time: 143.0394s
	iters: 500, epoch: 12 | loss: 0.6705192
	speed: 0.0146s/iter; left time: 131.5465s
	iters: 600, epoch: 12 | loss: 0.2340099
	speed: 0.0146s/iter; left time: 130.2805s
	iters: 700, epoch: 12 | loss: 0.1657155
	speed: 0.0146s/iter; left time: 129.0061s
	iters: 800, epoch: 12 | loss: 0.2672944
	speed: 0.0151s/iter; left time: 131.9401s
	iters: 900, epoch: 12 | loss: 0.3203825
	speed: 0.0147s/iter; left time: 126.6684s
	iters: 1000, epoch: 12 | loss: 0.4750161
	speed: 0.0144s/iter; left time: 122.5426s
Epoch: 12 cost time: 15.994732856750488
Epoch: 12, Steps: 1059 | Train Loss: 0.3480573 Vali Loss: 0.2810080 Test Loss: 0.5225536
EarlyStopping counter: 3 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.2689591
	speed: 0.0578s/iter; left time: 484.1094s
	iters: 200, epoch: 13 | loss: 0.3450576
	speed: 0.0140s/iter; left time: 115.6715s
	iters: 300, epoch: 13 | loss: 0.2042039
	speed: 0.0142s/iter; left time: 116.1142s
	iters: 400, epoch: 13 | loss: 0.1833190
	speed: 0.0148s/iter; left time: 119.5016s
	iters: 500, epoch: 13 | loss: 0.2723725
	speed: 0.0143s/iter; left time: 113.6859s
	iters: 600, epoch: 13 | loss: 0.3284924
	speed: 0.0134s/iter; left time: 105.4414s
	iters: 700, epoch: 13 | loss: 0.3340423
	speed: 0.0135s/iter; left time: 104.5754s
	iters: 800, epoch: 13 | loss: 0.2516212
	speed: 0.0134s/iter; left time: 103.0309s
	iters: 900, epoch: 13 | loss: 0.2760172
	speed: 0.0139s/iter; left time: 105.5035s
	iters: 1000, epoch: 13 | loss: 0.4126152
	speed: 0.0134s/iter; left time: 99.8468s
Epoch: 13 cost time: 14.717247009277344
Epoch: 13, Steps: 1059 | Train Loss: 0.3478521 Vali Loss: 0.2757745 Test Loss: 0.5071633
EarlyStopping counter: 4 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 14 | loss: 0.5542091
	speed: 0.0553s/iter; left time: 404.3141s
	iters: 200, epoch: 14 | loss: 0.2917423
	speed: 0.0130s/iter; left time: 93.7283s
	iters: 300, epoch: 14 | loss: 0.3382097
	speed: 0.0134s/iter; left time: 95.1649s
	iters: 400, epoch: 14 | loss: 0.2498068
	speed: 0.0134s/iter; left time: 93.7398s
	iters: 500, epoch: 14 | loss: 0.3032727
	speed: 0.0136s/iter; left time: 94.2582s
	iters: 600, epoch: 14 | loss: 0.4758925
	speed: 0.0120s/iter; left time: 82.0798s
	iters: 700, epoch: 14 | loss: 0.2230077
	speed: 0.0114s/iter; left time: 76.8393s
	iters: 800, epoch: 14 | loss: 0.3453595
	speed: 0.0114s/iter; left time: 75.1597s
	iters: 900, epoch: 14 | loss: 0.3761803
	speed: 0.0115s/iter; left time: 74.7298s
	iters: 1000, epoch: 14 | loss: 0.5065193
	speed: 0.0116s/iter; left time: 74.3585s
Epoch: 14 cost time: 13.158354759216309
Epoch: 14, Steps: 1059 | Train Loss: 0.3477645 Vali Loss: 0.2784425 Test Loss: 0.5145680
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTm2_336_336_DLinear_ETTm2_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15227<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
mse:0.5015823245048523, mae:0.45808637142181396
