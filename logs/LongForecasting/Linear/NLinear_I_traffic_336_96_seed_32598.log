Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='NLinear', model_id='traffic_336_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=32598, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_336_96_NLinear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed32598>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11849
val 1661
test 3413
	iters: 100, epoch: 1 | loss: 0.5836038
	speed: 0.3164s/iter; left time: 4651.2381s
	iters: 200, epoch: 1 | loss: 0.7879230
	speed: 0.3011s/iter; left time: 4395.6748s
	iters: 300, epoch: 1 | loss: 0.9781666
	speed: 0.3019s/iter; left time: 4377.7410s
	iters: 400, epoch: 1 | loss: 0.6870868
	speed: 0.3012s/iter; left time: 4337.4955s
	iters: 500, epoch: 1 | loss: 0.7047470
	speed: 0.3017s/iter; left time: 4313.9194s
	iters: 600, epoch: 1 | loss: 1.3268222
	speed: 0.3014s/iter; left time: 4280.8848s
	iters: 700, epoch: 1 | loss: 0.7630858
	speed: 0.3013s/iter; left time: 4249.1764s
Epoch: 1 cost time: 224.73254919052124
Epoch: 1, Steps: 740 | Train Loss: 1.1920091 Vali Loss: 1.1909920 Test Loss: 1.4408318
Validation loss decreased (inf --> 1.190992).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 1.7359432
	speed: 0.6144s/iter; left time: 8577.8449s
	iters: 200, epoch: 2 | loss: 0.8818263
	speed: 0.3014s/iter; left time: 4177.0861s
	iters: 300, epoch: 2 | loss: 0.8554323
	speed: 0.3018s/iter; left time: 4153.3851s
	iters: 400, epoch: 2 | loss: 0.9678465
	speed: 0.3025s/iter; left time: 4132.7778s
	iters: 500, epoch: 2 | loss: 0.7784626
	speed: 0.3036s/iter; left time: 4117.1609s
	iters: 600, epoch: 2 | loss: 0.8061450
	speed: 0.3020s/iter; left time: 4065.8820s
	iters: 700, epoch: 2 | loss: 1.1746457
	speed: 0.3015s/iter; left time: 4028.0312s
Epoch: 2 cost time: 223.4342701435089
Epoch: 2, Steps: 740 | Train Loss: 0.9802028 Vali Loss: 1.7397395 Test Loss: 1.7518992
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.3430026
	speed: 0.6104s/iter; left time: 8069.7924s
	iters: 200, epoch: 3 | loss: 0.3066964
	speed: 0.3014s/iter; left time: 3954.7299s
	iters: 300, epoch: 3 | loss: 0.3371612
	speed: 0.3024s/iter; left time: 3937.1529s
	iters: 400, epoch: 3 | loss: 0.3583877
	speed: 0.3021s/iter; left time: 3903.7785s
	iters: 500, epoch: 3 | loss: 0.3483039
	speed: 0.3020s/iter; left time: 3872.5267s
	iters: 600, epoch: 3 | loss: 0.3238440
	speed: 0.3030s/iter; left time: 3855.0247s
	iters: 700, epoch: 3 | loss: 0.3660259
	speed: 0.3023s/iter; left time: 3815.3296s
Epoch: 3 cost time: 223.597802400589
Epoch: 3, Steps: 740 | Train Loss: 0.3630303 Vali Loss: 0.4934506 Test Loss: 0.5844865
Validation loss decreased (1.190992 --> 0.493451).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.2572087
	speed: 0.6152s/iter; left time: 7677.9570s
	iters: 200, epoch: 4 | loss: 0.2628410
	speed: 0.3007s/iter; left time: 3722.3677s
	iters: 300, epoch: 4 | loss: 0.2742937
	speed: 0.3013s/iter; left time: 3699.8241s
	iters: 400, epoch: 4 | loss: 0.2563266
	speed: 0.3013s/iter; left time: 3669.6283s
	iters: 500, epoch: 4 | loss: 0.2531425
	speed: 0.3018s/iter; left time: 3646.5522s
	iters: 600, epoch: 4 | loss: 0.2534162
	speed: 0.3017s/iter; left time: 3615.0698s
	iters: 700, epoch: 4 | loss: 0.2797957
	speed: 0.3016s/iter; left time: 3583.8529s
Epoch: 4 cost time: 223.12131357192993
Epoch: 4, Steps: 740 | Train Loss: 0.2793301 Vali Loss: 0.4037112 Test Loss: 0.4891512
Validation loss decreased (0.493451 --> 0.403711).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.2478053
	speed: 0.6162s/iter; left time: 7235.2029s
	iters: 200, epoch: 5 | loss: 0.2585163
	speed: 0.3022s/iter; left time: 3517.7728s
	iters: 300, epoch: 5 | loss: 0.2468381
	speed: 0.3025s/iter; left time: 3491.5215s
	iters: 400, epoch: 5 | loss: 0.2806001
	speed: 0.3014s/iter; left time: 3448.0387s
	iters: 500, epoch: 5 | loss: 0.3038954
	speed: 0.3016s/iter; left time: 3420.3034s
	iters: 600, epoch: 5 | loss: 0.2774702
	speed: 0.3012s/iter; left time: 3386.1617s
	iters: 700, epoch: 5 | loss: 0.2803933
	speed: 0.3029s/iter; left time: 3375.1315s
Epoch: 5 cost time: 223.51812767982483
Epoch: 5, Steps: 740 | Train Loss: 0.2574966 Vali Loss: 0.3759935 Test Loss: 0.4547801
Validation loss decreased (0.403711 --> 0.375993).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.2714187
	speed: 0.6150s/iter; left time: 6765.2442s
	iters: 200, epoch: 6 | loss: 0.2483498
	speed: 0.3033s/iter; left time: 3306.2757s
	iters: 300, epoch: 6 | loss: 0.2269028
	speed: 0.3035s/iter; left time: 3278.3101s
	iters: 400, epoch: 6 | loss: 0.2436256
	speed: 0.3025s/iter; left time: 3237.3594s
	iters: 500, epoch: 6 | loss: 0.2676451
	speed: 0.3028s/iter; left time: 3210.4465s
	iters: 600, epoch: 6 | loss: 0.2438777
	speed: 0.3031s/iter; left time: 3183.3004s
	iters: 700, epoch: 6 | loss: 0.2473179
	speed: 0.3024s/iter; left time: 3145.6706s
Epoch: 6 cost time: 224.20579934120178
Epoch: 6, Steps: 740 | Train Loss: 0.2472196 Vali Loss: 0.3620131 Test Loss: 0.4403176
Validation loss decreased (0.375993 --> 0.362013).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.2580715
	speed: 0.6140s/iter; left time: 6300.4766s
	iters: 200, epoch: 7 | loss: 0.2623498
	speed: 0.3028s/iter; left time: 3076.9315s
	iters: 300, epoch: 7 | loss: 0.2173753
	speed: 0.3037s/iter; left time: 3055.1241s
	iters: 400, epoch: 7 | loss: 0.2191007
	speed: 0.3030s/iter; left time: 3018.4734s
	iters: 500, epoch: 7 | loss: 0.2544395
	speed: 0.3034s/iter; left time: 2992.2635s
	iters: 600, epoch: 7 | loss: 0.2693578
	speed: 0.3031s/iter; left time: 2958.6440s
	iters: 700, epoch: 7 | loss: 0.2299661
	speed: 0.3027s/iter; left time: 2924.2375s
Epoch: 7 cost time: 224.31104922294617
Epoch: 7, Steps: 740 | Train Loss: 0.2415814 Vali Loss: 0.3525765 Test Loss: 0.4300725
Validation loss decreased (0.362013 --> 0.352576).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.2380244
	speed: 0.6162s/iter; left time: 5866.5048s
	iters: 200, epoch: 8 | loss: 0.2463751
	speed: 0.3039s/iter; left time: 2863.1141s
	iters: 300, epoch: 8 | loss: 0.2670558
	speed: 0.3035s/iter; left time: 2828.5310s
	iters: 400, epoch: 8 | loss: 0.2230152
	speed: 0.3038s/iter; left time: 2801.7518s
	iters: 500, epoch: 8 | loss: 0.2336321
	speed: 0.3028s/iter; left time: 2761.9818s
	iters: 600, epoch: 8 | loss: 0.2080295
	speed: 0.3038s/iter; left time: 2740.7904s
	iters: 700, epoch: 8 | loss: 0.2319139
	speed: 0.3036s/iter; left time: 2708.4660s
Epoch: 8 cost time: 224.66868901252747
Epoch: 8, Steps: 740 | Train Loss: 0.2382823 Vali Loss: 0.3500881 Test Loss: 0.4269595
Validation loss decreased (0.352576 --> 0.350088).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.2410690
	speed: 0.6160s/iter; left time: 5409.0634s
	iters: 200, epoch: 9 | loss: 0.2199102
	speed: 0.3031s/iter; left time: 2630.8629s
	iters: 300, epoch: 9 | loss: 0.2732059
	speed: 0.3033s/iter; left time: 2602.6035s
	iters: 400, epoch: 9 | loss: 0.2235238
	speed: 0.3037s/iter; left time: 2575.9541s
	iters: 500, epoch: 9 | loss: 0.2212455
	speed: 0.3039s/iter; left time: 2547.2063s
	iters: 600, epoch: 9 | loss: 0.1965808
	speed: 0.3046s/iter; left time: 2522.5629s
	iters: 700, epoch: 9 | loss: 0.2450094
	speed: 0.3032s/iter; left time: 2480.4034s
Epoch: 9 cost time: 224.63940501213074
Epoch: 9, Steps: 740 | Train Loss: 0.2364136 Vali Loss: 0.3484657 Test Loss: 0.4251266
Validation loss decreased (0.350088 --> 0.348466).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.2257283
	speed: 0.6138s/iter; left time: 4935.5125s
	iters: 200, epoch: 10 | loss: 0.2052018
	speed: 0.3039s/iter; left time: 2412.8997s
	iters: 300, epoch: 10 | loss: 0.2498446
	speed: 0.3039s/iter; left time: 2382.6111s
	iters: 400, epoch: 10 | loss: 0.2583385
	speed: 0.3040s/iter; left time: 2353.0660s
	iters: 500, epoch: 10 | loss: 0.2988293
	speed: 0.3033s/iter; left time: 2317.1849s
	iters: 600, epoch: 10 | loss: 0.2357752
	speed: 0.3039s/iter; left time: 2291.5045s
	iters: 700, epoch: 10 | loss: 0.2338934
	speed: 0.3041s/iter; left time: 2263.1794s
Epoch: 10 cost time: 224.8083794116974
Epoch: 10, Steps: 740 | Train Loss: 0.2353450 Vali Loss: 0.3476963 Test Loss: 0.4241966
Validation loss decreased (0.348466 --> 0.347696).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.2259176
	speed: 0.6180s/iter; left time: 4511.8799s
	iters: 200, epoch: 11 | loss: 0.2072820
	speed: 0.3037s/iter; left time: 2187.1511s
	iters: 300, epoch: 11 | loss: 0.2314734
	speed: 0.3045s/iter; left time: 2162.0079s
	iters: 400, epoch: 11 | loss: 0.2289611
	speed: 0.3042s/iter; left time: 2129.8372s
	iters: 500, epoch: 11 | loss: 0.2370930
	speed: 0.3042s/iter; left time: 2099.3333s
	iters: 600, epoch: 11 | loss: 0.2404564
	speed: 0.3037s/iter; left time: 2065.4933s
	iters: 700, epoch: 11 | loss: 0.2042464
	speed: 0.3047s/iter; left time: 2041.7847s
Epoch: 11 cost time: 225.17034268379211
Epoch: 11, Steps: 740 | Train Loss: 0.2347070 Vali Loss: 0.3473503 Test Loss: 0.4235587
Validation loss decreased (0.347696 --> 0.347350).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.2154896
	speed: 0.6173s/iter; left time: 4049.9822s
	iters: 200, epoch: 12 | loss: 0.2085180
	speed: 0.3044s/iter; left time: 1966.7376s
	iters: 300, epoch: 12 | loss: 0.2644597
	speed: 0.3039s/iter; left time: 1933.1183s
	iters: 400, epoch: 12 | loss: 0.2388493
	speed: 0.3040s/iter; left time: 1903.1946s
	iters: 500, epoch: 12 | loss: 0.2570012
	speed: 0.3038s/iter; left time: 1871.9028s
	iters: 600, epoch: 12 | loss: 0.2177329
	speed: 0.3038s/iter; left time: 1841.2742s
	iters: 700, epoch: 12 | loss: 0.2268830
	speed: 0.3041s/iter; left time: 1813.0117s
Epoch: 12 cost time: 224.85625290870667
Epoch: 12, Steps: 740 | Train Loss: 0.2343601 Vali Loss: 0.3471637 Test Loss: 0.4232227
Validation loss decreased (0.347350 --> 0.347164).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.2721320
	speed: 0.6147s/iter; left time: 3578.1792s
	iters: 200, epoch: 13 | loss: 0.2390813
	speed: 0.3031s/iter; left time: 1734.0247s
	iters: 300, epoch: 13 | loss: 0.2410105
	speed: 0.3035s/iter; left time: 1705.9765s
	iters: 400, epoch: 13 | loss: 0.2551803
	speed: 0.3041s/iter; left time: 1679.0697s
	iters: 500, epoch: 13 | loss: 0.2369022
	speed: 0.3034s/iter; left time: 1644.4899s
	iters: 600, epoch: 13 | loss: 0.1985276
	speed: 0.3040s/iter; left time: 1617.5902s
	iters: 700, epoch: 13 | loss: 0.2448495
	speed: 0.3052s/iter; left time: 1593.7035s
Epoch: 13 cost time: 224.86688828468323
Epoch: 13, Steps: 740 | Train Loss: 0.2341105 Vali Loss: 0.3467921 Test Loss: 0.4231100
Validation loss decreased (0.347164 --> 0.346792).  Saving model ...
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 14 | loss: 0.2212666
	speed: 0.6180s/iter; left time: 3139.8901s
	iters: 200, epoch: 14 | loss: 0.2707563
	speed: 0.3040s/iter; left time: 1514.2961s
	iters: 300, epoch: 14 | loss: 0.2572755
	speed: 0.3040s/iter; left time: 1484.0572s
	iters: 400, epoch: 14 | loss: 0.2437183
	speed: 0.3035s/iter; left time: 1450.9057s
	iters: 500, epoch: 14 | loss: 0.2185353
	speed: 0.3041s/iter; left time: 1423.7097s
	iters: 600, epoch: 14 | loss: 0.2412630
	speed: 0.3049s/iter; left time: 1396.5329s
	iters: 700, epoch: 14 | loss: 0.2945823
	speed: 0.3046s/iter; left time: 1365.0322s
Epoch: 14 cost time: 225.14749717712402
Epoch: 14, Steps: 740 | Train Loss: 0.2341058 Vali Loss: 0.3464163 Test Loss: 0.4229308
Validation loss decreased (0.346792 --> 0.346416).  Saving model ...
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 15 | loss: 0.2461134
	speed: 0.6167s/iter; left time: 2677.0764s
	iters: 200, epoch: 15 | loss: 0.2615757
	speed: 0.3042s/iter; left time: 1290.0441s
	iters: 300, epoch: 15 | loss: 0.2037837
	speed: 0.3045s/iter; left time: 1260.9244s
	iters: 400, epoch: 15 | loss: 0.2195132
	speed: 0.3042s/iter; left time: 1229.4688s
	iters: 500, epoch: 15 | loss: 0.2360091
	speed: 0.3039s/iter; left time: 1197.8384s
	iters: 600, epoch: 15 | loss: 0.2254859
	speed: 0.3044s/iter; left time: 1169.2744s
	iters: 700, epoch: 15 | loss: 0.2466160
	speed: 0.3046s/iter; left time: 1139.6452s
Epoch: 15 cost time: 225.3270981311798
Epoch: 15, Steps: 740 | Train Loss: 0.2340619 Vali Loss: 0.3466426 Test Loss: 0.4229363
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 16 | loss: 0.2471516
	speed: 0.6163s/iter; left time: 2219.3877s
	iters: 200, epoch: 16 | loss: 0.2120689
	speed: 0.3041s/iter; left time: 1064.6169s
	iters: 300, epoch: 16 | loss: 0.2310679
	speed: 0.3041s/iter; left time: 1034.2335s
	iters: 400, epoch: 16 | loss: 0.2122059
	speed: 0.3036s/iter; left time: 1002.0732s
	iters: 500, epoch: 16 | loss: 0.2489128
	speed: 0.3034s/iter; left time: 971.2471s
	iters: 600, epoch: 16 | loss: 0.2401254
	speed: 0.3046s/iter; left time: 944.6563s
	iters: 700, epoch: 16 | loss: 0.2069434
	speed: 0.3034s/iter; left time: 910.3841s
Epoch: 16 cost time: 224.84450817108154
Epoch: 16, Steps: 740 | Train Loss: 0.2340144 Vali Loss: 0.3466784 Test Loss: 0.4229335
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 17 | loss: 0.2572881
	speed: 0.6149s/iter; left time: 1759.1972s
	iters: 200, epoch: 17 | loss: 0.2044814
	speed: 0.3048s/iter; left time: 841.6289s
	iters: 300, epoch: 17 | loss: 0.2286687
	speed: 0.3049s/iter; left time: 811.2616s
	iters: 400, epoch: 17 | loss: 0.2102385
	speed: 0.3057s/iter; left time: 782.9004s
	iters: 500, epoch: 17 | loss: 0.2352821
	speed: 0.3042s/iter; left time: 748.6583s
	iters: 600, epoch: 17 | loss: 0.1929063
	speed: 0.3043s/iter; left time: 718.5191s
	iters: 700, epoch: 17 | loss: 0.2275627
	speed: 0.3034s/iter; left time: 685.9436s
Epoch: 17 cost time: 225.28168296813965
Epoch: 17, Steps: 740 | Train Loss: 0.2340265 Vali Loss: 0.3468927 Test Loss: 0.4229354
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 18 | loss: 0.2514542
	speed: 0.6137s/iter; left time: 1301.7344s
	iters: 200, epoch: 18 | loss: 0.2549194
	speed: 0.3042s/iter; left time: 614.7967s
	iters: 300, epoch: 18 | loss: 0.2292977
	speed: 0.3038s/iter; left time: 583.6863s
	iters: 400, epoch: 18 | loss: 0.2547658
	speed: 0.3066s/iter; left time: 558.4087s
	iters: 500, epoch: 18 | loss: 0.2302878
	speed: 0.3202s/iter; left time: 551.0329s
	iters: 600, epoch: 18 | loss: 0.2236498
	speed: 0.3209s/iter; left time: 520.1646s
	iters: 700, epoch: 18 | loss: 0.2711582
	speed: 0.3069s/iter; left time: 466.8665s
Epoch: 18 cost time: 228.88334798812866
Epoch: 18, Steps: 740 | Train Loss: 0.2340315 Vali Loss: 0.3469743 Test Loss: 0.4229380
EarlyStopping counter: 4 out of 5
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 19 | loss: 0.2269129
	speed: 0.6211s/iter; left time: 857.7467s
	iters: 200, epoch: 19 | loss: 0.1980535
	speed: 0.3043s/iter; left time: 389.7587s
	iters: 300, epoch: 19 | loss: 0.2624586
	speed: 0.3068s/iter; left time: 362.3877s
	iters: 400, epoch: 19 | loss: 0.2262081
	speed: 0.3061s/iter; left time: 330.8521s
	iters: 500, epoch: 19 | loss: 0.2263435
	speed: 0.3044s/iter; left time: 298.6167s
	iters: 600, epoch: 19 | loss: 0.2335968
	speed: 0.3042s/iter; left time: 267.9994s
	iters: 700, epoch: 19 | loss: 0.2469379
	speed: 0.3054s/iter; left time: 238.5021s
Epoch: 19 cost time: 225.88790678977966
Epoch: 19, Steps: 740 | Train Loss: 0.2339961 Vali Loss: 0.3464319 Test Loss: 0.4229375
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : traffic_336_96_NLinear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed32598<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3413
mse:0.4232097566127777, mae:0.2942631244659424
