Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='Linear', model_id='traffic_336_720', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=720, root_path='./dataset/', save_pred_values=False, seed=25565, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_336_720_Linear_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed25565>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11225
val 1037
test 2789
	iters: 100, epoch: 1 | loss: 0.5246348
	speed: 0.3435s/iter; left time: 4782.1460s
	iters: 200, epoch: 1 | loss: 0.5315278
	speed: 0.3270s/iter; left time: 4519.9559s
	iters: 300, epoch: 1 | loss: 0.5119607
	speed: 0.3275s/iter; left time: 4494.2862s
	iters: 400, epoch: 1 | loss: 0.5078695
	speed: 0.3279s/iter; left time: 4466.3451s
	iters: 500, epoch: 1 | loss: 0.5089495
	speed: 0.3277s/iter; left time: 4431.3852s
	iters: 600, epoch: 1 | loss: 0.5367820
	speed: 0.3281s/iter; left time: 4402.8402s
	iters: 700, epoch: 1 | loss: 0.5105668
	speed: 0.3279s/iter; left time: 4368.5237s
Epoch: 1 cost time: 231.5187599658966
Epoch: 1, Steps: 701 | Train Loss: 0.5158378 Vali Loss: 0.7058629 Test Loss: 0.8273643
Validation loss decreased (inf --> 0.705863).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.5096288
	speed: 0.6255s/iter; left time: 8269.1990s
	iters: 200, epoch: 2 | loss: 0.4878212
	speed: 0.3314s/iter; left time: 4347.4180s
	iters: 300, epoch: 2 | loss: 0.4976290
	speed: 0.3306s/iter; left time: 4304.6179s
	iters: 400, epoch: 2 | loss: 0.4964574
	speed: 0.3295s/iter; left time: 4256.6753s
	iters: 500, epoch: 2 | loss: 0.4982509
	speed: 0.3283s/iter; left time: 4209.2338s
	iters: 600, epoch: 2 | loss: 0.5216650
	speed: 0.3290s/iter; left time: 4184.3720s
	iters: 700, epoch: 2 | loss: 0.4866759
	speed: 0.3282s/iter; left time: 4142.5065s
Epoch: 2 cost time: 231.64632964134216
Epoch: 2, Steps: 701 | Train Loss: 0.5058740 Vali Loss: 0.7025568 Test Loss: 0.8177385
Validation loss decreased (0.705863 --> 0.702557).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.3530456
	speed: 0.6253s/iter; left time: 7828.6317s
	iters: 200, epoch: 3 | loss: 0.3547597
	speed: 0.3331s/iter; left time: 4137.3024s
	iters: 300, epoch: 3 | loss: 0.3505377
	speed: 0.3298s/iter; left time: 4062.3868s
	iters: 400, epoch: 3 | loss: 0.3393134
	speed: 0.3285s/iter; left time: 4013.8848s
	iters: 500, epoch: 3 | loss: 0.3456674
	speed: 0.3284s/iter; left time: 3980.0740s
	iters: 600, epoch: 3 | loss: 0.3512723
	speed: 0.3287s/iter; left time: 3951.1835s
	iters: 700, epoch: 3 | loss: 0.3460830
	speed: 0.3283s/iter; left time: 3913.1946s
Epoch: 3 cost time: 231.57262253761292
Epoch: 3, Steps: 701 | Train Loss: 0.3615722 Vali Loss: 0.5267482 Test Loss: 0.6114069
Validation loss decreased (0.702557 --> 0.526748).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.3194058
	speed: 0.6202s/iter; left time: 7329.8450s
	iters: 200, epoch: 4 | loss: 0.3201712
	speed: 0.3328s/iter; left time: 3899.6480s
	iters: 300, epoch: 4 | loss: 0.2932414
	speed: 0.3304s/iter; left time: 3838.8566s
	iters: 400, epoch: 4 | loss: 0.3204604
	speed: 0.3302s/iter; left time: 3802.7663s
	iters: 500, epoch: 4 | loss: 0.3220718
	speed: 0.3300s/iter; left time: 3767.4488s
	iters: 600, epoch: 4 | loss: 0.3431304
	speed: 0.3304s/iter; left time: 3739.2297s
	iters: 700, epoch: 4 | loss: 0.3032646
	speed: 0.3297s/iter; left time: 3698.7251s
Epoch: 4 cost time: 231.76735734939575
Epoch: 4, Steps: 701 | Train Loss: 0.3125427 Vali Loss: 0.4656788 Test Loss: 0.5375408
Validation loss decreased (0.526748 --> 0.465679).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.2708547
	speed: 0.6227s/iter; left time: 6922.1554s
	iters: 200, epoch: 5 | loss: 0.2900368
	speed: 0.3312s/iter; left time: 3648.6306s
	iters: 300, epoch: 5 | loss: 0.3234650
	speed: 0.3287s/iter; left time: 3588.5806s
	iters: 400, epoch: 5 | loss: 0.2776491
	speed: 0.3288s/iter; left time: 3556.4036s
	iters: 500, epoch: 5 | loss: 0.3222478
	speed: 0.3287s/iter; left time: 3522.4584s
	iters: 600, epoch: 5 | loss: 0.2699544
	speed: 0.3290s/iter; left time: 3493.2112s
	iters: 700, epoch: 5 | loss: 0.2859905
	speed: 0.3289s/iter; left time: 3459.2489s
Epoch: 5 cost time: 231.23016905784607
Epoch: 5, Steps: 701 | Train Loss: 0.2901002 Vali Loss: 0.4417937 Test Loss: 0.5093449
Validation loss decreased (0.465679 --> 0.441794).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.2608480
	speed: 0.6241s/iter; left time: 6500.7954s
	iters: 200, epoch: 6 | loss: 0.2806076
	speed: 0.3342s/iter; left time: 3447.1354s
	iters: 300, epoch: 6 | loss: 0.2866395
	speed: 0.3300s/iter; left time: 3371.0984s
	iters: 400, epoch: 6 | loss: 0.3097024
	speed: 0.3301s/iter; left time: 3339.3926s
	iters: 500, epoch: 6 | loss: 0.2916452
	speed: 0.3294s/iter; left time: 3298.8695s
	iters: 600, epoch: 6 | loss: 0.2667953
	speed: 0.3307s/iter; left time: 3279.6066s
	iters: 700, epoch: 6 | loss: 0.2605201
	speed: 0.3301s/iter; left time: 3240.0267s
Epoch: 6 cost time: 232.300546169281
Epoch: 6, Steps: 701 | Train Loss: 0.2789535 Vali Loss: 0.4296010 Test Loss: 0.4962702
Validation loss decreased (0.441794 --> 0.429601).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.2861910
	speed: 0.6206s/iter; left time: 6029.4681s
	iters: 200, epoch: 7 | loss: 0.2877150
	speed: 0.3335s/iter; left time: 3206.3161s
	iters: 300, epoch: 7 | loss: 0.2825119
	speed: 0.3304s/iter; left time: 3143.7576s
	iters: 400, epoch: 7 | loss: 0.2537501
	speed: 0.3301s/iter; left time: 3108.3459s
	iters: 500, epoch: 7 | loss: 0.2660717
	speed: 0.3295s/iter; left time: 3069.2834s
	iters: 600, epoch: 7 | loss: 0.2849370
	speed: 0.3294s/iter; left time: 3035.1141s
	iters: 700, epoch: 7 | loss: 0.2923343
	speed: 0.3296s/iter; left time: 3004.0127s
Epoch: 7 cost time: 231.81233048439026
Epoch: 7, Steps: 701 | Train Loss: 0.2727791 Vali Loss: 0.4248255 Test Loss: 0.4886701
Validation loss decreased (0.429601 --> 0.424825).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.2621988
	speed: 0.6210s/iter; left time: 5597.7440s
	iters: 200, epoch: 8 | loss: 0.2964933
	speed: 0.3329s/iter; left time: 2967.7672s
	iters: 300, epoch: 8 | loss: 0.2556397
	speed: 0.3299s/iter; left time: 2907.6514s
	iters: 400, epoch: 8 | loss: 0.2735991
	speed: 0.3306s/iter; left time: 2880.4504s
	iters: 500, epoch: 8 | loss: 0.2377364
	speed: 0.3313s/iter; left time: 2853.8554s
	iters: 600, epoch: 8 | loss: 0.2705869
	speed: 0.3307s/iter; left time: 2815.6087s
	iters: 700, epoch: 8 | loss: 0.2645706
	speed: 0.3300s/iter; left time: 2776.6388s
Epoch: 8 cost time: 231.97266936302185
Epoch: 8, Steps: 701 | Train Loss: 0.2693582 Vali Loss: 0.4224039 Test Loss: 0.4854104
Validation loss decreased (0.424825 --> 0.422404).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.2699174
	speed: 0.6209s/iter; left time: 5161.6257s
	iters: 200, epoch: 9 | loss: 0.2630897
	speed: 0.3327s/iter; left time: 2732.0777s
	iters: 300, epoch: 9 | loss: 0.2517313
	speed: 0.3307s/iter; left time: 2683.3106s
	iters: 400, epoch: 9 | loss: 0.2685019
	speed: 0.3295s/iter; left time: 2640.4936s
	iters: 500, epoch: 9 | loss: 0.2782479
	speed: 0.3297s/iter; left time: 2608.7067s
	iters: 600, epoch: 9 | loss: 0.2458694
	speed: 0.3300s/iter; left time: 2578.2202s
	iters: 700, epoch: 9 | loss: 0.2989869
	speed: 0.3306s/iter; left time: 2549.8734s
Epoch: 9 cost time: 231.84734225273132
Epoch: 9, Steps: 701 | Train Loss: 0.2674829 Vali Loss: 0.4209670 Test Loss: 0.4840345
Validation loss decreased (0.422404 --> 0.420967).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.2502859
	speed: 0.6235s/iter; left time: 4746.2779s
	iters: 200, epoch: 10 | loss: 0.2657791
	speed: 0.3325s/iter; left time: 2498.1110s
	iters: 300, epoch: 10 | loss: 0.2888662
	speed: 0.3292s/iter; left time: 2440.2592s
	iters: 400, epoch: 10 | loss: 0.2901832
	speed: 0.3287s/iter; left time: 2403.3756s
	iters: 500, epoch: 10 | loss: 0.2462047
	speed: 0.3296s/iter; left time: 2377.1812s
	iters: 600, epoch: 10 | loss: 0.2876467
	speed: 0.3296s/iter; left time: 2344.0308s
	iters: 700, epoch: 10 | loss: 0.2658593
	speed: 0.3291s/iter; left time: 2307.8333s
Epoch: 10 cost time: 231.70073914527893
Epoch: 10, Steps: 701 | Train Loss: 0.2664754 Vali Loss: 0.4202720 Test Loss: 0.4832481
Validation loss decreased (0.420967 --> 0.420272).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.2622340
	speed: 0.6200s/iter; left time: 4284.7352s
	iters: 200, epoch: 11 | loss: 0.2630770
	speed: 0.3315s/iter; left time: 2257.8626s
	iters: 300, epoch: 11 | loss: 0.2537421
	speed: 0.3303s/iter; left time: 2216.6327s
	iters: 400, epoch: 11 | loss: 0.2471799
	speed: 0.3293s/iter; left time: 2176.8004s
	iters: 500, epoch: 11 | loss: 0.2508479
	speed: 0.3291s/iter; left time: 2142.7221s
	iters: 600, epoch: 11 | loss: 0.2859095
	speed: 0.3297s/iter; left time: 2113.6428s
	iters: 700, epoch: 11 | loss: 0.2577842
	speed: 0.3294s/iter; left time: 2078.7130s
Epoch: 11 cost time: 231.36666417121887
Epoch: 11, Steps: 701 | Train Loss: 0.2659380 Vali Loss: 0.4207417 Test Loss: 0.4830162
EarlyStopping counter: 1 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.2673078
	speed: 0.6526s/iter; left time: 4052.7169s
	iters: 200, epoch: 12 | loss: 0.2714053
	speed: 0.3316s/iter; left time: 2026.1506s
	iters: 300, epoch: 12 | loss: 0.2766148
	speed: 0.3324s/iter; left time: 1997.7948s
	iters: 400, epoch: 12 | loss: 0.2649215
	speed: 0.3313s/iter; left time: 1958.0776s
	iters: 500, epoch: 12 | loss: 0.2707551
	speed: 0.3315s/iter; left time: 1926.0402s
	iters: 600, epoch: 12 | loss: 0.2571071
	speed: 0.3307s/iter; left time: 1888.2793s
	iters: 700, epoch: 12 | loss: 0.2765922
	speed: 0.3309s/iter; left time: 1856.1039s
Epoch: 12 cost time: 234.88045692443848
Epoch: 12, Steps: 701 | Train Loss: 0.2656405 Vali Loss: 0.4198513 Test Loss: 0.4829966
Validation loss decreased (0.420272 --> 0.419851).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.2585460
	speed: 0.6240s/iter; left time: 3437.5332s
	iters: 200, epoch: 13 | loss: 0.2624333
	speed: 0.3328s/iter; left time: 1800.2268s
	iters: 300, epoch: 13 | loss: 0.2808113
	speed: 0.3311s/iter; left time: 1757.9745s
	iters: 400, epoch: 13 | loss: 0.2648053
	speed: 0.3306s/iter; left time: 1721.9061s
	iters: 500, epoch: 13 | loss: 0.2644296
	speed: 0.3301s/iter; left time: 1686.6967s
	iters: 600, epoch: 13 | loss: 0.2820559
	speed: 0.3293s/iter; left time: 1649.5868s
	iters: 700, epoch: 13 | loss: 0.2690196
	speed: 0.3288s/iter; left time: 1613.8641s
Epoch: 13 cost time: 231.89211916923523
Epoch: 13, Steps: 701 | Train Loss: 0.2654794 Vali Loss: 0.4200522 Test Loss: 0.4829487
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 14 | loss: 0.2573629
	speed: 0.6133s/iter; left time: 2948.8141s
	iters: 200, epoch: 14 | loss: 0.2640928
	speed: 0.3312s/iter; left time: 1559.5246s
	iters: 300, epoch: 14 | loss: 0.2736284
	speed: 0.3301s/iter; left time: 1520.8950s
	iters: 400, epoch: 14 | loss: 0.2866649
	speed: 0.3294s/iter; left time: 1484.7765s
	iters: 500, epoch: 14 | loss: 0.2731571
	speed: 0.3299s/iter; left time: 1454.0755s
	iters: 600, epoch: 14 | loss: 0.2540101
	speed: 0.3297s/iter; left time: 1420.4111s
	iters: 700, epoch: 14 | loss: 0.2555519
	speed: 0.3291s/iter; left time: 1384.6533s
Epoch: 14 cost time: 231.34369349479675
Epoch: 14, Steps: 701 | Train Loss: 0.2653731 Vali Loss: 0.4197969 Test Loss: 0.4829327
Validation loss decreased (0.419851 --> 0.419797).  Saving model ...
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 15 | loss: 0.2607816
	speed: 0.6218s/iter; left time: 2553.6053s
	iters: 200, epoch: 15 | loss: 0.2773944
	speed: 0.3326s/iter; left time: 1332.5714s
	iters: 300, epoch: 15 | loss: 0.2583639
	speed: 0.3319s/iter; left time: 1296.5927s
	iters: 400, epoch: 15 | loss: 0.2444981
	speed: 0.3303s/iter; left time: 1257.4607s
	iters: 500, epoch: 15 | loss: 0.2769502
	speed: 0.3301s/iter; left time: 1223.8328s
	iters: 600, epoch: 15 | loss: 0.2647891
	speed: 0.3304s/iter; left time: 1191.6635s
	iters: 700, epoch: 15 | loss: 0.2732260
	speed: 0.3301s/iter; left time: 1157.6618s
Epoch: 15 cost time: 232.24229550361633
Epoch: 15, Steps: 701 | Train Loss: 0.2653346 Vali Loss: 0.4205024 Test Loss: 0.4829431
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 16 | loss: 0.2531845
	speed: 0.6139s/iter; left time: 2090.8050s
	iters: 200, epoch: 16 | loss: 0.2742511
	speed: 0.3300s/iter; left time: 1091.0142s
	iters: 300, epoch: 16 | loss: 0.2567512
	speed: 0.3300s/iter; left time: 1058.0934s
	iters: 400, epoch: 16 | loss: 0.2684374
	speed: 0.3300s/iter; left time: 1024.9000s
	iters: 500, epoch: 16 | loss: 0.2413604
	speed: 0.3304s/iter; left time: 993.2441s
	iters: 600, epoch: 16 | loss: 0.2414878
	speed: 0.3301s/iter; left time: 959.2082s
	iters: 700, epoch: 16 | loss: 0.2511526
	speed: 0.3301s/iter; left time: 926.3781s
Epoch: 16 cost time: 231.45140290260315
Epoch: 16, Steps: 701 | Train Loss: 0.2653101 Vali Loss: 0.4201033 Test Loss: 0.4829430
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 17 | loss: 0.2581398
	speed: 0.6160s/iter; left time: 1666.2494s
	iters: 200, epoch: 17 | loss: 0.2845050
	speed: 0.3314s/iter; left time: 863.3627s
	iters: 300, epoch: 17 | loss: 0.2627856
	speed: 0.3297s/iter; left time: 825.8018s
	iters: 400, epoch: 17 | loss: 0.2719335
	speed: 0.3287s/iter; left time: 790.4258s
	iters: 500, epoch: 17 | loss: 0.2988291
	speed: 0.3286s/iter; left time: 757.5372s
	iters: 600, epoch: 17 | loss: 0.2825799
	speed: 0.3290s/iter; left time: 725.3662s
	iters: 700, epoch: 17 | loss: 0.2579431
	speed: 0.3289s/iter; left time: 692.3000s
Epoch: 17 cost time: 231.27072548866272
Epoch: 17, Steps: 701 | Train Loss: 0.2653045 Vali Loss: 0.4200827 Test Loss: 0.4829422
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 18 | loss: 0.2723482
	speed: 0.6146s/iter; left time: 1231.5745s
	iters: 200, epoch: 18 | loss: 0.2723994
	speed: 0.3294s/iter; left time: 627.2666s
	iters: 300, epoch: 18 | loss: 0.2718158
	speed: 0.3289s/iter; left time: 593.3896s
	iters: 400, epoch: 18 | loss: 0.2679110
	speed: 0.3290s/iter; left time: 560.5970s
	iters: 500, epoch: 18 | loss: 0.2496852
	speed: 0.3296s/iter; left time: 528.7335s
	iters: 600, epoch: 18 | loss: 0.2623999
	speed: 0.3301s/iter; left time: 496.4038s
	iters: 700, epoch: 18 | loss: 0.2660220
	speed: 0.3301s/iter; left time: 463.4187s
Epoch: 18 cost time: 231.1092176437378
Epoch: 18, Steps: 701 | Train Loss: 0.2652984 Vali Loss: 0.4198413 Test Loss: 0.4829423
EarlyStopping counter: 4 out of 5
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 19 | loss: 0.2771390
	speed: 0.6146s/iter; left time: 800.8855s
	iters: 200, epoch: 19 | loss: 0.2563195
	speed: 0.3305s/iter; left time: 397.5823s
	iters: 300, epoch: 19 | loss: 0.2697925
	speed: 0.3300s/iter; left time: 364.0399s
	iters: 400, epoch: 19 | loss: 0.2617859
	speed: 0.3294s/iter; left time: 330.3827s
	iters: 500, epoch: 19 | loss: 0.2650849
	speed: 0.3302s/iter; left time: 298.1269s
	iters: 600, epoch: 19 | loss: 0.2819070
	speed: 0.3296s/iter; left time: 264.6629s
	iters: 700, epoch: 19 | loss: 0.2698487
	speed: 0.3301s/iter; left time: 232.0314s
Epoch: 19 cost time: 231.39406871795654
Epoch: 19, Steps: 701 | Train Loss: 0.2652979 Vali Loss: 0.4198144 Test Loss: 0.4829422
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : traffic_336_720_Linear_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed25565<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2789
mse:0.48275238275527954, mae:0.3304975628852844
