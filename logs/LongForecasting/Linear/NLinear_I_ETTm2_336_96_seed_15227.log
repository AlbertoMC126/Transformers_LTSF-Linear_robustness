Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='NLinear', model_id='ETTm2_336_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=15227, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTm2_336_96_NLinear_ETTm2_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15227>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34129
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.2385183
	speed: 0.0047s/iter; left time: 99.9175s
	iters: 200, epoch: 1 | loss: 0.4787493
	speed: 0.0054s/iter; left time: 113.6766s
	iters: 300, epoch: 1 | loss: 0.2299662
	speed: 0.0053s/iter; left time: 111.0312s
	iters: 400, epoch: 1 | loss: 0.3780522
	speed: 0.0048s/iter; left time: 100.0147s
	iters: 500, epoch: 1 | loss: 2.1384947
	speed: 0.0046s/iter; left time: 95.1518s
	iters: 600, epoch: 1 | loss: 0.3265640
	speed: 0.0044s/iter; left time: 91.4161s
	iters: 700, epoch: 1 | loss: 0.2490560
	speed: 0.0051s/iter; left time: 105.3857s
	iters: 800, epoch: 1 | loss: 0.3531436
	speed: 0.0054s/iter; left time: 110.6748s
	iters: 900, epoch: 1 | loss: 0.2732978
	speed: 0.0054s/iter; left time: 110.9398s
	iters: 1000, epoch: 1 | loss: 0.2856049
	speed: 0.0053s/iter; left time: 108.5143s
Epoch: 1 cost time: 5.39713191986084
Epoch: 1, Steps: 1066 | Train Loss: 0.5710437 Vali Loss: 0.2454996 Test Loss: 0.3321397
Validation loss decreased (inf --> 0.245500).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 1.1618749
	speed: 0.0204s/iter; left time: 412.0832s
	iters: 200, epoch: 2 | loss: 0.4607694
	speed: 0.0040s/iter; left time: 79.6743s
	iters: 300, epoch: 2 | loss: 0.2549666
	speed: 0.0042s/iter; left time: 84.4091s
	iters: 400, epoch: 2 | loss: 0.2404247
	speed: 0.0039s/iter; left time: 76.4421s
	iters: 500, epoch: 2 | loss: 0.3273307
	speed: 0.0047s/iter; left time: 92.3098s
	iters: 600, epoch: 2 | loss: 0.9855083
	speed: 0.0050s/iter; left time: 99.2576s
	iters: 700, epoch: 2 | loss: 0.2545787
	speed: 0.0047s/iter; left time: 92.6010s
	iters: 800, epoch: 2 | loss: 0.2117786
	speed: 0.0040s/iter; left time: 77.0533s
	iters: 900, epoch: 2 | loss: 0.5104808
	speed: 0.0040s/iter; left time: 77.8526s
	iters: 1000, epoch: 2 | loss: 0.2917659
	speed: 0.0044s/iter; left time: 84.3369s
Epoch: 2 cost time: 4.653290271759033
Epoch: 2, Steps: 1066 | Train Loss: 0.4644700 Vali Loss: 0.1688408 Test Loss: 0.2272938
Validation loss decreased (0.245500 --> 0.168841).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.2437194
	speed: 0.0219s/iter; left time: 418.2904s
	iters: 200, epoch: 3 | loss: 0.3343754
	speed: 0.0039s/iter; left time: 74.4733s
	iters: 300, epoch: 3 | loss: 0.2540915
	speed: 0.0045s/iter; left time: 84.6317s
	iters: 400, epoch: 3 | loss: 0.1754579
	speed: 0.0047s/iter; left time: 89.1179s
	iters: 500, epoch: 3 | loss: 0.1272836
	speed: 0.0047s/iter; left time: 88.3987s
	iters: 600, epoch: 3 | loss: 0.2237004
	speed: 0.0048s/iter; left time: 88.3065s
	iters: 700, epoch: 3 | loss: 0.3375462
	speed: 0.0050s/iter; left time: 91.9175s
	iters: 800, epoch: 3 | loss: 0.3172047
	speed: 0.0043s/iter; left time: 79.2565s
	iters: 900, epoch: 3 | loss: 0.2985304
	speed: 0.0044s/iter; left time: 80.1468s
	iters: 1000, epoch: 3 | loss: 0.2529272
	speed: 0.0046s/iter; left time: 83.3057s
Epoch: 3 cost time: 4.811964273452759
Epoch: 3, Steps: 1066 | Train Loss: 0.2713207 Vali Loss: 0.1478115 Test Loss: 0.2051932
Validation loss decreased (0.168841 --> 0.147811).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.2480929
	speed: 0.0184s/iter; left time: 331.0034s
	iters: 200, epoch: 4 | loss: 0.1483381
	speed: 0.0042s/iter; left time: 76.0389s
	iters: 300, epoch: 4 | loss: 0.4407347
	speed: 0.0043s/iter; left time: 76.9951s
	iters: 400, epoch: 4 | loss: 0.1331560
	speed: 0.0045s/iter; left time: 80.2852s
	iters: 500, epoch: 4 | loss: 0.2305503
	speed: 0.0044s/iter; left time: 76.7109s
	iters: 600, epoch: 4 | loss: 0.2764605
	speed: 0.0049s/iter; left time: 86.0378s
	iters: 700, epoch: 4 | loss: 0.4728206
	speed: 0.0039s/iter; left time: 68.3526s
	iters: 800, epoch: 4 | loss: 0.1315180
	speed: 0.0050s/iter; left time: 86.9701s
	iters: 900, epoch: 4 | loss: 0.2072176
	speed: 0.0049s/iter; left time: 84.7811s
	iters: 1000, epoch: 4 | loss: 0.2910480
	speed: 0.0046s/iter; left time: 78.4230s
Epoch: 4 cost time: 4.853376150131226
Epoch: 4, Steps: 1066 | Train Loss: 0.2403203 Vali Loss: 0.1242410 Test Loss: 0.1800468
Validation loss decreased (0.147811 --> 0.124241).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.1999031
	speed: 0.0215s/iter; left time: 363.9715s
	iters: 200, epoch: 5 | loss: 0.1499156
	speed: 0.0043s/iter; left time: 71.8605s
	iters: 300, epoch: 5 | loss: 0.2893118
	speed: 0.0044s/iter; left time: 73.5722s
	iters: 400, epoch: 5 | loss: 0.3371470
	speed: 0.0039s/iter; left time: 65.4916s
	iters: 500, epoch: 5 | loss: 0.1615816
	speed: 0.0045s/iter; left time: 75.0032s
	iters: 600, epoch: 5 | loss: 0.1635268
	speed: 0.0049s/iter; left time: 80.8475s
	iters: 700, epoch: 5 | loss: 0.1346206
	speed: 0.0039s/iter; left time: 64.4464s
	iters: 800, epoch: 5 | loss: 0.2975211
	speed: 0.0040s/iter; left time: 65.5161s
	iters: 900, epoch: 5 | loss: 0.1204894
	speed: 0.0045s/iter; left time: 72.2723s
	iters: 1000, epoch: 5 | loss: 0.1687206
	speed: 0.0050s/iter; left time: 79.4927s
Epoch: 5 cost time: 4.705521583557129
Epoch: 5, Steps: 1066 | Train Loss: 0.2221984 Vali Loss: 0.1217828 Test Loss: 0.1727679
Validation loss decreased (0.124241 --> 0.121783).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.1038743
	speed: 0.0213s/iter; left time: 338.4135s
	iters: 200, epoch: 6 | loss: 0.6742845
	speed: 0.0045s/iter; left time: 71.4327s
	iters: 300, epoch: 6 | loss: 0.1843104
	speed: 0.0045s/iter; left time: 69.9821s
	iters: 400, epoch: 6 | loss: 0.2748654
	speed: 0.0042s/iter; left time: 64.7532s
	iters: 500, epoch: 6 | loss: 0.2284445
	speed: 0.0046s/iter; left time: 71.8874s
	iters: 600, epoch: 6 | loss: 0.1808581
	speed: 0.0051s/iter; left time: 78.9859s
	iters: 700, epoch: 6 | loss: 0.4057963
	speed: 0.0047s/iter; left time: 71.2560s
	iters: 800, epoch: 6 | loss: 0.1700970
	speed: 0.0053s/iter; left time: 80.8292s
	iters: 900, epoch: 6 | loss: 0.5750470
	speed: 0.0048s/iter; left time: 72.5878s
	iters: 1000, epoch: 6 | loss: 0.1292875
	speed: 0.0049s/iter; left time: 73.6538s
Epoch: 6 cost time: 4.9924094676971436
Epoch: 6, Steps: 1066 | Train Loss: 0.2142017 Vali Loss: 0.1187501 Test Loss: 0.1662076
Validation loss decreased (0.121783 --> 0.118750).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.1824676
	speed: 0.0211s/iter; left time: 312.8875s
	iters: 200, epoch: 7 | loss: 0.1454516
	speed: 0.0053s/iter; left time: 77.8951s
	iters: 300, epoch: 7 | loss: 0.1206370
	speed: 0.0053s/iter; left time: 76.9661s
	iters: 400, epoch: 7 | loss: 0.1573500
	speed: 0.0053s/iter; left time: 76.2563s
	iters: 500, epoch: 7 | loss: 0.1550271
	speed: 0.0053s/iter; left time: 76.2262s
	iters: 600, epoch: 7 | loss: 0.0891136
	speed: 0.0053s/iter; left time: 76.4955s
	iters: 700, epoch: 7 | loss: 0.3066999
	speed: 0.0045s/iter; left time: 63.9079s
	iters: 800, epoch: 7 | loss: 0.0978286
	speed: 0.0043s/iter; left time: 60.8855s
	iters: 900, epoch: 7 | loss: 0.7893535
	speed: 0.0044s/iter; left time: 61.7576s
	iters: 1000, epoch: 7 | loss: 0.4245480
	speed: 0.0040s/iter; left time: 55.2823s
Epoch: 7 cost time: 5.168563365936279
Epoch: 7, Steps: 1066 | Train Loss: 0.2101557 Vali Loss: 0.1167554 Test Loss: 0.1652032
Validation loss decreased (0.118750 --> 0.116755).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.2219931
	speed: 0.0204s/iter; left time: 280.3775s
	iters: 200, epoch: 8 | loss: 0.1963379
	speed: 0.0043s/iter; left time: 58.3754s
	iters: 300, epoch: 8 | loss: 0.1595267
	speed: 0.0046s/iter; left time: 62.2358s
	iters: 400, epoch: 8 | loss: 0.4633577
	speed: 0.0037s/iter; left time: 50.3407s
	iters: 500, epoch: 8 | loss: 0.1449878
	speed: 0.0047s/iter; left time: 63.2247s
	iters: 600, epoch: 8 | loss: 0.3460344
	speed: 0.0044s/iter; left time: 57.9418s
	iters: 700, epoch: 8 | loss: 0.1834194
	speed: 0.0037s/iter; left time: 49.3419s
	iters: 800, epoch: 8 | loss: 0.1845802
	speed: 0.0044s/iter; left time: 57.7210s
	iters: 900, epoch: 8 | loss: 0.1542108
	speed: 0.0039s/iter; left time: 50.1796s
	iters: 1000, epoch: 8 | loss: 0.2187238
	speed: 0.0046s/iter; left time: 59.1579s
Epoch: 8 cost time: 4.625185251235962
Epoch: 8, Steps: 1066 | Train Loss: 0.2070769 Vali Loss: 0.1166131 Test Loss: 0.1639939
Validation loss decreased (0.116755 --> 0.116613).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.1686941
	speed: 0.0204s/iter; left time: 258.8979s
	iters: 200, epoch: 9 | loss: 0.1211322
	speed: 0.0052s/iter; left time: 65.5125s
	iters: 300, epoch: 9 | loss: 0.3753648
	speed: 0.0044s/iter; left time: 54.4471s
	iters: 400, epoch: 9 | loss: 0.2060324
	speed: 0.0044s/iter; left time: 54.1574s
	iters: 500, epoch: 9 | loss: 0.1826984
	speed: 0.0037s/iter; left time: 45.7570s
	iters: 600, epoch: 9 | loss: 0.4029008
	speed: 0.0033s/iter; left time: 40.6084s
	iters: 700, epoch: 9 | loss: 0.1506209
	speed: 0.0045s/iter; left time: 54.0796s
	iters: 800, epoch: 9 | loss: 0.3143455
	speed: 0.0033s/iter; left time: 39.8168s
	iters: 900, epoch: 9 | loss: 0.4371789
	speed: 0.0039s/iter; left time: 46.8583s
	iters: 1000, epoch: 9 | loss: 0.3026039
	speed: 0.0038s/iter; left time: 45.1668s
Epoch: 9 cost time: 4.5455286502838135
Epoch: 9, Steps: 1066 | Train Loss: 0.2055861 Vali Loss: 0.1164210 Test Loss: 0.1655344
Validation loss decreased (0.116613 --> 0.116421).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.1861676
	speed: 0.0216s/iter; left time: 251.4901s
	iters: 200, epoch: 10 | loss: 0.2637795
	speed: 0.0039s/iter; left time: 45.2813s
	iters: 300, epoch: 10 | loss: 0.1350400
	speed: 0.0040s/iter; left time: 45.2715s
	iters: 400, epoch: 10 | loss: 0.3496901
	speed: 0.0041s/iter; left time: 46.7806s
	iters: 500, epoch: 10 | loss: 0.1273876
	speed: 0.0049s/iter; left time: 55.3918s
	iters: 600, epoch: 10 | loss: 0.1720325
	speed: 0.0036s/iter; left time: 39.6121s
	iters: 700, epoch: 10 | loss: 0.1243031
	speed: 0.0029s/iter; left time: 32.4193s
	iters: 800, epoch: 10 | loss: 0.1627534
	speed: 0.0043s/iter; left time: 46.9102s
	iters: 900, epoch: 10 | loss: 0.1858670
	speed: 0.0042s/iter; left time: 45.3162s
	iters: 1000, epoch: 10 | loss: 0.1767153
	speed: 0.0047s/iter; left time: 50.7572s
Epoch: 10 cost time: 4.3267822265625
Epoch: 10, Steps: 1066 | Train Loss: 0.2053056 Vali Loss: 0.1149297 Test Loss: 0.1623979
Validation loss decreased (0.116421 --> 0.114930).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.2257390
	speed: 0.0196s/iter; left time: 206.7944s
	iters: 200, epoch: 11 | loss: 0.1191928
	speed: 0.0052s/iter; left time: 54.5289s
	iters: 300, epoch: 11 | loss: 0.3398459
	speed: 0.0050s/iter; left time: 52.0409s
	iters: 400, epoch: 11 | loss: 0.3202620
	speed: 0.0051s/iter; left time: 52.7475s
	iters: 500, epoch: 11 | loss: 0.1009771
	speed: 0.0052s/iter; left time: 53.1695s
	iters: 600, epoch: 11 | loss: 0.1175646
	speed: 0.0051s/iter; left time: 51.6129s
	iters: 700, epoch: 11 | loss: 0.2384471
	speed: 0.0049s/iter; left time: 49.1444s
	iters: 800, epoch: 11 | loss: 0.4594153
	speed: 0.0047s/iter; left time: 46.3467s
	iters: 900, epoch: 11 | loss: 0.1399929
	speed: 0.0052s/iter; left time: 50.6776s
	iters: 1000, epoch: 11 | loss: 0.1591770
	speed: 0.0053s/iter; left time: 50.8007s
Epoch: 11 cost time: 5.399250030517578
Epoch: 11, Steps: 1066 | Train Loss: 0.2046690 Vali Loss: 0.1154389 Test Loss: 0.1631896
EarlyStopping counter: 1 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.1864391
	speed: 0.0226s/iter; left time: 214.4552s
	iters: 200, epoch: 12 | loss: 0.2253392
	speed: 0.0046s/iter; left time: 42.8186s
	iters: 300, epoch: 12 | loss: 0.1443548
	speed: 0.0040s/iter; left time: 36.9943s
	iters: 400, epoch: 12 | loss: 0.1899152
	speed: 0.0040s/iter; left time: 36.7334s
	iters: 500, epoch: 12 | loss: 0.1888631
	speed: 0.0044s/iter; left time: 40.3816s
	iters: 600, epoch: 12 | loss: 0.3794236
	speed: 0.0040s/iter; left time: 36.2497s
	iters: 700, epoch: 12 | loss: 0.2606253
	speed: 0.0042s/iter; left time: 37.5543s
	iters: 800, epoch: 12 | loss: 0.1671778
	speed: 0.0043s/iter; left time: 37.6479s
	iters: 900, epoch: 12 | loss: 0.2466784
	speed: 0.0045s/iter; left time: 39.4919s
	iters: 1000, epoch: 12 | loss: 0.1920054
	speed: 0.0040s/iter; left time: 34.6380s
Epoch: 12 cost time: 4.529699087142944
Epoch: 12, Steps: 1066 | Train Loss: 0.2044125 Vali Loss: 0.1158238 Test Loss: 0.1638712
EarlyStopping counter: 2 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.4731887
	speed: 0.0199s/iter; left time: 168.1229s
	iters: 200, epoch: 13 | loss: 0.1981842
	speed: 0.0048s/iter; left time: 39.7476s
	iters: 300, epoch: 13 | loss: 0.2653309
	speed: 0.0032s/iter; left time: 26.0037s
	iters: 400, epoch: 13 | loss: 0.3201686
	speed: 0.0034s/iter; left time: 27.3984s
	iters: 500, epoch: 13 | loss: 0.1033810
	speed: 0.0037s/iter; left time: 29.5696s
	iters: 600, epoch: 13 | loss: 0.2024542
	speed: 0.0034s/iter; left time: 26.9587s
	iters: 700, epoch: 13 | loss: 0.1521475
	speed: 0.0038s/iter; left time: 29.8284s
	iters: 800, epoch: 13 | loss: 0.2116614
	speed: 0.0045s/iter; left time: 34.5669s
	iters: 900, epoch: 13 | loss: 0.1472423
	speed: 0.0046s/iter; left time: 34.8645s
	iters: 1000, epoch: 13 | loss: 0.2038586
	speed: 0.0041s/iter; left time: 30.9587s
Epoch: 13 cost time: 4.319870471954346
Epoch: 13, Steps: 1066 | Train Loss: 0.2044970 Vali Loss: 0.1152004 Test Loss: 0.1626013
EarlyStopping counter: 3 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 14 | loss: 0.3167658
	speed: 0.0208s/iter; left time: 153.2376s
	iters: 200, epoch: 14 | loss: 0.1373980
	speed: 0.0039s/iter; left time: 28.3258s
	iters: 300, epoch: 14 | loss: 0.2061542
	speed: 0.0044s/iter; left time: 31.3151s
	iters: 400, epoch: 14 | loss: 0.1538183
	speed: 0.0053s/iter; left time: 37.7200s
	iters: 500, epoch: 14 | loss: 0.1240773
	speed: 0.0048s/iter; left time: 33.4424s
	iters: 600, epoch: 14 | loss: 0.2355472
	speed: 0.0050s/iter; left time: 34.4406s
	iters: 700, epoch: 14 | loss: 0.1851348
	speed: 0.0051s/iter; left time: 34.6397s
	iters: 800, epoch: 14 | loss: 0.3269973
	speed: 0.0052s/iter; left time: 34.9141s
	iters: 900, epoch: 14 | loss: 0.1709954
	speed: 0.0048s/iter; left time: 31.4537s
	iters: 1000, epoch: 14 | loss: 0.2759252
	speed: 0.0046s/iter; left time: 29.6006s
Epoch: 14 cost time: 5.132923126220703
Epoch: 14, Steps: 1066 | Train Loss: 0.2044143 Vali Loss: 0.1152944 Test Loss: 0.1627543
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 15 | loss: 0.1179220
	speed: 0.0243s/iter; left time: 152.8588s
	iters: 200, epoch: 15 | loss: 0.2304615
	speed: 0.0043s/iter; left time: 26.8351s
	iters: 300, epoch: 15 | loss: 0.1239198
	speed: 0.0047s/iter; left time: 28.7169s
	iters: 400, epoch: 15 | loss: 0.2200494
	speed: 0.0044s/iter; left time: 26.2680s
	iters: 500, epoch: 15 | loss: 0.1506447
	speed: 0.0045s/iter; left time: 26.6545s
	iters: 600, epoch: 15 | loss: 0.2094155
	speed: 0.0043s/iter; left time: 24.6489s
	iters: 700, epoch: 15 | loss: 0.1556777
	speed: 0.0046s/iter; left time: 26.4374s
	iters: 800, epoch: 15 | loss: 0.1922820
	speed: 0.0047s/iter; left time: 26.4303s
	iters: 900, epoch: 15 | loss: 0.1797709
	speed: 0.0048s/iter; left time: 26.2757s
	iters: 1000, epoch: 15 | loss: 0.1646094
	speed: 0.0048s/iter; left time: 26.0235s
Epoch: 15 cost time: 4.953709125518799
Epoch: 15, Steps: 1066 | Train Loss: 0.2043080 Vali Loss: 0.1153380 Test Loss: 0.1628341
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTm2_336_96_NLinear_ETTm2_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15227<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.16261114180088043, mae:0.25062382221221924
