Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='Linear', model_id='ETTm2_336_192', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=192, root_path='./dataset/', save_pred_values=False, seed=10458, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTm2_336_192_Linear_ETTm2_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed10458>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34033
val 11329
test 11329
	iters: 100, epoch: 1 | loss: 0.3314200
	speed: 0.0052s/iter; left time: 110.0849s
	iters: 200, epoch: 1 | loss: 0.5445716
	speed: 0.0055s/iter; left time: 116.4733s
	iters: 300, epoch: 1 | loss: 0.3016925
	speed: 0.0059s/iter; left time: 123.9214s
	iters: 400, epoch: 1 | loss: 0.3058344
	speed: 0.0062s/iter; left time: 129.3493s
	iters: 500, epoch: 1 | loss: 0.9055296
	speed: 0.0057s/iter; left time: 119.2119s
	iters: 600, epoch: 1 | loss: 0.3520958
	speed: 0.0057s/iter; left time: 118.0562s
	iters: 700, epoch: 1 | loss: 0.7337636
	speed: 0.0057s/iter; left time: 117.6092s
	iters: 800, epoch: 1 | loss: 0.3052351
	speed: 0.0057s/iter; left time: 115.6539s
	iters: 900, epoch: 1 | loss: 0.4254877
	speed: 0.0057s/iter; left time: 115.1684s
	iters: 1000, epoch: 1 | loss: 0.5594080
	speed: 0.0056s/iter; left time: 113.7124s
Epoch: 1 cost time: 6.017226934432983
Epoch: 1, Steps: 1063 | Train Loss: 0.5083334 Vali Loss: 1.2054513 Test Loss: 3.4475441
Validation loss decreased (inf --> 1.205451).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.4742666
	speed: 0.0225s/iter; left time: 452.1260s
	iters: 200, epoch: 2 | loss: 0.4582455
	speed: 0.0061s/iter; left time: 121.8543s
	iters: 300, epoch: 2 | loss: 0.6165990
	speed: 0.0053s/iter; left time: 105.6694s
	iters: 400, epoch: 2 | loss: 0.3231331
	speed: 0.0056s/iter; left time: 110.3262s
	iters: 500, epoch: 2 | loss: 0.6398602
	speed: 0.0061s/iter; left time: 120.1681s
	iters: 600, epoch: 2 | loss: 0.7437344
	speed: 0.0064s/iter; left time: 126.0757s
	iters: 700, epoch: 2 | loss: 0.8847432
	speed: 0.0066s/iter; left time: 128.1563s
	iters: 800, epoch: 2 | loss: 0.6648604
	speed: 0.0056s/iter; left time: 108.2069s
	iters: 900, epoch: 2 | loss: 0.4986745
	speed: 0.0055s/iter; left time: 106.0250s
	iters: 1000, epoch: 2 | loss: 0.3804170
	speed: 0.0060s/iter; left time: 115.5815s
Epoch: 2 cost time: 6.223118543624878
Epoch: 2, Steps: 1063 | Train Loss: 0.5020387 Vali Loss: 0.3144139 Test Loss: 0.5650571
Validation loss decreased (1.205451 --> 0.314414).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.2359290
	speed: 0.0210s/iter; left time: 399.4659s
	iters: 200, epoch: 3 | loss: 0.1264838
	speed: 0.0047s/iter; left time: 88.6476s
	iters: 300, epoch: 3 | loss: 0.3739503
	speed: 0.0053s/iter; left time: 99.0720s
	iters: 400, epoch: 3 | loss: 0.1963791
	speed: 0.0051s/iter; left time: 95.0448s
	iters: 500, epoch: 3 | loss: 0.3506151
	speed: 0.0049s/iter; left time: 90.7201s
	iters: 600, epoch: 3 | loss: 0.1957242
	speed: 0.0048s/iter; left time: 89.1955s
	iters: 700, epoch: 3 | loss: 0.3647922
	speed: 0.0053s/iter; left time: 97.5213s
	iters: 800, epoch: 3 | loss: 0.5223900
	speed: 0.0061s/iter; left time: 112.5869s
	iters: 900, epoch: 3 | loss: 0.2484705
	speed: 0.0063s/iter; left time: 115.3109s
	iters: 1000, epoch: 3 | loss: 0.4117413
	speed: 0.0064s/iter; left time: 116.2495s
Epoch: 3 cost time: 5.7063069343566895
Epoch: 3, Steps: 1063 | Train Loss: 0.3468125 Vali Loss: 0.3059389 Test Loss: 0.6683455
Validation loss decreased (0.314414 --> 0.305939).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.1903201
	speed: 0.0229s/iter; left time: 412.4287s
	iters: 200, epoch: 4 | loss: 0.1874994
	speed: 0.0054s/iter; left time: 96.5092s
	iters: 300, epoch: 4 | loss: 0.4180259
	speed: 0.0052s/iter; left time: 92.4654s
	iters: 400, epoch: 4 | loss: 0.3681062
	speed: 0.0056s/iter; left time: 98.5819s
	iters: 500, epoch: 4 | loss: 0.2846402
	speed: 0.0055s/iter; left time: 97.2171s
	iters: 600, epoch: 4 | loss: 0.2766225
	speed: 0.0051s/iter; left time: 89.4572s
	iters: 700, epoch: 4 | loss: 0.5824515
	speed: 0.0057s/iter; left time: 99.2305s
	iters: 800, epoch: 4 | loss: 0.3186595
	speed: 0.0062s/iter; left time: 106.3955s
	iters: 900, epoch: 4 | loss: 0.1845597
	speed: 0.0057s/iter; left time: 97.0714s
	iters: 1000, epoch: 4 | loss: 0.2170138
	speed: 0.0053s/iter; left time: 91.0433s
Epoch: 4 cost time: 5.9094398021698
Epoch: 4, Steps: 1063 | Train Loss: 0.3129061 Vali Loss: 0.1880771 Test Loss: 0.3039479
Validation loss decreased (0.305939 --> 0.188077).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.2952137
	speed: 0.0225s/iter; left time: 379.9967s
	iters: 200, epoch: 5 | loss: 0.1535605
	speed: 0.0061s/iter; left time: 101.7045s
	iters: 300, epoch: 5 | loss: 0.1907932
	speed: 0.0057s/iter; left time: 95.1178s
	iters: 400, epoch: 5 | loss: 0.2335003
	speed: 0.0061s/iter; left time: 101.0437s
	iters: 500, epoch: 5 | loss: 0.2617267
	speed: 0.0057s/iter; left time: 94.4415s
	iters: 600, epoch: 5 | loss: 0.2547649
	speed: 0.0060s/iter; left time: 98.8315s
	iters: 700, epoch: 5 | loss: 0.2617269
	speed: 0.0062s/iter; left time: 100.7898s
	iters: 800, epoch: 5 | loss: 0.1908679
	speed: 0.0062s/iter; left time: 100.7088s
	iters: 900, epoch: 5 | loss: 0.2834062
	speed: 0.0067s/iter; left time: 108.4677s
	iters: 1000, epoch: 5 | loss: 0.4276119
	speed: 0.0067s/iter; left time: 107.1162s
Epoch: 5 cost time: 6.4213292598724365
Epoch: 5, Steps: 1063 | Train Loss: 0.2956948 Vali Loss: 0.2899535 Test Loss: 0.6157641
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.2234295
	speed: 0.0245s/iter; left time: 387.7738s
	iters: 200, epoch: 6 | loss: 0.2363752
	speed: 0.0049s/iter; left time: 77.1559s
	iters: 300, epoch: 6 | loss: 0.4247200
	speed: 0.0048s/iter; left time: 75.1325s
	iters: 400, epoch: 6 | loss: 0.1870453
	speed: 0.0058s/iter; left time: 90.2998s
	iters: 500, epoch: 6 | loss: 0.1844549
	speed: 0.0059s/iter; left time: 91.7845s
	iters: 600, epoch: 6 | loss: 0.1791668
	speed: 0.0061s/iter; left time: 92.8661s
	iters: 700, epoch: 6 | loss: 0.3385473
	speed: 0.0066s/iter; left time: 101.2338s
	iters: 800, epoch: 6 | loss: 0.1893798
	speed: 0.0064s/iter; left time: 96.9762s
	iters: 900, epoch: 6 | loss: 0.1871130
	speed: 0.0054s/iter; left time: 80.9473s
	iters: 1000, epoch: 6 | loss: 0.3017272
	speed: 0.0048s/iter; left time: 72.0953s
Epoch: 6 cost time: 5.887555837631226
Epoch: 6, Steps: 1063 | Train Loss: 0.2861751 Vali Loss: 0.1943743 Test Loss: 0.3433730
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.3931388
	speed: 0.0216s/iter; left time: 319.5535s
	iters: 200, epoch: 7 | loss: 0.1299589
	speed: 0.0057s/iter; left time: 83.5999s
	iters: 300, epoch: 7 | loss: 0.2775607
	speed: 0.0063s/iter; left time: 91.1438s
	iters: 400, epoch: 7 | loss: 0.2685174
	speed: 0.0056s/iter; left time: 80.5648s
	iters: 500, epoch: 7 | loss: 0.1575894
	speed: 0.0060s/iter; left time: 86.3072s
	iters: 600, epoch: 7 | loss: 0.4680715
	speed: 0.0063s/iter; left time: 89.3165s
	iters: 700, epoch: 7 | loss: 0.2638814
	speed: 0.0060s/iter; left time: 84.6845s
	iters: 800, epoch: 7 | loss: 0.2742895
	speed: 0.0059s/iter; left time: 82.9954s
	iters: 900, epoch: 7 | loss: 0.2366148
	speed: 0.0056s/iter; left time: 78.6249s
	iters: 1000, epoch: 7 | loss: 0.5153133
	speed: 0.0055s/iter; left time: 76.7051s
Epoch: 7 cost time: 6.177502632141113
Epoch: 7, Steps: 1063 | Train Loss: 0.2804773 Vali Loss: 0.1857906 Test Loss: 0.3057888
Validation loss decreased (0.188077 --> 0.185791).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.1619876
	speed: 0.0210s/iter; left time: 287.5063s
	iters: 200, epoch: 8 | loss: 0.1835848
	speed: 0.0054s/iter; left time: 73.3225s
	iters: 300, epoch: 8 | loss: 0.2581378
	speed: 0.0054s/iter; left time: 73.3072s
	iters: 400, epoch: 8 | loss: 0.2072049
	speed: 0.0054s/iter; left time: 71.8036s
	iters: 500, epoch: 8 | loss: 0.2297883
	speed: 0.0062s/iter; left time: 82.7455s
	iters: 600, epoch: 8 | loss: 0.3382312
	speed: 0.0059s/iter; left time: 78.1301s
	iters: 700, epoch: 8 | loss: 0.1331489
	speed: 0.0061s/iter; left time: 80.0377s
	iters: 800, epoch: 8 | loss: 0.4084222
	speed: 0.0062s/iter; left time: 80.3335s
	iters: 900, epoch: 8 | loss: 0.2262799
	speed: 0.0063s/iter; left time: 80.9226s
	iters: 1000, epoch: 8 | loss: 0.2678562
	speed: 0.0066s/iter; left time: 84.7666s
Epoch: 8 cost time: 6.2214577198028564
Epoch: 8, Steps: 1063 | Train Loss: 0.2778161 Vali Loss: 0.2033368 Test Loss: 0.3625175
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.1616010
	speed: 0.0242s/iter; left time: 306.1059s
	iters: 200, epoch: 9 | loss: 0.1688963
	speed: 0.0055s/iter; left time: 68.8318s
	iters: 300, epoch: 9 | loss: 0.3207657
	speed: 0.0056s/iter; left time: 69.6346s
	iters: 400, epoch: 9 | loss: 0.4796111
	speed: 0.0055s/iter; left time: 67.6107s
	iters: 500, epoch: 9 | loss: 0.1783328
	speed: 0.0054s/iter; left time: 65.9490s
	iters: 600, epoch: 9 | loss: 0.3348254
	speed: 0.0060s/iter; left time: 73.4683s
	iters: 700, epoch: 9 | loss: 0.4739767
	speed: 0.0055s/iter; left time: 66.1055s
	iters: 800, epoch: 9 | loss: 0.1882589
	speed: 0.0061s/iter; left time: 73.4161s
	iters: 900, epoch: 9 | loss: 0.2177374
	speed: 0.0061s/iter; left time: 71.9963s
	iters: 1000, epoch: 9 | loss: 0.1471717
	speed: 0.0058s/iter; left time: 67.7166s
Epoch: 9 cost time: 6.041399717330933
Epoch: 9, Steps: 1063 | Train Loss: 0.2760896 Vali Loss: 0.1804249 Test Loss: 0.2909815
Validation loss decreased (0.185791 --> 0.180425).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.2942239
	speed: 0.0259s/iter; left time: 300.3905s
	iters: 200, epoch: 10 | loss: 0.2934581
	speed: 0.0064s/iter; left time: 73.5845s
	iters: 300, epoch: 10 | loss: 0.1990378
	speed: 0.0059s/iter; left time: 67.2057s
	iters: 400, epoch: 10 | loss: 0.3615915
	speed: 0.0065s/iter; left time: 73.3635s
	iters: 500, epoch: 10 | loss: 0.4538036
	speed: 0.0049s/iter; left time: 54.2977s
	iters: 600, epoch: 10 | loss: 0.2401170
	speed: 0.0062s/iter; left time: 68.5857s
	iters: 700, epoch: 10 | loss: 0.3361220
	speed: 0.0054s/iter; left time: 59.6974s
	iters: 800, epoch: 10 | loss: 0.2403369
	speed: 0.0059s/iter; left time: 64.3015s
	iters: 900, epoch: 10 | loss: 0.1712880
	speed: 0.0054s/iter; left time: 57.7807s
	iters: 1000, epoch: 10 | loss: 0.3118722
	speed: 0.0054s/iter; left time: 57.5388s
Epoch: 10 cost time: 6.175782918930054
Epoch: 10, Steps: 1063 | Train Loss: 0.2751745 Vali Loss: 0.1923790 Test Loss: 0.3275790
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.2061418
	speed: 0.0228s/iter; left time: 239.7432s
	iters: 200, epoch: 11 | loss: 0.3026913
	speed: 0.0050s/iter; left time: 52.0781s
	iters: 300, epoch: 11 | loss: 0.2622708
	speed: 0.0051s/iter; left time: 52.4815s
	iters: 400, epoch: 11 | loss: 0.2416834
	speed: 0.0059s/iter; left time: 60.3931s
	iters: 500, epoch: 11 | loss: 0.3466004
	speed: 0.0054s/iter; left time: 54.2257s
	iters: 600, epoch: 11 | loss: 0.2150675
	speed: 0.0051s/iter; left time: 51.3587s
	iters: 700, epoch: 11 | loss: 0.2120817
	speed: 0.0057s/iter; left time: 56.2152s
	iters: 800, epoch: 11 | loss: 0.3542692
	speed: 0.0056s/iter; left time: 54.7587s
	iters: 900, epoch: 11 | loss: 0.3106147
	speed: 0.0050s/iter; left time: 48.2209s
	iters: 1000, epoch: 11 | loss: 0.2222124
	speed: 0.0048s/iter; left time: 46.0418s
Epoch: 11 cost time: 5.547457218170166
Epoch: 11, Steps: 1063 | Train Loss: 0.2746615 Vali Loss: 0.1996492 Test Loss: 0.3513193
EarlyStopping counter: 2 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.1907330
	speed: 0.0219s/iter; left time: 207.2816s
	iters: 200, epoch: 12 | loss: 0.1718912
	speed: 0.0050s/iter; left time: 46.6798s
	iters: 300, epoch: 12 | loss: 0.3000360
	speed: 0.0053s/iter; left time: 49.5838s
	iters: 400, epoch: 12 | loss: 0.3847532
	speed: 0.0055s/iter; left time: 50.1891s
	iters: 500, epoch: 12 | loss: 0.1931712
	speed: 0.0062s/iter; left time: 55.8483s
	iters: 600, epoch: 12 | loss: 0.3179412
	speed: 0.0052s/iter; left time: 46.9922s
	iters: 700, epoch: 12 | loss: 0.3321197
	speed: 0.0054s/iter; left time: 47.7306s
	iters: 800, epoch: 12 | loss: 0.1678647
	speed: 0.0054s/iter; left time: 47.5957s
	iters: 900, epoch: 12 | loss: 0.2388865
	speed: 0.0052s/iter; left time: 45.3559s
	iters: 1000, epoch: 12 | loss: 0.2935372
	speed: 0.0057s/iter; left time: 49.1804s
Epoch: 12 cost time: 5.695091009140015
Epoch: 12, Steps: 1063 | Train Loss: 0.2743355 Vali Loss: 0.1962719 Test Loss: 0.3405887
EarlyStopping counter: 3 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.2297620
	speed: 0.0227s/iter; left time: 190.6627s
	iters: 200, epoch: 13 | loss: 0.3537446
	speed: 0.0044s/iter; left time: 36.9049s
	iters: 300, epoch: 13 | loss: 0.3424360
	speed: 0.0043s/iter; left time: 35.6097s
	iters: 400, epoch: 13 | loss: 0.2353354
	speed: 0.0053s/iter; left time: 42.7579s
	iters: 500, epoch: 13 | loss: 0.1510362
	speed: 0.0060s/iter; left time: 47.7898s
	iters: 600, epoch: 13 | loss: 0.5028852
	speed: 0.0047s/iter; left time: 37.3359s
	iters: 700, epoch: 13 | loss: 0.4137168
	speed: 0.0044s/iter; left time: 34.2673s
	iters: 800, epoch: 13 | loss: 0.4128781
	speed: 0.0049s/iter; left time: 37.5491s
	iters: 900, epoch: 13 | loss: 0.2121625
	speed: 0.0042s/iter; left time: 31.9408s
	iters: 1000, epoch: 13 | loss: 0.2499892
	speed: 0.0036s/iter; left time: 27.2737s
Epoch: 13 cost time: 4.914037704467773
Epoch: 13, Steps: 1063 | Train Loss: 0.2741820 Vali Loss: 0.1996744 Test Loss: 0.3518122
EarlyStopping counter: 4 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 14 | loss: 0.2372981
	speed: 0.0130s/iter; left time: 95.4618s
	iters: 200, epoch: 14 | loss: 0.2688930
	speed: 0.0029s/iter; left time: 21.2914s
	iters: 300, epoch: 14 | loss: 0.2160141
	speed: 0.0030s/iter; left time: 21.7288s
	iters: 400, epoch: 14 | loss: 0.2388366
	speed: 0.0033s/iter; left time: 23.1682s
	iters: 500, epoch: 14 | loss: 0.2283203
	speed: 0.0039s/iter; left time: 26.8565s
	iters: 600, epoch: 14 | loss: 0.1810405
	speed: 0.0041s/iter; left time: 27.8695s
	iters: 700, epoch: 14 | loss: 0.6384755
	speed: 0.0033s/iter; left time: 22.1813s
	iters: 800, epoch: 14 | loss: 0.2211144
	speed: 0.0039s/iter; left time: 25.9037s
	iters: 900, epoch: 14 | loss: 0.5860042
	speed: 0.0033s/iter; left time: 21.5402s
	iters: 1000, epoch: 14 | loss: 0.3004407
	speed: 0.0028s/iter; left time: 17.9732s
Epoch: 14 cost time: 3.5247437953948975
Epoch: 14, Steps: 1063 | Train Loss: 0.2740236 Vali Loss: 0.1994039 Test Loss: 0.3500404
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTm2_336_192_Linear_ETTm2_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed10458<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
mse:0.2916067838668823, mae:0.3474040627479553
