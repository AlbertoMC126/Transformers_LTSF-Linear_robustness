Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='Linear', model_id='weather_336_192', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=192, root_path='./dataset/', save_pred_values=False, seed=3293, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : weather_336_192_Linear_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3293>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36360
val 5079
test 10348
	iters: 100, epoch: 1 | loss: 0.6091432
	speed: 0.0147s/iter; left time: 668.0521s
	iters: 200, epoch: 1 | loss: 0.5840194
	speed: 0.0143s/iter; left time: 649.0628s
	iters: 300, epoch: 1 | loss: 0.8730803
	speed: 0.0145s/iter; left time: 653.9006s
	iters: 400, epoch: 1 | loss: 0.4958615
	speed: 0.0146s/iter; left time: 659.7059s
	iters: 500, epoch: 1 | loss: 0.4000170
	speed: 0.0143s/iter; left time: 641.8573s
	iters: 600, epoch: 1 | loss: 1.2342848
	speed: 0.0144s/iter; left time: 643.5425s
	iters: 700, epoch: 1 | loss: 0.5488623
	speed: 0.0142s/iter; left time: 637.4439s
	iters: 800, epoch: 1 | loss: 1.7829294
	speed: 0.0147s/iter; left time: 655.3810s
	iters: 900, epoch: 1 | loss: 0.4354665
	speed: 0.0139s/iter; left time: 618.7889s
	iters: 1000, epoch: 1 | loss: 0.5657733
	speed: 0.0147s/iter; left time: 653.0211s
	iters: 1100, epoch: 1 | loss: 0.4929142
	speed: 0.0145s/iter; left time: 643.4178s
	iters: 1200, epoch: 1 | loss: 3.3006938
	speed: 0.0143s/iter; left time: 632.9635s
	iters: 1300, epoch: 1 | loss: 0.8280948
	speed: 0.0144s/iter; left time: 633.8924s
	iters: 1400, epoch: 1 | loss: 0.5591348
	speed: 0.0143s/iter; left time: 628.0455s
	iters: 1500, epoch: 1 | loss: 0.7173326
	speed: 0.0147s/iter; left time: 647.5301s
	iters: 1600, epoch: 1 | loss: 1.3698621
	speed: 0.0144s/iter; left time: 632.7858s
	iters: 1700, epoch: 1 | loss: 0.9229744
	speed: 0.0145s/iter; left time: 636.0663s
	iters: 1800, epoch: 1 | loss: 0.4349447
	speed: 0.0141s/iter; left time: 615.9489s
	iters: 1900, epoch: 1 | loss: 0.4731818
	speed: 0.0147s/iter; left time: 641.7606s
	iters: 2000, epoch: 1 | loss: 0.3834267
	speed: 0.0145s/iter; left time: 631.3551s
	iters: 2100, epoch: 1 | loss: 0.4614333
	speed: 0.0148s/iter; left time: 641.3180s
	iters: 2200, epoch: 1 | loss: 0.6195536
	speed: 0.0146s/iter; left time: 633.1984s
Epoch: 1 cost time: 32.91462850570679
Epoch: 1, Steps: 2272 | Train Loss: 1.4193140 Vali Loss: 0.6169330 Test Loss: 0.2832258
Validation loss decreased (inf --> 0.616933).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.4859839
	speed: 0.0531s/iter; left time: 2285.5010s
	iters: 200, epoch: 2 | loss: 0.5734054
	speed: 0.0146s/iter; left time: 627.1100s
	iters: 300, epoch: 2 | loss: 0.6668588
	speed: 0.0151s/iter; left time: 648.6766s
	iters: 400, epoch: 2 | loss: 0.6146789
	speed: 0.0146s/iter; left time: 624.9341s
	iters: 500, epoch: 2 | loss: 0.5251400
	speed: 0.0143s/iter; left time: 608.8055s
	iters: 600, epoch: 2 | loss: 1.5676534
	speed: 0.0148s/iter; left time: 629.3855s
	iters: 700, epoch: 2 | loss: 1.3385898
	speed: 0.0145s/iter; left time: 615.9105s
	iters: 800, epoch: 2 | loss: 2.2512848
	speed: 0.0140s/iter; left time: 593.5805s
	iters: 900, epoch: 2 | loss: 0.4396488
	speed: 0.0146s/iter; left time: 618.9318s
	iters: 1000, epoch: 2 | loss: 0.4979441
	speed: 0.0149s/iter; left time: 628.0181s
	iters: 1100, epoch: 2 | loss: 0.4480292
	speed: 0.0146s/iter; left time: 613.1711s
	iters: 1200, epoch: 2 | loss: 0.6234292
	speed: 0.0147s/iter; left time: 617.6989s
	iters: 1300, epoch: 2 | loss: 1.3888606
	speed: 0.0144s/iter; left time: 602.0168s
	iters: 1400, epoch: 2 | loss: 0.5279303
	speed: 0.0145s/iter; left time: 606.7555s
	iters: 1500, epoch: 2 | loss: 0.3985115
	speed: 0.0144s/iter; left time: 599.8201s
	iters: 1600, epoch: 2 | loss: 0.4375839
	speed: 0.0147s/iter; left time: 609.9056s
	iters: 1700, epoch: 2 | loss: 0.5507991
	speed: 0.0146s/iter; left time: 607.1955s
	iters: 1800, epoch: 2 | loss: 0.6623134
	speed: 0.0141s/iter; left time: 582.9232s
	iters: 1900, epoch: 2 | loss: 0.4259133
	speed: 0.0140s/iter; left time: 578.6512s
	iters: 2000, epoch: 2 | loss: 1.6212264
	speed: 0.0145s/iter; left time: 594.9860s
	iters: 2100, epoch: 2 | loss: 1.6666551
	speed: 0.0148s/iter; left time: 607.6697s
	iters: 2200, epoch: 2 | loss: 0.5534112
	speed: 0.0144s/iter; left time: 588.3186s
Epoch: 2 cost time: 32.97582459449768
Epoch: 2, Steps: 2272 | Train Loss: 1.0791149 Vali Loss: 0.5817637 Test Loss: 0.2641886
Validation loss decreased (0.616933 --> 0.581764).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 1.4039938
	speed: 0.0532s/iter; left time: 2171.6694s
	iters: 200, epoch: 3 | loss: 1.4828075
	speed: 0.0147s/iter; left time: 598.0781s
	iters: 300, epoch: 3 | loss: 0.5211280
	speed: 0.0145s/iter; left time: 587.9948s
	iters: 400, epoch: 3 | loss: 0.5169181
	speed: 0.0146s/iter; left time: 592.7733s
	iters: 500, epoch: 3 | loss: 0.4319248
	speed: 0.0141s/iter; left time: 568.6945s
	iters: 600, epoch: 3 | loss: 1.7442740
	speed: 0.0142s/iter; left time: 574.0646s
	iters: 700, epoch: 3 | loss: 0.4137466
	speed: 0.0144s/iter; left time: 578.5599s
	iters: 800, epoch: 3 | loss: 0.4558495
	speed: 0.0144s/iter; left time: 577.2538s
	iters: 900, epoch: 3 | loss: 0.3655435
	speed: 0.0146s/iter; left time: 584.2646s
	iters: 1000, epoch: 3 | loss: 0.4844403
	speed: 0.0146s/iter; left time: 580.9551s
	iters: 1100, epoch: 3 | loss: 0.4041936
	speed: 0.0143s/iter; left time: 567.9355s
	iters: 1200, epoch: 3 | loss: 0.3469161
	speed: 0.0145s/iter; left time: 575.5433s
	iters: 1300, epoch: 3 | loss: 0.3250550
	speed: 0.0142s/iter; left time: 563.1140s
	iters: 1400, epoch: 3 | loss: 0.4457541
	speed: 0.0149s/iter; left time: 587.1927s
	iters: 1500, epoch: 3 | loss: 0.4660746
	speed: 0.0147s/iter; left time: 578.2033s
	iters: 1600, epoch: 3 | loss: 0.5082176
	speed: 0.0149s/iter; left time: 583.6807s
	iters: 1700, epoch: 3 | loss: 0.4170278
	speed: 0.0143s/iter; left time: 562.1797s
	iters: 1800, epoch: 3 | loss: 0.4377110
	speed: 0.0150s/iter; left time: 585.2950s
	iters: 1900, epoch: 3 | loss: 0.3244569
	speed: 0.0140s/iter; left time: 547.6023s
	iters: 2000, epoch: 3 | loss: 2.2101238
	speed: 0.0145s/iter; left time: 565.2733s
	iters: 2100, epoch: 3 | loss: 0.3510001
	speed: 0.0149s/iter; left time: 579.1426s
	iters: 2200, epoch: 3 | loss: 0.4306306
	speed: 0.0149s/iter; left time: 577.2971s
Epoch: 3 cost time: 32.94551420211792
Epoch: 3, Steps: 2272 | Train Loss: 0.7490368 Vali Loss: 0.4725414 Test Loss: 0.2172071
Validation loss decreased (0.581764 --> 0.472541).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.2662290
	speed: 0.0533s/iter; left time: 2054.5722s
	iters: 200, epoch: 4 | loss: 1.3813621
	speed: 0.0150s/iter; left time: 575.4944s
	iters: 300, epoch: 4 | loss: 0.4226106
	speed: 0.0149s/iter; left time: 571.3261s
	iters: 400, epoch: 4 | loss: 1.1004885
	speed: 0.0145s/iter; left time: 552.7991s
	iters: 500, epoch: 4 | loss: 0.3628910
	speed: 0.0148s/iter; left time: 563.9422s
	iters: 600, epoch: 4 | loss: 0.3177551
	speed: 0.0143s/iter; left time: 545.2430s
	iters: 700, epoch: 4 | loss: 0.6068550
	speed: 0.0145s/iter; left time: 551.3109s
	iters: 800, epoch: 4 | loss: 0.6280921
	speed: 0.0147s/iter; left time: 556.3226s
	iters: 900, epoch: 4 | loss: 0.2645303
	speed: 0.0144s/iter; left time: 543.6470s
	iters: 1000, epoch: 4 | loss: 0.9192497
	speed: 0.0146s/iter; left time: 549.4146s
	iters: 1100, epoch: 4 | loss: 0.3285738
	speed: 0.0148s/iter; left time: 554.9368s
	iters: 1200, epoch: 4 | loss: 0.3530454
	speed: 0.0148s/iter; left time: 553.4627s
	iters: 1300, epoch: 4 | loss: 0.5087001
	speed: 0.0146s/iter; left time: 545.6087s
	iters: 1400, epoch: 4 | loss: 0.3994292
	speed: 0.0144s/iter; left time: 537.8379s
	iters: 1500, epoch: 4 | loss: 1.3923960
	speed: 0.0143s/iter; left time: 529.4909s
	iters: 1600, epoch: 4 | loss: 0.4053376
	speed: 0.0147s/iter; left time: 545.4577s
	iters: 1700, epoch: 4 | loss: 0.3226247
	speed: 0.0144s/iter; left time: 531.8285s
	iters: 1800, epoch: 4 | loss: 0.6190850
	speed: 0.0143s/iter; left time: 525.0057s
	iters: 1900, epoch: 4 | loss: 0.3364663
	speed: 0.0147s/iter; left time: 538.8226s
	iters: 2000, epoch: 4 | loss: 0.6360089
	speed: 0.0150s/iter; left time: 548.1598s
	iters: 2100, epoch: 4 | loss: 0.2343199
	speed: 0.0146s/iter; left time: 533.5058s
	iters: 2200, epoch: 4 | loss: 0.2615609
	speed: 0.0145s/iter; left time: 529.0383s
Epoch: 4 cost time: 33.11612010002136
Epoch: 4, Steps: 2272 | Train Loss: 0.5949427 Vali Loss: 0.4512276 Test Loss: 0.2033309
Validation loss decreased (0.472541 --> 0.451228).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.6045359
	speed: 0.0528s/iter; left time: 1913.9863s
	iters: 200, epoch: 5 | loss: 1.3501327
	speed: 0.0145s/iter; left time: 524.0305s
	iters: 300, epoch: 5 | loss: 5.2020612
	speed: 0.0146s/iter; left time: 526.1825s
	iters: 400, epoch: 5 | loss: 0.3743404
	speed: 0.0150s/iter; left time: 540.1261s
	iters: 500, epoch: 5 | loss: 0.3801680
	speed: 0.0146s/iter; left time: 522.9217s
	iters: 600, epoch: 5 | loss: 0.3581716
	speed: 0.0146s/iter; left time: 520.5113s
	iters: 700, epoch: 5 | loss: 1.2209520
	speed: 0.0148s/iter; left time: 525.9921s
	iters: 800, epoch: 5 | loss: 0.4232686
	speed: 0.0146s/iter; left time: 520.5535s
	iters: 900, epoch: 5 | loss: 0.3691218
	speed: 0.0151s/iter; left time: 535.0527s
	iters: 1000, epoch: 5 | loss: 0.3281234
	speed: 0.0143s/iter; left time: 506.2004s
	iters: 1100, epoch: 5 | loss: 0.4583915
	speed: 0.0143s/iter; left time: 505.7390s
	iters: 1200, epoch: 5 | loss: 0.3774702
	speed: 0.0145s/iter; left time: 508.5730s
	iters: 1300, epoch: 5 | loss: 0.2202557
	speed: 0.0145s/iter; left time: 509.9386s
	iters: 1400, epoch: 5 | loss: 0.5256835
	speed: 0.0145s/iter; left time: 507.2812s
	iters: 1500, epoch: 5 | loss: 0.4332080
	speed: 0.0141s/iter; left time: 492.3170s
	iters: 1600, epoch: 5 | loss: 0.2995997
	speed: 0.0143s/iter; left time: 496.6907s
	iters: 1700, epoch: 5 | loss: 0.3388490
	speed: 0.0142s/iter; left time: 493.6860s
	iters: 1800, epoch: 5 | loss: 0.3886517
	speed: 0.0148s/iter; left time: 512.6308s
	iters: 1900, epoch: 5 | loss: 0.7325329
	speed: 0.0147s/iter; left time: 504.8133s
	iters: 2000, epoch: 5 | loss: 0.5449225
	speed: 0.0147s/iter; left time: 504.1018s
	iters: 2100, epoch: 5 | loss: 1.4278624
	speed: 0.0146s/iter; left time: 500.8108s
	iters: 2200, epoch: 5 | loss: 0.3410539
	speed: 0.0143s/iter; left time: 489.0208s
Epoch: 5 cost time: 32.96574568748474
Epoch: 5, Steps: 2272 | Train Loss: 0.5476121 Vali Loss: 0.4333332 Test Loss: 0.1881343
Validation loss decreased (0.451228 --> 0.433333).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 1.2424288
	speed: 0.0525s/iter; left time: 1782.4192s
	iters: 200, epoch: 6 | loss: 4.8909216
	speed: 0.0149s/iter; left time: 504.2173s
	iters: 300, epoch: 6 | loss: 0.3082435
	speed: 0.0142s/iter; left time: 479.1082s
	iters: 400, epoch: 6 | loss: 0.4596721
	speed: 0.0147s/iter; left time: 494.0344s
	iters: 500, epoch: 6 | loss: 0.3450627
	speed: 0.0149s/iter; left time: 499.6188s
	iters: 600, epoch: 6 | loss: 1.5382215
	speed: 0.0141s/iter; left time: 470.4629s
	iters: 700, epoch: 6 | loss: 0.3842263
	speed: 0.0150s/iter; left time: 501.7502s
	iters: 800, epoch: 6 | loss: 0.3522573
	speed: 0.0144s/iter; left time: 477.8251s
	iters: 900, epoch: 6 | loss: 0.2585365
	speed: 0.0146s/iter; left time: 484.0308s
	iters: 1000, epoch: 6 | loss: 0.2906041
	speed: 0.0147s/iter; left time: 485.8330s
	iters: 1100, epoch: 6 | loss: 1.2926985
	speed: 0.0147s/iter; left time: 484.1928s
	iters: 1200, epoch: 6 | loss: 0.5289853
	speed: 0.0147s/iter; left time: 484.2580s
	iters: 1300, epoch: 6 | loss: 0.3983311
	speed: 0.0152s/iter; left time: 498.6463s
	iters: 1400, epoch: 6 | loss: 0.3930865
	speed: 0.0146s/iter; left time: 476.7701s
	iters: 1500, epoch: 6 | loss: 0.2433397
	speed: 0.0149s/iter; left time: 486.6716s
	iters: 1600, epoch: 6 | loss: 0.3408408
	speed: 0.0149s/iter; left time: 482.5775s
	iters: 1700, epoch: 6 | loss: 0.2652917
	speed: 0.0147s/iter; left time: 475.0604s
	iters: 1800, epoch: 6 | loss: 0.2328656
	speed: 0.0145s/iter; left time: 469.6162s
	iters: 1900, epoch: 6 | loss: 0.2682289
	speed: 0.0143s/iter; left time: 459.1297s
	iters: 2000, epoch: 6 | loss: 0.3126034
	speed: 0.0146s/iter; left time: 467.9690s
	iters: 2100, epoch: 6 | loss: 0.3571251
	speed: 0.0139s/iter; left time: 445.1105s
	iters: 2200, epoch: 6 | loss: 0.2575303
	speed: 0.0145s/iter; left time: 463.6079s
Epoch: 6 cost time: 33.045270681381226
Epoch: 6, Steps: 2272 | Train Loss: 0.5278483 Vali Loss: 0.4328105 Test Loss: 0.1934095
Validation loss decreased (0.433333 --> 0.432810).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.4012541
	speed: 0.0523s/iter; left time: 1659.6267s
	iters: 200, epoch: 7 | loss: 0.2862762
	speed: 0.0147s/iter; left time: 465.8610s
	iters: 300, epoch: 7 | loss: 1.2676498
	speed: 0.0146s/iter; left time: 459.1244s
	iters: 400, epoch: 7 | loss: 0.4822518
	speed: 0.0145s/iter; left time: 456.2391s
	iters: 500, epoch: 7 | loss: 0.3384552
	speed: 0.0140s/iter; left time: 436.8187s
	iters: 600, epoch: 7 | loss: 0.3961600
	speed: 0.0142s/iter; left time: 442.6885s
	iters: 700, epoch: 7 | loss: 2.6428611
	speed: 0.0144s/iter; left time: 448.6782s
	iters: 800, epoch: 7 | loss: 0.3199041
	speed: 0.0147s/iter; left time: 457.3673s
	iters: 900, epoch: 7 | loss: 0.4682732
	speed: 0.0149s/iter; left time: 459.8313s
	iters: 1000, epoch: 7 | loss: 0.3273781
	speed: 0.0144s/iter; left time: 444.2118s
	iters: 1100, epoch: 7 | loss: 0.2956167
	speed: 0.0148s/iter; left time: 453.2159s
	iters: 1200, epoch: 7 | loss: 0.3136150
	speed: 0.0150s/iter; left time: 458.4666s
	iters: 1300, epoch: 7 | loss: 0.3355536
	speed: 0.0145s/iter; left time: 443.2282s
	iters: 1400, epoch: 7 | loss: 0.5052943
	speed: 0.0145s/iter; left time: 439.9974s
	iters: 1500, epoch: 7 | loss: 4.4474301
	speed: 0.0146s/iter; left time: 443.2397s
	iters: 1600, epoch: 7 | loss: 0.4417639
	speed: 0.0144s/iter; left time: 435.6620s
	iters: 1700, epoch: 7 | loss: 0.5085579
	speed: 0.0147s/iter; left time: 442.1957s
	iters: 1800, epoch: 7 | loss: 0.4817781
	speed: 0.0145s/iter; left time: 434.0550s
	iters: 1900, epoch: 7 | loss: 0.4823827
	speed: 0.0147s/iter; left time: 440.0134s
	iters: 2000, epoch: 7 | loss: 0.2688822
	speed: 0.0148s/iter; left time: 440.1892s
	iters: 2100, epoch: 7 | loss: 1.2392359
	speed: 0.0147s/iter; left time: 436.6265s
	iters: 2200, epoch: 7 | loss: 0.3523445
	speed: 0.0145s/iter; left time: 428.1980s
Epoch: 7 cost time: 32.97543907165527
Epoch: 7, Steps: 2272 | Train Loss: 0.5184049 Vali Loss: 0.4231343 Test Loss: 0.1860352
Validation loss decreased (0.432810 --> 0.423134).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.4247952
	speed: 0.0527s/iter; left time: 1551.9003s
	iters: 200, epoch: 8 | loss: 0.2778461
	speed: 0.0146s/iter; left time: 426.9913s
	iters: 300, epoch: 8 | loss: 0.3199065
	speed: 0.0144s/iter; left time: 421.5204s
	iters: 400, epoch: 8 | loss: 1.2413594
	speed: 0.0146s/iter; left time: 425.4279s
	iters: 500, epoch: 8 | loss: 0.3744942
	speed: 0.0147s/iter; left time: 425.4433s
	iters: 600, epoch: 8 | loss: 0.3289908
	speed: 0.0146s/iter; left time: 423.8136s
	iters: 700, epoch: 8 | loss: 0.5152102
	speed: 0.0147s/iter; left time: 423.5004s
	iters: 800, epoch: 8 | loss: 0.4779236
	speed: 0.0145s/iter; left time: 417.0616s
	iters: 900, epoch: 8 | loss: 0.2368267
	speed: 0.0145s/iter; left time: 414.1610s
	iters: 1000, epoch: 8 | loss: 0.2763156
	speed: 0.0146s/iter; left time: 415.3340s
	iters: 1100, epoch: 8 | loss: 0.5578074
	speed: 0.0147s/iter; left time: 418.0568s
	iters: 1200, epoch: 8 | loss: 0.4124128
	speed: 0.0143s/iter; left time: 404.0515s
	iters: 1300, epoch: 8 | loss: 1.3840263
	speed: 0.0147s/iter; left time: 416.1175s
	iters: 1400, epoch: 8 | loss: 0.4019727
	speed: 0.0145s/iter; left time: 406.6280s
	iters: 1500, epoch: 8 | loss: 0.5654075
	speed: 0.0148s/iter; left time: 413.7994s
	iters: 1600, epoch: 8 | loss: 0.4074640
	speed: 0.0149s/iter; left time: 415.6491s
	iters: 1700, epoch: 8 | loss: 0.3144571
	speed: 0.0141s/iter; left time: 391.9904s
	iters: 1800, epoch: 8 | loss: 0.3498385
	speed: 0.0146s/iter; left time: 406.1407s
	iters: 1900, epoch: 8 | loss: 1.2674900
	speed: 0.0144s/iter; left time: 398.6361s
	iters: 2000, epoch: 8 | loss: 0.3266218
	speed: 0.0146s/iter; left time: 402.5371s
	iters: 2100, epoch: 8 | loss: 0.3725030
	speed: 0.0145s/iter; left time: 398.3846s
	iters: 2200, epoch: 8 | loss: 0.3695899
	speed: 0.0149s/iter; left time: 406.0153s
Epoch: 8 cost time: 32.935994148254395
Epoch: 8, Steps: 2272 | Train Loss: 0.5137950 Vali Loss: 0.4243654 Test Loss: 0.1890116
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.3218118
	speed: 0.0521s/iter; left time: 1415.9471s
	iters: 200, epoch: 9 | loss: 1.3109148
	speed: 0.0149s/iter; left time: 403.1301s
	iters: 300, epoch: 9 | loss: 0.4435801
	speed: 0.0142s/iter; left time: 382.3326s
	iters: 400, epoch: 9 | loss: 0.4457474
	speed: 0.0146s/iter; left time: 391.9767s
	iters: 500, epoch: 9 | loss: 0.2433926
	speed: 0.0149s/iter; left time: 398.0046s
	iters: 600, epoch: 9 | loss: 0.2294817
	speed: 0.0142s/iter; left time: 379.8588s
	iters: 700, epoch: 9 | loss: 0.6289159
	speed: 0.0143s/iter; left time: 380.2051s
	iters: 800, epoch: 9 | loss: 0.3929991
	speed: 0.0144s/iter; left time: 380.0817s
	iters: 900, epoch: 9 | loss: 0.3503293
	speed: 0.0142s/iter; left time: 374.7010s
	iters: 1000, epoch: 9 | loss: 0.3790086
	speed: 0.0143s/iter; left time: 375.1705s
	iters: 1100, epoch: 9 | loss: 0.3607485
	speed: 0.0142s/iter; left time: 371.2093s
	iters: 1200, epoch: 9 | loss: 3.7127736
	speed: 0.0143s/iter; left time: 373.8695s
	iters: 1300, epoch: 9 | loss: 0.4008560
	speed: 0.0147s/iter; left time: 380.9896s
	iters: 1400, epoch: 9 | loss: 0.3970298
	speed: 0.0146s/iter; left time: 376.7840s
	iters: 1500, epoch: 9 | loss: 0.3473542
	speed: 0.0144s/iter; left time: 371.8637s
	iters: 1600, epoch: 9 | loss: 0.3201903
	speed: 0.0147s/iter; left time: 377.6532s
	iters: 1700, epoch: 9 | loss: 0.6779224
	speed: 0.0147s/iter; left time: 376.8825s
	iters: 1800, epoch: 9 | loss: 0.2752899
	speed: 0.0147s/iter; left time: 374.1802s
	iters: 1900, epoch: 9 | loss: 0.5574030
	speed: 0.0147s/iter; left time: 372.3693s
	iters: 2000, epoch: 9 | loss: 0.2650182
	speed: 0.0148s/iter; left time: 374.2813s
	iters: 2100, epoch: 9 | loss: 0.5387509
	speed: 0.0149s/iter; left time: 375.4277s
	iters: 2200, epoch: 9 | loss: 0.4844849
	speed: 0.0143s/iter; left time: 358.8771s
Epoch: 9 cost time: 32.86993050575256
Epoch: 9, Steps: 2272 | Train Loss: 0.5113750 Vali Loss: 0.4242779 Test Loss: 0.1886112
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.4804962
	speed: 0.0517s/iter; left time: 1286.6964s
	iters: 200, epoch: 10 | loss: 0.3588720
	speed: 0.0140s/iter; left time: 346.6197s
	iters: 300, epoch: 10 | loss: 0.3885518
	speed: 0.0145s/iter; left time: 356.8495s
	iters: 400, epoch: 10 | loss: 0.3218611
	speed: 0.0145s/iter; left time: 356.6893s
	iters: 500, epoch: 10 | loss: 1.2328535
	speed: 0.0144s/iter; left time: 352.4758s
	iters: 600, epoch: 10 | loss: 0.4141934
	speed: 0.0147s/iter; left time: 357.4397s
	iters: 700, epoch: 10 | loss: 0.4772304
	speed: 0.0145s/iter; left time: 351.8003s
	iters: 800, epoch: 10 | loss: 0.3872509
	speed: 0.0144s/iter; left time: 349.4755s
	iters: 900, epoch: 10 | loss: 0.3465303
	speed: 0.0143s/iter; left time: 343.5413s
	iters: 1000, epoch: 10 | loss: 0.3531553
	speed: 0.0143s/iter; left time: 343.4525s
	iters: 1100, epoch: 10 | loss: 1.2304704
	speed: 0.0145s/iter; left time: 345.9179s
	iters: 1200, epoch: 10 | loss: 0.3653858
	speed: 0.0148s/iter; left time: 351.9624s
	iters: 1300, epoch: 10 | loss: 0.3670084
	speed: 0.0152s/iter; left time: 359.0038s
	iters: 1400, epoch: 10 | loss: 0.1920873
	speed: 0.0147s/iter; left time: 346.1534s
	iters: 1500, epoch: 10 | loss: 0.3619748
	speed: 0.0143s/iter; left time: 336.5809s
	iters: 1600, epoch: 10 | loss: 0.5978501
	speed: 0.0148s/iter; left time: 346.8648s
	iters: 1700, epoch: 10 | loss: 0.4149216
	speed: 0.0143s/iter; left time: 333.7661s
	iters: 1800, epoch: 10 | loss: 0.4560630
	speed: 0.0146s/iter; left time: 338.2103s
	iters: 1900, epoch: 10 | loss: 0.2547727
	speed: 0.0144s/iter; left time: 332.2159s
	iters: 2000, epoch: 10 | loss: 0.2974423
	speed: 0.0145s/iter; left time: 333.4455s
	iters: 2100, epoch: 10 | loss: 0.3684124
	speed: 0.0147s/iter; left time: 336.1311s
	iters: 2200, epoch: 10 | loss: 0.2661767
	speed: 0.0143s/iter; left time: 325.0692s
Epoch: 10 cost time: 32.78428339958191
Epoch: 10, Steps: 2272 | Train Loss: 0.5102627 Vali Loss: 0.4239194 Test Loss: 0.1891220
EarlyStopping counter: 3 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.2999840
	speed: 0.0515s/iter; left time: 1164.3844s
	iters: 200, epoch: 11 | loss: 0.4652376
	speed: 0.0143s/iter; left time: 321.6376s
	iters: 300, epoch: 11 | loss: 0.3327152
	speed: 0.0145s/iter; left time: 324.9262s
	iters: 400, epoch: 11 | loss: 0.2424218
	speed: 0.0144s/iter; left time: 321.1354s
	iters: 500, epoch: 11 | loss: 0.2842577
	speed: 0.0143s/iter; left time: 317.9173s
	iters: 600, epoch: 11 | loss: 0.4162489
	speed: 0.0141s/iter; left time: 310.8803s
	iters: 700, epoch: 11 | loss: 4.1609235
	speed: 0.0146s/iter; left time: 321.3655s
	iters: 800, epoch: 11 | loss: 0.2648662
	speed: 0.0143s/iter; left time: 314.3250s
	iters: 900, epoch: 11 | loss: 0.3950604
	speed: 0.0144s/iter; left time: 313.4030s
	iters: 1000, epoch: 11 | loss: 0.2753814
	speed: 0.0145s/iter; left time: 315.1087s
	iters: 1100, epoch: 11 | loss: 1.4379857
	speed: 0.0145s/iter; left time: 314.4192s
	iters: 1200, epoch: 11 | loss: 0.2492421
	speed: 0.0148s/iter; left time: 317.6818s
	iters: 1300, epoch: 11 | loss: 0.3982915
	speed: 0.0148s/iter; left time: 318.1008s
	iters: 1400, epoch: 11 | loss: 0.2726960
	speed: 0.0145s/iter; left time: 309.6707s
	iters: 1500, epoch: 11 | loss: 0.4336220
	speed: 0.0148s/iter; left time: 313.0383s
	iters: 1600, epoch: 11 | loss: 0.4101981
	speed: 0.0142s/iter; left time: 300.2245s
	iters: 1700, epoch: 11 | loss: 0.4864202
	speed: 0.0144s/iter; left time: 303.4899s
	iters: 1800, epoch: 11 | loss: 1.3231219
	speed: 0.0144s/iter; left time: 300.7880s
	iters: 1900, epoch: 11 | loss: 0.3902222
	speed: 0.0147s/iter; left time: 305.3809s
	iters: 2000, epoch: 11 | loss: 0.4420839
	speed: 0.0148s/iter; left time: 307.6643s
	iters: 2100, epoch: 11 | loss: 0.2797303
	speed: 0.0141s/iter; left time: 290.6534s
	iters: 2200, epoch: 11 | loss: 0.1528062
	speed: 0.0150s/iter; left time: 308.2288s
Epoch: 11 cost time: 32.739622592926025
Epoch: 11, Steps: 2272 | Train Loss: 0.5095803 Vali Loss: 0.4230489 Test Loss: 0.1883390
Validation loss decreased (0.423134 --> 0.423049).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.3713757
	speed: 0.0510s/iter; left time: 1038.5205s
	iters: 200, epoch: 12 | loss: 0.3430775
	speed: 0.0146s/iter; left time: 295.3121s
	iters: 300, epoch: 12 | loss: 0.5596823
	speed: 0.0147s/iter; left time: 295.8865s
	iters: 400, epoch: 12 | loss: 1.2708668
	speed: 0.0151s/iter; left time: 303.0757s
	iters: 500, epoch: 12 | loss: 0.2826139
	speed: 0.0142s/iter; left time: 282.7240s
	iters: 600, epoch: 12 | loss: 0.3948981
	speed: 0.0142s/iter; left time: 282.3757s
	iters: 700, epoch: 12 | loss: 0.3359598
	speed: 0.0147s/iter; left time: 290.8798s
	iters: 800, epoch: 12 | loss: 0.5072255
	speed: 0.0144s/iter; left time: 283.8633s
	iters: 900, epoch: 12 | loss: 0.4644983
	speed: 0.0147s/iter; left time: 288.2924s
	iters: 1000, epoch: 12 | loss: 0.3828661
	speed: 0.0146s/iter; left time: 284.6081s
	iters: 1100, epoch: 12 | loss: 0.3425036
	speed: 0.0143s/iter; left time: 277.2394s
	iters: 1200, epoch: 12 | loss: 0.3521523
	speed: 0.0141s/iter; left time: 272.2535s
	iters: 1300, epoch: 12 | loss: 1.3979979
	speed: 0.0149s/iter; left time: 284.7107s
	iters: 1400, epoch: 12 | loss: 0.2459053
	speed: 0.0149s/iter; left time: 284.4434s
	iters: 1500, epoch: 12 | loss: 0.3212721
	speed: 0.0138s/iter; left time: 260.9581s
	iters: 1600, epoch: 12 | loss: 0.3215381
	speed: 0.0149s/iter; left time: 280.8015s
	iters: 1700, epoch: 12 | loss: 0.3226043
	speed: 0.0143s/iter; left time: 267.8875s
	iters: 1800, epoch: 12 | loss: 0.3474402
	speed: 0.0148s/iter; left time: 276.3506s
	iters: 1900, epoch: 12 | loss: 0.4528635
	speed: 0.0145s/iter; left time: 268.8703s
	iters: 2000, epoch: 12 | loss: 0.3744889
	speed: 0.0148s/iter; left time: 273.0861s
	iters: 2100, epoch: 12 | loss: 0.4592567
	speed: 0.0147s/iter; left time: 270.1134s
	iters: 2200, epoch: 12 | loss: 0.2467665
	speed: 0.0140s/iter; left time: 255.7134s
Epoch: 12 cost time: 32.841413497924805
Epoch: 12, Steps: 2272 | Train Loss: 0.5093064 Vali Loss: 0.4238312 Test Loss: 0.1881158
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.3467965
	speed: 0.0521s/iter; left time: 942.5667s
	iters: 200, epoch: 13 | loss: 0.5002436
	speed: 0.0148s/iter; left time: 265.4459s
	iters: 300, epoch: 13 | loss: 1.3302749
	speed: 0.0146s/iter; left time: 261.2926s
	iters: 400, epoch: 13 | loss: 0.3055949
	speed: 0.0141s/iter; left time: 249.7961s
	iters: 500, epoch: 13 | loss: 0.4568069
	speed: 0.0145s/iter; left time: 256.7276s
	iters: 600, epoch: 13 | loss: 0.3429810
	speed: 0.0143s/iter; left time: 251.5205s
	iters: 700, epoch: 13 | loss: 0.2575367
	speed: 0.0142s/iter; left time: 248.6907s
	iters: 800, epoch: 13 | loss: 0.3368414
	speed: 0.0144s/iter; left time: 250.4759s
	iters: 900, epoch: 13 | loss: 0.3801207
	speed: 0.0142s/iter; left time: 245.1436s
	iters: 1000, epoch: 13 | loss: 0.2348079
	speed: 0.0147s/iter; left time: 252.8006s
	iters: 1100, epoch: 13 | loss: 0.2183138
	speed: 0.0143s/iter; left time: 244.9583s
	iters: 1200, epoch: 13 | loss: 0.2286343
	speed: 0.0147s/iter; left time: 249.8235s
	iters: 1300, epoch: 13 | loss: 0.5716169
	speed: 0.0146s/iter; left time: 246.9367s
	iters: 1400, epoch: 13 | loss: 0.2620440
	speed: 0.0143s/iter; left time: 239.0930s
	iters: 1500, epoch: 13 | loss: 0.3451816
	speed: 0.0143s/iter; left time: 237.6612s
	iters: 1600, epoch: 13 | loss: 0.3208618
	speed: 0.0146s/iter; left time: 242.1500s
	iters: 1700, epoch: 13 | loss: 0.3227972
	speed: 0.0147s/iter; left time: 241.7900s
	iters: 1800, epoch: 13 | loss: 0.3230214
	speed: 0.0139s/iter; left time: 228.3263s
	iters: 1900, epoch: 13 | loss: 0.5357569
	speed: 0.0144s/iter; left time: 234.7560s
	iters: 2000, epoch: 13 | loss: 0.3419379
	speed: 0.0145s/iter; left time: 233.9427s
	iters: 2100, epoch: 13 | loss: 1.1120286
	speed: 0.0148s/iter; left time: 237.2981s
	iters: 2200, epoch: 13 | loss: 0.3040861
	speed: 0.0146s/iter; left time: 233.6075s
Epoch: 13 cost time: 32.741000175476074
Epoch: 13, Steps: 2272 | Train Loss: 0.5091604 Vali Loss: 0.4237414 Test Loss: 0.1882831
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.4344392
	speed: 0.0514s/iter; left time: 812.5224s
	iters: 200, epoch: 14 | loss: 0.3070745
	speed: 0.0125s/iter; left time: 196.9918s
	iters: 300, epoch: 14 | loss: 0.3376578
	speed: 0.0129s/iter; left time: 200.8276s
	iters: 400, epoch: 14 | loss: 0.5279862
	speed: 0.0130s/iter; left time: 200.8528s
	iters: 500, epoch: 14 | loss: 0.7856100
	speed: 0.0143s/iter; left time: 219.7287s
	iters: 600, epoch: 14 | loss: 1.2509456
	speed: 0.0149s/iter; left time: 227.8893s
	iters: 700, epoch: 14 | loss: 0.4323583
	speed: 0.0137s/iter; left time: 208.8615s
	iters: 800, epoch: 14 | loss: 0.6810942
	speed: 0.0124s/iter; left time: 187.8679s
	iters: 900, epoch: 14 | loss: 0.2843006
	speed: 0.0123s/iter; left time: 184.7140s
	iters: 1000, epoch: 14 | loss: 0.4558406
	speed: 0.0114s/iter; left time: 170.0729s
	iters: 1100, epoch: 14 | loss: 0.3205559
	speed: 0.0121s/iter; left time: 178.4401s
	iters: 1200, epoch: 14 | loss: 0.3053053
	speed: 0.0114s/iter; left time: 167.4187s
	iters: 1300, epoch: 14 | loss: 0.3247458
	speed: 0.0123s/iter; left time: 179.8183s
	iters: 1400, epoch: 14 | loss: 0.2976175
	speed: 0.0126s/iter; left time: 182.8769s
	iters: 1500, epoch: 14 | loss: 0.3416248
	speed: 0.0128s/iter; left time: 184.3223s
	iters: 1600, epoch: 14 | loss: 0.3141418
	speed: 0.0126s/iter; left time: 179.6980s
	iters: 1700, epoch: 14 | loss: 0.5111092
	speed: 0.0121s/iter; left time: 172.3997s
	iters: 1800, epoch: 14 | loss: 0.3892668
	speed: 0.0127s/iter; left time: 179.7765s
	iters: 1900, epoch: 14 | loss: 0.3339762
	speed: 0.0108s/iter; left time: 151.6049s
	iters: 2000, epoch: 14 | loss: 0.2847083
	speed: 0.0123s/iter; left time: 171.0023s
	iters: 2100, epoch: 14 | loss: 0.3626397
	speed: 0.0134s/iter; left time: 184.7176s
	iters: 2200, epoch: 14 | loss: 0.3054785
	speed: 0.0125s/iter; left time: 170.9878s
Epoch: 14 cost time: 28.625030517578125
Epoch: 14, Steps: 2272 | Train Loss: 0.5090505 Vali Loss: 0.4236350 Test Loss: 0.1881580
EarlyStopping counter: 3 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.3192510
	speed: 0.0490s/iter; left time: 663.3168s
	iters: 200, epoch: 15 | loss: 0.3378369
	speed: 0.0120s/iter; left time: 160.8295s
	iters: 300, epoch: 15 | loss: 0.6347892
	speed: 0.0123s/iter; left time: 163.3345s
	iters: 400, epoch: 15 | loss: 0.4722384
	speed: 0.0120s/iter; left time: 159.4012s
	iters: 500, epoch: 15 | loss: 0.2776425
	speed: 0.0122s/iter; left time: 159.9277s
	iters: 600, epoch: 15 | loss: 0.5977365
	speed: 0.0122s/iter; left time: 158.7499s
	iters: 700, epoch: 15 | loss: 0.2429765
	speed: 0.0125s/iter; left time: 161.8213s
	iters: 800, epoch: 15 | loss: 0.3232364
	speed: 0.0114s/iter; left time: 146.5852s
	iters: 900, epoch: 15 | loss: 0.3855949
	speed: 0.0122s/iter; left time: 155.7759s
	iters: 1000, epoch: 15 | loss: 0.3930072
	speed: 0.0129s/iter; left time: 162.9357s
	iters: 1100, epoch: 15 | loss: 0.4685861
	speed: 0.0128s/iter; left time: 160.7610s
	iters: 1200, epoch: 15 | loss: 0.2751909
	speed: 0.0135s/iter; left time: 167.5449s
	iters: 1300, epoch: 15 | loss: 0.3602462
	speed: 0.0110s/iter; left time: 136.2447s
	iters: 1400, epoch: 15 | loss: 0.3925394
	speed: 0.0115s/iter; left time: 141.1741s
	iters: 1500, epoch: 15 | loss: 0.3519035
	speed: 0.0119s/iter; left time: 144.6253s
	iters: 1600, epoch: 15 | loss: 0.3835287
	speed: 0.0124s/iter; left time: 149.7754s
	iters: 1700, epoch: 15 | loss: 0.2349897
	speed: 0.0117s/iter; left time: 139.7514s
	iters: 1800, epoch: 15 | loss: 0.3067985
	speed: 0.0130s/iter; left time: 154.0447s
	iters: 1900, epoch: 15 | loss: 0.3589596
	speed: 0.0133s/iter; left time: 155.6704s
	iters: 2000, epoch: 15 | loss: 0.2954234
	speed: 0.0132s/iter; left time: 153.6477s
	iters: 2100, epoch: 15 | loss: 0.3224885
	speed: 0.0129s/iter; left time: 148.6350s
	iters: 2200, epoch: 15 | loss: 1.3956443
	speed: 0.0129s/iter; left time: 147.5736s
Epoch: 15 cost time: 27.98951268196106
Epoch: 15, Steps: 2272 | Train Loss: 0.5090496 Vali Loss: 0.4237742 Test Loss: 0.1883275
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.2973791
	speed: 0.0445s/iter; left time: 500.5870s
	iters: 200, epoch: 16 | loss: 0.3212803
	speed: 0.0111s/iter; left time: 123.7481s
	iters: 300, epoch: 16 | loss: 0.3536833
	speed: 0.0107s/iter; left time: 118.3747s
	iters: 400, epoch: 16 | loss: 0.5448321
	speed: 0.0124s/iter; left time: 135.8782s
	iters: 500, epoch: 16 | loss: 0.4441167
	speed: 0.0119s/iter; left time: 129.2724s
	iters: 600, epoch: 16 | loss: 0.3529689
	speed: 0.0133s/iter; left time: 142.9946s
	iters: 700, epoch: 16 | loss: 0.3490818
	speed: 0.0111s/iter; left time: 118.7162s
	iters: 800, epoch: 16 | loss: 0.4039005
	speed: 0.0115s/iter; left time: 120.9779s
	iters: 900, epoch: 16 | loss: 0.7751729
	speed: 0.0108s/iter; left time: 113.1080s
	iters: 1000, epoch: 16 | loss: 0.3388913
	speed: 0.0112s/iter; left time: 115.8058s
	iters: 1100, epoch: 16 | loss: 0.3493402
	speed: 0.0113s/iter; left time: 115.9503s
	iters: 1200, epoch: 16 | loss: 0.3751619
	speed: 0.0120s/iter; left time: 122.1595s
	iters: 1300, epoch: 16 | loss: 1.2322521
	speed: 0.0117s/iter; left time: 117.2604s
	iters: 1400, epoch: 16 | loss: 0.4054810
	speed: 0.0117s/iter; left time: 116.2468s
	iters: 1500, epoch: 16 | loss: 0.4160925
	speed: 0.0122s/iter; left time: 120.0366s
	iters: 1600, epoch: 16 | loss: 0.3762619
	speed: 0.0118s/iter; left time: 115.5944s
	iters: 1700, epoch: 16 | loss: 0.2890469
	speed: 0.0102s/iter; left time: 98.8560s
	iters: 1800, epoch: 16 | loss: 0.5401471
	speed: 0.0106s/iter; left time: 101.7986s
	iters: 1900, epoch: 16 | loss: 0.4485280
	speed: 0.0108s/iter; left time: 101.7284s
	iters: 2000, epoch: 16 | loss: 0.2493566
	speed: 0.0119s/iter; left time: 111.2358s
	iters: 2100, epoch: 16 | loss: 0.3722536
	speed: 0.0112s/iter; left time: 103.5123s
	iters: 2200, epoch: 16 | loss: 0.2677408
	speed: 0.0122s/iter; left time: 111.5723s
Epoch: 16 cost time: 25.986021995544434
Epoch: 16, Steps: 2272 | Train Loss: 0.5089545 Vali Loss: 0.4236502 Test Loss: 0.1883600
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : weather_336_192_Linear_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3293<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10348
mse:0.18838776648044586, mae:0.25700172781944275
