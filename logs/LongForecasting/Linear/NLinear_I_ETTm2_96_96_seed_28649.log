Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='NLinear', model_id='ETTm2_96_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=28649, seq_len=96, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTm2_96_96_NLinear_ETTm2_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed28649>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34369
data_set:  <data_provider.data_loader.Dataset_ETT_minute object at 0x00000224C54B0D68>
val 11425
data_set:  <data_provider.data_loader.Dataset_ETT_minute object at 0x0000022492AB6DD8>
test 11425
data_set:  <data_provider.data_loader.Dataset_ETT_minute object at 0x00000224C54B0128>
Total number of trainable parameters: 65184
Total number of parameters: 65184
	iters: 100, epoch: 1 | loss: 0.1255353
	speed: 0.0041s/iter; left time: 86.8890s
	iters: 200, epoch: 1 | loss: 0.2463703
	speed: 0.0039s/iter; left time: 83.1657s
	iters: 300, epoch: 1 | loss: 0.1690779
	speed: 0.0036s/iter; left time: 76.0846s
	iters: 400, epoch: 1 | loss: 0.2193368
	speed: 0.0043s/iter; left time: 90.1015s
	iters: 500, epoch: 1 | loss: 0.1312191
	speed: 0.0033s/iter; left time: 69.8632s
	iters: 600, epoch: 1 | loss: 0.1440214
	speed: 0.0033s/iter; left time: 69.4404s
	iters: 700, epoch: 1 | loss: 0.1380747
	speed: 0.0038s/iter; left time: 78.5174s
	iters: 800, epoch: 1 | loss: 0.6917180
	speed: 0.0033s/iter; left time: 68.8335s
	iters: 900, epoch: 1 | loss: 0.1746454
	speed: 0.0043s/iter; left time: 87.9325s
	iters: 1000, epoch: 1 | loss: 0.1800317
	speed: 0.0032s/iter; left time: 64.7437s
Epoch: 1 cost time: 4.000320911407471
Epoch: 1, Steps: 1074 | Train Loss: 0.2700935 Vali Loss: 0.1548555 Test Loss: 0.2262355
Validation loss decreased (inf --> 0.154855).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.3049065
	speed: 0.0183s/iter; left time: 371.4429s
	iters: 200, epoch: 2 | loss: 0.1447882
	speed: 0.0036s/iter; left time: 73.5700s
	iters: 300, epoch: 2 | loss: 0.2834994
	speed: 0.0027s/iter; left time: 54.0623s
	iters: 400, epoch: 2 | loss: 0.1958307
	speed: 0.0033s/iter; left time: 66.5357s
	iters: 500, epoch: 2 | loss: 0.3325251
	speed: 0.0033s/iter; left time: 66.1767s
	iters: 600, epoch: 2 | loss: 0.2364684
	speed: 0.0040s/iter; left time: 78.2800s
	iters: 700, epoch: 2 | loss: 0.4351155
	speed: 0.0035s/iter; left time: 68.6169s
	iters: 800, epoch: 2 | loss: 0.1275231
	speed: 0.0033s/iter; left time: 65.1701s
	iters: 900, epoch: 2 | loss: 0.1452112
	speed: 0.0033s/iter; left time: 63.9775s
	iters: 1000, epoch: 2 | loss: 0.1957790
	speed: 0.0052s/iter; left time: 101.0224s
Epoch: 2 cost time: 3.9149537086486816
Epoch: 2, Steps: 1074 | Train Loss: 0.2786304 Vali Loss: 0.1425990 Test Loss: 0.1984655
Validation loss decreased (0.154855 --> 0.142599).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.1564587
	speed: 0.0187s/iter; left time: 359.7573s
	iters: 200, epoch: 3 | loss: 0.1953949
	speed: 0.0036s/iter; left time: 69.5942s
	iters: 300, epoch: 3 | loss: 0.1496252
	speed: 0.0031s/iter; left time: 58.6336s
	iters: 400, epoch: 3 | loss: 0.3643892
	speed: 0.0031s/iter; left time: 59.1658s
	iters: 500, epoch: 3 | loss: 0.1730989
	speed: 0.0044s/iter; left time: 82.3955s
	iters: 600, epoch: 3 | loss: 0.2295910
	speed: 0.0033s/iter; left time: 61.4603s
	iters: 700, epoch: 3 | loss: 0.1391611
	speed: 0.0030s/iter; left time: 55.2859s
	iters: 800, epoch: 3 | loss: 0.1647036
	speed: 0.0037s/iter; left time: 68.5056s
	iters: 900, epoch: 3 | loss: 0.2698785
	speed: 0.0030s/iter; left time: 55.6904s
	iters: 1000, epoch: 3 | loss: 0.3074153
	speed: 0.0033s/iter; left time: 60.2161s
Epoch: 3 cost time: 3.782625198364258
Epoch: 3, Steps: 1074 | Train Loss: 0.2448522 Vali Loss: 0.1451688 Test Loss: 0.1993242
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.3232812
	speed: 0.0178s/iter; left time: 323.4664s
	iters: 200, epoch: 4 | loss: 0.5524163
	speed: 0.0037s/iter; left time: 67.6444s
	iters: 300, epoch: 4 | loss: 0.2357205
	speed: 0.0032s/iter; left time: 57.6383s
	iters: 400, epoch: 4 | loss: 0.1500636
	speed: 0.0042s/iter; left time: 74.9192s
	iters: 500, epoch: 4 | loss: 0.2844851
	speed: 0.0038s/iter; left time: 68.3400s
	iters: 600, epoch: 4 | loss: 0.2219122
	speed: 0.0041s/iter; left time: 71.7021s
	iters: 700, epoch: 4 | loss: 0.6350951
	speed: 0.0039s/iter; left time: 68.7013s
	iters: 800, epoch: 4 | loss: 0.2986084
	speed: 0.0046s/iter; left time: 80.2556s
	iters: 900, epoch: 4 | loss: 0.1790766
	speed: 0.0038s/iter; left time: 65.9422s
	iters: 1000, epoch: 4 | loss: 0.2888169
	speed: 0.0047s/iter; left time: 81.5869s
Epoch: 4 cost time: 4.203012466430664
Epoch: 4, Steps: 1074 | Train Loss: 0.2373941 Vali Loss: 0.1275807 Test Loss: 0.1807171
Validation loss decreased (0.142599 --> 0.127581).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.2502356
	speed: 0.0146s/iter; left time: 248.7733s
	iters: 200, epoch: 5 | loss: 0.3318819
	speed: 0.0041s/iter; left time: 69.9371s
	iters: 300, epoch: 5 | loss: 0.2096853
	speed: 0.0033s/iter; left time: 56.1084s
	iters: 400, epoch: 5 | loss: 0.3600692
	speed: 0.0035s/iter; left time: 58.1688s
	iters: 500, epoch: 5 | loss: 0.3381695
	speed: 0.0036s/iter; left time: 59.9835s
	iters: 600, epoch: 5 | loss: 0.5350257
	speed: 0.0030s/iter; left time: 49.1887s
	iters: 700, epoch: 5 | loss: 0.1179072
	speed: 0.0038s/iter; left time: 61.8547s
	iters: 800, epoch: 5 | loss: 0.1853659
	speed: 0.0044s/iter; left time: 71.6895s
	iters: 900, epoch: 5 | loss: 0.6333767
	speed: 0.0036s/iter; left time: 58.7449s
	iters: 1000, epoch: 5 | loss: 0.3739280
	speed: 0.0030s/iter; left time: 48.6077s
Epoch: 5 cost time: 3.7742702960968018
Epoch: 5, Steps: 1074 | Train Loss: 0.2340504 Vali Loss: 0.1267590 Test Loss: 0.1780473
Validation loss decreased (0.127581 --> 0.126759).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.5205755
	speed: 0.0179s/iter; left time: 286.2337s
	iters: 200, epoch: 6 | loss: 0.7098480
	speed: 0.0030s/iter; left time: 47.8669s
	iters: 300, epoch: 6 | loss: 0.5701810
	speed: 0.0039s/iter; left time: 61.7568s
	iters: 400, epoch: 6 | loss: 0.2247460
	speed: 0.0030s/iter; left time: 46.7120s
	iters: 500, epoch: 6 | loss: 0.1318378
	speed: 0.0030s/iter; left time: 46.2858s
	iters: 600, epoch: 6 | loss: 0.1177636
	speed: 0.0036s/iter; left time: 56.5228s
	iters: 700, epoch: 6 | loss: 0.3072750
	speed: 0.0035s/iter; left time: 53.6628s
	iters: 800, epoch: 6 | loss: 0.6607855
	speed: 0.0040s/iter; left time: 60.7534s
	iters: 900, epoch: 6 | loss: 0.2206521
	speed: 0.0036s/iter; left time: 54.6749s
	iters: 1000, epoch: 6 | loss: 0.1778566
	speed: 0.0030s/iter; left time: 44.8624s
Epoch: 6 cost time: 3.7192788124084473
Epoch: 6, Steps: 1074 | Train Loss: 0.2318101 Vali Loss: 0.1264617 Test Loss: 0.1786147
Validation loss decreased (0.126759 --> 0.126462).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.1955264
	speed: 0.0181s/iter; left time: 270.7479s
	iters: 200, epoch: 7 | loss: 0.2390811
	speed: 0.0031s/iter; left time: 46.3578s
	iters: 300, epoch: 7 | loss: 0.1090433
	speed: 0.0034s/iter; left time: 50.6831s
	iters: 400, epoch: 7 | loss: 0.2440794
	speed: 0.0023s/iter; left time: 34.2712s
	iters: 500, epoch: 7 | loss: 0.1799534
	speed: 0.0034s/iter; left time: 50.0202s
	iters: 600, epoch: 7 | loss: 0.1767955
	speed: 0.0036s/iter; left time: 51.8260s
	iters: 700, epoch: 7 | loss: 0.3719709
	speed: 0.0028s/iter; left time: 40.7300s
	iters: 800, epoch: 7 | loss: 0.2524280
	speed: 0.0038s/iter; left time: 54.0824s
	iters: 900, epoch: 7 | loss: 0.2519813
	speed: 0.0041s/iter; left time: 58.2122s
	iters: 1000, epoch: 7 | loss: 0.3307967
	speed: 0.0044s/iter; left time: 61.7824s
Epoch: 7 cost time: 3.6725146770477295
Epoch: 7, Steps: 1074 | Train Loss: 0.2304969 Vali Loss: 0.1239521 Test Loss: 0.1764036
Validation loss decreased (0.126462 --> 0.123952).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.2661204
	speed: 0.0170s/iter; left time: 236.0652s
	iters: 200, epoch: 8 | loss: 0.1592169
	speed: 0.0033s/iter; left time: 45.1555s
	iters: 300, epoch: 8 | loss: 0.1898088
	speed: 0.0038s/iter; left time: 51.2729s
	iters: 400, epoch: 8 | loss: 0.2893462
	speed: 0.0034s/iter; left time: 46.6158s
	iters: 500, epoch: 8 | loss: 0.1684268
	speed: 0.0039s/iter; left time: 52.5985s
	iters: 600, epoch: 8 | loss: 0.1715507
	speed: 0.0032s/iter; left time: 43.0289s
	iters: 700, epoch: 8 | loss: 0.3229229
	speed: 0.0035s/iter; left time: 46.1619s
	iters: 800, epoch: 8 | loss: 0.2080486
	speed: 0.0035s/iter; left time: 45.7582s
	iters: 900, epoch: 8 | loss: 0.1220754
	speed: 0.0041s/iter; left time: 53.7208s
	iters: 1000, epoch: 8 | loss: 0.2796934
	speed: 0.0038s/iter; left time: 49.6905s
Epoch: 8 cost time: 3.8594810962677
Epoch: 8, Steps: 1074 | Train Loss: 0.2300003 Vali Loss: 0.1239810 Test Loss: 0.1768441
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.2496510
	speed: 0.0194s/iter; left time: 248.1711s
	iters: 200, epoch: 9 | loss: 0.2912196
	speed: 0.0036s/iter; left time: 46.3035s
	iters: 300, epoch: 9 | loss: 0.1522848
	speed: 0.0030s/iter; left time: 37.8827s
	iters: 400, epoch: 9 | loss: 0.4434454
	speed: 0.0025s/iter; left time: 31.6105s
	iters: 500, epoch: 9 | loss: 0.2158618
	speed: 0.0034s/iter; left time: 42.5987s
	iters: 600, epoch: 9 | loss: 0.2013853
	speed: 0.0027s/iter; left time: 32.6348s
	iters: 700, epoch: 9 | loss: 0.1469606
	speed: 0.0031s/iter; left time: 38.0772s
	iters: 800, epoch: 9 | loss: 0.1767993
	speed: 0.0033s/iter; left time: 39.6884s
	iters: 900, epoch: 9 | loss: 0.1694670
	speed: 0.0039s/iter; left time: 46.8202s
	iters: 1000, epoch: 9 | loss: 0.2954032
	speed: 0.0035s/iter; left time: 41.1544s
Epoch: 9 cost time: 3.5627694129943848
Epoch: 9, Steps: 1074 | Train Loss: 0.2297387 Vali Loss: 0.1238051 Test Loss: 0.1764088
Validation loss decreased (0.123952 --> 0.123805).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.1451593
	speed: 0.0179s/iter; left time: 210.1025s
	iters: 200, epoch: 10 | loss: 0.4109554
	speed: 0.0036s/iter; left time: 41.8707s
	iters: 300, epoch: 10 | loss: 0.1481443
	speed: 0.0042s/iter; left time: 48.5899s
	iters: 400, epoch: 10 | loss: 0.2171458
	speed: 0.0031s/iter; left time: 35.6647s
	iters: 500, epoch: 10 | loss: 0.2245382
	speed: 0.0034s/iter; left time: 38.8910s
	iters: 600, epoch: 10 | loss: 0.1424555
	speed: 0.0044s/iter; left time: 49.0722s
	iters: 700, epoch: 10 | loss: 0.2419460
	speed: 0.0035s/iter; left time: 38.3858s
	iters: 800, epoch: 10 | loss: 0.1562125
	speed: 0.0034s/iter; left time: 37.1804s
	iters: 900, epoch: 10 | loss: 0.4331391
	speed: 0.0039s/iter; left time: 42.6267s
	iters: 1000, epoch: 10 | loss: 0.1944124
	speed: 0.0032s/iter; left time: 34.2886s
Epoch: 10 cost time: 3.849874258041382
Epoch: 10, Steps: 1074 | Train Loss: 0.2295130 Vali Loss: 0.1246955 Test Loss: 0.1766612
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.2030818
	speed: 0.0161s/iter; left time: 171.2115s
	iters: 200, epoch: 11 | loss: 0.2462329
	speed: 0.0034s/iter; left time: 36.3051s
	iters: 300, epoch: 11 | loss: 0.1187603
	speed: 0.0033s/iter; left time: 34.2582s
	iters: 400, epoch: 11 | loss: 0.1564489
	speed: 0.0041s/iter; left time: 41.9880s
	iters: 500, epoch: 11 | loss: 0.1408904
	speed: 0.0028s/iter; left time: 28.7915s
	iters: 600, epoch: 11 | loss: 0.2685826
	speed: 0.0030s/iter; left time: 30.1287s
	iters: 700, epoch: 11 | loss: 0.6430293
	speed: 0.0039s/iter; left time: 39.5913s
	iters: 800, epoch: 11 | loss: 0.1209575
	speed: 0.0025s/iter; left time: 25.1731s
	iters: 900, epoch: 11 | loss: 0.1314323
	speed: 0.0028s/iter; left time: 28.0348s
	iters: 1000, epoch: 11 | loss: 0.2274904
	speed: 0.0033s/iter; left time: 32.4748s
Epoch: 11 cost time: 3.5311408042907715
Epoch: 11, Steps: 1074 | Train Loss: 0.2294092 Vali Loss: 0.1247498 Test Loss: 0.1769050
EarlyStopping counter: 2 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.2517022
	speed: 0.0167s/iter; left time: 159.6880s
	iters: 200, epoch: 12 | loss: 0.2406013
	speed: 0.0030s/iter; left time: 28.3399s
	iters: 300, epoch: 12 | loss: 0.1584626
	speed: 0.0023s/iter; left time: 21.9768s
	iters: 400, epoch: 12 | loss: 0.2080442
	speed: 0.0030s/iter; left time: 27.4831s
	iters: 500, epoch: 12 | loss: 0.4007292
	speed: 0.0033s/iter; left time: 30.0784s
	iters: 600, epoch: 12 | loss: 0.2337538
	speed: 0.0027s/iter; left time: 24.2142s
	iters: 700, epoch: 12 | loss: 0.5597154
	speed: 0.0028s/iter; left time: 25.5431s
	iters: 800, epoch: 12 | loss: 0.1344487
	speed: 0.0028s/iter; left time: 25.2407s
	iters: 900, epoch: 12 | loss: 0.2807773
	speed: 0.0028s/iter; left time: 24.9762s
	iters: 1000, epoch: 12 | loss: 0.1733096
	speed: 0.0039s/iter; left time: 34.1746s
Epoch: 12 cost time: 3.288900375366211
Epoch: 12, Steps: 1074 | Train Loss: 0.2293913 Vali Loss: 0.1246938 Test Loss: 0.1767414
EarlyStopping counter: 3 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.0925415
	speed: 0.0147s/iter; left time: 124.7343s
	iters: 200, epoch: 13 | loss: 0.2258755
	speed: 0.0031s/iter; left time: 26.2393s
	iters: 300, epoch: 13 | loss: 0.2694162
	speed: 0.0019s/iter; left time: 15.5372s
	iters: 400, epoch: 13 | loss: 0.2453980
	speed: 0.0022s/iter; left time: 18.1535s
	iters: 500, epoch: 13 | loss: 0.1882062
	speed: 0.0019s/iter; left time: 15.3283s
	iters: 600, epoch: 13 | loss: 0.3586723
	speed: 0.0025s/iter; left time: 19.6095s
	iters: 700, epoch: 13 | loss: 0.3402580
	speed: 0.0020s/iter; left time: 15.6545s
	iters: 800, epoch: 13 | loss: 0.1866689
	speed: 0.0024s/iter; left time: 18.6531s
	iters: 900, epoch: 13 | loss: 0.1554710
	speed: 0.0017s/iter; left time: 13.1724s
	iters: 1000, epoch: 13 | loss: 0.1376842
	speed: 0.0025s/iter; left time: 19.0152s
Epoch: 13 cost time: 2.4802863597869873
Epoch: 13, Steps: 1074 | Train Loss: 0.2293526 Vali Loss: 0.1247630 Test Loss: 0.1767046
EarlyStopping counter: 4 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 14 | loss: 0.2275769
	speed: 0.0115s/iter; left time: 85.2293s
	iters: 200, epoch: 14 | loss: 0.1257360
	speed: 0.0021s/iter; left time: 15.4113s
	iters: 300, epoch: 14 | loss: 0.1746905
	speed: 0.0027s/iter; left time: 19.6766s
	iters: 400, epoch: 14 | loss: 0.1052846
	speed: 0.0022s/iter; left time: 15.7702s
	iters: 500, epoch: 14 | loss: 0.2974960
	speed: 0.0024s/iter; left time: 16.6925s
	iters: 600, epoch: 14 | loss: 0.1681699
	speed: 0.0021s/iter; left time: 14.2197s
	iters: 700, epoch: 14 | loss: 0.2172560
	speed: 0.0022s/iter; left time: 14.9256s
	iters: 800, epoch: 14 | loss: 0.2023673
	speed: 0.0025s/iter; left time: 16.8057s
	iters: 900, epoch: 14 | loss: 0.1736481
	speed: 0.0027s/iter; left time: 17.6508s
	iters: 1000, epoch: 14 | loss: 0.2583415
	speed: 0.0022s/iter; left time: 14.4559s
Epoch: 14 cost time: 2.506727933883667
Epoch: 14, Steps: 1074 | Train Loss: 0.2293389 Vali Loss: 0.1247900 Test Loss: 0.1767323
EarlyStopping counter: 5 out of 5
Early stopping
Total training time: 64.8761 seconds
>>>>>>>testing : ETTm2_96_96_NLinear_ETTm2_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed28649<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
data_set:  <data_provider.data_loader.Dataset_ETT_minute object at 0x0000022487F01080>
mse:0.1766602247953415, mae:0.2566409111022949
