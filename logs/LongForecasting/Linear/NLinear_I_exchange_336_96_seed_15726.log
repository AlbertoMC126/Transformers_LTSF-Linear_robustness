Args in experiment:
Namespace(activation='gelu', batch_size=8, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='exchange_rate.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=8, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='mse', lradj='type1', model='NLinear', model_id='Exchange_336_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=15726, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : Exchange_336_96_NLinear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15726>>>>>>>>>>>>>>>>>>>>>>>>>>
train 4880
val 665
test 1422
	iters: 100, epoch: 1 | loss: 0.0708466
	speed: 0.0037s/iter; left time: 44.6750s
	iters: 200, epoch: 1 | loss: 0.0946353
	speed: 0.0028s/iter; left time: 33.4831s
	iters: 300, epoch: 1 | loss: 0.1107302
	speed: 0.0030s/iter; left time: 35.2266s
	iters: 400, epoch: 1 | loss: 0.0987644
	speed: 0.0030s/iter; left time: 35.4323s
	iters: 500, epoch: 1 | loss: 0.1535715
	speed: 0.0032s/iter; left time: 37.4308s
	iters: 600, epoch: 1 | loss: 0.1191122
	speed: 0.0027s/iter; left time: 31.3227s
Epoch: 1 cost time: 1.863325834274292
Epoch: 1, Steps: 610 | Train Loss: 0.1247796 Vali Loss: 0.1418891 Test Loss: 0.0952863
Validation loss decreased (inf --> 0.141889).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.0661309
	speed: 0.0047s/iter; left time: 54.1410s
	iters: 200, epoch: 2 | loss: 0.0867800
	speed: 0.0032s/iter; left time: 36.2297s
	iters: 300, epoch: 2 | loss: 0.1005362
	speed: 0.0029s/iter; left time: 33.1956s
	iters: 400, epoch: 2 | loss: 0.1215018
	speed: 0.0033s/iter; left time: 36.9509s
	iters: 500, epoch: 2 | loss: 0.0553635
	speed: 0.0031s/iter; left time: 34.2712s
	iters: 600, epoch: 2 | loss: 0.0973742
	speed: 0.0029s/iter; left time: 31.4397s
Epoch: 2 cost time: 1.8604466915130615
Epoch: 2, Steps: 610 | Train Loss: 0.1200473 Vali Loss: 0.1474963 Test Loss: 0.0954984
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.0481728
	speed: 0.0060s/iter; left time: 65.2048s
	iters: 200, epoch: 3 | loss: 0.1115903
	speed: 0.0023s/iter; left time: 25.0121s
	iters: 300, epoch: 3 | loss: 0.1269166
	speed: 0.0024s/iter; left time: 25.6343s
	iters: 400, epoch: 3 | loss: 0.0831297
	speed: 0.0027s/iter; left time: 28.2564s
	iters: 500, epoch: 3 | loss: 0.1243015
	speed: 0.0027s/iter; left time: 28.1113s
	iters: 600, epoch: 3 | loss: 0.0894814
	speed: 0.0028s/iter; left time: 29.1708s
Epoch: 3 cost time: 1.675518274307251
Epoch: 3, Steps: 610 | Train Loss: 0.1160109 Vali Loss: 0.1407303 Test Loss: 0.1031015
Validation loss decreased (0.141889 --> 0.140730).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.0893382
	speed: 0.0049s/iter; left time: 50.4307s
	iters: 200, epoch: 4 | loss: 0.1034283
	speed: 0.0030s/iter; left time: 30.5137s
	iters: 300, epoch: 4 | loss: 0.1482013
	speed: 0.0029s/iter; left time: 29.2060s
	iters: 400, epoch: 4 | loss: 0.0847005
	speed: 0.0025s/iter; left time: 25.3262s
	iters: 500, epoch: 4 | loss: 0.0869003
	speed: 0.0029s/iter; left time: 28.2478s
	iters: 600, epoch: 4 | loss: 0.0751147
	speed: 0.0034s/iter; left time: 32.8305s
Epoch: 4 cost time: 1.8001763820648193
Epoch: 4, Steps: 610 | Train Loss: 0.1138196 Vali Loss: 0.1409945 Test Loss: 0.0962873
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0884340
	speed: 0.0062s/iter; left time: 60.2170s
	iters: 200, epoch: 5 | loss: 0.2089139
	speed: 0.0029s/iter; left time: 27.8226s
	iters: 300, epoch: 5 | loss: 0.0807462
	speed: 0.0034s/iter; left time: 31.9781s
	iters: 400, epoch: 5 | loss: 0.0620464
	speed: 0.0032s/iter; left time: 30.3616s
	iters: 500, epoch: 5 | loss: 0.0644624
	speed: 0.0033s/iter; left time: 30.0984s
	iters: 600, epoch: 5 | loss: 0.1015400
	speed: 0.0033s/iter; left time: 30.3228s
Epoch: 5 cost time: 2.00759220123291
Epoch: 5, Steps: 610 | Train Loss: 0.1126214 Vali Loss: 0.1390414 Test Loss: 0.0948038
Validation loss decreased (0.140730 --> 0.139041).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0881962
	speed: 0.0057s/iter; left time: 51.3408s
	iters: 200, epoch: 6 | loss: 0.0714241
	speed: 0.0036s/iter; left time: 32.0502s
	iters: 300, epoch: 6 | loss: 0.1415044
	speed: 0.0035s/iter; left time: 31.1555s
	iters: 400, epoch: 6 | loss: 0.1592399
	speed: 0.0034s/iter; left time: 29.5827s
	iters: 500, epoch: 6 | loss: 0.0707357
	speed: 0.0036s/iter; left time: 30.9705s
	iters: 600, epoch: 6 | loss: 0.2243148
	speed: 0.0037s/iter; left time: 31.2453s
Epoch: 6 cost time: 2.140746831893921
Epoch: 6, Steps: 610 | Train Loss: 0.1122294 Vali Loss: 0.1411515 Test Loss: 0.0946867
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1288918
	speed: 0.0059s/iter; left time: 49.9707s
	iters: 200, epoch: 7 | loss: 0.0786136
	speed: 0.0036s/iter; left time: 29.7773s
	iters: 300, epoch: 7 | loss: 0.0864783
	speed: 0.0037s/iter; left time: 30.5935s
	iters: 400, epoch: 7 | loss: 0.3812077
	speed: 0.0038s/iter; left time: 30.6102s
	iters: 500, epoch: 7 | loss: 0.0755768
	speed: 0.0036s/iter; left time: 29.0429s
	iters: 600, epoch: 7 | loss: 0.0680859
	speed: 0.0037s/iter; left time: 29.7041s
Epoch: 7 cost time: 2.2304799556732178
Epoch: 7, Steps: 610 | Train Loss: 0.1120046 Vali Loss: 0.1416719 Test Loss: 0.0932794
EarlyStopping counter: 2 out of 5
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.2188735
	speed: 0.0060s/iter; left time: 47.1548s
	iters: 200, epoch: 8 | loss: 0.1304706
	speed: 0.0033s/iter; left time: 25.2803s
	iters: 300, epoch: 8 | loss: 0.0968539
	speed: 0.0035s/iter; left time: 26.4033s
	iters: 400, epoch: 8 | loss: 0.0495257
	speed: 0.0036s/iter; left time: 27.1896s
	iters: 500, epoch: 8 | loss: 0.0597090
	speed: 0.0036s/iter; left time: 26.4213s
	iters: 600, epoch: 8 | loss: 0.0844560
	speed: 0.0031s/iter; left time: 22.8728s
Epoch: 8 cost time: 2.0717477798461914
Epoch: 8, Steps: 610 | Train Loss: 0.1118665 Vali Loss: 0.1411215 Test Loss: 0.0935305
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.1473576
	speed: 0.0041s/iter; left time: 29.9107s
	iters: 200, epoch: 9 | loss: 0.3300181
	speed: 0.0035s/iter; left time: 24.8524s
	iters: 300, epoch: 9 | loss: 0.0684785
	speed: 0.0037s/iter; left time: 25.8371s
	iters: 400, epoch: 9 | loss: 0.1186754
	speed: 0.0032s/iter; left time: 22.0909s
	iters: 500, epoch: 9 | loss: 0.1656965
	speed: 0.0032s/iter; left time: 21.8986s
	iters: 600, epoch: 9 | loss: 0.0920214
	speed: 0.0031s/iter; left time: 20.9696s
Epoch: 9 cost time: 1.9654531478881836
Epoch: 9, Steps: 610 | Train Loss: 0.1117737 Vali Loss: 0.1412862 Test Loss: 0.0933687
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.1237883
	speed: 0.0047s/iter; left time: 31.0851s
	iters: 200, epoch: 10 | loss: 0.0761128
	speed: 0.0027s/iter; left time: 17.7750s
	iters: 300, epoch: 10 | loss: 0.0724362
	speed: 0.0027s/iter; left time: 17.6302s
	iters: 400, epoch: 10 | loss: 0.1691093
	speed: 0.0027s/iter; left time: 17.2484s
	iters: 500, epoch: 10 | loss: 0.2674128
	speed: 0.0033s/iter; left time: 20.6828s
	iters: 600, epoch: 10 | loss: 0.1085116
	speed: 0.0032s/iter; left time: 19.7385s
Epoch: 10 cost time: 1.7883083820343018
Epoch: 10, Steps: 610 | Train Loss: 0.1117603 Vali Loss: 0.1415328 Test Loss: 0.0934181
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : Exchange_336_96_NLinear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15726<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 1422
mse:0.09468314796686172, mae:0.2136446088552475
