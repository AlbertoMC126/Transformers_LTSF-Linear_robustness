Args in experiment:
Namespace(activation='gelu', batch_size=8, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='exchange_rate.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=8, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='mse', lradj='type1', model='NLinear', model_id='Exchange_336_192', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=192, root_path='./dataset/', save_pred_values=False, seed=3293, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : Exchange_336_192_NLinear_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3293>>>>>>>>>>>>>>>>>>>>>>>>>>
train 4784
val 569
test 1326
	iters: 100, epoch: 1 | loss: 0.1771193
	speed: 0.0038s/iter; left time: 44.9765s
	iters: 200, epoch: 1 | loss: 0.1787952
	speed: 0.0045s/iter; left time: 53.1604s
	iters: 300, epoch: 1 | loss: 0.1642763
	speed: 0.0048s/iter; left time: 55.8458s
	iters: 400, epoch: 1 | loss: 0.3733486
	speed: 0.0038s/iter; left time: 43.8335s
	iters: 500, epoch: 1 | loss: 0.2023691
	speed: 0.0029s/iter; left time: 33.5807s
Epoch: 1 cost time: 2.283266067504883
Epoch: 1, Steps: 598 | Train Loss: 0.2460630 Vali Loss: 0.2501353 Test Loss: 0.1923628
Validation loss decreased (inf --> 0.250135).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1718978
	speed: 0.0096s/iter; left time: 107.9551s
	iters: 200, epoch: 2 | loss: 0.2441019
	speed: 0.0041s/iter; left time: 45.5740s
	iters: 300, epoch: 2 | loss: 0.1881093
	speed: 0.0041s/iter; left time: 45.6901s
	iters: 400, epoch: 2 | loss: 0.1769231
	speed: 0.0044s/iter; left time: 48.2436s
	iters: 500, epoch: 2 | loss: 0.2314667
	speed: 0.0044s/iter; left time: 47.6109s
Epoch: 2 cost time: 2.553600788116455
Epoch: 2, Steps: 598 | Train Loss: 0.2407903 Vali Loss: 0.2528720 Test Loss: 0.1994829
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.2161720
	speed: 0.0109s/iter; left time: 116.3934s
	iters: 200, epoch: 3 | loss: 0.2331247
	speed: 0.0046s/iter; left time: 48.1764s
	iters: 300, epoch: 3 | loss: 0.2147140
	speed: 0.0044s/iter; left time: 45.5279s
	iters: 400, epoch: 3 | loss: 0.1371854
	speed: 0.0037s/iter; left time: 38.7650s
	iters: 500, epoch: 3 | loss: 0.2418486
	speed: 0.0038s/iter; left time: 39.0319s
Epoch: 3 cost time: 2.457597017288208
Epoch: 3, Steps: 598 | Train Loss: 0.2354809 Vali Loss: 0.2490207 Test Loss: 0.2041215
Validation loss decreased (0.250135 --> 0.249021).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1383721
	speed: 0.0099s/iter; left time: 99.3046s
	iters: 200, epoch: 4 | loss: 0.3475374
	speed: 0.0043s/iter; left time: 42.6683s
	iters: 300, epoch: 4 | loss: 0.1371185
	speed: 0.0043s/iter; left time: 42.7242s
	iters: 400, epoch: 4 | loss: 0.3379431
	speed: 0.0042s/iter; left time: 41.3182s
	iters: 500, epoch: 4 | loss: 0.1775211
	speed: 0.0042s/iter; left time: 40.7948s
Epoch: 4 cost time: 2.46289324760437
Epoch: 4, Steps: 598 | Train Loss: 0.2321426 Vali Loss: 0.2486971 Test Loss: 0.1952476
Validation loss decreased (0.249021 --> 0.248697).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1525539
	speed: 0.0099s/iter; left time: 93.6888s
	iters: 200, epoch: 5 | loss: 0.1076607
	speed: 0.0037s/iter; left time: 34.8841s
	iters: 300, epoch: 5 | loss: 0.1994009
	speed: 0.0042s/iter; left time: 39.2064s
	iters: 400, epoch: 5 | loss: 0.2852076
	speed: 0.0043s/iter; left time: 39.4266s
	iters: 500, epoch: 5 | loss: 0.3799046
	speed: 0.0042s/iter; left time: 38.3838s
Epoch: 5 cost time: 2.4615583419799805
Epoch: 5, Steps: 598 | Train Loss: 0.2308088 Vali Loss: 0.2470371 Test Loss: 0.1964784
Validation loss decreased (0.248697 --> 0.247037).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.3731226
	speed: 0.0106s/iter; left time: 93.8261s
	iters: 200, epoch: 6 | loss: 0.2780730
	speed: 0.0043s/iter; left time: 37.6456s
	iters: 300, epoch: 6 | loss: 0.1576961
	speed: 0.0043s/iter; left time: 36.8723s
	iters: 400, epoch: 6 | loss: 0.1717246
	speed: 0.0042s/iter; left time: 36.0033s
	iters: 500, epoch: 6 | loss: 0.3647264
	speed: 0.0038s/iter; left time: 32.1220s
Epoch: 6 cost time: 2.5111804008483887
Epoch: 6, Steps: 598 | Train Loss: 0.2300794 Vali Loss: 0.2463591 Test Loss: 0.2000516
Validation loss decreased (0.247037 --> 0.246359).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.4410985
	speed: 0.0102s/iter; left time: 84.7463s
	iters: 200, epoch: 7 | loss: 0.1469224
	speed: 0.0036s/iter; left time: 29.2565s
	iters: 300, epoch: 7 | loss: 0.1503752
	speed: 0.0035s/iter; left time: 27.9326s
	iters: 400, epoch: 7 | loss: 0.3253503
	speed: 0.0041s/iter; left time: 32.5515s
	iters: 500, epoch: 7 | loss: 0.4683957
	speed: 0.0039s/iter; left time: 30.7834s
Epoch: 7 cost time: 2.211552143096924
Epoch: 7, Steps: 598 | Train Loss: 0.2298888 Vali Loss: 0.2446019 Test Loss: 0.1951363
Validation loss decreased (0.246359 --> 0.244602).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.2425288
	speed: 0.0094s/iter; left time: 72.0885s
	iters: 200, epoch: 8 | loss: 0.1359697
	speed: 0.0033s/iter; left time: 24.8457s
	iters: 300, epoch: 8 | loss: 0.2864968
	speed: 0.0037s/iter; left time: 27.4507s
	iters: 400, epoch: 8 | loss: 0.1822444
	speed: 0.0042s/iter; left time: 31.0487s
	iters: 500, epoch: 8 | loss: 0.1513059
	speed: 0.0042s/iter; left time: 30.2957s
Epoch: 8 cost time: 2.2667267322540283
Epoch: 8, Steps: 598 | Train Loss: 0.2296638 Vali Loss: 0.2451267 Test Loss: 0.1950780
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.1107615
	speed: 0.0103s/iter; left time: 73.0519s
	iters: 200, epoch: 9 | loss: 0.2269438
	speed: 0.0043s/iter; left time: 30.2082s
	iters: 300, epoch: 9 | loss: 0.3933403
	speed: 0.0042s/iter; left time: 29.2272s
	iters: 400, epoch: 9 | loss: 0.2642857
	speed: 0.0045s/iter; left time: 30.7194s
	iters: 500, epoch: 9 | loss: 0.2218991
	speed: 0.0043s/iter; left time: 28.6377s
Epoch: 9 cost time: 2.5866386890411377
Epoch: 9, Steps: 598 | Train Loss: 0.2295106 Vali Loss: 0.2450825 Test Loss: 0.1952163
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.1929602
	speed: 0.0111s/iter; left time: 71.6768s
	iters: 200, epoch: 10 | loss: 0.1919197
	speed: 0.0043s/iter; left time: 27.4513s
	iters: 300, epoch: 10 | loss: 0.1686057
	speed: 0.0044s/iter; left time: 27.5019s
	iters: 400, epoch: 10 | loss: 0.2040193
	speed: 0.0041s/iter; left time: 25.5966s
	iters: 500, epoch: 10 | loss: 0.1679903
	speed: 0.0044s/iter; left time: 26.8730s
Epoch: 10 cost time: 2.5729167461395264
Epoch: 10, Steps: 598 | Train Loss: 0.2294639 Vali Loss: 0.2450448 Test Loss: 0.1954427
EarlyStopping counter: 3 out of 5
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 11 | loss: 0.1466803
	speed: 0.0099s/iter; left time: 58.0519s
	iters: 200, epoch: 11 | loss: 0.1409848
	speed: 0.0039s/iter; left time: 22.2725s
	iters: 300, epoch: 11 | loss: 0.3666812
	speed: 0.0040s/iter; left time: 22.5536s
	iters: 400, epoch: 11 | loss: 0.2163649
	speed: 0.0042s/iter; left time: 23.1612s
	iters: 500, epoch: 11 | loss: 0.4860299
	speed: 0.0039s/iter; left time: 21.3369s
Epoch: 11 cost time: 2.369558572769165
Epoch: 11, Steps: 598 | Train Loss: 0.2294210 Vali Loss: 0.2444997 Test Loss: 0.1953995
Validation loss decreased (0.244602 --> 0.244500).  Saving model ...
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 12 | loss: 0.3275297
	speed: 0.0104s/iter; left time: 54.9030s
	iters: 200, epoch: 12 | loss: 0.2475043
	speed: 0.0040s/iter; left time: 20.8388s
	iters: 300, epoch: 12 | loss: 0.1564636
	speed: 0.0038s/iter; left time: 19.2250s
	iters: 400, epoch: 12 | loss: 0.3204169
	speed: 0.0039s/iter; left time: 19.1847s
	iters: 500, epoch: 12 | loss: 0.2838915
	speed: 0.0042s/iter; left time: 20.5566s
Epoch: 12 cost time: 2.3827316761016846
Epoch: 12, Steps: 598 | Train Loss: 0.2294024 Vali Loss: 0.2450732 Test Loss: 0.1954704
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.44140625e-07
	iters: 100, epoch: 13 | loss: 0.1242352
	speed: 0.0103s/iter; left time: 48.2659s
	iters: 200, epoch: 13 | loss: 0.4393440
	speed: 0.0042s/iter; left time: 19.3580s
	iters: 300, epoch: 13 | loss: 0.1558060
	speed: 0.0042s/iter; left time: 18.9716s
	iters: 400, epoch: 13 | loss: 0.1499255
	speed: 0.0040s/iter; left time: 17.5050s
	iters: 500, epoch: 13 | loss: 0.1784964
	speed: 0.0035s/iter; left time: 14.9048s
Epoch: 13 cost time: 2.298243284225464
Epoch: 13, Steps: 598 | Train Loss: 0.2293937 Vali Loss: 0.2450246 Test Loss: 0.1954732
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.220703125e-07
	iters: 100, epoch: 14 | loss: 0.1293647
	speed: 0.0079s/iter; left time: 32.3809s
	iters: 200, epoch: 14 | loss: 0.1768721
	speed: 0.0031s/iter; left time: 12.3996s
	iters: 300, epoch: 14 | loss: 0.4513555
	speed: 0.0032s/iter; left time: 12.2650s
	iters: 400, epoch: 14 | loss: 0.3525040
	speed: 0.0029s/iter; left time: 10.7990s
	iters: 500, epoch: 14 | loss: 0.2640141
	speed: 0.0027s/iter; left time: 10.0285s
Epoch: 14 cost time: 1.764986515045166
Epoch: 14, Steps: 598 | Train Loss: 0.2293880 Vali Loss: 0.2451610 Test Loss: 0.1954835
EarlyStopping counter: 3 out of 5
Updating learning rate to 6.103515625e-08
	iters: 100, epoch: 15 | loss: 0.2429540
	speed: 0.0066s/iter; left time: 23.0696s
	iters: 200, epoch: 15 | loss: 0.1773347
	speed: 0.0024s/iter; left time: 8.1690s
	iters: 300, epoch: 15 | loss: 0.3577140
	speed: 0.0025s/iter; left time: 8.1896s
	iters: 400, epoch: 15 | loss: 0.3974901
	speed: 0.0027s/iter; left time: 8.5465s
	iters: 500, epoch: 15 | loss: 0.1965449
	speed: 0.0027s/iter; left time: 8.4088s
Epoch: 15 cost time: 1.5554733276367188
Epoch: 15, Steps: 598 | Train Loss: 0.2293856 Vali Loss: 0.2450250 Test Loss: 0.1954867
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.0517578125e-08
	iters: 100, epoch: 16 | loss: 0.3477658
	speed: 0.0069s/iter; left time: 20.0070s
	iters: 200, epoch: 16 | loss: 0.1863156
	speed: 0.0026s/iter; left time: 7.2653s
	iters: 300, epoch: 16 | loss: 0.1402733
	speed: 0.0024s/iter; left time: 6.4870s
	iters: 400, epoch: 16 | loss: 0.1689695
	speed: 0.0024s/iter; left time: 6.1666s
	iters: 500, epoch: 16 | loss: 0.1955536
	speed: 0.0023s/iter; left time: 5.8041s
Epoch: 16 cost time: 1.5007109642028809
Epoch: 16, Steps: 598 | Train Loss: 0.2293843 Vali Loss: 0.2449649 Test Loss: 0.1954893
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : Exchange_336_192_NLinear_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3293<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 1326
mse:0.19535645842552185, mae:0.31026777625083923
