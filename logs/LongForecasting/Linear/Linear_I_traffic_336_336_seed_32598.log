Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='Linear', model_id='traffic_336_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=336, root_path='./dataset/', save_pred_values=False, seed=32598, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_336_336_Linear_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed32598>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11609
val 1421
test 3173
	iters: 100, epoch: 1 | loss: 0.4381908
	speed: 0.3271s/iter; left time: 4709.8725s
	iters: 200, epoch: 1 | loss: 0.4785057
	speed: 0.3090s/iter; left time: 4419.4419s
	iters: 300, epoch: 1 | loss: 0.4557324
	speed: 0.3092s/iter; left time: 4390.7647s
	iters: 400, epoch: 1 | loss: 0.4913720
	speed: 0.3096s/iter; left time: 4365.4178s
	iters: 500, epoch: 1 | loss: 0.5079885
	speed: 0.3120s/iter; left time: 4367.8393s
	iters: 600, epoch: 1 | loss: 0.4668304
	speed: 0.3105s/iter; left time: 4316.7645s
	iters: 700, epoch: 1 | loss: 0.4825660
	speed: 0.3106s/iter; left time: 4286.6241s
Epoch: 1 cost time: 226.7773723602295
Epoch: 1, Steps: 725 | Train Loss: 0.4950238 Vali Loss: 0.6548216 Test Loss: 0.7802520
Validation loss decreased (inf --> 0.654822).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.4755471
	speed: 0.6138s/iter; left time: 8394.3846s
	iters: 200, epoch: 2 | loss: 0.4706072
	speed: 0.3097s/iter; left time: 4203.8148s
	iters: 300, epoch: 2 | loss: 0.5048946
	speed: 0.3087s/iter; left time: 4160.3688s
	iters: 400, epoch: 2 | loss: 0.4932121
	speed: 0.3081s/iter; left time: 4120.7235s
	iters: 500, epoch: 2 | loss: 0.5050643
	speed: 0.3104s/iter; left time: 4121.0633s
	iters: 600, epoch: 2 | loss: 0.5009469
	speed: 0.3091s/iter; left time: 4072.9923s
	iters: 700, epoch: 2 | loss: 0.4785925
	speed: 0.3092s/iter; left time: 4043.1694s
Epoch: 2 cost time: 224.49990344047546
Epoch: 2, Steps: 725 | Train Loss: 0.4862599 Vali Loss: 0.6426263 Test Loss: 0.7704999
Validation loss decreased (0.654822 --> 0.642626).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.3635169
	speed: 0.6115s/iter; left time: 7919.3908s
	iters: 200, epoch: 3 | loss: 0.3579784
	speed: 0.3112s/iter; left time: 3999.6879s
	iters: 300, epoch: 3 | loss: 0.3427114
	speed: 0.3092s/iter; left time: 3942.0002s
	iters: 400, epoch: 3 | loss: 0.3334312
	speed: 0.3092s/iter; left time: 3911.8381s
	iters: 500, epoch: 3 | loss: 0.3741730
	speed: 0.3113s/iter; left time: 3907.3800s
	iters: 600, epoch: 3 | loss: 0.3577299
	speed: 0.3097s/iter; left time: 3855.5402s
	iters: 700, epoch: 3 | loss: 0.3310953
	speed: 0.3089s/iter; left time: 3814.8803s
Epoch: 3 cost time: 224.64844155311584
Epoch: 3, Steps: 725 | Train Loss: 0.3418927 Vali Loss: 0.4761589 Test Loss: 0.5808825
Validation loss decreased (0.642626 --> 0.476159).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.2838503
	speed: 0.6148s/iter; left time: 7516.5080s
	iters: 200, epoch: 4 | loss: 0.2886822
	speed: 0.3115s/iter; left time: 3777.5121s
	iters: 300, epoch: 4 | loss: 0.2923548
	speed: 0.3108s/iter; left time: 3738.0399s
	iters: 400, epoch: 4 | loss: 0.3235407
	speed: 0.3088s/iter; left time: 3683.2728s
	iters: 500, epoch: 4 | loss: 0.2894873
	speed: 0.3098s/iter; left time: 3663.3713s
	iters: 600, epoch: 4 | loss: 0.2690282
	speed: 0.3110s/iter; left time: 3646.4867s
	iters: 700, epoch: 4 | loss: 0.3041246
	speed: 0.3087s/iter; left time: 3588.4504s
Epoch: 4 cost time: 225.00881242752075
Epoch: 4, Steps: 725 | Train Loss: 0.2937548 Vali Loss: 0.4174275 Test Loss: 0.5075160
Validation loss decreased (0.476159 --> 0.417428).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.2729521
	speed: 0.6141s/iter; left time: 7062.6005s
	iters: 200, epoch: 5 | loss: 0.2764517
	speed: 0.3100s/iter; left time: 3534.0032s
	iters: 300, epoch: 5 | loss: 0.2624704
	speed: 0.3092s/iter; left time: 3494.3456s
	iters: 400, epoch: 5 | loss: 0.2549884
	speed: 0.3088s/iter; left time: 3458.7607s
	iters: 500, epoch: 5 | loss: 0.2806333
	speed: 0.3088s/iter; left time: 3427.6996s
	iters: 600, epoch: 5 | loss: 0.2920953
	speed: 0.3078s/iter; left time: 3386.5907s
	iters: 700, epoch: 5 | loss: 0.2601351
	speed: 0.3086s/iter; left time: 3363.6657s
Epoch: 5 cost time: 224.27900552749634
Epoch: 5, Steps: 725 | Train Loss: 0.2722850 Vali Loss: 0.3944903 Test Loss: 0.4795357
Validation loss decreased (0.417428 --> 0.394490).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.2607260
	speed: 0.6114s/iter; left time: 6588.9272s
	iters: 200, epoch: 6 | loss: 0.2552143
	speed: 0.3113s/iter; left time: 3323.5390s
	iters: 300, epoch: 6 | loss: 0.2674120
	speed: 0.3110s/iter; left time: 3288.6963s
	iters: 400, epoch: 6 | loss: 0.2596102
	speed: 0.3110s/iter; left time: 3257.7428s
	iters: 500, epoch: 6 | loss: 0.2651854
	speed: 0.3112s/iter; left time: 3228.8758s
	iters: 600, epoch: 6 | loss: 0.2746691
	speed: 0.3137s/iter; left time: 3223.4116s
	iters: 700, epoch: 6 | loss: 0.2488920
	speed: 0.3130s/iter; left time: 3185.1407s
Epoch: 6 cost time: 226.03262305259705
Epoch: 6, Steps: 725 | Train Loss: 0.2612636 Vali Loss: 0.3808994 Test Loss: 0.4654480
Validation loss decreased (0.394490 --> 0.380899).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.2458910
	speed: 0.6139s/iter; left time: 6170.5608s
	iters: 200, epoch: 7 | loss: 0.2435311
	speed: 0.3112s/iter; left time: 3096.6231s
	iters: 300, epoch: 7 | loss: 0.2633214
	speed: 0.3102s/iter; left time: 3055.4653s
	iters: 400, epoch: 7 | loss: 0.2758487
	speed: 0.3116s/iter; left time: 3038.2007s
	iters: 500, epoch: 7 | loss: 0.2577112
	speed: 0.3122s/iter; left time: 3012.7009s
	iters: 600, epoch: 7 | loss: 0.2731729
	speed: 0.3123s/iter; left time: 2982.4839s
	iters: 700, epoch: 7 | loss: 0.2710412
	speed: 0.3123s/iter; left time: 2951.9159s
Epoch: 7 cost time: 225.98295187950134
Epoch: 7, Steps: 725 | Train Loss: 0.2551876 Vali Loss: 0.3748399 Test Loss: 0.4588861
Validation loss decreased (0.380899 --> 0.374840).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.2718993
	speed: 0.6153s/iter; left time: 5738.2406s
	iters: 200, epoch: 8 | loss: 0.2624925
	speed: 0.3146s/iter; left time: 2902.6742s
	iters: 300, epoch: 8 | loss: 0.2626566
	speed: 0.3126s/iter; left time: 2852.5276s
	iters: 400, epoch: 8 | loss: 0.2621253
	speed: 0.3114s/iter; left time: 2810.3086s
	iters: 500, epoch: 8 | loss: 0.2320838
	speed: 0.3097s/iter; left time: 2764.4325s
	iters: 600, epoch: 8 | loss: 0.2573431
	speed: 0.3111s/iter; left time: 2745.6171s
	iters: 700, epoch: 8 | loss: 0.2564123
	speed: 0.3129s/iter; left time: 2730.6693s
Epoch: 8 cost time: 226.4103102684021
Epoch: 8, Steps: 725 | Train Loss: 0.2518853 Vali Loss: 0.3730078 Test Loss: 0.4559144
Validation loss decreased (0.374840 --> 0.373008).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.2495249
	speed: 0.6152s/iter; left time: 5291.6531s
	iters: 200, epoch: 9 | loss: 0.2463934
	speed: 0.3110s/iter; left time: 2644.2287s
	iters: 300, epoch: 9 | loss: 0.2373940
	speed: 0.3099s/iter; left time: 2603.4133s
	iters: 400, epoch: 9 | loss: 0.2429326
	speed: 0.3091s/iter; left time: 2565.7508s
	iters: 500, epoch: 9 | loss: 0.2641869
	speed: 0.3084s/iter; left time: 2529.3637s
	iters: 600, epoch: 9 | loss: 0.2580093
	speed: 0.3093s/iter; left time: 2505.2731s
	iters: 700, epoch: 9 | loss: 0.2298870
	speed: 0.3112s/iter; left time: 2490.0881s
Epoch: 9 cost time: 225.13158750534058
Epoch: 9, Steps: 725 | Train Loss: 0.2500673 Vali Loss: 0.3720375 Test Loss: 0.4544587
Validation loss decreased (0.373008 --> 0.372038).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.2918261
	speed: 0.6154s/iter; left time: 4847.0053s
	iters: 200, epoch: 10 | loss: 0.2493631
	speed: 0.3137s/iter; left time: 2439.0237s
	iters: 300, epoch: 10 | loss: 0.2312306
	speed: 0.3163s/iter; left time: 2427.7339s
	iters: 400, epoch: 10 | loss: 0.2390307
	speed: 0.3152s/iter; left time: 2388.1590s
	iters: 500, epoch: 10 | loss: 0.2395220
	speed: 0.3122s/iter; left time: 2333.6683s
	iters: 600, epoch: 10 | loss: 0.2529724
	speed: 0.3108s/iter; left time: 2292.4986s
	iters: 700, epoch: 10 | loss: 0.2478597
	speed: 0.3095s/iter; left time: 2251.6280s
Epoch: 10 cost time: 226.93392848968506
Epoch: 10, Steps: 725 | Train Loss: 0.2490723 Vali Loss: 0.3710645 Test Loss: 0.4536575
Validation loss decreased (0.372038 --> 0.371064).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.2802068
	speed: 0.6136s/iter; left time: 4387.7920s
	iters: 200, epoch: 11 | loss: 0.2452447
	speed: 0.3111s/iter; left time: 2193.3659s
	iters: 300, epoch: 11 | loss: 0.2665419
	speed: 0.3111s/iter; left time: 2162.1818s
	iters: 400, epoch: 11 | loss: 0.2451234
	speed: 0.3115s/iter; left time: 2134.0302s
	iters: 500, epoch: 11 | loss: 0.2475107
	speed: 0.3093s/iter; left time: 2088.0744s
	iters: 600, epoch: 11 | loss: 0.2480040
	speed: 0.3094s/iter; left time: 2057.8079s
	iters: 700, epoch: 11 | loss: 0.2708238
	speed: 0.3098s/iter; left time: 2029.1811s
Epoch: 11 cost time: 225.22003388404846
Epoch: 11, Steps: 725 | Train Loss: 0.2485402 Vali Loss: 0.3709259 Test Loss: 0.4534985
Validation loss decreased (0.371064 --> 0.370926).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.2391750
	speed: 0.6142s/iter; left time: 3946.6652s
	iters: 200, epoch: 12 | loss: 0.2420649
	speed: 0.3101s/iter; left time: 1961.4868s
	iters: 300, epoch: 12 | loss: 0.2484459
	speed: 0.3100s/iter; left time: 1930.2200s
	iters: 400, epoch: 12 | loss: 0.2383172
	speed: 0.3123s/iter; left time: 1913.1633s
	iters: 500, epoch: 12 | loss: 0.2417089
	speed: 0.3094s/iter; left time: 1864.5048s
	iters: 600, epoch: 12 | loss: 0.2302464
	speed: 0.3091s/iter; left time: 1831.8893s
	iters: 700, epoch: 12 | loss: 0.2393000
	speed: 0.3086s/iter; left time: 1797.6829s
Epoch: 12 cost time: 224.8238170146942
Epoch: 12, Steps: 725 | Train Loss: 0.2482388 Vali Loss: 0.3706498 Test Loss: 0.4533587
Validation loss decreased (0.370926 --> 0.370650).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.2613422
	speed: 0.6160s/iter; left time: 3511.8424s
	iters: 200, epoch: 13 | loss: 0.2309538
	speed: 0.3092s/iter; left time: 1731.6445s
	iters: 300, epoch: 13 | loss: 0.2344614
	speed: 0.3092s/iter; left time: 1700.9118s
	iters: 400, epoch: 13 | loss: 0.2221200
	speed: 0.3106s/iter; left time: 1677.3866s
	iters: 500, epoch: 13 | loss: 0.2415835
	speed: 0.3104s/iter; left time: 1645.2649s
	iters: 600, epoch: 13 | loss: 0.2697365
	speed: 0.3099s/iter; left time: 1611.8944s
	iters: 700, epoch: 13 | loss: 0.2519252
	speed: 0.3089s/iter; left time: 1575.9045s
Epoch: 13 cost time: 224.79003739356995
Epoch: 13, Steps: 725 | Train Loss: 0.2481132 Vali Loss: 0.3709192 Test Loss: 0.4532824
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 14 | loss: 0.2408418
	speed: 0.6075s/iter; left time: 3022.7517s
	iters: 200, epoch: 14 | loss: 0.2577723
	speed: 0.3093s/iter; left time: 1507.9419s
	iters: 300, epoch: 14 | loss: 0.2554642
	speed: 0.3087s/iter; left time: 1474.4319s
	iters: 400, epoch: 14 | loss: 0.2482218
	speed: 0.3086s/iter; left time: 1443.1808s
	iters: 500, epoch: 14 | loss: 0.2393718
	speed: 0.3084s/iter; left time: 1411.2420s
	iters: 600, epoch: 14 | loss: 0.2398037
	speed: 0.3095s/iter; left time: 1385.2390s
	iters: 700, epoch: 14 | loss: 0.2430145
	speed: 0.3096s/iter; left time: 1354.6376s
Epoch: 14 cost time: 224.00061416625977
Epoch: 14, Steps: 725 | Train Loss: 0.2480135 Vali Loss: 0.3706995 Test Loss: 0.4532678
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 15 | loss: 0.2315720
	speed: 0.6066s/iter; left time: 2578.8309s
	iters: 200, epoch: 15 | loss: 0.2874889
	speed: 0.3093s/iter; left time: 1284.0783s
	iters: 300, epoch: 15 | loss: 0.2314543
	speed: 0.3091s/iter; left time: 1252.2524s
	iters: 400, epoch: 15 | loss: 0.2585624
	speed: 0.3097s/iter; left time: 1223.4446s
	iters: 500, epoch: 15 | loss: 0.2371361
	speed: 0.3087s/iter; left time: 1188.8084s
	iters: 600, epoch: 15 | loss: 0.2512369
	speed: 0.3094s/iter; left time: 1160.4275s
	iters: 700, epoch: 15 | loss: 0.2289730
	speed: 0.3085s/iter; left time: 1126.3192s
Epoch: 15 cost time: 224.1263337135315
Epoch: 15, Steps: 725 | Train Loss: 0.2479813 Vali Loss: 0.3704668 Test Loss: 0.4532655
Validation loss decreased (0.370650 --> 0.370467).  Saving model ...
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 16 | loss: 0.2318524
	speed: 0.6158s/iter; left time: 2171.3011s
	iters: 200, epoch: 16 | loss: 0.2257906
	speed: 0.3103s/iter; left time: 1062.9713s
	iters: 300, epoch: 16 | loss: 0.2154845
	speed: 0.3094s/iter; left time: 1029.0705s
	iters: 400, epoch: 16 | loss: 0.2442034
	speed: 0.3084s/iter; left time: 994.8864s
	iters: 500, epoch: 16 | loss: 0.2292926
	speed: 0.3088s/iter; left time: 965.4396s
	iters: 600, epoch: 16 | loss: 0.2291673
	speed: 0.3093s/iter; left time: 935.9255s
	iters: 700, epoch: 16 | loss: 0.2402789
	speed: 0.3090s/iter; left time: 904.0099s
Epoch: 16 cost time: 224.51477146148682
Epoch: 16, Steps: 725 | Train Loss: 0.2479473 Vali Loss: 0.3704945 Test Loss: 0.4532687
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 17 | loss: 0.2256053
	speed: 0.6104s/iter; left time: 1709.7041s
	iters: 200, epoch: 17 | loss: 0.2588688
	speed: 0.3097s/iter; left time: 836.3959s
	iters: 300, epoch: 17 | loss: 0.2808319
	speed: 0.3102s/iter; left time: 806.8585s
	iters: 400, epoch: 17 | loss: 0.2529512
	speed: 0.3091s/iter; left time: 773.1341s
	iters: 500, epoch: 17 | loss: 0.2451668
	speed: 0.3089s/iter; left time: 741.7471s
	iters: 600, epoch: 17 | loss: 0.2482029
	speed: 0.3095s/iter; left time: 712.2002s
	iters: 700, epoch: 17 | loss: 0.2482780
	speed: 0.3090s/iter; left time: 680.0885s
Epoch: 17 cost time: 224.34681797027588
Epoch: 17, Steps: 725 | Train Loss: 0.2479596 Vali Loss: 0.3705228 Test Loss: 0.4532686
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 18 | loss: 0.2159221
	speed: 0.6065s/iter; left time: 1259.0160s
	iters: 200, epoch: 18 | loss: 0.2493790
	speed: 0.3086s/iter; left time: 609.7873s
	iters: 300, epoch: 18 | loss: 0.2394430
	speed: 0.3096s/iter; left time: 580.8491s
	iters: 400, epoch: 18 | loss: 0.2571356
	speed: 0.3111s/iter; left time: 552.4343s
	iters: 500, epoch: 18 | loss: 0.2349658
	speed: 0.3106s/iter; left time: 520.5182s
	iters: 600, epoch: 18 | loss: 0.2421134
	speed: 0.3097s/iter; left time: 488.0262s
	iters: 700, epoch: 18 | loss: 0.2604982
	speed: 0.3110s/iter; left time: 458.9812s
Epoch: 18 cost time: 224.63832235336304
Epoch: 18, Steps: 725 | Train Loss: 0.2479320 Vali Loss: 0.3705837 Test Loss: 0.4532685
EarlyStopping counter: 3 out of 5
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 19 | loss: 0.2630852
	speed: 0.6099s/iter; left time: 823.9308s
	iters: 200, epoch: 19 | loss: 0.2479704
	speed: 0.3114s/iter; left time: 389.6040s
	iters: 300, epoch: 19 | loss: 0.2740534
	speed: 0.3113s/iter; left time: 358.2981s
	iters: 400, epoch: 19 | loss: 0.2498692
	speed: 0.3101s/iter; left time: 325.9510s
	iters: 500, epoch: 19 | loss: 0.2332203
	speed: 0.3105s/iter; left time: 295.2622s
	iters: 600, epoch: 19 | loss: 0.2410845
	speed: 0.3114s/iter; left time: 264.9918s
	iters: 700, epoch: 19 | loss: 0.2634971
	speed: 0.3097s/iter; left time: 232.5917s
Epoch: 19 cost time: 225.31385707855225
Epoch: 19, Steps: 725 | Train Loss: 0.2479095 Vali Loss: 0.3706429 Test Loss: 0.4532686
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 20 | loss: 0.2410862
	speed: 0.6061s/iter; left time: 379.4119s
	iters: 200, epoch: 20 | loss: 0.2551388
	speed: 0.3103s/iter; left time: 163.2419s
	iters: 300, epoch: 20 | loss: 0.2740863
	speed: 0.3114s/iter; left time: 132.6488s
	iters: 400, epoch: 20 | loss: 0.2383849
	speed: 0.3121s/iter; left time: 101.7381s
	iters: 500, epoch: 20 | loss: 0.2346932
	speed: 0.3107s/iter; left time: 70.2183s
	iters: 600, epoch: 20 | loss: 0.2208723
	speed: 0.3115s/iter; left time: 39.2459s
	iters: 700, epoch: 20 | loss: 0.2465497
	speed: 0.3093s/iter; left time: 8.0417s
Epoch: 20 cost time: 225.15555334091187
Epoch: 20, Steps: 725 | Train Loss: 0.2479398 Vali Loss: 0.3708447 Test Loss: 0.4532686
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : traffic_336_336_Linear_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed32598<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3173
mse:0.4522918164730072, mae:0.3119989037513733
