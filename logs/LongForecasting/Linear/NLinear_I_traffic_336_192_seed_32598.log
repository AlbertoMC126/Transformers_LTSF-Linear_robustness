Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='NLinear', model_id='traffic_336_192', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=192, root_path='./dataset/', save_pred_values=False, seed=32598, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_336_192_NLinear_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed32598>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11753
val 1565
test 3317
	iters: 100, epoch: 1 | loss: 0.8041218
	speed: 0.3153s/iter; left time: 4597.6812s
	iters: 200, epoch: 1 | loss: 0.6654475
	speed: 0.3008s/iter; left time: 4355.4265s
	iters: 300, epoch: 1 | loss: 0.7551993
	speed: 0.3009s/iter; left time: 4327.6389s
	iters: 400, epoch: 1 | loss: 0.9552069
	speed: 0.3016s/iter; left time: 4306.8455s
	iters: 500, epoch: 1 | loss: 1.4183950
	speed: 0.3005s/iter; left time: 4260.7392s
	iters: 600, epoch: 1 | loss: 1.3857640
	speed: 0.3018s/iter; left time: 4249.1860s
	iters: 700, epoch: 1 | loss: 0.6942139
	speed: 0.3005s/iter; left time: 4201.4911s
Epoch: 1 cost time: 222.57624745368958
Epoch: 1, Steps: 734 | Train Loss: 1.0734483 Vali Loss: 1.7023227 Test Loss: 1.9131731
Validation loss decreased (inf --> 1.702323).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.7746739
	speed: 0.6025s/iter; left time: 8342.5871s
	iters: 200, epoch: 2 | loss: 0.8897704
	speed: 0.2998s/iter; left time: 4121.3007s
	iters: 300, epoch: 2 | loss: 1.0524557
	speed: 0.2998s/iter; left time: 4091.4949s
	iters: 400, epoch: 2 | loss: 0.6282554
	speed: 0.3001s/iter; left time: 4065.0765s
	iters: 500, epoch: 2 | loss: 2.6409774
	speed: 0.3011s/iter; left time: 4048.9092s
	iters: 600, epoch: 2 | loss: 2.3315620
	speed: 0.3020s/iter; left time: 4030.7440s
	iters: 700, epoch: 2 | loss: 2.3150015
	speed: 0.3008s/iter; left time: 3984.6117s
Epoch: 2 cost time: 220.58361411094666
Epoch: 2, Steps: 734 | Train Loss: 1.2348993 Vali Loss: 1.9961820 Test Loss: 2.2495816
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.3582813
	speed: 0.6055s/iter; left time: 7939.3984s
	iters: 200, epoch: 3 | loss: 0.3427859
	speed: 0.3006s/iter; left time: 3911.3600s
	iters: 300, epoch: 3 | loss: 0.3241557
	speed: 0.3018s/iter; left time: 3897.7137s
	iters: 400, epoch: 3 | loss: 0.3494916
	speed: 0.3030s/iter; left time: 3881.9325s
	iters: 500, epoch: 3 | loss: 0.3471099
	speed: 0.3030s/iter; left time: 3852.4553s
	iters: 600, epoch: 3 | loss: 0.3249086
	speed: 0.3023s/iter; left time: 3812.5729s
	iters: 700, epoch: 3 | loss: 0.3486544
	speed: 0.3005s/iter; left time: 3760.4068s
Epoch: 3 cost time: 221.5508406162262
Epoch: 3, Steps: 734 | Train Loss: 0.4040507 Vali Loss: 0.4959663 Test Loss: 0.6173252
Validation loss decreased (1.702323 --> 0.495966).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.2718576
	speed: 0.6064s/iter; left time: 7506.3165s
	iters: 200, epoch: 4 | loss: 0.2823559
	speed: 0.3017s/iter; left time: 3704.7284s
	iters: 300, epoch: 4 | loss: 0.2678365
	speed: 0.3002s/iter; left time: 3656.4813s
	iters: 400, epoch: 4 | loss: 0.2954071
	speed: 0.3001s/iter; left time: 3625.1295s
	iters: 500, epoch: 4 | loss: 0.2742360
	speed: 0.3000s/iter; left time: 3594.0157s
	iters: 600, epoch: 4 | loss: 0.3165260
	speed: 0.3005s/iter; left time: 3569.2986s
	iters: 700, epoch: 4 | loss: 0.2977325
	speed: 0.3012s/iter; left time: 3548.2519s
Epoch: 4 cost time: 220.8155562877655
Epoch: 4, Steps: 734 | Train Loss: 0.2865681 Vali Loss: 0.4010588 Test Loss: 0.4928752
Validation loss decreased (0.495966 --> 0.401059).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.2578889
	speed: 0.6042s/iter; left time: 7036.2584s
	iters: 200, epoch: 5 | loss: 0.2430546
	speed: 0.3000s/iter; left time: 3463.8385s
	iters: 300, epoch: 5 | loss: 0.2744985
	speed: 0.3016s/iter; left time: 3451.3150s
	iters: 400, epoch: 5 | loss: 0.2462972
	speed: 0.3006s/iter; left time: 3409.7906s
	iters: 500, epoch: 5 | loss: 0.2764028
	speed: 0.3001s/iter; left time: 3374.1737s
	iters: 600, epoch: 5 | loss: 0.2639041
	speed: 0.2997s/iter; left time: 3340.1123s
	iters: 700, epoch: 5 | loss: 0.2899694
	speed: 0.3000s/iter; left time: 3313.4818s
Epoch: 5 cost time: 220.34112215042114
Epoch: 5, Steps: 734 | Train Loss: 0.2648988 Vali Loss: 0.3706971 Test Loss: 0.4601102
Validation loss decreased (0.401059 --> 0.370697).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.2750480
	speed: 0.6048s/iter; left time: 6598.7870s
	iters: 200, epoch: 6 | loss: 0.2706542
	speed: 0.3090s/iter; left time: 3340.8131s
	iters: 300, epoch: 6 | loss: 0.2274722
	speed: 0.3093s/iter; left time: 3312.4970s
	iters: 400, epoch: 6 | loss: 0.2454616
	speed: 0.3053s/iter; left time: 3239.0831s
	iters: 500, epoch: 6 | loss: 0.2612727
	speed: 0.3017s/iter; left time: 3171.2975s
	iters: 600, epoch: 6 | loss: 0.2354141
	speed: 0.3019s/iter; left time: 3142.7143s
	iters: 700, epoch: 6 | loss: 0.2279894
	speed: 0.3034s/iter; left time: 3128.5359s
Epoch: 6 cost time: 223.48974752426147
Epoch: 6, Steps: 734 | Train Loss: 0.2546306 Vali Loss: 0.3644156 Test Loss: 0.4537164
Validation loss decreased (0.370697 --> 0.364416).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.2427238
	speed: 0.6095s/iter; left time: 6202.7183s
	iters: 200, epoch: 7 | loss: 0.2246895
	speed: 0.3023s/iter; left time: 3046.4047s
	iters: 300, epoch: 7 | loss: 0.2452498
	speed: 0.3119s/iter; left time: 3111.6205s
	iters: 400, epoch: 7 | loss: 0.2238426
	speed: 0.3059s/iter; left time: 3020.9771s
	iters: 500, epoch: 7 | loss: 0.2489000
	speed: 0.3081s/iter; left time: 3011.9143s
	iters: 600, epoch: 7 | loss: 0.2505340
	speed: 0.3038s/iter; left time: 2939.7539s
	iters: 700, epoch: 7 | loss: 0.2400211
	speed: 0.3035s/iter; left time: 2906.6861s
Epoch: 7 cost time: 224.17454957962036
Epoch: 7, Steps: 734 | Train Loss: 0.2491962 Vali Loss: 0.3568330 Test Loss: 0.4443817
Validation loss decreased (0.364416 --> 0.356833).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.2374199
	speed: 0.6083s/iter; left time: 5744.2233s
	iters: 200, epoch: 8 | loss: 0.2212994
	speed: 0.3018s/iter; left time: 2819.4714s
	iters: 300, epoch: 8 | loss: 0.2826148
	speed: 0.3037s/iter; left time: 2807.5317s
	iters: 400, epoch: 8 | loss: 0.2338293
	speed: 0.3001s/iter; left time: 2743.5613s
	iters: 500, epoch: 8 | loss: 0.2372688
	speed: 0.3026s/iter; left time: 2736.1329s
	iters: 600, epoch: 8 | loss: 0.2471804
	speed: 0.3038s/iter; left time: 2716.9425s
	iters: 700, epoch: 8 | loss: 0.2240188
	speed: 0.3044s/iter; left time: 2691.7179s
Epoch: 8 cost time: 222.24381256103516
Epoch: 8, Steps: 734 | Train Loss: 0.2459476 Vali Loss: 0.3533281 Test Loss: 0.4404599
Validation loss decreased (0.356833 --> 0.353328).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.2620309
	speed: 0.6070s/iter; left time: 5286.4810s
	iters: 200, epoch: 9 | loss: 0.2059064
	speed: 0.3005s/iter; left time: 2587.1310s
	iters: 300, epoch: 9 | loss: 0.2635848
	speed: 0.3019s/iter; left time: 2568.5642s
	iters: 400, epoch: 9 | loss: 0.2233415
	speed: 0.3001s/iter; left time: 2523.6511s
	iters: 500, epoch: 9 | loss: 0.2427521
	speed: 0.2997s/iter; left time: 2490.4578s
	iters: 600, epoch: 9 | loss: 0.2418986
	speed: 0.3000s/iter; left time: 2463.1024s
	iters: 700, epoch: 9 | loss: 0.2444111
	speed: 0.3000s/iter; left time: 2432.3175s
Epoch: 9 cost time: 220.6895670890808
Epoch: 9, Steps: 734 | Train Loss: 0.2440134 Vali Loss: 0.3514888 Test Loss: 0.4380038
Validation loss decreased (0.353328 --> 0.351489).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.2198309
	speed: 0.6128s/iter; left time: 4887.0276s
	iters: 200, epoch: 10 | loss: 0.2126956
	speed: 0.3027s/iter; left time: 2383.9725s
	iters: 300, epoch: 10 | loss: 0.2453586
	speed: 0.3034s/iter; left time: 2358.6190s
	iters: 400, epoch: 10 | loss: 0.2341240
	speed: 0.3027s/iter; left time: 2322.9395s
	iters: 500, epoch: 10 | loss: 0.2564044
	speed: 0.3024s/iter; left time: 2290.5742s
	iters: 600, epoch: 10 | loss: 0.2544378
	speed: 0.3009s/iter; left time: 2249.4770s
	iters: 700, epoch: 10 | loss: 0.2299945
	speed: 0.3015s/iter; left time: 2223.7916s
Epoch: 10 cost time: 222.00077486038208
Epoch: 10, Steps: 734 | Train Loss: 0.2429366 Vali Loss: 0.3508832 Test Loss: 0.4376076
Validation loss decreased (0.351489 --> 0.350883).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.2280929
	speed: 0.6072s/iter; left time: 4396.6513s
	iters: 200, epoch: 11 | loss: 0.2412322
	speed: 0.3019s/iter; left time: 2155.6741s
	iters: 300, epoch: 11 | loss: 0.2589646
	speed: 0.3004s/iter; left time: 2114.9397s
	iters: 400, epoch: 11 | loss: 0.2716800
	speed: 0.3018s/iter; left time: 2094.9196s
	iters: 500, epoch: 11 | loss: 0.2476450
	speed: 0.3008s/iter; left time: 2058.1107s
	iters: 600, epoch: 11 | loss: 0.2351772
	speed: 0.3030s/iter; left time: 2042.2068s
	iters: 700, epoch: 11 | loss: 0.2234998
	speed: 0.3023s/iter; left time: 2007.6804s
Epoch: 11 cost time: 221.54089188575745
Epoch: 11, Steps: 734 | Train Loss: 0.2423284 Vali Loss: 0.3501373 Test Loss: 0.4368227
Validation loss decreased (0.350883 --> 0.350137).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.2304392
	speed: 0.6095s/iter; left time: 3966.2800s
	iters: 200, epoch: 12 | loss: 0.2284027
	speed: 0.3031s/iter; left time: 1941.7289s
	iters: 300, epoch: 12 | loss: 0.2564103
	speed: 0.3033s/iter; left time: 1913.1368s
	iters: 400, epoch: 12 | loss: 0.2488602
	speed: 0.3029s/iter; left time: 1879.9236s
	iters: 500, epoch: 12 | loss: 0.2394693
	speed: 0.3023s/iter; left time: 1846.3886s
	iters: 600, epoch: 12 | loss: 0.2122826
	speed: 0.3022s/iter; left time: 1815.0453s
	iters: 700, epoch: 12 | loss: 0.2228577
	speed: 0.3013s/iter; left time: 1779.4999s
Epoch: 12 cost time: 222.23096227645874
Epoch: 12, Steps: 734 | Train Loss: 0.2419817 Vali Loss: 0.3500516 Test Loss: 0.4365388
Validation loss decreased (0.350137 --> 0.350052).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.2497707
	speed: 0.6093s/iter; left time: 3517.2058s
	iters: 200, epoch: 13 | loss: 0.2444253
	speed: 0.3013s/iter; left time: 1709.4326s
	iters: 300, epoch: 13 | loss: 0.2717464
	speed: 0.3023s/iter; left time: 1684.9120s
	iters: 400, epoch: 13 | loss: 0.2395694
	speed: 0.3011s/iter; left time: 1647.8807s
	iters: 500, epoch: 13 | loss: 0.2270399
	speed: 0.3024s/iter; left time: 1624.7883s
	iters: 600, epoch: 13 | loss: 0.2183947
	speed: 0.3027s/iter; left time: 1596.0092s
	iters: 700, epoch: 13 | loss: 0.2477462
	speed: 0.3028s/iter; left time: 1566.2862s
Epoch: 13 cost time: 221.78441286087036
Epoch: 13, Steps: 734 | Train Loss: 0.2418200 Vali Loss: 0.3496388 Test Loss: 0.4364433
Validation loss decreased (0.350052 --> 0.349639).  Saving model ...
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 14 | loss: 0.2209027
	speed: 0.6074s/iter; left time: 3060.6444s
	iters: 200, epoch: 14 | loss: 0.2259601
	speed: 0.3020s/iter; left time: 1491.6124s
	iters: 300, epoch: 14 | loss: 0.2607656
	speed: 0.3024s/iter; left time: 1463.3369s
	iters: 400, epoch: 14 | loss: 0.2619151
	speed: 0.3003s/iter; left time: 1423.0653s
	iters: 500, epoch: 14 | loss: 0.2643461
	speed: 0.3006s/iter; left time: 1394.3485s
	iters: 600, epoch: 14 | loss: 0.2338752
	speed: 0.3019s/iter; left time: 1370.4727s
	iters: 700, epoch: 14 | loss: 0.2198257
	speed: 0.3001s/iter; left time: 1332.3614s
Epoch: 14 cost time: 221.25627875328064
Epoch: 14, Steps: 734 | Train Loss: 0.2416750 Vali Loss: 0.3496581 Test Loss: 0.4363282
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 15 | loss: 0.2503132
	speed: 0.6051s/iter; left time: 2605.0596s
	iters: 200, epoch: 15 | loss: 0.2467273
	speed: 0.3004s/iter; left time: 1263.1414s
	iters: 300, epoch: 15 | loss: 0.2729646
	speed: 0.3024s/iter; left time: 1241.3264s
	iters: 400, epoch: 15 | loss: 0.2280455
	speed: 0.3021s/iter; left time: 1210.0184s
	iters: 500, epoch: 15 | loss: 0.2588558
	speed: 0.3020s/iter; left time: 1179.1755s
	iters: 600, epoch: 15 | loss: 0.2603363
	speed: 0.3027s/iter; left time: 1151.8034s
	iters: 700, epoch: 15 | loss: 0.2429011
	speed: 0.3020s/iter; left time: 1118.9620s
Epoch: 15 cost time: 221.7176706790924
Epoch: 15, Steps: 734 | Train Loss: 0.2416031 Vali Loss: 0.3498453 Test Loss: 0.4363072
EarlyStopping counter: 2 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 16 | loss: 0.2551634
	speed: 0.6062s/iter; left time: 2164.7818s
	iters: 200, epoch: 16 | loss: 0.2485993
	speed: 0.3022s/iter; left time: 1048.9334s
	iters: 300, epoch: 16 | loss: 0.2547995
	speed: 0.3007s/iter; left time: 1013.6138s
	iters: 400, epoch: 16 | loss: 0.2600319
	speed: 0.3020s/iter; left time: 987.9662s
	iters: 500, epoch: 16 | loss: 0.2291634
	speed: 0.3014s/iter; left time: 955.6059s
	iters: 600, epoch: 16 | loss: 0.2141652
	speed: 0.3052s/iter; left time: 937.1208s
	iters: 700, epoch: 16 | loss: 0.2597668
	speed: 0.3008s/iter; left time: 893.5288s
Epoch: 16 cost time: 221.66141295433044
Epoch: 16, Steps: 734 | Train Loss: 0.2416263 Vali Loss: 0.3498454 Test Loss: 0.4362938
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 17 | loss: 0.2570989
	speed: 0.6054s/iter; left time: 1717.5316s
	iters: 200, epoch: 17 | loss: 0.2382565
	speed: 0.3024s/iter; left time: 827.5645s
	iters: 300, epoch: 17 | loss: 0.2754432
	speed: 0.3006s/iter; left time: 792.8066s
	iters: 400, epoch: 17 | loss: 0.2358393
	speed: 0.3024s/iter; left time: 767.1767s
	iters: 500, epoch: 17 | loss: 0.2478008
	speed: 0.3012s/iter; left time: 733.9898s
	iters: 600, epoch: 17 | loss: 0.2465468
	speed: 0.3031s/iter; left time: 708.3180s
	iters: 700, epoch: 17 | loss: 0.2670107
	speed: 0.3028s/iter; left time: 677.2679s
Epoch: 17 cost time: 221.78786778450012
Epoch: 17, Steps: 734 | Train Loss: 0.2415875 Vali Loss: 0.3499046 Test Loss: 0.4362935
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 18 | loss: 0.2484410
	speed: 0.6057s/iter; left time: 1273.7403s
	iters: 200, epoch: 18 | loss: 0.2482990
	speed: 0.3017s/iter; left time: 604.3159s
	iters: 300, epoch: 18 | loss: 0.2639758
	speed: 0.2998s/iter; left time: 570.5868s
	iters: 400, epoch: 18 | loss: 0.2532459
	speed: 0.3000s/iter; left time: 540.9365s
	iters: 500, epoch: 18 | loss: 0.2528610
	speed: 0.2999s/iter; left time: 510.7446s
	iters: 600, epoch: 18 | loss: 0.2460580
	speed: 0.3003s/iter; left time: 481.3223s
	iters: 700, epoch: 18 | loss: 0.2410982
	speed: 0.3018s/iter; left time: 453.6595s
Epoch: 18 cost time: 220.72531056404114
Epoch: 18, Steps: 734 | Train Loss: 0.2415903 Vali Loss: 0.3497735 Test Loss: 0.4362933
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : traffic_336_192_NLinear_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed32598<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3317
mse:0.43609946966171265, mae:0.2992102801799774
