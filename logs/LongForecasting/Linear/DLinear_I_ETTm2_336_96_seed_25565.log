Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='DLinear', model_id='ETTm2_336_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=25565, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTm2_336_96_DLinear_ETTm2_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed25565>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34129
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.2787331
	speed: 0.0077s/iter; left time: 163.0138s
	iters: 200, epoch: 1 | loss: 0.2845970
	speed: 0.0085s/iter; left time: 180.2201s
	iters: 300, epoch: 1 | loss: 0.5813712
	speed: 0.0089s/iter; left time: 186.7207s
	iters: 400, epoch: 1 | loss: 0.6477578
	speed: 0.0078s/iter; left time: 162.4124s
	iters: 500, epoch: 1 | loss: 0.3431056
	speed: 0.0079s/iter; left time: 163.9135s
	iters: 600, epoch: 1 | loss: 0.6913332
	speed: 0.0085s/iter; left time: 176.5429s
	iters: 700, epoch: 1 | loss: 0.3871764
	speed: 0.0061s/iter; left time: 125.2285s
	iters: 800, epoch: 1 | loss: 0.4588797
	speed: 0.0065s/iter; left time: 133.2221s
	iters: 900, epoch: 1 | loss: 0.7595376
	speed: 0.0085s/iter; left time: 173.3851s
	iters: 1000, epoch: 1 | loss: 0.6146871
	speed: 0.0069s/iter; left time: 139.2697s
Epoch: 1 cost time: 8.164394855499268
Epoch: 1, Steps: 1066 | Train Loss: 0.4638260 Vali Loss: 0.3783687 Test Loss: 0.8929232
Validation loss decreased (inf --> 0.378369).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.5368978
	speed: 0.0327s/iter; left time: 659.8150s
	iters: 200, epoch: 2 | loss: 0.2788625
	speed: 0.0080s/iter; left time: 161.0987s
	iters: 300, epoch: 2 | loss: 0.5890146
	speed: 0.0084s/iter; left time: 167.8714s
	iters: 400, epoch: 2 | loss: 0.5052619
	speed: 0.0074s/iter; left time: 146.1849s
	iters: 500, epoch: 2 | loss: 0.3018333
	speed: 0.0076s/iter; left time: 149.4242s
	iters: 600, epoch: 2 | loss: 0.3956237
	speed: 0.0077s/iter; left time: 150.9622s
	iters: 700, epoch: 2 | loss: 0.3863842
	speed: 0.0078s/iter; left time: 152.7647s
	iters: 800, epoch: 2 | loss: 0.2837878
	speed: 0.0082s/iter; left time: 160.1737s
	iters: 900, epoch: 2 | loss: 0.3983902
	speed: 0.0084s/iter; left time: 163.4167s
	iters: 1000, epoch: 2 | loss: 0.4069484
	speed: 0.0094s/iter; left time: 181.8132s
Epoch: 2 cost time: 8.668920040130615
Epoch: 2, Steps: 1066 | Train Loss: 0.4531854 Vali Loss: 0.9905004 Test Loss: 2.4556410
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.2241468
	speed: 0.0362s/iter; left time: 690.6686s
	iters: 200, epoch: 3 | loss: 0.5202615
	speed: 0.0087s/iter; left time: 165.6226s
	iters: 300, epoch: 3 | loss: 0.1599369
	speed: 0.0084s/iter; left time: 157.7816s
	iters: 400, epoch: 3 | loss: 0.2470845
	speed: 0.0083s/iter; left time: 155.2202s
	iters: 500, epoch: 3 | loss: 0.2446225
	speed: 0.0075s/iter; left time: 140.2206s
	iters: 600, epoch: 3 | loss: 0.1867944
	speed: 0.0083s/iter; left time: 154.8563s
	iters: 700, epoch: 3 | loss: 0.2319655
	speed: 0.0085s/iter; left time: 156.6406s
	iters: 800, epoch: 3 | loss: 0.4049350
	speed: 0.0083s/iter; left time: 153.2356s
	iters: 900, epoch: 3 | loss: 0.3112018
	speed: 0.0084s/iter; left time: 154.3863s
	iters: 1000, epoch: 3 | loss: 0.2718954
	speed: 0.0091s/iter; left time: 164.6445s
Epoch: 3 cost time: 8.867915868759155
Epoch: 3, Steps: 1066 | Train Loss: 0.2801548 Vali Loss: 0.2606340 Test Loss: 0.4898701
Validation loss decreased (0.378369 --> 0.260634).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.1649735
	speed: 0.0363s/iter; left time: 654.2386s
	iters: 200, epoch: 4 | loss: 0.1217566
	speed: 0.0091s/iter; left time: 163.4688s
	iters: 300, epoch: 4 | loss: 0.1636736
	speed: 0.0090s/iter; left time: 160.7689s
	iters: 400, epoch: 4 | loss: 0.3854843
	speed: 0.0096s/iter; left time: 169.3233s
	iters: 500, epoch: 4 | loss: 0.1607399
	speed: 0.0092s/iter; left time: 161.3246s
	iters: 600, epoch: 4 | loss: 0.1625615
	speed: 0.0084s/iter; left time: 146.3593s
	iters: 700, epoch: 4 | loss: 0.2168562
	speed: 0.0079s/iter; left time: 136.8107s
	iters: 800, epoch: 4 | loss: 0.2003434
	speed: 0.0077s/iter; left time: 132.7001s
	iters: 900, epoch: 4 | loss: 0.3384300
	speed: 0.0077s/iter; left time: 132.4449s
	iters: 1000, epoch: 4 | loss: 0.1920532
	speed: 0.0079s/iter; left time: 134.8866s
Epoch: 4 cost time: 9.03165340423584
Epoch: 4, Steps: 1066 | Train Loss: 0.2361071 Vali Loss: 0.2279039 Test Loss: 0.4813014
Validation loss decreased (0.260634 --> 0.227904).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.1941103
	speed: 0.0354s/iter; left time: 600.0676s
	iters: 200, epoch: 5 | loss: 0.1688014
	speed: 0.0084s/iter; left time: 141.2943s
	iters: 300, epoch: 5 | loss: 0.1602095
	speed: 0.0075s/iter; left time: 125.8453s
	iters: 400, epoch: 5 | loss: 0.1544204
	speed: 0.0084s/iter; left time: 139.4589s
	iters: 500, epoch: 5 | loss: 0.2297385
	speed: 0.0084s/iter; left time: 138.4633s
	iters: 600, epoch: 5 | loss: 0.2393008
	speed: 0.0080s/iter; left time: 132.3618s
	iters: 700, epoch: 5 | loss: 0.1792526
	speed: 0.0091s/iter; left time: 149.0352s
	iters: 800, epoch: 5 | loss: 0.2468628
	speed: 0.0084s/iter; left time: 135.7916s
	iters: 900, epoch: 5 | loss: 0.3104366
	speed: 0.0070s/iter; left time: 112.7825s
	iters: 1000, epoch: 5 | loss: 0.1162207
	speed: 0.0073s/iter; left time: 116.6198s
Epoch: 5 cost time: 8.60784363746643
Epoch: 5, Steps: 1066 | Train Loss: 0.2206306 Vali Loss: 0.1905366 Test Loss: 0.3918221
Validation loss decreased (0.227904 --> 0.190537).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.1737288
	speed: 0.0353s/iter; left time: 560.4477s
	iters: 200, epoch: 6 | loss: 0.1759772
	speed: 0.0093s/iter; left time: 146.5985s
	iters: 300, epoch: 6 | loss: 0.2015127
	speed: 0.0097s/iter; left time: 151.9207s
	iters: 400, epoch: 6 | loss: 0.2539445
	speed: 0.0085s/iter; left time: 131.7812s
	iters: 500, epoch: 6 | loss: 0.0968543
	speed: 0.0083s/iter; left time: 128.9036s
	iters: 600, epoch: 6 | loss: 0.1092313
	speed: 0.0090s/iter; left time: 139.1591s
	iters: 700, epoch: 6 | loss: 0.3971148
	speed: 0.0082s/iter; left time: 124.6761s
	iters: 800, epoch: 6 | loss: 0.1404557
	speed: 0.0090s/iter; left time: 136.9060s
	iters: 900, epoch: 6 | loss: 0.2861205
	speed: 0.0082s/iter; left time: 123.1425s
	iters: 1000, epoch: 6 | loss: 0.3075228
	speed: 0.0095s/iter; left time: 142.3254s
Epoch: 6 cost time: 9.323408126831055
Epoch: 6, Steps: 1066 | Train Loss: 0.2103236 Vali Loss: 0.1418097 Test Loss: 0.2319656
Validation loss decreased (0.190537 --> 0.141810).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.1416328
	speed: 0.0332s/iter; left time: 492.0702s
	iters: 200, epoch: 7 | loss: 0.1136639
	speed: 0.0088s/iter; left time: 130.0667s
	iters: 300, epoch: 7 | loss: 0.1688935
	speed: 0.0094s/iter; left time: 138.1072s
	iters: 400, epoch: 7 | loss: 0.1387435
	speed: 0.0076s/iter; left time: 109.8089s
	iters: 500, epoch: 7 | loss: 0.1998828
	speed: 0.0076s/iter; left time: 108.9500s
	iters: 600, epoch: 7 | loss: 0.3302003
	speed: 0.0075s/iter; left time: 107.3375s
	iters: 700, epoch: 7 | loss: 0.1165285
	speed: 0.0081s/iter; left time: 115.8257s
	iters: 800, epoch: 7 | loss: 0.2939964
	speed: 0.0092s/iter; left time: 130.3838s
	iters: 900, epoch: 7 | loss: 0.1365858
	speed: 0.0081s/iter; left time: 114.3035s
	iters: 1000, epoch: 7 | loss: 0.2954077
	speed: 0.0077s/iter; left time: 107.1166s
Epoch: 7 cost time: 8.6202552318573
Epoch: 7, Steps: 1066 | Train Loss: 0.2052862 Vali Loss: 0.1532117 Test Loss: 0.2752125
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.1537131
	speed: 0.0337s/iter; left time: 464.0908s
	iters: 200, epoch: 8 | loss: 0.3104079
	speed: 0.0082s/iter; left time: 112.5577s
	iters: 300, epoch: 8 | loss: 0.1455250
	speed: 0.0072s/iter; left time: 97.8009s
	iters: 400, epoch: 8 | loss: 0.1505016
	speed: 0.0091s/iter; left time: 121.8320s
	iters: 500, epoch: 8 | loss: 0.2118032
	speed: 0.0091s/iter; left time: 121.3347s
	iters: 600, epoch: 8 | loss: 0.1406475
	speed: 0.0096s/iter; left time: 127.0470s
	iters: 700, epoch: 8 | loss: 0.2230977
	speed: 0.0083s/iter; left time: 109.0026s
	iters: 800, epoch: 8 | loss: 0.1796376
	speed: 0.0083s/iter; left time: 108.7902s
	iters: 900, epoch: 8 | loss: 0.1569457
	speed: 0.0083s/iter; left time: 107.6891s
	iters: 1000, epoch: 8 | loss: 0.1016971
	speed: 0.0084s/iter; left time: 107.6412s
Epoch: 8 cost time: 8.925854921340942
Epoch: 8, Steps: 1066 | Train Loss: 0.2022010 Vali Loss: 0.1234784 Test Loss: 0.1824406
Validation loss decreased (0.141810 --> 0.123478).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.2926958
	speed: 0.0404s/iter; left time: 513.4208s
	iters: 200, epoch: 9 | loss: 0.1572919
	speed: 0.0076s/iter; left time: 96.0999s
	iters: 300, epoch: 9 | loss: 0.1111377
	speed: 0.0080s/iter; left time: 99.3451s
	iters: 400, epoch: 9 | loss: 0.2386097
	speed: 0.0076s/iter; left time: 94.7147s
	iters: 500, epoch: 9 | loss: 0.1560249
	speed: 0.0081s/iter; left time: 99.4503s
	iters: 600, epoch: 9 | loss: 0.1510730
	speed: 0.0082s/iter; left time: 99.7708s
	iters: 700, epoch: 9 | loss: 0.2789275
	speed: 0.0078s/iter; left time: 94.4817s
	iters: 800, epoch: 9 | loss: 0.1406502
	speed: 0.0081s/iter; left time: 97.6327s
	iters: 900, epoch: 9 | loss: 0.1077649
	speed: 0.0086s/iter; left time: 102.0729s
	iters: 1000, epoch: 9 | loss: 0.1379077
	speed: 0.0080s/iter; left time: 94.5799s
Epoch: 9 cost time: 8.559920310974121
Epoch: 9, Steps: 1066 | Train Loss: 0.2004824 Vali Loss: 0.1357000 Test Loss: 0.2189463
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.2675898
	speed: 0.0364s/iter; left time: 422.7365s
	iters: 200, epoch: 10 | loss: 0.1909248
	speed: 0.0075s/iter; left time: 85.9007s
	iters: 300, epoch: 10 | loss: 0.1746835
	speed: 0.0081s/iter; left time: 92.5755s
	iters: 400, epoch: 10 | loss: 0.1210057
	speed: 0.0084s/iter; left time: 94.7002s
	iters: 500, epoch: 10 | loss: 0.1811202
	speed: 0.0094s/iter; left time: 105.9036s
	iters: 600, epoch: 10 | loss: 0.1002313
	speed: 0.0070s/iter; left time: 78.1152s
	iters: 700, epoch: 10 | loss: 0.1895284
	speed: 0.0091s/iter; left time: 100.5731s
	iters: 800, epoch: 10 | loss: 0.2689843
	speed: 0.0083s/iter; left time: 90.1693s
	iters: 900, epoch: 10 | loss: 0.3123344
	speed: 0.0085s/iter; left time: 91.8400s
	iters: 1000, epoch: 10 | loss: 0.2634787
	speed: 0.0067s/iter; left time: 72.3000s
Epoch: 10 cost time: 8.473828792572021
Epoch: 10, Steps: 1066 | Train Loss: 0.1996217 Vali Loss: 0.1296833 Test Loss: 0.2033545
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.1930719
	speed: 0.0322s/iter; left time: 340.5746s
	iters: 200, epoch: 11 | loss: 0.1508927
	speed: 0.0088s/iter; left time: 91.5393s
	iters: 300, epoch: 11 | loss: 0.1526566
	speed: 0.0080s/iter; left time: 82.7070s
	iters: 400, epoch: 11 | loss: 0.1423087
	speed: 0.0085s/iter; left time: 87.5526s
	iters: 500, epoch: 11 | loss: 0.1612132
	speed: 0.0083s/iter; left time: 83.8406s
	iters: 600, epoch: 11 | loss: 0.1866283
	speed: 0.0093s/iter; left time: 93.5721s
	iters: 700, epoch: 11 | loss: 0.3591453
	speed: 0.0088s/iter; left time: 87.8777s
	iters: 800, epoch: 11 | loss: 0.1432788
	speed: 0.0077s/iter; left time: 75.5716s
	iters: 900, epoch: 11 | loss: 0.4496811
	speed: 0.0090s/iter; left time: 88.2640s
	iters: 1000, epoch: 11 | loss: 0.1736700
	speed: 0.0084s/iter; left time: 80.8633s
Epoch: 11 cost time: 8.955092668533325
Epoch: 11, Steps: 1066 | Train Loss: 0.1991165 Vali Loss: 0.1292912 Test Loss: 0.2019115
EarlyStopping counter: 3 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.2434916
	speed: 0.0387s/iter; left time: 367.5633s
	iters: 200, epoch: 12 | loss: 0.1349952
	speed: 0.0090s/iter; left time: 84.6513s
	iters: 300, epoch: 12 | loss: 0.1708405
	speed: 0.0084s/iter; left time: 78.4669s
	iters: 400, epoch: 12 | loss: 0.2143813
	speed: 0.0077s/iter; left time: 70.8236s
	iters: 500, epoch: 12 | loss: 0.1472875
	speed: 0.0075s/iter; left time: 67.8367s
	iters: 600, epoch: 12 | loss: 0.2540348
	speed: 0.0076s/iter; left time: 68.6421s
	iters: 700, epoch: 12 | loss: 0.1192658
	speed: 0.0073s/iter; left time: 65.2291s
	iters: 800, epoch: 12 | loss: 0.2519722
	speed: 0.0092s/iter; left time: 80.6797s
	iters: 900, epoch: 12 | loss: 0.1513473
	speed: 0.0083s/iter; left time: 72.0155s
	iters: 1000, epoch: 12 | loss: 0.1196594
	speed: 0.0086s/iter; left time: 74.2455s
Epoch: 12 cost time: 8.725030183792114
Epoch: 12, Steps: 1066 | Train Loss: 0.1988387 Vali Loss: 0.1292137 Test Loss: 0.2019900
EarlyStopping counter: 4 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.2944798
	speed: 0.0332s/iter; left time: 279.6784s
	iters: 200, epoch: 13 | loss: 0.2008643
	speed: 0.0082s/iter; left time: 68.2289s
	iters: 300, epoch: 13 | loss: 0.4727483
	speed: 0.0077s/iter; left time: 63.1191s
	iters: 400, epoch: 13 | loss: 0.2269541
	speed: 0.0082s/iter; left time: 66.3458s
	iters: 500, epoch: 13 | loss: 0.3374961
	speed: 0.0087s/iter; left time: 69.7101s
	iters: 600, epoch: 13 | loss: 0.1651426
	speed: 0.0079s/iter; left time: 62.8281s
	iters: 700, epoch: 13 | loss: 0.0915289
	speed: 0.0078s/iter; left time: 61.4060s
	iters: 800, epoch: 13 | loss: 0.1399820
	speed: 0.0075s/iter; left time: 58.2802s
	iters: 900, epoch: 13 | loss: 0.3450776
	speed: 0.0077s/iter; left time: 58.7668s
	iters: 1000, epoch: 13 | loss: 0.3736461
	speed: 0.0087s/iter; left time: 65.4400s
Epoch: 13 cost time: 8.597368001937866
Epoch: 13, Steps: 1066 | Train Loss: 0.1987126 Vali Loss: 0.1310332 Test Loss: 0.2076574
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTm2_336_96_DLinear_ETTm2_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed25565<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.1827583909034729, mae:0.276951402425766
