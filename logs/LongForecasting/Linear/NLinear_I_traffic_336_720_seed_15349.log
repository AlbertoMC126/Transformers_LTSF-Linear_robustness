Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='NLinear', model_id='traffic_336_720', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=720, root_path='./dataset/', save_pred_values=False, seed=15349, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_336_720_NLinear_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15349>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11225
val 1037
test 2789
	iters: 100, epoch: 1 | loss: 0.8351035
	speed: 0.3504s/iter; left time: 4878.0700s
	iters: 200, epoch: 1 | loss: 1.0003616
	speed: 0.3332s/iter; left time: 4605.5450s
	iters: 300, epoch: 1 | loss: 0.9014723
	speed: 0.3337s/iter; left time: 4578.7368s
	iters: 400, epoch: 1 | loss: 0.9020935
	speed: 0.3348s/iter; left time: 4560.7123s
	iters: 500, epoch: 1 | loss: 1.0624696
	speed: 0.3333s/iter; left time: 4506.9235s
	iters: 600, epoch: 1 | loss: 1.4824656
	speed: 0.3344s/iter; left time: 4487.6442s
	iters: 700, epoch: 1 | loss: 1.1372786
	speed: 0.3335s/iter; left time: 4442.9536s
Epoch: 1 cost time: 235.8991985321045
Epoch: 1, Steps: 701 | Train Loss: 1.0969814 Vali Loss: 1.2827199 Test Loss: 1.3897697
Validation loss decreased (inf --> 1.282720).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.7197620
	speed: 0.6345s/iter; left time: 8387.6442s
	iters: 200, epoch: 2 | loss: 0.7114678
	speed: 0.3344s/iter; left time: 4386.7277s
	iters: 300, epoch: 2 | loss: 0.9341130
	speed: 0.3338s/iter; left time: 4346.0346s
	iters: 400, epoch: 2 | loss: 0.9413617
	speed: 0.3341s/iter; left time: 4316.4375s
	iters: 500, epoch: 2 | loss: 1.2192825
	speed: 0.3340s/iter; left time: 4282.0987s
	iters: 600, epoch: 2 | loss: 1.3656989
	speed: 0.3347s/iter; left time: 4256.7990s
	iters: 700, epoch: 2 | loss: 2.5238390
	speed: 0.3347s/iter; left time: 4224.0869s
Epoch: 2 cost time: 234.619291305542
Epoch: 2, Steps: 701 | Train Loss: 1.1914148 Vali Loss: 2.5627851 Test Loss: 2.5969634
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.4476114
	speed: 0.6186s/iter; left time: 7743.7322s
	iters: 200, epoch: 3 | loss: 0.3551834
	speed: 0.3336s/iter; left time: 4143.3862s
	iters: 300, epoch: 3 | loss: 0.3955231
	speed: 0.3341s/iter; left time: 4116.0363s
	iters: 400, epoch: 3 | loss: 0.3308694
	speed: 0.3342s/iter; left time: 4082.9948s
	iters: 500, epoch: 3 | loss: 0.3958651
	speed: 0.3341s/iter; left time: 4048.5500s
	iters: 600, epoch: 3 | loss: 0.3938867
	speed: 0.3420s/iter; left time: 4111.0250s
	iters: 700, epoch: 3 | loss: 0.4093669
	speed: 0.3351s/iter; left time: 3994.2149s
Epoch: 3 cost time: 235.08073472976685
Epoch: 3, Steps: 701 | Train Loss: 0.4372205 Vali Loss: 0.5292574 Test Loss: 0.6381339
Validation loss decreased (1.282720 --> 0.529257).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.3035492
	speed: 0.6317s/iter; left time: 7465.0867s
	iters: 200, epoch: 4 | loss: 0.3110838
	speed: 0.3393s/iter; left time: 3975.4517s
	iters: 300, epoch: 4 | loss: 0.3159223
	speed: 0.3367s/iter; left time: 3912.0631s
	iters: 400, epoch: 4 | loss: 0.3049453
	speed: 0.3342s/iter; left time: 3849.5180s
	iters: 500, epoch: 4 | loss: 0.3414940
	speed: 0.3329s/iter; left time: 3801.4406s
	iters: 600, epoch: 4 | loss: 0.3254763
	speed: 0.3330s/iter; left time: 3769.0673s
	iters: 700, epoch: 4 | loss: 0.3132546
	speed: 0.3345s/iter; left time: 3752.9551s
Epoch: 4 cost time: 235.31786513328552
Epoch: 4, Steps: 701 | Train Loss: 0.3181674 Vali Loss: 0.4723095 Test Loss: 0.5672860
Validation loss decreased (0.529257 --> 0.472309).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.3042179
	speed: 0.6291s/iter; left time: 6993.4339s
	iters: 200, epoch: 5 | loss: 0.2699732
	speed: 0.3397s/iter; left time: 3742.0420s
	iters: 300, epoch: 5 | loss: 0.2846925
	speed: 0.3382s/iter; left time: 3691.6152s
	iters: 400, epoch: 5 | loss: 0.3156656
	speed: 0.3444s/iter; left time: 3724.9997s
	iters: 500, epoch: 5 | loss: 0.3200395
	speed: 0.3370s/iter; left time: 3611.9293s
	iters: 600, epoch: 5 | loss: 0.2795820
	speed: 0.3344s/iter; left time: 3550.7456s
	iters: 700, epoch: 5 | loss: 0.2913074
	speed: 0.3353s/iter; left time: 3525.9345s
Epoch: 5 cost time: 237.08121395111084
Epoch: 5, Steps: 701 | Train Loss: 0.2966045 Vali Loss: 0.4351889 Test Loss: 0.5125099
Validation loss decreased (0.472309 --> 0.435189).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.2686443
	speed: 0.6290s/iter; left time: 6551.7317s
	iters: 200, epoch: 6 | loss: 0.2863984
	speed: 0.3386s/iter; left time: 3493.0933s
	iters: 300, epoch: 6 | loss: 0.2703709
	speed: 0.3362s/iter; left time: 3434.8611s
	iters: 400, epoch: 6 | loss: 0.2957647
	speed: 0.3370s/iter; left time: 3409.3337s
	iters: 500, epoch: 6 | loss: 0.2906680
	speed: 0.3367s/iter; left time: 3372.4738s
	iters: 600, epoch: 6 | loss: 0.2822649
	speed: 0.3337s/iter; left time: 3309.2280s
	iters: 700, epoch: 6 | loss: 0.2937712
	speed: 0.3343s/iter; left time: 3281.3280s
Epoch: 6 cost time: 235.96323657035828
Epoch: 6, Steps: 701 | Train Loss: 0.2862318 Vali Loss: 0.4219490 Test Loss: 0.4942366
Validation loss decreased (0.435189 --> 0.421949).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.2937945
	speed: 0.6303s/iter; left time: 6123.3501s
	iters: 200, epoch: 7 | loss: 0.2514049
	speed: 0.3388s/iter; left time: 3257.2989s
	iters: 300, epoch: 7 | loss: 0.2802467
	speed: 0.3435s/iter; left time: 3268.0074s
	iters: 400, epoch: 7 | loss: 0.2946543
	speed: 0.3356s/iter; left time: 3159.9814s
	iters: 500, epoch: 7 | loss: 0.2790733
	speed: 0.3360s/iter; left time: 3129.6089s
	iters: 600, epoch: 7 | loss: 0.2501440
	speed: 0.3349s/iter; left time: 3086.5297s
	iters: 700, epoch: 7 | loss: 0.2795403
	speed: 0.3353s/iter; left time: 3056.3042s
Epoch: 7 cost time: 236.76043462753296
Epoch: 7, Steps: 701 | Train Loss: 0.2804692 Vali Loss: 0.4153967 Test Loss: 0.4855399
Validation loss decreased (0.421949 --> 0.415397).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.2779231
	speed: 0.6278s/iter; left time: 5659.0330s
	iters: 200, epoch: 8 | loss: 0.2645958
	speed: 0.3365s/iter; left time: 2999.1732s
	iters: 300, epoch: 8 | loss: 0.2780740
	speed: 0.3377s/iter; left time: 2976.0804s
	iters: 400, epoch: 8 | loss: 0.2781004
	speed: 0.3362s/iter; left time: 2929.6358s
	iters: 500, epoch: 8 | loss: 0.2735055
	speed: 0.3343s/iter; left time: 2880.0414s
	iters: 600, epoch: 8 | loss: 0.2767336
	speed: 0.3352s/iter; left time: 2853.7150s
	iters: 700, epoch: 8 | loss: 0.2586920
	speed: 0.3365s/iter; left time: 2831.6678s
Epoch: 8 cost time: 235.84741735458374
Epoch: 8, Steps: 701 | Train Loss: 0.2771663 Vali Loss: 0.4117582 Test Loss: 0.4811140
Validation loss decreased (0.415397 --> 0.411758).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.3113933
	speed: 0.6342s/iter; left time: 5271.9403s
	iters: 200, epoch: 9 | loss: 0.2674365
	speed: 0.3370s/iter; left time: 2767.9342s
	iters: 300, epoch: 9 | loss: 0.2721217
	speed: 0.3348s/iter; left time: 2716.3220s
	iters: 400, epoch: 9 | loss: 0.2694485
	speed: 0.3341s/iter; left time: 2677.1774s
	iters: 500, epoch: 9 | loss: 0.2670470
	speed: 0.3334s/iter; left time: 2638.4075s
	iters: 600, epoch: 9 | loss: 0.2827753
	speed: 0.3334s/iter; left time: 2604.6722s
	iters: 700, epoch: 9 | loss: 0.2811515
	speed: 0.3335s/iter; left time: 2572.0138s
Epoch: 9 cost time: 234.79974246025085
Epoch: 9, Steps: 701 | Train Loss: 0.2752021 Vali Loss: 0.4101486 Test Loss: 0.4792992
Validation loss decreased (0.411758 --> 0.410149).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.2659136
	speed: 0.6272s/iter; left time: 4774.0482s
	iters: 200, epoch: 10 | loss: 0.2775449
	speed: 0.3370s/iter; left time: 2531.7472s
	iters: 300, epoch: 10 | loss: 0.2747440
	speed: 0.3348s/iter; left time: 2481.7308s
	iters: 400, epoch: 10 | loss: 0.2582422
	speed: 0.3342s/iter; left time: 2443.8941s
	iters: 500, epoch: 10 | loss: 0.2818309
	speed: 0.3379s/iter; left time: 2436.7683s
	iters: 600, epoch: 10 | loss: 0.2873294
	speed: 0.3421s/iter; left time: 2433.1400s
	iters: 700, epoch: 10 | loss: 0.2796359
	speed: 0.3368s/iter; left time: 2361.5079s
Epoch: 10 cost time: 236.41740775108337
Epoch: 10, Steps: 701 | Train Loss: 0.2740884 Vali Loss: 0.4093356 Test Loss: 0.4785846
Validation loss decreased (0.410149 --> 0.409336).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.2816020
	speed: 0.6301s/iter; left time: 4354.6759s
	iters: 200, epoch: 11 | loss: 0.2595176
	speed: 0.3394s/iter; left time: 2311.7859s
	iters: 300, epoch: 11 | loss: 0.2844641
	speed: 0.3370s/iter; left time: 2261.5346s
	iters: 400, epoch: 11 | loss: 0.2733024
	speed: 0.3377s/iter; left time: 2232.7665s
	iters: 500, epoch: 11 | loss: 0.2678280
	speed: 0.3376s/iter; left time: 2198.1017s
	iters: 600, epoch: 11 | loss: 0.2707947
	speed: 0.3381s/iter; left time: 2167.3315s
	iters: 700, epoch: 11 | loss: 0.2698657
	speed: 0.3374s/iter; left time: 2129.2095s
Epoch: 11 cost time: 237.1110076904297
Epoch: 11, Steps: 701 | Train Loss: 0.2734117 Vali Loss: 0.4090509 Test Loss: 0.4778505
Validation loss decreased (0.409336 --> 0.409051).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.2439141
	speed: 0.6328s/iter; left time: 3929.7934s
	iters: 200, epoch: 12 | loss: 0.2566133
	speed: 0.3398s/iter; left time: 2076.0461s
	iters: 300, epoch: 12 | loss: 0.2658064
	speed: 0.3407s/iter; left time: 2047.6820s
	iters: 400, epoch: 12 | loss: 0.2839542
	speed: 0.3387s/iter; left time: 2001.4633s
	iters: 500, epoch: 12 | loss: 0.3015616
	speed: 0.3360s/iter; left time: 1952.2349s
	iters: 600, epoch: 12 | loss: 0.2782560
	speed: 0.3365s/iter; left time: 1921.3465s
	iters: 700, epoch: 12 | loss: 0.2744576
	speed: 0.3356s/iter; left time: 1882.5229s
Epoch: 12 cost time: 237.12730145454407
Epoch: 12, Steps: 701 | Train Loss: 0.2731097 Vali Loss: 0.4089664 Test Loss: 0.4775408
Validation loss decreased (0.409051 --> 0.408966).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.2896034
	speed: 0.6269s/iter; left time: 3453.5183s
	iters: 200, epoch: 13 | loss: 0.2726898
	speed: 0.3378s/iter; left time: 1827.0970s
	iters: 300, epoch: 13 | loss: 0.3221065
	speed: 0.3349s/iter; left time: 1778.1422s
	iters: 400, epoch: 13 | loss: 0.2670465
	speed: 0.3341s/iter; left time: 1740.4474s
	iters: 500, epoch: 13 | loss: 0.2677718
	speed: 0.3358s/iter; left time: 1715.7032s
	iters: 600, epoch: 13 | loss: 0.2597087
	speed: 0.3364s/iter; left time: 1684.8244s
	iters: 700, epoch: 13 | loss: 0.2528127
	speed: 0.3347s/iter; left time: 1643.2520s
Epoch: 13 cost time: 235.38496565818787
Epoch: 13, Steps: 701 | Train Loss: 0.2729045 Vali Loss: 0.4088477 Test Loss: 0.4773411
Validation loss decreased (0.408966 --> 0.408848).  Saving model ...
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 14 | loss: 0.2557810
	speed: 0.6315s/iter; left time: 3036.2268s
	iters: 200, epoch: 14 | loss: 0.2665416
	speed: 0.3437s/iter; left time: 1618.0876s
	iters: 300, epoch: 14 | loss: 0.2713307
	speed: 0.3379s/iter; left time: 1556.9304s
	iters: 400, epoch: 14 | loss: 0.2764077
	speed: 0.3384s/iter; left time: 1525.5481s
	iters: 500, epoch: 14 | loss: 0.2762111
	speed: 0.3370s/iter; left time: 1485.5695s
	iters: 600, epoch: 14 | loss: 0.2734165
	speed: 0.3357s/iter; left time: 1446.2537s
	iters: 700, epoch: 14 | loss: 0.2770621
	speed: 0.3382s/iter; left time: 1423.0113s
Epoch: 14 cost time: 237.63673424720764
Epoch: 14, Steps: 701 | Train Loss: 0.2727995 Vali Loss: 0.4085306 Test Loss: 0.4772485
Validation loss decreased (0.408848 --> 0.408531).  Saving model ...
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 15 | loss: 0.2732651
	speed: 0.6332s/iter; left time: 2600.7387s
	iters: 200, epoch: 15 | loss: 0.2575462
	speed: 0.3394s/iter; left time: 1359.8154s
	iters: 300, epoch: 15 | loss: 0.2503966
	speed: 0.3364s/iter; left time: 1314.2733s
	iters: 400, epoch: 15 | loss: 0.2807237
	speed: 0.3345s/iter; left time: 1273.3141s
	iters: 500, epoch: 15 | loss: 0.2504144
	speed: 0.3341s/iter; left time: 1238.4521s
	iters: 600, epoch: 15 | loss: 0.2688753
	speed: 0.3349s/iter; left time: 1207.9865s
	iters: 700, epoch: 15 | loss: 0.3045015
	speed: 0.3336s/iter; left time: 1169.9312s
Epoch: 15 cost time: 235.8300416469574
Epoch: 15, Steps: 701 | Train Loss: 0.2727283 Vali Loss: 0.4086362 Test Loss: 0.4772265
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 16 | loss: 0.2655395
	speed: 0.6202s/iter; left time: 2112.3044s
	iters: 200, epoch: 16 | loss: 0.2606106
	speed: 0.3360s/iter; left time: 1110.8661s
	iters: 300, epoch: 16 | loss: 0.2853374
	speed: 0.3343s/iter; left time: 1071.8413s
	iters: 400, epoch: 16 | loss: 0.2614761
	speed: 0.3353s/iter; left time: 1041.4878s
	iters: 500, epoch: 16 | loss: 0.2774881
	speed: 0.3351s/iter; left time: 1007.2685s
	iters: 600, epoch: 16 | loss: 0.2755359
	speed: 0.3353s/iter; left time: 974.3017s
	iters: 700, epoch: 16 | loss: 0.2489632
	speed: 0.3345s/iter; left time: 938.5309s
Epoch: 16 cost time: 235.01628589630127
Epoch: 16, Steps: 701 | Train Loss: 0.2727105 Vali Loss: 0.4088025 Test Loss: 0.4772296
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 17 | loss: 0.2702702
	speed: 0.6188s/iter; left time: 1673.7828s
	iters: 200, epoch: 17 | loss: 0.2760405
	speed: 0.3339s/iter; left time: 869.7184s
	iters: 300, epoch: 17 | loss: 0.2691189
	speed: 0.3338s/iter; left time: 836.2682s
	iters: 400, epoch: 17 | loss: 0.2595382
	speed: 0.3334s/iter; left time: 801.7734s
	iters: 500, epoch: 17 | loss: 0.2751056
	speed: 0.3338s/iter; left time: 769.5038s
	iters: 600, epoch: 17 | loss: 0.2660160
	speed: 0.3335s/iter; left time: 735.3660s
	iters: 700, epoch: 17 | loss: 0.2540248
	speed: 0.3334s/iter; left time: 701.8578s
Epoch: 17 cost time: 234.10244059562683
Epoch: 17, Steps: 701 | Train Loss: 0.2726903 Vali Loss: 0.4089290 Test Loss: 0.4772257
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 18 | loss: 0.2952136
	speed: 0.6188s/iter; left time: 1239.9815s
	iters: 200, epoch: 18 | loss: 0.2706745
	speed: 0.3340s/iter; left time: 635.9824s
	iters: 300, epoch: 18 | loss: 0.2700772
	speed: 0.3352s/iter; left time: 604.7074s
	iters: 400, epoch: 18 | loss: 0.2708448
	speed: 0.3347s/iter; left time: 570.3444s
	iters: 500, epoch: 18 | loss: 0.2577349
	speed: 0.3357s/iter; left time: 538.4554s
	iters: 600, epoch: 18 | loss: 0.2707057
	speed: 0.3354s/iter; left time: 504.4296s
	iters: 700, epoch: 18 | loss: 0.2935230
	speed: 0.3353s/iter; left time: 470.8147s
Epoch: 18 cost time: 234.90587639808655
Epoch: 18, Steps: 701 | Train Loss: 0.2726753 Vali Loss: 0.4087076 Test Loss: 0.4772274
EarlyStopping counter: 4 out of 5
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 19 | loss: 0.2975446
	speed: 0.6233s/iter; left time: 812.1835s
	iters: 200, epoch: 19 | loss: 0.2731180
	speed: 0.3355s/iter; left time: 403.6291s
	iters: 300, epoch: 19 | loss: 0.2977879
	speed: 0.3345s/iter; left time: 368.9927s
	iters: 400, epoch: 19 | loss: 0.2600916
	speed: 0.3331s/iter; left time: 334.1167s
	iters: 500, epoch: 19 | loss: 0.2790788
	speed: 0.3334s/iter; left time: 301.0483s
	iters: 600, epoch: 19 | loss: 0.2703637
	speed: 0.3331s/iter; left time: 267.5060s
	iters: 700, epoch: 19 | loss: 0.2919615
	speed: 0.3332s/iter; left time: 234.2101s
Epoch: 19 cost time: 234.60611271858215
Epoch: 19, Steps: 701 | Train Loss: 0.2726707 Vali Loss: 0.4083935 Test Loss: 0.4772272
Validation loss decreased (0.408531 --> 0.408394).  Saving model ...
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 20 | loss: 0.2652818
	speed: 0.6246s/iter; left time: 376.0367s
	iters: 200, epoch: 20 | loss: 0.2661559
	speed: 0.3363s/iter; left time: 168.8024s
	iters: 300, epoch: 20 | loss: 0.2651708
	speed: 0.3341s/iter; left time: 134.3024s
	iters: 400, epoch: 20 | loss: 0.2701873
	speed: 0.3342s/iter; left time: 100.9180s
	iters: 500, epoch: 20 | loss: 0.2816004
	speed: 0.3342s/iter; left time: 67.5056s
	iters: 600, epoch: 20 | loss: 0.2562684
	speed: 0.3356s/iter; left time: 34.2268s
	iters: 700, epoch: 20 | loss: 0.2761972
	speed: 0.3352s/iter; left time: 0.6704s
Epoch: 20 cost time: 234.81019258499146
Epoch: 20, Steps: 701 | Train Loss: 0.2726651 Vali Loss: 0.4083518 Test Loss: 0.4772270
Validation loss decreased (0.408394 --> 0.408352).  Saving model ...
Updating learning rate to 1.9073486328125e-08
>>>>>>>testing : traffic_336_720_NLinear_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15349<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2789
mse:0.47704780101776123, mae:0.3218758702278137
