Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='Linear', model_id='traffic_336_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=336, root_path='./dataset/', save_pred_values=False, seed=15227, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_336_336_Linear_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15227>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11609
val 1421
test 3173
	iters: 100, epoch: 1 | loss: 0.4533897
	speed: 0.3274s/iter; left time: 4714.3513s
	iters: 200, epoch: 1 | loss: 0.4637783
	speed: 0.3126s/iter; left time: 4469.9803s
	iters: 300, epoch: 1 | loss: 0.4698389
	speed: 0.3117s/iter; left time: 4425.9716s
	iters: 400, epoch: 1 | loss: 0.4823989
	speed: 0.3116s/iter; left time: 4393.5709s
	iters: 500, epoch: 1 | loss: 0.5030977
	speed: 0.3114s/iter; left time: 4359.6476s
	iters: 600, epoch: 1 | loss: 0.4904214
	speed: 0.3120s/iter; left time: 4337.7903s
	iters: 700, epoch: 1 | loss: 0.4823064
	speed: 0.3111s/iter; left time: 4293.2497s
Epoch: 1 cost time: 227.69713687896729
Epoch: 1, Steps: 725 | Train Loss: 0.4925233 Vali Loss: 0.6492937 Test Loss: 0.7748238
Validation loss decreased (inf --> 0.649294).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.5091270
	speed: 0.6126s/iter; left time: 8377.6861s
	iters: 200, epoch: 2 | loss: 0.4976619
	speed: 0.3128s/iter; left time: 4246.6382s
	iters: 300, epoch: 2 | loss: 0.4726261
	speed: 0.3163s/iter; left time: 4261.8582s
	iters: 400, epoch: 2 | loss: 0.4736373
	speed: 0.3133s/iter; left time: 4190.1559s
	iters: 500, epoch: 2 | loss: 0.4446379
	speed: 0.3129s/iter; left time: 4154.5818s
	iters: 600, epoch: 2 | loss: 0.4902636
	speed: 0.3119s/iter; left time: 4109.2652s
	iters: 700, epoch: 2 | loss: 0.5164713
	speed: 0.3123s/iter; left time: 4083.2615s
Epoch: 2 cost time: 226.95354390144348
Epoch: 2, Steps: 725 | Train Loss: 0.4863492 Vali Loss: 0.6564123 Test Loss: 0.7884346
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.3580289
	speed: 0.6112s/iter; left time: 7916.1112s
	iters: 200, epoch: 3 | loss: 0.3330001
	speed: 0.3118s/iter; left time: 4006.5506s
	iters: 300, epoch: 3 | loss: 0.3311002
	speed: 0.3115s/iter; left time: 3971.9930s
	iters: 400, epoch: 3 | loss: 0.3466313
	speed: 0.3122s/iter; left time: 3949.5403s
	iters: 500, epoch: 3 | loss: 0.3248239
	speed: 0.3126s/iter; left time: 3923.8734s
	iters: 600, epoch: 3 | loss: 0.3243604
	speed: 0.3142s/iter; left time: 3912.6101s
	iters: 700, epoch: 3 | loss: 0.3617278
	speed: 0.3131s/iter; left time: 3867.1520s
Epoch: 3 cost time: 226.59631276130676
Epoch: 3, Steps: 725 | Train Loss: 0.3430644 Vali Loss: 0.4700913 Test Loss: 0.5703302
Validation loss decreased (0.649294 --> 0.470091).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.2704601
	speed: 0.6166s/iter; left time: 7538.4251s
	iters: 200, epoch: 4 | loss: 0.2906029
	speed: 0.3126s/iter; left time: 3790.1094s
	iters: 300, epoch: 4 | loss: 0.3105447
	speed: 0.3125s/iter; left time: 3758.3662s
	iters: 400, epoch: 4 | loss: 0.2778365
	speed: 0.3114s/iter; left time: 3713.5508s
	iters: 500, epoch: 4 | loss: 0.3101924
	speed: 0.3140s/iter; left time: 3713.4228s
	iters: 600, epoch: 4 | loss: 0.3083052
	speed: 0.3129s/iter; left time: 3668.6633s
	iters: 700, epoch: 4 | loss: 0.3326540
	speed: 0.3127s/iter; left time: 3635.5001s
Epoch: 4 cost time: 226.816752910614
Epoch: 4, Steps: 725 | Train Loss: 0.2936594 Vali Loss: 0.4166917 Test Loss: 0.5087739
Validation loss decreased (0.470091 --> 0.416692).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.2612926
	speed: 0.6186s/iter; left time: 7114.5449s
	iters: 200, epoch: 5 | loss: 0.2674243
	speed: 0.3118s/iter; left time: 3555.0329s
	iters: 300, epoch: 5 | loss: 0.2589704
	speed: 0.3114s/iter; left time: 3519.6666s
	iters: 400, epoch: 5 | loss: 0.2837101
	speed: 0.3129s/iter; left time: 3504.3421s
	iters: 500, epoch: 5 | loss: 0.2971867
	speed: 0.3116s/iter; left time: 3458.7014s
	iters: 600, epoch: 5 | loss: 0.2715384
	speed: 0.3112s/iter; left time: 3423.6729s
	iters: 700, epoch: 5 | loss: 0.2894327
	speed: 0.3125s/iter; left time: 3406.2398s
Epoch: 5 cost time: 226.45325899124146
Epoch: 5, Steps: 725 | Train Loss: 0.2723563 Vali Loss: 0.3928760 Test Loss: 0.4793591
Validation loss decreased (0.416692 --> 0.392876).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.2360029
	speed: 0.6155s/iter; left time: 6633.0156s
	iters: 200, epoch: 6 | loss: 0.2819140
	speed: 0.3131s/iter; left time: 3342.7351s
	iters: 300, epoch: 6 | loss: 0.2549431
	speed: 0.3130s/iter; left time: 3310.2247s
	iters: 400, epoch: 6 | loss: 0.2580809
	speed: 0.3135s/iter; left time: 3284.3009s
	iters: 500, epoch: 6 | loss: 0.2625544
	speed: 0.3123s/iter; left time: 3239.9442s
	iters: 600, epoch: 6 | loss: 0.2390738
	speed: 0.3131s/iter; left time: 3217.8505s
	iters: 700, epoch: 6 | loss: 0.2546962
	speed: 0.3119s/iter; left time: 3174.2995s
Epoch: 6 cost time: 226.94564580917358
Epoch: 6, Steps: 725 | Train Loss: 0.2612395 Vali Loss: 0.3808764 Test Loss: 0.4657153
Validation loss decreased (0.392876 --> 0.380876).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.2467409
	speed: 0.6158s/iter; left time: 6189.5804s
	iters: 200, epoch: 7 | loss: 0.2582865
	speed: 0.3126s/iter; left time: 3110.5366s
	iters: 300, epoch: 7 | loss: 0.2423830
	speed: 0.3114s/iter; left time: 3067.6899s
	iters: 400, epoch: 7 | loss: 0.2550775
	speed: 0.3126s/iter; left time: 3047.9413s
	iters: 500, epoch: 7 | loss: 0.2559168
	speed: 0.3131s/iter; left time: 3021.7166s
	iters: 600, epoch: 7 | loss: 0.2634707
	speed: 0.3119s/iter; left time: 2978.6747s
	iters: 700, epoch: 7 | loss: 0.2474989
	speed: 0.3121s/iter; left time: 2949.8161s
Epoch: 7 cost time: 226.57728576660156
Epoch: 7, Steps: 725 | Train Loss: 0.2552396 Vali Loss: 0.3763295 Test Loss: 0.4593289
Validation loss decreased (0.380876 --> 0.376330).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.2287496
	speed: 0.6159s/iter; left time: 5744.1565s
	iters: 200, epoch: 8 | loss: 0.2505182
	speed: 0.3124s/iter; left time: 2881.9913s
	iters: 300, epoch: 8 | loss: 0.2571054
	speed: 0.3140s/iter; left time: 2865.7296s
	iters: 400, epoch: 8 | loss: 0.2578298
	speed: 0.3123s/iter; left time: 2818.7230s
	iters: 500, epoch: 8 | loss: 0.2291518
	speed: 0.3125s/iter; left time: 2789.3973s
	iters: 600, epoch: 8 | loss: 0.2546075
	speed: 0.3116s/iter; left time: 2750.3540s
	iters: 700, epoch: 8 | loss: 0.2663331
	speed: 0.3112s/iter; left time: 2715.2938s
Epoch: 8 cost time: 226.49823904037476
Epoch: 8, Steps: 725 | Train Loss: 0.2519113 Vali Loss: 0.3729860 Test Loss: 0.4559388
Validation loss decreased (0.376330 --> 0.372986).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.2338924
	speed: 0.6153s/iter; left time: 5292.5176s
	iters: 200, epoch: 9 | loss: 0.2545031
	speed: 0.3115s/iter; left time: 2648.0563s
	iters: 300, epoch: 9 | loss: 0.2650235
	speed: 0.3108s/iter; left time: 2610.7862s
	iters: 400, epoch: 9 | loss: 0.2467771
	speed: 0.3118s/iter; left time: 2588.4695s
	iters: 500, epoch: 9 | loss: 0.2517655
	speed: 0.3124s/iter; left time: 2561.9431s
	iters: 600, epoch: 9 | loss: 0.2503304
	speed: 0.3118s/iter; left time: 2525.6393s
	iters: 700, epoch: 9 | loss: 0.2740062
	speed: 0.3128s/iter; left time: 2502.4458s
Epoch: 9 cost time: 226.277930021286
Epoch: 9, Steps: 725 | Train Loss: 0.2500710 Vali Loss: 0.3717754 Test Loss: 0.4542724
Validation loss decreased (0.372986 --> 0.371775).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.2500291
	speed: 0.6203s/iter; left time: 4885.8362s
	iters: 200, epoch: 10 | loss: 0.2512614
	speed: 0.3130s/iter; left time: 2433.5503s
	iters: 300, epoch: 10 | loss: 0.2356720
	speed: 0.3127s/iter; left time: 2399.9350s
	iters: 400, epoch: 10 | loss: 0.2519289
	speed: 0.3129s/iter; left time: 2370.3049s
	iters: 500, epoch: 10 | loss: 0.2464626
	speed: 0.3121s/iter; left time: 2333.0870s
	iters: 600, epoch: 10 | loss: 0.2484319
	speed: 0.3120s/iter; left time: 2301.5896s
	iters: 700, epoch: 10 | loss: 0.2636809
	speed: 0.3125s/iter; left time: 2273.4579s
Epoch: 10 cost time: 226.91801285743713
Epoch: 10, Steps: 725 | Train Loss: 0.2490634 Vali Loss: 0.3712276 Test Loss: 0.4538360
Validation loss decreased (0.371775 --> 0.371228).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.2556070
	speed: 0.6163s/iter; left time: 4407.2806s
	iters: 200, epoch: 11 | loss: 0.2487187
	speed: 0.3140s/iter; left time: 2214.2775s
	iters: 300, epoch: 11 | loss: 0.2265300
	speed: 0.3140s/iter; left time: 2182.3518s
	iters: 400, epoch: 11 | loss: 0.2398627
	speed: 0.3127s/iter; left time: 2142.4862s
	iters: 500, epoch: 11 | loss: 0.2826804
	speed: 0.3124s/iter; left time: 2109.0895s
	iters: 600, epoch: 11 | loss: 0.2726110
	speed: 0.3122s/iter; left time: 2076.1814s
	iters: 700, epoch: 11 | loss: 0.2244067
	speed: 0.3119s/iter; left time: 2042.9337s
Epoch: 11 cost time: 226.8486065864563
Epoch: 11, Steps: 725 | Train Loss: 0.2485438 Vali Loss: 0.3705613 Test Loss: 0.4533899
Validation loss decreased (0.371228 --> 0.370561).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.2557275
	speed: 0.6145s/iter; left time: 3949.0097s
	iters: 200, epoch: 12 | loss: 0.2564407
	speed: 0.3128s/iter; left time: 1978.5922s
	iters: 300, epoch: 12 | loss: 0.2446091
	speed: 0.3115s/iter; left time: 1939.5211s
	iters: 400, epoch: 12 | loss: 0.2504609
	speed: 0.3125s/iter; left time: 1914.1523s
	iters: 500, epoch: 12 | loss: 0.2341248
	speed: 0.3152s/iter; left time: 1899.1174s
	iters: 600, epoch: 12 | loss: 0.2533286
	speed: 0.3123s/iter; left time: 1850.4998s
	iters: 700, epoch: 12 | loss: 0.2522080
	speed: 0.3124s/iter; left time: 1819.8448s
Epoch: 12 cost time: 226.8228063583374
Epoch: 12, Steps: 725 | Train Loss: 0.2482499 Vali Loss: 0.3704831 Test Loss: 0.4532988
Validation loss decreased (0.370561 --> 0.370483).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.2261358
	speed: 0.6177s/iter; left time: 3521.5756s
	iters: 200, epoch: 13 | loss: 0.2645158
	speed: 0.3128s/iter; left time: 1752.2230s
	iters: 300, epoch: 13 | loss: 0.2470263
	speed: 0.3125s/iter; left time: 1719.1229s
	iters: 400, epoch: 13 | loss: 0.2427282
	speed: 0.3136s/iter; left time: 1693.9570s
	iters: 500, epoch: 13 | loss: 0.2671311
	speed: 0.3118s/iter; left time: 1652.6814s
	iters: 600, epoch: 13 | loss: 0.2529189
	speed: 0.3115s/iter; left time: 1619.9547s
	iters: 700, epoch: 13 | loss: 0.2304387
	speed: 0.3131s/iter; left time: 1596.9884s
Epoch: 13 cost time: 226.82386088371277
Epoch: 13, Steps: 725 | Train Loss: 0.2480897 Vali Loss: 0.3707668 Test Loss: 0.4533064
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 14 | loss: 0.2510953
	speed: 0.6112s/iter; left time: 3041.3950s
	iters: 200, epoch: 14 | loss: 0.2509124
	speed: 0.3131s/iter; left time: 1526.7614s
	iters: 300, epoch: 14 | loss: 0.2562656
	speed: 0.3123s/iter; left time: 1491.6584s
	iters: 400, epoch: 14 | loss: 0.2306039
	speed: 0.3120s/iter; left time: 1459.0307s
	iters: 500, epoch: 14 | loss: 0.2865863
	speed: 0.3136s/iter; left time: 1435.1204s
	iters: 600, epoch: 14 | loss: 0.2485642
	speed: 0.3139s/iter; left time: 1405.2269s
	iters: 700, epoch: 14 | loss: 0.2425779
	speed: 0.3123s/iter; left time: 1366.4063s
Epoch: 14 cost time: 226.71536207199097
Epoch: 14, Steps: 725 | Train Loss: 0.2480213 Vali Loss: 0.3707508 Test Loss: 0.4532530
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 15 | loss: 0.2357416
	speed: 0.6119s/iter; left time: 2600.9764s
	iters: 200, epoch: 15 | loss: 0.2483243
	speed: 0.3117s/iter; left time: 1293.8254s
	iters: 300, epoch: 15 | loss: 0.2634437
	speed: 0.3124s/iter; left time: 1265.4425s
	iters: 400, epoch: 15 | loss: 0.2285480
	speed: 0.3131s/iter; left time: 1237.0842s
	iters: 500, epoch: 15 | loss: 0.2545209
	speed: 0.3131s/iter; left time: 1205.8390s
	iters: 600, epoch: 15 | loss: 0.2363431
	speed: 0.3132s/iter; left time: 1174.7030s
	iters: 700, epoch: 15 | loss: 0.2442750
	speed: 0.3143s/iter; left time: 1147.6550s
Epoch: 15 cost time: 226.91552782058716
Epoch: 15, Steps: 725 | Train Loss: 0.2479634 Vali Loss: 0.3708039 Test Loss: 0.4532496
EarlyStopping counter: 3 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 16 | loss: 0.2300877
	speed: 0.6134s/iter; left time: 2162.9152s
	iters: 200, epoch: 16 | loss: 0.2523051
	speed: 0.3138s/iter; left time: 1074.9272s
	iters: 300, epoch: 16 | loss: 0.2234104
	speed: 0.3142s/iter; left time: 1045.1766s
	iters: 400, epoch: 16 | loss: 0.2203734
	speed: 0.3130s/iter; left time: 1009.7780s
	iters: 500, epoch: 16 | loss: 0.2499248
	speed: 0.3135s/iter; left time: 980.1203s
	iters: 600, epoch: 16 | loss: 0.2356181
	speed: 0.3143s/iter; left time: 951.0130s
	iters: 700, epoch: 16 | loss: 0.2608162
	speed: 0.3129s/iter; left time: 915.6018s
Epoch: 16 cost time: 227.35435342788696
Epoch: 16, Steps: 725 | Train Loss: 0.2479354 Vali Loss: 0.3708579 Test Loss: 0.4532498
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 17 | loss: 0.2520693
	speed: 0.6102s/iter; left time: 1709.0585s
	iters: 200, epoch: 17 | loss: 0.2538711
	speed: 0.3127s/iter; left time: 844.5376s
	iters: 300, epoch: 17 | loss: 0.2545688
	speed: 0.3116s/iter; left time: 810.4156s
	iters: 400, epoch: 17 | loss: 0.2565005
	speed: 0.3122s/iter; left time: 780.8280s
	iters: 500, epoch: 17 | loss: 0.2354943
	speed: 0.3133s/iter; left time: 752.1902s
	iters: 600, epoch: 17 | loss: 0.2473727
	speed: 0.3128s/iter; left time: 719.7270s
	iters: 700, epoch: 17 | loss: 0.2395383
	speed: 0.3121s/iter; left time: 686.8442s
Epoch: 17 cost time: 226.61522364616394
Epoch: 17, Steps: 725 | Train Loss: 0.2479259 Vali Loss: 0.3704710 Test Loss: 0.4532496
Validation loss decreased (0.370483 --> 0.370471).  Saving model ...
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 18 | loss: 0.2592497
	speed: 0.6190s/iter; left time: 1285.0255s
	iters: 200, epoch: 18 | loss: 0.2382336
	speed: 0.3130s/iter; left time: 618.5217s
	iters: 300, epoch: 18 | loss: 0.2364990
	speed: 0.3131s/iter; left time: 587.4192s
	iters: 400, epoch: 18 | loss: 0.2251973
	speed: 0.3133s/iter; left time: 556.4558s
	iters: 500, epoch: 18 | loss: 0.2497104
	speed: 0.3117s/iter; left time: 522.3975s
	iters: 600, epoch: 18 | loss: 0.2574485
	speed: 0.3116s/iter; left time: 491.0920s
	iters: 700, epoch: 18 | loss: 0.2441101
	speed: 0.3117s/iter; left time: 460.0516s
Epoch: 18 cost time: 226.8781681060791
Epoch: 18, Steps: 725 | Train Loss: 0.2479141 Vali Loss: 0.3705242 Test Loss: 0.4532491
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 19 | loss: 0.2351485
	speed: 0.6125s/iter; left time: 827.4270s
	iters: 200, epoch: 19 | loss: 0.2459593
	speed: 0.3134s/iter; left time: 392.0445s
	iters: 300, epoch: 19 | loss: 0.2474106
	speed: 0.3130s/iter; left time: 360.2853s
	iters: 400, epoch: 19 | loss: 0.2580402
	speed: 0.3135s/iter; left time: 329.4883s
	iters: 500, epoch: 19 | loss: 0.2336860
	speed: 0.3128s/iter; left time: 297.4679s
	iters: 600, epoch: 19 | loss: 0.2326641
	speed: 0.3128s/iter; left time: 266.1510s
	iters: 700, epoch: 19 | loss: 0.2394814
	speed: 0.3131s/iter; left time: 235.1306s
Epoch: 19 cost time: 226.95909142494202
Epoch: 19, Steps: 725 | Train Loss: 0.2479345 Vali Loss: 0.3706100 Test Loss: 0.4532491
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 20 | loss: 0.2297886
	speed: 0.6132s/iter; left time: 383.8451s
	iters: 200, epoch: 20 | loss: 0.2490483
	speed: 0.3123s/iter; left time: 164.2518s
	iters: 300, epoch: 20 | loss: 0.2380023
	speed: 0.3124s/iter; left time: 133.0941s
	iters: 400, epoch: 20 | loss: 0.2380009
	speed: 0.3129s/iter; left time: 101.9989s
	iters: 500, epoch: 20 | loss: 0.2662607
	speed: 0.3124s/iter; left time: 70.6002s
	iters: 600, epoch: 20 | loss: 0.2642354
	speed: 0.3120s/iter; left time: 39.3070s
	iters: 700, epoch: 20 | loss: 0.2377225
	speed: 0.3121s/iter; left time: 8.1151s
Epoch: 20 cost time: 226.6337959766388
Epoch: 20, Steps: 725 | Train Loss: 0.2479295 Vali Loss: 0.3710103 Test Loss: 0.4532490
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.9073486328125e-08
>>>>>>>testing : traffic_336_336_Linear_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15227<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3173
mse:0.45227476954460144, mae:0.3119924068450928
