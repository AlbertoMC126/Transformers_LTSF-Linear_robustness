Args in experiment:
Namespace(activation='gelu', batch_size=8, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='exchange_rate.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=8, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='mse', lradj='type1', model='NLinear', model_id='Exchange_336_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=15349, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : Exchange_336_96_NLinear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15349>>>>>>>>>>>>>>>>>>>>>>>>>>
train 4880
val 665
test 1422
	iters: 100, epoch: 1 | loss: 0.0909471
	speed: 0.0029s/iter; left time: 35.3569s
	iters: 200, epoch: 1 | loss: 0.1681415
	speed: 0.0024s/iter; left time: 29.1624s
	iters: 300, epoch: 1 | loss: 0.3383104
	speed: 0.0032s/iter; left time: 38.3213s
	iters: 400, epoch: 1 | loss: 0.1479398
	speed: 0.0028s/iter; left time: 33.3043s
	iters: 500, epoch: 1 | loss: 0.0871368
	speed: 0.0037s/iter; left time: 43.2850s
	iters: 600, epoch: 1 | loss: 0.0753384
	speed: 0.0038s/iter; left time: 43.9676s
Epoch: 1 cost time: 1.9263253211975098
Epoch: 1, Steps: 610 | Train Loss: 0.1244351 Vali Loss: 0.1441697 Test Loss: 0.0955880
Validation loss decreased (inf --> 0.144170).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.0824676
	speed: 0.0056s/iter; left time: 63.7999s
	iters: 200, epoch: 2 | loss: 0.1237290
	speed: 0.0036s/iter; left time: 41.3493s
	iters: 300, epoch: 2 | loss: 0.1676878
	speed: 0.0030s/iter; left time: 34.2116s
	iters: 400, epoch: 2 | loss: 0.1394334
	speed: 0.0031s/iter; left time: 34.2652s
	iters: 500, epoch: 2 | loss: 0.0996876
	speed: 0.0029s/iter; left time: 31.6149s
	iters: 600, epoch: 2 | loss: 0.1758092
	speed: 0.0033s/iter; left time: 35.7208s
Epoch: 2 cost time: 1.9214491844177246
Epoch: 2, Steps: 610 | Train Loss: 0.1202551 Vali Loss: 0.1482700 Test Loss: 0.0987152
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.0785346
	speed: 0.0050s/iter; left time: 54.5416s
	iters: 200, epoch: 3 | loss: 0.0572981
	speed: 0.0029s/iter; left time: 31.1571s
	iters: 300, epoch: 3 | loss: 0.1133492
	speed: 0.0024s/iter; left time: 25.5324s
	iters: 400, epoch: 3 | loss: 0.0531197
	speed: 0.0028s/iter; left time: 29.4380s
	iters: 500, epoch: 3 | loss: 0.1033813
	speed: 0.0037s/iter; left time: 38.2558s
	iters: 600, epoch: 3 | loss: 0.1091233
	speed: 0.0035s/iter; left time: 36.2296s
Epoch: 3 cost time: 1.8482601642608643
Epoch: 3, Steps: 610 | Train Loss: 0.1156840 Vali Loss: 0.1427728 Test Loss: 0.0964570
Validation loss decreased (0.144170 --> 0.142773).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.0681325
	speed: 0.0055s/iter; left time: 56.3886s
	iters: 200, epoch: 4 | loss: 0.1532568
	speed: 0.0033s/iter; left time: 33.1575s
	iters: 300, epoch: 4 | loss: 0.0479135
	speed: 0.0035s/iter; left time: 34.7618s
	iters: 400, epoch: 4 | loss: 0.1810879
	speed: 0.0032s/iter; left time: 32.2064s
	iters: 500, epoch: 4 | loss: 0.0648300
	speed: 0.0032s/iter; left time: 31.2963s
	iters: 600, epoch: 4 | loss: 0.1562000
	speed: 0.0031s/iter; left time: 30.1188s
Epoch: 4 cost time: 1.9654698371887207
Epoch: 4, Steps: 610 | Train Loss: 0.1138147 Vali Loss: 0.1419332 Test Loss: 0.0949419
Validation loss decreased (0.142773 --> 0.141933).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1223117
	speed: 0.0049s/iter; left time: 47.1457s
	iters: 200, epoch: 5 | loss: 0.1904529
	speed: 0.0029s/iter; left time: 28.2049s
	iters: 300, epoch: 5 | loss: 0.1269118
	speed: 0.0029s/iter; left time: 27.3749s
	iters: 400, epoch: 5 | loss: 0.1603055
	speed: 0.0034s/iter; left time: 31.3594s
	iters: 500, epoch: 5 | loss: 0.1966864
	speed: 0.0029s/iter; left time: 27.1347s
	iters: 600, epoch: 5 | loss: 0.0783428
	speed: 0.0031s/iter; left time: 28.1461s
Epoch: 5 cost time: 1.8435819149017334
Epoch: 5, Steps: 610 | Train Loss: 0.1127949 Vali Loss: 0.1423550 Test Loss: 0.0922429
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1087579
	speed: 0.0062s/iter; left time: 56.3028s
	iters: 200, epoch: 6 | loss: 0.1784243
	speed: 0.0037s/iter; left time: 33.0454s
	iters: 300, epoch: 6 | loss: 0.0703747
	speed: 0.0031s/iter; left time: 27.5149s
	iters: 400, epoch: 6 | loss: 0.1250182
	speed: 0.0029s/iter; left time: 25.6404s
	iters: 500, epoch: 6 | loss: 0.1479659
	speed: 0.0030s/iter; left time: 25.7853s
	iters: 600, epoch: 6 | loss: 0.1006189
	speed: 0.0029s/iter; left time: 24.7412s
Epoch: 6 cost time: 1.956446886062622
Epoch: 6, Steps: 610 | Train Loss: 0.1122059 Vali Loss: 0.1409856 Test Loss: 0.0949972
Validation loss decreased (0.141933 --> 0.140986).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.0860191
	speed: 0.0051s/iter; left time: 43.2178s
	iters: 200, epoch: 7 | loss: 0.1684356
	speed: 0.0030s/iter; left time: 24.6257s
	iters: 300, epoch: 7 | loss: 0.1574274
	speed: 0.0033s/iter; left time: 27.2777s
	iters: 400, epoch: 7 | loss: 0.0569735
	speed: 0.0036s/iter; left time: 29.3075s
	iters: 500, epoch: 7 | loss: 0.1261569
	speed: 0.0034s/iter; left time: 27.5956s
	iters: 600, epoch: 7 | loss: 0.1074283
	speed: 0.0033s/iter; left time: 26.5277s
Epoch: 7 cost time: 1.9924798011779785
Epoch: 7, Steps: 610 | Train Loss: 0.1119981 Vali Loss: 0.1423904 Test Loss: 0.0938091
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.1236145
	speed: 0.0058s/iter; left time: 45.1187s
	iters: 200, epoch: 8 | loss: 0.1053879
	speed: 0.0035s/iter; left time: 26.7493s
	iters: 300, epoch: 8 | loss: 0.0604257
	speed: 0.0029s/iter; left time: 22.3588s
	iters: 400, epoch: 8 | loss: 0.0672262
	speed: 0.0024s/iter; left time: 17.8399s
	iters: 500, epoch: 8 | loss: 0.0587292
	speed: 0.0031s/iter; left time: 23.1630s
	iters: 600, epoch: 8 | loss: 0.1423682
	speed: 0.0032s/iter; left time: 23.6057s
Epoch: 8 cost time: 1.8787486553192139
Epoch: 8, Steps: 610 | Train Loss: 0.1119338 Vali Loss: 0.1415215 Test Loss: 0.0932216
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.0786124
	speed: 0.0050s/iter; left time: 36.3341s
	iters: 200, epoch: 9 | loss: 0.0507344
	speed: 0.0035s/iter; left time: 24.9980s
	iters: 300, epoch: 9 | loss: 0.1856943
	speed: 0.0033s/iter; left time: 23.0992s
	iters: 400, epoch: 9 | loss: 0.1802527
	speed: 0.0034s/iter; left time: 23.8210s
	iters: 500, epoch: 9 | loss: 0.0810528
	speed: 0.0032s/iter; left time: 21.4862s
	iters: 600, epoch: 9 | loss: 0.0936768
	speed: 0.0033s/iter; left time: 22.1153s
Epoch: 9 cost time: 1.9864532947540283
Epoch: 9, Steps: 610 | Train Loss: 0.1118225 Vali Loss: 0.1414950 Test Loss: 0.0932917
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.1596274
	speed: 0.0051s/iter; left time: 33.5972s
	iters: 200, epoch: 10 | loss: 0.0618149
	speed: 0.0031s/iter; left time: 20.1841s
	iters: 300, epoch: 10 | loss: 0.1221616
	speed: 0.0031s/iter; left time: 20.0665s
	iters: 400, epoch: 10 | loss: 0.0710425
	speed: 0.0031s/iter; left time: 19.7097s
	iters: 500, epoch: 10 | loss: 0.1028462
	speed: 0.0034s/iter; left time: 21.0553s
	iters: 600, epoch: 10 | loss: 0.0757447
	speed: 0.0033s/iter; left time: 20.2886s
Epoch: 10 cost time: 1.9325103759765625
Epoch: 10, Steps: 610 | Train Loss: 0.1117857 Vali Loss: 0.1411222 Test Loss: 0.0933908
EarlyStopping counter: 4 out of 5
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 11 | loss: 0.1754455
	speed: 0.0056s/iter; left time: 33.6668s
	iters: 200, epoch: 11 | loss: 0.1729419
	speed: 0.0033s/iter; left time: 19.7683s
	iters: 300, epoch: 11 | loss: 0.1913172
	speed: 0.0029s/iter; left time: 16.8366s
	iters: 400, epoch: 11 | loss: 0.1901892
	speed: 0.0030s/iter; left time: 16.8749s
	iters: 500, epoch: 11 | loss: 0.2231607
	speed: 0.0027s/iter; left time: 15.0667s
	iters: 600, epoch: 11 | loss: 0.1147152
	speed: 0.0026s/iter; left time: 14.0855s
Epoch: 11 cost time: 1.8161296844482422
Epoch: 11, Steps: 610 | Train Loss: 0.1117557 Vali Loss: 0.1410791 Test Loss: 0.0934229
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : Exchange_336_96_NLinear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15349<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 1422
mse:0.09486963599920273, mae:0.21372981369495392
