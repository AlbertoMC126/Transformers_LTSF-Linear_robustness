Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTh1', data_path='ETTh1.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='Linear', model_id='ETTh1_336_192', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=192, root_path='./dataset/', save_pred_values=False, seed=15726, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTh1_336_192_Linear_ETTh1_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15726>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8113
val 2689
test 2689
	iters: 100, epoch: 1 | loss: 0.4118441
	speed: 0.0060s/iter; left time: 29.9260s
	iters: 200, epoch: 1 | loss: 0.5160840
	speed: 0.0035s/iter; left time: 17.0797s
Epoch: 1 cost time: 1.2205889225006104
Epoch: 1, Steps: 253 | Train Loss: 0.4742200 Vali Loss: 1.0895958 Test Loss: 0.4880982
Validation loss decreased (inf --> 1.089596).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.3967974
	speed: 0.0123s/iter; left time: 58.0609s
	iters: 200, epoch: 2 | loss: 0.5463763
	speed: 0.0054s/iter; left time: 25.0848s
Epoch: 2 cost time: 1.4533743858337402
Epoch: 2, Steps: 253 | Train Loss: 0.4480172 Vali Loss: 1.1405847 Test Loss: 0.4785894
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.4181476
	speed: 0.0107s/iter; left time: 47.6804s
	iters: 200, epoch: 3 | loss: 0.4147619
	speed: 0.0055s/iter; left time: 23.8773s
Epoch: 3 cost time: 1.361539363861084
Epoch: 3, Steps: 253 | Train Loss: 0.3990273 Vali Loss: 1.0245473 Test Loss: 0.4656868
Validation loss decreased (1.089596 --> 1.024547).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.3853662
	speed: 0.0125s/iter; left time: 52.5324s
	iters: 200, epoch: 4 | loss: 0.3405333
	speed: 0.0056s/iter; left time: 22.8072s
Epoch: 4 cost time: 1.4004721641540527
Epoch: 4, Steps: 253 | Train Loss: 0.3807941 Vali Loss: 0.9469246 Test Loss: 0.4354727
Validation loss decreased (1.024547 --> 0.946925).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.3546389
	speed: 0.0119s/iter; left time: 46.8064s
	iters: 200, epoch: 5 | loss: 0.3466265
	speed: 0.0051s/iter; left time: 19.7171s
Epoch: 5 cost time: 1.316267967224121
Epoch: 5, Steps: 253 | Train Loss: 0.3706833 Vali Loss: 0.9207084 Test Loss: 0.4199571
Validation loss decreased (0.946925 --> 0.920708).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.3127075
	speed: 0.0107s/iter; left time: 39.4072s
	iters: 200, epoch: 6 | loss: 0.3774063
	speed: 0.0059s/iter; left time: 21.0506s
Epoch: 6 cost time: 1.3783886432647705
Epoch: 6, Steps: 253 | Train Loss: 0.3658152 Vali Loss: 0.9466769 Test Loss: 0.4161732
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.3741390
	speed: 0.0131s/iter; left time: 45.2229s
	iters: 200, epoch: 7 | loss: 0.3710192
	speed: 0.0055s/iter; left time: 18.3639s
Epoch: 7 cost time: 1.462632179260254
Epoch: 7, Steps: 253 | Train Loss: 0.3629152 Vali Loss: 0.9331481 Test Loss: 0.4170576
EarlyStopping counter: 2 out of 5
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.3416267
	speed: 0.0132s/iter; left time: 42.1833s
	iters: 200, epoch: 8 | loss: 0.4298483
	speed: 0.0058s/iter; left time: 17.9540s
Epoch: 8 cost time: 1.5785701274871826
Epoch: 8, Steps: 253 | Train Loss: 0.3616187 Vali Loss: 0.9360353 Test Loss: 0.4157582
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.3425494
	speed: 0.0137s/iter; left time: 40.1366s
	iters: 200, epoch: 9 | loss: 0.3114542
	speed: 0.0062s/iter; left time: 17.7122s
Epoch: 9 cost time: 1.5069642066955566
Epoch: 9, Steps: 253 | Train Loss: 0.3606740 Vali Loss: 0.9340741 Test Loss: 0.4154988
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.3561537
	speed: 0.0130s/iter; left time: 34.9639s
	iters: 200, epoch: 10 | loss: 0.3352581
	speed: 0.0056s/iter; left time: 14.5995s
Epoch: 10 cost time: 1.4775967597961426
Epoch: 10, Steps: 253 | Train Loss: 0.3603001 Vali Loss: 0.9349478 Test Loss: 0.4151660
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTh1_336_192_Linear_ETTh1_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15726<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2689
mse:0.419106125831604, mae:0.4261088967323303
