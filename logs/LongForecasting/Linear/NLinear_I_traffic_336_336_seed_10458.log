Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='NLinear', model_id='traffic_336_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=336, root_path='./dataset/', save_pred_values=False, seed=10458, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_336_336_NLinear_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed10458>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11609
val 1421
test 3173
	iters: 100, epoch: 1 | loss: 0.9378427
	speed: 0.3214s/iter; left time: 4628.7264s
	iters: 200, epoch: 1 | loss: 0.6640231
	speed: 0.3066s/iter; left time: 4384.6773s
	iters: 300, epoch: 1 | loss: 0.9651188
	speed: 0.3067s/iter; left time: 4356.0450s
	iters: 400, epoch: 1 | loss: 1.0189396
	speed: 0.3073s/iter; left time: 4333.3885s
	iters: 500, epoch: 1 | loss: 0.8879123
	speed: 0.3073s/iter; left time: 4303.0677s
	iters: 600, epoch: 1 | loss: 1.2318534
	speed: 0.3070s/iter; left time: 4267.2321s
	iters: 700, epoch: 1 | loss: 0.8838512
	speed: 0.3064s/iter; left time: 4228.0182s
Epoch: 1 cost time: 224.1202483177185
Epoch: 1, Steps: 725 | Train Loss: 1.0804710 Vali Loss: 1.2639133 Test Loss: 1.4286364
Validation loss decreased (inf --> 1.263913).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 1.5885878
	speed: 0.6068s/iter; left time: 8298.7892s
	iters: 200, epoch: 2 | loss: 1.1157706
	speed: 0.3060s/iter; left time: 4153.6308s
	iters: 300, epoch: 2 | loss: 1.2735275
	speed: 0.3057s/iter; left time: 4119.1888s
	iters: 400, epoch: 2 | loss: 0.6787771
	speed: 0.3074s/iter; left time: 4112.0331s
	iters: 500, epoch: 2 | loss: 2.0875568
	speed: 0.3059s/iter; left time: 4061.7612s
	iters: 600, epoch: 2 | loss: 0.6908071
	speed: 0.3051s/iter; left time: 4020.4807s
	iters: 700, epoch: 2 | loss: 1.3358413
	speed: 0.3054s/iter; left time: 3993.2134s
Epoch: 2 cost time: 221.9471447467804
Epoch: 2, Steps: 725 | Train Loss: 1.2970715 Vali Loss: 1.9549202 Test Loss: 1.5973001
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.3435205
	speed: 0.5986s/iter; left time: 7752.2935s
	iters: 200, epoch: 3 | loss: 0.3427927
	speed: 0.3052s/iter; left time: 3922.5810s
	iters: 300, epoch: 3 | loss: 0.4019765
	speed: 0.3061s/iter; left time: 3903.2998s
	iters: 400, epoch: 3 | loss: 0.3692730
	speed: 0.3081s/iter; left time: 3897.9474s
	iters: 500, epoch: 3 | loss: 0.3638231
	speed: 0.3081s/iter; left time: 3867.0556s
	iters: 600, epoch: 3 | loss: 0.3289816
	speed: 0.3092s/iter; left time: 3850.1957s
	iters: 700, epoch: 3 | loss: 0.3587064
	speed: 0.3083s/iter; left time: 3807.9473s
Epoch: 3 cost time: 222.64465188980103
Epoch: 3, Steps: 725 | Train Loss: 0.3889248 Vali Loss: 0.4891870 Test Loss: 0.6062413
Validation loss decreased (1.263913 --> 0.489187).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.2775165
	speed: 0.6075s/iter; left time: 7427.3494s
	iters: 200, epoch: 4 | loss: 0.3117715
	speed: 0.3065s/iter; left time: 3716.8809s
	iters: 300, epoch: 4 | loss: 0.3089539
	speed: 0.3064s/iter; left time: 3685.3403s
	iters: 400, epoch: 4 | loss: 0.2912605
	speed: 0.3066s/iter; left time: 3656.2266s
	iters: 500, epoch: 4 | loss: 0.2923676
	speed: 0.3077s/iter; left time: 3638.7120s
	iters: 600, epoch: 4 | loss: 0.3043181
	speed: 0.3063s/iter; left time: 3591.4081s
	iters: 700, epoch: 4 | loss: 0.3105556
	speed: 0.3077s/iter; left time: 3577.8971s
Epoch: 4 cost time: 222.69695043563843
Epoch: 4, Steps: 725 | Train Loss: 0.2981060 Vali Loss: 0.4138568 Test Loss: 0.5095847
Validation loss decreased (0.489187 --> 0.413857).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.2723949
	speed: 0.6104s/iter; left time: 7020.3022s
	iters: 200, epoch: 5 | loss: 0.2715955
	speed: 0.3059s/iter; left time: 3487.1106s
	iters: 300, epoch: 5 | loss: 0.2685511
	speed: 0.3063s/iter; left time: 3460.9651s
	iters: 400, epoch: 5 | loss: 0.2726018
	speed: 0.3062s/iter; left time: 3429.3395s
	iters: 500, epoch: 5 | loss: 0.2929155
	speed: 0.3069s/iter; left time: 3407.4409s
	iters: 600, epoch: 5 | loss: 0.3054112
	speed: 0.3082s/iter; left time: 3390.0460s
	iters: 700, epoch: 5 | loss: 0.2654652
	speed: 0.3078s/iter; left time: 3355.3067s
Epoch: 5 cost time: 222.72178626060486
Epoch: 5, Steps: 725 | Train Loss: 0.2766275 Vali Loss: 0.3902967 Test Loss: 0.4815377
Validation loss decreased (0.413857 --> 0.390297).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.2618714
	speed: 0.6099s/iter; left time: 6572.7208s
	iters: 200, epoch: 6 | loss: 0.2369227
	speed: 0.3071s/iter; left time: 3278.5677s
	iters: 300, epoch: 6 | loss: 0.2797491
	speed: 0.3076s/iter; left time: 3252.6583s
	iters: 400, epoch: 6 | loss: 0.2572809
	speed: 0.3070s/iter; left time: 3216.5323s
	iters: 500, epoch: 6 | loss: 0.2414749
	speed: 0.3067s/iter; left time: 3182.6361s
	iters: 600, epoch: 6 | loss: 0.2925963
	speed: 0.3071s/iter; left time: 3155.9204s
	iters: 700, epoch: 6 | loss: 0.2674994
	speed: 0.3053s/iter; left time: 3106.2542s
Epoch: 6 cost time: 222.7225158214569
Epoch: 6, Steps: 725 | Train Loss: 0.2665074 Vali Loss: 0.3764698 Test Loss: 0.4681507
Validation loss decreased (0.390297 --> 0.376470).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.2828874
	speed: 0.6067s/iter; left time: 6097.4771s
	iters: 200, epoch: 7 | loss: 0.2471263
	speed: 0.3065s/iter; left time: 3050.2752s
	iters: 300, epoch: 7 | loss: 0.2605138
	speed: 0.3071s/iter; left time: 3025.7118s
	iters: 400, epoch: 7 | loss: 0.2688162
	speed: 0.3072s/iter; left time: 2995.5946s
	iters: 500, epoch: 7 | loss: 0.2759259
	speed: 0.3055s/iter; left time: 2948.8429s
	iters: 600, epoch: 7 | loss: 0.2667302
	speed: 0.3070s/iter; left time: 2931.7780s
	iters: 700, epoch: 7 | loss: 0.2596060
	speed: 0.3070s/iter; left time: 2901.8949s
Epoch: 7 cost time: 222.53968214988708
Epoch: 7, Steps: 725 | Train Loss: 0.2608246 Vali Loss: 0.3695629 Test Loss: 0.4582308
Validation loss decreased (0.376470 --> 0.369563).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.2656575
	speed: 0.6090s/iter; left time: 5679.2093s
	iters: 200, epoch: 8 | loss: 0.2583368
	speed: 0.3095s/iter; left time: 2855.0360s
	iters: 300, epoch: 8 | loss: 0.2599746
	speed: 0.3063s/iter; left time: 2795.4557s
	iters: 400, epoch: 8 | loss: 0.2555887
	speed: 0.3070s/iter; left time: 2771.2861s
	iters: 500, epoch: 8 | loss: 0.2317325
	speed: 0.3066s/iter; left time: 2736.5235s
	iters: 600, epoch: 8 | loss: 0.2122199
	speed: 0.3065s/iter; left time: 2705.0274s
	iters: 700, epoch: 8 | loss: 0.2477004
	speed: 0.3092s/iter; left time: 2698.0511s
Epoch: 8 cost time: 223.20723724365234
Epoch: 8, Steps: 725 | Train Loss: 0.2575701 Vali Loss: 0.3662242 Test Loss: 0.4541282
Validation loss decreased (0.369563 --> 0.366224).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.2647169
	speed: 0.6085s/iter; left time: 5233.9490s
	iters: 200, epoch: 9 | loss: 0.2320864
	speed: 0.3070s/iter; left time: 2609.5313s
	iters: 300, epoch: 9 | loss: 0.2436281
	speed: 0.3067s/iter; left time: 2576.3967s
	iters: 400, epoch: 9 | loss: 0.2510146
	speed: 0.3065s/iter; left time: 2544.3179s
	iters: 500, epoch: 9 | loss: 0.2644470
	speed: 0.3062s/iter; left time: 2510.9343s
	iters: 600, epoch: 9 | loss: 0.2330209
	speed: 0.3071s/iter; left time: 2487.8732s
	iters: 700, epoch: 9 | loss: 0.2698479
	speed: 0.3071s/iter; left time: 2456.8036s
Epoch: 9 cost time: 222.65837907791138
Epoch: 9, Steps: 725 | Train Loss: 0.2555986 Vali Loss: 0.3646047 Test Loss: 0.4522017
Validation loss decreased (0.366224 --> 0.364605).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.2551152
	speed: 0.6095s/iter; left time: 4800.2820s
	iters: 200, epoch: 10 | loss: 0.2379965
	speed: 0.3075s/iter; left time: 2391.0229s
	iters: 300, epoch: 10 | loss: 0.2505391
	speed: 0.3107s/iter; left time: 2384.6908s
	iters: 400, epoch: 10 | loss: 0.2538041
	speed: 0.3068s/iter; left time: 2324.5077s
	iters: 500, epoch: 10 | loss: 0.2423895
	speed: 0.3067s/iter; left time: 2292.8582s
	iters: 600, epoch: 10 | loss: 0.2796913
	speed: 0.3066s/iter; left time: 2261.4874s
	iters: 700, epoch: 10 | loss: 0.2480022
	speed: 0.3066s/iter; left time: 2230.8528s
Epoch: 10 cost time: 220.76360201835632
Epoch: 10, Steps: 725 | Train Loss: 0.2545407 Vali Loss: 0.3637029 Test Loss: 0.4505878
Validation loss decreased (0.364605 --> 0.363703).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.2354310
	speed: 0.5864s/iter; left time: 4193.2825s
	iters: 200, epoch: 11 | loss: 0.2393183
	speed: 0.3069s/iter; left time: 2164.2187s
	iters: 300, epoch: 11 | loss: 0.2503445
	speed: 0.3070s/iter; left time: 2133.7466s
	iters: 400, epoch: 11 | loss: 0.2450224
	speed: 0.3072s/iter; left time: 2104.7231s
	iters: 500, epoch: 11 | loss: 0.2518430
	speed: 0.3061s/iter; left time: 2066.4641s
	iters: 600, epoch: 11 | loss: 0.2344228
	speed: 0.3092s/iter; left time: 2056.2755s
	iters: 700, epoch: 11 | loss: 0.2218636
	speed: 0.3061s/iter; left time: 2005.3101s
Epoch: 11 cost time: 222.98905682563782
Epoch: 11, Steps: 725 | Train Loss: 0.2538958 Vali Loss: 0.3629123 Test Loss: 0.4500746
Validation loss decreased (0.363703 --> 0.362912).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.2860739
	speed: 0.6102s/iter; left time: 3921.2443s
	iters: 200, epoch: 12 | loss: 0.2650025
	speed: 0.3090s/iter; left time: 1954.9939s
	iters: 300, epoch: 12 | loss: 0.2618938
	speed: 0.3103s/iter; left time: 1931.9622s
	iters: 400, epoch: 12 | loss: 0.2349874
	speed: 0.3095s/iter; left time: 1896.0071s
	iters: 500, epoch: 12 | loss: 0.2370374
	speed: 0.3092s/iter; left time: 1863.4749s
	iters: 600, epoch: 12 | loss: 0.2559462
	speed: 0.3079s/iter; left time: 1824.5078s
	iters: 700, epoch: 12 | loss: 0.2374756
	speed: 0.3058s/iter; left time: 1781.5968s
Epoch: 12 cost time: 223.89613485336304
Epoch: 12, Steps: 725 | Train Loss: 0.2535834 Vali Loss: 0.3626403 Test Loss: 0.4498643
Validation loss decreased (0.362912 --> 0.362640).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.2446796
	speed: 0.6087s/iter; left time: 3470.2580s
	iters: 200, epoch: 13 | loss: 0.2657089
	speed: 0.3123s/iter; left time: 1749.3077s
	iters: 300, epoch: 13 | loss: 0.2432747
	speed: 0.3089s/iter; left time: 1699.5074s
	iters: 400, epoch: 13 | loss: 0.2266381
	speed: 0.3079s/iter; left time: 1663.0315s
	iters: 500, epoch: 13 | loss: 0.2539471
	speed: 0.3086s/iter; left time: 1635.8680s
	iters: 600, epoch: 13 | loss: 0.2501785
	speed: 0.3072s/iter; left time: 1597.9739s
	iters: 700, epoch: 13 | loss: 0.2762582
	speed: 0.3070s/iter; left time: 1566.0032s
Epoch: 13 cost time: 223.74638509750366
Epoch: 13, Steps: 725 | Train Loss: 0.2533738 Vali Loss: 0.3627971 Test Loss: 0.4497385
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 14 | loss: 0.2344050
	speed: 0.6029s/iter; left time: 2999.7938s
	iters: 200, epoch: 14 | loss: 0.2479153
	speed: 0.3072s/iter; left time: 1497.8018s
	iters: 300, epoch: 14 | loss: 0.2398975
	speed: 0.3079s/iter; left time: 1470.5774s
	iters: 400, epoch: 14 | loss: 0.2688043
	speed: 0.3083s/iter; left time: 1441.6569s
	iters: 500, epoch: 14 | loss: 0.2270001
	speed: 0.3114s/iter; left time: 1425.1894s
	iters: 600, epoch: 14 | loss: 0.2396331
	speed: 0.3079s/iter; left time: 1377.9991s
	iters: 700, epoch: 14 | loss: 0.2271141
	speed: 0.3069s/iter; left time: 1342.8436s
Epoch: 14 cost time: 223.35806679725647
Epoch: 14, Steps: 725 | Train Loss: 0.2532941 Vali Loss: 0.3624570 Test Loss: 0.4496969
Validation loss decreased (0.362640 --> 0.362457).  Saving model ...
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 15 | loss: 0.2392900
	speed: 0.6078s/iter; left time: 2583.8889s
	iters: 200, epoch: 15 | loss: 0.2676586
	speed: 0.3058s/iter; left time: 1269.3999s
	iters: 300, epoch: 15 | loss: 0.2551311
	speed: 0.3075s/iter; left time: 1245.7342s
	iters: 400, epoch: 15 | loss: 0.2661646
	speed: 0.3067s/iter; left time: 1211.7392s
	iters: 500, epoch: 15 | loss: 0.2372172
	speed: 0.3069s/iter; left time: 1182.0444s
	iters: 600, epoch: 15 | loss: 0.2623734
	speed: 0.3070s/iter; left time: 1151.7258s
	iters: 700, epoch: 15 | loss: 0.2512166
	speed: 0.3065s/iter; left time: 1119.1178s
Epoch: 15 cost time: 222.5901951789856
Epoch: 15, Steps: 725 | Train Loss: 0.2532279 Vali Loss: 0.3626445 Test Loss: 0.4496395
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 16 | loss: 0.2339776
	speed: 0.6073s/iter; left time: 2141.3646s
	iters: 200, epoch: 16 | loss: 0.2573565
	speed: 0.3067s/iter; left time: 1050.7890s
	iters: 300, epoch: 16 | loss: 0.2616712
	speed: 0.3073s/iter; left time: 1021.9620s
	iters: 400, epoch: 16 | loss: 0.2686258
	speed: 0.3076s/iter; left time: 992.4200s
	iters: 500, epoch: 16 | loss: 0.2561411
	speed: 0.3077s/iter; left time: 961.9752s
	iters: 600, epoch: 16 | loss: 0.2349986
	speed: 0.3078s/iter; left time: 931.3996s
	iters: 700, epoch: 16 | loss: 0.2499879
	speed: 0.3080s/iter; left time: 901.3318s
Epoch: 16 cost time: 222.92580604553223
Epoch: 16, Steps: 725 | Train Loss: 0.2531848 Vali Loss: 0.3628655 Test Loss: 0.4496373
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 17 | loss: 0.2420478
	speed: 0.6023s/iter; left time: 1687.0239s
	iters: 200, epoch: 17 | loss: 0.2401176
	speed: 0.3065s/iter; left time: 827.7742s
	iters: 300, epoch: 17 | loss: 0.2505513
	speed: 0.3095s/iter; left time: 805.0439s
	iters: 400, epoch: 17 | loss: 0.2292492
	speed: 0.3083s/iter; left time: 771.1181s
	iters: 500, epoch: 17 | loss: 0.2671024
	speed: 0.3069s/iter; left time: 736.7677s
	iters: 600, epoch: 17 | loss: 0.2418409
	speed: 0.3080s/iter; left time: 708.5939s
	iters: 700, epoch: 17 | loss: 0.2733296
	speed: 0.3067s/iter; left time: 675.0785s
Epoch: 17 cost time: 223.00882482528687
Epoch: 17, Steps: 725 | Train Loss: 0.2531879 Vali Loss: 0.3625465 Test Loss: 0.4496334
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 18 | loss: 0.2341935
	speed: 0.6031s/iter; left time: 1252.0089s
	iters: 200, epoch: 18 | loss: 0.2764932
	speed: 0.3072s/iter; left time: 607.0730s
	iters: 300, epoch: 18 | loss: 0.2448686
	speed: 0.3065s/iter; left time: 574.9232s
	iters: 400, epoch: 18 | loss: 0.2357984
	speed: 0.3071s/iter; left time: 545.3744s
	iters: 500, epoch: 18 | loss: 0.2373674
	speed: 0.3081s/iter; left time: 516.4306s
	iters: 600, epoch: 18 | loss: 0.2525567
	speed: 0.3079s/iter; left time: 485.2147s
	iters: 700, epoch: 18 | loss: 0.2557099
	speed: 0.3103s/iter; left time: 457.9663s
Epoch: 18 cost time: 223.12569952011108
Epoch: 18, Steps: 725 | Train Loss: 0.2531627 Vali Loss: 0.3629566 Test Loss: 0.4496323
EarlyStopping counter: 4 out of 5
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 19 | loss: 0.2559477
	speed: 0.6030s/iter; left time: 814.5927s
	iters: 200, epoch: 19 | loss: 0.2572955
	speed: 0.3067s/iter; left time: 383.7202s
	iters: 300, epoch: 19 | loss: 0.2623695
	speed: 0.3067s/iter; left time: 353.0291s
	iters: 400, epoch: 19 | loss: 0.2588901
	speed: 0.3066s/iter; left time: 322.1862s
	iters: 500, epoch: 19 | loss: 0.2701146
	speed: 0.3063s/iter; left time: 291.2910s
	iters: 600, epoch: 19 | loss: 0.2292023
	speed: 0.3071s/iter; left time: 261.3312s
	iters: 700, epoch: 19 | loss: 0.2521838
	speed: 0.3074s/iter; left time: 230.8725s
Epoch: 19 cost time: 222.39296293258667
Epoch: 19, Steps: 725 | Train Loss: 0.2531657 Vali Loss: 0.3626849 Test Loss: 0.4496315
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : traffic_336_336_NLinear_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed10458<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3173
mse:0.44855305552482605, mae:0.30531370639801025
