Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='Linear', model_id='Electricity_336_720', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=720, root_path='./dataset/', save_pred_values=False, seed=10458, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : Electricity_336_720_Linear_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed10458>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17357
val 1913
test 4541
	iters: 100, epoch: 1 | loss: 0.2779573
	speed: 0.1109s/iter; left time: 2392.8405s
	iters: 200, epoch: 1 | loss: 0.2951467
	speed: 0.0954s/iter; left time: 2049.8531s
	iters: 300, epoch: 1 | loss: 0.2916054
	speed: 0.0950s/iter; left time: 2030.5542s
	iters: 400, epoch: 1 | loss: 0.2665237
	speed: 0.0960s/iter; left time: 2043.7798s
	iters: 500, epoch: 1 | loss: 0.3003111
	speed: 0.0954s/iter; left time: 2021.4564s
	iters: 600, epoch: 1 | loss: 0.2890417
	speed: 0.0952s/iter; left time: 2006.6674s
	iters: 700, epoch: 1 | loss: 0.2900566
	speed: 0.0989s/iter; left time: 2074.2153s
	iters: 800, epoch: 1 | loss: 0.2537971
	speed: 0.1027s/iter; left time: 2143.7687s
	iters: 900, epoch: 1 | loss: 0.2829816
	speed: 0.0985s/iter; left time: 2047.8819s
	iters: 1000, epoch: 1 | loss: 0.2937565
	speed: 0.0954s/iter; left time: 1973.3978s
Epoch: 1 cost time: 106.35679125785828
Epoch: 1, Steps: 1084 | Train Loss: 0.2937459 Vali Loss: 0.2515841 Test Loss: 0.2868466
Validation loss decreased (inf --> 0.251584).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.3170508
	speed: 0.3906s/iter; left time: 8006.2304s
	iters: 200, epoch: 2 | loss: 0.2990551
	speed: 0.0947s/iter; left time: 1931.9199s
	iters: 300, epoch: 2 | loss: 0.2683816
	speed: 0.0953s/iter; left time: 1933.9069s
	iters: 400, epoch: 2 | loss: 0.2909315
	speed: 0.0952s/iter; left time: 1923.4334s
	iters: 500, epoch: 2 | loss: 0.2475402
	speed: 0.0954s/iter; left time: 1917.3805s
	iters: 600, epoch: 2 | loss: 0.2855880
	speed: 0.1021s/iter; left time: 2040.9232s
	iters: 700, epoch: 2 | loss: 0.2849051
	speed: 0.1006s/iter; left time: 2001.7058s
	iters: 800, epoch: 2 | loss: 0.2986845
	speed: 0.0981s/iter; left time: 1941.8881s
	iters: 900, epoch: 2 | loss: 0.2795866
	speed: 0.0962s/iter; left time: 1895.5518s
	iters: 1000, epoch: 2 | loss: 0.3033309
	speed: 0.0953s/iter; left time: 1867.5861s
Epoch: 2 cost time: 105.02589392662048
Epoch: 2, Steps: 1084 | Train Loss: 0.2847585 Vali Loss: 0.2516499 Test Loss: 0.2888432
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.2210664
	speed: 0.3646s/iter; left time: 7078.1144s
	iters: 200, epoch: 3 | loss: 0.1993101
	speed: 0.0941s/iter; left time: 1818.1186s
	iters: 300, epoch: 3 | loss: 0.2243696
	speed: 0.0949s/iter; left time: 1822.4546s
	iters: 400, epoch: 3 | loss: 0.2254874
	speed: 0.0945s/iter; left time: 1805.8037s
	iters: 500, epoch: 3 | loss: 0.2670914
	speed: 0.0965s/iter; left time: 1834.9991s
	iters: 600, epoch: 3 | loss: 0.2174135
	speed: 0.1030s/iter; left time: 1947.3930s
	iters: 700, epoch: 3 | loss: 0.2306088
	speed: 0.1000s/iter; left time: 1880.6597s
	iters: 800, epoch: 3 | loss: 0.2316965
	speed: 0.1002s/iter; left time: 1875.3064s
	iters: 900, epoch: 3 | loss: 0.2730585
	speed: 0.0948s/iter; left time: 1764.8026s
	iters: 1000, epoch: 3 | loss: 0.2215868
	speed: 0.0945s/iter; left time: 1749.3660s
Epoch: 3 cost time: 104.64521098136902
Epoch: 3, Steps: 1084 | Train Loss: 0.2352184 Vali Loss: 0.2136310 Test Loss: 0.2524382
Validation loss decreased (0.251584 --> 0.213631).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.2169427
	speed: 0.3905s/iter; left time: 7157.8535s
	iters: 200, epoch: 4 | loss: 0.2076159
	speed: 0.0954s/iter; left time: 1739.6096s
	iters: 300, epoch: 4 | loss: 0.1999161
	speed: 0.0965s/iter; left time: 1750.0970s
	iters: 400, epoch: 4 | loss: 0.2069852
	speed: 0.0960s/iter; left time: 1731.0809s
	iters: 500, epoch: 4 | loss: 0.2416134
	speed: 0.1011s/iter; left time: 1812.9300s
	iters: 600, epoch: 4 | loss: 0.2189052
	speed: 0.1017s/iter; left time: 1814.0545s
	iters: 700, epoch: 4 | loss: 0.2350181
	speed: 0.1034s/iter; left time: 1833.9878s
	iters: 800, epoch: 4 | loss: 0.1978074
	speed: 0.0963s/iter; left time: 1697.3982s
	iters: 900, epoch: 4 | loss: 0.2087142
	speed: 0.0954s/iter; left time: 1671.6138s
	iters: 1000, epoch: 4 | loss: 0.2571563
	speed: 0.0947s/iter; left time: 1651.2269s
Epoch: 4 cost time: 105.82718515396118
Epoch: 4, Steps: 1084 | Train Loss: 0.2163108 Vali Loss: 0.1851854 Test Loss: 0.2215654
Validation loss decreased (0.213631 --> 0.185185).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.1814098
	speed: 0.3907s/iter; left time: 6738.0409s
	iters: 200, epoch: 5 | loss: 0.2079998
	speed: 0.0957s/iter; left time: 1641.0341s
	iters: 300, epoch: 5 | loss: 0.2205913
	speed: 0.0956s/iter; left time: 1628.9793s
	iters: 400, epoch: 5 | loss: 0.2230248
	speed: 0.0988s/iter; left time: 1674.5286s
	iters: 500, epoch: 5 | loss: 0.2000337
	speed: 0.1012s/iter; left time: 1704.4157s
	iters: 600, epoch: 5 | loss: 0.2690463
	speed: 0.1016s/iter; left time: 1701.5072s
	iters: 700, epoch: 5 | loss: 0.1981937
	speed: 0.0954s/iter; left time: 1588.3186s
	iters: 800, epoch: 5 | loss: 0.2084644
	speed: 0.0945s/iter; left time: 1564.0244s
	iters: 900, epoch: 5 | loss: 0.1814160
	speed: 0.0945s/iter; left time: 1553.8523s
	iters: 1000, epoch: 5 | loss: 0.2104183
	speed: 0.0946s/iter; left time: 1545.9999s
Epoch: 5 cost time: 104.92372918128967
Epoch: 5, Steps: 1084 | Train Loss: 0.2064668 Vali Loss: 0.1829109 Test Loss: 0.2160225
Validation loss decreased (0.185185 --> 0.182911).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.2327769
	speed: 0.3917s/iter; left time: 6330.1652s
	iters: 200, epoch: 6 | loss: 0.2249402
	speed: 0.0937s/iter; left time: 1504.9975s
	iters: 300, epoch: 6 | loss: 0.1817893
	speed: 0.0947s/iter; left time: 1512.0184s
	iters: 400, epoch: 6 | loss: 0.2125801
	speed: 0.0968s/iter; left time: 1535.2911s
	iters: 500, epoch: 6 | loss: 0.2065177
	speed: 0.1002s/iter; left time: 1579.6292s
	iters: 600, epoch: 6 | loss: 0.2430790
	speed: 0.0987s/iter; left time: 1546.0093s
	iters: 700, epoch: 6 | loss: 0.2383318
	speed: 0.0956s/iter; left time: 1486.9548s
	iters: 800, epoch: 6 | loss: 0.1668026
	speed: 0.0954s/iter; left time: 1475.0836s
	iters: 900, epoch: 6 | loss: 0.2058440
	speed: 0.0958s/iter; left time: 1470.9948s
	iters: 1000, epoch: 6 | loss: 0.2097625
	speed: 0.0951s/iter; left time: 1451.1091s
Epoch: 6 cost time: 104.12417268753052
Epoch: 6, Steps: 1084 | Train Loss: 0.2012042 Vali Loss: 0.1738192 Test Loss: 0.2077223
Validation loss decreased (0.182911 --> 0.173819).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.2243119
	speed: 0.3895s/iter; left time: 5872.3457s
	iters: 200, epoch: 7 | loss: 0.1786342
	speed: 0.0959s/iter; left time: 1435.9904s
	iters: 300, epoch: 7 | loss: 0.1695466
	speed: 0.1009s/iter; left time: 1500.6149s
	iters: 400, epoch: 7 | loss: 0.1933074
	speed: 0.1001s/iter; left time: 1479.4974s
	iters: 500, epoch: 7 | loss: 0.2071418
	speed: 0.0991s/iter; left time: 1455.0148s
	iters: 600, epoch: 7 | loss: 0.1898023
	speed: 0.0956s/iter; left time: 1392.8409s
	iters: 700, epoch: 7 | loss: 0.1790029
	speed: 0.0956s/iter; left time: 1383.4386s
	iters: 800, epoch: 7 | loss: 0.2485426
	speed: 0.0961s/iter; left time: 1380.9596s
	iters: 900, epoch: 7 | loss: 0.1956972
	speed: 0.0957s/iter; left time: 1366.9212s
	iters: 1000, epoch: 7 | loss: 0.1984326
	speed: 0.0958s/iter; left time: 1358.4720s
Epoch: 7 cost time: 105.20809316635132
Epoch: 7, Steps: 1084 | Train Loss: 0.1984300 Vali Loss: 0.1711616 Test Loss: 0.2046192
Validation loss decreased (0.173819 --> 0.171162).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.1916646
	speed: 0.3977s/iter; left time: 5564.4034s
	iters: 200, epoch: 8 | loss: 0.1884700
	speed: 0.0996s/iter; left time: 1383.6172s
	iters: 300, epoch: 8 | loss: 0.1842031
	speed: 0.1013s/iter; left time: 1397.6959s
	iters: 400, epoch: 8 | loss: 0.2047915
	speed: 0.1047s/iter; left time: 1434.2868s
	iters: 500, epoch: 8 | loss: 0.1864138
	speed: 0.0967s/iter; left time: 1315.0315s
	iters: 600, epoch: 8 | loss: 0.2288424
	speed: 0.0943s/iter; left time: 1272.0666s
	iters: 700, epoch: 8 | loss: 0.2291363
	speed: 0.0944s/iter; left time: 1263.9461s
	iters: 800, epoch: 8 | loss: 0.1892130
	speed: 0.0937s/iter; left time: 1245.4188s
	iters: 900, epoch: 8 | loss: 0.2023153
	speed: 0.0943s/iter; left time: 1243.5054s
	iters: 1000, epoch: 8 | loss: 0.2165903
	speed: 0.0942s/iter; left time: 1233.7936s
Epoch: 8 cost time: 105.02139592170715
Epoch: 8, Steps: 1084 | Train Loss: 0.1969145 Vali Loss: 0.1685865 Test Loss: 0.2025141
Validation loss decreased (0.171162 --> 0.168587).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.2006697
	speed: 0.3906s/iter; left time: 5041.8004s
	iters: 200, epoch: 9 | loss: 0.2057622
	speed: 0.0994s/iter; left time: 1273.2719s
	iters: 300, epoch: 9 | loss: 0.1848759
	speed: 0.1025s/iter; left time: 1303.2102s
	iters: 400, epoch: 9 | loss: 0.1975187
	speed: 0.0995s/iter; left time: 1254.4088s
	iters: 500, epoch: 9 | loss: 0.2165733
	speed: 0.0960s/iter; left time: 1201.4454s
	iters: 600, epoch: 9 | loss: 0.1964830
	speed: 0.0948s/iter; left time: 1176.6458s
	iters: 700, epoch: 9 | loss: 0.1913677
	speed: 0.0952s/iter; left time: 1171.4881s
	iters: 800, epoch: 9 | loss: 0.1956373
	speed: 0.1010s/iter; left time: 1232.7289s
	iters: 900, epoch: 9 | loss: 0.1871902
	speed: 0.0970s/iter; left time: 1174.5115s
	iters: 1000, epoch: 9 | loss: 0.1864601
	speed: 0.0967s/iter; left time: 1161.1070s
Epoch: 9 cost time: 106.17431092262268
Epoch: 9, Steps: 1084 | Train Loss: 0.1960872 Vali Loss: 0.1686925 Test Loss: 0.2017839
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.2010157
	speed: 0.3724s/iter; left time: 4403.5581s
	iters: 200, epoch: 10 | loss: 0.2107599
	speed: 0.1002s/iter; left time: 1174.6133s
	iters: 300, epoch: 10 | loss: 0.2311415
	speed: 0.1028s/iter; left time: 1194.9795s
	iters: 400, epoch: 10 | loss: 0.1916999
	speed: 0.0964s/iter; left time: 1111.4346s
	iters: 500, epoch: 10 | loss: 0.1928498
	speed: 0.0954s/iter; left time: 1090.2755s
	iters: 600, epoch: 10 | loss: 0.1863000
	speed: 0.0961s/iter; left time: 1088.5148s
	iters: 700, epoch: 10 | loss: 0.1755646
	speed: 0.0957s/iter; left time: 1073.6873s
	iters: 800, epoch: 10 | loss: 0.2110391
	speed: 0.0955s/iter; left time: 1062.1325s
	iters: 900, epoch: 10 | loss: 0.1766978
	speed: 0.0950s/iter; left time: 1047.7525s
	iters: 1000, epoch: 10 | loss: 0.1964980
	speed: 0.0946s/iter; left time: 1033.8835s
Epoch: 10 cost time: 105.18825364112854
Epoch: 10, Steps: 1084 | Train Loss: 0.1956709 Vali Loss: 0.1682986 Test Loss: 0.2018752
Validation loss decreased (0.168587 --> 0.168299).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.1909544
	speed: 0.3947s/iter; left time: 4238.9960s
	iters: 200, epoch: 11 | loss: 0.2107348
	speed: 0.1007s/iter; left time: 1071.0911s
	iters: 300, epoch: 11 | loss: 0.2471978
	speed: 0.0965s/iter; left time: 1017.6073s
	iters: 400, epoch: 11 | loss: 0.2309678
	speed: 0.0947s/iter; left time: 988.7271s
	iters: 500, epoch: 11 | loss: 0.2050113
	speed: 0.0939s/iter; left time: 971.2071s
	iters: 600, epoch: 11 | loss: 0.2143967
	speed: 0.0934s/iter; left time: 956.7124s
	iters: 700, epoch: 11 | loss: 0.1815260
	speed: 0.0927s/iter; left time: 940.4857s
	iters: 800, epoch: 11 | loss: 0.2016943
	speed: 0.0942s/iter; left time: 945.7214s
	iters: 900, epoch: 11 | loss: 0.1642340
	speed: 0.0948s/iter; left time: 942.0581s
	iters: 1000, epoch: 11 | loss: 0.1760592
	speed: 0.0951s/iter; left time: 935.8855s
Epoch: 11 cost time: 103.83210468292236
Epoch: 11, Steps: 1084 | Train Loss: 0.1954304 Vali Loss: 0.1683042 Test Loss: 0.2016715
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.1979353
	speed: 0.3716s/iter; left time: 3588.9506s
	iters: 200, epoch: 12 | loss: 0.1738956
	speed: 0.1008s/iter; left time: 963.1452s
	iters: 300, epoch: 12 | loss: 0.1741942
	speed: 0.0955s/iter; left time: 902.8686s
	iters: 400, epoch: 12 | loss: 0.1791929
	speed: 0.0952s/iter; left time: 890.4470s
	iters: 500, epoch: 12 | loss: 0.2089157
	speed: 0.0946s/iter; left time: 876.1324s
	iters: 600, epoch: 12 | loss: 0.1863246
	speed: 0.0952s/iter; left time: 871.6066s
	iters: 700, epoch: 12 | loss: 0.1715858
	speed: 0.0945s/iter; left time: 856.1144s
	iters: 800, epoch: 12 | loss: 0.1867335
	speed: 0.0952s/iter; left time: 852.6304s
	iters: 900, epoch: 12 | loss: 0.1933954
	speed: 0.0960s/iter; left time: 850.0160s
	iters: 1000, epoch: 12 | loss: 0.2095153
	speed: 0.0960s/iter; left time: 840.6139s
Epoch: 12 cost time: 104.20776104927063
Epoch: 12, Steps: 1084 | Train Loss: 0.1952942 Vali Loss: 0.1682482 Test Loss: 0.2017535
Validation loss decreased (0.168299 --> 0.168248).  Saving model ...
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.1758862
	speed: 0.3996s/iter; left time: 3425.7817s
	iters: 200, epoch: 13 | loss: 0.1685536
	speed: 0.0999s/iter; left time: 846.7186s
	iters: 300, epoch: 13 | loss: 0.2015031
	speed: 0.0957s/iter; left time: 801.2616s
	iters: 400, epoch: 13 | loss: 0.1791576
	speed: 0.0957s/iter; left time: 791.8277s
	iters: 500, epoch: 13 | loss: 0.2174457
	speed: 0.0953s/iter; left time: 778.8443s
	iters: 600, epoch: 13 | loss: 0.1735731
	speed: 0.0948s/iter; left time: 765.3135s
	iters: 700, epoch: 13 | loss: 0.2030916
	speed: 0.0949s/iter; left time: 756.6850s
	iters: 800, epoch: 13 | loss: 0.2259883
	speed: 0.0962s/iter; left time: 757.2944s
	iters: 900, epoch: 13 | loss: 0.1712228
	speed: 0.0959s/iter; left time: 745.6026s
	iters: 1000, epoch: 13 | loss: 0.1907894
	speed: 0.0951s/iter; left time: 729.6882s
Epoch: 13 cost time: 104.52167963981628
Epoch: 13, Steps: 1084 | Train Loss: 0.1952365 Vali Loss: 0.1682054 Test Loss: 0.2015854
Validation loss decreased (0.168248 --> 0.168205).  Saving model ...
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.1937797
	speed: 0.4038s/iter; left time: 3023.7100s
	iters: 200, epoch: 14 | loss: 0.1996038
	speed: 0.0954s/iter; left time: 704.6419s
	iters: 300, epoch: 14 | loss: 0.2080275
	speed: 0.0947s/iter; left time: 690.1935s
	iters: 400, epoch: 14 | loss: 0.1904651
	speed: 0.0950s/iter; left time: 683.2256s
	iters: 500, epoch: 14 | loss: 0.1643610
	speed: 0.0946s/iter; left time: 670.9350s
	iters: 600, epoch: 14 | loss: 0.1821248
	speed: 0.0947s/iter; left time: 661.8322s
	iters: 700, epoch: 14 | loss: 0.1857265
	speed: 0.0955s/iter; left time: 657.8790s
	iters: 800, epoch: 14 | loss: 0.1974853
	speed: 0.0948s/iter; left time: 643.8393s
	iters: 900, epoch: 14 | loss: 0.1911789
	speed: 0.0934s/iter; left time: 624.7608s
	iters: 1000, epoch: 14 | loss: 0.1682114
	speed: 0.0944s/iter; left time: 622.0983s
Epoch: 14 cost time: 104.17940545082092
Epoch: 14, Steps: 1084 | Train Loss: 0.1952248 Vali Loss: 0.1682550 Test Loss: 0.2015763
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.1801742
	speed: 0.3842s/iter; left time: 2460.8865s
	iters: 200, epoch: 15 | loss: 0.1867411
	speed: 0.0957s/iter; left time: 603.6141s
	iters: 300, epoch: 15 | loss: 0.2081418
	speed: 0.0947s/iter; left time: 587.7696s
	iters: 400, epoch: 15 | loss: 0.2003547
	speed: 0.0952s/iter; left time: 580.8983s
	iters: 500, epoch: 15 | loss: 0.1888877
	speed: 0.0964s/iter; left time: 578.9892s
	iters: 600, epoch: 15 | loss: 0.1649684
	speed: 0.0963s/iter; left time: 568.6483s
	iters: 700, epoch: 15 | loss: 0.1638532
	speed: 0.0961s/iter; left time: 557.6364s
	iters: 800, epoch: 15 | loss: 0.1877155
	speed: 0.0960s/iter; left time: 547.5209s
	iters: 900, epoch: 15 | loss: 0.1886203
	speed: 0.0960s/iter; left time: 537.8318s
	iters: 1000, epoch: 15 | loss: 0.1774706
	speed: 0.0966s/iter; left time: 531.5288s
Epoch: 15 cost time: 104.85068225860596
Epoch: 15, Steps: 1084 | Train Loss: 0.1951616 Vali Loss: 0.1681956 Test Loss: 0.2015664
Validation loss decreased (0.168205 --> 0.168196).  Saving model ...
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.2031095
	speed: 0.4019s/iter; left time: 2138.6049s
	iters: 200, epoch: 16 | loss: 0.1593887
	speed: 0.0952s/iter; left time: 496.8913s
	iters: 300, epoch: 16 | loss: 0.1639852
	speed: 0.0958s/iter; left time: 490.6243s
	iters: 400, epoch: 16 | loss: 0.2010091
	speed: 0.0965s/iter; left time: 484.3001s
	iters: 500, epoch: 16 | loss: 0.1740356
	speed: 0.0954s/iter; left time: 469.3702s
	iters: 600, epoch: 16 | loss: 0.2572882
	speed: 0.0951s/iter; left time: 458.3277s
	iters: 700, epoch: 16 | loss: 0.1750424
	speed: 0.0953s/iter; left time: 450.1101s
	iters: 800, epoch: 16 | loss: 0.2418495
	speed: 0.0960s/iter; left time: 443.5552s
	iters: 900, epoch: 16 | loss: 0.2115986
	speed: 0.0959s/iter; left time: 433.5251s
	iters: 1000, epoch: 16 | loss: 0.1597129
	speed: 0.1015s/iter; left time: 448.8171s
Epoch: 16 cost time: 105.12709951400757
Epoch: 16, Steps: 1084 | Train Loss: 0.1952016 Vali Loss: 0.1681823 Test Loss: 0.2015601
Validation loss decreased (0.168196 --> 0.168182).  Saving model ...
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 17 | loss: 0.2110362
	speed: 0.4041s/iter; left time: 1712.2016s
	iters: 200, epoch: 17 | loss: 0.1722497
	speed: 0.0945s/iter; left time: 390.8071s
	iters: 300, epoch: 17 | loss: 0.1924489
	speed: 0.0949s/iter; left time: 383.2681s
	iters: 400, epoch: 17 | loss: 0.2241081
	speed: 0.0947s/iter; left time: 372.9280s
	iters: 500, epoch: 17 | loss: 0.1998346
	speed: 0.0953s/iter; left time: 365.8126s
	iters: 600, epoch: 17 | loss: 0.1777443
	speed: 0.0957s/iter; left time: 357.5082s
	iters: 700, epoch: 17 | loss: 0.2005544
	speed: 0.0952s/iter; left time: 346.4054s
	iters: 800, epoch: 17 | loss: 0.1826290
	speed: 0.0948s/iter; left time: 335.2338s
	iters: 900, epoch: 17 | loss: 0.1961845
	speed: 0.0969s/iter; left time: 333.1311s
	iters: 1000, epoch: 17 | loss: 0.2078288
	speed: 0.1003s/iter; left time: 334.7271s
Epoch: 17 cost time: 104.46994757652283
Epoch: 17, Steps: 1084 | Train Loss: 0.1951834 Vali Loss: 0.1682533 Test Loss: 0.2015575
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 18 | loss: 0.2112588
	speed: 0.3745s/iter; left time: 1180.6515s
	iters: 200, epoch: 18 | loss: 0.1739830
	speed: 0.0945s/iter; left time: 288.6260s
	iters: 300, epoch: 18 | loss: 0.1835719
	speed: 0.0959s/iter; left time: 283.1845s
	iters: 400, epoch: 18 | loss: 0.1787762
	speed: 0.0957s/iter; left time: 273.0012s
	iters: 500, epoch: 18 | loss: 0.1858380
	speed: 0.0955s/iter; left time: 263.0025s
	iters: 600, epoch: 18 | loss: 0.1703029
	speed: 0.0958s/iter; left time: 254.0433s
	iters: 700, epoch: 18 | loss: 0.1919014
	speed: 0.0946s/iter; left time: 241.5638s
	iters: 800, epoch: 18 | loss: 0.1691916
	speed: 0.0949s/iter; left time: 232.9091s
	iters: 900, epoch: 18 | loss: 0.1809015
	speed: 0.0982s/iter; left time: 231.0607s
	iters: 1000, epoch: 18 | loss: 0.1747767
	speed: 0.1025s/iter; left time: 231.0367s
Epoch: 18 cost time: 104.53184342384338
Epoch: 18, Steps: 1084 | Train Loss: 0.1951690 Vali Loss: 0.1682336 Test Loss: 0.2015563
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 19 | loss: 0.1946061
	speed: 0.3714s/iter; left time: 768.5159s
	iters: 200, epoch: 19 | loss: 0.1801821
	speed: 0.0946s/iter; left time: 186.3146s
	iters: 300, epoch: 19 | loss: 0.2134673
	speed: 0.0946s/iter; left time: 176.7337s
	iters: 400, epoch: 19 | loss: 0.2042008
	speed: 0.0946s/iter; left time: 167.3174s
	iters: 500, epoch: 19 | loss: 0.1790842
	speed: 0.0958s/iter; left time: 159.9401s
	iters: 600, epoch: 19 | loss: 0.1695353
	speed: 0.0957s/iter; left time: 150.1643s
	iters: 700, epoch: 19 | loss: 0.1723796
	speed: 0.0947s/iter; left time: 139.1877s
	iters: 800, epoch: 19 | loss: 0.2108731
	speed: 0.0975s/iter; left time: 133.4927s
	iters: 900, epoch: 19 | loss: 0.2447651
	speed: 0.1006s/iter; left time: 127.6599s
	iters: 1000, epoch: 19 | loss: 0.1696055
	speed: 0.1004s/iter; left time: 117.3096s
Epoch: 19 cost time: 104.6913275718689
Epoch: 19, Steps: 1084 | Train Loss: 0.1951745 Vali Loss: 0.1681966 Test Loss: 0.2015561
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.9073486328125e-08
	iters: 100, epoch: 20 | loss: 0.1799931
	speed: 0.3683s/iter; left time: 362.8157s
	iters: 200, epoch: 20 | loss: 0.2064621
	speed: 0.0947s/iter; left time: 83.8407s
	iters: 300, epoch: 20 | loss: 0.1815005
	speed: 0.0947s/iter; left time: 74.3464s
	iters: 400, epoch: 20 | loss: 0.1925914
	speed: 0.0946s/iter; left time: 64.8104s
	iters: 500, epoch: 20 | loss: 0.1929133
	speed: 0.0944s/iter; left time: 55.2194s
	iters: 600, epoch: 20 | loss: 0.1711877
	speed: 0.0945s/iter; left time: 45.8473s
	iters: 700, epoch: 20 | loss: 0.1796519
	speed: 0.0949s/iter; left time: 36.5388s
	iters: 800, epoch: 20 | loss: 0.2029352
	speed: 0.0971s/iter; left time: 27.6859s
	iters: 900, epoch: 20 | loss: 0.2190469
	speed: 0.1003s/iter; left time: 18.5541s
	iters: 1000, epoch: 20 | loss: 0.1867175
	speed: 0.0991s/iter; left time: 8.4229s
Epoch: 20 cost time: 104.24718642234802
Epoch: 20, Steps: 1084 | Train Loss: 0.1951726 Vali Loss: 0.1682577 Test Loss: 0.2015558
EarlyStopping counter: 4 out of 5
Updating learning rate to 9.5367431640625e-09
>>>>>>>testing : Electricity_336_720_Linear_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed10458<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4541
mse:0.20146360993385315, mae:0.29745596647262573
