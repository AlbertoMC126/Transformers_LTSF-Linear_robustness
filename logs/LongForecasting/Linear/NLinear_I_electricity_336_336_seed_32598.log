Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='NLinear', model_id='Electricity_336_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=336, root_path='./dataset/', save_pred_values=False, seed=32598, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : Electricity_336_336_NLinear_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed32598>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17741
val 2297
test 4925
	iters: 100, epoch: 1 | loss: 0.2593203
	speed: 0.1015s/iter; left time: 2239.7390s
	iters: 200, epoch: 1 | loss: 0.2872611
	speed: 0.0857s/iter; left time: 1881.6165s
	iters: 300, epoch: 1 | loss: 0.2303660
	speed: 0.0859s/iter; left time: 1878.4319s
	iters: 400, epoch: 1 | loss: 0.2500616
	speed: 0.0875s/iter; left time: 1903.6220s
	iters: 500, epoch: 1 | loss: 0.2363388
	speed: 0.0871s/iter; left time: 1886.0209s
	iters: 600, epoch: 1 | loss: 0.3190879
	speed: 0.0888s/iter; left time: 1914.7250s
	iters: 700, epoch: 1 | loss: 0.2525418
	speed: 0.0887s/iter; left time: 1904.3679s
	iters: 800, epoch: 1 | loss: 0.2735667
	speed: 0.0874s/iter; left time: 1867.6279s
	iters: 900, epoch: 1 | loss: 0.2753087
	speed: 0.0887s/iter; left time: 1886.4173s
	iters: 1000, epoch: 1 | loss: 0.2439913
	speed: 0.0879s/iter; left time: 1860.8806s
	iters: 1100, epoch: 1 | loss: 0.2688535
	speed: 0.0864s/iter; left time: 1818.7670s
Epoch: 1 cost time: 98.3453061580658
Epoch: 1, Steps: 1108 | Train Loss: 0.2800636 Vali Loss: 0.2201480 Test Loss: 0.2419930
Validation loss decreased (inf --> 0.220148).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.2881990
	speed: 0.2454s/iter; left time: 5142.6906s
	iters: 200, epoch: 2 | loss: 0.2815472
	speed: 0.0851s/iter; left time: 1775.5534s
	iters: 300, epoch: 2 | loss: 0.2603331
	speed: 0.0844s/iter; left time: 1751.3311s
	iters: 400, epoch: 2 | loss: 0.2593331
	speed: 0.0851s/iter; left time: 1756.8854s
	iters: 500, epoch: 2 | loss: 0.2919148
	speed: 0.0843s/iter; left time: 1732.6956s
	iters: 600, epoch: 2 | loss: 0.3120553
	speed: 0.0845s/iter; left time: 1728.6893s
	iters: 700, epoch: 2 | loss: 0.2481372
	speed: 0.0869s/iter; left time: 1768.0037s
	iters: 800, epoch: 2 | loss: 0.3063190
	speed: 0.0891s/iter; left time: 1804.1319s
	iters: 900, epoch: 2 | loss: 0.2997356
	speed: 0.0896s/iter; left time: 1804.7750s
	iters: 1000, epoch: 2 | loss: 0.2643594
	speed: 0.0905s/iter; left time: 1815.5506s
	iters: 1100, epoch: 2 | loss: 0.2653367
	speed: 0.0860s/iter; left time: 1716.7993s
Epoch: 2 cost time: 95.95981740951538
Epoch: 2, Steps: 1108 | Train Loss: 0.2641422 Vali Loss: 0.2203046 Test Loss: 0.2495037
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.2046882
	speed: 0.2272s/iter; left time: 4508.9122s
	iters: 200, epoch: 3 | loss: 0.1616519
	speed: 0.0851s/iter; left time: 1679.8005s
	iters: 300, epoch: 3 | loss: 0.2233289
	speed: 0.0862s/iter; left time: 1693.0403s
	iters: 400, epoch: 3 | loss: 0.1878814
	speed: 0.0852s/iter; left time: 1666.0532s
	iters: 500, epoch: 3 | loss: 0.2162391
	speed: 0.0845s/iter; left time: 1643.4438s
	iters: 600, epoch: 3 | loss: 0.2090738
	speed: 0.0848s/iter; left time: 1640.1084s
	iters: 700, epoch: 3 | loss: 0.2061867
	speed: 0.0854s/iter; left time: 1644.2661s
	iters: 800, epoch: 3 | loss: 0.2419145
	speed: 0.0853s/iter; left time: 1633.9110s
	iters: 900, epoch: 3 | loss: 0.1976971
	speed: 0.0851s/iter; left time: 1619.7870s
	iters: 1000, epoch: 3 | loss: 0.2541787
	speed: 0.0858s/iter; left time: 1626.2438s
	iters: 1100, epoch: 3 | loss: 0.2294215
	speed: 0.0857s/iter; left time: 1614.7545s
Epoch: 3 cost time: 94.54609680175781
Epoch: 3, Steps: 1108 | Train Loss: 0.2067251 Vali Loss: 0.1797231 Test Loss: 0.2037105
Validation loss decreased (0.220148 --> 0.179723).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.1639562
	speed: 0.2456s/iter; left time: 4601.3730s
	iters: 200, epoch: 4 | loss: 0.1841446
	speed: 0.0860s/iter; left time: 1603.2486s
	iters: 300, epoch: 4 | loss: 0.1745178
	speed: 0.0856s/iter; left time: 1587.4879s
	iters: 400, epoch: 4 | loss: 0.1816139
	speed: 0.0861s/iter; left time: 1587.9664s
	iters: 500, epoch: 4 | loss: 0.1816848
	speed: 0.0869s/iter; left time: 1592.9519s
	iters: 600, epoch: 4 | loss: 0.1889601
	speed: 0.0871s/iter; left time: 1588.1542s
	iters: 700, epoch: 4 | loss: 0.1715497
	speed: 0.0866s/iter; left time: 1571.1049s
	iters: 800, epoch: 4 | loss: 0.2144423
	speed: 0.0868s/iter; left time: 1564.9728s
	iters: 900, epoch: 4 | loss: 0.1904603
	speed: 0.0870s/iter; left time: 1560.4781s
	iters: 1000, epoch: 4 | loss: 0.2019789
	speed: 0.0851s/iter; left time: 1518.6504s
	iters: 1100, epoch: 4 | loss: 0.2133168
	speed: 0.0851s/iter; left time: 1509.1587s
Epoch: 4 cost time: 95.68639636039734
Epoch: 4, Steps: 1108 | Train Loss: 0.1870557 Vali Loss: 0.1631012 Test Loss: 0.1843478
Validation loss decreased (0.179723 --> 0.163101).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.1732507
	speed: 0.2442s/iter; left time: 4304.4908s
	iters: 200, epoch: 5 | loss: 0.1928053
	speed: 0.0857s/iter; left time: 1502.6108s
	iters: 300, epoch: 5 | loss: 0.2129686
	speed: 0.0861s/iter; left time: 1500.9979s
	iters: 400, epoch: 5 | loss: 0.1862002
	speed: 0.0853s/iter; left time: 1478.5025s
	iters: 500, epoch: 5 | loss: 0.2070262
	speed: 0.0849s/iter; left time: 1463.5407s
	iters: 600, epoch: 5 | loss: 0.1727929
	speed: 0.0842s/iter; left time: 1443.0694s
	iters: 700, epoch: 5 | loss: 0.1666608
	speed: 0.0844s/iter; left time: 1437.6589s
	iters: 800, epoch: 5 | loss: 0.1994532
	speed: 0.0876s/iter; left time: 1482.7702s
	iters: 900, epoch: 5 | loss: 0.1794718
	speed: 0.0879s/iter; left time: 1479.8207s
	iters: 1000, epoch: 5 | loss: 0.1744099
	speed: 0.0864s/iter; left time: 1444.9080s
	iters: 1100, epoch: 5 | loss: 0.1619401
	speed: 0.0914s/iter; left time: 1519.2219s
Epoch: 5 cost time: 95.77269387245178
Epoch: 5, Steps: 1108 | Train Loss: 0.1772828 Vali Loss: 0.1537808 Test Loss: 0.1780576
Validation loss decreased (0.163101 --> 0.153781).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.1562933
	speed: 0.2518s/iter; left time: 4159.6171s
	iters: 200, epoch: 6 | loss: 0.1653464
	speed: 0.0861s/iter; left time: 1413.2440s
	iters: 300, epoch: 6 | loss: 0.1926219
	speed: 0.0851s/iter; left time: 1389.3510s
	iters: 400, epoch: 6 | loss: 0.1731149
	speed: 0.0851s/iter; left time: 1379.7476s
	iters: 500, epoch: 6 | loss: 0.1672672
	speed: 0.0852s/iter; left time: 1373.3168s
	iters: 600, epoch: 6 | loss: 0.1623111
	speed: 0.0856s/iter; left time: 1371.7730s
	iters: 700, epoch: 6 | loss: 0.1658511
	speed: 0.0862s/iter; left time: 1372.0765s
	iters: 800, epoch: 6 | loss: 0.2028443
	speed: 0.0851s/iter; left time: 1346.2908s
	iters: 900, epoch: 6 | loss: 0.1596329
	speed: 0.0855s/iter; left time: 1343.5063s
	iters: 1000, epoch: 6 | loss: 0.1746998
	speed: 0.0850s/iter; left time: 1327.7716s
	iters: 1100, epoch: 6 | loss: 0.1650100
	speed: 0.0850s/iter; left time: 1319.0030s
Epoch: 6 cost time: 95.15061354637146
Epoch: 6, Steps: 1108 | Train Loss: 0.1721669 Vali Loss: 0.1498451 Test Loss: 0.1737746
Validation loss decreased (0.153781 --> 0.149845).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.1675363
	speed: 0.2458s/iter; left time: 3788.1403s
	iters: 200, epoch: 7 | loss: 0.1447350
	speed: 0.0855s/iter; left time: 1308.8787s
	iters: 300, epoch: 7 | loss: 0.1714256
	speed: 0.0861s/iter; left time: 1309.6079s
	iters: 400, epoch: 7 | loss: 0.1613787
	speed: 0.0865s/iter; left time: 1307.7990s
	iters: 500, epoch: 7 | loss: 0.1646553
	speed: 0.0859s/iter; left time: 1289.7501s
	iters: 600, epoch: 7 | loss: 0.1916131
	speed: 0.0855s/iter; left time: 1274.4884s
	iters: 700, epoch: 7 | loss: 0.1529873
	speed: 0.0872s/iter; left time: 1291.1052s
	iters: 800, epoch: 7 | loss: 0.1561041
	speed: 0.0864s/iter; left time: 1270.8502s
	iters: 900, epoch: 7 | loss: 0.1567639
	speed: 0.0858s/iter; left time: 1253.5072s
	iters: 1000, epoch: 7 | loss: 0.1609581
	speed: 0.0861s/iter; left time: 1248.8833s
	iters: 1100, epoch: 7 | loss: 0.1907410
	speed: 0.0878s/iter; left time: 1265.6003s
Epoch: 7 cost time: 95.69337511062622
Epoch: 7, Steps: 1108 | Train Loss: 0.1690699 Vali Loss: 0.1472187 Test Loss: 0.1702743
Validation loss decreased (0.149845 --> 0.147219).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.1675365
	speed: 0.2449s/iter; left time: 3502.9969s
	iters: 200, epoch: 8 | loss: 0.1758453
	speed: 0.0876s/iter; left time: 1244.2899s
	iters: 300, epoch: 8 | loss: 0.1732862
	speed: 0.0878s/iter; left time: 1237.9413s
	iters: 400, epoch: 8 | loss: 0.1792372
	speed: 0.0864s/iter; left time: 1209.9600s
	iters: 500, epoch: 8 | loss: 0.2174087
	speed: 0.0852s/iter; left time: 1185.3766s
	iters: 600, epoch: 8 | loss: 0.1500546
	speed: 0.0850s/iter; left time: 1173.1869s
	iters: 700, epoch: 8 | loss: 0.1608208
	speed: 0.0860s/iter; left time: 1178.7244s
	iters: 800, epoch: 8 | loss: 0.1919547
	speed: 0.0853s/iter; left time: 1160.1294s
	iters: 900, epoch: 8 | loss: 0.1671649
	speed: 0.0858s/iter; left time: 1159.3796s
	iters: 1000, epoch: 8 | loss: 0.1379226
	speed: 0.0855s/iter; left time: 1145.8020s
	iters: 1100, epoch: 8 | loss: 0.1856281
	speed: 0.0859s/iter; left time: 1142.3706s
Epoch: 8 cost time: 95.65504765510559
Epoch: 8, Steps: 1108 | Train Loss: 0.1673936 Vali Loss: 0.1460316 Test Loss: 0.1690484
Validation loss decreased (0.147219 --> 0.146032).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.2185418
	speed: 0.2437s/iter; left time: 3215.6866s
	iters: 200, epoch: 9 | loss: 0.1641328
	speed: 0.0871s/iter; left time: 1140.5715s
	iters: 300, epoch: 9 | loss: 0.1729894
	speed: 0.0860s/iter; left time: 1118.0071s
	iters: 400, epoch: 9 | loss: 0.1536696
	speed: 0.0902s/iter; left time: 1163.8355s
	iters: 500, epoch: 9 | loss: 0.2187764
	speed: 0.0857s/iter; left time: 1097.2243s
	iters: 600, epoch: 9 | loss: 0.1469214
	speed: 0.0842s/iter; left time: 1069.1885s
	iters: 700, epoch: 9 | loss: 0.1509024
	speed: 0.0846s/iter; left time: 1065.3125s
	iters: 800, epoch: 9 | loss: 0.1711691
	speed: 0.0848s/iter; left time: 1059.9958s
	iters: 900, epoch: 9 | loss: 0.2113115
	speed: 0.0849s/iter; left time: 1052.9176s
	iters: 1000, epoch: 9 | loss: 0.1654266
	speed: 0.0852s/iter; left time: 1047.9224s
	iters: 1100, epoch: 9 | loss: 0.1576869
	speed: 0.0854s/iter; left time: 1041.1325s
Epoch: 9 cost time: 95.29385328292847
Epoch: 9, Steps: 1108 | Train Loss: 0.1665655 Vali Loss: 0.1454387 Test Loss: 0.1685344
Validation loss decreased (0.146032 --> 0.145439).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.1779599
	speed: 0.2447s/iter; left time: 2958.7418s
	iters: 200, epoch: 10 | loss: 0.1486693
	speed: 0.0849s/iter; left time: 1017.7677s
	iters: 300, epoch: 10 | loss: 0.1878339
	speed: 0.0861s/iter; left time: 1023.3519s
	iters: 400, epoch: 10 | loss: 0.1508251
	speed: 0.0867s/iter; left time: 1022.5210s
	iters: 500, epoch: 10 | loss: 0.1618317
	speed: 0.0865s/iter; left time: 1011.1743s
	iters: 600, epoch: 10 | loss: 0.1655319
	speed: 0.0845s/iter; left time: 978.7039s
	iters: 700, epoch: 10 | loss: 0.1532124
	speed: 0.0851s/iter; left time: 977.2570s
	iters: 800, epoch: 10 | loss: 0.1966132
	speed: 0.0853s/iter; left time: 971.0826s
	iters: 900, epoch: 10 | loss: 0.2281553
	speed: 0.0860s/iter; left time: 970.4835s
	iters: 1000, epoch: 10 | loss: 0.2109550
	speed: 0.0855s/iter; left time: 956.1811s
	iters: 1100, epoch: 10 | loss: 0.1629611
	speed: 0.0861s/iter; left time: 954.4405s
Epoch: 10 cost time: 94.93386650085449
Epoch: 10, Steps: 1108 | Train Loss: 0.1660754 Vali Loss: 0.1450408 Test Loss: 0.1681455
Validation loss decreased (0.145439 --> 0.145041).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.1666809
	speed: 0.2456s/iter; left time: 2697.3009s
	iters: 200, epoch: 11 | loss: 0.1822597
	speed: 0.0855s/iter; left time: 930.2153s
	iters: 300, epoch: 11 | loss: 0.1654920
	speed: 0.0853s/iter; left time: 919.7053s
	iters: 400, epoch: 11 | loss: 0.1662997
	speed: 0.0888s/iter; left time: 948.7425s
	iters: 500, epoch: 11 | loss: 0.1368259
	speed: 0.0864s/iter; left time: 914.3295s
	iters: 600, epoch: 11 | loss: 0.1535053
	speed: 0.0857s/iter; left time: 898.0369s
	iters: 700, epoch: 11 | loss: 0.1775142
	speed: 0.0861s/iter; left time: 894.0383s
	iters: 800, epoch: 11 | loss: 0.1368926
	speed: 0.0855s/iter; left time: 879.0489s
	iters: 900, epoch: 11 | loss: 0.1942894
	speed: 0.0846s/iter; left time: 860.9839s
	iters: 1000, epoch: 11 | loss: 0.2230327
	speed: 0.0855s/iter; left time: 862.2386s
	iters: 1100, epoch: 11 | loss: 0.1639043
	speed: 0.0860s/iter; left time: 858.4251s
Epoch: 11 cost time: 95.4601674079895
Epoch: 11, Steps: 1108 | Train Loss: 0.1658462 Vali Loss: 0.1449260 Test Loss: 0.1680265
Validation loss decreased (0.145041 --> 0.144926).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.1413118
	speed: 0.2420s/iter; left time: 2389.6643s
	iters: 200, epoch: 12 | loss: 0.1585224
	speed: 0.0857s/iter; left time: 838.0246s
	iters: 300, epoch: 12 | loss: 0.1903378
	speed: 0.0856s/iter; left time: 828.4052s
	iters: 400, epoch: 12 | loss: 0.1523597
	speed: 0.0858s/iter; left time: 821.4507s
	iters: 500, epoch: 12 | loss: 0.1612500
	speed: 0.0852s/iter; left time: 807.4297s
	iters: 600, epoch: 12 | loss: 0.1486547
	speed: 0.0845s/iter; left time: 792.2834s
	iters: 700, epoch: 12 | loss: 0.1326196
	speed: 0.0886s/iter; left time: 821.8063s
	iters: 800, epoch: 12 | loss: 0.1666823
	speed: 0.0858s/iter; left time: 786.7606s
	iters: 900, epoch: 12 | loss: 0.1622636
	speed: 0.0859s/iter; left time: 778.9524s
	iters: 1000, epoch: 12 | loss: 0.1612077
	speed: 0.0849s/iter; left time: 761.6075s
	iters: 1100, epoch: 12 | loss: 0.1419255
	speed: 0.0847s/iter; left time: 751.1892s
Epoch: 12 cost time: 95.00855684280396
Epoch: 12, Steps: 1108 | Train Loss: 0.1657164 Vali Loss: 0.1448007 Test Loss: 0.1678859
Validation loss decreased (0.144926 --> 0.144801).  Saving model ...
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.1790557
	speed: 0.2420s/iter; left time: 2121.4438s
	iters: 200, epoch: 13 | loss: 0.1788714
	speed: 0.0848s/iter; left time: 734.9174s
	iters: 300, epoch: 13 | loss: 0.1285602
	speed: 0.0846s/iter; left time: 724.8542s
	iters: 400, epoch: 13 | loss: 0.1463414
	speed: 0.0852s/iter; left time: 721.4759s
	iters: 500, epoch: 13 | loss: 0.1868666
	speed: 0.0845s/iter; left time: 706.6609s
	iters: 600, epoch: 13 | loss: 0.1685107
	speed: 0.0850s/iter; left time: 702.4516s
	iters: 700, epoch: 13 | loss: 0.1721068
	speed: 0.0867s/iter; left time: 707.5355s
	iters: 800, epoch: 13 | loss: 0.1451527
	speed: 0.0878s/iter; left time: 708.2695s
	iters: 900, epoch: 13 | loss: 0.1614146
	speed: 0.0867s/iter; left time: 690.7178s
	iters: 1000, epoch: 13 | loss: 0.2205832
	speed: 0.0849s/iter; left time: 667.6102s
	iters: 1100, epoch: 13 | loss: 0.1479147
	speed: 0.0847s/iter; left time: 657.7202s
Epoch: 13 cost time: 94.81218433380127
Epoch: 13, Steps: 1108 | Train Loss: 0.1656092 Vali Loss: 0.1448452 Test Loss: 0.1678268
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.1707703
	speed: 0.2258s/iter; left time: 1729.1775s
	iters: 200, epoch: 14 | loss: 0.1856405
	speed: 0.0859s/iter; left time: 649.4238s
	iters: 300, epoch: 14 | loss: 0.1665489
	speed: 0.0849s/iter; left time: 633.1099s
	iters: 400, epoch: 14 | loss: 0.1418703
	speed: 0.0862s/iter; left time: 634.1864s
	iters: 500, epoch: 14 | loss: 0.2116880
	speed: 0.0868s/iter; left time: 629.5527s
	iters: 600, epoch: 14 | loss: 0.1669747
	speed: 0.0861s/iter; left time: 616.4313s
	iters: 700, epoch: 14 | loss: 0.1758628
	speed: 0.0863s/iter; left time: 608.7436s
	iters: 800, epoch: 14 | loss: 0.1479673
	speed: 0.0880s/iter; left time: 611.9119s
	iters: 900, epoch: 14 | loss: 0.1604296
	speed: 0.0887s/iter; left time: 608.2087s
	iters: 1000, epoch: 14 | loss: 0.2279718
	speed: 0.0865s/iter; left time: 584.4226s
	iters: 1100, epoch: 14 | loss: 0.1423081
	speed: 0.0869s/iter; left time: 578.3974s
Epoch: 14 cost time: 95.8947389125824
Epoch: 14, Steps: 1108 | Train Loss: 0.1655774 Vali Loss: 0.1448234 Test Loss: 0.1678297
EarlyStopping counter: 2 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.1832516
	speed: 0.2265s/iter; left time: 1483.1409s
	iters: 200, epoch: 15 | loss: 0.1505678
	speed: 0.0853s/iter; left time: 549.9260s
	iters: 300, epoch: 15 | loss: 0.1429288
	speed: 0.0861s/iter; left time: 546.3376s
	iters: 400, epoch: 15 | loss: 0.1672632
	speed: 0.0855s/iter; left time: 534.3013s
	iters: 500, epoch: 15 | loss: 0.1599750
	speed: 0.0856s/iter; left time: 526.2408s
	iters: 600, epoch: 15 | loss: 0.1796165
	speed: 0.0845s/iter; left time: 511.1012s
	iters: 700, epoch: 15 | loss: 0.1603893
	speed: 0.0870s/iter; left time: 517.7112s
	iters: 800, epoch: 15 | loss: 0.1551050
	speed: 0.0859s/iter; left time: 502.6075s
	iters: 900, epoch: 15 | loss: 0.1831296
	speed: 0.0900s/iter; left time: 517.4842s
	iters: 1000, epoch: 15 | loss: 0.1800462
	speed: 0.0898s/iter; left time: 507.4469s
	iters: 1100, epoch: 15 | loss: 0.1566941
	speed: 0.0884s/iter; left time: 490.6789s
Epoch: 15 cost time: 96.1517083644867
Epoch: 15, Steps: 1108 | Train Loss: 0.1655787 Vali Loss: 0.1448172 Test Loss: 0.1678221
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.1385083
	speed: 0.2278s/iter; left time: 1239.5398s
	iters: 200, epoch: 16 | loss: 0.1771331
	speed: 0.0851s/iter; left time: 454.6812s
	iters: 300, epoch: 16 | loss: 0.1672137
	speed: 0.0851s/iter; left time: 446.1840s
	iters: 400, epoch: 16 | loss: 0.1767819
	speed: 0.0918s/iter; left time: 472.0974s
	iters: 500, epoch: 16 | loss: 0.1563670
	speed: 0.0959s/iter; left time: 483.4616s
	iters: 600, epoch: 16 | loss: 0.1627395
	speed: 0.0974s/iter; left time: 481.4707s
	iters: 700, epoch: 16 | loss: 0.1630574
	speed: 0.0983s/iter; left time: 475.7123s
	iters: 800, epoch: 16 | loss: 0.1534054
	speed: 0.0972s/iter; left time: 460.8155s
	iters: 900, epoch: 16 | loss: 0.1751487
	speed: 0.0905s/iter; left time: 420.1171s
	iters: 1000, epoch: 16 | loss: 0.1651340
	speed: 0.0880s/iter; left time: 399.4471s
	iters: 1100, epoch: 16 | loss: 0.1758027
	speed: 0.0859s/iter; left time: 381.6052s
Epoch: 16 cost time: 100.66674876213074
Epoch: 16, Steps: 1108 | Train Loss: 0.1655681 Vali Loss: 0.1447672 Test Loss: 0.1678220
Validation loss decreased (0.144801 --> 0.144767).  Saving model ...
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 17 | loss: 0.1920069
	speed: 0.2466s/iter; left time: 1068.6952s
	iters: 200, epoch: 17 | loss: 0.1939050
	speed: 0.0848s/iter; left time: 359.0723s
	iters: 300, epoch: 17 | loss: 0.1948079
	speed: 0.0851s/iter; left time: 351.5898s
	iters: 400, epoch: 17 | loss: 0.1353626
	speed: 0.0864s/iter; left time: 348.3429s
	iters: 500, epoch: 17 | loss: 0.1668676
	speed: 0.0858s/iter; left time: 337.2558s
	iters: 600, epoch: 17 | loss: 0.1666776
	speed: 0.0853s/iter; left time: 326.8015s
	iters: 700, epoch: 17 | loss: 0.1979738
	speed: 0.0865s/iter; left time: 322.7267s
	iters: 800, epoch: 17 | loss: 0.1420534
	speed: 0.0868s/iter; left time: 315.5115s
	iters: 900, epoch: 17 | loss: 0.1648469
	speed: 0.0860s/iter; left time: 303.6762s
	iters: 1000, epoch: 17 | loss: 0.1700393
	speed: 0.0859s/iter; left time: 294.7345s
	iters: 1100, epoch: 17 | loss: 0.1870129
	speed: 0.0888s/iter; left time: 295.8697s
Epoch: 17 cost time: 95.46038866043091
Epoch: 17, Steps: 1108 | Train Loss: 0.1655584 Vali Loss: 0.1449232 Test Loss: 0.1678211
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 18 | loss: 0.1706888
	speed: 0.2315s/iter; left time: 746.6869s
	iters: 200, epoch: 18 | loss: 0.1871662
	speed: 0.0852s/iter; left time: 266.3572s
	iters: 300, epoch: 18 | loss: 0.1537068
	speed: 0.0863s/iter; left time: 261.1916s
	iters: 400, epoch: 18 | loss: 0.1460960
	speed: 0.0867s/iter; left time: 253.5145s
	iters: 500, epoch: 18 | loss: 0.1529300
	speed: 0.0853s/iter; left time: 240.8837s
	iters: 600, epoch: 18 | loss: 0.1847762
	speed: 0.0858s/iter; left time: 233.8922s
	iters: 700, epoch: 18 | loss: 0.1695239
	speed: 0.0858s/iter; left time: 225.2822s
	iters: 800, epoch: 18 | loss: 0.1656305
	speed: 0.0870s/iter; left time: 219.7455s
	iters: 900, epoch: 18 | loss: 0.1397133
	speed: 0.0862s/iter; left time: 209.1051s
	iters: 1000, epoch: 18 | loss: 0.1417096
	speed: 0.0860s/iter; left time: 199.9983s
	iters: 1100, epoch: 18 | loss: 0.1734079
	speed: 0.0864s/iter; left time: 192.1337s
Epoch: 18 cost time: 95.51006865501404
Epoch: 18, Steps: 1108 | Train Loss: 0.1655792 Vali Loss: 0.1448009 Test Loss: 0.1678214
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 19 | loss: 0.1701326
	speed: 0.2322s/iter; left time: 491.4660s
	iters: 200, epoch: 19 | loss: 0.1662360
	speed: 0.0847s/iter; left time: 170.8244s
	iters: 300, epoch: 19 | loss: 0.1454483
	speed: 0.0844s/iter; left time: 161.8368s
	iters: 400, epoch: 19 | loss: 0.1496587
	speed: 0.0841s/iter; left time: 152.8123s
	iters: 500, epoch: 19 | loss: 0.1648818
	speed: 0.0847s/iter; left time: 145.4200s
	iters: 600, epoch: 19 | loss: 0.1439825
	speed: 0.0846s/iter; left time: 136.8741s
	iters: 700, epoch: 19 | loss: 0.1570750
	speed: 0.0850s/iter; left time: 128.8808s
	iters: 800, epoch: 19 | loss: 0.1503879
	speed: 0.0846s/iter; left time: 119.9112s
	iters: 900, epoch: 19 | loss: 0.1581910
	speed: 0.0851s/iter; left time: 112.0608s
	iters: 1000, epoch: 19 | loss: 0.1825881
	speed: 0.0850s/iter; left time: 103.4439s
	iters: 1100, epoch: 19 | loss: 0.1724049
	speed: 0.0850s/iter; left time: 94.9375s
Epoch: 19 cost time: 93.88721442222595
Epoch: 19, Steps: 1108 | Train Loss: 0.1655675 Vali Loss: 0.1448208 Test Loss: 0.1678216
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.9073486328125e-08
	iters: 100, epoch: 20 | loss: 0.1811012
	speed: 0.2264s/iter; left time: 228.3989s
	iters: 200, epoch: 20 | loss: 0.1434454
	speed: 0.0847s/iter; left time: 77.0250s
	iters: 300, epoch: 20 | loss: 0.1433191
	speed: 0.0863s/iter; left time: 69.7794s
	iters: 400, epoch: 20 | loss: 0.1443484
	speed: 0.0866s/iter; left time: 61.3864s
	iters: 500, epoch: 20 | loss: 0.1696190
	speed: 0.0860s/iter; left time: 52.3793s
	iters: 600, epoch: 20 | loss: 0.1668560
	speed: 0.0853s/iter; left time: 43.4165s
	iters: 700, epoch: 20 | loss: 0.2036482
	speed: 0.0847s/iter; left time: 34.6252s
	iters: 800, epoch: 20 | loss: 0.1580584
	speed: 0.0861s/iter; left time: 26.5974s
	iters: 900, epoch: 20 | loss: 0.1662530
	speed: 0.0860s/iter; left time: 17.9823s
	iters: 1000, epoch: 20 | loss: 0.1533176
	speed: 0.0862s/iter; left time: 9.3911s
	iters: 1100, epoch: 20 | loss: 0.1467949
	speed: 0.0858s/iter; left time: 0.7725s
Epoch: 20 cost time: 95.05297827720642
Epoch: 20, Steps: 1108 | Train Loss: 0.1655628 Vali Loss: 0.1448466 Test Loss: 0.1678216
EarlyStopping counter: 4 out of 5
Updating learning rate to 9.5367431640625e-09
>>>>>>>testing : Electricity_336_336_NLinear_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed32598<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4925
mse:0.16771025955677032, mae:0.2601809501647949
