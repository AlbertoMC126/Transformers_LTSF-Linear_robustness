Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='Linear', model_id='ETTm2_336_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=3293, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTm2_336_96_Linear_ETTm2_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3293>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34129
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.1915525
	speed: 0.0029s/iter; left time: 61.3785s
	iters: 200, epoch: 1 | loss: 0.2933891
	speed: 0.0029s/iter; left time: 60.2056s
	iters: 300, epoch: 1 | loss: 0.3150787
	speed: 0.0045s/iter; left time: 94.6539s
	iters: 400, epoch: 1 | loss: 0.4460095
	speed: 0.0043s/iter; left time: 90.1695s
	iters: 500, epoch: 1 | loss: 0.4829159
	speed: 0.0038s/iter; left time: 79.7115s
	iters: 600, epoch: 1 | loss: 0.2888329
	speed: 0.0042s/iter; left time: 87.0734s
	iters: 700, epoch: 1 | loss: 0.3631841
	speed: 0.0040s/iter; left time: 83.3089s
	iters: 800, epoch: 1 | loss: 0.6704563
	speed: 0.0038s/iter; left time: 78.0344s
	iters: 900, epoch: 1 | loss: 0.4967300
	speed: 0.0044s/iter; left time: 90.2732s
	iters: 1000, epoch: 1 | loss: 0.5310783
	speed: 0.0042s/iter; left time: 84.7386s
Epoch: 1 cost time: 4.176204681396484
Epoch: 1, Steps: 1066 | Train Loss: 0.4156574 Vali Loss: 0.6227323 Test Loss: 1.7128265
Validation loss decreased (inf --> 0.622732).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.5622661
	speed: 0.0184s/iter; left time: 370.1475s
	iters: 200, epoch: 2 | loss: 0.3215844
	speed: 0.0041s/iter; left time: 82.4964s
	iters: 300, epoch: 2 | loss: 0.3282200
	speed: 0.0046s/iter; left time: 91.1869s
	iters: 400, epoch: 2 | loss: 0.3062873
	speed: 0.0037s/iter; left time: 74.0584s
	iters: 500, epoch: 2 | loss: 0.4003353
	speed: 0.0038s/iter; left time: 75.9037s
	iters: 600, epoch: 2 | loss: 0.3921058
	speed: 0.0046s/iter; left time: 90.8062s
	iters: 700, epoch: 2 | loss: 0.3198736
	speed: 0.0037s/iter; left time: 72.4046s
	iters: 800, epoch: 2 | loss: 0.3151546
	speed: 0.0038s/iter; left time: 74.3182s
	iters: 900, epoch: 2 | loss: 0.3356117
	speed: 0.0048s/iter; left time: 92.9464s
	iters: 1000, epoch: 2 | loss: 0.2610004
	speed: 0.0046s/iter; left time: 87.8030s
Epoch: 2 cost time: 4.426017761230469
Epoch: 2, Steps: 1066 | Train Loss: 0.3890755 Vali Loss: 0.3459798 Test Loss: 0.8025980
Validation loss decreased (0.622732 --> 0.345980).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.3896114
	speed: 0.0163s/iter; left time: 311.6539s
	iters: 200, epoch: 3 | loss: 0.1953425
	speed: 0.0035s/iter; left time: 65.5207s
	iters: 300, epoch: 3 | loss: 0.1885320
	speed: 0.0040s/iter; left time: 75.9333s
	iters: 400, epoch: 3 | loss: 0.2357065
	speed: 0.0037s/iter; left time: 68.9897s
	iters: 500, epoch: 3 | loss: 0.3273930
	speed: 0.0039s/iter; left time: 73.0805s
	iters: 600, epoch: 3 | loss: 0.1359115
	speed: 0.0042s/iter; left time: 78.6680s
	iters: 700, epoch: 3 | loss: 0.2780423
	speed: 0.0045s/iter; left time: 83.3854s
	iters: 800, epoch: 3 | loss: 0.2352241
	speed: 0.0039s/iter; left time: 70.9813s
	iters: 900, epoch: 3 | loss: 0.3967816
	speed: 0.0041s/iter; left time: 74.2974s
	iters: 1000, epoch: 3 | loss: 0.1956240
	speed: 0.0037s/iter; left time: 67.4810s
Epoch: 3 cost time: 4.169026136398315
Epoch: 3, Steps: 1066 | Train Loss: 0.2610674 Vali Loss: 0.2218717 Test Loss: 0.4076135
Validation loss decreased (0.345980 --> 0.221872).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.1560431
	speed: 0.0197s/iter; left time: 355.3104s
	iters: 200, epoch: 4 | loss: 0.0996459
	speed: 0.0046s/iter; left time: 81.7612s
	iters: 300, epoch: 4 | loss: 0.1615363
	speed: 0.0044s/iter; left time: 77.5303s
	iters: 400, epoch: 4 | loss: 0.1396214
	speed: 0.0047s/iter; left time: 83.8809s
	iters: 500, epoch: 4 | loss: 0.2393660
	speed: 0.0038s/iter; left time: 66.0949s
	iters: 600, epoch: 4 | loss: 0.1988696
	speed: 0.0046s/iter; left time: 80.4309s
	iters: 700, epoch: 4 | loss: 0.3102710
	speed: 0.0037s/iter; left time: 63.8252s
	iters: 800, epoch: 4 | loss: 0.2837577
	speed: 0.0036s/iter; left time: 62.7171s
	iters: 900, epoch: 4 | loss: 0.1944114
	speed: 0.0039s/iter; left time: 67.1694s
	iters: 1000, epoch: 4 | loss: 0.2149739
	speed: 0.0038s/iter; left time: 65.7810s
Epoch: 4 cost time: 4.436021089553833
Epoch: 4, Steps: 1066 | Train Loss: 0.2311204 Vali Loss: 0.1864200 Test Loss: 0.3718255
Validation loss decreased (0.221872 --> 0.186420).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.1627199
	speed: 0.0173s/iter; left time: 293.2317s
	iters: 200, epoch: 5 | loss: 0.1480810
	speed: 0.0038s/iter; left time: 64.4017s
	iters: 300, epoch: 5 | loss: 0.1389384
	speed: 0.0040s/iter; left time: 67.0281s
	iters: 400, epoch: 5 | loss: 0.2067501
	speed: 0.0044s/iter; left time: 73.5096s
	iters: 500, epoch: 5 | loss: 0.1251684
	speed: 0.0041s/iter; left time: 68.0580s
	iters: 600, epoch: 5 | loss: 0.1204782
	speed: 0.0033s/iter; left time: 54.5116s
	iters: 700, epoch: 5 | loss: 0.2629313
	speed: 0.0038s/iter; left time: 62.9744s
	iters: 800, epoch: 5 | loss: 0.1565518
	speed: 0.0043s/iter; left time: 69.4174s
	iters: 900, epoch: 5 | loss: 0.4150437
	speed: 0.0041s/iter; left time: 66.4406s
	iters: 1000, epoch: 5 | loss: 0.1498150
	speed: 0.0043s/iter; left time: 69.3663s
Epoch: 5 cost time: 4.333061695098877
Epoch: 5, Steps: 1066 | Train Loss: 0.2171416 Vali Loss: 0.2456741 Test Loss: 0.5097179
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.2045403
	speed: 0.0181s/iter; left time: 287.4122s
	iters: 200, epoch: 6 | loss: 0.2008314
	speed: 0.0045s/iter; left time: 71.7008s
	iters: 300, epoch: 6 | loss: 0.1788604
	speed: 0.0043s/iter; left time: 67.9790s
	iters: 400, epoch: 6 | loss: 0.1769238
	speed: 0.0043s/iter; left time: 66.2621s
	iters: 500, epoch: 6 | loss: 0.0893044
	speed: 0.0042s/iter; left time: 64.9475s
	iters: 600, epoch: 6 | loss: 0.2142372
	speed: 0.0041s/iter; left time: 63.7186s
	iters: 700, epoch: 6 | loss: 0.2282986
	speed: 0.0040s/iter; left time: 61.8028s
	iters: 800, epoch: 6 | loss: 0.2569197
	speed: 0.0042s/iter; left time: 64.2668s
	iters: 900, epoch: 6 | loss: 0.3110051
	speed: 0.0049s/iter; left time: 74.0969s
	iters: 1000, epoch: 6 | loss: 0.1133432
	speed: 0.0047s/iter; left time: 70.9494s
Epoch: 6 cost time: 4.659981727600098
Epoch: 6, Steps: 1066 | Train Loss: 0.2093652 Vali Loss: 0.1241068 Test Loss: 0.1882318
Validation loss decreased (0.186420 --> 0.124107).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.1293702
	speed: 0.0163s/iter; left time: 240.9437s
	iters: 200, epoch: 7 | loss: 0.1173776
	speed: 0.0046s/iter; left time: 68.3310s
	iters: 300, epoch: 7 | loss: 0.2904800
	speed: 0.0045s/iter; left time: 66.3975s
	iters: 400, epoch: 7 | loss: 0.1499348
	speed: 0.0034s/iter; left time: 48.7005s
	iters: 500, epoch: 7 | loss: 0.0954590
	speed: 0.0037s/iter; left time: 52.9486s
	iters: 600, epoch: 7 | loss: 0.2635466
	speed: 0.0041s/iter; left time: 58.4888s
	iters: 700, epoch: 7 | loss: 0.1514418
	speed: 0.0043s/iter; left time: 61.3785s
	iters: 800, epoch: 7 | loss: 0.2991865
	speed: 0.0039s/iter; left time: 54.8132s
	iters: 900, epoch: 7 | loss: 0.2186620
	speed: 0.0041s/iter; left time: 58.0921s
	iters: 1000, epoch: 7 | loss: 0.1092259
	speed: 0.0041s/iter; left time: 56.5255s
Epoch: 7 cost time: 4.295552492141724
Epoch: 7, Steps: 1066 | Train Loss: 0.2042079 Vali Loss: 0.1550985 Test Loss: 0.2750967
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.3125451
	speed: 0.0175s/iter; left time: 240.8513s
	iters: 200, epoch: 8 | loss: 0.1850646
	speed: 0.0038s/iter; left time: 52.1858s
	iters: 300, epoch: 8 | loss: 0.2244750
	speed: 0.0041s/iter; left time: 55.4968s
	iters: 400, epoch: 8 | loss: 0.2552191
	speed: 0.0042s/iter; left time: 56.6622s
	iters: 500, epoch: 8 | loss: 0.4987789
	speed: 0.0046s/iter; left time: 61.2245s
	iters: 600, epoch: 8 | loss: 0.1802012
	speed: 0.0046s/iter; left time: 60.3285s
	iters: 700, epoch: 8 | loss: 0.1313490
	speed: 0.0049s/iter; left time: 64.5038s
	iters: 800, epoch: 8 | loss: 0.1223887
	speed: 0.0043s/iter; left time: 56.5495s
	iters: 900, epoch: 8 | loss: 0.2208423
	speed: 0.0041s/iter; left time: 53.6507s
	iters: 1000, epoch: 8 | loss: 0.1024269
	speed: 0.0042s/iter; left time: 53.7757s
Epoch: 8 cost time: 4.581077337265015
Epoch: 8, Steps: 1066 | Train Loss: 0.2018633 Vali Loss: 0.1291606 Test Loss: 0.2036192
EarlyStopping counter: 2 out of 5
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.1639195
	speed: 0.0206s/iter; left time: 261.6809s
	iters: 200, epoch: 9 | loss: 0.2197238
	speed: 0.0044s/iter; left time: 55.9130s
	iters: 300, epoch: 9 | loss: 0.1391029
	speed: 0.0048s/iter; left time: 59.3690s
	iters: 400, epoch: 9 | loss: 0.1422223
	speed: 0.0049s/iter; left time: 60.2116s
	iters: 500, epoch: 9 | loss: 0.1976461
	speed: 0.0044s/iter; left time: 53.9955s
	iters: 600, epoch: 9 | loss: 0.2162729
	speed: 0.0043s/iter; left time: 52.0539s
	iters: 700, epoch: 9 | loss: 0.1458944
	speed: 0.0042s/iter; left time: 51.2989s
	iters: 800, epoch: 9 | loss: 0.1203778
	speed: 0.0048s/iter; left time: 58.1660s
	iters: 900, epoch: 9 | loss: 0.1062678
	speed: 0.0047s/iter; left time: 56.3960s
	iters: 1000, epoch: 9 | loss: 0.2457846
	speed: 0.0042s/iter; left time: 49.7733s
Epoch: 9 cost time: 4.780935049057007
Epoch: 9, Steps: 1066 | Train Loss: 0.2004816 Vali Loss: 0.1230256 Test Loss: 0.1817416
Validation loss decreased (0.124107 --> 0.123026).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.1721539
	speed: 0.0175s/iter; left time: 203.5279s
	iters: 200, epoch: 10 | loss: 0.1522633
	speed: 0.0034s/iter; left time: 38.8460s
	iters: 300, epoch: 10 | loss: 0.1998353
	speed: 0.0037s/iter; left time: 42.0583s
	iters: 400, epoch: 10 | loss: 0.1247667
	speed: 0.0041s/iter; left time: 46.3535s
	iters: 500, epoch: 10 | loss: 0.3545540
	speed: 0.0033s/iter; left time: 36.5904s
	iters: 600, epoch: 10 | loss: 0.1484351
	speed: 0.0037s/iter; left time: 41.0880s
	iters: 700, epoch: 10 | loss: 0.4313082
	speed: 0.0042s/iter; left time: 46.2096s
	iters: 800, epoch: 10 | loss: 0.1423181
	speed: 0.0042s/iter; left time: 45.8934s
	iters: 900, epoch: 10 | loss: 0.2419111
	speed: 0.0039s/iter; left time: 42.4777s
	iters: 1000, epoch: 10 | loss: 0.2858668
	speed: 0.0039s/iter; left time: 41.4122s
Epoch: 10 cost time: 4.13805890083313
Epoch: 10, Steps: 1066 | Train Loss: 0.1998331 Vali Loss: 0.1255596 Test Loss: 0.1921552
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.2313535
	speed: 0.0200s/iter; left time: 210.7375s
	iters: 200, epoch: 11 | loss: 0.0988382
	speed: 0.0044s/iter; left time: 46.4968s
	iters: 300, epoch: 11 | loss: 0.2856901
	speed: 0.0042s/iter; left time: 43.1066s
	iters: 400, epoch: 11 | loss: 0.1034048
	speed: 0.0038s/iter; left time: 38.9084s
	iters: 500, epoch: 11 | loss: 0.2691523
	speed: 0.0037s/iter; left time: 37.8180s
	iters: 600, epoch: 11 | loss: 0.1112364
	speed: 0.0038s/iter; left time: 37.9299s
	iters: 700, epoch: 11 | loss: 0.1507730
	speed: 0.0035s/iter; left time: 35.3009s
	iters: 800, epoch: 11 | loss: 0.3487828
	speed: 0.0036s/iter; left time: 35.4996s
	iters: 900, epoch: 11 | loss: 0.1872693
	speed: 0.0040s/iter; left time: 39.0440s
	iters: 1000, epoch: 11 | loss: 0.1683971
	speed: 0.0037s/iter; left time: 35.8820s
Epoch: 11 cost time: 4.06670069694519
Epoch: 11, Steps: 1066 | Train Loss: 0.1993563 Vali Loss: 0.1308397 Test Loss: 0.2057582
EarlyStopping counter: 2 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.3554436
	speed: 0.0147s/iter; left time: 139.9800s
	iters: 200, epoch: 12 | loss: 0.2226611
	speed: 0.0031s/iter; left time: 29.4063s
	iters: 300, epoch: 12 | loss: 0.2237672
	speed: 0.0038s/iter; left time: 35.7213s
	iters: 400, epoch: 12 | loss: 0.2792084
	speed: 0.0036s/iter; left time: 33.5506s
	iters: 500, epoch: 12 | loss: 0.1341283
	speed: 0.0037s/iter; left time: 33.2674s
	iters: 600, epoch: 12 | loss: 0.1324607
	speed: 0.0043s/iter; left time: 39.0382s
	iters: 700, epoch: 12 | loss: 0.2065312
	speed: 0.0038s/iter; left time: 34.0678s
	iters: 800, epoch: 12 | loss: 0.1263812
	speed: 0.0042s/iter; left time: 36.5263s
	iters: 900, epoch: 12 | loss: 0.1315777
	speed: 0.0041s/iter; left time: 35.9973s
	iters: 1000, epoch: 12 | loss: 0.1070277
	speed: 0.0044s/iter; left time: 37.9221s
Epoch: 12 cost time: 4.1785383224487305
Epoch: 12, Steps: 1066 | Train Loss: 0.1992386 Vali Loss: 0.1331973 Test Loss: 0.2139263
EarlyStopping counter: 3 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.1721642
	speed: 0.0207s/iter; left time: 174.4385s
	iters: 200, epoch: 13 | loss: 0.2232029
	speed: 0.0049s/iter; left time: 40.4789s
	iters: 300, epoch: 13 | loss: 0.3347845
	speed: 0.0040s/iter; left time: 33.1777s
	iters: 400, epoch: 13 | loss: 0.1303560
	speed: 0.0042s/iter; left time: 34.3084s
	iters: 500, epoch: 13 | loss: 0.1860608
	speed: 0.0042s/iter; left time: 33.8021s
	iters: 600, epoch: 13 | loss: 0.0973361
	speed: 0.0048s/iter; left time: 38.2425s
	iters: 700, epoch: 13 | loss: 0.2422960
	speed: 0.0047s/iter; left time: 36.4072s
	iters: 800, epoch: 13 | loss: 0.1789845
	speed: 0.0044s/iter; left time: 34.3322s
	iters: 900, epoch: 13 | loss: 0.1051868
	speed: 0.0045s/iter; left time: 34.1016s
	iters: 1000, epoch: 13 | loss: 0.1537674
	speed: 0.0043s/iter; left time: 32.4666s
Epoch: 13 cost time: 4.755239963531494
Epoch: 13, Steps: 1066 | Train Loss: 0.1991325 Vali Loss: 0.1341421 Test Loss: 0.2168031
EarlyStopping counter: 4 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 14 | loss: 0.1688649
	speed: 0.0213s/iter; left time: 157.0055s
	iters: 200, epoch: 14 | loss: 0.1860708
	speed: 0.0039s/iter; left time: 28.1110s
	iters: 300, epoch: 14 | loss: 0.2282923
	speed: 0.0035s/iter; left time: 25.0224s
	iters: 400, epoch: 14 | loss: 0.1894826
	speed: 0.0035s/iter; left time: 24.3674s
	iters: 500, epoch: 14 | loss: 0.2315161
	speed: 0.0036s/iter; left time: 25.2059s
	iters: 600, epoch: 14 | loss: 0.2216803
	speed: 0.0041s/iter; left time: 28.2341s
	iters: 700, epoch: 14 | loss: 0.1524037
	speed: 0.0043s/iter; left time: 29.1486s
	iters: 800, epoch: 14 | loss: 0.2630772
	speed: 0.0041s/iter; left time: 27.5449s
	iters: 900, epoch: 14 | loss: 0.2494457
	speed: 0.0040s/iter; left time: 26.1892s
	iters: 1000, epoch: 14 | loss: 0.3683318
	speed: 0.0041s/iter; left time: 26.1752s
Epoch: 14 cost time: 4.230701684951782
Epoch: 14, Steps: 1066 | Train Loss: 0.1990880 Vali Loss: 0.1327111 Test Loss: 0.2122166
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTm2_336_96_Linear_ETTm2_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3293<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.18209390342235565, mae:0.2747972011566162
