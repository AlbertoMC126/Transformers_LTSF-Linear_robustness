Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='NLinear', model_id='traffic_336_192', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=192, root_path='./dataset/', save_pred_values=False, seed=3144, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_336_192_NLinear_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3144>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11753
val 1565
test 3317
	iters: 100, epoch: 1 | loss: 1.0297551
	speed: 0.3154s/iter; left time: 4599.1002s
	iters: 200, epoch: 1 | loss: 1.4894110
	speed: 0.3005s/iter; left time: 4352.1619s
	iters: 300, epoch: 1 | loss: 1.0721178
	speed: 0.3014s/iter; left time: 4334.6303s
	iters: 400, epoch: 1 | loss: 1.1260304
	speed: 0.3007s/iter; left time: 4293.9414s
	iters: 500, epoch: 1 | loss: 0.8626906
	speed: 0.3006s/iter; left time: 4262.7333s
	iters: 600, epoch: 1 | loss: 0.9951549
	speed: 0.3023s/iter; left time: 4256.9387s
	iters: 700, epoch: 1 | loss: 0.9238887
	speed: 0.3007s/iter; left time: 4203.4683s
Epoch: 1 cost time: 222.55173349380493
Epoch: 1, Steps: 734 | Train Loss: 1.1086555 Vali Loss: 1.3276526 Test Loss: 1.6083802
Validation loss decreased (inf --> 1.327653).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.7651911
	speed: 0.6052s/iter; left time: 8380.4743s
	iters: 200, epoch: 2 | loss: 0.9130659
	speed: 0.3004s/iter; left time: 4129.2261s
	iters: 300, epoch: 2 | loss: 1.0129437
	speed: 0.3000s/iter; left time: 4094.1487s
	iters: 400, epoch: 2 | loss: 0.9466214
	speed: 0.3020s/iter; left time: 4090.6419s
	iters: 500, epoch: 2 | loss: 0.7302005
	speed: 0.3008s/iter; left time: 4044.7117s
	iters: 600, epoch: 2 | loss: 0.8307633
	speed: 0.3018s/iter; left time: 4028.2865s
	iters: 700, epoch: 2 | loss: 0.6937394
	speed: 0.3003s/iter; left time: 3977.7644s
Epoch: 2 cost time: 220.84361362457275
Epoch: 2, Steps: 734 | Train Loss: 1.0246901 Vali Loss: 1.8001481 Test Loss: 1.3462259
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.3535213
	speed: 0.6066s/iter; left time: 7953.9326s
	iters: 200, epoch: 3 | loss: 0.3385395
	speed: 0.3025s/iter; left time: 3936.7792s
	iters: 300, epoch: 3 | loss: 0.3392795
	speed: 0.3027s/iter; left time: 3908.5008s
	iters: 400, epoch: 3 | loss: 0.3090365
	speed: 0.3024s/iter; left time: 3875.2736s
	iters: 500, epoch: 3 | loss: 0.3765187
	speed: 0.3008s/iter; left time: 3824.6665s
	iters: 600, epoch: 3 | loss: 0.3481333
	speed: 0.3021s/iter; left time: 3810.3313s
	iters: 700, epoch: 3 | loss: 0.3327391
	speed: 0.3009s/iter; left time: 3764.9711s
Epoch: 3 cost time: 221.5326235294342
Epoch: 3, Steps: 734 | Train Loss: 0.3674730 Vali Loss: 0.4958876 Test Loss: 0.6014814
Validation loss decreased (1.327653 --> 0.495888).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.2778576
	speed: 0.6078s/iter; left time: 7524.1193s
	iters: 200, epoch: 4 | loss: 0.2847238
	speed: 0.3023s/iter; left time: 3711.4702s
	iters: 300, epoch: 4 | loss: 0.2762275
	speed: 0.3008s/iter; left time: 3663.7827s
	iters: 400, epoch: 4 | loss: 0.2806354
	speed: 0.3025s/iter; left time: 3653.8737s
	iters: 500, epoch: 4 | loss: 0.2960361
	speed: 0.3019s/iter; left time: 3616.6805s
	iters: 600, epoch: 4 | loss: 0.3102994
	speed: 0.3009s/iter; left time: 3574.1587s
	iters: 700, epoch: 4 | loss: 0.3150105
	speed: 0.3000s/iter; left time: 3534.1731s
Epoch: 4 cost time: 221.2917549610138
Epoch: 4, Steps: 734 | Train Loss: 0.2853922 Vali Loss: 0.3954009 Test Loss: 0.4907745
Validation loss decreased (0.495888 --> 0.395401).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.2569480
	speed: 0.6059s/iter; left time: 7055.6975s
	iters: 200, epoch: 5 | loss: 0.2768587
	speed: 0.3008s/iter; left time: 3473.0385s
	iters: 300, epoch: 5 | loss: 0.2679523
	speed: 0.3010s/iter; left time: 3445.2061s
	iters: 400, epoch: 5 | loss: 0.2828363
	speed: 0.3018s/iter; left time: 3423.7813s
	iters: 500, epoch: 5 | loss: 0.2723354
	speed: 0.3027s/iter; left time: 3404.2910s
	iters: 600, epoch: 5 | loss: 0.2711475
	speed: 0.3021s/iter; left time: 3366.9242s
	iters: 700, epoch: 5 | loss: 0.2525571
	speed: 0.3020s/iter; left time: 3335.4500s
Epoch: 5 cost time: 221.40942645072937
Epoch: 5, Steps: 734 | Train Loss: 0.2644958 Vali Loss: 0.3737006 Test Loss: 0.4653976
Validation loss decreased (0.395401 --> 0.373701).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.2296261
	speed: 0.6063s/iter; left time: 6615.5364s
	iters: 200, epoch: 6 | loss: 0.2638171
	speed: 0.3003s/iter; left time: 3246.7478s
	iters: 300, epoch: 6 | loss: 0.2479650
	speed: 0.3006s/iter; left time: 3219.2631s
	iters: 400, epoch: 6 | loss: 0.2830958
	speed: 0.3015s/iter; left time: 3198.9734s
	iters: 500, epoch: 6 | loss: 0.2625067
	speed: 0.3015s/iter; left time: 3168.7325s
	iters: 600, epoch: 6 | loss: 0.2569519
	speed: 0.3029s/iter; left time: 3153.5856s
	iters: 700, epoch: 6 | loss: 0.2884417
	speed: 0.3023s/iter; left time: 3116.9396s
Epoch: 6 cost time: 221.28303456306458
Epoch: 6, Steps: 734 | Train Loss: 0.2544824 Vali Loss: 0.3620085 Test Loss: 0.4505083
Validation loss decreased (0.373701 --> 0.362008).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.2297278
	speed: 0.6085s/iter; left time: 6193.2047s
	iters: 200, epoch: 7 | loss: 0.2722451
	speed: 0.3004s/iter; left time: 3027.6033s
	iters: 300, epoch: 7 | loss: 0.2664928
	speed: 0.2998s/iter; left time: 2991.1603s
	iters: 400, epoch: 7 | loss: 0.2271558
	speed: 0.3006s/iter; left time: 2969.1201s
	iters: 500, epoch: 7 | loss: 0.2585337
	speed: 0.3019s/iter; left time: 2952.0745s
	iters: 600, epoch: 7 | loss: 0.2486260
	speed: 0.3003s/iter; left time: 2905.9005s
	iters: 700, epoch: 7 | loss: 0.2463332
	speed: 0.3023s/iter; left time: 2894.8579s
Epoch: 7 cost time: 221.02644777297974
Epoch: 7, Steps: 734 | Train Loss: 0.2488584 Vali Loss: 0.3564045 Test Loss: 0.4437122
Validation loss decreased (0.362008 --> 0.356404).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.2319914
	speed: 0.6073s/iter; left time: 5734.5254s
	iters: 200, epoch: 8 | loss: 0.2648190
	speed: 0.3004s/iter; left time: 2806.9091s
	iters: 300, epoch: 8 | loss: 0.2523525
	speed: 0.3017s/iter; left time: 2788.3682s
	iters: 400, epoch: 8 | loss: 0.2532328
	speed: 0.3018s/iter; left time: 2759.3101s
	iters: 500, epoch: 8 | loss: 0.2193870
	speed: 0.3018s/iter; left time: 2728.9751s
	iters: 600, epoch: 8 | loss: 0.2569400
	speed: 0.3017s/iter; left time: 2698.3186s
	iters: 700, epoch: 8 | loss: 0.2472083
	speed: 0.3012s/iter; left time: 2663.7004s
Epoch: 8 cost time: 221.1930856704712
Epoch: 8, Steps: 734 | Train Loss: 0.2456636 Vali Loss: 0.3531114 Test Loss: 0.4401071
Validation loss decreased (0.356404 --> 0.353111).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.2446312
	speed: 0.6080s/iter; left time: 5294.8953s
	iters: 200, epoch: 9 | loss: 0.2567055
	speed: 0.3008s/iter; left time: 2589.3860s
	iters: 300, epoch: 9 | loss: 0.2426188
	speed: 0.3016s/iter; left time: 2566.0853s
	iters: 400, epoch: 9 | loss: 0.2407351
	speed: 0.3002s/iter; left time: 2524.1573s
	iters: 500, epoch: 9 | loss: 0.2640743
	speed: 0.3009s/iter; left time: 2500.4557s
	iters: 600, epoch: 9 | loss: 0.2407345
	speed: 0.3020s/iter; left time: 2478.9615s
	iters: 700, epoch: 9 | loss: 0.2452314
	speed: 0.3007s/iter; left time: 2438.7255s
Epoch: 9 cost time: 221.13872694969177
Epoch: 9, Steps: 734 | Train Loss: 0.2437379 Vali Loss: 0.3517012 Test Loss: 0.4384039
Validation loss decreased (0.353111 --> 0.351701).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.2260970
	speed: 0.6078s/iter; left time: 4847.0040s
	iters: 200, epoch: 10 | loss: 0.2194212
	speed: 0.3018s/iter; left time: 2376.9430s
	iters: 300, epoch: 10 | loss: 0.2518892
	speed: 0.3019s/iter; left time: 2347.3978s
	iters: 400, epoch: 10 | loss: 0.2721196
	speed: 0.3015s/iter; left time: 2313.9857s
	iters: 500, epoch: 10 | loss: 0.2247244
	speed: 0.3013s/iter; left time: 2282.4719s
	iters: 600, epoch: 10 | loss: 0.2367388
	speed: 0.3028s/iter; left time: 2263.7305s
	iters: 700, epoch: 10 | loss: 0.2423149
	speed: 0.3026s/iter; left time: 2231.7308s
Epoch: 10 cost time: 221.6927080154419
Epoch: 10, Steps: 734 | Train Loss: 0.2426655 Vali Loss: 0.3500111 Test Loss: 0.4368042
Validation loss decreased (0.351701 --> 0.350011).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.2382212
	speed: 0.6062s/iter; left time: 4389.2129s
	iters: 200, epoch: 11 | loss: 0.2318668
	speed: 0.3015s/iter; left time: 2153.2541s
	iters: 300, epoch: 11 | loss: 0.2328216
	speed: 0.3008s/iter; left time: 2117.7286s
	iters: 400, epoch: 11 | loss: 0.2686347
	speed: 0.3020s/iter; left time: 2095.8669s
	iters: 500, epoch: 11 | loss: 0.2288462
	speed: 0.3023s/iter; left time: 2067.9944s
	iters: 600, epoch: 11 | loss: 0.2403164
	speed: 0.3022s/iter; left time: 2037.1656s
	iters: 700, epoch: 11 | loss: 0.2533859
	speed: 0.3027s/iter; left time: 2010.3668s
Epoch: 11 cost time: 221.53626132011414
Epoch: 11, Steps: 734 | Train Loss: 0.2420793 Vali Loss: 0.3498771 Test Loss: 0.4365727
Validation loss decreased (0.350011 --> 0.349877).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.2396743
	speed: 0.6083s/iter; left time: 3958.3317s
	iters: 200, epoch: 12 | loss: 0.2423560
	speed: 0.3005s/iter; left time: 1925.4460s
	iters: 300, epoch: 12 | loss: 0.2354495
	speed: 0.3021s/iter; left time: 1905.0802s
	iters: 400, epoch: 12 | loss: 0.2492301
	speed: 0.3002s/iter; left time: 1863.1109s
	iters: 500, epoch: 12 | loss: 0.2311803
	speed: 0.3012s/iter; left time: 1839.6387s
	iters: 600, epoch: 12 | loss: 0.2376281
	speed: 0.3012s/iter; left time: 1809.4597s
	iters: 700, epoch: 12 | loss: 0.2501402
	speed: 0.3029s/iter; left time: 1789.1776s
Epoch: 12 cost time: 221.2976531982422
Epoch: 12, Steps: 734 | Train Loss: 0.2417306 Vali Loss: 0.3498490 Test Loss: 0.4364345
Validation loss decreased (0.349877 --> 0.349849).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.2564284
	speed: 0.6093s/iter; left time: 3517.7494s
	iters: 200, epoch: 13 | loss: 0.2397480
	speed: 0.3023s/iter; left time: 1715.0749s
	iters: 300, epoch: 13 | loss: 0.2277310
	speed: 0.3011s/iter; left time: 1677.9027s
	iters: 400, epoch: 13 | loss: 0.2264910
	speed: 0.3022s/iter; left time: 1653.8407s
	iters: 500, epoch: 13 | loss: 0.2503560
	speed: 0.3020s/iter; left time: 1622.6189s
	iters: 600, epoch: 13 | loss: 0.2283309
	speed: 0.3007s/iter; left time: 1585.5490s
	iters: 700, epoch: 13 | loss: 0.2474339
	speed: 0.3001s/iter; left time: 1552.2755s
Epoch: 13 cost time: 221.3802137374878
Epoch: 13, Steps: 734 | Train Loss: 0.2415421 Vali Loss: 0.3497936 Test Loss: 0.4363494
Validation loss decreased (0.349849 --> 0.349794).  Saving model ...
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 14 | loss: 0.2628021
	speed: 0.6078s/iter; left time: 3062.5370s
	iters: 200, epoch: 14 | loss: 0.2279639
	speed: 0.3025s/iter; left time: 1494.0380s
	iters: 300, epoch: 14 | loss: 0.2582997
	speed: 0.3019s/iter; left time: 1460.7756s
	iters: 400, epoch: 14 | loss: 0.2676725
	speed: 0.3025s/iter; left time: 1433.7595s
	iters: 500, epoch: 14 | loss: 0.2226012
	speed: 0.3014s/iter; left time: 1398.1186s
	iters: 600, epoch: 14 | loss: 0.2664662
	speed: 0.3010s/iter; left time: 1366.1478s
	iters: 700, epoch: 14 | loss: 0.2783805
	speed: 0.3000s/iter; left time: 1331.8742s
Epoch: 14 cost time: 221.43657779693604
Epoch: 14, Steps: 734 | Train Loss: 0.2414244 Vali Loss: 0.3498010 Test Loss: 0.4362521
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 15 | loss: 0.2479346
	speed: 0.6054s/iter; left time: 2606.1786s
	iters: 200, epoch: 15 | loss: 0.2223549
	speed: 0.3012s/iter; left time: 1266.6751s
	iters: 300, epoch: 15 | loss: 0.2585269
	speed: 0.3022s/iter; left time: 1240.3582s
	iters: 400, epoch: 15 | loss: 0.2437553
	speed: 0.3030s/iter; left time: 1213.6808s
	iters: 500, epoch: 15 | loss: 0.2490911
	speed: 0.3021s/iter; left time: 1179.8580s
	iters: 600, epoch: 15 | loss: 0.2484665
	speed: 0.3014s/iter; left time: 1147.0118s
	iters: 700, epoch: 15 | loss: 0.2626328
	speed: 0.3018s/iter; left time: 1118.2472s
Epoch: 15 cost time: 221.56947684288025
Epoch: 15, Steps: 734 | Train Loss: 0.2413840 Vali Loss: 0.3497388 Test Loss: 0.4361894
Validation loss decreased (0.349794 --> 0.349739).  Saving model ...
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 16 | loss: 0.2462795
	speed: 0.6061s/iter; left time: 2164.2649s
	iters: 200, epoch: 16 | loss: 0.2420559
	speed: 0.3007s/iter; left time: 1043.8094s
	iters: 300, epoch: 16 | loss: 0.2328828
	speed: 0.3023s/iter; left time: 1019.0920s
	iters: 400, epoch: 16 | loss: 0.2234889
	speed: 0.3021s/iter; left time: 988.1208s
	iters: 500, epoch: 16 | loss: 0.2384088
	speed: 0.3016s/iter; left time: 956.3073s
	iters: 600, epoch: 16 | loss: 0.2462896
	speed: 0.3026s/iter; left time: 929.4067s
	iters: 700, epoch: 16 | loss: 0.2384711
	speed: 0.3013s/iter; left time: 895.0138s
Epoch: 16 cost time: 221.4491412639618
Epoch: 16, Steps: 734 | Train Loss: 0.2413801 Vali Loss: 0.3495089 Test Loss: 0.4361840
Validation loss decreased (0.349739 --> 0.349509).  Saving model ...
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 17 | loss: 0.2703614
	speed: 0.6091s/iter; left time: 1728.0190s
	iters: 200, epoch: 17 | loss: 0.2663454
	speed: 0.3012s/iter; left time: 824.2886s
	iters: 300, epoch: 17 | loss: 0.2456490
	speed: 0.3009s/iter; left time: 793.3730s
	iters: 400, epoch: 17 | loss: 0.2464181
	speed: 0.3021s/iter; left time: 766.3122s
	iters: 500, epoch: 17 | loss: 0.2374309
	speed: 0.3030s/iter; left time: 738.2982s
	iters: 600, epoch: 17 | loss: 0.2553383
	speed: 0.3023s/iter; left time: 706.4350s
	iters: 700, epoch: 17 | loss: 0.2311444
	speed: 0.3026s/iter; left time: 676.9493s
Epoch: 17 cost time: 221.65891337394714
Epoch: 17, Steps: 734 | Train Loss: 0.2413592 Vali Loss: 0.3493967 Test Loss: 0.4361798
Validation loss decreased (0.349509 --> 0.349397).  Saving model ...
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 18 | loss: 0.2313344
	speed: 0.6070s/iter; left time: 1276.5020s
	iters: 200, epoch: 18 | loss: 0.2650495
	speed: 0.3021s/iter; left time: 605.0874s
	iters: 300, epoch: 18 | loss: 0.2513846
	speed: 0.3012s/iter; left time: 573.1878s
	iters: 400, epoch: 18 | loss: 0.2639721
	speed: 0.3022s/iter; left time: 544.8148s
	iters: 500, epoch: 18 | loss: 0.2425797
	speed: 0.3019s/iter; left time: 514.1440s
	iters: 600, epoch: 18 | loss: 0.2220597
	speed: 0.3018s/iter; left time: 483.7273s
	iters: 700, epoch: 18 | loss: 0.2470248
	speed: 0.3014s/iter; left time: 452.9302s
Epoch: 18 cost time: 221.45325231552124
Epoch: 18, Steps: 734 | Train Loss: 0.2413323 Vali Loss: 0.3497154 Test Loss: 0.4361779
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 19 | loss: 0.2282321
	speed: 0.6060s/iter; left time: 829.6010s
	iters: 200, epoch: 19 | loss: 0.2300323
	speed: 0.3021s/iter; left time: 383.3844s
	iters: 300, epoch: 19 | loss: 0.2605888
	speed: 0.3022s/iter; left time: 353.2144s
	iters: 400, epoch: 19 | loss: 0.2588407
	speed: 0.3019s/iter; left time: 322.7228s
	iters: 500, epoch: 19 | loss: 0.2562754
	speed: 0.3022s/iter; left time: 292.8574s
	iters: 600, epoch: 19 | loss: 0.2186916
	speed: 0.3008s/iter; left time: 261.3712s
	iters: 700, epoch: 19 | loss: 0.2261959
	speed: 0.3020s/iter; left time: 232.2187s
Epoch: 19 cost time: 221.51637887954712
Epoch: 19, Steps: 734 | Train Loss: 0.2413391 Vali Loss: 0.3495915 Test Loss: 0.4361769
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 20 | loss: 0.2504160
	speed: 0.6056s/iter; left time: 384.5317s
	iters: 200, epoch: 20 | loss: 0.2242713
	speed: 0.3017s/iter; left time: 161.3864s
	iters: 300, epoch: 20 | loss: 0.2413638
	speed: 0.3014s/iter; left time: 131.1001s
	iters: 400, epoch: 20 | loss: 0.2419127
	speed: 0.3009s/iter; left time: 100.8076s
	iters: 500, epoch: 20 | loss: 0.2240204
	speed: 0.3017s/iter; left time: 70.8961s
	iters: 600, epoch: 20 | loss: 0.2308227
	speed: 0.3016s/iter; left time: 40.7102s
	iters: 700, epoch: 20 | loss: 0.2366806
	speed: 0.3019s/iter; left time: 10.5663s
Epoch: 20 cost time: 221.3960337638855
Epoch: 20, Steps: 734 | Train Loss: 0.2413334 Vali Loss: 0.3495013 Test Loss: 0.4361766
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.9073486328125e-08
>>>>>>>testing : traffic_336_192_NLinear_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3144<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3317
mse:0.4358315169811249, mae:0.2988867163658142
