Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='DLinear', model_id='ETTm2_336_720', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=720, root_path='./dataset/', save_pred_values=False, seed=15227, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTm2_336_720_DLinear_ETTm2_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15227>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33505
val 10801
test 10801
	iters: 100, epoch: 1 | loss: 0.7938555
	speed: 0.0367s/iter; left time: 765.4065s
	iters: 200, epoch: 1 | loss: 0.7996556
	speed: 0.0361s/iter; left time: 749.0969s
	iters: 300, epoch: 1 | loss: 0.5689217
	speed: 0.0361s/iter; left time: 745.5259s
	iters: 400, epoch: 1 | loss: 0.7531158
	speed: 0.0355s/iter; left time: 730.1527s
	iters: 500, epoch: 1 | loss: 0.6040068
	speed: 0.0358s/iter; left time: 731.4691s
	iters: 600, epoch: 1 | loss: 0.3488505
	speed: 0.0370s/iter; left time: 752.0749s
	iters: 700, epoch: 1 | loss: 1.0181172
	speed: 0.0350s/iter; left time: 709.2899s
	iters: 800, epoch: 1 | loss: 1.0134890
	speed: 0.0335s/iter; left time: 675.1875s
	iters: 900, epoch: 1 | loss: 0.6893750
	speed: 0.0365s/iter; left time: 732.3576s
	iters: 1000, epoch: 1 | loss: 0.6715488
	speed: 0.0378s/iter; left time: 753.4565s
Epoch: 1 cost time: 37.750428915023804
Epoch: 1, Steps: 1047 | Train Loss: 0.7810342 Vali Loss: 0.7852829 Test Loss: 1.6870836
Validation loss decreased (inf --> 0.785283).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.9535163
	speed: 0.1183s/iter; left time: 2341.5903s
	iters: 200, epoch: 2 | loss: 0.7548142
	speed: 0.0354s/iter; left time: 696.2736s
	iters: 300, epoch: 2 | loss: 0.7854661
	speed: 0.0362s/iter; left time: 709.7043s
	iters: 400, epoch: 2 | loss: 1.0954965
	speed: 0.0355s/iter; left time: 692.2628s
	iters: 500, epoch: 2 | loss: 0.8770828
	speed: 0.0322s/iter; left time: 624.6233s
	iters: 600, epoch: 2 | loss: 0.8679837
	speed: 0.0362s/iter; left time: 698.9891s
	iters: 700, epoch: 2 | loss: 0.7198374
	speed: 0.0377s/iter; left time: 723.3577s
	iters: 800, epoch: 2 | loss: 0.9449068
	speed: 0.0375s/iter; left time: 716.0305s
	iters: 900, epoch: 2 | loss: 0.6216571
	speed: 0.0369s/iter; left time: 700.1815s
	iters: 1000, epoch: 2 | loss: 0.9471714
	speed: 0.0370s/iter; left time: 698.3810s
Epoch: 2 cost time: 37.759790658950806
Epoch: 2, Steps: 1047 | Train Loss: 0.7824762 Vali Loss: 1.1870948 Test Loss: 3.1181502
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.8368931
	speed: 0.1162s/iter; left time: 2179.0922s
	iters: 200, epoch: 3 | loss: 0.3217515
	speed: 0.0374s/iter; left time: 696.8648s
	iters: 300, epoch: 3 | loss: 0.3550053
	speed: 0.0385s/iter; left time: 713.6610s
	iters: 400, epoch: 3 | loss: 0.5405276
	speed: 0.0370s/iter; left time: 682.2848s
	iters: 500, epoch: 3 | loss: 0.3613503
	speed: 0.0379s/iter; left time: 695.4205s
	iters: 600, epoch: 3 | loss: 0.3279330
	speed: 0.0380s/iter; left time: 693.6764s
	iters: 700, epoch: 3 | loss: 0.6229528
	speed: 0.0380s/iter; left time: 690.4648s
	iters: 800, epoch: 3 | loss: 0.6022766
	speed: 0.0346s/iter; left time: 625.1448s
	iters: 900, epoch: 3 | loss: 0.4322020
	speed: 0.0361s/iter; left time: 648.5839s
	iters: 1000, epoch: 3 | loss: 0.3725556
	speed: 0.0384s/iter; left time: 686.0236s
Epoch: 3 cost time: 38.67266893386841
Epoch: 3, Steps: 1047 | Train Loss: 0.5698022 Vali Loss: 0.6621640 Test Loss: 1.7061182
Validation loss decreased (0.785283 --> 0.662164).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.7380932
	speed: 0.1161s/iter; left time: 2054.4162s
	iters: 200, epoch: 4 | loss: 0.4332627
	speed: 0.0375s/iter; left time: 659.1362s
	iters: 300, epoch: 4 | loss: 0.3344472
	speed: 0.0369s/iter; left time: 645.5600s
	iters: 400, epoch: 4 | loss: 0.4209732
	speed: 0.0376s/iter; left time: 654.7757s
	iters: 500, epoch: 4 | loss: 0.4829374
	speed: 0.0348s/iter; left time: 601.3462s
	iters: 600, epoch: 4 | loss: 0.6488604
	speed: 0.0357s/iter; left time: 613.6023s
	iters: 700, epoch: 4 | loss: 0.3422519
	speed: 0.0360s/iter; left time: 616.0326s
	iters: 800, epoch: 4 | loss: 0.4214636
	speed: 0.0371s/iter; left time: 631.4331s
	iters: 900, epoch: 4 | loss: 0.4939885
	speed: 0.0396s/iter; left time: 669.5024s
	iters: 1000, epoch: 4 | loss: 0.5577248
	speed: 0.0395s/iter; left time: 663.3328s
Epoch: 4 cost time: 38.54497933387756
Epoch: 4, Steps: 1047 | Train Loss: 0.5094964 Vali Loss: 0.3813184 Test Loss: 0.6757852
Validation loss decreased (0.662164 --> 0.381318).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.4702346
	speed: 0.1147s/iter; left time: 1909.9010s
	iters: 200, epoch: 5 | loss: 0.4586470
	speed: 0.0360s/iter; left time: 595.9177s
	iters: 300, epoch: 5 | loss: 0.3427175
	speed: 0.0368s/iter; left time: 605.4098s
	iters: 400, epoch: 5 | loss: 0.5869320
	speed: 0.0356s/iter; left time: 581.4602s
	iters: 500, epoch: 5 | loss: 0.4410858
	speed: 0.0377s/iter; left time: 613.2940s
	iters: 600, epoch: 5 | loss: 0.3309055
	speed: 0.0379s/iter; left time: 612.4523s
	iters: 700, epoch: 5 | loss: 0.4742976
	speed: 0.0352s/iter; left time: 564.5262s
	iters: 800, epoch: 5 | loss: 0.2905841
	speed: 0.0376s/iter; left time: 599.9420s
	iters: 900, epoch: 5 | loss: 0.4322908
	speed: 0.0347s/iter; left time: 550.2501s
	iters: 1000, epoch: 5 | loss: 0.4306427
	speed: 0.0351s/iter; left time: 552.4069s
Epoch: 5 cost time: 37.7932813167572
Epoch: 5, Steps: 1047 | Train Loss: 0.4824350 Vali Loss: 0.3943267 Test Loss: 0.7073768
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.5652435
	speed: 0.1214s/iter; left time: 1894.0316s
	iters: 200, epoch: 6 | loss: 0.3544849
	speed: 0.0372s/iter; left time: 576.7872s
	iters: 300, epoch: 6 | loss: 0.4247058
	speed: 0.0363s/iter; left time: 558.8590s
	iters: 400, epoch: 6 | loss: 0.3199907
	speed: 0.0379s/iter; left time: 579.7189s
	iters: 500, epoch: 6 | loss: 0.3862159
	speed: 0.0352s/iter; left time: 534.8641s
	iters: 600, epoch: 6 | loss: 0.5196519
	speed: 0.0362s/iter; left time: 546.4378s
	iters: 700, epoch: 6 | loss: 0.5263736
	speed: 0.0376s/iter; left time: 563.8556s
	iters: 800, epoch: 6 | loss: 0.8721951
	speed: 0.0368s/iter; left time: 548.6496s
	iters: 900, epoch: 6 | loss: 0.4538673
	speed: 0.0347s/iter; left time: 514.4862s
	iters: 1000, epoch: 6 | loss: 0.4514939
	speed: 0.0363s/iter; left time: 534.1707s
Epoch: 6 cost time: 38.20246458053589
Epoch: 6, Steps: 1047 | Train Loss: 0.4669647 Vali Loss: 0.4607719 Test Loss: 0.9729937
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.4488473
	speed: 0.1151s/iter; left time: 1676.3538s
	iters: 200, epoch: 7 | loss: 0.8949016
	speed: 0.0373s/iter; left time: 539.2180s
	iters: 300, epoch: 7 | loss: 0.8415709
	speed: 0.0367s/iter; left time: 526.8003s
	iters: 400, epoch: 7 | loss: 0.5581798
	speed: 0.0370s/iter; left time: 526.9717s
	iters: 500, epoch: 7 | loss: 0.3246149
	speed: 0.0370s/iter; left time: 523.3469s
	iters: 600, epoch: 7 | loss: 0.3491969
	speed: 0.0386s/iter; left time: 542.6301s
	iters: 700, epoch: 7 | loss: 0.6143140
	speed: 0.0361s/iter; left time: 503.3424s
	iters: 800, epoch: 7 | loss: 0.6171428
	speed: 0.0368s/iter; left time: 510.4241s
	iters: 900, epoch: 7 | loss: 0.4415539
	speed: 0.0379s/iter; left time: 520.8856s
	iters: 1000, epoch: 7 | loss: 0.4140046
	speed: 0.0388s/iter; left time: 530.5063s
Epoch: 7 cost time: 38.61038661003113
Epoch: 7, Steps: 1047 | Train Loss: 0.4587209 Vali Loss: 0.4384255 Test Loss: 0.9325767
EarlyStopping counter: 3 out of 5
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.6377319
	speed: 0.1161s/iter; left time: 1568.2069s
	iters: 200, epoch: 8 | loss: 0.5617792
	speed: 0.0372s/iter; left time: 499.2805s
	iters: 300, epoch: 8 | loss: 0.5861391
	speed: 0.0373s/iter; left time: 497.0405s
	iters: 400, epoch: 8 | loss: 0.3563461
	speed: 0.0372s/iter; left time: 491.9822s
	iters: 500, epoch: 8 | loss: 0.5805646
	speed: 0.0376s/iter; left time: 492.7922s
	iters: 600, epoch: 8 | loss: 0.6666690
	speed: 0.0364s/iter; left time: 474.1534s
	iters: 700, epoch: 8 | loss: 0.5672474
	speed: 0.0363s/iter; left time: 469.3477s
	iters: 800, epoch: 8 | loss: 0.3195512
	speed: 0.0389s/iter; left time: 498.3386s
	iters: 900, epoch: 8 | loss: 0.2734071
	speed: 0.0339s/iter; left time: 430.9779s
	iters: 1000, epoch: 8 | loss: 0.2528568
	speed: 0.0360s/iter; left time: 453.6502s
Epoch: 8 cost time: 38.29740238189697
Epoch: 8, Steps: 1047 | Train Loss: 0.4540851 Vali Loss: 0.3935013 Test Loss: 0.7703711
EarlyStopping counter: 4 out of 5
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.4861942
	speed: 0.1157s/iter; left time: 1441.9090s
	iters: 200, epoch: 9 | loss: 0.3333718
	speed: 0.0375s/iter; left time: 463.8020s
	iters: 300, epoch: 9 | loss: 0.3070438
	speed: 0.0374s/iter; left time: 458.6867s
	iters: 400, epoch: 9 | loss: 0.2800874
	speed: 0.0384s/iter; left time: 467.6141s
	iters: 500, epoch: 9 | loss: 0.2527148
	speed: 0.0364s/iter; left time: 438.6261s
	iters: 600, epoch: 9 | loss: 0.7207759
	speed: 0.0357s/iter; left time: 427.4608s
	iters: 700, epoch: 9 | loss: 0.2735572
	speed: 0.0379s/iter; left time: 449.1381s
	iters: 800, epoch: 9 | loss: 0.4247257
	speed: 0.0371s/iter; left time: 436.0674s
	iters: 900, epoch: 9 | loss: 0.7031164
	speed: 0.0359s/iter; left time: 418.7130s
	iters: 1000, epoch: 9 | loss: 0.4835544
	speed: 0.0347s/iter; left time: 400.8021s
Epoch: 9 cost time: 37.97794055938721
Epoch: 9, Steps: 1047 | Train Loss: 0.4513878 Vali Loss: 0.4152418 Test Loss: 0.8588201
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTm2_336_720_DLinear_ETTm2_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15227<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10801
mse:0.6760411858558655, mae:0.5451738238334656
