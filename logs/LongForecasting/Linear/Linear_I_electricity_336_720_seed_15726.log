Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='Linear', model_id='Electricity_336_720', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=720, root_path='./dataset/', save_pred_values=False, seed=15726, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : Electricity_336_720_Linear_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15726>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17357
val 1913
test 4541
	iters: 100, epoch: 1 | loss: 0.3201136
	speed: 0.1111s/iter; left time: 2398.4726s
	iters: 200, epoch: 1 | loss: 0.2609358
	speed: 0.0955s/iter; left time: 2050.8536s
	iters: 300, epoch: 1 | loss: 0.2973962
	speed: 0.0945s/iter; left time: 2020.7493s
	iters: 400, epoch: 1 | loss: 0.3149101
	speed: 0.0951s/iter; left time: 2024.7486s
	iters: 500, epoch: 1 | loss: 0.2632572
	speed: 0.0949s/iter; left time: 2011.0462s
	iters: 600, epoch: 1 | loss: 0.2612996
	speed: 0.0959s/iter; left time: 2020.8670s
	iters: 700, epoch: 1 | loss: 0.2900837
	speed: 0.0953s/iter; left time: 2000.1372s
	iters: 800, epoch: 1 | loss: 0.2817693
	speed: 0.0944s/iter; left time: 1972.1354s
	iters: 900, epoch: 1 | loss: 0.3209237
	speed: 0.0953s/iter; left time: 1979.6133s
	iters: 1000, epoch: 1 | loss: 0.2827224
	speed: 0.0957s/iter; left time: 1978.3026s
Epoch: 1 cost time: 105.20132040977478
Epoch: 1, Steps: 1084 | Train Loss: 0.2942697 Vali Loss: 0.2415746 Test Loss: 0.2809507
Validation loss decreased (inf --> 0.241575).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.3136662
	speed: 0.3992s/iter; left time: 8182.5199s
	iters: 200, epoch: 2 | loss: 0.2983881
	speed: 0.0934s/iter; left time: 1904.6952s
	iters: 300, epoch: 2 | loss: 0.2931302
	speed: 0.0939s/iter; left time: 1904.9693s
	iters: 400, epoch: 2 | loss: 0.2816213
	speed: 0.0939s/iter; left time: 1897.0574s
	iters: 500, epoch: 2 | loss: 0.2569798
	speed: 0.0945s/iter; left time: 1899.1707s
	iters: 600, epoch: 2 | loss: 0.2660352
	speed: 0.0939s/iter; left time: 1877.9472s
	iters: 700, epoch: 2 | loss: 0.2845499
	speed: 0.0943s/iter; left time: 1875.6512s
	iters: 800, epoch: 2 | loss: 0.2842113
	speed: 0.0940s/iter; left time: 1860.8528s
	iters: 900, epoch: 2 | loss: 0.2968005
	speed: 0.0948s/iter; left time: 1867.3636s
	iters: 1000, epoch: 2 | loss: 0.2911366
	speed: 0.0962s/iter; left time: 1885.9207s
Epoch: 2 cost time: 103.37693905830383
Epoch: 2, Steps: 1084 | Train Loss: 0.2859139 Vali Loss: 0.2629718 Test Loss: 0.3068896
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.2360691
	speed: 0.3836s/iter; left time: 7447.4530s
	iters: 200, epoch: 3 | loss: 0.2156911
	speed: 0.0951s/iter; left time: 1835.7624s
	iters: 300, epoch: 3 | loss: 0.2437118
	speed: 0.0951s/iter; left time: 1826.5562s
	iters: 400, epoch: 3 | loss: 0.2746230
	speed: 0.0959s/iter; left time: 1832.3559s
	iters: 500, epoch: 3 | loss: 0.2168268
	speed: 0.0952s/iter; left time: 1810.3120s
	iters: 600, epoch: 3 | loss: 0.2389228
	speed: 0.0953s/iter; left time: 1802.3748s
	iters: 700, epoch: 3 | loss: 0.2496125
	speed: 0.0954s/iter; left time: 1793.9535s
	iters: 800, epoch: 3 | loss: 0.2509677
	speed: 0.0949s/iter; left time: 1776.6519s
	iters: 900, epoch: 3 | loss: 0.2379605
	speed: 0.0943s/iter; left time: 1754.9254s
	iters: 1000, epoch: 3 | loss: 0.2234897
	speed: 0.0978s/iter; left time: 1811.2733s
Epoch: 3 cost time: 104.11883091926575
Epoch: 3, Steps: 1084 | Train Loss: 0.2354452 Vali Loss: 0.1978359 Test Loss: 0.2397079
Validation loss decreased (0.241575 --> 0.197836).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.1980549
	speed: 0.4018s/iter; left time: 7364.8149s
	iters: 200, epoch: 4 | loss: 0.1917741
	speed: 0.0952s/iter; left time: 1735.3420s
	iters: 300, epoch: 4 | loss: 0.2005458
	speed: 0.0964s/iter; left time: 1747.2330s
	iters: 400, epoch: 4 | loss: 0.2058154
	speed: 0.0947s/iter; left time: 1706.6891s
	iters: 500, epoch: 4 | loss: 0.1763560
	speed: 0.0953s/iter; left time: 1708.3226s
	iters: 600, epoch: 4 | loss: 0.1721935
	speed: 0.0960s/iter; left time: 1711.9898s
	iters: 700, epoch: 4 | loss: 0.2052930
	speed: 0.0954s/iter; left time: 1691.0470s
	iters: 800, epoch: 4 | loss: 0.2404072
	speed: 0.0957s/iter; left time: 1687.2396s
	iters: 900, epoch: 4 | loss: 0.2211566
	speed: 0.0964s/iter; left time: 1690.5078s
	iters: 1000, epoch: 4 | loss: 0.2327182
	speed: 0.1047s/iter; left time: 1824.8633s
Epoch: 4 cost time: 105.46936655044556
Epoch: 4, Steps: 1084 | Train Loss: 0.2161701 Vali Loss: 0.1841898 Test Loss: 0.2171484
Validation loss decreased (0.197836 --> 0.184190).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.1723070
	speed: 0.4005s/iter; left time: 6906.4305s
	iters: 200, epoch: 5 | loss: 0.2226867
	speed: 0.0931s/iter; left time: 1596.1955s
	iters: 300, epoch: 5 | loss: 0.2100519
	speed: 0.0948s/iter; left time: 1615.2410s
	iters: 400, epoch: 5 | loss: 0.2000967
	speed: 0.0948s/iter; left time: 1606.6350s
	iters: 500, epoch: 5 | loss: 0.2188589
	speed: 0.0954s/iter; left time: 1606.5939s
	iters: 600, epoch: 5 | loss: 0.1785036
	speed: 0.0945s/iter; left time: 1583.0987s
	iters: 700, epoch: 5 | loss: 0.2010461
	speed: 0.0942s/iter; left time: 1568.3133s
	iters: 800, epoch: 5 | loss: 0.1868013
	speed: 0.0937s/iter; left time: 1550.7196s
	iters: 900, epoch: 5 | loss: 0.1954463
	speed: 0.1001s/iter; left time: 1646.8443s
	iters: 1000, epoch: 5 | loss: 0.1916901
	speed: 0.0997s/iter; left time: 1629.9779s
Epoch: 5 cost time: 104.47219061851501
Epoch: 5, Steps: 1084 | Train Loss: 0.2064411 Vali Loss: 0.1801695 Test Loss: 0.2145890
Validation loss decreased (0.184190 --> 0.180169).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.2103968
	speed: 0.3979s/iter; left time: 6430.6240s
	iters: 200, epoch: 6 | loss: 0.2134809
	speed: 0.0951s/iter; left time: 1527.8682s
	iters: 300, epoch: 6 | loss: 0.2261779
	speed: 0.0950s/iter; left time: 1517.0380s
	iters: 400, epoch: 6 | loss: 0.1862316
	speed: 0.0961s/iter; left time: 1524.8245s
	iters: 500, epoch: 6 | loss: 0.2319468
	speed: 0.0964s/iter; left time: 1519.6402s
	iters: 600, epoch: 6 | loss: 0.1999544
	speed: 0.0961s/iter; left time: 1505.1940s
	iters: 700, epoch: 6 | loss: 0.1720436
	speed: 0.0950s/iter; left time: 1477.5570s
	iters: 800, epoch: 6 | loss: 0.2221966
	speed: 0.0981s/iter; left time: 1516.3311s
	iters: 900, epoch: 6 | loss: 0.2249767
	speed: 0.0993s/iter; left time: 1524.6174s
	iters: 1000, epoch: 6 | loss: 0.2164167
	speed: 0.0989s/iter; left time: 1509.3476s
Epoch: 6 cost time: 104.72599291801453
Epoch: 6, Steps: 1084 | Train Loss: 0.2012284 Vali Loss: 0.1716727 Test Loss: 0.2069124
Validation loss decreased (0.180169 --> 0.171673).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.1795768
	speed: 0.3902s/iter; left time: 5882.5664s
	iters: 200, epoch: 7 | loss: 0.1947856
	speed: 0.0958s/iter; left time: 1434.4679s
	iters: 300, epoch: 7 | loss: 0.1909747
	speed: 0.0952s/iter; left time: 1415.9114s
	iters: 400, epoch: 7 | loss: 0.2042283
	speed: 0.0948s/iter; left time: 1400.3789s
	iters: 500, epoch: 7 | loss: 0.2252507
	speed: 0.0946s/iter; left time: 1388.8700s
	iters: 600, epoch: 7 | loss: 0.1970578
	speed: 0.0948s/iter; left time: 1381.3267s
	iters: 700, epoch: 7 | loss: 0.1751241
	speed: 0.0952s/iter; left time: 1377.8510s
	iters: 800, epoch: 7 | loss: 0.1971290
	speed: 0.0984s/iter; left time: 1415.3468s
	iters: 900, epoch: 7 | loss: 0.1848345
	speed: 0.1003s/iter; left time: 1432.6904s
	iters: 1000, epoch: 7 | loss: 0.2418852
	speed: 0.1009s/iter; left time: 1429.9915s
Epoch: 7 cost time: 104.47071599960327
Epoch: 7, Steps: 1084 | Train Loss: 0.1984050 Vali Loss: 0.1703351 Test Loss: 0.2037309
Validation loss decreased (0.171673 --> 0.170335).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.1934216
	speed: 0.3888s/iter; left time: 5441.1365s
	iters: 200, epoch: 8 | loss: 0.1926828
	speed: 0.0945s/iter; left time: 1312.9403s
	iters: 300, epoch: 8 | loss: 0.1753182
	speed: 0.0944s/iter; left time: 1301.6344s
	iters: 400, epoch: 8 | loss: 0.1938604
	speed: 0.0940s/iter; left time: 1286.6207s
	iters: 500, epoch: 8 | loss: 0.2117985
	speed: 0.0945s/iter; left time: 1284.7283s
	iters: 600, epoch: 8 | loss: 0.1937595
	speed: 0.0952s/iter; left time: 1284.5204s
	iters: 700, epoch: 8 | loss: 0.1814088
	speed: 0.1026s/iter; left time: 1374.3913s
	iters: 800, epoch: 8 | loss: 0.2058275
	speed: 0.0997s/iter; left time: 1325.9340s
	iters: 900, epoch: 8 | loss: 0.2059696
	speed: 0.0995s/iter; left time: 1313.2797s
	iters: 1000, epoch: 8 | loss: 0.1952817
	speed: 0.0938s/iter; left time: 1228.5085s
Epoch: 8 cost time: 104.52607536315918
Epoch: 8, Steps: 1084 | Train Loss: 0.1968894 Vali Loss: 0.1693783 Test Loss: 0.2034089
Validation loss decreased (0.170335 --> 0.169378).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.1808202
	speed: 0.3907s/iter; left time: 5043.2576s
	iters: 200, epoch: 9 | loss: 0.2204953
	speed: 0.0957s/iter; left time: 1225.1826s
	iters: 300, epoch: 9 | loss: 0.2079557
	speed: 0.0956s/iter; left time: 1215.0777s
	iters: 400, epoch: 9 | loss: 0.2001993
	speed: 0.0950s/iter; left time: 1198.3064s
	iters: 500, epoch: 9 | loss: 0.1848319
	speed: 0.0953s/iter; left time: 1191.6316s
	iters: 600, epoch: 9 | loss: 0.1809418
	speed: 0.0989s/iter; left time: 1226.7725s
	iters: 700, epoch: 9 | loss: 0.2379103
	speed: 0.1020s/iter; left time: 1255.3792s
	iters: 800, epoch: 9 | loss: 0.1867807
	speed: 0.1010s/iter; left time: 1232.6800s
	iters: 900, epoch: 9 | loss: 0.1841059
	speed: 0.0981s/iter; left time: 1187.5891s
	iters: 1000, epoch: 9 | loss: 0.1698933
	speed: 0.0951s/iter; left time: 1141.6615s
Epoch: 9 cost time: 105.31836700439453
Epoch: 9, Steps: 1084 | Train Loss: 0.1961061 Vali Loss: 0.1678415 Test Loss: 0.2017967
Validation loss decreased (0.169378 --> 0.167841).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.1931563
	speed: 0.3884s/iter; left time: 4592.3616s
	iters: 200, epoch: 10 | loss: 0.2133351
	speed: 0.0951s/iter; left time: 1115.0878s
	iters: 300, epoch: 10 | loss: 0.2000178
	speed: 0.0955s/iter; left time: 1110.4035s
	iters: 400, epoch: 10 | loss: 0.1723694
	speed: 0.0952s/iter; left time: 1096.8355s
	iters: 500, epoch: 10 | loss: 0.1722294
	speed: 0.0958s/iter; left time: 1094.7151s
	iters: 600, epoch: 10 | loss: 0.1871833
	speed: 0.1036s/iter; left time: 1173.4229s
	iters: 700, epoch: 10 | loss: 0.2025606
	speed: 0.1013s/iter; left time: 1137.0944s
	iters: 800, epoch: 10 | loss: 0.2024017
	speed: 0.1004s/iter; left time: 1117.0584s
	iters: 900, epoch: 10 | loss: 0.1681310
	speed: 0.0948s/iter; left time: 1044.8845s
	iters: 1000, epoch: 10 | loss: 0.1895977
	speed: 0.0943s/iter; left time: 1030.3817s
Epoch: 10 cost time: 105.21896743774414
Epoch: 10, Steps: 1084 | Train Loss: 0.1956806 Vali Loss: 0.1681657 Test Loss: 0.2016863
EarlyStopping counter: 1 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.1943802
	speed: 0.3657s/iter; left time: 3928.0010s
	iters: 200, epoch: 11 | loss: 0.2060087
	speed: 0.0939s/iter; left time: 999.2850s
	iters: 300, epoch: 11 | loss: 0.1993727
	speed: 0.0936s/iter; left time: 986.1490s
	iters: 400, epoch: 11 | loss: 0.1901174
	speed: 0.0933s/iter; left time: 974.1244s
	iters: 500, epoch: 11 | loss: 0.2130556
	speed: 0.0988s/iter; left time: 1021.5841s
	iters: 600, epoch: 11 | loss: 0.1934870
	speed: 0.1016s/iter; left time: 1040.2264s
	iters: 700, epoch: 11 | loss: 0.1948794
	speed: 0.1016s/iter; left time: 1030.4461s
	iters: 800, epoch: 11 | loss: 0.1700645
	speed: 0.0980s/iter; left time: 984.0759s
	iters: 900, epoch: 11 | loss: 0.1744118
	speed: 0.0954s/iter; left time: 948.0356s
	iters: 1000, epoch: 11 | loss: 0.2443592
	speed: 0.0947s/iter; left time: 931.6738s
Epoch: 11 cost time: 104.54631090164185
Epoch: 11, Steps: 1084 | Train Loss: 0.1954248 Vali Loss: 0.1683322 Test Loss: 0.2017085
EarlyStopping counter: 2 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.2166432
	speed: 0.3676s/iter; left time: 3549.4619s
	iters: 200, epoch: 12 | loss: 0.1758163
	speed: 0.0948s/iter; left time: 905.9342s
	iters: 300, epoch: 12 | loss: 0.2027145
	speed: 0.0958s/iter; left time: 905.6475s
	iters: 400, epoch: 12 | loss: 0.1837204
	speed: 0.0956s/iter; left time: 894.9113s
	iters: 500, epoch: 12 | loss: 0.2512036
	speed: 0.1001s/iter; left time: 926.2839s
	iters: 600, epoch: 12 | loss: 0.1923972
	speed: 0.0999s/iter; left time: 915.1868s
	iters: 700, epoch: 12 | loss: 0.2124233
	speed: 0.1000s/iter; left time: 905.7654s
	iters: 800, epoch: 12 | loss: 0.1803982
	speed: 0.0949s/iter; left time: 849.5787s
	iters: 900, epoch: 12 | loss: 0.2018151
	speed: 0.0950s/iter; left time: 841.3990s
	iters: 1000, epoch: 12 | loss: 0.1831964
	speed: 0.0956s/iter; left time: 837.3330s
Epoch: 12 cost time: 104.77435445785522
Epoch: 12, Steps: 1084 | Train Loss: 0.1953370 Vali Loss: 0.1681332 Test Loss: 0.2015446
EarlyStopping counter: 3 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.1894878
	speed: 0.3651s/iter; left time: 3129.5741s
	iters: 200, epoch: 13 | loss: 0.2208689
	speed: 0.0948s/iter; left time: 803.0573s
	iters: 300, epoch: 13 | loss: 0.1762217
	speed: 0.0948s/iter; left time: 794.1598s
	iters: 400, epoch: 13 | loss: 0.2392800
	speed: 0.0982s/iter; left time: 812.1946s
	iters: 500, epoch: 13 | loss: 0.1932026
	speed: 0.0984s/iter; left time: 804.5907s
	iters: 600, epoch: 13 | loss: 0.2045893
	speed: 0.1026s/iter; left time: 827.9502s
	iters: 700, epoch: 13 | loss: 0.1909469
	speed: 0.0984s/iter; left time: 784.2195s
	iters: 800, epoch: 13 | loss: 0.2190624
	speed: 0.0945s/iter; left time: 744.3867s
	iters: 900, epoch: 13 | loss: 0.2004697
	speed: 0.0949s/iter; left time: 737.9129s
	iters: 1000, epoch: 13 | loss: 0.2021199
	speed: 0.0944s/iter; left time: 724.2592s
Epoch: 13 cost time: 104.52112245559692
Epoch: 13, Steps: 1084 | Train Loss: 0.1952692 Vali Loss: 0.1680863 Test Loss: 0.2014642
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.1845227
	speed: 0.3658s/iter; left time: 2739.1728s
	iters: 200, epoch: 14 | loss: 0.1780709
	speed: 0.0944s/iter; left time: 697.7494s
	iters: 300, epoch: 14 | loss: 0.1924975
	speed: 0.0951s/iter; left time: 693.3376s
	iters: 400, epoch: 14 | loss: 0.1793648
	speed: 0.0978s/iter; left time: 703.3265s
	iters: 500, epoch: 14 | loss: 0.1918231
	speed: 0.1012s/iter; left time: 717.6863s
	iters: 600, epoch: 14 | loss: 0.2088289
	speed: 0.0996s/iter; left time: 695.9389s
	iters: 700, epoch: 14 | loss: 0.1864039
	speed: 0.0959s/iter; left time: 660.9903s
	iters: 800, epoch: 14 | loss: 0.2117840
	speed: 0.0944s/iter; left time: 641.2113s
	iters: 900, epoch: 14 | loss: 0.2032676
	speed: 0.0943s/iter; left time: 630.6009s
	iters: 1000, epoch: 14 | loss: 0.1772992
	speed: 0.0946s/iter; left time: 623.0797s
Epoch: 14 cost time: 104.07593607902527
Epoch: 14, Steps: 1084 | Train Loss: 0.1952044 Vali Loss: 0.1681302 Test Loss: 0.2014931
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : Electricity_336_720_Linear_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15726<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4541
mse:0.20169831812381744, mae:0.2980142831802368
