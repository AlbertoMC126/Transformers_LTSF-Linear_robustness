Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTh1', data_path='ETTh1.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='NLinear', model_id='ETTh1_336_720', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=720, root_path='./dataset/', save_pred_values=False, seed=3144, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTh1_336_720_NLinear_ETTh1_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3144>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7585
val 2161
test 2161
	iters: 100, epoch: 1 | loss: 0.6592633
	speed: 0.0201s/iter; left time: 93.1509s
	iters: 200, epoch: 1 | loss: 0.7842175
	speed: 0.0180s/iter; left time: 81.5644s
Epoch: 1 cost time: 4.441506862640381
Epoch: 1, Steps: 237 | Train Loss: 0.6744584 Vali Loss: 1.6649599 Test Loss: 0.5387130
Validation loss decreased (inf --> 1.664960).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.6597746
	speed: 0.0336s/iter; left time: 147.9961s
	iters: 200, epoch: 2 | loss: 0.5977433
	speed: 0.0191s/iter; left time: 82.0075s
Epoch: 2 cost time: 4.456933975219727
Epoch: 2, Steps: 237 | Train Loss: 0.6425042 Vali Loss: 1.7207191 Test Loss: 0.5489513
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.5957718
	speed: 0.0309s/iter; left time: 128.8739s
	iters: 200, epoch: 3 | loss: 0.5592635
	speed: 0.0179s/iter; left time: 72.6284s
Epoch: 3 cost time: 4.110073089599609
Epoch: 3, Steps: 237 | Train Loss: 0.5911439 Vali Loss: 1.5706662 Test Loss: 0.4872381
Validation loss decreased (1.664960 --> 1.570666).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.5946923
	speed: 0.0311s/iter; left time: 122.0888s
	iters: 200, epoch: 4 | loss: 0.5642626
	speed: 0.0185s/iter; left time: 71.0185s
Epoch: 4 cost time: 4.333745956420898
Epoch: 4, Steps: 237 | Train Loss: 0.5664197 Vali Loss: 1.5914592 Test Loss: 0.4705073
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.5568665
	speed: 0.0333s/iter; left time: 122.8944s
	iters: 200, epoch: 5 | loss: 0.5709661
	speed: 0.0198s/iter; left time: 71.1759s
Epoch: 5 cost time: 4.386973857879639
Epoch: 5, Steps: 237 | Train Loss: 0.5539671 Vali Loss: 1.5298827 Test Loss: 0.4645692
Validation loss decreased (1.570666 --> 1.529883).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.6109305
	speed: 0.0320s/iter; left time: 110.4235s
	iters: 200, epoch: 6 | loss: 0.5884330
	speed: 0.0197s/iter; left time: 66.1121s
Epoch: 6 cost time: 4.434771299362183
Epoch: 6, Steps: 237 | Train Loss: 0.5479370 Vali Loss: 1.5659133 Test Loss: 0.4621923
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.5593658
	speed: 0.0352s/iter; left time: 113.2956s
	iters: 200, epoch: 7 | loss: 0.4762385
	speed: 0.0172s/iter; left time: 53.6143s
Epoch: 7 cost time: 4.346658706665039
Epoch: 7, Steps: 237 | Train Loss: 0.5444516 Vali Loss: 1.5201023 Test Loss: 0.4549124
Validation loss decreased (1.529883 --> 1.520102).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.5557538
	speed: 0.0350s/iter; left time: 104.4122s
	iters: 200, epoch: 8 | loss: 0.6068596
	speed: 0.0184s/iter; left time: 53.0093s
Epoch: 8 cost time: 4.3782289028167725
Epoch: 8, Steps: 237 | Train Loss: 0.5426066 Vali Loss: 1.5229295 Test Loss: 0.4548942
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.4951563
	speed: 0.0356s/iter; left time: 97.7954s
	iters: 200, epoch: 9 | loss: 0.5608010
	speed: 0.0204s/iter; left time: 54.0609s
Epoch: 9 cost time: 4.683012962341309
Epoch: 9, Steps: 237 | Train Loss: 0.5416186 Vali Loss: 1.5185708 Test Loss: 0.4542503
Validation loss decreased (1.520102 --> 1.518571).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.5656832
	speed: 0.0323s/iter; left time: 80.8886s
	iters: 200, epoch: 10 | loss: 0.5711367
	speed: 0.0191s/iter; left time: 46.0366s
Epoch: 10 cost time: 4.17753267288208
Epoch: 10, Steps: 237 | Train Loss: 0.5412309 Vali Loss: 1.5184278 Test Loss: 0.4541192
Validation loss decreased (1.518571 --> 1.518428).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.5287973
	speed: 0.0411s/iter; left time: 93.3132s
	iters: 200, epoch: 11 | loss: 0.5833884
	speed: 0.0250s/iter; left time: 54.2536s
Epoch: 11 cost time: 6.0227110385894775
Epoch: 11, Steps: 237 | Train Loss: 0.5408832 Vali Loss: 1.5126381 Test Loss: 0.4536988
Validation loss decreased (1.518428 --> 1.512638).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.5361048
	speed: 0.0344s/iter; left time: 69.8911s
	iters: 200, epoch: 12 | loss: 0.5447787
	speed: 0.0173s/iter; left time: 33.4986s
Epoch: 12 cost time: 4.096143484115601
Epoch: 12, Steps: 237 | Train Loss: 0.5407008 Vali Loss: 1.5158955 Test Loss: 0.4536982
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.6012062
	speed: 0.0340s/iter; left time: 61.1223s
	iters: 200, epoch: 13 | loss: 0.6147608
	speed: 0.0167s/iter; left time: 28.3850s
Epoch: 13 cost time: 4.126112937927246
Epoch: 13, Steps: 237 | Train Loss: 0.5406118 Vali Loss: 1.5140407 Test Loss: 0.4537027
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.5262512
	speed: 0.0304s/iter; left time: 47.3508s
	iters: 200, epoch: 14 | loss: 0.5270794
	speed: 0.0162s/iter; left time: 23.6538s
Epoch: 14 cost time: 3.761749267578125
Epoch: 14, Steps: 237 | Train Loss: 0.5404971 Vali Loss: 1.5183330 Test Loss: 0.4536644
EarlyStopping counter: 3 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.5594368
	speed: 0.0280s/iter; left time: 37.1083s
	iters: 200, epoch: 15 | loss: 0.5796736
	speed: 0.0139s/iter; left time: 17.0325s
Epoch: 15 cost time: 3.3789703845977783
Epoch: 15, Steps: 237 | Train Loss: 0.5405138 Vali Loss: 1.5145274 Test Loss: 0.4536594
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.5144838
	speed: 0.0259s/iter; left time: 28.1016s
	iters: 200, epoch: 16 | loss: 0.5305656
	speed: 0.0132s/iter; left time: 12.9937s
Epoch: 16 cost time: 3.1972925662994385
Epoch: 16, Steps: 237 | Train Loss: 0.5405324 Vali Loss: 1.5148036 Test Loss: 0.4536548
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTh1_336_720_NLinear_ETTh1_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3144<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
mse:0.4525764286518097, mae:0.45997926592826843
