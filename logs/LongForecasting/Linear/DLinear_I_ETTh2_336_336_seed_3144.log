Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTh2', data_path='ETTh2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='DLinear', model_id='ETTh2_336_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=336, root_path='./dataset/', save_pred_values=False, seed=3144, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTh2_336_336_DLinear_ETTh2_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3144>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7969
val 2545
test 2545
Total number of trainable parameters: 1585248
Total number of parameters: 1585248
	iters: 100, epoch: 1 | loss: 0.6630357
	speed: 0.0286s/iter; left time: 139.5982s
	iters: 200, epoch: 1 | loss: 0.5459360
	speed: 0.0283s/iter; left time: 135.1274s
Epoch: 1 cost time: 7.118107557296753
Epoch: 1, Steps: 249 | Train Loss: 0.6917054 Vali Loss: 0.7108105 Test Loss: 1.3896141
Validation loss decreased (inf --> 0.710810).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.4027018
	speed: 0.0546s/iter; left time: 252.6894s
	iters: 200, epoch: 2 | loss: 0.7272598
	speed: 0.0308s/iter; left time: 139.6072s
Epoch: 2 cost time: 7.477057218551636
Epoch: 2, Steps: 249 | Train Loss: 0.6770399 Vali Loss: 0.5347211 Test Loss: 0.8701541
Validation loss decreased (0.710810 --> 0.534721).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.3818273
	speed: 0.0563s/iter; left time: 246.8411s
	iters: 200, epoch: 3 | loss: 0.4089450
	speed: 0.0315s/iter; left time: 135.1225s
Epoch: 3 cost time: 7.478329181671143
Epoch: 3, Steps: 249 | Train Loss: 0.5828515 Vali Loss: 0.5695181 Test Loss: 1.0160538
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.8757557
	speed: 0.0520s/iter; left time: 215.0326s
	iters: 200, epoch: 4 | loss: 0.5187200
	speed: 0.0297s/iter; left time: 119.7669s
Epoch: 4 cost time: 7.269772052764893
Epoch: 4, Steps: 249 | Train Loss: 0.5457334 Vali Loss: 0.4771273 Test Loss: 0.7729882
Validation loss decreased (0.534721 --> 0.477127).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.4380083
	speed: 0.0561s/iter; left time: 218.1425s
	iters: 200, epoch: 5 | loss: 0.6492304
	speed: 0.0297s/iter; left time: 112.3155s
Epoch: 5 cost time: 7.312952518463135
Epoch: 5, Steps: 249 | Train Loss: 0.5294699 Vali Loss: 0.4918388 Test Loss: 0.7778127
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.3742430
	speed: 0.0518s/iter; left time: 188.3894s
	iters: 200, epoch: 6 | loss: 0.2798255
	speed: 0.0298s/iter; left time: 105.5406s
Epoch: 6 cost time: 7.325102806091309
Epoch: 6, Steps: 249 | Train Loss: 0.5210366 Vali Loss: 0.4856684 Test Loss: 0.7286994
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.6128848
	speed: 0.0549s/iter; left time: 185.8234s
	iters: 200, epoch: 7 | loss: 0.6329568
	speed: 0.0303s/iter; left time: 99.6353s
Epoch: 7 cost time: 7.367579936981201
Epoch: 7, Steps: 249 | Train Loss: 0.5166181 Vali Loss: 0.4893613 Test Loss: 0.7015375
EarlyStopping counter: 3 out of 5
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.4254128
	speed: 0.0506s/iter; left time: 158.6921s
	iters: 200, epoch: 8 | loss: 0.4417561
	speed: 0.0272s/iter; left time: 82.6139s
Epoch: 8 cost time: 6.654286623001099
Epoch: 8, Steps: 249 | Train Loss: 0.5138925 Vali Loss: 0.4755874 Test Loss: 0.6822182
Validation loss decreased (0.477127 --> 0.475587).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.6901299
	speed: 0.0514s/iter; left time: 148.5596s
	iters: 200, epoch: 9 | loss: 0.5545974
	speed: 0.0270s/iter; left time: 75.2832s
Epoch: 9 cost time: 6.640939712524414
Epoch: 9, Steps: 249 | Train Loss: 0.5127512 Vali Loss: 0.4831700 Test Loss: 0.7276739
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.4941505
	speed: 0.0484s/iter; left time: 127.8491s
	iters: 200, epoch: 10 | loss: 0.5533733
	speed: 0.0264s/iter; left time: 67.1115s
Epoch: 10 cost time: 6.503255367279053
Epoch: 10, Steps: 249 | Train Loss: 0.5119926 Vali Loss: 0.4783569 Test Loss: 0.6918518
EarlyStopping counter: 2 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.3600728
	speed: 0.0431s/iter; left time: 103.0582s
	iters: 200, epoch: 11 | loss: 0.5853261
	speed: 0.0167s/iter; left time: 38.2321s
Epoch: 11 cost time: 4.594922780990601
Epoch: 11, Steps: 249 | Train Loss: 0.5116328 Vali Loss: 0.4778661 Test Loss: 0.6903723
EarlyStopping counter: 3 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.4530349
	speed: 0.0276s/iter; left time: 59.0996s
	iters: 200, epoch: 12 | loss: 0.6511895
	speed: 0.0129s/iter; left time: 26.3634s
Epoch: 12 cost time: 3.23964786529541
Epoch: 12, Steps: 249 | Train Loss: 0.5112935 Vali Loss: 0.4794667 Test Loss: 0.6985729
EarlyStopping counter: 4 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.3805681
	speed: 0.0220s/iter; left time: 41.7055s
	iters: 200, epoch: 13 | loss: 0.4904033
	speed: 0.0106s/iter; left time: 19.0287s
Epoch: 13 cost time: 2.6829206943511963
Epoch: 13, Steps: 249 | Train Loss: 0.5112699 Vali Loss: 0.4803053 Test Loss: 0.7021011
EarlyStopping counter: 5 out of 5
Early stopping
Total training time: 93.7097 seconds
>>>>>>>testing : ETTh2_336_336_DLinear_ETTh2_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3144<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2545
mse:0.6801450848579407, mae:0.5493574142456055
