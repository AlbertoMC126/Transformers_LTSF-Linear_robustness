Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='DLinear', model_id='ETTm2_336_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=336, root_path='./dataset/', save_pred_values=False, seed=10458, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTm2_336_336_DLinear_ETTm2_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed10458>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33889
val 11185
test 11185
	iters: 100, epoch: 1 | loss: 0.6796852
	speed: 0.0178s/iter; left time: 374.5623s
	iters: 200, epoch: 1 | loss: 0.3660182
	speed: 0.0171s/iter; left time: 358.0508s
	iters: 300, epoch: 1 | loss: 0.7405818
	speed: 0.0175s/iter; left time: 365.2962s
	iters: 400, epoch: 1 | loss: 0.3578287
	speed: 0.0181s/iter; left time: 376.8472s
	iters: 500, epoch: 1 | loss: 0.4983953
	speed: 0.0168s/iter; left time: 347.6617s
	iters: 600, epoch: 1 | loss: 0.3526822
	speed: 0.0174s/iter; left time: 357.5917s
	iters: 700, epoch: 1 | loss: 0.4185522
	speed: 0.0183s/iter; left time: 374.5391s
	iters: 800, epoch: 1 | loss: 0.4067776
	speed: 0.0176s/iter; left time: 359.1172s
	iters: 900, epoch: 1 | loss: 0.4793766
	speed: 0.0173s/iter; left time: 351.7266s
	iters: 1000, epoch: 1 | loss: 0.6728947
	speed: 0.0172s/iter; left time: 346.3760s
Epoch: 1 cost time: 18.40432643890381
Epoch: 1, Steps: 1059 | Train Loss: 0.6444746 Vali Loss: 0.5347554 Test Loss: 0.8760203
Validation loss decreased (inf --> 0.534755).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.3912634
	speed: 0.0661s/iter; left time: 1323.5943s
	iters: 200, epoch: 2 | loss: 0.5278811
	speed: 0.0173s/iter; left time: 345.3252s
	iters: 300, epoch: 2 | loss: 0.6243544
	speed: 0.0178s/iter; left time: 353.2796s
	iters: 400, epoch: 2 | loss: 0.4146531
	speed: 0.0172s/iter; left time: 340.1003s
	iters: 500, epoch: 2 | loss: 0.9307269
	speed: 0.0166s/iter; left time: 325.0607s
	iters: 600, epoch: 2 | loss: 0.7947279
	speed: 0.0172s/iter; left time: 335.8778s
	iters: 700, epoch: 2 | loss: 0.9343972
	speed: 0.0173s/iter; left time: 335.5055s
	iters: 800, epoch: 2 | loss: 1.2520151
	speed: 0.0174s/iter; left time: 337.1126s
	iters: 900, epoch: 2 | loss: 1.0364096
	speed: 0.0161s/iter; left time: 309.4897s
	iters: 1000, epoch: 2 | loss: 0.5161906
	speed: 0.0171s/iter; left time: 326.5104s
Epoch: 2 cost time: 18.03380060195923
Epoch: 2, Steps: 1059 | Train Loss: 0.6601418 Vali Loss: 0.8176182 Test Loss: 2.0242596
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.2635857
	speed: 0.0597s/iter; left time: 1131.1821s
	iters: 200, epoch: 3 | loss: 0.4939031
	speed: 0.0172s/iter; left time: 324.5216s
	iters: 300, epoch: 3 | loss: 0.4018590
	speed: 0.0171s/iter; left time: 321.3629s
	iters: 400, epoch: 3 | loss: 0.2370195
	speed: 0.0161s/iter; left time: 301.1138s
	iters: 500, epoch: 3 | loss: 0.4129342
	speed: 0.0167s/iter; left time: 309.6054s
	iters: 600, epoch: 3 | loss: 0.3309263
	speed: 0.0176s/iter; left time: 325.2266s
	iters: 700, epoch: 3 | loss: 0.6045924
	speed: 0.0177s/iter; left time: 324.6938s
	iters: 800, epoch: 3 | loss: 0.3475680
	speed: 0.0169s/iter; left time: 308.4236s
	iters: 900, epoch: 3 | loss: 0.4217209
	speed: 0.0171s/iter; left time: 310.6692s
	iters: 1000, epoch: 3 | loss: 0.3340712
	speed: 0.0183s/iter; left time: 331.1844s
Epoch: 3 cost time: 18.000200986862183
Epoch: 3, Steps: 1059 | Train Loss: 0.4606371 Vali Loss: 0.3387751 Test Loss: 0.5701953
Validation loss decreased (0.534755 --> 0.338775).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.3799392
	speed: 0.0636s/iter; left time: 1138.1719s
	iters: 200, epoch: 4 | loss: 0.2406177
	speed: 0.0170s/iter; left time: 302.8262s
	iters: 300, epoch: 4 | loss: 0.3403564
	speed: 0.0167s/iter; left time: 294.8111s
	iters: 400, epoch: 4 | loss: 0.4923107
	speed: 0.0166s/iter; left time: 292.6855s
	iters: 500, epoch: 4 | loss: 0.5432199
	speed: 0.0172s/iter; left time: 301.8704s
	iters: 600, epoch: 4 | loss: 0.3358909
	speed: 0.0179s/iter; left time: 311.1171s
	iters: 700, epoch: 4 | loss: 0.3675009
	speed: 0.0183s/iter; left time: 316.1702s
	iters: 800, epoch: 4 | loss: 0.3435678
	speed: 0.0170s/iter; left time: 292.9407s
	iters: 900, epoch: 4 | loss: 0.3240398
	speed: 0.0168s/iter; left time: 288.0532s
	iters: 1000, epoch: 4 | loss: 0.5455794
	speed: 0.0172s/iter; left time: 292.9274s
Epoch: 4 cost time: 17.901505947113037
Epoch: 4, Steps: 1059 | Train Loss: 0.4050241 Vali Loss: 0.2969949 Test Loss: 0.5124624
Validation loss decreased (0.338775 --> 0.296995).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.2152923
	speed: 0.0668s/iter; left time: 1126.0613s
	iters: 200, epoch: 5 | loss: 0.3246602
	speed: 0.0176s/iter; left time: 294.9736s
	iters: 300, epoch: 5 | loss: 0.2424618
	speed: 0.0179s/iter; left time: 297.1420s
	iters: 400, epoch: 5 | loss: 0.2761399
	speed: 0.0178s/iter; left time: 293.7461s
	iters: 500, epoch: 5 | loss: 0.2502649
	speed: 0.0173s/iter; left time: 285.1228s
	iters: 600, epoch: 5 | loss: 0.2785172
	speed: 0.0174s/iter; left time: 284.8274s
	iters: 700, epoch: 5 | loss: 0.6760848
	speed: 0.0179s/iter; left time: 290.7757s
	iters: 800, epoch: 5 | loss: 0.2475962
	speed: 0.0174s/iter; left time: 280.8407s
	iters: 900, epoch: 5 | loss: 0.3543769
	speed: 0.0173s/iter; left time: 278.2600s
	iters: 1000, epoch: 5 | loss: 0.5312823
	speed: 0.0169s/iter; left time: 268.9063s
Epoch: 5 cost time: 18.419459342956543
Epoch: 5, Steps: 1059 | Train Loss: 0.3776130 Vali Loss: 0.4363626 Test Loss: 1.0066475
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.2393080
	speed: 0.0674s/iter; left time: 1064.1842s
	iters: 200, epoch: 6 | loss: 0.4983862
	speed: 0.0169s/iter; left time: 265.3722s
	iters: 300, epoch: 6 | loss: 0.2509677
	speed: 0.0163s/iter; left time: 254.4835s
	iters: 400, epoch: 6 | loss: 0.3787303
	speed: 0.0184s/iter; left time: 284.9978s
	iters: 500, epoch: 6 | loss: 0.6973103
	speed: 0.0167s/iter; left time: 256.3544s
	iters: 600, epoch: 6 | loss: 0.4527457
	speed: 0.0177s/iter; left time: 270.3585s
	iters: 700, epoch: 6 | loss: 0.4364071
	speed: 0.0173s/iter; left time: 263.2834s
	iters: 800, epoch: 6 | loss: 0.2680420
	speed: 0.0173s/iter; left time: 261.6744s
	iters: 900, epoch: 6 | loss: 0.2995394
	speed: 0.0180s/iter; left time: 269.9627s
	iters: 1000, epoch: 6 | loss: 0.2938366
	speed: 0.0158s/iter; left time: 235.4248s
Epoch: 6 cost time: 18.19497013092041
Epoch: 6, Steps: 1059 | Train Loss: 0.3644528 Vali Loss: 0.2649109 Test Loss: 0.4365757
Validation loss decreased (0.296995 --> 0.264911).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.2742856
	speed: 0.0642s/iter; left time: 944.8621s
	iters: 200, epoch: 7 | loss: 0.3611601
	speed: 0.0179s/iter; left time: 262.0734s
	iters: 300, epoch: 7 | loss: 0.2534834
	speed: 0.0165s/iter; left time: 240.2179s
	iters: 400, epoch: 7 | loss: 0.2284281
	speed: 0.0172s/iter; left time: 248.8194s
	iters: 500, epoch: 7 | loss: 0.2056137
	speed: 0.0173s/iter; left time: 248.1910s
	iters: 600, epoch: 7 | loss: 0.3072130
	speed: 0.0174s/iter; left time: 248.1134s
	iters: 700, epoch: 7 | loss: 0.7188601
	speed: 0.0182s/iter; left time: 256.4792s
	iters: 800, epoch: 7 | loss: 0.5040746
	speed: 0.0162s/iter; left time: 226.9405s
	iters: 900, epoch: 7 | loss: 0.3983850
	speed: 0.0177s/iter; left time: 247.1075s
	iters: 1000, epoch: 7 | loss: 0.2609856
	speed: 0.0155s/iter; left time: 214.7765s
Epoch: 7 cost time: 18.152263402938843
Epoch: 7, Steps: 1059 | Train Loss: 0.3574620 Vali Loss: 0.2665196 Test Loss: 0.4684551
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.3494753
	speed: 0.0657s/iter; left time: 898.2065s
	iters: 200, epoch: 8 | loss: 0.3318420
	speed: 0.0167s/iter; left time: 226.2409s
	iters: 300, epoch: 8 | loss: 0.2888729
	speed: 0.0171s/iter; left time: 230.8072s
	iters: 400, epoch: 8 | loss: 0.2504779
	speed: 0.0149s/iter; left time: 199.4793s
	iters: 500, epoch: 8 | loss: 0.5188327
	speed: 0.0155s/iter; left time: 206.2765s
	iters: 600, epoch: 8 | loss: 0.4317179
	speed: 0.0134s/iter; left time: 176.8858s
	iters: 700, epoch: 8 | loss: 0.2122887
	speed: 0.0164s/iter; left time: 214.6827s
	iters: 800, epoch: 8 | loss: 0.2580130
	speed: 0.0174s/iter; left time: 226.2216s
	iters: 900, epoch: 8 | loss: 0.2815312
	speed: 0.0167s/iter; left time: 215.4821s
	iters: 1000, epoch: 8 | loss: 0.2629527
	speed: 0.0158s/iter; left time: 201.1391s
Epoch: 8 cost time: 17.112013816833496
Epoch: 8, Steps: 1059 | Train Loss: 0.3526099 Vali Loss: 0.2480438 Test Loss: 0.4191739
Validation loss decreased (0.264911 --> 0.248044).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.4541450
	speed: 0.0707s/iter; left time: 891.5302s
	iters: 200, epoch: 9 | loss: 0.4659586
	speed: 0.0166s/iter; left time: 207.4687s
	iters: 300, epoch: 9 | loss: 0.3411511
	speed: 0.0150s/iter; left time: 186.0696s
	iters: 400, epoch: 9 | loss: 0.5053343
	speed: 0.0183s/iter; left time: 224.9637s
	iters: 500, epoch: 9 | loss: 0.5493094
	speed: 0.0174s/iter; left time: 211.8810s
	iters: 600, epoch: 9 | loss: 0.2411421
	speed: 0.0167s/iter; left time: 202.2728s
	iters: 700, epoch: 9 | loss: 0.3797848
	speed: 0.0179s/iter; left time: 214.9015s
	iters: 800, epoch: 9 | loss: 0.2526692
	speed: 0.0180s/iter; left time: 213.9637s
	iters: 900, epoch: 9 | loss: 0.2262350
	speed: 0.0166s/iter; left time: 195.7215s
	iters: 1000, epoch: 9 | loss: 0.2159828
	speed: 0.0149s/iter; left time: 174.2706s
Epoch: 9 cost time: 17.857791662216187
Epoch: 9, Steps: 1059 | Train Loss: 0.3503954 Vali Loss: 0.2786574 Test Loss: 0.5205098
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.2871631
	speed: 0.0668s/iter; left time: 771.6026s
	iters: 200, epoch: 10 | loss: 0.3760784
	speed: 0.0171s/iter; left time: 195.9396s
	iters: 300, epoch: 10 | loss: 0.2640067
	speed: 0.0172s/iter; left time: 195.1751s
	iters: 400, epoch: 10 | loss: 0.2028327
	speed: 0.0168s/iter; left time: 189.1844s
	iters: 500, epoch: 10 | loss: 0.3906377
	speed: 0.0165s/iter; left time: 184.1485s
	iters: 600, epoch: 10 | loss: 0.3632400
	speed: 0.0153s/iter; left time: 169.3149s
	iters: 700, epoch: 10 | loss: 0.2697537
	speed: 0.0166s/iter; left time: 182.0031s
	iters: 800, epoch: 10 | loss: 0.3999026
	speed: 0.0168s/iter; left time: 182.1575s
	iters: 900, epoch: 10 | loss: 0.1658663
	speed: 0.0170s/iter; left time: 182.5794s
	iters: 1000, epoch: 10 | loss: 0.3224342
	speed: 0.0147s/iter; left time: 156.7203s
Epoch: 10 cost time: 17.326664686203003
Epoch: 10, Steps: 1059 | Train Loss: 0.3491451 Vali Loss: 0.2737847 Test Loss: 0.4957099
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.2420585
	speed: 0.0640s/iter; left time: 671.6611s
	iters: 200, epoch: 11 | loss: 0.2194022
	speed: 0.0171s/iter; left time: 177.8906s
	iters: 300, epoch: 11 | loss: 0.5658712
	speed: 0.0177s/iter; left time: 182.5834s
	iters: 400, epoch: 11 | loss: 0.7451670
	speed: 0.0169s/iter; left time: 171.8425s
	iters: 500, epoch: 11 | loss: 0.1908983
	speed: 0.0170s/iter; left time: 171.4951s
	iters: 600, epoch: 11 | loss: 0.2891756
	speed: 0.0163s/iter; left time: 163.0589s
	iters: 700, epoch: 11 | loss: 0.2501450
	speed: 0.0154s/iter; left time: 152.1780s
	iters: 800, epoch: 11 | loss: 0.2479158
	speed: 0.0153s/iter; left time: 149.5457s
	iters: 900, epoch: 11 | loss: 0.2018968
	speed: 0.0150s/iter; left time: 144.8897s
	iters: 1000, epoch: 11 | loss: 0.3480079
	speed: 0.0145s/iter; left time: 139.0937s
Epoch: 11 cost time: 16.931905508041382
Epoch: 11, Steps: 1059 | Train Loss: 0.3484435 Vali Loss: 0.2824419 Test Loss: 0.5261280
EarlyStopping counter: 3 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.3201711
	speed: 0.0576s/iter; left time: 543.3582s
	iters: 200, epoch: 12 | loss: 0.1847099
	speed: 0.0142s/iter; left time: 132.0899s
	iters: 300, epoch: 12 | loss: 0.5135665
	speed: 0.0154s/iter; left time: 142.5499s
	iters: 400, epoch: 12 | loss: 0.2029561
	speed: 0.0166s/iter; left time: 151.3735s
	iters: 500, epoch: 12 | loss: 0.2700362
	speed: 0.0167s/iter; left time: 150.7963s
	iters: 600, epoch: 12 | loss: 0.5223006
	speed: 0.0163s/iter; left time: 145.8988s
	iters: 700, epoch: 12 | loss: 0.4737575
	speed: 0.0154s/iter; left time: 136.4423s
	iters: 800, epoch: 12 | loss: 0.2689860
	speed: 0.0162s/iter; left time: 141.6958s
	iters: 900, epoch: 12 | loss: 0.4446606
	speed: 0.0150s/iter; left time: 129.6516s
	iters: 1000, epoch: 12 | loss: 0.3774977
	speed: 0.0144s/iter; left time: 123.2465s
Epoch: 12 cost time: 16.27066969871521
Epoch: 12, Steps: 1059 | Train Loss: 0.3480585 Vali Loss: 0.2822173 Test Loss: 0.5281551
EarlyStopping counter: 4 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.2087209
	speed: 0.0585s/iter; left time: 489.7362s
	iters: 200, epoch: 13 | loss: 0.2015451
	speed: 0.0148s/iter; left time: 122.2504s
	iters: 300, epoch: 13 | loss: 0.7052572
	speed: 0.0148s/iter; left time: 120.6551s
	iters: 400, epoch: 13 | loss: 0.2106258
	speed: 0.0142s/iter; left time: 114.5466s
	iters: 500, epoch: 13 | loss: 0.2061611
	speed: 0.0134s/iter; left time: 106.8604s
	iters: 600, epoch: 13 | loss: 0.4506160
	speed: 0.0135s/iter; left time: 105.9206s
	iters: 700, epoch: 13 | loss: 0.2266804
	speed: 0.0140s/iter; left time: 108.4935s
	iters: 800, epoch: 13 | loss: 0.2891413
	speed: 0.0136s/iter; left time: 104.4414s
	iters: 900, epoch: 13 | loss: 0.2917943
	speed: 0.0133s/iter; left time: 101.0314s
	iters: 1000, epoch: 13 | loss: 0.2711653
	speed: 0.0133s/iter; left time: 99.6521s
Epoch: 13 cost time: 14.696647644042969
Epoch: 13, Steps: 1059 | Train Loss: 0.3477719 Vali Loss: 0.2805248 Test Loss: 0.5220479
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTm2_336_336_DLinear_ETTm2_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed10458<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
mse:0.4195871651172638, mae:0.42000511288642883
