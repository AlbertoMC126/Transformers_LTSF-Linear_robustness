Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='Linear', model_id='weather_336_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=336, root_path='./dataset/', save_pred_values=False, seed=15726, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : weather_336_336_Linear_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15726>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36216
val 4935
test 10204
	iters: 100, epoch: 1 | loss: 0.4871119
	speed: 0.0241s/iter; left time: 1088.6558s
	iters: 200, epoch: 1 | loss: 0.5624580
	speed: 0.0246s/iter; left time: 1110.0002s
	iters: 300, epoch: 1 | loss: 0.5555407
	speed: 0.0249s/iter; left time: 1118.2796s
	iters: 400, epoch: 1 | loss: 0.4643830
	speed: 0.0251s/iter; left time: 1125.3922s
	iters: 500, epoch: 1 | loss: 1.1927111
	speed: 0.0242s/iter; left time: 1085.1806s
	iters: 600, epoch: 1 | loss: 1.1292375
	speed: 0.0246s/iter; left time: 1099.9110s
	iters: 700, epoch: 1 | loss: 0.5839065
	speed: 0.0250s/iter; left time: 1112.0218s
	iters: 800, epoch: 1 | loss: 0.4714890
	speed: 0.0250s/iter; left time: 1112.9186s
	iters: 900, epoch: 1 | loss: 0.4654470
	speed: 0.0247s/iter; left time: 1096.6247s
	iters: 1000, epoch: 1 | loss: 0.4233881
	speed: 0.0250s/iter; left time: 1104.4837s
	iters: 1100, epoch: 1 | loss: 0.5758133
	speed: 0.0248s/iter; left time: 1095.7456s
	iters: 1200, epoch: 1 | loss: 1.2267536
	speed: 0.0246s/iter; left time: 1083.1564s
	iters: 1300, epoch: 1 | loss: 0.5143863
	speed: 0.0249s/iter; left time: 1094.6514s
	iters: 1400, epoch: 1 | loss: 0.6627575
	speed: 0.0241s/iter; left time: 1056.0187s
	iters: 1500, epoch: 1 | loss: 0.4970064
	speed: 0.0245s/iter; left time: 1073.5215s
	iters: 1600, epoch: 1 | loss: 0.4413173
	speed: 0.0249s/iter; left time: 1086.7357s
	iters: 1700, epoch: 1 | loss: 4.9756355
	speed: 0.0244s/iter; left time: 1064.0060s
	iters: 1800, epoch: 1 | loss: 0.5883118
	speed: 0.0244s/iter; left time: 1060.7107s
	iters: 1900, epoch: 1 | loss: 0.5133219
	speed: 0.0248s/iter; left time: 1076.9734s
	iters: 2000, epoch: 1 | loss: 0.6559916
	speed: 0.0246s/iter; left time: 1063.5824s
	iters: 2100, epoch: 1 | loss: 0.5856580
	speed: 0.0243s/iter; left time: 1050.4466s
	iters: 2200, epoch: 1 | loss: 0.6723738
	speed: 0.0249s/iter; left time: 1071.0096s
Epoch: 1 cost time: 55.829792499542236
Epoch: 1, Steps: 2263 | Train Loss: 1.1799320 Vali Loss: 0.6886988 Test Loss: 0.3292824
Validation loss decreased (inf --> 0.688699).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.5070753
	speed: 0.0803s/iter; left time: 3444.7633s
	iters: 200, epoch: 2 | loss: 0.6615916
	speed: 0.0248s/iter; left time: 1060.3015s
	iters: 300, epoch: 2 | loss: 0.4995206
	speed: 0.0246s/iter; left time: 1050.4647s
	iters: 400, epoch: 2 | loss: 0.4560017
	speed: 0.0246s/iter; left time: 1049.8880s
	iters: 500, epoch: 2 | loss: 1.4484313
	speed: 0.0246s/iter; left time: 1046.6022s
	iters: 600, epoch: 2 | loss: 0.5054223
	speed: 0.0247s/iter; left time: 1049.2028s
	iters: 700, epoch: 2 | loss: 0.5155639
	speed: 0.0247s/iter; left time: 1042.6463s
	iters: 800, epoch: 2 | loss: 1.0791163
	speed: 0.0240s/iter; left time: 1011.7982s
	iters: 900, epoch: 2 | loss: 0.5300948
	speed: 0.0239s/iter; left time: 1007.9486s
	iters: 1000, epoch: 2 | loss: 1.5481457
	speed: 0.0245s/iter; left time: 1029.0257s
	iters: 1100, epoch: 2 | loss: 0.5301239
	speed: 0.0247s/iter; left time: 1035.4407s
	iters: 1200, epoch: 2 | loss: 0.4401954
	speed: 0.0249s/iter; left time: 1041.4593s
	iters: 1300, epoch: 2 | loss: 5.5909309
	speed: 0.0246s/iter; left time: 1027.0582s
	iters: 1400, epoch: 2 | loss: 0.6814876
	speed: 0.0241s/iter; left time: 1001.1368s
	iters: 1500, epoch: 2 | loss: 3.7316585
	speed: 0.0240s/iter; left time: 997.0282s
	iters: 1600, epoch: 2 | loss: 0.8133379
	speed: 0.0250s/iter; left time: 1033.2675s
	iters: 1700, epoch: 2 | loss: 4.0713978
	speed: 0.0244s/iter; left time: 1008.2307s
	iters: 1800, epoch: 2 | loss: 0.5244026
	speed: 0.0247s/iter; left time: 1017.2413s
	iters: 1900, epoch: 2 | loss: 0.9825763
	speed: 0.0247s/iter; left time: 1014.9547s
	iters: 2000, epoch: 2 | loss: 0.6770561
	speed: 0.0243s/iter; left time: 994.5946s
	iters: 2100, epoch: 2 | loss: 0.5363846
	speed: 0.0244s/iter; left time: 999.8073s
	iters: 2200, epoch: 2 | loss: 0.6648132
	speed: 0.0246s/iter; left time: 1001.6278s
Epoch: 2 cost time: 55.34018635749817
Epoch: 2, Steps: 2263 | Train Loss: 0.9670529 Vali Loss: 0.6642268 Test Loss: 0.3373359
Validation loss decreased (0.688699 --> 0.664227).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.4311858
	speed: 0.0796s/iter; left time: 3235.7929s
	iters: 200, epoch: 3 | loss: 1.0237545
	speed: 0.0241s/iter; left time: 978.5221s
	iters: 300, epoch: 3 | loss: 0.5027246
	speed: 0.0240s/iter; left time: 970.2585s
	iters: 400, epoch: 3 | loss: 0.5521826
	speed: 0.0240s/iter; left time: 967.7219s
	iters: 500, epoch: 3 | loss: 0.3048947
	speed: 0.0245s/iter; left time: 984.1604s
	iters: 600, epoch: 3 | loss: 0.4660110
	speed: 0.0245s/iter; left time: 985.1362s
	iters: 700, epoch: 3 | loss: 0.4646471
	speed: 0.0241s/iter; left time: 963.4819s
	iters: 800, epoch: 3 | loss: 0.4277706
	speed: 0.0241s/iter; left time: 963.7914s
	iters: 900, epoch: 3 | loss: 0.4633838
	speed: 0.0242s/iter; left time: 962.7419s
	iters: 1000, epoch: 3 | loss: 1.1854876
	speed: 0.0244s/iter; left time: 971.3965s
	iters: 1100, epoch: 3 | loss: 0.4317007
	speed: 0.0246s/iter; left time: 976.5938s
	iters: 1200, epoch: 3 | loss: 0.9758407
	speed: 0.0248s/iter; left time: 979.4620s
	iters: 1300, epoch: 3 | loss: 0.8601217
	speed: 0.0250s/iter; left time: 987.2605s
	iters: 1400, epoch: 3 | loss: 0.5014929
	speed: 0.0247s/iter; left time: 971.4744s
	iters: 1500, epoch: 3 | loss: 0.6158119
	speed: 0.0242s/iter; left time: 948.9397s
	iters: 1600, epoch: 3 | loss: 0.4129072
	speed: 0.0249s/iter; left time: 974.7480s
	iters: 1700, epoch: 3 | loss: 0.9505581
	speed: 0.0245s/iter; left time: 956.7233s
	iters: 1800, epoch: 3 | loss: 0.5747403
	speed: 0.0246s/iter; left time: 956.3709s
	iters: 1900, epoch: 3 | loss: 0.6216226
	speed: 0.0251s/iter; left time: 975.6073s
	iters: 2000, epoch: 3 | loss: 1.3577523
	speed: 0.0243s/iter; left time: 939.3935s
	iters: 2100, epoch: 3 | loss: 0.3947751
	speed: 0.0241s/iter; left time: 930.4949s
	iters: 2200, epoch: 3 | loss: 0.5020977
	speed: 0.0243s/iter; left time: 938.2221s
Epoch: 3 cost time: 55.19301176071167
Epoch: 3, Steps: 2263 | Train Loss: 0.7181835 Vali Loss: 0.5640501 Test Loss: 0.2857532
Validation loss decreased (0.664227 --> 0.564050).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.5920621
	speed: 0.0783s/iter; left time: 3004.4272s
	iters: 200, epoch: 4 | loss: 0.3344114
	speed: 0.0244s/iter; left time: 933.8866s
	iters: 300, epoch: 4 | loss: 0.5437506
	speed: 0.0246s/iter; left time: 937.3948s
	iters: 400, epoch: 4 | loss: 0.3554799
	speed: 0.0242s/iter; left time: 920.4419s
	iters: 500, epoch: 4 | loss: 0.4129439
	speed: 0.0246s/iter; left time: 935.3791s
	iters: 600, epoch: 4 | loss: 0.4539131
	speed: 0.0247s/iter; left time: 934.0233s
	iters: 700, epoch: 4 | loss: 0.5157050
	speed: 0.0247s/iter; left time: 934.4221s
	iters: 800, epoch: 4 | loss: 0.3957503
	speed: 0.0240s/iter; left time: 903.7195s
	iters: 900, epoch: 4 | loss: 0.4150481
	speed: 0.0245s/iter; left time: 921.8563s
	iters: 1000, epoch: 4 | loss: 0.3814308
	speed: 0.0249s/iter; left time: 933.8303s
	iters: 1100, epoch: 4 | loss: 0.3604069
	speed: 0.0245s/iter; left time: 916.4412s
	iters: 1200, epoch: 4 | loss: 0.3940621
	speed: 0.0247s/iter; left time: 920.9444s
	iters: 1300, epoch: 4 | loss: 0.4671185
	speed: 0.0248s/iter; left time: 922.1105s
	iters: 1400, epoch: 4 | loss: 0.5158875
	speed: 0.0250s/iter; left time: 927.5352s
	iters: 1500, epoch: 4 | loss: 0.4574308
	speed: 0.0243s/iter; left time: 898.5028s
	iters: 1600, epoch: 4 | loss: 0.3551189
	speed: 0.0251s/iter; left time: 926.2726s
	iters: 1700, epoch: 4 | loss: 0.5298283
	speed: 0.0248s/iter; left time: 913.1585s
	iters: 1800, epoch: 4 | loss: 0.3613442
	speed: 0.0240s/iter; left time: 879.5184s
	iters: 1900, epoch: 4 | loss: 0.4572423
	speed: 0.0245s/iter; left time: 894.7064s
	iters: 2000, epoch: 4 | loss: 0.4553922
	speed: 0.0246s/iter; left time: 896.7507s
	iters: 2100, epoch: 4 | loss: 0.5196251
	speed: 0.0248s/iter; left time: 901.9384s
	iters: 2200, epoch: 4 | loss: 0.3862361
	speed: 0.0246s/iter; left time: 892.2545s
Epoch: 4 cost time: 55.412991762161255
Epoch: 4, Steps: 2263 | Train Loss: 0.5798631 Vali Loss: 0.5371572 Test Loss: 0.2640391
Validation loss decreased (0.564050 --> 0.537157).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.5161729
	speed: 0.0790s/iter; left time: 2853.4254s
	iters: 200, epoch: 5 | loss: 0.6772303
	speed: 0.0248s/iter; left time: 892.8523s
	iters: 300, epoch: 5 | loss: 0.4152429
	speed: 0.0250s/iter; left time: 897.5121s
	iters: 400, epoch: 5 | loss: 0.9947857
	speed: 0.0245s/iter; left time: 876.4342s
	iters: 500, epoch: 5 | loss: 0.9694266
	speed: 0.0243s/iter; left time: 866.5186s
	iters: 600, epoch: 5 | loss: 1.0221413
	speed: 0.0243s/iter; left time: 865.2590s
	iters: 700, epoch: 5 | loss: 0.3852154
	speed: 0.0244s/iter; left time: 865.5048s
	iters: 800, epoch: 5 | loss: 0.3655553
	speed: 0.0248s/iter; left time: 878.1283s
	iters: 900, epoch: 5 | loss: 0.4353119
	speed: 0.0247s/iter; left time: 871.2145s
	iters: 1000, epoch: 5 | loss: 0.9337576
	speed: 0.0251s/iter; left time: 883.6693s
	iters: 1100, epoch: 5 | loss: 0.3879473
	speed: 0.0248s/iter; left time: 870.1209s
	iters: 1200, epoch: 5 | loss: 0.3496430
	speed: 0.0243s/iter; left time: 850.5323s
	iters: 1300, epoch: 5 | loss: 0.4429820
	speed: 0.0247s/iter; left time: 862.5866s
	iters: 1400, epoch: 5 | loss: 0.3917890
	speed: 0.0249s/iter; left time: 866.5701s
	iters: 1500, epoch: 5 | loss: 0.9722865
	speed: 0.0251s/iter; left time: 870.8886s
	iters: 1600, epoch: 5 | loss: 0.5188754
	speed: 0.0245s/iter; left time: 846.8010s
	iters: 1700, epoch: 5 | loss: 0.3128260
	speed: 0.0250s/iter; left time: 864.3471s
	iters: 1800, epoch: 5 | loss: 0.6105201
	speed: 0.0250s/iter; left time: 860.0044s
	iters: 1900, epoch: 5 | loss: 0.3976503
	speed: 0.0246s/iter; left time: 844.6794s
	iters: 2000, epoch: 5 | loss: 0.5238502
	speed: 0.0252s/iter; left time: 860.6466s
	iters: 2100, epoch: 5 | loss: 0.3712378
	speed: 0.0246s/iter; left time: 839.1422s
	iters: 2200, epoch: 5 | loss: 0.4462333
	speed: 0.0243s/iter; left time: 825.8786s
Epoch: 5 cost time: 55.51587152481079
Epoch: 5, Steps: 2263 | Train Loss: 0.5443237 Vali Loss: 0.5067087 Test Loss: 0.2545547
Validation loss decreased (0.537157 --> 0.506709).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.9842719
	speed: 0.0780s/iter; left time: 2639.8151s
	iters: 200, epoch: 6 | loss: 0.6802880
	speed: 0.0241s/iter; left time: 814.9453s
	iters: 300, epoch: 6 | loss: 0.4075595
	speed: 0.0250s/iter; left time: 841.5760s
	iters: 400, epoch: 6 | loss: 0.4714702
	speed: 0.0244s/iter; left time: 817.9127s
	iters: 500, epoch: 6 | loss: 0.3940488
	speed: 0.0245s/iter; left time: 819.1494s
	iters: 600, epoch: 6 | loss: 0.3724115
	speed: 0.0247s/iter; left time: 823.3441s
	iters: 700, epoch: 6 | loss: 0.4888060
	speed: 0.0248s/iter; left time: 824.8023s
	iters: 800, epoch: 6 | loss: 0.5092670
	speed: 0.0244s/iter; left time: 809.8795s
	iters: 900, epoch: 6 | loss: 0.3543903
	speed: 0.0249s/iter; left time: 824.0842s
	iters: 1000, epoch: 6 | loss: 0.4435251
	speed: 0.0250s/iter; left time: 824.8180s
	iters: 1100, epoch: 6 | loss: 0.5575508
	speed: 0.0246s/iter; left time: 808.7526s
	iters: 1200, epoch: 6 | loss: 0.4266492
	speed: 0.0244s/iter; left time: 799.4624s
	iters: 1300, epoch: 6 | loss: 0.3950805
	speed: 0.0246s/iter; left time: 803.8496s
	iters: 1400, epoch: 6 | loss: 1.0240400
	speed: 0.0248s/iter; left time: 805.5227s
	iters: 1500, epoch: 6 | loss: 0.4091654
	speed: 0.0246s/iter; left time: 798.7743s
	iters: 1600, epoch: 6 | loss: 0.4494208
	speed: 0.0248s/iter; left time: 801.2834s
	iters: 1700, epoch: 6 | loss: 0.3720483
	speed: 0.0244s/iter; left time: 788.1563s
	iters: 1800, epoch: 6 | loss: 0.5143725
	speed: 0.0245s/iter; left time: 787.5772s
	iters: 1900, epoch: 6 | loss: 0.4727062
	speed: 0.0247s/iter; left time: 790.4967s
	iters: 2000, epoch: 6 | loss: 0.3753644
	speed: 0.0245s/iter; left time: 781.9505s
	iters: 2100, epoch: 6 | loss: 0.4015372
	speed: 0.0243s/iter; left time: 773.5835s
	iters: 2200, epoch: 6 | loss: 0.4210590
	speed: 0.0248s/iter; left time: 788.7204s
Epoch: 6 cost time: 55.35038733482361
Epoch: 6, Steps: 2263 | Train Loss: 0.5298750 Vali Loss: 0.5001490 Test Loss: 0.2441376
Validation loss decreased (0.506709 --> 0.500149).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.4258369
	speed: 0.0784s/iter; left time: 2477.5489s
	iters: 200, epoch: 7 | loss: 0.3746132
	speed: 0.0249s/iter; left time: 783.7797s
	iters: 300, epoch: 7 | loss: 0.4131049
	speed: 0.0242s/iter; left time: 760.7305s
	iters: 400, epoch: 7 | loss: 0.4219023
	speed: 0.0246s/iter; left time: 770.6189s
	iters: 500, epoch: 7 | loss: 0.3597509
	speed: 0.0249s/iter; left time: 775.5581s
	iters: 600, epoch: 7 | loss: 0.5783143
	speed: 0.0249s/iter; left time: 773.9050s
	iters: 700, epoch: 7 | loss: 0.9244958
	speed: 0.0243s/iter; left time: 753.7032s
	iters: 800, epoch: 7 | loss: 0.4747611
	speed: 0.0244s/iter; left time: 754.7191s
	iters: 900, epoch: 7 | loss: 0.3308375
	speed: 0.0243s/iter; left time: 748.9391s
	iters: 1000, epoch: 7 | loss: 0.4686843
	speed: 0.0246s/iter; left time: 754.5923s
	iters: 1100, epoch: 7 | loss: 1.0135654
	speed: 0.0249s/iter; left time: 760.1482s
	iters: 1200, epoch: 7 | loss: 0.4679659
	speed: 0.0243s/iter; left time: 740.6270s
	iters: 1300, epoch: 7 | loss: 0.4470804
	speed: 0.0250s/iter; left time: 759.7573s
	iters: 1400, epoch: 7 | loss: 0.3985499
	speed: 0.0241s/iter; left time: 730.1933s
	iters: 1500, epoch: 7 | loss: 0.6238549
	speed: 0.0244s/iter; left time: 736.0545s
	iters: 1600, epoch: 7 | loss: 0.3419396
	speed: 0.0242s/iter; left time: 729.3196s
	iters: 1700, epoch: 7 | loss: 0.5086027
	speed: 0.0240s/iter; left time: 718.5583s
	iters: 1800, epoch: 7 | loss: 0.3365173
	speed: 0.0244s/iter; left time: 728.8986s
	iters: 1900, epoch: 7 | loss: 0.2962765
	speed: 0.0244s/iter; left time: 726.1132s
	iters: 2000, epoch: 7 | loss: 1.0125997
	speed: 0.0244s/iter; left time: 724.7231s
	iters: 2100, epoch: 7 | loss: 0.3920627
	speed: 0.0239s/iter; left time: 707.0002s
	iters: 2200, epoch: 7 | loss: 0.5220657
	speed: 0.0237s/iter; left time: 698.2104s
Epoch: 7 cost time: 54.83200716972351
Epoch: 7, Steps: 2263 | Train Loss: 0.5230755 Vali Loss: 0.4945688 Test Loss: 0.2466170
Validation loss decreased (0.500149 --> 0.494569).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.4750755
	speed: 0.0797s/iter; left time: 2337.1791s
	iters: 200, epoch: 8 | loss: 0.5613523
	speed: 0.0243s/iter; left time: 709.4068s
	iters: 300, epoch: 8 | loss: 0.3518381
	speed: 0.0244s/iter; left time: 711.1194s
	iters: 400, epoch: 8 | loss: 0.5455773
	speed: 0.0246s/iter; left time: 714.7767s
	iters: 500, epoch: 8 | loss: 0.4029272
	speed: 0.0251s/iter; left time: 725.3096s
	iters: 600, epoch: 8 | loss: 0.3409879
	speed: 0.0243s/iter; left time: 700.4470s
	iters: 700, epoch: 8 | loss: 0.3582452
	speed: 0.0244s/iter; left time: 701.7427s
	iters: 800, epoch: 8 | loss: 1.4045128
	speed: 0.0248s/iter; left time: 710.9492s
	iters: 900, epoch: 8 | loss: 0.4306612
	speed: 0.0251s/iter; left time: 715.9760s
	iters: 1000, epoch: 8 | loss: 0.7142392
	speed: 0.0256s/iter; left time: 727.9848s
	iters: 1100, epoch: 8 | loss: 0.6089925
	speed: 0.0248s/iter; left time: 703.7192s
	iters: 1200, epoch: 8 | loss: 0.3375833
	speed: 0.0237s/iter; left time: 669.4759s
	iters: 1300, epoch: 8 | loss: 0.4368463
	speed: 0.0239s/iter; left time: 671.4319s
	iters: 1400, epoch: 8 | loss: 0.4019777
	speed: 0.0251s/iter; left time: 704.4483s
	iters: 1500, epoch: 8 | loss: 1.0183352
	speed: 0.0249s/iter; left time: 694.7069s
	iters: 1600, epoch: 8 | loss: 0.3232747
	speed: 0.0247s/iter; left time: 685.8111s
	iters: 1700, epoch: 8 | loss: 0.4870228
	speed: 0.0246s/iter; left time: 682.4136s
	iters: 1800, epoch: 8 | loss: 0.8032798
	speed: 0.0246s/iter; left time: 679.6193s
	iters: 1900, epoch: 8 | loss: 0.2545685
	speed: 0.0247s/iter; left time: 680.3132s
	iters: 2000, epoch: 8 | loss: 0.5608511
	speed: 0.0243s/iter; left time: 666.7590s
	iters: 2100, epoch: 8 | loss: 0.4893832
	speed: 0.0247s/iter; left time: 673.6624s
	iters: 2200, epoch: 8 | loss: 0.4543071
	speed: 0.0227s/iter; left time: 618.4334s
Epoch: 8 cost time: 55.186816453933716
Epoch: 8, Steps: 2263 | Train Loss: 0.5195995 Vali Loss: 0.4961414 Test Loss: 0.2407046
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.4179828
	speed: 0.0786s/iter; left time: 2125.8377s
	iters: 200, epoch: 9 | loss: 0.4555869
	speed: 0.0256s/iter; left time: 690.9418s
	iters: 300, epoch: 9 | loss: 0.4176872
	speed: 0.0261s/iter; left time: 701.9688s
	iters: 400, epoch: 9 | loss: 0.3172695
	speed: 0.0253s/iter; left time: 678.0736s
	iters: 500, epoch: 9 | loss: 0.5183511
	speed: 0.0250s/iter; left time: 666.5037s
	iters: 600, epoch: 9 | loss: 0.3429439
	speed: 0.0250s/iter; left time: 662.8435s
	iters: 700, epoch: 9 | loss: 0.7581357
	speed: 0.0259s/iter; left time: 684.9386s
	iters: 800, epoch: 9 | loss: 0.5124139
	speed: 0.0253s/iter; left time: 666.7649s
	iters: 900, epoch: 9 | loss: 0.3633159
	speed: 0.0252s/iter; left time: 660.7901s
	iters: 1000, epoch: 9 | loss: 0.3733265
	speed: 0.0240s/iter; left time: 627.0565s
	iters: 1100, epoch: 9 | loss: 1.4617848
	speed: 0.0222s/iter; left time: 579.7250s
	iters: 1200, epoch: 9 | loss: 0.3763672
	speed: 0.0227s/iter; left time: 589.5818s
	iters: 1300, epoch: 9 | loss: 0.4154095
	speed: 0.0237s/iter; left time: 614.0926s
	iters: 1400, epoch: 9 | loss: 0.3458892
	speed: 0.0232s/iter; left time: 596.5641s
	iters: 1500, epoch: 9 | loss: 0.5073880
	speed: 0.0231s/iter; left time: 592.5255s
	iters: 1600, epoch: 9 | loss: 0.6821757
	speed: 0.0227s/iter; left time: 580.8483s
	iters: 1700, epoch: 9 | loss: 0.9250527
	speed: 0.0238s/iter; left time: 605.2267s
	iters: 1800, epoch: 9 | loss: 0.7142669
	speed: 0.0221s/iter; left time: 560.8583s
	iters: 1900, epoch: 9 | loss: 0.3416529
	speed: 0.0220s/iter; left time: 555.4702s
	iters: 2000, epoch: 9 | loss: 0.4002576
	speed: 0.0238s/iter; left time: 597.7821s
	iters: 2100, epoch: 9 | loss: 0.3971276
	speed: 0.0217s/iter; left time: 543.5692s
	iters: 2200, epoch: 9 | loss: 0.3315279
	speed: 0.0213s/iter; left time: 530.6623s
Epoch: 9 cost time: 53.40779137611389
Epoch: 9, Steps: 2263 | Train Loss: 0.5178190 Vali Loss: 0.4926122 Test Loss: 0.2422281
Validation loss decreased (0.494569 --> 0.492612).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.5899322
	speed: 0.0735s/iter; left time: 1823.2164s
	iters: 200, epoch: 10 | loss: 0.3988651
	speed: 0.0244s/iter; left time: 602.1020s
	iters: 300, epoch: 10 | loss: 0.3449331
	speed: 0.0244s/iter; left time: 598.8691s
	iters: 400, epoch: 10 | loss: 0.8715003
	speed: 0.0237s/iter; left time: 581.0266s
	iters: 500, epoch: 10 | loss: 0.3636363
	speed: 0.0219s/iter; left time: 533.6858s
	iters: 600, epoch: 10 | loss: 0.4021288
	speed: 0.0216s/iter; left time: 525.5163s
	iters: 700, epoch: 10 | loss: 0.3162059
	speed: 0.0233s/iter; left time: 562.8847s
	iters: 800, epoch: 10 | loss: 0.3623701
	speed: 0.0244s/iter; left time: 588.1132s
	iters: 900, epoch: 10 | loss: 0.5346219
	speed: 0.0247s/iter; left time: 593.1463s
	iters: 1000, epoch: 10 | loss: 0.4118504
	speed: 0.0217s/iter; left time: 518.2780s
	iters: 1100, epoch: 10 | loss: 0.4934730
	speed: 0.0237s/iter; left time: 564.3025s
	iters: 1200, epoch: 10 | loss: 0.3966805
	speed: 0.0245s/iter; left time: 580.5053s
	iters: 1300, epoch: 10 | loss: 0.3407260
	speed: 0.0227s/iter; left time: 534.7142s
	iters: 1400, epoch: 10 | loss: 0.3627354
	speed: 0.0233s/iter; left time: 547.5991s
	iters: 1500, epoch: 10 | loss: 0.4529180
	speed: 0.0216s/iter; left time: 505.4008s
	iters: 1600, epoch: 10 | loss: 0.4304756
	speed: 0.0227s/iter; left time: 528.2915s
	iters: 1700, epoch: 10 | loss: 0.4757715
	speed: 0.0239s/iter; left time: 555.4803s
	iters: 1800, epoch: 10 | loss: 0.9850067
	speed: 0.0240s/iter; left time: 555.3534s
	iters: 1900, epoch: 10 | loss: 0.6444911
	speed: 0.0233s/iter; left time: 536.7388s
	iters: 2000, epoch: 10 | loss: 0.3340411
	speed: 0.0227s/iter; left time: 520.3086s
	iters: 2100, epoch: 10 | loss: 0.3064010
	speed: 0.0231s/iter; left time: 526.2320s
	iters: 2200, epoch: 10 | loss: 0.4119892
	speed: 0.0214s/iter; left time: 486.2958s
Epoch: 10 cost time: 51.995583057403564
Epoch: 10, Steps: 2263 | Train Loss: 0.5169751 Vali Loss: 0.4938808 Test Loss: 0.2420729
EarlyStopping counter: 1 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.3317881
	speed: 0.0786s/iter; left time: 1771.7147s
	iters: 200, epoch: 11 | loss: 0.4838212
	speed: 0.0214s/iter; left time: 479.5371s
	iters: 300, epoch: 11 | loss: 0.3099792
	speed: 0.0228s/iter; left time: 509.4755s
	iters: 400, epoch: 11 | loss: 0.5135478
	speed: 0.0230s/iter; left time: 510.3333s
	iters: 500, epoch: 11 | loss: 0.5609183
	speed: 0.0241s/iter; left time: 533.7978s
	iters: 600, epoch: 11 | loss: 0.3444930
	speed: 0.0239s/iter; left time: 525.8358s
	iters: 700, epoch: 11 | loss: 0.3410569
	speed: 0.0244s/iter; left time: 534.6950s
	iters: 800, epoch: 11 | loss: 0.3678588
	speed: 0.0225s/iter; left time: 490.7920s
	iters: 900, epoch: 11 | loss: 0.3530753
	speed: 0.0211s/iter; left time: 458.7633s
	iters: 1000, epoch: 11 | loss: 0.4425172
	speed: 0.0207s/iter; left time: 448.7070s
	iters: 1100, epoch: 11 | loss: 0.4984838
	speed: 0.0223s/iter; left time: 480.7145s
	iters: 1200, epoch: 11 | loss: 0.3612060
	speed: 0.0209s/iter; left time: 447.8778s
	iters: 1300, epoch: 11 | loss: 0.9459740
	speed: 0.0223s/iter; left time: 476.4941s
	iters: 1400, epoch: 11 | loss: 0.3882736
	speed: 0.0222s/iter; left time: 472.2734s
	iters: 1500, epoch: 11 | loss: 0.3604184
	speed: 0.0229s/iter; left time: 484.4949s
	iters: 1600, epoch: 11 | loss: 0.2936638
	speed: 0.0256s/iter; left time: 537.4098s
	iters: 1700, epoch: 11 | loss: 0.3342857
	speed: 0.0224s/iter; left time: 468.2173s
	iters: 1800, epoch: 11 | loss: 0.4465527
	speed: 0.0212s/iter; left time: 440.6776s
	iters: 1900, epoch: 11 | loss: 0.4184933
	speed: 0.0238s/iter; left time: 493.8367s
	iters: 2000, epoch: 11 | loss: 0.4382627
	speed: 0.0244s/iter; left time: 503.4162s
	iters: 2100, epoch: 11 | loss: 0.3155771
	speed: 0.0206s/iter; left time: 423.3651s
	iters: 2200, epoch: 11 | loss: 0.3672240
	speed: 0.0211s/iter; left time: 430.2504s
Epoch: 11 cost time: 50.81835460662842
Epoch: 11, Steps: 2263 | Train Loss: 0.5164543 Vali Loss: 0.4938590 Test Loss: 0.2413783
EarlyStopping counter: 2 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 1.9178931
	speed: 0.0698s/iter; left time: 1414.7551s
	iters: 200, epoch: 12 | loss: 0.4869791
	speed: 0.0193s/iter; left time: 388.3367s
	iters: 300, epoch: 12 | loss: 0.3926863
	speed: 0.0216s/iter; left time: 433.0722s
	iters: 400, epoch: 12 | loss: 0.4131814
	speed: 0.0229s/iter; left time: 456.6440s
	iters: 500, epoch: 12 | loss: 0.4341235
	speed: 0.0223s/iter; left time: 442.2592s
	iters: 600, epoch: 12 | loss: 0.2833695
	speed: 0.0228s/iter; left time: 451.0500s
	iters: 700, epoch: 12 | loss: 0.4071162
	speed: 0.0234s/iter; left time: 460.4986s
	iters: 800, epoch: 12 | loss: 0.4009880
	speed: 0.0223s/iter; left time: 435.8131s
	iters: 900, epoch: 12 | loss: 0.3721837
	speed: 0.0226s/iter; left time: 439.5320s
	iters: 1000, epoch: 12 | loss: 0.9889366
	speed: 0.0224s/iter; left time: 434.6498s
	iters: 1100, epoch: 12 | loss: 0.6824097
	speed: 0.0221s/iter; left time: 425.1724s
	iters: 1200, epoch: 12 | loss: 0.2701117
	speed: 0.0217s/iter; left time: 415.7993s
	iters: 1300, epoch: 12 | loss: 0.9121984
	speed: 0.0213s/iter; left time: 405.8483s
	iters: 1400, epoch: 12 | loss: 0.3506771
	speed: 0.0210s/iter; left time: 398.2673s
	iters: 1500, epoch: 12 | loss: 1.0181973
	speed: 0.0209s/iter; left time: 395.0860s
	iters: 1600, epoch: 12 | loss: 0.3990695
	speed: 0.0225s/iter; left time: 422.8797s
	iters: 1700, epoch: 12 | loss: 0.4337061
	speed: 0.0205s/iter; left time: 383.1055s
	iters: 1800, epoch: 12 | loss: 0.5798613
	speed: 0.0196s/iter; left time: 363.6356s
	iters: 1900, epoch: 12 | loss: 0.5745647
	speed: 0.0201s/iter; left time: 372.0537s
	iters: 2000, epoch: 12 | loss: 0.3112920
	speed: 0.0220s/iter; left time: 404.2474s
	iters: 2100, epoch: 12 | loss: 0.4366517
	speed: 0.0211s/iter; left time: 384.7335s
	iters: 2200, epoch: 12 | loss: 0.3981112
	speed: 0.0179s/iter; left time: 325.6766s
Epoch: 12 cost time: 48.192171573638916
Epoch: 12, Steps: 2263 | Train Loss: 0.5162501 Vali Loss: 0.4951934 Test Loss: 0.2411703
EarlyStopping counter: 3 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.5255185
	speed: 0.0628s/iter; left time: 1130.1653s
	iters: 200, epoch: 13 | loss: 0.3747526
	speed: 0.0185s/iter; left time: 330.4371s
	iters: 300, epoch: 13 | loss: 0.3261724
	speed: 0.0189s/iter; left time: 337.2906s
	iters: 400, epoch: 13 | loss: 0.5058123
	speed: 0.0185s/iter; left time: 326.7221s
	iters: 500, epoch: 13 | loss: 0.9224566
	speed: 0.0216s/iter; left time: 380.8794s
	iters: 600, epoch: 13 | loss: 0.3340487
	speed: 0.0189s/iter; left time: 331.3074s
	iters: 700, epoch: 13 | loss: 0.3881141
	speed: 0.0197s/iter; left time: 343.4686s
	iters: 800, epoch: 13 | loss: 0.5731705
	speed: 0.0188s/iter; left time: 326.1284s
	iters: 900, epoch: 13 | loss: 0.3764646
	speed: 0.0180s/iter; left time: 310.3071s
	iters: 1000, epoch: 13 | loss: 0.5718623
	speed: 0.0197s/iter; left time: 337.4274s
	iters: 1100, epoch: 13 | loss: 0.3620598
	speed: 0.0199s/iter; left time: 338.2983s
	iters: 1200, epoch: 13 | loss: 0.3623579
	speed: 0.0210s/iter; left time: 354.7679s
	iters: 1300, epoch: 13 | loss: 0.9278195
	speed: 0.0194s/iter; left time: 325.1937s
	iters: 1400, epoch: 13 | loss: 0.4650357
	speed: 0.0195s/iter; left time: 325.4999s
	iters: 1500, epoch: 13 | loss: 0.4017053
	speed: 0.0197s/iter; left time: 327.0486s
	iters: 1600, epoch: 13 | loss: 0.9374931
	speed: 0.0200s/iter; left time: 330.9232s
	iters: 1700, epoch: 13 | loss: 0.5601875
	speed: 0.0200s/iter; left time: 328.7696s
	iters: 1800, epoch: 13 | loss: 0.2749169
	speed: 0.0208s/iter; left time: 338.5713s
	iters: 1900, epoch: 13 | loss: 0.3738146
	speed: 0.0203s/iter; left time: 329.5350s
	iters: 2000, epoch: 13 | loss: 0.4099654
	speed: 0.0207s/iter; left time: 332.8580s
	iters: 2100, epoch: 13 | loss: 0.4443320
	speed: 0.0205s/iter; left time: 327.8434s
	iters: 2200, epoch: 13 | loss: 0.3051799
	speed: 0.0209s/iter; left time: 332.7015s
Epoch: 13 cost time: 44.635793685913086
Epoch: 13, Steps: 2263 | Train Loss: 0.5161144 Vali Loss: 0.4936329 Test Loss: 0.2408911
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.4110151
	speed: 0.0720s/iter; left time: 1132.9335s
	iters: 200, epoch: 14 | loss: 0.4601039
	speed: 0.0183s/iter; left time: 286.3925s
	iters: 300, epoch: 14 | loss: 0.2968742
	speed: 0.0196s/iter; left time: 305.3057s
	iters: 400, epoch: 14 | loss: 0.8687899
	speed: 0.0189s/iter; left time: 291.5911s
	iters: 500, epoch: 14 | loss: 0.2964538
	speed: 0.0198s/iter; left time: 303.2447s
	iters: 600, epoch: 14 | loss: 0.4411077
	speed: 0.0198s/iter; left time: 301.1343s
	iters: 700, epoch: 14 | loss: 0.5858703
	speed: 0.0190s/iter; left time: 288.2419s
	iters: 800, epoch: 14 | loss: 0.4957588
	speed: 0.0190s/iter; left time: 286.4757s
	iters: 900, epoch: 14 | loss: 1.4776816
	speed: 0.0191s/iter; left time: 285.9152s
	iters: 1000, epoch: 14 | loss: 0.4865287
	speed: 0.0192s/iter; left time: 285.1797s
	iters: 1100, epoch: 14 | loss: 0.3477074
	speed: 0.0190s/iter; left time: 279.4337s
	iters: 1200, epoch: 14 | loss: 0.7795634
	speed: 0.0189s/iter; left time: 276.2084s
	iters: 1300, epoch: 14 | loss: 0.3416680
	speed: 0.0188s/iter; left time: 273.6093s
	iters: 1400, epoch: 14 | loss: 0.5310191
	speed: 0.0192s/iter; left time: 277.3057s
	iters: 1500, epoch: 14 | loss: 0.3659136
	speed: 0.0192s/iter; left time: 274.8747s
	iters: 1600, epoch: 14 | loss: 0.3888180
	speed: 0.0191s/iter; left time: 272.6570s
	iters: 1700, epoch: 14 | loss: 0.3959927
	speed: 0.0201s/iter; left time: 284.7242s
	iters: 1800, epoch: 14 | loss: 0.8798415
	speed: 0.0197s/iter; left time: 277.1097s
	iters: 1900, epoch: 14 | loss: 0.7654594
	speed: 0.0191s/iter; left time: 266.7067s
	iters: 2000, epoch: 14 | loss: 0.8277204
	speed: 0.0168s/iter; left time: 232.7790s
	iters: 2100, epoch: 14 | loss: 0.4115581
	speed: 0.0177s/iter; left time: 243.3171s
	iters: 2200, epoch: 14 | loss: 0.4371579
	speed: 0.0186s/iter; left time: 253.6448s
Epoch: 14 cost time: 42.69546175003052
Epoch: 14, Steps: 2263 | Train Loss: 0.5160028 Vali Loss: 0.4939292 Test Loss: 0.2410923
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : weather_336_336_Linear_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15726<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10204
mse:0.24229586124420166, mae:0.30213800072669983
