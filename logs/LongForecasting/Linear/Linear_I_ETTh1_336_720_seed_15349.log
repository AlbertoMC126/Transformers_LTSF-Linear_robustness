Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTh1', data_path='ETTh1.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='Linear', model_id='ETTh1_336_720', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=720, root_path='./dataset/', save_pred_values=False, seed=15349, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTh1_336_720_Linear_ETTh1_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15349>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7585
val 2161
test 2161
	iters: 100, epoch: 1 | loss: 0.6166843
	speed: 0.0168s/iter; left time: 77.9997s
	iters: 200, epoch: 1 | loss: 0.6098210
	speed: 0.0187s/iter; left time: 85.0438s
Epoch: 1 cost time: 4.286134243011475
Epoch: 1, Steps: 237 | Train Loss: 0.5979359 Vali Loss: 1.4371928 Test Loss: 0.5521519
Validation loss decreased (inf --> 1.437193).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.5628927
	speed: 0.0324s/iter; left time: 142.8088s
	iters: 200, epoch: 2 | loss: 0.5993461
	speed: 0.0198s/iter; left time: 85.3131s
Epoch: 2 cost time: 4.346718788146973
Epoch: 2, Steps: 237 | Train Loss: 0.5670174 Vali Loss: 1.4317966 Test Loss: 0.5823199
Validation loss decreased (1.437193 --> 1.431797).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.4976031
	speed: 0.0337s/iter; left time: 140.5542s
	iters: 200, epoch: 3 | loss: 0.4919936
	speed: 0.0197s/iter; left time: 80.1836s
Epoch: 3 cost time: 4.4582836627960205
Epoch: 3, Steps: 237 | Train Loss: 0.5228231 Vali Loss: 1.3186065 Test Loss: 0.5165953
Validation loss decreased (1.431797 --> 1.318606).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.4978882
	speed: 0.0324s/iter; left time: 127.2819s
	iters: 200, epoch: 4 | loss: 0.4827348
	speed: 0.0200s/iter; left time: 76.6112s
Epoch: 4 cost time: 4.438976049423218
Epoch: 4, Steps: 237 | Train Loss: 0.5001934 Vali Loss: 1.2974160 Test Loss: 0.5057664
Validation loss decreased (1.318606 --> 1.297416).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.4608090
	speed: 0.0317s/iter; left time: 117.0423s
	iters: 200, epoch: 5 | loss: 0.4525800
	speed: 0.0191s/iter; left time: 68.5174s
Epoch: 5 cost time: 4.242971181869507
Epoch: 5, Steps: 237 | Train Loss: 0.4892888 Vali Loss: 1.2679416 Test Loss: 0.4866380
Validation loss decreased (1.297416 --> 1.267942).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.4588765
	speed: 0.0300s/iter; left time: 103.6971s
	iters: 200, epoch: 6 | loss: 0.4963283
	speed: 0.0183s/iter; left time: 61.4313s
Epoch: 6 cost time: 4.137613534927368
Epoch: 6, Steps: 237 | Train Loss: 0.4839538 Vali Loss: 1.2532482 Test Loss: 0.4862513
Validation loss decreased (1.267942 --> 1.253248).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.5049463
	speed: 0.0316s/iter; left time: 101.7505s
	iters: 200, epoch: 7 | loss: 0.4810016
	speed: 0.0183s/iter; left time: 57.2253s
Epoch: 7 cost time: 4.131465435028076
Epoch: 7, Steps: 237 | Train Loss: 0.4810124 Vali Loss: 1.2510142 Test Loss: 0.4858374
Validation loss decreased (1.253248 --> 1.251014).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.4865762
	speed: 0.0307s/iter; left time: 91.4891s
	iters: 200, epoch: 8 | loss: 0.4698221
	speed: 0.0170s/iter; left time: 49.1314s
Epoch: 8 cost time: 4.101361274719238
Epoch: 8, Steps: 237 | Train Loss: 0.4791351 Vali Loss: 1.2498703 Test Loss: 0.4890309
Validation loss decreased (1.251014 --> 1.249870).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.4931826
	speed: 0.0316s/iter; left time: 86.7664s
	iters: 200, epoch: 9 | loss: 0.4787571
	speed: 0.0177s/iter; left time: 46.7175s
Epoch: 9 cost time: 4.131626129150391
Epoch: 9, Steps: 237 | Train Loss: 0.4782053 Vali Loss: 1.2488003 Test Loss: 0.4853565
Validation loss decreased (1.249870 --> 1.248800).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.4287113
	speed: 0.0317s/iter; left time: 79.4588s
	iters: 200, epoch: 10 | loss: 0.5826285
	speed: 0.0202s/iter; left time: 48.5526s
Epoch: 10 cost time: 4.262338161468506
Epoch: 10, Steps: 237 | Train Loss: 0.4777705 Vali Loss: 1.2435876 Test Loss: 0.4878488
Validation loss decreased (1.248800 --> 1.243588).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.4971092
	speed: 0.0344s/iter; left time: 78.1194s
	iters: 200, epoch: 11 | loss: 0.4269041
	speed: 0.0178s/iter; left time: 38.7373s
Epoch: 11 cost time: 4.262929916381836
Epoch: 11, Steps: 237 | Train Loss: 0.4774154 Vali Loss: 1.2422115 Test Loss: 0.4875956
Validation loss decreased (1.243588 --> 1.242211).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.5020393
	speed: 0.0286s/iter; left time: 58.2156s
	iters: 200, epoch: 12 | loss: 0.5213388
	speed: 0.0171s/iter; left time: 33.0636s
Epoch: 12 cost time: 3.9065537452697754
Epoch: 12, Steps: 237 | Train Loss: 0.4773169 Vali Loss: 1.2433652 Test Loss: 0.4880923
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.4744731
	speed: 0.0270s/iter; left time: 48.5908s
	iters: 200, epoch: 13 | loss: 0.4749410
	speed: 0.0163s/iter; left time: 27.5994s
Epoch: 13 cost time: 3.6857986450195312
Epoch: 13, Steps: 237 | Train Loss: 0.4772012 Vali Loss: 1.2421209 Test Loss: 0.4875844
Validation loss decreased (1.242211 --> 1.242121).  Saving model ...
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.5115060
	speed: 0.0291s/iter; left time: 45.3935s
	iters: 200, epoch: 14 | loss: 0.4921272
	speed: 0.0155s/iter; left time: 22.5889s
Epoch: 14 cost time: 3.6700921058654785
Epoch: 14, Steps: 237 | Train Loss: 0.4771349 Vali Loss: 1.2411126 Test Loss: 0.4875626
Validation loss decreased (1.242121 --> 1.241113).  Saving model ...
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.4272819
	speed: 0.0280s/iter; left time: 37.0032s
	iters: 200, epoch: 15 | loss: 0.4706023
	speed: 0.0160s/iter; left time: 19.5792s
Epoch: 15 cost time: 3.6235275268554688
Epoch: 15, Steps: 237 | Train Loss: 0.4771721 Vali Loss: 1.2429221 Test Loss: 0.4875570
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.4729670
	speed: 0.0260s/iter; left time: 28.1923s
	iters: 200, epoch: 16 | loss: 0.4374965
	speed: 0.0147s/iter; left time: 14.4978s
Epoch: 16 cost time: 3.3906774520874023
Epoch: 16, Steps: 237 | Train Loss: 0.4771453 Vali Loss: 1.2432916 Test Loss: 0.4875323
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 17 | loss: 0.5492122
	speed: 0.0271s/iter; left time: 23.0310s
	iters: 200, epoch: 17 | loss: 0.4874794
	speed: 0.0136s/iter; left time: 10.1857s
Epoch: 17 cost time: 3.270571708679199
Epoch: 17, Steps: 237 | Train Loss: 0.4770822 Vali Loss: 1.2436713 Test Loss: 0.4875183
EarlyStopping counter: 3 out of 5
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 18 | loss: 0.5134066
	speed: 0.0251s/iter; left time: 15.3606s
	iters: 200, epoch: 18 | loss: 0.4504151
	speed: 0.0138s/iter; left time: 7.0911s
Epoch: 18 cost time: 3.2304351329803467
Epoch: 18, Steps: 237 | Train Loss: 0.4771442 Vali Loss: 1.2447749 Test Loss: 0.4875074
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 19 | loss: 0.4990527
	speed: 0.0248s/iter; left time: 9.3144s
	iters: 200, epoch: 19 | loss: 0.4307525
	speed: 0.0107s/iter; left time: 2.9483s
Epoch: 19 cost time: 2.731800079345703
Epoch: 19, Steps: 237 | Train Loss: 0.4771364 Vali Loss: 1.2429166 Test Loss: 0.4875065
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTh1_336_720_Linear_ETTh1_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15349<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
mse:0.48661094903945923, mae:0.48570215702056885
