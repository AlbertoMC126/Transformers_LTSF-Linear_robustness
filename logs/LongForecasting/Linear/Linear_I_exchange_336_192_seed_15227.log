Args in experiment:
Namespace(activation='gelu', batch_size=8, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='exchange_rate.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=8, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='mse', lradj='type1', model='Linear', model_id='Exchange_336_192', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=192, root_path='./dataset/', save_pred_values=False, seed=15227, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : Exchange_336_192_Linear_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15227>>>>>>>>>>>>>>>>>>>>>>>>>>
train 4784
val 569
test 1326
	iters: 100, epoch: 1 | loss: 0.3679454
	speed: 0.0045s/iter; left time: 52.9312s
	iters: 200, epoch: 1 | loss: 0.2069639
	speed: 0.0041s/iter; left time: 48.6907s
	iters: 300, epoch: 1 | loss: 0.1583091
	speed: 0.0039s/iter; left time: 45.0538s
	iters: 400, epoch: 1 | loss: 0.1876873
	speed: 0.0031s/iter; left time: 35.7234s
	iters: 500, epoch: 1 | loss: 0.1661521
	speed: 0.0029s/iter; left time: 32.8929s
Epoch: 1 cost time: 2.212850332260132
Epoch: 1, Steps: 598 | Train Loss: 0.2699406 Vali Loss: 0.4414440 Test Loss: 0.1940546
Validation loss decreased (inf --> 0.441444).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2327687
	speed: 0.0091s/iter; left time: 102.6395s
	iters: 200, epoch: 2 | loss: 0.1930853
	speed: 0.0038s/iter; left time: 42.0088s
	iters: 300, epoch: 2 | loss: 0.1752861
	speed: 0.0038s/iter; left time: 42.3715s
	iters: 400, epoch: 2 | loss: 0.1769658
	speed: 0.0035s/iter; left time: 38.3752s
	iters: 500, epoch: 2 | loss: 0.2961228
	speed: 0.0041s/iter; left time: 44.1291s
Epoch: 2 cost time: 2.2786648273468018
Epoch: 2, Steps: 598 | Train Loss: 0.2341281 Vali Loss: 0.4586733 Test Loss: 0.2189467
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1320435
	speed: 0.0102s/iter; left time: 109.2431s
	iters: 200, epoch: 3 | loss: 0.2114329
	speed: 0.0036s/iter; left time: 37.9284s
	iters: 300, epoch: 3 | loss: 0.4461744
	speed: 0.0035s/iter; left time: 36.3138s
	iters: 400, epoch: 3 | loss: 0.3933782
	speed: 0.0041s/iter; left time: 42.2068s
	iters: 500, epoch: 3 | loss: 0.1652350
	speed: 0.0044s/iter; left time: 44.8640s
Epoch: 3 cost time: 2.3547861576080322
Epoch: 3, Steps: 598 | Train Loss: 0.2221604 Vali Loss: 0.6693088 Test Loss: 0.2453433
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.2024994
	speed: 0.0101s/iter; left time: 102.1004s
	iters: 200, epoch: 4 | loss: 0.1512901
	speed: 0.0035s/iter; left time: 34.6266s
	iters: 300, epoch: 4 | loss: 0.1711998
	speed: 0.0040s/iter; left time: 39.2708s
	iters: 400, epoch: 4 | loss: 0.1892222
	speed: 0.0035s/iter; left time: 34.0867s
	iters: 500, epoch: 4 | loss: 0.2130074
	speed: 0.0040s/iter; left time: 38.9019s
Epoch: 4 cost time: 2.3318324089050293
Epoch: 4, Steps: 598 | Train Loss: 0.2182370 Vali Loss: 0.4721484 Test Loss: 0.1923182
EarlyStopping counter: 3 out of 5
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.2176034
	speed: 0.0102s/iter; left time: 96.3176s
	iters: 200, epoch: 5 | loss: 0.1601267
	speed: 0.0037s/iter; left time: 35.1336s
	iters: 300, epoch: 5 | loss: 0.1047219
	speed: 0.0042s/iter; left time: 38.7653s
	iters: 400, epoch: 5 | loss: 0.1822996
	speed: 0.0037s/iter; left time: 33.5584s
	iters: 500, epoch: 5 | loss: 0.2079439
	speed: 0.0030s/iter; left time: 27.2977s
Epoch: 5 cost time: 2.212897539138794
Epoch: 5, Steps: 598 | Train Loss: 0.2159292 Vali Loss: 0.4341882 Test Loss: 0.1891385
Validation loss decreased (0.441444 --> 0.434188).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.2664108
	speed: 0.0093s/iter; left time: 82.8545s
	iters: 200, epoch: 6 | loss: 0.1866083
	speed: 0.0043s/iter; left time: 37.5611s
	iters: 300, epoch: 6 | loss: 0.1801011
	speed: 0.0039s/iter; left time: 34.0619s
	iters: 400, epoch: 6 | loss: 0.1112539
	speed: 0.0037s/iter; left time: 31.7983s
	iters: 500, epoch: 6 | loss: 0.1943237
	speed: 0.0045s/iter; left time: 37.7978s
Epoch: 6 cost time: 2.492830991744995
Epoch: 6, Steps: 598 | Train Loss: 0.2148869 Vali Loss: 0.4582130 Test Loss: 0.1857399
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.2149016
	speed: 0.0108s/iter; left time: 88.9657s
	iters: 200, epoch: 7 | loss: 0.1352734
	speed: 0.0041s/iter; left time: 33.6729s
	iters: 300, epoch: 7 | loss: 0.1961290
	speed: 0.0044s/iter; left time: 35.8668s
	iters: 400, epoch: 7 | loss: 0.1666291
	speed: 0.0043s/iter; left time: 34.3637s
	iters: 500, epoch: 7 | loss: 0.1802522
	speed: 0.0045s/iter; left time: 35.6025s
Epoch: 7 cost time: 2.6246325969696045
Epoch: 7, Steps: 598 | Train Loss: 0.2142762 Vali Loss: 0.4458999 Test Loss: 0.1825389
EarlyStopping counter: 2 out of 5
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.3532575
	speed: 0.0111s/iter; left time: 84.8244s
	iters: 200, epoch: 8 | loss: 0.4782499
	speed: 0.0040s/iter; left time: 30.6787s
	iters: 300, epoch: 8 | loss: 0.1546007
	speed: 0.0038s/iter; left time: 28.5723s
	iters: 400, epoch: 8 | loss: 0.1857578
	speed: 0.0039s/iter; left time: 29.0844s
	iters: 500, epoch: 8 | loss: 0.2504402
	speed: 0.0039s/iter; left time: 28.1542s
Epoch: 8 cost time: 2.3652870655059814
Epoch: 8, Steps: 598 | Train Loss: 0.2141206 Vali Loss: 0.4628541 Test Loss: 0.1840619
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.1438751
	speed: 0.0089s/iter; left time: 62.8651s
	iters: 200, epoch: 9 | loss: 0.1653642
	speed: 0.0036s/iter; left time: 24.9259s
	iters: 300, epoch: 9 | loss: 0.1954408
	speed: 0.0036s/iter; left time: 25.0323s
	iters: 400, epoch: 9 | loss: 0.1814930
	speed: 0.0037s/iter; left time: 25.2813s
	iters: 500, epoch: 9 | loss: 0.1465692
	speed: 0.0037s/iter; left time: 24.5861s
Epoch: 9 cost time: 2.17452335357666
Epoch: 9, Steps: 598 | Train Loss: 0.2137890 Vali Loss: 0.4827398 Test Loss: 0.1899643
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.1643973
	speed: 0.0089s/iter; left time: 57.7962s
	iters: 200, epoch: 10 | loss: 0.1616905
	speed: 0.0034s/iter; left time: 21.8162s
	iters: 300, epoch: 10 | loss: 0.1508288
	speed: 0.0036s/iter; left time: 22.4161s
	iters: 400, epoch: 10 | loss: 0.1325427
	speed: 0.0036s/iter; left time: 22.1304s
	iters: 500, epoch: 10 | loss: 0.1908391
	speed: 0.0037s/iter; left time: 22.4343s
Epoch: 10 cost time: 2.1412572860717773
Epoch: 10, Steps: 598 | Train Loss: 0.2138527 Vali Loss: 0.4672155 Test Loss: 0.1846991
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : Exchange_336_192_Linear_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15227<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 1326
mse:0.18905271589756012, mae:0.32881537079811096
