Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='DLinear', model_id='traffic_336_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=3144, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_336_96_DLinear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3144>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11849
val 1661
test 3413
	iters: 100, epoch: 1 | loss: 0.5208793
	speed: 0.4341s/iter; left time: 6382.1288s
	iters: 200, epoch: 1 | loss: 0.5494640
	speed: 0.4227s/iter; left time: 6171.2211s
	iters: 300, epoch: 1 | loss: 0.6051391
	speed: 0.4152s/iter; left time: 6020.1560s
	iters: 400, epoch: 1 | loss: 0.5434859
	speed: 0.4297s/iter; left time: 6187.7913s
	iters: 500, epoch: 1 | loss: 0.5675463
	speed: 0.4373s/iter; left time: 6254.2763s
	iters: 600, epoch: 1 | loss: 0.5934224
	speed: 0.4173s/iter; left time: 5926.5859s
	iters: 700, epoch: 1 | loss: 0.5617800
	speed: 0.4221s/iter; left time: 5951.4534s
Epoch: 1 cost time: 314.98612880706787
Epoch: 1, Steps: 740 | Train Loss: 0.5825944 Vali Loss: 0.7955359 Test Loss: 0.9147088
Validation loss decreased (inf --> 0.795536).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.5382917
	speed: 0.9229s/iter; left time: 12884.7003s
	iters: 200, epoch: 2 | loss: 0.5813385
	speed: 0.4186s/iter; left time: 5802.8566s
	iters: 300, epoch: 2 | loss: 0.5386649
	speed: 0.4216s/iter; left time: 5802.1605s
	iters: 400, epoch: 2 | loss: 0.6120411
	speed: 0.4182s/iter; left time: 5713.2570s
	iters: 500, epoch: 2 | loss: 0.5671685
	speed: 0.4229s/iter; left time: 5735.2715s
	iters: 600, epoch: 2 | loss: 0.5424596
	speed: 0.4274s/iter; left time: 5752.8793s
	iters: 700, epoch: 2 | loss: 0.6016973
	speed: 0.4118s/iter; left time: 5502.2763s
Epoch: 2 cost time: 311.1405646800995
Epoch: 2, Steps: 740 | Train Loss: 0.5720454 Vali Loss: 0.8345497 Test Loss: 0.9549525
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.3402311
	speed: 0.8524s/iter; left time: 11269.2118s
	iters: 200, epoch: 3 | loss: 0.3612646
	speed: 0.4210s/iter; left time: 5524.0369s
	iters: 300, epoch: 3 | loss: 0.3713738
	speed: 0.4253s/iter; left time: 5537.4348s
	iters: 400, epoch: 3 | loss: 0.3546127
	speed: 0.4316s/iter; left time: 5576.0802s
	iters: 500, epoch: 3 | loss: 0.3370565
	speed: 0.4204s/iter; left time: 5390.4813s
	iters: 600, epoch: 3 | loss: 0.3485475
	speed: 0.4174s/iter; left time: 5309.5649s
	iters: 700, epoch: 3 | loss: 0.3743963
	speed: 0.4167s/iter; left time: 5259.5802s
Epoch: 3 cost time: 311.5768873691559
Epoch: 3, Steps: 740 | Train Loss: 0.3523152 Vali Loss: 0.4982097 Test Loss: 0.5986798
Validation loss decreased (0.795536 --> 0.498210).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.2787171
	speed: 0.9072s/iter; left time: 11322.4184s
	iters: 200, epoch: 4 | loss: 0.2848461
	speed: 0.4235s/iter; left time: 5243.8246s
	iters: 300, epoch: 4 | loss: 0.3159524
	speed: 0.4163s/iter; left time: 5112.6983s
	iters: 400, epoch: 4 | loss: 0.2781725
	speed: 0.4092s/iter; left time: 4984.0910s
	iters: 500, epoch: 4 | loss: 0.2910169
	speed: 0.4089s/iter; left time: 4940.4121s
	iters: 600, epoch: 4 | loss: 0.2623695
	speed: 0.4146s/iter; left time: 4967.2659s
	iters: 700, epoch: 4 | loss: 0.3076444
	speed: 0.4127s/iter; left time: 4902.8516s
Epoch: 4 cost time: 306.6907215118408
Epoch: 4, Steps: 740 | Train Loss: 0.2874747 Vali Loss: 0.4140703 Test Loss: 0.5037242
Validation loss decreased (0.498210 --> 0.414070).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.2997960
	speed: 0.8977s/iter; left time: 10539.9512s
	iters: 200, epoch: 5 | loss: 0.2490871
	speed: 0.4174s/iter; left time: 4858.9547s
	iters: 300, epoch: 5 | loss: 0.2747261
	speed: 0.4144s/iter; left time: 4782.9940s
	iters: 400, epoch: 5 | loss: 0.2825710
	speed: 0.4060s/iter; left time: 4645.2894s
	iters: 500, epoch: 5 | loss: 0.2393205
	speed: 0.4117s/iter; left time: 4669.4108s
	iters: 600, epoch: 5 | loss: 0.2771698
	speed: 0.4205s/iter; left time: 4727.3300s
	iters: 700, epoch: 5 | loss: 0.2433828
	speed: 0.4072s/iter; left time: 4536.6947s
Epoch: 5 cost time: 305.3779125213623
Epoch: 5, Steps: 740 | Train Loss: 0.2609330 Vali Loss: 0.3809439 Test Loss: 0.4634227
Validation loss decreased (0.414070 --> 0.380944).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.2299777
	speed: 0.8868s/iter; left time: 9755.4076s
	iters: 200, epoch: 6 | loss: 0.2621593
	speed: 0.4090s/iter; left time: 4458.4396s
	iters: 300, epoch: 6 | loss: 0.2445484
	speed: 0.4115s/iter; left time: 4444.7632s
	iters: 400, epoch: 6 | loss: 0.2642878
	speed: 0.4100s/iter; left time: 4387.1861s
	iters: 500, epoch: 6 | loss: 0.2295364
	speed: 0.4046s/iter; left time: 4289.5790s
	iters: 600, epoch: 6 | loss: 0.2452859
	speed: 0.4043s/iter; left time: 4245.0971s
	iters: 700, epoch: 6 | loss: 0.2467319
	speed: 0.4082s/iter; left time: 4245.4029s
Epoch: 6 cost time: 301.7207386493683
Epoch: 6, Steps: 740 | Train Loss: 0.2472944 Vali Loss: 0.3627470 Test Loss: 0.4429162
Validation loss decreased (0.380944 --> 0.362747).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.2214836
	speed: 0.8902s/iter; left time: 9134.3989s
	iters: 200, epoch: 7 | loss: 0.2274572
	speed: 0.4168s/iter; left time: 4235.4774s
	iters: 300, epoch: 7 | loss: 0.2169285
	speed: 0.4195s/iter; left time: 4220.2740s
	iters: 400, epoch: 7 | loss: 0.2239682
	speed: 0.4236s/iter; left time: 4219.2729s
	iters: 500, epoch: 7 | loss: 0.2319818
	speed: 0.4217s/iter; left time: 4158.6352s
	iters: 600, epoch: 7 | loss: 0.2667693
	speed: 0.4067s/iter; left time: 3970.2625s
	iters: 700, epoch: 7 | loss: 0.2165235
	speed: 0.4272s/iter; left time: 4127.2121s
Epoch: 7 cost time: 309.7421224117279
Epoch: 7, Steps: 740 | Train Loss: 0.2398749 Vali Loss: 0.3560830 Test Loss: 0.4348573
Validation loss decreased (0.362747 --> 0.356083).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.2229290
	speed: 0.9180s/iter; left time: 8740.6124s
	iters: 200, epoch: 8 | loss: 0.2685127
	speed: 0.4198s/iter; left time: 3955.3360s
	iters: 300, epoch: 8 | loss: 0.2313497
	speed: 0.4109s/iter; left time: 3829.7864s
	iters: 400, epoch: 8 | loss: 0.2289782
	speed: 0.4135s/iter; left time: 3813.2184s
	iters: 500, epoch: 8 | loss: 0.2352487
	speed: 0.4097s/iter; left time: 3737.3116s
	iters: 600, epoch: 8 | loss: 0.2307625
	speed: 0.4055s/iter; left time: 3657.9516s
	iters: 700, epoch: 8 | loss: 0.2565429
	speed: 0.4075s/iter; left time: 3635.2498s
Epoch: 8 cost time: 305.32174491882324
Epoch: 8, Steps: 740 | Train Loss: 0.2358543 Vali Loss: 0.3514867 Test Loss: 0.4298697
Validation loss decreased (0.356083 --> 0.351487).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.2326929
	speed: 0.8930s/iter; left time: 7841.3057s
	iters: 200, epoch: 9 | loss: 0.2460122
	speed: 0.4089s/iter; left time: 3549.7774s
	iters: 300, epoch: 9 | loss: 0.2421031
	speed: 0.4290s/iter; left time: 3681.1435s
	iters: 400, epoch: 9 | loss: 0.2186178
	speed: 0.4519s/iter; left time: 3832.1435s
	iters: 500, epoch: 9 | loss: 0.2299424
	speed: 0.4303s/iter; left time: 3606.1474s
	iters: 600, epoch: 9 | loss: 0.2197088
	speed: 0.4114s/iter; left time: 3406.3990s
	iters: 700, epoch: 9 | loss: 0.2350210
	speed: 0.4242s/iter; left time: 3470.5812s
Epoch: 9 cost time: 313.5507538318634
Epoch: 9, Steps: 740 | Train Loss: 0.2336144 Vali Loss: 0.3501358 Test Loss: 0.4277841
Validation loss decreased (0.351487 --> 0.350136).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.2416132
	speed: 0.9030s/iter; left time: 7261.0860s
	iters: 200, epoch: 10 | loss: 0.2145205
	speed: 0.4118s/iter; left time: 3269.9713s
	iters: 300, epoch: 10 | loss: 0.2534149
	speed: 0.4245s/iter; left time: 3328.5324s
	iters: 400, epoch: 10 | loss: 0.2145261
	speed: 0.4192s/iter; left time: 3244.6691s
	iters: 500, epoch: 10 | loss: 0.2615508
	speed: 0.4192s/iter; left time: 3203.1047s
	iters: 600, epoch: 10 | loss: 0.2619848
	speed: 0.4226s/iter; left time: 3187.0840s
	iters: 700, epoch: 10 | loss: 0.2345707
	speed: 0.4099s/iter; left time: 3049.8521s
Epoch: 10 cost time: 308.33262848854065
Epoch: 10, Steps: 740 | Train Loss: 0.2324138 Vali Loss: 0.3488850 Test Loss: 0.4267373
Validation loss decreased (0.350136 --> 0.348885).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.2267834
	speed: 0.8986s/iter; left time: 6560.6050s
	iters: 200, epoch: 11 | loss: 0.2332613
	speed: 0.4139s/iter; left time: 2980.5647s
	iters: 300, epoch: 11 | loss: 0.2398168
	speed: 0.4109s/iter; left time: 2917.4490s
	iters: 400, epoch: 11 | loss: 0.2024477
	speed: 0.4140s/iter; left time: 2898.6826s
	iters: 500, epoch: 11 | loss: 0.2082458
	speed: 0.4093s/iter; left time: 2824.7408s
	iters: 600, epoch: 11 | loss: 0.2195051
	speed: 0.4180s/iter; left time: 2842.9244s
	iters: 700, epoch: 11 | loss: 0.2098211
	speed: 0.4198s/iter; left time: 2812.8766s
Epoch: 11 cost time: 306.6531882286072
Epoch: 11, Steps: 740 | Train Loss: 0.2316954 Vali Loss: 0.3482289 Test Loss: 0.4261252
Validation loss decreased (0.348885 --> 0.348229).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.2037526
	speed: 0.9117s/iter; left time: 5981.5863s
	iters: 200, epoch: 12 | loss: 0.2511074
	speed: 0.4172s/iter; left time: 2695.8291s
	iters: 300, epoch: 12 | loss: 0.2164208
	speed: 0.4235s/iter; left time: 2694.1376s
	iters: 400, epoch: 12 | loss: 0.2304482
	speed: 0.4164s/iter; left time: 2606.8033s
	iters: 500, epoch: 12 | loss: 0.2501042
	speed: 0.4089s/iter; left time: 2519.4889s
	iters: 600, epoch: 12 | loss: 0.2607269
	speed: 0.4198s/iter; left time: 2544.6506s
	iters: 700, epoch: 12 | loss: 0.2552015
	speed: 0.4104s/iter; left time: 2446.2856s
Epoch: 12 cost time: 308.65456438064575
Epoch: 12, Steps: 740 | Train Loss: 0.2313045 Vali Loss: 0.3481860 Test Loss: 0.4259945
Validation loss decreased (0.348229 --> 0.348186).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.2496594
	speed: 0.9011s/iter; left time: 5245.3771s
	iters: 200, epoch: 13 | loss: 0.2351297
	speed: 0.4116s/iter; left time: 2354.4895s
	iters: 300, epoch: 13 | loss: 0.2578372
	speed: 0.4060s/iter; left time: 2282.2453s
	iters: 400, epoch: 13 | loss: 0.2206026
	speed: 0.4075s/iter; left time: 2249.6090s
	iters: 500, epoch: 13 | loss: 0.2213827
	speed: 0.4140s/iter; left time: 2244.4757s
	iters: 600, epoch: 13 | loss: 0.2643591
	speed: 0.4229s/iter; left time: 2250.1884s
	iters: 700, epoch: 13 | loss: 0.2033435
	speed: 0.4269s/iter; left time: 2229.0407s
Epoch: 13 cost time: 307.29236936569214
Epoch: 13, Steps: 740 | Train Loss: 0.2311545 Vali Loss: 0.3479402 Test Loss: 0.4259482
Validation loss decreased (0.348186 --> 0.347940).  Saving model ...
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 14 | loss: 0.2429941
	speed: 0.9031s/iter; left time: 4588.4942s
	iters: 200, epoch: 14 | loss: 0.2173652
	speed: 0.4148s/iter; left time: 2066.1057s
	iters: 300, epoch: 14 | loss: 0.2404776
	speed: 0.4064s/iter; left time: 1983.4141s
	iters: 400, epoch: 14 | loss: 0.2366205
	speed: 0.4122s/iter; left time: 1970.6882s
	iters: 500, epoch: 14 | loss: 0.2152416
	speed: 0.4089s/iter; left time: 1914.1950s
	iters: 600, epoch: 14 | loss: 0.2900954
	speed: 0.4098s/iter; left time: 1877.1050s
	iters: 700, epoch: 14 | loss: 0.2091819
	speed: 0.4222s/iter; left time: 1891.7525s
Epoch: 14 cost time: 305.7411563396454
Epoch: 14, Steps: 740 | Train Loss: 0.2310426 Vali Loss: 0.3480635 Test Loss: 0.4258932
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 15 | loss: 0.2392193
	speed: 0.8487s/iter; left time: 3684.0229s
	iters: 200, epoch: 15 | loss: 0.2198897
	speed: 0.4204s/iter; left time: 1782.7261s
	iters: 300, epoch: 15 | loss: 0.2769275
	speed: 0.4178s/iter; left time: 1730.2202s
	iters: 400, epoch: 15 | loss: 0.2143661
	speed: 0.4114s/iter; left time: 1662.3463s
	iters: 500, epoch: 15 | loss: 0.2468188
	speed: 0.4131s/iter; left time: 1628.1772s
	iters: 600, epoch: 15 | loss: 0.2281187
	speed: 0.4176s/iter; left time: 1604.0133s
	iters: 700, epoch: 15 | loss: 0.2068375
	speed: 0.4119s/iter; left time: 1540.8351s
Epoch: 15 cost time: 307.46856331825256
Epoch: 15, Steps: 740 | Train Loss: 0.2309543 Vali Loss: 0.3480929 Test Loss: 0.4258851
EarlyStopping counter: 2 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 16 | loss: 0.2403159
	speed: 0.8638s/iter; left time: 3110.4052s
	iters: 200, epoch: 16 | loss: 0.2678291
	speed: 0.4175s/iter; left time: 1461.4967s
	iters: 300, epoch: 16 | loss: 0.2436073
	speed: 0.4093s/iter; left time: 1392.1613s
	iters: 400, epoch: 16 | loss: 0.2157674
	speed: 0.4077s/iter; left time: 1345.6834s
	iters: 500, epoch: 16 | loss: 0.2110094
	speed: 0.4180s/iter; left time: 1337.8582s
	iters: 600, epoch: 16 | loss: 0.2176995
	speed: 0.4198s/iter; left time: 1301.8262s
	iters: 700, epoch: 16 | loss: 0.2485138
	speed: 0.4089s/iter; left time: 1227.1183s
Epoch: 16 cost time: 306.4584743976593
Epoch: 16, Steps: 740 | Train Loss: 0.2309633 Vali Loss: 0.3478366 Test Loss: 0.4258818
Validation loss decreased (0.347940 --> 0.347837).  Saving model ...
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 17 | loss: 0.2237942
	speed: 0.9026s/iter; left time: 2582.4727s
	iters: 200, epoch: 17 | loss: 0.2294217
	speed: 0.4066s/iter; left time: 1122.5112s
	iters: 300, epoch: 17 | loss: 0.1944913
	speed: 0.4103s/iter; left time: 1091.8342s
	iters: 400, epoch: 17 | loss: 0.2139337
	speed: 0.4097s/iter; left time: 1049.1521s
	iters: 500, epoch: 17 | loss: 0.2631913
	speed: 0.4068s/iter; left time: 1001.0785s
	iters: 600, epoch: 17 | loss: 0.2175346
	speed: 0.4066s/iter; left time: 959.9328s
	iters: 700, epoch: 17 | loss: 0.2124917
	speed: 0.4055s/iter; left time: 916.8777s
Epoch: 17 cost time: 302.22806119918823
Epoch: 17, Steps: 740 | Train Loss: 0.2309519 Vali Loss: 0.3482329 Test Loss: 0.4258817
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 18 | loss: 0.2226258
	speed: 0.8647s/iter; left time: 1833.9754s
	iters: 200, epoch: 18 | loss: 0.2213876
	speed: 0.4126s/iter; left time: 833.7968s
	iters: 300, epoch: 18 | loss: 0.2216602
	speed: 0.4109s/iter; left time: 789.3449s
	iters: 400, epoch: 18 | loss: 0.2109833
	speed: 0.4169s/iter; left time: 759.2086s
	iters: 500, epoch: 18 | loss: 0.2127904
	speed: 0.4104s/iter; left time: 706.3223s
	iters: 600, epoch: 18 | loss: 0.2474792
	speed: 0.4091s/iter; left time: 663.1346s
	iters: 700, epoch: 18 | loss: 0.2409687
	speed: 0.4109s/iter; left time: 624.9985s
Epoch: 18 cost time: 307.1765773296356
Epoch: 18, Steps: 740 | Train Loss: 0.2308984 Vali Loss: 0.3481482 Test Loss: 0.4258816
EarlyStopping counter: 2 out of 5
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 19 | loss: 0.2487868
	speed: 0.8435s/iter; left time: 1164.8571s
	iters: 200, epoch: 19 | loss: 0.2712336
	speed: 0.4106s/iter; left time: 525.9782s
	iters: 300, epoch: 19 | loss: 0.2613385
	speed: 0.4058s/iter; left time: 479.2257s
	iters: 400, epoch: 19 | loss: 0.2090991
	speed: 0.4352s/iter; left time: 470.4774s
	iters: 500, epoch: 19 | loss: 0.2511300
	speed: 0.4806s/iter; left time: 471.4635s
	iters: 600, epoch: 19 | loss: 0.2535544
	speed: 0.4729s/iter; left time: 416.5872s
	iters: 700, epoch: 19 | loss: 0.2085496
	speed: 0.4151s/iter; left time: 324.1950s
Epoch: 19 cost time: 319.5278534889221
Epoch: 19, Steps: 740 | Train Loss: 0.2308948 Vali Loss: 0.3477811 Test Loss: 0.4258814
Validation loss decreased (0.347837 --> 0.347781).  Saving model ...
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 20 | loss: 0.2458751
	speed: 0.9570s/iter; left time: 613.4480s
	iters: 200, epoch: 20 | loss: 0.2349521
	speed: 0.4322s/iter; left time: 233.8305s
	iters: 300, epoch: 20 | loss: 0.2289265
	speed: 0.4167s/iter; left time: 183.7799s
	iters: 400, epoch: 20 | loss: 0.2384013
	speed: 0.4127s/iter; left time: 140.7422s
	iters: 500, epoch: 20 | loss: 0.2100334
	speed: 0.4196s/iter; left time: 101.1151s
	iters: 600, epoch: 20 | loss: 0.2275545
	speed: 0.4115s/iter; left time: 58.0185s
	iters: 700, epoch: 20 | loss: 0.2009989
	speed: 0.4121s/iter; left time: 16.8965s
Epoch: 20 cost time: 314.3588194847107
Epoch: 20, Steps: 740 | Train Loss: 0.2309219 Vali Loss: 0.3480712 Test Loss: 0.4258814
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.9073486328125e-08
>>>>>>>testing : traffic_336_96_DLinear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3144<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3413
mse:0.42613711953163147, mae:0.29834413528442383
