Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='DLinear', model_id='weather_336_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=336, root_path='./dataset/', save_pred_values=False, seed=25565, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : weather_336_336_DLinear_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed25565>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36216
val 4935
test 10204
	iters: 100, epoch: 1 | loss: 0.5766953
	speed: 0.0423s/iter; left time: 1911.8783s
	iters: 200, epoch: 1 | loss: 0.8137629
	speed: 0.0440s/iter; left time: 1980.8153s
	iters: 300, epoch: 1 | loss: 0.5034934
	speed: 0.0465s/iter; left time: 2092.5015s
	iters: 400, epoch: 1 | loss: 0.7763239
	speed: 0.0446s/iter; left time: 2000.0339s
	iters: 500, epoch: 1 | loss: 3.6790960
	speed: 0.0457s/iter; left time: 2044.6439s
	iters: 600, epoch: 1 | loss: 3.1192663
	speed: 0.0473s/iter; left time: 2111.3657s
	iters: 700, epoch: 1 | loss: 1.0307926
	speed: 0.0462s/iter; left time: 2059.4487s
	iters: 800, epoch: 1 | loss: 0.7226933
	speed: 0.0446s/iter; left time: 1983.5430s
	iters: 900, epoch: 1 | loss: 2.5017607
	speed: 0.0461s/iter; left time: 2047.0098s
	iters: 1000, epoch: 1 | loss: 1.0543934
	speed: 0.0457s/iter; left time: 2024.2412s
	iters: 1100, epoch: 1 | loss: 0.4892653
	speed: 0.0470s/iter; left time: 2074.5345s
	iters: 1200, epoch: 1 | loss: 1.0499601
	speed: 0.0460s/iter; left time: 2028.9406s
	iters: 1300, epoch: 1 | loss: 0.6669917
	speed: 0.0476s/iter; left time: 2092.9072s
	iters: 1400, epoch: 1 | loss: 0.5250790
	speed: 0.0414s/iter; left time: 1816.7837s
	iters: 1500, epoch: 1 | loss: 0.5359617
	speed: 0.0449s/iter; left time: 1964.2205s
	iters: 1600, epoch: 1 | loss: 0.9442626
	speed: 0.0465s/iter; left time: 2028.8025s
	iters: 1700, epoch: 1 | loss: 0.5265263
	speed: 0.0420s/iter; left time: 1828.5463s
	iters: 1800, epoch: 1 | loss: 0.4508506
	speed: 0.0466s/iter; left time: 2023.1263s
	iters: 1900, epoch: 1 | loss: 1.1277958
	speed: 0.0441s/iter; left time: 1911.9529s
	iters: 2000, epoch: 1 | loss: 2.2903810
	speed: 0.0426s/iter; left time: 1841.2690s
	iters: 2100, epoch: 1 | loss: 0.6812941
	speed: 0.0436s/iter; left time: 1880.2951s
	iters: 2200, epoch: 1 | loss: 0.5841009
	speed: 0.0461s/iter; left time: 1985.9247s
Epoch: 1 cost time: 102.0461859703064
Epoch: 1, Steps: 2263 | Train Loss: 1.0585164 Vali Loss: 0.8118992 Test Loss: 0.3925684
Validation loss decreased (inf --> 0.811899).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.8384649
	speed: 0.1590s/iter; left time: 6820.4991s
	iters: 200, epoch: 2 | loss: 1.1728648
	speed: 0.0468s/iter; left time: 2003.1352s
	iters: 300, epoch: 2 | loss: 0.7968759
	speed: 0.0471s/iter; left time: 2010.1664s
	iters: 400, epoch: 2 | loss: 0.6004192
	speed: 0.0439s/iter; left time: 1868.6828s
	iters: 500, epoch: 2 | loss: 1.4371692
	speed: 0.0460s/iter; left time: 1955.2840s
	iters: 600, epoch: 2 | loss: 4.1452656
	speed: 0.0443s/iter; left time: 1879.7025s
	iters: 700, epoch: 2 | loss: 0.7118866
	speed: 0.0449s/iter; left time: 1898.4566s
	iters: 800, epoch: 2 | loss: 0.7673038
	speed: 0.0445s/iter; left time: 1875.8693s
	iters: 900, epoch: 2 | loss: 0.9633760
	speed: 0.0480s/iter; left time: 2020.7976s
	iters: 1000, epoch: 2 | loss: 1.1985242
	speed: 0.0470s/iter; left time: 1973.5431s
	iters: 1100, epoch: 2 | loss: 0.6293182
	speed: 0.0467s/iter; left time: 1957.4980s
	iters: 1200, epoch: 2 | loss: 5.9234982
	speed: 0.0442s/iter; left time: 1847.6920s
	iters: 1300, epoch: 2 | loss: 1.5979018
	speed: 0.0460s/iter; left time: 1916.5435s
	iters: 1400, epoch: 2 | loss: 0.6359033
	speed: 0.0469s/iter; left time: 1951.8379s
	iters: 1500, epoch: 2 | loss: 0.6155450
	speed: 0.0446s/iter; left time: 1850.1377s
	iters: 1600, epoch: 2 | loss: 5.2850900
	speed: 0.0463s/iter; left time: 1916.8939s
	iters: 1700, epoch: 2 | loss: 0.4900979
	speed: 0.0459s/iter; left time: 1895.6854s
	iters: 1800, epoch: 2 | loss: 0.6070211
	speed: 0.0449s/iter; left time: 1848.7988s
	iters: 1900, epoch: 2 | loss: 0.5413213
	speed: 0.0455s/iter; left time: 1870.3218s
	iters: 2000, epoch: 2 | loss: 3.9115474
	speed: 0.0404s/iter; left time: 1654.7607s
	iters: 2100, epoch: 2 | loss: 1.2568763
	speed: 0.0454s/iter; left time: 1858.3152s
	iters: 2200, epoch: 2 | loss: 3.8161814
	speed: 0.0434s/iter; left time: 1769.2740s
Epoch: 2 cost time: 102.40093851089478
Epoch: 2, Steps: 2263 | Train Loss: 1.1619946 Vali Loss: 0.7390097 Test Loss: 0.3242919
Validation loss decreased (0.811899 --> 0.739010).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.4026772
	speed: 0.1584s/iter; left time: 6437.6140s
	iters: 200, epoch: 3 | loss: 3.6116476
	speed: 0.0482s/iter; left time: 1953.0040s
	iters: 300, epoch: 3 | loss: 1.1746670
	speed: 0.0451s/iter; left time: 1823.9652s
	iters: 400, epoch: 3 | loss: 0.5421603
	speed: 0.0444s/iter; left time: 1791.4867s
	iters: 500, epoch: 3 | loss: 1.8618909
	speed: 0.0424s/iter; left time: 1703.9776s
	iters: 600, epoch: 3 | loss: 0.6053395
	speed: 0.0465s/iter; left time: 1866.5231s
	iters: 700, epoch: 3 | loss: 1.6719303
	speed: 0.0463s/iter; left time: 1854.6044s
	iters: 800, epoch: 3 | loss: 0.5640383
	speed: 0.0462s/iter; left time: 1843.7389s
	iters: 900, epoch: 3 | loss: 0.4541125
	speed: 0.0469s/iter; left time: 1868.9923s
	iters: 1000, epoch: 3 | loss: 1.2952726
	speed: 0.0453s/iter; left time: 1800.4584s
	iters: 1100, epoch: 3 | loss: 0.6168296
	speed: 0.0470s/iter; left time: 1862.8290s
	iters: 1200, epoch: 3 | loss: 0.5639085
	speed: 0.0477s/iter; left time: 1886.2658s
	iters: 1300, epoch: 3 | loss: 1.4459339
	speed: 0.0427s/iter; left time: 1684.0090s
	iters: 1400, epoch: 3 | loss: 0.4474559
	speed: 0.0475s/iter; left time: 1869.7940s
	iters: 1500, epoch: 3 | loss: 2.1419306
	speed: 0.0441s/iter; left time: 1728.6928s
	iters: 1600, epoch: 3 | loss: 0.3943910
	speed: 0.0435s/iter; left time: 1701.5993s
	iters: 1700, epoch: 3 | loss: 1.6174114
	speed: 0.0458s/iter; left time: 1787.3560s
	iters: 1800, epoch: 3 | loss: 0.4866017
	speed: 0.0469s/iter; left time: 1826.1999s
	iters: 1900, epoch: 3 | loss: 0.4952865
	speed: 0.0458s/iter; left time: 1779.8297s
	iters: 2000, epoch: 3 | loss: 0.4385318
	speed: 0.0458s/iter; left time: 1775.9496s
	iters: 2100, epoch: 3 | loss: 0.4001272
	speed: 0.0476s/iter; left time: 1838.4483s
	iters: 2200, epoch: 3 | loss: 0.4303413
	speed: 0.0460s/iter; left time: 1773.2727s
Epoch: 3 cost time: 103.19581532478333
Epoch: 3, Steps: 2263 | Train Loss: 0.7800497 Vali Loss: 0.5740200 Test Loss: 0.2767980
Validation loss decreased (0.739010 --> 0.574020).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.4622604
	speed: 0.1483s/iter; left time: 5689.1484s
	iters: 200, epoch: 4 | loss: 0.4323735
	speed: 0.0467s/iter; left time: 1788.7748s
	iters: 300, epoch: 4 | loss: 0.5625531
	speed: 0.0443s/iter; left time: 1692.5300s
	iters: 400, epoch: 4 | loss: 1.1060385
	speed: 0.0433s/iter; left time: 1649.2388s
	iters: 500, epoch: 4 | loss: 0.3852463
	speed: 0.0431s/iter; left time: 1636.4378s
	iters: 600, epoch: 4 | loss: 0.9812584
	speed: 0.0486s/iter; left time: 1839.2138s
	iters: 700, epoch: 4 | loss: 0.4130269
	speed: 0.0445s/iter; left time: 1681.4434s
	iters: 800, epoch: 4 | loss: 0.4490608
	speed: 0.0454s/iter; left time: 1709.0557s
	iters: 900, epoch: 4 | loss: 0.5516963
	speed: 0.0464s/iter; left time: 1744.0422s
	iters: 1000, epoch: 4 | loss: 0.6306491
	speed: 0.0436s/iter; left time: 1633.5695s
	iters: 1100, epoch: 4 | loss: 1.9031061
	speed: 0.0428s/iter; left time: 1600.1318s
	iters: 1200, epoch: 4 | loss: 0.4738393
	speed: 0.0458s/iter; left time: 1706.2646s
	iters: 1300, epoch: 4 | loss: 0.6697393
	speed: 0.0459s/iter; left time: 1707.1892s
	iters: 1400, epoch: 4 | loss: 0.4823910
	speed: 0.0461s/iter; left time: 1709.1099s
	iters: 1500, epoch: 4 | loss: 0.5427401
	speed: 0.0467s/iter; left time: 1725.8384s
	iters: 1600, epoch: 4 | loss: 0.3942796
	speed: 0.0451s/iter; left time: 1663.7419s
	iters: 1700, epoch: 4 | loss: 0.4358900
	speed: 0.0447s/iter; left time: 1645.1744s
	iters: 1800, epoch: 4 | loss: 0.3510023
	speed: 0.0445s/iter; left time: 1633.7077s
	iters: 1900, epoch: 4 | loss: 0.3440708
	speed: 0.0446s/iter; left time: 1630.8709s
	iters: 2000, epoch: 4 | loss: 0.5689180
	speed: 0.0444s/iter; left time: 1617.6556s
	iters: 2100, epoch: 4 | loss: 0.4606542
	speed: 0.0448s/iter; left time: 1629.8590s
	iters: 2200, epoch: 4 | loss: 1.0589628
	speed: 0.0469s/iter; left time: 1702.5081s
Epoch: 4 cost time: 101.8669924736023
Epoch: 4, Steps: 2263 | Train Loss: 0.5841289 Vali Loss: 0.5243437 Test Loss: 0.2514418
Validation loss decreased (0.574020 --> 0.524344).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.4815519
	speed: 0.1498s/iter; left time: 5408.7128s
	iters: 200, epoch: 5 | loss: 0.3992274
	speed: 0.0473s/iter; left time: 1703.0701s
	iters: 300, epoch: 5 | loss: 0.3627444
	speed: 0.0448s/iter; left time: 1610.3227s
	iters: 400, epoch: 5 | loss: 1.0980839
	speed: 0.0464s/iter; left time: 1661.9483s
	iters: 500, epoch: 5 | loss: 1.4608747
	speed: 0.0481s/iter; left time: 1716.8080s
	iters: 600, epoch: 5 | loss: 0.5242358
	speed: 0.0452s/iter; left time: 1610.2475s
	iters: 700, epoch: 5 | loss: 0.4507622
	speed: 0.0450s/iter; left time: 1597.9900s
	iters: 800, epoch: 5 | loss: 0.4766595
	speed: 0.0457s/iter; left time: 1617.7835s
	iters: 900, epoch: 5 | loss: 0.5424018
	speed: 0.0460s/iter; left time: 1624.5035s
	iters: 1000, epoch: 5 | loss: 0.3645638
	speed: 0.0466s/iter; left time: 1639.1558s
	iters: 1100, epoch: 5 | loss: 0.3493628
	speed: 0.0445s/iter; left time: 1564.0683s
	iters: 1200, epoch: 5 | loss: 0.9130152
	speed: 0.0457s/iter; left time: 1600.1031s
	iters: 1300, epoch: 5 | loss: 0.4627937
	speed: 0.0442s/iter; left time: 1541.8510s
	iters: 1400, epoch: 5 | loss: 0.5087426
	speed: 0.0425s/iter; left time: 1479.9320s
	iters: 1500, epoch: 5 | loss: 0.6257932
	speed: 0.0418s/iter; left time: 1451.9280s
	iters: 1600, epoch: 5 | loss: 0.5586170
	speed: 0.0447s/iter; left time: 1546.2046s
	iters: 1700, epoch: 5 | loss: 0.4040520
	speed: 0.0421s/iter; left time: 1453.4118s
	iters: 1800, epoch: 5 | loss: 0.3019581
	speed: 0.0441s/iter; left time: 1517.3644s
	iters: 1900, epoch: 5 | loss: 0.3454686
	speed: 0.0460s/iter; left time: 1579.6277s
	iters: 2000, epoch: 5 | loss: 1.0488125
	speed: 0.0463s/iter; left time: 1584.9729s
	iters: 2100, epoch: 5 | loss: 0.4354027
	speed: 0.0437s/iter; left time: 1488.9728s
	iters: 2200, epoch: 5 | loss: 0.4050326
	speed: 0.0427s/iter; left time: 1450.8070s
Epoch: 5 cost time: 101.2616286277771
Epoch: 5, Steps: 2263 | Train Loss: 0.5293852 Vali Loss: 0.5206422 Test Loss: 0.2553126
Validation loss decreased (0.524344 --> 0.520642).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.3409190
	speed: 0.1529s/iter; left time: 5174.6884s
	iters: 200, epoch: 6 | loss: 0.3356104
	speed: 0.0461s/iter; left time: 1555.5433s
	iters: 300, epoch: 6 | loss: 0.4618347
	speed: 0.0479s/iter; left time: 1612.2294s
	iters: 400, epoch: 6 | loss: 0.4728769
	speed: 0.0460s/iter; left time: 1543.2152s
	iters: 500, epoch: 6 | loss: 0.5033227
	speed: 0.0451s/iter; left time: 1509.7566s
	iters: 600, epoch: 6 | loss: 0.4948391
	speed: 0.0455s/iter; left time: 1516.9991s
	iters: 700, epoch: 6 | loss: 0.8921755
	speed: 0.0442s/iter; left time: 1469.6409s
	iters: 800, epoch: 6 | loss: 0.4940047
	speed: 0.0449s/iter; left time: 1487.4233s
	iters: 900, epoch: 6 | loss: 0.4425063
	speed: 0.0443s/iter; left time: 1465.2649s
	iters: 1000, epoch: 6 | loss: 0.9490198
	speed: 0.0445s/iter; left time: 1465.4531s
	iters: 1100, epoch: 6 | loss: 0.9268876
	speed: 0.0469s/iter; left time: 1541.2962s
	iters: 1200, epoch: 6 | loss: 0.4738652
	speed: 0.0451s/iter; left time: 1478.0829s
	iters: 1300, epoch: 6 | loss: 0.5444499
	speed: 0.0478s/iter; left time: 1561.9201s
	iters: 1400, epoch: 6 | loss: 0.3887707
	speed: 0.0442s/iter; left time: 1438.3795s
	iters: 1500, epoch: 6 | loss: 0.3587605
	speed: 0.0464s/iter; left time: 1506.3087s
	iters: 1600, epoch: 6 | loss: 0.3924231
	speed: 0.0467s/iter; left time: 1509.5949s
	iters: 1700, epoch: 6 | loss: 0.4266726
	speed: 0.0479s/iter; left time: 1544.7750s
	iters: 1800, epoch: 6 | loss: 0.5113316
	speed: 0.0475s/iter; left time: 1527.8275s
	iters: 1900, epoch: 6 | loss: 0.4540058
	speed: 0.0482s/iter; left time: 1543.4410s
	iters: 2000, epoch: 6 | loss: 0.4906629
	speed: 0.0468s/iter; left time: 1493.9795s
	iters: 2100, epoch: 6 | loss: 0.5208685
	speed: 0.0453s/iter; left time: 1442.2060s
	iters: 2200, epoch: 6 | loss: 0.3970301
	speed: 0.0432s/iter; left time: 1372.9730s
Epoch: 6 cost time: 103.01063513755798
Epoch: 6, Steps: 2263 | Train Loss: 0.5097712 Vali Loss: 0.5026274 Test Loss: 0.2429636
Validation loss decreased (0.520642 --> 0.502627).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.9240055
	speed: 0.1541s/iter; left time: 4867.2497s
	iters: 200, epoch: 7 | loss: 0.4797365
	speed: 0.0457s/iter; left time: 1439.7258s
	iters: 300, epoch: 7 | loss: 0.3266440
	speed: 0.0439s/iter; left time: 1376.7089s
	iters: 400, epoch: 7 | loss: 0.4815987
	speed: 0.0456s/iter; left time: 1426.6466s
	iters: 500, epoch: 7 | loss: 0.4356386
	speed: 0.0457s/iter; left time: 1426.4649s
	iters: 600, epoch: 7 | loss: 0.4471106
	speed: 0.0446s/iter; left time: 1386.8502s
	iters: 700, epoch: 7 | loss: 0.5629189
	speed: 0.0466s/iter; left time: 1444.2971s
	iters: 800, epoch: 7 | loss: 0.3317059
	speed: 0.0447s/iter; left time: 1379.5557s
	iters: 900, epoch: 7 | loss: 0.3780354
	speed: 0.0445s/iter; left time: 1370.7189s
	iters: 1000, epoch: 7 | loss: 1.1817112
	speed: 0.0480s/iter; left time: 1472.2257s
	iters: 1100, epoch: 7 | loss: 0.4472224
	speed: 0.0443s/iter; left time: 1353.3527s
	iters: 1200, epoch: 7 | loss: 0.4491424
	speed: 0.0476s/iter; left time: 1450.2427s
	iters: 1300, epoch: 7 | loss: 0.4958723
	speed: 0.0456s/iter; left time: 1386.5204s
	iters: 1400, epoch: 7 | loss: 0.2647486
	speed: 0.0470s/iter; left time: 1422.3195s
	iters: 1500, epoch: 7 | loss: 0.4056330
	speed: 0.0454s/iter; left time: 1370.6345s
	iters: 1600, epoch: 7 | loss: 0.9013831
	speed: 0.0451s/iter; left time: 1357.5852s
	iters: 1700, epoch: 7 | loss: 0.4918572
	speed: 0.0468s/iter; left time: 1402.5500s
	iters: 1800, epoch: 7 | loss: 0.6216609
	speed: 0.0486s/iter; left time: 1452.0526s
	iters: 1900, epoch: 7 | loss: 0.4730316
	speed: 0.0433s/iter; left time: 1288.6725s
	iters: 2000, epoch: 7 | loss: 0.8942596
	speed: 0.0463s/iter; left time: 1374.2657s
	iters: 2100, epoch: 7 | loss: 0.3893824
	speed: 0.0485s/iter; left time: 1435.4036s
	iters: 2200, epoch: 7 | loss: 0.9220650
	speed: 0.0416s/iter; left time: 1225.9249s
Epoch: 7 cost time: 102.59996843338013
Epoch: 7, Steps: 2263 | Train Loss: 0.5013524 Vali Loss: 0.4961364 Test Loss: 0.2404635
Validation loss decreased (0.502627 --> 0.496136).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.4972248
	speed: 0.1521s/iter; left time: 4460.2158s
	iters: 200, epoch: 8 | loss: 0.3759213
	speed: 0.0425s/iter; left time: 1242.0335s
	iters: 300, epoch: 8 | loss: 0.4079873
	speed: 0.0456s/iter; left time: 1327.7483s
	iters: 400, epoch: 8 | loss: 1.0840249
	speed: 0.0448s/iter; left time: 1299.0629s
	iters: 500, epoch: 8 | loss: 0.4689762
	speed: 0.0458s/iter; left time: 1325.8011s
	iters: 600, epoch: 8 | loss: 0.2746785
	speed: 0.0455s/iter; left time: 1311.1930s
	iters: 700, epoch: 8 | loss: 0.3168743
	speed: 0.0440s/iter; left time: 1263.3083s
	iters: 800, epoch: 8 | loss: 0.4517470
	speed: 0.0409s/iter; left time: 1170.1239s
	iters: 900, epoch: 8 | loss: 0.4818287
	speed: 0.0440s/iter; left time: 1255.6531s
	iters: 1000, epoch: 8 | loss: 0.9038937
	speed: 0.0434s/iter; left time: 1234.2402s
	iters: 1100, epoch: 8 | loss: 0.4999936
	speed: 0.0422s/iter; left time: 1194.0553s
	iters: 1200, epoch: 8 | loss: 0.8886840
	speed: 0.0422s/iter; left time: 1190.9944s
	iters: 1300, epoch: 8 | loss: 0.8726407
	speed: 0.0484s/iter; left time: 1359.9529s
	iters: 1400, epoch: 8 | loss: 0.4359250
	speed: 0.0428s/iter; left time: 1199.5227s
	iters: 1500, epoch: 8 | loss: 0.3028560
	speed: 0.0424s/iter; left time: 1183.5405s
	iters: 1600, epoch: 8 | loss: 0.5633878
	speed: 0.0431s/iter; left time: 1200.1211s
	iters: 1700, epoch: 8 | loss: 1.1040466
	speed: 0.0439s/iter; left time: 1217.7642s
	iters: 1800, epoch: 8 | loss: 0.4390495
	speed: 0.0465s/iter; left time: 1284.2575s
	iters: 1900, epoch: 8 | loss: 0.3458304
	speed: 0.0436s/iter; left time: 1198.7270s
	iters: 2000, epoch: 8 | loss: 0.3904139
	speed: 0.0452s/iter; left time: 1239.1226s
	iters: 2100, epoch: 8 | loss: 0.2922446
	speed: 0.0427s/iter; left time: 1166.0280s
	iters: 2200, epoch: 8 | loss: 0.4659396
	speed: 0.0427s/iter; left time: 1161.6075s
Epoch: 8 cost time: 99.1085524559021
Epoch: 8, Steps: 2263 | Train Loss: 0.4971539 Vali Loss: 0.4953912 Test Loss: 0.2400594
Validation loss decreased (0.496136 --> 0.495391).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.3991660
	speed: 0.1503s/iter; left time: 4065.9121s
	iters: 200, epoch: 9 | loss: 0.5362197
	speed: 0.0425s/iter; left time: 1145.3052s
	iters: 300, epoch: 9 | loss: 0.4602510
	speed: 0.0460s/iter; left time: 1234.5954s
	iters: 400, epoch: 9 | loss: 0.9186217
	speed: 0.0465s/iter; left time: 1243.6980s
	iters: 500, epoch: 9 | loss: 0.3055394
	speed: 0.0420s/iter; left time: 1120.3272s
	iters: 600, epoch: 9 | loss: 0.4116233
	speed: 0.0461s/iter; left time: 1224.4885s
	iters: 700, epoch: 9 | loss: 0.8815648
	speed: 0.0471s/iter; left time: 1245.4400s
	iters: 800, epoch: 9 | loss: 0.5113626
	speed: 0.0475s/iter; left time: 1252.1893s
	iters: 900, epoch: 9 | loss: 0.4475808
	speed: 0.0460s/iter; left time: 1206.6706s
	iters: 1000, epoch: 9 | loss: 0.9703346
	speed: 0.0457s/iter; left time: 1196.4295s
	iters: 1100, epoch: 9 | loss: 0.3843056
	speed: 0.0460s/iter; left time: 1198.4670s
	iters: 1200, epoch: 9 | loss: 0.3815265
	speed: 0.0449s/iter; left time: 1166.3695s
	iters: 1300, epoch: 9 | loss: 0.4817307
	speed: 0.0448s/iter; left time: 1158.6436s
	iters: 1400, epoch: 9 | loss: 0.5429657
	speed: 0.0450s/iter; left time: 1159.2250s
	iters: 1500, epoch: 9 | loss: 0.4179088
	speed: 0.0430s/iter; left time: 1102.4937s
	iters: 1600, epoch: 9 | loss: 0.3934377
	speed: 0.0460s/iter; left time: 1176.3029s
	iters: 1700, epoch: 9 | loss: 1.0952744
	speed: 0.0447s/iter; left time: 1136.8022s
	iters: 1800, epoch: 9 | loss: 0.9242290
	speed: 0.0448s/iter; left time: 1136.0825s
	iters: 1900, epoch: 9 | loss: 0.5456250
	speed: 0.0449s/iter; left time: 1133.1224s
	iters: 2000, epoch: 9 | loss: 0.3960767
	speed: 0.0476s/iter; left time: 1198.1054s
	iters: 2100, epoch: 9 | loss: 0.3790690
	speed: 0.0448s/iter; left time: 1122.1235s
	iters: 2200, epoch: 9 | loss: 0.3891676
	speed: 0.0440s/iter; left time: 1098.6170s
Epoch: 9 cost time: 101.40305757522583
Epoch: 9, Steps: 2263 | Train Loss: 0.4952125 Vali Loss: 0.4947327 Test Loss: 0.2421241
Validation loss decreased (0.495391 --> 0.494733).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.4506032
	speed: 0.1446s/iter; left time: 3584.3836s
	iters: 200, epoch: 10 | loss: 0.3705746
	speed: 0.0422s/iter; left time: 1042.8400s
	iters: 300, epoch: 10 | loss: 0.3297354
	speed: 0.0446s/iter; left time: 1096.3341s
	iters: 400, epoch: 10 | loss: 0.4324180
	speed: 0.0437s/iter; left time: 1071.4629s
	iters: 500, epoch: 10 | loss: 0.9898427
	speed: 0.0458s/iter; left time: 1116.1548s
	iters: 600, epoch: 10 | loss: 0.3598466
	speed: 0.0453s/iter; left time: 1099.4348s
	iters: 700, epoch: 10 | loss: 0.3776051
	speed: 0.0459s/iter; left time: 1110.4627s
	iters: 800, epoch: 10 | loss: 0.3818125
	speed: 0.0458s/iter; left time: 1104.5499s
	iters: 900, epoch: 10 | loss: 0.3869159
	speed: 0.0469s/iter; left time: 1124.4981s
	iters: 1000, epoch: 10 | loss: 0.4655950
	speed: 0.0434s/iter; left time: 1038.0231s
	iters: 1100, epoch: 10 | loss: 0.3574724
	speed: 0.0479s/iter; left time: 1139.9592s
	iters: 1200, epoch: 10 | loss: 0.5858762
	speed: 0.0441s/iter; left time: 1045.8861s
	iters: 1300, epoch: 10 | loss: 0.3462139
	speed: 0.0454s/iter; left time: 1071.5319s
	iters: 1400, epoch: 10 | loss: 0.3808433
	speed: 0.0455s/iter; left time: 1068.3329s
	iters: 1500, epoch: 10 | loss: 0.5991040
	speed: 0.0449s/iter; left time: 1050.9400s
	iters: 1600, epoch: 10 | loss: 0.4120368
	speed: 0.0419s/iter; left time: 976.1784s
	iters: 1700, epoch: 10 | loss: 0.8734036
	speed: 0.0446s/iter; left time: 1035.1017s
	iters: 1800, epoch: 10 | loss: 0.3586482
	speed: 0.0467s/iter; left time: 1079.0877s
	iters: 1900, epoch: 10 | loss: 0.3665584
	speed: 0.0477s/iter; left time: 1096.1517s
	iters: 2000, epoch: 10 | loss: 0.4223957
	speed: 0.0440s/iter; left time: 1007.4479s
	iters: 2100, epoch: 10 | loss: 0.5041165
	speed: 0.0465s/iter; left time: 1059.4790s
	iters: 2200, epoch: 10 | loss: 0.3528192
	speed: 0.0446s/iter; left time: 1013.1894s
Epoch: 10 cost time: 101.51577758789062
Epoch: 10, Steps: 2263 | Train Loss: 0.4941740 Vali Loss: 0.4927372 Test Loss: 0.2399933
Validation loss decreased (0.494733 --> 0.492737).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.5465531
	speed: 0.1495s/iter; left time: 3368.1607s
	iters: 200, epoch: 11 | loss: 0.3139344
	speed: 0.0435s/iter; left time: 976.4913s
	iters: 300, epoch: 11 | loss: 0.5700385
	speed: 0.0432s/iter; left time: 964.9275s
	iters: 400, epoch: 11 | loss: 0.4318696
	speed: 0.0460s/iter; left time: 1021.6649s
	iters: 500, epoch: 11 | loss: 0.4642794
	speed: 0.0455s/iter; left time: 1007.2257s
	iters: 600, epoch: 11 | loss: 0.5107639
	speed: 0.0441s/iter; left time: 971.6259s
	iters: 700, epoch: 11 | loss: 1.0562415
	speed: 0.0455s/iter; left time: 997.6394s
	iters: 800, epoch: 11 | loss: 0.3598097
	speed: 0.0462s/iter; left time: 1008.9681s
	iters: 900, epoch: 11 | loss: 0.3383359
	speed: 0.0472s/iter; left time: 1024.6976s
	iters: 1000, epoch: 11 | loss: 0.4238528
	speed: 0.0445s/iter; left time: 962.0645s
	iters: 1100, epoch: 11 | loss: 0.3536110
	speed: 0.0442s/iter; left time: 952.2046s
	iters: 1200, epoch: 11 | loss: 0.4159930
	speed: 0.0460s/iter; left time: 986.4491s
	iters: 1300, epoch: 11 | loss: 0.4433312
	speed: 0.0482s/iter; left time: 1027.6836s
	iters: 1400, epoch: 11 | loss: 0.3861462
	speed: 0.0472s/iter; left time: 1001.7249s
	iters: 1500, epoch: 11 | loss: 0.3750048
	speed: 0.0460s/iter; left time: 972.9945s
	iters: 1600, epoch: 11 | loss: 0.4351299
	speed: 0.0474s/iter; left time: 997.7073s
	iters: 1700, epoch: 11 | loss: 0.4933797
	speed: 0.0421s/iter; left time: 882.1859s
	iters: 1800, epoch: 11 | loss: 0.4675825
	speed: 0.0468s/iter; left time: 975.7757s
	iters: 1900, epoch: 11 | loss: 0.4845622
	speed: 0.0483s/iter; left time: 1001.3012s
	iters: 2000, epoch: 11 | loss: 0.3725519
	speed: 0.0446s/iter; left time: 919.6380s
	iters: 2100, epoch: 11 | loss: 0.2912323
	speed: 0.0466s/iter; left time: 957.2352s
	iters: 2200, epoch: 11 | loss: 0.5355313
	speed: 0.0448s/iter; left time: 914.5490s
Epoch: 11 cost time: 102.39702701568604
Epoch: 11, Steps: 2263 | Train Loss: 0.4935778 Vali Loss: 0.4935270 Test Loss: 0.2399430
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.8311775
	speed: 0.1486s/iter; left time: 3012.7316s
	iters: 200, epoch: 12 | loss: 0.4742372
	speed: 0.0459s/iter; left time: 926.3494s
	iters: 300, epoch: 12 | loss: 0.6004498
	speed: 0.0461s/iter; left time: 925.5529s
	iters: 400, epoch: 12 | loss: 0.4476882
	speed: 0.0453s/iter; left time: 904.0185s
	iters: 500, epoch: 12 | loss: 0.3443586
	speed: 0.0469s/iter; left time: 932.5591s
	iters: 600, epoch: 12 | loss: 0.4990413
	speed: 0.0449s/iter; left time: 887.0030s
	iters: 700, epoch: 12 | loss: 0.2761385
	speed: 0.0474s/iter; left time: 931.9201s
	iters: 800, epoch: 12 | loss: 0.3649215
	speed: 0.0463s/iter; left time: 906.2558s
	iters: 900, epoch: 12 | loss: 0.5136284
	speed: 0.0452s/iter; left time: 879.6710s
	iters: 1000, epoch: 12 | loss: 0.3626722
	speed: 0.0439s/iter; left time: 850.3670s
	iters: 1100, epoch: 12 | loss: 0.4240173
	speed: 0.0461s/iter; left time: 888.8900s
	iters: 1200, epoch: 12 | loss: 0.4727462
	speed: 0.0468s/iter; left time: 897.6467s
	iters: 1300, epoch: 12 | loss: 0.2763756
	speed: 0.0439s/iter; left time: 837.2858s
	iters: 1400, epoch: 12 | loss: 0.3072429
	speed: 0.0436s/iter; left time: 826.3686s
	iters: 1500, epoch: 12 | loss: 0.4635351
	speed: 0.0440s/iter; left time: 830.5286s
	iters: 1600, epoch: 12 | loss: 0.4291623
	speed: 0.0435s/iter; left time: 817.0035s
	iters: 1700, epoch: 12 | loss: 0.8282471
	speed: 0.0457s/iter; left time: 853.4909s
	iters: 1800, epoch: 12 | loss: 0.5245925
	speed: 0.0464s/iter; left time: 860.9729s
	iters: 1900, epoch: 12 | loss: 0.2836239
	speed: 0.0460s/iter; left time: 848.8397s
	iters: 2000, epoch: 12 | loss: 0.3964857
	speed: 0.0446s/iter; left time: 819.8207s
	iters: 2100, epoch: 12 | loss: 0.3936319
	speed: 0.0446s/iter; left time: 815.5972s
	iters: 2200, epoch: 12 | loss: 0.4009645
	speed: 0.0447s/iter; left time: 812.6238s
Epoch: 12 cost time: 101.72492957115173
Epoch: 12, Steps: 2263 | Train Loss: 0.4933502 Vali Loss: 0.4935888 Test Loss: 0.2400706
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.3297285
	speed: 0.1558s/iter; left time: 2804.6695s
	iters: 200, epoch: 13 | loss: 0.5329061
	speed: 0.0451s/iter; left time: 806.6668s
	iters: 300, epoch: 13 | loss: 0.3606223
	speed: 0.0441s/iter; left time: 784.5637s
	iters: 400, epoch: 13 | loss: 1.1143811
	speed: 0.0462s/iter; left time: 818.3954s
	iters: 500, epoch: 13 | loss: 0.5201973
	speed: 0.0482s/iter; left time: 848.2459s
	iters: 600, epoch: 13 | loss: 0.6129672
	speed: 0.0485s/iter; left time: 848.1954s
	iters: 700, epoch: 13 | loss: 0.3486198
	speed: 0.0463s/iter; left time: 805.9644s
	iters: 800, epoch: 13 | loss: 0.2597794
	speed: 0.0478s/iter; left time: 827.2813s
	iters: 900, epoch: 13 | loss: 0.4769245
	speed: 0.0468s/iter; left time: 804.5897s
	iters: 1000, epoch: 13 | loss: 0.2958104
	speed: 0.0450s/iter; left time: 769.3794s
	iters: 1100, epoch: 13 | loss: 0.3147836
	speed: 0.0461s/iter; left time: 784.4397s
	iters: 1200, epoch: 13 | loss: 0.2905993
	speed: 0.0437s/iter; left time: 738.9623s
	iters: 1300, epoch: 13 | loss: 0.4443995
	speed: 0.0452s/iter; left time: 760.2556s
	iters: 1400, epoch: 13 | loss: 0.4535711
	speed: 0.0460s/iter; left time: 769.0036s
	iters: 1500, epoch: 13 | loss: 0.5316116
	speed: 0.0459s/iter; left time: 761.4135s
	iters: 1600, epoch: 13 | loss: 0.3515379
	speed: 0.0459s/iter; left time: 758.3134s
	iters: 1700, epoch: 13 | loss: 0.3634053
	speed: 0.0443s/iter; left time: 727.4755s
	iters: 1800, epoch: 13 | loss: 0.3281477
	speed: 0.0443s/iter; left time: 722.0967s
	iters: 1900, epoch: 13 | loss: 0.3952615
	speed: 0.0455s/iter; left time: 737.8622s
	iters: 2000, epoch: 13 | loss: 0.4393552
	speed: 0.0456s/iter; left time: 734.1974s
	iters: 2100, epoch: 13 | loss: 0.3785529
	speed: 0.0468s/iter; left time: 748.2648s
	iters: 2200, epoch: 13 | loss: 0.6183621
	speed: 0.0417s/iter; left time: 663.6823s
Epoch: 13 cost time: 102.70283699035645
Epoch: 13, Steps: 2263 | Train Loss: 0.4929467 Vali Loss: 0.4929917 Test Loss: 0.2398590
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.3655723
	speed: 0.1519s/iter; left time: 2390.9674s
	iters: 200, epoch: 14 | loss: 0.5119224
	speed: 0.0443s/iter; left time: 693.2902s
	iters: 300, epoch: 14 | loss: 0.3812612
	speed: 0.0433s/iter; left time: 672.3754s
	iters: 400, epoch: 14 | loss: 0.9397941
	speed: 0.0454s/iter; left time: 701.2098s
	iters: 500, epoch: 14 | loss: 0.5920711
	speed: 0.0428s/iter; left time: 655.8976s
	iters: 600, epoch: 14 | loss: 0.5584522
	speed: 0.0456s/iter; left time: 694.7981s
	iters: 700, epoch: 14 | loss: 0.4227463
	speed: 0.0463s/iter; left time: 700.7961s
	iters: 800, epoch: 14 | loss: 0.3191873
	speed: 0.0420s/iter; left time: 631.0801s
	iters: 900, epoch: 14 | loss: 0.4217329
	speed: 0.0463s/iter; left time: 692.4434s
	iters: 1000, epoch: 14 | loss: 0.4043886
	speed: 0.0470s/iter; left time: 698.2483s
	iters: 1100, epoch: 14 | loss: 0.3712103
	speed: 0.0475s/iter; left time: 699.8882s
	iters: 1200, epoch: 14 | loss: 0.3765394
	speed: 0.0478s/iter; left time: 699.4912s
	iters: 1300, epoch: 14 | loss: 0.3866214
	speed: 0.0458s/iter; left time: 665.9054s
	iters: 1400, epoch: 14 | loss: 0.3382498
	speed: 0.0453s/iter; left time: 654.8712s
	iters: 1500, epoch: 14 | loss: 0.3034330
	speed: 0.0444s/iter; left time: 636.1784s
	iters: 1600, epoch: 14 | loss: 0.5065265
	speed: 0.0462s/iter; left time: 658.1257s
	iters: 1700, epoch: 14 | loss: 0.3820641
	speed: 0.0461s/iter; left time: 652.1982s
	iters: 1800, epoch: 14 | loss: 1.4601793
	speed: 0.0430s/iter; left time: 603.8464s
	iters: 1900, epoch: 14 | loss: 0.3556030
	speed: 0.0425s/iter; left time: 592.0741s
	iters: 2000, epoch: 14 | loss: 0.3847254
	speed: 0.0463s/iter; left time: 640.2941s
	iters: 2100, epoch: 14 | loss: 0.3380207
	speed: 0.0481s/iter; left time: 660.6914s
	iters: 2200, epoch: 14 | loss: 0.4770337
	speed: 0.0414s/iter; left time: 564.9222s
Epoch: 14 cost time: 101.0693006515503
Epoch: 14, Steps: 2263 | Train Loss: 0.4928717 Vali Loss: 0.4935581 Test Loss: 0.2399069
EarlyStopping counter: 4 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.4361685
	speed: 0.1446s/iter; left time: 1948.8727s
	iters: 200, epoch: 15 | loss: 0.3357194
	speed: 0.0371s/iter; left time: 496.1047s
	iters: 300, epoch: 15 | loss: 0.3638054
	speed: 0.0427s/iter; left time: 566.9213s
	iters: 400, epoch: 15 | loss: 0.3851054
	speed: 0.0388s/iter; left time: 511.5274s
	iters: 500, epoch: 15 | loss: 1.5844442
	speed: 0.0349s/iter; left time: 456.5704s
	iters: 600, epoch: 15 | loss: 0.3634122
	speed: 0.0349s/iter; left time: 452.7214s
	iters: 700, epoch: 15 | loss: 0.4781156
	speed: 0.0351s/iter; left time: 452.0650s
	iters: 800, epoch: 15 | loss: 0.3794495
	speed: 0.0350s/iter; left time: 447.0046s
	iters: 900, epoch: 15 | loss: 0.4453088
	speed: 0.0353s/iter; left time: 447.4044s
	iters: 1000, epoch: 15 | loss: 0.3669184
	speed: 0.0354s/iter; left time: 445.5125s
	iters: 1100, epoch: 15 | loss: 0.4031120
	speed: 0.0350s/iter; left time: 437.2247s
	iters: 1200, epoch: 15 | loss: 0.3912789
	speed: 0.0350s/iter; left time: 433.4806s
	iters: 1300, epoch: 15 | loss: 0.9771444
	speed: 0.0354s/iter; left time: 434.6479s
	iters: 1400, epoch: 15 | loss: 0.4152888
	speed: 0.0345s/iter; left time: 419.8098s
	iters: 1500, epoch: 15 | loss: 0.2972159
	speed: 0.0330s/iter; left time: 399.0729s
	iters: 1600, epoch: 15 | loss: 0.3373554
	speed: 0.0353s/iter; left time: 423.4449s
	iters: 1700, epoch: 15 | loss: 0.5046193
	speed: 0.0366s/iter; left time: 434.3957s
	iters: 1800, epoch: 15 | loss: 0.2874055
	speed: 0.0370s/iter; left time: 435.4047s
	iters: 1900, epoch: 15 | loss: 0.9704981
	speed: 0.0366s/iter; left time: 428.0076s
	iters: 2000, epoch: 15 | loss: 0.5097495
	speed: 0.0367s/iter; left time: 424.6190s
	iters: 2100, epoch: 15 | loss: 0.3892605
	speed: 0.0365s/iter; left time: 419.3882s
	iters: 2200, epoch: 15 | loss: 0.3827209
	speed: 0.0347s/iter; left time: 394.7846s
Epoch: 15 cost time: 81.35713386535645
Epoch: 15, Steps: 2263 | Train Loss: 0.4930324 Vali Loss: 0.4933865 Test Loss: 0.2399264
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : weather_336_336_DLinear_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed25565<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10204
mse:0.24006205797195435, mae:0.2982901930809021
