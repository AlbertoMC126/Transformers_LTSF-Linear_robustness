Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='DLinear', model_id='traffic_336_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=25565, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_336_96_DLinear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed25565>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11849
val 1661
test 3413
	iters: 100, epoch: 1 | loss: 0.5610352
	speed: 0.4030s/iter; left time: 5924.7532s
	iters: 200, epoch: 1 | loss: 0.5924724
	speed: 0.3877s/iter; left time: 5660.1961s
	iters: 300, epoch: 1 | loss: 0.5310286
	speed: 0.3843s/iter; left time: 5572.9579s
	iters: 400, epoch: 1 | loss: 0.5590419
	speed: 0.3861s/iter; left time: 5559.9896s
	iters: 500, epoch: 1 | loss: 0.5220042
	speed: 0.3830s/iter; left time: 5477.2240s
	iters: 600, epoch: 1 | loss: 0.5616761
	speed: 0.3840s/iter; left time: 5453.3204s
	iters: 700, epoch: 1 | loss: 0.5437683
	speed: 0.3849s/iter; left time: 5427.2055s
Epoch: 1 cost time: 287.02805399894714
Epoch: 1, Steps: 740 | Train Loss: 0.5809979 Vali Loss: 0.8109132 Test Loss: 0.9506411
Validation loss decreased (inf --> 0.810913).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.5676823
	speed: 0.8704s/iter; left time: 12151.8021s
	iters: 200, epoch: 2 | loss: 0.5670958
	speed: 0.3904s/iter; left time: 5412.0061s
	iters: 300, epoch: 2 | loss: 0.5513893
	speed: 0.3872s/iter; left time: 5328.1865s
	iters: 400, epoch: 2 | loss: 0.5597525
	speed: 0.3871s/iter; left time: 5288.7504s
	iters: 500, epoch: 2 | loss: 0.5395692
	speed: 0.3879s/iter; left time: 5259.8843s
	iters: 600, epoch: 2 | loss: 0.5262313
	speed: 0.3852s/iter; left time: 5184.9128s
	iters: 700, epoch: 2 | loss: 0.5848890
	speed: 0.3820s/iter; left time: 5103.9586s
Epoch: 2 cost time: 286.4349875450134
Epoch: 2, Steps: 740 | Train Loss: 0.5734826 Vali Loss: 0.8353867 Test Loss: 0.9673440
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.3674475
	speed: 0.8057s/iter; left time: 10651.7754s
	iters: 200, epoch: 3 | loss: 0.3345871
	speed: 0.3891s/iter; left time: 5104.8593s
	iters: 300, epoch: 3 | loss: 0.3661085
	speed: 0.3888s/iter; left time: 5062.3512s
	iters: 400, epoch: 3 | loss: 0.3405002
	speed: 0.3874s/iter; left time: 5005.6755s
	iters: 500, epoch: 3 | loss: 0.3428510
	speed: 0.3854s/iter; left time: 4941.2139s
	iters: 600, epoch: 3 | loss: 0.3678030
	speed: 0.3851s/iter; left time: 4898.9509s
	iters: 700, epoch: 3 | loss: 0.3521290
	speed: 0.3861s/iter; left time: 4872.5966s
Epoch: 3 cost time: 286.1583626270294
Epoch: 3, Steps: 740 | Train Loss: 0.3530081 Vali Loss: 0.4995726 Test Loss: 0.5971810
Validation loss decreased (0.810913 --> 0.499573).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.3164938
	speed: 0.8666s/iter; left time: 10815.5852s
	iters: 200, epoch: 4 | loss: 0.2452336
	speed: 0.3857s/iter; left time: 4775.0781s
	iters: 300, epoch: 4 | loss: 0.2846628
	speed: 0.3890s/iter; left time: 4777.6249s
	iters: 400, epoch: 4 | loss: 0.2859965
	speed: 0.3904s/iter; left time: 4755.4208s
	iters: 500, epoch: 4 | loss: 0.2823969
	speed: 0.3867s/iter; left time: 4671.2638s
	iters: 600, epoch: 4 | loss: 0.2744040
	speed: 0.3870s/iter; left time: 4636.1521s
	iters: 700, epoch: 4 | loss: 0.2663115
	speed: 0.3870s/iter; left time: 4597.3657s
Epoch: 4 cost time: 286.76283502578735
Epoch: 4, Steps: 740 | Train Loss: 0.2876243 Vali Loss: 0.4155646 Test Loss: 0.5022004
Validation loss decreased (0.499573 --> 0.415565).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.2617934
	speed: 0.8631s/iter; left time: 10133.7785s
	iters: 200, epoch: 5 | loss: 0.2506463
	speed: 0.3869s/iter; left time: 4504.1614s
	iters: 300, epoch: 5 | loss: 0.2435285
	speed: 0.3871s/iter; left time: 4467.2240s
	iters: 400, epoch: 5 | loss: 0.2707893
	speed: 0.3908s/iter; left time: 4471.3596s
	iters: 500, epoch: 5 | loss: 0.2752289
	speed: 0.3917s/iter; left time: 4441.9872s
	iters: 600, epoch: 5 | loss: 0.2152818
	speed: 0.3868s/iter; left time: 4348.1861s
	iters: 700, epoch: 5 | loss: 0.2566221
	speed: 0.3848s/iter; left time: 4287.4895s
Epoch: 5 cost time: 286.8573317527771
Epoch: 5, Steps: 740 | Train Loss: 0.2608141 Vali Loss: 0.3809995 Test Loss: 0.4630338
Validation loss decreased (0.415565 --> 0.381000).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.2882578
	speed: 0.8581s/iter; left time: 9440.1785s
	iters: 200, epoch: 6 | loss: 0.2505602
	speed: 0.3844s/iter; left time: 4190.8692s
	iters: 300, epoch: 6 | loss: 0.2738993
	speed: 0.3865s/iter; left time: 4174.5409s
	iters: 400, epoch: 6 | loss: 0.2413663
	speed: 0.3864s/iter; left time: 4135.0717s
	iters: 500, epoch: 6 | loss: 0.2432121
	speed: 0.3886s/iter; left time: 4119.1466s
	iters: 600, epoch: 6 | loss: 0.2465507
	speed: 0.3880s/iter; left time: 4074.8803s
	iters: 700, epoch: 6 | loss: 0.2636275
	speed: 0.3876s/iter; left time: 4031.2994s
Epoch: 6 cost time: 286.3803405761719
Epoch: 6, Steps: 740 | Train Loss: 0.2472405 Vali Loss: 0.3649375 Test Loss: 0.4454031
Validation loss decreased (0.381000 --> 0.364938).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.2082250
	speed: 0.8597s/iter; left time: 8821.3814s
	iters: 200, epoch: 7 | loss: 0.2398894
	speed: 0.3856s/iter; left time: 3917.6849s
	iters: 300, epoch: 7 | loss: 0.2775412
	speed: 0.3837s/iter; left time: 3860.8413s
	iters: 400, epoch: 7 | loss: 0.2508860
	speed: 0.3827s/iter; left time: 3812.3970s
	iters: 500, epoch: 7 | loss: 0.2604824
	speed: 0.3848s/iter; left time: 3794.7760s
	iters: 600, epoch: 7 | loss: 0.2653383
	speed: 0.3888s/iter; left time: 3795.2778s
	iters: 700, epoch: 7 | loss: 0.2306978
	speed: 0.3908s/iter; left time: 3775.4256s
Epoch: 7 cost time: 286.04978942871094
Epoch: 7, Steps: 740 | Train Loss: 0.2399097 Vali Loss: 0.3560702 Test Loss: 0.4343351
Validation loss decreased (0.364938 --> 0.356070).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.2066189
	speed: 0.8674s/iter; left time: 8258.2196s
	iters: 200, epoch: 8 | loss: 0.2750186
	speed: 0.3843s/iter; left time: 3620.7104s
	iters: 300, epoch: 8 | loss: 0.2224285
	speed: 0.3847s/iter; left time: 3585.5137s
	iters: 400, epoch: 8 | loss: 0.2332252
	speed: 0.3840s/iter; left time: 3540.7952s
	iters: 500, epoch: 8 | loss: 0.2370447
	speed: 0.3847s/iter; left time: 3508.8453s
	iters: 600, epoch: 8 | loss: 0.2345392
	speed: 0.3847s/iter; left time: 3470.5482s
	iters: 700, epoch: 8 | loss: 0.2205669
	speed: 0.3866s/iter; left time: 3449.1496s
Epoch: 8 cost time: 285.334410905838
Epoch: 8, Steps: 740 | Train Loss: 0.2358195 Vali Loss: 0.3513385 Test Loss: 0.4299583
Validation loss decreased (0.356070 --> 0.351338).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.1896013
	speed: 0.8681s/iter; left time: 7623.1219s
	iters: 200, epoch: 9 | loss: 0.2301411
	speed: 0.3865s/iter; left time: 3354.8460s
	iters: 300, epoch: 9 | loss: 0.2193367
	speed: 0.3853s/iter; left time: 3306.1313s
	iters: 400, epoch: 9 | loss: 0.2316361
	speed: 0.3872s/iter; left time: 3283.4335s
	iters: 500, epoch: 9 | loss: 0.2206962
	speed: 0.3863s/iter; left time: 3237.6415s
	iters: 600, epoch: 9 | loss: 0.2591087
	speed: 0.3861s/iter; left time: 3196.9056s
	iters: 700, epoch: 9 | loss: 0.2155979
	speed: 0.3832s/iter; left time: 3135.3594s
Epoch: 9 cost time: 286.0130670070648
Epoch: 9, Steps: 740 | Train Loss: 0.2336208 Vali Loss: 0.3498372 Test Loss: 0.4273416
Validation loss decreased (0.351338 --> 0.349837).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.2293692
	speed: 0.8701s/iter; left time: 6996.7325s
	iters: 200, epoch: 10 | loss: 0.2041934
	speed: 0.3839s/iter; left time: 3048.2385s
	iters: 300, epoch: 10 | loss: 0.2550928
	speed: 0.3839s/iter; left time: 3010.1010s
	iters: 400, epoch: 10 | loss: 0.2595541
	speed: 0.3820s/iter; left time: 2957.4114s
	iters: 500, epoch: 10 | loss: 0.2723705
	speed: 0.3820s/iter; left time: 2919.0152s
	iters: 600, epoch: 10 | loss: 0.2135506
	speed: 0.3807s/iter; left time: 2870.6351s
	iters: 700, epoch: 10 | loss: 0.2175829
	speed: 0.3814s/iter; left time: 2837.9655s
Epoch: 10 cost time: 283.79332160949707
Epoch: 10, Steps: 740 | Train Loss: 0.2323860 Vali Loss: 0.3488100 Test Loss: 0.4267449
Validation loss decreased (0.349837 --> 0.348810).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.2825558
	speed: 0.8672s/iter; left time: 6331.0763s
	iters: 200, epoch: 11 | loss: 0.2009865
	speed: 0.3895s/iter; left time: 2805.0696s
	iters: 300, epoch: 11 | loss: 0.2337762
	speed: 0.3840s/iter; left time: 2727.0276s
	iters: 400, epoch: 11 | loss: 0.2921430
	speed: 0.3823s/iter; left time: 2676.5816s
	iters: 500, epoch: 11 | loss: 0.2514549
	speed: 0.3871s/iter; left time: 2671.6746s
	iters: 600, epoch: 11 | loss: 0.2596020
	speed: 0.3860s/iter; left time: 2625.2911s
	iters: 700, epoch: 11 | loss: 0.2355500
	speed: 0.3814s/iter; left time: 2555.6005s
Epoch: 11 cost time: 285.3090045452118
Epoch: 11, Steps: 740 | Train Loss: 0.2316815 Vali Loss: 0.3488331 Test Loss: 0.4263122
EarlyStopping counter: 1 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.2187008
	speed: 0.8082s/iter; left time: 5302.5887s
	iters: 200, epoch: 12 | loss: 0.2330080
	speed: 0.3835s/iter; left time: 2477.9182s
	iters: 300, epoch: 12 | loss: 0.2241034
	speed: 0.3838s/iter; left time: 2441.2504s
	iters: 400, epoch: 12 | loss: 0.2240661
	speed: 0.3866s/iter; left time: 2420.6338s
	iters: 500, epoch: 12 | loss: 0.2183544
	speed: 0.3840s/iter; left time: 2365.8565s
	iters: 600, epoch: 12 | loss: 0.2320048
	speed: 0.3803s/iter; left time: 2304.9981s
	iters: 700, epoch: 12 | loss: 0.2342192
	speed: 0.3842s/iter; left time: 2290.2946s
Epoch: 12 cost time: 283.66843938827515
Epoch: 12, Steps: 740 | Train Loss: 0.2313543 Vali Loss: 0.3483275 Test Loss: 0.4260487
Validation loss decreased (0.348810 --> 0.348327).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.2716033
	speed: 0.8663s/iter; left time: 5042.8936s
	iters: 200, epoch: 13 | loss: 0.2484352
	speed: 0.3833s/iter; left time: 2193.0196s
	iters: 300, epoch: 13 | loss: 0.2412458
	speed: 0.3854s/iter; left time: 2166.5651s
	iters: 400, epoch: 13 | loss: 0.2019362
	speed: 0.3838s/iter; left time: 2118.7312s
	iters: 500, epoch: 13 | loss: 0.2451602
	speed: 0.3856s/iter; left time: 2090.3878s
	iters: 600, epoch: 13 | loss: 0.2115704
	speed: 0.3848s/iter; left time: 2047.3668s
	iters: 700, epoch: 13 | loss: 0.2375054
	speed: 0.3827s/iter; left time: 1997.9875s
Epoch: 13 cost time: 284.8728003501892
Epoch: 13, Steps: 740 | Train Loss: 0.2311289 Vali Loss: 0.3482953 Test Loss: 0.4259775
Validation loss decreased (0.348327 --> 0.348295).  Saving model ...
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 14 | loss: 0.2362566
	speed: 0.8610s/iter; left time: 4374.5445s
	iters: 200, epoch: 14 | loss: 0.2354249
	speed: 0.3837s/iter; left time: 1911.4190s
	iters: 300, epoch: 14 | loss: 0.2201535
	speed: 0.3783s/iter; left time: 1846.6403s
	iters: 400, epoch: 14 | loss: 0.2124428
	speed: 0.3837s/iter; left time: 1834.2431s
	iters: 500, epoch: 14 | loss: 0.2226460
	speed: 0.3848s/iter; left time: 1801.1732s
	iters: 600, epoch: 14 | loss: 0.2528716
	speed: 0.3857s/iter; left time: 1767.1049s
	iters: 700, epoch: 14 | loss: 0.2407226
	speed: 0.3847s/iter; left time: 1723.9458s
Epoch: 14 cost time: 283.84593439102173
Epoch: 14, Steps: 740 | Train Loss: 0.2310500 Vali Loss: 0.3482675 Test Loss: 0.4259543
Validation loss decreased (0.348295 --> 0.348267).  Saving model ...
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 15 | loss: 0.2332768
	speed: 0.8960s/iter; left time: 3889.5036s
	iters: 200, epoch: 15 | loss: 0.2137588
	speed: 0.4396s/iter; left time: 1864.2277s
	iters: 300, epoch: 15 | loss: 0.2499411
	speed: 0.4030s/iter; left time: 1668.7248s
	iters: 400, epoch: 15 | loss: 0.2319365
	speed: 0.4009s/iter; left time: 1620.1163s
	iters: 500, epoch: 15 | loss: 0.2205468
	speed: 0.4141s/iter; left time: 1631.8982s
	iters: 600, epoch: 15 | loss: 0.2103423
	speed: 0.4082s/iter; left time: 1567.7953s
	iters: 700, epoch: 15 | loss: 0.2203351
	speed: 0.4039s/iter; left time: 1511.0187s
Epoch: 15 cost time: 304.2773768901825
Epoch: 15, Steps: 740 | Train Loss: 0.2309821 Vali Loss: 0.3480717 Test Loss: 0.4259407
Validation loss decreased (0.348267 --> 0.348072).  Saving model ...
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 16 | loss: 0.2394159
	speed: 0.9014s/iter; left time: 3246.0960s
	iters: 200, epoch: 16 | loss: 0.2528788
	speed: 0.4111s/iter; left time: 1439.1263s
	iters: 300, epoch: 16 | loss: 0.2178554
	speed: 0.4142s/iter; left time: 1408.6266s
	iters: 400, epoch: 16 | loss: 0.2524970
	speed: 0.4105s/iter; left time: 1355.0272s
	iters: 500, epoch: 16 | loss: 0.2084451
	speed: 0.4062s/iter; left time: 1300.4031s
	iters: 600, epoch: 16 | loss: 0.2771526
	speed: 0.4110s/iter; left time: 1274.3810s
	iters: 700, epoch: 16 | loss: 0.2107916
	speed: 0.4193s/iter; left time: 1258.1904s
Epoch: 16 cost time: 304.6452040672302
Epoch: 16, Steps: 740 | Train Loss: 0.2309782 Vali Loss: 0.3484402 Test Loss: 0.4259395
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 17 | loss: 0.2095284
	speed: 0.8366s/iter; left time: 2393.4521s
	iters: 200, epoch: 17 | loss: 0.2319467
	speed: 0.4033s/iter; left time: 1113.5632s
	iters: 300, epoch: 17 | loss: 0.2092116
	speed: 0.4057s/iter; left time: 1079.5792s
	iters: 400, epoch: 17 | loss: 0.2330750
	speed: 0.4060s/iter; left time: 1039.8608s
	iters: 500, epoch: 17 | loss: 0.2376729
	speed: 0.4039s/iter; left time: 993.9656s
	iters: 600, epoch: 17 | loss: 0.2352338
	speed: 0.4075s/iter; left time: 962.0651s
	iters: 700, epoch: 17 | loss: 0.2635150
	speed: 0.4077s/iter; left time: 921.8385s
Epoch: 17 cost time: 299.1355128288269
Epoch: 17, Steps: 740 | Train Loss: 0.2309140 Vali Loss: 0.3482619 Test Loss: 0.4259382
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 18 | loss: 0.2253136
	speed: 0.8305s/iter; left time: 1761.3879s
	iters: 200, epoch: 18 | loss: 0.2722496
	speed: 0.3913s/iter; left time: 790.7432s
	iters: 300, epoch: 18 | loss: 0.2067086
	speed: 0.4016s/iter; left time: 771.4788s
	iters: 400, epoch: 18 | loss: 0.2355478
	speed: 0.3960s/iter; left time: 721.0449s
	iters: 500, epoch: 18 | loss: 0.2480327
	speed: 0.3932s/iter; left time: 676.6909s
	iters: 600, epoch: 18 | loss: 0.2193078
	speed: 0.3914s/iter; left time: 634.4674s
	iters: 700, epoch: 18 | loss: 0.2186130
	speed: 0.3915s/iter; left time: 595.4536s
Epoch: 18 cost time: 292.3642737865448
Epoch: 18, Steps: 740 | Train Loss: 0.2309120 Vali Loss: 0.3481326 Test Loss: 0.4259379
EarlyStopping counter: 3 out of 5
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 19 | loss: 0.2362846
	speed: 0.8487s/iter; left time: 1172.0036s
	iters: 200, epoch: 19 | loss: 0.2522198
	speed: 0.4005s/iter; left time: 513.0565s
	iters: 300, epoch: 19 | loss: 0.2148074
	speed: 0.4023s/iter; left time: 475.0662s
	iters: 400, epoch: 19 | loss: 0.2394042
	speed: 0.4030s/iter; left time: 435.6422s
	iters: 500, epoch: 19 | loss: 0.2127668
	speed: 0.4001s/iter; left time: 392.4860s
	iters: 600, epoch: 19 | loss: 0.2106582
	speed: 0.4011s/iter; left time: 353.3252s
	iters: 700, epoch: 19 | loss: 0.2461567
	speed: 0.4062s/iter; left time: 317.2449s
Epoch: 19 cost time: 299.13313245773315
Epoch: 19, Steps: 740 | Train Loss: 0.2309014 Vali Loss: 0.3486286 Test Loss: 0.4259375
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 20 | loss: 0.2453566
	speed: 0.8610s/iter; left time: 551.8876s
	iters: 200, epoch: 20 | loss: 0.2157521
	speed: 0.3968s/iter; left time: 214.6693s
	iters: 300, epoch: 20 | loss: 0.2168812
	speed: 0.4001s/iter; left time: 176.4224s
	iters: 400, epoch: 20 | loss: 0.2344674
	speed: 0.4092s/iter; left time: 139.5409s
	iters: 500, epoch: 20 | loss: 0.2473812
	speed: 0.4012s/iter; left time: 96.6888s
	iters: 600, epoch: 20 | loss: 0.2775677
	speed: 0.3898s/iter; left time: 54.9644s
	iters: 700, epoch: 20 | loss: 0.2162842
	speed: 0.3884s/iter; left time: 15.9245s
Epoch: 20 cost time: 295.3054573535919
Epoch: 20, Steps: 740 | Train Loss: 0.2309037 Vali Loss: 0.3486260 Test Loss: 0.4259373
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : traffic_336_96_DLinear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed25565<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3413
mse:0.4261966347694397, mae:0.2983993887901306
