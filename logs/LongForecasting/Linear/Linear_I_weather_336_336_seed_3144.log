Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='Linear', model_id='weather_336_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=336, root_path='./dataset/', save_pred_values=False, seed=3144, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : weather_336_336_Linear_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3144>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36216
val 4935
test 10204
	iters: 100, epoch: 1 | loss: 0.6168376
	speed: 0.0241s/iter; left time: 1089.5618s
	iters: 200, epoch: 1 | loss: 0.5918489
	speed: 0.0245s/iter; left time: 1106.2083s
	iters: 300, epoch: 1 | loss: 0.6712499
	speed: 0.0244s/iter; left time: 1098.0120s
	iters: 400, epoch: 1 | loss: 1.2406453
	speed: 0.0246s/iter; left time: 1105.1934s
	iters: 500, epoch: 1 | loss: 0.7952517
	speed: 0.0250s/iter; left time: 1118.1042s
	iters: 600, epoch: 1 | loss: 1.1456186
	speed: 0.0242s/iter; left time: 1081.7987s
	iters: 700, epoch: 1 | loss: 0.5961521
	speed: 0.0244s/iter; left time: 1087.2606s
	iters: 800, epoch: 1 | loss: 0.9283180
	speed: 0.0242s/iter; left time: 1078.0230s
	iters: 900, epoch: 1 | loss: 2.4633484
	speed: 0.0248s/iter; left time: 1101.0558s
	iters: 1000, epoch: 1 | loss: 0.5852433
	speed: 0.0246s/iter; left time: 1090.7602s
	iters: 1100, epoch: 1 | loss: 0.4251122
	speed: 0.0245s/iter; left time: 1083.9125s
	iters: 1200, epoch: 1 | loss: 1.1189998
	speed: 0.0246s/iter; left time: 1083.5055s
	iters: 1300, epoch: 1 | loss: 0.6635804
	speed: 0.0250s/iter; left time: 1100.3786s
	iters: 1400, epoch: 1 | loss: 0.4156103
	speed: 0.0249s/iter; left time: 1093.5299s
	iters: 1500, epoch: 1 | loss: 0.4226460
	speed: 0.0244s/iter; left time: 1066.5160s
	iters: 1600, epoch: 1 | loss: 0.4810244
	speed: 0.0246s/iter; left time: 1073.1977s
	iters: 1700, epoch: 1 | loss: 0.4437144
	speed: 0.0245s/iter; left time: 1067.2761s
	iters: 1800, epoch: 1 | loss: 0.4307566
	speed: 0.0245s/iter; left time: 1063.5406s
	iters: 1900, epoch: 1 | loss: 0.5854502
	speed: 0.0248s/iter; left time: 1074.8025s
	iters: 2000, epoch: 1 | loss: 0.5985665
	speed: 0.0246s/iter; left time: 1066.1700s
	iters: 2100, epoch: 1 | loss: 0.4946515
	speed: 0.0239s/iter; left time: 1030.3993s
	iters: 2200, epoch: 1 | loss: 0.6032529
	speed: 0.0248s/iter; left time: 1065.8027s
Epoch: 1 cost time: 55.57119297981262
Epoch: 1, Steps: 2263 | Train Loss: 1.2750330 Vali Loss: 0.6933577 Test Loss: 0.3215726
Validation loss decreased (inf --> 0.693358).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.4837515
	speed: 0.0800s/iter; left time: 3429.7604s
	iters: 200, epoch: 2 | loss: 0.5564406
	speed: 0.0242s/iter; left time: 1034.2966s
	iters: 300, epoch: 2 | loss: 1.0965155
	speed: 0.0249s/iter; left time: 1061.4640s
	iters: 400, epoch: 2 | loss: 0.4857525
	speed: 0.0240s/iter; left time: 1022.2913s
	iters: 500, epoch: 2 | loss: 2.8334224
	speed: 0.0242s/iter; left time: 1028.3954s
	iters: 600, epoch: 2 | loss: 6.1094646
	speed: 0.0243s/iter; left time: 1028.6435s
	iters: 700, epoch: 2 | loss: 0.5678511
	speed: 0.0243s/iter; left time: 1027.6415s
	iters: 800, epoch: 2 | loss: 0.4914082
	speed: 0.0244s/iter; left time: 1030.5874s
	iters: 900, epoch: 2 | loss: 0.9107388
	speed: 0.0242s/iter; left time: 1019.7259s
	iters: 1000, epoch: 2 | loss: 0.4915368
	speed: 0.0248s/iter; left time: 1039.7834s
	iters: 1100, epoch: 2 | loss: 0.5509204
	speed: 0.0241s/iter; left time: 1008.3883s
	iters: 1200, epoch: 2 | loss: 0.5667455
	speed: 0.0242s/iter; left time: 1011.1411s
	iters: 1300, epoch: 2 | loss: 1.5687995
	speed: 0.0247s/iter; left time: 1030.3758s
	iters: 1400, epoch: 2 | loss: 0.5715114
	speed: 0.0243s/iter; left time: 1012.0592s
	iters: 1500, epoch: 2 | loss: 0.4703408
	speed: 0.0238s/iter; left time: 988.2263s
	iters: 1600, epoch: 2 | loss: 0.3991350
	speed: 0.0246s/iter; left time: 1016.4951s
	iters: 1700, epoch: 2 | loss: 0.5967686
	speed: 0.0241s/iter; left time: 994.8010s
	iters: 1800, epoch: 2 | loss: 0.6875941
	speed: 0.0246s/iter; left time: 1012.0755s
	iters: 1900, epoch: 2 | loss: 0.6219546
	speed: 0.0247s/iter; left time: 1014.3811s
	iters: 2000, epoch: 2 | loss: 0.6544516
	speed: 0.0246s/iter; left time: 1007.0247s
	iters: 2100, epoch: 2 | loss: 0.5422762
	speed: 0.0244s/iter; left time: 996.3732s
	iters: 2200, epoch: 2 | loss: 0.6248338
	speed: 0.0242s/iter; left time: 986.7183s
Epoch: 2 cost time: 55.00136876106262
Epoch: 2, Steps: 2263 | Train Loss: 1.0315161 Vali Loss: 0.6816924 Test Loss: 0.3071493
Validation loss decreased (0.693358 --> 0.681692).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.3936795
	speed: 0.0797s/iter; left time: 3239.2759s
	iters: 200, epoch: 3 | loss: 0.4572157
	speed: 0.0241s/iter; left time: 976.1968s
	iters: 300, epoch: 3 | loss: 0.9627652
	speed: 0.0248s/iter; left time: 1002.5011s
	iters: 400, epoch: 3 | loss: 0.5910396
	speed: 0.0244s/iter; left time: 984.8653s
	iters: 500, epoch: 3 | loss: 0.4582556
	speed: 0.0246s/iter; left time: 990.0511s
	iters: 600, epoch: 3 | loss: 1.0931578
	speed: 0.0244s/iter; left time: 978.7472s
	iters: 700, epoch: 3 | loss: 0.3494067
	speed: 0.0240s/iter; left time: 960.0290s
	iters: 800, epoch: 3 | loss: 0.4352893
	speed: 0.0244s/iter; left time: 973.0472s
	iters: 900, epoch: 3 | loss: 0.5653307
	speed: 0.0249s/iter; left time: 991.3307s
	iters: 1000, epoch: 3 | loss: 0.9897031
	speed: 0.0238s/iter; left time: 945.9559s
	iters: 1100, epoch: 3 | loss: 1.9789019
	speed: 0.0242s/iter; left time: 958.6069s
	iters: 1200, epoch: 3 | loss: 2.0236590
	speed: 0.0246s/iter; left time: 970.7735s
	iters: 1300, epoch: 3 | loss: 0.4301582
	speed: 0.0241s/iter; left time: 948.7355s
	iters: 1400, epoch: 3 | loss: 0.9293498
	speed: 0.0248s/iter; left time: 976.5847s
	iters: 1500, epoch: 3 | loss: 1.0343530
	speed: 0.0246s/iter; left time: 963.2787s
	iters: 1600, epoch: 3 | loss: 0.6326668
	speed: 0.0242s/iter; left time: 947.9572s
	iters: 1700, epoch: 3 | loss: 1.0573714
	speed: 0.0243s/iter; left time: 947.8914s
	iters: 1800, epoch: 3 | loss: 0.4409629
	speed: 0.0245s/iter; left time: 953.0813s
	iters: 1900, epoch: 3 | loss: 0.4489248
	speed: 0.0242s/iter; left time: 940.8140s
	iters: 2000, epoch: 3 | loss: 0.5367961
	speed: 0.0242s/iter; left time: 936.9084s
	iters: 2100, epoch: 3 | loss: 0.3908320
	speed: 0.0248s/iter; left time: 959.3014s
	iters: 2200, epoch: 3 | loss: 0.4034298
	speed: 0.0243s/iter; left time: 937.8514s
Epoch: 3 cost time: 55.034610748291016
Epoch: 3, Steps: 2263 | Train Loss: 0.7460989 Vali Loss: 0.5833939 Test Loss: 0.2882103
Validation loss decreased (0.681692 --> 0.583394).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.4721600
	speed: 0.0792s/iter; left time: 3040.0841s
	iters: 200, epoch: 4 | loss: 0.4651674
	speed: 0.0240s/iter; left time: 918.7513s
	iters: 300, epoch: 4 | loss: 0.5976785
	speed: 0.0242s/iter; left time: 922.1429s
	iters: 400, epoch: 4 | loss: 0.3587732
	speed: 0.0241s/iter; left time: 918.5023s
	iters: 500, epoch: 4 | loss: 0.4690804
	speed: 0.0245s/iter; left time: 929.1139s
	iters: 600, epoch: 4 | loss: 1.0464509
	speed: 0.0249s/iter; left time: 944.2667s
	iters: 700, epoch: 4 | loss: 0.4967956
	speed: 0.0247s/iter; left time: 932.7209s
	iters: 800, epoch: 4 | loss: 0.3581872
	speed: 0.0245s/iter; left time: 923.7534s
	iters: 900, epoch: 4 | loss: 0.6817858
	speed: 0.0241s/iter; left time: 905.9372s
	iters: 1000, epoch: 4 | loss: 0.5750074
	speed: 0.0241s/iter; left time: 902.9997s
	iters: 1100, epoch: 4 | loss: 0.3995073
	speed: 0.0245s/iter; left time: 914.5055s
	iters: 1200, epoch: 4 | loss: 0.8940265
	speed: 0.0246s/iter; left time: 916.5228s
	iters: 1300, epoch: 4 | loss: 0.4353820
	speed: 0.0239s/iter; left time: 889.3582s
	iters: 1400, epoch: 4 | loss: 0.3266544
	speed: 0.0247s/iter; left time: 913.9107s
	iters: 1500, epoch: 4 | loss: 0.2969171
	speed: 0.0247s/iter; left time: 913.6479s
	iters: 1600, epoch: 4 | loss: 0.5783828
	speed: 0.0243s/iter; left time: 896.0592s
	iters: 1700, epoch: 4 | loss: 0.9847731
	speed: 0.0245s/iter; left time: 901.3514s
	iters: 1800, epoch: 4 | loss: 0.9079357
	speed: 0.0244s/iter; left time: 893.2005s
	iters: 1900, epoch: 4 | loss: 0.4548314
	speed: 0.0241s/iter; left time: 882.5812s
	iters: 2000, epoch: 4 | loss: 0.5747182
	speed: 0.0244s/iter; left time: 890.8176s
	iters: 2100, epoch: 4 | loss: 0.3553861
	speed: 0.0248s/iter; left time: 901.3692s
	iters: 2200, epoch: 4 | loss: 0.4374533
	speed: 0.0237s/iter; left time: 858.8197s
Epoch: 4 cost time: 55.00191116333008
Epoch: 4, Steps: 2263 | Train Loss: 0.6022336 Vali Loss: 0.5167264 Test Loss: 0.2458082
Validation loss decreased (0.583394 --> 0.516726).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.3731770
	speed: 0.0785s/iter; left time: 2832.8814s
	iters: 200, epoch: 5 | loss: 0.6682351
	speed: 0.0244s/iter; left time: 880.1935s
	iters: 300, epoch: 5 | loss: 0.3502272
	speed: 0.0249s/iter; left time: 892.7596s
	iters: 400, epoch: 5 | loss: 0.9016886
	speed: 0.0250s/iter; left time: 894.6218s
	iters: 500, epoch: 5 | loss: 0.3646700
	speed: 0.0240s/iter; left time: 857.1260s
	iters: 600, epoch: 5 | loss: 0.8749141
	speed: 0.0241s/iter; left time: 858.1150s
	iters: 700, epoch: 5 | loss: 0.9868839
	speed: 0.0238s/iter; left time: 845.2635s
	iters: 800, epoch: 5 | loss: 0.9043227
	speed: 0.0239s/iter; left time: 846.1805s
	iters: 900, epoch: 5 | loss: 0.3025792
	speed: 0.0244s/iter; left time: 860.5668s
	iters: 1000, epoch: 5 | loss: 0.4772758
	speed: 0.0244s/iter; left time: 857.7286s
	iters: 1100, epoch: 5 | loss: 0.3633704
	speed: 0.0244s/iter; left time: 855.0703s
	iters: 1200, epoch: 5 | loss: 0.8522081
	speed: 0.0249s/iter; left time: 871.3238s
	iters: 1300, epoch: 5 | loss: 0.4252873
	speed: 0.0242s/iter; left time: 846.4363s
	iters: 1400, epoch: 5 | loss: 0.4661126
	speed: 0.0251s/iter; left time: 872.1051s
	iters: 1500, epoch: 5 | loss: 0.4007313
	speed: 0.0245s/iter; left time: 849.5274s
	iters: 1600, epoch: 5 | loss: 0.3776254
	speed: 0.0245s/iter; left time: 847.0625s
	iters: 1700, epoch: 5 | loss: 0.4401388
	speed: 0.0245s/iter; left time: 845.5258s
	iters: 1800, epoch: 5 | loss: 0.9349529
	speed: 0.0248s/iter; left time: 854.5773s
	iters: 1900, epoch: 5 | loss: 0.6242633
	speed: 0.0244s/iter; left time: 835.4730s
	iters: 2000, epoch: 5 | loss: 0.3571555
	speed: 0.0252s/iter; left time: 862.8071s
	iters: 2100, epoch: 5 | loss: 0.2966826
	speed: 0.0244s/iter; left time: 830.7565s
	iters: 2200, epoch: 5 | loss: 1.1420312
	speed: 0.0243s/iter; left time: 824.7311s
Epoch: 5 cost time: 55.10335898399353
Epoch: 5, Steps: 2263 | Train Loss: 0.5626353 Vali Loss: 0.5018774 Test Loss: 0.2559732
Validation loss decreased (0.516726 --> 0.501877).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.8855427
	speed: 0.0798s/iter; left time: 2700.5982s
	iters: 200, epoch: 6 | loss: 0.4327954
	speed: 0.0244s/iter; left time: 823.3303s
	iters: 300, epoch: 6 | loss: 0.3935358
	speed: 0.0248s/iter; left time: 833.1688s
	iters: 400, epoch: 6 | loss: 0.4286803
	speed: 0.0250s/iter; left time: 837.3639s
	iters: 500, epoch: 6 | loss: 0.3874816
	speed: 0.0241s/iter; left time: 804.4074s
	iters: 600, epoch: 6 | loss: 0.6296816
	speed: 0.0244s/iter; left time: 813.3114s
	iters: 700, epoch: 6 | loss: 0.4597445
	speed: 0.0245s/iter; left time: 813.5150s
	iters: 800, epoch: 6 | loss: 0.3401396
	speed: 0.0245s/iter; left time: 813.0921s
	iters: 900, epoch: 6 | loss: 0.9434956
	speed: 0.0246s/iter; left time: 813.4613s
	iters: 1000, epoch: 6 | loss: 0.4748793
	speed: 0.0246s/iter; left time: 811.1018s
	iters: 1100, epoch: 6 | loss: 0.4695394
	speed: 0.0241s/iter; left time: 791.7066s
	iters: 1200, epoch: 6 | loss: 0.4080189
	speed: 0.0246s/iter; left time: 807.1423s
	iters: 1300, epoch: 6 | loss: 0.5325780
	speed: 0.0242s/iter; left time: 791.2993s
	iters: 1400, epoch: 6 | loss: 0.4886370
	speed: 0.0246s/iter; left time: 800.4867s
	iters: 1500, epoch: 6 | loss: 0.7019135
	speed: 0.0250s/iter; left time: 811.6930s
	iters: 1600, epoch: 6 | loss: 0.4286419
	speed: 0.0245s/iter; left time: 792.5035s
	iters: 1700, epoch: 6 | loss: 0.9686298
	speed: 0.0246s/iter; left time: 791.8038s
	iters: 1800, epoch: 6 | loss: 0.9396390
	speed: 0.0248s/iter; left time: 797.7968s
	iters: 1900, epoch: 6 | loss: 0.3961913
	speed: 0.0245s/iter; left time: 786.3937s
	iters: 2000, epoch: 6 | loss: 0.6342915
	speed: 0.0247s/iter; left time: 788.6841s
	iters: 2100, epoch: 6 | loss: 0.5341624
	speed: 0.0242s/iter; left time: 769.7659s
	iters: 2200, epoch: 6 | loss: 0.3348583
	speed: 0.0246s/iter; left time: 780.7641s
Epoch: 6 cost time: 55.18054914474487
Epoch: 6, Steps: 2263 | Train Loss: 0.5463354 Vali Loss: 0.5030320 Test Loss: 0.2482935
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.4273582
	speed: 0.0781s/iter; left time: 2467.2698s
	iters: 200, epoch: 7 | loss: 0.4410410
	speed: 0.0240s/iter; left time: 754.3941s
	iters: 300, epoch: 7 | loss: 0.5883315
	speed: 0.0241s/iter; left time: 755.3177s
	iters: 400, epoch: 7 | loss: 0.3451760
	speed: 0.0243s/iter; left time: 760.1302s
	iters: 500, epoch: 7 | loss: 0.5261472
	speed: 0.0246s/iter; left time: 766.5777s
	iters: 600, epoch: 7 | loss: 0.4266652
	speed: 0.0242s/iter; left time: 753.7460s
	iters: 700, epoch: 7 | loss: 0.4120130
	speed: 0.0242s/iter; left time: 750.7197s
	iters: 800, epoch: 7 | loss: 0.8585609
	speed: 0.0241s/iter; left time: 743.8462s
	iters: 900, epoch: 7 | loss: 0.3823762
	speed: 0.0240s/iter; left time: 739.5249s
	iters: 1000, epoch: 7 | loss: 0.8425455
	speed: 0.0242s/iter; left time: 742.7817s
	iters: 1100, epoch: 7 | loss: 0.9342914
	speed: 0.0243s/iter; left time: 742.8142s
	iters: 1200, epoch: 7 | loss: 0.3378990
	speed: 0.0241s/iter; left time: 733.1221s
	iters: 1300, epoch: 7 | loss: 0.6735171
	speed: 0.0244s/iter; left time: 741.9574s
	iters: 1400, epoch: 7 | loss: 0.4494179
	speed: 0.0241s/iter; left time: 729.5754s
	iters: 1500, epoch: 7 | loss: 0.3868575
	speed: 0.0247s/iter; left time: 746.9514s
	iters: 1600, epoch: 7 | loss: 0.5346145
	speed: 0.0242s/iter; left time: 727.8993s
	iters: 1700, epoch: 7 | loss: 0.3824128
	speed: 0.0243s/iter; left time: 727.9817s
	iters: 1800, epoch: 7 | loss: 0.3944451
	speed: 0.0245s/iter; left time: 732.5292s
	iters: 1900, epoch: 7 | loss: 0.3353209
	speed: 0.0238s/iter; left time: 707.8677s
	iters: 2000, epoch: 7 | loss: 0.3640106
	speed: 0.0242s/iter; left time: 718.0418s
	iters: 2100, epoch: 7 | loss: 0.3901239
	speed: 0.0243s/iter; left time: 718.1303s
	iters: 2200, epoch: 7 | loss: 0.4806186
	speed: 0.0242s/iter; left time: 714.4895s
Epoch: 7 cost time: 54.52286219596863
Epoch: 7, Steps: 2263 | Train Loss: 0.5385235 Vali Loss: 0.5013310 Test Loss: 0.2464746
Validation loss decreased (0.501877 --> 0.501331).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.4729050
	speed: 0.0784s/iter; left time: 2299.3048s
	iters: 200, epoch: 8 | loss: 0.3732051
	speed: 0.0238s/iter; left time: 696.6552s
	iters: 300, epoch: 8 | loss: 0.5617275
	speed: 0.0244s/iter; left time: 710.5212s
	iters: 400, epoch: 8 | loss: 0.3969947
	speed: 0.0244s/iter; left time: 707.9644s
	iters: 500, epoch: 8 | loss: 0.3667071
	speed: 0.0248s/iter; left time: 716.7940s
	iters: 600, epoch: 8 | loss: 0.3865463
	speed: 0.0245s/iter; left time: 704.9451s
	iters: 700, epoch: 8 | loss: 0.8095707
	speed: 0.0246s/iter; left time: 705.7527s
	iters: 800, epoch: 8 | loss: 1.4696674
	speed: 0.0243s/iter; left time: 695.8622s
	iters: 900, epoch: 8 | loss: 0.4223157
	speed: 0.0242s/iter; left time: 689.6371s
	iters: 1000, epoch: 8 | loss: 0.3963792
	speed: 0.0247s/iter; left time: 700.8181s
	iters: 1100, epoch: 8 | loss: 0.4065911
	speed: 0.0249s/iter; left time: 705.7364s
	iters: 1200, epoch: 8 | loss: 0.3154783
	speed: 0.0252s/iter; left time: 712.3856s
	iters: 1300, epoch: 8 | loss: 0.3313724
	speed: 0.0241s/iter; left time: 676.6625s
	iters: 1400, epoch: 8 | loss: 0.3989983
	speed: 0.0235s/iter; left time: 657.6891s
	iters: 1500, epoch: 8 | loss: 1.4161036
	speed: 0.0251s/iter; left time: 701.0987s
	iters: 1600, epoch: 8 | loss: 0.3796731
	speed: 0.0245s/iter; left time: 680.5354s
	iters: 1700, epoch: 8 | loss: 0.5459816
	speed: 0.0242s/iter; left time: 671.9813s
	iters: 1800, epoch: 8 | loss: 0.4246506
	speed: 0.0247s/iter; left time: 681.8847s
	iters: 1900, epoch: 8 | loss: 0.8637375
	speed: 0.0243s/iter; left time: 668.6249s
	iters: 2000, epoch: 8 | loss: 0.4423915
	speed: 0.0242s/iter; left time: 662.8873s
	iters: 2100, epoch: 8 | loss: 0.4040833
	speed: 0.0245s/iter; left time: 670.4850s
	iters: 2200, epoch: 8 | loss: 0.3649843
	speed: 0.0247s/iter; left time: 672.1439s
Epoch: 8 cost time: 54.973276138305664
Epoch: 8, Steps: 2263 | Train Loss: 0.5343328 Vali Loss: 0.4947709 Test Loss: 0.2379505
Validation loss decreased (0.501331 --> 0.494771).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.8979495
	speed: 0.0791s/iter; left time: 2140.0620s
	iters: 200, epoch: 9 | loss: 0.3853387
	speed: 0.0234s/iter; left time: 631.7245s
	iters: 300, epoch: 9 | loss: 0.4656572
	speed: 0.0256s/iter; left time: 688.2444s
	iters: 400, epoch: 9 | loss: 0.3754041
	speed: 0.0260s/iter; left time: 694.8086s
	iters: 500, epoch: 9 | loss: 0.4021409
	speed: 0.0253s/iter; left time: 673.5399s
	iters: 600, epoch: 9 | loss: 0.3307882
	speed: 0.0249s/iter; left time: 662.4066s
	iters: 700, epoch: 9 | loss: 0.4093359
	speed: 0.0249s/iter; left time: 657.5676s
	iters: 800, epoch: 9 | loss: 0.3405432
	speed: 0.0261s/iter; left time: 688.2896s
	iters: 900, epoch: 9 | loss: 1.4597863
	speed: 0.0249s/iter; left time: 654.9063s
	iters: 1000, epoch: 9 | loss: 0.3235353
	speed: 0.0248s/iter; left time: 649.6396s
	iters: 1100, epoch: 9 | loss: 0.8507550
	speed: 0.0241s/iter; left time: 628.5660s
	iters: 1200, epoch: 9 | loss: 0.5441467
	speed: 0.0222s/iter; left time: 576.2034s
	iters: 1300, epoch: 9 | loss: 0.4324785
	speed: 0.0229s/iter; left time: 591.7062s
	iters: 1400, epoch: 9 | loss: 0.3464563
	speed: 0.0237s/iter; left time: 611.2041s
	iters: 1500, epoch: 9 | loss: 0.3944490
	speed: 0.0218s/iter; left time: 559.5973s
	iters: 1600, epoch: 9 | loss: 0.4822305
	speed: 0.0223s/iter; left time: 569.4182s
	iters: 1700, epoch: 9 | loss: 0.4052117
	speed: 0.0232s/iter; left time: 590.6498s
	iters: 1800, epoch: 9 | loss: 0.5635811
	speed: 0.0227s/iter; left time: 574.9535s
	iters: 1900, epoch: 9 | loss: 0.4520030
	speed: 0.0233s/iter; left time: 588.7042s
	iters: 2000, epoch: 9 | loss: 1.1285039
	speed: 0.0254s/iter; left time: 640.0629s
	iters: 2100, epoch: 9 | loss: 0.4844905
	speed: 0.0259s/iter; left time: 650.0291s
	iters: 2200, epoch: 9 | loss: 0.8784410
	speed: 0.0248s/iter; left time: 619.9847s
Epoch: 9 cost time: 54.29812574386597
Epoch: 9, Steps: 2263 | Train Loss: 0.5326697 Vali Loss: 0.4949689 Test Loss: 0.2413791
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 1.0717098
	speed: 0.0761s/iter; left time: 1885.8175s
	iters: 200, epoch: 10 | loss: 0.5733638
	speed: 0.0227s/iter; left time: 561.7112s
	iters: 300, epoch: 10 | loss: 0.4321187
	speed: 0.0215s/iter; left time: 528.4958s
	iters: 400, epoch: 10 | loss: 0.4106682
	speed: 0.0235s/iter; left time: 576.5236s
	iters: 500, epoch: 10 | loss: 0.3752564
	speed: 0.0225s/iter; left time: 547.7105s
	iters: 600, epoch: 10 | loss: 0.4244554
	speed: 0.0214s/iter; left time: 519.1809s
	iters: 700, epoch: 10 | loss: 0.2750495
	speed: 0.0240s/iter; left time: 580.4645s
	iters: 800, epoch: 10 | loss: 0.8300999
	speed: 0.0249s/iter; left time: 600.7614s
	iters: 900, epoch: 10 | loss: 10.7731810
	speed: 0.0245s/iter; left time: 586.9435s
	iters: 1000, epoch: 10 | loss: 0.4980400
	speed: 0.0235s/iter; left time: 561.0061s
	iters: 1100, epoch: 10 | loss: 0.2624325
	speed: 0.0235s/iter; left time: 559.8144s
	iters: 1200, epoch: 10 | loss: 0.3461016
	speed: 0.0216s/iter; left time: 512.4222s
	iters: 1300, epoch: 10 | loss: 0.4092984
	speed: 0.0233s/iter; left time: 548.5838s
	iters: 1400, epoch: 10 | loss: 0.3641865
	speed: 0.0232s/iter; left time: 545.7299s
	iters: 1500, epoch: 10 | loss: 0.3567240
	speed: 0.0228s/iter; left time: 533.7598s
	iters: 1600, epoch: 10 | loss: 0.2760340
	speed: 0.0247s/iter; left time: 575.6275s
	iters: 1700, epoch: 10 | loss: 0.4658214
	speed: 0.0253s/iter; left time: 587.0492s
	iters: 1800, epoch: 10 | loss: 0.4205884
	speed: 0.0236s/iter; left time: 546.1131s
	iters: 1900, epoch: 10 | loss: 0.3920074
	speed: 0.0235s/iter; left time: 540.3301s
	iters: 2000, epoch: 10 | loss: 0.3859752
	speed: 0.0234s/iter; left time: 535.9786s
	iters: 2100, epoch: 10 | loss: 0.4047727
	speed: 0.0233s/iter; left time: 531.4273s
	iters: 2200, epoch: 10 | loss: 0.9499938
	speed: 0.0210s/iter; left time: 477.4755s
Epoch: 10 cost time: 52.11466145515442
Epoch: 10, Steps: 2263 | Train Loss: 0.5316344 Vali Loss: 0.4954439 Test Loss: 0.2399730
EarlyStopping counter: 2 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.3897024
	speed: 0.0732s/iter; left time: 1648.1535s
	iters: 200, epoch: 11 | loss: 0.3696342
	speed: 0.0211s/iter; left time: 474.0138s
	iters: 300, epoch: 11 | loss: 0.5790662
	speed: 0.0252s/iter; left time: 562.4531s
	iters: 400, epoch: 11 | loss: 0.3982666
	speed: 0.0214s/iter; left time: 476.6694s
	iters: 500, epoch: 11 | loss: 0.4195728
	speed: 0.0242s/iter; left time: 535.9942s
	iters: 600, epoch: 11 | loss: 0.4424251
	speed: 0.0235s/iter; left time: 518.1364s
	iters: 700, epoch: 11 | loss: 0.3599916
	speed: 0.0236s/iter; left time: 518.5771s
	iters: 800, epoch: 11 | loss: 0.4164026
	speed: 0.0246s/iter; left time: 536.9394s
	iters: 900, epoch: 11 | loss: 0.4648363
	speed: 0.0243s/iter; left time: 527.7192s
	iters: 1000, epoch: 11 | loss: 0.4549564
	speed: 0.0228s/iter; left time: 494.1617s
	iters: 1100, epoch: 11 | loss: 0.4177187
	speed: 0.0246s/iter; left time: 530.4207s
	iters: 1200, epoch: 11 | loss: 0.9534811
	speed: 0.0217s/iter; left time: 464.1526s
	iters: 1300, epoch: 11 | loss: 0.4099538
	speed: 0.0215s/iter; left time: 459.4476s
	iters: 1400, epoch: 11 | loss: 0.4847127
	speed: 0.0233s/iter; left time: 494.1903s
	iters: 1500, epoch: 11 | loss: 1.0649549
	speed: 0.0212s/iter; left time: 448.0920s
	iters: 1600, epoch: 11 | loss: 0.4095327
	speed: 0.0232s/iter; left time: 487.3165s
	iters: 1700, epoch: 11 | loss: 0.3364609
	speed: 0.0210s/iter; left time: 440.5702s
	iters: 1800, epoch: 11 | loss: 0.4198632
	speed: 0.0241s/iter; left time: 502.9951s
	iters: 1900, epoch: 11 | loss: 0.9479383
	speed: 0.0212s/iter; left time: 440.4718s
	iters: 2000, epoch: 11 | loss: 0.5068228
	speed: 0.0234s/iter; left time: 483.7213s
	iters: 2100, epoch: 11 | loss: 0.4685099
	speed: 0.0227s/iter; left time: 465.0328s
	iters: 2200, epoch: 11 | loss: 0.3087897
	speed: 0.0227s/iter; left time: 462.7821s
Epoch: 11 cost time: 51.47158479690552
Epoch: 11, Steps: 2263 | Train Loss: 0.5311000 Vali Loss: 0.4923355 Test Loss: 0.2419786
Validation loss decreased (0.494771 --> 0.492335).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.3508841
	speed: 0.0776s/iter; left time: 1572.5647s
	iters: 200, epoch: 12 | loss: 0.4677549
	speed: 0.0206s/iter; left time: 416.3790s
	iters: 300, epoch: 12 | loss: 0.4187650
	speed: 0.0201s/iter; left time: 403.8852s
	iters: 400, epoch: 12 | loss: 0.8150969
	speed: 0.0214s/iter; left time: 426.4954s
	iters: 500, epoch: 12 | loss: 0.3127246
	speed: 0.0210s/iter; left time: 417.2231s
	iters: 600, epoch: 12 | loss: 0.8487138
	speed: 0.0225s/iter; left time: 444.3300s
	iters: 700, epoch: 12 | loss: 0.3762770
	speed: 0.0213s/iter; left time: 419.3207s
	iters: 800, epoch: 12 | loss: 0.3288976
	speed: 0.0260s/iter; left time: 508.0889s
	iters: 900, epoch: 12 | loss: 0.3773575
	speed: 0.0213s/iter; left time: 413.8343s
	iters: 1000, epoch: 12 | loss: 0.5247383
	speed: 0.0206s/iter; left time: 399.8892s
	iters: 1100, epoch: 12 | loss: 0.4202398
	speed: 0.0208s/iter; left time: 400.3297s
	iters: 1200, epoch: 12 | loss: 0.3708026
	speed: 0.0214s/iter; left time: 409.5508s
	iters: 1300, epoch: 12 | loss: 0.3189031
	speed: 0.0205s/iter; left time: 389.9987s
	iters: 1400, epoch: 12 | loss: 0.8915733
	speed: 0.0213s/iter; left time: 404.0962s
	iters: 1500, epoch: 12 | loss: 0.4329217
	speed: 0.0221s/iter; left time: 416.4812s
	iters: 1600, epoch: 12 | loss: 0.4152089
	speed: 0.0203s/iter; left time: 380.8393s
	iters: 1700, epoch: 12 | loss: 0.4866479
	speed: 0.0210s/iter; left time: 392.3641s
	iters: 1800, epoch: 12 | loss: 0.4076023
	speed: 0.0200s/iter; left time: 370.9488s
	iters: 1900, epoch: 12 | loss: 0.4542674
	speed: 0.0183s/iter; left time: 338.4455s
	iters: 2000, epoch: 12 | loss: 0.4384311
	speed: 0.0214s/iter; left time: 393.1506s
	iters: 2100, epoch: 12 | loss: 0.3908912
	speed: 0.0228s/iter; left time: 415.9836s
	iters: 2200, epoch: 12 | loss: 0.7281787
	speed: 0.0209s/iter; left time: 379.6301s
Epoch: 12 cost time: 47.66386103630066
Epoch: 12, Steps: 2263 | Train Loss: 0.5308781 Vali Loss: 0.4948032 Test Loss: 0.2415474
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.4105439
	speed: 0.0740s/iter; left time: 1331.8905s
	iters: 200, epoch: 13 | loss: 0.3781895
	speed: 0.0171s/iter; left time: 305.9068s
	iters: 300, epoch: 13 | loss: 0.5073000
	speed: 0.0166s/iter; left time: 295.6266s
	iters: 400, epoch: 13 | loss: 0.3574192
	speed: 0.0168s/iter; left time: 297.8639s
	iters: 500, epoch: 13 | loss: 0.4812741
	speed: 0.0220s/iter; left time: 387.5684s
	iters: 600, epoch: 13 | loss: 0.4044242
	speed: 0.0223s/iter; left time: 389.9496s
	iters: 700, epoch: 13 | loss: 0.3535958
	speed: 0.0203s/iter; left time: 352.5767s
	iters: 800, epoch: 13 | loss: 0.3217742
	speed: 0.0188s/iter; left time: 325.4351s
	iters: 900, epoch: 13 | loss: 0.3937231
	speed: 0.0196s/iter; left time: 338.0012s
	iters: 1000, epoch: 13 | loss: 0.4595766
	speed: 0.0205s/iter; left time: 350.4082s
	iters: 1100, epoch: 13 | loss: 0.3904314
	speed: 0.0215s/iter; left time: 365.8752s
	iters: 1200, epoch: 13 | loss: 0.3384596
	speed: 0.0202s/iter; left time: 340.9023s
	iters: 1300, epoch: 13 | loss: 0.9937586
	speed: 0.0202s/iter; left time: 339.9727s
	iters: 1400, epoch: 13 | loss: 0.4871161
	speed: 0.0187s/iter; left time: 312.7980s
	iters: 1500, epoch: 13 | loss: 0.3217161
	speed: 0.0187s/iter; left time: 310.7862s
	iters: 1600, epoch: 13 | loss: 0.4309722
	speed: 0.0198s/iter; left time: 326.0192s
	iters: 1700, epoch: 13 | loss: 0.8658262
	speed: 0.0191s/iter; left time: 313.1325s
	iters: 1800, epoch: 13 | loss: 0.4440202
	speed: 0.0174s/iter; left time: 283.5799s
	iters: 1900, epoch: 13 | loss: 0.4187450
	speed: 0.0177s/iter; left time: 286.9167s
	iters: 2000, epoch: 13 | loss: 0.4258066
	speed: 0.0174s/iter; left time: 280.5144s
	iters: 2100, epoch: 13 | loss: 1.0666337
	speed: 0.0177s/iter; left time: 283.3798s
	iters: 2200, epoch: 13 | loss: 0.8974776
	speed: 0.0200s/iter; left time: 318.5163s
Epoch: 13 cost time: 43.17246413230896
Epoch: 13, Steps: 2263 | Train Loss: 0.5306384 Vali Loss: 0.4945333 Test Loss: 0.2409401
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 1.0788596
	speed: 0.0685s/iter; left time: 1078.0869s
	iters: 200, epoch: 14 | loss: 0.3386753
	speed: 0.0173s/iter; left time: 270.7946s
	iters: 300, epoch: 14 | loss: 1.0615017
	speed: 0.0186s/iter; left time: 288.6762s
	iters: 400, epoch: 14 | loss: 2.0151262
	speed: 0.0177s/iter; left time: 272.9154s
	iters: 500, epoch: 14 | loss: 0.2990155
	speed: 0.0178s/iter; left time: 273.1402s
	iters: 600, epoch: 14 | loss: 0.9275742
	speed: 0.0186s/iter; left time: 283.4736s
	iters: 700, epoch: 14 | loss: 0.4539574
	speed: 0.0212s/iter; left time: 321.5073s
	iters: 800, epoch: 14 | loss: 0.4145782
	speed: 0.0195s/iter; left time: 293.4300s
	iters: 900, epoch: 14 | loss: 0.3698150
	speed: 0.0195s/iter; left time: 290.7077s
	iters: 1000, epoch: 14 | loss: 0.3796265
	speed: 0.0179s/iter; left time: 265.2411s
	iters: 1100, epoch: 14 | loss: 0.4474770
	speed: 0.0194s/iter; left time: 285.4792s
	iters: 1200, epoch: 14 | loss: 0.4958163
	speed: 0.0177s/iter; left time: 259.6622s
	iters: 1300, epoch: 14 | loss: 0.4011142
	speed: 0.0175s/iter; left time: 254.1219s
	iters: 1400, epoch: 14 | loss: 0.5147764
	speed: 0.0175s/iter; left time: 252.0849s
	iters: 1500, epoch: 14 | loss: 0.4305376
	speed: 0.0174s/iter; left time: 250.0168s
	iters: 1600, epoch: 14 | loss: 0.4080889
	speed: 0.0174s/iter; left time: 248.4454s
	iters: 1700, epoch: 14 | loss: 0.4315596
	speed: 0.0175s/iter; left time: 247.5507s
	iters: 1800, epoch: 14 | loss: 0.9926128
	speed: 0.0178s/iter; left time: 249.8696s
	iters: 1900, epoch: 14 | loss: 0.3990891
	speed: 0.0186s/iter; left time: 259.5983s
	iters: 2000, epoch: 14 | loss: 0.4511369
	speed: 0.0185s/iter; left time: 256.2026s
	iters: 2100, epoch: 14 | loss: 0.3813154
	speed: 0.0184s/iter; left time: 252.2545s
	iters: 2200, epoch: 14 | loss: 0.6079433
	speed: 0.0186s/iter; left time: 254.2577s
Epoch: 14 cost time: 41.53294086456299
Epoch: 14, Steps: 2263 | Train Loss: 0.5305928 Vali Loss: 0.4942006 Test Loss: 0.2410891
EarlyStopping counter: 3 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.8844058
	speed: 0.0693s/iter; left time: 933.5050s
	iters: 200, epoch: 15 | loss: 0.9727086
	speed: 0.0153s/iter; left time: 204.4317s
	iters: 300, epoch: 15 | loss: 0.3401107
	speed: 0.0169s/iter; left time: 224.8604s
	iters: 400, epoch: 15 | loss: 0.3327011
	speed: 0.0179s/iter; left time: 235.6815s
	iters: 500, epoch: 15 | loss: 0.3190402
	speed: 0.0181s/iter; left time: 236.3879s
	iters: 600, epoch: 15 | loss: 0.4149371
	speed: 0.0184s/iter; left time: 238.7414s
	iters: 700, epoch: 15 | loss: 0.5403591
	speed: 0.0180s/iter; left time: 232.3492s
	iters: 800, epoch: 15 | loss: 0.4452149
	speed: 0.0176s/iter; left time: 225.0630s
	iters: 900, epoch: 15 | loss: 0.3213499
	speed: 0.0172s/iter; left time: 217.7355s
	iters: 1000, epoch: 15 | loss: 0.3429434
	speed: 0.0168s/iter; left time: 211.3951s
	iters: 1100, epoch: 15 | loss: 0.3046841
	speed: 0.0165s/iter; left time: 206.1549s
	iters: 1200, epoch: 15 | loss: 0.9023540
	speed: 0.0179s/iter; left time: 221.7014s
	iters: 1300, epoch: 15 | loss: 0.3323511
	speed: 0.0159s/iter; left time: 195.3013s
	iters: 1400, epoch: 15 | loss: 0.3868026
	speed: 0.0165s/iter; left time: 201.3371s
	iters: 1500, epoch: 15 | loss: 0.4110723
	speed: 0.0166s/iter; left time: 200.2282s
	iters: 1600, epoch: 15 | loss: 1.6469513
	speed: 0.0165s/iter; left time: 197.9783s
	iters: 1700, epoch: 15 | loss: 0.3914818
	speed: 0.0166s/iter; left time: 197.6071s
	iters: 1800, epoch: 15 | loss: 0.4341334
	speed: 0.0162s/iter; left time: 190.3012s
	iters: 1900, epoch: 15 | loss: 0.5321533
	speed: 0.0161s/iter; left time: 188.5417s
	iters: 2000, epoch: 15 | loss: 0.4238552
	speed: 0.0167s/iter; left time: 193.7037s
	iters: 2100, epoch: 15 | loss: 0.4265049
	speed: 0.0157s/iter; left time: 180.5146s
	iters: 2200, epoch: 15 | loss: 0.3515447
	speed: 0.0155s/iter; left time: 175.9548s
Epoch: 15 cost time: 37.8788640499115
Epoch: 15, Steps: 2263 | Train Loss: 0.5306198 Vali Loss: 0.4944471 Test Loss: 0.2410975
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.3831700
	speed: 0.0643s/iter; left time: 720.8598s
	iters: 200, epoch: 16 | loss: 0.4317975
	speed: 0.0150s/iter; left time: 166.4672s
	iters: 300, epoch: 16 | loss: 0.4359282
	speed: 0.0156s/iter; left time: 171.5998s
	iters: 400, epoch: 16 | loss: 0.4227006
	speed: 0.0161s/iter; left time: 175.2486s
	iters: 500, epoch: 16 | loss: 0.4199916
	speed: 0.0167s/iter; left time: 180.1318s
	iters: 600, epoch: 16 | loss: 0.4025390
	speed: 0.0171s/iter; left time: 183.4037s
	iters: 700, epoch: 16 | loss: 0.9962727
	speed: 0.0169s/iter; left time: 179.8705s
	iters: 800, epoch: 16 | loss: 0.4735920
	speed: 0.0167s/iter; left time: 175.9043s
	iters: 900, epoch: 16 | loss: 0.3309696
	speed: 0.0168s/iter; left time: 175.3641s
	iters: 1000, epoch: 16 | loss: 10.7258558
	speed: 0.0168s/iter; left time: 173.0332s
	iters: 1100, epoch: 16 | loss: 0.3744631
	speed: 0.0165s/iter; left time: 168.6436s
	iters: 1200, epoch: 16 | loss: 0.3798844
	speed: 0.0166s/iter; left time: 167.7840s
	iters: 1300, epoch: 16 | loss: 0.3507338
	speed: 0.0165s/iter; left time: 164.9118s
	iters: 1400, epoch: 16 | loss: 0.4988188
	speed: 0.0165s/iter; left time: 163.5976s
	iters: 1500, epoch: 16 | loss: 0.3741139
	speed: 0.0163s/iter; left time: 160.4665s
	iters: 1600, epoch: 16 | loss: 0.3941575
	speed: 0.0164s/iter; left time: 159.6662s
	iters: 1700, epoch: 16 | loss: 0.2984881
	speed: 0.0164s/iter; left time: 157.8070s
	iters: 1800, epoch: 16 | loss: 0.9015549
	speed: 0.0166s/iter; left time: 157.6440s
	iters: 1900, epoch: 16 | loss: 0.4586719
	speed: 0.0165s/iter; left time: 155.5822s
	iters: 2000, epoch: 16 | loss: 1.0578967
	speed: 0.0163s/iter; left time: 151.8231s
	iters: 2100, epoch: 16 | loss: 0.3905131
	speed: 0.0155s/iter; left time: 142.8805s
	iters: 2200, epoch: 16 | loss: 0.5559492
	speed: 0.0159s/iter; left time: 144.7058s
Epoch: 16 cost time: 36.9710156917572
Epoch: 16, Steps: 2263 | Train Loss: 0.5306054 Vali Loss: 0.4942563 Test Loss: 0.2411167
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : weather_336_336_Linear_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3144<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10204
mse:0.24204599857330322, mae:0.3017895817756653
