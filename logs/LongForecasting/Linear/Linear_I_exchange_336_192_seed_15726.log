Args in experiment:
Namespace(activation='gelu', batch_size=8, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='exchange_rate.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=8, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='mse', lradj='type1', model='Linear', model_id='Exchange_336_192', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=192, root_path='./dataset/', save_pred_values=False, seed=15726, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : Exchange_336_192_Linear_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15726>>>>>>>>>>>>>>>>>>>>>>>>>>
train 4784
val 569
test 1326
	iters: 100, epoch: 1 | loss: 0.4153116
	speed: 0.0038s/iter; left time: 44.9841s
	iters: 200, epoch: 1 | loss: 0.2120565
	speed: 0.0042s/iter; left time: 49.8669s
	iters: 300, epoch: 1 | loss: 0.2017930
	speed: 0.0039s/iter; left time: 45.1703s
	iters: 400, epoch: 1 | loss: 0.2690440
	speed: 0.0038s/iter; left time: 44.3942s
	iters: 500, epoch: 1 | loss: 0.2280073
	speed: 0.0043s/iter; left time: 49.3967s
Epoch: 1 cost time: 2.4249215126037598
Epoch: 1, Steps: 598 | Train Loss: 0.2682328 Vali Loss: 0.4703144 Test Loss: 0.2149150
Validation loss decreased (inf --> 0.470314).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1910181
	speed: 0.0105s/iter; left time: 118.2952s
	iters: 200, epoch: 2 | loss: 0.2709795
	speed: 0.0043s/iter; left time: 48.2601s
	iters: 300, epoch: 2 | loss: 0.2468172
	speed: 0.0043s/iter; left time: 48.0192s
	iters: 400, epoch: 2 | loss: 0.1295815
	speed: 0.0039s/iter; left time: 43.1094s
	iters: 500, epoch: 2 | loss: 0.2002667
	speed: 0.0040s/iter; left time: 43.8863s
Epoch: 2 cost time: 2.4818577766418457
Epoch: 2, Steps: 598 | Train Loss: 0.2331484 Vali Loss: 0.4082050 Test Loss: 0.2007142
Validation loss decreased (0.470314 --> 0.408205).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1690823
	speed: 0.0099s/iter; left time: 105.5107s
	iters: 200, epoch: 3 | loss: 0.1514057
	speed: 0.0039s/iter; left time: 40.9082s
	iters: 300, epoch: 3 | loss: 0.3719389
	speed: 0.0033s/iter; left time: 34.8485s
	iters: 400, epoch: 3 | loss: 0.1138138
	speed: 0.0037s/iter; left time: 38.1491s
	iters: 500, epoch: 3 | loss: 0.1776048
	speed: 0.0040s/iter; left time: 41.0812s
Epoch: 3 cost time: 2.243469715118408
Epoch: 3, Steps: 598 | Train Loss: 0.2234654 Vali Loss: 0.4335335 Test Loss: 0.1947726
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.2588422
	speed: 0.0088s/iter; left time: 88.8327s
	iters: 200, epoch: 4 | loss: 0.1866363
	speed: 0.0041s/iter; left time: 40.9645s
	iters: 300, epoch: 4 | loss: 0.1766776
	speed: 0.0041s/iter; left time: 40.9480s
	iters: 400, epoch: 4 | loss: 0.2296020
	speed: 0.0041s/iter; left time: 40.1832s
	iters: 500, epoch: 4 | loss: 0.1491908
	speed: 0.0044s/iter; left time: 42.9213s
Epoch: 4 cost time: 2.4540750980377197
Epoch: 4, Steps: 598 | Train Loss: 0.2182492 Vali Loss: 0.5084861 Test Loss: 0.2144836
EarlyStopping counter: 2 out of 5
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.2485081
	speed: 0.0104s/iter; left time: 98.7797s
	iters: 200, epoch: 5 | loss: 0.1436229
	speed: 0.0041s/iter; left time: 38.1529s
	iters: 300, epoch: 5 | loss: 0.1090663
	speed: 0.0039s/iter; left time: 35.7782s
	iters: 400, epoch: 5 | loss: 0.1576577
	speed: 0.0041s/iter; left time: 37.5247s
	iters: 500, epoch: 5 | loss: 0.0911961
	speed: 0.0038s/iter; left time: 34.0294s
Epoch: 5 cost time: 2.4132180213928223
Epoch: 5, Steps: 598 | Train Loss: 0.2160727 Vali Loss: 0.4636992 Test Loss: 0.1905900
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1261034
	speed: 0.0104s/iter; left time: 92.3097s
	iters: 200, epoch: 6 | loss: 0.1835630
	speed: 0.0042s/iter; left time: 36.5747s
	iters: 300, epoch: 6 | loss: 0.2820023
	speed: 0.0042s/iter; left time: 36.0022s
	iters: 400, epoch: 6 | loss: 0.1304215
	speed: 0.0041s/iter; left time: 35.4841s
	iters: 500, epoch: 6 | loss: 0.1605214
	speed: 0.0041s/iter; left time: 34.3367s
Epoch: 6 cost time: 2.450639009475708
Epoch: 6, Steps: 598 | Train Loss: 0.2149697 Vali Loss: 0.4766514 Test Loss: 0.1826857
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1630156
	speed: 0.0100s/iter; left time: 82.5075s
	iters: 200, epoch: 7 | loss: 0.2131814
	speed: 0.0039s/iter; left time: 31.4661s
	iters: 300, epoch: 7 | loss: 0.1470734
	speed: 0.0041s/iter; left time: 33.0189s
	iters: 400, epoch: 7 | loss: 0.2308220
	speed: 0.0037s/iter; left time: 29.5166s
	iters: 500, epoch: 7 | loss: 0.1547791
	speed: 0.0040s/iter; left time: 31.8716s
Epoch: 7 cost time: 2.3323893547058105
Epoch: 7, Steps: 598 | Train Loss: 0.2143048 Vali Loss: 0.4643672 Test Loss: 0.1808100
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : Exchange_336_192_Linear_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15726<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 1326
mse:0.2006589025259018, mae:0.34150442481040955
