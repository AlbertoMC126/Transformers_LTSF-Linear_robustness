Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTh2', data_path='ETTh2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.05, loss='mse', lradj='type1', model='NLinear', model_id='ETTh2_96_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=3144, seq_len=96, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTh2_96_96_NLinear_ETTh2_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3144>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8449
data_set:  <data_provider.data_loader.Dataset_ETT_hour object at 0x000001EAF0EB0D68>
val 2785
data_set:  <data_provider.data_loader.Dataset_ETT_hour object at 0x000001EABE4B7DD8>
test 2785
data_set:  <data_provider.data_loader.Dataset_ETT_hour object at 0x000001EAF0EB0128>
Total number of trainable parameters: 65184
Total number of parameters: 65184
	iters: 100, epoch: 1 | loss: 2.3025050
	speed: 0.0027s/iter; left time: 28.5646s
	iters: 200, epoch: 1 | loss: 2.0224066
	speed: 0.0027s/iter; left time: 27.9274s
	iters: 300, epoch: 1 | loss: 0.5309974
	speed: 0.0034s/iter; left time: 34.4902s
	iters: 400, epoch: 1 | loss: 1.2465194
	speed: 0.0034s/iter; left time: 34.7517s
	iters: 500, epoch: 1 | loss: 1.6751798
	speed: 0.0030s/iter; left time: 29.6971s
Epoch: 1 cost time: 1.6010143756866455
Epoch: 1, Steps: 528 | Train Loss: 1.4387185 Vali Loss: 2.1057785 Test Loss: 3.1525366
Validation loss decreased (inf --> 2.105778).  Saving model ...
Updating learning rate to 0.05
	iters: 100, epoch: 2 | loss: 0.8409197
	speed: 0.0079s/iter; left time: 78.8344s
	iters: 200, epoch: 2 | loss: 1.3211573
	speed: 0.0028s/iter; left time: 27.5727s
	iters: 300, epoch: 2 | loss: 2.0182059
	speed: 0.0034s/iter; left time: 33.2704s
	iters: 400, epoch: 2 | loss: 1.8997587
	speed: 0.0035s/iter; left time: 34.1049s
	iters: 500, epoch: 2 | loss: 1.1600039
	speed: 0.0025s/iter; left time: 24.0624s
Epoch: 2 cost time: 1.5818700790405273
Epoch: 2, Steps: 528 | Train Loss: 2.0978891 Vali Loss: 0.6541750 Test Loss: 0.9271244
Validation loss decreased (2.105778 --> 0.654175).  Saving model ...
Updating learning rate to 0.025
	iters: 100, epoch: 3 | loss: 0.3839920
	speed: 0.0073s/iter; left time: 69.0879s
	iters: 200, epoch: 3 | loss: 0.4093168
	speed: 0.0031s/iter; left time: 29.0267s
	iters: 300, epoch: 3 | loss: 0.4578802
	speed: 0.0027s/iter; left time: 25.1680s
	iters: 400, epoch: 3 | loss: 1.0330970
	speed: 0.0026s/iter; left time: 23.4834s
	iters: 500, epoch: 3 | loss: 0.3699781
	speed: 0.0026s/iter; left time: 23.1547s
Epoch: 3 cost time: 1.407693862915039
Epoch: 3, Steps: 528 | Train Loss: 0.6494612 Vali Loss: 0.2790287 Test Loss: 0.3904344
Validation loss decreased (0.654175 --> 0.279029).  Saving model ...
Updating learning rate to 0.0125
	iters: 100, epoch: 4 | loss: 0.5685800
	speed: 0.0066s/iter; left time: 58.8763s
	iters: 200, epoch: 4 | loss: 0.4816260
	speed: 0.0036s/iter; left time: 31.6947s
	iters: 300, epoch: 4 | loss: 0.2775337
	speed: 0.0030s/iter; left time: 25.7731s
	iters: 400, epoch: 4 | loss: 0.9277118
	speed: 0.0025s/iter; left time: 21.4103s
	iters: 500, epoch: 4 | loss: 0.4585098
	speed: 0.0028s/iter; left time: 23.8697s
Epoch: 4 cost time: 1.5158507823944092
Epoch: 4, Steps: 528 | Train Loss: 0.4838743 Vali Loss: 0.2345194 Test Loss: 0.3420902
Validation loss decreased (0.279029 --> 0.234519).  Saving model ...
Updating learning rate to 0.00625
	iters: 100, epoch: 5 | loss: 0.2732187
	speed: 0.0088s/iter; left time: 73.6451s
	iters: 200, epoch: 5 | loss: 0.7170161
	speed: 0.0024s/iter; left time: 19.6067s
	iters: 300, epoch: 5 | loss: 0.6416574
	speed: 0.0029s/iter; left time: 23.7482s
	iters: 400, epoch: 5 | loss: 0.4867831
	speed: 0.0037s/iter; left time: 29.7158s
	iters: 500, epoch: 5 | loss: 0.2238077
	speed: 0.0031s/iter; left time: 25.0337s
Epoch: 5 cost time: 1.5313291549682617
Epoch: 5, Steps: 528 | Train Loss: 0.4404022 Vali Loss: 0.2284785 Test Loss: 0.3133807
Validation loss decreased (0.234519 --> 0.228479).  Saving model ...
Updating learning rate to 0.003125
	iters: 100, epoch: 6 | loss: 0.3969110
	speed: 0.0083s/iter; left time: 64.9393s
	iters: 200, epoch: 6 | loss: 0.9766267
	speed: 0.0023s/iter; left time: 17.7840s
	iters: 300, epoch: 6 | loss: 0.3350219
	speed: 0.0022s/iter; left time: 16.6776s
	iters: 400, epoch: 6 | loss: 0.4236759
	speed: 0.0022s/iter; left time: 16.4605s
	iters: 500, epoch: 6 | loss: 1.0268776
	speed: 0.0031s/iter; left time: 23.1830s
Epoch: 6 cost time: 1.3598666191101074
Epoch: 6, Steps: 528 | Train Loss: 0.4225063 Vali Loss: 0.2183842 Test Loss: 0.3005781
Validation loss decreased (0.228479 --> 0.218384).  Saving model ...
Updating learning rate to 0.0015625
	iters: 100, epoch: 7 | loss: 0.2208726
	speed: 0.0078s/iter; left time: 56.9965s
	iters: 200, epoch: 7 | loss: 0.4457812
	speed: 0.0033s/iter; left time: 23.9779s
	iters: 300, epoch: 7 | loss: 0.3039385
	speed: 0.0026s/iter; left time: 18.4426s
	iters: 400, epoch: 7 | loss: 0.5184065
	speed: 0.0028s/iter; left time: 19.3199s
	iters: 500, epoch: 7 | loss: 0.3286289
	speed: 0.0021s/iter; left time: 14.3363s
Epoch: 7 cost time: 1.4167070388793945
Epoch: 7, Steps: 528 | Train Loss: 0.4125465 Vali Loss: 0.2177559 Test Loss: 0.3051175
Validation loss decreased (0.218384 --> 0.217756).  Saving model ...
Updating learning rate to 0.00078125
	iters: 100, epoch: 8 | loss: 0.1910949
	speed: 0.0075s/iter; left time: 50.7603s
	iters: 200, epoch: 8 | loss: 0.9398152
	speed: 0.0034s/iter; left time: 22.8995s
	iters: 300, epoch: 8 | loss: 0.4799156
	speed: 0.0031s/iter; left time: 20.5429s
	iters: 400, epoch: 8 | loss: 0.2151890
	speed: 0.0029s/iter; left time: 18.8109s
	iters: 500, epoch: 8 | loss: 0.2557062
	speed: 0.0027s/iter; left time: 17.2593s
Epoch: 8 cost time: 1.6229581832885742
Epoch: 8, Steps: 528 | Train Loss: 0.4083705 Vali Loss: 0.2125030 Test Loss: 0.2949314
Validation loss decreased (0.217756 --> 0.212503).  Saving model ...
Updating learning rate to 0.000390625
	iters: 100, epoch: 9 | loss: 0.4181276
	speed: 0.0087s/iter; left time: 54.5682s
	iters: 200, epoch: 9 | loss: 0.2138871
	speed: 0.0028s/iter; left time: 17.2885s
	iters: 300, epoch: 9 | loss: 0.6971680
	speed: 0.0030s/iter; left time: 17.9209s
	iters: 400, epoch: 9 | loss: 0.2634345
	speed: 0.0023s/iter; left time: 13.9100s
	iters: 500, epoch: 9 | loss: 0.6181458
	speed: 0.0025s/iter; left time: 14.5864s
Epoch: 9 cost time: 1.4534292221069336
Epoch: 9, Steps: 528 | Train Loss: 0.4047738 Vali Loss: 0.2109805 Test Loss: 0.2923343
Validation loss decreased (0.212503 --> 0.210981).  Saving model ...
Updating learning rate to 0.0001953125
	iters: 100, epoch: 10 | loss: 0.2584015
	speed: 0.0072s/iter; left time: 41.0212s
	iters: 200, epoch: 10 | loss: 0.6146307
	speed: 0.0025s/iter; left time: 14.0266s
	iters: 300, epoch: 10 | loss: 0.2570040
	speed: 0.0034s/iter; left time: 18.9307s
	iters: 400, epoch: 10 | loss: 0.1806565
	speed: 0.0034s/iter; left time: 18.6163s
	iters: 500, epoch: 10 | loss: 0.3127365
	speed: 0.0028s/iter; left time: 15.1170s
Epoch: 10 cost time: 1.5519907474517822
Epoch: 10, Steps: 528 | Train Loss: 0.4030917 Vali Loss: 0.2109001 Test Loss: 0.2910542
Validation loss decreased (0.210981 --> 0.210900).  Saving model ...
Updating learning rate to 9.765625e-05
	iters: 100, epoch: 11 | loss: 0.2601980
	speed: 0.0087s/iter; left time: 45.1465s
	iters: 200, epoch: 11 | loss: 0.3095679
	speed: 0.0023s/iter; left time: 11.9188s
	iters: 300, epoch: 11 | loss: 0.3004099
	speed: 0.0022s/iter; left time: 10.8774s
	iters: 400, epoch: 11 | loss: 0.2873355
	speed: 0.0025s/iter; left time: 12.2149s
	iters: 500, epoch: 11 | loss: 0.3934166
	speed: 0.0025s/iter; left time: 11.9468s
Epoch: 11 cost time: 1.2975873947143555
Epoch: 11, Steps: 528 | Train Loss: 0.4018283 Vali Loss: 0.2115509 Test Loss: 0.2903179
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.8828125e-05
	iters: 100, epoch: 12 | loss: 0.3264534
	speed: 0.0078s/iter; left time: 36.3491s
	iters: 200, epoch: 12 | loss: 0.2607616
	speed: 0.0028s/iter; left time: 12.8051s
	iters: 300, epoch: 12 | loss: 0.4523613
	speed: 0.0033s/iter; left time: 14.6070s
	iters: 400, epoch: 12 | loss: 0.9861875
	speed: 0.0038s/iter; left time: 16.3334s
	iters: 500, epoch: 12 | loss: 0.3354428
	speed: 0.0025s/iter; left time: 10.6259s
Epoch: 12 cost time: 1.5940196514129639
Epoch: 12, Steps: 528 | Train Loss: 0.4017189 Vali Loss: 0.2104954 Test Loss: 0.2902643
Validation loss decreased (0.210900 --> 0.210495).  Saving model ...
Updating learning rate to 2.44140625e-05
	iters: 100, epoch: 13 | loss: 0.2242717
	speed: 0.0072s/iter; left time: 29.6447s
	iters: 200, epoch: 13 | loss: 0.3459797
	speed: 0.0023s/iter; left time: 9.4449s
	iters: 300, epoch: 13 | loss: 0.9795287
	speed: 0.0022s/iter; left time: 8.5821s
	iters: 400, epoch: 13 | loss: 0.2595201
	speed: 0.0031s/iter; left time: 11.9447s
	iters: 500, epoch: 13 | loss: 0.2019469
	speed: 0.0030s/iter; left time: 11.0585s
Epoch: 13 cost time: 1.4376575946807861
Epoch: 13, Steps: 528 | Train Loss: 0.4010748 Vali Loss: 0.2103149 Test Loss: 0.2902823
Validation loss decreased (0.210495 --> 0.210315).  Saving model ...
Updating learning rate to 1.220703125e-05
	iters: 100, epoch: 14 | loss: 0.5023996
	speed: 0.0083s/iter; left time: 29.8003s
	iters: 200, epoch: 14 | loss: 0.4226077
	speed: 0.0033s/iter; left time: 11.4686s
	iters: 300, epoch: 14 | loss: 0.6848501
	speed: 0.0023s/iter; left time: 7.9689s
	iters: 400, epoch: 14 | loss: 0.2054577
	speed: 0.0025s/iter; left time: 8.2263s
	iters: 500, epoch: 14 | loss: 0.3149820
	speed: 0.0036s/iter; left time: 11.5619s
Epoch: 14 cost time: 1.562540054321289
Epoch: 14, Steps: 528 | Train Loss: 0.4008361 Vali Loss: 0.2103091 Test Loss: 0.2903335
Validation loss decreased (0.210315 --> 0.210309).  Saving model ...
Updating learning rate to 6.103515625e-06
	iters: 100, epoch: 15 | loss: 0.2336232
	speed: 0.0075s/iter; left time: 22.9491s
	iters: 200, epoch: 15 | loss: 0.4522668
	speed: 0.0022s/iter; left time: 6.5080s
	iters: 300, epoch: 15 | loss: 0.3479468
	speed: 0.0025s/iter; left time: 7.1638s
	iters: 400, epoch: 15 | loss: 0.2901438
	speed: 0.0021s/iter; left time: 5.6850s
	iters: 500, epoch: 15 | loss: 0.1380306
	speed: 0.0028s/iter; left time: 7.4495s
Epoch: 15 cost time: 1.2971854209899902
Epoch: 15, Steps: 528 | Train Loss: 0.4006806 Vali Loss: 0.2101849 Test Loss: 0.2902935
Validation loss decreased (0.210309 --> 0.210185).  Saving model ...
Updating learning rate to 3.0517578125e-06
	iters: 100, epoch: 16 | loss: 0.4689337
	speed: 0.0073s/iter; left time: 18.6576s
	iters: 200, epoch: 16 | loss: 0.3670981
	speed: 0.0025s/iter; left time: 6.1100s
	iters: 300, epoch: 16 | loss: 0.1885591
	speed: 0.0020s/iter; left time: 4.7473s
	iters: 400, epoch: 16 | loss: 0.3020461
	speed: 0.0022s/iter; left time: 4.9089s
	iters: 500, epoch: 16 | loss: 0.5810769
	speed: 0.0019s/iter; left time: 4.0076s
Epoch: 16 cost time: 1.2185161113739014
Epoch: 16, Steps: 528 | Train Loss: 0.4006601 Vali Loss: 0.2101276 Test Loss: 0.2902657
Validation loss decreased (0.210185 --> 0.210128).  Saving model ...
Updating learning rate to 1.52587890625e-06
	iters: 100, epoch: 17 | loss: 0.5146018
	speed: 0.0073s/iter; left time: 14.7828s
	iters: 200, epoch: 17 | loss: 1.0398402
	speed: 0.0027s/iter; left time: 5.0877s
	iters: 300, epoch: 17 | loss: 0.4206105
	speed: 0.0028s/iter; left time: 5.0989s
	iters: 400, epoch: 17 | loss: 0.3647788
	speed: 0.0020s/iter; left time: 3.4762s
	iters: 500, epoch: 17 | loss: 0.3087848
	speed: 0.0022s/iter; left time: 3.5326s
Epoch: 17 cost time: 1.26552414894104
Epoch: 17, Steps: 528 | Train Loss: 0.4006437 Vali Loss: 0.2101812 Test Loss: 0.2902553
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.62939453125e-07
	iters: 100, epoch: 18 | loss: 0.8528236
	speed: 0.0045s/iter; left time: 6.7296s
	iters: 200, epoch: 18 | loss: 0.2105424
	speed: 0.0023s/iter; left time: 3.2444s
	iters: 300, epoch: 18 | loss: 0.4415952
	speed: 0.0016s/iter; left time: 2.0068s
	iters: 400, epoch: 18 | loss: 0.9553788
	speed: 0.0017s/iter; left time: 2.0365s
	iters: 500, epoch: 18 | loss: 0.2763460
	speed: 0.0016s/iter; left time: 1.6928s
Epoch: 18 cost time: 0.9687609672546387
Epoch: 18, Steps: 528 | Train Loss: 0.4005309 Vali Loss: 0.2100670 Test Loss: 0.2902558
Validation loss decreased (0.210128 --> 0.210067).  Saving model ...
Updating learning rate to 3.814697265625e-07
	iters: 100, epoch: 19 | loss: 0.8141061
	speed: 0.0047s/iter; left time: 4.4868s
	iters: 200, epoch: 19 | loss: 0.3694550
	speed: 0.0017s/iter; left time: 1.4724s
	iters: 300, epoch: 19 | loss: 0.3557873
	speed: 0.0016s/iter; left time: 1.1819s
	iters: 400, epoch: 19 | loss: 0.2638913
	speed: 0.0019s/iter; left time: 1.2348s
	iters: 500, epoch: 19 | loss: 0.3140287
	speed: 0.0020s/iter; left time: 1.1295s
Epoch: 19 cost time: 0.9685053825378418
Epoch: 19, Steps: 528 | Train Loss: 0.4006278 Vali Loss: 0.2101751 Test Loss: 0.2902513
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.9073486328125e-07
	iters: 100, epoch: 20 | loss: 0.2086054
	speed: 0.0038s/iter; left time: 1.6102s
	iters: 200, epoch: 20 | loss: 0.2060827
	speed: 0.0014s/iter; left time: 0.4620s
	iters: 300, epoch: 20 | loss: 0.2100092
	speed: 0.0014s/iter; left time: 0.3226s
	iters: 400, epoch: 20 | loss: 0.4130188
	speed: 0.0014s/iter; left time: 0.1809s
	iters: 500, epoch: 20 | loss: 0.3798365
	speed: 0.0014s/iter; left time: 0.0408s
Epoch: 20 cost time: 0.7659702301025391
Epoch: 20, Steps: 528 | Train Loss: 0.4006254 Vali Loss: 0.2101816 Test Loss: 0.2902519
EarlyStopping counter: 2 out of 5
Updating learning rate to 9.5367431640625e-08
Total training time: 34.9448 seconds
>>>>>>>testing : ETTh2_96_96_NLinear_ETTh2_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3144<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
data_set:  <data_provider.data_loader.Dataset_ETT_hour object at 0x000001EAB3911080>
mse:0.2912460267543793, mae:0.341659814119339
