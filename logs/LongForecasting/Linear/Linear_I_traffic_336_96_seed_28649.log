Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='Linear', model_id='traffic_336_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=28649, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_336_96_Linear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed28649>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11849
val 1661
test 3413
	iters: 100, epoch: 1 | loss: 0.4419046
	speed: 0.3150s/iter; left time: 4631.5001s
	iters: 200, epoch: 1 | loss: 0.4697284
	speed: 0.3015s/iter; left time: 4401.5183s
	iters: 300, epoch: 1 | loss: 0.4489641
	speed: 0.3027s/iter; left time: 4390.0357s
	iters: 400, epoch: 1 | loss: 0.4611117
	speed: 0.3024s/iter; left time: 4354.5512s
	iters: 500, epoch: 1 | loss: 0.4246385
	speed: 0.3033s/iter; left time: 4337.2238s
	iters: 600, epoch: 1 | loss: 0.4928558
	speed: 0.3022s/iter; left time: 4291.0131s
	iters: 700, epoch: 1 | loss: 0.4729745
	speed: 0.3028s/iter; left time: 4270.3537s
Epoch: 1 cost time: 225.31656455993652
Epoch: 1, Steps: 740 | Train Loss: 0.4742311 Vali Loss: 0.6374125 Test Loss: 0.7447115
Validation loss decreased (inf --> 0.637412).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.4688213
	speed: 0.6110s/iter; left time: 8530.2859s
	iters: 200, epoch: 2 | loss: 0.4325910
	speed: 0.3017s/iter; left time: 4181.4851s
	iters: 300, epoch: 2 | loss: 0.4151877
	speed: 0.3021s/iter; left time: 4157.7485s
	iters: 400, epoch: 2 | loss: 0.4112676
	speed: 0.3009s/iter; left time: 4111.2751s
	iters: 500, epoch: 2 | loss: 0.4915582
	speed: 0.3032s/iter; left time: 4111.8181s
	iters: 600, epoch: 2 | loss: 0.4309372
	speed: 0.3019s/iter; left time: 4063.6606s
	iters: 700, epoch: 2 | loss: 0.4365371
	speed: 0.3025s/iter; left time: 4041.3122s
Epoch: 2 cost time: 223.4775321483612
Epoch: 2, Steps: 740 | Train Loss: 0.4655140 Vali Loss: 0.6149296 Test Loss: 0.7186305
Validation loss decreased (0.637412 --> 0.614930).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.3231962
	speed: 0.6110s/iter; left time: 8078.2047s
	iters: 200, epoch: 3 | loss: 0.3398522
	speed: 0.3011s/iter; left time: 3950.7661s
	iters: 300, epoch: 3 | loss: 0.3302065
	speed: 0.3022s/iter; left time: 3934.3199s
	iters: 400, epoch: 3 | loss: 0.3101586
	speed: 0.3017s/iter; left time: 3898.5858s
	iters: 500, epoch: 3 | loss: 0.3235749
	speed: 0.3011s/iter; left time: 3859.8508s
	iters: 600, epoch: 3 | loss: 0.3031427
	speed: 0.3020s/iter; left time: 3842.2629s
	iters: 700, epoch: 3 | loss: 0.2908513
	speed: 0.3018s/iter; left time: 3809.4538s
Epoch: 3 cost time: 223.2351315021515
Epoch: 3, Steps: 740 | Train Loss: 0.3221405 Vali Loss: 0.4480450 Test Loss: 0.5387903
Validation loss decreased (0.614930 --> 0.448045).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.2623611
	speed: 0.6104s/iter; left time: 7618.8850s
	iters: 200, epoch: 4 | loss: 0.2686267
	speed: 0.3013s/iter; left time: 3730.4993s
	iters: 300, epoch: 4 | loss: 0.2813221
	speed: 0.3007s/iter; left time: 3692.7548s
	iters: 400, epoch: 4 | loss: 0.3014772
	speed: 0.3021s/iter; left time: 3679.9836s
	iters: 500, epoch: 4 | loss: 0.3045876
	speed: 0.3014s/iter; left time: 3641.0245s
	iters: 600, epoch: 4 | loss: 0.3050848
	speed: 0.3014s/iter; left time: 3610.5721s
	iters: 700, epoch: 4 | loss: 0.2643793
	speed: 0.3017s/iter; left time: 3584.8808s
Epoch: 4 cost time: 223.07188653945923
Epoch: 4, Steps: 740 | Train Loss: 0.2755090 Vali Loss: 0.3977561 Test Loss: 0.4812623
Validation loss decreased (0.448045 --> 0.397756).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.2856565
	speed: 0.6107s/iter; left time: 7170.6547s
	iters: 200, epoch: 5 | loss: 0.2575659
	speed: 0.3015s/iter; left time: 3510.2136s
	iters: 300, epoch: 5 | loss: 0.2664704
	speed: 0.3034s/iter; left time: 3501.1730s
	iters: 400, epoch: 5 | loss: 0.2447151
	speed: 0.3027s/iter; left time: 3463.5445s
	iters: 500, epoch: 5 | loss: 0.2599730
	speed: 0.3008s/iter; left time: 3411.7345s
	iters: 600, epoch: 5 | loss: 0.2799045
	speed: 0.2999s/iter; left time: 3371.2232s
	iters: 700, epoch: 5 | loss: 0.2589664
	speed: 0.3011s/iter; left time: 3354.9646s
Epoch: 5 cost time: 223.22473740577698
Epoch: 5, Steps: 740 | Train Loss: 0.2545286 Vali Loss: 0.3693851 Test Loss: 0.4514344
Validation loss decreased (0.397756 --> 0.369385).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.2297224
	speed: 0.6096s/iter; left time: 6705.8700s
	iters: 200, epoch: 6 | loss: 0.2435895
	speed: 0.3015s/iter; left time: 3286.3593s
	iters: 300, epoch: 6 | loss: 0.2565991
	speed: 0.3028s/iter; left time: 3271.0178s
	iters: 400, epoch: 6 | loss: 0.2111699
	speed: 0.3027s/iter; left time: 3239.6479s
	iters: 500, epoch: 6 | loss: 0.2276962
	speed: 0.3009s/iter; left time: 3189.5648s
	iters: 600, epoch: 6 | loss: 0.2561880
	speed: 0.3019s/iter; left time: 3170.7011s
	iters: 700, epoch: 6 | loss: 0.2665528
	speed: 0.3029s/iter; left time: 3150.8228s
Epoch: 6 cost time: 223.30967378616333
Epoch: 6, Steps: 740 | Train Loss: 0.2438230 Vali Loss: 0.3587393 Test Loss: 0.4374425
Validation loss decreased (0.369385 --> 0.358739).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.2507092
	speed: 0.6119s/iter; left time: 6278.8632s
	iters: 200, epoch: 7 | loss: 0.2371525
	speed: 0.3026s/iter; left time: 3074.7303s
	iters: 300, epoch: 7 | loss: 0.2347719
	speed: 0.3010s/iter; left time: 3028.4760s
	iters: 400, epoch: 7 | loss: 0.2196643
	speed: 0.3007s/iter; left time: 2995.1799s
	iters: 500, epoch: 7 | loss: 0.2317889
	speed: 0.3013s/iter; left time: 2971.3738s
	iters: 600, epoch: 7 | loss: 0.2557636
	speed: 0.3010s/iter; left time: 2938.3658s
	iters: 700, epoch: 7 | loss: 0.2252515
	speed: 0.3016s/iter; left time: 2913.4614s
Epoch: 7 cost time: 223.18350410461426
Epoch: 7, Steps: 740 | Train Loss: 0.2379426 Vali Loss: 0.3530200 Test Loss: 0.4314868
Validation loss decreased (0.358739 --> 0.353020).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.2410198
	speed: 0.6109s/iter; left time: 5816.1425s
	iters: 200, epoch: 8 | loss: 0.2534522
	speed: 0.3011s/iter; left time: 2836.2368s
	iters: 300, epoch: 8 | loss: 0.2208706
	speed: 0.3008s/iter; left time: 2803.5458s
	iters: 400, epoch: 8 | loss: 0.2447120
	speed: 0.3010s/iter; left time: 2775.8707s
	iters: 500, epoch: 8 | loss: 0.2814464
	speed: 0.3008s/iter; left time: 2743.2925s
	iters: 600, epoch: 8 | loss: 0.2578610
	speed: 0.3012s/iter; left time: 2716.9016s
	iters: 700, epoch: 8 | loss: 0.2341996
	speed: 0.3017s/iter; left time: 2691.1743s
Epoch: 8 cost time: 222.80915713310242
Epoch: 8, Steps: 740 | Train Loss: 0.2347345 Vali Loss: 0.3500795 Test Loss: 0.4281369
Validation loss decreased (0.353020 --> 0.350079).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.2455579
	speed: 0.6118s/iter; left time: 5371.8078s
	iters: 200, epoch: 9 | loss: 0.2415696
	speed: 0.3015s/iter; left time: 2617.5644s
	iters: 300, epoch: 9 | loss: 0.2414143
	speed: 0.3019s/iter; left time: 2590.8165s
	iters: 400, epoch: 9 | loss: 0.2248342
	speed: 0.3015s/iter; left time: 2557.0767s
	iters: 500, epoch: 9 | loss: 0.2339759
	speed: 0.3017s/iter; left time: 2528.8723s
	iters: 600, epoch: 9 | loss: 0.2582195
	speed: 0.3028s/iter; left time: 2507.2766s
	iters: 700, epoch: 9 | loss: 0.2382708
	speed: 0.3013s/iter; left time: 2465.3277s
Epoch: 9 cost time: 223.30378413200378
Epoch: 9, Steps: 740 | Train Loss: 0.2329108 Vali Loss: 0.3489016 Test Loss: 0.4264700
Validation loss decreased (0.350079 --> 0.348902).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.2528136
	speed: 0.6127s/iter; left time: 4926.8633s
	iters: 200, epoch: 10 | loss: 0.2093506
	speed: 0.3040s/iter; left time: 2414.1807s
	iters: 300, epoch: 10 | loss: 0.2641101
	speed: 0.3035s/iter; left time: 2379.8552s
	iters: 400, epoch: 10 | loss: 0.2745635
	speed: 0.3034s/iter; left time: 2348.9903s
	iters: 500, epoch: 10 | loss: 0.2361018
	speed: 0.3031s/iter; left time: 2315.6200s
	iters: 600, epoch: 10 | loss: 0.2524080
	speed: 0.3035s/iter; left time: 2289.0375s
	iters: 700, epoch: 10 | loss: 0.2368719
	speed: 0.3027s/iter; left time: 2252.0623s
Epoch: 10 cost time: 224.40650415420532
Epoch: 10, Steps: 740 | Train Loss: 0.2319417 Vali Loss: 0.3481896 Test Loss: 0.4259253
Validation loss decreased (0.348902 --> 0.348190).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.2324923
	speed: 0.6128s/iter; left time: 4473.9744s
	iters: 200, epoch: 11 | loss: 0.2259103
	speed: 0.3024s/iter; left time: 2177.5781s
	iters: 300, epoch: 11 | loss: 0.2634270
	speed: 0.3024s/iter; left time: 2147.2325s
	iters: 400, epoch: 11 | loss: 0.2680029
	speed: 0.3024s/iter; left time: 2116.9352s
	iters: 500, epoch: 11 | loss: 0.2064728
	speed: 0.3029s/iter; left time: 2090.0623s
	iters: 600, epoch: 11 | loss: 0.2451153
	speed: 0.3023s/iter; left time: 2055.6607s
	iters: 700, epoch: 11 | loss: 0.2391421
	speed: 0.3013s/iter; left time: 2019.0254s
Epoch: 11 cost time: 223.69972968101501
Epoch: 11, Steps: 740 | Train Loss: 0.2314623 Vali Loss: 0.3480029 Test Loss: 0.4257295
Validation loss decreased (0.348190 --> 0.348003).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.2205066
	speed: 0.6274s/iter; left time: 4116.2108s
	iters: 200, epoch: 12 | loss: 0.2553841
	speed: 0.3028s/iter; left time: 1956.1650s
	iters: 300, epoch: 12 | loss: 0.2275216
	speed: 0.3027s/iter; left time: 1925.4147s
	iters: 400, epoch: 12 | loss: 0.2388625
	speed: 0.3020s/iter; left time: 1891.1268s
	iters: 500, epoch: 12 | loss: 0.2369266
	speed: 0.3021s/iter; left time: 1861.1676s
	iters: 600, epoch: 12 | loss: 0.2318882
	speed: 0.3034s/iter; left time: 1839.1385s
	iters: 700, epoch: 12 | loss: 0.2472522
	speed: 0.3024s/iter; left time: 1802.6754s
Epoch: 12 cost time: 223.92838311195374
Epoch: 12, Steps: 740 | Train Loss: 0.2311530 Vali Loss: 0.3477467 Test Loss: 0.4255511
Validation loss decreased (0.348003 --> 0.347747).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.2674149
	speed: 0.6135s/iter; left time: 3571.1646s
	iters: 200, epoch: 13 | loss: 0.2368101
	speed: 0.3037s/iter; left time: 1737.4035s
	iters: 300, epoch: 13 | loss: 0.2290866
	speed: 0.3015s/iter; left time: 1694.9651s
	iters: 400, epoch: 13 | loss: 0.2370027
	speed: 0.3028s/iter; left time: 1671.5192s
	iters: 500, epoch: 13 | loss: 0.1992140
	speed: 0.3029s/iter; left time: 1641.9815s
	iters: 600, epoch: 13 | loss: 0.2207058
	speed: 0.3049s/iter; left time: 1622.1937s
	iters: 700, epoch: 13 | loss: 0.2292579
	speed: 0.3044s/iter; left time: 1589.2885s
Epoch: 13 cost time: 224.4850664138794
Epoch: 13, Steps: 740 | Train Loss: 0.2309849 Vali Loss: 0.3480271 Test Loss: 0.4255576
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 14 | loss: 0.2350399
	speed: 0.6118s/iter; left time: 3108.4033s
	iters: 200, epoch: 14 | loss: 0.2395358
	speed: 0.3029s/iter; left time: 1508.7951s
	iters: 300, epoch: 14 | loss: 0.2103428
	speed: 0.3031s/iter; left time: 1479.2155s
	iters: 400, epoch: 14 | loss: 0.2046797
	speed: 0.3023s/iter; left time: 1445.1118s
	iters: 500, epoch: 14 | loss: 0.1987204
	speed: 0.3017s/iter; left time: 1412.3015s
	iters: 600, epoch: 14 | loss: 0.2249882
	speed: 0.3019s/iter; left time: 1383.2281s
	iters: 700, epoch: 14 | loss: 0.2156709
	speed: 0.3010s/iter; left time: 1348.8839s
Epoch: 14 cost time: 223.73204827308655
Epoch: 14, Steps: 740 | Train Loss: 0.2309066 Vali Loss: 0.3474554 Test Loss: 0.4255386
Validation loss decreased (0.347747 --> 0.347455).  Saving model ...
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 15 | loss: 0.2472117
	speed: 0.6130s/iter; left time: 2661.0407s
	iters: 200, epoch: 15 | loss: 0.2411116
	speed: 0.3025s/iter; left time: 1282.6941s
	iters: 300, epoch: 15 | loss: 0.2036998
	speed: 0.3020s/iter; left time: 1250.6127s
	iters: 400, epoch: 15 | loss: 0.2120593
	speed: 0.3024s/iter; left time: 1221.9677s
	iters: 500, epoch: 15 | loss: 0.2324894
	speed: 0.3016s/iter; left time: 1188.7659s
	iters: 600, epoch: 15 | loss: 0.2533777
	speed: 0.3024s/iter; left time: 1161.5852s
	iters: 700, epoch: 15 | loss: 0.2413334
	speed: 0.3012s/iter; left time: 1126.8975s
Epoch: 15 cost time: 223.57436203956604
Epoch: 15, Steps: 740 | Train Loss: 0.2308900 Vali Loss: 0.3475833 Test Loss: 0.4255264
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 16 | loss: 0.2307081
	speed: 0.6119s/iter; left time: 2203.3029s
	iters: 200, epoch: 16 | loss: 0.2130992
	speed: 0.3033s/iter; left time: 1061.8379s
	iters: 300, epoch: 16 | loss: 0.2277531
	speed: 0.3039s/iter; left time: 1033.6713s
	iters: 400, epoch: 16 | loss: 0.2119827
	speed: 0.3044s/iter; left time: 1004.8591s
	iters: 500, epoch: 16 | loss: 0.2190226
	speed: 0.3052s/iter; left time: 976.9231s
	iters: 600, epoch: 16 | loss: 0.2129952
	speed: 0.3049s/iter; left time: 945.3613s
	iters: 700, epoch: 16 | loss: 0.2208678
	speed: 0.3050s/iter; left time: 915.1676s
Epoch: 16 cost time: 225.0968952178955
Epoch: 16, Steps: 740 | Train Loss: 0.2308438 Vali Loss: 0.3477318 Test Loss: 0.4255258
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 17 | loss: 0.2285852
	speed: 0.6156s/iter; left time: 1761.2281s
	iters: 200, epoch: 17 | loss: 0.2114893
	speed: 0.3042s/iter; left time: 839.9127s
	iters: 300, epoch: 17 | loss: 0.2254348
	speed: 0.3057s/iter; left time: 813.5130s
	iters: 400, epoch: 17 | loss: 0.2364672
	speed: 0.3058s/iter; left time: 783.2501s
	iters: 500, epoch: 17 | loss: 0.2413042
	speed: 0.3053s/iter; left time: 751.2712s
	iters: 600, epoch: 17 | loss: 0.2034637
	speed: 0.3052s/iter; left time: 720.6534s
	iters: 700, epoch: 17 | loss: 0.2004264
	speed: 0.3048s/iter; left time: 689.1153s
Epoch: 17 cost time: 225.87842679023743
Epoch: 17, Steps: 740 | Train Loss: 0.2307644 Vali Loss: 0.3477852 Test Loss: 0.4255246
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 18 | loss: 0.2052779
	speed: 0.6138s/iter; left time: 1301.8001s
	iters: 200, epoch: 18 | loss: 0.1853408
	speed: 0.3051s/iter; left time: 616.6000s
	iters: 300, epoch: 18 | loss: 0.2128048
	speed: 0.3050s/iter; left time: 585.9803s
	iters: 400, epoch: 18 | loss: 0.2087734
	speed: 0.3058s/iter; left time: 556.9404s
	iters: 500, epoch: 18 | loss: 0.2190908
	speed: 0.3050s/iter; left time: 524.9652s
	iters: 600, epoch: 18 | loss: 0.2376247
	speed: 0.3052s/iter; left time: 494.7592s
	iters: 700, epoch: 18 | loss: 0.2470083
	speed: 0.3056s/iter; left time: 464.8300s
Epoch: 18 cost time: 225.85813117027283
Epoch: 18, Steps: 740 | Train Loss: 0.2308072 Vali Loss: 0.3477260 Test Loss: 0.4255241
EarlyStopping counter: 4 out of 5
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 19 | loss: 0.2260439
	speed: 0.6145s/iter; left time: 848.6735s
	iters: 200, epoch: 19 | loss: 0.2124013
	speed: 0.3043s/iter; left time: 389.8116s
	iters: 300, epoch: 19 | loss: 0.2397842
	speed: 0.3049s/iter; left time: 360.0942s
	iters: 400, epoch: 19 | loss: 0.2463114
	speed: 0.3047s/iter; left time: 329.3269s
	iters: 500, epoch: 19 | loss: 0.2329485
	speed: 0.3059s/iter; left time: 300.1073s
	iters: 600, epoch: 19 | loss: 0.2560065
	speed: 0.3048s/iter; left time: 268.5590s
	iters: 700, epoch: 19 | loss: 0.2294266
	speed: 0.3044s/iter; left time: 237.7635s
Epoch: 19 cost time: 225.5706193447113
Epoch: 19, Steps: 740 | Train Loss: 0.2308270 Vali Loss: 0.3477294 Test Loss: 0.4255238
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : traffic_336_96_Linear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed28649<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3413
mse:0.4257907271385193, mae:0.2980577051639557
