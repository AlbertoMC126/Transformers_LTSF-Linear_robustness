Args in experiment:
Namespace(activation='gelu', batch_size=8, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='exchange_rate.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=8, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='mse', lradj='type1', model='Linear', model_id='Exchange_336_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=25565, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : Exchange_336_96_Linear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed25565>>>>>>>>>>>>>>>>>>>>>>>>>>
train 4880
val 665
test 1422
	iters: 100, epoch: 1 | loss: 0.0990434
	speed: 0.0027s/iter; left time: 32.1886s
	iters: 200, epoch: 1 | loss: 0.1074247
	speed: 0.0026s/iter; left time: 31.5849s
	iters: 300, epoch: 1 | loss: 0.0974214
	speed: 0.0030s/iter; left time: 35.4649s
	iters: 400, epoch: 1 | loss: 0.0726520
	speed: 0.0030s/iter; left time: 35.4983s
	iters: 500, epoch: 1 | loss: 0.1069721
	speed: 0.0032s/iter; left time: 37.0925s
	iters: 600, epoch: 1 | loss: 0.2231766
	speed: 0.0029s/iter; left time: 33.3134s
Epoch: 1 cost time: 1.7641541957855225
Epoch: 1, Steps: 610 | Train Loss: 0.1656627 Vali Loss: 0.2796804 Test Loss: 0.1192685
Validation loss decreased (inf --> 0.279680).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1039534
	speed: 0.0046s/iter; left time: 52.6287s
	iters: 200, epoch: 2 | loss: 0.2499775
	speed: 0.0026s/iter; left time: 29.1643s
	iters: 300, epoch: 2 | loss: 0.0835998
	speed: 0.0029s/iter; left time: 32.2042s
	iters: 400, epoch: 2 | loss: 0.2098506
	speed: 0.0031s/iter; left time: 34.8042s
	iters: 500, epoch: 2 | loss: 0.0648249
	speed: 0.0026s/iter; left time: 29.3911s
	iters: 600, epoch: 2 | loss: 0.1263949
	speed: 0.0026s/iter; left time: 28.8134s
Epoch: 2 cost time: 1.6864333152770996
Epoch: 2, Steps: 610 | Train Loss: 0.1283096 Vali Loss: 0.2149543 Test Loss: 0.1108891
Validation loss decreased (0.279680 --> 0.214954).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1205194
	speed: 0.0051s/iter; left time: 55.4966s
	iters: 200, epoch: 3 | loss: 0.1558034
	speed: 0.0031s/iter; left time: 33.7442s
	iters: 300, epoch: 3 | loss: 0.1293766
	speed: 0.0031s/iter; left time: 33.2425s
	iters: 400, epoch: 3 | loss: 0.1375182
	speed: 0.0031s/iter; left time: 33.2295s
	iters: 500, epoch: 3 | loss: 0.0971541
	speed: 0.0028s/iter; left time: 29.0323s
	iters: 600, epoch: 3 | loss: 0.1668202
	speed: 0.0027s/iter; left time: 28.4637s
Epoch: 3 cost time: 1.861469030380249
Epoch: 3, Steps: 610 | Train Loss: 0.1198604 Vali Loss: 0.1983836 Test Loss: 0.1051441
Validation loss decreased (0.214954 --> 0.198384).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.0617490
	speed: 0.0050s/iter; left time: 51.4578s
	iters: 200, epoch: 4 | loss: 0.0702436
	speed: 0.0035s/iter; left time: 35.8072s
	iters: 300, epoch: 4 | loss: 0.0630599
	speed: 0.0034s/iter; left time: 34.6707s
	iters: 400, epoch: 4 | loss: 0.0961718
	speed: 0.0035s/iter; left time: 35.2973s
	iters: 500, epoch: 4 | loss: 0.1103203
	speed: 0.0035s/iter; left time: 34.4498s
	iters: 600, epoch: 4 | loss: 0.0853170
	speed: 0.0033s/iter; left time: 31.9713s
Epoch: 4 cost time: 2.081521511077881
Epoch: 4, Steps: 610 | Train Loss: 0.1165729 Vali Loss: 0.2104265 Test Loss: 0.1031771
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1206343
	speed: 0.0048s/iter; left time: 46.3729s
	iters: 200, epoch: 5 | loss: 0.0921156
	speed: 0.0029s/iter; left time: 27.2622s
	iters: 300, epoch: 5 | loss: 0.1534149
	speed: 0.0028s/iter; left time: 26.6664s
	iters: 400, epoch: 5 | loss: 0.0900448
	speed: 0.0032s/iter; left time: 30.4230s
	iters: 500, epoch: 5 | loss: 0.1252443
	speed: 0.0030s/iter; left time: 27.9682s
	iters: 600, epoch: 5 | loss: 0.0581369
	speed: 0.0029s/iter; left time: 26.8591s
Epoch: 5 cost time: 1.806182622909546
Epoch: 5, Steps: 610 | Train Loss: 0.1149448 Vali Loss: 0.2167454 Test Loss: 0.0909074
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1093832
	speed: 0.0048s/iter; left time: 43.4447s
	iters: 200, epoch: 6 | loss: 0.1401219
	speed: 0.0026s/iter; left time: 23.5458s
	iters: 300, epoch: 6 | loss: 0.0608791
	speed: 0.0025s/iter; left time: 22.1447s
	iters: 400, epoch: 6 | loss: 0.0727186
	speed: 0.0031s/iter; left time: 26.9531s
	iters: 500, epoch: 6 | loss: 0.0825806
	speed: 0.0031s/iter; left time: 26.6451s
	iters: 600, epoch: 6 | loss: 0.0767964
	speed: 0.0027s/iter; left time: 23.3673s
Epoch: 6 cost time: 1.7095136642456055
Epoch: 6, Steps: 610 | Train Loss: 0.1140948 Vali Loss: 0.2071462 Test Loss: 0.0928813
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.0877457
	speed: 0.0044s/iter; left time: 37.0600s
	iters: 200, epoch: 7 | loss: 0.0837426
	speed: 0.0027s/iter; left time: 22.1871s
	iters: 300, epoch: 7 | loss: 0.1130450
	speed: 0.0027s/iter; left time: 22.3572s
	iters: 400, epoch: 7 | loss: 0.1425271
	speed: 0.0032s/iter; left time: 26.0513s
	iters: 500, epoch: 7 | loss: 0.0709715
	speed: 0.0031s/iter; left time: 24.6900s
	iters: 600, epoch: 7 | loss: 0.1493606
	speed: 0.0032s/iter; left time: 25.1077s
Epoch: 7 cost time: 1.779524564743042
Epoch: 7, Steps: 610 | Train Loss: 0.1135383 Vali Loss: 0.2042271 Test Loss: 0.0916184
EarlyStopping counter: 4 out of 5
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.1446238
	speed: 0.0052s/iter; left time: 40.3993s
	iters: 200, epoch: 8 | loss: 0.0784502
	speed: 0.0032s/iter; left time: 24.5846s
	iters: 300, epoch: 8 | loss: 0.0665437
	speed: 0.0034s/iter; left time: 25.7332s
	iters: 400, epoch: 8 | loss: 0.0829449
	speed: 0.0030s/iter; left time: 22.3669s
	iters: 500, epoch: 8 | loss: 0.1864226
	speed: 0.0027s/iter; left time: 19.9151s
	iters: 600, epoch: 8 | loss: 0.1128775
	speed: 0.0027s/iter; left time: 19.8794s
Epoch: 8 cost time: 1.8293845653533936
Epoch: 8, Steps: 610 | Train Loss: 0.1133146 Vali Loss: 0.2174409 Test Loss: 0.0921605
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : Exchange_336_96_Linear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed25565<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 1422
mse:0.10498648881912231, mae:0.23830999433994293
