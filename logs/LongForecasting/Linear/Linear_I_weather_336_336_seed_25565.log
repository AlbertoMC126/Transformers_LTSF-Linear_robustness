Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='Linear', model_id='weather_336_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=336, root_path='./dataset/', save_pred_values=False, seed=25565, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : weather_336_336_Linear_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed25565>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36216
val 4935
test 10204
	iters: 100, epoch: 1 | loss: 0.5970161
	speed: 0.0249s/iter; left time: 1126.1146s
	iters: 200, epoch: 1 | loss: 0.4338453
	speed: 0.0247s/iter; left time: 1112.5677s
	iters: 300, epoch: 1 | loss: 0.4820226
	speed: 0.0249s/iter; left time: 1118.9027s
	iters: 400, epoch: 1 | loss: 1.0142502
	speed: 0.0245s/iter; left time: 1096.9119s
	iters: 500, epoch: 1 | loss: 0.5249655
	speed: 0.0249s/iter; left time: 1114.5089s
	iters: 600, epoch: 1 | loss: 0.5958562
	speed: 0.0250s/iter; left time: 1115.4321s
	iters: 700, epoch: 1 | loss: 0.6636639
	speed: 0.0246s/iter; left time: 1095.1841s
	iters: 800, epoch: 1 | loss: 1.5868615
	speed: 0.0248s/iter; left time: 1104.0401s
	iters: 900, epoch: 1 | loss: 1.2573990
	speed: 0.0246s/iter; left time: 1090.1679s
	iters: 1000, epoch: 1 | loss: 0.6111863
	speed: 0.0248s/iter; left time: 1096.0698s
	iters: 1100, epoch: 1 | loss: 0.5043525
	speed: 0.0245s/iter; left time: 1083.1769s
	iters: 1200, epoch: 1 | loss: 0.6168512
	speed: 0.0250s/iter; left time: 1102.0688s
	iters: 1300, epoch: 1 | loss: 0.6705949
	speed: 0.0248s/iter; left time: 1090.4927s
	iters: 1400, epoch: 1 | loss: 0.8589138
	speed: 0.0247s/iter; left time: 1081.5909s
	iters: 1500, epoch: 1 | loss: 0.6002901
	speed: 0.0246s/iter; left time: 1078.6671s
	iters: 1600, epoch: 1 | loss: 0.9887136
	speed: 0.0246s/iter; left time: 1072.3703s
	iters: 1700, epoch: 1 | loss: 0.4102479
	speed: 0.0246s/iter; left time: 1071.5351s
	iters: 1800, epoch: 1 | loss: 4.3240871
	speed: 0.0249s/iter; left time: 1080.9236s
	iters: 1900, epoch: 1 | loss: 0.4993667
	speed: 0.0247s/iter; left time: 1070.3457s
	iters: 2000, epoch: 1 | loss: 0.4716714
	speed: 0.0245s/iter; left time: 1058.5654s
	iters: 2100, epoch: 1 | loss: 0.5887060
	speed: 0.0247s/iter; left time: 1067.9307s
	iters: 2200, epoch: 1 | loss: 1.0558000
	speed: 0.0246s/iter; left time: 1061.0511s
Epoch: 1 cost time: 55.854809045791626
Epoch: 1, Steps: 2263 | Train Loss: 1.3981709 Vali Loss: 0.6561770 Test Loss: 0.3253248
Validation loss decreased (inf --> 0.656177).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 1.0908456
	speed: 0.0797s/iter; left time: 3418.1324s
	iters: 200, epoch: 2 | loss: 2.5258405
	speed: 0.0245s/iter; left time: 1046.4415s
	iters: 300, epoch: 2 | loss: 1.1471905
	speed: 0.0244s/iter; left time: 1042.5938s
	iters: 400, epoch: 2 | loss: 0.6510535
	speed: 0.0248s/iter; left time: 1056.0549s
	iters: 500, epoch: 2 | loss: 0.5705386
	speed: 0.0247s/iter; left time: 1049.9946s
	iters: 600, epoch: 2 | loss: 0.6377738
	speed: 0.0244s/iter; left time: 1034.7679s
	iters: 700, epoch: 2 | loss: 0.9688703
	speed: 0.0238s/iter; left time: 1006.9042s
	iters: 800, epoch: 2 | loss: 0.4208978
	speed: 0.0246s/iter; left time: 1038.1947s
	iters: 900, epoch: 2 | loss: 0.5436031
	speed: 0.0246s/iter; left time: 1037.2127s
	iters: 1000, epoch: 2 | loss: 0.4676816
	speed: 0.0244s/iter; left time: 1024.9142s
	iters: 1100, epoch: 2 | loss: 0.5427181
	speed: 0.0247s/iter; left time: 1033.9749s
	iters: 1200, epoch: 2 | loss: 1.0555488
	speed: 0.0242s/iter; left time: 1011.6823s
	iters: 1300, epoch: 2 | loss: 0.5921606
	speed: 0.0248s/iter; left time: 1034.9708s
	iters: 1400, epoch: 2 | loss: 0.6013402
	speed: 0.0241s/iter; left time: 1003.3146s
	iters: 1500, epoch: 2 | loss: 0.5008641
	speed: 0.0246s/iter; left time: 1022.1471s
	iters: 1600, epoch: 2 | loss: 0.4927012
	speed: 0.0244s/iter; left time: 1010.1883s
	iters: 1700, epoch: 2 | loss: 0.5489169
	speed: 0.0241s/iter; left time: 995.4263s
	iters: 1800, epoch: 2 | loss: 6.8496027
	speed: 0.0243s/iter; left time: 1000.1339s
	iters: 1900, epoch: 2 | loss: 0.4450802
	speed: 0.0246s/iter; left time: 1012.3004s
	iters: 2000, epoch: 2 | loss: 0.6337049
	speed: 0.0241s/iter; left time: 989.4630s
	iters: 2100, epoch: 2 | loss: 0.3863506
	speed: 0.0246s/iter; left time: 1005.5379s
	iters: 2200, epoch: 2 | loss: 3.3085206
	speed: 0.0244s/iter; left time: 996.3211s
Epoch: 2 cost time: 55.18566012382507
Epoch: 2, Steps: 2263 | Train Loss: 1.1042517 Vali Loss: 0.6829624 Test Loss: 0.3110076
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 15.1549768
	speed: 0.0798s/iter; left time: 3240.8705s
	iters: 200, epoch: 3 | loss: 0.4053935
	speed: 0.0249s/iter; left time: 1007.7120s
	iters: 300, epoch: 3 | loss: 4.3851843
	speed: 0.0247s/iter; left time: 1000.6230s
	iters: 400, epoch: 3 | loss: 0.4355460
	speed: 0.0240s/iter; left time: 968.8240s
	iters: 500, epoch: 3 | loss: 1.4977870
	speed: 0.0248s/iter; left time: 996.5144s
	iters: 600, epoch: 3 | loss: 0.8729560
	speed: 0.0243s/iter; left time: 975.4964s
	iters: 700, epoch: 3 | loss: 0.4340216
	speed: 0.0245s/iter; left time: 980.9048s
	iters: 800, epoch: 3 | loss: 0.9884340
	speed: 0.0245s/iter; left time: 978.1386s
	iters: 900, epoch: 3 | loss: 0.4143157
	speed: 0.0251s/iter; left time: 999.4352s
	iters: 1000, epoch: 3 | loss: 2.6950195
	speed: 0.0244s/iter; left time: 967.6174s
	iters: 1100, epoch: 3 | loss: 0.8937626
	speed: 0.0239s/iter; left time: 947.2613s
	iters: 1200, epoch: 3 | loss: 0.4212200
	speed: 0.0246s/iter; left time: 971.7429s
	iters: 1300, epoch: 3 | loss: 0.4681156
	speed: 0.0244s/iter; left time: 963.2164s
	iters: 1400, epoch: 3 | loss: 0.3902861
	speed: 0.0242s/iter; left time: 953.1772s
	iters: 1500, epoch: 3 | loss: 0.3911204
	speed: 0.0247s/iter; left time: 968.1541s
	iters: 1600, epoch: 3 | loss: 0.4330217
	speed: 0.0241s/iter; left time: 941.2847s
	iters: 1700, epoch: 3 | loss: 2.1521111
	speed: 0.0246s/iter; left time: 960.2376s
	iters: 1800, epoch: 3 | loss: 1.1095828
	speed: 0.0243s/iter; left time: 947.7974s
	iters: 1900, epoch: 3 | loss: 0.4368937
	speed: 0.0245s/iter; left time: 951.1526s
	iters: 2000, epoch: 3 | loss: 0.4713173
	speed: 0.0241s/iter; left time: 935.3075s
	iters: 2100, epoch: 3 | loss: 1.2328218
	speed: 0.0245s/iter; left time: 945.9560s
	iters: 2200, epoch: 3 | loss: 0.4072474
	speed: 0.0243s/iter; left time: 934.9524s
Epoch: 3 cost time: 55.21151804924011
Epoch: 3, Steps: 2263 | Train Loss: 0.7908261 Vali Loss: 0.5433661 Test Loss: 0.2855225
Validation loss decreased (0.656177 --> 0.543366).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.4098263
	speed: 0.0799s/iter; left time: 3067.7367s
	iters: 200, epoch: 4 | loss: 0.3617150
	speed: 0.0250s/iter; left time: 956.4885s
	iters: 300, epoch: 4 | loss: 0.7566448
	speed: 0.0245s/iter; left time: 933.9636s
	iters: 400, epoch: 4 | loss: 0.3925691
	speed: 0.0246s/iter; left time: 937.7718s
	iters: 500, epoch: 4 | loss: 0.4282231
	speed: 0.0246s/iter; left time: 933.2841s
	iters: 600, epoch: 4 | loss: 0.6028705
	speed: 0.0245s/iter; left time: 929.1228s
	iters: 700, epoch: 4 | loss: 0.9530499
	speed: 0.0245s/iter; left time: 924.6168s
	iters: 800, epoch: 4 | loss: 0.4116035
	speed: 0.0244s/iter; left time: 919.6962s
	iters: 900, epoch: 4 | loss: 0.3788279
	speed: 0.0245s/iter; left time: 918.6561s
	iters: 1000, epoch: 4 | loss: 0.4432593
	speed: 0.0249s/iter; left time: 931.9589s
	iters: 1100, epoch: 4 | loss: 0.4256074
	speed: 0.0246s/iter; left time: 921.1394s
	iters: 1200, epoch: 4 | loss: 0.4000303
	speed: 0.0242s/iter; left time: 901.7314s
	iters: 1300, epoch: 4 | loss: 0.2718223
	speed: 0.0244s/iter; left time: 905.5502s
	iters: 1400, epoch: 4 | loss: 5.4470711
	speed: 0.0244s/iter; left time: 904.9323s
	iters: 1500, epoch: 4 | loss: 0.3433102
	speed: 0.0245s/iter; left time: 904.7818s
	iters: 1600, epoch: 4 | loss: 0.9336464
	speed: 0.0250s/iter; left time: 919.9677s
	iters: 1700, epoch: 4 | loss: 0.4182008
	speed: 0.0242s/iter; left time: 889.8261s
	iters: 1800, epoch: 4 | loss: 0.3611696
	speed: 0.0246s/iter; left time: 902.3853s
	iters: 1900, epoch: 4 | loss: 0.5025143
	speed: 0.0243s/iter; left time: 889.8311s
	iters: 2000, epoch: 4 | loss: 0.9019043
	speed: 0.0249s/iter; left time: 906.7984s
	iters: 2100, epoch: 4 | loss: 0.3579078
	speed: 0.0244s/iter; left time: 887.5467s
	iters: 2200, epoch: 4 | loss: 0.4808678
	speed: 0.0245s/iter; left time: 889.3527s
Epoch: 4 cost time: 55.323988914489746
Epoch: 4, Steps: 2263 | Train Loss: 0.6367216 Vali Loss: 0.5251845 Test Loss: 0.2506600
Validation loss decreased (0.543366 --> 0.525184).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.4904584
	speed: 0.0795s/iter; left time: 2868.9581s
	iters: 200, epoch: 5 | loss: 0.3527393
	speed: 0.0250s/iter; left time: 898.4370s
	iters: 300, epoch: 5 | loss: 0.4875133
	speed: 0.0246s/iter; left time: 882.7856s
	iters: 400, epoch: 5 | loss: 0.5722632
	speed: 0.0246s/iter; left time: 880.1814s
	iters: 500, epoch: 5 | loss: 0.4551156
	speed: 0.0250s/iter; left time: 892.7806s
	iters: 600, epoch: 5 | loss: 0.9711763
	speed: 0.0249s/iter; left time: 887.5336s
	iters: 700, epoch: 5 | loss: 0.3417895
	speed: 0.0251s/iter; left time: 892.4907s
	iters: 800, epoch: 5 | loss: 0.3208568
	speed: 0.0247s/iter; left time: 873.1120s
	iters: 900, epoch: 5 | loss: 0.3264888
	speed: 0.0247s/iter; left time: 873.7645s
	iters: 1000, epoch: 5 | loss: 0.4828829
	speed: 0.0244s/iter; left time: 858.6885s
	iters: 1100, epoch: 5 | loss: 0.5601175
	speed: 0.0252s/iter; left time: 883.4446s
	iters: 1200, epoch: 5 | loss: 0.5533414
	speed: 0.0249s/iter; left time: 873.1134s
	iters: 1300, epoch: 5 | loss: 0.4397582
	speed: 0.0248s/iter; left time: 865.4991s
	iters: 1400, epoch: 5 | loss: 0.4379386
	speed: 0.0243s/iter; left time: 845.3780s
	iters: 1500, epoch: 5 | loss: 0.4609224
	speed: 0.0248s/iter; left time: 860.8648s
	iters: 1600, epoch: 5 | loss: 0.6443114
	speed: 0.0242s/iter; left time: 836.7606s
	iters: 1700, epoch: 5 | loss: 0.4404484
	speed: 0.0244s/iter; left time: 840.4495s
	iters: 1800, epoch: 5 | loss: 0.5265283
	speed: 0.0239s/iter; left time: 821.8362s
	iters: 1900, epoch: 5 | loss: 0.4431850
	speed: 0.0246s/iter; left time: 845.7096s
	iters: 2000, epoch: 5 | loss: 0.4130061
	speed: 0.0248s/iter; left time: 848.6566s
	iters: 2100, epoch: 5 | loss: 0.5122945
	speed: 0.0245s/iter; left time: 837.1641s
	iters: 2200, epoch: 5 | loss: 0.3975794
	speed: 0.0240s/iter; left time: 815.7856s
Epoch: 5 cost time: 55.49834227561951
Epoch: 5, Steps: 2263 | Train Loss: 0.5918831 Vali Loss: 0.5191097 Test Loss: 0.2545208
Validation loss decreased (0.525184 --> 0.519110).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 1.1115658
	speed: 0.0797s/iter; left time: 2697.1223s
	iters: 200, epoch: 6 | loss: 0.5643333
	speed: 0.0245s/iter; left time: 825.3196s
	iters: 300, epoch: 6 | loss: 0.3477896
	speed: 0.0249s/iter; left time: 836.1623s
	iters: 400, epoch: 6 | loss: 0.3478288
	speed: 0.0248s/iter; left time: 830.4686s
	iters: 500, epoch: 6 | loss: 0.3750024
	speed: 0.0243s/iter; left time: 812.3768s
	iters: 600, epoch: 6 | loss: 0.3784454
	speed: 0.0246s/iter; left time: 819.3088s
	iters: 700, epoch: 6 | loss: 0.4660693
	speed: 0.0243s/iter; left time: 807.1844s
	iters: 800, epoch: 6 | loss: 0.4056799
	speed: 0.0247s/iter; left time: 817.5132s
	iters: 900, epoch: 6 | loss: 0.3074976
	speed: 0.0244s/iter; left time: 806.3893s
	iters: 1000, epoch: 6 | loss: 0.3748799
	speed: 0.0246s/iter; left time: 809.3353s
	iters: 1100, epoch: 6 | loss: 0.3507949
	speed: 0.0243s/iter; left time: 799.5407s
	iters: 1200, epoch: 6 | loss: 0.3571153
	speed: 0.0249s/iter; left time: 813.8768s
	iters: 1300, epoch: 6 | loss: 0.5878611
	speed: 0.0249s/iter; left time: 811.6820s
	iters: 1400, epoch: 6 | loss: 0.6017570
	speed: 0.0244s/iter; left time: 792.8378s
	iters: 1500, epoch: 6 | loss: 0.5243074
	speed: 0.0240s/iter; left time: 780.1047s
	iters: 1600, epoch: 6 | loss: 0.4692872
	speed: 0.0249s/iter; left time: 804.5170s
	iters: 1700, epoch: 6 | loss: 0.5708016
	speed: 0.0243s/iter; left time: 782.0249s
	iters: 1800, epoch: 6 | loss: 0.5032585
	speed: 0.0249s/iter; left time: 801.0833s
	iters: 1900, epoch: 6 | loss: 0.3309425
	speed: 0.0247s/iter; left time: 790.9915s
	iters: 2000, epoch: 6 | loss: 0.4160190
	speed: 0.0244s/iter; left time: 780.8145s
	iters: 2100, epoch: 6 | loss: 0.8704911
	speed: 0.0243s/iter; left time: 775.3247s
	iters: 2200, epoch: 6 | loss: 0.3574620
	speed: 0.0240s/iter; left time: 760.6359s
Epoch: 6 cost time: 55.110782623291016
Epoch: 6, Steps: 2263 | Train Loss: 0.5727415 Vali Loss: 0.4929092 Test Loss: 0.2401399
Validation loss decreased (0.519110 --> 0.492909).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 1.0164607
	speed: 0.0800s/iter; left time: 2526.2312s
	iters: 200, epoch: 7 | loss: 0.4546575
	speed: 0.0242s/iter; left time: 762.8180s
	iters: 300, epoch: 7 | loss: 0.4702604
	speed: 0.0240s/iter; left time: 752.8871s
	iters: 400, epoch: 7 | loss: 0.9832209
	speed: 0.0242s/iter; left time: 756.6744s
	iters: 500, epoch: 7 | loss: 0.4251980
	speed: 0.0244s/iter; left time: 762.3063s
	iters: 600, epoch: 7 | loss: 1.5103823
	speed: 0.0242s/iter; left time: 752.7631s
	iters: 700, epoch: 7 | loss: 0.4428076
	speed: 0.0241s/iter; left time: 745.3377s
	iters: 800, epoch: 7 | loss: 0.3932647
	speed: 0.0243s/iter; left time: 749.1579s
	iters: 900, epoch: 7 | loss: 0.3800724
	speed: 0.0239s/iter; left time: 737.0838s
	iters: 1000, epoch: 7 | loss: 0.4376568
	speed: 0.0244s/iter; left time: 747.2264s
	iters: 1100, epoch: 7 | loss: 0.3984076
	speed: 0.0249s/iter; left time: 761.0900s
	iters: 1200, epoch: 7 | loss: 0.4277421
	speed: 0.0247s/iter; left time: 754.1722s
	iters: 1300, epoch: 7 | loss: 0.5238150
	speed: 0.0241s/iter; left time: 733.4657s
	iters: 1400, epoch: 7 | loss: 0.4027532
	speed: 0.0242s/iter; left time: 731.8523s
	iters: 1500, epoch: 7 | loss: 0.3400295
	speed: 0.0245s/iter; left time: 740.7469s
	iters: 1600, epoch: 7 | loss: 0.4485938
	speed: 0.0241s/iter; left time: 725.9963s
	iters: 1700, epoch: 7 | loss: 0.3463234
	speed: 0.0242s/iter; left time: 725.1706s
	iters: 1800, epoch: 7 | loss: 0.4861856
	speed: 0.0244s/iter; left time: 728.4381s
	iters: 1900, epoch: 7 | loss: 0.4926833
	speed: 0.0246s/iter; left time: 732.5263s
	iters: 2000, epoch: 7 | loss: 0.3611667
	speed: 0.0241s/iter; left time: 716.6749s
	iters: 2100, epoch: 7 | loss: 0.6948433
	speed: 0.0244s/iter; left time: 721.2325s
	iters: 2200, epoch: 7 | loss: 0.4364673
	speed: 0.0239s/iter; left time: 704.6963s
Epoch: 7 cost time: 54.57492208480835
Epoch: 7, Steps: 2263 | Train Loss: 0.5637088 Vali Loss: 0.5006431 Test Loss: 0.2412677
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.3403585
	speed: 0.0793s/iter; left time: 2324.9220s
	iters: 200, epoch: 8 | loss: 0.5512849
	speed: 0.0240s/iter; left time: 701.4590s
	iters: 300, epoch: 8 | loss: 0.2928641
	speed: 0.0248s/iter; left time: 721.5113s
	iters: 400, epoch: 8 | loss: 0.3501309
	speed: 0.0242s/iter; left time: 702.2422s
	iters: 500, epoch: 8 | loss: 2.1816916
	speed: 0.0247s/iter; left time: 714.8975s
	iters: 600, epoch: 8 | loss: 0.3972174
	speed: 0.0244s/iter; left time: 704.3441s
	iters: 700, epoch: 8 | loss: 0.3200609
	speed: 0.0243s/iter; left time: 697.2861s
	iters: 800, epoch: 8 | loss: 0.4017094
	speed: 0.0245s/iter; left time: 701.4965s
	iters: 900, epoch: 8 | loss: 0.3682480
	speed: 0.0248s/iter; left time: 706.9891s
	iters: 1000, epoch: 8 | loss: 0.4359685
	speed: 0.0249s/iter; left time: 707.8012s
	iters: 1100, epoch: 8 | loss: 0.4375673
	speed: 0.0253s/iter; left time: 716.3049s
	iters: 1200, epoch: 8 | loss: 0.5192742
	speed: 0.0238s/iter; left time: 671.0534s
	iters: 1300, epoch: 8 | loss: 0.3240803
	speed: 0.0253s/iter; left time: 711.5096s
	iters: 1400, epoch: 8 | loss: 1.0248985
	speed: 0.0251s/iter; left time: 702.4875s
	iters: 1500, epoch: 8 | loss: 0.3560707
	speed: 0.0244s/iter; left time: 681.3055s
	iters: 1600, epoch: 8 | loss: 0.3105732
	speed: 0.0249s/iter; left time: 692.0667s
	iters: 1700, epoch: 8 | loss: 0.3393514
	speed: 0.0249s/iter; left time: 691.0104s
	iters: 1800, epoch: 8 | loss: 0.3707247
	speed: 0.0247s/iter; left time: 681.8359s
	iters: 1900, epoch: 8 | loss: 0.3309582
	speed: 0.0242s/iter; left time: 664.8008s
	iters: 2000, epoch: 8 | loss: 0.6324131
	speed: 0.0251s/iter; left time: 688.6658s
	iters: 2100, epoch: 8 | loss: 0.3453680
	speed: 0.0241s/iter; left time: 657.6719s
	iters: 2200, epoch: 8 | loss: 0.6048380
	speed: 0.0238s/iter; left time: 647.5648s
Epoch: 8 cost time: 55.24532747268677
Epoch: 8, Steps: 2263 | Train Loss: 0.5592115 Vali Loss: 0.4966316 Test Loss: 0.2449101
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.5628111
	speed: 0.0805s/iter; left time: 2177.1239s
	iters: 200, epoch: 9 | loss: 0.4041376
	speed: 0.0255s/iter; left time: 687.8424s
	iters: 300, epoch: 9 | loss: 0.3663053
	speed: 0.0255s/iter; left time: 684.5140s
	iters: 400, epoch: 9 | loss: 0.3661351
	speed: 0.0251s/iter; left time: 670.3068s
	iters: 500, epoch: 9 | loss: 0.4058896
	speed: 0.0254s/iter; left time: 676.8978s
	iters: 600, epoch: 9 | loss: 0.4676894
	speed: 0.0258s/iter; left time: 686.0914s
	iters: 700, epoch: 9 | loss: 0.3004504
	speed: 0.0256s/iter; left time: 676.2126s
	iters: 800, epoch: 9 | loss: 0.4167082
	speed: 0.0249s/iter; left time: 657.1333s
	iters: 900, epoch: 9 | loss: 0.3437642
	speed: 0.0257s/iter; left time: 673.8021s
	iters: 1000, epoch: 9 | loss: 0.3883666
	speed: 0.0240s/iter; left time: 628.8847s
	iters: 1100, epoch: 9 | loss: 0.4961616
	speed: 0.0239s/iter; left time: 622.2692s
	iters: 1200, epoch: 9 | loss: 0.3339823
	speed: 0.0224s/iter; left time: 581.1648s
	iters: 1300, epoch: 9 | loss: 0.4967860
	speed: 0.0235s/iter; left time: 608.4527s
	iters: 1400, epoch: 9 | loss: 0.4677487
	speed: 0.0225s/iter; left time: 580.3453s
	iters: 1500, epoch: 9 | loss: 0.3543640
	speed: 0.0223s/iter; left time: 572.9828s
	iters: 1600, epoch: 9 | loss: 0.4360882
	speed: 0.0225s/iter; left time: 575.7455s
	iters: 1700, epoch: 9 | loss: 0.3382365
	speed: 0.0209s/iter; left time: 532.9257s
	iters: 1800, epoch: 9 | loss: 0.3419123
	speed: 0.0229s/iter; left time: 580.1290s
	iters: 1900, epoch: 9 | loss: 0.4069401
	speed: 0.0238s/iter; left time: 602.1980s
	iters: 2000, epoch: 9 | loss: 0.3753976
	speed: 0.0227s/iter; left time: 570.3595s
	iters: 2100, epoch: 9 | loss: 0.3188478
	speed: 0.0223s/iter; left time: 558.7357s
	iters: 2200, epoch: 9 | loss: 0.4592873
	speed: 0.0228s/iter; left time: 567.9672s
Epoch: 9 cost time: 53.5435152053833
Epoch: 9, Steps: 2263 | Train Loss: 0.5569721 Vali Loss: 0.4977023 Test Loss: 0.2411866
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.4824961
	speed: 0.0819s/iter; left time: 2029.4385s
	iters: 200, epoch: 10 | loss: 0.3403451
	speed: 0.0248s/iter; left time: 611.8883s
	iters: 300, epoch: 10 | loss: 0.3044950
	speed: 0.0250s/iter; left time: 615.4289s
	iters: 400, epoch: 10 | loss: 0.3766791
	speed: 0.0238s/iter; left time: 581.9120s
	iters: 500, epoch: 10 | loss: 0.7104536
	speed: 0.0206s/iter; left time: 502.3090s
	iters: 600, epoch: 10 | loss: 0.5416177
	speed: 0.0232s/iter; left time: 562.6610s
	iters: 700, epoch: 10 | loss: 0.4078132
	speed: 0.0221s/iter; left time: 533.8325s
	iters: 800, epoch: 10 | loss: 0.4365417
	speed: 0.0245s/iter; left time: 590.5804s
	iters: 900, epoch: 10 | loss: 0.9729003
	speed: 0.0226s/iter; left time: 543.1998s
	iters: 1000, epoch: 10 | loss: 0.4035972
	speed: 0.0225s/iter; left time: 537.0771s
	iters: 1100, epoch: 10 | loss: 1.0073296
	speed: 0.0240s/iter; left time: 571.2129s
	iters: 1200, epoch: 10 | loss: 0.4458950
	speed: 0.0220s/iter; left time: 521.0538s
	iters: 1300, epoch: 10 | loss: 0.3230509
	speed: 0.0250s/iter; left time: 589.9102s
	iters: 1400, epoch: 10 | loss: 0.3216807
	speed: 0.0233s/iter; left time: 547.9143s
	iters: 1500, epoch: 10 | loss: 0.4156525
	speed: 0.0241s/iter; left time: 563.3764s
	iters: 1600, epoch: 10 | loss: 0.3883380
	speed: 0.0245s/iter; left time: 570.0114s
	iters: 1700, epoch: 10 | loss: 0.4833330
	speed: 0.0235s/iter; left time: 545.0001s
	iters: 1800, epoch: 10 | loss: 0.5067301
	speed: 0.0235s/iter; left time: 543.2341s
	iters: 1900, epoch: 10 | loss: 0.5561595
	speed: 0.0234s/iter; left time: 538.6877s
	iters: 2000, epoch: 10 | loss: 0.3452090
	speed: 0.0237s/iter; left time: 542.2301s
	iters: 2100, epoch: 10 | loss: 0.3873364
	speed: 0.0231s/iter; left time: 527.2985s
	iters: 2200, epoch: 10 | loss: 0.3770635
	speed: 0.0192s/iter; left time: 434.6354s
Epoch: 10 cost time: 52.36559009552002
Epoch: 10, Steps: 2263 | Train Loss: 0.5558706 Vali Loss: 0.4953725 Test Loss: 0.2413158
EarlyStopping counter: 4 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.5298194
	speed: 0.0874s/iter; left time: 1968.5530s
	iters: 200, epoch: 11 | loss: 0.2691005
	speed: 0.0221s/iter; left time: 496.3989s
	iters: 300, epoch: 11 | loss: 0.3282334
	speed: 0.0210s/iter; left time: 469.6340s
	iters: 400, epoch: 11 | loss: 0.4191950
	speed: 0.0230s/iter; left time: 512.3842s
	iters: 500, epoch: 11 | loss: 0.3194008
	speed: 0.0220s/iter; left time: 486.6028s
	iters: 600, epoch: 11 | loss: 0.3101506
	speed: 0.0218s/iter; left time: 481.1110s
	iters: 700, epoch: 11 | loss: 0.5300208
	speed: 0.0210s/iter; left time: 461.6397s
	iters: 800, epoch: 11 | loss: 0.4427123
	speed: 0.0220s/iter; left time: 480.9061s
	iters: 900, epoch: 11 | loss: 0.3655784
	speed: 0.0229s/iter; left time: 498.3073s
	iters: 1000, epoch: 11 | loss: 0.4353730
	speed: 0.0232s/iter; left time: 501.2996s
	iters: 1100, epoch: 11 | loss: 0.5552429
	speed: 0.0254s/iter; left time: 546.0819s
	iters: 1200, epoch: 11 | loss: 0.8524984
	speed: 0.0231s/iter; left time: 494.7994s
	iters: 1300, epoch: 11 | loss: 0.4172883
	speed: 0.0227s/iter; left time: 484.7383s
	iters: 1400, epoch: 11 | loss: 0.7907304
	speed: 0.0231s/iter; left time: 491.0326s
	iters: 1500, epoch: 11 | loss: 0.4278908
	speed: 0.0238s/iter; left time: 502.7418s
	iters: 1600, epoch: 11 | loss: 0.3129367
	speed: 0.0230s/iter; left time: 484.5776s
	iters: 1700, epoch: 11 | loss: 0.4331420
	speed: 0.0227s/iter; left time: 475.2375s
	iters: 1800, epoch: 11 | loss: 0.9381764
	speed: 0.0234s/iter; left time: 488.3010s
	iters: 1900, epoch: 11 | loss: 0.4882655
	speed: 0.0239s/iter; left time: 494.6621s
	iters: 2000, epoch: 11 | loss: 0.4344392
	speed: 0.0248s/iter; left time: 512.3527s
	iters: 2100, epoch: 11 | loss: 0.3969711
	speed: 0.0202s/iter; left time: 413.8100s
	iters: 2200, epoch: 11 | loss: 0.3300890
	speed: 0.0186s/iter; left time: 380.5037s
Epoch: 11 cost time: 50.884424448013306
Epoch: 11, Steps: 2263 | Train Loss: 0.5552402 Vali Loss: 0.4959655 Test Loss: 0.2418673
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : weather_336_336_Linear_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed25565<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10204
mse:0.24020425975322723, mae:0.30001887679100037
