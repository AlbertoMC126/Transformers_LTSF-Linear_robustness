Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='DLinear', model_id='traffic_336_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=336, root_path='./dataset/', save_pred_values=False, seed=25565, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_336_336_DLinear_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed25565>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11609
val 1421
test 3173
	iters: 100, epoch: 1 | loss: 0.5373627
	speed: 0.4600s/iter; left time: 6624.3837s
	iters: 200, epoch: 1 | loss: 0.5744236
	speed: 0.4487s/iter; left time: 6416.7282s
	iters: 300, epoch: 1 | loss: 0.6970619
	speed: 0.4482s/iter; left time: 6365.2278s
	iters: 400, epoch: 1 | loss: 0.6095982
	speed: 0.4392s/iter; left time: 6193.5116s
	iters: 500, epoch: 1 | loss: 0.6166946
	speed: 0.4576s/iter; left time: 6406.3413s
	iters: 600, epoch: 1 | loss: 0.5809981
	speed: 0.4505s/iter; left time: 6262.9749s
	iters: 700, epoch: 1 | loss: 0.5292512
	speed: 0.4416s/iter; left time: 6094.5522s
Epoch: 1 cost time: 326.1038851737976
Epoch: 1, Steps: 725 | Train Loss: 0.6026491 Vali Loss: 0.8208376 Test Loss: 0.9770103
Validation loss decreased (inf --> 0.820838).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.5735316
	speed: 0.9505s/iter; left time: 12998.9159s
	iters: 200, epoch: 2 | loss: 0.5791376
	speed: 0.4494s/iter; left time: 6101.1334s
	iters: 300, epoch: 2 | loss: 0.5475789
	speed: 0.4476s/iter; left time: 6031.8733s
	iters: 400, epoch: 2 | loss: 0.5448106
	speed: 0.4410s/iter; left time: 5898.7858s
	iters: 500, epoch: 2 | loss: 0.5933173
	speed: 0.4658s/iter; left time: 6183.5621s
	iters: 600, epoch: 2 | loss: 0.5445969
	speed: 0.4446s/iter; left time: 5858.5315s
	iters: 700, epoch: 2 | loss: 0.5727605
	speed: 0.4432s/iter; left time: 5795.4229s
Epoch: 2 cost time: 324.89491868019104
Epoch: 2, Steps: 725 | Train Loss: 0.5902714 Vali Loss: 0.8268908 Test Loss: 0.9861071
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.3704152
	speed: 0.8696s/iter; left time: 11261.6492s
	iters: 200, epoch: 3 | loss: 0.3679122
	speed: 0.4406s/iter; left time: 5662.7828s
	iters: 300, epoch: 3 | loss: 0.3773139
	speed: 0.4523s/iter; left time: 5767.0812s
	iters: 400, epoch: 3 | loss: 0.3768652
	speed: 0.4402s/iter; left time: 5568.4090s
	iters: 500, epoch: 3 | loss: 0.3690389
	speed: 0.4401s/iter; left time: 5523.1590s
	iters: 600, epoch: 3 | loss: 0.3626891
	speed: 0.4423s/iter; left time: 5507.6786s
	iters: 700, epoch: 3 | loss: 0.3690109
	speed: 0.4408s/iter; left time: 5444.3499s
Epoch: 3 cost time: 320.5438528060913
Epoch: 3, Steps: 725 | Train Loss: 0.3718871 Vali Loss: 0.5242679 Test Loss: 0.6334729
Validation loss decreased (0.820838 --> 0.524268).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.2922351
	speed: 0.9565s/iter; left time: 11694.3639s
	iters: 200, epoch: 4 | loss: 0.3121209
	speed: 0.4484s/iter; left time: 5436.9770s
	iters: 300, epoch: 4 | loss: 0.3119450
	speed: 0.4489s/iter; left time: 5398.4999s
	iters: 400, epoch: 4 | loss: 0.2954874
	speed: 0.4412s/iter; left time: 5261.2618s
	iters: 500, epoch: 4 | loss: 0.2976081
	speed: 0.4559s/iter; left time: 5390.9184s
	iters: 600, epoch: 4 | loss: 0.3093104
	speed: 0.4452s/iter; left time: 5219.9751s
	iters: 700, epoch: 4 | loss: 0.3255173
	speed: 0.4409s/iter; left time: 5125.5106s
Epoch: 4 cost time: 323.91389632225037
Epoch: 4, Steps: 725 | Train Loss: 0.3064678 Vali Loss: 0.4404306 Test Loss: 0.5319528
Validation loss decreased (0.524268 --> 0.440431).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.2824771
	speed: 0.9508s/iter; left time: 10934.6985s
	iters: 200, epoch: 5 | loss: 0.2549098
	speed: 0.4584s/iter; left time: 5226.0478s
	iters: 300, epoch: 5 | loss: 0.2510717
	speed: 0.4494s/iter; left time: 5079.1032s
	iters: 400, epoch: 5 | loss: 0.3397151
	speed: 0.4399s/iter; left time: 4927.7432s
	iters: 500, epoch: 5 | loss: 0.2707841
	speed: 0.4654s/iter; left time: 5166.7012s
	iters: 600, epoch: 5 | loss: 0.2718465
	speed: 0.4401s/iter; left time: 4841.6249s
	iters: 700, epoch: 5 | loss: 0.2882197
	speed: 0.4444s/iter; left time: 4844.5750s
Epoch: 5 cost time: 325.5694417953491
Epoch: 5, Steps: 725 | Train Loss: 0.2788033 Vali Loss: 0.4034477 Test Loss: 0.4925739
Validation loss decreased (0.440431 --> 0.403448).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.2754458
	speed: 0.9631s/iter; left time: 10378.6120s
	iters: 200, epoch: 6 | loss: 0.2608605
	speed: 0.4492s/iter; left time: 4795.6247s
	iters: 300, epoch: 6 | loss: 0.2319757
	speed: 0.4436s/iter; left time: 4691.2859s
	iters: 400, epoch: 6 | loss: 0.2771347
	speed: 0.4413s/iter; left time: 4622.6920s
	iters: 500, epoch: 6 | loss: 0.2601358
	speed: 0.4715s/iter; left time: 4892.2949s
	iters: 600, epoch: 6 | loss: 0.2844545
	speed: 0.4428s/iter; left time: 4549.7594s
	iters: 700, epoch: 6 | loss: 0.2382239
	speed: 0.4408s/iter; left time: 4485.4564s
Epoch: 6 cost time: 324.78517031669617
Epoch: 6, Steps: 725 | Train Loss: 0.2647305 Vali Loss: 0.3871770 Test Loss: 0.4714671
Validation loss decreased (0.403448 --> 0.387177).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.2523811
	speed: 0.9544s/iter; left time: 9592.5235s
	iters: 200, epoch: 7 | loss: 0.2532351
	speed: 0.4518s/iter; left time: 4495.5496s
	iters: 300, epoch: 7 | loss: 0.2505834
	speed: 0.4441s/iter; left time: 4374.7380s
	iters: 400, epoch: 7 | loss: 0.2366738
	speed: 0.4389s/iter; left time: 4279.9871s
	iters: 500, epoch: 7 | loss: 0.2696744
	speed: 0.4653s/iter; left time: 4490.9357s
	iters: 600, epoch: 7 | loss: 0.2372662
	speed: 0.4422s/iter; left time: 4222.9800s
	iters: 700, epoch: 7 | loss: 0.2645915
	speed: 0.4454s/iter; left time: 4209.6737s
Epoch: 7 cost time: 323.89016556739807
Epoch: 7, Steps: 725 | Train Loss: 0.2572492 Vali Loss: 0.3792983 Test Loss: 0.4624812
Validation loss decreased (0.387177 --> 0.379298).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.2502299
	speed: 0.9483s/iter; left time: 8844.2649s
	iters: 200, epoch: 8 | loss: 0.2544437
	speed: 0.4604s/iter; left time: 4247.9838s
	iters: 300, epoch: 8 | loss: 0.2350017
	speed: 0.4396s/iter; left time: 4011.8572s
	iters: 400, epoch: 8 | loss: 0.2408407
	speed: 0.4366s/iter; left time: 3941.1382s
	iters: 500, epoch: 8 | loss: 0.2554047
	speed: 0.4384s/iter; left time: 3912.9780s
	iters: 600, epoch: 8 | loss: 0.2640902
	speed: 0.4395s/iter; left time: 3879.1492s
	iters: 700, epoch: 8 | loss: 0.2272869
	speed: 0.4457s/iter; left time: 3889.0764s
Epoch: 8 cost time: 321.58532428741455
Epoch: 8, Steps: 725 | Train Loss: 0.2530710 Vali Loss: 0.3742015 Test Loss: 0.4574825
Validation loss decreased (0.379298 --> 0.374202).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.2543539
	speed: 0.9496s/iter; left time: 8167.4369s
	iters: 200, epoch: 9 | loss: 0.2276365
	speed: 0.4417s/iter; left time: 3754.8463s
	iters: 300, epoch: 9 | loss: 0.2484764
	speed: 0.4418s/iter; left time: 3711.2089s
	iters: 400, epoch: 9 | loss: 0.2415996
	speed: 0.4375s/iter; left time: 3631.5908s
	iters: 500, epoch: 9 | loss: 0.2573658
	speed: 0.4386s/iter; left time: 3596.6252s
	iters: 600, epoch: 9 | loss: 0.2554065
	speed: 0.4405s/iter; left time: 3568.3613s
	iters: 700, epoch: 9 | loss: 0.2496883
	speed: 0.4462s/iter; left time: 3569.7031s
Epoch: 9 cost time: 320.0804102420807
Epoch: 9, Steps: 725 | Train Loss: 0.2507470 Vali Loss: 0.3727968 Test Loss: 0.4555181
Validation loss decreased (0.374202 --> 0.372797).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.2434377
	speed: 0.9540s/iter; left time: 7513.8669s
	iters: 200, epoch: 10 | loss: 0.2513342
	speed: 0.4605s/iter; left time: 3580.6171s
	iters: 300, epoch: 10 | loss: 0.2570265
	speed: 0.4411s/iter; left time: 3385.7292s
	iters: 400, epoch: 10 | loss: 0.2890987
	speed: 0.4387s/iter; left time: 3323.4462s
	iters: 500, epoch: 10 | loss: 0.2450401
	speed: 0.4383s/iter; left time: 3276.8634s
	iters: 600, epoch: 10 | loss: 0.2279282
	speed: 0.4384s/iter; left time: 3233.3399s
	iters: 700, epoch: 10 | loss: 0.2565781
	speed: 0.4446s/iter; left time: 3234.8663s
Epoch: 10 cost time: 322.1280286312103
Epoch: 10, Steps: 725 | Train Loss: 0.2495260 Vali Loss: 0.3717326 Test Loss: 0.4542756
Validation loss decreased (0.372797 --> 0.371733).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.2584135
	speed: 0.9511s/iter; left time: 6801.3849s
	iters: 200, epoch: 11 | loss: 0.2634985
	speed: 0.4477s/iter; left time: 3156.6368s
	iters: 300, epoch: 11 | loss: 0.2511332
	speed: 0.4395s/iter; left time: 3054.6602s
	iters: 400, epoch: 11 | loss: 0.2587907
	speed: 0.4493s/iter; left time: 3078.0702s
	iters: 500, epoch: 11 | loss: 0.2202909
	speed: 0.4398s/iter; left time: 2969.2016s
	iters: 600, epoch: 11 | loss: 0.2626777
	speed: 0.4394s/iter; left time: 2922.2703s
	iters: 700, epoch: 11 | loss: 0.2333252
	speed: 0.4489s/iter; left time: 2940.5448s
Epoch: 11 cost time: 322.1201968193054
Epoch: 11, Steps: 725 | Train Loss: 0.2488158 Vali Loss: 0.3710366 Test Loss: 0.4538620
Validation loss decreased (0.371733 --> 0.371037).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.2461490
	speed: 0.9526s/iter; left time: 6121.5581s
	iters: 200, epoch: 12 | loss: 0.2387962
	speed: 0.4593s/iter; left time: 2905.2687s
	iters: 300, epoch: 12 | loss: 0.2174913
	speed: 0.4387s/iter; left time: 2731.4683s
	iters: 400, epoch: 12 | loss: 0.2528167
	speed: 0.4377s/iter; left time: 2681.3897s
	iters: 500, epoch: 12 | loss: 0.2827473
	speed: 0.4405s/iter; left time: 2654.5873s
	iters: 600, epoch: 12 | loss: 0.2428068
	speed: 0.4420s/iter; left time: 2619.3151s
	iters: 700, epoch: 12 | loss: 0.2526715
	speed: 0.4464s/iter; left time: 2600.7339s
Epoch: 12 cost time: 322.1394052505493
Epoch: 12, Steps: 725 | Train Loss: 0.2484525 Vali Loss: 0.3708935 Test Loss: 0.4536745
Validation loss decreased (0.371037 --> 0.370893).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.2732655
	speed: 0.9533s/iter; left time: 5434.8934s
	iters: 200, epoch: 13 | loss: 0.2297607
	speed: 0.4487s/iter; left time: 2513.1123s
	iters: 300, epoch: 13 | loss: 0.2360273
	speed: 0.4400s/iter; left time: 2420.5267s
	iters: 400, epoch: 13 | loss: 0.2457060
	speed: 0.4393s/iter; left time: 2372.4323s
	iters: 500, epoch: 13 | loss: 0.2436932
	speed: 0.4396s/iter; left time: 2330.1812s
	iters: 600, epoch: 13 | loss: 0.2478269
	speed: 0.4399s/iter; left time: 2288.0010s
	iters: 700, epoch: 13 | loss: 0.2221072
	speed: 0.4455s/iter; left time: 2272.6847s
Epoch: 13 cost time: 321.08867287635803
Epoch: 13, Steps: 725 | Train Loss: 0.2482672 Vali Loss: 0.3712855 Test Loss: 0.4536210
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 14 | loss: 0.2389924
	speed: 0.8786s/iter; left time: 4371.8813s
	iters: 200, epoch: 14 | loss: 0.2453966
	speed: 0.4479s/iter; left time: 2184.0536s
	iters: 300, epoch: 14 | loss: 0.2384325
	speed: 0.4406s/iter; left time: 2104.1470s
	iters: 400, epoch: 14 | loss: 0.2187104
	speed: 0.4400s/iter; left time: 2057.2816s
	iters: 500, epoch: 14 | loss: 0.2431053
	speed: 0.4393s/iter; left time: 2010.4002s
	iters: 600, epoch: 14 | loss: 0.2793320
	speed: 0.4405s/iter; left time: 1971.6804s
	iters: 700, epoch: 14 | loss: 0.2499958
	speed: 0.4742s/iter; left time: 2074.9184s
Epoch: 14 cost time: 323.3915972709656
Epoch: 14, Steps: 725 | Train Loss: 0.2481539 Vali Loss: 0.3709147 Test Loss: 0.4535859
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 15 | loss: 0.2486558
	speed: 0.8742s/iter; left time: 3716.2854s
	iters: 200, epoch: 15 | loss: 0.2418335
	speed: 0.4516s/iter; left time: 1874.5237s
	iters: 300, epoch: 15 | loss: 0.2512145
	speed: 0.4397s/iter; left time: 1781.2961s
	iters: 400, epoch: 15 | loss: 0.2480339
	speed: 0.4389s/iter; left time: 1734.1669s
	iters: 500, epoch: 15 | loss: 0.2675486
	speed: 0.4381s/iter; left time: 1687.2020s
	iters: 600, epoch: 15 | loss: 0.2466124
	speed: 0.4387s/iter; left time: 1645.6539s
	iters: 700, epoch: 15 | loss: 0.2514453
	speed: 0.4458s/iter; left time: 1627.5576s
Epoch: 15 cost time: 320.5121982097626
Epoch: 15, Steps: 725 | Train Loss: 0.2480836 Vali Loss: 0.3709556 Test Loss: 0.4535855
EarlyStopping counter: 3 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 16 | loss: 0.2659214
	speed: 0.8734s/iter; left time: 3079.6693s
	iters: 200, epoch: 16 | loss: 0.2599841
	speed: 0.4527s/iter; left time: 1550.8489s
	iters: 300, epoch: 16 | loss: 0.2607882
	speed: 0.4429s/iter; left time: 1473.0690s
	iters: 400, epoch: 16 | loss: 0.2634659
	speed: 0.4394s/iter; left time: 1417.5327s
	iters: 500, epoch: 16 | loss: 0.2431218
	speed: 0.4383s/iter; left time: 1370.2374s
	iters: 600, epoch: 16 | loss: 0.2048160
	speed: 0.4396s/iter; left time: 1330.1152s
	iters: 700, epoch: 16 | loss: 0.2893000
	speed: 0.4459s/iter; left time: 1304.6776s
Epoch: 16 cost time: 320.9330279827118
Epoch: 16, Steps: 725 | Train Loss: 0.2480625 Vali Loss: 0.3712314 Test Loss: 0.4535846
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 17 | loss: 0.2585084
	speed: 0.8757s/iter; left time: 2452.9297s
	iters: 200, epoch: 17 | loss: 0.2388437
	speed: 0.4445s/iter; left time: 1200.7080s
	iters: 300, epoch: 17 | loss: 0.2456425
	speed: 0.4443s/iter; left time: 1155.7056s
	iters: 400, epoch: 17 | loss: 0.2493436
	speed: 0.4380s/iter; left time: 1095.5364s
	iters: 500, epoch: 17 | loss: 0.2377750
	speed: 0.4381s/iter; left time: 1051.8304s
	iters: 600, epoch: 17 | loss: 0.2473425
	speed: 0.4400s/iter; left time: 1012.4828s
	iters: 700, epoch: 17 | loss: 0.2541660
	speed: 0.4427s/iter; left time: 974.4378s
Epoch: 17 cost time: 319.9648518562317
Epoch: 17, Steps: 725 | Train Loss: 0.2480499 Vali Loss: 0.3711663 Test Loss: 0.4535841
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : traffic_336_336_DLinear_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed25565<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3173
mse:0.45270827412605286, mae:0.3123801052570343
