Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTh2', data_path='ETTh2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='Linear', model_id='ETTh2_336_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=336, root_path='./dataset/', save_pred_values=False, seed=25565, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTh2_336_336_Linear_ETTh2_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed25565>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7969
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 0.5269851
	speed: 0.0093s/iter; left time: 45.2776s
	iters: 200, epoch: 1 | loss: 0.5640838
	speed: 0.0075s/iter; left time: 35.8693s
Epoch: 1 cost time: 2.051022529602051
Epoch: 1, Steps: 249 | Train Loss: 0.6649744 Vali Loss: 0.6936687 Test Loss: 1.2503213
Validation loss decreased (inf --> 0.693669).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.5081546
	speed: 0.0166s/iter; left time: 76.7294s
	iters: 200, epoch: 2 | loss: 0.6420503
	speed: 0.0055s/iter; left time: 25.0353s
Epoch: 2 cost time: 1.7627747058868408
Epoch: 2, Steps: 249 | Train Loss: 0.6380366 Vali Loss: 0.5044824 Test Loss: 0.7227025
Validation loss decreased (0.693669 --> 0.504482).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.3498357
	speed: 0.0165s/iter; left time: 72.1932s
	iters: 200, epoch: 3 | loss: 0.6723030
	speed: 0.0076s/iter; left time: 32.4808s
Epoch: 3 cost time: 1.88665771484375
Epoch: 3, Steps: 249 | Train Loss: 0.5696687 Vali Loss: 0.5366124 Test Loss: 0.8553795
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.4359214
	speed: 0.0175s/iter; left time: 72.4164s
	iters: 200, epoch: 4 | loss: 0.3968920
	speed: 0.0081s/iter; left time: 32.6439s
Epoch: 4 cost time: 2.104416608810425
Epoch: 4, Steps: 249 | Train Loss: 0.5425132 Vali Loss: 0.4881407 Test Loss: 0.7703620
Validation loss decreased (0.504482 --> 0.488141).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.4345862
	speed: 0.0163s/iter; left time: 63.4874s
	iters: 200, epoch: 5 | loss: 0.4868394
	speed: 0.0080s/iter; left time: 30.3289s
Epoch: 5 cost time: 1.9774680137634277
Epoch: 5, Steps: 249 | Train Loss: 0.5285714 Vali Loss: 0.5008172 Test Loss: 0.7440374
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.7744268
	speed: 0.0181s/iter; left time: 65.9463s
	iters: 200, epoch: 6 | loss: 0.3995534
	speed: 0.0087s/iter; left time: 30.7711s
Epoch: 6 cost time: 2.1455793380737305
Epoch: 6, Steps: 249 | Train Loss: 0.5217777 Vali Loss: 0.5057227 Test Loss: 0.8354680
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.3609492
	speed: 0.0164s/iter; left time: 55.6385s
	iters: 200, epoch: 7 | loss: 0.6977119
	speed: 0.0093s/iter; left time: 30.6603s
Epoch: 7 cost time: 2.0767369270324707
Epoch: 7, Steps: 249 | Train Loss: 0.5183804 Vali Loss: 0.4820186 Test Loss: 0.6718528
Validation loss decreased (0.488141 --> 0.482019).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.5780067
	speed: 0.0157s/iter; left time: 49.3552s
	iters: 200, epoch: 8 | loss: 0.6107736
	speed: 0.0093s/iter; left time: 28.2928s
Epoch: 8 cost time: 2.19254732131958
Epoch: 8, Steps: 249 | Train Loss: 0.5163139 Vali Loss: 0.4924560 Test Loss: 0.7481922
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.6448403
	speed: 0.0161s/iter; left time: 46.4690s
	iters: 200, epoch: 9 | loss: 0.4560396
	speed: 0.0073s/iter; left time: 20.4693s
Epoch: 9 cost time: 1.7963652610778809
Epoch: 9, Steps: 249 | Train Loss: 0.5151416 Vali Loss: 0.4823392 Test Loss: 0.7073865
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.4119543
	speed: 0.0165s/iter; left time: 43.5543s
	iters: 200, epoch: 10 | loss: 0.4424568
	speed: 0.0078s/iter; left time: 19.9247s
Epoch: 10 cost time: 1.9598541259765625
Epoch: 10, Steps: 249 | Train Loss: 0.5145313 Vali Loss: 0.4801274 Test Loss: 0.7001063
Validation loss decreased (0.482019 --> 0.480127).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.3352540
	speed: 0.0171s/iter; left time: 40.8906s
	iters: 200, epoch: 11 | loss: 0.5657607
	speed: 0.0078s/iter; left time: 17.8052s
Epoch: 11 cost time: 1.9451375007629395
Epoch: 11, Steps: 249 | Train Loss: 0.5142959 Vali Loss: 0.4817516 Test Loss: 0.7074562
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.5174390
	speed: 0.0162s/iter; left time: 34.7936s
	iters: 200, epoch: 12 | loss: 0.6184828
	speed: 0.0087s/iter; left time: 17.6904s
Epoch: 12 cost time: 2.073784589767456
Epoch: 12, Steps: 249 | Train Loss: 0.5141217 Vali Loss: 0.4831590 Test Loss: 0.7085530
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.5660365
	speed: 0.0166s/iter; left time: 31.3763s
	iters: 200, epoch: 13 | loss: 0.3211481
	speed: 0.0072s/iter; left time: 12.9497s
Epoch: 13 cost time: 1.8022429943084717
Epoch: 13, Steps: 249 | Train Loss: 0.5140047 Vali Loss: 0.4818452 Test Loss: 0.7093930
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.4670808
	speed: 0.0151s/iter; left time: 24.8163s
	iters: 200, epoch: 14 | loss: 0.3605033
	speed: 0.0068s/iter; left time: 10.5271s
Epoch: 14 cost time: 1.7242953777313232
Epoch: 14, Steps: 249 | Train Loss: 0.5139715 Vali Loss: 0.4825373 Test Loss: 0.7092501
EarlyStopping counter: 4 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.3953967
	speed: 0.0112s/iter; left time: 15.5725s
	iters: 200, epoch: 15 | loss: 0.2712173
	speed: 0.0049s/iter; left time: 6.3116s
Epoch: 15 cost time: 1.2233834266662598
Epoch: 15, Steps: 249 | Train Loss: 0.5139466 Vali Loss: 0.4832967 Test Loss: 0.7090905
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTh2_336_336_Linear_ETTh2_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed25565<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2545
mse:0.6981076002120972, mae:0.5598207712173462
