Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='NLinear', model_id='ETTm2_96_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=32598, seq_len=96, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTm2_96_96_NLinear_ETTm2_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed32598>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34369
data_set:  <data_provider.data_loader.Dataset_ETT_minute object at 0x000002959B5C0D68>
val 11425
data_set:  <data_provider.data_loader.Dataset_ETT_minute object at 0x00000295E8BC6DD8>
test 11425
data_set:  <data_provider.data_loader.Dataset_ETT_minute object at 0x000002959B5C0128>
Total number of trainable parameters: 65184
Total number of parameters: 65184
	iters: 100, epoch: 1 | loss: 0.3049441
	speed: 0.0041s/iter; left time: 86.8580s
	iters: 200, epoch: 1 | loss: 0.1437943
	speed: 0.0034s/iter; left time: 73.2269s
	iters: 300, epoch: 1 | loss: 0.5303345
	speed: 0.0033s/iter; left time: 69.5006s
	iters: 400, epoch: 1 | loss: 0.1121633
	speed: 0.0036s/iter; left time: 75.6989s
	iters: 500, epoch: 1 | loss: 0.1352145
	speed: 0.0043s/iter; left time: 89.8069s
	iters: 600, epoch: 1 | loss: 0.1778116
	speed: 0.0033s/iter; left time: 69.6111s
	iters: 700, epoch: 1 | loss: 0.2170002
	speed: 0.0033s/iter; left time: 69.0841s
	iters: 800, epoch: 1 | loss: 0.3785797
	speed: 0.0050s/iter; left time: 104.4101s
	iters: 900, epoch: 1 | loss: 0.1712986
	speed: 0.0035s/iter; left time: 71.6552s
	iters: 1000, epoch: 1 | loss: 0.3383592
	speed: 0.0038s/iter; left time: 77.9986s
Epoch: 1 cost time: 4.015796661376953
Epoch: 1, Steps: 1074 | Train Loss: 0.2703833 Vali Loss: 0.1438936 Test Loss: 0.1990009
Validation loss decreased (inf --> 0.143894).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.3211637
	speed: 0.0174s/iter; left time: 352.3390s
	iters: 200, epoch: 2 | loss: 0.7140893
	speed: 0.0033s/iter; left time: 66.6881s
	iters: 300, epoch: 2 | loss: 0.3061462
	speed: 0.0036s/iter; left time: 73.2034s
	iters: 400, epoch: 2 | loss: 0.4769861
	speed: 0.0035s/iter; left time: 69.6602s
	iters: 500, epoch: 2 | loss: 0.1948594
	speed: 0.0040s/iter; left time: 79.0053s
	iters: 600, epoch: 2 | loss: 0.2089965
	speed: 0.0043s/iter; left time: 84.3283s
	iters: 700, epoch: 2 | loss: 0.1980189
	speed: 0.0033s/iter; left time: 65.5339s
	iters: 800, epoch: 2 | loss: 0.1392431
	speed: 0.0032s/iter; left time: 62.1322s
	iters: 900, epoch: 2 | loss: 0.2133877
	speed: 0.0038s/iter; left time: 73.3980s
	iters: 1000, epoch: 2 | loss: 0.6830126
	speed: 0.0038s/iter; left time: 73.0740s
Epoch: 2 cost time: 3.8334145545959473
Epoch: 2, Steps: 1074 | Train Loss: 0.2787963 Vali Loss: 0.1405361 Test Loss: 0.1972318
Validation loss decreased (0.143894 --> 0.140536).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.1968625
	speed: 0.0161s/iter; left time: 309.2134s
	iters: 200, epoch: 3 | loss: 0.2088121
	speed: 0.0030s/iter; left time: 56.8101s
	iters: 300, epoch: 3 | loss: 0.2182599
	speed: 0.0033s/iter; left time: 62.7646s
	iters: 400, epoch: 3 | loss: 0.2074662
	speed: 0.0034s/iter; left time: 64.8090s
	iters: 500, epoch: 3 | loss: 0.1579060
	speed: 0.0035s/iter; left time: 66.6996s
	iters: 600, epoch: 3 | loss: 0.1678183
	speed: 0.0038s/iter; left time: 71.1610s
	iters: 700, epoch: 3 | loss: 0.3414589
	speed: 0.0042s/iter; left time: 78.6144s
	iters: 800, epoch: 3 | loss: 0.1997474
	speed: 0.0038s/iter; left time: 69.5238s
	iters: 900, epoch: 3 | loss: 0.1125358
	speed: 0.0041s/iter; left time: 74.8925s
	iters: 1000, epoch: 3 | loss: 0.2890579
	speed: 0.0034s/iter; left time: 63.0234s
Epoch: 3 cost time: 3.7655792236328125
Epoch: 3, Steps: 1074 | Train Loss: 0.2449645 Vali Loss: 0.1291095 Test Loss: 0.1827524
Validation loss decreased (0.140536 --> 0.129110).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.3393553
	speed: 0.0159s/iter; left time: 289.3743s
	iters: 200, epoch: 4 | loss: 0.1228385
	speed: 0.0031s/iter; left time: 56.4920s
	iters: 300, epoch: 4 | loss: 0.8934711
	speed: 0.0028s/iter; left time: 50.4995s
	iters: 400, epoch: 4 | loss: 0.2493275
	speed: 0.0041s/iter; left time: 72.5629s
	iters: 500, epoch: 4 | loss: 0.1805716
	speed: 0.0038s/iter; left time: 67.1623s
	iters: 600, epoch: 4 | loss: 0.2484962
	speed: 0.0036s/iter; left time: 64.3240s
	iters: 700, epoch: 4 | loss: 0.2353163
	speed: 0.0046s/iter; left time: 80.6669s
	iters: 800, epoch: 4 | loss: 0.1419863
	speed: 0.0039s/iter; left time: 68.3992s
	iters: 900, epoch: 4 | loss: 0.1783931
	speed: 0.0046s/iter; left time: 79.4361s
	iters: 1000, epoch: 4 | loss: 0.1927384
	speed: 0.0040s/iter; left time: 68.3295s
Epoch: 4 cost time: 4.131759881973267
Epoch: 4, Steps: 1074 | Train Loss: 0.2373409 Vali Loss: 0.1344280 Test Loss: 0.1878430
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.2740541
	speed: 0.0177s/iter; left time: 302.6298s
	iters: 200, epoch: 5 | loss: 0.2148926
	speed: 0.0033s/iter; left time: 56.2886s
	iters: 300, epoch: 5 | loss: 0.3492746
	speed: 0.0039s/iter; left time: 65.4489s
	iters: 400, epoch: 5 | loss: 0.1539401
	speed: 0.0034s/iter; left time: 57.6264s
	iters: 500, epoch: 5 | loss: 0.1440455
	speed: 0.0031s/iter; left time: 52.2067s
	iters: 600, epoch: 5 | loss: 0.3798577
	speed: 0.0028s/iter; left time: 46.6428s
	iters: 700, epoch: 5 | loss: 0.2203405
	speed: 0.0037s/iter; left time: 61.7954s
	iters: 800, epoch: 5 | loss: 0.2302628
	speed: 0.0028s/iter; left time: 46.0886s
	iters: 900, epoch: 5 | loss: 0.1518166
	speed: 0.0044s/iter; left time: 71.2529s
	iters: 1000, epoch: 5 | loss: 0.1980720
	speed: 0.0042s/iter; left time: 68.2175s
Epoch: 5 cost time: 3.8065874576568604
Epoch: 5, Steps: 1074 | Train Loss: 0.2341242 Vali Loss: 0.1289464 Test Loss: 0.1822942
Validation loss decreased (0.129110 --> 0.128946).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.3575304
	speed: 0.0186s/iter; left time: 297.7755s
	iters: 200, epoch: 6 | loss: 0.2636363
	speed: 0.0032s/iter; left time: 51.5844s
	iters: 300, epoch: 6 | loss: 0.1606910
	speed: 0.0033s/iter; left time: 52.4889s
	iters: 400, epoch: 6 | loss: 0.1908742
	speed: 0.0037s/iter; left time: 58.9118s
	iters: 500, epoch: 6 | loss: 0.1599340
	speed: 0.0041s/iter; left time: 63.4400s
	iters: 600, epoch: 6 | loss: 0.1865970
	speed: 0.0031s/iter; left time: 48.4630s
	iters: 700, epoch: 6 | loss: 0.2349463
	speed: 0.0038s/iter; left time: 58.8952s
	iters: 800, epoch: 6 | loss: 0.3150406
	speed: 0.0034s/iter; left time: 51.5537s
	iters: 900, epoch: 6 | loss: 0.2990309
	speed: 0.0041s/iter; left time: 61.7473s
	iters: 1000, epoch: 6 | loss: 0.1453815
	speed: 0.0041s/iter; left time: 61.7209s
Epoch: 6 cost time: 3.9094650745391846
Epoch: 6, Steps: 1074 | Train Loss: 0.2316979 Vali Loss: 0.1234724 Test Loss: 0.1764270
Validation loss decreased (0.128946 --> 0.123472).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.1839126
	speed: 0.0167s/iter; left time: 249.3758s
	iters: 200, epoch: 7 | loss: 0.1851511
	speed: 0.0039s/iter; left time: 57.9763s
	iters: 300, epoch: 7 | loss: 0.1528481
	speed: 0.0038s/iter; left time: 55.2720s
	iters: 400, epoch: 7 | loss: 0.2859878
	speed: 0.0028s/iter; left time: 41.1753s
	iters: 500, epoch: 7 | loss: 0.2804998
	speed: 0.0028s/iter; left time: 40.8904s
	iters: 600, epoch: 7 | loss: 0.1531173
	speed: 0.0038s/iter; left time: 54.1564s
	iters: 700, epoch: 7 | loss: 0.1257008
	speed: 0.0035s/iter; left time: 49.5872s
	iters: 800, epoch: 7 | loss: 0.2401716
	speed: 0.0028s/iter; left time: 40.5606s
	iters: 900, epoch: 7 | loss: 0.2756474
	speed: 0.0041s/iter; left time: 58.2142s
	iters: 1000, epoch: 7 | loss: 0.1265084
	speed: 0.0032s/iter; left time: 44.4317s
Epoch: 7 cost time: 3.562929153442383
Epoch: 7, Steps: 1074 | Train Loss: 0.2305785 Vali Loss: 0.1257378 Test Loss: 0.1776288
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.2237903
	speed: 0.0178s/iter; left time: 246.9303s
	iters: 200, epoch: 8 | loss: 0.1454009
	speed: 0.0027s/iter; left time: 36.5800s
	iters: 300, epoch: 8 | loss: 0.1346472
	speed: 0.0039s/iter; left time: 53.3370s
	iters: 400, epoch: 8 | loss: 0.3087780
	speed: 0.0039s/iter; left time: 53.0164s
	iters: 500, epoch: 8 | loss: 0.2282888
	speed: 0.0046s/iter; left time: 61.4676s
	iters: 600, epoch: 8 | loss: 0.3318374
	speed: 0.0038s/iter; left time: 50.8194s
	iters: 700, epoch: 8 | loss: 0.1477532
	speed: 0.0030s/iter; left time: 39.8911s
	iters: 800, epoch: 8 | loss: 0.2235298
	speed: 0.0027s/iter; left time: 35.3821s
	iters: 900, epoch: 8 | loss: 0.1397816
	speed: 0.0027s/iter; left time: 35.0430s
	iters: 1000, epoch: 8 | loss: 0.1809476
	speed: 0.0033s/iter; left time: 43.1404s
Epoch: 8 cost time: 3.749905586242676
Epoch: 8, Steps: 1074 | Train Loss: 0.2300222 Vali Loss: 0.1244903 Test Loss: 0.1768537
EarlyStopping counter: 2 out of 5
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.6619549
	speed: 0.0188s/iter; left time: 240.5714s
	iters: 200, epoch: 9 | loss: 0.2583759
	speed: 0.0038s/iter; left time: 48.0967s
	iters: 300, epoch: 9 | loss: 0.1174980
	speed: 0.0035s/iter; left time: 43.9703s
	iters: 400, epoch: 9 | loss: 0.2599143
	speed: 0.0033s/iter; left time: 41.5359s
	iters: 500, epoch: 9 | loss: 0.1899899
	speed: 0.0027s/iter; left time: 33.3425s
	iters: 600, epoch: 9 | loss: 0.1877973
	speed: 0.0041s/iter; left time: 49.9584s
	iters: 700, epoch: 9 | loss: 0.2036689
	speed: 0.0041s/iter; left time: 49.4781s
	iters: 800, epoch: 9 | loss: 0.4649668
	speed: 0.0031s/iter; left time: 37.8139s
	iters: 900, epoch: 9 | loss: 0.1769664
	speed: 0.0050s/iter; left time: 59.9275s
	iters: 1000, epoch: 9 | loss: 0.1733245
	speed: 0.0031s/iter; left time: 37.1635s
Epoch: 9 cost time: 3.968599796295166
Epoch: 9, Steps: 1074 | Train Loss: 0.2297114 Vali Loss: 0.1242712 Test Loss: 0.1765061
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.3779727
	speed: 0.0194s/iter; left time: 226.9308s
	iters: 200, epoch: 10 | loss: 0.1894303
	speed: 0.0033s/iter; left time: 38.1361s
	iters: 300, epoch: 10 | loss: 0.1614623
	speed: 0.0039s/iter; left time: 44.9900s
	iters: 400, epoch: 10 | loss: 0.1310429
	speed: 0.0030s/iter; left time: 33.8939s
	iters: 500, epoch: 10 | loss: 0.1780045
	speed: 0.0044s/iter; left time: 49.5205s
	iters: 600, epoch: 10 | loss: 0.1841314
	speed: 0.0045s/iter; left time: 50.7988s
	iters: 700, epoch: 10 | loss: 0.1884283
	speed: 0.0032s/iter; left time: 35.0270s
	iters: 800, epoch: 10 | loss: 0.2355514
	speed: 0.0038s/iter; left time: 41.8495s
	iters: 900, epoch: 10 | loss: 0.1179220
	speed: 0.0032s/iter; left time: 34.5679s
	iters: 1000, epoch: 10 | loss: 0.2379913
	speed: 0.0043s/iter; left time: 46.0682s
Epoch: 10 cost time: 4.046792030334473
Epoch: 10, Steps: 1074 | Train Loss: 0.2295338 Vali Loss: 0.1252588 Test Loss: 0.1768955
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.1516173
	speed: 0.0186s/iter; left time: 197.8256s
	iters: 200, epoch: 11 | loss: 0.1070920
	speed: 0.0033s/iter; left time: 34.5738s
	iters: 300, epoch: 11 | loss: 0.2507655
	speed: 0.0034s/iter; left time: 35.9031s
	iters: 400, epoch: 11 | loss: 0.6563117
	speed: 0.0030s/iter; left time: 30.6893s
	iters: 500, epoch: 11 | loss: 0.0952359
	speed: 0.0028s/iter; left time: 28.8247s
	iters: 600, epoch: 11 | loss: 0.2161384
	speed: 0.0031s/iter; left time: 31.3314s
	iters: 700, epoch: 11 | loss: 0.4227234
	speed: 0.0033s/iter; left time: 33.2914s
	iters: 800, epoch: 11 | loss: 0.3189589
	speed: 0.0026s/iter; left time: 25.8696s
	iters: 900, epoch: 11 | loss: 0.6776737
	speed: 0.0030s/iter; left time: 29.7431s
	iters: 1000, epoch: 11 | loss: 0.2183907
	speed: 0.0033s/iter; left time: 31.9936s
Epoch: 11 cost time: 3.2966501712799072
Epoch: 11, Steps: 1074 | Train Loss: 0.2294378 Vali Loss: 0.1247253 Test Loss: 0.1767040
EarlyStopping counter: 5 out of 5
Early stopping
Total training time: 54.5730 seconds
>>>>>>>testing : ETTm2_96_96_NLinear_ETTm2_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed32598<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
data_set:  <data_provider.data_loader.Dataset_ETT_minute object at 0x00000295DE031080>
mse:0.17666414380073547, mae:0.2567637860774994
