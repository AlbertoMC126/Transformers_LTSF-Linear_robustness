Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTh2', data_path='ETTh2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='Linear', model_id='ETTh2_336_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=336, root_path='./dataset/', save_pred_values=False, seed=3293, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTh2_336_336_Linear_ETTh2_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3293>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7969
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 0.3402492
	speed: 0.0094s/iter; left time: 45.7177s
	iters: 200, epoch: 1 | loss: 0.4944228
	speed: 0.0092s/iter; left time: 43.9075s
Epoch: 1 cost time: 2.2210187911987305
Epoch: 1, Steps: 249 | Train Loss: 0.6532999 Vali Loss: 0.5754577 Test Loss: 1.1197535
Validation loss decreased (inf --> 0.575458).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.8838246
	speed: 0.0127s/iter; left time: 58.6114s
	iters: 200, epoch: 2 | loss: 0.7811978
	speed: 0.0085s/iter; left time: 38.7220s
Epoch: 2 cost time: 1.8357765674591064
Epoch: 2, Steps: 249 | Train Loss: 0.6256055 Vali Loss: 0.6728764 Test Loss: 1.3404305
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.4099144
	speed: 0.0177s/iter; left time: 77.4744s
	iters: 200, epoch: 3 | loss: 0.4878878
	speed: 0.0087s/iter; left time: 37.2996s
Epoch: 3 cost time: 2.1329123973846436
Epoch: 3, Steps: 249 | Train Loss: 0.5714278 Vali Loss: 0.6072285 Test Loss: 1.1102827
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.6238692
	speed: 0.0154s/iter; left time: 63.7762s
	iters: 200, epoch: 4 | loss: 0.5878753
	speed: 0.0094s/iter; left time: 37.7674s
Epoch: 4 cost time: 2.194413661956787
Epoch: 4, Steps: 249 | Train Loss: 0.5393492 Vali Loss: 0.4814253 Test Loss: 0.7017568
Validation loss decreased (0.575458 --> 0.481425).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.5831171
	speed: 0.0203s/iter; left time: 78.8054s
	iters: 200, epoch: 5 | loss: 0.4976314
	speed: 0.0084s/iter; left time: 31.9575s
Epoch: 5 cost time: 2.233609914779663
Epoch: 5, Steps: 249 | Train Loss: 0.5293312 Vali Loss: 0.4811945 Test Loss: 0.6543455
Validation loss decreased (0.481425 --> 0.481194).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.4448251
	speed: 0.0176s/iter; left time: 63.9796s
	iters: 200, epoch: 6 | loss: 0.4719310
	speed: 0.0086s/iter; left time: 30.4435s
Epoch: 6 cost time: 2.0885512828826904
Epoch: 6, Steps: 249 | Train Loss: 0.5209792 Vali Loss: 0.4974234 Test Loss: 0.7178072
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.5261992
	speed: 0.0181s/iter; left time: 61.4578s
	iters: 200, epoch: 7 | loss: 0.6028557
	speed: 0.0081s/iter; left time: 26.6765s
Epoch: 7 cost time: 2.0017354488372803
Epoch: 7, Steps: 249 | Train Loss: 0.5177999 Vali Loss: 0.4874729 Test Loss: 0.7221756
EarlyStopping counter: 2 out of 5
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.5800459
	speed: 0.0174s/iter; left time: 54.4928s
	iters: 200, epoch: 8 | loss: 0.4352483
	speed: 0.0085s/iter; left time: 25.9219s
Epoch: 8 cost time: 2.1955552101135254
Epoch: 8, Steps: 249 | Train Loss: 0.5162470 Vali Loss: 0.4902359 Test Loss: 0.7299049
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.4510037
	speed: 0.0190s/iter; left time: 54.8724s
	iters: 200, epoch: 9 | loss: 0.2824027
	speed: 0.0093s/iter; left time: 26.0655s
Epoch: 9 cost time: 2.2807137966156006
Epoch: 9, Steps: 249 | Train Loss: 0.5151014 Vali Loss: 0.4804721 Test Loss: 0.7047429
Validation loss decreased (0.481194 --> 0.480472).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.3972113
	speed: 0.0180s/iter; left time: 47.3994s
	iters: 200, epoch: 10 | loss: 0.4879244
	speed: 0.0073s/iter; left time: 18.5214s
Epoch: 10 cost time: 1.850234031677246
Epoch: 10, Steps: 249 | Train Loss: 0.5142741 Vali Loss: 0.4837276 Test Loss: 0.7121435
EarlyStopping counter: 1 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.3358933
	speed: 0.0153s/iter; left time: 36.4928s
	iters: 200, epoch: 11 | loss: 0.7086016
	speed: 0.0074s/iter; left time: 16.8884s
Epoch: 11 cost time: 1.8804759979248047
Epoch: 11, Steps: 249 | Train Loss: 0.5142765 Vali Loss: 0.4843777 Test Loss: 0.7139313
EarlyStopping counter: 2 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.5541279
	speed: 0.0158s/iter; left time: 33.8390s
	iters: 200, epoch: 12 | loss: 0.6553545
	speed: 0.0076s/iter; left time: 15.6038s
Epoch: 12 cost time: 1.8868215084075928
Epoch: 12, Steps: 249 | Train Loss: 0.5140078 Vali Loss: 0.4839981 Test Loss: 0.7113696
EarlyStopping counter: 3 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.4706155
	speed: 0.0144s/iter; left time: 27.1691s
	iters: 200, epoch: 13 | loss: 0.3705791
	speed: 0.0069s/iter; left time: 12.4219s
Epoch: 13 cost time: 1.746565580368042
Epoch: 13, Steps: 249 | Train Loss: 0.5139546 Vali Loss: 0.4820395 Test Loss: 0.7100457
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.2830665
	speed: 0.0135s/iter; left time: 22.1563s
	iters: 200, epoch: 14 | loss: 0.2905499
	speed: 0.0058s/iter; left time: 8.8797s
Epoch: 14 cost time: 1.5042967796325684
Epoch: 14, Steps: 249 | Train Loss: 0.5138702 Vali Loss: 0.4830060 Test Loss: 0.7098353
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTh2_336_336_Linear_ETTh2_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3293<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2545
mse:0.7026498913764954, mae:0.5609102249145508
