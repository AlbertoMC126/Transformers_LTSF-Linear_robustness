Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='DLinear', model_id='ETTm2_336_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=10458, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTm2_336_96_DLinear_ETTm2_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed10458>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34129
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.4894233
	speed: 0.0087s/iter; left time: 184.6591s
	iters: 200, epoch: 1 | loss: 0.2423883
	speed: 0.0070s/iter; left time: 148.1163s
	iters: 300, epoch: 1 | loss: 0.2887652
	speed: 0.0060s/iter; left time: 126.7987s
	iters: 400, epoch: 1 | loss: 0.4689218
	speed: 0.0080s/iter; left time: 167.5893s
	iters: 500, epoch: 1 | loss: 0.3203325
	speed: 0.0094s/iter; left time: 196.6275s
	iters: 600, epoch: 1 | loss: 0.2635405
	speed: 0.0088s/iter; left time: 181.3484s
	iters: 700, epoch: 1 | loss: 0.5173280
	speed: 0.0090s/iter; left time: 185.2353s
	iters: 800, epoch: 1 | loss: 0.7089616
	speed: 0.0088s/iter; left time: 181.2530s
	iters: 900, epoch: 1 | loss: 0.6243415
	speed: 0.0086s/iter; left time: 174.8745s
	iters: 1000, epoch: 1 | loss: 0.5300235
	speed: 0.0080s/iter; left time: 162.6168s
Epoch: 1 cost time: 8.793396472930908
Epoch: 1, Steps: 1066 | Train Loss: 0.4549715 Vali Loss: 0.6763353 Test Loss: 1.6010309
Validation loss decreased (inf --> 0.676335).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.6220101
	speed: 0.0383s/iter; left time: 771.8969s
	iters: 200, epoch: 2 | loss: 0.2734049
	speed: 0.0075s/iter; left time: 149.4490s
	iters: 300, epoch: 2 | loss: 0.4005535
	speed: 0.0063s/iter; left time: 125.3695s
	iters: 400, epoch: 2 | loss: 0.5044935
	speed: 0.0074s/iter; left time: 146.0113s
	iters: 500, epoch: 2 | loss: 0.5242572
	speed: 0.0085s/iter; left time: 168.5218s
	iters: 600, epoch: 2 | loss: 0.2953837
	speed: 0.0086s/iter; left time: 169.8596s
	iters: 700, epoch: 2 | loss: 0.2205423
	speed: 0.0090s/iter; left time: 176.4454s
	iters: 800, epoch: 2 | loss: 0.3188331
	speed: 0.0091s/iter; left time: 176.1398s
	iters: 900, epoch: 2 | loss: 0.4475442
	speed: 0.0096s/iter; left time: 185.6495s
	iters: 1000, epoch: 2 | loss: 0.3666274
	speed: 0.0080s/iter; left time: 153.4156s
Epoch: 2 cost time: 8.725775480270386
Epoch: 2, Steps: 1066 | Train Loss: 0.4419957 Vali Loss: 0.3459988 Test Loss: 0.6533977
Validation loss decreased (0.676335 --> 0.345999).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.2286356
	speed: 0.0330s/iter; left time: 630.8143s
	iters: 200, epoch: 3 | loss: 0.1887019
	speed: 0.0080s/iter; left time: 151.7809s
	iters: 300, epoch: 3 | loss: 0.2166642
	speed: 0.0073s/iter; left time: 137.1568s
	iters: 400, epoch: 3 | loss: 0.3385934
	speed: 0.0092s/iter; left time: 172.9125s
	iters: 500, epoch: 3 | loss: 0.2281459
	speed: 0.0093s/iter; left time: 174.4178s
	iters: 600, epoch: 3 | loss: 0.2783665
	speed: 0.0077s/iter; left time: 143.8790s
	iters: 700, epoch: 3 | loss: 0.3389005
	speed: 0.0071s/iter; left time: 131.8819s
	iters: 800, epoch: 3 | loss: 0.2604214
	speed: 0.0079s/iter; left time: 145.8519s
	iters: 900, epoch: 3 | loss: 0.2392707
	speed: 0.0081s/iter; left time: 147.4437s
	iters: 1000, epoch: 3 | loss: 0.1694419
	speed: 0.0080s/iter; left time: 145.1586s
Epoch: 3 cost time: 8.620101928710938
Epoch: 3, Steps: 1066 | Train Loss: 0.2786487 Vali Loss: 0.2635910 Test Loss: 0.5870426
Validation loss decreased (0.345999 --> 0.263591).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.1934341
	speed: 0.0368s/iter; left time: 663.9695s
	iters: 200, epoch: 4 | loss: 0.1729500
	speed: 0.0075s/iter; left time: 134.6098s
	iters: 300, epoch: 4 | loss: 0.1979783
	speed: 0.0073s/iter; left time: 130.0346s
	iters: 400, epoch: 4 | loss: 0.1770491
	speed: 0.0074s/iter; left time: 130.5829s
	iters: 500, epoch: 4 | loss: 0.2504976
	speed: 0.0075s/iter; left time: 132.2466s
	iters: 600, epoch: 4 | loss: 0.1597008
	speed: 0.0085s/iter; left time: 149.3382s
	iters: 700, epoch: 4 | loss: 0.2842447
	speed: 0.0091s/iter; left time: 158.5895s
	iters: 800, epoch: 4 | loss: 0.1940627
	speed: 0.0090s/iter; left time: 155.5662s
	iters: 900, epoch: 4 | loss: 0.2557727
	speed: 0.0095s/iter; left time: 163.0498s
	iters: 1000, epoch: 4 | loss: 0.1778293
	speed: 0.0095s/iter; left time: 162.1962s
Epoch: 4 cost time: 8.983606576919556
Epoch: 4, Steps: 1066 | Train Loss: 0.2388889 Vali Loss: 0.2195098 Test Loss: 0.4501293
Validation loss decreased (0.263591 --> 0.219510).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.2677652
	speed: 0.0362s/iter; left time: 614.1175s
	iters: 200, epoch: 5 | loss: 0.1270858
	speed: 0.0079s/iter; left time: 132.8583s
	iters: 300, epoch: 5 | loss: 0.2097460
	speed: 0.0082s/iter; left time: 137.4478s
	iters: 400, epoch: 5 | loss: 0.2401163
	speed: 0.0091s/iter; left time: 151.9519s
	iters: 500, epoch: 5 | loss: 0.1721724
	speed: 0.0085s/iter; left time: 141.2859s
	iters: 600, epoch: 5 | loss: 0.1494534
	speed: 0.0083s/iter; left time: 136.4369s
	iters: 700, epoch: 5 | loss: 0.3726501
	speed: 0.0076s/iter; left time: 124.6551s
	iters: 800, epoch: 5 | loss: 0.1242146
	speed: 0.0092s/iter; left time: 150.1042s
	iters: 900, epoch: 5 | loss: 0.3618984
	speed: 0.0081s/iter; left time: 131.5641s
	iters: 1000, epoch: 5 | loss: 0.1881771
	speed: 0.0082s/iter; left time: 131.5633s
Epoch: 5 cost time: 8.969195365905762
Epoch: 5, Steps: 1066 | Train Loss: 0.2206050 Vali Loss: 0.1550215 Test Loss: 0.2600711
Validation loss decreased (0.219510 --> 0.155022).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.1246263
	speed: 0.0377s/iter; left time: 599.2565s
	iters: 200, epoch: 6 | loss: 0.2247931
	speed: 0.0093s/iter; left time: 146.5734s
	iters: 300, epoch: 6 | loss: 0.4683374
	speed: 0.0084s/iter; left time: 131.8091s
	iters: 400, epoch: 6 | loss: 0.1653154
	speed: 0.0078s/iter; left time: 121.0045s
	iters: 500, epoch: 6 | loss: 0.2159438
	speed: 0.0088s/iter; left time: 136.1910s
	iters: 600, epoch: 6 | loss: 0.1671660
	speed: 0.0078s/iter; left time: 119.9504s
	iters: 700, epoch: 6 | loss: 0.1250557
	speed: 0.0084s/iter; left time: 128.1741s
	iters: 800, epoch: 6 | loss: 0.2144226
	speed: 0.0067s/iter; left time: 101.1721s
	iters: 900, epoch: 6 | loss: 0.1511182
	speed: 0.0078s/iter; left time: 117.9217s
	iters: 1000, epoch: 6 | loss: 0.1659388
	speed: 0.0083s/iter; left time: 124.6244s
Epoch: 6 cost time: 8.79013991355896
Epoch: 6, Steps: 1066 | Train Loss: 0.2108280 Vali Loss: 0.1874895 Test Loss: 0.3656751
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.1707771
	speed: 0.0388s/iter; left time: 575.6801s
	iters: 200, epoch: 7 | loss: 0.2241409
	speed: 0.0087s/iter; left time: 127.4186s
	iters: 300, epoch: 7 | loss: 0.1914548
	speed: 0.0069s/iter; left time: 101.3512s
	iters: 400, epoch: 7 | loss: 0.1395928
	speed: 0.0082s/iter; left time: 118.5656s
	iters: 500, epoch: 7 | loss: 0.2160322
	speed: 0.0089s/iter; left time: 127.8490s
	iters: 600, epoch: 7 | loss: 0.3596181
	speed: 0.0080s/iter; left time: 114.4911s
	iters: 700, epoch: 7 | loss: 0.1781663
	speed: 0.0080s/iter; left time: 113.0990s
	iters: 800, epoch: 7 | loss: 0.0934146
	speed: 0.0069s/iter; left time: 96.8972s
	iters: 900, epoch: 7 | loss: 0.1435670
	speed: 0.0077s/iter; left time: 108.4469s
	iters: 1000, epoch: 7 | loss: 0.1096893
	speed: 0.0085s/iter; left time: 117.9960s
Epoch: 7 cost time: 8.601133108139038
Epoch: 7, Steps: 1066 | Train Loss: 0.2048644 Vali Loss: 0.1236448 Test Loss: 0.1808348
Validation loss decreased (0.155022 --> 0.123645).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.1059872
	speed: 0.0352s/iter; left time: 484.2736s
	iters: 200, epoch: 8 | loss: 0.3867820
	speed: 0.0074s/iter; left time: 101.2541s
	iters: 300, epoch: 8 | loss: 0.1488692
	speed: 0.0070s/iter; left time: 94.8057s
	iters: 400, epoch: 8 | loss: 0.1853910
	speed: 0.0085s/iter; left time: 114.5712s
	iters: 500, epoch: 8 | loss: 0.2624794
	speed: 0.0078s/iter; left time: 104.0928s
	iters: 600, epoch: 8 | loss: 0.1111424
	speed: 0.0077s/iter; left time: 101.9685s
	iters: 700, epoch: 8 | loss: 0.3130069
	speed: 0.0075s/iter; left time: 98.2055s
	iters: 800, epoch: 8 | loss: 0.2748832
	speed: 0.0086s/iter; left time: 112.7075s
	iters: 900, epoch: 8 | loss: 0.1809836
	speed: 0.0087s/iter; left time: 112.4956s
	iters: 1000, epoch: 8 | loss: 0.2208009
	speed: 0.0071s/iter; left time: 91.8132s
Epoch: 8 cost time: 8.354732751846313
Epoch: 8, Steps: 1066 | Train Loss: 0.2022533 Vali Loss: 0.1188758 Test Loss: 0.1667305
Validation loss decreased (0.123645 --> 0.118876).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.0958846
	speed: 0.0359s/iter; left time: 455.1599s
	iters: 200, epoch: 9 | loss: 0.0991424
	speed: 0.0077s/iter; left time: 97.1075s
	iters: 300, epoch: 9 | loss: 0.1787061
	speed: 0.0078s/iter; left time: 97.4711s
	iters: 400, epoch: 9 | loss: 0.1703256
	speed: 0.0077s/iter; left time: 95.0542s
	iters: 500, epoch: 9 | loss: 0.1211234
	speed: 0.0087s/iter; left time: 107.3498s
	iters: 600, epoch: 9 | loss: 0.1689521
	speed: 0.0081s/iter; left time: 98.5516s
	iters: 700, epoch: 9 | loss: 0.2080990
	speed: 0.0078s/iter; left time: 93.8771s
	iters: 800, epoch: 9 | loss: 0.1301188
	speed: 0.0079s/iter; left time: 95.1347s
	iters: 900, epoch: 9 | loss: 0.2161788
	speed: 0.0078s/iter; left time: 92.6262s
	iters: 1000, epoch: 9 | loss: 0.2159067
	speed: 0.0078s/iter; left time: 92.0159s
Epoch: 9 cost time: 8.509920120239258
Epoch: 9, Steps: 1066 | Train Loss: 0.2005364 Vali Loss: 0.1302486 Test Loss: 0.2028115
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.1299285
	speed: 0.0353s/iter; left time: 410.9933s
	iters: 200, epoch: 10 | loss: 0.2061175
	speed: 0.0080s/iter; left time: 92.2405s
	iters: 300, epoch: 10 | loss: 0.1982961
	speed: 0.0073s/iter; left time: 82.9554s
	iters: 400, epoch: 10 | loss: 0.2092138
	speed: 0.0078s/iter; left time: 88.3720s
	iters: 500, epoch: 10 | loss: 0.3455864
	speed: 0.0086s/iter; left time: 96.7039s
	iters: 600, epoch: 10 | loss: 0.1329333
	speed: 0.0079s/iter; left time: 88.3690s
	iters: 700, epoch: 10 | loss: 0.1843784
	speed: 0.0095s/iter; left time: 104.7612s
	iters: 800, epoch: 10 | loss: 0.1508534
	speed: 0.0067s/iter; left time: 73.4146s
	iters: 900, epoch: 10 | loss: 0.1705537
	speed: 0.0068s/iter; left time: 73.6491s
	iters: 1000, epoch: 10 | loss: 0.1461079
	speed: 0.0062s/iter; left time: 66.8522s
Epoch: 10 cost time: 8.100494146347046
Epoch: 10, Steps: 1066 | Train Loss: 0.1996203 Vali Loss: 0.1351344 Test Loss: 0.2211272
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.1585231
	speed: 0.0347s/iter; left time: 366.0054s
	iters: 200, epoch: 11 | loss: 0.2658441
	speed: 0.0093s/iter; left time: 97.4186s
	iters: 300, epoch: 11 | loss: 0.1934377
	speed: 0.0087s/iter; left time: 89.8516s
	iters: 400, epoch: 11 | loss: 0.1603856
	speed: 0.0089s/iter; left time: 91.3536s
	iters: 500, epoch: 11 | loss: 0.2042477
	speed: 0.0082s/iter; left time: 83.1293s
	iters: 600, epoch: 11 | loss: 0.1512870
	speed: 0.0079s/iter; left time: 79.0794s
	iters: 700, epoch: 11 | loss: 0.1343026
	speed: 0.0087s/iter; left time: 86.3665s
	iters: 800, epoch: 11 | loss: 0.1833829
	speed: 0.0080s/iter; left time: 79.1597s
	iters: 900, epoch: 11 | loss: 0.2364996
	speed: 0.0072s/iter; left time: 70.4580s
	iters: 1000, epoch: 11 | loss: 0.1451957
	speed: 0.0082s/iter; left time: 79.0522s
Epoch: 11 cost time: 8.785872459411621
Epoch: 11, Steps: 1066 | Train Loss: 0.1990802 Vali Loss: 0.1271768 Test Loss: 0.1963378
EarlyStopping counter: 3 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.2950274
	speed: 0.0343s/iter; left time: 326.1044s
	iters: 200, epoch: 12 | loss: 0.3787050
	speed: 0.0084s/iter; left time: 79.0719s
	iters: 300, epoch: 12 | loss: 0.2841743
	speed: 0.0082s/iter; left time: 76.2366s
	iters: 400, epoch: 12 | loss: 0.2273328
	speed: 0.0080s/iter; left time: 74.0046s
	iters: 500, epoch: 12 | loss: 0.1327981
	speed: 0.0077s/iter; left time: 69.9617s
	iters: 600, epoch: 12 | loss: 0.1254929
	speed: 0.0077s/iter; left time: 68.9971s
	iters: 700, epoch: 12 | loss: 0.2507758
	speed: 0.0084s/iter; left time: 74.4612s
	iters: 800, epoch: 12 | loss: 0.2040011
	speed: 0.0088s/iter; left time: 77.7762s
	iters: 900, epoch: 12 | loss: 0.1877330
	speed: 0.0093s/iter; left time: 80.6319s
	iters: 1000, epoch: 12 | loss: 0.1490744
	speed: 0.0088s/iter; left time: 75.5706s
Epoch: 12 cost time: 8.886972427368164
Epoch: 12, Steps: 1066 | Train Loss: 0.1986536 Vali Loss: 0.1310983 Test Loss: 0.2083563
EarlyStopping counter: 4 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.1572779
	speed: 0.0341s/iter; left time: 287.3989s
	iters: 200, epoch: 13 | loss: 0.1282598
	speed: 0.0075s/iter; left time: 62.5697s
	iters: 300, epoch: 13 | loss: 0.2147711
	speed: 0.0074s/iter; left time: 61.0590s
	iters: 400, epoch: 13 | loss: 0.1793983
	speed: 0.0074s/iter; left time: 59.7650s
	iters: 500, epoch: 13 | loss: 0.2452519
	speed: 0.0083s/iter; left time: 66.4931s
	iters: 600, epoch: 13 | loss: 0.1579305
	speed: 0.0093s/iter; left time: 73.7579s
	iters: 700, epoch: 13 | loss: 0.2263488
	speed: 0.0090s/iter; left time: 70.5693s
	iters: 800, epoch: 13 | loss: 0.1604748
	speed: 0.0087s/iter; left time: 67.3461s
	iters: 900, epoch: 13 | loss: 0.6071568
	speed: 0.0088s/iter; left time: 67.2383s
	iters: 1000, epoch: 13 | loss: 0.4606368
	speed: 0.0085s/iter; left time: 64.0761s
Epoch: 13 cost time: 8.748370885848999
Epoch: 13, Steps: 1066 | Train Loss: 0.1987211 Vali Loss: 0.1298094 Test Loss: 0.2037674
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTm2_336_96_DLinear_ETTm2_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed10458<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.16701078414916992, mae:0.2588548958301544
