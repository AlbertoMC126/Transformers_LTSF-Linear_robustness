Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='DLinear', model_id='ETTm2_336_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=336, root_path='./dataset/', save_pred_values=False, seed=12890, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTm2_336_336_DLinear_ETTm2_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed12890>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33889
val 11185
test 11185
	iters: 100, epoch: 1 | loss: 1.1818804
	speed: 0.0174s/iter; left time: 367.1852s
	iters: 200, epoch: 1 | loss: 0.4648200
	speed: 0.0174s/iter; left time: 364.3442s
	iters: 300, epoch: 1 | loss: 0.6441599
	speed: 0.0178s/iter; left time: 371.3498s
	iters: 400, epoch: 1 | loss: 0.6058380
	speed: 0.0181s/iter; left time: 375.1834s
	iters: 500, epoch: 1 | loss: 1.1178627
	speed: 0.0173s/iter; left time: 356.8149s
	iters: 600, epoch: 1 | loss: 0.5904660
	speed: 0.0183s/iter; left time: 376.2553s
	iters: 700, epoch: 1 | loss: 0.7964357
	speed: 0.0183s/iter; left time: 374.5532s
	iters: 800, epoch: 1 | loss: 0.4512001
	speed: 0.0179s/iter; left time: 364.4169s
	iters: 900, epoch: 1 | loss: 0.6642942
	speed: 0.0185s/iter; left time: 375.7046s
	iters: 1000, epoch: 1 | loss: 0.7246754
	speed: 0.0184s/iter; left time: 371.6094s
Epoch: 1 cost time: 18.885690450668335
Epoch: 1, Steps: 1059 | Train Loss: 0.6696810 Vali Loss: 0.4827478 Test Loss: 0.9079630
Validation loss decreased (inf --> 0.482748).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.5397686
	speed: 0.0674s/iter; left time: 1349.7194s
	iters: 200, epoch: 2 | loss: 0.8641167
	speed: 0.0164s/iter; left time: 325.8517s
	iters: 300, epoch: 2 | loss: 0.5473137
	speed: 0.0174s/iter; left time: 344.0054s
	iters: 400, epoch: 2 | loss: 0.4694940
	speed: 0.0165s/iter; left time: 325.4527s
	iters: 500, epoch: 2 | loss: 0.5797290
	speed: 0.0171s/iter; left time: 336.0615s
	iters: 600, epoch: 2 | loss: 0.8527168
	speed: 0.0179s/iter; left time: 348.9900s
	iters: 700, epoch: 2 | loss: 0.6001809
	speed: 0.0167s/iter; left time: 324.6665s
	iters: 800, epoch: 2 | loss: 0.3724685
	speed: 0.0172s/iter; left time: 333.1563s
	iters: 900, epoch: 2 | loss: 0.7434971
	speed: 0.0179s/iter; left time: 344.5625s
	iters: 1000, epoch: 2 | loss: 0.9188176
	speed: 0.0159s/iter; left time: 303.7336s
Epoch: 2 cost time: 17.79463005065918
Epoch: 2, Steps: 1059 | Train Loss: 0.6450911 Vali Loss: 0.5559236 Test Loss: 1.0639830
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.4972537
	speed: 0.0636s/iter; left time: 1206.8334s
	iters: 200, epoch: 3 | loss: 1.1196228
	speed: 0.0173s/iter; left time: 326.9991s
	iters: 300, epoch: 3 | loss: 0.3335145
	speed: 0.0152s/iter; left time: 284.9037s
	iters: 400, epoch: 3 | loss: 0.5246877
	speed: 0.0155s/iter; left time: 289.6097s
	iters: 500, epoch: 3 | loss: 0.4902629
	speed: 0.0173s/iter; left time: 320.7258s
	iters: 600, epoch: 3 | loss: 0.4274329
	speed: 0.0186s/iter; left time: 343.0766s
	iters: 700, epoch: 3 | loss: 0.3040915
	speed: 0.0171s/iter; left time: 314.1229s
	iters: 800, epoch: 3 | loss: 0.6104802
	speed: 0.0169s/iter; left time: 308.7537s
	iters: 900, epoch: 3 | loss: 0.3480489
	speed: 0.0174s/iter; left time: 315.9533s
	iters: 1000, epoch: 3 | loss: 0.3462511
	speed: 0.0166s/iter; left time: 300.2210s
Epoch: 3 cost time: 17.736286401748657
Epoch: 3, Steps: 1059 | Train Loss: 0.4619297 Vali Loss: 0.5445609 Test Loss: 1.2832989
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.2882698
	speed: 0.0637s/iter; left time: 1139.7032s
	iters: 200, epoch: 4 | loss: 0.3163887
	speed: 0.0165s/iter; left time: 294.5545s
	iters: 300, epoch: 4 | loss: 0.5016577
	speed: 0.0160s/iter; left time: 283.5449s
	iters: 400, epoch: 4 | loss: 0.9370779
	speed: 0.0152s/iter; left time: 267.8103s
	iters: 500, epoch: 4 | loss: 0.2465732
	speed: 0.0166s/iter; left time: 291.0812s
	iters: 600, epoch: 4 | loss: 0.7798147
	speed: 0.0177s/iter; left time: 307.2221s
	iters: 700, epoch: 4 | loss: 0.3002226
	speed: 0.0164s/iter; left time: 283.9865s
	iters: 800, epoch: 4 | loss: 0.4812297
	speed: 0.0159s/iter; left time: 272.9841s
	iters: 900, epoch: 4 | loss: 0.5121788
	speed: 0.0172s/iter; left time: 294.7238s
	iters: 1000, epoch: 4 | loss: 0.3643196
	speed: 0.0171s/iter; left time: 291.0561s
Epoch: 4 cost time: 17.491216897964478
Epoch: 4, Steps: 1059 | Train Loss: 0.4042467 Vali Loss: 0.4333779 Test Loss: 0.9324113
Validation loss decreased (0.482748 --> 0.433378).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.3647929
	speed: 0.0649s/iter; left time: 1093.2140s
	iters: 200, epoch: 5 | loss: 0.6163145
	speed: 0.0179s/iter; left time: 299.3270s
	iters: 300, epoch: 5 | loss: 0.3236141
	speed: 0.0187s/iter; left time: 311.4561s
	iters: 400, epoch: 5 | loss: 0.2312599
	speed: 0.0180s/iter; left time: 297.3854s
	iters: 500, epoch: 5 | loss: 0.3136684
	speed: 0.0174s/iter; left time: 285.7821s
	iters: 600, epoch: 5 | loss: 0.2321040
	speed: 0.0182s/iter; left time: 296.9219s
	iters: 700, epoch: 5 | loss: 0.3044727
	speed: 0.0178s/iter; left time: 289.8018s
	iters: 800, epoch: 5 | loss: 0.3217852
	speed: 0.0168s/iter; left time: 270.8303s
	iters: 900, epoch: 5 | loss: 0.7007471
	speed: 0.0158s/iter; left time: 253.5505s
	iters: 1000, epoch: 5 | loss: 0.1497335
	speed: 0.0160s/iter; left time: 254.7158s
Epoch: 5 cost time: 18.344414234161377
Epoch: 5, Steps: 1059 | Train Loss: 0.3786006 Vali Loss: 0.2648742 Test Loss: 0.4552954
Validation loss decreased (0.433378 --> 0.264874).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.2349141
	speed: 0.0621s/iter; left time: 980.4499s
	iters: 200, epoch: 6 | loss: 0.1875879
	speed: 0.0157s/iter; left time: 246.2203s
	iters: 300, epoch: 6 | loss: 0.2385341
	speed: 0.0152s/iter; left time: 236.5717s
	iters: 400, epoch: 6 | loss: 0.2019961
	speed: 0.0153s/iter; left time: 237.1509s
	iters: 500, epoch: 6 | loss: 0.4005944
	speed: 0.0158s/iter; left time: 243.4697s
	iters: 600, epoch: 6 | loss: 0.4666562
	speed: 0.0171s/iter; left time: 261.0210s
	iters: 700, epoch: 6 | loss: 0.2758162
	speed: 0.0152s/iter; left time: 231.4726s
	iters: 800, epoch: 6 | loss: 0.3379989
	speed: 0.0169s/iter; left time: 254.6090s
	iters: 900, epoch: 6 | loss: 0.3999815
	speed: 0.0168s/iter; left time: 251.3989s
	iters: 1000, epoch: 6 | loss: 0.2967144
	speed: 0.0159s/iter; left time: 236.5618s
Epoch: 6 cost time: 16.785414457321167
Epoch: 6, Steps: 1059 | Train Loss: 0.3651776 Vali Loss: 0.2728467 Test Loss: 0.4541194
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.2522758
	speed: 0.0629s/iter; left time: 926.7627s
	iters: 200, epoch: 7 | loss: 0.2927019
	speed: 0.0171s/iter; left time: 249.8997s
	iters: 300, epoch: 7 | loss: 0.3723844
	speed: 0.0166s/iter; left time: 240.8459s
	iters: 400, epoch: 7 | loss: 0.4784395
	speed: 0.0161s/iter; left time: 232.1604s
	iters: 500, epoch: 7 | loss: 0.4970863
	speed: 0.0180s/iter; left time: 257.7087s
	iters: 600, epoch: 7 | loss: 0.2303079
	speed: 0.0174s/iter; left time: 247.3559s
	iters: 700, epoch: 7 | loss: 0.4112836
	speed: 0.0164s/iter; left time: 232.1913s
	iters: 800, epoch: 7 | loss: 0.3388663
	speed: 0.0173s/iter; left time: 242.1791s
	iters: 900, epoch: 7 | loss: 0.6639108
	speed: 0.0179s/iter; left time: 249.0204s
	iters: 1000, epoch: 7 | loss: 0.3090697
	speed: 0.0182s/iter; left time: 251.1695s
Epoch: 7 cost time: 18.011388540267944
Epoch: 7, Steps: 1059 | Train Loss: 0.3568770 Vali Loss: 0.3177064 Test Loss: 0.6262495
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.2417249
	speed: 0.0630s/iter; left time: 860.4380s
	iters: 200, epoch: 8 | loss: 0.2150607
	speed: 0.0169s/iter; left time: 229.5220s
	iters: 300, epoch: 8 | loss: 0.3196776
	speed: 0.0172s/iter; left time: 231.4422s
	iters: 400, epoch: 8 | loss: 0.3449848
	speed: 0.0164s/iter; left time: 219.8155s
	iters: 500, epoch: 8 | loss: 0.1950542
	speed: 0.0169s/iter; left time: 223.7928s
	iters: 600, epoch: 8 | loss: 0.1996460
	speed: 0.0167s/iter; left time: 219.4581s
	iters: 700, epoch: 8 | loss: 0.3125132
	speed: 0.0173s/iter; left time: 225.5927s
	iters: 800, epoch: 8 | loss: 0.4260756
	speed: 0.0179s/iter; left time: 231.5856s
	iters: 900, epoch: 8 | loss: 0.2165581
	speed: 0.0177s/iter; left time: 228.2088s
	iters: 1000, epoch: 8 | loss: 0.3087477
	speed: 0.0167s/iter; left time: 212.9480s
Epoch: 8 cost time: 17.825539588928223
Epoch: 8, Steps: 1059 | Train Loss: 0.3525803 Vali Loss: 0.2675451 Test Loss: 0.4803516
EarlyStopping counter: 3 out of 5
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.7521187
	speed: 0.0625s/iter; left time: 787.7286s
	iters: 200, epoch: 9 | loss: 0.9882008
	speed: 0.0170s/iter; left time: 212.1893s
	iters: 300, epoch: 9 | loss: 0.4106859
	speed: 0.0171s/iter; left time: 211.6165s
	iters: 400, epoch: 9 | loss: 0.3067440
	speed: 0.0174s/iter; left time: 213.6449s
	iters: 500, epoch: 9 | loss: 0.2598237
	speed: 0.0172s/iter; left time: 209.9500s
	iters: 600, epoch: 9 | loss: 0.2202873
	speed: 0.0155s/iter; left time: 188.1980s
	iters: 700, epoch: 9 | loss: 0.2134010
	speed: 0.0170s/iter; left time: 204.7160s
	iters: 800, epoch: 9 | loss: 0.4866571
	speed: 0.0159s/iter; left time: 189.4131s
	iters: 900, epoch: 9 | loss: 0.3965316
	speed: 0.0165s/iter; left time: 194.5153s
	iters: 1000, epoch: 9 | loss: 0.2229164
	speed: 0.0163s/iter; left time: 190.9423s
Epoch: 9 cost time: 17.52094841003418
Epoch: 9, Steps: 1059 | Train Loss: 0.3504736 Vali Loss: 0.2780364 Test Loss: 0.5158408
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.4118824
	speed: 0.0597s/iter; left time: 689.4615s
	iters: 200, epoch: 10 | loss: 0.2431370
	speed: 0.0166s/iter; left time: 190.4664s
	iters: 300, epoch: 10 | loss: 0.3786276
	speed: 0.0183s/iter; left time: 207.2737s
	iters: 400, epoch: 10 | loss: 0.2056519
	speed: 0.0166s/iter; left time: 187.1512s
	iters: 500, epoch: 10 | loss: 0.3283078
	speed: 0.0161s/iter; left time: 179.6806s
	iters: 600, epoch: 10 | loss: 0.4141711
	speed: 0.0181s/iter; left time: 199.8333s
	iters: 700, epoch: 10 | loss: 0.6409103
	speed: 0.0168s/iter; left time: 184.3487s
	iters: 800, epoch: 10 | loss: 0.4057221
	speed: 0.0171s/iter; left time: 185.7410s
	iters: 900, epoch: 10 | loss: 0.4371653
	speed: 0.0163s/iter; left time: 174.8059s
	iters: 1000, epoch: 10 | loss: 0.3300081
	speed: 0.0159s/iter; left time: 169.1766s
Epoch: 10 cost time: 17.679916620254517
Epoch: 10, Steps: 1059 | Train Loss: 0.3490675 Vali Loss: 0.2688286 Test Loss: 0.4803217
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTm2_336_336_DLinear_ETTm2_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed12890<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
mse:0.4557093679904938, mae:0.4407837390899658
