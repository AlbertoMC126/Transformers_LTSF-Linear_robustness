Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='Linear', model_id='ETTm2_336_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=15349, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTm2_336_96_Linear_ETTm2_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15349>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34129
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.4386404
	speed: 0.0039s/iter; left time: 82.1254s
	iters: 200, epoch: 1 | loss: 0.3629110
	speed: 0.0040s/iter; left time: 83.4393s
	iters: 300, epoch: 1 | loss: 0.3497452
	speed: 0.0043s/iter; left time: 89.8192s
	iters: 400, epoch: 1 | loss: 0.3172826
	speed: 0.0042s/iter; left time: 87.8354s
	iters: 500, epoch: 1 | loss: 0.3006920
	speed: 0.0043s/iter; left time: 89.9922s
	iters: 600, epoch: 1 | loss: 0.4818093
	speed: 0.0038s/iter; left time: 77.9109s
	iters: 700, epoch: 1 | loss: 0.2658669
	speed: 0.0038s/iter; left time: 79.3907s
	iters: 800, epoch: 1 | loss: 0.3776364
	speed: 0.0038s/iter; left time: 78.6625s
	iters: 900, epoch: 1 | loss: 0.4251270
	speed: 0.0042s/iter; left time: 85.7681s
	iters: 1000, epoch: 1 | loss: 0.2873400
	speed: 0.0036s/iter; left time: 73.6124s
Epoch: 1 cost time: 4.277973890304565
Epoch: 1, Steps: 1066 | Train Loss: 0.4089398 Vali Loss: 0.3210870 Test Loss: 0.5057526
Validation loss decreased (inf --> 0.321087).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.2454535
	speed: 0.0185s/iter; left time: 372.9192s
	iters: 200, epoch: 2 | loss: 0.2258674
	speed: 0.0043s/iter; left time: 85.3046s
	iters: 300, epoch: 2 | loss: 0.2651614
	speed: 0.0038s/iter; left time: 76.6193s
	iters: 400, epoch: 2 | loss: 0.4300001
	speed: 0.0036s/iter; left time: 70.9203s
	iters: 500, epoch: 2 | loss: 0.5620910
	speed: 0.0037s/iter; left time: 72.7043s
	iters: 600, epoch: 2 | loss: 0.3284245
	speed: 0.0044s/iter; left time: 85.8923s
	iters: 700, epoch: 2 | loss: 0.1945955
	speed: 0.0044s/iter; left time: 85.7022s
	iters: 800, epoch: 2 | loss: 0.2056486
	speed: 0.0043s/iter; left time: 83.4707s
	iters: 900, epoch: 2 | loss: 0.3455051
	speed: 0.0038s/iter; left time: 73.9701s
	iters: 1000, epoch: 2 | loss: 0.3878168
	speed: 0.0037s/iter; left time: 70.6658s
Epoch: 2 cost time: 4.25001859664917
Epoch: 2, Steps: 1066 | Train Loss: 0.3968908 Vali Loss: 1.3020182 Test Loss: 2.9967470
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.2125073
	speed: 0.0175s/iter; left time: 333.2247s
	iters: 200, epoch: 3 | loss: 0.5670425
	speed: 0.0040s/iter; left time: 75.7746s
	iters: 300, epoch: 3 | loss: 0.1502661
	speed: 0.0047s/iter; left time: 89.0012s
	iters: 400, epoch: 3 | loss: 0.1676175
	speed: 0.0046s/iter; left time: 87.1811s
	iters: 500, epoch: 3 | loss: 0.2018316
	speed: 0.0046s/iter; left time: 86.5365s
	iters: 600, epoch: 3 | loss: 0.2839828
	speed: 0.0037s/iter; left time: 69.5593s
	iters: 700, epoch: 3 | loss: 0.2065041
	speed: 0.0047s/iter; left time: 86.3436s
	iters: 800, epoch: 3 | loss: 0.2129709
	speed: 0.0045s/iter; left time: 82.7946s
	iters: 900, epoch: 3 | loss: 0.2584722
	speed: 0.0040s/iter; left time: 73.5216s
	iters: 1000, epoch: 3 | loss: 0.1957650
	speed: 0.0035s/iter; left time: 63.5114s
Epoch: 3 cost time: 4.5262017250061035
Epoch: 3, Steps: 1066 | Train Loss: 0.2594844 Vali Loss: 0.1917710 Test Loss: 0.3148499
Validation loss decreased (0.321087 --> 0.191771).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.3041066
	speed: 0.0151s/iter; left time: 271.6522s
	iters: 200, epoch: 4 | loss: 0.2680646
	speed: 0.0032s/iter; left time: 56.8158s
	iters: 300, epoch: 4 | loss: 0.2401225
	speed: 0.0041s/iter; left time: 72.9283s
	iters: 400, epoch: 4 | loss: 0.5209056
	speed: 0.0040s/iter; left time: 71.0694s
	iters: 500, epoch: 4 | loss: 0.1497130
	speed: 0.0043s/iter; left time: 76.3585s
	iters: 600, epoch: 4 | loss: 0.1416812
	speed: 0.0043s/iter; left time: 75.8833s
	iters: 700, epoch: 4 | loss: 0.2228325
	speed: 0.0043s/iter; left time: 74.7447s
	iters: 800, epoch: 4 | loss: 0.1295467
	speed: 0.0038s/iter; left time: 66.5772s
	iters: 900, epoch: 4 | loss: 0.1316759
	speed: 0.0039s/iter; left time: 67.5220s
	iters: 1000, epoch: 4 | loss: 0.5577778
	speed: 0.0048s/iter; left time: 81.7051s
Epoch: 4 cost time: 4.294023752212524
Epoch: 4, Steps: 1066 | Train Loss: 0.2314684 Vali Loss: 0.1680536 Test Loss: 0.2556455
Validation loss decreased (0.191771 --> 0.168054).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.1537150
	speed: 0.0182s/iter; left time: 307.8147s
	iters: 200, epoch: 5 | loss: 0.3178179
	speed: 0.0042s/iter; left time: 70.1333s
	iters: 300, epoch: 5 | loss: 0.1267461
	speed: 0.0042s/iter; left time: 70.5473s
	iters: 400, epoch: 5 | loss: 0.2110635
	speed: 0.0048s/iter; left time: 79.1724s
	iters: 500, epoch: 5 | loss: 0.1937664
	speed: 0.0051s/iter; left time: 83.6221s
	iters: 600, epoch: 5 | loss: 0.2518167
	speed: 0.0040s/iter; left time: 65.2083s
	iters: 700, epoch: 5 | loss: 0.3102365
	speed: 0.0036s/iter; left time: 58.5580s
	iters: 800, epoch: 5 | loss: 0.2645607
	speed: 0.0037s/iter; left time: 59.8259s
	iters: 900, epoch: 5 | loss: 0.1297476
	speed: 0.0040s/iter; left time: 65.1478s
	iters: 1000, epoch: 5 | loss: 0.1603131
	speed: 0.0042s/iter; left time: 67.2790s
Epoch: 5 cost time: 4.488374948501587
Epoch: 5, Steps: 1066 | Train Loss: 0.2174969 Vali Loss: 0.1605107 Test Loss: 0.2586141
Validation loss decreased (0.168054 --> 0.160511).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.1976591
	speed: 0.0171s/iter; left time: 272.4747s
	iters: 200, epoch: 6 | loss: 0.2875008
	speed: 0.0037s/iter; left time: 58.7524s
	iters: 300, epoch: 6 | loss: 0.1116010
	speed: 0.0043s/iter; left time: 67.3512s
	iters: 400, epoch: 6 | loss: 0.2068384
	speed: 0.0047s/iter; left time: 72.8099s
	iters: 500, epoch: 6 | loss: 0.1411824
	speed: 0.0047s/iter; left time: 73.3129s
	iters: 600, epoch: 6 | loss: 0.1681835
	speed: 0.0045s/iter; left time: 69.1057s
	iters: 700, epoch: 6 | loss: 0.1822607
	speed: 0.0034s/iter; left time: 52.0167s
	iters: 800, epoch: 6 | loss: 0.1682231
	speed: 0.0034s/iter; left time: 52.1050s
	iters: 900, epoch: 6 | loss: 0.1885769
	speed: 0.0036s/iter; left time: 54.3364s
	iters: 1000, epoch: 6 | loss: 0.2358234
	speed: 0.0028s/iter; left time: 42.4665s
Epoch: 6 cost time: 4.152074337005615
Epoch: 6, Steps: 1066 | Train Loss: 0.2083074 Vali Loss: 0.1475173 Test Loss: 0.2497549
Validation loss decreased (0.160511 --> 0.147517).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.2358113
	speed: 0.0177s/iter; left time: 262.5611s
	iters: 200, epoch: 7 | loss: 0.2605012
	speed: 0.0039s/iter; left time: 57.3145s
	iters: 300, epoch: 7 | loss: 0.1349017
	speed: 0.0037s/iter; left time: 53.5276s
	iters: 400, epoch: 7 | loss: 0.1836520
	speed: 0.0033s/iter; left time: 48.5135s
	iters: 500, epoch: 7 | loss: 0.1463459
	speed: 0.0036s/iter; left time: 52.1155s
	iters: 600, epoch: 7 | loss: 0.1040408
	speed: 0.0034s/iter; left time: 49.1436s
	iters: 700, epoch: 7 | loss: 0.1600578
	speed: 0.0036s/iter; left time: 51.9212s
	iters: 800, epoch: 7 | loss: 0.3476724
	speed: 0.0042s/iter; left time: 59.6496s
	iters: 900, epoch: 7 | loss: 0.1769138
	speed: 0.0041s/iter; left time: 57.8510s
	iters: 1000, epoch: 7 | loss: 0.2344654
	speed: 0.0043s/iter; left time: 59.3568s
Epoch: 7 cost time: 4.078624963760376
Epoch: 7, Steps: 1066 | Train Loss: 0.2040858 Vali Loss: 0.1514270 Test Loss: 0.2589312
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.1943175
	speed: 0.0173s/iter; left time: 238.6113s
	iters: 200, epoch: 8 | loss: 0.1830342
	speed: 0.0043s/iter; left time: 58.0794s
	iters: 300, epoch: 8 | loss: 0.1222184
	speed: 0.0041s/iter; left time: 56.1426s
	iters: 400, epoch: 8 | loss: 0.3100614
	speed: 0.0043s/iter; left time: 58.4522s
	iters: 500, epoch: 8 | loss: 0.2939566
	speed: 0.0035s/iter; left time: 47.2908s
	iters: 600, epoch: 8 | loss: 0.1471185
	speed: 0.0040s/iter; left time: 52.9033s
	iters: 700, epoch: 8 | loss: 0.3379784
	speed: 0.0037s/iter; left time: 48.2017s
	iters: 800, epoch: 8 | loss: 0.1555109
	speed: 0.0038s/iter; left time: 49.4936s
	iters: 900, epoch: 8 | loss: 0.2291093
	speed: 0.0041s/iter; left time: 52.8970s
	iters: 1000, epoch: 8 | loss: 0.1998830
	speed: 0.0042s/iter; left time: 53.4975s
Epoch: 8 cost time: 4.279091119766235
Epoch: 8, Steps: 1066 | Train Loss: 0.2020173 Vali Loss: 0.1293251 Test Loss: 0.2007924
Validation loss decreased (0.147517 --> 0.129325).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.2667032
	speed: 0.0178s/iter; left time: 226.2601s
	iters: 200, epoch: 9 | loss: 0.2541347
	speed: 0.0044s/iter; left time: 55.1573s
	iters: 300, epoch: 9 | loss: 0.1984477
	speed: 0.0044s/iter; left time: 54.6264s
	iters: 400, epoch: 9 | loss: 0.4080444
	speed: 0.0043s/iter; left time: 53.4139s
	iters: 500, epoch: 9 | loss: 0.2574376
	speed: 0.0044s/iter; left time: 54.4848s
	iters: 600, epoch: 9 | loss: 0.1801563
	speed: 0.0044s/iter; left time: 53.5092s
	iters: 700, epoch: 9 | loss: 0.1045810
	speed: 0.0044s/iter; left time: 53.6930s
	iters: 800, epoch: 9 | loss: 0.1255382
	speed: 0.0051s/iter; left time: 61.3126s
	iters: 900, epoch: 9 | loss: 0.1524193
	speed: 0.0049s/iter; left time: 58.5036s
	iters: 1000, epoch: 9 | loss: 0.1504894
	speed: 0.0046s/iter; left time: 54.1538s
Epoch: 9 cost time: 4.800987958908081
Epoch: 9, Steps: 1066 | Train Loss: 0.2004963 Vali Loss: 0.1226249 Test Loss: 0.1800058
Validation loss decreased (0.129325 --> 0.122625).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.1559155
	speed: 0.0209s/iter; left time: 243.1813s
	iters: 200, epoch: 10 | loss: 0.1803747
	speed: 0.0046s/iter; left time: 53.4925s
	iters: 300, epoch: 10 | loss: 0.1756631
	speed: 0.0037s/iter; left time: 42.2962s
	iters: 400, epoch: 10 | loss: 0.2360680
	speed: 0.0037s/iter; left time: 42.0233s
	iters: 500, epoch: 10 | loss: 0.1756931
	speed: 0.0040s/iter; left time: 45.2775s
	iters: 600, epoch: 10 | loss: 0.1256907
	speed: 0.0043s/iter; left time: 47.4010s
	iters: 700, epoch: 10 | loss: 0.1558955
	speed: 0.0042s/iter; left time: 46.8552s
	iters: 800, epoch: 10 | loss: 0.1694590
	speed: 0.0049s/iter; left time: 53.7962s
	iters: 900, epoch: 10 | loss: 0.2589381
	speed: 0.0050s/iter; left time: 53.7019s
	iters: 1000, epoch: 10 | loss: 0.1588485
	speed: 0.0050s/iter; left time: 53.3487s
Epoch: 10 cost time: 4.763122320175171
Epoch: 10, Steps: 1066 | Train Loss: 0.1998454 Vali Loss: 0.1282454 Test Loss: 0.1996901
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.0944053
	speed: 0.0199s/iter; left time: 210.4265s
	iters: 200, epoch: 11 | loss: 0.1816822
	speed: 0.0045s/iter; left time: 47.2837s
	iters: 300, epoch: 11 | loss: 0.1936658
	speed: 0.0044s/iter; left time: 45.1199s
	iters: 400, epoch: 11 | loss: 0.1731217
	speed: 0.0030s/iter; left time: 30.9097s
	iters: 500, epoch: 11 | loss: 0.2790962
	speed: 0.0031s/iter; left time: 31.4991s
	iters: 600, epoch: 11 | loss: 0.2222480
	speed: 0.0035s/iter; left time: 34.8298s
	iters: 700, epoch: 11 | loss: 0.3275530
	speed: 0.0037s/iter; left time: 37.0550s
	iters: 800, epoch: 11 | loss: 0.1872424
	speed: 0.0043s/iter; left time: 42.6380s
	iters: 900, epoch: 11 | loss: 0.1579243
	speed: 0.0037s/iter; left time: 36.5061s
	iters: 1000, epoch: 11 | loss: 0.3578615
	speed: 0.0031s/iter; left time: 29.5627s
Epoch: 11 cost time: 3.957291603088379
Epoch: 11, Steps: 1066 | Train Loss: 0.1992656 Vali Loss: 0.1322505 Test Loss: 0.2099716
EarlyStopping counter: 2 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.1589765
	speed: 0.0146s/iter; left time: 138.9689s
	iters: 200, epoch: 12 | loss: 0.1211766
	speed: 0.0037s/iter; left time: 35.0489s
	iters: 300, epoch: 12 | loss: 0.2444567
	speed: 0.0041s/iter; left time: 37.7663s
	iters: 400, epoch: 12 | loss: 0.0964291
	speed: 0.0038s/iter; left time: 35.0329s
	iters: 500, epoch: 12 | loss: 0.1077543
	speed: 0.0037s/iter; left time: 33.2764s
	iters: 600, epoch: 12 | loss: 0.2826360
	speed: 0.0037s/iter; left time: 33.4415s
	iters: 700, epoch: 12 | loss: 0.2147381
	speed: 0.0046s/iter; left time: 41.2726s
	iters: 800, epoch: 12 | loss: 0.2212637
	speed: 0.0049s/iter; left time: 42.7678s
	iters: 900, epoch: 12 | loss: 0.1426310
	speed: 0.0042s/iter; left time: 36.0873s
	iters: 1000, epoch: 12 | loss: 0.1393998
	speed: 0.0047s/iter; left time: 40.2248s
Epoch: 12 cost time: 4.365728139877319
Epoch: 12, Steps: 1066 | Train Loss: 0.1992552 Vali Loss: 0.1289822 Test Loss: 0.2015501
EarlyStopping counter: 3 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.1151188
	speed: 0.0153s/iter; left time: 128.9186s
	iters: 200, epoch: 13 | loss: 0.1681626
	speed: 0.0035s/iter; left time: 29.3181s
	iters: 300, epoch: 13 | loss: 0.2564592
	speed: 0.0041s/iter; left time: 34.0063s
	iters: 400, epoch: 13 | loss: 0.2778690
	speed: 0.0043s/iter; left time: 34.7919s
	iters: 500, epoch: 13 | loss: 0.1449253
	speed: 0.0044s/iter; left time: 35.0209s
	iters: 600, epoch: 13 | loss: 0.7553153
	speed: 0.0040s/iter; left time: 31.7994s
	iters: 700, epoch: 13 | loss: 0.1223698
	speed: 0.0041s/iter; left time: 31.9421s
	iters: 800, epoch: 13 | loss: 0.2156829
	speed: 0.0036s/iter; left time: 27.5394s
	iters: 900, epoch: 13 | loss: 0.2569800
	speed: 0.0037s/iter; left time: 28.3821s
	iters: 1000, epoch: 13 | loss: 0.2142244
	speed: 0.0037s/iter; left time: 28.0982s
Epoch: 13 cost time: 4.145017147064209
Epoch: 13, Steps: 1066 | Train Loss: 0.1991372 Vali Loss: 0.1322534 Test Loss: 0.2111583
EarlyStopping counter: 4 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 14 | loss: 0.1465348
	speed: 0.0179s/iter; left time: 131.8876s
	iters: 200, epoch: 14 | loss: 0.1185644
	speed: 0.0039s/iter; left time: 28.2678s
	iters: 300, epoch: 14 | loss: 0.2502023
	speed: 0.0042s/iter; left time: 29.7918s
	iters: 400, epoch: 14 | loss: 0.1572028
	speed: 0.0041s/iter; left time: 29.1167s
	iters: 500, epoch: 14 | loss: 0.1420247
	speed: 0.0046s/iter; left time: 31.8905s
	iters: 600, epoch: 14 | loss: 0.4520242
	speed: 0.0047s/iter; left time: 32.0533s
	iters: 700, epoch: 14 | loss: 0.1436974
	speed: 0.0045s/iter; left time: 30.2529s
	iters: 800, epoch: 14 | loss: 0.2046242
	speed: 0.0045s/iter; left time: 29.7834s
	iters: 900, epoch: 14 | loss: 0.2170883
	speed: 0.0042s/iter; left time: 27.2625s
	iters: 1000, epoch: 14 | loss: 0.2460270
	speed: 0.0041s/iter; left time: 26.3690s
Epoch: 14 cost time: 4.538124322891235
Epoch: 14, Steps: 1066 | Train Loss: 0.1990793 Vali Loss: 0.1319373 Test Loss: 0.2100507
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTm2_336_96_Linear_ETTm2_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15349<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.1803463101387024, mae:0.27475184202194214
