Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='NLinear', model_id='ETTm2_96_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=3144, seq_len=96, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTm2_96_96_NLinear_ETTm2_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3144>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34369
data_set:  <data_provider.data_loader.Dataset_ETT_minute object at 0x00000216185F0CF8>
val 11425
data_set:  <data_provider.data_loader.Dataset_ETT_minute object at 0x0000021665AA6D68>
test 11425
data_set:  <data_provider.data_loader.Dataset_ETT_minute object at 0x00000216641D75F8>
Total number of trainable parameters: 65184
Total number of parameters: 65184
	iters: 100, epoch: 1 | loss: 0.3842545
	speed: 0.0039s/iter; left time: 83.5471s
	iters: 200, epoch: 1 | loss: 0.2265019
	speed: 0.0034s/iter; left time: 73.1305s
	iters: 300, epoch: 1 | loss: 0.2094553
	speed: 0.0030s/iter; left time: 62.8917s
	iters: 400, epoch: 1 | loss: 0.1765082
	speed: 0.0038s/iter; left time: 79.6329s
	iters: 500, epoch: 1 | loss: 0.4387770
	speed: 0.0033s/iter; left time: 69.9560s
	iters: 600, epoch: 1 | loss: 0.1656925
	speed: 0.0035s/iter; left time: 72.7880s
	iters: 700, epoch: 1 | loss: 0.1976491
	speed: 0.0043s/iter; left time: 88.4248s
	iters: 800, epoch: 1 | loss: 0.4267865
	speed: 0.0035s/iter; left time: 72.0665s
	iters: 900, epoch: 1 | loss: 0.2339572
	speed: 0.0035s/iter; left time: 71.6570s
	iters: 1000, epoch: 1 | loss: 0.2278524
	speed: 0.0038s/iter; left time: 77.8695s
Epoch: 1 cost time: 3.8595967292785645
Epoch: 1, Steps: 1074 | Train Loss: 0.2718962 Vali Loss: 0.1381405 Test Loss: 0.1941530
Validation loss decreased (inf --> 0.138140).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.2789970
	speed: 0.0181s/iter; left time: 368.1852s
	iters: 200, epoch: 2 | loss: 0.3868324
	speed: 0.0036s/iter; left time: 73.4390s
	iters: 300, epoch: 2 | loss: 0.2016952
	speed: 0.0034s/iter; left time: 68.3054s
	iters: 400, epoch: 2 | loss: 0.3417901
	speed: 0.0033s/iter; left time: 65.0326s
	iters: 500, epoch: 2 | loss: 0.3031578
	speed: 0.0027s/iter; left time: 53.7975s
	iters: 600, epoch: 2 | loss: 0.1633087
	speed: 0.0035s/iter; left time: 68.6918s
	iters: 700, epoch: 2 | loss: 0.2182872
	speed: 0.0032s/iter; left time: 62.3776s
	iters: 800, epoch: 2 | loss: 0.2107418
	speed: 0.0032s/iter; left time: 62.1284s
	iters: 900, epoch: 2 | loss: 0.1725253
	speed: 0.0038s/iter; left time: 73.5995s
	iters: 1000, epoch: 2 | loss: 0.3365141
	speed: 0.0048s/iter; left time: 94.0258s
Epoch: 2 cost time: 3.692838191986084
Epoch: 2, Steps: 1074 | Train Loss: 0.2717794 Vali Loss: 0.1423554 Test Loss: 0.2045916
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.2054689
	speed: 0.0162s/iter; left time: 312.5079s
	iters: 200, epoch: 3 | loss: 0.2152759
	speed: 0.0045s/iter; left time: 85.4211s
	iters: 300, epoch: 3 | loss: 0.1344488
	speed: 0.0040s/iter; left time: 76.5894s
	iters: 400, epoch: 3 | loss: 0.2512952
	speed: 0.0032s/iter; left time: 59.9358s
	iters: 500, epoch: 3 | loss: 0.2119937
	speed: 0.0040s/iter; left time: 74.4803s
	iters: 600, epoch: 3 | loss: 0.1941043
	speed: 0.0033s/iter; left time: 61.8196s
	iters: 700, epoch: 3 | loss: 0.2234940
	speed: 0.0031s/iter; left time: 58.2194s
	iters: 800, epoch: 3 | loss: 0.2686422
	speed: 0.0030s/iter; left time: 54.9892s
	iters: 900, epoch: 3 | loss: 0.2642133
	speed: 0.0036s/iter; left time: 66.2810s
	iters: 1000, epoch: 3 | loss: 0.2576884
	speed: 0.0037s/iter; left time: 68.7443s
Epoch: 3 cost time: 3.7499475479125977
Epoch: 3, Steps: 1074 | Train Loss: 0.2473123 Vali Loss: 0.1469706 Test Loss: 0.2013046
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.1702385
	speed: 0.0164s/iter; left time: 297.9145s
	iters: 200, epoch: 4 | loss: 0.2364691
	speed: 0.0034s/iter; left time: 62.0486s
	iters: 300, epoch: 4 | loss: 0.1967109
	speed: 0.0038s/iter; left time: 67.3605s
	iters: 400, epoch: 4 | loss: 0.3236118
	speed: 0.0033s/iter; left time: 58.5887s
	iters: 500, epoch: 4 | loss: 0.2403569
	speed: 0.0033s/iter; left time: 59.0364s
	iters: 600, epoch: 4 | loss: 0.1770590
	speed: 0.0035s/iter; left time: 61.5641s
	iters: 700, epoch: 4 | loss: 0.2195671
	speed: 0.0033s/iter; left time: 58.7190s
	iters: 800, epoch: 4 | loss: 0.3795266
	speed: 0.0038s/iter; left time: 65.4970s
	iters: 900, epoch: 4 | loss: 0.2601832
	speed: 0.0044s/iter; left time: 76.4604s
	iters: 1000, epoch: 4 | loss: 0.1410401
	speed: 0.0040s/iter; left time: 68.3448s
Epoch: 4 cost time: 3.974003553390503
Epoch: 4, Steps: 1074 | Train Loss: 0.2380297 Vali Loss: 0.1374576 Test Loss: 0.1893776
Validation loss decreased (0.138140 --> 0.137458).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.2126242
	speed: 0.0198s/iter; left time: 338.9877s
	iters: 200, epoch: 5 | loss: 0.3854959
	speed: 0.0036s/iter; left time: 60.5002s
	iters: 300, epoch: 5 | loss: 0.2100151
	speed: 0.0042s/iter; left time: 70.3910s
	iters: 400, epoch: 5 | loss: 0.2946246
	speed: 0.0026s/iter; left time: 44.3560s
	iters: 500, epoch: 5 | loss: 0.1663843
	speed: 0.0030s/iter; left time: 49.7827s
	iters: 600, epoch: 5 | loss: 0.2310124
	speed: 0.0034s/iter; left time: 57.0308s
	iters: 700, epoch: 5 | loss: 0.1416790
	speed: 0.0039s/iter; left time: 64.3954s
	iters: 800, epoch: 5 | loss: 0.1651944
	speed: 0.0025s/iter; left time: 40.9868s
	iters: 900, epoch: 5 | loss: 0.1172904
	speed: 0.0039s/iter; left time: 63.5539s
	iters: 1000, epoch: 5 | loss: 0.3472296
	speed: 0.0041s/iter; left time: 66.0160s
Epoch: 5 cost time: 3.656144380569458
Epoch: 5, Steps: 1074 | Train Loss: 0.2341410 Vali Loss: 0.1267348 Test Loss: 0.1790614
Validation loss decreased (0.137458 --> 0.126735).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.4040537
	speed: 0.0178s/iter; left time: 284.9933s
	iters: 200, epoch: 6 | loss: 0.2351586
	speed: 0.0029s/iter; left time: 46.4670s
	iters: 300, epoch: 6 | loss: 0.1309900
	speed: 0.0038s/iter; left time: 60.0465s
	iters: 400, epoch: 6 | loss: 0.5861471
	speed: 0.0041s/iter; left time: 63.8048s
	iters: 500, epoch: 6 | loss: 0.1087733
	speed: 0.0027s/iter; left time: 41.4733s
	iters: 600, epoch: 6 | loss: 0.1724243
	speed: 0.0030s/iter; left time: 46.1275s
	iters: 700, epoch: 6 | loss: 0.1107391
	speed: 0.0033s/iter; left time: 51.2216s
	iters: 800, epoch: 6 | loss: 0.3065778
	speed: 0.0040s/iter; left time: 61.4753s
	iters: 900, epoch: 6 | loss: 0.3973794
	speed: 0.0025s/iter; left time: 38.0317s
	iters: 1000, epoch: 6 | loss: 0.2911865
	speed: 0.0036s/iter; left time: 54.3191s
Epoch: 6 cost time: 3.5976195335388184
Epoch: 6, Steps: 1074 | Train Loss: 0.2319628 Vali Loss: 0.1269127 Test Loss: 0.1789364
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.3016748
	speed: 0.0167s/iter; left time: 249.6755s
	iters: 200, epoch: 7 | loss: 0.1945056
	speed: 0.0031s/iter; left time: 46.3493s
	iters: 300, epoch: 7 | loss: 0.4632141
	speed: 0.0028s/iter; left time: 41.4560s
	iters: 400, epoch: 7 | loss: 0.1769494
	speed: 0.0031s/iter; left time: 45.7416s
	iters: 500, epoch: 7 | loss: 0.5252541
	speed: 0.0036s/iter; left time: 52.2594s
	iters: 600, epoch: 7 | loss: 0.1289700
	speed: 0.0031s/iter; left time: 45.1059s
	iters: 700, epoch: 7 | loss: 0.2894664
	speed: 0.0030s/iter; left time: 42.5636s
	iters: 800, epoch: 7 | loss: 0.2096176
	speed: 0.0036s/iter; left time: 51.1863s
	iters: 900, epoch: 7 | loss: 0.1692238
	speed: 0.0041s/iter; left time: 58.2093s
	iters: 1000, epoch: 7 | loss: 0.1690982
	speed: 0.0033s/iter; left time: 46.6977s
Epoch: 7 cost time: 3.6077051162719727
Epoch: 7, Steps: 1074 | Train Loss: 0.2305405 Vali Loss: 0.1255670 Test Loss: 0.1773378
Validation loss decreased (0.126735 --> 0.125567).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.5567571
	speed: 0.0159s/iter; left time: 221.0404s
	iters: 200, epoch: 8 | loss: 0.1874360
	speed: 0.0041s/iter; left time: 56.6030s
	iters: 300, epoch: 8 | loss: 0.1732573
	speed: 0.0041s/iter; left time: 55.5098s
	iters: 400, epoch: 8 | loss: 0.2412516
	speed: 0.0028s/iter; left time: 38.0871s
	iters: 500, epoch: 8 | loss: 0.1115282
	speed: 0.0030s/iter; left time: 39.9638s
	iters: 600, epoch: 8 | loss: 0.5369204
	speed: 0.0039s/iter; left time: 52.2462s
	iters: 700, epoch: 8 | loss: 0.1402629
	speed: 0.0033s/iter; left time: 44.0175s
	iters: 800, epoch: 8 | loss: 0.0963287
	speed: 0.0035s/iter; left time: 45.8923s
	iters: 900, epoch: 8 | loss: 0.7170538
	speed: 0.0034s/iter; left time: 43.7665s
	iters: 1000, epoch: 8 | loss: 0.1438538
	speed: 0.0038s/iter; left time: 48.6298s
Epoch: 8 cost time: 3.6684486865997314
Epoch: 8, Steps: 1074 | Train Loss: 0.2299551 Vali Loss: 0.1248754 Test Loss: 0.1768173
Validation loss decreased (0.125567 --> 0.124875).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.3120560
	speed: 0.0187s/iter; left time: 239.7478s
	iters: 200, epoch: 9 | loss: 0.2397511
	speed: 0.0036s/iter; left time: 45.1414s
	iters: 300, epoch: 9 | loss: 0.1723136
	speed: 0.0033s/iter; left time: 41.8060s
	iters: 400, epoch: 9 | loss: 0.1533133
	speed: 0.0042s/iter; left time: 51.8936s
	iters: 500, epoch: 9 | loss: 0.2921656
	speed: 0.0035s/iter; left time: 42.7538s
	iters: 600, epoch: 9 | loss: 0.1492348
	speed: 0.0036s/iter; left time: 44.7437s
	iters: 700, epoch: 9 | loss: 0.2239641
	speed: 0.0036s/iter; left time: 43.8163s
	iters: 800, epoch: 9 | loss: 0.1978070
	speed: 0.0032s/iter; left time: 38.6667s
	iters: 900, epoch: 9 | loss: 0.2108877
	speed: 0.0029s/iter; left time: 34.7377s
	iters: 1000, epoch: 9 | loss: 0.1102142
	speed: 0.0036s/iter; left time: 42.4096s
Epoch: 9 cost time: 3.748614549636841
Epoch: 9, Steps: 1074 | Train Loss: 0.2297008 Vali Loss: 0.1243803 Test Loss: 0.1766975
Validation loss decreased (0.124875 --> 0.124380).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.2111455
	speed: 0.0177s/iter; left time: 207.7099s
	iters: 200, epoch: 10 | loss: 0.1564669
	speed: 0.0043s/iter; left time: 50.2667s
	iters: 300, epoch: 10 | loss: 0.1390366
	speed: 0.0040s/iter; left time: 45.7476s
	iters: 400, epoch: 10 | loss: 0.2960164
	speed: 0.0029s/iter; left time: 33.0770s
	iters: 500, epoch: 10 | loss: 0.3872504
	speed: 0.0039s/iter; left time: 44.2218s
	iters: 600, epoch: 10 | loss: 0.2171070
	speed: 0.0036s/iter; left time: 40.3285s
	iters: 700, epoch: 10 | loss: 0.1222626
	speed: 0.0050s/iter; left time: 55.5416s
	iters: 800, epoch: 10 | loss: 0.1185127
	speed: 0.0039s/iter; left time: 43.0167s
	iters: 900, epoch: 10 | loss: 0.1762200
	speed: 0.0046s/iter; left time: 50.0804s
	iters: 1000, epoch: 10 | loss: 0.2635928
	speed: 0.0037s/iter; left time: 39.9493s
Epoch: 10 cost time: 4.18517279624939
Epoch: 10, Steps: 1074 | Train Loss: 0.2295077 Vali Loss: 0.1242668 Test Loss: 0.1764372
Validation loss decreased (0.124380 --> 0.124267).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.1287286
	speed: 0.0169s/iter; left time: 179.5953s
	iters: 200, epoch: 11 | loss: 0.2062683
	speed: 0.0041s/iter; left time: 42.8146s
	iters: 300, epoch: 11 | loss: 0.1435174
	speed: 0.0027s/iter; left time: 27.7318s
	iters: 400, epoch: 11 | loss: 0.1034833
	speed: 0.0044s/iter; left time: 45.2497s
	iters: 500, epoch: 11 | loss: 0.4334668
	speed: 0.0036s/iter; left time: 36.8025s
	iters: 600, epoch: 11 | loss: 0.1638634
	speed: 0.0028s/iter; left time: 28.5100s
	iters: 700, epoch: 11 | loss: 0.1354774
	speed: 0.0027s/iter; left time: 26.6557s
	iters: 800, epoch: 11 | loss: 0.2031026
	speed: 0.0035s/iter; left time: 34.5569s
	iters: 900, epoch: 11 | loss: 0.1384536
	speed: 0.0038s/iter; left time: 37.3803s
	iters: 1000, epoch: 11 | loss: 0.2564735
	speed: 0.0032s/iter; left time: 31.1466s
Epoch: 11 cost time: 3.6253809928894043
Epoch: 11, Steps: 1074 | Train Loss: 0.2294185 Vali Loss: 0.1248019 Test Loss: 0.1766927
EarlyStopping counter: 1 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.2746009
	speed: 0.0154s/iter; left time: 147.3345s
	iters: 200, epoch: 12 | loss: 0.1426786
	speed: 0.0027s/iter; left time: 25.7867s
	iters: 300, epoch: 12 | loss: 0.1534479
	speed: 0.0028s/iter; left time: 26.3420s
	iters: 400, epoch: 12 | loss: 0.1903719
	speed: 0.0028s/iter; left time: 25.5273s
	iters: 500, epoch: 12 | loss: 0.1631978
	speed: 0.0030s/iter; left time: 27.7302s
	iters: 600, epoch: 12 | loss: 0.2210219
	speed: 0.0033s/iter; left time: 29.7394s
	iters: 700, epoch: 12 | loss: 0.1291981
	speed: 0.0025s/iter; left time: 22.5562s
	iters: 800, epoch: 12 | loss: 0.1408912
	speed: 0.0025s/iter; left time: 22.4519s
	iters: 900, epoch: 12 | loss: 0.1611540
	speed: 0.0027s/iter; left time: 23.5948s
	iters: 1000, epoch: 12 | loss: 0.3414470
	speed: 0.0026s/iter; left time: 22.3403s
Epoch: 12 cost time: 2.9929401874542236
Epoch: 12, Steps: 1074 | Train Loss: 0.2293888 Vali Loss: 0.1246837 Test Loss: 0.1766418
EarlyStopping counter: 2 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.1634106
	speed: 0.0162s/iter; left time: 137.4408s
	iters: 200, epoch: 13 | loss: 0.1742063
	speed: 0.0030s/iter; left time: 25.2931s
	iters: 300, epoch: 13 | loss: 0.1745690
	speed: 0.0033s/iter; left time: 27.3895s
	iters: 400, epoch: 13 | loss: 0.4374511
	speed: 0.0027s/iter; left time: 21.8198s
	iters: 500, epoch: 13 | loss: 0.1676480
	speed: 0.0021s/iter; left time: 16.6434s
	iters: 600, epoch: 13 | loss: 0.1810762
	speed: 0.0024s/iter; left time: 18.9460s
	iters: 700, epoch: 13 | loss: 0.1820526
	speed: 0.0020s/iter; left time: 15.5455s
	iters: 800, epoch: 13 | loss: 0.3230237
	speed: 0.0023s/iter; left time: 17.9994s
	iters: 900, epoch: 13 | loss: 0.1138180
	speed: 0.0024s/iter; left time: 18.2983s
	iters: 1000, epoch: 13 | loss: 0.2396223
	speed: 0.0022s/iter; left time: 16.6233s
Epoch: 13 cost time: 2.74578857421875
Epoch: 13, Steps: 1074 | Train Loss: 0.2293540 Vali Loss: 0.1247461 Test Loss: 0.1766940
EarlyStopping counter: 3 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 14 | loss: 0.5343065
	speed: 0.0102s/iter; left time: 75.3441s
	iters: 200, epoch: 14 | loss: 0.1940431
	speed: 0.0019s/iter; left time: 13.7143s
	iters: 300, epoch: 14 | loss: 0.2219190
	speed: 0.0019s/iter; left time: 13.7002s
	iters: 400, epoch: 14 | loss: 0.2594750
	speed: 0.0025s/iter; left time: 18.0400s
	iters: 500, epoch: 14 | loss: 0.2445018
	speed: 0.0024s/iter; left time: 16.6847s
	iters: 600, epoch: 14 | loss: 0.3398141
	speed: 0.0021s/iter; left time: 14.5306s
	iters: 700, epoch: 14 | loss: 0.1216330
	speed: 0.0022s/iter; left time: 14.9225s
	iters: 800, epoch: 14 | loss: 0.2345494
	speed: 0.0023s/iter; left time: 15.7221s
	iters: 900, epoch: 14 | loss: 0.4631310
	speed: 0.0022s/iter; left time: 14.4947s
	iters: 1000, epoch: 14 | loss: 0.1271472
	speed: 0.0020s/iter; left time: 13.2239s
Epoch: 14 cost time: 2.360806941986084
Epoch: 14, Steps: 1074 | Train Loss: 0.2293379 Vali Loss: 0.1247587 Test Loss: 0.1766982
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 15 | loss: 0.1930348
	speed: 0.0103s/iter; left time: 65.4547s
	iters: 200, epoch: 15 | loss: 0.2318489
	speed: 0.0025s/iter; left time: 15.6672s
	iters: 300, epoch: 15 | loss: 0.4024884
	speed: 0.0021s/iter; left time: 12.6451s
	iters: 400, epoch: 15 | loss: 0.4022437
	speed: 0.0022s/iter; left time: 13.3983s
	iters: 500, epoch: 15 | loss: 0.3392256
	speed: 0.0020s/iter; left time: 11.6730s
	iters: 600, epoch: 15 | loss: 0.1084079
	speed: 0.0026s/iter; left time: 15.3551s
	iters: 700, epoch: 15 | loss: 0.3597302
	speed: 0.0022s/iter; left time: 12.7254s
	iters: 800, epoch: 15 | loss: 0.1395888
	speed: 0.0019s/iter; left time: 10.5975s
	iters: 900, epoch: 15 | loss: 0.1892179
	speed: 0.0021s/iter; left time: 11.3957s
	iters: 1000, epoch: 15 | loss: 0.3306266
	speed: 0.0028s/iter; left time: 15.3971s
Epoch: 15 cost time: 2.417886972427368
Epoch: 15, Steps: 1074 | Train Loss: 0.2293277 Vali Loss: 0.1247611 Test Loss: 0.1766949
EarlyStopping counter: 5 out of 5
Early stopping
Total training time: 67.4220 seconds
>>>>>>>testing : ETTm2_96_96_NLinear_ETTm2_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3144<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
data_set:  <data_provider.data_loader.Dataset_ETT_minute object at 0x00000216641D75F8>
mse:0.17669183015823364, mae:0.25663307309150696
