Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTh2', data_path='ETTh2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.05, loss='mse', lradj='type1', model='DLinear', model_id='ETTh2_336_192', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=192, root_path='./dataset/', save_pred_values=False, seed=15349, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTh2_336_192_DLinear_ETTh2_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15349>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8113
val 2689
test 2689
Total number of trainable parameters: 905856
Total number of parameters: 905856
	iters: 100, epoch: 1 | loss: 1.4749960
	speed: 0.0185s/iter; left time: 91.6210s
	iters: 200, epoch: 1 | loss: 2.5350573
	speed: 0.0179s/iter; left time: 87.0903s
Epoch: 1 cost time: 4.565091848373413
Epoch: 1, Steps: 253 | Train Loss: 5.7817879 Vali Loss: 2.7677164 Test Loss: 7.5720816
Validation loss decreased (inf --> 2.767716).  Saving model ...
Updating learning rate to 0.05
	iters: 100, epoch: 2 | loss: 5.7196894
	speed: 0.0366s/iter; left time: 172.2565s
	iters: 200, epoch: 2 | loss: 4.4825339
	speed: 0.0182s/iter; left time: 83.8148s
Epoch: 2 cost time: 4.659188270568848
Epoch: 2, Steps: 253 | Train Loss: 3.5409833 Vali Loss: 2.6025145 Test Loss: 5.1308517
Validation loss decreased (2.767716 --> 2.602515).  Saving model ...
Updating learning rate to 0.025
	iters: 100, epoch: 3 | loss: 0.7130678
	speed: 0.0390s/iter; left time: 173.7235s
	iters: 200, epoch: 3 | loss: 0.7344319
	speed: 0.0185s/iter; left time: 80.5523s
Epoch: 3 cost time: 4.516700029373169
Epoch: 3, Steps: 253 | Train Loss: 0.9821849 Vali Loss: 0.6282195 Test Loss: 1.5577985
Validation loss decreased (2.602515 --> 0.628219).  Saving model ...
Updating learning rate to 0.0125
	iters: 100, epoch: 4 | loss: 0.4028567
	speed: 0.0361s/iter; left time: 151.8508s
	iters: 200, epoch: 4 | loss: 0.5138371
	speed: 0.0175s/iter; left time: 71.8548s
Epoch: 4 cost time: 4.229615688323975
Epoch: 4, Steps: 253 | Train Loss: 0.5815756 Vali Loss: 0.6337274 Test Loss: 1.4087526
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00625
	iters: 100, epoch: 5 | loss: 0.8509746
	speed: 0.0365s/iter; left time: 144.2910s
	iters: 200, epoch: 5 | loss: 0.6770557
	speed: 0.0212s/iter; left time: 81.6521s
Epoch: 5 cost time: 4.981842041015625
Epoch: 5, Steps: 253 | Train Loss: 0.5097863 Vali Loss: 0.4345471 Test Loss: 0.7951385
Validation loss decreased (0.628219 --> 0.434547).  Saving model ...
Updating learning rate to 0.003125
	iters: 100, epoch: 6 | loss: 0.4682269
	speed: 0.0364s/iter; left time: 134.4811s
	iters: 200, epoch: 6 | loss: 0.4376372
	speed: 0.0172s/iter; left time: 61.8775s
Epoch: 6 cost time: 4.268589496612549
Epoch: 6, Steps: 253 | Train Loss: 0.4767993 Vali Loss: 0.4471467 Test Loss: 0.8024350
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0015625
	iters: 100, epoch: 7 | loss: 0.3746405
	speed: 0.0328s/iter; left time: 113.0925s
	iters: 200, epoch: 7 | loss: 0.5189355
	speed: 0.0174s/iter; left time: 58.3341s
Epoch: 7 cost time: 4.330039739608765
Epoch: 7, Steps: 253 | Train Loss: 0.4580637 Vali Loss: 0.4436418 Test Loss: 0.7435840
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.00078125
	iters: 100, epoch: 8 | loss: 0.6266271
	speed: 0.0338s/iter; left time: 107.9077s
	iters: 200, epoch: 8 | loss: 0.3942970
	speed: 0.0177s/iter; left time: 54.8438s
Epoch: 8 cost time: 4.327965974807739
Epoch: 8, Steps: 253 | Train Loss: 0.4470228 Vali Loss: 0.3644976 Test Loss: 0.5276601
Validation loss decreased (0.434547 --> 0.364498).  Saving model ...
Updating learning rate to 0.000390625
	iters: 100, epoch: 9 | loss: 0.2845442
	speed: 0.0346s/iter; left time: 101.6007s
	iters: 200, epoch: 9 | loss: 0.5836996
	speed: 0.0176s/iter; left time: 50.0595s
Epoch: 9 cost time: 4.293763637542725
Epoch: 9, Steps: 253 | Train Loss: 0.4425643 Vali Loss: 0.3846819 Test Loss: 0.5773500
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0001953125
	iters: 100, epoch: 10 | loss: 0.7178695
	speed: 0.0346s/iter; left time: 92.7491s
	iters: 200, epoch: 10 | loss: 0.5802763
	speed: 0.0177s/iter; left time: 45.6545s
Epoch: 10 cost time: 4.364620923995972
Epoch: 10, Steps: 253 | Train Loss: 0.4388315 Vali Loss: 0.3594186 Test Loss: 0.4972869
Validation loss decreased (0.364498 --> 0.359419).  Saving model ...
Updating learning rate to 9.765625e-05
	iters: 100, epoch: 11 | loss: 0.5458164
	speed: 0.0359s/iter; left time: 87.3288s
	iters: 200, epoch: 11 | loss: 0.3483378
	speed: 0.0177s/iter; left time: 41.1586s
Epoch: 11 cost time: 4.351800203323364
Epoch: 11, Steps: 253 | Train Loss: 0.4379333 Vali Loss: 0.3785898 Test Loss: 0.5770462
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.8828125e-05
	iters: 100, epoch: 12 | loss: 0.2478591
	speed: 0.0323s/iter; left time: 70.3589s
	iters: 200, epoch: 12 | loss: 0.4392002
	speed: 0.0149s/iter; left time: 31.0223s
Epoch: 12 cost time: 3.773634910583496
Epoch: 12, Steps: 253 | Train Loss: 0.4364885 Vali Loss: 0.3843317 Test Loss: 0.5951032
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.44140625e-05
	iters: 100, epoch: 13 | loss: 0.6164863
	speed: 0.0259s/iter; left time: 49.9520s
	iters: 200, epoch: 13 | loss: 0.3976318
	speed: 0.0116s/iter; left time: 21.1072s
Epoch: 13 cost time: 3.0508735179901123
Epoch: 13, Steps: 253 | Train Loss: 0.4364504 Vali Loss: 0.3749633 Test Loss: 0.5606143
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.220703125e-05
	iters: 100, epoch: 14 | loss: 0.2695327
	speed: 0.0216s/iter; left time: 36.1876s
	iters: 200, epoch: 14 | loss: 0.3665157
	speed: 0.0098s/iter; left time: 15.4021s
Epoch: 14 cost time: 2.464730739593506
Epoch: 14, Steps: 253 | Train Loss: 0.4360194 Vali Loss: 0.3782485 Test Loss: 0.5725861
EarlyStopping counter: 4 out of 5
Updating learning rate to 6.103515625e-06
	iters: 100, epoch: 15 | loss: 0.4052238
	speed: 0.0168s/iter; left time: 23.8656s
	iters: 200, epoch: 15 | loss: 0.4488236
	speed: 0.0076s/iter; left time: 10.0196s
Epoch: 15 cost time: 1.920468807220459
Epoch: 15, Steps: 253 | Train Loss: 0.4352366 Vali Loss: 0.3786199 Test Loss: 0.5741690
EarlyStopping counter: 5 out of 5
Early stopping
Total training time: 72.1260 seconds
>>>>>>>testing : ETTh2_336_192_DLinear_ETTh2_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15349<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2689
mse:0.49949899315834045, mae:0.4695650637149811
