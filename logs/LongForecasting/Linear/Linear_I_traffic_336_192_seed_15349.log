Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='Linear', model_id='traffic_336_192', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=192, root_path='./dataset/', save_pred_values=False, seed=15349, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_336_192_Linear_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15349>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11753
val 1565
test 3317
	iters: 100, epoch: 1 | loss: 0.4485382
	speed: 0.3174s/iter; left time: 4627.3969s
	iters: 200, epoch: 1 | loss: 0.4552003
	speed: 0.3030s/iter; left time: 4387.7617s
	iters: 300, epoch: 1 | loss: 0.4678671
	speed: 0.3025s/iter; left time: 4349.9487s
	iters: 400, epoch: 1 | loss: 0.4881177
	speed: 0.3024s/iter; left time: 4319.1139s
	iters: 500, epoch: 1 | loss: 0.5257265
	speed: 0.3031s/iter; left time: 4298.3322s
	iters: 600, epoch: 1 | loss: 0.4539239
	speed: 0.3013s/iter; left time: 4242.2634s
	iters: 700, epoch: 1 | loss: 0.4756660
	speed: 0.3027s/iter; left time: 4232.5840s
Epoch: 1 cost time: 223.75280356407166
Epoch: 1, Steps: 734 | Train Loss: 0.4825047 Vali Loss: 0.6260856 Test Loss: 0.7479535
Validation loss decreased (inf --> 0.626086).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.4333999
	speed: 0.6101s/iter; left time: 8448.1783s
	iters: 200, epoch: 2 | loss: 0.4744712
	speed: 0.3005s/iter; left time: 4131.5504s
	iters: 300, epoch: 2 | loss: 0.4479850
	speed: 0.3005s/iter; left time: 4100.5090s
	iters: 400, epoch: 2 | loss: 0.4753763
	speed: 0.3024s/iter; left time: 4096.2972s
	iters: 500, epoch: 2 | loss: 0.4608837
	speed: 0.3012s/iter; left time: 4050.5458s
	iters: 600, epoch: 2 | loss: 0.4829956
	speed: 0.3001s/iter; left time: 4005.4787s
	iters: 700, epoch: 2 | loss: 0.4700782
	speed: 0.3022s/iter; left time: 4003.6212s
Epoch: 2 cost time: 221.27600646018982
Epoch: 2, Steps: 734 | Train Loss: 0.4726856 Vali Loss: 0.6240403 Test Loss: 0.7571051
Validation loss decreased (0.626086 --> 0.624040).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.3107833
	speed: 0.6111s/iter; left time: 8012.9281s
	iters: 200, epoch: 3 | loss: 0.2903675
	speed: 0.3030s/iter; left time: 3942.5875s
	iters: 300, epoch: 3 | loss: 0.3425080
	speed: 0.3032s/iter; left time: 3915.1047s
	iters: 400, epoch: 3 | loss: 0.3660019
	speed: 0.3011s/iter; left time: 3858.0396s
	iters: 500, epoch: 3 | loss: 0.3226523
	speed: 0.3035s/iter; left time: 3858.7247s
	iters: 600, epoch: 3 | loss: 0.3262030
	speed: 0.3048s/iter; left time: 3844.5092s
	iters: 700, epoch: 3 | loss: 0.3426934
	speed: 0.3023s/iter; left time: 3782.2913s
Epoch: 3 cost time: 222.39776921272278
Epoch: 3, Steps: 734 | Train Loss: 0.3302852 Vali Loss: 0.4559064 Test Loss: 0.5542253
Validation loss decreased (0.624040 --> 0.455906).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.2748636
	speed: 0.6096s/iter; left time: 7546.6867s
	iters: 200, epoch: 4 | loss: 0.2677273
	speed: 0.3026s/iter; left time: 3716.0336s
	iters: 300, epoch: 4 | loss: 0.2760125
	speed: 0.3027s/iter; left time: 3686.3166s
	iters: 400, epoch: 4 | loss: 0.2727302
	speed: 0.3032s/iter; left time: 3661.9435s
	iters: 500, epoch: 4 | loss: 0.2756869
	speed: 0.3026s/iter; left time: 3625.0936s
	iters: 600, epoch: 4 | loss: 0.2740398
	speed: 0.3032s/iter; left time: 3601.5167s
	iters: 700, epoch: 4 | loss: 0.2753147
	speed: 0.3029s/iter; left time: 3567.9773s
Epoch: 4 cost time: 222.41240239143372
Epoch: 4, Steps: 734 | Train Loss: 0.2824264 Vali Loss: 0.4005670 Test Loss: 0.4918232
Validation loss decreased (0.455906 --> 0.400567).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.2850364
	speed: 0.6107s/iter; left time: 7111.7403s
	iters: 200, epoch: 5 | loss: 0.2553289
	speed: 0.3016s/iter; left time: 3481.9116s
	iters: 300, epoch: 5 | loss: 0.2810699
	speed: 0.3024s/iter; left time: 3461.0291s
	iters: 400, epoch: 5 | loss: 0.2625139
	speed: 0.3020s/iter; left time: 3426.3804s
	iters: 500, epoch: 5 | loss: 0.2776667
	speed: 0.3023s/iter; left time: 3399.4717s
	iters: 600, epoch: 5 | loss: 0.2397819
	speed: 0.3018s/iter; left time: 3363.0163s
	iters: 700, epoch: 5 | loss: 0.2608942
	speed: 0.3039s/iter; left time: 3357.1082s
Epoch: 5 cost time: 222.13922667503357
Epoch: 5, Steps: 734 | Train Loss: 0.2614106 Vali Loss: 0.3785166 Test Loss: 0.4662751
Validation loss decreased (0.400567 --> 0.378517).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.2521809
	speed: 0.6119s/iter; left time: 6676.7891s
	iters: 200, epoch: 6 | loss: 0.2437692
	speed: 0.3013s/iter; left time: 3257.4908s
	iters: 300, epoch: 6 | loss: 0.2728693
	speed: 0.3012s/iter; left time: 3226.1032s
	iters: 400, epoch: 6 | loss: 0.2342146
	speed: 0.3011s/iter; left time: 3195.3002s
	iters: 500, epoch: 6 | loss: 0.2481034
	speed: 0.3001s/iter; left time: 3154.6833s
	iters: 600, epoch: 6 | loss: 0.2262349
	speed: 0.3002s/iter; left time: 3125.6685s
	iters: 700, epoch: 6 | loss: 0.2982673
	speed: 0.3022s/iter; left time: 3116.2884s
Epoch: 6 cost time: 221.28832745552063
Epoch: 6, Steps: 734 | Train Loss: 0.2505831 Vali Loss: 0.3655560 Test Loss: 0.4512345
Validation loss decreased (0.378517 --> 0.365556).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.2675925
	speed: 0.6100s/iter; left time: 6207.4803s
	iters: 200, epoch: 7 | loss: 0.2626570
	speed: 0.3012s/iter; left time: 3034.7143s
	iters: 300, epoch: 7 | loss: 0.2593122
	speed: 0.3008s/iter; left time: 3000.7354s
	iters: 400, epoch: 7 | loss: 0.2529500
	speed: 0.3014s/iter; left time: 2977.1697s
	iters: 500, epoch: 7 | loss: 0.2318389
	speed: 0.3013s/iter; left time: 2946.0543s
	iters: 600, epoch: 7 | loss: 0.2290321
	speed: 0.2996s/iter; left time: 2898.7758s
	iters: 700, epoch: 7 | loss: 0.2352972
	speed: 0.3006s/iter; left time: 2878.9424s
Epoch: 7 cost time: 220.96532654762268
Epoch: 7, Steps: 734 | Train Loss: 0.2446520 Vali Loss: 0.3608684 Test Loss: 0.4448971
Validation loss decreased (0.365556 --> 0.360868).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.2296408
	speed: 0.6096s/iter; left time: 5756.8831s
	iters: 200, epoch: 8 | loss: 0.2404308
	speed: 0.3015s/iter; left time: 2817.0031s
	iters: 300, epoch: 8 | loss: 0.2290359
	speed: 0.3001s/iter; left time: 2773.5906s
	iters: 400, epoch: 8 | loss: 0.2377898
	speed: 0.3013s/iter; left time: 2755.1201s
	iters: 500, epoch: 8 | loss: 0.2233156
	speed: 0.3010s/iter; left time: 2722.0086s
	iters: 600, epoch: 8 | loss: 0.2629159
	speed: 0.3001s/iter; left time: 2684.2161s
	iters: 700, epoch: 8 | loss: 0.2433852
	speed: 0.3008s/iter; left time: 2659.5817s
Epoch: 8 cost time: 220.75293231010437
Epoch: 8, Steps: 734 | Train Loss: 0.2413932 Vali Loss: 0.3574348 Test Loss: 0.4415026
Validation loss decreased (0.360868 --> 0.357435).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.2298146
	speed: 0.6058s/iter; left time: 5276.2536s
	iters: 200, epoch: 9 | loss: 0.2382181
	speed: 0.2992s/iter; left time: 2575.5873s
	iters: 300, epoch: 9 | loss: 0.2373911
	speed: 0.2999s/iter; left time: 2552.1270s
	iters: 400, epoch: 9 | loss: 0.2381386
	speed: 0.3022s/iter; left time: 2541.3215s
	iters: 500, epoch: 9 | loss: 0.2026964
	speed: 0.3007s/iter; left time: 2498.1302s
	iters: 600, epoch: 9 | loss: 0.2394141
	speed: 0.3020s/iter; left time: 2479.2099s
	iters: 700, epoch: 9 | loss: 0.2454964
	speed: 0.3008s/iter; left time: 2439.5003s
Epoch: 9 cost time: 220.82271337509155
Epoch: 9, Steps: 734 | Train Loss: 0.2395772 Vali Loss: 0.3566326 Test Loss: 0.4402325
Validation loss decreased (0.357435 --> 0.356633).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.2549896
	speed: 0.6070s/iter; left time: 4840.7841s
	iters: 200, epoch: 10 | loss: 0.2461468
	speed: 0.3017s/iter; left time: 2375.5197s
	iters: 300, epoch: 10 | loss: 0.2363858
	speed: 0.3009s/iter; left time: 2339.8219s
	iters: 400, epoch: 10 | loss: 0.2390723
	speed: 0.3010s/iter; left time: 2310.4049s
	iters: 500, epoch: 10 | loss: 0.2389455
	speed: 0.3019s/iter; left time: 2286.8081s
	iters: 600, epoch: 10 | loss: 0.2425280
	speed: 0.2997s/iter; left time: 2240.1729s
	iters: 700, epoch: 10 | loss: 0.2292525
	speed: 0.2997s/iter; left time: 2210.3114s
Epoch: 10 cost time: 220.90689706802368
Epoch: 10, Steps: 734 | Train Loss: 0.2385904 Vali Loss: 0.3558747 Test Loss: 0.4395287
Validation loss decreased (0.356633 --> 0.355875).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.2402372
	speed: 0.6093s/iter; left time: 4411.7695s
	iters: 200, epoch: 11 | loss: 0.2577138
	speed: 0.2992s/iter; left time: 2136.4167s
	iters: 300, epoch: 11 | loss: 0.2190935
	speed: 0.2998s/iter; left time: 2111.0203s
	iters: 400, epoch: 11 | loss: 0.2612393
	speed: 0.3022s/iter; left time: 2097.8719s
	iters: 500, epoch: 11 | loss: 0.2453454
	speed: 0.3002s/iter; left time: 2053.5255s
	iters: 600, epoch: 11 | loss: 0.2291086
	speed: 0.3002s/iter; left time: 2023.8589s
	iters: 700, epoch: 11 | loss: 0.2278183
	speed: 0.3001s/iter; left time: 1992.8618s
Epoch: 11 cost time: 220.6251242160797
Epoch: 11, Steps: 734 | Train Loss: 0.2380740 Vali Loss: 0.3556233 Test Loss: 0.4391005
Validation loss decreased (0.355875 --> 0.355623).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.2386521
	speed: 0.6127s/iter; left time: 3986.5175s
	iters: 200, epoch: 12 | loss: 0.2434770
	speed: 0.3011s/iter; left time: 1929.4086s
	iters: 300, epoch: 12 | loss: 0.2350578
	speed: 0.3006s/iter; left time: 1896.1766s
	iters: 400, epoch: 12 | loss: 0.2315139
	speed: 0.3029s/iter; left time: 1879.8246s
	iters: 500, epoch: 12 | loss: 0.2436664
	speed: 0.3005s/iter; left time: 1835.2604s
	iters: 600, epoch: 12 | loss: 0.2220923
	speed: 0.3029s/iter; left time: 1819.3468s
	iters: 700, epoch: 12 | loss: 0.2259259
	speed: 0.3022s/iter; left time: 1785.3284s
Epoch: 12 cost time: 221.7930943965912
Epoch: 12, Steps: 734 | Train Loss: 0.2377874 Vali Loss: 0.3551200 Test Loss: 0.4390323
Validation loss decreased (0.355623 --> 0.355120).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.2291821
	speed: 0.6130s/iter; left time: 3538.8606s
	iters: 200, epoch: 13 | loss: 0.2440802
	speed: 0.3043s/iter; left time: 1726.1171s
	iters: 300, epoch: 13 | loss: 0.2290241
	speed: 0.3035s/iter; left time: 1691.4753s
	iters: 400, epoch: 13 | loss: 0.2319210
	speed: 0.3054s/iter; left time: 1671.3344s
	iters: 500, epoch: 13 | loss: 0.2528251
	speed: 0.3020s/iter; left time: 1622.6366s
	iters: 600, epoch: 13 | loss: 0.2308671
	speed: 0.3022s/iter; left time: 1593.3108s
	iters: 700, epoch: 13 | loss: 0.2376994
	speed: 0.3024s/iter; left time: 1564.4335s
Epoch: 13 cost time: 222.76148128509521
Epoch: 13, Steps: 734 | Train Loss: 0.2376408 Vali Loss: 0.3554899 Test Loss: 0.4390111
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 14 | loss: 0.2310418
	speed: 0.6115s/iter; left time: 3081.3454s
	iters: 200, epoch: 14 | loss: 0.2616195
	speed: 0.3028s/iter; left time: 1495.3746s
	iters: 300, epoch: 14 | loss: 0.2147744
	speed: 0.3038s/iter; left time: 1470.0277s
	iters: 400, epoch: 14 | loss: 0.2335580
	speed: 0.3024s/iter; left time: 1433.2687s
	iters: 500, epoch: 14 | loss: 0.2311992
	speed: 0.3027s/iter; left time: 1404.1981s
	iters: 600, epoch: 14 | loss: 0.2460548
	speed: 0.3021s/iter; left time: 1371.4026s
	iters: 700, epoch: 14 | loss: 0.2236549
	speed: 0.3025s/iter; left time: 1342.6844s
Epoch: 14 cost time: 222.38672542572021
Epoch: 14, Steps: 734 | Train Loss: 0.2375472 Vali Loss: 0.3556375 Test Loss: 0.4389656
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 15 | loss: 0.2426743
	speed: 0.6077s/iter; left time: 2616.1761s
	iters: 200, epoch: 15 | loss: 0.2070899
	speed: 0.3032s/iter; left time: 1274.7611s
	iters: 300, epoch: 15 | loss: 0.2588694
	speed: 0.3033s/iter; left time: 1244.8440s
	iters: 400, epoch: 15 | loss: 0.2317941
	speed: 0.3045s/iter; left time: 1219.3765s
	iters: 500, epoch: 15 | loss: 0.2389247
	speed: 0.3038s/iter; left time: 1186.2097s
	iters: 600, epoch: 15 | loss: 0.2081336
	speed: 0.3039s/iter; left time: 1156.4735s
	iters: 700, epoch: 15 | loss: 0.2428331
	speed: 0.3014s/iter; left time: 1116.7998s
Epoch: 15 cost time: 222.3130304813385
Epoch: 15, Steps: 734 | Train Loss: 0.2375165 Vali Loss: 0.3555741 Test Loss: 0.4389576
EarlyStopping counter: 3 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 16 | loss: 0.2265121
	speed: 0.6085s/iter; left time: 2172.9467s
	iters: 200, epoch: 16 | loss: 0.2341316
	speed: 0.3030s/iter; left time: 1051.6016s
	iters: 300, epoch: 16 | loss: 0.2256763
	speed: 0.3022s/iter; left time: 1018.8824s
	iters: 400, epoch: 16 | loss: 0.2286397
	speed: 0.3015s/iter; left time: 986.2724s
	iters: 500, epoch: 16 | loss: 0.2423941
	speed: 0.3028s/iter; left time: 960.2303s
	iters: 600, epoch: 16 | loss: 0.2219335
	speed: 0.3024s/iter; left time: 928.5711s
	iters: 700, epoch: 16 | loss: 0.2332887
	speed: 0.3030s/iter; left time: 900.1767s
Epoch: 16 cost time: 222.06326580047607
Epoch: 16, Steps: 734 | Train Loss: 0.2374953 Vali Loss: 0.3557333 Test Loss: 0.4389556
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 17 | loss: 0.2235062
	speed: 0.6059s/iter; left time: 1718.9478s
	iters: 200, epoch: 17 | loss: 0.2475854
	speed: 0.3016s/iter; left time: 825.3747s
	iters: 300, epoch: 17 | loss: 0.2279135
	speed: 0.3031s/iter; left time: 799.1778s
	iters: 400, epoch: 17 | loss: 0.2531106
	speed: 0.3016s/iter; left time: 765.1401s
	iters: 500, epoch: 17 | loss: 0.2429783
	speed: 0.3021s/iter; left time: 736.1121s
	iters: 600, epoch: 17 | loss: 0.2597521
	speed: 0.3031s/iter; left time: 708.4323s
	iters: 700, epoch: 17 | loss: 0.2223121
	speed: 0.3028s/iter; left time: 677.3288s
Epoch: 17 cost time: 221.7423312664032
Epoch: 17, Steps: 734 | Train Loss: 0.2374713 Vali Loss: 0.3553036 Test Loss: 0.4389545
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : traffic_336_192_Linear_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15349<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3317
mse:0.4387238323688507, mae:0.30413421988487244
