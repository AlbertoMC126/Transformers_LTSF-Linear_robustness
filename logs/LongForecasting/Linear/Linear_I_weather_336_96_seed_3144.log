Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='Linear', model_id='weather_336_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=3144, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : weather_336_96_Linear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3144>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36456
val 5175
test 10444
	iters: 100, epoch: 1 | loss: 0.6050712
	speed: 0.0113s/iter; left time: 514.4815s
	iters: 200, epoch: 1 | loss: 0.2854167
	speed: 0.0096s/iter; left time: 434.0821s
	iters: 300, epoch: 1 | loss: 0.7373455
	speed: 0.0099s/iter; left time: 449.1800s
	iters: 400, epoch: 1 | loss: 1.1532674
	speed: 0.0095s/iter; left time: 427.6831s
	iters: 500, epoch: 1 | loss: 0.5400475
	speed: 0.0097s/iter; left time: 437.1976s
	iters: 600, epoch: 1 | loss: 1.2282752
	speed: 0.0095s/iter; left time: 429.0433s
	iters: 700, epoch: 1 | loss: 0.6007532
	speed: 0.0097s/iter; left time: 433.0246s
	iters: 800, epoch: 1 | loss: 0.4229058
	speed: 0.0102s/iter; left time: 457.3503s
	iters: 900, epoch: 1 | loss: 0.4265397
	speed: 0.0097s/iter; left time: 434.2166s
	iters: 1000, epoch: 1 | loss: 2.4428332
	speed: 0.0096s/iter; left time: 427.2395s
	iters: 1100, epoch: 1 | loss: 0.3577181
	speed: 0.0097s/iter; left time: 431.1340s
	iters: 1200, epoch: 1 | loss: 0.3391264
	speed: 0.0096s/iter; left time: 424.1730s
	iters: 1300, epoch: 1 | loss: 1.1941382
	speed: 0.0093s/iter; left time: 410.6889s
	iters: 1400, epoch: 1 | loss: 2.5058005
	speed: 0.0101s/iter; left time: 447.7923s
	iters: 1500, epoch: 1 | loss: 0.4467703
	speed: 0.0096s/iter; left time: 425.1454s
	iters: 1600, epoch: 1 | loss: 0.3001790
	speed: 0.0100s/iter; left time: 441.5460s
	iters: 1700, epoch: 1 | loss: 0.4194479
	speed: 0.0094s/iter; left time: 411.7423s
	iters: 1800, epoch: 1 | loss: 0.3238133
	speed: 0.0087s/iter; left time: 380.5331s
	iters: 1900, epoch: 1 | loss: 0.3200842
	speed: 0.0095s/iter; left time: 415.9546s
	iters: 2000, epoch: 1 | loss: 0.4106955
	speed: 0.0098s/iter; left time: 426.2053s
	iters: 2100, epoch: 1 | loss: 0.6109046
	speed: 0.0099s/iter; left time: 430.2313s
	iters: 2200, epoch: 1 | loss: 0.4086619
	speed: 0.0097s/iter; left time: 419.3904s
Epoch: 1 cost time: 22.158934354782104
Epoch: 1, Steps: 2278 | Train Loss: 1.3274073 Vali Loss: 0.5487841 Test Loss: 0.2299420
Validation loss decreased (inf --> 0.548784).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.2749023
	speed: 0.0374s/iter; left time: 1616.3889s
	iters: 200, epoch: 2 | loss: 0.5846811
	speed: 0.0081s/iter; left time: 347.2496s
	iters: 300, epoch: 2 | loss: 0.2890618
	speed: 0.0084s/iter; left time: 362.2065s
	iters: 400, epoch: 2 | loss: 0.7978759
	speed: 0.0089s/iter; left time: 381.2233s
	iters: 500, epoch: 2 | loss: 0.8364258
	speed: 0.0092s/iter; left time: 393.5751s
	iters: 600, epoch: 2 | loss: 0.4371857
	speed: 0.0101s/iter; left time: 432.4302s
	iters: 700, epoch: 2 | loss: 0.3245512
	speed: 0.0098s/iter; left time: 416.8838s
	iters: 800, epoch: 2 | loss: 0.3314720
	speed: 0.0101s/iter; left time: 429.9000s
	iters: 900, epoch: 2 | loss: 0.3169424
	speed: 0.0093s/iter; left time: 395.2784s
	iters: 1000, epoch: 2 | loss: 0.6351236
	speed: 0.0091s/iter; left time: 384.6334s
	iters: 1100, epoch: 2 | loss: 2.1538503
	speed: 0.0082s/iter; left time: 346.4036s
	iters: 1200, epoch: 2 | loss: 3.3492236
	speed: 0.0084s/iter; left time: 354.6298s
	iters: 1300, epoch: 2 | loss: 2.3194623
	speed: 0.0089s/iter; left time: 372.2663s
	iters: 1400, epoch: 2 | loss: 0.2772933
	speed: 0.0095s/iter; left time: 397.6900s
	iters: 1500, epoch: 2 | loss: 0.3559785
	speed: 0.0101s/iter; left time: 421.1925s
	iters: 1600, epoch: 2 | loss: 0.5791680
	speed: 0.0096s/iter; left time: 398.9944s
	iters: 1700, epoch: 2 | loss: 0.6728149
	speed: 0.0084s/iter; left time: 349.7407s
	iters: 1800, epoch: 2 | loss: 0.3274836
	speed: 0.0089s/iter; left time: 370.3126s
	iters: 1900, epoch: 2 | loss: 0.6707609
	speed: 0.0091s/iter; left time: 378.4666s
	iters: 2000, epoch: 2 | loss: 10.8944149
	speed: 0.0090s/iter; left time: 372.5721s
	iters: 2100, epoch: 2 | loss: 0.4143243
	speed: 0.0101s/iter; left time: 416.8339s
	iters: 2200, epoch: 2 | loss: 0.4385618
	speed: 0.0094s/iter; left time: 385.0290s
Epoch: 2 cost time: 20.98065161705017
Epoch: 2, Steps: 2278 | Train Loss: 1.0081021 Vali Loss: 0.5411918 Test Loss: 0.2296628
Validation loss decreased (0.548784 --> 0.541192).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.2304354
	speed: 0.0375s/iter; left time: 1532.7047s
	iters: 200, epoch: 3 | loss: 0.3083584
	speed: 0.0096s/iter; left time: 390.5952s
	iters: 300, epoch: 3 | loss: 0.6810633
	speed: 0.0086s/iter; left time: 348.0909s
	iters: 400, epoch: 3 | loss: 0.4872725
	speed: 0.0091s/iter; left time: 371.0488s
	iters: 500, epoch: 3 | loss: 0.3671500
	speed: 0.0088s/iter; left time: 355.4451s
	iters: 600, epoch: 3 | loss: 0.2817192
	speed: 0.0090s/iter; left time: 364.7188s
	iters: 700, epoch: 3 | loss: 0.3427750
	speed: 0.0096s/iter; left time: 385.7067s
	iters: 800, epoch: 3 | loss: 0.3398676
	speed: 0.0094s/iter; left time: 377.3300s
	iters: 900, epoch: 3 | loss: 0.2280010
	speed: 0.0102s/iter; left time: 409.6767s
	iters: 1000, epoch: 3 | loss: 0.3092726
	speed: 0.0106s/iter; left time: 424.5623s
	iters: 1100, epoch: 3 | loss: 0.6449081
	speed: 0.0085s/iter; left time: 338.9959s
	iters: 1200, epoch: 3 | loss: 0.3078777
	speed: 0.0084s/iter; left time: 334.0190s
	iters: 1300, epoch: 3 | loss: 2.1455309
	speed: 0.0093s/iter; left time: 370.2610s
	iters: 1400, epoch: 3 | loss: 0.2615541
	speed: 0.0102s/iter; left time: 405.6070s
	iters: 1500, epoch: 3 | loss: 0.3963826
	speed: 0.0099s/iter; left time: 389.8886s
	iters: 1600, epoch: 3 | loss: 0.1966451
	speed: 0.0106s/iter; left time: 417.1653s
	iters: 1700, epoch: 3 | loss: 0.3777403
	speed: 0.0099s/iter; left time: 387.9613s
	iters: 1800, epoch: 3 | loss: 1.3327504
	speed: 0.0103s/iter; left time: 405.0141s
	iters: 1900, epoch: 3 | loss: 0.2648479
	speed: 0.0091s/iter; left time: 356.8665s
	iters: 2000, epoch: 3 | loss: 0.4782509
	speed: 0.0094s/iter; left time: 364.7730s
	iters: 2100, epoch: 3 | loss: 5.4667416
	speed: 0.0087s/iter; left time: 336.5971s
	iters: 2200, epoch: 3 | loss: 0.7037367
	speed: 0.0085s/iter; left time: 330.4919s
Epoch: 3 cost time: 21.440450429916382
Epoch: 3, Steps: 2278 | Train Loss: 0.6862037 Vali Loss: 0.4287799 Test Loss: 0.1868073
Validation loss decreased (0.541192 --> 0.428780).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.2953490
	speed: 0.0388s/iter; left time: 1500.0987s
	iters: 200, epoch: 4 | loss: 0.4223027
	speed: 0.0091s/iter; left time: 351.2609s
	iters: 300, epoch: 4 | loss: 0.2609595
	speed: 0.0089s/iter; left time: 342.1883s
	iters: 400, epoch: 4 | loss: 1.8088163
	speed: 0.0096s/iter; left time: 367.0508s
	iters: 500, epoch: 4 | loss: 0.5004920
	speed: 0.0099s/iter; left time: 376.7802s
	iters: 600, epoch: 4 | loss: 0.3946128
	speed: 0.0093s/iter; left time: 353.7120s
	iters: 700, epoch: 4 | loss: 0.4653902
	speed: 0.0091s/iter; left time: 347.8194s
	iters: 800, epoch: 4 | loss: 1.7786589
	speed: 0.0088s/iter; left time: 335.1664s
	iters: 900, epoch: 4 | loss: 0.2323044
	speed: 0.0081s/iter; left time: 306.1093s
	iters: 1000, epoch: 4 | loss: 0.3670621
	speed: 0.0092s/iter; left time: 348.3007s
	iters: 1100, epoch: 4 | loss: 0.3038514
	speed: 0.0093s/iter; left time: 349.3645s
	iters: 1200, epoch: 4 | loss: 0.1954716
	speed: 0.0091s/iter; left time: 342.0561s
	iters: 1300, epoch: 4 | loss: 0.6678517
	speed: 0.0090s/iter; left time: 336.7279s
	iters: 1400, epoch: 4 | loss: 0.3181770
	speed: 0.0094s/iter; left time: 350.9069s
	iters: 1500, epoch: 4 | loss: 0.3061966
	speed: 0.0106s/iter; left time: 395.6373s
	iters: 1600, epoch: 4 | loss: 0.3263313
	speed: 0.0100s/iter; left time: 369.8571s
	iters: 1700, epoch: 4 | loss: 0.4247620
	speed: 0.0097s/iter; left time: 359.6139s
	iters: 1800, epoch: 4 | loss: 0.2218798
	speed: 0.0096s/iter; left time: 354.6867s
	iters: 1900, epoch: 4 | loss: 0.5977886
	speed: 0.0095s/iter; left time: 348.0200s
	iters: 2000, epoch: 4 | loss: 0.3502583
	speed: 0.0093s/iter; left time: 342.1833s
	iters: 2100, epoch: 4 | loss: 0.3307958
	speed: 0.0100s/iter; left time: 366.7427s
	iters: 2200, epoch: 4 | loss: 0.3619982
	speed: 0.0097s/iter; left time: 353.3158s
Epoch: 4 cost time: 21.43471121788025
Epoch: 4, Steps: 2278 | Train Loss: 0.5342330 Vali Loss: 0.3912953 Test Loss: 0.1558229
Validation loss decreased (0.428780 --> 0.391295).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.2783733
	speed: 0.0360s/iter; left time: 1310.3376s
	iters: 200, epoch: 5 | loss: 0.2691927
	speed: 0.0098s/iter; left time: 354.9156s
	iters: 300, epoch: 5 | loss: 0.4377107
	speed: 0.0096s/iter; left time: 348.7433s
	iters: 400, epoch: 5 | loss: 0.2461318
	speed: 0.0095s/iter; left time: 342.5479s
	iters: 500, epoch: 5 | loss: 0.2667513
	speed: 0.0097s/iter; left time: 350.4595s
	iters: 600, epoch: 5 | loss: 2.1262507
	speed: 0.0101s/iter; left time: 362.9788s
	iters: 700, epoch: 5 | loss: 0.2176220
	speed: 0.0088s/iter; left time: 314.4856s
	iters: 800, epoch: 5 | loss: 0.3503198
	speed: 0.0097s/iter; left time: 344.1096s
	iters: 900, epoch: 5 | loss: 0.2979318
	speed: 0.0098s/iter; left time: 348.4539s
	iters: 1000, epoch: 5 | loss: 0.3061727
	speed: 0.0097s/iter; left time: 344.2870s
	iters: 1100, epoch: 5 | loss: 0.5916770
	speed: 0.0095s/iter; left time: 334.6467s
	iters: 1200, epoch: 5 | loss: 0.2986263
	speed: 0.0094s/iter; left time: 330.5138s
	iters: 1300, epoch: 5 | loss: 0.2595825
	speed: 0.0095s/iter; left time: 334.3603s
	iters: 1400, epoch: 5 | loss: 0.3349876
	speed: 0.0093s/iter; left time: 326.5463s
	iters: 1500, epoch: 5 | loss: 0.2427606
	speed: 0.0098s/iter; left time: 343.1627s
	iters: 1600, epoch: 5 | loss: 0.1791019
	speed: 0.0101s/iter; left time: 353.7034s
	iters: 1700, epoch: 5 | loss: 0.4006368
	speed: 0.0092s/iter; left time: 318.8901s
	iters: 1800, epoch: 5 | loss: 0.3385438
	speed: 0.0091s/iter; left time: 316.6444s
	iters: 1900, epoch: 5 | loss: 0.2679193
	speed: 0.0094s/iter; left time: 323.9097s
	iters: 2000, epoch: 5 | loss: 0.2671582
	speed: 0.0097s/iter; left time: 333.2086s
	iters: 2100, epoch: 5 | loss: 2.1311972
	speed: 0.0098s/iter; left time: 336.2595s
	iters: 2200, epoch: 5 | loss: 0.4421513
	speed: 0.0093s/iter; left time: 319.5621s
Epoch: 5 cost time: 21.782622575759888
Epoch: 5, Steps: 2278 | Train Loss: 0.4882757 Vali Loss: 0.3776390 Test Loss: 0.1512857
Validation loss decreased (0.391295 --> 0.377639).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.2122987
	speed: 0.0371s/iter; left time: 1265.5665s
	iters: 200, epoch: 6 | loss: 0.2674510
	speed: 0.0100s/iter; left time: 340.1321s
	iters: 300, epoch: 6 | loss: 0.2715579
	speed: 0.0095s/iter; left time: 323.3715s
	iters: 400, epoch: 6 | loss: 0.4112936
	speed: 0.0095s/iter; left time: 321.9089s
	iters: 500, epoch: 6 | loss: 2.0444882
	speed: 0.0096s/iter; left time: 323.1539s
	iters: 600, epoch: 6 | loss: 0.2150702
	speed: 0.0093s/iter; left time: 311.2711s
	iters: 700, epoch: 6 | loss: 0.2131702
	speed: 0.0091s/iter; left time: 305.1810s
	iters: 800, epoch: 6 | loss: 0.4327140
	speed: 0.0097s/iter; left time: 323.6544s
	iters: 900, epoch: 6 | loss: 0.4299379
	speed: 0.0093s/iter; left time: 308.6006s
	iters: 1000, epoch: 6 | loss: 0.2915681
	speed: 0.0090s/iter; left time: 297.9734s
	iters: 1100, epoch: 6 | loss: 0.2851552
	speed: 0.0093s/iter; left time: 307.1319s
	iters: 1200, epoch: 6 | loss: 0.1930147
	speed: 0.0099s/iter; left time: 325.4253s
	iters: 1300, epoch: 6 | loss: 0.4073884
	speed: 0.0089s/iter; left time: 294.0961s
	iters: 1400, epoch: 6 | loss: 0.3279490
	speed: 0.0096s/iter; left time: 314.1963s
	iters: 1500, epoch: 6 | loss: 0.5188140
	speed: 0.0098s/iter; left time: 321.3357s
	iters: 1600, epoch: 6 | loss: 0.2869269
	speed: 0.0094s/iter; left time: 305.6687s
	iters: 1700, epoch: 6 | loss: 0.2270378
	speed: 0.0094s/iter; left time: 306.0400s
	iters: 1800, epoch: 6 | loss: 0.3842857
	speed: 0.0087s/iter; left time: 281.6549s
	iters: 1900, epoch: 6 | loss: 0.2445823
	speed: 0.0085s/iter; left time: 274.9940s
	iters: 2000, epoch: 6 | loss: 0.2633739
	speed: 0.0091s/iter; left time: 292.2867s
	iters: 2100, epoch: 6 | loss: 0.2122848
	speed: 0.0089s/iter; left time: 285.3308s
	iters: 2200, epoch: 6 | loss: 0.2691491
	speed: 0.0091s/iter; left time: 290.5123s
Epoch: 6 cost time: 21.270154237747192
Epoch: 6, Steps: 2278 | Train Loss: 0.4688273 Vali Loss: 0.3717150 Test Loss: 0.1473141
Validation loss decreased (0.377639 --> 0.371715).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.3475443
	speed: 0.0379s/iter; left time: 1205.7547s
	iters: 200, epoch: 7 | loss: 0.2228316
	speed: 0.0084s/iter; left time: 264.9953s
	iters: 300, epoch: 7 | loss: 0.4707632
	speed: 0.0084s/iter; left time: 263.8538s
	iters: 400, epoch: 7 | loss: 0.2934437
	speed: 0.0089s/iter; left time: 281.7426s
	iters: 500, epoch: 7 | loss: 0.5837743
	speed: 0.0089s/iter; left time: 279.9575s
	iters: 600, epoch: 7 | loss: 0.2655282
	speed: 0.0090s/iter; left time: 280.5558s
	iters: 700, epoch: 7 | loss: 0.1988745
	speed: 0.0089s/iter; left time: 277.2124s
	iters: 800, epoch: 7 | loss: 0.4078862
	speed: 0.0095s/iter; left time: 295.2336s
	iters: 900, epoch: 7 | loss: 0.1946041
	speed: 0.0105s/iter; left time: 326.2720s
	iters: 1000, epoch: 7 | loss: 0.2759914
	speed: 0.0101s/iter; left time: 313.3369s
	iters: 1100, epoch: 7 | loss: 2.2240853
	speed: 0.0106s/iter; left time: 325.1874s
	iters: 1200, epoch: 7 | loss: 0.1927866
	speed: 0.0094s/iter; left time: 289.4606s
	iters: 1300, epoch: 7 | loss: 0.4800971
	speed: 0.0093s/iter; left time: 284.8903s
	iters: 1400, epoch: 7 | loss: 0.2990668
	speed: 0.0093s/iter; left time: 284.8045s
	iters: 1500, epoch: 7 | loss: 0.3122827
	speed: 0.0086s/iter; left time: 261.6826s
	iters: 1600, epoch: 7 | loss: 0.2240749
	speed: 0.0088s/iter; left time: 266.7548s
	iters: 1700, epoch: 7 | loss: 0.7152489
	speed: 0.0083s/iter; left time: 250.0622s
	iters: 1800, epoch: 7 | loss: 0.2722378
	speed: 0.0083s/iter; left time: 251.1739s
	iters: 1900, epoch: 7 | loss: 0.3928121
	speed: 0.0087s/iter; left time: 261.2965s
	iters: 2000, epoch: 7 | loss: 0.2048513
	speed: 0.0089s/iter; left time: 264.7661s
	iters: 2100, epoch: 7 | loss: 0.2660576
	speed: 0.0093s/iter; left time: 276.3903s
	iters: 2200, epoch: 7 | loss: 0.2059975
	speed: 0.0085s/iter; left time: 252.5441s
Epoch: 7 cost time: 20.817217350006104
Epoch: 7, Steps: 2278 | Train Loss: 0.4590615 Vali Loss: 0.3684154 Test Loss: 0.1454718
Validation loss decreased (0.371715 --> 0.368415).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.2804777
	speed: 0.0376s/iter; left time: 1108.3606s
	iters: 200, epoch: 8 | loss: 1.5924535
	speed: 0.0095s/iter; left time: 279.1822s
	iters: 300, epoch: 8 | loss: 0.2464262
	speed: 0.0096s/iter; left time: 281.4764s
	iters: 400, epoch: 8 | loss: 0.2250997
	speed: 0.0091s/iter; left time: 266.5758s
	iters: 500, epoch: 8 | loss: 0.2468739
	speed: 0.0093s/iter; left time: 270.6728s
	iters: 600, epoch: 8 | loss: 0.1731010
	speed: 0.0092s/iter; left time: 266.5476s
	iters: 700, epoch: 8 | loss: 0.2940552
	speed: 0.0082s/iter; left time: 237.3849s
	iters: 800, epoch: 8 | loss: 0.2430318
	speed: 0.0086s/iter; left time: 247.4370s
	iters: 900, epoch: 8 | loss: 0.2340447
	speed: 0.0094s/iter; left time: 269.1983s
	iters: 1000, epoch: 8 | loss: 0.3713095
	speed: 0.0091s/iter; left time: 261.7551s
	iters: 1100, epoch: 8 | loss: 0.3923781
	speed: 0.0090s/iter; left time: 255.3957s
	iters: 1200, epoch: 8 | loss: 0.2150180
	speed: 0.0097s/iter; left time: 275.6921s
	iters: 1300, epoch: 8 | loss: 0.2461193
	speed: 0.0090s/iter; left time: 254.6698s
	iters: 1400, epoch: 8 | loss: 0.2698927
	speed: 0.0091s/iter; left time: 257.6114s
	iters: 1500, epoch: 8 | loss: 0.3604102
	speed: 0.0087s/iter; left time: 244.7945s
	iters: 1600, epoch: 8 | loss: 0.2873182
	speed: 0.0092s/iter; left time: 258.7814s
	iters: 1700, epoch: 8 | loss: 0.2336823
	speed: 0.0084s/iter; left time: 233.8173s
	iters: 1800, epoch: 8 | loss: 0.3727142
	speed: 0.0095s/iter; left time: 263.1712s
	iters: 1900, epoch: 8 | loss: 0.2382452
	speed: 0.0093s/iter; left time: 256.9630s
	iters: 2000, epoch: 8 | loss: 1.4434568
	speed: 0.0094s/iter; left time: 258.7938s
	iters: 2100, epoch: 8 | loss: 0.4181023
	speed: 0.0097s/iter; left time: 265.9905s
	iters: 2200, epoch: 8 | loss: 0.3980878
	speed: 0.0101s/iter; left time: 276.4077s
Epoch: 8 cost time: 20.942395448684692
Epoch: 8, Steps: 2278 | Train Loss: 0.4556061 Vali Loss: 0.3681815 Test Loss: 0.1463392
Validation loss decreased (0.368415 --> 0.368181).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.2976546
	speed: 0.0363s/iter; left time: 988.6583s
	iters: 200, epoch: 9 | loss: 0.6017286
	speed: 0.0087s/iter; left time: 236.6587s
	iters: 300, epoch: 9 | loss: 0.2601540
	speed: 0.0101s/iter; left time: 271.7617s
	iters: 400, epoch: 9 | loss: 0.2729390
	speed: 0.0091s/iter; left time: 244.5882s
	iters: 500, epoch: 9 | loss: 0.2166201
	speed: 0.0086s/iter; left time: 229.7175s
	iters: 600, epoch: 9 | loss: 0.3358902
	speed: 0.0096s/iter; left time: 256.7395s
	iters: 700, epoch: 9 | loss: 0.4432291
	speed: 0.0093s/iter; left time: 247.6430s
	iters: 800, epoch: 9 | loss: 0.2834952
	speed: 0.0095s/iter; left time: 252.6824s
	iters: 900, epoch: 9 | loss: 0.3552780
	speed: 0.0096s/iter; left time: 254.7719s
	iters: 1000, epoch: 9 | loss: 0.1726093
	speed: 0.0101s/iter; left time: 264.7044s
	iters: 1100, epoch: 9 | loss: 0.2278479
	speed: 0.0100s/iter; left time: 262.1043s
	iters: 1200, epoch: 9 | loss: 0.1571684
	speed: 0.0091s/iter; left time: 237.4904s
	iters: 1300, epoch: 9 | loss: 0.3666329
	speed: 0.0090s/iter; left time: 234.4686s
	iters: 1400, epoch: 9 | loss: 0.1956159
	speed: 0.0088s/iter; left time: 229.0177s
	iters: 1500, epoch: 9 | loss: 0.5178441
	speed: 0.0086s/iter; left time: 222.1098s
	iters: 1600, epoch: 9 | loss: 0.2141802
	speed: 0.0092s/iter; left time: 237.7462s
	iters: 1700, epoch: 9 | loss: 0.2265084
	speed: 0.0098s/iter; left time: 250.0206s
	iters: 1800, epoch: 9 | loss: 0.3722466
	speed: 0.0095s/iter; left time: 241.7520s
	iters: 1900, epoch: 9 | loss: 2.2450693
	speed: 0.0094s/iter; left time: 239.2606s
	iters: 2000, epoch: 9 | loss: 0.2985763
	speed: 0.0093s/iter; left time: 235.8050s
	iters: 2100, epoch: 9 | loss: 0.2992962
	speed: 0.0098s/iter; left time: 246.5303s
	iters: 2200, epoch: 9 | loss: 0.2462296
	speed: 0.0095s/iter; left time: 239.4787s
Epoch: 9 cost time: 21.242640733718872
Epoch: 9, Steps: 2278 | Train Loss: 0.4533485 Vali Loss: 0.3676048 Test Loss: 0.1466285
Validation loss decreased (0.368181 --> 0.367605).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.3347356
	speed: 0.0356s/iter; left time: 888.9744s
	iters: 200, epoch: 10 | loss: 0.5818630
	speed: 0.0092s/iter; left time: 229.9077s
	iters: 300, epoch: 10 | loss: 0.2180223
	speed: 0.0094s/iter; left time: 232.4697s
	iters: 400, epoch: 10 | loss: 0.2236845
	speed: 0.0092s/iter; left time: 227.1594s
	iters: 500, epoch: 10 | loss: 2.4989164
	speed: 0.0091s/iter; left time: 223.8916s
	iters: 600, epoch: 10 | loss: 0.2050561
	speed: 0.0091s/iter; left time: 222.5052s
	iters: 700, epoch: 10 | loss: 0.5463208
	speed: 0.0092s/iter; left time: 223.8748s
	iters: 800, epoch: 10 | loss: 0.1999906
	speed: 0.0094s/iter; left time: 227.2236s
	iters: 900, epoch: 10 | loss: 3.4958069
	speed: 0.0091s/iter; left time: 218.8082s
	iters: 1000, epoch: 10 | loss: 0.2648070
	speed: 0.0097s/iter; left time: 233.4200s
	iters: 1100, epoch: 10 | loss: 0.2361418
	speed: 0.0093s/iter; left time: 222.7410s
	iters: 1200, epoch: 10 | loss: 0.2388512
	speed: 0.0094s/iter; left time: 223.1706s
	iters: 1300, epoch: 10 | loss: 0.2690866
	speed: 0.0093s/iter; left time: 221.8349s
	iters: 1400, epoch: 10 | loss: 0.1467457
	speed: 0.0096s/iter; left time: 227.3291s
	iters: 1500, epoch: 10 | loss: 0.3330620
	speed: 0.0096s/iter; left time: 225.0525s
	iters: 1600, epoch: 10 | loss: 0.2744501
	speed: 0.0092s/iter; left time: 216.2308s
	iters: 1700, epoch: 10 | loss: 0.2389713
	speed: 0.0097s/iter; left time: 226.7562s
	iters: 1800, epoch: 10 | loss: 9.8884726
	speed: 0.0092s/iter; left time: 214.4785s
	iters: 1900, epoch: 10 | loss: 0.4357086
	speed: 0.0096s/iter; left time: 222.3827s
	iters: 2000, epoch: 10 | loss: 0.3041919
	speed: 0.0095s/iter; left time: 218.0963s
	iters: 2100, epoch: 10 | loss: 0.2098360
	speed: 0.0093s/iter; left time: 213.5629s
	iters: 2200, epoch: 10 | loss: 0.3567442
	speed: 0.0094s/iter; left time: 214.3546s
Epoch: 10 cost time: 21.292396068572998
Epoch: 10, Steps: 2278 | Train Loss: 0.4522117 Vali Loss: 0.3664271 Test Loss: 0.1453885
Validation loss decreased (0.367605 --> 0.366427).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.5923586
	speed: 0.0369s/iter; left time: 836.8104s
	iters: 200, epoch: 11 | loss: 0.1946258
	speed: 0.0090s/iter; left time: 202.4766s
	iters: 300, epoch: 11 | loss: 0.1992937
	speed: 0.0090s/iter; left time: 201.7175s
	iters: 400, epoch: 11 | loss: 0.5280483
	speed: 0.0095s/iter; left time: 213.5972s
	iters: 500, epoch: 11 | loss: 0.3939118
	speed: 0.0091s/iter; left time: 203.4134s
	iters: 600, epoch: 11 | loss: 0.5298540
	speed: 0.0093s/iter; left time: 205.3317s
	iters: 700, epoch: 11 | loss: 0.5677185
	speed: 0.0095s/iter; left time: 210.7477s
	iters: 800, epoch: 11 | loss: 2.4153111
	speed: 0.0095s/iter; left time: 208.0892s
	iters: 900, epoch: 11 | loss: 0.2244347
	speed: 0.0096s/iter; left time: 210.3158s
	iters: 1000, epoch: 11 | loss: 0.2943882
	speed: 0.0093s/iter; left time: 202.8218s
	iters: 1100, epoch: 11 | loss: 0.1838986
	speed: 0.0094s/iter; left time: 203.1202s
	iters: 1200, epoch: 11 | loss: 0.3130791
	speed: 0.0094s/iter; left time: 202.5834s
	iters: 1300, epoch: 11 | loss: 3.6147747
	speed: 0.0097s/iter; left time: 208.0855s
	iters: 1400, epoch: 11 | loss: 0.1599910
	speed: 0.0099s/iter; left time: 211.6009s
	iters: 1500, epoch: 11 | loss: 0.2594213
	speed: 0.0096s/iter; left time: 203.6952s
	iters: 1600, epoch: 11 | loss: 0.4081295
	speed: 0.0091s/iter; left time: 192.3817s
	iters: 1700, epoch: 11 | loss: 0.2121198
	speed: 0.0092s/iter; left time: 194.4544s
	iters: 1800, epoch: 11 | loss: 0.6418900
	speed: 0.0094s/iter; left time: 196.8779s
	iters: 1900, epoch: 11 | loss: 0.2850519
	speed: 0.0097s/iter; left time: 202.4815s
	iters: 2000, epoch: 11 | loss: 0.3158540
	speed: 0.0096s/iter; left time: 200.3691s
	iters: 2100, epoch: 11 | loss: 0.2587690
	speed: 0.0093s/iter; left time: 192.3763s
	iters: 2200, epoch: 11 | loss: 0.2335814
	speed: 0.0095s/iter; left time: 196.3852s
Epoch: 11 cost time: 21.418266534805298
Epoch: 11, Steps: 2278 | Train Loss: 0.4516196 Vali Loss: 0.3655863 Test Loss: 0.1460332
Validation loss decreased (0.366427 --> 0.365586).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 1.5344335
	speed: 0.0367s/iter; left time: 748.0478s
	iters: 200, epoch: 12 | loss: 0.2251556
	speed: 0.0093s/iter; left time: 188.3494s
	iters: 300, epoch: 12 | loss: 0.2558899
	speed: 0.0095s/iter; left time: 192.9360s
	iters: 400, epoch: 12 | loss: 0.1760649
	speed: 0.0097s/iter; left time: 194.2330s
	iters: 500, epoch: 12 | loss: 2.2426486
	speed: 0.0092s/iter; left time: 184.2583s
	iters: 600, epoch: 12 | loss: 0.2203034
	speed: 0.0094s/iter; left time: 188.0119s
	iters: 700, epoch: 12 | loss: 0.2269349
	speed: 0.0094s/iter; left time: 185.7953s
	iters: 800, epoch: 12 | loss: 2.3471966
	speed: 0.0094s/iter; left time: 185.0463s
	iters: 900, epoch: 12 | loss: 0.2946258
	speed: 0.0093s/iter; left time: 182.6312s
	iters: 1000, epoch: 12 | loss: 0.3370128
	speed: 0.0092s/iter; left time: 179.4508s
	iters: 1100, epoch: 12 | loss: 0.3225134
	speed: 0.0094s/iter; left time: 181.4581s
	iters: 1200, epoch: 12 | loss: 0.2597741
	speed: 0.0090s/iter; left time: 174.2368s
	iters: 1300, epoch: 12 | loss: 0.1841963
	speed: 0.0095s/iter; left time: 182.6600s
	iters: 1400, epoch: 12 | loss: 0.2884069
	speed: 0.0099s/iter; left time: 189.0234s
	iters: 1500, epoch: 12 | loss: 0.2680475
	speed: 0.0090s/iter; left time: 171.7310s
	iters: 1600, epoch: 12 | loss: 0.3392488
	speed: 0.0092s/iter; left time: 174.2808s
	iters: 1700, epoch: 12 | loss: 0.2024661
	speed: 0.0097s/iter; left time: 183.1261s
	iters: 1800, epoch: 12 | loss: 0.2304807
	speed: 0.0093s/iter; left time: 174.0654s
	iters: 1900, epoch: 12 | loss: 0.5751608
	speed: 0.0093s/iter; left time: 173.3176s
	iters: 2000, epoch: 12 | loss: 0.3255636
	speed: 0.0096s/iter; left time: 177.4831s
	iters: 2100, epoch: 12 | loss: 0.2546044
	speed: 0.0096s/iter; left time: 175.9935s
	iters: 2200, epoch: 12 | loss: 0.2130260
	speed: 0.0092s/iter; left time: 168.6925s
Epoch: 12 cost time: 21.3863525390625
Epoch: 12, Steps: 2278 | Train Loss: 0.4513035 Vali Loss: 0.3661069 Test Loss: 0.1452079
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.2443496
	speed: 0.0364s/iter; left time: 660.5301s
	iters: 200, epoch: 13 | loss: 0.2932495
	speed: 0.0091s/iter; left time: 163.7921s
	iters: 300, epoch: 13 | loss: 0.2326508
	speed: 0.0092s/iter; left time: 165.3932s
	iters: 400, epoch: 13 | loss: 0.3619871
	speed: 0.0090s/iter; left time: 160.1881s
	iters: 500, epoch: 13 | loss: 0.2515826
	speed: 0.0093s/iter; left time: 165.6759s
	iters: 600, epoch: 13 | loss: 0.3574548
	speed: 0.0090s/iter; left time: 158.3788s
	iters: 700, epoch: 13 | loss: 0.2830894
	speed: 0.0091s/iter; left time: 160.3072s
	iters: 800, epoch: 13 | loss: 0.3271683
	speed: 0.0096s/iter; left time: 167.9248s
	iters: 900, epoch: 13 | loss: 0.2578053
	speed: 0.0095s/iter; left time: 165.1405s
	iters: 1000, epoch: 13 | loss: 0.2222068
	speed: 0.0095s/iter; left time: 162.8925s
	iters: 1100, epoch: 13 | loss: 0.2469206
	speed: 0.0092s/iter; left time: 157.8422s
	iters: 1200, epoch: 13 | loss: 0.3141468
	speed: 0.0096s/iter; left time: 163.3580s
	iters: 1300, epoch: 13 | loss: 0.2185072
	speed: 0.0093s/iter; left time: 158.1905s
	iters: 1400, epoch: 13 | loss: 0.2696869
	speed: 0.0097s/iter; left time: 162.9780s
	iters: 1500, epoch: 13 | loss: 3.1597457
	speed: 0.0094s/iter; left time: 157.2923s
	iters: 1600, epoch: 13 | loss: 0.4013284
	speed: 0.0094s/iter; left time: 156.3080s
	iters: 1700, epoch: 13 | loss: 0.2101925
	speed: 0.0095s/iter; left time: 156.8968s
	iters: 1800, epoch: 13 | loss: 0.2465951
	speed: 0.0096s/iter; left time: 157.1205s
	iters: 1900, epoch: 13 | loss: 0.2394920
	speed: 0.0096s/iter; left time: 156.3388s
	iters: 2000, epoch: 13 | loss: 0.2071426
	speed: 0.0091s/iter; left time: 146.9949s
	iters: 2100, epoch: 13 | loss: 0.6149125
	speed: 0.0088s/iter; left time: 142.2534s
	iters: 2200, epoch: 13 | loss: 0.2730308
	speed: 0.0092s/iter; left time: 147.7765s
Epoch: 13 cost time: 21.205702543258667
Epoch: 13, Steps: 2278 | Train Loss: 0.4511808 Vali Loss: 0.3663467 Test Loss: 0.1455735
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.4104337
	speed: 0.0366s/iter; left time: 579.4913s
	iters: 200, epoch: 14 | loss: 0.2224054
	speed: 0.0097s/iter; left time: 152.1724s
	iters: 300, epoch: 14 | loss: 0.3998502
	speed: 0.0097s/iter; left time: 151.3947s
	iters: 400, epoch: 14 | loss: 0.2920277
	speed: 0.0096s/iter; left time: 149.2791s
	iters: 500, epoch: 14 | loss: 0.3549417
	speed: 0.0095s/iter; left time: 146.1555s
	iters: 600, epoch: 14 | loss: 0.3258070
	speed: 0.0095s/iter; left time: 145.6445s
	iters: 700, epoch: 14 | loss: 0.2593214
	speed: 0.0094s/iter; left time: 142.6652s
	iters: 800, epoch: 14 | loss: 0.2022749
	speed: 0.0094s/iter; left time: 142.1120s
	iters: 900, epoch: 14 | loss: 0.2901753
	speed: 0.0095s/iter; left time: 142.4288s
	iters: 1000, epoch: 14 | loss: 0.2597391
	speed: 0.0094s/iter; left time: 140.5327s
	iters: 1100, epoch: 14 | loss: 2.5002449
	speed: 0.0093s/iter; left time: 138.7950s
	iters: 1200, epoch: 14 | loss: 0.2458545
	speed: 0.0093s/iter; left time: 137.8508s
	iters: 1300, epoch: 14 | loss: 0.2611971
	speed: 0.0093s/iter; left time: 136.0982s
	iters: 1400, epoch: 14 | loss: 0.2771803
	speed: 0.0094s/iter; left time: 136.1084s
	iters: 1500, epoch: 14 | loss: 8.1383486
	speed: 0.0093s/iter; left time: 134.7498s
	iters: 1600, epoch: 14 | loss: 0.3464652
	speed: 0.0091s/iter; left time: 130.3163s
	iters: 1700, epoch: 14 | loss: 0.2543385
	speed: 0.0096s/iter; left time: 136.7473s
	iters: 1800, epoch: 14 | loss: 5.6566787
	speed: 0.0095s/iter; left time: 134.8138s
	iters: 1900, epoch: 14 | loss: 0.1712369
	speed: 0.0091s/iter; left time: 128.3047s
	iters: 2000, epoch: 14 | loss: 0.8750268
	speed: 0.0097s/iter; left time: 135.1008s
	iters: 2100, epoch: 14 | loss: 0.3272738
	speed: 0.0090s/iter; left time: 125.2786s
	iters: 2200, epoch: 14 | loss: 0.3980967
	speed: 0.0094s/iter; left time: 129.7937s
Epoch: 14 cost time: 21.424184799194336
Epoch: 14, Steps: 2278 | Train Loss: 0.4510841 Vali Loss: 0.3665476 Test Loss: 0.1454861
EarlyStopping counter: 3 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.3024090
	speed: 0.0373s/iter; left time: 506.4262s
	iters: 200, epoch: 15 | loss: 2.1115780
	speed: 0.0095s/iter; left time: 128.6274s
	iters: 300, epoch: 15 | loss: 0.2430266
	speed: 0.0097s/iter; left time: 130.0386s
	iters: 400, epoch: 15 | loss: 0.2028302
	speed: 0.0098s/iter; left time: 129.8948s
	iters: 500, epoch: 15 | loss: 0.4644356
	speed: 0.0099s/iter; left time: 130.7118s
	iters: 600, epoch: 15 | loss: 0.3071262
	speed: 0.0091s/iter; left time: 118.9903s
	iters: 700, epoch: 15 | loss: 0.3787563
	speed: 0.0090s/iter; left time: 117.2855s
	iters: 800, epoch: 15 | loss: 0.2453786
	speed: 0.0091s/iter; left time: 116.9319s
	iters: 900, epoch: 15 | loss: 0.2037465
	speed: 0.0091s/iter; left time: 116.7447s
	iters: 1000, epoch: 15 | loss: 0.4008967
	speed: 0.0094s/iter; left time: 119.2171s
	iters: 1100, epoch: 15 | loss: 0.1774464
	speed: 0.0089s/iter; left time: 112.3218s
	iters: 1200, epoch: 15 | loss: 0.2677875
	speed: 0.0089s/iter; left time: 110.8107s
	iters: 1300, epoch: 15 | loss: 2.2312770
	speed: 0.0092s/iter; left time: 114.2510s
	iters: 1400, epoch: 15 | loss: 0.1715272
	speed: 0.0091s/iter; left time: 111.9214s
	iters: 1500, epoch: 15 | loss: 0.2898303
	speed: 0.0093s/iter; left time: 113.0151s
	iters: 1600, epoch: 15 | loss: 0.2993385
	speed: 0.0090s/iter; left time: 108.6311s
	iters: 1700, epoch: 15 | loss: 1.4037321
	speed: 0.0090s/iter; left time: 107.9908s
	iters: 1800, epoch: 15 | loss: 0.6664350
	speed: 0.0092s/iter; left time: 108.6819s
	iters: 1900, epoch: 15 | loss: 0.3112781
	speed: 0.0093s/iter; left time: 109.0088s
	iters: 2000, epoch: 15 | loss: 0.5710732
	speed: 0.0090s/iter; left time: 105.3301s
	iters: 2100, epoch: 15 | loss: 0.7392454
	speed: 0.0094s/iter; left time: 108.5880s
	iters: 2200, epoch: 15 | loss: 0.1861600
	speed: 0.0089s/iter; left time: 102.4470s
Epoch: 15 cost time: 21.11404037475586
Epoch: 15, Steps: 2278 | Train Loss: 0.4510574 Vali Loss: 0.3662027 Test Loss: 0.1454557
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.1443850
	speed: 0.0356s/iter; left time: 401.6824s
	iters: 200, epoch: 16 | loss: 0.2904153
	speed: 0.0095s/iter; left time: 106.7254s
	iters: 300, epoch: 16 | loss: 0.5682735
	speed: 0.0090s/iter; left time: 99.6732s
	iters: 400, epoch: 16 | loss: 0.2845819
	speed: 0.0087s/iter; left time: 95.3637s
	iters: 500, epoch: 16 | loss: 0.2384748
	speed: 0.0091s/iter; left time: 98.8511s
	iters: 600, epoch: 16 | loss: 0.5904686
	speed: 0.0087s/iter; left time: 93.7310s
	iters: 700, epoch: 16 | loss: 0.2681168
	speed: 0.0085s/iter; left time: 91.2320s
	iters: 800, epoch: 16 | loss: 0.2193771
	speed: 0.0077s/iter; left time: 81.9075s
	iters: 900, epoch: 16 | loss: 0.3164676
	speed: 0.0079s/iter; left time: 82.5783s
	iters: 1000, epoch: 16 | loss: 0.2738425
	speed: 0.0082s/iter; left time: 85.5350s
	iters: 1100, epoch: 16 | loss: 0.1637924
	speed: 0.0084s/iter; left time: 86.3543s
	iters: 1200, epoch: 16 | loss: 0.2530141
	speed: 0.0093s/iter; left time: 94.3396s
	iters: 1300, epoch: 16 | loss: 3.4465957
	speed: 0.0095s/iter; left time: 95.6322s
	iters: 1400, epoch: 16 | loss: 0.2380549
	speed: 0.0096s/iter; left time: 96.0328s
	iters: 1500, epoch: 16 | loss: 0.2638759
	speed: 0.0100s/iter; left time: 99.2239s
	iters: 1600, epoch: 16 | loss: 0.2457438
	speed: 0.0084s/iter; left time: 82.2605s
	iters: 1700, epoch: 16 | loss: 0.2254205
	speed: 0.0083s/iter; left time: 79.9673s
	iters: 1800, epoch: 16 | loss: 0.1951829
	speed: 0.0089s/iter; left time: 85.5169s
	iters: 1900, epoch: 16 | loss: 0.1657266
	speed: 0.0084s/iter; left time: 79.6955s
	iters: 2000, epoch: 16 | loss: 0.5768735
	speed: 0.0090s/iter; left time: 84.3007s
	iters: 2100, epoch: 16 | loss: 0.2426143
	speed: 0.0087s/iter; left time: 80.7543s
	iters: 2200, epoch: 16 | loss: 0.1664484
	speed: 0.0098s/iter; left time: 89.6305s
Epoch: 16 cost time: 20.115139961242676
Epoch: 16, Steps: 2278 | Train Loss: 0.4510212 Vali Loss: 0.3659881 Test Loss: 0.1454631
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : weather_336_96_Linear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3144<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
mse:0.1460762768983841, mae:0.21300776302814484
