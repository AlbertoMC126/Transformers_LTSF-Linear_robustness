Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='Linear', model_id='weather_336_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=336, root_path='./dataset/', save_pred_values=False, seed=3293, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : weather_336_336_Linear_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3293>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36216
val 4935
test 10204
	iters: 100, epoch: 1 | loss: 0.4221462
	speed: 0.0244s/iter; left time: 1101.5016s
	iters: 200, epoch: 1 | loss: 0.4562909
	speed: 0.0246s/iter; left time: 1107.3584s
	iters: 300, epoch: 1 | loss: 0.5764049
	speed: 0.0251s/iter; left time: 1128.8177s
	iters: 400, epoch: 1 | loss: 1.6759976
	speed: 0.0252s/iter; left time: 1128.9994s
	iters: 500, epoch: 1 | loss: 0.7587357
	speed: 0.0248s/iter; left time: 1111.3749s
	iters: 600, epoch: 1 | loss: 0.8754261
	speed: 0.0243s/iter; left time: 1086.8504s
	iters: 700, epoch: 1 | loss: 0.4831134
	speed: 0.0249s/iter; left time: 1110.7819s
	iters: 800, epoch: 1 | loss: 0.6408615
	speed: 0.0250s/iter; left time: 1110.6946s
	iters: 900, epoch: 1 | loss: 1.0103554
	speed: 0.0243s/iter; left time: 1079.5345s
	iters: 1000, epoch: 1 | loss: 0.5087138
	speed: 0.0248s/iter; left time: 1098.2811s
	iters: 1100, epoch: 1 | loss: 0.5659392
	speed: 0.0244s/iter; left time: 1077.6445s
	iters: 1200, epoch: 1 | loss: 1.1822151
	speed: 0.0250s/iter; left time: 1102.9547s
	iters: 1300, epoch: 1 | loss: 0.5936010
	speed: 0.0248s/iter; left time: 1089.8410s
	iters: 1400, epoch: 1 | loss: 0.4317250
	speed: 0.0248s/iter; left time: 1086.4141s
	iters: 1500, epoch: 1 | loss: 0.4903117
	speed: 0.0252s/iter; left time: 1102.3042s
	iters: 1600, epoch: 1 | loss: 0.6165072
	speed: 0.0245s/iter; left time: 1067.9977s
	iters: 1700, epoch: 1 | loss: 6.9564376
	speed: 0.0244s/iter; left time: 1064.1325s
	iters: 1800, epoch: 1 | loss: 0.6811063
	speed: 0.0247s/iter; left time: 1071.5669s
	iters: 1900, epoch: 1 | loss: 0.9880164
	speed: 0.0243s/iter; left time: 1052.3607s
	iters: 2000, epoch: 1 | loss: 11.5227203
	speed: 0.0251s/iter; left time: 1084.5219s
	iters: 2100, epoch: 1 | loss: 0.4977934
	speed: 0.0246s/iter; left time: 1063.6075s
	iters: 2200, epoch: 1 | loss: 1.0585586
	speed: 0.0242s/iter; left time: 1041.8888s
Epoch: 1 cost time: 55.799803018569946
Epoch: 1, Steps: 2263 | Train Loss: 1.4846094 Vali Loss: 0.6624566 Test Loss: 0.3036221
Validation loss decreased (inf --> 0.662457).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.4435855
	speed: 0.0791s/iter; left time: 3391.8087s
	iters: 200, epoch: 2 | loss: 3.4184015
	speed: 0.0250s/iter; left time: 1071.6381s
	iters: 300, epoch: 2 | loss: 1.9011204
	speed: 0.0247s/iter; left time: 1053.0341s
	iters: 400, epoch: 2 | loss: 0.5010865
	speed: 0.0250s/iter; left time: 1065.2291s
	iters: 500, epoch: 2 | loss: 1.5304772
	speed: 0.0246s/iter; left time: 1047.4490s
	iters: 600, epoch: 2 | loss: 0.5316004
	speed: 0.0249s/iter; left time: 1057.4580s
	iters: 700, epoch: 2 | loss: 0.5199567
	speed: 0.0250s/iter; left time: 1055.7810s
	iters: 800, epoch: 2 | loss: 0.4612959
	speed: 0.0248s/iter; left time: 1044.7242s
	iters: 900, epoch: 2 | loss: 0.6344752
	speed: 0.0243s/iter; left time: 1021.6283s
	iters: 1000, epoch: 2 | loss: 1.4851717
	speed: 0.0245s/iter; left time: 1029.5390s
	iters: 1100, epoch: 2 | loss: 0.7324155
	speed: 0.0247s/iter; left time: 1034.3889s
	iters: 1200, epoch: 2 | loss: 0.9920556
	speed: 0.0244s/iter; left time: 1018.8570s
	iters: 1300, epoch: 2 | loss: 0.4947151
	speed: 0.0248s/iter; left time: 1034.4902s
	iters: 1400, epoch: 2 | loss: 0.4160253
	speed: 0.0246s/iter; left time: 1025.0709s
	iters: 1500, epoch: 2 | loss: 5.7253790
	speed: 0.0250s/iter; left time: 1036.0700s
	iters: 1600, epoch: 2 | loss: 0.9796955
	speed: 0.0242s/iter; left time: 1001.7654s
	iters: 1700, epoch: 2 | loss: 1.3573791
	speed: 0.0240s/iter; left time: 992.1323s
	iters: 1800, epoch: 2 | loss: 0.8215754
	speed: 0.0248s/iter; left time: 1019.9844s
	iters: 1900, epoch: 2 | loss: 0.7720779
	speed: 0.0252s/iter; left time: 1034.2153s
	iters: 2000, epoch: 2 | loss: 0.9197397
	speed: 0.0248s/iter; left time: 1018.3885s
	iters: 2100, epoch: 2 | loss: 1.0631480
	speed: 0.0253s/iter; left time: 1033.4383s
	iters: 2200, epoch: 2 | loss: 0.4613627
	speed: 0.0241s/iter; left time: 983.9819s
Epoch: 2 cost time: 55.68938374519348
Epoch: 2, Steps: 2263 | Train Loss: 1.1675575 Vali Loss: 0.6545334 Test Loss: 0.3152061
Validation loss decreased (0.662457 --> 0.654533).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.4513506
	speed: 0.0796s/iter; left time: 3235.1867s
	iters: 200, epoch: 3 | loss: 0.4306701
	speed: 0.0243s/iter; left time: 984.6587s
	iters: 300, epoch: 3 | loss: 0.3698344
	speed: 0.0248s/iter; left time: 1004.1403s
	iters: 400, epoch: 3 | loss: 0.6514949
	speed: 0.0244s/iter; left time: 985.8158s
	iters: 500, epoch: 3 | loss: 0.5714978
	speed: 0.0242s/iter; left time: 971.7918s
	iters: 600, epoch: 3 | loss: 2.4800417
	speed: 0.0245s/iter; left time: 982.9195s
	iters: 700, epoch: 3 | loss: 1.6381379
	speed: 0.0243s/iter; left time: 971.4833s
	iters: 800, epoch: 3 | loss: 0.7845062
	speed: 0.0247s/iter; left time: 984.7402s
	iters: 900, epoch: 3 | loss: 0.6131331
	speed: 0.0249s/iter; left time: 993.5838s
	iters: 1000, epoch: 3 | loss: 0.9060749
	speed: 0.0244s/iter; left time: 971.2029s
	iters: 1100, epoch: 3 | loss: 0.5633215
	speed: 0.0242s/iter; left time: 959.4265s
	iters: 1200, epoch: 3 | loss: 0.5281087
	speed: 0.0248s/iter; left time: 979.6320s
	iters: 1300, epoch: 3 | loss: 0.4483840
	speed: 0.0241s/iter; left time: 952.1750s
	iters: 1400, epoch: 3 | loss: 0.5664136
	speed: 0.0245s/iter; left time: 962.5892s
	iters: 1500, epoch: 3 | loss: 0.4862213
	speed: 0.0250s/iter; left time: 980.9252s
	iters: 1600, epoch: 3 | loss: 0.4020229
	speed: 0.0246s/iter; left time: 962.0644s
	iters: 1700, epoch: 3 | loss: 1.0720128
	speed: 0.0247s/iter; left time: 963.3529s
	iters: 1800, epoch: 3 | loss: 0.3516444
	speed: 0.0246s/iter; left time: 956.7565s
	iters: 1900, epoch: 3 | loss: 1.0566052
	speed: 0.0252s/iter; left time: 978.9103s
	iters: 2000, epoch: 3 | loss: 0.4460794
	speed: 0.0245s/iter; left time: 947.2780s
	iters: 2100, epoch: 3 | loss: 0.4578219
	speed: 0.0246s/iter; left time: 948.9198s
	iters: 2200, epoch: 3 | loss: 0.6145637
	speed: 0.0240s/iter; left time: 926.2652s
Epoch: 3 cost time: 55.22524905204773
Epoch: 3, Steps: 2263 | Train Loss: 0.8169867 Vali Loss: 0.5394088 Test Loss: 0.2903110
Validation loss decreased (0.654533 --> 0.539409).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.4044300
	speed: 0.0799s/iter; left time: 3066.3885s
	iters: 200, epoch: 4 | loss: 0.3266498
	speed: 0.0247s/iter; left time: 943.8482s
	iters: 300, epoch: 4 | loss: 0.4418475
	speed: 0.0249s/iter; left time: 948.6180s
	iters: 400, epoch: 4 | loss: 0.4541473
	speed: 0.0248s/iter; left time: 943.3643s
	iters: 500, epoch: 4 | loss: 0.5945508
	speed: 0.0246s/iter; left time: 932.9561s
	iters: 600, epoch: 4 | loss: 0.4345435
	speed: 0.0249s/iter; left time: 941.7492s
	iters: 700, epoch: 4 | loss: 7.0425572
	speed: 0.0237s/iter; left time: 893.3380s
	iters: 800, epoch: 4 | loss: 0.3654902
	speed: 0.0245s/iter; left time: 921.3379s
	iters: 900, epoch: 4 | loss: 0.6591609
	speed: 0.0242s/iter; left time: 909.1940s
	iters: 1000, epoch: 4 | loss: 0.4731589
	speed: 0.0244s/iter; left time: 915.8931s
	iters: 1100, epoch: 4 | loss: 0.5133757
	speed: 0.0247s/iter; left time: 921.5004s
	iters: 1200, epoch: 4 | loss: 0.3923719
	speed: 0.0244s/iter; left time: 908.0543s
	iters: 1300, epoch: 4 | loss: 0.4233792
	speed: 0.0244s/iter; left time: 905.1745s
	iters: 1400, epoch: 4 | loss: 0.4661799
	speed: 0.0250s/iter; left time: 926.8348s
	iters: 1500, epoch: 4 | loss: 0.6685704
	speed: 0.0245s/iter; left time: 907.1778s
	iters: 1600, epoch: 4 | loss: 0.5381587
	speed: 0.0247s/iter; left time: 910.1862s
	iters: 1700, epoch: 4 | loss: 0.3791347
	speed: 0.0248s/iter; left time: 910.2671s
	iters: 1800, epoch: 4 | loss: 0.6206249
	speed: 0.0245s/iter; left time: 898.7664s
	iters: 1900, epoch: 4 | loss: 0.5175803
	speed: 0.0248s/iter; left time: 907.0369s
	iters: 2000, epoch: 4 | loss: 0.5629475
	speed: 0.0250s/iter; left time: 909.9898s
	iters: 2100, epoch: 4 | loss: 1.0993087
	speed: 0.0245s/iter; left time: 889.5740s
	iters: 2200, epoch: 4 | loss: 0.5302382
	speed: 0.0242s/iter; left time: 877.8777s
Epoch: 4 cost time: 55.2212655544281
Epoch: 4, Steps: 2263 | Train Loss: 0.6558566 Vali Loss: 0.5148852 Test Loss: 0.2601445
Validation loss decreased (0.539409 --> 0.514885).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.4332079
	speed: 0.0810s/iter; left time: 2925.0216s
	iters: 200, epoch: 5 | loss: 0.4400625
	speed: 0.0244s/iter; left time: 877.4004s
	iters: 300, epoch: 5 | loss: 0.3685124
	speed: 0.0249s/iter; left time: 894.5691s
	iters: 400, epoch: 5 | loss: 0.5320510
	speed: 0.0246s/iter; left time: 882.5130s
	iters: 500, epoch: 5 | loss: 0.2869424
	speed: 0.0246s/iter; left time: 877.2147s
	iters: 600, epoch: 5 | loss: 0.3559205
	speed: 0.0250s/iter; left time: 890.4520s
	iters: 700, epoch: 5 | loss: 0.6876684
	speed: 0.0246s/iter; left time: 874.3248s
	iters: 800, epoch: 5 | loss: 0.4846931
	speed: 0.0248s/iter; left time: 878.4136s
	iters: 900, epoch: 5 | loss: 0.8101286
	speed: 0.0246s/iter; left time: 867.2288s
	iters: 1000, epoch: 5 | loss: 0.4820339
	speed: 0.0250s/iter; left time: 881.8059s
	iters: 1100, epoch: 5 | loss: 0.6063421
	speed: 0.0251s/iter; left time: 881.1990s
	iters: 1200, epoch: 5 | loss: 0.5997875
	speed: 0.0250s/iter; left time: 873.8853s
	iters: 1300, epoch: 5 | loss: 0.5276529
	speed: 0.0248s/iter; left time: 866.4883s
	iters: 1400, epoch: 5 | loss: 0.7080107
	speed: 0.0245s/iter; left time: 853.9865s
	iters: 1500, epoch: 5 | loss: 0.3677780
	speed: 0.0246s/iter; left time: 855.2280s
	iters: 1600, epoch: 5 | loss: 0.9516139
	speed: 0.0242s/iter; left time: 836.7468s
	iters: 1700, epoch: 5 | loss: 0.9796961
	speed: 0.0247s/iter; left time: 851.3442s
	iters: 1800, epoch: 5 | loss: 0.6393676
	speed: 0.0246s/iter; left time: 847.6943s
	iters: 1900, epoch: 5 | loss: 0.4767815
	speed: 0.0247s/iter; left time: 848.7242s
	iters: 2000, epoch: 5 | loss: 0.4456080
	speed: 0.0240s/iter; left time: 819.5102s
	iters: 2100, epoch: 5 | loss: 0.4566575
	speed: 0.0244s/iter; left time: 833.6240s
	iters: 2200, epoch: 5 | loss: 0.3550218
	speed: 0.0232s/iter; left time: 789.5910s
Epoch: 5 cost time: 55.323848485946655
Epoch: 5, Steps: 2263 | Train Loss: 0.6074247 Vali Loss: 0.5040733 Test Loss: 0.2484035
Validation loss decreased (0.514885 --> 0.504073).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.9677976
	speed: 0.0819s/iter; left time: 2773.5717s
	iters: 200, epoch: 6 | loss: 0.3829481
	speed: 0.0245s/iter; left time: 826.5312s
	iters: 300, epoch: 6 | loss: 0.7322668
	speed: 0.0244s/iter; left time: 821.1715s
	iters: 400, epoch: 6 | loss: 1.0361450
	speed: 0.0245s/iter; left time: 821.2545s
	iters: 500, epoch: 6 | loss: 0.3515154
	speed: 0.0246s/iter; left time: 823.5090s
	iters: 600, epoch: 6 | loss: 0.4201667
	speed: 0.0248s/iter; left time: 826.0696s
	iters: 700, epoch: 6 | loss: 0.3581709
	speed: 0.0247s/iter; left time: 822.0335s
	iters: 800, epoch: 6 | loss: 0.2556578
	speed: 0.0245s/iter; left time: 811.7746s
	iters: 900, epoch: 6 | loss: 0.4804828
	speed: 0.0251s/iter; left time: 828.7272s
	iters: 1000, epoch: 6 | loss: 0.4045522
	speed: 0.0244s/iter; left time: 805.5290s
	iters: 1100, epoch: 6 | loss: 0.9749122
	speed: 0.0245s/iter; left time: 805.8473s
	iters: 1200, epoch: 6 | loss: 0.5435627
	speed: 0.0242s/iter; left time: 793.8734s
	iters: 1300, epoch: 6 | loss: 0.4445351
	speed: 0.0245s/iter; left time: 800.3297s
	iters: 1400, epoch: 6 | loss: 0.5482929
	speed: 0.0250s/iter; left time: 813.5372s
	iters: 1500, epoch: 6 | loss: 0.5518325
	speed: 0.0247s/iter; left time: 800.3026s
	iters: 1600, epoch: 6 | loss: 0.9026355
	speed: 0.0247s/iter; left time: 799.2912s
	iters: 1700, epoch: 6 | loss: 0.3329467
	speed: 0.0243s/iter; left time: 782.9629s
	iters: 1800, epoch: 6 | loss: 0.5371032
	speed: 0.0245s/iter; left time: 788.8923s
	iters: 1900, epoch: 6 | loss: 0.4218241
	speed: 0.0245s/iter; left time: 784.7466s
	iters: 2000, epoch: 6 | loss: 0.4057469
	speed: 0.0245s/iter; left time: 781.4576s
	iters: 2100, epoch: 6 | loss: 0.3418401
	speed: 0.0245s/iter; left time: 779.3977s
	iters: 2200, epoch: 6 | loss: 0.6229075
	speed: 0.0219s/iter; left time: 694.9738s
Epoch: 6 cost time: 54.959296464920044
Epoch: 6, Steps: 2263 | Train Loss: 0.5870567 Vali Loss: 0.5001003 Test Loss: 0.2442254
Validation loss decreased (0.504073 --> 0.500100).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.4854159
	speed: 0.0817s/iter; left time: 2579.0998s
	iters: 200, epoch: 7 | loss: 0.5098949
	speed: 0.0244s/iter; left time: 767.1591s
	iters: 300, epoch: 7 | loss: 1.6879191
	speed: 0.0246s/iter; left time: 771.8600s
	iters: 400, epoch: 7 | loss: 0.3687280
	speed: 0.0241s/iter; left time: 752.6421s
	iters: 500, epoch: 7 | loss: 0.9250549
	speed: 0.0245s/iter; left time: 762.6923s
	iters: 600, epoch: 7 | loss: 0.3463446
	speed: 0.0243s/iter; left time: 755.1300s
	iters: 700, epoch: 7 | loss: 0.5470203
	speed: 0.0250s/iter; left time: 775.5688s
	iters: 800, epoch: 7 | loss: 0.4214427
	speed: 0.0245s/iter; left time: 757.9905s
	iters: 900, epoch: 7 | loss: 0.4349523
	speed: 0.0249s/iter; left time: 767.3086s
	iters: 1000, epoch: 7 | loss: 1.0446972
	speed: 0.0249s/iter; left time: 765.0316s
	iters: 1100, epoch: 7 | loss: 0.4794153
	speed: 0.0244s/iter; left time: 745.6644s
	iters: 1200, epoch: 7 | loss: 0.4007011
	speed: 0.0247s/iter; left time: 751.5736s
	iters: 1300, epoch: 7 | loss: 0.4454935
	speed: 0.0247s/iter; left time: 750.5266s
	iters: 1400, epoch: 7 | loss: 0.3220569
	speed: 0.0242s/iter; left time: 732.4256s
	iters: 1500, epoch: 7 | loss: 0.4961967
	speed: 0.0246s/iter; left time: 741.1133s
	iters: 1600, epoch: 7 | loss: 0.2965889
	speed: 0.0249s/iter; left time: 749.4750s
	iters: 1700, epoch: 7 | loss: 0.3002413
	speed: 0.0241s/iter; left time: 722.6885s
	iters: 1800, epoch: 7 | loss: 0.4850838
	speed: 0.0247s/iter; left time: 736.8125s
	iters: 1900, epoch: 7 | loss: 0.5297236
	speed: 0.0245s/iter; left time: 729.6922s
	iters: 2000, epoch: 7 | loss: 1.1559356
	speed: 0.0245s/iter; left time: 728.3478s
	iters: 2100, epoch: 7 | loss: 0.3886987
	speed: 0.0246s/iter; left time: 726.3376s
	iters: 2200, epoch: 7 | loss: 0.3999322
	speed: 0.0212s/iter; left time: 624.1901s
Epoch: 7 cost time: 54.81881880760193
Epoch: 7, Steps: 2263 | Train Loss: 0.5771225 Vali Loss: 0.4944426 Test Loss: 0.2395482
Validation loss decreased (0.500100 --> 0.494443).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.3470056
	speed: 0.0825s/iter; left time: 2420.0047s
	iters: 200, epoch: 8 | loss: 0.4760467
	speed: 0.0242s/iter; left time: 707.2627s
	iters: 300, epoch: 8 | loss: 0.3448295
	speed: 0.0243s/iter; left time: 708.0805s
	iters: 400, epoch: 8 | loss: 0.2988129
	speed: 0.0245s/iter; left time: 709.8041s
	iters: 500, epoch: 8 | loss: 0.3608555
	speed: 0.0248s/iter; left time: 717.8996s
	iters: 600, epoch: 8 | loss: 0.4921772
	speed: 0.0245s/iter; left time: 704.8715s
	iters: 700, epoch: 8 | loss: 0.3708158
	speed: 0.0250s/iter; left time: 716.5945s
	iters: 800, epoch: 8 | loss: 0.3130478
	speed: 0.0243s/iter; left time: 696.8500s
	iters: 900, epoch: 8 | loss: 0.9302558
	speed: 0.0247s/iter; left time: 705.1047s
	iters: 1000, epoch: 8 | loss: 0.4669440
	speed: 0.0256s/iter; left time: 728.2687s
	iters: 1100, epoch: 8 | loss: 0.9149874
	speed: 0.0247s/iter; left time: 698.5221s
	iters: 1200, epoch: 8 | loss: 0.4308604
	speed: 0.0234s/iter; left time: 660.1395s
	iters: 1300, epoch: 8 | loss: 0.4073993
	speed: 0.0251s/iter; left time: 704.7250s
	iters: 1400, epoch: 8 | loss: 0.3313177
	speed: 0.0247s/iter; left time: 692.6241s
	iters: 1500, epoch: 8 | loss: 0.3488264
	speed: 0.0243s/iter; left time: 679.8206s
	iters: 1600, epoch: 8 | loss: 0.3620846
	speed: 0.0246s/iter; left time: 683.3527s
	iters: 1700, epoch: 8 | loss: 0.4669097
	speed: 0.0249s/iter; left time: 689.1598s
	iters: 1800, epoch: 8 | loss: 0.3108886
	speed: 0.0246s/iter; left time: 680.1670s
	iters: 1900, epoch: 8 | loss: 1.0166409
	speed: 0.0247s/iter; left time: 681.1036s
	iters: 2000, epoch: 8 | loss: 0.5022694
	speed: 0.0240s/iter; left time: 658.7457s
	iters: 2100, epoch: 8 | loss: 0.6730543
	speed: 0.0242s/iter; left time: 661.0446s
	iters: 2200, epoch: 8 | loss: 0.4386971
	speed: 0.0208s/iter; left time: 564.9242s
Epoch: 8 cost time: 54.80061197280884
Epoch: 8, Steps: 2263 | Train Loss: 0.5724845 Vali Loss: 0.4961240 Test Loss: 0.2452478
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.3008356
	speed: 0.0845s/iter; left time: 2287.5037s
	iters: 200, epoch: 9 | loss: 0.8793622
	speed: 0.0261s/iter; left time: 703.5617s
	iters: 300, epoch: 9 | loss: 0.3556266
	speed: 0.0250s/iter; left time: 670.9357s
	iters: 400, epoch: 9 | loss: 1.0021712
	speed: 0.0258s/iter; left time: 689.8430s
	iters: 500, epoch: 9 | loss: 0.4031108
	speed: 0.0248s/iter; left time: 659.8779s
	iters: 600, epoch: 9 | loss: 0.4156226
	speed: 0.0260s/iter; left time: 690.8674s
	iters: 700, epoch: 9 | loss: 1.0827260
	speed: 0.0251s/iter; left time: 663.0290s
	iters: 800, epoch: 9 | loss: 1.1527150
	speed: 0.0259s/iter; left time: 681.9704s
	iters: 900, epoch: 9 | loss: 0.6338190
	speed: 0.0235s/iter; left time: 616.0298s
	iters: 1000, epoch: 9 | loss: 0.2772951
	speed: 0.0228s/iter; left time: 596.9207s
	iters: 1100, epoch: 9 | loss: 0.4920076
	speed: 0.0229s/iter; left time: 596.8062s
	iters: 1200, epoch: 9 | loss: 0.9666073
	speed: 0.0241s/iter; left time: 626.3735s
	iters: 1300, epoch: 9 | loss: 1.5205162
	speed: 0.0227s/iter; left time: 587.2817s
	iters: 1400, epoch: 9 | loss: 0.4227464
	speed: 0.0237s/iter; left time: 611.0001s
	iters: 1500, epoch: 9 | loss: 0.5376203
	speed: 0.0232s/iter; left time: 595.6996s
	iters: 1600, epoch: 9 | loss: 0.4717966
	speed: 0.0235s/iter; left time: 601.7325s
	iters: 1700, epoch: 9 | loss: 0.3301356
	speed: 0.0240s/iter; left time: 610.7633s
	iters: 1800, epoch: 9 | loss: 0.5205421
	speed: 0.0245s/iter; left time: 622.5132s
	iters: 1900, epoch: 9 | loss: 1.7064173
	speed: 0.0251s/iter; left time: 633.5709s
	iters: 2000, epoch: 9 | loss: 0.6436464
	speed: 0.0231s/iter; left time: 579.9503s
	iters: 2100, epoch: 9 | loss: 0.3930601
	speed: 0.0225s/iter; left time: 562.6074s
	iters: 2200, epoch: 9 | loss: 1.0024408
	speed: 0.0176s/iter; left time: 438.6166s
Epoch: 9 cost time: 53.70583748817444
Epoch: 9, Steps: 2263 | Train Loss: 0.5699795 Vali Loss: 0.4926627 Test Loss: 0.2409995
Validation loss decreased (0.494443 --> 0.492663).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.5136397
	speed: 0.0812s/iter; left time: 2013.8250s
	iters: 200, epoch: 10 | loss: 0.7763706
	speed: 0.0237s/iter; left time: 584.0182s
	iters: 300, epoch: 10 | loss: 0.5956123
	speed: 0.0237s/iter; left time: 582.9048s
	iters: 400, epoch: 10 | loss: 0.5778278
	speed: 0.0235s/iter; left time: 576.3024s
	iters: 500, epoch: 10 | loss: 0.3252725
	speed: 0.0242s/iter; left time: 589.5020s
	iters: 600, epoch: 10 | loss: 0.4033277
	speed: 0.0253s/iter; left time: 614.8940s
	iters: 700, epoch: 10 | loss: 0.3196100
	speed: 0.0255s/iter; left time: 616.1416s
	iters: 800, epoch: 10 | loss: 0.3562111
	speed: 0.0234s/iter; left time: 563.2955s
	iters: 900, epoch: 10 | loss: 0.4907064
	speed: 0.0227s/iter; left time: 545.5617s
	iters: 1000, epoch: 10 | loss: 0.3879304
	speed: 0.0240s/iter; left time: 574.3300s
	iters: 1100, epoch: 10 | loss: 0.4655879
	speed: 0.0233s/iter; left time: 553.2329s
	iters: 1200, epoch: 10 | loss: 0.3824983
	speed: 0.0214s/iter; left time: 506.7812s
	iters: 1300, epoch: 10 | loss: 0.3854722
	speed: 0.0252s/iter; left time: 594.9483s
	iters: 1400, epoch: 10 | loss: 0.6057273
	speed: 0.0211s/iter; left time: 496.2283s
	iters: 1500, epoch: 10 | loss: 0.4385124
	speed: 0.0227s/iter; left time: 530.7113s
	iters: 1600, epoch: 10 | loss: 0.3708183
	speed: 0.0221s/iter; left time: 515.6757s
	iters: 1700, epoch: 10 | loss: 1.4618818
	speed: 0.0249s/iter; left time: 577.5507s
	iters: 1800, epoch: 10 | loss: 0.4358486
	speed: 0.0245s/iter; left time: 565.5707s
	iters: 1900, epoch: 10 | loss: 0.4514074
	speed: 0.0236s/iter; left time: 541.6825s
	iters: 2000, epoch: 10 | loss: 0.6215353
	speed: 0.0223s/iter; left time: 510.9999s
	iters: 2100, epoch: 10 | loss: 0.3271961
	speed: 0.0200s/iter; left time: 455.0867s
	iters: 2200, epoch: 10 | loss: 0.3914380
	speed: 0.0162s/iter; left time: 367.4991s
Epoch: 10 cost time: 51.77551603317261
Epoch: 10, Steps: 2263 | Train Loss: 0.5686936 Vali Loss: 0.4945249 Test Loss: 0.2425301
EarlyStopping counter: 1 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.5408125
	speed: 0.0803s/iter; left time: 1809.4757s
	iters: 200, epoch: 11 | loss: 0.3180147
	speed: 0.0220s/iter; left time: 494.4106s
	iters: 300, epoch: 11 | loss: 0.3936441
	speed: 0.0238s/iter; left time: 532.0582s
	iters: 400, epoch: 11 | loss: 0.3960968
	speed: 0.0227s/iter; left time: 504.4167s
	iters: 500, epoch: 11 | loss: 0.3610425
	speed: 0.0243s/iter; left time: 538.1863s
	iters: 600, epoch: 11 | loss: 0.2647899
	speed: 0.0229s/iter; left time: 504.7442s
	iters: 700, epoch: 11 | loss: 0.3334077
	speed: 0.0238s/iter; left time: 521.1811s
	iters: 800, epoch: 11 | loss: 0.2930986
	speed: 0.0236s/iter; left time: 515.7152s
	iters: 900, epoch: 11 | loss: 0.9479439
	speed: 0.0234s/iter; left time: 508.9169s
	iters: 1000, epoch: 11 | loss: 0.3583351
	speed: 0.0256s/iter; left time: 554.4210s
	iters: 1100, epoch: 11 | loss: 0.6663713
	speed: 0.0239s/iter; left time: 515.6367s
	iters: 1200, epoch: 11 | loss: 0.3533183
	speed: 0.0240s/iter; left time: 514.7016s
	iters: 1300, epoch: 11 | loss: 0.4173551
	speed: 0.0238s/iter; left time: 508.0067s
	iters: 1400, epoch: 11 | loss: 0.6074066
	speed: 0.0249s/iter; left time: 528.6788s
	iters: 1500, epoch: 11 | loss: 0.4483924
	speed: 0.0220s/iter; left time: 464.9953s
	iters: 1600, epoch: 11 | loss: 0.9528461
	speed: 0.0247s/iter; left time: 519.2493s
	iters: 1700, epoch: 11 | loss: 0.4063463
	speed: 0.0224s/iter; left time: 467.9084s
	iters: 1800, epoch: 11 | loss: 0.4898570
	speed: 0.0241s/iter; left time: 501.8699s
	iters: 1900, epoch: 11 | loss: 0.4800763
	speed: 0.0207s/iter; left time: 428.5307s
	iters: 2000, epoch: 11 | loss: 0.3766715
	speed: 0.0233s/iter; left time: 480.4080s
	iters: 2100, epoch: 11 | loss: 0.4122494
	speed: 0.0198s/iter; left time: 407.0310s
	iters: 2200, epoch: 11 | loss: 0.3877110
	speed: 0.0184s/iter; left time: 376.1960s
Epoch: 11 cost time: 52.0625786781311
Epoch: 11, Steps: 2263 | Train Loss: 0.5680829 Vali Loss: 0.4955192 Test Loss: 0.2419292
EarlyStopping counter: 2 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 1.0044953
	speed: 0.0894s/iter; left time: 1811.9049s
	iters: 200, epoch: 12 | loss: 0.5273793
	speed: 0.0229s/iter; left time: 462.8086s
	iters: 300, epoch: 12 | loss: 0.3993911
	speed: 0.0213s/iter; left time: 428.0328s
	iters: 400, epoch: 12 | loss: 0.3570687
	speed: 0.0255s/iter; left time: 510.0655s
	iters: 500, epoch: 12 | loss: 0.3494186
	speed: 0.0246s/iter; left time: 488.7620s
	iters: 600, epoch: 12 | loss: 0.6060211
	speed: 0.0201s/iter; left time: 396.9101s
	iters: 700, epoch: 12 | loss: 0.3331577
	speed: 0.0217s/iter; left time: 426.6091s
	iters: 800, epoch: 12 | loss: 0.4956614
	speed: 0.0204s/iter; left time: 398.3542s
	iters: 900, epoch: 12 | loss: 0.9528512
	speed: 0.0208s/iter; left time: 404.0753s
	iters: 1000, epoch: 12 | loss: 0.6098263
	speed: 0.0231s/iter; left time: 447.8476s
	iters: 1100, epoch: 12 | loss: 0.4000513
	speed: 0.0225s/iter; left time: 434.3790s
	iters: 1200, epoch: 12 | loss: 0.3250812
	speed: 0.0220s/iter; left time: 421.7111s
	iters: 1300, epoch: 12 | loss: 0.4615231
	speed: 0.0218s/iter; left time: 415.3891s
	iters: 1400, epoch: 12 | loss: 0.3855347
	speed: 0.0200s/iter; left time: 380.2702s
	iters: 1500, epoch: 12 | loss: 0.8639614
	speed: 0.0227s/iter; left time: 428.0781s
	iters: 1600, epoch: 12 | loss: 0.7381741
	speed: 0.0235s/iter; left time: 440.9712s
	iters: 1700, epoch: 12 | loss: 0.4277562
	speed: 0.0221s/iter; left time: 412.6414s
	iters: 1800, epoch: 12 | loss: 0.3559566
	speed: 0.0213s/iter; left time: 395.7672s
	iters: 1900, epoch: 12 | loss: 0.4134524
	speed: 0.0205s/iter; left time: 378.3332s
	iters: 2000, epoch: 12 | loss: 0.4319947
	speed: 0.0167s/iter; left time: 306.8034s
	iters: 2100, epoch: 12 | loss: 0.4876933
	speed: 0.0174s/iter; left time: 317.4708s
	iters: 2200, epoch: 12 | loss: 0.3780770
	speed: 0.0194s/iter; left time: 352.9212s
Epoch: 12 cost time: 48.51809883117676
Epoch: 12, Steps: 2263 | Train Loss: 0.5677126 Vali Loss: 0.4945365 Test Loss: 0.2407258
EarlyStopping counter: 3 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.3620297
	speed: 0.0837s/iter; left time: 1507.6541s
	iters: 200, epoch: 13 | loss: 0.4004508
	speed: 0.0227s/iter; left time: 406.0958s
	iters: 300, epoch: 13 | loss: 0.4553919
	speed: 0.0202s/iter; left time: 359.2556s
	iters: 400, epoch: 13 | loss: 0.9021065
	speed: 0.0176s/iter; left time: 310.9330s
	iters: 500, epoch: 13 | loss: 0.4220195
	speed: 0.0176s/iter; left time: 310.6696s
	iters: 600, epoch: 13 | loss: 0.9175888
	speed: 0.0182s/iter; left time: 318.7090s
	iters: 700, epoch: 13 | loss: 0.5068766
	speed: 0.0198s/iter; left time: 344.1697s
	iters: 800, epoch: 13 | loss: 0.7617793
	speed: 0.0192s/iter; left time: 333.0479s
	iters: 900, epoch: 13 | loss: 0.3579404
	speed: 0.0205s/iter; left time: 351.8608s
	iters: 1000, epoch: 13 | loss: 0.3869246
	speed: 0.0199s/iter; left time: 340.1367s
	iters: 1100, epoch: 13 | loss: 0.4944622
	speed: 0.0209s/iter; left time: 356.0882s
	iters: 1200, epoch: 13 | loss: 0.3189890
	speed: 0.0196s/iter; left time: 330.7532s
	iters: 1300, epoch: 13 | loss: 0.2916499
	speed: 0.0208s/iter; left time: 349.5532s
	iters: 1400, epoch: 13 | loss: 0.5476961
	speed: 0.0212s/iter; left time: 354.7334s
	iters: 1500, epoch: 13 | loss: 0.4249161
	speed: 0.0218s/iter; left time: 362.5691s
	iters: 1600, epoch: 13 | loss: 0.4024152
	speed: 0.0222s/iter; left time: 366.9352s
	iters: 1700, epoch: 13 | loss: 4.2264719
	speed: 0.0223s/iter; left time: 365.5651s
	iters: 1800, epoch: 13 | loss: 0.3124337
	speed: 0.0218s/iter; left time: 355.9081s
	iters: 1900, epoch: 13 | loss: 0.3677103
	speed: 0.0192s/iter; left time: 310.9008s
	iters: 2000, epoch: 13 | loss: 0.9295328
	speed: 0.0188s/iter; left time: 303.0024s
	iters: 2100, epoch: 13 | loss: 0.9379585
	speed: 0.0191s/iter; left time: 306.0417s
	iters: 2200, epoch: 13 | loss: 0.4328343
	speed: 0.0177s/iter; left time: 282.0269s
Epoch: 13 cost time: 45.57868671417236
Epoch: 13, Steps: 2263 | Train Loss: 0.5675629 Vali Loss: 0.4945219 Test Loss: 0.2412186
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.3878268
	speed: 0.0751s/iter; left time: 1182.9968s
	iters: 200, epoch: 14 | loss: 0.3333162
	speed: 0.0198s/iter; left time: 310.2270s
	iters: 300, epoch: 14 | loss: 0.8867732
	speed: 0.0190s/iter; left time: 295.5678s
	iters: 400, epoch: 14 | loss: 0.4370132
	speed: 0.0185s/iter; left time: 286.0743s
	iters: 500, epoch: 14 | loss: 0.2856027
	speed: 0.0188s/iter; left time: 287.8761s
	iters: 600, epoch: 14 | loss: 0.3441290
	speed: 0.0175s/iter; left time: 266.7682s
	iters: 700, epoch: 14 | loss: 0.4625996
	speed: 0.0192s/iter; left time: 290.6363s
	iters: 800, epoch: 14 | loss: 0.3541626
	speed: 0.0193s/iter; left time: 290.0841s
	iters: 900, epoch: 14 | loss: 0.4034753
	speed: 0.0192s/iter; left time: 286.3552s
	iters: 1000, epoch: 14 | loss: 0.3637393
	speed: 0.0189s/iter; left time: 279.8473s
	iters: 1100, epoch: 14 | loss: 0.6813027
	speed: 0.0182s/iter; left time: 267.6453s
	iters: 1200, epoch: 14 | loss: 0.5217237
	speed: 0.0186s/iter; left time: 271.9488s
	iters: 1300, epoch: 14 | loss: 0.9523028
	speed: 0.0189s/iter; left time: 274.1809s
	iters: 1400, epoch: 14 | loss: 0.3034559
	speed: 0.0190s/iter; left time: 274.9653s
	iters: 1500, epoch: 14 | loss: 0.4743389
	speed: 0.0187s/iter; left time: 268.8020s
	iters: 1600, epoch: 14 | loss: 0.4987714
	speed: 0.0190s/iter; left time: 270.5532s
	iters: 1700, epoch: 14 | loss: 0.4180493
	speed: 0.0191s/iter; left time: 269.8969s
	iters: 1800, epoch: 14 | loss: 0.6344862
	speed: 0.0184s/iter; left time: 258.5729s
	iters: 1900, epoch: 14 | loss: 0.3806414
	speed: 0.0174s/iter; left time: 242.7644s
	iters: 2000, epoch: 14 | loss: 7.2724614
	speed: 0.0177s/iter; left time: 245.2565s
	iters: 2100, epoch: 14 | loss: 0.3019386
	speed: 0.0176s/iter; left time: 241.7229s
	iters: 2200, epoch: 14 | loss: 0.3188824
	speed: 0.0184s/iter; left time: 250.7880s
Epoch: 14 cost time: 42.218446016311646
Epoch: 14, Steps: 2263 | Train Loss: 0.5674279 Vali Loss: 0.4945538 Test Loss: 0.2412041
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : weather_336_336_Linear_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3293<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10204
mse:0.24106654524803162, mae:0.30162137746810913
