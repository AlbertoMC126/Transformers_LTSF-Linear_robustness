Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='NLinear', model_id='traffic_336_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=28649, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_336_96_NLinear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed28649>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11849
val 1661
test 3413
	iters: 100, epoch: 1 | loss: 0.6709640
	speed: 0.3187s/iter; left time: 4685.7573s
	iters: 200, epoch: 1 | loss: 0.6742883
	speed: 0.3043s/iter; left time: 4442.7193s
	iters: 300, epoch: 1 | loss: 1.1821352
	speed: 0.3030s/iter; left time: 4393.7498s
	iters: 400, epoch: 1 | loss: 0.7714059
	speed: 0.3042s/iter; left time: 4381.0383s
	iters: 500, epoch: 1 | loss: 1.0532939
	speed: 0.3032s/iter; left time: 4335.5510s
	iters: 600, epoch: 1 | loss: 0.8536782
	speed: 0.3049s/iter; left time: 4330.5478s
	iters: 700, epoch: 1 | loss: 1.0750839
	speed: 0.3041s/iter; left time: 4288.0627s
Epoch: 1 cost time: 226.65170073509216
Epoch: 1, Steps: 740 | Train Loss: 1.0562653 Vali Loss: 1.1138928 Test Loss: 1.2773743
Validation loss decreased (inf --> 1.113893).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.8109485
	speed: 0.6173s/iter; left time: 8617.6956s
	iters: 200, epoch: 2 | loss: 1.2616670
	speed: 0.3040s/iter; left time: 4213.7144s
	iters: 300, epoch: 2 | loss: 0.9288059
	speed: 0.3037s/iter; left time: 4179.5372s
	iters: 400, epoch: 2 | loss: 1.5004073
	speed: 0.3030s/iter; left time: 4138.8413s
	iters: 500, epoch: 2 | loss: 1.5797710
	speed: 0.3039s/iter; left time: 4120.6301s
	iters: 600, epoch: 2 | loss: 0.7525628
	speed: 0.3034s/iter; left time: 4084.2089s
	iters: 700, epoch: 2 | loss: 0.5347650
	speed: 0.3030s/iter; left time: 4048.1925s
Epoch: 2 cost time: 224.55072164535522
Epoch: 2, Steps: 740 | Train Loss: 0.9647696 Vali Loss: 1.5075673 Test Loss: 2.1065648
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.3275545
	speed: 0.6166s/iter; left time: 8152.3603s
	iters: 200, epoch: 3 | loss: 0.3234040
	speed: 0.3030s/iter; left time: 3976.2682s
	iters: 300, epoch: 3 | loss: 0.3621907
	speed: 0.3051s/iter; left time: 3972.8242s
	iters: 400, epoch: 3 | loss: 0.3175519
	speed: 0.3036s/iter; left time: 3922.3521s
	iters: 500, epoch: 3 | loss: 0.3389486
	speed: 0.3039s/iter; left time: 3896.2806s
	iters: 600, epoch: 3 | loss: 0.3410699
	speed: 0.3036s/iter; left time: 3862.4529s
	iters: 700, epoch: 3 | loss: 0.3085809
	speed: 0.3026s/iter; left time: 3819.0442s
Epoch: 3 cost time: 224.75529789924622
Epoch: 3, Steps: 740 | Train Loss: 0.3551466 Vali Loss: 0.4743486 Test Loss: 0.5628629
Validation loss decreased (1.113893 --> 0.474349).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.2686737
	speed: 0.6157s/iter; left time: 7684.8433s
	iters: 200, epoch: 4 | loss: 0.2710683
	speed: 0.3039s/iter; left time: 3762.2248s
	iters: 300, epoch: 4 | loss: 0.2874637
	speed: 0.3035s/iter; left time: 3727.5831s
	iters: 400, epoch: 4 | loss: 0.3098967
	speed: 0.3037s/iter; left time: 3699.1586s
	iters: 500, epoch: 4 | loss: 0.3273410
	speed: 0.3048s/iter; left time: 3682.6106s
	iters: 600, epoch: 4 | loss: 0.3189186
	speed: 0.3039s/iter; left time: 3640.8019s
	iters: 700, epoch: 4 | loss: 0.2557933
	speed: 0.3035s/iter; left time: 3606.4309s
Epoch: 4 cost time: 224.72261142730713
Epoch: 4, Steps: 740 | Train Loss: 0.2825599 Vali Loss: 0.4028901 Test Loss: 0.4901772
Validation loss decreased (0.474349 --> 0.402890).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.2890457
	speed: 0.6153s/iter; left time: 7224.6203s
	iters: 200, epoch: 5 | loss: 0.2725859
	speed: 0.3035s/iter; left time: 3532.5286s
	iters: 300, epoch: 5 | loss: 0.2634544
	speed: 0.3028s/iter; left time: 3494.8592s
	iters: 400, epoch: 5 | loss: 0.2667761
	speed: 0.3026s/iter; left time: 3461.9483s
	iters: 500, epoch: 5 | loss: 0.2577263
	speed: 0.3044s/iter; left time: 3451.9291s
	iters: 600, epoch: 5 | loss: 0.2845288
	speed: 0.3032s/iter; left time: 3408.6480s
	iters: 700, epoch: 5 | loss: 0.2695803
	speed: 0.3034s/iter; left time: 3380.5865s
Epoch: 5 cost time: 224.34012007713318
Epoch: 5, Steps: 740 | Train Loss: 0.2570960 Vali Loss: 0.3754296 Test Loss: 0.4544946
Validation loss decreased (0.402890 --> 0.375430).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.2306073
	speed: 0.6161s/iter; left time: 6777.6924s
	iters: 200, epoch: 6 | loss: 0.2440040
	speed: 0.3045s/iter; left time: 3319.2649s
	iters: 300, epoch: 6 | loss: 0.2602482
	speed: 0.3030s/iter; left time: 3272.7492s
	iters: 400, epoch: 6 | loss: 0.2131983
	speed: 0.3034s/iter; left time: 3246.7425s
	iters: 500, epoch: 6 | loss: 0.2312418
	speed: 0.3044s/iter; left time: 3226.4736s
	iters: 600, epoch: 6 | loss: 0.2557172
	speed: 0.3030s/iter; left time: 3181.9775s
	iters: 700, epoch: 6 | loss: 0.2724831
	speed: 0.3044s/iter; left time: 3166.0288s
Epoch: 6 cost time: 224.67766499519348
Epoch: 6, Steps: 740 | Train Loss: 0.2469316 Vali Loss: 0.3603142 Test Loss: 0.4370348
Validation loss decreased (0.375430 --> 0.360314).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.2556293
	speed: 0.6194s/iter; left time: 6356.1090s
	iters: 200, epoch: 7 | loss: 0.2398389
	speed: 0.3039s/iter; left time: 3088.0236s
	iters: 300, epoch: 7 | loss: 0.2375805
	speed: 0.3022s/iter; left time: 3040.9141s
	iters: 400, epoch: 7 | loss: 0.2229117
	speed: 0.3025s/iter; left time: 3012.9551s
	iters: 500, epoch: 7 | loss: 0.2343629
	speed: 0.3039s/iter; left time: 2996.9507s
	iters: 600, epoch: 7 | loss: 0.2582957
	speed: 0.3042s/iter; left time: 2969.5142s
	iters: 700, epoch: 7 | loss: 0.2295851
	speed: 0.3040s/iter; left time: 2937.1873s
Epoch: 7 cost time: 224.64975881576538
Epoch: 7, Steps: 740 | Train Loss: 0.2413933 Vali Loss: 0.3539387 Test Loss: 0.4312764
Validation loss decreased (0.360314 --> 0.353939).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.2440828
	speed: 0.6185s/iter; left time: 5888.7453s
	iters: 200, epoch: 8 | loss: 0.2575517
	speed: 0.3028s/iter; left time: 2852.2955s
	iters: 300, epoch: 8 | loss: 0.2238933
	speed: 0.3022s/iter; left time: 2816.4383s
	iters: 400, epoch: 8 | loss: 0.2460014
	speed: 0.3025s/iter; left time: 2788.9159s
	iters: 500, epoch: 8 | loss: 0.2875865
	speed: 0.3033s/iter; left time: 2766.3194s
	iters: 600, epoch: 8 | loss: 0.2615757
	speed: 0.3026s/iter; left time: 2729.5112s
	iters: 700, epoch: 8 | loss: 0.2397324
	speed: 0.3034s/iter; left time: 2706.5571s
Epoch: 8 cost time: 224.32119512557983
Epoch: 8, Steps: 740 | Train Loss: 0.2381150 Vali Loss: 0.3507055 Test Loss: 0.4276931
Validation loss decreased (0.353939 --> 0.350705).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.2501573
	speed: 0.6189s/iter; left time: 5434.4725s
	iters: 200, epoch: 9 | loss: 0.2442914
	speed: 0.3040s/iter; left time: 2639.2764s
	iters: 300, epoch: 9 | loss: 0.2467833
	speed: 0.3035s/iter; left time: 2604.6590s
	iters: 400, epoch: 9 | loss: 0.2277800
	speed: 0.3019s/iter; left time: 2560.1038s
	iters: 500, epoch: 9 | loss: 0.2383498
	speed: 0.3030s/iter; left time: 2539.0288s
	iters: 600, epoch: 9 | loss: 0.2597839
	speed: 0.3027s/iter; left time: 2506.7842s
	iters: 700, epoch: 9 | loss: 0.2415096
	speed: 0.3026s/iter; left time: 2475.6778s
Epoch: 9 cost time: 224.25725936889648
Epoch: 9, Steps: 740 | Train Loss: 0.2361986 Vali Loss: 0.3487516 Test Loss: 0.4246169
Validation loss decreased (0.350705 --> 0.348752).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.2574320
	speed: 0.6182s/iter; left time: 4971.1190s
	iters: 200, epoch: 10 | loss: 0.2134083
	speed: 0.3052s/iter; left time: 2423.7387s
	iters: 300, epoch: 10 | loss: 0.2685549
	speed: 0.3049s/iter; left time: 2390.6549s
	iters: 400, epoch: 10 | loss: 0.2769682
	speed: 0.3049s/iter; left time: 2359.9259s
	iters: 500, epoch: 10 | loss: 0.2384225
	speed: 0.3042s/iter; left time: 2324.1814s
	iters: 600, epoch: 10 | loss: 0.2565236
	speed: 0.3036s/iter; left time: 2289.6366s
	iters: 700, epoch: 10 | loss: 0.2413040
	speed: 0.3028s/iter; left time: 2253.3541s
Epoch: 10 cost time: 225.18205094337463
Epoch: 10, Steps: 740 | Train Loss: 0.2351061 Vali Loss: 0.3477315 Test Loss: 0.4240096
Validation loss decreased (0.348752 --> 0.347732).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.2354187
	speed: 0.6162s/iter; left time: 4498.7702s
	iters: 200, epoch: 11 | loss: 0.2279754
	speed: 0.3047s/iter; left time: 2193.9574s
	iters: 300, epoch: 11 | loss: 0.2687814
	speed: 0.3046s/iter; left time: 2163.0532s
	iters: 400, epoch: 11 | loss: 0.2735153
	speed: 0.3047s/iter; left time: 2133.1476s
	iters: 500, epoch: 11 | loss: 0.2086453
	speed: 0.3033s/iter; left time: 2092.9105s
	iters: 600, epoch: 11 | loss: 0.2483941
	speed: 0.3041s/iter; left time: 2067.9364s
	iters: 700, epoch: 11 | loss: 0.2428743
	speed: 0.3039s/iter; left time: 2036.5909s
Epoch: 11 cost time: 225.07754182815552
Epoch: 11, Steps: 740 | Train Loss: 0.2345510 Vali Loss: 0.3471495 Test Loss: 0.4232433
Validation loss decreased (0.347732 --> 0.347150).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.2231250
	speed: 0.6177s/iter; left time: 4052.7839s
	iters: 200, epoch: 12 | loss: 0.2603032
	speed: 0.3033s/iter; left time: 1959.4625s
	iters: 300, epoch: 12 | loss: 0.2310871
	speed: 0.3046s/iter; left time: 1937.4635s
	iters: 400, epoch: 12 | loss: 0.2401689
	speed: 0.3040s/iter; left time: 1903.1235s
	iters: 500, epoch: 12 | loss: 0.2396084
	speed: 0.3046s/iter; left time: 1876.4014s
	iters: 600, epoch: 12 | loss: 0.2354931
	speed: 0.3058s/iter; left time: 1853.5089s
	iters: 700, epoch: 12 | loss: 0.2525232
	speed: 0.3048s/iter; left time: 1816.7108s
Epoch: 12 cost time: 225.42379570007324
Epoch: 12, Steps: 740 | Train Loss: 0.2341865 Vali Loss: 0.3468136 Test Loss: 0.4230080
Validation loss decreased (0.347150 --> 0.346814).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.2716076
	speed: 0.6182s/iter; left time: 3598.6283s
	iters: 200, epoch: 13 | loss: 0.2404162
	speed: 0.3037s/iter; left time: 1737.3363s
	iters: 300, epoch: 13 | loss: 0.2324641
	speed: 0.3044s/iter; left time: 1711.2016s
	iters: 400, epoch: 13 | loss: 0.2422046
	speed: 0.3032s/iter; left time: 1674.2244s
	iters: 500, epoch: 13 | loss: 0.2016141
	speed: 0.3039s/iter; left time: 1647.2949s
	iters: 600, epoch: 13 | loss: 0.2246268
	speed: 0.3047s/iter; left time: 1621.3049s
	iters: 700, epoch: 13 | loss: 0.2326737
	speed: 0.3043s/iter; left time: 1588.6246s
Epoch: 13 cost time: 224.97468614578247
Epoch: 13, Steps: 740 | Train Loss: 0.2339875 Vali Loss: 0.3469899 Test Loss: 0.4228946
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 14 | loss: 0.2367480
	speed: 0.6181s/iter; left time: 3140.5883s
	iters: 200, epoch: 14 | loss: 0.2424657
	speed: 0.3045s/iter; left time: 1516.5385s
	iters: 300, epoch: 14 | loss: 0.2116592
	speed: 0.3031s/iter; left time: 1479.4658s
	iters: 400, epoch: 14 | loss: 0.2070107
	speed: 0.3030s/iter; left time: 1448.7087s
	iters: 500, epoch: 14 | loss: 0.2018482
	speed: 0.3047s/iter; left time: 1426.1987s
	iters: 600, epoch: 14 | loss: 0.2291341
	speed: 0.3044s/iter; left time: 1394.4665s
	iters: 700, epoch: 14 | loss: 0.2195152
	speed: 0.3046s/iter; left time: 1365.1166s
Epoch: 14 cost time: 225.08471131324768
Epoch: 14, Steps: 740 | Train Loss: 0.2338915 Vali Loss: 0.3463771 Test Loss: 0.4228038
Validation loss decreased (0.346814 --> 0.346377).  Saving model ...
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 15 | loss: 0.2506238
	speed: 0.6204s/iter; left time: 2693.2063s
	iters: 200, epoch: 15 | loss: 0.2459980
	speed: 0.3046s/iter; left time: 1291.9844s
	iters: 300, epoch: 15 | loss: 0.2068245
	speed: 0.3030s/iter; left time: 1254.6053s
	iters: 400, epoch: 15 | loss: 0.2146743
	speed: 0.3045s/iter; left time: 1230.6187s
	iters: 500, epoch: 15 | loss: 0.2351329
	speed: 0.3042s/iter; left time: 1198.7479s
	iters: 600, epoch: 15 | loss: 0.2559354
	speed: 0.3044s/iter; left time: 1169.2113s
	iters: 700, epoch: 15 | loss: 0.2461348
	speed: 0.3035s/iter; left time: 1135.2898s
Epoch: 15 cost time: 224.989417552948
Epoch: 15, Steps: 740 | Train Loss: 0.2338642 Vali Loss: 0.3464807 Test Loss: 0.4227700
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 16 | loss: 0.2329713
	speed: 0.6150s/iter; left time: 2214.4834s
	iters: 200, epoch: 16 | loss: 0.2149141
	speed: 0.3031s/iter; left time: 1061.2896s
	iters: 300, epoch: 16 | loss: 0.2287762
	speed: 0.3039s/iter; left time: 1033.5147s
	iters: 400, epoch: 16 | loss: 0.2147296
	speed: 0.3036s/iter; left time: 1002.0442s
	iters: 500, epoch: 16 | loss: 0.2221440
	speed: 0.3031s/iter; left time: 970.2327s
	iters: 600, epoch: 16 | loss: 0.2153625
	speed: 0.3038s/iter; left time: 942.1855s
	iters: 700, epoch: 16 | loss: 0.2216564
	speed: 0.3040s/iter; left time: 912.2476s
Epoch: 16 cost time: 224.69594383239746
Epoch: 16, Steps: 740 | Train Loss: 0.2338076 Vali Loss: 0.3466311 Test Loss: 0.4227733
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 17 | loss: 0.2316871
	speed: 0.6179s/iter; left time: 1767.8239s
	iters: 200, epoch: 17 | loss: 0.2135337
	speed: 0.3034s/iter; left time: 837.7503s
	iters: 300, epoch: 17 | loss: 0.2290412
	speed: 0.3048s/iter; left time: 811.1313s
	iters: 400, epoch: 17 | loss: 0.2387379
	speed: 0.3032s/iter; left time: 776.4268s
	iters: 500, epoch: 17 | loss: 0.2440652
	speed: 0.3036s/iter; left time: 747.0831s
	iters: 600, epoch: 17 | loss: 0.2066650
	speed: 0.3044s/iter; left time: 718.7881s
	iters: 700, epoch: 17 | loss: 0.2025803
	speed: 0.3040s/iter; left time: 687.4471s
Epoch: 17 cost time: 225.01757311820984
Epoch: 17, Steps: 740 | Train Loss: 0.2337250 Vali Loss: 0.3467064 Test Loss: 0.4227773
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 18 | loss: 0.2077594
	speed: 0.6161s/iter; left time: 1306.8521s
	iters: 200, epoch: 18 | loss: 0.1880499
	speed: 0.3045s/iter; left time: 615.4074s
	iters: 300, epoch: 18 | loss: 0.2163504
	speed: 0.3048s/iter; left time: 585.5172s
	iters: 400, epoch: 18 | loss: 0.2121318
	speed: 0.3042s/iter; left time: 553.9834s
	iters: 500, epoch: 18 | loss: 0.2226426
	speed: 0.3037s/iter; left time: 522.6499s
	iters: 600, epoch: 18 | loss: 0.2416264
	speed: 0.3031s/iter; left time: 491.2640s
	iters: 700, epoch: 18 | loss: 0.2482925
	speed: 0.3039s/iter; left time: 462.2246s
Epoch: 18 cost time: 224.90458035469055
Epoch: 18, Steps: 740 | Train Loss: 0.2337669 Vali Loss: 0.3466357 Test Loss: 0.4227764
EarlyStopping counter: 4 out of 5
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 19 | loss: 0.2272039
	speed: 0.6167s/iter; left time: 851.6549s
	iters: 200, epoch: 19 | loss: 0.2130330
	speed: 0.3046s/iter; left time: 390.1646s
	iters: 300, epoch: 19 | loss: 0.2423811
	speed: 0.3034s/iter; left time: 358.3393s
	iters: 400, epoch: 19 | loss: 0.2523077
	speed: 0.3042s/iter; left time: 328.8845s
	iters: 500, epoch: 19 | loss: 0.2352529
	speed: 0.3033s/iter; left time: 297.4915s
	iters: 600, epoch: 19 | loss: 0.2587547
	speed: 0.3036s/iter; left time: 267.4345s
	iters: 700, epoch: 19 | loss: 0.2306532
	speed: 0.3037s/iter; left time: 237.1563s
Epoch: 19 cost time: 224.88289499282837
Epoch: 19, Steps: 740 | Train Loss: 0.2337851 Vali Loss: 0.3466359 Test Loss: 0.4227771
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : traffic_336_96_NLinear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed28649<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3413
mse:0.4230801463127136, mae:0.2941211462020874
