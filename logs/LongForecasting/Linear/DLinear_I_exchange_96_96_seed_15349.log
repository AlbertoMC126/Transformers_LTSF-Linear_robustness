Args in experiment:
Namespace(activation='gelu', batch_size=8, c_out=8, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='exchange_rate.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=8, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='mse', lradj='type1', model='DLinear', model_id='Exchange_96_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=15349, seq_len=96, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : Exchange_96_96_DLinear_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15349>>>>>>>>>>>>>>>>>>>>>>>>>>
train 5120
data_set:  <data_provider.data_loader.Dataset_Custom object at 0x000002586B190400>
val 665
data_set:  <data_provider.data_loader.Dataset_Custom object at 0x0000025838797DD8>
test 1422
data_set:  <data_provider.data_loader.Dataset_Custom object at 0x000002586B190128>
Total number of trainable parameters: 148992
Total number of parameters: 148992
	iters: 100, epoch: 1 | loss: 0.1635432
	speed: 0.0153s/iter; left time: 194.1901s
	iters: 200, epoch: 1 | loss: 0.1940527
	speed: 0.0047s/iter; left time: 59.1060s
	iters: 300, epoch: 1 | loss: 0.1101164
	speed: 0.0050s/iter; left time: 62.4799s
	iters: 400, epoch: 1 | loss: 0.1333726
	speed: 0.0042s/iter; left time: 52.3159s
	iters: 500, epoch: 1 | loss: 0.0815644
	speed: 0.0042s/iter; left time: 51.9084s
	iters: 600, epoch: 1 | loss: 0.1128099
	speed: 0.0042s/iter; left time: 51.4752s
Epoch: 1 cost time: 4.013693571090698
Epoch: 1, Steps: 640 | Train Loss: 0.1760963 Vali Loss: 0.3103817 Test Loss: 0.1151873
Validation loss decreased (inf --> 0.310382).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1049332
	speed: 0.0114s/iter; left time: 136.9096s
	iters: 200, epoch: 2 | loss: 0.1088237
	speed: 0.0044s/iter; left time: 52.9674s
	iters: 300, epoch: 2 | loss: 0.1035088
	speed: 0.0053s/iter; left time: 63.0295s
	iters: 400, epoch: 2 | loss: 0.1151862
	speed: 0.0042s/iter; left time: 49.6167s
	iters: 500, epoch: 2 | loss: 0.1011157
	speed: 0.0046s/iter; left time: 53.1832s
	iters: 600, epoch: 2 | loss: 0.0928620
	speed: 0.0051s/iter; left time: 59.2477s
Epoch: 2 cost time: 3.008125066757202
Epoch: 2, Steps: 640 | Train Loss: 0.1246861 Vali Loss: 0.1991418 Test Loss: 0.0869794
Validation loss decreased (0.310382 --> 0.199142).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.0969906
	speed: 0.0113s/iter; left time: 128.5267s
	iters: 200, epoch: 3 | loss: 0.0699165
	speed: 0.0047s/iter; left time: 53.0461s
	iters: 300, epoch: 3 | loss: 0.1523772
	speed: 0.0042s/iter; left time: 47.4399s
	iters: 400, epoch: 3 | loss: 0.1180441
	speed: 0.0045s/iter; left time: 50.2768s
	iters: 500, epoch: 3 | loss: 0.1412566
	speed: 0.0044s/iter; left time: 48.2318s
	iters: 600, epoch: 3 | loss: 0.1708585
	speed: 0.0041s/iter; left time: 44.3657s
Epoch: 3 cost time: 2.887362003326416
Epoch: 3, Steps: 640 | Train Loss: 0.1192373 Vali Loss: 0.1862481 Test Loss: 0.0900114
Validation loss decreased (0.199142 --> 0.186248).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.2790224
	speed: 0.0106s/iter; left time: 114.5622s
	iters: 200, epoch: 4 | loss: 0.0722127
	speed: 0.0042s/iter; left time: 45.0194s
	iters: 300, epoch: 4 | loss: 0.0788302
	speed: 0.0048s/iter; left time: 51.2820s
	iters: 400, epoch: 4 | loss: 0.1380647
	speed: 0.0042s/iter; left time: 44.2257s
	iters: 500, epoch: 4 | loss: 0.0761862
	speed: 0.0047s/iter; left time: 48.6465s
	iters: 600, epoch: 4 | loss: 0.1214160
	speed: 0.0049s/iter; left time: 50.1659s
Epoch: 4 cost time: 2.890679121017456
Epoch: 4, Steps: 640 | Train Loss: 0.1169631 Vali Loss: 0.1763255 Test Loss: 0.0845460
Validation loss decreased (0.186248 --> 0.176325).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.2311966
	speed: 0.0095s/iter; left time: 96.3151s
	iters: 200, epoch: 5 | loss: 0.1047880
	speed: 0.0046s/iter; left time: 46.1699s
	iters: 300, epoch: 5 | loss: 0.1404608
	speed: 0.0037s/iter; left time: 36.5762s
	iters: 400, epoch: 5 | loss: 0.0791241
	speed: 0.0042s/iter; left time: 41.5302s
	iters: 500, epoch: 5 | loss: 0.1518173
	speed: 0.0050s/iter; left time: 48.7308s
	iters: 600, epoch: 5 | loss: 0.0998625
	speed: 0.0045s/iter; left time: 43.6749s
Epoch: 5 cost time: 2.786849021911621
Epoch: 5, Steps: 640 | Train Loss: 0.1161321 Vali Loss: 0.1658789 Test Loss: 0.0816845
Validation loss decreased (0.176325 --> 0.165879).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.2412155
	speed: 0.0094s/iter; left time: 89.0502s
	iters: 200, epoch: 6 | loss: 0.0816209
	speed: 0.0042s/iter; left time: 39.6830s
	iters: 300, epoch: 6 | loss: 0.1796534
	speed: 0.0044s/iter; left time: 40.6934s
	iters: 400, epoch: 6 | loss: 0.0668954
	speed: 0.0044s/iter; left time: 40.2250s
	iters: 500, epoch: 6 | loss: 0.1835180
	speed: 0.0042s/iter; left time: 38.3943s
	iters: 600, epoch: 6 | loss: 0.2069919
	speed: 0.0048s/iter; left time: 42.7955s
Epoch: 6 cost time: 2.7905068397521973
Epoch: 6, Steps: 640 | Train Loss: 0.1156018 Vali Loss: 0.1851880 Test Loss: 0.0824880
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.0554809
	speed: 0.0095s/iter; left time: 83.8651s
	iters: 200, epoch: 7 | loss: 0.0831226
	speed: 0.0044s/iter; left time: 38.3304s
	iters: 300, epoch: 7 | loss: 0.1590751
	speed: 0.0045s/iter; left time: 39.2797s
	iters: 400, epoch: 7 | loss: 0.0904319
	speed: 0.0048s/iter; left time: 41.4435s
	iters: 500, epoch: 7 | loss: 0.0726211
	speed: 0.0044s/iter; left time: 37.0253s
	iters: 600, epoch: 7 | loss: 0.1513448
	speed: 0.0041s/iter; left time: 33.9779s
Epoch: 7 cost time: 2.7814526557922363
Epoch: 7, Steps: 640 | Train Loss: 0.1154632 Vali Loss: 0.1836550 Test Loss: 0.0844203
EarlyStopping counter: 2 out of 5
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.1053850
	speed: 0.0086s/iter; left time: 70.6520s
	iters: 200, epoch: 8 | loss: 0.1021801
	speed: 0.0034s/iter; left time: 27.9036s
	iters: 300, epoch: 8 | loss: 0.0976883
	speed: 0.0041s/iter; left time: 32.5957s
	iters: 400, epoch: 8 | loss: 0.1850044
	speed: 0.0040s/iter; left time: 31.3684s
	iters: 500, epoch: 8 | loss: 0.2118586
	speed: 0.0037s/iter; left time: 28.9267s
	iters: 600, epoch: 8 | loss: 0.1075363
	speed: 0.0044s/iter; left time: 34.1053s
Epoch: 8 cost time: 2.5001139640808105
Epoch: 8, Steps: 640 | Train Loss: 0.1153332 Vali Loss: 0.1778740 Test Loss: 0.0836555
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.0747789
	speed: 0.0104s/iter; left time: 79.0166s
	iters: 200, epoch: 9 | loss: 0.0962698
	speed: 0.0044s/iter; left time: 32.7203s
	iters: 300, epoch: 9 | loss: 0.2295508
	speed: 0.0055s/iter; left time: 40.6705s
	iters: 400, epoch: 9 | loss: 0.1333927
	speed: 0.0041s/iter; left time: 29.9591s
	iters: 500, epoch: 9 | loss: 0.1679516
	speed: 0.0041s/iter; left time: 29.6228s
	iters: 600, epoch: 9 | loss: 0.1235405
	speed: 0.0035s/iter; left time: 24.6315s
Epoch: 9 cost time: 2.787083387374878
Epoch: 9, Steps: 640 | Train Loss: 0.1152769 Vali Loss: 0.1763093 Test Loss: 0.0829605
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.1899960
	speed: 0.0065s/iter; left time: 45.2590s
	iters: 200, epoch: 10 | loss: 0.0978011
	speed: 0.0031s/iter; left time: 21.3805s
	iters: 300, epoch: 10 | loss: 0.0936314
	speed: 0.0034s/iter; left time: 23.1855s
	iters: 400, epoch: 10 | loss: 0.1193717
	speed: 0.0030s/iter; left time: 19.7157s
	iters: 500, epoch: 10 | loss: 0.0925723
	speed: 0.0025s/iter; left time: 16.3583s
	iters: 600, epoch: 10 | loss: 0.1360068
	speed: 0.0027s/iter; left time: 17.0862s
Epoch: 10 cost time: 1.866863489151001
Epoch: 10, Steps: 640 | Train Loss: 0.1152368 Vali Loss: 0.1761564 Test Loss: 0.0829905
EarlyStopping counter: 5 out of 5
Early stopping
Total training time: 31.7635 seconds
>>>>>>>testing : Exchange_96_96_DLinear_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15349<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 1422
data_set:  <data_provider.data_loader.Dataset_Custom object at 0x00000258387979B0>
mse:0.08157526701688766, mae:0.20666196942329407
