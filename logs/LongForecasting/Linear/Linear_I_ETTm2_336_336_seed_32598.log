Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='Linear', model_id='ETTm2_336_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=336, root_path='./dataset/', save_pred_values=False, seed=32598, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTm2_336_336_Linear_ETTm2_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed32598>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33889
val 11185
test 11185
	iters: 100, epoch: 1 | loss: 0.2678344
	speed: 0.0083s/iter; left time: 174.5155s
	iters: 200, epoch: 1 | loss: 0.4857451
	speed: 0.0087s/iter; left time: 183.2207s
	iters: 300, epoch: 1 | loss: 0.4640469
	speed: 0.0087s/iter; left time: 181.3009s
	iters: 400, epoch: 1 | loss: 0.5199510
	speed: 0.0096s/iter; left time: 198.9899s
	iters: 500, epoch: 1 | loss: 0.6769049
	speed: 0.0090s/iter; left time: 186.8983s
	iters: 600, epoch: 1 | loss: 0.7997007
	speed: 0.0079s/iter; left time: 162.4466s
	iters: 700, epoch: 1 | loss: 0.6329186
	speed: 0.0060s/iter; left time: 122.4563s
	iters: 800, epoch: 1 | loss: 0.5602557
	speed: 0.0075s/iter; left time: 153.3181s
	iters: 900, epoch: 1 | loss: 0.4989780
	speed: 0.0082s/iter; left time: 165.5444s
	iters: 1000, epoch: 1 | loss: 0.6734304
	speed: 0.0080s/iter; left time: 161.0973s
Epoch: 1 cost time: 8.715633392333984
Epoch: 1, Steps: 1059 | Train Loss: 0.5926243 Vali Loss: 0.4028836 Test Loss: 0.8139990
Validation loss decreased (inf --> 0.402884).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 1.1738555
	speed: 0.0353s/iter; left time: 707.5636s
	iters: 200, epoch: 2 | loss: 0.5734800
	speed: 0.0088s/iter; left time: 176.1732s
	iters: 300, epoch: 2 | loss: 0.9680287
	speed: 0.0085s/iter; left time: 168.0030s
	iters: 400, epoch: 2 | loss: 0.4642957
	speed: 0.0090s/iter; left time: 176.9364s
	iters: 500, epoch: 2 | loss: 0.4611324
	speed: 0.0087s/iter; left time: 171.3670s
	iters: 600, epoch: 2 | loss: 0.7602637
	speed: 0.0077s/iter; left time: 149.9561s
	iters: 700, epoch: 2 | loss: 0.4542332
	speed: 0.0085s/iter; left time: 165.0721s
	iters: 800, epoch: 2 | loss: 0.7921598
	speed: 0.0084s/iter; left time: 162.5512s
	iters: 900, epoch: 2 | loss: 0.3682385
	speed: 0.0083s/iter; left time: 159.0513s
	iters: 1000, epoch: 2 | loss: 0.3998345
	speed: 0.0087s/iter; left time: 165.6410s
Epoch: 2 cost time: 8.990309953689575
Epoch: 2, Steps: 1059 | Train Loss: 0.6025279 Vali Loss: 0.7793549 Test Loss: 1.7381901
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.4907674
	speed: 0.0328s/iter; left time: 621.1447s
	iters: 200, epoch: 3 | loss: 0.4598365
	speed: 0.0081s/iter; left time: 153.2302s
	iters: 300, epoch: 3 | loss: 0.3813114
	speed: 0.0066s/iter; left time: 123.4896s
	iters: 400, epoch: 3 | loss: 0.5373715
	speed: 0.0091s/iter; left time: 169.1475s
	iters: 500, epoch: 3 | loss: 0.2869958
	speed: 0.0084s/iter; left time: 156.5456s
	iters: 600, epoch: 3 | loss: 0.2900913
	speed: 0.0081s/iter; left time: 148.9682s
	iters: 700, epoch: 3 | loss: 0.3360660
	speed: 0.0083s/iter; left time: 152.8523s
	iters: 800, epoch: 3 | loss: 0.4495830
	speed: 0.0079s/iter; left time: 143.9194s
	iters: 900, epoch: 3 | loss: 0.3586436
	speed: 0.0081s/iter; left time: 147.1815s
	iters: 1000, epoch: 3 | loss: 0.4253501
	speed: 0.0089s/iter; left time: 160.8038s
Epoch: 3 cost time: 8.673882961273193
Epoch: 3, Steps: 1059 | Train Loss: 0.4352382 Vali Loss: 0.3943530 Test Loss: 0.8643332
Validation loss decreased (0.402884 --> 0.394353).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.3311902
	speed: 0.0381s/iter; left time: 682.6118s
	iters: 200, epoch: 4 | loss: 0.3426947
	speed: 0.0097s/iter; left time: 172.7248s
	iters: 300, epoch: 4 | loss: 0.6070830
	speed: 0.0099s/iter; left time: 175.6806s
	iters: 400, epoch: 4 | loss: 0.2807044
	speed: 0.0094s/iter; left time: 165.1800s
	iters: 500, epoch: 4 | loss: 0.4681953
	speed: 0.0096s/iter; left time: 168.0575s
	iters: 600, epoch: 4 | loss: 0.3175468
	speed: 0.0088s/iter; left time: 152.5589s
	iters: 700, epoch: 4 | loss: 0.3182146
	speed: 0.0092s/iter; left time: 158.7395s
	iters: 800, epoch: 4 | loss: 0.4015150
	speed: 0.0090s/iter; left time: 154.5218s
	iters: 900, epoch: 4 | loss: 0.4584009
	speed: 0.0078s/iter; left time: 133.2808s
	iters: 1000, epoch: 4 | loss: 0.3595222
	speed: 0.0075s/iter; left time: 127.0642s
Epoch: 4 cost time: 9.528351068496704
Epoch: 4, Steps: 1059 | Train Loss: 0.3944040 Vali Loss: 0.3640222 Test Loss: 0.7758737
Validation loss decreased (0.394353 --> 0.364022).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.3958204
	speed: 0.0361s/iter; left time: 608.5124s
	iters: 200, epoch: 5 | loss: 0.1438184
	speed: 0.0077s/iter; left time: 129.4966s
	iters: 300, epoch: 5 | loss: 0.7372624
	speed: 0.0081s/iter; left time: 135.0466s
	iters: 400, epoch: 5 | loss: 0.3121246
	speed: 0.0083s/iter; left time: 137.5448s
	iters: 500, epoch: 5 | loss: 0.4682565
	speed: 0.0087s/iter; left time: 142.5708s
	iters: 600, epoch: 5 | loss: 0.3477225
	speed: 0.0087s/iter; left time: 142.1687s
	iters: 700, epoch: 5 | loss: 0.3621523
	speed: 0.0081s/iter; left time: 130.9780s
	iters: 800, epoch: 5 | loss: 0.3083909
	speed: 0.0082s/iter; left time: 131.6330s
	iters: 900, epoch: 5 | loss: 0.5616096
	speed: 0.0080s/iter; left time: 127.5920s
	iters: 1000, epoch: 5 | loss: 0.4497758
	speed: 0.0089s/iter; left time: 141.7887s
Epoch: 5 cost time: 8.729223012924194
Epoch: 5, Steps: 1059 | Train Loss: 0.3739375 Vali Loss: 0.3409545 Test Loss: 0.6547818
Validation loss decreased (0.364022 --> 0.340955).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.5350165
	speed: 0.0336s/iter; left time: 530.4143s
	iters: 200, epoch: 6 | loss: 0.2107589
	speed: 0.0082s/iter; left time: 129.0119s
	iters: 300, epoch: 6 | loss: 0.2487700
	speed: 0.0083s/iter; left time: 129.3804s
	iters: 400, epoch: 6 | loss: 0.2825580
	speed: 0.0085s/iter; left time: 130.9966s
	iters: 500, epoch: 6 | loss: 0.1998453
	speed: 0.0090s/iter; left time: 138.8203s
	iters: 600, epoch: 6 | loss: 0.2811513
	speed: 0.0095s/iter; left time: 145.7046s
	iters: 700, epoch: 6 | loss: 0.8641279
	speed: 0.0093s/iter; left time: 141.4223s
	iters: 800, epoch: 6 | loss: 0.4793368
	speed: 0.0074s/iter; left time: 112.3292s
	iters: 900, epoch: 6 | loss: 0.3635360
	speed: 0.0079s/iter; left time: 118.5713s
	iters: 1000, epoch: 6 | loss: 0.3919325
	speed: 0.0064s/iter; left time: 95.4069s
Epoch: 6 cost time: 8.76030707359314
Epoch: 6, Steps: 1059 | Train Loss: 0.3617890 Vali Loss: 0.2351037 Test Loss: 0.3640406
Validation loss decreased (0.340955 --> 0.235104).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.2041881
	speed: 0.0337s/iter; left time: 496.6594s
	iters: 200, epoch: 7 | loss: 0.2643683
	speed: 0.0094s/iter; left time: 137.3873s
	iters: 300, epoch: 7 | loss: 0.3420835
	speed: 0.0086s/iter; left time: 125.0932s
	iters: 400, epoch: 7 | loss: 0.2766176
	speed: 0.0091s/iter; left time: 131.3508s
	iters: 500, epoch: 7 | loss: 0.2638586
	speed: 0.0087s/iter; left time: 124.2149s
	iters: 600, epoch: 7 | loss: 0.4001253
	speed: 0.0079s/iter; left time: 112.2708s
	iters: 700, epoch: 7 | loss: 0.3428255
	speed: 0.0084s/iter; left time: 118.7010s
	iters: 800, epoch: 7 | loss: 0.5753912
	speed: 0.0084s/iter; left time: 117.5827s
	iters: 900, epoch: 7 | loss: 0.2636785
	speed: 0.0076s/iter; left time: 106.2812s
	iters: 1000, epoch: 7 | loss: 0.1924467
	speed: 0.0075s/iter; left time: 104.2555s
Epoch: 7 cost time: 8.850088596343994
Epoch: 7, Steps: 1059 | Train Loss: 0.3555397 Vali Loss: 0.2704015 Test Loss: 0.4721545
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.3259531
	speed: 0.0316s/iter; left time: 431.7461s
	iters: 200, epoch: 8 | loss: 0.5656960
	speed: 0.0079s/iter; left time: 107.0452s
	iters: 300, epoch: 8 | loss: 0.4847024
	speed: 0.0087s/iter; left time: 116.9255s
	iters: 400, epoch: 8 | loss: 0.3152409
	speed: 0.0090s/iter; left time: 120.0784s
	iters: 500, epoch: 8 | loss: 0.3592709
	speed: 0.0083s/iter; left time: 109.5014s
	iters: 600, epoch: 8 | loss: 0.2821837
	speed: 0.0075s/iter; left time: 99.1877s
	iters: 700, epoch: 8 | loss: 0.3384651
	speed: 0.0066s/iter; left time: 86.0994s
	iters: 800, epoch: 8 | loss: 0.4728044
	speed: 0.0073s/iter; left time: 94.5758s
	iters: 900, epoch: 8 | loss: 0.4165732
	speed: 0.0079s/iter; left time: 102.0489s
	iters: 1000, epoch: 8 | loss: 0.4284395
	speed: 0.0085s/iter; left time: 108.4290s
Epoch: 8 cost time: 8.400670766830444
Epoch: 8, Steps: 1059 | Train Loss: 0.3523306 Vali Loss: 0.2893792 Test Loss: 0.5519073
EarlyStopping counter: 2 out of 5
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.3873270
	speed: 0.0383s/iter; left time: 482.5283s
	iters: 200, epoch: 9 | loss: 0.5855686
	speed: 0.0095s/iter; left time: 118.5673s
	iters: 300, epoch: 9 | loss: 0.4539788
	speed: 0.0096s/iter; left time: 118.9052s
	iters: 400, epoch: 9 | loss: 0.4970060
	speed: 0.0082s/iter; left time: 101.3346s
	iters: 500, epoch: 9 | loss: 0.3420590
	speed: 0.0084s/iter; left time: 102.6969s
	iters: 600, epoch: 9 | loss: 0.2313689
	speed: 0.0089s/iter; left time: 107.6055s
	iters: 700, epoch: 9 | loss: 0.4950623
	speed: 0.0081s/iter; left time: 97.5458s
	iters: 800, epoch: 9 | loss: 0.5829124
	speed: 0.0074s/iter; left time: 88.6326s
	iters: 900, epoch: 9 | loss: 0.3849816
	speed: 0.0073s/iter; left time: 86.3233s
	iters: 1000, epoch: 9 | loss: 0.3699496
	speed: 0.0074s/iter; left time: 86.4259s
Epoch: 9 cost time: 8.849947929382324
Epoch: 9, Steps: 1059 | Train Loss: 0.3503002 Vali Loss: 0.3027229 Test Loss: 0.5849681
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.4205612
	speed: 0.0328s/iter; left time: 378.9483s
	iters: 200, epoch: 10 | loss: 0.2490537
	speed: 0.0085s/iter; left time: 97.7471s
	iters: 300, epoch: 10 | loss: 0.2413036
	speed: 0.0083s/iter; left time: 94.5935s
	iters: 400, epoch: 10 | loss: 0.2280604
	speed: 0.0084s/iter; left time: 94.9800s
	iters: 500, epoch: 10 | loss: 0.2406509
	speed: 0.0083s/iter; left time: 92.6662s
	iters: 600, epoch: 10 | loss: 0.2159158
	speed: 0.0087s/iter; left time: 95.9320s
	iters: 700, epoch: 10 | loss: 0.3407008
	speed: 0.0077s/iter; left time: 84.4180s
	iters: 800, epoch: 10 | loss: 0.2347556
	speed: 0.0076s/iter; left time: 82.5837s
	iters: 900, epoch: 10 | loss: 0.1987009
	speed: 0.0071s/iter; left time: 76.6702s
	iters: 1000, epoch: 10 | loss: 0.3607232
	speed: 0.0072s/iter; left time: 77.1961s
Epoch: 10 cost time: 8.449196100234985
Epoch: 10, Steps: 1059 | Train Loss: 0.3492529 Vali Loss: 0.2813873 Test Loss: 0.5230591
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.1651169
	speed: 0.0327s/iter; left time: 343.0235s
	iters: 200, epoch: 11 | loss: 0.4670219
	speed: 0.0086s/iter; left time: 89.3789s
	iters: 300, epoch: 11 | loss: 0.4438098
	speed: 0.0084s/iter; left time: 86.1358s
	iters: 400, epoch: 11 | loss: 0.3461822
	speed: 0.0085s/iter; left time: 87.0666s
	iters: 500, epoch: 11 | loss: 0.4292324
	speed: 0.0088s/iter; left time: 88.6540s
	iters: 600, epoch: 11 | loss: 0.3415174
	speed: 0.0082s/iter; left time: 81.6659s
	iters: 700, epoch: 11 | loss: 0.3376278
	speed: 0.0087s/iter; left time: 85.9894s
	iters: 800, epoch: 11 | loss: 0.6031910
	speed: 0.0076s/iter; left time: 74.0527s
	iters: 900, epoch: 11 | loss: 0.2973467
	speed: 0.0078s/iter; left time: 76.0563s
	iters: 1000, epoch: 11 | loss: 0.3081153
	speed: 0.0085s/iter; left time: 81.2511s
Epoch: 11 cost time: 8.861433744430542
Epoch: 11, Steps: 1059 | Train Loss: 0.3487707 Vali Loss: 0.2863046 Test Loss: 0.5404806
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTm2_336_336_Linear_ETTm2_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed32598<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
mse:0.36434847116470337, mae:0.38882210850715637
