Args in experiment:
Namespace(activation='gelu', batch_size=8, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='exchange_rate.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=8, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='mse', lradj='type1', model='DLinear', model_id='Exchange_336_192', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=192, root_path='./dataset/', save_pred_values=False, seed=15726, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : Exchange_336_192_DLinear_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15726>>>>>>>>>>>>>>>>>>>>>>>>>>
train 4784
val 569
test 1326
	iters: 100, epoch: 1 | loss: 0.2319523
	speed: 0.0091s/iter; left time: 107.7160s
	iters: 200, epoch: 1 | loss: 0.3213037
	speed: 0.0085s/iter; left time: 99.4129s
	iters: 300, epoch: 1 | loss: 0.2139525
	speed: 0.0087s/iter; left time: 100.8917s
	iters: 400, epoch: 1 | loss: 0.1688875
	speed: 0.0075s/iter; left time: 86.7136s
	iters: 500, epoch: 1 | loss: 0.2334691
	speed: 0.0078s/iter; left time: 88.9121s
Epoch: 1 cost time: 4.941467761993408
Epoch: 1, Steps: 598 | Train Loss: 0.2671405 Vali Loss: 0.4325291 Test Loss: 0.2133182
Validation loss decreased (inf --> 0.432529).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.3997209
	speed: 0.0179s/iter; left time: 201.3635s
	iters: 200, epoch: 2 | loss: 0.1688572
	speed: 0.0058s/iter; left time: 64.2204s
	iters: 300, epoch: 2 | loss: 0.1891849
	speed: 0.0075s/iter; left time: 82.4526s
	iters: 400, epoch: 2 | loss: 0.1948339
	speed: 0.0081s/iter; left time: 88.8000s
	iters: 500, epoch: 2 | loss: 0.2010580
	speed: 0.0073s/iter; left time: 78.7715s
Epoch: 2 cost time: 4.305508375167847
Epoch: 2, Steps: 598 | Train Loss: 0.2295911 Vali Loss: 0.4410803 Test Loss: 0.2277934
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.2476354
	speed: 0.0179s/iter; left time: 191.0550s
	iters: 200, epoch: 3 | loss: 0.1609500
	speed: 0.0079s/iter; left time: 83.7340s
	iters: 300, epoch: 3 | loss: 0.1322576
	speed: 0.0074s/iter; left time: 77.3587s
	iters: 400, epoch: 3 | loss: 0.1927171
	speed: 0.0085s/iter; left time: 88.0926s
	iters: 500, epoch: 3 | loss: 0.2729878
	speed: 0.0082s/iter; left time: 84.3908s
Epoch: 3 cost time: 4.7192065715789795
Epoch: 3, Steps: 598 | Train Loss: 0.2187055 Vali Loss: 0.5078804 Test Loss: 0.2064185
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.2118498
	speed: 0.0212s/iter; left time: 213.4567s
	iters: 200, epoch: 4 | loss: 0.1766108
	speed: 0.0086s/iter; left time: 85.5248s
	iters: 300, epoch: 4 | loss: 0.2425835
	speed: 0.0086s/iter; left time: 85.2760s
	iters: 400, epoch: 4 | loss: 0.1621792
	speed: 0.0087s/iter; left time: 85.3938s
	iters: 500, epoch: 4 | loss: 0.2611898
	speed: 0.0087s/iter; left time: 83.6375s
Epoch: 4 cost time: 5.196449518203735
Epoch: 4, Steps: 598 | Train Loss: 0.2136314 Vali Loss: 0.5332170 Test Loss: 0.2091025
EarlyStopping counter: 3 out of 5
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.2402458
	speed: 0.0218s/iter; left time: 206.0932s
	iters: 200, epoch: 5 | loss: 0.3165449
	speed: 0.0061s/iter; left time: 57.2540s
	iters: 300, epoch: 5 | loss: 0.2788191
	speed: 0.0089s/iter; left time: 82.6797s
	iters: 400, epoch: 5 | loss: 0.2763925
	speed: 0.0087s/iter; left time: 80.1649s
	iters: 500, epoch: 5 | loss: 0.1393502
	speed: 0.0086s/iter; left time: 78.0322s
Epoch: 5 cost time: 4.710402250289917
Epoch: 5, Steps: 598 | Train Loss: 0.2109041 Vali Loss: 0.4448694 Test Loss: 0.1869404
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.2854560
	speed: 0.0170s/iter; left time: 150.4899s
	iters: 200, epoch: 6 | loss: 0.2345707
	speed: 0.0086s/iter; left time: 75.0208s
	iters: 300, epoch: 6 | loss: 0.3867469
	speed: 0.0083s/iter; left time: 72.0805s
	iters: 400, epoch: 6 | loss: 0.1622588
	speed: 0.0076s/iter; left time: 64.9592s
	iters: 500, epoch: 6 | loss: 0.2262037
	speed: 0.0088s/iter; left time: 74.9200s
Epoch: 6 cost time: 4.952188014984131
Epoch: 6, Steps: 598 | Train Loss: 0.2097126 Vali Loss: 0.4761387 Test Loss: 0.1927148
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : Exchange_336_192_DLinear_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15726<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 1326
mse:0.21315376460552216, mae:0.3409583866596222
