Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='Linear', model_id='Electricity_336_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=336, root_path='./dataset/', save_pred_values=False, seed=25565, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : Electricity_336_336_Linear_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed25565>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17741
val 2297
test 4925
	iters: 100, epoch: 1 | loss: 0.2216945
	speed: 0.0996s/iter; left time: 2196.9785s
	iters: 200, epoch: 1 | loss: 0.2224422
	speed: 0.0848s/iter; left time: 1862.1470s
	iters: 300, epoch: 1 | loss: 0.2423524
	speed: 0.0854s/iter; left time: 1866.7878s
	iters: 400, epoch: 1 | loss: 0.2391362
	speed: 0.0844s/iter; left time: 1836.8187s
	iters: 500, epoch: 1 | loss: 0.2165226
	speed: 0.0857s/iter; left time: 1856.2818s
	iters: 600, epoch: 1 | loss: 0.2511382
	speed: 0.0850s/iter; left time: 1833.7333s
	iters: 700, epoch: 1 | loss: 0.1976369
	speed: 0.0851s/iter; left time: 1826.0034s
	iters: 800, epoch: 1 | loss: 0.2416905
	speed: 0.0859s/iter; left time: 1834.5925s
	iters: 900, epoch: 1 | loss: 0.2354974
	speed: 0.0841s/iter; left time: 1787.6245s
	iters: 1000, epoch: 1 | loss: 0.2045263
	speed: 0.0845s/iter; left time: 1789.0756s
	iters: 1100, epoch: 1 | loss: 0.2398288
	speed: 0.0877s/iter; left time: 1846.5874s
Epoch: 1 cost time: 95.96067643165588
Epoch: 1, Steps: 1108 | Train Loss: 0.2513994 Vali Loss: 0.2211614 Test Loss: 0.2465461
Validation loss decreased (inf --> 0.221161).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.2392059
	speed: 0.2377s/iter; left time: 4980.5705s
	iters: 200, epoch: 2 | loss: 0.2707105
	speed: 0.0839s/iter; left time: 1749.7897s
	iters: 300, epoch: 2 | loss: 0.2443828
	speed: 0.0843s/iter; left time: 1749.1236s
	iters: 400, epoch: 2 | loss: 0.2394089
	speed: 0.0845s/iter; left time: 1745.4200s
	iters: 500, epoch: 2 | loss: 0.2381974
	speed: 0.0840s/iter; left time: 1726.7893s
	iters: 600, epoch: 2 | loss: 0.2416339
	speed: 0.0834s/iter; left time: 1706.4055s
	iters: 700, epoch: 2 | loss: 0.2489761
	speed: 0.0837s/iter; left time: 1704.5405s
	iters: 800, epoch: 2 | loss: 0.2530099
	speed: 0.0839s/iter; left time: 1699.7631s
	iters: 900, epoch: 2 | loss: 0.2670034
	speed: 0.0845s/iter; left time: 1703.1645s
	iters: 1000, epoch: 2 | loss: 0.2347901
	speed: 0.0862s/iter; left time: 1729.3551s
	iters: 1100, epoch: 2 | loss: 0.2432829
	speed: 0.0844s/iter; left time: 1683.5136s
Epoch: 2 cost time: 93.43495774269104
Epoch: 2, Steps: 1108 | Train Loss: 0.2440681 Vali Loss: 0.2144625 Test Loss: 0.2451565
Validation loss decreased (0.221161 --> 0.214463).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.1921507
	speed: 0.2429s/iter; left time: 4819.3903s
	iters: 200, epoch: 3 | loss: 0.1891475
	speed: 0.0858s/iter; left time: 1693.1838s
	iters: 300, epoch: 3 | loss: 0.1707464
	speed: 0.0855s/iter; left time: 1680.3590s
	iters: 400, epoch: 3 | loss: 0.1872262
	speed: 0.0853s/iter; left time: 1667.0312s
	iters: 500, epoch: 3 | loss: 0.1824628
	speed: 0.0856s/iter; left time: 1665.2976s
	iters: 600, epoch: 3 | loss: 0.1976943
	speed: 0.0855s/iter; left time: 1653.6940s
	iters: 700, epoch: 3 | loss: 0.2110559
	speed: 0.0862s/iter; left time: 1659.2174s
	iters: 800, epoch: 3 | loss: 0.2117779
	speed: 0.0859s/iter; left time: 1644.3746s
	iters: 900, epoch: 3 | loss: 0.2476444
	speed: 0.0848s/iter; left time: 1614.6844s
	iters: 1000, epoch: 3 | loss: 0.1950095
	speed: 0.0851s/iter; left time: 1612.6269s
	iters: 1100, epoch: 3 | loss: 0.1807182
	speed: 0.0854s/iter; left time: 1609.0757s
Epoch: 3 cost time: 94.80672311782837
Epoch: 3, Steps: 1108 | Train Loss: 0.1961406 Vali Loss: 0.1761539 Test Loss: 0.2035064
Validation loss decreased (0.214463 --> 0.176154).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.1707673
	speed: 0.2462s/iter; left time: 4613.3628s
	iters: 200, epoch: 4 | loss: 0.1908675
	speed: 0.0853s/iter; left time: 1589.6705s
	iters: 300, epoch: 4 | loss: 0.1924343
	speed: 0.0850s/iter; left time: 1576.5585s
	iters: 400, epoch: 4 | loss: 0.1741872
	speed: 0.0854s/iter; left time: 1574.4992s
	iters: 500, epoch: 4 | loss: 0.1706848
	speed: 0.0854s/iter; left time: 1566.8735s
	iters: 600, epoch: 4 | loss: 0.1922616
	speed: 0.0854s/iter; left time: 1557.7103s
	iters: 700, epoch: 4 | loss: 0.2090708
	speed: 0.0845s/iter; left time: 1532.8769s
	iters: 800, epoch: 4 | loss: 0.1858244
	speed: 0.0856s/iter; left time: 1543.1241s
	iters: 900, epoch: 4 | loss: 0.1516841
	speed: 0.0857s/iter; left time: 1537.5128s
	iters: 1000, epoch: 4 | loss: 0.1800862
	speed: 0.0860s/iter; left time: 1533.6781s
	iters: 1100, epoch: 4 | loss: 0.1578935
	speed: 0.0852s/iter; left time: 1512.0350s
Epoch: 4 cost time: 94.836740732193
Epoch: 4, Steps: 1108 | Train Loss: 0.1787606 Vali Loss: 0.1563697 Test Loss: 0.1823136
Validation loss decreased (0.176154 --> 0.156370).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.1811543
	speed: 0.2482s/iter; left time: 4375.6691s
	iters: 200, epoch: 5 | loss: 0.2011194
	speed: 0.0875s/iter; left time: 1534.4286s
	iters: 300, epoch: 5 | loss: 0.1790008
	speed: 0.0846s/iter; left time: 1475.3345s
	iters: 400, epoch: 5 | loss: 0.1641339
	speed: 0.0849s/iter; left time: 1472.0579s
	iters: 500, epoch: 5 | loss: 0.1682340
	speed: 0.0841s/iter; left time: 1449.1666s
	iters: 600, epoch: 5 | loss: 0.1548552
	speed: 0.0842s/iter; left time: 1441.8223s
	iters: 700, epoch: 5 | loss: 0.2084172
	speed: 0.0847s/iter; left time: 1443.1618s
	iters: 800, epoch: 5 | loss: 0.1489256
	speed: 0.0847s/iter; left time: 1433.4986s
	iters: 900, epoch: 5 | loss: 0.2343872
	speed: 0.0846s/iter; left time: 1423.5492s
	iters: 1000, epoch: 5 | loss: 0.1496267
	speed: 0.0839s/iter; left time: 1404.1808s
	iters: 1100, epoch: 5 | loss: 0.1686386
	speed: 0.0845s/iter; left time: 1405.2801s
Epoch: 5 cost time: 94.38862800598145
Epoch: 5, Steps: 1108 | Train Loss: 0.1698545 Vali Loss: 0.1488125 Test Loss: 0.1742646
Validation loss decreased (0.156370 --> 0.148812).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.1555378
	speed: 0.2450s/iter; left time: 4047.9217s
	iters: 200, epoch: 6 | loss: 0.1516771
	speed: 0.0860s/iter; left time: 1412.4722s
	iters: 300, epoch: 6 | loss: 0.1764564
	speed: 0.0855s/iter; left time: 1394.9338s
	iters: 400, epoch: 6 | loss: 0.1640021
	speed: 0.0848s/iter; left time: 1374.9995s
	iters: 500, epoch: 6 | loss: 0.1795852
	speed: 0.0848s/iter; left time: 1367.4527s
	iters: 600, epoch: 6 | loss: 0.1599176
	speed: 0.0851s/iter; left time: 1363.6323s
	iters: 700, epoch: 6 | loss: 0.2042489
	speed: 0.0844s/iter; left time: 1343.2559s
	iters: 800, epoch: 6 | loss: 0.2161698
	speed: 0.0842s/iter; left time: 1332.7252s
	iters: 900, epoch: 6 | loss: 0.1563390
	speed: 0.0850s/iter; left time: 1336.1610s
	iters: 1000, epoch: 6 | loss: 0.1587591
	speed: 0.0851s/iter; left time: 1329.9424s
	iters: 1100, epoch: 6 | loss: 0.1827322
	speed: 0.0857s/iter; left time: 1330.6419s
Epoch: 6 cost time: 94.58299136161804
Epoch: 6, Steps: 1108 | Train Loss: 0.1650876 Vali Loss: 0.1444533 Test Loss: 0.1694352
Validation loss decreased (0.148812 --> 0.144453).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.1331372
	speed: 0.2425s/iter; left time: 3737.8818s
	iters: 200, epoch: 7 | loss: 0.1461521
	speed: 0.0846s/iter; left time: 1294.9786s
	iters: 300, epoch: 7 | loss: 0.1460002
	speed: 0.0849s/iter; left time: 1291.0709s
	iters: 400, epoch: 7 | loss: 0.1408147
	speed: 0.0856s/iter; left time: 1293.3471s
	iters: 500, epoch: 7 | loss: 0.1488798
	speed: 0.0852s/iter; left time: 1278.7341s
	iters: 600, epoch: 7 | loss: 0.1603321
	speed: 0.0844s/iter; left time: 1259.3491s
	iters: 700, epoch: 7 | loss: 0.1502838
	speed: 0.0841s/iter; left time: 1245.3827s
	iters: 800, epoch: 7 | loss: 0.2182755
	speed: 0.0855s/iter; left time: 1257.8493s
	iters: 900, epoch: 7 | loss: 0.1378376
	speed: 0.0851s/iter; left time: 1244.1270s
	iters: 1000, epoch: 7 | loss: 0.1492301
	speed: 0.0848s/iter; left time: 1231.0034s
	iters: 1100, epoch: 7 | loss: 0.1518754
	speed: 0.0849s/iter; left time: 1223.7270s
Epoch: 7 cost time: 94.11375713348389
Epoch: 7, Steps: 1108 | Train Loss: 0.1624931 Vali Loss: 0.1423176 Test Loss: 0.1672207
Validation loss decreased (0.144453 --> 0.142318).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.1566955
	speed: 0.2442s/iter; left time: 3493.9535s
	iters: 200, epoch: 8 | loss: 0.1988041
	speed: 0.0863s/iter; left time: 1225.9359s
	iters: 300, epoch: 8 | loss: 0.1412766
	speed: 0.0865s/iter; left time: 1219.3928s
	iters: 400, epoch: 8 | loss: 0.1793984
	speed: 0.0889s/iter; left time: 1244.4171s
	iters: 500, epoch: 8 | loss: 0.1404177
	speed: 0.0892s/iter; left time: 1239.9218s
	iters: 600, epoch: 8 | loss: 0.1844130
	speed: 0.0865s/iter; left time: 1194.1139s
	iters: 700, epoch: 8 | loss: 0.1564189
	speed: 0.0856s/iter; left time: 1173.2665s
	iters: 800, epoch: 8 | loss: 0.1920288
	speed: 0.0845s/iter; left time: 1149.9996s
	iters: 900, epoch: 8 | loss: 0.1854702
	speed: 0.0847s/iter; left time: 1143.5918s
	iters: 1000, epoch: 8 | loss: 0.1801984
	speed: 0.0844s/iter; left time: 1131.1879s
	iters: 1100, epoch: 8 | loss: 0.1980235
	speed: 0.0850s/iter; left time: 1131.4347s
Epoch: 8 cost time: 95.54356694221497
Epoch: 8, Steps: 1108 | Train Loss: 0.1611191 Vali Loss: 0.1417418 Test Loss: 0.1661078
Validation loss decreased (0.142318 --> 0.141742).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.1346341
	speed: 0.2405s/iter; left time: 3173.7852s
	iters: 200, epoch: 9 | loss: 0.1950681
	speed: 0.0835s/iter; left time: 1093.4593s
	iters: 300, epoch: 9 | loss: 0.1400947
	speed: 0.0848s/iter; left time: 1102.1801s
	iters: 400, epoch: 9 | loss: 0.2016694
	speed: 0.0873s/iter; left time: 1125.5215s
	iters: 500, epoch: 9 | loss: 0.1817224
	speed: 0.0881s/iter; left time: 1127.1398s
	iters: 600, epoch: 9 | loss: 0.1730117
	speed: 0.0880s/iter; left time: 1117.5102s
	iters: 700, epoch: 9 | loss: 0.1801945
	speed: 0.0850s/iter; left time: 1070.4988s
	iters: 800, epoch: 9 | loss: 0.1555338
	speed: 0.0846s/iter; left time: 1057.2298s
	iters: 900, epoch: 9 | loss: 0.1728063
	speed: 0.0852s/iter; left time: 1056.6192s
	iters: 1000, epoch: 9 | loss: 0.1578452
	speed: 0.0852s/iter; left time: 1048.1636s
	iters: 1100, epoch: 9 | loss: 0.1363827
	speed: 0.0854s/iter; left time: 1041.6452s
Epoch: 9 cost time: 94.94532942771912
Epoch: 9, Steps: 1108 | Train Loss: 0.1603505 Vali Loss: 0.1412929 Test Loss: 0.1657558
Validation loss decreased (0.141742 --> 0.141293).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.1529649
	speed: 0.2408s/iter; left time: 2911.4409s
	iters: 200, epoch: 10 | loss: 0.1421140
	speed: 0.0853s/iter; left time: 1022.2409s
	iters: 300, epoch: 10 | loss: 0.1727165
	speed: 0.0856s/iter; left time: 1017.8197s
	iters: 400, epoch: 10 | loss: 0.1977870
	speed: 0.0860s/iter; left time: 1013.7381s
	iters: 500, epoch: 10 | loss: 0.1533459
	speed: 0.0869s/iter; left time: 1016.3163s
	iters: 600, epoch: 10 | loss: 0.1531336
	speed: 0.0863s/iter; left time: 1000.6891s
	iters: 700, epoch: 10 | loss: 0.1385221
	speed: 0.0865s/iter; left time: 994.3699s
	iters: 800, epoch: 10 | loss: 0.1570469
	speed: 0.0858s/iter; left time: 977.1802s
	iters: 900, epoch: 10 | loss: 0.1716591
	speed: 0.0835s/iter; left time: 942.9783s
	iters: 1000, epoch: 10 | loss: 0.1497730
	speed: 0.0841s/iter; left time: 940.6728s
	iters: 1100, epoch: 10 | loss: 0.2044987
	speed: 0.0849s/iter; left time: 941.7223s
Epoch: 10 cost time: 94.85967350006104
Epoch: 10, Steps: 1108 | Train Loss: 0.1599925 Vali Loss: 0.1410154 Test Loss: 0.1654030
Validation loss decreased (0.141293 --> 0.141015).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.1514925
	speed: 0.2419s/iter; left time: 2656.7547s
	iters: 200, epoch: 11 | loss: 0.1671324
	speed: 0.0849s/iter; left time: 923.8009s
	iters: 300, epoch: 11 | loss: 0.1271114
	speed: 0.0845s/iter; left time: 910.6952s
	iters: 400, epoch: 11 | loss: 0.1625583
	speed: 0.0846s/iter; left time: 903.6006s
	iters: 500, epoch: 11 | loss: 0.1363740
	speed: 0.0852s/iter; left time: 901.8660s
	iters: 600, epoch: 11 | loss: 0.1662782
	speed: 0.0865s/iter; left time: 906.8516s
	iters: 700, epoch: 11 | loss: 0.1426598
	speed: 0.0904s/iter; left time: 938.7319s
	iters: 800, epoch: 11 | loss: 0.1476936
	speed: 0.0888s/iter; left time: 912.5873s
	iters: 900, epoch: 11 | loss: 0.1386103
	speed: 0.0885s/iter; left time: 900.6417s
	iters: 1000, epoch: 11 | loss: 0.1189685
	speed: 0.0844s/iter; left time: 850.7835s
	iters: 1100, epoch: 11 | loss: 0.1698956
	speed: 0.0843s/iter; left time: 840.9299s
Epoch: 11 cost time: 95.44834041595459
Epoch: 11, Steps: 1108 | Train Loss: 0.1597679 Vali Loss: 0.1407527 Test Loss: 0.1651770
Validation loss decreased (0.141015 --> 0.140753).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.1767062
	speed: 0.2383s/iter; left time: 2353.1942s
	iters: 200, epoch: 12 | loss: 0.1887186
	speed: 0.0846s/iter; left time: 826.8544s
	iters: 300, epoch: 12 | loss: 0.1299375
	speed: 0.0847s/iter; left time: 818.8738s
	iters: 400, epoch: 12 | loss: 0.1389257
	speed: 0.0845s/iter; left time: 809.0384s
	iters: 500, epoch: 12 | loss: 0.1468253
	speed: 0.0844s/iter; left time: 799.8599s
	iters: 600, epoch: 12 | loss: 0.1571356
	speed: 0.0850s/iter; left time: 796.7722s
	iters: 700, epoch: 12 | loss: 0.1482763
	speed: 0.0854s/iter; left time: 792.3760s
	iters: 800, epoch: 12 | loss: 0.1662940
	speed: 0.0867s/iter; left time: 795.4920s
	iters: 900, epoch: 12 | loss: 0.1536428
	speed: 0.0875s/iter; left time: 793.9283s
	iters: 1000, epoch: 12 | loss: 0.1592327
	speed: 0.0865s/iter; left time: 776.5287s
	iters: 1100, epoch: 12 | loss: 0.1565306
	speed: 0.0864s/iter; left time: 766.4376s
Epoch: 12 cost time: 94.760582447052
Epoch: 12, Steps: 1108 | Train Loss: 0.1596883 Vali Loss: 0.1407170 Test Loss: 0.1650681
Validation loss decreased (0.140753 --> 0.140717).  Saving model ...
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.1399872
	speed: 0.2416s/iter; left time: 2117.9761s
	iters: 200, epoch: 13 | loss: 0.1632771
	speed: 0.0862s/iter; left time: 746.7287s
	iters: 300, epoch: 13 | loss: 0.1500716
	speed: 0.0847s/iter; left time: 725.3154s
	iters: 400, epoch: 13 | loss: 0.1764069
	speed: 0.0855s/iter; left time: 723.5059s
	iters: 500, epoch: 13 | loss: 0.1827622
	speed: 0.0856s/iter; left time: 716.0486s
	iters: 600, epoch: 13 | loss: 0.1411678
	speed: 0.0856s/iter; left time: 707.4952s
	iters: 700, epoch: 13 | loss: 0.1816997
	speed: 0.0855s/iter; left time: 698.2621s
	iters: 800, epoch: 13 | loss: 0.1749930
	speed: 0.0858s/iter; left time: 692.0889s
	iters: 900, epoch: 13 | loss: 0.1717261
	speed: 0.0902s/iter; left time: 718.7161s
	iters: 1000, epoch: 13 | loss: 0.1483627
	speed: 0.0865s/iter; left time: 680.5796s
	iters: 1100, epoch: 13 | loss: 0.1522506
	speed: 0.0854s/iter; left time: 663.4595s
Epoch: 13 cost time: 95.4173800945282
Epoch: 13, Steps: 1108 | Train Loss: 0.1596040 Vali Loss: 0.1406979 Test Loss: 0.1650835
Validation loss decreased (0.140717 --> 0.140698).  Saving model ...
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.1601391
	speed: 0.2409s/iter; left time: 1844.8462s
	iters: 200, epoch: 14 | loss: 0.1422927
	speed: 0.0847s/iter; left time: 640.4452s
	iters: 300, epoch: 14 | loss: 0.1581664
	speed: 0.0854s/iter; left time: 636.5348s
	iters: 400, epoch: 14 | loss: 0.1384965
	speed: 0.0854s/iter; left time: 628.0501s
	iters: 500, epoch: 14 | loss: 0.1713937
	speed: 0.0861s/iter; left time: 625.1001s
	iters: 600, epoch: 14 | loss: 0.1625144
	speed: 0.0843s/iter; left time: 603.2767s
	iters: 700, epoch: 14 | loss: 0.1390534
	speed: 0.0851s/iter; left time: 600.2730s
	iters: 800, epoch: 14 | loss: 0.1719468
	speed: 0.0862s/iter; left time: 599.8911s
	iters: 900, epoch: 14 | loss: 0.1474212
	speed: 0.0855s/iter; left time: 586.0837s
	iters: 1000, epoch: 14 | loss: 0.1572352
	speed: 0.0883s/iter; left time: 596.3802s
	iters: 1100, epoch: 14 | loss: 0.1498708
	speed: 0.0881s/iter; left time: 586.3539s
Epoch: 14 cost time: 95.27412748336792
Epoch: 14, Steps: 1108 | Train Loss: 0.1595571 Vali Loss: 0.1406952 Test Loss: 0.1650961
Validation loss decreased (0.140698 --> 0.140695).  Saving model ...
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.1490900
	speed: 0.2429s/iter; left time: 1590.7614s
	iters: 200, epoch: 15 | loss: 0.1580031
	speed: 0.0827s/iter; left time: 533.5486s
	iters: 300, epoch: 15 | loss: 0.1627732
	speed: 0.0851s/iter; left time: 540.5653s
	iters: 400, epoch: 15 | loss: 0.1965539
	speed: 0.0847s/iter; left time: 528.9801s
	iters: 500, epoch: 15 | loss: 0.1372638
	speed: 0.0845s/iter; left time: 519.4041s
	iters: 600, epoch: 15 | loss: 0.1685212
	speed: 0.0845s/iter; left time: 511.3475s
	iters: 700, epoch: 15 | loss: 0.1422448
	speed: 0.0837s/iter; left time: 498.0540s
	iters: 800, epoch: 15 | loss: 0.1438870
	speed: 0.0839s/iter; left time: 490.9271s
	iters: 900, epoch: 15 | loss: 0.1750089
	speed: 0.0833s/iter; left time: 479.0721s
	iters: 1000, epoch: 15 | loss: 0.1590521
	speed: 0.0841s/iter; left time: 474.8418s
	iters: 1100, epoch: 15 | loss: 0.1312616
	speed: 0.0853s/iter; left time: 473.5659s
Epoch: 15 cost time: 93.25995755195618
Epoch: 15, Steps: 1108 | Train Loss: 0.1595293 Vali Loss: 0.1406976 Test Loss: 0.1650961
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.1553387
	speed: 0.2313s/iter; left time: 1258.6410s
	iters: 200, epoch: 16 | loss: 0.1440955
	speed: 0.0846s/iter; left time: 452.1054s
	iters: 300, epoch: 16 | loss: 0.1412957
	speed: 0.0842s/iter; left time: 441.1384s
	iters: 400, epoch: 16 | loss: 0.1633489
	speed: 0.0844s/iter; left time: 433.8495s
	iters: 500, epoch: 16 | loss: 0.1716798
	speed: 0.0847s/iter; left time: 426.7524s
	iters: 600, epoch: 16 | loss: 0.2013243
	speed: 0.0850s/iter; left time: 420.0589s
	iters: 700, epoch: 16 | loss: 0.1693719
	speed: 0.0851s/iter; left time: 412.0186s
	iters: 800, epoch: 16 | loss: 0.1423600
	speed: 0.0848s/iter; left time: 402.2724s
	iters: 900, epoch: 16 | loss: 0.1567280
	speed: 0.0855s/iter; left time: 396.7873s
	iters: 1000, epoch: 16 | loss: 0.1914190
	speed: 0.0849s/iter; left time: 385.3924s
	iters: 1100, epoch: 16 | loss: 0.1475115
	speed: 0.0853s/iter; left time: 378.7632s
Epoch: 16 cost time: 94.26716899871826
Epoch: 16, Steps: 1108 | Train Loss: 0.1595294 Vali Loss: 0.1406804 Test Loss: 0.1650948
Validation loss decreased (0.140695 --> 0.140680).  Saving model ...
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 17 | loss: 0.1674140
	speed: 0.2454s/iter; left time: 1063.4458s
	iters: 200, epoch: 17 | loss: 0.1453767
	speed: 0.0863s/iter; left time: 365.1058s
	iters: 300, epoch: 17 | loss: 0.1504656
	speed: 0.0860s/iter; left time: 355.4038s
	iters: 400, epoch: 17 | loss: 0.1492302
	speed: 0.0848s/iter; left time: 341.8347s
	iters: 500, epoch: 17 | loss: 0.1825032
	speed: 0.0856s/iter; left time: 336.5367s
	iters: 600, epoch: 17 | loss: 0.2002475
	speed: 0.0853s/iter; left time: 326.8396s
	iters: 700, epoch: 17 | loss: 0.2060180
	speed: 0.0858s/iter; left time: 320.2230s
	iters: 800, epoch: 17 | loss: 0.1519865
	speed: 0.0854s/iter; left time: 310.2340s
	iters: 900, epoch: 17 | loss: 0.1372270
	speed: 0.0846s/iter; left time: 298.9145s
	iters: 1000, epoch: 17 | loss: 0.2045175
	speed: 0.0848s/iter; left time: 291.1092s
	iters: 1100, epoch: 17 | loss: 0.1406316
	speed: 0.0849s/iter; left time: 282.9570s
Epoch: 17 cost time: 94.91178822517395
Epoch: 17, Steps: 1108 | Train Loss: 0.1595338 Vali Loss: 0.1407387 Test Loss: 0.1650945
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 18 | loss: 0.1731354
	speed: 0.2291s/iter; left time: 738.9194s
	iters: 200, epoch: 18 | loss: 0.1770553
	speed: 0.0884s/iter; left time: 276.1550s
	iters: 300, epoch: 18 | loss: 0.1590302
	speed: 0.0877s/iter; left time: 265.1880s
	iters: 400, epoch: 18 | loss: 0.1531102
	speed: 0.0897s/iter; left time: 262.3124s
	iters: 500, epoch: 18 | loss: 0.1724272
	speed: 0.0846s/iter; left time: 239.0855s
	iters: 600, epoch: 18 | loss: 0.1907660
	speed: 0.0854s/iter; left time: 232.8013s
	iters: 700, epoch: 18 | loss: 0.1803399
	speed: 0.0844s/iter; left time: 221.4503s
	iters: 800, epoch: 18 | loss: 0.1511959
	speed: 0.0850s/iter; left time: 214.6988s
	iters: 900, epoch: 18 | loss: 0.1717040
	speed: 0.0857s/iter; left time: 207.9319s
	iters: 1000, epoch: 18 | loss: 0.1523618
	speed: 0.0847s/iter; left time: 196.9093s
	iters: 1100, epoch: 18 | loss: 0.1609545
	speed: 0.0845s/iter; left time: 188.0797s
Epoch: 18 cost time: 95.55105233192444
Epoch: 18, Steps: 1108 | Train Loss: 0.1595359 Vali Loss: 0.1406280 Test Loss: 0.1650944
Validation loss decreased (0.140680 --> 0.140628).  Saving model ...
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 19 | loss: 0.1701057
	speed: 0.2437s/iter; left time: 515.9799s
	iters: 200, epoch: 19 | loss: 0.1642442
	speed: 0.0857s/iter; left time: 172.7890s
	iters: 300, epoch: 19 | loss: 0.1868111
	speed: 0.0898s/iter; left time: 172.2138s
	iters: 400, epoch: 19 | loss: 0.1568430
	speed: 0.0862s/iter; left time: 156.6537s
	iters: 500, epoch: 19 | loss: 0.1649605
	speed: 0.0868s/iter; left time: 148.9803s
	iters: 600, epoch: 19 | loss: 0.1426895
	speed: 0.0844s/iter; left time: 136.4862s
	iters: 700, epoch: 19 | loss: 0.1376056
	speed: 0.0850s/iter; left time: 128.9131s
	iters: 800, epoch: 19 | loss: 0.1904258
	speed: 0.0854s/iter; left time: 120.9514s
	iters: 900, epoch: 19 | loss: 0.1864010
	speed: 0.0850s/iter; left time: 111.9369s
	iters: 1000, epoch: 19 | loss: 0.1701338
	speed: 0.0844s/iter; left time: 102.6649s
	iters: 1100, epoch: 19 | loss: 0.1324868
	speed: 0.0849s/iter; left time: 94.8127s
Epoch: 19 cost time: 95.08603024482727
Epoch: 19, Steps: 1108 | Train Loss: 0.1595361 Vali Loss: 0.1406948 Test Loss: 0.1650944
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.9073486328125e-08
	iters: 100, epoch: 20 | loss: 0.1853952
	speed: 0.2249s/iter; left time: 226.9643s
	iters: 200, epoch: 20 | loss: 0.1650371
	speed: 0.0850s/iter; left time: 77.2935s
	iters: 300, epoch: 20 | loss: 0.1380642
	speed: 0.0854s/iter; left time: 69.0810s
	iters: 400, epoch: 20 | loss: 0.1540745
	speed: 0.0881s/iter; left time: 62.4801s
	iters: 500, epoch: 20 | loss: 0.1667775
	speed: 0.0870s/iter; left time: 53.0005s
	iters: 600, epoch: 20 | loss: 0.1718384
	speed: 0.0865s/iter; left time: 44.0194s
	iters: 700, epoch: 20 | loss: 0.1650307
	speed: 0.0851s/iter; left time: 34.8251s
	iters: 800, epoch: 20 | loss: 0.1693147
	speed: 0.0844s/iter; left time: 26.0814s
	iters: 900, epoch: 20 | loss: 0.1583121
	speed: 0.0845s/iter; left time: 17.6685s
	iters: 1000, epoch: 20 | loss: 0.1354536
	speed: 0.0848s/iter; left time: 9.2449s
	iters: 1100, epoch: 20 | loss: 0.1497062
	speed: 0.0853s/iter; left time: 0.7677s
Epoch: 20 cost time: 94.81889581680298
Epoch: 20, Steps: 1108 | Train Loss: 0.1595360 Vali Loss: 0.1406641 Test Loss: 0.1650945
EarlyStopping counter: 2 out of 5
Updating learning rate to 9.5367431640625e-09
>>>>>>>testing : Electricity_336_336_Linear_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed25565<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4925
mse:0.16497497260570526, mae:0.2633073925971985
