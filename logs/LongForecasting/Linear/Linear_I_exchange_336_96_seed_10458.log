Args in experiment:
Namespace(activation='gelu', batch_size=8, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='exchange_rate.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=8, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='mse', lradj='type1', model='Linear', model_id='Exchange_336_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=10458, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : Exchange_336_96_Linear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed10458>>>>>>>>>>>>>>>>>>>>>>>>>>
train 4880
val 665
test 1422
	iters: 100, epoch: 1 | loss: 0.1060597
	speed: 0.0027s/iter; left time: 32.0677s
	iters: 200, epoch: 1 | loss: 0.1441033
	speed: 0.0026s/iter; left time: 30.6251s
	iters: 300, epoch: 1 | loss: 0.1669311
	speed: 0.0025s/iter; left time: 29.8715s
	iters: 400, epoch: 1 | loss: 0.1363077
	speed: 0.0026s/iter; left time: 30.7778s
	iters: 500, epoch: 1 | loss: 0.1673039
	speed: 0.0025s/iter; left time: 29.2528s
	iters: 600, epoch: 1 | loss: 0.2927859
	speed: 0.0025s/iter; left time: 28.4411s
Epoch: 1 cost time: 1.5651593208312988
Epoch: 1, Steps: 610 | Train Loss: 0.1650908 Vali Loss: 0.3882443 Test Loss: 0.1698119
Validation loss decreased (inf --> 0.388244).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1327440
	speed: 0.0055s/iter; left time: 63.4301s
	iters: 200, epoch: 2 | loss: 0.1153265
	speed: 0.0028s/iter; left time: 32.3537s
	iters: 300, epoch: 2 | loss: 0.0928675
	speed: 0.0026s/iter; left time: 29.4945s
	iters: 400, epoch: 2 | loss: 0.1909076
	speed: 0.0027s/iter; left time: 29.8799s
	iters: 500, epoch: 2 | loss: 0.2775830
	speed: 0.0026s/iter; left time: 29.2802s
	iters: 600, epoch: 2 | loss: 0.0807756
	speed: 0.0026s/iter; left time: 28.7963s
Epoch: 2 cost time: 1.693246603012085
Epoch: 2, Steps: 610 | Train Loss: 0.1289337 Vali Loss: 0.2174997 Test Loss: 0.1149094
Validation loss decreased (0.388244 --> 0.217500).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1775729
	speed: 0.0044s/iter; left time: 47.3526s
	iters: 200, epoch: 3 | loss: 0.1158897
	speed: 0.0029s/iter; left time: 31.6961s
	iters: 300, epoch: 3 | loss: 0.0850678
	speed: 0.0033s/iter; left time: 35.4853s
	iters: 400, epoch: 3 | loss: 0.0586833
	speed: 0.0035s/iter; left time: 36.6103s
	iters: 500, epoch: 3 | loss: 0.2277976
	speed: 0.0035s/iter; left time: 36.5839s
	iters: 600, epoch: 3 | loss: 0.1576112
	speed: 0.0035s/iter; left time: 36.0419s
Epoch: 3 cost time: 1.9704697132110596
Epoch: 3, Steps: 610 | Train Loss: 0.1195734 Vali Loss: 0.2661743 Test Loss: 0.1003138
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.0911212
	speed: 0.0057s/iter; left time: 58.7501s
	iters: 200, epoch: 4 | loss: 0.0796902
	speed: 0.0036s/iter; left time: 36.4173s
	iters: 300, epoch: 4 | loss: 0.1109998
	speed: 0.0034s/iter; left time: 34.3687s
	iters: 400, epoch: 4 | loss: 0.1842932
	speed: 0.0033s/iter; left time: 32.7049s
	iters: 500, epoch: 4 | loss: 0.0866751
	speed: 0.0032s/iter; left time: 31.2911s
	iters: 600, epoch: 4 | loss: 0.1007366
	speed: 0.0032s/iter; left time: 31.0919s
Epoch: 4 cost time: 2.048520565032959
Epoch: 4, Steps: 610 | Train Loss: 0.1166313 Vali Loss: 0.2782303 Test Loss: 0.1085890
EarlyStopping counter: 2 out of 5
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1319577
	speed: 0.0054s/iter; left time: 52.1693s
	iters: 200, epoch: 5 | loss: 0.1498184
	speed: 0.0032s/iter; left time: 30.6905s
	iters: 300, epoch: 5 | loss: 0.0990141
	speed: 0.0034s/iter; left time: 32.2618s
	iters: 400, epoch: 5 | loss: 0.0685410
	speed: 0.0035s/iter; left time: 32.7635s
	iters: 500, epoch: 5 | loss: 0.1555344
	speed: 0.0034s/iter; left time: 31.1344s
	iters: 600, epoch: 5 | loss: 0.1997284
	speed: 0.0032s/iter; left time: 29.5902s
Epoch: 5 cost time: 2.0231823921203613
Epoch: 5, Steps: 610 | Train Loss: 0.1148343 Vali Loss: 0.2376995 Test Loss: 0.1027667
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0894015
	speed: 0.0056s/iter; left time: 50.6171s
	iters: 200, epoch: 6 | loss: 0.0718427
	speed: 0.0033s/iter; left time: 29.6278s
	iters: 300, epoch: 6 | loss: 0.0547461
	speed: 0.0031s/iter; left time: 27.5266s
	iters: 400, epoch: 6 | loss: 0.0973462
	speed: 0.0031s/iter; left time: 26.8892s
	iters: 500, epoch: 6 | loss: 0.0792663
	speed: 0.0031s/iter; left time: 26.9089s
	iters: 600, epoch: 6 | loss: 0.0989730
	speed: 0.0032s/iter; left time: 27.1923s
Epoch: 6 cost time: 1.948563575744629
Epoch: 6, Steps: 610 | Train Loss: 0.1140074 Vali Loss: 0.2154122 Test Loss: 0.0948147
Validation loss decreased (0.217500 --> 0.215412).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1168807
	speed: 0.0053s/iter; left time: 44.9307s
	iters: 200, epoch: 7 | loss: 0.0965845
	speed: 0.0032s/iter; left time: 26.5243s
	iters: 300, epoch: 7 | loss: 0.1639692
	speed: 0.0033s/iter; left time: 27.2822s
	iters: 400, epoch: 7 | loss: 0.1058153
	speed: 0.0032s/iter; left time: 25.8126s
	iters: 500, epoch: 7 | loss: 0.0997829
	speed: 0.0032s/iter; left time: 25.5704s
	iters: 600, epoch: 7 | loss: 0.0671137
	speed: 0.0034s/iter; left time: 27.3964s
Epoch: 7 cost time: 1.9844136238098145
Epoch: 7, Steps: 610 | Train Loss: 0.1135550 Vali Loss: 0.1981231 Test Loss: 0.0921972
Validation loss decreased (0.215412 --> 0.198123).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.1386096
	speed: 0.0059s/iter; left time: 45.9067s
	iters: 200, epoch: 8 | loss: 0.0875397
	speed: 0.0031s/iter; left time: 23.8887s
	iters: 300, epoch: 8 | loss: 0.1246218
	speed: 0.0031s/iter; left time: 23.3509s
	iters: 400, epoch: 8 | loss: 0.0823156
	speed: 0.0032s/iter; left time: 23.7352s
	iters: 500, epoch: 8 | loss: 0.1303728
	speed: 0.0028s/iter; left time: 21.0810s
	iters: 600, epoch: 8 | loss: 0.1549102
	speed: 0.0032s/iter; left time: 23.2393s
Epoch: 8 cost time: 1.9188570976257324
Epoch: 8, Steps: 610 | Train Loss: 0.1132186 Vali Loss: 0.2322419 Test Loss: 0.0984128
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.1152300
	speed: 0.0052s/iter; left time: 37.7108s
	iters: 200, epoch: 9 | loss: 0.0653180
	speed: 0.0030s/iter; left time: 21.4363s
	iters: 300, epoch: 9 | loss: 0.0971073
	speed: 0.0030s/iter; left time: 21.2196s
	iters: 400, epoch: 9 | loss: 0.0764381
	speed: 0.0029s/iter; left time: 19.7249s
	iters: 500, epoch: 9 | loss: 0.1014367
	speed: 0.0026s/iter; left time: 17.9381s
	iters: 600, epoch: 9 | loss: 0.0716875
	speed: 0.0026s/iter; left time: 17.6760s
Epoch: 9 cost time: 1.7462406158447266
Epoch: 9, Steps: 610 | Train Loss: 0.1131929 Vali Loss: 0.2057933 Test Loss: 0.0919154
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.2251476
	speed: 0.0045s/iter; left time: 29.6301s
	iters: 200, epoch: 10 | loss: 0.0925139
	speed: 0.0030s/iter; left time: 19.7283s
	iters: 300, epoch: 10 | loss: 0.1295265
	speed: 0.0030s/iter; left time: 19.2332s
	iters: 400, epoch: 10 | loss: 0.1663906
	speed: 0.0029s/iter; left time: 18.3789s
	iters: 500, epoch: 10 | loss: 0.1666984
	speed: 0.0028s/iter; left time: 17.5170s
	iters: 600, epoch: 10 | loss: 0.1950437
	speed: 0.0026s/iter; left time: 16.0108s
Epoch: 10 cost time: 1.750279426574707
Epoch: 10, Steps: 610 | Train Loss: 0.1130889 Vali Loss: 0.2092056 Test Loss: 0.0922819
EarlyStopping counter: 3 out of 5
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 11 | loss: 0.0789956
	speed: 0.0045s/iter; left time: 26.9076s
	iters: 200, epoch: 11 | loss: 0.0856293
	speed: 0.0030s/iter; left time: 17.8210s
	iters: 300, epoch: 11 | loss: 0.1285349
	speed: 0.0030s/iter; left time: 17.4030s
	iters: 400, epoch: 11 | loss: 0.0501153
	speed: 0.0032s/iter; left time: 18.1474s
	iters: 500, epoch: 11 | loss: 0.0769806
	speed: 0.0034s/iter; left time: 18.8193s
	iters: 600, epoch: 11 | loss: 0.1563096
	speed: 0.0027s/iter; left time: 14.7426s
Epoch: 11 cost time: 1.8374722003936768
Epoch: 11, Steps: 610 | Train Loss: 0.1130575 Vali Loss: 0.2088075 Test Loss: 0.0920353
EarlyStopping counter: 4 out of 5
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 12 | loss: 0.0918833
	speed: 0.0049s/iter; left time: 26.2126s
	iters: 200, epoch: 12 | loss: 0.0880213
	speed: 0.0028s/iter; left time: 14.6560s
	iters: 300, epoch: 12 | loss: 0.1192099
	speed: 0.0028s/iter; left time: 14.3272s
	iters: 400, epoch: 12 | loss: 0.0791554
	speed: 0.0024s/iter; left time: 12.3713s
	iters: 500, epoch: 12 | loss: 0.1751200
	speed: 0.0024s/iter; left time: 12.0091s
	iters: 600, epoch: 12 | loss: 0.0691016
	speed: 0.0024s/iter; left time: 11.7384s
Epoch: 12 cost time: 1.5928449630737305
Epoch: 12, Steps: 610 | Train Loss: 0.1130332 Vali Loss: 0.2089075 Test Loss: 0.0920230
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : Exchange_336_96_Linear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed10458<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 1422
mse:0.09206927567720413, mae:0.22351817786693573
