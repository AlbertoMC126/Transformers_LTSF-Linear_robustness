Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTh2', data_path='ETTh2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.05, loss='mse', lradj='type1', model='DLinear', model_id='ETTh2_336_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=15227, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTh2_336_96_DLinear_ETTh2_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15227>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
Total number of trainable parameters: 452928
Total number of parameters: 452928
	iters: 100, epoch: 1 | loss: 1.4730783
	speed: 0.0106s/iter; left time: 53.4655s
	iters: 200, epoch: 1 | loss: 1.6123937
	speed: 0.0104s/iter; left time: 51.4074s
Epoch: 1 cost time: 2.9236950874328613
Epoch: 1, Steps: 256 | Train Loss: 4.2780976 Vali Loss: 2.4461620 Test Loss: 7.9945292
Validation loss decreased (inf --> 2.446162).  Saving model ...
Updating learning rate to 0.05
	iters: 100, epoch: 2 | loss: 4.4183145
	speed: 0.0296s/iter; left time: 140.9986s
	iters: 200, epoch: 2 | loss: 3.2437494
	speed: 0.0109s/iter; left time: 50.9333s
Epoch: 2 cost time: 2.8104305267333984
Epoch: 2, Steps: 256 | Train Loss: 3.9349398 Vali Loss: 3.6940644 Test Loss: 8.5420904
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.025
	iters: 100, epoch: 3 | loss: 0.8390919
	speed: 0.0240s/iter; left time: 108.0665s
	iters: 200, epoch: 3 | loss: 0.6717597
	speed: 0.0108s/iter; left time: 47.7064s
Epoch: 3 cost time: 2.79060959815979
Epoch: 3, Steps: 256 | Train Loss: 1.0166058 Vali Loss: 0.5487116 Test Loss: 1.2670752
Validation loss decreased (2.446162 --> 0.548712).  Saving model ...
Updating learning rate to 0.0125
	iters: 100, epoch: 4 | loss: 0.3642379
	speed: 0.0242s/iter; left time: 102.7400s
	iters: 200, epoch: 4 | loss: 0.5255222
	speed: 0.0103s/iter; left time: 42.6038s
Epoch: 4 cost time: 2.710237503051758
Epoch: 4, Steps: 256 | Train Loss: 0.4852302 Vali Loss: 0.3968964 Test Loss: 0.7230741
Validation loss decreased (0.548712 --> 0.396896).  Saving model ...
Updating learning rate to 0.00625
	iters: 100, epoch: 5 | loss: 0.2534789
	speed: 0.0235s/iter; left time: 93.7867s
	iters: 200, epoch: 5 | loss: 0.5275459
	speed: 0.0111s/iter; left time: 43.1782s
Epoch: 5 cost time: 2.7604503631591797
Epoch: 5, Steps: 256 | Train Loss: 0.4193199 Vali Loss: 0.3052504 Test Loss: 0.5339437
Validation loss decreased (0.396896 --> 0.305250).  Saving model ...
Updating learning rate to 0.003125
	iters: 100, epoch: 6 | loss: 0.2970061
	speed: 0.0238s/iter; left time: 89.0678s
	iters: 200, epoch: 6 | loss: 0.2472778
	speed: 0.0125s/iter; left time: 45.4783s
Epoch: 6 cost time: 2.815232038497925
Epoch: 6, Steps: 256 | Train Loss: 0.3842258 Vali Loss: 0.2956401 Test Loss: 0.4778904
Validation loss decreased (0.305250 --> 0.295640).  Saving model ...
Updating learning rate to 0.0015625
	iters: 100, epoch: 7 | loss: 0.2804335
	speed: 0.0252s/iter; left time: 87.9256s
	iters: 200, epoch: 7 | loss: 0.2718454
	speed: 0.0106s/iter; left time: 35.7401s
Epoch: 7 cost time: 2.7743122577667236
Epoch: 7, Steps: 256 | Train Loss: 0.3678196 Vali Loss: 0.3143399 Test Loss: 0.5481913
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00078125
	iters: 100, epoch: 8 | loss: 0.3398775
	speed: 0.0230s/iter; left time: 74.3191s
	iters: 200, epoch: 8 | loss: 0.6544818
	speed: 0.0104s/iter; left time: 32.4278s
Epoch: 8 cost time: 2.634514570236206
Epoch: 8, Steps: 256 | Train Loss: 0.3593093 Vali Loss: 0.2735657 Test Loss: 0.3846282
Validation loss decreased (0.295640 --> 0.273566).  Saving model ...
Updating learning rate to 0.000390625
	iters: 100, epoch: 9 | loss: 0.2310370
	speed: 0.0237s/iter; left time: 70.5494s
	iters: 200, epoch: 9 | loss: 0.1958040
	speed: 0.0098s/iter; left time: 28.2356s
Epoch: 9 cost time: 2.5699994564056396
Epoch: 9, Steps: 256 | Train Loss: 0.3541603 Vali Loss: 0.2673870 Test Loss: 0.3839133
Validation loss decreased (0.273566 --> 0.267387).  Saving model ...
Updating learning rate to 0.0001953125
	iters: 100, epoch: 10 | loss: 0.2957152
	speed: 0.0246s/iter; left time: 66.8282s
	iters: 200, epoch: 10 | loss: 0.4843608
	speed: 0.0110s/iter; left time: 28.6971s
Epoch: 10 cost time: 2.800079584121704
Epoch: 10, Steps: 256 | Train Loss: 0.3511846 Vali Loss: 0.2656998 Test Loss: 0.3814814
Validation loss decreased (0.267387 --> 0.265700).  Saving model ...
Updating learning rate to 9.765625e-05
	iters: 100, epoch: 11 | loss: 0.4305954
	speed: 0.0254s/iter; left time: 62.5414s
	iters: 200, epoch: 11 | loss: 0.3357944
	speed: 0.0107s/iter; left time: 25.3192s
Epoch: 11 cost time: 2.798116683959961
Epoch: 11, Steps: 256 | Train Loss: 0.3497341 Vali Loss: 0.2744325 Test Loss: 0.4132373
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.8828125e-05
	iters: 100, epoch: 12 | loss: 0.2765464
	speed: 0.0247s/iter; left time: 54.5213s
	iters: 200, epoch: 12 | loss: 0.3153907
	speed: 0.0112s/iter; left time: 23.5964s
Epoch: 12 cost time: 2.7078073024749756
Epoch: 12, Steps: 256 | Train Loss: 0.3491100 Vali Loss: 0.2702881 Test Loss: 0.3962180
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.44140625e-05
	iters: 100, epoch: 13 | loss: 0.4699235
	speed: 0.0206s/iter; left time: 40.0584s
	iters: 200, epoch: 13 | loss: 0.3021507
	speed: 0.0089s/iter; left time: 16.4665s
Epoch: 13 cost time: 2.268115282058716
Epoch: 13, Steps: 256 | Train Loss: 0.3485018 Vali Loss: 0.2762080 Test Loss: 0.4160438
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.220703125e-05
	iters: 100, epoch: 14 | loss: 0.3053116
	speed: 0.0175s/iter; left time: 29.5515s
	iters: 200, epoch: 14 | loss: 0.3301966
	speed: 0.0080s/iter; left time: 12.7941s
Epoch: 14 cost time: 2.0943164825439453
Epoch: 14, Steps: 256 | Train Loss: 0.3482968 Vali Loss: 0.2779262 Test Loss: 0.4238968
EarlyStopping counter: 4 out of 5
Updating learning rate to 6.103515625e-06
	iters: 100, epoch: 15 | loss: 0.5347064
	speed: 0.0156s/iter; left time: 22.4402s
	iters: 200, epoch: 15 | loss: 0.3366469
	speed: 0.0062s/iter; left time: 8.2677s
Epoch: 15 cost time: 1.700016975402832
Epoch: 15, Steps: 256 | Train Loss: 0.3476642 Vali Loss: 0.2774805 Test Loss: 0.4218800
EarlyStopping counter: 5 out of 5
Early stopping
Total training time: 49.6880 seconds
>>>>>>>testing : ETTh2_336_96_DLinear_ETTh2_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15227<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.38467589020729065, mae:0.4079011380672455
