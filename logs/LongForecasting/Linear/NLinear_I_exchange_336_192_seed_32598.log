Args in experiment:
Namespace(activation='gelu', batch_size=8, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='exchange_rate.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=8, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='mse', lradj='type1', model='NLinear', model_id='Exchange_336_192', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=192, root_path='./dataset/', save_pred_values=False, seed=32598, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : Exchange_336_192_NLinear_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed32598>>>>>>>>>>>>>>>>>>>>>>>>>>
train 4784
val 569
test 1326
	iters: 100, epoch: 1 | loss: 0.3043699
	speed: 0.0041s/iter; left time: 48.4164s
	iters: 200, epoch: 1 | loss: 0.3843535
	speed: 0.0039s/iter; left time: 45.7502s
	iters: 300, epoch: 1 | loss: 0.5115603
	speed: 0.0041s/iter; left time: 48.0336s
	iters: 400, epoch: 1 | loss: 0.3520217
	speed: 0.0043s/iter; left time: 49.7297s
	iters: 500, epoch: 1 | loss: 0.1902825
	speed: 0.0040s/iter; left time: 46.1878s
Epoch: 1 cost time: 2.4626917839050293
Epoch: 1, Steps: 598 | Train Loss: 0.2469213 Vali Loss: 0.2563873 Test Loss: 0.2021811
Validation loss decreased (inf --> 0.256387).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2867691
	speed: 0.0114s/iter; left time: 128.2283s
	iters: 200, epoch: 2 | loss: 0.2091943
	speed: 0.0042s/iter; left time: 46.5785s
	iters: 300, epoch: 2 | loss: 0.2197218
	speed: 0.0040s/iter; left time: 44.3691s
	iters: 400, epoch: 2 | loss: 0.1711050
	speed: 0.0042s/iter; left time: 45.8572s
	iters: 500, epoch: 2 | loss: 0.1924237
	speed: 0.0045s/iter; left time: 48.7743s
Epoch: 2 cost time: 2.5486550331115723
Epoch: 2, Steps: 598 | Train Loss: 0.2395826 Vali Loss: 0.2480579 Test Loss: 0.1964819
Validation loss decreased (0.256387 --> 0.248058).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1880684
	speed: 0.0096s/iter; left time: 102.1023s
	iters: 200, epoch: 3 | loss: 0.2214562
	speed: 0.0036s/iter; left time: 37.9283s
	iters: 300, epoch: 3 | loss: 0.3132132
	speed: 0.0037s/iter; left time: 38.2026s
	iters: 400, epoch: 3 | loss: 0.1312998
	speed: 0.0040s/iter; left time: 41.1492s
	iters: 500, epoch: 3 | loss: 0.1025834
	speed: 0.0044s/iter; left time: 45.6011s
Epoch: 3 cost time: 2.358287811279297
Epoch: 3, Steps: 598 | Train Loss: 0.2346724 Vali Loss: 0.2487700 Test Loss: 0.1973387
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.2696451
	speed: 0.0104s/iter; left time: 104.7409s
	iters: 200, epoch: 4 | loss: 0.3344337
	speed: 0.0043s/iter; left time: 43.0669s
	iters: 300, epoch: 4 | loss: 0.1348919
	speed: 0.0043s/iter; left time: 42.5105s
	iters: 400, epoch: 4 | loss: 0.2041972
	speed: 0.0046s/iter; left time: 44.9481s
	iters: 500, epoch: 4 | loss: 0.1599165
	speed: 0.0046s/iter; left time: 44.8549s
Epoch: 4 cost time: 2.5988941192626953
Epoch: 4, Steps: 598 | Train Loss: 0.2325732 Vali Loss: 0.2468731 Test Loss: 0.1990473
Validation loss decreased (0.248058 --> 0.246873).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.2836661
	speed: 0.0106s/iter; left time: 100.6012s
	iters: 200, epoch: 5 | loss: 0.1386908
	speed: 0.0044s/iter; left time: 41.5344s
	iters: 300, epoch: 5 | loss: 0.3889407
	speed: 0.0037s/iter; left time: 33.9246s
	iters: 400, epoch: 5 | loss: 0.1693236
	speed: 0.0037s/iter; left time: 33.7642s
	iters: 500, epoch: 5 | loss: 0.3800507
	speed: 0.0041s/iter; left time: 37.3643s
Epoch: 5 cost time: 2.4285595417022705
Epoch: 5, Steps: 598 | Train Loss: 0.2308400 Vali Loss: 0.2461676 Test Loss: 0.2024227
Validation loss decreased (0.246873 --> 0.246168).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1766184
	speed: 0.0109s/iter; left time: 96.9489s
	iters: 200, epoch: 6 | loss: 0.1856642
	speed: 0.0038s/iter; left time: 32.9120s
	iters: 300, epoch: 6 | loss: 0.1780968
	speed: 0.0039s/iter; left time: 33.6435s
	iters: 400, epoch: 6 | loss: 0.2661963
	speed: 0.0043s/iter; left time: 36.9462s
	iters: 500, epoch: 6 | loss: 0.1993218
	speed: 0.0042s/iter; left time: 35.7648s
Epoch: 6 cost time: 2.3701186180114746
Epoch: 6, Steps: 598 | Train Loss: 0.2302267 Vali Loss: 0.2461387 Test Loss: 0.1973300
Validation loss decreased (0.246168 --> 0.246139).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.2138501
	speed: 0.0089s/iter; left time: 73.8257s
	iters: 200, epoch: 7 | loss: 0.1881588
	speed: 0.0043s/iter; left time: 35.4683s
	iters: 300, epoch: 7 | loss: 0.2474705
	speed: 0.0043s/iter; left time: 34.5693s
	iters: 400, epoch: 7 | loss: 0.3370177
	speed: 0.0040s/iter; left time: 31.6576s
	iters: 500, epoch: 7 | loss: 0.2053065
	speed: 0.0042s/iter; left time: 32.8305s
Epoch: 7 cost time: 2.505811929702759
Epoch: 7, Steps: 598 | Train Loss: 0.2297603 Vali Loss: 0.2446406 Test Loss: 0.1958836
Validation loss decreased (0.246139 --> 0.244641).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.2522492
	speed: 0.0110s/iter; left time: 84.5218s
	iters: 200, epoch: 8 | loss: 0.3066526
	speed: 0.0042s/iter; left time: 31.5296s
	iters: 300, epoch: 8 | loss: 0.1147858
	speed: 0.0042s/iter; left time: 31.6942s
	iters: 400, epoch: 8 | loss: 0.3651775
	speed: 0.0045s/iter; left time: 32.8506s
	iters: 500, epoch: 8 | loss: 0.1761550
	speed: 0.0036s/iter; left time: 26.1174s
Epoch: 8 cost time: 2.4426631927490234
Epoch: 8, Steps: 598 | Train Loss: 0.2295871 Vali Loss: 0.2436675 Test Loss: 0.1953501
Validation loss decreased (0.244641 --> 0.243667).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.2060881
	speed: 0.0102s/iter; left time: 72.4128s
	iters: 200, epoch: 9 | loss: 0.2525236
	speed: 0.0044s/iter; left time: 30.9280s
	iters: 300, epoch: 9 | loss: 0.2018136
	speed: 0.0038s/iter; left time: 25.9262s
	iters: 400, epoch: 9 | loss: 0.2766845
	speed: 0.0040s/iter; left time: 27.1015s
	iters: 500, epoch: 9 | loss: 0.2169455
	speed: 0.0039s/iter; left time: 26.1895s
Epoch: 9 cost time: 2.423391819000244
Epoch: 9, Steps: 598 | Train Loss: 0.2294957 Vali Loss: 0.2448378 Test Loss: 0.1952771
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.2250633
	speed: 0.0088s/iter; left time: 57.3002s
	iters: 200, epoch: 10 | loss: 0.4464195
	speed: 0.0040s/iter; left time: 25.4521s
	iters: 300, epoch: 10 | loss: 0.2741735
	speed: 0.0042s/iter; left time: 26.3089s
	iters: 400, epoch: 10 | loss: 0.2097471
	speed: 0.0038s/iter; left time: 23.4958s
	iters: 500, epoch: 10 | loss: 0.4246025
	speed: 0.0040s/iter; left time: 24.5631s
Epoch: 10 cost time: 2.3439159393310547
Epoch: 10, Steps: 598 | Train Loss: 0.2294295 Vali Loss: 0.2449255 Test Loss: 0.1954878
EarlyStopping counter: 2 out of 5
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 11 | loss: 0.1334535
	speed: 0.0092s/iter; left time: 53.9941s
	iters: 200, epoch: 11 | loss: 0.2129522
	speed: 0.0036s/iter; left time: 20.5804s
	iters: 300, epoch: 11 | loss: 0.1937818
	speed: 0.0043s/iter; left time: 24.4437s
	iters: 400, epoch: 11 | loss: 0.1680463
	speed: 0.0044s/iter; left time: 24.2774s
	iters: 500, epoch: 11 | loss: 0.1682926
	speed: 0.0043s/iter; left time: 23.5291s
Epoch: 11 cost time: 2.3795583248138428
Epoch: 11, Steps: 598 | Train Loss: 0.2293981 Vali Loss: 0.2449655 Test Loss: 0.1954831
EarlyStopping counter: 3 out of 5
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 12 | loss: 0.1679452
	speed: 0.0088s/iter; left time: 46.2390s
	iters: 200, epoch: 12 | loss: 0.5327376
	speed: 0.0040s/iter; left time: 20.7869s
	iters: 300, epoch: 12 | loss: 0.1513685
	speed: 0.0040s/iter; left time: 20.4337s
	iters: 400, epoch: 12 | loss: 0.2515368
	speed: 0.0039s/iter; left time: 19.3948s
	iters: 500, epoch: 12 | loss: 0.3315052
	speed: 0.0034s/iter; left time: 16.7968s
Epoch: 12 cost time: 2.200727939605713
Epoch: 12, Steps: 598 | Train Loss: 0.2293784 Vali Loss: 0.2449296 Test Loss: 0.1955053
EarlyStopping counter: 4 out of 5
Updating learning rate to 2.44140625e-07
	iters: 100, epoch: 13 | loss: 0.1512114
	speed: 0.0083s/iter; left time: 39.0834s
	iters: 200, epoch: 13 | loss: 0.1832287
	speed: 0.0039s/iter; left time: 18.0649s
	iters: 300, epoch: 13 | loss: 0.3286608
	speed: 0.0034s/iter; left time: 15.2581s
	iters: 400, epoch: 13 | loss: 0.1915502
	speed: 0.0034s/iter; left time: 14.7774s
	iters: 500, epoch: 13 | loss: 0.3835984
	speed: 0.0033s/iter; left time: 14.2691s
Epoch: 13 cost time: 2.1394100189208984
Epoch: 13, Steps: 598 | Train Loss: 0.2293695 Vali Loss: 0.2448336 Test Loss: 0.1955147
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : Exchange_336_192_NLinear_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed32598<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 1326
mse:0.1953117400407791, mae:0.31003645062446594
