Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTh1', data_path='ETTh1.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='DLinear', model_id='ETTh1_96_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=3144, seq_len=96, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTh1_96_96_DLinear_ETTh1_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3144>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8449
val 2785
test 2785
Total number of trainable parameters: 130368
Total number of parameters: 130368
	iters: 100, epoch: 1 | loss: 0.3707590
	speed: 0.0072s/iter; left time: 37.5104s
	iters: 200, epoch: 1 | loss: 0.3703177
	speed: 0.0074s/iter; left time: 37.5581s
Epoch: 1 cost time: 1.8898367881774902
Epoch: 1, Steps: 264 | Train Loss: 0.3876789 Vali Loss: 0.7284046 Test Loss: 0.4202597
Validation loss decreased (inf --> 0.728405).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.3832632
	speed: 0.0176s/iter; left time: 86.6035s
	iters: 200, epoch: 2 | loss: 0.3630533
	speed: 0.0063s/iter; left time: 30.3515s
Epoch: 2 cost time: 1.6921374797821045
Epoch: 2, Steps: 264 | Train Loss: 0.3640790 Vali Loss: 0.7219926 Test Loss: 0.4142688
Validation loss decreased (0.728405 --> 0.721993).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.3683813
	speed: 0.0160s/iter; left time: 74.4523s
	iters: 200, epoch: 3 | loss: 0.4804952
	speed: 0.0054s/iter; left time: 24.7419s
Epoch: 3 cost time: 1.5649516582489014
Epoch: 3, Steps: 264 | Train Loss: 0.3490250 Vali Loss: 0.6713954 Test Loss: 0.3962760
Validation loss decreased (0.721993 --> 0.671395).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.3707705
	speed: 0.0160s/iter; left time: 70.1514s
	iters: 200, epoch: 4 | loss: 0.2859924
	speed: 0.0064s/iter; left time: 27.5632s
Epoch: 4 cost time: 1.7713041305541992
Epoch: 4, Steps: 264 | Train Loss: 0.3406305 Vali Loss: 0.6555883 Test Loss: 0.3882960
Validation loss decreased (0.671395 --> 0.655588).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.3552907
	speed: 0.0151s/iter; left time: 62.3846s
	iters: 200, epoch: 5 | loss: 0.2876573
	speed: 0.0055s/iter; left time: 22.0878s
Epoch: 5 cost time: 1.5423080921173096
Epoch: 5, Steps: 264 | Train Loss: 0.3358750 Vali Loss: 0.6568055 Test Loss: 0.3840382
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.3643242
	speed: 0.0133s/iter; left time: 51.5249s
	iters: 200, epoch: 6 | loss: 0.3558471
	speed: 0.0064s/iter; left time: 24.2156s
Epoch: 6 cost time: 1.5324513912200928
Epoch: 6, Steps: 264 | Train Loss: 0.3338989 Vali Loss: 0.6610016 Test Loss: 0.3867783
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.3869953
	speed: 0.0123s/iter; left time: 44.3680s
	iters: 200, epoch: 7 | loss: 0.3355098
	speed: 0.0050s/iter; left time: 17.4743s
Epoch: 7 cost time: 1.4042761325836182
Epoch: 7, Steps: 264 | Train Loss: 0.3327038 Vali Loss: 0.6548595 Test Loss: 0.3822482
Validation loss decreased (0.655588 --> 0.654859).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.3744234
	speed: 0.0154s/iter; left time: 51.3523s
	iters: 200, epoch: 8 | loss: 0.3347939
	speed: 0.0065s/iter; left time: 21.0686s
Epoch: 8 cost time: 1.7127058506011963
Epoch: 8, Steps: 264 | Train Loss: 0.3319581 Vali Loss: 0.6565711 Test Loss: 0.3825095
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.3781886
	speed: 0.0136s/iter; left time: 41.5969s
	iters: 200, epoch: 9 | loss: 0.2820880
	speed: 0.0063s/iter; left time: 18.7260s
Epoch: 9 cost time: 1.598677396774292
Epoch: 9, Steps: 264 | Train Loss: 0.3315858 Vali Loss: 0.6528110 Test Loss: 0.3822151
Validation loss decreased (0.654859 --> 0.652811).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.3029547
	speed: 0.0161s/iter; left time: 45.1423s
	iters: 200, epoch: 10 | loss: 0.3914276
	speed: 0.0067s/iter; left time: 18.0036s
Epoch: 10 cost time: 1.674370527267456
Epoch: 10, Steps: 264 | Train Loss: 0.3314236 Vali Loss: 0.6510273 Test Loss: 0.3824583
Validation loss decreased (0.652811 --> 0.651027).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.3966486
	speed: 0.0163s/iter; left time: 41.4720s
	iters: 200, epoch: 11 | loss: 0.3651935
	speed: 0.0072s/iter; left time: 17.5546s
Epoch: 11 cost time: 1.7492642402648926
Epoch: 11, Steps: 264 | Train Loss: 0.3311956 Vali Loss: 0.6526513 Test Loss: 0.3822596
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.3261209
	speed: 0.0193s/iter; left time: 43.8379s
	iters: 200, epoch: 12 | loss: 0.2840192
	speed: 0.0063s/iter; left time: 13.7676s
Epoch: 12 cost time: 2.029888868331909
Epoch: 12, Steps: 264 | Train Loss: 0.3312588 Vali Loss: 0.6526920 Test Loss: 0.3822118
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.3578148
	speed: 0.0149s/iter; left time: 29.9454s
	iters: 200, epoch: 13 | loss: 0.2543160
	speed: 0.0072s/iter; left time: 13.6918s
Epoch: 13 cost time: 1.769150972366333
Epoch: 13, Steps: 264 | Train Loss: 0.3312255 Vali Loss: 0.6522837 Test Loss: 0.3822817
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.3120592
	speed: 0.0124s/iter; left time: 21.6204s
	iters: 200, epoch: 14 | loss: 0.3419062
	speed: 0.0047s/iter; left time: 7.8230s
Epoch: 14 cost time: 1.2944483757019043
Epoch: 14, Steps: 264 | Train Loss: 0.3312054 Vali Loss: 0.6521813 Test Loss: 0.3822975
EarlyStopping counter: 4 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.3173001
	speed: 0.0107s/iter; left time: 15.9146s
	iters: 200, epoch: 15 | loss: 0.3472982
	speed: 0.0044s/iter; left time: 6.0377s
Epoch: 15 cost time: 1.2100439071655273
Epoch: 15, Steps: 264 | Train Loss: 0.3311669 Vali Loss: 0.6527053 Test Loss: 0.3822969
EarlyStopping counter: 5 out of 5
Early stopping
Total training time: 31.4958 seconds
>>>>>>>testing : ETTh1_96_96_DLinear_ETTh1_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3144<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.3819825351238251, mae:0.3908243477344513
