Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTh2', data_path='ETTh2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.05, loss='mse', lradj='type1', model='NLinear', model_id='ETTh2_96_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=15349, seq_len=96, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTh2_96_96_NLinear_ETTh2_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15349>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8449
data_set:  <data_provider.data_loader.Dataset_ETT_hour object at 0x000002412FD60D68>
val 2785
data_set:  <data_provider.data_loader.Dataset_ETT_hour object at 0x000002417D367DD8>
test 2785
data_set:  <data_provider.data_loader.Dataset_ETT_hour object at 0x000002412FD60128>
Total number of trainable parameters: 65184
Total number of parameters: 65184
	iters: 100, epoch: 1 | loss: 1.5601003
	speed: 0.0035s/iter; left time: 36.4035s
	iters: 200, epoch: 1 | loss: 1.2066404
	speed: 0.0033s/iter; left time: 34.1472s
	iters: 300, epoch: 1 | loss: 2.0513120
	speed: 0.0036s/iter; left time: 36.7782s
	iters: 400, epoch: 1 | loss: 1.2460859
	speed: 0.0026s/iter; left time: 26.6897s
	iters: 500, epoch: 1 | loss: 0.5139479
	speed: 0.0033s/iter; left time: 32.8375s
Epoch: 1 cost time: 1.7496776580810547
Epoch: 1, Steps: 528 | Train Loss: 1.5269500 Vali Loss: 0.5906426 Test Loss: 0.8798093
Validation loss decreased (inf --> 0.590643).  Saving model ...
Updating learning rate to 0.05
	iters: 100, epoch: 2 | loss: 0.9653353
	speed: 0.0078s/iter; left time: 77.5444s
	iters: 200, epoch: 2 | loss: 1.8138233
	speed: 0.0034s/iter; left time: 33.8300s
	iters: 300, epoch: 2 | loss: 0.9679273
	speed: 0.0034s/iter; left time: 33.4729s
	iters: 400, epoch: 2 | loss: 1.2425337
	speed: 0.0028s/iter; left time: 27.1029s
	iters: 500, epoch: 2 | loss: 0.6493409
	speed: 0.0031s/iter; left time: 29.0910s
Epoch: 2 cost time: 1.6192994117736816
Epoch: 2, Steps: 528 | Train Loss: 1.6090175 Vali Loss: 0.9403601 Test Loss: 1.0113299
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.025
	iters: 100, epoch: 3 | loss: 0.4260358
	speed: 0.0068s/iter; left time: 63.8293s
	iters: 200, epoch: 3 | loss: 0.6189114
	speed: 0.0031s/iter; left time: 29.0728s
	iters: 300, epoch: 3 | loss: 0.6114526
	speed: 0.0029s/iter; left time: 26.7014s
	iters: 400, epoch: 3 | loss: 0.7661821
	speed: 0.0028s/iter; left time: 25.8687s
	iters: 500, epoch: 3 | loss: 0.2300139
	speed: 0.0025s/iter; left time: 22.8752s
Epoch: 3 cost time: 1.5394561290740967
Epoch: 3, Steps: 528 | Train Loss: 0.7045903 Vali Loss: 0.5143954 Test Loss: 0.7823005
Validation loss decreased (0.590643 --> 0.514395).  Saving model ...
Updating learning rate to 0.0125
	iters: 100, epoch: 4 | loss: 0.3718604
	speed: 0.0078s/iter; left time: 69.3605s
	iters: 200, epoch: 4 | loss: 0.5375225
	speed: 0.0028s/iter; left time: 24.1386s
	iters: 300, epoch: 4 | loss: 0.2638822
	speed: 0.0027s/iter; left time: 23.5800s
	iters: 400, epoch: 4 | loss: 0.2964658
	speed: 0.0023s/iter; left time: 20.1156s
	iters: 500, epoch: 4 | loss: 0.3281537
	speed: 0.0027s/iter; left time: 22.5333s
Epoch: 4 cost time: 1.4991700649261475
Epoch: 4, Steps: 528 | Train Loss: 0.5000561 Vali Loss: 0.2280534 Test Loss: 0.3160268
Validation loss decreased (0.514395 --> 0.228053).  Saving model ...
Updating learning rate to 0.00625
	iters: 100, epoch: 5 | loss: 0.3421939
	speed: 0.0080s/iter; left time: 66.5286s
	iters: 200, epoch: 5 | loss: 0.3908087
	speed: 0.0024s/iter; left time: 19.9816s
	iters: 300, epoch: 5 | loss: 0.7737269
	speed: 0.0034s/iter; left time: 27.3453s
	iters: 400, epoch: 5 | loss: 0.3709085
	speed: 0.0033s/iter; left time: 26.4290s
	iters: 500, epoch: 5 | loss: 0.3140389
	speed: 0.0028s/iter; left time: 22.3550s
Epoch: 5 cost time: 1.5159215927124023
Epoch: 5, Steps: 528 | Train Loss: 0.4450378 Vali Loss: 0.2368261 Test Loss: 0.3389915
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.003125
	iters: 100, epoch: 6 | loss: 0.5508204
	speed: 0.0078s/iter; left time: 61.0957s
	iters: 200, epoch: 6 | loss: 0.3285211
	speed: 0.0025s/iter; left time: 19.3260s
	iters: 300, epoch: 6 | loss: 0.2238192
	speed: 0.0020s/iter; left time: 15.4602s
	iters: 400, epoch: 6 | loss: 0.2011757
	speed: 0.0030s/iter; left time: 22.3268s
	iters: 500, epoch: 6 | loss: 0.2040065
	speed: 0.0026s/iter; left time: 19.1722s
Epoch: 6 cost time: 1.344202995300293
Epoch: 6, Steps: 528 | Train Loss: 0.4250132 Vali Loss: 0.2127626 Test Loss: 0.2941461
Validation loss decreased (0.228053 --> 0.212763).  Saving model ...
Updating learning rate to 0.0015625
	iters: 100, epoch: 7 | loss: 0.3262721
	speed: 0.0063s/iter; left time: 46.1251s
	iters: 200, epoch: 7 | loss: 0.2411302
	speed: 0.0023s/iter; left time: 16.8865s
	iters: 300, epoch: 7 | loss: 0.2203082
	speed: 0.0030s/iter; left time: 21.3051s
	iters: 400, epoch: 7 | loss: 0.4733853
	speed: 0.0023s/iter; left time: 16.1084s
	iters: 500, epoch: 7 | loss: 0.6753560
	speed: 0.0027s/iter; left time: 18.6412s
Epoch: 7 cost time: 1.346257209777832
Epoch: 7, Steps: 528 | Train Loss: 0.4125086 Vali Loss: 0.2155142 Test Loss: 0.2956761
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00078125
	iters: 100, epoch: 8 | loss: 0.7184926
	speed: 0.0071s/iter; left time: 48.2891s
	iters: 200, epoch: 8 | loss: 0.6266301
	speed: 0.0032s/iter; left time: 21.4132s
	iters: 300, epoch: 8 | loss: 0.3114175
	speed: 0.0031s/iter; left time: 20.5473s
	iters: 400, epoch: 8 | loss: 0.3764222
	speed: 0.0023s/iter; left time: 14.5836s
	iters: 500, epoch: 8 | loss: 0.3513491
	speed: 0.0038s/iter; left time: 24.4792s
Epoch: 8 cost time: 1.6001060009002686
Epoch: 8, Steps: 528 | Train Loss: 0.4067512 Vali Loss: 0.2156706 Test Loss: 0.2948955
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.000390625
	iters: 100, epoch: 9 | loss: 0.2837480
	speed: 0.0085s/iter; left time: 52.9051s
	iters: 200, epoch: 9 | loss: 0.5144457
	speed: 0.0028s/iter; left time: 17.2820s
	iters: 300, epoch: 9 | loss: 0.4258933
	speed: 0.0030s/iter; left time: 17.9266s
	iters: 400, epoch: 9 | loss: 0.2442333
	speed: 0.0026s/iter; left time: 15.2908s
	iters: 500, epoch: 9 | loss: 0.2384865
	speed: 0.0026s/iter; left time: 15.0389s
Epoch: 9 cost time: 1.4431345462799072
Epoch: 9, Steps: 528 | Train Loss: 0.4044523 Vali Loss: 0.2096990 Test Loss: 0.2901685
Validation loss decreased (0.212763 --> 0.209699).  Saving model ...
Updating learning rate to 0.0001953125
	iters: 100, epoch: 10 | loss: 0.4882267
	speed: 0.0080s/iter; left time: 45.5017s
	iters: 200, epoch: 10 | loss: 0.1965890
	speed: 0.0025s/iter; left time: 14.0243s
	iters: 300, epoch: 10 | loss: 0.2260494
	speed: 0.0022s/iter; left time: 12.0860s
	iters: 400, epoch: 10 | loss: 0.4945143
	speed: 0.0028s/iter; left time: 15.1942s
	iters: 500, epoch: 10 | loss: 0.2277119
	speed: 0.0036s/iter; left time: 19.0610s
Epoch: 10 cost time: 1.4688539505004883
Epoch: 10, Steps: 528 | Train Loss: 0.4023673 Vali Loss: 0.2096674 Test Loss: 0.2901146
Validation loss decreased (0.209699 --> 0.209667).  Saving model ...
Updating learning rate to 9.765625e-05
	iters: 100, epoch: 11 | loss: 0.2956436
	speed: 0.0072s/iter; left time: 37.2442s
	iters: 200, epoch: 11 | loss: 0.3573586
	speed: 0.0036s/iter; left time: 18.2666s
	iters: 300, epoch: 11 | loss: 1.2218626
	speed: 0.0025s/iter; left time: 12.4483s
	iters: 400, epoch: 11 | loss: 0.5078864
	speed: 0.0033s/iter; left time: 16.0264s
	iters: 500, epoch: 11 | loss: 0.4255324
	speed: 0.0030s/iter; left time: 14.1840s
Epoch: 11 cost time: 1.6255621910095215
Epoch: 11, Steps: 528 | Train Loss: 0.4011869 Vali Loss: 0.2092103 Test Loss: 0.2886227
Validation loss decreased (0.209667 --> 0.209210).  Saving model ...
Updating learning rate to 4.8828125e-05
	iters: 100, epoch: 12 | loss: 0.4942139
	speed: 0.0081s/iter; left time: 37.8180s
	iters: 200, epoch: 12 | loss: 0.2935018
	speed: 0.0034s/iter; left time: 15.6261s
	iters: 300, epoch: 12 | loss: 0.3070258
	speed: 0.0022s/iter; left time: 9.7509s
	iters: 400, epoch: 12 | loss: 0.5234228
	speed: 0.0028s/iter; left time: 12.2470s
	iters: 500, epoch: 12 | loss: 0.4426885
	speed: 0.0031s/iter; left time: 13.2968s
Epoch: 12 cost time: 1.5472705364227295
Epoch: 12, Steps: 528 | Train Loss: 0.4000406 Vali Loss: 0.2093513 Test Loss: 0.2895270
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.44140625e-05
	iters: 100, epoch: 13 | loss: 0.4642702
	speed: 0.0052s/iter; left time: 21.2494s
	iters: 200, epoch: 13 | loss: 0.4103215
	speed: 0.0025s/iter; left time: 10.0737s
	iters: 300, epoch: 13 | loss: 0.3839873
	speed: 0.0027s/iter; left time: 10.4201s
	iters: 400, epoch: 13 | loss: 0.2783559
	speed: 0.0023s/iter; left time: 8.9806s
	iters: 500, epoch: 13 | loss: 0.8622445
	speed: 0.0023s/iter; left time: 8.7147s
Epoch: 13 cost time: 1.2497262954711914
Epoch: 13, Steps: 528 | Train Loss: 0.4003343 Vali Loss: 0.2093883 Test Loss: 0.2895728
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.220703125e-05
	iters: 100, epoch: 14 | loss: 0.3900496
	speed: 0.0066s/iter; left time: 23.6157s
	iters: 200, epoch: 14 | loss: 0.1874248
	speed: 0.0025s/iter; left time: 8.7377s
	iters: 300, epoch: 14 | loss: 0.3373058
	speed: 0.0028s/iter; left time: 9.5659s
	iters: 400, epoch: 14 | loss: 0.3160395
	speed: 0.0023s/iter; left time: 7.7162s
	iters: 500, epoch: 14 | loss: 0.1780127
	speed: 0.0022s/iter; left time: 6.9984s
Epoch: 14 cost time: 1.3282175064086914
Epoch: 14, Steps: 528 | Train Loss: 0.4001685 Vali Loss: 0.2094258 Test Loss: 0.2896299
EarlyStopping counter: 3 out of 5
Updating learning rate to 6.103515625e-06
	iters: 100, epoch: 15 | loss: 1.0175875
	speed: 0.0059s/iter; left time: 18.2174s
	iters: 200, epoch: 15 | loss: 0.8178506
	speed: 0.0028s/iter; left time: 8.3452s
	iters: 300, epoch: 15 | loss: 0.4002779
	speed: 0.0020s/iter; left time: 5.8336s
	iters: 400, epoch: 15 | loss: 0.2302022
	speed: 0.0023s/iter; left time: 6.4899s
	iters: 500, epoch: 15 | loss: 0.2641264
	speed: 0.0022s/iter; left time: 5.8314s
Epoch: 15 cost time: 1.250262975692749
Epoch: 15, Steps: 528 | Train Loss: 0.4000710 Vali Loss: 0.2094575 Test Loss: 0.2896675
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.0517578125e-06
	iters: 100, epoch: 16 | loss: 1.0150554
	speed: 0.0059s/iter; left time: 15.0874s
	iters: 200, epoch: 16 | loss: 0.3386793
	speed: 0.0022s/iter; left time: 5.3386s
	iters: 300, epoch: 16 | loss: 0.3085299
	speed: 0.0033s/iter; left time: 7.6767s
	iters: 400, epoch: 16 | loss: 0.1983110
	speed: 0.0030s/iter; left time: 6.6608s
	iters: 500, epoch: 16 | loss: 0.3352707
	speed: 0.0028s/iter; left time: 6.0294s
Epoch: 16 cost time: 1.4374949932098389
Epoch: 16, Steps: 528 | Train Loss: 0.3999971 Vali Loss: 0.2094478 Test Loss: 0.2896615
EarlyStopping counter: 5 out of 5
Early stopping
Total training time: 29.2652 seconds
>>>>>>>testing : ETTh2_96_96_NLinear_ETTh2_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15349<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
data_set:  <data_provider.data_loader.Dataset_ETT_hour object at 0x00000241727B1080>
mse:0.289617121219635, mae:0.33969351649284363
