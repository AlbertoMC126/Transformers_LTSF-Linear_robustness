Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='Linear', model_id='traffic_336_192', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=192, root_path='./dataset/', save_pred_values=False, seed=10458, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_336_192_Linear_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed10458>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11753
val 1565
test 3317
	iters: 100, epoch: 1 | loss: 0.4799951
	speed: 0.3172s/iter; left time: 4625.0635s
	iters: 200, epoch: 1 | loss: 0.4710909
	speed: 0.3024s/iter; left time: 4378.8797s
	iters: 300, epoch: 1 | loss: 0.4783870
	speed: 0.3031s/iter; left time: 4359.1330s
	iters: 400, epoch: 1 | loss: 0.4464453
	speed: 0.3024s/iter; left time: 4318.9665s
	iters: 500, epoch: 1 | loss: 0.4977278
	speed: 0.3012s/iter; left time: 4271.3775s
	iters: 600, epoch: 1 | loss: 0.4834383
	speed: 0.3020s/iter; left time: 4252.6787s
	iters: 700, epoch: 1 | loss: 0.4794713
	speed: 0.3020s/iter; left time: 4222.0398s
Epoch: 1 cost time: 223.45503687858582
Epoch: 1, Steps: 734 | Train Loss: 0.4813269 Vali Loss: 0.6282889 Test Loss: 0.7523175
Validation loss decreased (inf --> 0.628289).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.4954489
	speed: 0.6036s/iter; left time: 8357.7940s
	iters: 200, epoch: 2 | loss: 0.4458659
	speed: 0.3013s/iter; left time: 4141.4360s
	iters: 300, epoch: 2 | loss: 0.4999212
	speed: 0.3009s/iter; left time: 4105.7716s
	iters: 400, epoch: 2 | loss: 0.4865910
	speed: 0.3028s/iter; left time: 4101.9684s
	iters: 500, epoch: 2 | loss: 0.4350644
	speed: 0.3008s/iter; left time: 4044.4995s
	iters: 600, epoch: 2 | loss: 0.4802882
	speed: 0.3019s/iter; left time: 4030.1030s
	iters: 700, epoch: 2 | loss: 0.4914844
	speed: 0.3022s/iter; left time: 4003.2649s
Epoch: 2 cost time: 221.24334597587585
Epoch: 2, Steps: 734 | Train Loss: 0.4737727 Vali Loss: 0.6424175 Test Loss: 0.7587503
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.3061950
	speed: 0.6097s/iter; left time: 7994.6389s
	iters: 200, epoch: 3 | loss: 0.3335757
	speed: 0.3009s/iter; left time: 3915.8693s
	iters: 300, epoch: 3 | loss: 0.2988961
	speed: 0.3014s/iter; left time: 3891.9474s
	iters: 400, epoch: 3 | loss: 0.3196587
	speed: 0.3039s/iter; left time: 3893.9460s
	iters: 500, epoch: 3 | loss: 0.3255515
	speed: 0.3027s/iter; left time: 3848.8070s
	iters: 600, epoch: 3 | loss: 0.3479764
	speed: 0.3028s/iter; left time: 3818.7892s
	iters: 700, epoch: 3 | loss: 0.3497022
	speed: 0.3029s/iter; left time: 3790.5828s
Epoch: 3 cost time: 222.03670072555542
Epoch: 3, Steps: 734 | Train Loss: 0.3302128 Vali Loss: 0.4552370 Test Loss: 0.5533114
Validation loss decreased (0.628289 --> 0.455237).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.2730061
	speed: 0.6107s/iter; left time: 7559.4737s
	iters: 200, epoch: 4 | loss: 0.2827053
	speed: 0.3031s/iter; left time: 3721.6278s
	iters: 300, epoch: 4 | loss: 0.2821569
	speed: 0.3025s/iter; left time: 3684.0604s
	iters: 400, epoch: 4 | loss: 0.2772164
	speed: 0.3033s/iter; left time: 3663.8628s
	iters: 500, epoch: 4 | loss: 0.2828920
	speed: 0.3035s/iter; left time: 3635.7446s
	iters: 600, epoch: 4 | loss: 0.2969925
	speed: 0.3030s/iter; left time: 3599.6579s
	iters: 700, epoch: 4 | loss: 0.3155454
	speed: 0.3024s/iter; left time: 3561.9719s
Epoch: 4 cost time: 222.464586019516
Epoch: 4, Steps: 734 | Train Loss: 0.2825269 Vali Loss: 0.4011756 Test Loss: 0.4938025
Validation loss decreased (0.455237 --> 0.401176).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.2440547
	speed: 0.6115s/iter; left time: 7121.4288s
	iters: 200, epoch: 5 | loss: 0.2635832
	speed: 0.3023s/iter; left time: 3489.7899s
	iters: 300, epoch: 5 | loss: 0.2526693
	speed: 0.3017s/iter; left time: 3453.3958s
	iters: 400, epoch: 5 | loss: 0.2607590
	speed: 0.3005s/iter; left time: 3409.6465s
	iters: 500, epoch: 5 | loss: 0.3051572
	speed: 0.3021s/iter; left time: 3397.3392s
	iters: 600, epoch: 5 | loss: 0.2407692
	speed: 0.3002s/iter; left time: 3345.4035s
	iters: 700, epoch: 5 | loss: 0.2738131
	speed: 0.3001s/iter; left time: 3314.0906s
Epoch: 5 cost time: 221.13245129585266
Epoch: 5, Steps: 734 | Train Loss: 0.2614661 Vali Loss: 0.3782393 Test Loss: 0.4648035
Validation loss decreased (0.401176 --> 0.378239).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.2506247
	speed: 0.6081s/iter; left time: 6635.0471s
	iters: 200, epoch: 6 | loss: 0.2228672
	speed: 0.3027s/iter; left time: 3272.4235s
	iters: 300, epoch: 6 | loss: 0.2414042
	speed: 0.3019s/iter; left time: 3234.0292s
	iters: 400, epoch: 6 | loss: 0.2505195
	speed: 0.3023s/iter; left time: 3207.8653s
	iters: 500, epoch: 6 | loss: 0.2589258
	speed: 0.3031s/iter; left time: 3185.6063s
	iters: 600, epoch: 6 | loss: 0.2323523
	speed: 0.3024s/iter; left time: 3148.5518s
	iters: 700, epoch: 6 | loss: 0.2692395
	speed: 0.3017s/iter; left time: 3110.5828s
Epoch: 6 cost time: 222.00854992866516
Epoch: 6, Steps: 734 | Train Loss: 0.2505806 Vali Loss: 0.3658600 Test Loss: 0.4513219
Validation loss decreased (0.378239 --> 0.365860).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.2358889
	speed: 0.6074s/iter; left time: 6181.4315s
	iters: 200, epoch: 7 | loss: 0.2246204
	speed: 0.3009s/iter; left time: 3031.8026s
	iters: 300, epoch: 7 | loss: 0.2366947
	speed: 0.3020s/iter; left time: 3012.6948s
	iters: 400, epoch: 7 | loss: 0.2301161
	speed: 0.3021s/iter; left time: 2983.7309s
	iters: 500, epoch: 7 | loss: 0.2407415
	speed: 0.3024s/iter; left time: 2956.4699s
	iters: 600, epoch: 7 | loss: 0.2451245
	speed: 0.3011s/iter; left time: 2913.4241s
	iters: 700, epoch: 7 | loss: 0.2498247
	speed: 0.3012s/iter; left time: 2884.7045s
Epoch: 7 cost time: 221.28874707221985
Epoch: 7, Steps: 734 | Train Loss: 0.2446271 Vali Loss: 0.3604302 Test Loss: 0.4449441
Validation loss decreased (0.365860 --> 0.360430).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.2597868
	speed: 0.6109s/iter; left time: 5768.6653s
	iters: 200, epoch: 8 | loss: 0.2295284
	speed: 0.3025s/iter; left time: 2826.5618s
	iters: 300, epoch: 8 | loss: 0.2292834
	speed: 0.3012s/iter; left time: 2784.3305s
	iters: 400, epoch: 8 | loss: 0.2622517
	speed: 0.3015s/iter; left time: 2756.5681s
	iters: 500, epoch: 8 | loss: 0.2290013
	speed: 0.3016s/iter; left time: 2727.6682s
	iters: 600, epoch: 8 | loss: 0.2167476
	speed: 0.3030s/iter; left time: 2709.7424s
	iters: 700, epoch: 8 | loss: 0.2328932
	speed: 0.3014s/iter; left time: 2665.3840s
Epoch: 8 cost time: 221.54658484458923
Epoch: 8, Steps: 734 | Train Loss: 0.2413959 Vali Loss: 0.3581031 Test Loss: 0.4418488
Validation loss decreased (0.360430 --> 0.358103).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.2372192
	speed: 0.6084s/iter; left time: 5298.5568s
	iters: 200, epoch: 9 | loss: 0.2214118
	speed: 0.3014s/iter; left time: 2594.6099s
	iters: 300, epoch: 9 | loss: 0.2178051
	speed: 0.3026s/iter; left time: 2574.9829s
	iters: 400, epoch: 9 | loss: 0.2465543
	speed: 0.3020s/iter; left time: 2539.9055s
	iters: 500, epoch: 9 | loss: 0.2480724
	speed: 0.3027s/iter; left time: 2515.3568s
	iters: 600, epoch: 9 | loss: 0.2589101
	speed: 0.3031s/iter; left time: 2488.0349s
	iters: 700, epoch: 9 | loss: 0.2473346
	speed: 0.3012s/iter; left time: 2442.5078s
Epoch: 9 cost time: 221.84141969680786
Epoch: 9, Steps: 734 | Train Loss: 0.2395778 Vali Loss: 0.3561541 Test Loss: 0.4400010
Validation loss decreased (0.358103 --> 0.356154).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.2565343
	speed: 0.6105s/iter; left time: 4868.5733s
	iters: 200, epoch: 10 | loss: 0.2490121
	speed: 0.3017s/iter; left time: 2375.6180s
	iters: 300, epoch: 10 | loss: 0.2354626
	speed: 0.3035s/iter; left time: 2359.4956s
	iters: 400, epoch: 10 | loss: 0.2217532
	speed: 0.3017s/iter; left time: 2315.4093s
	iters: 500, epoch: 10 | loss: 0.2322903
	speed: 0.3012s/iter; left time: 2281.8401s
	iters: 600, epoch: 10 | loss: 0.2436311
	speed: 0.3008s/iter; left time: 2248.3830s
	iters: 700, epoch: 10 | loss: 0.2213179
	speed: 0.3025s/iter; left time: 2231.0150s
Epoch: 10 cost time: 221.57599759101868
Epoch: 10, Steps: 734 | Train Loss: 0.2386146 Vali Loss: 0.3557703 Test Loss: 0.4393943
Validation loss decreased (0.356154 --> 0.355770).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.2442246
	speed: 0.6104s/iter; left time: 4419.8916s
	iters: 200, epoch: 11 | loss: 0.2396819
	speed: 0.3013s/iter; left time: 2151.5553s
	iters: 300, epoch: 11 | loss: 0.2455988
	speed: 0.3014s/iter; left time: 2122.3780s
	iters: 400, epoch: 11 | loss: 0.2181754
	speed: 0.3013s/iter; left time: 2091.1772s
	iters: 500, epoch: 11 | loss: 0.2405986
	speed: 0.3025s/iter; left time: 2069.6882s
	iters: 600, epoch: 11 | loss: 0.2273457
	speed: 0.3016s/iter; left time: 2032.9280s
	iters: 700, epoch: 11 | loss: 0.2283196
	speed: 0.3021s/iter; left time: 2006.2322s
Epoch: 11 cost time: 221.5548973083496
Epoch: 11, Steps: 734 | Train Loss: 0.2380461 Vali Loss: 0.3555706 Test Loss: 0.4391257
Validation loss decreased (0.355770 --> 0.355571).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.2376595
	speed: 0.6112s/iter; left time: 3977.3877s
	iters: 200, epoch: 12 | loss: 0.2599558
	speed: 0.3035s/iter; left time: 1944.4685s
	iters: 300, epoch: 12 | loss: 0.2493031
	speed: 0.3035s/iter; left time: 1914.3530s
	iters: 400, epoch: 12 | loss: 0.2310668
	speed: 0.3033s/iter; left time: 1882.7473s
	iters: 500, epoch: 12 | loss: 0.2509755
	speed: 0.3021s/iter; left time: 1844.6718s
	iters: 600, epoch: 12 | loss: 0.2358802
	speed: 0.3020s/iter; left time: 1814.4000s
	iters: 700, epoch: 12 | loss: 0.2414810
	speed: 0.3031s/iter; left time: 1790.2881s
Epoch: 12 cost time: 222.34849548339844
Epoch: 12, Steps: 734 | Train Loss: 0.2377934 Vali Loss: 0.3557714 Test Loss: 0.4389852
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.2366257
	speed: 0.6081s/iter; left time: 3510.7217s
	iters: 200, epoch: 13 | loss: 0.2331731
	speed: 0.3007s/iter; left time: 1705.8778s
	iters: 300, epoch: 13 | loss: 0.2215043
	speed: 0.3001s/iter; left time: 1672.5161s
	iters: 400, epoch: 13 | loss: 0.2537409
	speed: 0.3006s/iter; left time: 1645.2292s
	iters: 500, epoch: 13 | loss: 0.2371559
	speed: 0.3026s/iter; left time: 1625.6708s
	iters: 600, epoch: 13 | loss: 0.2188084
	speed: 0.3031s/iter; left time: 1598.1814s
	iters: 700, epoch: 13 | loss: 0.2492387
	speed: 0.3033s/iter; left time: 1569.1135s
Epoch: 13 cost time: 221.59934449195862
Epoch: 13, Steps: 734 | Train Loss: 0.2376405 Vali Loss: 0.3551456 Test Loss: 0.4389598
Validation loss decreased (0.355571 --> 0.355146).  Saving model ...
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 14 | loss: 0.2192732
	speed: 0.6095s/iter; left time: 3071.1378s
	iters: 200, epoch: 14 | loss: 0.2358870
	speed: 0.3014s/iter; left time: 1488.8068s
	iters: 300, epoch: 14 | loss: 0.2347154
	speed: 0.3010s/iter; left time: 1456.4583s
	iters: 400, epoch: 14 | loss: 0.2317209
	speed: 0.3019s/iter; left time: 1430.4778s
	iters: 500, epoch: 14 | loss: 0.2300279
	speed: 0.3015s/iter; left time: 1398.8469s
	iters: 600, epoch: 14 | loss: 0.2548363
	speed: 0.3024s/iter; left time: 1372.8098s
	iters: 700, epoch: 14 | loss: 0.2199413
	speed: 0.3030s/iter; left time: 1344.9421s
Epoch: 14 cost time: 221.6839108467102
Epoch: 14, Steps: 734 | Train Loss: 0.2375587 Vali Loss: 0.3552764 Test Loss: 0.4389337
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 15 | loss: 0.2337205
	speed: 0.6080s/iter; left time: 2617.3620s
	iters: 200, epoch: 15 | loss: 0.2219510
	speed: 0.3022s/iter; left time: 1270.8153s
	iters: 300, epoch: 15 | loss: 0.2921152
	speed: 0.3032s/iter; left time: 1244.6947s
	iters: 400, epoch: 15 | loss: 0.2257349
	speed: 0.3033s/iter; left time: 1214.8899s
	iters: 500, epoch: 15 | loss: 0.2547310
	speed: 0.3032s/iter; left time: 1183.9340s
	iters: 600, epoch: 15 | loss: 0.2226472
	speed: 0.3034s/iter; left time: 1154.3274s
	iters: 700, epoch: 15 | loss: 0.2616339
	speed: 0.3019s/iter; left time: 1118.6335s
Epoch: 15 cost time: 222.2904920578003
Epoch: 15, Steps: 734 | Train Loss: 0.2375297 Vali Loss: 0.3553926 Test Loss: 0.4389301
EarlyStopping counter: 2 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 16 | loss: 0.2213514
	speed: 0.6118s/iter; left time: 2184.8906s
	iters: 200, epoch: 16 | loss: 0.2385559
	speed: 0.3031s/iter; left time: 1051.9966s
	iters: 300, epoch: 16 | loss: 0.2425810
	speed: 0.3020s/iter; left time: 1017.9964s
	iters: 400, epoch: 16 | loss: 0.2362195
	speed: 0.3022s/iter; left time: 988.6026s
	iters: 500, epoch: 16 | loss: 0.2376157
	speed: 0.3014s/iter; left time: 955.7883s
	iters: 600, epoch: 16 | loss: 0.2493394
	speed: 0.3019s/iter; left time: 926.9897s
	iters: 700, epoch: 16 | loss: 0.2415700
	speed: 0.3004s/iter; left time: 892.4199s
Epoch: 16 cost time: 221.68439292907715
Epoch: 16, Steps: 734 | Train Loss: 0.2374756 Vali Loss: 0.3550436 Test Loss: 0.4389281
Validation loss decreased (0.355146 --> 0.355044).  Saving model ...
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 17 | loss: 0.2276298
	speed: 0.6060s/iter; left time: 1719.3243s
	iters: 200, epoch: 17 | loss: 0.2375212
	speed: 0.3027s/iter; left time: 828.4430s
	iters: 300, epoch: 17 | loss: 0.2306695
	speed: 0.3028s/iter; left time: 798.4773s
	iters: 400, epoch: 17 | loss: 0.2254516
	speed: 0.3034s/iter; left time: 769.6708s
	iters: 500, epoch: 17 | loss: 0.2342107
	speed: 0.3013s/iter; left time: 734.2326s
	iters: 600, epoch: 17 | loss: 0.2248270
	speed: 0.3016s/iter; left time: 704.7919s
	iters: 700, epoch: 17 | loss: 0.2116313
	speed: 0.3015s/iter; left time: 674.4901s
Epoch: 17 cost time: 221.72566032409668
Epoch: 17, Steps: 734 | Train Loss: 0.2374793 Vali Loss: 0.3555818 Test Loss: 0.4389286
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 18 | loss: 0.2606233
	speed: 0.6065s/iter; left time: 1275.5077s
	iters: 200, epoch: 18 | loss: 0.2339524
	speed: 0.3000s/iter; left time: 600.8964s
	iters: 300, epoch: 18 | loss: 0.2561555
	speed: 0.2999s/iter; left time: 570.7143s
	iters: 400, epoch: 18 | loss: 0.2425579
	speed: 0.3009s/iter; left time: 542.4400s
	iters: 500, epoch: 18 | loss: 0.2371413
	speed: 0.3023s/iter; left time: 514.8588s
	iters: 600, epoch: 18 | loss: 0.2341310
	speed: 0.3021s/iter; left time: 484.2181s
	iters: 700, epoch: 18 | loss: 0.2281984
	speed: 0.3018s/iter; left time: 453.6533s
Epoch: 18 cost time: 221.25423955917358
Epoch: 18, Steps: 734 | Train Loss: 0.2374675 Vali Loss: 0.3550149 Test Loss: 0.4389283
Validation loss decreased (0.355044 --> 0.355015).  Saving model ...
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 19 | loss: 0.2535281
	speed: 0.6122s/iter; left time: 838.0878s
	iters: 200, epoch: 19 | loss: 0.2549292
	speed: 0.3019s/iter; left time: 383.1556s
	iters: 300, epoch: 19 | loss: 0.2564498
	speed: 0.3002s/iter; left time: 350.9435s
	iters: 400, epoch: 19 | loss: 0.2400194
	speed: 0.3016s/iter; left time: 322.3972s
	iters: 500, epoch: 19 | loss: 0.2271611
	speed: 0.3001s/iter; left time: 290.7990s
	iters: 600, epoch: 19 | loss: 0.2249963
	speed: 0.3024s/iter; left time: 262.8243s
	iters: 700, epoch: 19 | loss: 0.2118139
	speed: 0.3011s/iter; left time: 231.5598s
Epoch: 19 cost time: 221.3388078212738
Epoch: 19, Steps: 734 | Train Loss: 0.2374638 Vali Loss: 0.3548535 Test Loss: 0.4389282
Validation loss decreased (0.355015 --> 0.354853).  Saving model ...
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 20 | loss: 0.2187207
	speed: 0.6101s/iter; left time: 387.4303s
	iters: 200, epoch: 20 | loss: 0.2329600
	speed: 0.3014s/iter; left time: 161.2516s
	iters: 300, epoch: 20 | loss: 0.2482281
	speed: 0.3024s/iter; left time: 131.5490s
	iters: 400, epoch: 20 | loss: 0.2406523
	speed: 0.3021s/iter; left time: 101.2059s
	iters: 500, epoch: 20 | loss: 0.2317146
	speed: 0.3020s/iter; left time: 70.9636s
	iters: 600, epoch: 20 | loss: 0.1993024
	speed: 0.3036s/iter; left time: 40.9926s
	iters: 700, epoch: 20 | loss: 0.2438492
	speed: 0.3009s/iter; left time: 10.5299s
Epoch: 20 cost time: 221.86193227767944
Epoch: 20, Steps: 734 | Train Loss: 0.2374455 Vali Loss: 0.3552728 Test Loss: 0.4389282
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.9073486328125e-08
>>>>>>>testing : traffic_336_192_Linear_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed10458<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3317
mse:0.43862035870552063, mae:0.3040241003036499
