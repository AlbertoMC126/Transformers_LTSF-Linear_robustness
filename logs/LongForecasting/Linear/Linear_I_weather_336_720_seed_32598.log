Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='Linear', model_id='weather_336_720', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=720, root_path='./dataset/', save_pred_values=False, seed=32598, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : weather_336_720_Linear_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed32598>>>>>>>>>>>>>>>>>>>>>>>>>>
train 35832
val 4551
test 9820
	iters: 100, epoch: 1 | loss: 0.6356676
	speed: 0.0506s/iter; left time: 2259.4704s
	iters: 200, epoch: 1 | loss: 0.9397064
	speed: 0.0488s/iter; left time: 2177.0423s
	iters: 300, epoch: 1 | loss: 0.5737332
	speed: 0.0474s/iter; left time: 2110.5543s
	iters: 400, epoch: 1 | loss: 1.1844264
	speed: 0.0505s/iter; left time: 2239.5165s
	iters: 500, epoch: 1 | loss: 2.2748055
	speed: 0.0460s/iter; left time: 2036.3720s
	iters: 600, epoch: 1 | loss: 1.7352128
	speed: 0.0466s/iter; left time: 2056.6671s
	iters: 700, epoch: 1 | loss: 1.0967256
	speed: 0.0471s/iter; left time: 2077.3027s
	iters: 800, epoch: 1 | loss: 0.8358626
	speed: 0.0505s/iter; left time: 2220.6512s
	iters: 900, epoch: 1 | loss: 0.6773816
	speed: 0.0509s/iter; left time: 2231.4116s
	iters: 1000, epoch: 1 | loss: 0.5686033
	speed: 0.0504s/iter; left time: 2205.3308s
	iters: 1100, epoch: 1 | loss: 3.0830097
	speed: 0.0528s/iter; left time: 2307.6154s
	iters: 1200, epoch: 1 | loss: 5.0316978
	speed: 0.0509s/iter; left time: 2219.7281s
	iters: 1300, epoch: 1 | loss: 7.3391171
	speed: 0.0478s/iter; left time: 2079.0238s
	iters: 1400, epoch: 1 | loss: 0.6170987
	speed: 0.0497s/iter; left time: 2154.1823s
	iters: 1500, epoch: 1 | loss: 0.7919966
	speed: 0.0510s/iter; left time: 2206.8406s
	iters: 1600, epoch: 1 | loss: 4.1154900
	speed: 0.0520s/iter; left time: 2243.4141s
	iters: 1700, epoch: 1 | loss: 0.7756668
	speed: 0.0484s/iter; left time: 2086.0402s
	iters: 1800, epoch: 1 | loss: 6.2294302
	speed: 0.0525s/iter; left time: 2258.1327s
	iters: 1900, epoch: 1 | loss: 1.0185715
	speed: 0.0471s/iter; left time: 2020.2857s
	iters: 2000, epoch: 1 | loss: 0.5649092
	speed: 0.0504s/iter; left time: 2157.5707s
	iters: 2100, epoch: 1 | loss: 1.1023295
	speed: 0.0519s/iter; left time: 2215.3575s
	iters: 2200, epoch: 1 | loss: 0.6958113
	speed: 0.0486s/iter; left time: 2068.7093s
Epoch: 1 cost time: 110.99715948104858
Epoch: 1, Steps: 2239 | Train Loss: 1.4670040 Vali Loss: 0.7298077 Test Loss: 0.4015461
Validation loss decreased (inf --> 0.729808).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.5381953
	speed: 0.1394s/iter; left time: 5915.2542s
	iters: 200, epoch: 2 | loss: 0.7914177
	speed: 0.0508s/iter; left time: 2151.9435s
	iters: 300, epoch: 2 | loss: 0.6475639
	speed: 0.0493s/iter; left time: 2081.7750s
	iters: 400, epoch: 2 | loss: 0.7102351
	speed: 0.0479s/iter; left time: 2020.5252s
	iters: 500, epoch: 2 | loss: 0.5617364
	speed: 0.0482s/iter; left time: 2027.7691s
	iters: 600, epoch: 2 | loss: 2.5511484
	speed: 0.0499s/iter; left time: 2093.3184s
	iters: 700, epoch: 2 | loss: 1.6200764
	speed: 0.0510s/iter; left time: 2134.6414s
	iters: 800, epoch: 2 | loss: 0.9297421
	speed: 0.0485s/iter; left time: 2024.3145s
	iters: 900, epoch: 2 | loss: 1.8156065
	speed: 0.0492s/iter; left time: 2050.6913s
	iters: 1000, epoch: 2 | loss: 0.8710191
	speed: 0.0489s/iter; left time: 2029.3876s
	iters: 1100, epoch: 2 | loss: 0.8222155
	speed: 0.0511s/iter; left time: 2118.2746s
	iters: 1200, epoch: 2 | loss: 0.5632547
	speed: 0.0526s/iter; left time: 2174.4686s
	iters: 1300, epoch: 2 | loss: 0.5509143
	speed: 0.0484s/iter; left time: 1996.9400s
	iters: 1400, epoch: 2 | loss: 0.6572931
	speed: 0.0511s/iter; left time: 2103.8338s
	iters: 1500, epoch: 2 | loss: 1.6037971
	speed: 0.0506s/iter; left time: 2078.5772s
	iters: 1600, epoch: 2 | loss: 0.5588804
	speed: 0.0513s/iter; left time: 2098.6425s
	iters: 1700, epoch: 2 | loss: 4.9362874
	speed: 0.0497s/iter; left time: 2029.2571s
	iters: 1800, epoch: 2 | loss: 2.1950138
	speed: 0.0503s/iter; left time: 2050.7239s
	iters: 1900, epoch: 2 | loss: 0.9783432
	speed: 0.0480s/iter; left time: 1949.3851s
	iters: 2000, epoch: 2 | loss: 0.6430877
	speed: 0.0512s/iter; left time: 2075.9944s
	iters: 2100, epoch: 2 | loss: 0.8134173
	speed: 0.0492s/iter; left time: 1990.2593s
	iters: 2200, epoch: 2 | loss: 0.5488467
	speed: 0.0487s/iter; left time: 1963.1144s
Epoch: 2 cost time: 110.8461229801178
Epoch: 2, Steps: 2239 | Train Loss: 1.1371991 Vali Loss: 0.7297333 Test Loss: 0.3921659
Validation loss decreased (0.729808 --> 0.729733).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 1.7621964
	speed: 0.1411s/iter; left time: 5671.1221s
	iters: 200, epoch: 3 | loss: 0.5659945
	speed: 0.0471s/iter; left time: 1886.9392s
	iters: 300, epoch: 3 | loss: 0.8256145
	speed: 0.0487s/iter; left time: 1946.6617s
	iters: 400, epoch: 3 | loss: 0.7640592
	speed: 0.0494s/iter; left time: 1972.0605s
	iters: 500, epoch: 3 | loss: 0.3871302
	speed: 0.0514s/iter; left time: 2047.5665s
	iters: 600, epoch: 3 | loss: 0.5132033
	speed: 0.0513s/iter; left time: 2035.5505s
	iters: 700, epoch: 3 | loss: 0.7827429
	speed: 0.0479s/iter; left time: 1897.9557s
	iters: 800, epoch: 3 | loss: 0.4345272
	speed: 0.0515s/iter; left time: 2035.3224s
	iters: 900, epoch: 3 | loss: 0.5308408
	speed: 0.0506s/iter; left time: 1993.0277s
	iters: 1000, epoch: 3 | loss: 1.7208531
	speed: 0.0477s/iter; left time: 1875.7959s
	iters: 1100, epoch: 3 | loss: 0.7162255
	speed: 0.0494s/iter; left time: 1935.5829s
	iters: 1200, epoch: 3 | loss: 0.5190405
	speed: 0.0498s/iter; left time: 1949.1351s
	iters: 1300, epoch: 3 | loss: 0.3995825
	speed: 0.0510s/iter; left time: 1989.7157s
	iters: 1400, epoch: 3 | loss: 0.4719875
	speed: 0.0541s/iter; left time: 2103.5393s
	iters: 1500, epoch: 3 | loss: 1.2689364
	speed: 0.0558s/iter; left time: 2163.3885s
	iters: 1600, epoch: 3 | loss: 1.1826475
	speed: 0.0479s/iter; left time: 1853.2123s
	iters: 1700, epoch: 3 | loss: 0.7294855
	speed: 0.0438s/iter; left time: 1692.4237s
	iters: 1800, epoch: 3 | loss: 3.2933342
	speed: 0.0455s/iter; left time: 1750.2946s
	iters: 1900, epoch: 3 | loss: 0.8176583
	speed: 0.0505s/iter; left time: 1940.0199s
	iters: 2000, epoch: 3 | loss: 0.7008219
	speed: 0.0515s/iter; left time: 1974.1314s
	iters: 2100, epoch: 3 | loss: 0.4677171
	speed: 0.0520s/iter; left time: 1987.3438s
	iters: 2200, epoch: 3 | loss: 0.3986785
	speed: 0.0489s/iter; left time: 1862.8928s
Epoch: 3 cost time: 110.49322319030762
Epoch: 3, Steps: 2239 | Train Loss: 0.8313779 Vali Loss: 0.6588563 Test Loss: 0.3536262
Validation loss decreased (0.729733 --> 0.658856).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.5309739
	speed: 0.1430s/iter; left time: 5428.2203s
	iters: 200, epoch: 4 | loss: 0.5989870
	speed: 0.0505s/iter; left time: 1912.6365s
	iters: 300, epoch: 4 | loss: 0.4395080
	speed: 0.0538s/iter; left time: 2030.1687s
	iters: 400, epoch: 4 | loss: 0.6661255
	speed: 0.0516s/iter; left time: 1942.2241s
	iters: 500, epoch: 4 | loss: 0.8291271
	speed: 0.0521s/iter; left time: 1956.5872s
	iters: 600, epoch: 4 | loss: 0.7687849
	speed: 0.0547s/iter; left time: 2048.1522s
	iters: 700, epoch: 4 | loss: 0.4603442
	speed: 0.0492s/iter; left time: 1836.9076s
	iters: 800, epoch: 4 | loss: 0.5713058
	speed: 0.0429s/iter; left time: 1598.7095s
	iters: 900, epoch: 4 | loss: 0.5942169
	speed: 0.0487s/iter; left time: 1808.4015s
	iters: 1000, epoch: 4 | loss: 0.6062943
	speed: 0.0510s/iter; left time: 1889.1049s
	iters: 1100, epoch: 4 | loss: 0.5016490
	speed: 0.0481s/iter; left time: 1778.0844s
	iters: 1200, epoch: 4 | loss: 0.3966825
	speed: 0.0510s/iter; left time: 1880.7845s
	iters: 1300, epoch: 4 | loss: 0.4614538
	speed: 0.0514s/iter; left time: 1890.5281s
	iters: 1400, epoch: 4 | loss: 0.5293868
	speed: 0.0489s/iter; left time: 1791.4686s
	iters: 1500, epoch: 4 | loss: 0.5165220
	speed: 0.0502s/iter; left time: 1834.5212s
	iters: 1600, epoch: 4 | loss: 0.5049642
	speed: 0.0500s/iter; left time: 1823.3336s
	iters: 1700, epoch: 4 | loss: 0.7850735
	speed: 0.0520s/iter; left time: 1889.3096s
	iters: 1800, epoch: 4 | loss: 2.1380084
	speed: 0.0520s/iter; left time: 1886.9693s
	iters: 1900, epoch: 4 | loss: 1.0393157
	speed: 0.0502s/iter; left time: 1814.4027s
	iters: 2000, epoch: 4 | loss: 0.4678202
	speed: 0.0505s/iter; left time: 1820.5191s
	iters: 2100, epoch: 4 | loss: 0.8517789
	speed: 0.0524s/iter; left time: 1885.0795s
	iters: 2200, epoch: 4 | loss: 1.1298568
	speed: 0.0531s/iter; left time: 1906.0122s
Epoch: 4 cost time: 112.15477180480957
Epoch: 4, Steps: 2239 | Train Loss: 0.6818590 Vali Loss: 0.6005130 Test Loss: 0.3348606
Validation loss decreased (0.658856 --> 0.600513).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.7131650
	speed: 0.1486s/iter; left time: 5307.9760s
	iters: 200, epoch: 5 | loss: 0.6364816
	speed: 0.0501s/iter; left time: 1784.0720s
	iters: 300, epoch: 5 | loss: 0.4256817
	speed: 0.0512s/iter; left time: 1820.2722s
	iters: 400, epoch: 5 | loss: 0.5018350
	speed: 0.0474s/iter; left time: 1679.7654s
	iters: 500, epoch: 5 | loss: 0.8048706
	speed: 0.0493s/iter; left time: 1742.7471s
	iters: 600, epoch: 5 | loss: 0.5333383
	speed: 0.0448s/iter; left time: 1579.7920s
	iters: 700, epoch: 5 | loss: 0.5726364
	speed: 0.0512s/iter; left time: 1799.8471s
	iters: 800, epoch: 5 | loss: 0.5817363
	speed: 0.0483s/iter; left time: 1693.1117s
	iters: 900, epoch: 5 | loss: 0.4444649
	speed: 0.0516s/iter; left time: 1801.3600s
	iters: 1000, epoch: 5 | loss: 0.4320763
	speed: 0.0535s/iter; left time: 1861.5499s
	iters: 1100, epoch: 5 | loss: 0.5384108
	speed: 0.0489s/iter; left time: 1697.2532s
	iters: 1200, epoch: 5 | loss: 0.4115964
	speed: 0.0500s/iter; left time: 1731.7509s
	iters: 1300, epoch: 5 | loss: 0.4251208
	speed: 0.0500s/iter; left time: 1727.7749s
	iters: 1400, epoch: 5 | loss: 0.4398771
	speed: 0.0523s/iter; left time: 1800.3153s
	iters: 1500, epoch: 5 | loss: 0.8380427
	speed: 0.0456s/iter; left time: 1564.5474s
	iters: 1600, epoch: 5 | loss: 0.6473947
	speed: 0.0482s/iter; left time: 1648.8529s
	iters: 1700, epoch: 5 | loss: 0.6999850
	speed: 0.0497s/iter; left time: 1696.0328s
	iters: 1800, epoch: 5 | loss: 1.0646137
	speed: 0.0525s/iter; left time: 1785.1418s
	iters: 1900, epoch: 5 | loss: 0.6593958
	speed: 0.0484s/iter; left time: 1641.5863s
	iters: 2000, epoch: 5 | loss: 0.4624055
	speed: 0.0501s/iter; left time: 1693.9381s
	iters: 2100, epoch: 5 | loss: 0.4313930
	speed: 0.0488s/iter; left time: 1644.5677s
	iters: 2200, epoch: 5 | loss: 0.7800778
	speed: 0.0483s/iter; left time: 1623.3577s
Epoch: 5 cost time: 110.62817621231079
Epoch: 5, Steps: 2239 | Train Loss: 0.6382392 Vali Loss: 0.6049866 Test Loss: 0.3259848
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.7567540
	speed: 0.1498s/iter; left time: 5016.3340s
	iters: 200, epoch: 6 | loss: 0.5477597
	speed: 0.0445s/iter; left time: 1485.0647s
	iters: 300, epoch: 6 | loss: 0.4681408
	speed: 0.0511s/iter; left time: 1700.0635s
	iters: 400, epoch: 6 | loss: 0.5599771
	speed: 0.0506s/iter; left time: 1680.2353s
	iters: 500, epoch: 6 | loss: 0.9729293
	speed: 0.0492s/iter; left time: 1626.3076s
	iters: 600, epoch: 6 | loss: 0.9149249
	speed: 0.0495s/iter; left time: 1631.2164s
	iters: 700, epoch: 6 | loss: 0.5513575
	speed: 0.0521s/iter; left time: 1712.6400s
	iters: 800, epoch: 6 | loss: 0.5023235
	speed: 0.0498s/iter; left time: 1633.1013s
	iters: 900, epoch: 6 | loss: 0.5098481
	speed: 0.0493s/iter; left time: 1610.0463s
	iters: 1000, epoch: 6 | loss: 0.4194120
	speed: 0.0510s/iter; left time: 1663.4454s
	iters: 1100, epoch: 6 | loss: 0.9278404
	speed: 0.0466s/iter; left time: 1513.5746s
	iters: 1200, epoch: 6 | loss: 0.4300052
	speed: 0.0527s/iter; left time: 1707.3873s
	iters: 1300, epoch: 6 | loss: 0.6068102
	speed: 0.0525s/iter; left time: 1696.5216s
	iters: 1400, epoch: 6 | loss: 0.3975980
	speed: 0.0514s/iter; left time: 1654.4940s
	iters: 1500, epoch: 6 | loss: 0.7523063
	speed: 0.0529s/iter; left time: 1698.3176s
	iters: 1600, epoch: 6 | loss: 0.4766687
	speed: 0.0560s/iter; left time: 1790.6634s
	iters: 1700, epoch: 6 | loss: 0.7548597
	speed: 0.0488s/iter; left time: 1554.8942s
	iters: 1800, epoch: 6 | loss: 0.7262050
	speed: 0.0518s/iter; left time: 1645.9451s
	iters: 1900, epoch: 6 | loss: 0.5457191
	speed: 0.0512s/iter; left time: 1622.1577s
	iters: 2000, epoch: 6 | loss: 0.4436894
	speed: 0.0507s/iter; left time: 1600.2090s
	iters: 2100, epoch: 6 | loss: 0.5181394
	speed: 0.0497s/iter; left time: 1563.3851s
	iters: 2200, epoch: 6 | loss: 0.4158469
	speed: 0.0470s/iter; left time: 1474.8619s
Epoch: 6 cost time: 111.7256486415863
Epoch: 6, Steps: 2239 | Train Loss: 0.6197392 Vali Loss: 0.6020474 Test Loss: 0.3216357
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.3974047
	speed: 0.1551s/iter; left time: 4846.4164s
	iters: 200, epoch: 7 | loss: 0.4667554
	speed: 0.0476s/iter; left time: 1483.8372s
	iters: 300, epoch: 7 | loss: 0.4170767
	speed: 0.0479s/iter; left time: 1486.0730s
	iters: 400, epoch: 7 | loss: 0.4430710
	speed: 0.0493s/iter; left time: 1526.4362s
	iters: 500, epoch: 7 | loss: 0.4882022
	speed: 0.0534s/iter; left time: 1646.8580s
	iters: 600, epoch: 7 | loss: 0.3786507
	speed: 0.0513s/iter; left time: 1578.8062s
	iters: 700, epoch: 7 | loss: 0.4867252
	speed: 0.0523s/iter; left time: 1601.5844s
	iters: 800, epoch: 7 | loss: 0.4159980
	speed: 0.0562s/iter; left time: 1717.5366s
	iters: 900, epoch: 7 | loss: 0.4154302
	speed: 0.0488s/iter; left time: 1487.0544s
	iters: 1000, epoch: 7 | loss: 0.4162045
	speed: 0.0500s/iter; left time: 1518.0182s
	iters: 1100, epoch: 7 | loss: 0.4609223
	speed: 0.0482s/iter; left time: 1456.6610s
	iters: 1200, epoch: 7 | loss: 0.4587820
	speed: 0.0524s/iter; left time: 1579.9680s
	iters: 1300, epoch: 7 | loss: 0.4767344
	speed: 0.0502s/iter; left time: 1509.5787s
	iters: 1400, epoch: 7 | loss: 0.5927092
	speed: 0.0492s/iter; left time: 1473.9018s
	iters: 1500, epoch: 7 | loss: 0.7340428
	speed: 0.0508s/iter; left time: 1517.5985s
	iters: 1600, epoch: 7 | loss: 0.5268745
	speed: 0.0518s/iter; left time: 1541.7119s
	iters: 1700, epoch: 7 | loss: 0.7277484
	speed: 0.0491s/iter; left time: 1454.3659s
	iters: 1800, epoch: 7 | loss: 0.4301221
	speed: 0.0527s/iter; left time: 1558.0178s
	iters: 1900, epoch: 7 | loss: 0.4757134
	speed: 0.0505s/iter; left time: 1486.9046s
	iters: 2000, epoch: 7 | loss: 0.4734927
	speed: 0.0535s/iter; left time: 1568.8190s
	iters: 2100, epoch: 7 | loss: 0.7540512
	speed: 0.0449s/iter; left time: 1311.9184s
	iters: 2200, epoch: 7 | loss: 0.4302616
	speed: 0.0463s/iter; left time: 1350.8810s
Epoch: 7 cost time: 111.92039465904236
Epoch: 7, Steps: 2239 | Train Loss: 0.6111046 Vali Loss: 0.5997418 Test Loss: 0.3227435
Validation loss decreased (0.600513 --> 0.599742).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.6703952
	speed: 0.1613s/iter; left time: 4678.4369s
	iters: 200, epoch: 8 | loss: 0.9754844
	speed: 0.0495s/iter; left time: 1430.1886s
	iters: 300, epoch: 8 | loss: 0.8005942
	speed: 0.0467s/iter; left time: 1345.1482s
	iters: 400, epoch: 8 | loss: 0.7616653
	speed: 0.0513s/iter; left time: 1473.3724s
	iters: 500, epoch: 8 | loss: 0.4996373
	speed: 0.0517s/iter; left time: 1478.5816s
	iters: 600, epoch: 8 | loss: 0.7293839
	speed: 0.0524s/iter; left time: 1494.3012s
	iters: 700, epoch: 8 | loss: 0.6237845
	speed: 0.0493s/iter; left time: 1401.6982s
	iters: 800, epoch: 8 | loss: 0.6096544
	speed: 0.0503s/iter; left time: 1423.3715s
	iters: 900, epoch: 8 | loss: 0.4499290
	speed: 0.0481s/iter; left time: 1355.4099s
	iters: 1000, epoch: 8 | loss: 0.5744098
	speed: 0.0500s/iter; left time: 1405.3727s
	iters: 1100, epoch: 8 | loss: 0.4794872
	speed: 0.0537s/iter; left time: 1505.1052s
	iters: 1200, epoch: 8 | loss: 0.5265427
	speed: 0.0512s/iter; left time: 1427.5231s
	iters: 1300, epoch: 8 | loss: 0.4754396
	speed: 0.0539s/iter; left time: 1499.6963s
	iters: 1400, epoch: 8 | loss: 0.3876651
	speed: 0.0506s/iter; left time: 1402.9780s
	iters: 1500, epoch: 8 | loss: 0.5094069
	speed: 0.0516s/iter; left time: 1423.6288s
	iters: 1600, epoch: 8 | loss: 0.5321159
	speed: 0.0485s/iter; left time: 1334.1214s
	iters: 1700, epoch: 8 | loss: 0.4240853
	speed: 0.0517s/iter; left time: 1415.7453s
	iters: 1800, epoch: 8 | loss: 0.5643799
	speed: 0.0515s/iter; left time: 1407.3559s
	iters: 1900, epoch: 8 | loss: 0.9104457
	speed: 0.0513s/iter; left time: 1396.0823s
	iters: 2000, epoch: 8 | loss: 0.7151878
	speed: 0.0491s/iter; left time: 1331.7715s
	iters: 2100, epoch: 8 | loss: 0.4932187
	speed: 0.0412s/iter; left time: 1111.6694s
	iters: 2200, epoch: 8 | loss: 0.5456615
	speed: 0.0414s/iter; left time: 1112.8786s
Epoch: 8 cost time: 111.13605737686157
Epoch: 8, Steps: 2239 | Train Loss: 0.6066844 Vali Loss: 0.5932528 Test Loss: 0.3178786
Validation loss decreased (0.599742 --> 0.593253).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.4016438
	speed: 0.1683s/iter; left time: 4505.8426s
	iters: 200, epoch: 9 | loss: 0.4821916
	speed: 0.0458s/iter; left time: 1221.0695s
	iters: 300, epoch: 9 | loss: 0.4270873
	speed: 0.0531s/iter; left time: 1409.7769s
	iters: 400, epoch: 9 | loss: 0.7014464
	speed: 0.0529s/iter; left time: 1400.9120s
	iters: 500, epoch: 9 | loss: 0.7734110
	speed: 0.0539s/iter; left time: 1421.4059s
	iters: 600, epoch: 9 | loss: 0.4966667
	speed: 0.0507s/iter; left time: 1331.6032s
	iters: 700, epoch: 9 | loss: 0.9315129
	speed: 0.0492s/iter; left time: 1287.2077s
	iters: 800, epoch: 9 | loss: 0.4398915
	speed: 0.0433s/iter; left time: 1128.9942s
	iters: 900, epoch: 9 | loss: 0.4970472
	speed: 0.0487s/iter; left time: 1263.9091s
	iters: 1000, epoch: 9 | loss: 0.5720769
	speed: 0.0513s/iter; left time: 1325.9730s
	iters: 1100, epoch: 9 | loss: 0.3771622
	speed: 0.0495s/iter; left time: 1276.0958s
	iters: 1200, epoch: 9 | loss: 0.4067963
	speed: 0.0489s/iter; left time: 1256.3162s
	iters: 1300, epoch: 9 | loss: 0.4800666
	speed: 0.0523s/iter; left time: 1336.7400s
	iters: 1400, epoch: 9 | loss: 0.7228441
	speed: 0.0483s/iter; left time: 1230.4704s
	iters: 1500, epoch: 9 | loss: 0.5514910
	speed: 0.0438s/iter; left time: 1110.5261s
	iters: 1600, epoch: 9 | loss: 0.3533970
	speed: 0.0483s/iter; left time: 1221.0107s
	iters: 1700, epoch: 9 | loss: 0.6807109
	speed: 0.0526s/iter; left time: 1324.5371s
	iters: 1800, epoch: 9 | loss: 0.4782508
	speed: 0.0506s/iter; left time: 1267.4535s
	iters: 1900, epoch: 9 | loss: 0.4298390
	speed: 0.0483s/iter; left time: 1206.2548s
	iters: 2000, epoch: 9 | loss: 0.9983010
	speed: 0.0499s/iter; left time: 1241.9806s
	iters: 2100, epoch: 9 | loss: 0.7682279
	speed: 0.0454s/iter; left time: 1125.2733s
	iters: 2200, epoch: 9 | loss: 0.3968948
	speed: 0.0383s/iter; left time: 944.6065s
Epoch: 9 cost time: 108.65216970443726
Epoch: 9, Steps: 2239 | Train Loss: 0.6044105 Vali Loss: 0.5954839 Test Loss: 0.3179754
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.4915076
	speed: 0.1732s/iter; left time: 4248.6581s
	iters: 200, epoch: 10 | loss: 0.7567296
	speed: 0.0517s/iter; left time: 1263.6690s
	iters: 300, epoch: 10 | loss: 0.4003638
	speed: 0.0482s/iter; left time: 1172.5931s
	iters: 400, epoch: 10 | loss: 0.3960970
	speed: 0.0497s/iter; left time: 1203.5638s
	iters: 500, epoch: 10 | loss: 0.7192934
	speed: 0.0537s/iter; left time: 1295.3234s
	iters: 600, epoch: 10 | loss: 0.3674805
	speed: 0.0505s/iter; left time: 1213.9883s
	iters: 700, epoch: 10 | loss: 0.7950941
	speed: 0.0506s/iter; left time: 1211.1205s
	iters: 800, epoch: 10 | loss: 0.4522365
	speed: 0.0466s/iter; left time: 1109.5487s
	iters: 900, epoch: 10 | loss: 1.0029892
	speed: 0.0495s/iter; left time: 1175.3898s
	iters: 1000, epoch: 10 | loss: 0.4577261
	speed: 0.0496s/iter; left time: 1172.9469s
	iters: 1100, epoch: 10 | loss: 0.8409629
	speed: 0.0516s/iter; left time: 1213.2576s
	iters: 1200, epoch: 10 | loss: 0.4389136
	speed: 0.0513s/iter; left time: 1202.2924s
	iters: 1300, epoch: 10 | loss: 0.4700364
	speed: 0.0480s/iter; left time: 1120.7532s
	iters: 1400, epoch: 10 | loss: 0.6863561
	speed: 0.0485s/iter; left time: 1126.5428s
	iters: 1500, epoch: 10 | loss: 0.5197693
	speed: 0.0513s/iter; left time: 1185.6330s
	iters: 1600, epoch: 10 | loss: 0.4719157
	speed: 0.0466s/iter; left time: 1072.7283s
	iters: 1700, epoch: 10 | loss: 0.3683203
	speed: 0.0527s/iter; left time: 1208.5682s
	iters: 1800, epoch: 10 | loss: 0.4479798
	speed: 0.0518s/iter; left time: 1182.7638s
	iters: 1900, epoch: 10 | loss: 0.7667801
	speed: 0.0503s/iter; left time: 1143.2432s
	iters: 2000, epoch: 10 | loss: 0.6841965
	speed: 0.0497s/iter; left time: 1125.3231s
	iters: 2100, epoch: 10 | loss: 0.3813417
	speed: 0.0379s/iter; left time: 852.9982s
	iters: 2200, epoch: 10 | loss: 0.4147657
	speed: 0.0378s/iter; left time: 847.5544s
Epoch: 10 cost time: 109.39380550384521
Epoch: 10, Steps: 2239 | Train Loss: 0.6033446 Vali Loss: 0.5922936 Test Loss: 0.3180394
Validation loss decreased (0.593253 --> 0.592294).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.6623399
	speed: 0.1721s/iter; left time: 3837.1061s
	iters: 200, epoch: 11 | loss: 0.4708795
	speed: 0.0509s/iter; left time: 1128.4454s
	iters: 300, epoch: 11 | loss: 0.6726971
	speed: 0.0569s/iter; left time: 1257.5372s
	iters: 400, epoch: 11 | loss: 0.4795092
	speed: 0.0549s/iter; left time: 1206.2663s
	iters: 500, epoch: 11 | loss: 0.8673981
	speed: 0.0482s/iter; left time: 1056.0881s
	iters: 600, epoch: 11 | loss: 0.4281511
	speed: 0.0502s/iter; left time: 1094.6648s
	iters: 700, epoch: 11 | loss: 0.5730057
	speed: 0.0499s/iter; left time: 1082.4553s
	iters: 800, epoch: 11 | loss: 0.3735511
	speed: 0.0495s/iter; left time: 1069.4172s
	iters: 900, epoch: 11 | loss: 0.4306807
	speed: 0.0515s/iter; left time: 1106.6157s
	iters: 1000, epoch: 11 | loss: 0.5755454
	speed: 0.0508s/iter; left time: 1086.2208s
	iters: 1100, epoch: 11 | loss: 0.4450843
	speed: 0.0491s/iter; left time: 1045.4656s
	iters: 1200, epoch: 11 | loss: 0.4681338
	speed: 0.0492s/iter; left time: 1042.2037s
	iters: 1300, epoch: 11 | loss: 0.4258822
	speed: 0.0508s/iter; left time: 1070.4972s
	iters: 1400, epoch: 11 | loss: 0.6356338
	speed: 0.0528s/iter; left time: 1109.2980s
	iters: 1500, epoch: 11 | loss: 0.9015667
	speed: 0.0495s/iter; left time: 1033.4439s
	iters: 1600, epoch: 11 | loss: 0.3910518
	speed: 0.0491s/iter; left time: 1020.8663s
	iters: 1700, epoch: 11 | loss: 0.6423579
	speed: 0.0515s/iter; left time: 1065.7998s
	iters: 1800, epoch: 11 | loss: 0.5324931
	speed: 0.0484s/iter; left time: 997.2154s
	iters: 1900, epoch: 11 | loss: 0.7451471
	speed: 0.0489s/iter; left time: 1002.0719s
	iters: 2000, epoch: 11 | loss: 0.5218999
	speed: 0.0467s/iter; left time: 951.4211s
	iters: 2100, epoch: 11 | loss: 0.4763102
	speed: 0.0396s/iter; left time: 803.1064s
	iters: 2200, epoch: 11 | loss: 0.6519150
	speed: 0.0411s/iter; left time: 830.5165s
Epoch: 11 cost time: 110.39051961898804
Epoch: 11, Steps: 2239 | Train Loss: 0.6027310 Vali Loss: 0.5922436 Test Loss: 0.3164355
Validation loss decreased (0.592294 --> 0.592244).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.5168706
	speed: 0.1644s/iter; left time: 3296.2420s
	iters: 200, epoch: 12 | loss: 0.5546973
	speed: 0.0467s/iter; left time: 931.8050s
	iters: 300, epoch: 12 | loss: 0.4915666
	speed: 0.0473s/iter; left time: 938.4434s
	iters: 400, epoch: 12 | loss: 0.5004303
	speed: 0.0437s/iter; left time: 863.1393s
	iters: 500, epoch: 12 | loss: 0.4732379
	speed: 0.0418s/iter; left time: 821.9096s
	iters: 600, epoch: 12 | loss: 0.7565086
	speed: 0.0502s/iter; left time: 981.4962s
	iters: 700, epoch: 12 | loss: 0.7998859
	speed: 0.0471s/iter; left time: 916.9343s
	iters: 800, epoch: 12 | loss: 0.5200242
	speed: 0.0426s/iter; left time: 824.5770s
	iters: 900, epoch: 12 | loss: 0.7181752
	speed: 0.0452s/iter; left time: 869.7871s
	iters: 1000, epoch: 12 | loss: 0.4421367
	speed: 0.0437s/iter; left time: 836.0697s
	iters: 1100, epoch: 12 | loss: 1.2094042
	speed: 0.0444s/iter; left time: 846.7232s
	iters: 1200, epoch: 12 | loss: 0.4138263
	speed: 0.0429s/iter; left time: 812.4457s
	iters: 1300, epoch: 12 | loss: 0.4933227
	speed: 0.0444s/iter; left time: 836.1513s
	iters: 1400, epoch: 12 | loss: 0.6895546
	speed: 0.0430s/iter; left time: 807.0548s
	iters: 1500, epoch: 12 | loss: 0.4225437
	speed: 0.0447s/iter; left time: 833.7724s
	iters: 1600, epoch: 12 | loss: 0.3734698
	speed: 0.0465s/iter; left time: 863.2747s
	iters: 1700, epoch: 12 | loss: 0.5070555
	speed: 0.0440s/iter; left time: 812.4757s
	iters: 1800, epoch: 12 | loss: 0.5447223
	speed: 0.0434s/iter; left time: 796.4544s
	iters: 1900, epoch: 12 | loss: 0.4292891
	speed: 0.0390s/iter; left time: 711.3779s
	iters: 2000, epoch: 12 | loss: 0.3946471
	speed: 0.0375s/iter; left time: 680.8275s
	iters: 2100, epoch: 12 | loss: 0.4758226
	speed: 0.0371s/iter; left time: 670.4139s
	iters: 2200, epoch: 12 | loss: 0.5294567
	speed: 0.0376s/iter; left time: 675.5017s
Epoch: 12 cost time: 97.72787594795227
Epoch: 12, Steps: 2239 | Train Loss: 0.6024701 Vali Loss: 0.5936864 Test Loss: 0.3178840
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.4848165
	speed: 0.1614s/iter; left time: 2874.5644s
	iters: 200, epoch: 13 | loss: 0.4977251
	speed: 0.0411s/iter; left time: 728.2577s
	iters: 300, epoch: 13 | loss: 0.4161090
	speed: 0.0422s/iter; left time: 743.3329s
	iters: 400, epoch: 13 | loss: 0.7192361
	speed: 0.0412s/iter; left time: 721.5100s
	iters: 500, epoch: 13 | loss: 0.3989118
	speed: 0.0381s/iter; left time: 662.7617s
	iters: 600, epoch: 13 | loss: 0.5695525
	speed: 0.0413s/iter; left time: 714.4777s
	iters: 700, epoch: 13 | loss: 0.4663656
	speed: 0.0418s/iter; left time: 720.0761s
	iters: 800, epoch: 13 | loss: 0.4073907
	speed: 0.0454s/iter; left time: 777.3759s
	iters: 900, epoch: 13 | loss: 0.5213715
	speed: 0.0457s/iter; left time: 777.1229s
	iters: 1000, epoch: 13 | loss: 0.6531406
	speed: 0.0420s/iter; left time: 710.1343s
	iters: 1100, epoch: 13 | loss: 0.5385799
	speed: 0.0413s/iter; left time: 693.9593s
	iters: 1200, epoch: 13 | loss: 3.0784249
	speed: 0.0432s/iter; left time: 722.7247s
	iters: 1300, epoch: 13 | loss: 0.3365163
	speed: 0.0407s/iter; left time: 675.6872s
	iters: 1400, epoch: 13 | loss: 0.3848608
	speed: 0.0440s/iter; left time: 727.0761s
	iters: 1500, epoch: 13 | loss: 1.1414213
	speed: 0.0418s/iter; left time: 686.0863s
	iters: 1600, epoch: 13 | loss: 0.6803623
	speed: 0.0420s/iter; left time: 684.5533s
	iters: 1700, epoch: 13 | loss: 0.4023118
	speed: 0.0410s/iter; left time: 665.5222s
	iters: 1800, epoch: 13 | loss: 0.6404665
	speed: 0.0395s/iter; left time: 636.4398s
	iters: 1900, epoch: 13 | loss: 0.5839272
	speed: 0.0384s/iter; left time: 614.6197s
	iters: 2000, epoch: 13 | loss: 0.5264894
	speed: 0.0352s/iter; left time: 560.5860s
	iters: 2100, epoch: 13 | loss: 0.4850474
	speed: 0.0358s/iter; left time: 566.2239s
	iters: 2200, epoch: 13 | loss: 0.4541011
	speed: 0.0372s/iter; left time: 584.8675s
Epoch: 13 cost time: 91.80834197998047
Epoch: 13, Steps: 2239 | Train Loss: 0.6020713 Vali Loss: 0.5931156 Test Loss: 0.3176176
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.4123603
	speed: 0.1462s/iter; left time: 2276.9019s
	iters: 200, epoch: 14 | loss: 0.7200478
	speed: 0.0378s/iter; left time: 584.6361s
	iters: 300, epoch: 14 | loss: 0.4300404
	speed: 0.0360s/iter; left time: 554.1128s
	iters: 400, epoch: 14 | loss: 0.4576910
	speed: 0.0345s/iter; left time: 526.7847s
	iters: 500, epoch: 14 | loss: 0.5002642
	speed: 0.0361s/iter; left time: 548.3127s
	iters: 600, epoch: 14 | loss: 0.8701823
	speed: 0.0335s/iter; left time: 505.1851s
	iters: 700, epoch: 14 | loss: 0.6572415
	speed: 0.0351s/iter; left time: 525.7900s
	iters: 800, epoch: 14 | loss: 0.4553732
	speed: 0.0341s/iter; left time: 507.9392s
	iters: 900, epoch: 14 | loss: 0.5378792
	speed: 0.0361s/iter; left time: 533.7888s
	iters: 1000, epoch: 14 | loss: 0.5751016
	speed: 0.0344s/iter; left time: 505.5116s
	iters: 1100, epoch: 14 | loss: 0.5403007
	speed: 0.0352s/iter; left time: 513.3859s
	iters: 1200, epoch: 14 | loss: 0.5319008
	speed: 0.0365s/iter; left time: 528.8146s
	iters: 1300, epoch: 14 | loss: 0.4620260
	speed: 0.0353s/iter; left time: 506.9179s
	iters: 1400, epoch: 14 | loss: 0.4141406
	speed: 0.0343s/iter; left time: 489.6910s
	iters: 1500, epoch: 14 | loss: 0.4485791
	speed: 0.0352s/iter; left time: 499.5230s
	iters: 1600, epoch: 14 | loss: 0.5745655
	speed: 0.0363s/iter; left time: 510.6197s
	iters: 1700, epoch: 14 | loss: 0.6419108
	speed: 0.0360s/iter; left time: 503.6296s
	iters: 1800, epoch: 14 | loss: 0.4227007
	speed: 0.0363s/iter; left time: 503.5382s
	iters: 1900, epoch: 14 | loss: 0.5056317
	speed: 0.0352s/iter; left time: 484.9322s
	iters: 2000, epoch: 14 | loss: 0.4369310
	speed: 0.0334s/iter; left time: 457.1492s
	iters: 2100, epoch: 14 | loss: 0.7447988
	speed: 0.0334s/iter; left time: 453.0920s
	iters: 2200, epoch: 14 | loss: 0.4995778
	speed: 0.0353s/iter; left time: 475.7653s
Epoch: 14 cost time: 79.53781867027283
Epoch: 14, Steps: 2239 | Train Loss: 0.6021972 Vali Loss: 0.5931175 Test Loss: 0.3175078
EarlyStopping counter: 3 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.4042209
	speed: 0.1231s/iter; left time: 1641.0159s
	iters: 200, epoch: 15 | loss: 0.9147217
	speed: 0.0328s/iter; left time: 433.7684s
	iters: 300, epoch: 15 | loss: 0.4276841
	speed: 0.0337s/iter; left time: 442.1348s
	iters: 400, epoch: 15 | loss: 0.4478232
	speed: 0.0327s/iter; left time: 426.0806s
	iters: 500, epoch: 15 | loss: 0.3954901
	speed: 0.0325s/iter; left time: 420.7163s
	iters: 600, epoch: 15 | loss: 0.4439640
	speed: 0.0336s/iter; left time: 430.8521s
	iters: 700, epoch: 15 | loss: 0.6272364
	speed: 0.0343s/iter; left time: 436.7857s
	iters: 800, epoch: 15 | loss: 0.4299506
	speed: 0.0342s/iter; left time: 432.2297s
	iters: 900, epoch: 15 | loss: 0.7177552
	speed: 0.0331s/iter; left time: 414.8337s
	iters: 1000, epoch: 15 | loss: 0.4867149
	speed: 0.0329s/iter; left time: 408.5679s
	iters: 1100, epoch: 15 | loss: 0.4894593
	speed: 0.0328s/iter; left time: 404.2492s
	iters: 1200, epoch: 15 | loss: 0.4634180
	speed: 0.0341s/iter; left time: 417.4769s
	iters: 1300, epoch: 15 | loss: 0.5619147
	speed: 0.0327s/iter; left time: 396.9278s
	iters: 1400, epoch: 15 | loss: 0.3838288
	speed: 0.0334s/iter; left time: 401.7053s
	iters: 1500, epoch: 15 | loss: 0.4844384
	speed: 0.0333s/iter; left time: 397.3093s
	iters: 1600, epoch: 15 | loss: 0.4841827
	speed: 0.0326s/iter; left time: 386.3589s
	iters: 1700, epoch: 15 | loss: 0.4691021
	speed: 0.0331s/iter; left time: 388.2536s
	iters: 1800, epoch: 15 | loss: 0.5669125
	speed: 0.0341s/iter; left time: 396.3422s
	iters: 1900, epoch: 15 | loss: 2.3434463
	speed: 0.0337s/iter; left time: 388.3346s
	iters: 2000, epoch: 15 | loss: 0.4220363
	speed: 0.0322s/iter; left time: 368.1374s
	iters: 2100, epoch: 15 | loss: 0.7098982
	speed: 0.0320s/iter; left time: 362.9113s
	iters: 2200, epoch: 15 | loss: 0.3967364
	speed: 0.0327s/iter; left time: 367.6196s
Epoch: 15 cost time: 74.3541853427887
Epoch: 15, Steps: 2239 | Train Loss: 0.6021593 Vali Loss: 0.5928091 Test Loss: 0.3174186
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.4025512
	speed: 0.1166s/iter; left time: 1294.2181s
	iters: 200, epoch: 16 | loss: 0.4199582
	speed: 0.0344s/iter; left time: 378.2887s
	iters: 300, epoch: 16 | loss: 0.5691867
	speed: 0.0333s/iter; left time: 362.4829s
	iters: 400, epoch: 16 | loss: 0.4481821
	speed: 0.0324s/iter; left time: 349.9584s
	iters: 500, epoch: 16 | loss: 6.6701107
	speed: 0.0341s/iter; left time: 364.7092s
	iters: 600, epoch: 16 | loss: 0.5399904
	speed: 0.0333s/iter; left time: 352.4880s
	iters: 700, epoch: 16 | loss: 0.5317841
	speed: 0.0338s/iter; left time: 354.2953s
	iters: 800, epoch: 16 | loss: 0.4569246
	speed: 0.0340s/iter; left time: 353.4455s
	iters: 900, epoch: 16 | loss: 0.8058214
	speed: 0.0336s/iter; left time: 345.4856s
	iters: 1000, epoch: 16 | loss: 0.4696622
	speed: 0.0333s/iter; left time: 339.3934s
	iters: 1100, epoch: 16 | loss: 0.4309887
	speed: 0.0336s/iter; left time: 339.4934s
	iters: 1200, epoch: 16 | loss: 0.3837883
	speed: 0.0344s/iter; left time: 343.5732s
	iters: 1300, epoch: 16 | loss: 0.7123797
	speed: 0.0341s/iter; left time: 337.4488s
	iters: 1400, epoch: 16 | loss: 0.5444642
	speed: 0.0338s/iter; left time: 331.5588s
	iters: 1500, epoch: 16 | loss: 0.4664173
	speed: 0.0351s/iter; left time: 340.0046s
	iters: 1600, epoch: 16 | loss: 0.4579123
	speed: 0.0337s/iter; left time: 323.1688s
	iters: 1700, epoch: 16 | loss: 0.4895391
	speed: 0.0341s/iter; left time: 323.9199s
	iters: 1800, epoch: 16 | loss: 0.6591122
	speed: 0.0348s/iter; left time: 327.3551s
	iters: 1900, epoch: 16 | loss: 0.4292802
	speed: 0.0329s/iter; left time: 306.1450s
	iters: 2000, epoch: 16 | loss: 0.4594708
	speed: 0.0310s/iter; left time: 284.8790s
	iters: 2100, epoch: 16 | loss: 0.4141169
	speed: 0.0313s/iter; left time: 285.1388s
	iters: 2200, epoch: 16 | loss: 0.5449154
	speed: 0.0319s/iter; left time: 287.3804s
Epoch: 16 cost time: 74.95474362373352
Epoch: 16, Steps: 2239 | Train Loss: 0.6021455 Vali Loss: 0.5928454 Test Loss: 0.3173965
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : weather_336_720_Linear_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed32598<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9820
mse:0.3163767457008362, mae:0.35876646637916565
