Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='Linear', model_id='ETTm2_336_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=336, root_path='./dataset/', save_pred_values=False, seed=15227, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTm2_336_336_Linear_ETTm2_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15227>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33889
val 11185
test 11185
	iters: 100, epoch: 1 | loss: 0.6225482
	speed: 0.0080s/iter; left time: 167.9814s
	iters: 200, epoch: 1 | loss: 0.4798541
	speed: 0.0083s/iter; left time: 173.9752s
	iters: 300, epoch: 1 | loss: 0.6594170
	speed: 0.0093s/iter; left time: 193.4257s
	iters: 400, epoch: 1 | loss: 0.8810572
	speed: 0.0095s/iter; left time: 197.9513s
	iters: 500, epoch: 1 | loss: 0.4833379
	speed: 0.0087s/iter; left time: 179.0594s
	iters: 600, epoch: 1 | loss: 0.7633923
	speed: 0.0074s/iter; left time: 151.9305s
	iters: 700, epoch: 1 | loss: 0.8668623
	speed: 0.0092s/iter; left time: 188.2521s
	iters: 800, epoch: 1 | loss: 0.5105774
	speed: 0.0090s/iter; left time: 183.2240s
	iters: 900, epoch: 1 | loss: 1.1360859
	speed: 0.0091s/iter; left time: 184.2061s
	iters: 1000, epoch: 1 | loss: 0.6197721
	speed: 0.0090s/iter; left time: 180.6758s
Epoch: 1 cost time: 9.246904611587524
Epoch: 1, Steps: 1059 | Train Loss: 0.5910457 Vali Loss: 0.5912736 Test Loss: 1.3553525
Validation loss decreased (inf --> 0.591274).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.2914272
	speed: 0.0337s/iter; left time: 674.5743s
	iters: 200, epoch: 2 | loss: 0.5202160
	speed: 0.0077s/iter; left time: 153.0131s
	iters: 300, epoch: 2 | loss: 0.3664115
	speed: 0.0077s/iter; left time: 151.9477s
	iters: 400, epoch: 2 | loss: 0.4147709
	speed: 0.0087s/iter; left time: 171.4136s
	iters: 500, epoch: 2 | loss: 0.5296029
	speed: 0.0088s/iter; left time: 171.7605s
	iters: 600, epoch: 2 | loss: 0.3310513
	speed: 0.0082s/iter; left time: 160.3017s
	iters: 700, epoch: 2 | loss: 0.5934470
	speed: 0.0087s/iter; left time: 169.1970s
	iters: 800, epoch: 2 | loss: 0.4433557
	speed: 0.0084s/iter; left time: 161.3458s
	iters: 900, epoch: 2 | loss: 0.7005043
	speed: 0.0081s/iter; left time: 154.8226s
	iters: 1000, epoch: 2 | loss: 0.3578342
	speed: 0.0072s/iter; left time: 137.1498s
Epoch: 2 cost time: 8.614050149917603
Epoch: 2, Steps: 1059 | Train Loss: 0.5959286 Vali Loss: 0.5106503 Test Loss: 1.0839634
Validation loss decreased (0.591274 --> 0.510650).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.4492644
	speed: 0.0335s/iter; left time: 635.7465s
	iters: 200, epoch: 3 | loss: 0.5397147
	speed: 0.0082s/iter; left time: 154.1726s
	iters: 300, epoch: 3 | loss: 0.2778678
	speed: 0.0081s/iter; left time: 152.1973s
	iters: 400, epoch: 3 | loss: 0.5700152
	speed: 0.0067s/iter; left time: 124.5406s
	iters: 500, epoch: 3 | loss: 0.2374910
	speed: 0.0088s/iter; left time: 163.4161s
	iters: 600, epoch: 3 | loss: 0.2820544
	speed: 0.0081s/iter; left time: 149.3381s
	iters: 700, epoch: 3 | loss: 0.2998587
	speed: 0.0074s/iter; left time: 136.6921s
	iters: 800, epoch: 3 | loss: 0.3211167
	speed: 0.0081s/iter; left time: 147.2047s
	iters: 900, epoch: 3 | loss: 0.4750596
	speed: 0.0082s/iter; left time: 148.2733s
	iters: 1000, epoch: 3 | loss: 0.8050262
	speed: 0.0087s/iter; left time: 156.8296s
Epoch: 3 cost time: 8.467883825302124
Epoch: 3, Steps: 1059 | Train Loss: 0.4416995 Vali Loss: 0.4348324 Test Loss: 1.0199969
Validation loss decreased (0.510650 --> 0.434832).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.2789138
	speed: 0.0349s/iter; left time: 625.1409s
	iters: 200, epoch: 4 | loss: 0.3402281
	speed: 0.0093s/iter; left time: 164.7336s
	iters: 300, epoch: 4 | loss: 0.3254355
	speed: 0.0078s/iter; left time: 137.9440s
	iters: 400, epoch: 4 | loss: 0.8575226
	speed: 0.0085s/iter; left time: 150.3956s
	iters: 500, epoch: 4 | loss: 0.2786454
	speed: 0.0082s/iter; left time: 143.3581s
	iters: 600, epoch: 4 | loss: 0.3417358
	speed: 0.0074s/iter; left time: 129.1591s
	iters: 700, epoch: 4 | loss: 0.3980522
	speed: 0.0076s/iter; left time: 132.0853s
	iters: 800, epoch: 4 | loss: 0.2734139
	speed: 0.0079s/iter; left time: 136.3608s
	iters: 900, epoch: 4 | loss: 0.5273181
	speed: 0.0071s/iter; left time: 121.7811s
	iters: 1000, epoch: 4 | loss: 0.3509258
	speed: 0.0065s/iter; left time: 110.0450s
Epoch: 4 cost time: 8.272238969802856
Epoch: 4, Steps: 1059 | Train Loss: 0.3949243 Vali Loss: 0.2949233 Test Loss: 0.5516379
Validation loss decreased (0.434832 --> 0.294923).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.5132748
	speed: 0.0313s/iter; left time: 527.2151s
	iters: 200, epoch: 5 | loss: 0.4039795
	speed: 0.0076s/iter; left time: 127.3929s
	iters: 300, epoch: 5 | loss: 0.5574424
	speed: 0.0084s/iter; left time: 139.2235s
	iters: 400, epoch: 5 | loss: 0.1325319
	speed: 0.0078s/iter; left time: 128.7618s
	iters: 500, epoch: 5 | loss: 0.2764420
	speed: 0.0087s/iter; left time: 143.4136s
	iters: 600, epoch: 5 | loss: 0.4505038
	speed: 0.0091s/iter; left time: 149.1075s
	iters: 700, epoch: 5 | loss: 0.4990100
	speed: 0.0079s/iter; left time: 127.7348s
	iters: 800, epoch: 5 | loss: 0.3659249
	speed: 0.0074s/iter; left time: 119.8334s
	iters: 900, epoch: 5 | loss: 0.2123027
	speed: 0.0064s/iter; left time: 103.3013s
	iters: 1000, epoch: 5 | loss: 0.1796205
	speed: 0.0087s/iter; left time: 139.0401s
Epoch: 5 cost time: 8.541722774505615
Epoch: 5, Steps: 1059 | Train Loss: 0.3742150 Vali Loss: 0.5075026 Test Loss: 1.2366586
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.3130310
	speed: 0.0322s/iter; left time: 507.8638s
	iters: 200, epoch: 6 | loss: 0.3503640
	speed: 0.0080s/iter; left time: 125.1744s
	iters: 300, epoch: 6 | loss: 0.2851986
	speed: 0.0079s/iter; left time: 123.4823s
	iters: 400, epoch: 6 | loss: 0.2499974
	speed: 0.0082s/iter; left time: 127.6602s
	iters: 500, epoch: 6 | loss: 0.3560192
	speed: 0.0081s/iter; left time: 124.0831s
	iters: 600, epoch: 6 | loss: 0.4248567
	speed: 0.0088s/iter; left time: 135.1437s
	iters: 700, epoch: 6 | loss: 0.3157886
	speed: 0.0084s/iter; left time: 127.4339s
	iters: 800, epoch: 6 | loss: 0.4576075
	speed: 0.0088s/iter; left time: 133.0588s
	iters: 900, epoch: 6 | loss: 0.2396383
	speed: 0.0089s/iter; left time: 133.8531s
	iters: 1000, epoch: 6 | loss: 0.2369104
	speed: 0.0079s/iter; left time: 118.2353s
Epoch: 6 cost time: 8.779802083969116
Epoch: 6, Steps: 1059 | Train Loss: 0.3616651 Vali Loss: 0.2716477 Test Loss: 0.4971266
Validation loss decreased (0.294923 --> 0.271648).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.2334167
	speed: 0.0345s/iter; left time: 507.9083s
	iters: 200, epoch: 7 | loss: 0.3790216
	speed: 0.0086s/iter; left time: 125.1821s
	iters: 300, epoch: 7 | loss: 0.2815348
	speed: 0.0090s/iter; left time: 131.3695s
	iters: 400, epoch: 7 | loss: 0.2530262
	speed: 0.0086s/iter; left time: 124.6775s
	iters: 500, epoch: 7 | loss: 0.3627789
	speed: 0.0087s/iter; left time: 124.1109s
	iters: 600, epoch: 7 | loss: 0.3052261
	speed: 0.0089s/iter; left time: 126.4931s
	iters: 700, epoch: 7 | loss: 0.2431526
	speed: 0.0099s/iter; left time: 140.2038s
	iters: 800, epoch: 7 | loss: 0.2293958
	speed: 0.0098s/iter; left time: 137.0630s
	iters: 900, epoch: 7 | loss: 0.2848984
	speed: 0.0088s/iter; left time: 123.0094s
	iters: 1000, epoch: 7 | loss: 0.2307741
	speed: 0.0083s/iter; left time: 114.9385s
Epoch: 7 cost time: 9.351774215698242
Epoch: 7, Steps: 1059 | Train Loss: 0.3554246 Vali Loss: 0.2979836 Test Loss: 0.5695615
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.2204898
	speed: 0.0334s/iter; left time: 456.5845s
	iters: 200, epoch: 8 | loss: 0.2427596
	speed: 0.0082s/iter; left time: 111.4042s
	iters: 300, epoch: 8 | loss: 0.2206033
	speed: 0.0078s/iter; left time: 105.3631s
	iters: 400, epoch: 8 | loss: 0.7584395
	speed: 0.0092s/iter; left time: 122.6111s
	iters: 500, epoch: 8 | loss: 0.3561031
	speed: 0.0093s/iter; left time: 122.8519s
	iters: 600, epoch: 8 | loss: 0.3051547
	speed: 0.0085s/iter; left time: 111.4345s
	iters: 700, epoch: 8 | loss: 0.2585428
	speed: 0.0084s/iter; left time: 109.1578s
	iters: 800, epoch: 8 | loss: 0.2469667
	speed: 0.0056s/iter; left time: 72.7825s
	iters: 900, epoch: 8 | loss: 0.3148218
	speed: 0.0087s/iter; left time: 111.7146s
	iters: 1000, epoch: 8 | loss: 0.3000176
	speed: 0.0078s/iter; left time: 99.8235s
Epoch: 8 cost time: 8.673767566680908
Epoch: 8, Steps: 1059 | Train Loss: 0.3523541 Vali Loss: 0.2955865 Test Loss: 0.5741682
EarlyStopping counter: 2 out of 5
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.3994988
	speed: 0.0319s/iter; left time: 402.4511s
	iters: 200, epoch: 9 | loss: 0.2346568
	speed: 0.0086s/iter; left time: 108.0849s
	iters: 300, epoch: 9 | loss: 0.2579604
	speed: 0.0092s/iter; left time: 113.9382s
	iters: 400, epoch: 9 | loss: 0.6825837
	speed: 0.0085s/iter; left time: 104.8896s
	iters: 500, epoch: 9 | loss: 0.5487074
	speed: 0.0086s/iter; left time: 105.0238s
	iters: 600, epoch: 9 | loss: 0.3139615
	speed: 0.0085s/iter; left time: 103.0779s
	iters: 700, epoch: 9 | loss: 0.3060940
	speed: 0.0087s/iter; left time: 104.6173s
	iters: 800, epoch: 9 | loss: 0.2518043
	speed: 0.0087s/iter; left time: 103.1019s
	iters: 900, epoch: 9 | loss: 0.4815516
	speed: 0.0070s/iter; left time: 82.4206s
	iters: 1000, epoch: 9 | loss: 0.2966955
	speed: 0.0086s/iter; left time: 100.4957s
Epoch: 9 cost time: 8.944206953048706
Epoch: 9, Steps: 1059 | Train Loss: 0.3504349 Vali Loss: 0.2811065 Test Loss: 0.5253648
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.4187456
	speed: 0.0341s/iter; left time: 393.6309s
	iters: 200, epoch: 10 | loss: 0.1543767
	speed: 0.0090s/iter; left time: 102.8122s
	iters: 300, epoch: 10 | loss: 0.2628186
	speed: 0.0085s/iter; left time: 96.3907s
	iters: 400, epoch: 10 | loss: 0.4338543
	speed: 0.0082s/iter; left time: 92.7769s
	iters: 500, epoch: 10 | loss: 0.3433048
	speed: 0.0073s/iter; left time: 81.6662s
	iters: 600, epoch: 10 | loss: 0.2168218
	speed: 0.0090s/iter; left time: 99.6994s
	iters: 700, epoch: 10 | loss: 0.4827031
	speed: 0.0087s/iter; left time: 95.2743s
	iters: 800, epoch: 10 | loss: 0.5765654
	speed: 0.0083s/iter; left time: 90.5870s
	iters: 900, epoch: 10 | loss: 0.2320049
	speed: 0.0093s/iter; left time: 99.9960s
	iters: 1000, epoch: 10 | loss: 0.2614468
	speed: 0.0091s/iter; left time: 97.0374s
Epoch: 10 cost time: 9.003509283065796
Epoch: 10, Steps: 1059 | Train Loss: 0.3493547 Vali Loss: 0.2987275 Test Loss: 0.5840361
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.1837588
	speed: 0.0343s/iter; left time: 359.9113s
	iters: 200, epoch: 11 | loss: 0.3375126
	speed: 0.0088s/iter; left time: 91.5530s
	iters: 300, epoch: 11 | loss: 0.2146466
	speed: 0.0073s/iter; left time: 74.8154s
	iters: 400, epoch: 11 | loss: 0.1882352
	speed: 0.0078s/iter; left time: 79.5071s
	iters: 500, epoch: 11 | loss: 0.2602627
	speed: 0.0084s/iter; left time: 84.2941s
	iters: 600, epoch: 11 | loss: 0.1713242
	speed: 0.0081s/iter; left time: 80.8495s
	iters: 700, epoch: 11 | loss: 0.6885601
	speed: 0.0086s/iter; left time: 85.5294s
	iters: 800, epoch: 11 | loss: 0.2695737
	speed: 0.0087s/iter; left time: 84.7283s
	iters: 900, epoch: 11 | loss: 0.2643534
	speed: 0.0087s/iter; left time: 84.6023s
	iters: 1000, epoch: 11 | loss: 0.3225775
	speed: 0.0074s/iter; left time: 70.9876s
Epoch: 11 cost time: 8.58551287651062
Epoch: 11, Steps: 1059 | Train Loss: 0.3486898 Vali Loss: 0.2916958 Test Loss: 0.5556200
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTm2_336_336_Linear_ETTm2_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15227<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
mse:0.49762997031211853, mae:0.4448792636394501
