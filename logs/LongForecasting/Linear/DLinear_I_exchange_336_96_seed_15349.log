Args in experiment:
Namespace(activation='gelu', batch_size=8, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='exchange_rate.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=8, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='mse', lradj='type1', model='DLinear', model_id='Exchange_336_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=15349, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : Exchange_336_96_DLinear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15349>>>>>>>>>>>>>>>>>>>>>>>>>>
train 4880
val 665
test 1422
	iters: 100, epoch: 1 | loss: 0.1334403
	speed: 0.0062s/iter; left time: 74.9438s
	iters: 200, epoch: 1 | loss: 0.3614277
	speed: 0.0058s/iter; left time: 69.7260s
	iters: 300, epoch: 1 | loss: 0.1991034
	speed: 0.0062s/iter; left time: 73.7034s
	iters: 400, epoch: 1 | loss: 0.1016261
	speed: 0.0057s/iter; left time: 66.9117s
	iters: 500, epoch: 1 | loss: 0.1531216
	speed: 0.0062s/iter; left time: 72.7035s
	iters: 600, epoch: 1 | loss: 0.0854802
	speed: 0.0059s/iter; left time: 68.5841s
Epoch: 1 cost time: 3.6661629676818848
Epoch: 1, Steps: 610 | Train Loss: 0.1640718 Vali Loss: 0.2099545 Test Loss: 0.1249111
Validation loss decreased (inf --> 0.209955).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1718223
	speed: 0.0106s/iter; left time: 121.2695s
	iters: 200, epoch: 2 | loss: 0.0794225
	speed: 0.0068s/iter; left time: 77.5727s
	iters: 300, epoch: 2 | loss: 0.1899944
	speed: 0.0071s/iter; left time: 79.7589s
	iters: 400, epoch: 2 | loss: 0.1025188
	speed: 0.0060s/iter; left time: 66.7197s
	iters: 500, epoch: 2 | loss: 0.0901076
	speed: 0.0063s/iter; left time: 69.6854s
	iters: 600, epoch: 2 | loss: 0.1113662
	speed: 0.0068s/iter; left time: 74.2123s
Epoch: 2 cost time: 3.9934422969818115
Epoch: 2, Steps: 610 | Train Loss: 0.1236272 Vali Loss: 0.3567708 Test Loss: 0.1456396
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.0703967
	speed: 0.0111s/iter; left time: 120.8173s
	iters: 200, epoch: 3 | loss: 0.0524148
	speed: 0.0072s/iter; left time: 77.3262s
	iters: 300, epoch: 3 | loss: 0.0653039
	speed: 0.0073s/iter; left time: 78.0062s
	iters: 400, epoch: 3 | loss: 0.1687458
	speed: 0.0065s/iter; left time: 69.0753s
	iters: 500, epoch: 3 | loss: 0.0708132
	speed: 0.0065s/iter; left time: 68.5672s
	iters: 600, epoch: 3 | loss: 0.0807857
	speed: 0.0063s/iter; left time: 65.2243s
Epoch: 3 cost time: 4.108198642730713
Epoch: 3, Steps: 610 | Train Loss: 0.1148979 Vali Loss: 0.2643290 Test Loss: 0.1420429
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1067770
	speed: 0.0100s/iter; left time: 103.0367s
	iters: 200, epoch: 4 | loss: 0.0924452
	speed: 0.0064s/iter; left time: 65.3801s
	iters: 300, epoch: 4 | loss: 0.0763045
	speed: 0.0065s/iter; left time: 65.1802s
	iters: 400, epoch: 4 | loss: 0.2173726
	speed: 0.0067s/iter; left time: 66.7920s
	iters: 500, epoch: 4 | loss: 0.0869192
	speed: 0.0066s/iter; left time: 65.3686s
	iters: 600, epoch: 4 | loss: 0.0853933
	speed: 0.0066s/iter; left time: 64.2036s
Epoch: 4 cost time: 3.9703726768493652
Epoch: 4, Steps: 610 | Train Loss: 0.1114291 Vali Loss: 0.2277763 Test Loss: 0.0916030
EarlyStopping counter: 3 out of 5
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1389255
	speed: 0.0107s/iter; left time: 103.4984s
	iters: 200, epoch: 5 | loss: 0.0842244
	speed: 0.0050s/iter; left time: 48.1731s
	iters: 300, epoch: 5 | loss: 0.0625948
	speed: 0.0054s/iter; left time: 51.1054s
	iters: 400, epoch: 5 | loss: 0.0993529
	speed: 0.0064s/iter; left time: 60.1218s
	iters: 500, epoch: 5 | loss: 0.0945245
	speed: 0.0052s/iter; left time: 48.4352s
	iters: 600, epoch: 5 | loss: 0.0664936
	speed: 0.0058s/iter; left time: 53.4353s
Epoch: 5 cost time: 3.4928157329559326
Epoch: 5, Steps: 610 | Train Loss: 0.1095643 Vali Loss: 0.2196255 Test Loss: 0.0978286
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0617912
	speed: 0.0107s/iter; left time: 96.5920s
	iters: 200, epoch: 6 | loss: 0.1079354
	speed: 0.0062s/iter; left time: 55.1378s
	iters: 300, epoch: 6 | loss: 0.0678421
	speed: 0.0058s/iter; left time: 51.1729s
	iters: 400, epoch: 6 | loss: 0.0653872
	speed: 0.0061s/iter; left time: 53.1457s
	iters: 500, epoch: 6 | loss: 0.1069104
	speed: 0.0054s/iter; left time: 47.0613s
	iters: 600, epoch: 6 | loss: 0.0855493
	speed: 0.0055s/iter; left time: 47.3849s
Epoch: 6 cost time: 3.5988070964813232
Epoch: 6, Steps: 610 | Train Loss: 0.1086955 Vali Loss: 0.1921288 Test Loss: 0.0881308
Validation loss decreased (0.209955 --> 0.192129).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.0727575
	speed: 0.0095s/iter; left time: 80.2917s
	iters: 200, epoch: 7 | loss: 0.1270756
	speed: 0.0068s/iter; left time: 56.5559s
	iters: 300, epoch: 7 | loss: 0.0678330
	speed: 0.0064s/iter; left time: 52.3479s
	iters: 400, epoch: 7 | loss: 0.0955059
	speed: 0.0063s/iter; left time: 51.4617s
	iters: 500, epoch: 7 | loss: 0.0584201
	speed: 0.0063s/iter; left time: 51.0602s
	iters: 600, epoch: 7 | loss: 0.0988077
	speed: 0.0066s/iter; left time: 52.5876s
Epoch: 7 cost time: 3.8668062686920166
Epoch: 7, Steps: 610 | Train Loss: 0.1082335 Vali Loss: 0.1917783 Test Loss: 0.0888426
Validation loss decreased (0.192129 --> 0.191778).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.0928604
	speed: 0.0101s/iter; left time: 78.7299s
	iters: 200, epoch: 8 | loss: 0.1695365
	speed: 0.0062s/iter; left time: 47.7046s
	iters: 300, epoch: 8 | loss: 0.0634683
	speed: 0.0062s/iter; left time: 47.5560s
	iters: 400, epoch: 8 | loss: 0.2059770
	speed: 0.0063s/iter; left time: 47.5489s
	iters: 500, epoch: 8 | loss: 0.0840032
	speed: 0.0072s/iter; left time: 53.7232s
	iters: 600, epoch: 8 | loss: 0.1040619
	speed: 0.0063s/iter; left time: 46.3463s
Epoch: 8 cost time: 3.8880534172058105
Epoch: 8, Steps: 610 | Train Loss: 0.1079728 Vali Loss: 0.2000565 Test Loss: 0.0901395
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.0849461
	speed: 0.0099s/iter; left time: 71.7196s
	iters: 200, epoch: 9 | loss: 0.0799207
	speed: 0.0056s/iter; left time: 40.1158s
	iters: 300, epoch: 9 | loss: 0.0813371
	speed: 0.0056s/iter; left time: 39.0368s
	iters: 400, epoch: 9 | loss: 0.1021654
	speed: 0.0057s/iter; left time: 39.4659s
	iters: 500, epoch: 9 | loss: 0.1088005
	speed: 0.0056s/iter; left time: 38.3339s
	iters: 600, epoch: 9 | loss: 0.2061623
	speed: 0.0056s/iter; left time: 37.6559s
Epoch: 9 cost time: 3.475059747695923
Epoch: 9, Steps: 610 | Train Loss: 0.1079032 Vali Loss: 0.1987626 Test Loss: 0.0897038
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.0490191
	speed: 0.0091s/iter; left time: 60.0958s
	iters: 200, epoch: 10 | loss: 0.0961062
	speed: 0.0059s/iter; left time: 38.3498s
	iters: 300, epoch: 10 | loss: 0.3920000
	speed: 0.0060s/iter; left time: 38.4176s
	iters: 400, epoch: 10 | loss: 0.0733032
	speed: 0.0058s/iter; left time: 36.6790s
	iters: 500, epoch: 10 | loss: 0.1365816
	speed: 0.0056s/iter; left time: 34.4742s
	iters: 600, epoch: 10 | loss: 0.0732871
	speed: 0.0055s/iter; left time: 33.5632s
Epoch: 10 cost time: 3.4749033451080322
Epoch: 10, Steps: 610 | Train Loss: 0.1077906 Vali Loss: 0.2007366 Test Loss: 0.0892960
EarlyStopping counter: 3 out of 5
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 11 | loss: 0.1074904
	speed: 0.0086s/iter; left time: 51.8656s
	iters: 200, epoch: 11 | loss: 0.0836725
	speed: 0.0055s/iter; left time: 32.5698s
	iters: 300, epoch: 11 | loss: 0.0715837
	speed: 0.0051s/iter; left time: 29.8387s
	iters: 400, epoch: 11 | loss: 0.1222005
	speed: 0.0051s/iter; left time: 28.9610s
	iters: 500, epoch: 11 | loss: 0.1527716
	speed: 0.0051s/iter; left time: 28.4085s
	iters: 600, epoch: 11 | loss: 0.1343409
	speed: 0.0051s/iter; left time: 27.7824s
Epoch: 11 cost time: 3.1648354530334473
Epoch: 11, Steps: 610 | Train Loss: 0.1077554 Vali Loss: 0.1996489 Test Loss: 0.0888584
EarlyStopping counter: 4 out of 5
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 12 | loss: 0.0796449
	speed: 0.0088s/iter; left time: 47.3511s
	iters: 200, epoch: 12 | loss: 0.0996216
	speed: 0.0049s/iter; left time: 26.0869s
	iters: 300, epoch: 12 | loss: 0.0929435
	speed: 0.0049s/iter; left time: 25.2378s
	iters: 400, epoch: 12 | loss: 0.0829005
	speed: 0.0053s/iter; left time: 27.0842s
	iters: 500, epoch: 12 | loss: 0.0767500
	speed: 0.0049s/iter; left time: 24.3165s
	iters: 600, epoch: 12 | loss: 0.1080279
	speed: 0.0048s/iter; left time: 23.2739s
Epoch: 12 cost time: 3.0866260528564453
Epoch: 12, Steps: 610 | Train Loss: 0.1077278 Vali Loss: 0.1992265 Test Loss: 0.0886876
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : Exchange_336_96_DLinear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15349<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 1422
mse:0.08871733397245407, mae:0.21796786785125732
