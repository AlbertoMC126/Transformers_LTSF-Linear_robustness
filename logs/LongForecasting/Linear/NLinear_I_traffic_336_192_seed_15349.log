Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='NLinear', model_id='traffic_336_192', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=192, root_path='./dataset/', save_pred_values=False, seed=15349, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_336_192_NLinear_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15349>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11753
val 1565
test 3317
	iters: 100, epoch: 1 | loss: 0.6484275
	speed: 0.3158s/iter; left time: 4604.7750s
	iters: 200, epoch: 1 | loss: 0.9711006
	speed: 0.3017s/iter; left time: 4368.5867s
	iters: 300, epoch: 1 | loss: 0.8285825
	speed: 0.2998s/iter; left time: 4310.9778s
	iters: 400, epoch: 1 | loss: 0.6875108
	speed: 0.3030s/iter; left time: 4327.7823s
	iters: 500, epoch: 1 | loss: 0.8138543
	speed: 0.2999s/iter; left time: 4253.1453s
	iters: 600, epoch: 1 | loss: 0.8536083
	speed: 0.3001s/iter; left time: 4225.2522s
	iters: 700, epoch: 1 | loss: 0.9169251
	speed: 0.2998s/iter; left time: 4191.8459s
Epoch: 1 cost time: 222.43757939338684
Epoch: 1, Steps: 734 | Train Loss: 1.1473050 Vali Loss: 1.0122025 Test Loss: 1.2374330
Validation loss decreased (inf --> 1.012203).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.5939890
	speed: 0.6031s/iter; left time: 8351.4086s
	iters: 200, epoch: 2 | loss: 1.0043483
	speed: 0.2997s/iter; left time: 4120.1634s
	iters: 300, epoch: 2 | loss: 1.6453439
	speed: 0.2997s/iter; left time: 4089.7252s
	iters: 400, epoch: 2 | loss: 1.3424799
	speed: 0.2997s/iter; left time: 4059.4310s
	iters: 500, epoch: 2 | loss: 1.8900764
	speed: 0.3001s/iter; left time: 4035.2061s
	iters: 600, epoch: 2 | loss: 0.5680087
	speed: 0.3001s/iter; left time: 4005.5691s
	iters: 700, epoch: 2 | loss: 0.7806262
	speed: 0.3029s/iter; left time: 4012.6557s
Epoch: 2 cost time: 220.42237281799316
Epoch: 2, Steps: 734 | Train Loss: 1.0441073 Vali Loss: 1.6844739 Test Loss: 1.7179258
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.3340828
	speed: 0.6010s/iter; left time: 7880.5427s
	iters: 200, epoch: 3 | loss: 0.2839766
	speed: 0.3000s/iter; left time: 3903.7273s
	iters: 300, epoch: 3 | loss: 0.3431810
	speed: 0.2990s/iter; left time: 3861.1228s
	iters: 400, epoch: 3 | loss: 0.3736386
	speed: 0.2995s/iter; left time: 3837.9944s
	iters: 500, epoch: 3 | loss: 0.3084720
	speed: 0.2999s/iter; left time: 3812.0723s
	iters: 600, epoch: 3 | loss: 0.3472601
	speed: 0.3000s/iter; left time: 3784.1983s
	iters: 700, epoch: 3 | loss: 0.3558012
	speed: 0.2998s/iter; left time: 3751.4929s
Epoch: 3 cost time: 219.9841320514679
Epoch: 3, Steps: 734 | Train Loss: 0.3604533 Vali Loss: 0.5170136 Test Loss: 0.6183156
Validation loss decreased (1.012203 --> 0.517014).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.2703806
	speed: 0.6035s/iter; left time: 7470.9359s
	iters: 200, epoch: 4 | loss: 0.2615084
	speed: 0.2997s/iter; left time: 3679.4819s
	iters: 300, epoch: 4 | loss: 0.2716026
	speed: 0.3028s/iter; left time: 3687.8948s
	iters: 400, epoch: 4 | loss: 0.2888988
	speed: 0.2996s/iter; left time: 3619.0666s
	iters: 500, epoch: 4 | loss: 0.2805929
	speed: 0.2999s/iter; left time: 3592.1760s
	iters: 600, epoch: 4 | loss: 0.2747799
	speed: 0.2999s/iter; left time: 3562.6823s
	iters: 700, epoch: 4 | loss: 0.2817856
	speed: 0.2998s/iter; left time: 3531.4082s
Epoch: 4 cost time: 220.4067931175232
Epoch: 4, Steps: 734 | Train Loss: 0.2855278 Vali Loss: 0.4012286 Test Loss: 0.4972872
Validation loss decreased (0.517014 --> 0.401229).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.2914615
	speed: 0.6044s/iter; left time: 7038.0909s
	iters: 200, epoch: 5 | loss: 0.2590186
	speed: 0.2987s/iter; left time: 3448.0903s
	iters: 300, epoch: 5 | loss: 0.2846680
	speed: 0.2998s/iter; left time: 3430.7088s
	iters: 400, epoch: 5 | loss: 0.2638417
	speed: 0.2998s/iter; left time: 3400.8485s
	iters: 500, epoch: 5 | loss: 0.2791483
	speed: 0.3032s/iter; left time: 3408.9714s
	iters: 600, epoch: 5 | loss: 0.2389379
	speed: 0.2998s/iter; left time: 3341.4161s
	iters: 700, epoch: 5 | loss: 0.2696566
	speed: 0.3000s/iter; left time: 3313.7756s
Epoch: 5 cost time: 220.45726037025452
Epoch: 5, Steps: 734 | Train Loss: 0.2646103 Vali Loss: 0.3756582 Test Loss: 0.4677376
Validation loss decreased (0.401229 --> 0.375658).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.2518094
	speed: 0.6060s/iter; left time: 6612.1223s
	iters: 200, epoch: 6 | loss: 0.2464179
	speed: 0.3001s/iter; left time: 3244.2962s
	iters: 300, epoch: 6 | loss: 0.2757449
	speed: 0.2997s/iter; left time: 3210.4755s
	iters: 400, epoch: 6 | loss: 0.2357551
	speed: 0.2997s/iter; left time: 3180.5129s
	iters: 500, epoch: 6 | loss: 0.2493634
	speed: 0.3000s/iter; left time: 3152.8199s
	iters: 600, epoch: 6 | loss: 0.2281619
	speed: 0.3000s/iter; left time: 3123.3080s
	iters: 700, epoch: 6 | loss: 0.3104059
	speed: 0.2998s/iter; left time: 3091.6978s
Epoch: 6 cost time: 220.70026230812073
Epoch: 6, Steps: 734 | Train Loss: 0.2544274 Vali Loss: 0.3632649 Test Loss: 0.4522500
Validation loss decreased (0.375658 --> 0.363265).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.2693872
	speed: 0.6074s/iter; left time: 6181.1914s
	iters: 200, epoch: 7 | loss: 0.2695895
	speed: 0.3008s/iter; left time: 3031.1796s
	iters: 300, epoch: 7 | loss: 0.2625530
	speed: 0.3015s/iter; left time: 3008.0030s
	iters: 400, epoch: 7 | loss: 0.2579765
	speed: 0.3000s/iter; left time: 2963.1464s
	iters: 500, epoch: 7 | loss: 0.2348362
	speed: 0.3000s/iter; left time: 2932.9779s
	iters: 600, epoch: 7 | loss: 0.2314539
	speed: 0.3000s/iter; left time: 2902.9711s
	iters: 700, epoch: 7 | loss: 0.2409067
	speed: 0.3009s/iter; left time: 2882.1584s
Epoch: 7 cost time: 220.6865746974945
Epoch: 7, Steps: 734 | Train Loss: 0.2489334 Vali Loss: 0.3560961 Test Loss: 0.4434492
Validation loss decreased (0.363265 --> 0.356096).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.2334272
	speed: 0.6074s/iter; left time: 5735.5067s
	iters: 200, epoch: 8 | loss: 0.2446118
	speed: 0.3002s/iter; left time: 2804.8516s
	iters: 300, epoch: 8 | loss: 0.2336507
	speed: 0.3030s/iter; left time: 2800.9318s
	iters: 400, epoch: 8 | loss: 0.2392894
	speed: 0.3020s/iter; left time: 2760.8263s
	iters: 500, epoch: 8 | loss: 0.2263949
	speed: 0.3000s/iter; left time: 2712.6257s
	iters: 600, epoch: 8 | loss: 0.2675745
	speed: 0.2995s/iter; left time: 2678.0923s
	iters: 700, epoch: 8 | loss: 0.2480509
	speed: 0.2998s/iter; left time: 2651.2144s
Epoch: 8 cost time: 220.8130385875702
Epoch: 8, Steps: 734 | Train Loss: 0.2457063 Vali Loss: 0.3534675 Test Loss: 0.4405844
Validation loss decreased (0.356096 --> 0.353468).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.2332022
	speed: 0.6062s/iter; left time: 5279.4621s
	iters: 200, epoch: 9 | loss: 0.2430825
	speed: 0.3007s/iter; left time: 2588.3799s
	iters: 300, epoch: 9 | loss: 0.2430032
	speed: 0.3009s/iter; left time: 2560.5155s
	iters: 400, epoch: 9 | loss: 0.2436233
	speed: 0.3016s/iter; left time: 2536.3671s
	iters: 500, epoch: 9 | loss: 0.2071593
	speed: 0.3018s/iter; left time: 2507.5491s
	iters: 600, epoch: 9 | loss: 0.2434169
	speed: 0.3048s/iter; left time: 2502.2689s
	iters: 700, epoch: 9 | loss: 0.2492164
	speed: 0.3028s/iter; left time: 2455.5253s
Epoch: 9 cost time: 221.8671109676361
Epoch: 9, Steps: 734 | Train Loss: 0.2438295 Vali Loss: 0.3513244 Test Loss: 0.4381765
Validation loss decreased (0.353468 --> 0.351324).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.2583931
	speed: 0.6073s/iter; left time: 4843.5563s
	iters: 200, epoch: 10 | loss: 0.2536374
	speed: 0.3018s/iter; left time: 2376.3301s
	iters: 300, epoch: 10 | loss: 0.2402542
	speed: 0.3019s/iter; left time: 2347.6470s
	iters: 400, epoch: 10 | loss: 0.2454186
	speed: 0.3016s/iter; left time: 2314.4223s
	iters: 500, epoch: 10 | loss: 0.2407733
	speed: 0.3018s/iter; left time: 2286.1191s
	iters: 600, epoch: 10 | loss: 0.2489759
	speed: 0.3021s/iter; left time: 2258.0955s
	iters: 700, epoch: 10 | loss: 0.2327810
	speed: 0.3025s/iter; left time: 2231.0385s
Epoch: 10 cost time: 221.72694540023804
Epoch: 10, Steps: 734 | Train Loss: 0.2427233 Vali Loss: 0.3503711 Test Loss: 0.4371383
Validation loss decreased (0.351324 --> 0.350371).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.2435406
	speed: 0.6131s/iter; left time: 4439.1491s
	iters: 200, epoch: 11 | loss: 0.2612018
	speed: 0.3024s/iter; left time: 2159.3300s
	iters: 300, epoch: 11 | loss: 0.2239003
	speed: 0.3023s/iter; left time: 2128.2313s
	iters: 400, epoch: 11 | loss: 0.2653454
	speed: 0.3005s/iter; left time: 2086.0603s
	iters: 500, epoch: 11 | loss: 0.2491305
	speed: 0.3020s/iter; left time: 2066.2741s
	iters: 600, epoch: 11 | loss: 0.2311414
	speed: 0.3019s/iter; left time: 2034.8710s
	iters: 700, epoch: 11 | loss: 0.2282876
	speed: 0.3021s/iter; left time: 2006.4726s
Epoch: 11 cost time: 222.08540558815002
Epoch: 11, Steps: 734 | Train Loss: 0.2421299 Vali Loss: 0.3500007 Test Loss: 0.4366460
Validation loss decreased (0.350371 --> 0.350001).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.2423908
	speed: 0.6091s/iter; left time: 3963.4408s
	iters: 200, epoch: 12 | loss: 0.2472931
	speed: 0.3020s/iter; left time: 1935.1923s
	iters: 300, epoch: 12 | loss: 0.2403094
	speed: 0.3023s/iter; left time: 1906.4021s
	iters: 400, epoch: 12 | loss: 0.2351698
	speed: 0.3009s/iter; left time: 1867.5833s
	iters: 500, epoch: 12 | loss: 0.2493276
	speed: 0.3022s/iter; left time: 1845.5625s
	iters: 600, epoch: 12 | loss: 0.2257231
	speed: 0.3011s/iter; left time: 1808.6060s
	iters: 700, epoch: 12 | loss: 0.2316100
	speed: 0.3018s/iter; left time: 1782.7303s
Epoch: 12 cost time: 221.65007400512695
Epoch: 12, Steps: 734 | Train Loss: 0.2417881 Vali Loss: 0.3494791 Test Loss: 0.4364167
Validation loss decreased (0.350001 --> 0.349479).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.2327333
	speed: 0.6094s/iter; left time: 3518.2431s
	iters: 200, epoch: 13 | loss: 0.2491829
	speed: 0.3026s/iter; left time: 1716.7822s
	iters: 300, epoch: 13 | loss: 0.2327856
	speed: 0.3057s/iter; left time: 1703.5503s
	iters: 400, epoch: 13 | loss: 0.2360368
	speed: 0.3011s/iter; left time: 1647.7675s
	iters: 500, epoch: 13 | loss: 0.2567388
	speed: 0.3019s/iter; left time: 1622.2031s
	iters: 600, epoch: 13 | loss: 0.2336768
	speed: 0.3023s/iter; left time: 1593.7994s
	iters: 700, epoch: 13 | loss: 0.2398311
	speed: 0.3022s/iter; left time: 1563.0678s
Epoch: 13 cost time: 222.26154041290283
Epoch: 13, Steps: 734 | Train Loss: 0.2416104 Vali Loss: 0.3497489 Test Loss: 0.4363094
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 14 | loss: 0.2347315
	speed: 0.6043s/iter; left time: 3045.0128s
	iters: 200, epoch: 14 | loss: 0.2660252
	speed: 0.3018s/iter; left time: 1490.7808s
	iters: 300, epoch: 14 | loss: 0.2161006
	speed: 0.3007s/iter; left time: 1455.0469s
	iters: 400, epoch: 14 | loss: 0.2365101
	speed: 0.3023s/iter; left time: 1432.4417s
	iters: 500, epoch: 14 | loss: 0.2363403
	speed: 0.3024s/iter; left time: 1402.6518s
	iters: 600, epoch: 14 | loss: 0.2504819
	speed: 0.3027s/iter; left time: 1373.7468s
	iters: 700, epoch: 14 | loss: 0.2283119
	speed: 0.3025s/iter; left time: 1342.9171s
Epoch: 14 cost time: 221.7221302986145
Epoch: 14, Steps: 734 | Train Loss: 0.2414980 Vali Loss: 0.3498962 Test Loss: 0.4362830
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 15 | loss: 0.2447667
	speed: 0.6099s/iter; left time: 2625.4092s
	iters: 200, epoch: 15 | loss: 0.2091518
	speed: 0.3016s/iter; left time: 1268.3872s
	iters: 300, epoch: 15 | loss: 0.2623136
	speed: 0.3023s/iter; left time: 1240.7415s
	iters: 400, epoch: 15 | loss: 0.2369283
	speed: 0.3007s/iter; left time: 1204.2640s
	iters: 500, epoch: 15 | loss: 0.2448181
	speed: 0.3006s/iter; left time: 1173.7801s
	iters: 600, epoch: 15 | loss: 0.2106793
	speed: 0.3025s/iter; left time: 1150.9209s
	iters: 700, epoch: 15 | loss: 0.2457026
	speed: 0.3020s/iter; left time: 1118.8096s
Epoch: 15 cost time: 221.88158512115479
Epoch: 15, Steps: 734 | Train Loss: 0.2414567 Vali Loss: 0.3497936 Test Loss: 0.4362399
EarlyStopping counter: 3 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 16 | loss: 0.2304014
	speed: 0.6064s/iter; left time: 2165.5409s
	iters: 200, epoch: 16 | loss: 0.2384727
	speed: 0.3025s/iter; left time: 1049.8594s
	iters: 300, epoch: 16 | loss: 0.2299266
	speed: 0.3022s/iter; left time: 1018.8240s
	iters: 400, epoch: 16 | loss: 0.2321395
	speed: 0.3048s/iter; left time: 996.9611s
	iters: 500, epoch: 16 | loss: 0.2469211
	speed: 0.3023s/iter; left time: 958.6206s
	iters: 600, epoch: 16 | loss: 0.2251144
	speed: 0.3018s/iter; left time: 926.8059s
	iters: 700, epoch: 16 | loss: 0.2378157
	speed: 0.3023s/iter; left time: 898.2629s
Epoch: 16 cost time: 222.04332661628723
Epoch: 16, Steps: 734 | Train Loss: 0.2414265 Vali Loss: 0.3499474 Test Loss: 0.4362264
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 17 | loss: 0.2265683
	speed: 0.6048s/iter; left time: 1715.7869s
	iters: 200, epoch: 17 | loss: 0.2500805
	speed: 0.3026s/iter; left time: 828.3259s
	iters: 300, epoch: 17 | loss: 0.2330877
	speed: 0.3020s/iter; left time: 796.2979s
	iters: 400, epoch: 17 | loss: 0.2558341
	speed: 0.3003s/iter; left time: 761.7594s
	iters: 500, epoch: 17 | loss: 0.2457316
	speed: 0.3006s/iter; left time: 732.5459s
	iters: 600, epoch: 17 | loss: 0.2654623
	speed: 0.3004s/iter; left time: 702.0796s
	iters: 700, epoch: 17 | loss: 0.2252019
	speed: 0.3050s/iter; left time: 682.1939s
Epoch: 17 cost time: 221.55075931549072
Epoch: 17, Steps: 734 | Train Loss: 0.2413980 Vali Loss: 0.3495092 Test Loss: 0.4362243
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : traffic_336_192_NLinear_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15349<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3317
mse:0.4360673129558563, mae:0.2993832528591156
