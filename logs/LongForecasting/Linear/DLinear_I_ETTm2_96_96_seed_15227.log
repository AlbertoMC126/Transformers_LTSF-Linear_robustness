Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='DLinear', model_id='ETTm2_96_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=15227, seq_len=96, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTm2_96_96_DLinear_ETTm2_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15227>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34369
data_set:  <data_provider.data_loader.Dataset_ETT_minute object at 0x000002478CEF0550>
val 11425
data_set:  <data_provider.data_loader.Dataset_ETT_minute object at 0x00000247DA4D7DD8>
test 11425
data_set:  <data_provider.data_loader.Dataset_ETT_minute object at 0x000002478CEF0208>
Total number of trainable parameters: 130368
Total number of parameters: 130368
	iters: 100, epoch: 1 | loss: 0.3900339
	speed: 0.0049s/iter; left time: 104.2726s
	iters: 200, epoch: 1 | loss: 0.1789505
	speed: 0.0049s/iter; left time: 104.6593s
	iters: 300, epoch: 1 | loss: 0.2071729
	speed: 0.0054s/iter; left time: 114.8443s
	iters: 400, epoch: 1 | loss: 0.2881010
	speed: 0.0054s/iter; left time: 112.8319s
	iters: 500, epoch: 1 | loss: 0.1957514
	speed: 0.0050s/iter; left time: 104.6807s
	iters: 600, epoch: 1 | loss: 0.2392283
	speed: 0.0050s/iter; left time: 103.6441s
	iters: 700, epoch: 1 | loss: 0.8366095
	speed: 0.0044s/iter; left time: 90.8930s
	iters: 800, epoch: 1 | loss: 0.3393515
	speed: 0.0047s/iter; left time: 97.2756s
	iters: 900, epoch: 1 | loss: 0.2266476
	speed: 0.0051s/iter; left time: 105.2714s
	iters: 1000, epoch: 1 | loss: 0.5507299
	speed: 0.0061s/iter; left time: 125.5934s
Epoch: 1 cost time: 5.497616291046143
Epoch: 1, Steps: 1074 | Train Loss: 0.2795098 Vali Loss: 0.1949481 Test Loss: 0.3311329
Validation loss decreased (inf --> 0.194948).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.1561983
	speed: 0.0256s/iter; left time: 520.4786s
	iters: 200, epoch: 2 | loss: 0.2896015
	speed: 0.0048s/iter; left time: 97.1118s
	iters: 300, epoch: 2 | loss: 0.2339763
	speed: 0.0049s/iter; left time: 98.1736s
	iters: 400, epoch: 2 | loss: 0.2684502
	speed: 0.0040s/iter; left time: 80.2844s
	iters: 500, epoch: 2 | loss: 0.2218634
	speed: 0.0053s/iter; left time: 105.6137s
	iters: 600, epoch: 2 | loss: 0.1860228
	speed: 0.0047s/iter; left time: 94.0656s
	iters: 700, epoch: 2 | loss: 0.1789434
	speed: 0.0054s/iter; left time: 107.0160s
	iters: 800, epoch: 2 | loss: 0.3011211
	speed: 0.0046s/iter; left time: 90.1872s
	iters: 900, epoch: 2 | loss: 0.4414192
	speed: 0.0056s/iter; left time: 109.6032s
	iters: 1000, epoch: 2 | loss: 0.1942566
	speed: 0.0053s/iter; left time: 102.0999s
Epoch: 2 cost time: 5.410682916641235
Epoch: 2, Steps: 1074 | Train Loss: 0.2739418 Vali Loss: 0.1828826 Test Loss: 0.3279862
Validation loss decreased (0.194948 --> 0.182883).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.1606320
	speed: 0.0257s/iter; left time: 493.7562s
	iters: 200, epoch: 3 | loss: 0.1245623
	speed: 0.0055s/iter; left time: 105.7547s
	iters: 300, epoch: 3 | loss: 0.3232846
	speed: 0.0047s/iter; left time: 90.4006s
	iters: 400, epoch: 3 | loss: 0.1741004
	speed: 0.0048s/iter; left time: 90.4891s
	iters: 500, epoch: 3 | loss: 0.2834810
	speed: 0.0057s/iter; left time: 107.2453s
	iters: 600, epoch: 3 | loss: 0.1877095
	speed: 0.0055s/iter; left time: 103.3322s
	iters: 700, epoch: 3 | loss: 0.1795584
	speed: 0.0050s/iter; left time: 93.6525s
	iters: 800, epoch: 3 | loss: 0.1043395
	speed: 0.0057s/iter; left time: 105.0820s
	iters: 900, epoch: 3 | loss: 0.2428402
	speed: 0.0056s/iter; left time: 102.7276s
	iters: 1000, epoch: 3 | loss: 0.1519841
	speed: 0.0049s/iter; left time: 89.6062s
Epoch: 3 cost time: 5.807570934295654
Epoch: 3, Steps: 1074 | Train Loss: 0.2417226 Vali Loss: 0.1575209 Test Loss: 0.2607166
Validation loss decreased (0.182883 --> 0.157521).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.1417282
	speed: 0.0260s/iter; left time: 472.6239s
	iters: 200, epoch: 4 | loss: 0.1182507
	speed: 0.0060s/iter; left time: 107.6619s
	iters: 300, epoch: 4 | loss: 0.2490665
	speed: 0.0056s/iter; left time: 99.7981s
	iters: 400, epoch: 4 | loss: 0.1136437
	speed: 0.0054s/iter; left time: 96.0731s
	iters: 500, epoch: 4 | loss: 0.2038172
	speed: 0.0061s/iter; left time: 108.5602s
	iters: 600, epoch: 4 | loss: 0.2225611
	speed: 0.0050s/iter; left time: 88.0277s
	iters: 700, epoch: 4 | loss: 0.1616327
	speed: 0.0045s/iter; left time: 79.8080s
	iters: 800, epoch: 4 | loss: 0.2976357
	speed: 0.0052s/iter; left time: 90.4775s
	iters: 900, epoch: 4 | loss: 0.1292662
	speed: 0.0059s/iter; left time: 103.2587s
	iters: 1000, epoch: 4 | loss: 0.1620024
	speed: 0.0049s/iter; left time: 85.1258s
Epoch: 4 cost time: 5.760751724243164
Epoch: 4, Steps: 1074 | Train Loss: 0.2303931 Vali Loss: 0.1490947 Test Loss: 0.2419932
Validation loss decreased (0.157521 --> 0.149095).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.3807742
	speed: 0.0282s/iter; left time: 481.8483s
	iters: 200, epoch: 5 | loss: 0.1295682
	speed: 0.0061s/iter; left time: 104.3902s
	iters: 300, epoch: 5 | loss: 0.1591314
	speed: 0.0057s/iter; left time: 96.0302s
	iters: 400, epoch: 5 | loss: 0.1536669
	speed: 0.0053s/iter; left time: 89.3185s
	iters: 500, epoch: 5 | loss: 0.1849984
	speed: 0.0050s/iter; left time: 82.5922s
	iters: 600, epoch: 5 | loss: 0.2492894
	speed: 0.0060s/iter; left time: 100.3291s
	iters: 700, epoch: 5 | loss: 0.2206689
	speed: 0.0053s/iter; left time: 86.7378s
	iters: 800, epoch: 5 | loss: 0.1519552
	speed: 0.0051s/iter; left time: 83.9150s
	iters: 900, epoch: 5 | loss: 0.3285042
	speed: 0.0049s/iter; left time: 79.0878s
	iters: 1000, epoch: 5 | loss: 0.1454444
	speed: 0.0051s/iter; left time: 81.8153s
Epoch: 5 cost time: 5.840984582901001
Epoch: 5, Steps: 1074 | Train Loss: 0.2238671 Vali Loss: 0.1339870 Test Loss: 0.2036443
Validation loss decreased (0.149095 --> 0.133987).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.2530975
	speed: 0.0250s/iter; left time: 401.0644s
	iters: 200, epoch: 6 | loss: 0.1869216
	speed: 0.0046s/iter; left time: 73.6426s
	iters: 300, epoch: 6 | loss: 0.1391867
	speed: 0.0050s/iter; left time: 79.4311s
	iters: 400, epoch: 6 | loss: 0.1536260
	speed: 0.0053s/iter; left time: 82.6684s
	iters: 500, epoch: 6 | loss: 0.2503692
	speed: 0.0053s/iter; left time: 82.9883s
	iters: 600, epoch: 6 | loss: 0.1129841
	speed: 0.0057s/iter; left time: 88.0529s
	iters: 700, epoch: 6 | loss: 0.3358361
	speed: 0.0069s/iter; left time: 107.0170s
	iters: 800, epoch: 6 | loss: 0.1582754
	speed: 0.0059s/iter; left time: 89.9521s
	iters: 900, epoch: 6 | loss: 0.2394518
	speed: 0.0054s/iter; left time: 81.7623s
	iters: 1000, epoch: 6 | loss: 0.1339878
	speed: 0.0062s/iter; left time: 93.4514s
Epoch: 6 cost time: 6.005683660507202
Epoch: 6, Steps: 1074 | Train Loss: 0.2206024 Vali Loss: 0.1409343 Test Loss: 0.2291060
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.2172677
	speed: 0.0250s/iter; left time: 372.9039s
	iters: 200, epoch: 7 | loss: 0.1631129
	speed: 0.0061s/iter; left time: 90.7028s
	iters: 300, epoch: 7 | loss: 0.1820076
	speed: 0.0052s/iter; left time: 76.9477s
	iters: 400, epoch: 7 | loss: 0.2051154
	speed: 0.0050s/iter; left time: 73.7771s
	iters: 500, epoch: 7 | loss: 0.2136461
	speed: 0.0057s/iter; left time: 82.2755s
	iters: 600, epoch: 7 | loss: 0.3079536
	speed: 0.0055s/iter; left time: 78.9307s
	iters: 700, epoch: 7 | loss: 0.1807868
	speed: 0.0055s/iter; left time: 78.5191s
	iters: 800, epoch: 7 | loss: 0.1206454
	speed: 0.0053s/iter; left time: 74.8800s
	iters: 900, epoch: 7 | loss: 0.1770036
	speed: 0.0049s/iter; left time: 68.7533s
	iters: 1000, epoch: 7 | loss: 0.1090266
	speed: 0.0055s/iter; left time: 77.7578s
Epoch: 7 cost time: 5.743671655654907
Epoch: 7, Steps: 1074 | Train Loss: 0.2186457 Vali Loss: 0.1504421 Test Loss: 0.2522247
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.1815198
	speed: 0.0235s/iter; left time: 325.2833s
	iters: 200, epoch: 8 | loss: 0.3037621
	speed: 0.0045s/iter; left time: 62.3471s
	iters: 300, epoch: 8 | loss: 0.2320443
	speed: 0.0052s/iter; left time: 70.7460s
	iters: 400, epoch: 8 | loss: 0.5002300
	speed: 0.0056s/iter; left time: 76.5498s
	iters: 500, epoch: 8 | loss: 0.1201899
	speed: 0.0046s/iter; left time: 61.6058s
	iters: 600, epoch: 8 | loss: 0.4889190
	speed: 0.0052s/iter; left time: 69.2045s
	iters: 700, epoch: 8 | loss: 0.2396670
	speed: 0.0047s/iter; left time: 61.6938s
	iters: 800, epoch: 8 | loss: 0.2159117
	speed: 0.0059s/iter; left time: 77.6711s
	iters: 900, epoch: 8 | loss: 0.1136134
	speed: 0.0056s/iter; left time: 72.8070s
	iters: 1000, epoch: 8 | loss: 0.1146403
	speed: 0.0046s/iter; left time: 59.7487s
Epoch: 8 cost time: 5.570652961730957
Epoch: 8, Steps: 1074 | Train Loss: 0.2175292 Vali Loss: 0.1473457 Test Loss: 0.2481786
EarlyStopping counter: 3 out of 5
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.1525127
	speed: 0.0249s/iter; left time: 318.2072s
	iters: 200, epoch: 9 | loss: 0.1893500
	speed: 0.0049s/iter; left time: 61.6655s
	iters: 300, epoch: 9 | loss: 0.2182740
	speed: 0.0056s/iter; left time: 70.3575s
	iters: 400, epoch: 9 | loss: 0.2197928
	speed: 0.0051s/iter; left time: 64.1527s
	iters: 500, epoch: 9 | loss: 0.3212252
	speed: 0.0058s/iter; left time: 72.2104s
	iters: 600, epoch: 9 | loss: 0.1783690
	speed: 0.0066s/iter; left time: 81.4459s
	iters: 700, epoch: 9 | loss: 0.1949326
	speed: 0.0051s/iter; left time: 61.6102s
	iters: 800, epoch: 9 | loss: 0.1572482
	speed: 0.0061s/iter; left time: 73.4036s
	iters: 900, epoch: 9 | loss: 0.2089060
	speed: 0.0046s/iter; left time: 54.8626s
	iters: 1000, epoch: 9 | loss: 0.1467196
	speed: 0.0060s/iter; left time: 70.8382s
Epoch: 9 cost time: 5.895004987716675
Epoch: 9, Steps: 1074 | Train Loss: 0.2169498 Vali Loss: 0.1459932 Test Loss: 0.2405179
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.2213069
	speed: 0.0228s/iter; left time: 267.4323s
	iters: 200, epoch: 10 | loss: 0.1268239
	speed: 0.0063s/iter; left time: 73.4023s
	iters: 300, epoch: 10 | loss: 0.1719525
	speed: 0.0047s/iter; left time: 54.4769s
	iters: 400, epoch: 10 | loss: 0.1233413
	speed: 0.0047s/iter; left time: 53.6950s
	iters: 500, epoch: 10 | loss: 0.3094398
	speed: 0.0064s/iter; left time: 72.1713s
	iters: 600, epoch: 10 | loss: 0.2460336
	speed: 0.0063s/iter; left time: 70.9397s
	iters: 700, epoch: 10 | loss: 0.1568049
	speed: 0.0052s/iter; left time: 57.4366s
	iters: 800, epoch: 10 | loss: 0.1304360
	speed: 0.0065s/iter; left time: 72.0729s
	iters: 900, epoch: 10 | loss: 0.0979117
	speed: 0.0051s/iter; left time: 55.6186s
	iters: 1000, epoch: 10 | loss: 0.1464275
	speed: 0.0053s/iter; left time: 57.6745s
Epoch: 10 cost time: 5.848883867263794
Epoch: 10, Steps: 1074 | Train Loss: 0.2166276 Vali Loss: 0.1505232 Test Loss: 0.2550660
EarlyStopping counter: 5 out of 5
Early stopping
Total training time: 72.5504 seconds
>>>>>>>testing : ETTm2_96_96_DLinear_ETTm2_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15227<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
data_set:  <data_provider.data_loader.Dataset_ETT_minute object at 0x000002478CEE3860>
mse:0.20402967929840088, mae:0.29215314984321594
