Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='DLinear', model_id='ETTm2_96_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=15726, seq_len=96, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTm2_96_96_DLinear_ETTm2_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15726>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34369
data_set:  <data_provider.data_loader.Dataset_ETT_minute object at 0x00000293D0F90550>
val 11425
data_set:  <data_provider.data_loader.Dataset_ETT_minute object at 0x000002939E597DD8>
test 11425
data_set:  <data_provider.data_loader.Dataset_ETT_minute object at 0x00000293D0F90208>
Total number of trainable parameters: 130368
Total number of parameters: 130368
	iters: 100, epoch: 1 | loss: 0.2299188
	speed: 0.0057s/iter; left time: 121.6165s
	iters: 200, epoch: 1 | loss: 0.3183952
	speed: 0.0050s/iter; left time: 106.7035s
	iters: 300, epoch: 1 | loss: 0.2470190
	speed: 0.0048s/iter; left time: 101.7615s
	iters: 400, epoch: 1 | loss: 0.3161294
	speed: 0.0058s/iter; left time: 121.3258s
	iters: 500, epoch: 1 | loss: 0.2791366
	speed: 0.0052s/iter; left time: 109.7556s
	iters: 600, epoch: 1 | loss: 0.3257280
	speed: 0.0060s/iter; left time: 125.9288s
	iters: 700, epoch: 1 | loss: 0.1592365
	speed: 0.0063s/iter; left time: 130.4281s
	iters: 800, epoch: 1 | loss: 0.2583774
	speed: 0.0045s/iter; left time: 93.6995s
	iters: 900, epoch: 1 | loss: 0.2443119
	speed: 0.0053s/iter; left time: 108.1951s
	iters: 1000, epoch: 1 | loss: 0.2618884
	speed: 0.0059s/iter; left time: 120.8058s
Epoch: 1 cost time: 5.805697441101074
Epoch: 1, Steps: 1074 | Train Loss: 0.2755288 Vali Loss: 0.1694660 Test Loss: 0.2714231
Validation loss decreased (inf --> 0.169466).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.3029225
	speed: 0.0260s/iter; left time: 527.9479s
	iters: 200, epoch: 2 | loss: 0.2289729
	speed: 0.0058s/iter; left time: 118.1163s
	iters: 300, epoch: 2 | loss: 0.2211961
	speed: 0.0051s/iter; left time: 102.3114s
	iters: 400, epoch: 2 | loss: 0.3342433
	speed: 0.0044s/iter; left time: 88.1847s
	iters: 500, epoch: 2 | loss: 0.3178470
	speed: 0.0067s/iter; left time: 132.7897s
	iters: 600, epoch: 2 | loss: 0.2333938
	speed: 0.0055s/iter; left time: 108.2537s
	iters: 700, epoch: 2 | loss: 0.1950571
	speed: 0.0046s/iter; left time: 91.3004s
	iters: 800, epoch: 2 | loss: 0.3916205
	speed: 0.0056s/iter; left time: 109.8350s
	iters: 900, epoch: 2 | loss: 0.1912027
	speed: 0.0050s/iter; left time: 97.9796s
	iters: 1000, epoch: 2 | loss: 0.1558644
	speed: 0.0053s/iter; left time: 102.5008s
Epoch: 2 cost time: 5.69613242149353
Epoch: 2, Steps: 1074 | Train Loss: 0.2775772 Vali Loss: 0.2409933 Test Loss: 0.3988103
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.1773753
	speed: 0.0232s/iter; left time: 445.2989s
	iters: 200, epoch: 3 | loss: 0.2215659
	speed: 0.0053s/iter; left time: 101.8332s
	iters: 300, epoch: 3 | loss: 0.1489474
	speed: 0.0064s/iter; left time: 122.4673s
	iters: 400, epoch: 3 | loss: 0.1586646
	speed: 0.0063s/iter; left time: 119.6106s
	iters: 500, epoch: 3 | loss: 0.1798115
	speed: 0.0048s/iter; left time: 91.1035s
	iters: 600, epoch: 3 | loss: 0.6230682
	speed: 0.0047s/iter; left time: 88.2742s
	iters: 700, epoch: 3 | loss: 0.2014862
	speed: 0.0051s/iter; left time: 95.5953s
	iters: 800, epoch: 3 | loss: 0.7093261
	speed: 0.0056s/iter; left time: 103.8099s
	iters: 900, epoch: 3 | loss: 0.2009895
	speed: 0.0046s/iter; left time: 84.9701s
	iters: 1000, epoch: 3 | loss: 0.1316767
	speed: 0.0062s/iter; left time: 114.5403s
Epoch: 3 cost time: 5.825257301330566
Epoch: 3, Steps: 1074 | Train Loss: 0.2439205 Vali Loss: 0.1464216 Test Loss: 0.2245563
Validation loss decreased (0.169466 --> 0.146422).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.1879786
	speed: 0.0252s/iter; left time: 457.0331s
	iters: 200, epoch: 4 | loss: 0.2860210
	speed: 0.0049s/iter; left time: 88.9259s
	iters: 300, epoch: 4 | loss: 0.1563034
	speed: 0.0055s/iter; left time: 98.5211s
	iters: 400, epoch: 4 | loss: 0.3133415
	speed: 0.0049s/iter; left time: 87.8431s
	iters: 500, epoch: 4 | loss: 0.2541676
	speed: 0.0055s/iter; left time: 98.0368s
	iters: 600, epoch: 4 | loss: 0.4982352
	speed: 0.0045s/iter; left time: 79.7036s
	iters: 700, epoch: 4 | loss: 0.2859743
	speed: 0.0052s/iter; left time: 92.1005s
	iters: 800, epoch: 4 | loss: 0.1738646
	speed: 0.0063s/iter; left time: 109.2440s
	iters: 900, epoch: 4 | loss: 0.2256830
	speed: 0.0043s/iter; left time: 75.5042s
	iters: 1000, epoch: 4 | loss: 0.2921480
	speed: 0.0060s/iter; left time: 103.2928s
Epoch: 4 cost time: 5.554450035095215
Epoch: 4, Steps: 1074 | Train Loss: 0.2308477 Vali Loss: 0.2336793 Test Loss: 0.4781485
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.1769696
	speed: 0.0248s/iter; left time: 424.3082s
	iters: 200, epoch: 5 | loss: 0.1146206
	speed: 0.0058s/iter; left time: 99.0777s
	iters: 300, epoch: 5 | loss: 0.1583726
	speed: 0.0058s/iter; left time: 97.2231s
	iters: 400, epoch: 5 | loss: 0.1629779
	speed: 0.0058s/iter; left time: 97.9205s
	iters: 500, epoch: 5 | loss: 0.2101730
	speed: 0.0052s/iter; left time: 86.6615s
	iters: 600, epoch: 5 | loss: 0.1696404
	speed: 0.0055s/iter; left time: 90.7622s
	iters: 700, epoch: 5 | loss: 0.1295025
	speed: 0.0058s/iter; left time: 95.5047s
	iters: 800, epoch: 5 | loss: 0.1943453
	speed: 0.0063s/iter; left time: 103.6877s
	iters: 900, epoch: 5 | loss: 0.2863856
	speed: 0.0056s/iter; left time: 91.1697s
	iters: 1000, epoch: 5 | loss: 0.1497852
	speed: 0.0048s/iter; left time: 76.9056s
Epoch: 5 cost time: 6.048221111297607
Epoch: 5, Steps: 1074 | Train Loss: 0.2243703 Vali Loss: 0.1740823 Test Loss: 0.3302347
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.3849621
	speed: 0.0247s/iter; left time: 395.5202s
	iters: 200, epoch: 6 | loss: 0.4636170
	speed: 0.0057s/iter; left time: 91.2308s
	iters: 300, epoch: 6 | loss: 0.3527022
	speed: 0.0054s/iter; left time: 85.5244s
	iters: 400, epoch: 6 | loss: 0.1649498
	speed: 0.0053s/iter; left time: 83.3445s
	iters: 500, epoch: 6 | loss: 0.1253523
	speed: 0.0055s/iter; left time: 85.8715s
	iters: 600, epoch: 6 | loss: 0.1433866
	speed: 0.0058s/iter; left time: 89.2160s
	iters: 700, epoch: 6 | loss: 0.2375057
	speed: 0.0048s/iter; left time: 74.0408s
	iters: 800, epoch: 6 | loss: 0.1765853
	speed: 0.0047s/iter; left time: 72.6515s
	iters: 900, epoch: 6 | loss: 0.2460434
	speed: 0.0056s/iter; left time: 85.2853s
	iters: 1000, epoch: 6 | loss: 0.1722837
	speed: 0.0055s/iter; left time: 83.5896s
Epoch: 6 cost time: 5.682699918746948
Epoch: 6, Steps: 1074 | Train Loss: 0.2205040 Vali Loss: 0.1292537 Test Loss: 0.1916246
Validation loss decreased (0.146422 --> 0.129254).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.1834543
	speed: 0.0254s/iter; left time: 378.7091s
	iters: 200, epoch: 7 | loss: 0.3511780
	speed: 0.0058s/iter; left time: 85.7161s
	iters: 300, epoch: 7 | loss: 0.2234193
	speed: 0.0053s/iter; left time: 77.3995s
	iters: 400, epoch: 7 | loss: 0.2664473
	speed: 0.0058s/iter; left time: 84.7028s
	iters: 500, epoch: 7 | loss: 0.1107504
	speed: 0.0050s/iter; left time: 72.3777s
	iters: 600, epoch: 7 | loss: 0.1225108
	speed: 0.0054s/iter; left time: 77.2719s
	iters: 700, epoch: 7 | loss: 0.1587911
	speed: 0.0055s/iter; left time: 78.2980s
	iters: 800, epoch: 7 | loss: 0.2561672
	speed: 0.0063s/iter; left time: 89.4115s
	iters: 900, epoch: 7 | loss: 0.1526195
	speed: 0.0056s/iter; left time: 79.3813s
	iters: 1000, epoch: 7 | loss: 0.1288687
	speed: 0.0049s/iter; left time: 69.1997s
Epoch: 7 cost time: 6.01958966255188
Epoch: 7, Steps: 1074 | Train Loss: 0.2183594 Vali Loss: 0.1426985 Test Loss: 0.2318947
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.1522128
	speed: 0.0251s/iter; left time: 347.4081s
	iters: 200, epoch: 8 | loss: 0.1175593
	speed: 0.0052s/iter; left time: 71.7505s
	iters: 300, epoch: 8 | loss: 0.1943091
	speed: 0.0050s/iter; left time: 68.0203s
	iters: 400, epoch: 8 | loss: 0.1914385
	speed: 0.0053s/iter; left time: 71.4931s
	iters: 500, epoch: 8 | loss: 0.3124126
	speed: 0.0049s/iter; left time: 65.4296s
	iters: 600, epoch: 8 | loss: 0.2613851
	speed: 0.0054s/iter; left time: 72.7933s
	iters: 700, epoch: 8 | loss: 0.1398575
	speed: 0.0060s/iter; left time: 79.9425s
	iters: 800, epoch: 8 | loss: 0.4370940
	speed: 0.0051s/iter; left time: 66.7494s
	iters: 900, epoch: 8 | loss: 0.3691098
	speed: 0.0075s/iter; left time: 97.4420s
	iters: 1000, epoch: 8 | loss: 0.1948773
	speed: 0.0060s/iter; left time: 78.1923s
Epoch: 8 cost time: 5.9917988777160645
Epoch: 8, Steps: 1074 | Train Loss: 0.2173623 Vali Loss: 0.1576242 Test Loss: 0.2781779
EarlyStopping counter: 2 out of 5
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.1612206
	speed: 0.0216s/iter; left time: 276.0055s
	iters: 200, epoch: 9 | loss: 0.1467052
	speed: 0.0057s/iter; left time: 72.3400s
	iters: 300, epoch: 9 | loss: 0.2912705
	speed: 0.0049s/iter; left time: 62.0714s
	iters: 400, epoch: 9 | loss: 0.2513457
	speed: 0.0054s/iter; left time: 67.2839s
	iters: 500, epoch: 9 | loss: 0.1848388
	speed: 0.0045s/iter; left time: 55.9289s
	iters: 600, epoch: 9 | loss: 0.2041987
	speed: 0.0056s/iter; left time: 68.5539s
	iters: 700, epoch: 9 | loss: 0.1958872
	speed: 0.0048s/iter; left time: 58.4818s
	iters: 800, epoch: 9 | loss: 0.1761100
	speed: 0.0058s/iter; left time: 69.5356s
	iters: 900, epoch: 9 | loss: 0.1214551
	speed: 0.0062s/iter; left time: 74.2503s
	iters: 1000, epoch: 9 | loss: 0.1901690
	speed: 0.0045s/iter; left time: 53.0167s
Epoch: 9 cost time: 5.775882244110107
Epoch: 9, Steps: 1074 | Train Loss: 0.2168639 Vali Loss: 0.1484928 Test Loss: 0.2489794
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.2057808
	speed: 0.0229s/iter; left time: 268.7196s
	iters: 200, epoch: 10 | loss: 0.1476898
	speed: 0.0052s/iter; left time: 60.2164s
	iters: 300, epoch: 10 | loss: 0.1575423
	speed: 0.0055s/iter; left time: 63.3033s
	iters: 400, epoch: 10 | loss: 0.1902909
	speed: 0.0050s/iter; left time: 57.4454s
	iters: 500, epoch: 10 | loss: 0.1544414
	speed: 0.0063s/iter; left time: 70.9175s
	iters: 600, epoch: 10 | loss: 0.2640220
	speed: 0.0050s/iter; left time: 55.7541s
	iters: 700, epoch: 10 | loss: 0.2198313
	speed: 0.0051s/iter; left time: 57.2322s
	iters: 800, epoch: 10 | loss: 0.1475020
	speed: 0.0059s/iter; left time: 64.5097s
	iters: 900, epoch: 10 | loss: 0.2430908
	speed: 0.0052s/iter; left time: 56.2312s
	iters: 1000, epoch: 10 | loss: 0.1570992
	speed: 0.0043s/iter; left time: 46.1090s
Epoch: 10 cost time: 5.59159779548645
Epoch: 10, Steps: 1074 | Train Loss: 0.2166675 Vali Loss: 0.1521645 Test Loss: 0.2583512
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.1454647
	speed: 0.0203s/iter; left time: 216.1464s
	iters: 200, epoch: 11 | loss: 0.1527994
	speed: 0.0042s/iter; left time: 44.6527s
	iters: 300, epoch: 11 | loss: 0.1073451
	speed: 0.0042s/iter; left time: 43.6893s
	iters: 400, epoch: 11 | loss: 0.4755641
	speed: 0.0047s/iter; left time: 48.4366s
	iters: 500, epoch: 11 | loss: 0.4715991
	speed: 0.0049s/iter; left time: 50.4617s
	iters: 600, epoch: 11 | loss: 0.2288755
	speed: 0.0043s/iter; left time: 43.6732s
	iters: 700, epoch: 11 | loss: 0.2645982
	speed: 0.0043s/iter; left time: 43.3299s
	iters: 800, epoch: 11 | loss: 0.1676754
	speed: 0.0052s/iter; left time: 51.6689s
	iters: 900, epoch: 11 | loss: 0.2425631
	speed: 0.0048s/iter; left time: 46.9761s
	iters: 1000, epoch: 11 | loss: 0.3425300
	speed: 0.0042s/iter; left time: 40.5312s
Epoch: 11 cost time: 4.873619794845581
Epoch: 11, Steps: 1074 | Train Loss: 0.2164525 Vali Loss: 0.1525586 Test Loss: 0.2625894
EarlyStopping counter: 5 out of 5
Early stopping
Total training time: 78.3652 seconds
>>>>>>>testing : ETTm2_96_96_DLinear_ETTm2_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15726<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
data_set:  <data_provider.data_loader.Dataset_ETT_minute object at 0x00000293D0F83860>
mse:0.19200371205806732, mae:0.28170186281204224
