Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTh2', data_path='ETTh2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.05, loss='mse', lradj='type1', model='NLinear', model_id='ETTh2_96_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=10458, seq_len=96, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTh2_96_96_NLinear_ETTh2_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed10458>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8449
data_set:  <data_provider.data_loader.Dataset_ETT_hour object at 0x000001BD28370D68>
val 2785
data_set:  <data_provider.data_loader.Dataset_ETT_hour object at 0x000001BD75947DD8>
test 2785
data_set:  <data_provider.data_loader.Dataset_ETT_hour object at 0x000001BD28370128>
Total number of trainable parameters: 65184
Total number of parameters: 65184
	iters: 100, epoch: 1 | loss: 1.5874530
	speed: 0.0048s/iter; left time: 50.6372s
	iters: 200, epoch: 1 | loss: 0.9169872
	speed: 0.0029s/iter; left time: 29.5532s
	iters: 300, epoch: 1 | loss: 2.4104924
	speed: 0.0031s/iter; left time: 31.9697s
	iters: 400, epoch: 1 | loss: 1.1748689
	speed: 0.0033s/iter; left time: 33.1533s
	iters: 500, epoch: 1 | loss: 0.5722863
	speed: 0.0027s/iter; left time: 27.4765s
Epoch: 1 cost time: 1.7500004768371582
Epoch: 1, Steps: 528 | Train Loss: 1.6027564 Vali Loss: 0.6301718 Test Loss: 0.9267507
Validation loss decreased (inf --> 0.630172).  Saving model ...
Updating learning rate to 0.05
	iters: 100, epoch: 2 | loss: 0.7000223
	speed: 0.0080s/iter; left time: 79.1564s
	iters: 200, epoch: 2 | loss: 1.0559783
	speed: 0.0028s/iter; left time: 27.1287s
	iters: 300, epoch: 2 | loss: 0.7759919
	speed: 0.0029s/iter; left time: 28.6927s
	iters: 400, epoch: 2 | loss: 0.9309807
	speed: 0.0034s/iter; left time: 32.3645s
	iters: 500, epoch: 2 | loss: 2.3112550
	speed: 0.0033s/iter; left time: 31.9156s
Epoch: 2 cost time: 1.5936334133148193
Epoch: 2, Steps: 528 | Train Loss: 1.9046884 Vali Loss: 0.8573871 Test Loss: 1.2829614
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.025
	iters: 100, epoch: 3 | loss: 0.5649160
	speed: 0.0069s/iter; left time: 64.7237s
	iters: 200, epoch: 3 | loss: 0.4158988
	speed: 0.0026s/iter; left time: 24.6502s
	iters: 300, epoch: 3 | loss: 0.2676885
	speed: 0.0027s/iter; left time: 24.6265s
	iters: 400, epoch: 3 | loss: 0.7192691
	speed: 0.0032s/iter; left time: 29.5545s
	iters: 500, epoch: 3 | loss: 0.8929790
	speed: 0.0028s/iter; left time: 25.0578s
Epoch: 3 cost time: 1.439117431640625
Epoch: 3, Steps: 528 | Train Loss: 0.6226845 Vali Loss: 0.2954717 Test Loss: 0.4128980
Validation loss decreased (0.630172 --> 0.295472).  Saving model ...
Updating learning rate to 0.0125
	iters: 100, epoch: 4 | loss: 0.5575927
	speed: 0.0071s/iter; left time: 62.6757s
	iters: 200, epoch: 4 | loss: 0.1603224
	speed: 0.0036s/iter; left time: 31.7997s
	iters: 300, epoch: 4 | loss: 0.1103802
	speed: 0.0034s/iter; left time: 29.3059s
	iters: 400, epoch: 4 | loss: 0.7021502
	speed: 0.0025s/iter; left time: 21.8469s
	iters: 500, epoch: 4 | loss: 0.6091480
	speed: 0.0028s/iter; left time: 23.8370s
Epoch: 4 cost time: 1.5570688247680664
Epoch: 4, Steps: 528 | Train Loss: 0.4871451 Vali Loss: 0.2308306 Test Loss: 0.3220406
Validation loss decreased (0.295472 --> 0.230831).  Saving model ...
Updating learning rate to 0.00625
	iters: 100, epoch: 5 | loss: 0.2957290
	speed: 0.0077s/iter; left time: 63.9279s
	iters: 200, epoch: 5 | loss: 0.2613207
	speed: 0.0026s/iter; left time: 21.3787s
	iters: 300, epoch: 5 | loss: 0.5491958
	speed: 0.0033s/iter; left time: 26.5011s
	iters: 400, epoch: 5 | loss: 0.4536467
	speed: 0.0031s/iter; left time: 25.1417s
	iters: 500, epoch: 5 | loss: 0.4498493
	speed: 0.0026s/iter; left time: 20.6455s
Epoch: 5 cost time: 1.4799675941467285
Epoch: 5, Steps: 528 | Train Loss: 0.4424028 Vali Loss: 0.2180716 Test Loss: 0.3031289
Validation loss decreased (0.230831 --> 0.218072).  Saving model ...
Updating learning rate to 0.003125
	iters: 100, epoch: 6 | loss: 0.4683241
	speed: 0.0072s/iter; left time: 56.1952s
	iters: 200, epoch: 6 | loss: 0.2303552
	speed: 0.0034s/iter; left time: 26.5420s
	iters: 300, epoch: 6 | loss: 0.1712994
	speed: 0.0027s/iter; left time: 20.2329s
	iters: 400, epoch: 6 | loss: 0.3123924
	speed: 0.0030s/iter; left time: 22.3278s
	iters: 500, epoch: 6 | loss: 0.2219471
	speed: 0.0029s/iter; left time: 21.1809s
Epoch: 6 cost time: 1.5468950271606445
Epoch: 6, Steps: 528 | Train Loss: 0.4224498 Vali Loss: 0.2192684 Test Loss: 0.2979125
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0015625
	iters: 100, epoch: 7 | loss: 0.8742518
	speed: 0.0067s/iter; left time: 48.7175s
	iters: 200, epoch: 7 | loss: 0.2512926
	speed: 0.0025s/iter; left time: 17.9644s
	iters: 300, epoch: 7 | loss: 0.4405509
	speed: 0.0032s/iter; left time: 22.5211s
	iters: 400, epoch: 7 | loss: 0.4059280
	speed: 0.0023s/iter; left time: 16.0751s
	iters: 500, epoch: 7 | loss: 0.2636162
	speed: 0.0023s/iter; left time: 16.1172s
Epoch: 7 cost time: 1.3751935958862305
Epoch: 7, Steps: 528 | Train Loss: 0.4154630 Vali Loss: 0.2117731 Test Loss: 0.2916348
Validation loss decreased (0.218072 --> 0.211773).  Saving model ...
Updating learning rate to 0.00078125
	iters: 100, epoch: 8 | loss: 0.5198977
	speed: 0.0074s/iter; left time: 50.0536s
	iters: 200, epoch: 8 | loss: 0.4378581
	speed: 0.0032s/iter; left time: 21.5288s
	iters: 300, epoch: 8 | loss: 0.2281893
	speed: 0.0026s/iter; left time: 16.9196s
	iters: 400, epoch: 8 | loss: 0.2609200
	speed: 0.0025s/iter; left time: 16.3535s
	iters: 500, epoch: 8 | loss: 0.2346146
	speed: 0.0027s/iter; left time: 17.2082s
Epoch: 8 cost time: 1.500483512878418
Epoch: 8, Steps: 528 | Train Loss: 0.4081590 Vali Loss: 0.2122221 Test Loss: 0.2916247
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.000390625
	iters: 100, epoch: 9 | loss: 0.7932709
	speed: 0.0077s/iter; left time: 48.2982s
	iters: 200, epoch: 9 | loss: 0.3050256
	speed: 0.0038s/iter; left time: 23.4353s
	iters: 300, epoch: 9 | loss: 0.8505905
	speed: 0.0031s/iter; left time: 18.8777s
	iters: 400, epoch: 9 | loss: 0.1644410
	speed: 0.0036s/iter; left time: 21.3361s
	iters: 500, epoch: 9 | loss: 0.2015067
	speed: 0.0027s/iter; left time: 15.4938s
Epoch: 9 cost time: 1.6562473773956299
Epoch: 9, Steps: 528 | Train Loss: 0.4044909 Vali Loss: 0.2094628 Test Loss: 0.2915035
Validation loss decreased (0.211773 --> 0.209463).  Saving model ...
Updating learning rate to 0.0001953125
	iters: 100, epoch: 10 | loss: 0.1892420
	speed: 0.0072s/iter; left time: 41.0177s
	iters: 200, epoch: 10 | loss: 0.2536637
	speed: 0.0031s/iter; left time: 17.5348s
	iters: 300, epoch: 10 | loss: 0.1394992
	speed: 0.0022s/iter; left time: 12.0633s
	iters: 400, epoch: 10 | loss: 0.3498054
	speed: 0.0027s/iter; left time: 14.3512s
	iters: 500, epoch: 10 | loss: 0.2032146
	speed: 0.0036s/iter; left time: 19.0933s
Epoch: 10 cost time: 1.4480814933776855
Epoch: 10, Steps: 528 | Train Loss: 0.4030917 Vali Loss: 0.2099696 Test Loss: 0.2899469
EarlyStopping counter: 1 out of 5
Updating learning rate to 9.765625e-05
	iters: 100, epoch: 11 | loss: 0.2475297
	speed: 0.0066s/iter; left time: 34.4366s
	iters: 200, epoch: 11 | loss: 0.2448556
	speed: 0.0034s/iter; left time: 17.0445s
	iters: 300, epoch: 11 | loss: 0.2668387
	speed: 0.0031s/iter; left time: 15.5641s
	iters: 400, epoch: 11 | loss: 0.2382093
	speed: 0.0030s/iter; left time: 14.4788s
	iters: 500, epoch: 11 | loss: 0.8503189
	speed: 0.0031s/iter; left time: 14.9533s
Epoch: 11 cost time: 1.5742924213409424
Epoch: 11, Steps: 528 | Train Loss: 0.4017390 Vali Loss: 0.2093708 Test Loss: 0.2899230
Validation loss decreased (0.209463 --> 0.209371).  Saving model ...
Updating learning rate to 4.8828125e-05
	iters: 100, epoch: 12 | loss: 0.3581834
	speed: 0.0075s/iter; left time: 34.8851s
	iters: 200, epoch: 12 | loss: 0.2273053
	speed: 0.0031s/iter; left time: 14.2216s
	iters: 300, epoch: 12 | loss: 0.2190008
	speed: 0.0030s/iter; left time: 13.2190s
	iters: 400, epoch: 12 | loss: 0.8665820
	speed: 0.0023s/iter; left time: 10.2022s
	iters: 500, epoch: 12 | loss: 0.2672795
	speed: 0.0031s/iter; left time: 13.1989s
Epoch: 12 cost time: 1.5940370559692383
Epoch: 12, Steps: 528 | Train Loss: 0.4012198 Vali Loss: 0.2099097 Test Loss: 0.2902122
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.44140625e-05
	iters: 100, epoch: 13 | loss: 0.2526467
	speed: 0.0075s/iter; left time: 31.0258s
	iters: 200, epoch: 13 | loss: 0.1388128
	speed: 0.0025s/iter; left time: 10.0784s
	iters: 300, epoch: 13 | loss: 0.5973355
	speed: 0.0027s/iter; left time: 10.4217s
	iters: 400, epoch: 13 | loss: 0.2689981
	speed: 0.0023s/iter; left time: 8.9746s
	iters: 500, epoch: 13 | loss: 0.2359222
	speed: 0.0028s/iter; left time: 10.5882s
Epoch: 13 cost time: 1.4376213550567627
Epoch: 13, Steps: 528 | Train Loss: 0.4009019 Vali Loss: 0.2097984 Test Loss: 0.2898797
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.220703125e-05
	iters: 100, epoch: 14 | loss: 0.3871925
	speed: 0.0065s/iter; left time: 23.4823s
	iters: 200, epoch: 14 | loss: 0.2504362
	speed: 0.0030s/iter; left time: 10.3866s
	iters: 300, epoch: 14 | loss: 0.2459590
	speed: 0.0024s/iter; left time: 8.1763s
	iters: 400, epoch: 14 | loss: 0.8993208
	speed: 0.0024s/iter; left time: 8.0416s
	iters: 500, epoch: 14 | loss: 0.3474615
	speed: 0.0028s/iter; left time: 8.9777s
Epoch: 14 cost time: 1.40580153465271
Epoch: 14, Steps: 528 | Train Loss: 0.4006601 Vali Loss: 0.2098598 Test Loss: 0.2899365
EarlyStopping counter: 3 out of 5
Updating learning rate to 6.103515625e-06
	iters: 100, epoch: 15 | loss: 0.1224746
	speed: 0.0061s/iter; left time: 18.7142s
	iters: 200, epoch: 15 | loss: 0.6822980
	speed: 0.0030s/iter; left time: 8.8056s
	iters: 300, epoch: 15 | loss: 0.3755789
	speed: 0.0027s/iter; left time: 7.6317s
	iters: 400, epoch: 15 | loss: 0.6401379
	speed: 0.0028s/iter; left time: 7.7822s
	iters: 500, epoch: 15 | loss: 0.3246276
	speed: 0.0025s/iter; left time: 6.6652s
Epoch: 15 cost time: 1.4166886806488037
Epoch: 15, Steps: 528 | Train Loss: 0.4005659 Vali Loss: 0.2098670 Test Loss: 0.2899153
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.0517578125e-06
	iters: 100, epoch: 16 | loss: 0.3827739
	speed: 0.0058s/iter; left time: 14.6922s
	iters: 200, epoch: 16 | loss: 0.3281675
	speed: 0.0022s/iter; left time: 5.3452s
	iters: 300, epoch: 16 | loss: 0.1707890
	speed: 0.0022s/iter; left time: 5.1122s
	iters: 400, epoch: 16 | loss: 0.3149791
	speed: 0.0030s/iter; left time: 6.6556s
	iters: 500, epoch: 16 | loss: 0.3506159
	speed: 0.0022s/iter; left time: 4.6876s
Epoch: 16 cost time: 1.2810413837432861
Epoch: 16, Steps: 528 | Train Loss: 0.4004238 Vali Loss: 0.2099233 Test Loss: 0.2899134
EarlyStopping counter: 5 out of 5
Early stopping
Total training time: 29.7344 seconds
>>>>>>>testing : ETTh2_96_96_NLinear_ETTh2_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed10458<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
data_set:  <data_provider.data_loader.Dataset_ETT_hour object at 0x000001BD6ADB1080>
mse:0.29090645909309387, mae:0.34089601039886475
