Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='DLinear', model_id='ETTm2_336_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=3293, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTm2_336_96_DLinear_ETTm2_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3293>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34129
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.3146178
	speed: 0.0078s/iter; left time: 165.7722s
	iters: 200, epoch: 1 | loss: 0.3681872
	speed: 0.0083s/iter; left time: 175.7850s
	iters: 300, epoch: 1 | loss: 0.5596468
	speed: 0.0075s/iter; left time: 157.0694s
	iters: 400, epoch: 1 | loss: 0.3490677
	speed: 0.0075s/iter; left time: 157.8217s
	iters: 500, epoch: 1 | loss: 0.3715837
	speed: 0.0084s/iter; left time: 174.0756s
	iters: 600, epoch: 1 | loss: 0.7529323
	speed: 0.0082s/iter; left time: 169.9523s
	iters: 700, epoch: 1 | loss: 0.3546161
	speed: 0.0084s/iter; left time: 172.8630s
	iters: 800, epoch: 1 | loss: 0.5538650
	speed: 0.0073s/iter; left time: 149.4336s
	iters: 900, epoch: 1 | loss: 0.4992200
	speed: 0.0083s/iter; left time: 170.1885s
	iters: 1000, epoch: 1 | loss: 0.2660300
	speed: 0.0078s/iter; left time: 158.5130s
Epoch: 1 cost time: 8.490398406982422
Epoch: 1, Steps: 1066 | Train Loss: 0.4426609 Vali Loss: 0.4685924 Test Loss: 0.9608738
Validation loss decreased (inf --> 0.468592).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.8932277
	speed: 0.0342s/iter; left time: 690.0962s
	iters: 200, epoch: 2 | loss: 0.4024237
	speed: 0.0083s/iter; left time: 165.7044s
	iters: 300, epoch: 2 | loss: 0.4780127
	speed: 0.0078s/iter; left time: 156.0480s
	iters: 400, epoch: 2 | loss: 0.4074892
	speed: 0.0077s/iter; left time: 152.9357s
	iters: 500, epoch: 2 | loss: 0.6225320
	speed: 0.0080s/iter; left time: 157.7216s
	iters: 600, epoch: 2 | loss: 0.6794087
	speed: 0.0081s/iter; left time: 159.0606s
	iters: 700, epoch: 2 | loss: 0.3384888
	speed: 0.0072s/iter; left time: 140.2099s
	iters: 800, epoch: 2 | loss: 0.2750664
	speed: 0.0079s/iter; left time: 153.9479s
	iters: 900, epoch: 2 | loss: 0.3526402
	speed: 0.0077s/iter; left time: 148.7178s
	iters: 1000, epoch: 2 | loss: 0.2595984
	speed: 0.0088s/iter; left time: 168.7091s
Epoch: 2 cost time: 8.461920261383057
Epoch: 2, Steps: 1066 | Train Loss: 0.4792302 Vali Loss: 0.7496682 Test Loss: 1.9993733
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.2365443
	speed: 0.0333s/iter; left time: 635.1195s
	iters: 200, epoch: 3 | loss: 0.5036125
	speed: 0.0081s/iter; left time: 154.0394s
	iters: 300, epoch: 3 | loss: 0.2861493
	speed: 0.0083s/iter; left time: 156.0815s
	iters: 400, epoch: 3 | loss: 0.2111514
	speed: 0.0084s/iter; left time: 157.2866s
	iters: 500, epoch: 3 | loss: 0.4860359
	speed: 0.0081s/iter; left time: 151.6209s
	iters: 600, epoch: 3 | loss: 0.3698198
	speed: 0.0080s/iter; left time: 147.7928s
	iters: 700, epoch: 3 | loss: 0.2679768
	speed: 0.0077s/iter; left time: 141.8498s
	iters: 800, epoch: 3 | loss: 0.2243325
	speed: 0.0078s/iter; left time: 144.0406s
	iters: 900, epoch: 3 | loss: 0.4258961
	speed: 0.0062s/iter; left time: 113.0859s
	iters: 1000, epoch: 3 | loss: 0.2013109
	speed: 0.0083s/iter; left time: 151.1182s
Epoch: 3 cost time: 8.441031217575073
Epoch: 3, Steps: 1066 | Train Loss: 0.2820407 Vali Loss: 0.3907377 Test Loss: 1.0294951
Validation loss decreased (0.468592 --> 0.390738).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.2290264
	speed: 0.0356s/iter; left time: 641.7834s
	iters: 200, epoch: 4 | loss: 0.1619697
	speed: 0.0081s/iter; left time: 145.7666s
	iters: 300, epoch: 4 | loss: 0.2507114
	speed: 0.0087s/iter; left time: 154.1855s
	iters: 400, epoch: 4 | loss: 0.2564280
	speed: 0.0071s/iter; left time: 126.0104s
	iters: 500, epoch: 4 | loss: 0.1670749
	speed: 0.0082s/iter; left time: 144.5769s
	iters: 600, epoch: 4 | loss: 0.3558347
	speed: 0.0078s/iter; left time: 136.7457s
	iters: 700, epoch: 4 | loss: 0.1668461
	speed: 0.0078s/iter; left time: 136.1230s
	iters: 800, epoch: 4 | loss: 0.3217868
	speed: 0.0075s/iter; left time: 129.2367s
	iters: 900, epoch: 4 | loss: 0.1808549
	speed: 0.0084s/iter; left time: 143.8448s
	iters: 1000, epoch: 4 | loss: 0.1428633
	speed: 0.0080s/iter; left time: 136.9896s
Epoch: 4 cost time: 8.510563611984253
Epoch: 4, Steps: 1066 | Train Loss: 0.2377682 Vali Loss: 0.4750647 Test Loss: 1.3311249
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.1018425
	speed: 0.0353s/iter; left time: 599.1639s
	iters: 200, epoch: 5 | loss: 0.2492455
	speed: 0.0082s/iter; left time: 137.5604s
	iters: 300, epoch: 5 | loss: 0.2472790
	speed: 0.0079s/iter; left time: 133.0644s
	iters: 400, epoch: 5 | loss: 0.1985315
	speed: 0.0074s/iter; left time: 123.2867s
	iters: 500, epoch: 5 | loss: 0.1986177
	speed: 0.0070s/iter; left time: 116.2696s
	iters: 600, epoch: 5 | loss: 0.2182300
	speed: 0.0071s/iter; left time: 116.1866s
	iters: 700, epoch: 5 | loss: 0.4626497
	speed: 0.0072s/iter; left time: 118.4709s
	iters: 800, epoch: 5 | loss: 0.1983065
	speed: 0.0074s/iter; left time: 120.3492s
	iters: 900, epoch: 5 | loss: 0.2760078
	speed: 0.0087s/iter; left time: 139.7805s
	iters: 1000, epoch: 5 | loss: 0.1271237
	speed: 0.0060s/iter; left time: 96.8235s
Epoch: 5 cost time: 7.873732089996338
Epoch: 5, Steps: 1066 | Train Loss: 0.2211227 Vali Loss: 0.1948886 Test Loss: 0.3718067
Validation loss decreased (0.390738 --> 0.194889).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.1819054
	speed: 0.0413s/iter; left time: 656.0126s
	iters: 200, epoch: 6 | loss: 0.1207907
	speed: 0.0093s/iter; left time: 147.2083s
	iters: 300, epoch: 6 | loss: 0.1694356
	speed: 0.0090s/iter; left time: 141.7479s
	iters: 400, epoch: 6 | loss: 0.1383637
	speed: 0.0068s/iter; left time: 105.2705s
	iters: 500, epoch: 6 | loss: 0.1813505
	speed: 0.0074s/iter; left time: 114.5157s
	iters: 600, epoch: 6 | loss: 0.1438508
	speed: 0.0079s/iter; left time: 121.7428s
	iters: 700, epoch: 6 | loss: 0.3127739
	speed: 0.0077s/iter; left time: 117.9114s
	iters: 800, epoch: 6 | loss: 0.2668165
	speed: 0.0086s/iter; left time: 130.2114s
	iters: 900, epoch: 6 | loss: 0.1542952
	speed: 0.0084s/iter; left time: 127.1198s
	iters: 1000, epoch: 6 | loss: 0.1249810
	speed: 0.0076s/iter; left time: 113.3668s
Epoch: 6 cost time: 8.809093713760376
Epoch: 6, Steps: 1066 | Train Loss: 0.2102037 Vali Loss: 0.1359938 Test Loss: 0.2166139
Validation loss decreased (0.194889 --> 0.135994).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.3113593
	speed: 0.0392s/iter; left time: 581.4911s
	iters: 200, epoch: 7 | loss: 0.2743987
	speed: 0.0093s/iter; left time: 136.8289s
	iters: 300, epoch: 7 | loss: 0.1773977
	speed: 0.0085s/iter; left time: 124.9057s
	iters: 400, epoch: 7 | loss: 0.1297321
	speed: 0.0084s/iter; left time: 121.6107s
	iters: 500, epoch: 7 | loss: 0.2368377
	speed: 0.0088s/iter; left time: 127.5632s
	iters: 600, epoch: 7 | loss: 0.1483251
	speed: 0.0080s/iter; left time: 114.9274s
	iters: 700, epoch: 7 | loss: 0.2311251
	speed: 0.0087s/iter; left time: 123.3738s
	iters: 800, epoch: 7 | loss: 0.1751645
	speed: 0.0092s/iter; left time: 129.5602s
	iters: 900, epoch: 7 | loss: 0.2686475
	speed: 0.0092s/iter; left time: 129.3203s
	iters: 1000, epoch: 7 | loss: 0.2077897
	speed: 0.0087s/iter; left time: 121.7045s
Epoch: 7 cost time: 9.336359739303589
Epoch: 7, Steps: 1066 | Train Loss: 0.2050616 Vali Loss: 0.1536738 Test Loss: 0.2764952
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.0968054
	speed: 0.0393s/iter; left time: 540.5988s
	iters: 200, epoch: 8 | loss: 0.1602831
	speed: 0.0083s/iter; left time: 113.2654s
	iters: 300, epoch: 8 | loss: 0.1262189
	speed: 0.0086s/iter; left time: 116.2415s
	iters: 400, epoch: 8 | loss: 0.1565028
	speed: 0.0086s/iter; left time: 116.0443s
	iters: 500, epoch: 8 | loss: 0.3973421
	speed: 0.0091s/iter; left time: 121.6018s
	iters: 600, epoch: 8 | loss: 0.1591391
	speed: 0.0077s/iter; left time: 102.3854s
	iters: 700, epoch: 8 | loss: 0.1215686
	speed: 0.0090s/iter; left time: 118.6088s
	iters: 800, epoch: 8 | loss: 0.0956179
	speed: 0.0081s/iter; left time: 105.6287s
	iters: 900, epoch: 8 | loss: 0.1223145
	speed: 0.0075s/iter; left time: 97.6085s
	iters: 1000, epoch: 8 | loss: 0.2708310
	speed: 0.0073s/iter; left time: 93.7530s
Epoch: 8 cost time: 8.8067045211792
Epoch: 8, Steps: 1066 | Train Loss: 0.2021293 Vali Loss: 0.1275885 Test Loss: 0.1891943
Validation loss decreased (0.135994 --> 0.127588).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.2755376
	speed: 0.0390s/iter; left time: 495.0094s
	iters: 200, epoch: 9 | loss: 0.2077887
	speed: 0.0092s/iter; left time: 116.2649s
	iters: 300, epoch: 9 | loss: 0.5360925
	speed: 0.0086s/iter; left time: 106.8314s
	iters: 400, epoch: 9 | loss: 0.2014809
	speed: 0.0089s/iter; left time: 109.6782s
	iters: 500, epoch: 9 | loss: 0.1350473
	speed: 0.0078s/iter; left time: 95.6712s
	iters: 600, epoch: 9 | loss: 0.1100025
	speed: 0.0082s/iter; left time: 100.0149s
	iters: 700, epoch: 9 | loss: 0.3039156
	speed: 0.0067s/iter; left time: 81.1793s
	iters: 800, epoch: 9 | loss: 0.3712853
	speed: 0.0068s/iter; left time: 81.4388s
	iters: 900, epoch: 9 | loss: 0.1017041
	speed: 0.0078s/iter; left time: 92.4118s
	iters: 1000, epoch: 9 | loss: 0.3333984
	speed: 0.0076s/iter; left time: 89.4219s
Epoch: 9 cost time: 8.466737031936646
Epoch: 9, Steps: 1066 | Train Loss: 0.2004151 Vali Loss: 0.1328929 Test Loss: 0.2133024
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.2016416
	speed: 0.0376s/iter; left time: 437.7290s
	iters: 200, epoch: 10 | loss: 0.1769249
	speed: 0.0074s/iter; left time: 85.4211s
	iters: 300, epoch: 10 | loss: 0.1090488
	speed: 0.0074s/iter; left time: 84.9222s
	iters: 400, epoch: 10 | loss: 0.1708713
	speed: 0.0077s/iter; left time: 87.2393s
	iters: 500, epoch: 10 | loss: 0.2427763
	speed: 0.0078s/iter; left time: 88.0591s
	iters: 600, epoch: 10 | loss: 0.1305507
	speed: 0.0075s/iter; left time: 83.0072s
	iters: 700, epoch: 10 | loss: 0.2094678
	speed: 0.0081s/iter; left time: 89.2121s
	iters: 800, epoch: 10 | loss: 0.0934107
	speed: 0.0083s/iter; left time: 90.4825s
	iters: 900, epoch: 10 | loss: 0.1075511
	speed: 0.0085s/iter; left time: 92.3759s
	iters: 1000, epoch: 10 | loss: 0.0942703
	speed: 0.0067s/iter; left time: 71.6831s
Epoch: 10 cost time: 8.275494813919067
Epoch: 10, Steps: 1066 | Train Loss: 0.1995958 Vali Loss: 0.1372212 Test Loss: 0.2281145
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.1918176
	speed: 0.0339s/iter; left time: 357.7676s
	iters: 200, epoch: 11 | loss: 0.1866918
	speed: 0.0085s/iter; left time: 88.7361s
	iters: 300, epoch: 11 | loss: 0.1053859
	speed: 0.0091s/iter; left time: 94.3067s
	iters: 400, epoch: 11 | loss: 0.2447699
	speed: 0.0082s/iter; left time: 83.8631s
	iters: 500, epoch: 11 | loss: 0.1073852
	speed: 0.0083s/iter; left time: 84.1240s
	iters: 600, epoch: 11 | loss: 0.3165044
	speed: 0.0083s/iter; left time: 83.2257s
	iters: 700, epoch: 11 | loss: 0.1540451
	speed: 0.0074s/iter; left time: 73.7161s
	iters: 800, epoch: 11 | loss: 0.2348315
	speed: 0.0083s/iter; left time: 81.8677s
	iters: 900, epoch: 11 | loss: 0.1247574
	speed: 0.0092s/iter; left time: 90.2276s
	iters: 1000, epoch: 11 | loss: 0.1175428
	speed: 0.0079s/iter; left time: 76.0363s
Epoch: 11 cost time: 8.87287187576294
Epoch: 11, Steps: 1066 | Train Loss: 0.1989515 Vali Loss: 0.1287307 Test Loss: 0.2000924
EarlyStopping counter: 3 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.1024613
	speed: 0.0385s/iter; left time: 365.6241s
	iters: 200, epoch: 12 | loss: 0.1296381
	speed: 0.0086s/iter; left time: 80.9511s
	iters: 300, epoch: 12 | loss: 0.1445774
	speed: 0.0088s/iter; left time: 81.9842s
	iters: 400, epoch: 12 | loss: 0.1585734
	speed: 0.0083s/iter; left time: 76.4273s
	iters: 500, epoch: 12 | loss: 0.0988210
	speed: 0.0083s/iter; left time: 75.1467s
	iters: 600, epoch: 12 | loss: 0.1708602
	speed: 0.0083s/iter; left time: 74.2201s
	iters: 700, epoch: 12 | loss: 0.1224516
	speed: 0.0090s/iter; left time: 80.4869s
	iters: 800, epoch: 12 | loss: 0.1777178
	speed: 0.0077s/iter; left time: 67.9311s
	iters: 900, epoch: 12 | loss: 0.2178322
	speed: 0.0080s/iter; left time: 69.6710s
	iters: 1000, epoch: 12 | loss: 0.2413925
	speed: 0.0082s/iter; left time: 70.2419s
Epoch: 12 cost time: 8.968974351882935
Epoch: 12, Steps: 1066 | Train Loss: 0.1988345 Vali Loss: 0.1327110 Test Loss: 0.2135119
EarlyStopping counter: 4 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.2144506
	speed: 0.0348s/iter; left time: 293.2990s
	iters: 200, epoch: 13 | loss: 0.1795822
	speed: 0.0088s/iter; left time: 73.0644s
	iters: 300, epoch: 13 | loss: 0.1202652
	speed: 0.0094s/iter; left time: 77.0403s
	iters: 400, epoch: 13 | loss: 0.2396671
	speed: 0.0088s/iter; left time: 71.5483s
	iters: 500, epoch: 13 | loss: 0.1575943
	speed: 0.0081s/iter; left time: 65.2140s
	iters: 600, epoch: 13 | loss: 0.1953644
	speed: 0.0080s/iter; left time: 63.1408s
	iters: 700, epoch: 13 | loss: 0.3382844
	speed: 0.0076s/iter; left time: 59.5829s
	iters: 800, epoch: 13 | loss: 0.2116410
	speed: 0.0076s/iter; left time: 59.0796s
	iters: 900, epoch: 13 | loss: 0.1541544
	speed: 0.0087s/iter; left time: 66.0144s
	iters: 1000, epoch: 13 | loss: 0.2301051
	speed: 0.0086s/iter; left time: 64.6117s
Epoch: 13 cost time: 8.938313245773315
Epoch: 13, Steps: 1066 | Train Loss: 0.1987240 Vali Loss: 0.1311020 Test Loss: 0.2080809
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTm2_336_96_DLinear_ETTm2_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3293<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.18955481052398682, mae:0.28324320912361145
