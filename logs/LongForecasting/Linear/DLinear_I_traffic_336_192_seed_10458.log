Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='DLinear', model_id='traffic_336_192', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=192, root_path='./dataset/', save_pred_values=False, seed=10458, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_336_192_DLinear_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed10458>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11753
val 1565
test 3317
	iters: 100, epoch: 1 | loss: 0.5325771
	speed: 0.4365s/iter; left time: 6364.1287s
	iters: 200, epoch: 1 | loss: 0.5573189
	speed: 0.4255s/iter; left time: 6161.7866s
	iters: 300, epoch: 1 | loss: 0.5823169
	speed: 0.4225s/iter; left time: 6075.7711s
	iters: 400, epoch: 1 | loss: 0.6116080
	speed: 0.4206s/iter; left time: 6005.9295s
	iters: 500, epoch: 1 | loss: 0.6067843
	speed: 0.4187s/iter; left time: 5937.1240s
	iters: 600, epoch: 1 | loss: 0.5366318
	speed: 0.4167s/iter; left time: 5867.4099s
	iters: 700, epoch: 1 | loss: 0.5852525
	speed: 0.4169s/iter; left time: 5828.8909s
Epoch: 1 cost time: 310.28649520874023
Epoch: 1, Steps: 734 | Train Loss: 0.5902053 Vali Loss: 0.8083028 Test Loss: 0.9406064
Validation loss decreased (inf --> 0.808303).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.5919493
	speed: 0.9159s/iter; left time: 12682.7913s
	iters: 200, epoch: 2 | loss: 0.5864435
	speed: 0.4320s/iter; left time: 5938.4381s
	iters: 300, epoch: 2 | loss: 0.5870234
	speed: 0.4206s/iter; left time: 5739.4900s
	iters: 400, epoch: 2 | loss: 0.5581610
	speed: 0.4175s/iter; left time: 5656.4895s
	iters: 500, epoch: 2 | loss: 0.5903187
	speed: 0.4196s/iter; left time: 5641.7632s
	iters: 600, epoch: 2 | loss: 0.6472424
	speed: 0.4196s/iter; left time: 5599.7957s
	iters: 700, epoch: 2 | loss: 0.5894603
	speed: 0.4186s/iter; left time: 5545.2213s
Epoch: 2 cost time: 309.793274641037
Epoch: 2, Steps: 734 | Train Loss: 0.5837037 Vali Loss: 0.8101737 Test Loss: 0.9466028
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.3649744
	speed: 0.8508s/iter; left time: 11156.8563s
	iters: 200, epoch: 3 | loss: 0.3238699
	speed: 0.4277s/iter; left time: 5565.3414s
	iters: 300, epoch: 3 | loss: 0.3366407
	speed: 0.4255s/iter; left time: 5494.4797s
	iters: 400, epoch: 3 | loss: 0.3556623
	speed: 0.4207s/iter; left time: 5390.4844s
	iters: 500, epoch: 3 | loss: 0.3549360
	speed: 0.4212s/iter; left time: 5354.2833s
	iters: 600, epoch: 3 | loss: 0.3775394
	speed: 0.4197s/iter; left time: 5293.7554s
	iters: 700, epoch: 3 | loss: 0.3727727
	speed: 0.4177s/iter; left time: 5226.3761s
Epoch: 3 cost time: 309.5921196937561
Epoch: 3, Steps: 734 | Train Loss: 0.3594601 Vali Loss: 0.5204065 Test Loss: 0.6203806
Validation loss decreased (0.808303 --> 0.520406).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.3007806
	speed: 0.9141s/iter; left time: 11315.4911s
	iters: 200, epoch: 4 | loss: 0.3129756
	speed: 0.4229s/iter; left time: 5192.4114s
	iters: 300, epoch: 4 | loss: 0.2726362
	speed: 0.4214s/iter; left time: 5131.7451s
	iters: 400, epoch: 4 | loss: 0.2795466
	speed: 0.4206s/iter; left time: 5080.3242s
	iters: 500, epoch: 4 | loss: 0.2945749
	speed: 0.4196s/iter; left time: 5026.1289s
	iters: 600, epoch: 4 | loss: 0.3110185
	speed: 0.4213s/iter; left time: 5004.7519s
	iters: 700, epoch: 4 | loss: 0.2874680
	speed: 0.4163s/iter; left time: 4903.5801s
Epoch: 4 cost time: 308.79524278640747
Epoch: 4, Steps: 734 | Train Loss: 0.2945826 Vali Loss: 0.4174377 Test Loss: 0.5122643
Validation loss decreased (0.520406 --> 0.417438).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.2435422
	speed: 0.9148s/iter; left time: 10652.4624s
	iters: 200, epoch: 5 | loss: 0.2826937
	speed: 0.4211s/iter; left time: 4861.2168s
	iters: 300, epoch: 5 | loss: 0.2660852
	speed: 0.4285s/iter; left time: 4904.2115s
	iters: 400, epoch: 5 | loss: 0.2601867
	speed: 0.4226s/iter; left time: 4794.4388s
	iters: 500, epoch: 5 | loss: 0.2786787
	speed: 0.4203s/iter; left time: 4725.8934s
	iters: 600, epoch: 5 | loss: 0.2883929
	speed: 0.4240s/iter; left time: 4725.0420s
	iters: 700, epoch: 5 | loss: 0.2451408
	speed: 0.4206s/iter; left time: 4645.8041s
Epoch: 5 cost time: 310.23138880729675
Epoch: 5, Steps: 734 | Train Loss: 0.2674794 Vali Loss: 0.3883686 Test Loss: 0.4754372
Validation loss decreased (0.417438 --> 0.388369).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.2339190
	speed: 0.9158s/iter; left time: 9992.0010s
	iters: 200, epoch: 6 | loss: 0.2612799
	speed: 0.4216s/iter; left time: 4558.4326s
	iters: 300, epoch: 6 | loss: 0.2677848
	speed: 0.4284s/iter; left time: 4588.4675s
	iters: 400, epoch: 6 | loss: 0.2698642
	speed: 0.4259s/iter; left time: 4519.6255s
	iters: 500, epoch: 6 | loss: 0.2401426
	speed: 0.4188s/iter; left time: 4401.6590s
	iters: 600, epoch: 6 | loss: 0.2662245
	speed: 0.4200s/iter; left time: 4372.8567s
	iters: 700, epoch: 6 | loss: 0.2699801
	speed: 0.4172s/iter; left time: 4301.5228s
Epoch: 6 cost time: 309.8621988296509
Epoch: 6, Steps: 734 | Train Loss: 0.2540544 Vali Loss: 0.3695953 Test Loss: 0.4565496
Validation loss decreased (0.388369 --> 0.369595).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.2374464
	speed: 0.9089s/iter; left time: 9250.1052s
	iters: 200, epoch: 7 | loss: 0.2400305
	speed: 0.4130s/iter; left time: 4161.8742s
	iters: 300, epoch: 7 | loss: 0.2560363
	speed: 0.4189s/iter; left time: 4179.8151s
	iters: 400, epoch: 7 | loss: 0.2453037
	speed: 0.4267s/iter; left time: 4214.2197s
	iters: 500, epoch: 7 | loss: 0.2369583
	speed: 0.4220s/iter; left time: 4126.3516s
	iters: 600, epoch: 7 | loss: 0.2505904
	speed: 0.4214s/iter; left time: 4077.8080s
	iters: 700, epoch: 7 | loss: 0.2548051
	speed: 0.4211s/iter; left time: 4033.3318s
Epoch: 7 cost time: 308.07648611068726
Epoch: 7, Steps: 734 | Train Loss: 0.2466175 Vali Loss: 0.3624826 Test Loss: 0.4479564
Validation loss decreased (0.369595 --> 0.362483).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.2177648
	speed: 0.9062s/iter; left time: 8557.5801s
	iters: 200, epoch: 8 | loss: 0.2415602
	speed: 0.4154s/iter; left time: 3881.0869s
	iters: 300, epoch: 8 | loss: 0.2515881
	speed: 0.4196s/iter; left time: 3878.2358s
	iters: 400, epoch: 8 | loss: 0.2352769
	speed: 0.4270s/iter; left time: 3904.2726s
	iters: 500, epoch: 8 | loss: 0.2358703
	speed: 0.4228s/iter; left time: 3822.9533s
	iters: 600, epoch: 8 | loss: 0.2353736
	speed: 0.4191s/iter; left time: 3748.0419s
	iters: 700, epoch: 8 | loss: 0.2551472
	speed: 0.4212s/iter; left time: 3724.5031s
Epoch: 8 cost time: 308.25790524482727
Epoch: 8, Steps: 734 | Train Loss: 0.2425268 Vali Loss: 0.3594576 Test Loss: 0.4435560
Validation loss decreased (0.362483 --> 0.359458).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.2379475
	speed: 0.9139s/iter; left time: 7959.5719s
	iters: 200, epoch: 9 | loss: 0.2457802
	speed: 0.4404s/iter; left time: 3791.2659s
	iters: 300, epoch: 9 | loss: 0.2543761
	speed: 0.4201s/iter; left time: 3574.3650s
	iters: 400, epoch: 9 | loss: 0.2202281
	speed: 0.4199s/iter; left time: 3531.2460s
	iters: 500, epoch: 9 | loss: 0.2276529
	speed: 0.4270s/iter; left time: 3548.1186s
	iters: 600, epoch: 9 | loss: 0.2497361
	speed: 0.4197s/iter; left time: 3445.3899s
	iters: 700, epoch: 9 | loss: 0.2437839
	speed: 0.4199s/iter; left time: 3404.7301s
Epoch: 9 cost time: 311.12473940849304
Epoch: 9, Steps: 734 | Train Loss: 0.2403040 Vali Loss: 0.3574843 Test Loss: 0.4412975
Validation loss decreased (0.359458 --> 0.357484).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.2593113
	speed: 0.9127s/iter; left time: 7279.0193s
	iters: 200, epoch: 10 | loss: 0.2400941
	speed: 0.4292s/iter; left time: 3379.8367s
	iters: 300, epoch: 10 | loss: 0.2267695
	speed: 0.4284s/iter; left time: 3330.5637s
	iters: 400, epoch: 10 | loss: 0.2434759
	speed: 0.4195s/iter; left time: 3219.5010s
	iters: 500, epoch: 10 | loss: 0.2159235
	speed: 0.4231s/iter; left time: 3205.0642s
	iters: 600, epoch: 10 | loss: 0.2269297
	speed: 0.4207s/iter; left time: 3144.6681s
	iters: 700, epoch: 10 | loss: 0.2221816
	speed: 0.4186s/iter; left time: 3086.9038s
Epoch: 10 cost time: 310.1841015815735
Epoch: 10, Steps: 734 | Train Loss: 0.2390333 Vali Loss: 0.3563711 Test Loss: 0.4399927
Validation loss decreased (0.357484 --> 0.356371).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.2338440
	speed: 0.9186s/iter; left time: 6651.8121s
	iters: 200, epoch: 11 | loss: 0.2467918
	speed: 0.4205s/iter; left time: 3002.8755s
	iters: 300, epoch: 11 | loss: 0.2576466
	speed: 0.4428s/iter; left time: 3118.0138s
	iters: 400, epoch: 11 | loss: 0.2526085
	speed: 0.4205s/iter; left time: 2918.7508s
	iters: 500, epoch: 11 | loss: 0.2572679
	speed: 0.4272s/iter; left time: 2922.5506s
	iters: 600, epoch: 11 | loss: 0.2468973
	speed: 0.4282s/iter; left time: 2886.6818s
	iters: 700, epoch: 11 | loss: 0.2330130
	speed: 0.4210s/iter; left time: 2796.1023s
Epoch: 11 cost time: 312.4781675338745
Epoch: 11, Steps: 734 | Train Loss: 0.2383548 Vali Loss: 0.3560443 Test Loss: 0.4395943
Validation loss decreased (0.356371 --> 0.356044).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.2276940
	speed: 0.9267s/iter; left time: 6029.8479s
	iters: 200, epoch: 12 | loss: 0.2191497
	speed: 0.4188s/iter; left time: 2683.3020s
	iters: 300, epoch: 12 | loss: 0.2149663
	speed: 0.4400s/iter; left time: 2775.1125s
	iters: 400, epoch: 12 | loss: 0.2365777
	speed: 0.4216s/iter; left time: 2617.1437s
	iters: 500, epoch: 12 | loss: 0.2533119
	speed: 0.4212s/iter; left time: 2572.4313s
	iters: 600, epoch: 12 | loss: 0.2199125
	speed: 0.4283s/iter; left time: 2573.0071s
	iters: 700, epoch: 12 | loss: 0.2386475
	speed: 0.4196s/iter; left time: 2478.5873s
Epoch: 12 cost time: 311.95891213417053
Epoch: 12, Steps: 734 | Train Loss: 0.2379799 Vali Loss: 0.3554855 Test Loss: 0.4393848
Validation loss decreased (0.356044 --> 0.355485).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.2388075
	speed: 0.9239s/iter; left time: 5333.7538s
	iters: 200, epoch: 13 | loss: 0.2323212
	speed: 0.4210s/iter; left time: 2388.2686s
	iters: 300, epoch: 13 | loss: 0.2336901
	speed: 0.4258s/iter; left time: 2373.2355s
	iters: 400, epoch: 13 | loss: 0.2244438
	speed: 0.4283s/iter; left time: 2343.9749s
	iters: 500, epoch: 13 | loss: 0.2219840
	speed: 0.4218s/iter; left time: 2266.3164s
	iters: 600, epoch: 13 | loss: 0.2657119
	speed: 0.4308s/iter; left time: 2271.4449s
	iters: 700, epoch: 13 | loss: 0.2421497
	speed: 0.4212s/iter; left time: 2178.8662s
Epoch: 13 cost time: 311.63320803642273
Epoch: 13, Steps: 734 | Train Loss: 0.2377633 Vali Loss: 0.3557847 Test Loss: 0.4393032
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 14 | loss: 0.2441790
	speed: 0.8665s/iter; left time: 4366.2992s
	iters: 200, epoch: 14 | loss: 0.2089874
	speed: 0.4176s/iter; left time: 2062.3924s
	iters: 300, epoch: 14 | loss: 0.2189934
	speed: 0.4175s/iter; left time: 2020.2447s
	iters: 400, epoch: 14 | loss: 0.2204122
	speed: 0.4351s/iter; left time: 2061.7449s
	iters: 500, epoch: 14 | loss: 0.2518256
	speed: 0.4214s/iter; left time: 1954.9022s
	iters: 600, epoch: 14 | loss: 0.2429947
	speed: 0.4210s/iter; left time: 1910.7175s
	iters: 700, epoch: 14 | loss: 0.2251278
	speed: 0.4256s/iter; left time: 1889.1799s
Epoch: 14 cost time: 311.89481353759766
Epoch: 14, Steps: 734 | Train Loss: 0.2377077 Vali Loss: 0.3558767 Test Loss: 0.4392613
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 15 | loss: 0.2101840
	speed: 0.8530s/iter; left time: 3672.2670s
	iters: 200, epoch: 15 | loss: 0.2167404
	speed: 0.4319s/iter; left time: 1815.9509s
	iters: 300, epoch: 15 | loss: 0.2395259
	speed: 0.4193s/iter; left time: 1721.2648s
	iters: 400, epoch: 15 | loss: 0.2389938
	speed: 0.4365s/iter; left time: 1748.2759s
	iters: 500, epoch: 15 | loss: 0.2471883
	speed: 0.4254s/iter; left time: 1661.1768s
	iters: 600, epoch: 15 | loss: 0.2477478
	speed: 0.4205s/iter; left time: 1599.9879s
	iters: 700, epoch: 15 | loss: 0.2586112
	speed: 0.4262s/iter; left time: 1578.9600s
Epoch: 15 cost time: 312.9593276977539
Epoch: 15, Steps: 734 | Train Loss: 0.2376237 Vali Loss: 0.3557535 Test Loss: 0.4392551
EarlyStopping counter: 3 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 16 | loss: 0.2317110
	speed: 0.8475s/iter; left time: 3026.4613s
	iters: 200, epoch: 16 | loss: 0.2452692
	speed: 0.4338s/iter; left time: 1505.8274s
	iters: 300, epoch: 16 | loss: 0.2467512
	speed: 0.4190s/iter; left time: 1412.6090s
	iters: 400, epoch: 16 | loss: 0.2390593
	speed: 0.4189s/iter; left time: 1370.2651s
	iters: 500, epoch: 16 | loss: 0.2969681
	speed: 0.4464s/iter; left time: 1415.6043s
	iters: 600, epoch: 16 | loss: 0.2137974
	speed: 0.4206s/iter; left time: 1291.5924s
	iters: 700, epoch: 16 | loss: 0.2273592
	speed: 0.4221s/iter; left time: 1254.0586s
Epoch: 16 cost time: 312.76119470596313
Epoch: 16, Steps: 734 | Train Loss: 0.2375773 Vali Loss: 0.3558869 Test Loss: 0.4392534
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 17 | loss: 0.2334198
	speed: 0.8507s/iter; left time: 2413.4322s
	iters: 200, epoch: 17 | loss: 0.2312550
	speed: 0.4272s/iter; left time: 1169.3802s
	iters: 300, epoch: 17 | loss: 0.2158297
	speed: 0.4247s/iter; left time: 1119.9018s
	iters: 400, epoch: 17 | loss: 0.2259167
	speed: 0.4194s/iter; left time: 1063.9087s
	iters: 500, epoch: 17 | loss: 0.2141192
	speed: 0.4332s/iter; left time: 1055.7292s
	iters: 600, epoch: 17 | loss: 0.2327358
	speed: 0.4423s/iter; left time: 1033.7120s
	iters: 700, epoch: 17 | loss: 0.2463242
	speed: 0.4213s/iter; left time: 942.4617s
Epoch: 17 cost time: 313.42431354522705
Epoch: 17, Steps: 734 | Train Loss: 0.2375887 Vali Loss: 0.3556722 Test Loss: 0.4392523
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : traffic_336_192_DLinear_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed10458<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3317
mse:0.43908071517944336, mae:0.3044523596763611
