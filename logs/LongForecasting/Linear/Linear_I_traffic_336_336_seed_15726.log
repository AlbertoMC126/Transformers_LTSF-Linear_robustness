Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='Linear', model_id='traffic_336_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=336, root_path='./dataset/', save_pred_values=False, seed=15726, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_336_336_Linear_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15726>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11609
val 1421
test 3173
	iters: 100, epoch: 1 | loss: 0.4735988
	speed: 0.3206s/iter; left time: 4616.8521s
	iters: 200, epoch: 1 | loss: 0.4656046
	speed: 0.3079s/iter; left time: 4403.1278s
	iters: 300, epoch: 1 | loss: 0.4799719
	speed: 0.3076s/iter; left time: 4368.3320s
	iters: 400, epoch: 1 | loss: 0.5482146
	speed: 0.3084s/iter; left time: 4348.5492s
	iters: 500, epoch: 1 | loss: 0.5137299
	speed: 0.3106s/iter; left time: 4348.5654s
	iters: 600, epoch: 1 | loss: 0.5098308
	speed: 0.3088s/iter; left time: 4292.5502s
	iters: 700, epoch: 1 | loss: 0.4904305
	speed: 0.3064s/iter; left time: 4228.7644s
Epoch: 1 cost time: 224.8755886554718
Epoch: 1, Steps: 725 | Train Loss: 0.4935424 Vali Loss: 0.6295596 Test Loss: 0.7576648
Validation loss decreased (inf --> 0.629560).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.4427632
	speed: 0.6043s/iter; left time: 8264.4203s
	iters: 200, epoch: 2 | loss: 0.4546807
	speed: 0.3058s/iter; left time: 4151.3927s
	iters: 300, epoch: 2 | loss: 0.5278436
	speed: 0.3056s/iter; left time: 4117.6747s
	iters: 400, epoch: 2 | loss: 0.5000706
	speed: 0.3062s/iter; left time: 4095.7832s
	iters: 500, epoch: 2 | loss: 0.4797852
	speed: 0.3088s/iter; left time: 4099.1120s
	iters: 600, epoch: 2 | loss: 0.4992731
	speed: 0.3088s/iter; left time: 4068.7359s
	iters: 700, epoch: 2 | loss: 0.4937073
	speed: 0.3092s/iter; left time: 4043.3491s
Epoch: 2 cost time: 222.93152832984924
Epoch: 2, Steps: 725 | Train Loss: 0.4893592 Vali Loss: 0.6706722 Test Loss: 0.7984257
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.3491923
	speed: 0.6003s/iter; left time: 7774.3187s
	iters: 200, epoch: 3 | loss: 0.3215654
	speed: 0.3086s/iter; left time: 3965.5981s
	iters: 300, epoch: 3 | loss: 0.3355049
	speed: 0.3087s/iter; left time: 3936.5617s
	iters: 400, epoch: 3 | loss: 0.3396186
	speed: 0.3077s/iter; left time: 3892.6408s
	iters: 500, epoch: 3 | loss: 0.3231358
	speed: 0.3076s/iter; left time: 3860.7095s
	iters: 600, epoch: 3 | loss: 0.3431764
	speed: 0.3095s/iter; left time: 3853.6959s
	iters: 700, epoch: 3 | loss: 0.3468017
	speed: 0.3097s/iter; left time: 3825.4106s
Epoch: 3 cost time: 223.5504286289215
Epoch: 3, Steps: 725 | Train Loss: 0.3419409 Vali Loss: 0.4731154 Test Loss: 0.5767105
Validation loss decreased (0.629560 --> 0.473115).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.2874807
	speed: 0.6095s/iter; left time: 7452.3028s
	iters: 200, epoch: 4 | loss: 0.3026632
	speed: 0.3078s/iter; left time: 3732.3945s
	iters: 300, epoch: 4 | loss: 0.3151111
	speed: 0.3065s/iter; left time: 3685.9112s
	iters: 400, epoch: 4 | loss: 0.2880901
	speed: 0.3088s/iter; left time: 3682.2714s
	iters: 500, epoch: 4 | loss: 0.3205669
	speed: 0.3079s/iter; left time: 3641.6982s
	iters: 600, epoch: 4 | loss: 0.2807466
	speed: 0.3083s/iter; left time: 3615.5421s
	iters: 700, epoch: 4 | loss: 0.3129899
	speed: 0.3095s/iter; left time: 3598.0789s
Epoch: 4 cost time: 223.7049469947815
Epoch: 4, Steps: 725 | Train Loss: 0.2936459 Vali Loss: 0.4175305 Test Loss: 0.5089630
Validation loss decreased (0.473115 --> 0.417531).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.2792656
	speed: 0.6112s/iter; left time: 7029.4433s
	iters: 200, epoch: 5 | loss: 0.2516909
	speed: 0.3073s/iter; left time: 3503.5453s
	iters: 300, epoch: 5 | loss: 0.2594357
	speed: 0.3087s/iter; left time: 3488.2652s
	iters: 400, epoch: 5 | loss: 0.2848424
	speed: 0.3062s/iter; left time: 3429.5646s
	iters: 500, epoch: 5 | loss: 0.2724242
	speed: 0.3059s/iter; left time: 3395.6060s
	iters: 600, epoch: 5 | loss: 0.2523733
	speed: 0.3079s/iter; left time: 3386.7902s
	iters: 700, epoch: 5 | loss: 0.2848095
	speed: 0.3105s/iter; left time: 3384.6189s
Epoch: 5 cost time: 223.48203587532043
Epoch: 5, Steps: 725 | Train Loss: 0.2725031 Vali Loss: 0.3953687 Test Loss: 0.4812634
Validation loss decreased (0.417531 --> 0.395369).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.2636963
	speed: 0.6103s/iter; left time: 6576.4136s
	iters: 200, epoch: 6 | loss: 0.2615818
	speed: 0.3118s/iter; left time: 3329.1559s
	iters: 300, epoch: 6 | loss: 0.2409628
	speed: 0.3075s/iter; left time: 3251.8541s
	iters: 400, epoch: 6 | loss: 0.2700568
	speed: 0.3083s/iter; left time: 3229.3627s
	iters: 500, epoch: 6 | loss: 0.2520677
	speed: 0.3062s/iter; left time: 3176.8254s
	iters: 600, epoch: 6 | loss: 0.2710901
	speed: 0.3086s/iter; left time: 3171.1181s
	iters: 700, epoch: 6 | loss: 0.2648145
	speed: 0.3094s/iter; left time: 3147.9938s
Epoch: 6 cost time: 224.02727246284485
Epoch: 6, Steps: 725 | Train Loss: 0.2613002 Vali Loss: 0.3821660 Test Loss: 0.4661117
Validation loss decreased (0.395369 --> 0.382166).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.2476481
	speed: 0.6072s/iter; left time: 6102.6918s
	iters: 200, epoch: 7 | loss: 0.2350699
	speed: 0.3093s/iter; left time: 3078.2836s
	iters: 300, epoch: 7 | loss: 0.2692948
	speed: 0.3064s/iter; left time: 3017.9663s
	iters: 400, epoch: 7 | loss: 0.2543650
	speed: 0.3047s/iter; left time: 2970.8746s
	iters: 500, epoch: 7 | loss: 0.2461320
	speed: 0.3074s/iter; left time: 2966.2968s
	iters: 600, epoch: 7 | loss: 0.2494711
	speed: 0.3080s/iter; left time: 2941.8619s
	iters: 700, epoch: 7 | loss: 0.2922306
	speed: 0.3080s/iter; left time: 2910.7832s
Epoch: 7 cost time: 223.07655382156372
Epoch: 7, Steps: 725 | Train Loss: 0.2552466 Vali Loss: 0.3756952 Test Loss: 0.4593467
Validation loss decreased (0.382166 --> 0.375695).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.2701743
	speed: 0.6115s/iter; left time: 5702.4137s
	iters: 200, epoch: 8 | loss: 0.2686152
	speed: 0.3096s/iter; left time: 2856.6134s
	iters: 300, epoch: 8 | loss: 0.2456528
	speed: 0.3091s/iter; left time: 2820.9513s
	iters: 400, epoch: 8 | loss: 0.2663503
	speed: 0.3063s/iter; left time: 2765.0836s
	iters: 500, epoch: 8 | loss: 0.2455528
	speed: 0.3079s/iter; left time: 2748.1283s
	iters: 600, epoch: 8 | loss: 0.2714314
	speed: 0.3059s/iter; left time: 2699.5262s
	iters: 700, epoch: 8 | loss: 0.2465479
	speed: 0.3048s/iter; left time: 2659.7413s
Epoch: 8 cost time: 223.18716645240784
Epoch: 8, Steps: 725 | Train Loss: 0.2518613 Vali Loss: 0.3732705 Test Loss: 0.4558882
Validation loss decreased (0.375695 --> 0.373270).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.2479934
	speed: 0.6097s/iter; left time: 5243.9963s
	iters: 200, epoch: 9 | loss: 0.2536817
	speed: 0.3073s/iter; left time: 2612.5194s
	iters: 300, epoch: 9 | loss: 0.2688944
	speed: 0.3091s/iter; left time: 2596.3476s
	iters: 400, epoch: 9 | loss: 0.2353374
	speed: 0.3084s/iter; left time: 2559.7673s
	iters: 500, epoch: 9 | loss: 0.2504384
	speed: 0.3049s/iter; left time: 2500.4793s
	iters: 600, epoch: 9 | loss: 0.2385455
	speed: 0.3049s/iter; left time: 2469.6156s
	iters: 700, epoch: 9 | loss: 0.2735293
	speed: 0.3075s/iter; left time: 2460.4258s
Epoch: 9 cost time: 222.98364305496216
Epoch: 9, Steps: 725 | Train Loss: 0.2500669 Vali Loss: 0.3714329 Test Loss: 0.4544455
Validation loss decreased (0.373270 --> 0.371433).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.2372630
	speed: 0.6075s/iter; left time: 4784.3801s
	iters: 200, epoch: 10 | loss: 0.2511871
	speed: 0.3092s/iter; left time: 2404.2511s
	iters: 300, epoch: 10 | loss: 0.2497043
	speed: 0.3078s/iter; left time: 2362.3466s
	iters: 400, epoch: 10 | loss: 0.2610648
	speed: 0.3083s/iter; left time: 2335.6163s
	iters: 500, epoch: 10 | loss: 0.2562206
	speed: 0.3075s/iter; left time: 2298.6555s
	iters: 600, epoch: 10 | loss: 0.2559620
	speed: 0.3058s/iter; left time: 2255.8870s
	iters: 700, epoch: 10 | loss: 0.2576983
	speed: 0.3056s/iter; left time: 2223.4442s
Epoch: 10 cost time: 223.05979418754578
Epoch: 10, Steps: 725 | Train Loss: 0.2490702 Vali Loss: 0.3711538 Test Loss: 0.4536349
Validation loss decreased (0.371433 --> 0.371154).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.2606947
	speed: 0.6039s/iter; left time: 4318.6643s
	iters: 200, epoch: 11 | loss: 0.2421399
	speed: 0.3092s/iter; left time: 2180.2807s
	iters: 300, epoch: 11 | loss: 0.2655425
	speed: 0.3094s/iter; left time: 2150.7519s
	iters: 400, epoch: 11 | loss: 0.2651830
	speed: 0.3104s/iter; left time: 2126.5535s
	iters: 500, epoch: 11 | loss: 0.2458774
	speed: 0.3099s/iter; left time: 2092.1300s
	iters: 600, epoch: 11 | loss: 0.2439166
	speed: 0.3065s/iter; left time: 2038.5330s
	iters: 700, epoch: 11 | loss: 0.2444701
	speed: 0.3072s/iter; left time: 2012.6678s
Epoch: 11 cost time: 223.71435523033142
Epoch: 11, Steps: 725 | Train Loss: 0.2485495 Vali Loss: 0.3709661 Test Loss: 0.4534411
Validation loss decreased (0.371154 --> 0.370966).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.2687582
	speed: 0.6090s/iter; left time: 3913.6501s
	iters: 200, epoch: 12 | loss: 0.2580617
	speed: 0.3068s/iter; left time: 1940.7744s
	iters: 300, epoch: 12 | loss: 0.2722873
	speed: 0.3076s/iter; left time: 1914.9375s
	iters: 400, epoch: 12 | loss: 0.2242945
	speed: 0.3086s/iter; left time: 1890.2157s
	iters: 500, epoch: 12 | loss: 0.2576212
	speed: 0.3073s/iter; left time: 1851.7200s
	iters: 600, epoch: 12 | loss: 0.2697662
	speed: 0.3077s/iter; left time: 1823.5223s
	iters: 700, epoch: 12 | loss: 0.2475926
	speed: 0.3052s/iter; left time: 1778.0683s
Epoch: 12 cost time: 222.93723392486572
Epoch: 12, Steps: 725 | Train Loss: 0.2482356 Vali Loss: 0.3709732 Test Loss: 0.4533556
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.2311760
	speed: 0.6041s/iter; left time: 3444.2080s
	iters: 200, epoch: 13 | loss: 0.2541004
	speed: 0.3062s/iter; left time: 1714.7775s
	iters: 300, epoch: 13 | loss: 0.2664037
	speed: 0.3062s/iter; left time: 1684.4321s
	iters: 400, epoch: 13 | loss: 0.2550674
	speed: 0.3068s/iter; left time: 1656.7659s
	iters: 500, epoch: 13 | loss: 0.2686376
	speed: 0.3110s/iter; left time: 1648.6195s
	iters: 600, epoch: 13 | loss: 0.2592758
	speed: 0.3086s/iter; left time: 1604.8141s
	iters: 700, epoch: 13 | loss: 0.2604193
	speed: 0.3080s/iter; left time: 1570.8697s
Epoch: 13 cost time: 223.24620008468628
Epoch: 13, Steps: 725 | Train Loss: 0.2481010 Vali Loss: 0.3709806 Test Loss: 0.4533300
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 14 | loss: 0.2334295
	speed: 0.6062s/iter; left time: 3016.4805s
	iters: 200, epoch: 14 | loss: 0.2501776
	speed: 0.3068s/iter; left time: 1495.8163s
	iters: 300, epoch: 14 | loss: 0.2620226
	speed: 0.3068s/iter; left time: 1465.0598s
	iters: 400, epoch: 14 | loss: 0.2476194
	speed: 0.3103s/iter; left time: 1450.9858s
	iters: 500, epoch: 14 | loss: 0.2595569
	speed: 0.3072s/iter; left time: 1405.5793s
	iters: 600, epoch: 14 | loss: 0.2442363
	speed: 0.3066s/iter; left time: 1372.4168s
	iters: 700, epoch: 14 | loss: 0.2176979
	speed: 0.3090s/iter; left time: 1352.2819s
Epoch: 14 cost time: 223.4324290752411
Epoch: 14, Steps: 725 | Train Loss: 0.2479831 Vali Loss: 0.3706726 Test Loss: 0.4532959
Validation loss decreased (0.370966 --> 0.370673).  Saving model ...
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 15 | loss: 0.2538051
	speed: 0.6116s/iter; left time: 2599.9944s
	iters: 200, epoch: 15 | loss: 0.2200115
	speed: 0.3055s/iter; left time: 1268.2853s
	iters: 300, epoch: 15 | loss: 0.2486260
	speed: 0.3058s/iter; left time: 1238.7571s
	iters: 400, epoch: 15 | loss: 0.2388746
	speed: 0.3059s/iter; left time: 1208.7076s
	iters: 500, epoch: 15 | loss: 0.2369135
	speed: 0.3086s/iter; left time: 1188.3364s
	iters: 600, epoch: 15 | loss: 0.2209006
	speed: 0.3075s/iter; left time: 1153.2664s
	iters: 700, epoch: 15 | loss: 0.2606890
	speed: 0.3087s/iter; left time: 1126.9185s
Epoch: 15 cost time: 222.89004254341125
Epoch: 15, Steps: 725 | Train Loss: 0.2479519 Vali Loss: 0.3707535 Test Loss: 0.4532841
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 16 | loss: 0.2799893
	speed: 0.6023s/iter; left time: 2123.6563s
	iters: 200, epoch: 16 | loss: 0.2707036
	speed: 0.3057s/iter; left time: 1047.3706s
	iters: 300, epoch: 16 | loss: 0.2465473
	speed: 0.3091s/iter; left time: 1027.9762s
	iters: 400, epoch: 16 | loss: 0.2621647
	speed: 0.3041s/iter; left time: 980.9439s
	iters: 500, epoch: 16 | loss: 0.2287125
	speed: 0.3046s/iter; left time: 952.0295s
	iters: 600, epoch: 16 | loss: 0.2619325
	speed: 0.3067s/iter; left time: 927.9685s
	iters: 700, epoch: 16 | loss: 0.2292836
	speed: 0.3076s/iter; left time: 900.0598s
Epoch: 16 cost time: 222.08764243125916
Epoch: 16, Steps: 725 | Train Loss: 0.2479535 Vali Loss: 0.3707500 Test Loss: 0.4532816
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 17 | loss: 0.2454129
	speed: 0.5989s/iter; left time: 1677.5621s
	iters: 200, epoch: 17 | loss: 0.2620826
	speed: 0.3075s/iter; left time: 830.5428s
	iters: 300, epoch: 17 | loss: 0.2693967
	speed: 0.3089s/iter; left time: 803.3693s
	iters: 400, epoch: 17 | loss: 0.2409633
	speed: 0.3081s/iter; left time: 770.6830s
	iters: 500, epoch: 17 | loss: 0.2216624
	speed: 0.3068s/iter; left time: 736.6958s
	iters: 600, epoch: 17 | loss: 0.2315769
	speed: 0.3105s/iter; left time: 714.3455s
	iters: 700, epoch: 17 | loss: 0.2516323
	speed: 0.3079s/iter; left time: 677.6477s
Epoch: 17 cost time: 223.2565610408783
Epoch: 17, Steps: 725 | Train Loss: 0.2479364 Vali Loss: 0.3705945 Test Loss: 0.4532806
Validation loss decreased (0.370673 --> 0.370595).  Saving model ...
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 18 | loss: 0.2798611
	speed: 0.6121s/iter; left time: 1270.6537s
	iters: 200, epoch: 18 | loss: 0.2570517
	speed: 0.3075s/iter; left time: 607.7047s
	iters: 300, epoch: 18 | loss: 0.2642144
	speed: 0.3049s/iter; left time: 572.0822s
	iters: 400, epoch: 18 | loss: 0.2613706
	speed: 0.3067s/iter; left time: 544.7407s
	iters: 500, epoch: 18 | loss: 0.2534688
	speed: 0.3095s/iter; left time: 518.6862s
	iters: 600, epoch: 18 | loss: 0.2503228
	speed: 0.3098s/iter; left time: 488.1898s
	iters: 700, epoch: 18 | loss: 0.2548416
	speed: 0.3097s/iter; left time: 457.0891s
Epoch: 18 cost time: 223.60142159461975
Epoch: 18, Steps: 725 | Train Loss: 0.2479016 Vali Loss: 0.3707579 Test Loss: 0.4532803
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 19 | loss: 0.2569689
	speed: 0.6054s/iter; left time: 817.9334s
	iters: 200, epoch: 19 | loss: 0.2559415
	speed: 0.3086s/iter; left time: 386.0969s
	iters: 300, epoch: 19 | loss: 0.2396215
	speed: 0.3069s/iter; left time: 353.1852s
	iters: 400, epoch: 19 | loss: 0.2309724
	speed: 0.3066s/iter; left time: 322.2276s
	iters: 500, epoch: 19 | loss: 0.2436899
	speed: 0.3054s/iter; left time: 290.4055s
	iters: 600, epoch: 19 | loss: 0.2537156
	speed: 0.3053s/iter; left time: 259.8227s
	iters: 700, epoch: 19 | loss: 0.2491525
	speed: 0.3071s/iter; left time: 230.6210s
Epoch: 19 cost time: 222.79142117500305
Epoch: 19, Steps: 725 | Train Loss: 0.2479298 Vali Loss: 0.3707517 Test Loss: 0.4532800
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 20 | loss: 0.2231893
	speed: 0.6034s/iter; left time: 377.6989s
	iters: 200, epoch: 20 | loss: 0.2367055
	speed: 0.3079s/iter; left time: 161.9783s
	iters: 300, epoch: 20 | loss: 0.2451031
	speed: 0.3068s/iter; left time: 130.6865s
	iters: 400, epoch: 20 | loss: 0.2425569
	speed: 0.3051s/iter; left time: 99.4681s
	iters: 500, epoch: 20 | loss: 0.2643326
	speed: 0.3053s/iter; left time: 69.0040s
	iters: 600, epoch: 20 | loss: 0.2575216
	speed: 0.3047s/iter; left time: 38.3937s
	iters: 700, epoch: 20 | loss: 0.2594716
	speed: 0.3082s/iter; left time: 8.0127s
Epoch: 20 cost time: 222.43862891197205
Epoch: 20, Steps: 725 | Train Loss: 0.2479047 Vali Loss: 0.3708732 Test Loss: 0.4532800
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.9073486328125e-08
>>>>>>>testing : traffic_336_336_Linear_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15726<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3173
mse:0.45230504870414734, mae:0.3120323121547699
