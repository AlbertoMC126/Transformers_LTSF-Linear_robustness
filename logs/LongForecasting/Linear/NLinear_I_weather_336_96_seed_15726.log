Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='NLinear', model_id='weather_336_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=15726, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : weather_336_96_NLinear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15726>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36456
val 5175
test 10444
	iters: 100, epoch: 1 | loss: 0.2833866
	speed: 0.0105s/iter; left time: 476.0679s
	iters: 200, epoch: 1 | loss: 1.3381988
	speed: 0.0111s/iter; left time: 502.1752s
	iters: 300, epoch: 1 | loss: 0.8496072
	speed: 0.0093s/iter; left time: 422.4027s
	iters: 400, epoch: 1 | loss: 0.6200239
	speed: 0.0090s/iter; left time: 406.4496s
	iters: 500, epoch: 1 | loss: 1.5957329
	speed: 0.0090s/iter; left time: 403.7708s
	iters: 600, epoch: 1 | loss: 0.4633292
	speed: 0.0090s/iter; left time: 403.9249s
	iters: 700, epoch: 1 | loss: 0.4578127
	speed: 0.0097s/iter; left time: 435.6292s
	iters: 800, epoch: 1 | loss: 2.5036159
	speed: 0.0096s/iter; left time: 431.1569s
	iters: 900, epoch: 1 | loss: 0.3683810
	speed: 0.0098s/iter; left time: 436.8935s
	iters: 1000, epoch: 1 | loss: 0.5626379
	speed: 0.0094s/iter; left time: 419.0153s
	iters: 1100, epoch: 1 | loss: 0.3131229
	speed: 0.0097s/iter; left time: 430.9852s
	iters: 1200, epoch: 1 | loss: 0.4404138
	speed: 0.0094s/iter; left time: 417.8885s
	iters: 1300, epoch: 1 | loss: 0.5855372
	speed: 0.0087s/iter; left time: 385.5928s
	iters: 1400, epoch: 1 | loss: 0.3371666
	speed: 0.0085s/iter; left time: 375.8140s
	iters: 1500, epoch: 1 | loss: 0.4479218
	speed: 0.0103s/iter; left time: 453.3921s
	iters: 1600, epoch: 1 | loss: 0.6265185
	speed: 0.0100s/iter; left time: 437.5654s
	iters: 1700, epoch: 1 | loss: 0.3308063
	speed: 0.0085s/iter; left time: 370.7483s
	iters: 1800, epoch: 1 | loss: 2.1057379
	speed: 0.0089s/iter; left time: 389.4765s
	iters: 1900, epoch: 1 | loss: 0.4652784
	speed: 0.0101s/iter; left time: 438.8077s
	iters: 2000, epoch: 1 | loss: 0.2839977
	speed: 0.0086s/iter; left time: 375.9320s
	iters: 2100, epoch: 1 | loss: 0.7795428
	speed: 0.0103s/iter; left time: 445.5747s
	iters: 2200, epoch: 1 | loss: 0.4388325
	speed: 0.0101s/iter; left time: 438.9665s
Epoch: 1 cost time: 21.68389630317688
Epoch: 1, Steps: 2278 | Train Loss: 1.9417476 Vali Loss: 0.7733849 Test Loss: 0.1996128
Validation loss decreased (inf --> 0.773385).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.6414353
	speed: 0.0398s/iter; left time: 1718.6712s
	iters: 200, epoch: 2 | loss: 1.4104662
	speed: 0.0089s/iter; left time: 384.0129s
	iters: 300, epoch: 2 | loss: 0.2747822
	speed: 0.0088s/iter; left time: 378.3563s
	iters: 400, epoch: 2 | loss: 0.4283425
	speed: 0.0084s/iter; left time: 359.0359s
	iters: 500, epoch: 2 | loss: 4.6690173
	speed: 0.0096s/iter; left time: 410.8057s
	iters: 600, epoch: 2 | loss: 0.4908521
	speed: 0.0083s/iter; left time: 352.9950s
	iters: 700, epoch: 2 | loss: 0.5831272
	speed: 0.0098s/iter; left time: 416.1477s
	iters: 800, epoch: 2 | loss: 0.3024308
	speed: 0.0101s/iter; left time: 429.5820s
	iters: 900, epoch: 2 | loss: 0.2941865
	speed: 0.0100s/iter; left time: 423.5391s
	iters: 1000, epoch: 2 | loss: 0.4272073
	speed: 0.0093s/iter; left time: 392.9588s
	iters: 1100, epoch: 2 | loss: 0.4012688
	speed: 0.0084s/iter; left time: 356.1022s
	iters: 1200, epoch: 2 | loss: 0.2707623
	speed: 0.0094s/iter; left time: 396.5433s
	iters: 1300, epoch: 2 | loss: 0.4721736
	speed: 0.0106s/iter; left time: 444.6059s
	iters: 1400, epoch: 2 | loss: 0.9097442
	speed: 0.0099s/iter; left time: 413.4962s
	iters: 1500, epoch: 2 | loss: 0.6196591
	speed: 0.0096s/iter; left time: 401.2253s
	iters: 1600, epoch: 2 | loss: 0.3920653
	speed: 0.0088s/iter; left time: 366.4176s
	iters: 1700, epoch: 2 | loss: 0.8887680
	speed: 0.0092s/iter; left time: 383.5459s
	iters: 1800, epoch: 2 | loss: 4.1935434
	speed: 0.0103s/iter; left time: 426.1113s
	iters: 1900, epoch: 2 | loss: 0.3584063
	speed: 0.0102s/iter; left time: 422.1882s
	iters: 2000, epoch: 2 | loss: 0.6292100
	speed: 0.0108s/iter; left time: 447.1879s
	iters: 2100, epoch: 2 | loss: 0.6955937
	speed: 0.0086s/iter; left time: 353.8445s
	iters: 2200, epoch: 2 | loss: 0.5751738
	speed: 0.0083s/iter; left time: 340.5597s
Epoch: 2 cost time: 21.40781044960022
Epoch: 2, Steps: 2278 | Train Loss: 5.5379516 Vali Loss: 6.3988485 Test Loss: 0.3741143
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.2789493
	speed: 0.0363s/iter; left time: 1485.2945s
	iters: 200, epoch: 3 | loss: 0.3979347
	speed: 0.0095s/iter; left time: 387.3513s
	iters: 300, epoch: 3 | loss: 0.4473346
	speed: 0.0104s/iter; left time: 423.4819s
	iters: 400, epoch: 3 | loss: 0.3365670
	speed: 0.0097s/iter; left time: 392.2315s
	iters: 500, epoch: 3 | loss: 0.4512579
	speed: 0.0090s/iter; left time: 365.8861s
	iters: 600, epoch: 3 | loss: 2.0179105
	speed: 0.0113s/iter; left time: 457.0686s
	iters: 700, epoch: 3 | loss: 0.4255817
	speed: 0.0105s/iter; left time: 422.5186s
	iters: 800, epoch: 3 | loss: 0.3976491
	speed: 0.0111s/iter; left time: 444.8202s
	iters: 900, epoch: 3 | loss: 0.3188751
	speed: 0.0105s/iter; left time: 423.0131s
	iters: 1000, epoch: 3 | loss: 0.4683926
	speed: 0.0103s/iter; left time: 412.8655s
	iters: 1100, epoch: 3 | loss: 0.6234452
	speed: 0.0096s/iter; left time: 381.5916s
	iters: 1200, epoch: 3 | loss: 0.5720010
	speed: 0.0086s/iter; left time: 344.0341s
	iters: 1300, epoch: 3 | loss: 0.2752424
	speed: 0.0087s/iter; left time: 345.1184s
	iters: 1400, epoch: 3 | loss: 2.7224147
	speed: 0.0112s/iter; left time: 443.3433s
	iters: 1500, epoch: 3 | loss: 0.7802895
	speed: 0.0095s/iter; left time: 373.4282s
	iters: 1600, epoch: 3 | loss: 0.2609942
	speed: 0.0096s/iter; left time: 378.3446s
	iters: 1700, epoch: 3 | loss: 0.3974614
	speed: 0.0083s/iter; left time: 327.8985s
	iters: 1800, epoch: 3 | loss: 0.3399023
	speed: 0.0096s/iter; left time: 376.3898s
	iters: 1900, epoch: 3 | loss: 0.2705413
	speed: 0.0088s/iter; left time: 345.3197s
	iters: 2000, epoch: 3 | loss: 0.3653040
	speed: 0.0097s/iter; left time: 376.6009s
	iters: 2100, epoch: 3 | loss: 0.4337065
	speed: 0.0083s/iter; left time: 322.5506s
	iters: 2200, epoch: 3 | loss: 0.6513252
	speed: 0.0098s/iter; left time: 379.6171s
Epoch: 3 cost time: 22.15590262413025
Epoch: 3, Steps: 2278 | Train Loss: 84.0124299 Vali Loss: 0.4524911 Test Loss: 0.1814631
Validation loss decreased (0.773385 --> 0.452491).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.6359750
	speed: 0.0377s/iter; left time: 1457.3664s
	iters: 200, epoch: 4 | loss: 0.3286803
	speed: 0.0089s/iter; left time: 342.9570s
	iters: 300, epoch: 4 | loss: 1.5162665
	speed: 0.0096s/iter; left time: 369.4380s
	iters: 400, epoch: 4 | loss: 0.7954532
	speed: 0.0088s/iter; left time: 335.9739s
	iters: 500, epoch: 4 | loss: 0.3157823
	speed: 0.0085s/iter; left time: 326.2076s
	iters: 600, epoch: 4 | loss: 1.2233548
	speed: 0.0091s/iter; left time: 346.5070s
	iters: 700, epoch: 4 | loss: 9.3794746
	speed: 0.0104s/iter; left time: 395.6492s
	iters: 800, epoch: 4 | loss: 0.4273950
	speed: 0.0101s/iter; left time: 382.3854s
	iters: 900, epoch: 4 | loss: 0.4612799
	speed: 0.0087s/iter; left time: 329.9421s
	iters: 1000, epoch: 4 | loss: 0.2176374
	speed: 0.0096s/iter; left time: 361.5740s
	iters: 1100, epoch: 4 | loss: 0.3751048
	speed: 0.0091s/iter; left time: 342.4813s
	iters: 1200, epoch: 4 | loss: 0.4330615
	speed: 0.0085s/iter; left time: 319.5824s
	iters: 1300, epoch: 4 | loss: 1.3937854
	speed: 0.0095s/iter; left time: 353.7827s
	iters: 1400, epoch: 4 | loss: 0.3874452
	speed: 0.0089s/iter; left time: 332.2871s
	iters: 1500, epoch: 4 | loss: 0.2492022
	speed: 0.0088s/iter; left time: 326.9462s
	iters: 1600, epoch: 4 | loss: 0.2864660
	speed: 0.0087s/iter; left time: 323.5077s
	iters: 1700, epoch: 4 | loss: 0.8711510
	speed: 0.0087s/iter; left time: 320.3707s
	iters: 1800, epoch: 4 | loss: 0.3470025
	speed: 0.0099s/iter; left time: 365.9662s
	iters: 1900, epoch: 4 | loss: 2.4577096
	speed: 0.0094s/iter; left time: 347.2947s
	iters: 2000, epoch: 4 | loss: 0.2856164
	speed: 0.0099s/iter; left time: 362.2013s
	iters: 2100, epoch: 4 | loss: 1.4328279
	speed: 0.0110s/iter; left time: 404.6004s
	iters: 2200, epoch: 4 | loss: 0.4226063
	speed: 0.0109s/iter; left time: 398.6111s
Epoch: 4 cost time: 21.42291808128357
Epoch: 4, Steps: 2278 | Train Loss: 12.4236656 Vali Loss: 0.4798293 Test Loss: 0.1606448
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.2419170
	speed: 0.0391s/iter; left time: 1420.7832s
	iters: 200, epoch: 5 | loss: 0.2751795
	speed: 0.0101s/iter; left time: 364.3963s
	iters: 300, epoch: 5 | loss: 0.4512060
	speed: 0.0092s/iter; left time: 331.4379s
	iters: 400, epoch: 5 | loss: 0.4355356
	speed: 0.0103s/iter; left time: 370.7832s
	iters: 500, epoch: 5 | loss: 0.4387677
	speed: 0.0096s/iter; left time: 344.7726s
	iters: 600, epoch: 5 | loss: 0.3906838
	speed: 0.0100s/iter; left time: 356.9836s
	iters: 700, epoch: 5 | loss: 0.3673528
	speed: 0.0096s/iter; left time: 344.3542s
	iters: 800, epoch: 5 | loss: 0.3334846
	speed: 0.0108s/iter; left time: 385.1248s
	iters: 900, epoch: 5 | loss: 0.3391683
	speed: 0.0084s/iter; left time: 299.7773s
	iters: 1000, epoch: 5 | loss: 0.2734869
	speed: 0.0098s/iter; left time: 348.0180s
	iters: 1100, epoch: 5 | loss: 0.5255120
	speed: 0.0096s/iter; left time: 338.4464s
	iters: 1200, epoch: 5 | loss: 0.4362042
	speed: 0.0104s/iter; left time: 367.6860s
	iters: 1300, epoch: 5 | loss: 0.5805275
	speed: 0.0107s/iter; left time: 376.8488s
	iters: 1400, epoch: 5 | loss: 0.2713757
	speed: 0.0114s/iter; left time: 398.2677s
	iters: 1500, epoch: 5 | loss: 0.6006349
	speed: 0.0103s/iter; left time: 359.3674s
	iters: 1600, epoch: 5 | loss: 0.2894306
	speed: 0.0101s/iter; left time: 350.9434s
	iters: 1700, epoch: 5 | loss: 0.2448758
	speed: 0.0091s/iter; left time: 314.4793s
	iters: 1800, epoch: 5 | loss: 0.2586105
	speed: 0.0087s/iter; left time: 302.9533s
	iters: 1900, epoch: 5 | loss: 0.3765005
	speed: 0.0091s/iter; left time: 313.2708s
	iters: 2000, epoch: 5 | loss: 0.3374519
	speed: 0.0096s/iter; left time: 329.7509s
	iters: 2100, epoch: 5 | loss: 0.4040959
	speed: 0.0108s/iter; left time: 369.6802s
	iters: 2200, epoch: 5 | loss: 0.5936452
	speed: 0.0099s/iter; left time: 338.8159s
Epoch: 5 cost time: 22.369710445404053
Epoch: 5, Steps: 2278 | Train Loss: 1.7701900 Vali Loss: 0.4025847 Test Loss: 0.1560021
Validation loss decreased (0.452491 --> 0.402585).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.2707958
	speed: 0.0395s/iter; left time: 1346.0918s
	iters: 200, epoch: 6 | loss: 0.2310949
	speed: 0.0093s/iter; left time: 316.6189s
	iters: 300, epoch: 6 | loss: 0.2621252
	speed: 0.0096s/iter; left time: 323.5001s
	iters: 400, epoch: 6 | loss: 0.2164846
	speed: 0.0093s/iter; left time: 315.4850s
	iters: 500, epoch: 6 | loss: 0.1952635
	speed: 0.0082s/iter; left time: 274.5055s
	iters: 600, epoch: 6 | loss: 0.2163792
	speed: 0.0112s/iter; left time: 377.4811s
	iters: 700, epoch: 6 | loss: 0.2274445
	speed: 0.0102s/iter; left time: 340.0909s
	iters: 800, epoch: 6 | loss: 0.1816670
	speed: 0.0098s/iter; left time: 327.3267s
	iters: 900, epoch: 6 | loss: 2.1245606
	speed: 0.0101s/iter; left time: 336.7802s
	iters: 1000, epoch: 6 | loss: 0.6864116
	speed: 0.0100s/iter; left time: 332.8253s
	iters: 1100, epoch: 6 | loss: 0.3283133
	speed: 0.0105s/iter; left time: 348.0325s
	iters: 1200, epoch: 6 | loss: 0.2085533
	speed: 0.0101s/iter; left time: 332.7835s
	iters: 1300, epoch: 6 | loss: 0.4047253
	speed: 0.0089s/iter; left time: 292.2953s
	iters: 1400, epoch: 6 | loss: 0.3086202
	speed: 0.0096s/iter; left time: 314.3083s
	iters: 1500, epoch: 6 | loss: 0.2654578
	speed: 0.0099s/iter; left time: 324.0971s
	iters: 1600, epoch: 6 | loss: 0.2272003
	speed: 0.0103s/iter; left time: 335.2395s
	iters: 1700, epoch: 6 | loss: 0.4382926
	speed: 0.0088s/iter; left time: 284.5175s
	iters: 1800, epoch: 6 | loss: 0.2488889
	speed: 0.0099s/iter; left time: 319.2698s
	iters: 1900, epoch: 6 | loss: 0.2896426
	speed: 0.0087s/iter; left time: 281.8401s
	iters: 2000, epoch: 6 | loss: 0.3011915
	speed: 0.0094s/iter; left time: 302.4830s
	iters: 2100, epoch: 6 | loss: 0.3173939
	speed: 0.0089s/iter; left time: 286.7269s
	iters: 2200, epoch: 6 | loss: 0.3085614
	speed: 0.0081s/iter; left time: 257.7380s
Epoch: 6 cost time: 21.741554260253906
Epoch: 6, Steps: 2278 | Train Loss: 0.8847605 Vali Loss: 0.3866736 Test Loss: 0.1447144
Validation loss decreased (0.402585 --> 0.386674).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.2797250
	speed: 0.0374s/iter; left time: 1188.4027s
	iters: 200, epoch: 7 | loss: 0.3100518
	speed: 0.0098s/iter; left time: 311.9379s
	iters: 300, epoch: 7 | loss: 0.3009417
	speed: 0.0089s/iter; left time: 279.6962s
	iters: 400, epoch: 7 | loss: 0.3289097
	speed: 0.0083s/iter; left time: 262.7158s
	iters: 500, epoch: 7 | loss: 0.5865832
	speed: 0.0088s/iter; left time: 276.3618s
	iters: 600, epoch: 7 | loss: 0.2031371
	speed: 0.0088s/iter; left time: 276.7097s
	iters: 700, epoch: 7 | loss: 0.3158066
	speed: 0.0071s/iter; left time: 220.2223s
	iters: 800, epoch: 7 | loss: 0.2387724
	speed: 0.0083s/iter; left time: 257.8493s
	iters: 900, epoch: 7 | loss: 0.6475751
	speed: 0.0084s/iter; left time: 258.8776s
	iters: 1000, epoch: 7 | loss: 0.2256943
	speed: 0.0085s/iter; left time: 261.4437s
	iters: 1100, epoch: 7 | loss: 2.1669917
	speed: 0.0073s/iter; left time: 223.5558s
	iters: 1200, epoch: 7 | loss: 0.4977913
	speed: 0.0084s/iter; left time: 256.6548s
	iters: 1300, epoch: 7 | loss: 0.3871984
	speed: 0.0096s/iter; left time: 292.8632s
	iters: 1400, epoch: 7 | loss: 0.4654621
	speed: 0.0099s/iter; left time: 303.1254s
	iters: 1500, epoch: 7 | loss: 0.3005499
	speed: 0.0101s/iter; left time: 307.3389s
	iters: 1600, epoch: 7 | loss: 1.6786013
	speed: 0.0090s/iter; left time: 271.7974s
	iters: 1700, epoch: 7 | loss: 0.2463054
	speed: 0.0089s/iter; left time: 267.3887s
	iters: 1800, epoch: 7 | loss: 0.2274395
	speed: 0.0100s/iter; left time: 300.9969s
	iters: 1900, epoch: 7 | loss: 0.1799480
	speed: 0.0091s/iter; left time: 272.0694s
	iters: 2000, epoch: 7 | loss: 0.4361950
	speed: 0.0088s/iter; left time: 262.7829s
	iters: 2100, epoch: 7 | loss: 0.5716714
	speed: 0.0101s/iter; left time: 302.1802s
	iters: 2200, epoch: 7 | loss: 0.5746893
	speed: 0.0096s/iter; left time: 286.2962s
Epoch: 7 cost time: 20.351974964141846
Epoch: 7, Steps: 2278 | Train Loss: 0.4777511 Vali Loss: 0.3849399 Test Loss: 0.1443564
Validation loss decreased (0.386674 --> 0.384940).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.2811976
	speed: 0.0366s/iter; left time: 1079.4492s
	iters: 200, epoch: 8 | loss: 0.6020789
	speed: 0.0101s/iter; left time: 298.0425s
	iters: 300, epoch: 8 | loss: 0.3194618
	speed: 0.0102s/iter; left time: 299.6991s
	iters: 400, epoch: 8 | loss: 0.2780556
	speed: 0.0098s/iter; left time: 285.6772s
	iters: 500, epoch: 8 | loss: 0.2189530
	speed: 0.0093s/iter; left time: 270.5011s
	iters: 600, epoch: 8 | loss: 0.1778214
	speed: 0.0095s/iter; left time: 275.6989s
	iters: 700, epoch: 8 | loss: 0.3573087
	speed: 0.0088s/iter; left time: 255.1182s
	iters: 800, epoch: 8 | loss: 0.3606221
	speed: 0.0090s/iter; left time: 260.2296s
	iters: 900, epoch: 8 | loss: 0.4132102
	speed: 0.0097s/iter; left time: 277.7810s
	iters: 1000, epoch: 8 | loss: 0.2312673
	speed: 0.0092s/iter; left time: 261.8523s
	iters: 1100, epoch: 8 | loss: 0.3585003
	speed: 0.0086s/iter; left time: 245.5614s
	iters: 1200, epoch: 8 | loss: 0.5818798
	speed: 0.0078s/iter; left time: 222.3785s
	iters: 1300, epoch: 8 | loss: 0.3175934
	speed: 0.0084s/iter; left time: 237.8412s
	iters: 1400, epoch: 8 | loss: 0.2051298
	speed: 0.0092s/iter; left time: 259.7714s
	iters: 1500, epoch: 8 | loss: 0.2561566
	speed: 0.0101s/iter; left time: 284.0295s
	iters: 1600, epoch: 8 | loss: 0.3985872
	speed: 0.0096s/iter; left time: 268.1875s
	iters: 1700, epoch: 8 | loss: 0.7706892
	speed: 0.0074s/iter; left time: 205.7702s
	iters: 1800, epoch: 8 | loss: 0.3580787
	speed: 0.0085s/iter; left time: 237.3323s
	iters: 1900, epoch: 8 | loss: 2.1382360
	speed: 0.0099s/iter; left time: 273.8790s
	iters: 2000, epoch: 8 | loss: 0.2945653
	speed: 0.0100s/iter; left time: 277.2608s
	iters: 2100, epoch: 8 | loss: 0.3511252
	speed: 0.0085s/iter; left time: 232.5651s
	iters: 2200, epoch: 8 | loss: 0.2164292
	speed: 0.0093s/iter; left time: 254.4218s
Epoch: 8 cost time: 21.134073972702026
Epoch: 8, Steps: 2278 | Train Loss: 0.4341784 Vali Loss: 0.3800285 Test Loss: 0.1443858
Validation loss decreased (0.384940 --> 0.380029).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.2800408
	speed: 0.0368s/iter; left time: 1002.4277s
	iters: 200, epoch: 9 | loss: 0.2163606
	speed: 0.0109s/iter; left time: 295.9140s
	iters: 300, epoch: 9 | loss: 0.5302232
	speed: 0.0108s/iter; left time: 291.3181s
	iters: 400, epoch: 9 | loss: 0.2857019
	speed: 0.0111s/iter; left time: 300.1600s
	iters: 500, epoch: 9 | loss: 0.2507772
	speed: 0.0102s/iter; left time: 273.8277s
	iters: 600, epoch: 9 | loss: 0.5288496
	speed: 0.0087s/iter; left time: 233.7593s
	iters: 700, epoch: 9 | loss: 2.1691098
	speed: 0.0089s/iter; left time: 236.2242s
	iters: 800, epoch: 9 | loss: 0.1687218
	speed: 0.0092s/iter; left time: 243.9380s
	iters: 900, epoch: 9 | loss: 4.8440166
	speed: 0.0105s/iter; left time: 276.6137s
	iters: 1000, epoch: 9 | loss: 0.2397600
	speed: 0.0115s/iter; left time: 302.0200s
	iters: 1100, epoch: 9 | loss: 0.3820553
	speed: 0.0100s/iter; left time: 263.5062s
	iters: 1200, epoch: 9 | loss: 0.2530709
	speed: 0.0087s/iter; left time: 227.6652s
	iters: 1300, epoch: 9 | loss: 0.1846358
	speed: 0.0101s/iter; left time: 262.0198s
	iters: 1400, epoch: 9 | loss: 0.2747873
	speed: 0.0108s/iter; left time: 278.9832s
	iters: 1500, epoch: 9 | loss: 0.2889565
	speed: 0.0101s/iter; left time: 261.7612s
	iters: 1600, epoch: 9 | loss: 0.2958810
	speed: 0.0099s/iter; left time: 254.8965s
	iters: 1700, epoch: 9 | loss: 0.2684808
	speed: 0.0075s/iter; left time: 192.7906s
	iters: 1800, epoch: 9 | loss: 0.1818465
	speed: 0.0092s/iter; left time: 234.2251s
	iters: 1900, epoch: 9 | loss: 0.2866227
	speed: 0.0097s/iter; left time: 245.5140s
	iters: 2000, epoch: 9 | loss: 0.6237068
	speed: 0.0092s/iter; left time: 232.6024s
	iters: 2100, epoch: 9 | loss: 0.4261554
	speed: 0.0087s/iter; left time: 219.3855s
	iters: 2200, epoch: 9 | loss: 0.1674625
	speed: 0.0088s/iter; left time: 222.3183s
Epoch: 9 cost time: 22.149234771728516
Epoch: 9, Steps: 2278 | Train Loss: 0.4242737 Vali Loss: 0.3772582 Test Loss: 0.1431812
Validation loss decreased (0.380029 --> 0.377258).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.7102755
	speed: 0.0380s/iter; left time: 949.6861s
	iters: 200, epoch: 10 | loss: 0.2405920
	speed: 0.0115s/iter; left time: 285.1970s
	iters: 300, epoch: 10 | loss: 0.3657733
	speed: 0.0111s/iter; left time: 275.0175s
	iters: 400, epoch: 10 | loss: 0.4042522
	speed: 0.0104s/iter; left time: 256.7582s
	iters: 500, epoch: 10 | loss: 0.2822473
	speed: 0.0068s/iter; left time: 167.2911s
	iters: 600, epoch: 10 | loss: 0.2041233
	speed: 0.0104s/iter; left time: 254.2298s
	iters: 700, epoch: 10 | loss: 0.3299294
	speed: 0.0092s/iter; left time: 222.8966s
	iters: 800, epoch: 10 | loss: 0.2211340
	speed: 0.0098s/iter; left time: 237.5639s
	iters: 900, epoch: 10 | loss: 0.6001035
	speed: 0.0084s/iter; left time: 203.4187s
	iters: 1000, epoch: 10 | loss: 0.2945693
	speed: 0.0084s/iter; left time: 202.8755s
	iters: 1100, epoch: 10 | loss: 0.2419918
	speed: 0.0112s/iter; left time: 268.2932s
	iters: 1200, epoch: 10 | loss: 0.2051531
	speed: 0.0105s/iter; left time: 249.8546s
	iters: 1300, epoch: 10 | loss: 0.2035342
	speed: 0.0096s/iter; left time: 227.6135s
	iters: 1400, epoch: 10 | loss: 2.0529828
	speed: 0.0098s/iter; left time: 231.1818s
	iters: 1500, epoch: 10 | loss: 0.2639039
	speed: 0.0089s/iter; left time: 209.5016s
	iters: 1600, epoch: 10 | loss: 0.2567058
	speed: 0.0090s/iter; left time: 210.2035s
	iters: 1700, epoch: 10 | loss: 0.2182688
	speed: 0.0080s/iter; left time: 186.5980s
	iters: 1800, epoch: 10 | loss: 0.2905182
	speed: 0.0094s/iter; left time: 217.7617s
	iters: 1900, epoch: 10 | loss: 0.3495867
	speed: 0.0097s/iter; left time: 224.4655s
	iters: 2000, epoch: 10 | loss: 2.5235839
	speed: 0.0098s/iter; left time: 226.6907s
	iters: 2100, epoch: 10 | loss: 0.3103689
	speed: 0.0089s/iter; left time: 204.3954s
	iters: 2200, epoch: 10 | loss: 0.2650993
	speed: 0.0096s/iter; left time: 218.3240s
Epoch: 10 cost time: 21.495937824249268
Epoch: 10, Steps: 2278 | Train Loss: 0.4214320 Vali Loss: 0.3763119 Test Loss: 0.1432149
Validation loss decreased (0.377258 --> 0.376312).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.2409843
	speed: 0.0380s/iter; left time: 862.3004s
	iters: 200, epoch: 11 | loss: 0.7379617
	speed: 0.0108s/iter; left time: 244.4193s
	iters: 300, epoch: 11 | loss: 0.1937271
	speed: 0.0101s/iter; left time: 227.7803s
	iters: 400, epoch: 11 | loss: 0.3620102
	speed: 0.0101s/iter; left time: 226.7689s
	iters: 500, epoch: 11 | loss: 0.2006695
	speed: 0.0103s/iter; left time: 230.1806s
	iters: 600, epoch: 11 | loss: 0.3802803
	speed: 0.0097s/iter; left time: 215.2407s
	iters: 700, epoch: 11 | loss: 0.3542506
	speed: 0.0088s/iter; left time: 195.1744s
	iters: 800, epoch: 11 | loss: 0.8186201
	speed: 0.0088s/iter; left time: 192.9947s
	iters: 900, epoch: 11 | loss: 0.2377211
	speed: 0.0084s/iter; left time: 183.1718s
	iters: 1000, epoch: 11 | loss: 0.2032869
	speed: 0.0109s/iter; left time: 237.4546s
	iters: 1100, epoch: 11 | loss: 0.3177090
	speed: 0.0096s/iter; left time: 208.2181s
	iters: 1200, epoch: 11 | loss: 0.2189581
	speed: 0.0097s/iter; left time: 209.7499s
	iters: 1300, epoch: 11 | loss: 0.3706257
	speed: 0.0098s/iter; left time: 209.8599s
	iters: 1400, epoch: 11 | loss: 0.4109423
	speed: 0.0097s/iter; left time: 207.8096s
	iters: 1500, epoch: 11 | loss: 0.2509037
	speed: 0.0108s/iter; left time: 230.0608s
	iters: 1600, epoch: 11 | loss: 0.2308332
	speed: 0.0101s/iter; left time: 213.5691s
	iters: 1700, epoch: 11 | loss: 0.4456305
	speed: 0.0107s/iter; left time: 226.2189s
	iters: 1800, epoch: 11 | loss: 0.1565857
	speed: 0.0107s/iter; left time: 223.6715s
	iters: 1900, epoch: 11 | loss: 0.3974713
	speed: 0.0096s/iter; left time: 200.5632s
	iters: 2000, epoch: 11 | loss: 0.2446181
	speed: 0.0100s/iter; left time: 207.6001s
	iters: 2100, epoch: 11 | loss: 0.2451288
	speed: 0.0100s/iter; left time: 205.8297s
	iters: 2200, epoch: 11 | loss: 0.3761570
	speed: 0.0098s/iter; left time: 202.1816s
Epoch: 11 cost time: 22.734909534454346
Epoch: 11, Steps: 2278 | Train Loss: 0.4204266 Vali Loss: 0.3781717 Test Loss: 0.1432644
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.3300536
	speed: 0.0442s/iter; left time: 901.1988s
	iters: 200, epoch: 12 | loss: 0.2309258
	speed: 0.0098s/iter; left time: 197.9946s
	iters: 300, epoch: 12 | loss: 0.2849016
	speed: 0.0097s/iter; left time: 194.9659s
	iters: 400, epoch: 12 | loss: 0.4470333
	speed: 0.0094s/iter; left time: 189.8215s
	iters: 500, epoch: 12 | loss: 0.2139566
	speed: 0.0084s/iter; left time: 167.2252s
	iters: 600, epoch: 12 | loss: 0.2491249
	speed: 0.0101s/iter; left time: 200.9676s
	iters: 700, epoch: 12 | loss: 0.2272287
	speed: 0.0092s/iter; left time: 182.3990s
	iters: 800, epoch: 12 | loss: 0.4814319
	speed: 0.0090s/iter; left time: 176.7798s
	iters: 900, epoch: 12 | loss: 0.2058308
	speed: 0.0089s/iter; left time: 174.3135s
	iters: 1000, epoch: 12 | loss: 0.1679978
	speed: 0.0084s/iter; left time: 164.4744s
	iters: 1100, epoch: 12 | loss: 0.2641781
	speed: 0.0075s/iter; left time: 144.5865s
	iters: 1200, epoch: 12 | loss: 0.2985365
	speed: 0.0086s/iter; left time: 165.6318s
	iters: 1300, epoch: 12 | loss: 0.3553930
	speed: 0.0095s/iter; left time: 181.7999s
	iters: 1400, epoch: 12 | loss: 0.2222126
	speed: 0.0090s/iter; left time: 172.6426s
	iters: 1500, epoch: 12 | loss: 2.2498641
	speed: 0.0078s/iter; left time: 148.4200s
	iters: 1600, epoch: 12 | loss: 0.2719754
	speed: 0.0087s/iter; left time: 164.5183s
	iters: 1700, epoch: 12 | loss: 0.4458278
	speed: 0.0088s/iter; left time: 165.5458s
	iters: 1800, epoch: 12 | loss: 0.3059191
	speed: 0.0100s/iter; left time: 187.4613s
	iters: 1900, epoch: 12 | loss: 0.4065145
	speed: 0.0109s/iter; left time: 202.0678s
	iters: 2000, epoch: 12 | loss: 0.5117432
	speed: 0.0108s/iter; left time: 200.6250s
	iters: 2100, epoch: 12 | loss: 0.2155444
	speed: 0.0112s/iter; left time: 205.4275s
	iters: 2200, epoch: 12 | loss: 0.2391292
	speed: 0.0108s/iter; left time: 196.9912s
Epoch: 12 cost time: 21.439563989639282
Epoch: 12, Steps: 2278 | Train Loss: 0.4199301 Vali Loss: 0.3779183 Test Loss: 0.1432739
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.2881758
	speed: 0.0361s/iter; left time: 654.8527s
	iters: 200, epoch: 13 | loss: 0.2770557
	speed: 0.0099s/iter; left time: 179.2289s
	iters: 300, epoch: 13 | loss: 0.2224031
	speed: 0.0079s/iter; left time: 141.6157s
	iters: 400, epoch: 13 | loss: 0.3122813
	speed: 0.0079s/iter; left time: 141.2095s
	iters: 500, epoch: 13 | loss: 0.2054066
	speed: 0.0096s/iter; left time: 170.4745s
	iters: 600, epoch: 13 | loss: 0.5688744
	speed: 0.0097s/iter; left time: 170.3002s
	iters: 700, epoch: 13 | loss: 0.3515808
	speed: 0.0109s/iter; left time: 191.4172s
	iters: 800, epoch: 13 | loss: 0.3299764
	speed: 0.0101s/iter; left time: 176.3956s
	iters: 900, epoch: 13 | loss: 0.2707064
	speed: 0.0101s/iter; left time: 174.3355s
	iters: 1000, epoch: 13 | loss: 0.2639371
	speed: 0.0089s/iter; left time: 153.8344s
	iters: 1100, epoch: 13 | loss: 0.3561513
	speed: 0.0086s/iter; left time: 146.4194s
	iters: 1200, epoch: 13 | loss: 0.7306162
	speed: 0.0092s/iter; left time: 157.3520s
	iters: 1300, epoch: 13 | loss: 0.4233663
	speed: 0.0087s/iter; left time: 147.9833s
	iters: 1400, epoch: 13 | loss: 0.3146179
	speed: 0.0095s/iter; left time: 160.0464s
	iters: 1500, epoch: 13 | loss: 0.6085839
	speed: 0.0087s/iter; left time: 146.1996s
	iters: 1600, epoch: 13 | loss: 0.1596358
	speed: 0.0104s/iter; left time: 173.2697s
	iters: 1700, epoch: 13 | loss: 0.3995882
	speed: 0.0111s/iter; left time: 183.2590s
	iters: 1800, epoch: 13 | loss: 0.4188010
	speed: 0.0112s/iter; left time: 183.3420s
	iters: 1900, epoch: 13 | loss: 0.2224871
	speed: 0.0097s/iter; left time: 157.6038s
	iters: 2000, epoch: 13 | loss: 0.4345354
	speed: 0.0091s/iter; left time: 148.1634s
	iters: 2100, epoch: 13 | loss: 0.2528568
	speed: 0.0085s/iter; left time: 136.4492s
	iters: 2200, epoch: 13 | loss: 0.2697781
	speed: 0.0091s/iter; left time: 145.5592s
Epoch: 13 cost time: 21.324594974517822
Epoch: 13, Steps: 2278 | Train Loss: 0.4194754 Vali Loss: 0.3782052 Test Loss: 0.1434705
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.2601301
	speed: 0.0386s/iter; left time: 611.9952s
	iters: 200, epoch: 14 | loss: 0.6103063
	speed: 0.0088s/iter; left time: 138.9521s
	iters: 300, epoch: 14 | loss: 0.2141231
	speed: 0.0093s/iter; left time: 145.3921s
	iters: 400, epoch: 14 | loss: 0.3976246
	speed: 0.0086s/iter; left time: 134.1793s
	iters: 500, epoch: 14 | loss: 0.4026387
	speed: 0.0090s/iter; left time: 138.4734s
	iters: 600, epoch: 14 | loss: 0.2604443
	speed: 0.0094s/iter; left time: 143.5519s
	iters: 700, epoch: 14 | loss: 0.2881744
	speed: 0.0099s/iter; left time: 151.5999s
	iters: 800, epoch: 14 | loss: 0.2082649
	speed: 0.0107s/iter; left time: 162.1297s
	iters: 900, epoch: 14 | loss: 0.4743250
	speed: 0.0100s/iter; left time: 149.9074s
	iters: 1000, epoch: 14 | loss: 0.3055030
	speed: 0.0109s/iter; left time: 162.3705s
	iters: 1100, epoch: 14 | loss: 0.2020752
	speed: 0.0111s/iter; left time: 164.1480s
	iters: 1200, epoch: 14 | loss: 0.1741804
	speed: 0.0100s/iter; left time: 146.7702s
	iters: 1300, epoch: 14 | loss: 0.3847117
	speed: 0.0104s/iter; left time: 151.9222s
	iters: 1400, epoch: 14 | loss: 0.7382213
	speed: 0.0097s/iter; left time: 141.5762s
	iters: 1500, epoch: 14 | loss: 0.2413024
	speed: 0.0107s/iter; left time: 155.0651s
	iters: 1600, epoch: 14 | loss: 0.2872493
	speed: 0.0110s/iter; left time: 158.1457s
	iters: 1700, epoch: 14 | loss: 0.3153189
	speed: 0.0106s/iter; left time: 150.3478s
	iters: 1800, epoch: 14 | loss: 0.4051468
	speed: 0.0081s/iter; left time: 115.1898s
	iters: 1900, epoch: 14 | loss: 0.4053050
	speed: 0.0081s/iter; left time: 113.5074s
	iters: 2000, epoch: 14 | loss: 0.2495992
	speed: 0.0084s/iter; left time: 117.7480s
	iters: 2100, epoch: 14 | loss: 0.2834525
	speed: 0.0095s/iter; left time: 132.0947s
	iters: 2200, epoch: 14 | loss: 0.3601383
	speed: 0.0100s/iter; left time: 138.0632s
Epoch: 14 cost time: 22.07425093650818
Epoch: 14, Steps: 2278 | Train Loss: 0.4194894 Vali Loss: 0.3780259 Test Loss: 0.1432875
EarlyStopping counter: 4 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.4571300
	speed: 0.0372s/iter; left time: 505.0589s
	iters: 200, epoch: 15 | loss: 0.5611138
	speed: 0.0082s/iter; left time: 109.9663s
	iters: 300, epoch: 15 | loss: 0.6792147
	speed: 0.0093s/iter; left time: 124.4670s
	iters: 400, epoch: 15 | loss: 0.2678486
	speed: 0.0080s/iter; left time: 105.8877s
	iters: 500, epoch: 15 | loss: 0.3632048
	speed: 0.0085s/iter; left time: 111.4476s
	iters: 600, epoch: 15 | loss: 0.2225811
	speed: 0.0088s/iter; left time: 115.4095s
	iters: 700, epoch: 15 | loss: 0.1584705
	speed: 0.0096s/iter; left time: 124.8955s
	iters: 800, epoch: 15 | loss: 0.2199198
	speed: 0.0092s/iter; left time: 118.4255s
	iters: 900, epoch: 15 | loss: 0.4089663
	speed: 0.0089s/iter; left time: 113.9446s
	iters: 1000, epoch: 15 | loss: 0.2297639
	speed: 0.0090s/iter; left time: 114.0478s
	iters: 1100, epoch: 15 | loss: 0.2280463
	speed: 0.0080s/iter; left time: 100.3135s
	iters: 1200, epoch: 15 | loss: 0.3070256
	speed: 0.0083s/iter; left time: 102.8746s
	iters: 1300, epoch: 15 | loss: 0.2247299
	speed: 0.0084s/iter; left time: 104.1552s
	iters: 1400, epoch: 15 | loss: 0.2813258
	speed: 0.0089s/iter; left time: 109.4729s
	iters: 1500, epoch: 15 | loss: 0.5924297
	speed: 0.0087s/iter; left time: 105.4247s
	iters: 1600, epoch: 15 | loss: 0.2080922
	speed: 0.0100s/iter; left time: 121.0802s
	iters: 1700, epoch: 15 | loss: 0.1518469
	speed: 0.0098s/iter; left time: 116.9666s
	iters: 1800, epoch: 15 | loss: 0.3152145
	speed: 0.0099s/iter; left time: 117.5500s
	iters: 1900, epoch: 15 | loss: 0.2798142
	speed: 0.0102s/iter; left time: 120.3122s
	iters: 2000, epoch: 15 | loss: 0.1435799
	speed: 0.0092s/iter; left time: 106.8025s
	iters: 2100, epoch: 15 | loss: 0.3663950
	speed: 0.0103s/iter; left time: 118.7418s
	iters: 2200, epoch: 15 | loss: 0.3304980
	speed: 0.0094s/iter; left time: 107.5869s
Epoch: 15 cost time: 20.803866624832153
Epoch: 15, Steps: 2278 | Train Loss: 0.4193883 Vali Loss: 0.3782709 Test Loss: 0.1432801
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : weather_336_96_NLinear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15726<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
mse:0.14325597882270813, mae:0.1923099011182785
