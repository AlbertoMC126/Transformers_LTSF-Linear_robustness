Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='DLinear', model_id='traffic_336_192', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=192, root_path='./dataset/', save_pred_values=False, seed=15726, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_336_192_DLinear_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15726>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11753
val 1565
test 3317
	iters: 100, epoch: 1 | loss: 0.5203255
	speed: 0.4353s/iter; left time: 6347.5491s
	iters: 200, epoch: 1 | loss: 0.5718574
	speed: 0.3992s/iter; left time: 5780.3737s
	iters: 300, epoch: 1 | loss: 0.6000989
	speed: 0.3986s/iter; left time: 5732.0877s
	iters: 400, epoch: 1 | loss: 0.5782933
	speed: 0.3993s/iter; left time: 5702.5361s
	iters: 500, epoch: 1 | loss: 0.5740229
	speed: 0.3985s/iter; left time: 5651.0097s
	iters: 600, epoch: 1 | loss: 0.6071972
	speed: 0.3981s/iter; left time: 5606.2265s
	iters: 700, epoch: 1 | loss: 0.5926705
	speed: 0.3991s/iter; left time: 5579.6082s
Epoch: 1 cost time: 296.75183057785034
Epoch: 1, Steps: 734 | Train Loss: 0.5886249 Vali Loss: 0.8074604 Test Loss: 0.9501230
Validation loss decreased (inf --> 0.807460).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.5620399
	speed: 0.8942s/iter; left time: 12382.3482s
	iters: 200, epoch: 2 | loss: 0.5645494
	speed: 0.4020s/iter; left time: 5526.7922s
	iters: 300, epoch: 2 | loss: 0.5864170
	speed: 0.3997s/iter; left time: 5454.1216s
	iters: 400, epoch: 2 | loss: 0.5858229
	speed: 0.4023s/iter; left time: 5449.9211s
	iters: 500, epoch: 2 | loss: 0.5949083
	speed: 0.4026s/iter; left time: 5413.8554s
	iters: 600, epoch: 2 | loss: 0.5773323
	speed: 0.3972s/iter; left time: 5301.6439s
	iters: 700, epoch: 2 | loss: 0.5638017
	speed: 0.3952s/iter; left time: 5235.6243s
Epoch: 2 cost time: 294.03635263442993
Epoch: 2, Steps: 734 | Train Loss: 0.5791053 Vali Loss: 0.8278887 Test Loss: 0.9555715
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.3657625
	speed: 0.8278s/iter; left time: 10855.1345s
	iters: 200, epoch: 3 | loss: 0.3683938
	speed: 0.4033s/iter; left time: 5248.2264s
	iters: 300, epoch: 3 | loss: 0.3581196
	speed: 0.4030s/iter; left time: 5203.8444s
	iters: 400, epoch: 3 | loss: 0.3606984
	speed: 0.4015s/iter; left time: 5144.8415s
	iters: 500, epoch: 3 | loss: 0.3608689
	speed: 0.3978s/iter; left time: 5057.0725s
	iters: 600, epoch: 3 | loss: 0.3794421
	speed: 0.3993s/iter; left time: 5035.8392s
	iters: 700, epoch: 3 | loss: 0.3791050
	speed: 0.3900s/iter; left time: 4880.4239s
Epoch: 3 cost time: 292.6473617553711
Epoch: 3, Steps: 734 | Train Loss: 0.3592088 Vali Loss: 0.5080431 Test Loss: 0.6154822
Validation loss decreased (0.807460 --> 0.508043).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.2968538
	speed: 0.8872s/iter; left time: 10982.4750s
	iters: 200, epoch: 4 | loss: 0.3368784
	speed: 0.4036s/iter; left time: 4955.8634s
	iters: 300, epoch: 4 | loss: 0.2846734
	speed: 0.4060s/iter; left time: 4944.9534s
	iters: 400, epoch: 4 | loss: 0.2718293
	speed: 0.4033s/iter; left time: 4871.7203s
	iters: 500, epoch: 4 | loss: 0.3164855
	speed: 0.4005s/iter; left time: 4798.0338s
	iters: 600, epoch: 4 | loss: 0.3158356
	speed: 0.4025s/iter; left time: 4781.2742s
	iters: 700, epoch: 4 | loss: 0.2847210
	speed: 0.4063s/iter; left time: 4785.9200s
Epoch: 4 cost time: 295.5556287765503
Epoch: 4, Steps: 734 | Train Loss: 0.2951795 Vali Loss: 0.4241238 Test Loss: 0.5185209
Validation loss decreased (0.508043 --> 0.424124).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.2937382
	speed: 0.8978s/iter; left time: 10454.9501s
	iters: 200, epoch: 5 | loss: 0.2535984
	speed: 0.4040s/iter; left time: 4664.3032s
	iters: 300, epoch: 5 | loss: 0.3096331
	speed: 0.4005s/iter; left time: 4583.5957s
	iters: 400, epoch: 5 | loss: 0.2482517
	speed: 0.4000s/iter; left time: 4537.8110s
	iters: 500, epoch: 5 | loss: 0.2321911
	speed: 0.3996s/iter; left time: 4493.3699s
	iters: 600, epoch: 5 | loss: 0.2696859
	speed: 0.3972s/iter; left time: 4426.8912s
	iters: 700, epoch: 5 | loss: 0.2649841
	speed: 0.4044s/iter; left time: 4466.4712s
Epoch: 5 cost time: 294.68890929222107
Epoch: 5, Steps: 734 | Train Loss: 0.2677350 Vali Loss: 0.3861929 Test Loss: 0.4757021
Validation loss decreased (0.424124 --> 0.386193).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.2451391
	speed: 0.8985s/iter; left time: 9803.6381s
	iters: 200, epoch: 6 | loss: 0.2648772
	speed: 0.4118s/iter; left time: 4452.1907s
	iters: 300, epoch: 6 | loss: 0.2513218
	speed: 0.4016s/iter; left time: 4301.3683s
	iters: 400, epoch: 6 | loss: 0.2368640
	speed: 0.4023s/iter; left time: 4268.5326s
	iters: 500, epoch: 6 | loss: 0.2768584
	speed: 0.4016s/iter; left time: 4220.7679s
	iters: 600, epoch: 6 | loss: 0.2754255
	speed: 0.3969s/iter; left time: 4131.9550s
	iters: 700, epoch: 6 | loss: 0.2447078
	speed: 0.3990s/iter; left time: 4114.0150s
Epoch: 6 cost time: 295.2725131511688
Epoch: 6, Steps: 734 | Train Loss: 0.2540245 Vali Loss: 0.3708003 Test Loss: 0.4574122
Validation loss decreased (0.386193 --> 0.370800).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.2525536
	speed: 0.9063s/iter; left time: 9223.4155s
	iters: 200, epoch: 7 | loss: 0.2236971
	speed: 0.4136s/iter; left time: 4167.5563s
	iters: 300, epoch: 7 | loss: 0.2448757
	speed: 0.4044s/iter; left time: 4034.9297s
	iters: 400, epoch: 7 | loss: 0.2609412
	speed: 0.3989s/iter; left time: 3939.6534s
	iters: 500, epoch: 7 | loss: 0.2491058
	speed: 0.3990s/iter; left time: 3900.5421s
	iters: 600, epoch: 7 | loss: 0.2393114
	speed: 0.4025s/iter; left time: 3895.1235s
	iters: 700, epoch: 7 | loss: 0.2517760
	speed: 0.3982s/iter; left time: 3813.3965s
Epoch: 7 cost time: 296.26474261283875
Epoch: 7, Steps: 734 | Train Loss: 0.2466247 Vali Loss: 0.3640169 Test Loss: 0.4482788
Validation loss decreased (0.370800 --> 0.364017).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.2290252
	speed: 0.9022s/iter; left time: 8519.2842s
	iters: 200, epoch: 8 | loss: 0.2369926
	speed: 0.4072s/iter; left time: 3804.2142s
	iters: 300, epoch: 8 | loss: 0.2852002
	speed: 0.3999s/iter; left time: 3696.5200s
	iters: 400, epoch: 8 | loss: 0.2094672
	speed: 0.4035s/iter; left time: 3689.4660s
	iters: 500, epoch: 8 | loss: 0.2283318
	speed: 0.4043s/iter; left time: 3656.5078s
	iters: 600, epoch: 8 | loss: 0.2648668
	speed: 0.4072s/iter; left time: 3641.2047s
	iters: 700, epoch: 8 | loss: 0.2462414
	speed: 0.3996s/iter; left time: 3533.5677s
Epoch: 8 cost time: 296.28533601760864
Epoch: 8, Steps: 734 | Train Loss: 0.2425045 Vali Loss: 0.3587819 Test Loss: 0.4430124
Validation loss decreased (0.364017 --> 0.358782).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.2307627
	speed: 0.9088s/iter; left time: 7914.3985s
	iters: 200, epoch: 9 | loss: 0.2508484
	speed: 0.4043s/iter; left time: 3480.4646s
	iters: 300, epoch: 9 | loss: 0.2417344
	speed: 0.3990s/iter; left time: 3394.8509s
	iters: 400, epoch: 9 | loss: 0.2443290
	speed: 0.4050s/iter; left time: 3405.3722s
	iters: 500, epoch: 9 | loss: 0.2322423
	speed: 0.3991s/iter; left time: 3315.7531s
	iters: 600, epoch: 9 | loss: 0.2384714
	speed: 0.3998s/iter; left time: 3281.8809s
	iters: 700, epoch: 9 | loss: 0.2402027
	speed: 0.4031s/iter; left time: 3268.9998s
Epoch: 9 cost time: 295.8358681201935
Epoch: 9, Steps: 734 | Train Loss: 0.2402290 Vali Loss: 0.3569593 Test Loss: 0.4408479
Validation loss decreased (0.358782 --> 0.356959).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.2409411
	speed: 0.9008s/iter; left time: 7183.9490s
	iters: 200, epoch: 10 | loss: 0.2412532
	speed: 0.4186s/iter; left time: 3296.5347s
	iters: 300, epoch: 10 | loss: 0.2455808
	speed: 0.4009s/iter; left time: 3117.2454s
	iters: 400, epoch: 10 | loss: 0.2203838
	speed: 0.3982s/iter; left time: 3056.1398s
	iters: 500, epoch: 10 | loss: 0.2263523
	speed: 0.4002s/iter; left time: 3031.3025s
	iters: 600, epoch: 10 | loss: 0.2554766
	speed: 0.3987s/iter; left time: 2980.2010s
	iters: 700, epoch: 10 | loss: 0.2283767
	speed: 0.4072s/iter; left time: 3003.2562s
Epoch: 10 cost time: 296.4768431186676
Epoch: 10, Steps: 734 | Train Loss: 0.2390313 Vali Loss: 0.3561043 Test Loss: 0.4399380
Validation loss decreased (0.356959 --> 0.356104).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.2292282
	speed: 0.9056s/iter; left time: 6557.3790s
	iters: 200, epoch: 11 | loss: 0.2131636
	speed: 0.4095s/iter; left time: 2924.3339s
	iters: 300, epoch: 11 | loss: 0.2293602
	speed: 0.4019s/iter; left time: 2830.1073s
	iters: 400, epoch: 11 | loss: 0.2548670
	speed: 0.3982s/iter; left time: 2764.2422s
	iters: 500, epoch: 11 | loss: 0.2590021
	speed: 0.4017s/iter; left time: 2748.2403s
	iters: 600, epoch: 11 | loss: 0.2246764
	speed: 0.3980s/iter; left time: 2682.9230s
	iters: 700, epoch: 11 | loss: 0.2550679
	speed: 0.3983s/iter; left time: 2645.3897s
Epoch: 11 cost time: 295.22370195388794
Epoch: 11, Steps: 734 | Train Loss: 0.2383591 Vali Loss: 0.3556328 Test Loss: 0.4394665
Validation loss decreased (0.356104 --> 0.355633).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.2365952
	speed: 0.9075s/iter; left time: 5904.9769s
	iters: 200, epoch: 12 | loss: 0.2371828
	speed: 0.4056s/iter; left time: 2598.8045s
	iters: 300, epoch: 12 | loss: 0.2580230
	speed: 0.4045s/iter; left time: 2551.2757s
	iters: 400, epoch: 12 | loss: 0.2513694
	speed: 0.3977s/iter; left time: 2468.4943s
	iters: 500, epoch: 12 | loss: 0.2209914
	speed: 0.3977s/iter; left time: 2429.0085s
	iters: 600, epoch: 12 | loss: 0.2229533
	speed: 0.3994s/iter; left time: 2399.3955s
	iters: 700, epoch: 12 | loss: 0.2202375
	speed: 0.3996s/iter; left time: 2360.5191s
Epoch: 12 cost time: 294.6439754962921
Epoch: 12, Steps: 734 | Train Loss: 0.2379644 Vali Loss: 0.3557872 Test Loss: 0.4392986
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.2347958
	speed: 0.8315s/iter; left time: 4800.0689s
	iters: 200, epoch: 13 | loss: 0.2030705
	speed: 0.3945s/iter; left time: 2238.1825s
	iters: 300, epoch: 13 | loss: 0.2290416
	speed: 0.3972s/iter; left time: 2213.5274s
	iters: 400, epoch: 13 | loss: 0.2349171
	speed: 0.4040s/iter; left time: 2211.0614s
	iters: 500, epoch: 13 | loss: 0.2031238
	speed: 0.4004s/iter; left time: 2151.2940s
	iters: 600, epoch: 13 | loss: 0.2487298
	speed: 0.3956s/iter; left time: 2085.9019s
	iters: 700, epoch: 13 | loss: 0.2296088
	speed: 0.3993s/iter; left time: 2065.5699s
Epoch: 13 cost time: 292.59334993362427
Epoch: 13, Steps: 734 | Train Loss: 0.2377667 Vali Loss: 0.3555795 Test Loss: 0.4392191
Validation loss decreased (0.355633 --> 0.355580).  Saving model ...
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 14 | loss: 0.2133830
	speed: 0.9054s/iter; left time: 4562.5595s
	iters: 200, epoch: 14 | loss: 0.2342677
	speed: 0.4141s/iter; left time: 2045.3670s
	iters: 300, epoch: 14 | loss: 0.2286017
	speed: 0.3983s/iter; left time: 1927.3473s
	iters: 400, epoch: 14 | loss: 0.2461639
	speed: 0.3991s/iter; left time: 1891.2636s
	iters: 500, epoch: 14 | loss: 0.2416526
	speed: 0.4123s/iter; left time: 1912.7965s
	iters: 600, epoch: 14 | loss: 0.2748885
	speed: 0.3984s/iter; left time: 1808.5102s
	iters: 700, epoch: 14 | loss: 0.2524110
	speed: 0.3982s/iter; left time: 1767.6882s
Epoch: 14 cost time: 296.35462832450867
Epoch: 14, Steps: 734 | Train Loss: 0.2376551 Vali Loss: 0.3554600 Test Loss: 0.4392053
Validation loss decreased (0.355580 --> 0.355460).  Saving model ...
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 15 | loss: 0.2465772
	speed: 0.9077s/iter; left time: 3907.8136s
	iters: 200, epoch: 15 | loss: 0.2384310
	speed: 0.4303s/iter; left time: 1809.2584s
	iters: 300, epoch: 15 | loss: 0.2405683
	speed: 0.3993s/iter; left time: 1638.9619s
	iters: 400, epoch: 15 | loss: 0.2190492
	speed: 0.3984s/iter; left time: 1595.6752s
	iters: 500, epoch: 15 | loss: 0.2647952
	speed: 0.4003s/iter; left time: 1563.0885s
	iters: 600, epoch: 15 | loss: 0.2374219
	speed: 0.3997s/iter; left time: 1520.9682s
	iters: 700, epoch: 15 | loss: 0.2356692
	speed: 0.3969s/iter; left time: 1470.4007s
Epoch: 15 cost time: 296.6465971469879
Epoch: 15, Steps: 734 | Train Loss: 0.2376038 Vali Loss: 0.3554352 Test Loss: 0.4391901
Validation loss decreased (0.355460 --> 0.355435).  Saving model ...
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 16 | loss: 0.2483196
	speed: 0.9007s/iter; left time: 3216.5585s
	iters: 200, epoch: 16 | loss: 0.2253587
	speed: 0.4098s/iter; left time: 1422.3713s
	iters: 300, epoch: 16 | loss: 0.2178762
	speed: 0.4086s/iter; left time: 1377.4255s
	iters: 400, epoch: 16 | loss: 0.2479023
	speed: 0.4039s/iter; left time: 1321.3029s
	iters: 500, epoch: 16 | loss: 0.2284410
	speed: 0.4012s/iter; left time: 1272.1475s
	iters: 600, epoch: 16 | loss: 0.2311495
	speed: 0.4002s/iter; left time: 1229.1240s
	iters: 700, epoch: 16 | loss: 0.2307287
	speed: 0.3991s/iter; left time: 1185.6956s
Epoch: 16 cost time: 296.4237811565399
Epoch: 16, Steps: 734 | Train Loss: 0.2375841 Vali Loss: 0.3555293 Test Loss: 0.4391863
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 17 | loss: 0.2381930
	speed: 0.8254s/iter; left time: 2341.6518s
	iters: 200, epoch: 17 | loss: 0.2016014
	speed: 0.3973s/iter; left time: 1087.3518s
	iters: 300, epoch: 17 | loss: 0.2231155
	speed: 0.4060s/iter; left time: 1070.6566s
	iters: 400, epoch: 17 | loss: 0.2280863
	speed: 0.4032s/iter; left time: 1022.9929s
	iters: 500, epoch: 17 | loss: 0.2707225
	speed: 0.3981s/iter; left time: 970.1237s
	iters: 600, epoch: 17 | loss: 0.2393550
	speed: 0.3987s/iter; left time: 931.7861s
	iters: 700, epoch: 17 | loss: 0.2739857
	speed: 0.4035s/iter; left time: 902.5524s
Epoch: 17 cost time: 294.0391936302185
Epoch: 17, Steps: 734 | Train Loss: 0.2375413 Vali Loss: 0.3554606 Test Loss: 0.4391851
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 18 | loss: 0.2307481
	speed: 0.8233s/iter; left time: 1731.4469s
	iters: 200, epoch: 18 | loss: 0.2653023
	speed: 0.3973s/iter; left time: 795.7023s
	iters: 300, epoch: 18 | loss: 0.2358466
	speed: 0.3982s/iter; left time: 757.6998s
	iters: 400, epoch: 18 | loss: 0.2201831
	speed: 0.4001s/iter; left time: 721.3870s
	iters: 500, epoch: 18 | loss: 0.2444908
	speed: 0.4038s/iter; left time: 687.6475s
	iters: 600, epoch: 18 | loss: 0.2116873
	speed: 0.3995s/iter; left time: 640.4031s
	iters: 700, epoch: 18 | loss: 0.2486218
	speed: 0.4020s/iter; left time: 604.1968s
Epoch: 18 cost time: 293.5246117115021
Epoch: 18, Steps: 734 | Train Loss: 0.2375774 Vali Loss: 0.3556331 Test Loss: 0.4391848
EarlyStopping counter: 3 out of 5
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 19 | loss: 0.2413058
	speed: 0.8248s/iter; left time: 1129.0878s
	iters: 200, epoch: 19 | loss: 0.2302763
	speed: 0.3956s/iter; left time: 501.9911s
	iters: 300, epoch: 19 | loss: 0.2548434
	speed: 0.3981s/iter; left time: 465.3405s
	iters: 400, epoch: 19 | loss: 0.2302878
	speed: 0.3994s/iter; left time: 426.9525s
	iters: 500, epoch: 19 | loss: 0.2444796
	speed: 0.4037s/iter; left time: 391.1916s
	iters: 600, epoch: 19 | loss: 0.2235278
	speed: 0.4190s/iter; left time: 364.1406s
	iters: 700, epoch: 19 | loss: 0.2276694
	speed: 0.4001s/iter; left time: 307.6714s
Epoch: 19 cost time: 294.8960311412811
Epoch: 19, Steps: 734 | Train Loss: 0.2375330 Vali Loss: 0.3556374 Test Loss: 0.4391845
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 20 | loss: 0.2554598
	speed: 0.8403s/iter; left time: 533.5905s
	iters: 200, epoch: 20 | loss: 0.2364556
	speed: 0.3965s/iter; left time: 212.1282s
	iters: 300, epoch: 20 | loss: 0.2324060
	speed: 0.3959s/iter; left time: 172.2120s
	iters: 400, epoch: 20 | loss: 0.2366885
	speed: 0.3989s/iter; left time: 133.6288s
	iters: 500, epoch: 20 | loss: 0.2798355
	speed: 0.3960s/iter; left time: 93.0672s
	iters: 600, epoch: 20 | loss: 0.2369519
	speed: 0.4008s/iter; left time: 54.1036s
	iters: 700, epoch: 20 | loss: 0.2390963
	speed: 0.4046s/iter; left time: 14.1610s
Epoch: 20 cost time: 293.7493460178375
Epoch: 20, Steps: 734 | Train Loss: 0.2375424 Vali Loss: 0.3555985 Test Loss: 0.4391844
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : traffic_336_192_DLinear_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15726<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3317
mse:0.43888184428215027, mae:0.3042685389518738
