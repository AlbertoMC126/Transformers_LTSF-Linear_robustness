Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='DLinear', model_id='ETTm2_336_192', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=192, root_path='./dataset/', save_pred_values=False, seed=10458, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTm2_336_192_DLinear_ETTm2_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed10458>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34033
val 11329
test 11329
	iters: 100, epoch: 1 | loss: 0.4078414
	speed: 0.0115s/iter; left time: 243.1599s
	iters: 200, epoch: 1 | loss: 0.5592934
	speed: 0.0109s/iter; left time: 228.7452s
	iters: 300, epoch: 1 | loss: 0.7354816
	speed: 0.0104s/iter; left time: 217.0172s
	iters: 400, epoch: 1 | loss: 0.3835201
	speed: 0.0103s/iter; left time: 215.0901s
	iters: 500, epoch: 1 | loss: 0.6611801
	speed: 0.0069s/iter; left time: 142.3895s
	iters: 600, epoch: 1 | loss: 0.5594456
	speed: 0.0091s/iter; left time: 188.6904s
	iters: 700, epoch: 1 | loss: 0.4626747
	speed: 0.0117s/iter; left time: 239.7879s
	iters: 800, epoch: 1 | loss: 0.7791303
	speed: 0.0114s/iter; left time: 233.3642s
	iters: 900, epoch: 1 | loss: 0.7064700
	speed: 0.0112s/iter; left time: 227.9227s
	iters: 1000, epoch: 1 | loss: 0.4847865
	speed: 0.0109s/iter; left time: 220.0653s
Epoch: 1 cost time: 11.10004186630249
Epoch: 1, Steps: 1063 | Train Loss: 0.5593614 Vali Loss: 0.7279829 Test Loss: 1.8842952
Validation loss decreased (inf --> 0.727983).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.2332983
	speed: 0.0450s/iter; left time: 903.7653s
	iters: 200, epoch: 2 | loss: 0.3210267
	speed: 0.0117s/iter; left time: 233.5968s
	iters: 300, epoch: 2 | loss: 0.5790694
	speed: 0.0109s/iter; left time: 216.4253s
	iters: 400, epoch: 2 | loss: 0.5907537
	speed: 0.0109s/iter; left time: 215.8270s
	iters: 500, epoch: 2 | loss: 0.4276536
	speed: 0.0115s/iter; left time: 226.7602s
	iters: 600, epoch: 2 | loss: 0.4730602
	speed: 0.0102s/iter; left time: 200.5308s
	iters: 700, epoch: 2 | loss: 0.4212938
	speed: 0.0099s/iter; left time: 192.0802s
	iters: 800, epoch: 2 | loss: 0.3761284
	speed: 0.0108s/iter; left time: 208.7394s
	iters: 900, epoch: 2 | loss: 0.6788209
	speed: 0.0099s/iter; left time: 191.0809s
	iters: 1000, epoch: 2 | loss: 0.3163803
	speed: 0.0111s/iter; left time: 213.5449s
Epoch: 2 cost time: 11.370403289794922
Epoch: 2, Steps: 1063 | Train Loss: 0.5466499 Vali Loss: 0.5609926 Test Loss: 1.1865867
Validation loss decreased (0.727983 --> 0.560993).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.5254414
	speed: 0.0358s/iter; left time: 682.3876s
	iters: 200, epoch: 3 | loss: 0.3916467
	speed: 0.0101s/iter; left time: 191.6937s
	iters: 300, epoch: 3 | loss: 0.4108937
	speed: 0.0112s/iter; left time: 211.5465s
	iters: 400, epoch: 3 | loss: 0.4847109
	speed: 0.0117s/iter; left time: 219.6296s
	iters: 500, epoch: 3 | loss: 0.2888595
	speed: 0.0113s/iter; left time: 210.5907s
	iters: 600, epoch: 3 | loss: 0.3780171
	speed: 0.0085s/iter; left time: 157.7410s
	iters: 700, epoch: 3 | loss: 0.9933581
	speed: 0.0105s/iter; left time: 193.7679s
	iters: 800, epoch: 3 | loss: 0.3283315
	speed: 0.0105s/iter; left time: 193.2889s
	iters: 900, epoch: 3 | loss: 0.3765986
	speed: 0.0110s/iter; left time: 199.8606s
	iters: 1000, epoch: 3 | loss: 0.3578446
	speed: 0.0110s/iter; left time: 199.3163s
Epoch: 3 cost time: 11.034762620925903
Epoch: 3, Steps: 1063 | Train Loss: 0.3722580 Vali Loss: 0.2616203 Test Loss: 0.4709056
Validation loss decreased (0.560993 --> 0.261620).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.1983123
	speed: 0.0473s/iter; left time: 850.7685s
	iters: 200, epoch: 4 | loss: 0.3655020
	speed: 0.0095s/iter; left time: 168.9506s
	iters: 300, epoch: 4 | loss: 0.4227006
	speed: 0.0101s/iter; left time: 178.8060s
	iters: 400, epoch: 4 | loss: 0.2644786
	speed: 0.0101s/iter; left time: 178.3591s
	iters: 500, epoch: 4 | loss: 0.5766665
	speed: 0.0121s/iter; left time: 212.0368s
	iters: 600, epoch: 4 | loss: 0.3124814
	speed: 0.0093s/iter; left time: 162.5266s
	iters: 700, epoch: 4 | loss: 0.2670615
	speed: 0.0100s/iter; left time: 173.9229s
	iters: 800, epoch: 4 | loss: 0.3803914
	speed: 0.0107s/iter; left time: 185.1555s
	iters: 900, epoch: 4 | loss: 0.7901796
	speed: 0.0105s/iter; left time: 180.8196s
	iters: 1000, epoch: 4 | loss: 0.3145566
	speed: 0.0107s/iter; left time: 183.0517s
Epoch: 4 cost time: 10.941317796707153
Epoch: 4, Steps: 1063 | Train Loss: 0.3221011 Vali Loss: 0.3307426 Test Loss: 0.6955023
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.1592523
	speed: 0.0468s/iter; left time: 790.6778s
	iters: 200, epoch: 5 | loss: 0.2315506
	speed: 0.0090s/iter; left time: 151.8253s
	iters: 300, epoch: 5 | loss: 0.3065858
	speed: 0.0108s/iter; left time: 180.3354s
	iters: 400, epoch: 5 | loss: 0.1712143
	speed: 0.0105s/iter; left time: 173.9689s
	iters: 500, epoch: 5 | loss: 0.1803251
	speed: 0.0108s/iter; left time: 178.1768s
	iters: 600, epoch: 5 | loss: 0.1890911
	speed: 0.0111s/iter; left time: 181.6170s
	iters: 700, epoch: 5 | loss: 0.1889184
	speed: 0.0109s/iter; left time: 177.1742s
	iters: 800, epoch: 5 | loss: 0.2287633
	speed: 0.0099s/iter; left time: 161.1578s
	iters: 900, epoch: 5 | loss: 0.4329122
	speed: 0.0096s/iter; left time: 155.3535s
	iters: 1000, epoch: 5 | loss: 0.2204379
	speed: 0.0103s/iter; left time: 164.4314s
Epoch: 5 cost time: 11.00475263595581
Epoch: 5, Steps: 1063 | Train Loss: 0.3001240 Vali Loss: 0.3521893 Test Loss: 0.8193449
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.3640150
	speed: 0.0454s/iter; left time: 718.6437s
	iters: 200, epoch: 6 | loss: 0.2826068
	speed: 0.0106s/iter; left time: 166.3233s
	iters: 300, epoch: 6 | loss: 0.2858796
	speed: 0.0101s/iter; left time: 158.6874s
	iters: 400, epoch: 6 | loss: 0.2378638
	speed: 0.0100s/iter; left time: 154.6898s
	iters: 500, epoch: 6 | loss: 0.2079666
	speed: 0.0111s/iter; left time: 171.7662s
	iters: 600, epoch: 6 | loss: 0.3038013
	speed: 0.0104s/iter; left time: 159.4900s
	iters: 700, epoch: 6 | loss: 0.2337424
	speed: 0.0109s/iter; left time: 166.3827s
	iters: 800, epoch: 6 | loss: 0.3580628
	speed: 0.0122s/iter; left time: 185.4207s
	iters: 900, epoch: 6 | loss: 0.2778223
	speed: 0.0112s/iter; left time: 168.9818s
	iters: 1000, epoch: 6 | loss: 0.3941678
	speed: 0.0117s/iter; left time: 175.0333s
Epoch: 6 cost time: 11.633115530014038
Epoch: 6, Steps: 1063 | Train Loss: 0.2879798 Vali Loss: 0.1912186 Test Loss: 0.3322673
Validation loss decreased (0.261620 --> 0.191219).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.3260681
	speed: 0.0488s/iter; left time: 721.1339s
	iters: 200, epoch: 7 | loss: 0.2959592
	speed: 0.0109s/iter; left time: 160.5277s
	iters: 300, epoch: 7 | loss: 0.2370205
	speed: 0.0107s/iter; left time: 156.4090s
	iters: 400, epoch: 7 | loss: 0.1938972
	speed: 0.0108s/iter; left time: 156.8578s
	iters: 500, epoch: 7 | loss: 0.1993500
	speed: 0.0106s/iter; left time: 152.9039s
	iters: 600, epoch: 7 | loss: 0.2408586
	speed: 0.0097s/iter; left time: 139.1500s
	iters: 700, epoch: 7 | loss: 0.2262811
	speed: 0.0107s/iter; left time: 152.0792s
	iters: 800, epoch: 7 | loss: 0.1980542
	speed: 0.0102s/iter; left time: 144.2206s
	iters: 900, epoch: 7 | loss: 0.1415692
	speed: 0.0103s/iter; left time: 144.6019s
	iters: 1000, epoch: 7 | loss: 0.2382759
	speed: 0.0112s/iter; left time: 154.9701s
Epoch: 7 cost time: 11.31754732131958
Epoch: 7, Steps: 1063 | Train Loss: 0.2817469 Vali Loss: 0.1974835 Test Loss: 0.3497308
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.1618582
	speed: 0.0459s/iter; left time: 629.0894s
	iters: 200, epoch: 8 | loss: 0.1849622
	speed: 0.0095s/iter; left time: 129.0180s
	iters: 300, epoch: 8 | loss: 0.3605694
	speed: 0.0119s/iter; left time: 160.3049s
	iters: 400, epoch: 8 | loss: 0.2658938
	speed: 0.0119s/iter; left time: 159.9196s
	iters: 500, epoch: 8 | loss: 0.2642801
	speed: 0.0106s/iter; left time: 141.1666s
	iters: 600, epoch: 8 | loss: 0.2799639
	speed: 0.0107s/iter; left time: 141.9016s
	iters: 700, epoch: 8 | loss: 0.2829251
	speed: 0.0110s/iter; left time: 143.6721s
	iters: 800, epoch: 8 | loss: 0.2409814
	speed: 0.0108s/iter; left time: 141.1531s
	iters: 900, epoch: 8 | loss: 0.3761713
	speed: 0.0111s/iter; left time: 143.1798s
	iters: 1000, epoch: 8 | loss: 0.1741332
	speed: 0.0115s/iter; left time: 147.6903s
Epoch: 8 cost time: 11.524429321289062
Epoch: 8, Steps: 1063 | Train Loss: 0.2775556 Vali Loss: 0.1800593 Test Loss: 0.2886879
Validation loss decreased (0.191219 --> 0.180059).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.2418639
	speed: 0.0440s/iter; left time: 556.9157s
	iters: 200, epoch: 9 | loss: 0.2271273
	speed: 0.0101s/iter; left time: 127.1032s
	iters: 300, epoch: 9 | loss: 0.2426270
	speed: 0.0101s/iter; left time: 125.7385s
	iters: 400, epoch: 9 | loss: 0.1750148
	speed: 0.0113s/iter; left time: 140.0097s
	iters: 500, epoch: 9 | loss: 0.2468509
	speed: 0.0102s/iter; left time: 124.9181s
	iters: 600, epoch: 9 | loss: 0.2343904
	speed: 0.0114s/iter; left time: 138.6127s
	iters: 700, epoch: 9 | loss: 0.2255660
	speed: 0.0118s/iter; left time: 141.9137s
	iters: 800, epoch: 9 | loss: 0.2439250
	speed: 0.0105s/iter; left time: 125.5825s
	iters: 900, epoch: 9 | loss: 0.3735985
	speed: 0.0090s/iter; left time: 106.8563s
	iters: 1000, epoch: 9 | loss: 0.2147185
	speed: 0.0101s/iter; left time: 118.4173s
Epoch: 9 cost time: 11.100996255874634
Epoch: 9, Steps: 1063 | Train Loss: 0.2756802 Vali Loss: 0.1793195 Test Loss: 0.2889278
Validation loss decreased (0.180059 --> 0.179320).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.2499149
	speed: 0.0406s/iter; left time: 471.1659s
	iters: 200, epoch: 10 | loss: 0.2639673
	speed: 0.0098s/iter; left time: 112.3231s
	iters: 300, epoch: 10 | loss: 0.2140760
	speed: 0.0095s/iter; left time: 108.0426s
	iters: 400, epoch: 10 | loss: 0.1935876
	speed: 0.0104s/iter; left time: 117.1252s
	iters: 500, epoch: 10 | loss: 0.2291051
	speed: 0.0104s/iter; left time: 116.6625s
	iters: 600, epoch: 10 | loss: 0.2474566
	speed: 0.0110s/iter; left time: 121.6026s
	iters: 700, epoch: 10 | loss: 0.1979496
	speed: 0.0111s/iter; left time: 121.8738s
	iters: 800, epoch: 10 | loss: 0.2488501
	speed: 0.0107s/iter; left time: 116.8942s
	iters: 900, epoch: 10 | loss: 0.5550710
	speed: 0.0107s/iter; left time: 115.6332s
	iters: 1000, epoch: 10 | loss: 0.1738847
	speed: 0.0104s/iter; left time: 110.9321s
Epoch: 10 cost time: 10.961259365081787
Epoch: 10, Steps: 1063 | Train Loss: 0.2748322 Vali Loss: 0.1891672 Test Loss: 0.3222464
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.2447366
	speed: 0.0513s/iter; left time: 540.5501s
	iters: 200, epoch: 11 | loss: 0.4760993
	speed: 0.0108s/iter; left time: 112.1595s
	iters: 300, epoch: 11 | loss: 0.1402204
	speed: 0.0095s/iter; left time: 98.2791s
	iters: 400, epoch: 11 | loss: 0.3595119
	speed: 0.0109s/iter; left time: 111.6415s
	iters: 500, epoch: 11 | loss: 0.4507194
	speed: 0.0114s/iter; left time: 115.7047s
	iters: 600, epoch: 11 | loss: 0.2035362
	speed: 0.0098s/iter; left time: 98.7351s
	iters: 700, epoch: 11 | loss: 0.2997834
	speed: 0.0114s/iter; left time: 113.3198s
	iters: 800, epoch: 11 | loss: 0.3737535
	speed: 0.0095s/iter; left time: 92.9252s
	iters: 900, epoch: 11 | loss: 0.2371646
	speed: 0.0096s/iter; left time: 93.3288s
	iters: 1000, epoch: 11 | loss: 0.2096800
	speed: 0.0098s/iter; left time: 94.4989s
Epoch: 11 cost time: 11.067009210586548
Epoch: 11, Steps: 1063 | Train Loss: 0.2742234 Vali Loss: 0.2029499 Test Loss: 0.3591946
EarlyStopping counter: 2 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.3000165
	speed: 0.0433s/iter; left time: 410.1019s
	iters: 200, epoch: 12 | loss: 0.1636672
	speed: 0.0099s/iter; left time: 92.4861s
	iters: 300, epoch: 12 | loss: 0.1628523
	speed: 0.0098s/iter; left time: 91.2222s
	iters: 400, epoch: 12 | loss: 0.4942869
	speed: 0.0092s/iter; left time: 84.6525s
	iters: 500, epoch: 12 | loss: 0.4050238
	speed: 0.0097s/iter; left time: 87.6994s
	iters: 600, epoch: 12 | loss: 0.4204741
	speed: 0.0109s/iter; left time: 97.3043s
	iters: 700, epoch: 12 | loss: 0.2415608
	speed: 0.0100s/iter; left time: 88.4288s
	iters: 800, epoch: 12 | loss: 0.2245705
	speed: 0.0110s/iter; left time: 96.8023s
	iters: 900, epoch: 12 | loss: 0.2096038
	speed: 0.0114s/iter; left time: 98.5414s
	iters: 1000, epoch: 12 | loss: 0.3721438
	speed: 0.0106s/iter; left time: 90.8615s
Epoch: 12 cost time: 10.903672456741333
Epoch: 12, Steps: 1063 | Train Loss: 0.2739043 Vali Loss: 0.1859351 Test Loss: 0.3088432
EarlyStopping counter: 3 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.2530276
	speed: 0.0493s/iter; left time: 413.9531s
	iters: 200, epoch: 13 | loss: 0.2517678
	speed: 0.0110s/iter; left time: 91.4515s
	iters: 300, epoch: 13 | loss: 0.4088735
	speed: 0.0106s/iter; left time: 86.6655s
	iters: 400, epoch: 13 | loss: 0.3859602
	speed: 0.0115s/iter; left time: 93.1292s
	iters: 500, epoch: 13 | loss: 0.1301422
	speed: 0.0114s/iter; left time: 91.5187s
	iters: 600, epoch: 13 | loss: 0.3162159
	speed: 0.0113s/iter; left time: 89.0410s
	iters: 700, epoch: 13 | loss: 0.4191649
	speed: 0.0104s/iter; left time: 81.4907s
	iters: 800, epoch: 13 | loss: 0.2996115
	speed: 0.0094s/iter; left time: 72.2326s
	iters: 900, epoch: 13 | loss: 0.5355188
	speed: 0.0107s/iter; left time: 81.3035s
	iters: 1000, epoch: 13 | loss: 0.2912665
	speed: 0.0107s/iter; left time: 80.6075s
Epoch: 13 cost time: 11.492365837097168
Epoch: 13, Steps: 1063 | Train Loss: 0.2736014 Vali Loss: 0.1943938 Test Loss: 0.3358052
EarlyStopping counter: 4 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 14 | loss: 0.3808541
	speed: 0.0467s/iter; left time: 342.9437s
	iters: 200, epoch: 14 | loss: 0.1611484
	speed: 0.0096s/iter; left time: 69.3968s
	iters: 300, epoch: 14 | loss: 0.6023235
	speed: 0.0096s/iter; left time: 68.4935s
	iters: 400, epoch: 14 | loss: 0.3412435
	speed: 0.0095s/iter; left time: 66.8636s
	iters: 500, epoch: 14 | loss: 0.2835790
	speed: 0.0090s/iter; left time: 62.5055s
	iters: 600, epoch: 14 | loss: 0.1614880
	speed: 0.0090s/iter; left time: 61.3876s
	iters: 700, epoch: 14 | loss: 0.3476857
	speed: 0.0095s/iter; left time: 63.7980s
	iters: 800, epoch: 14 | loss: 0.2626322
	speed: 0.0089s/iter; left time: 58.9829s
	iters: 900, epoch: 14 | loss: 0.2873530
	speed: 0.0077s/iter; left time: 50.4928s
	iters: 1000, epoch: 14 | loss: 0.2069092
	speed: 0.0077s/iter; left time: 49.6182s
Epoch: 14 cost time: 9.440758466720581
Epoch: 14, Steps: 1063 | Train Loss: 0.2737068 Vali Loss: 0.1938214 Test Loss: 0.3334292
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTm2_336_192_DLinear_ETTm2_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed10458<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
mse:0.289535790681839, mae:0.34922099113464355
