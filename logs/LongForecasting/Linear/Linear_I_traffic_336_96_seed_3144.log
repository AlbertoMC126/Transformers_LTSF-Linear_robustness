Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='Linear', model_id='traffic_336_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=3144, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_336_96_Linear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3144>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11849
val 1661
test 3413
	iters: 100, epoch: 1 | loss: 0.4365045
	speed: 0.3157s/iter; left time: 4641.2228s
	iters: 200, epoch: 1 | loss: 0.4257693
	speed: 0.3013s/iter; left time: 4399.4246s
	iters: 300, epoch: 1 | loss: 0.4391755
	speed: 0.3026s/iter; left time: 4388.4863s
	iters: 400, epoch: 1 | loss: 0.4629813
	speed: 0.3028s/iter; left time: 4360.5639s
	iters: 500, epoch: 1 | loss: 0.4687535
	speed: 0.3031s/iter; left time: 4334.1570s
	iters: 600, epoch: 1 | loss: 0.4613883
	speed: 0.3024s/iter; left time: 4294.3943s
	iters: 700, epoch: 1 | loss: 0.4960840
	speed: 0.3019s/iter; left time: 4256.5397s
Epoch: 1 cost time: 225.27242183685303
Epoch: 1, Steps: 740 | Train Loss: 0.4731926 Vali Loss: 0.6239175 Test Loss: 0.7414657
Validation loss decreased (inf --> 0.623917).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.4534143
	speed: 0.6092s/iter; left time: 8504.8769s
	iters: 200, epoch: 2 | loss: 0.4606609
	speed: 0.3027s/iter; left time: 4196.2282s
	iters: 300, epoch: 2 | loss: 0.4570785
	speed: 0.3018s/iter; left time: 4153.5394s
	iters: 400, epoch: 2 | loss: 0.4817299
	speed: 0.3019s/iter; left time: 4123.7599s
	iters: 500, epoch: 2 | loss: 0.4687209
	speed: 0.3022s/iter; left time: 4098.6188s
	iters: 600, epoch: 2 | loss: 0.5170320
	speed: 0.3014s/iter; left time: 4057.0430s
	iters: 700, epoch: 2 | loss: 0.4874901
	speed: 0.3021s/iter; left time: 4035.9930s
Epoch: 2 cost time: 223.59260058403015
Epoch: 2, Steps: 740 | Train Loss: 0.4650245 Vali Loss: 0.6278418 Test Loss: 0.7373398
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.3116161
	speed: 0.6089s/iter; left time: 8049.7967s
	iters: 200, epoch: 3 | loss: 0.2988223
	speed: 0.3010s/iter; left time: 3949.0972s
	iters: 300, epoch: 3 | loss: 0.3431180
	speed: 0.3015s/iter; left time: 3925.5393s
	iters: 400, epoch: 3 | loss: 0.3199340
	speed: 0.3015s/iter; left time: 3896.0896s
	iters: 500, epoch: 3 | loss: 0.3017596
	speed: 0.3036s/iter; left time: 3892.1761s
	iters: 600, epoch: 3 | loss: 0.2971280
	speed: 0.3019s/iter; left time: 3839.9439s
	iters: 700, epoch: 3 | loss: 0.3534228
	speed: 0.3009s/iter; left time: 3797.8261s
Epoch: 3 cost time: 223.29944348335266
Epoch: 3, Steps: 740 | Train Loss: 0.3225170 Vali Loss: 0.4502582 Test Loss: 0.5406178
Validation loss decreased (0.623917 --> 0.450258).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.3165197
	speed: 0.6099s/iter; left time: 7612.1946s
	iters: 200, epoch: 4 | loss: 0.2927622
	speed: 0.3043s/iter; left time: 3767.5922s
	iters: 300, epoch: 4 | loss: 0.2572933
	speed: 0.3028s/iter; left time: 3718.6173s
	iters: 400, epoch: 4 | loss: 0.2912791
	speed: 0.3020s/iter; left time: 3678.7356s
	iters: 500, epoch: 4 | loss: 0.3006692
	speed: 0.3026s/iter; left time: 3656.2232s
	iters: 600, epoch: 4 | loss: 0.3037178
	speed: 0.3019s/iter; left time: 3617.6118s
	iters: 700, epoch: 4 | loss: 0.2583894
	speed: 0.3021s/iter; left time: 3589.0907s
Epoch: 4 cost time: 223.78741121292114
Epoch: 4, Steps: 740 | Train Loss: 0.2754098 Vali Loss: 0.3932176 Test Loss: 0.4781265
Validation loss decreased (0.450258 --> 0.393218).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.2692967
	speed: 0.6077s/iter; left time: 7134.9267s
	iters: 200, epoch: 5 | loss: 0.3062975
	speed: 0.3001s/iter; left time: 3493.6760s
	iters: 300, epoch: 5 | loss: 0.2835403
	speed: 0.3023s/iter; left time: 3488.8730s
	iters: 400, epoch: 5 | loss: 0.2631354
	speed: 0.3018s/iter; left time: 3453.0215s
	iters: 500, epoch: 5 | loss: 0.2539611
	speed: 0.3014s/iter; left time: 3418.3286s
	iters: 600, epoch: 5 | loss: 0.2644658
	speed: 0.3012s/iter; left time: 3386.2549s
	iters: 700, epoch: 5 | loss: 0.2852369
	speed: 0.3014s/iter; left time: 3357.3797s
Epoch: 5 cost time: 223.03807163238525
Epoch: 5, Steps: 740 | Train Loss: 0.2546158 Vali Loss: 0.3702827 Test Loss: 0.4526508
Validation loss decreased (0.393218 --> 0.370283).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.2469700
	speed: 0.6098s/iter; left time: 6708.9003s
	iters: 200, epoch: 6 | loss: 0.2402885
	speed: 0.3029s/iter; left time: 3302.2960s
	iters: 300, epoch: 6 | loss: 0.2396839
	speed: 0.3012s/iter; left time: 3253.1628s
	iters: 400, epoch: 6 | loss: 0.2474290
	speed: 0.3021s/iter; left time: 3232.3810s
	iters: 500, epoch: 6 | loss: 0.2143596
	speed: 0.3023s/iter; left time: 3204.7859s
	iters: 600, epoch: 6 | loss: 0.2375781
	speed: 0.3026s/iter; left time: 3177.0812s
	iters: 700, epoch: 6 | loss: 0.2314834
	speed: 0.3024s/iter; left time: 3145.7614s
Epoch: 6 cost time: 223.58606624603271
Epoch: 6, Steps: 740 | Train Loss: 0.2438013 Vali Loss: 0.3584781 Test Loss: 0.4372523
Validation loss decreased (0.370283 --> 0.358478).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.2886273
	speed: 0.6106s/iter; left time: 6264.9022s
	iters: 200, epoch: 7 | loss: 0.2531807
	speed: 0.3022s/iter; left time: 3070.2104s
	iters: 300, epoch: 7 | loss: 0.2667122
	speed: 0.3035s/iter; left time: 3053.5709s
	iters: 400, epoch: 7 | loss: 0.2347982
	speed: 0.3025s/iter; left time: 3013.2120s
	iters: 500, epoch: 7 | loss: 0.2332271
	speed: 0.3019s/iter; left time: 2977.2900s
	iters: 600, epoch: 7 | loss: 0.2345907
	speed: 0.3032s/iter; left time: 2959.4101s
	iters: 700, epoch: 7 | loss: 0.2597833
	speed: 0.3030s/iter; left time: 2927.0978s
Epoch: 7 cost time: 223.97441220283508
Epoch: 7, Steps: 740 | Train Loss: 0.2378953 Vali Loss: 0.3527847 Test Loss: 0.4306852
Validation loss decreased (0.358478 --> 0.352785).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.2258716
	speed: 0.6156s/iter; left time: 5861.1787s
	iters: 200, epoch: 8 | loss: 0.2244922
	speed: 0.3029s/iter; left time: 2853.6254s
	iters: 300, epoch: 8 | loss: 0.2430155
	speed: 0.3025s/iter; left time: 2819.2175s
	iters: 400, epoch: 8 | loss: 0.2075680
	speed: 0.3021s/iter; left time: 2785.6040s
	iters: 500, epoch: 8 | loss: 0.2223949
	speed: 0.3020s/iter; left time: 2754.3777s
	iters: 600, epoch: 8 | loss: 0.2255379
	speed: 0.3023s/iter; left time: 2726.8858s
	iters: 700, epoch: 8 | loss: 0.2646052
	speed: 0.3029s/iter; left time: 2702.5864s
Epoch: 8 cost time: 224.0214295387268
Epoch: 8, Steps: 740 | Train Loss: 0.2346624 Vali Loss: 0.3499197 Test Loss: 0.4281200
Validation loss decreased (0.352785 --> 0.349920).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.2274172
	speed: 0.6115s/iter; left time: 5369.8135s
	iters: 200, epoch: 9 | loss: 0.2187431
	speed: 0.3028s/iter; left time: 2628.7628s
	iters: 300, epoch: 9 | loss: 0.2417269
	speed: 0.3023s/iter; left time: 2593.8139s
	iters: 400, epoch: 9 | loss: 0.2582778
	speed: 0.3025s/iter; left time: 2565.6707s
	iters: 500, epoch: 9 | loss: 0.2792125
	speed: 0.3021s/iter; left time: 2532.0168s
	iters: 600, epoch: 9 | loss: 0.2385921
	speed: 0.3016s/iter; left time: 2497.6388s
	iters: 700, epoch: 9 | loss: 0.2217303
	speed: 0.3012s/iter; left time: 2463.9023s
Epoch: 9 cost time: 223.57958054542542
Epoch: 9, Steps: 740 | Train Loss: 0.2329165 Vali Loss: 0.3482505 Test Loss: 0.4264964
Validation loss decreased (0.349920 --> 0.348250).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.2213831
	speed: 0.6081s/iter; left time: 4889.3928s
	iters: 200, epoch: 10 | loss: 0.2749792
	speed: 0.3027s/iter; left time: 2403.5664s
	iters: 300, epoch: 10 | loss: 0.2563975
	speed: 0.3049s/iter; left time: 2391.0328s
	iters: 400, epoch: 10 | loss: 0.2333833
	speed: 0.3047s/iter; left time: 2358.5276s
	iters: 500, epoch: 10 | loss: 0.2287767
	speed: 0.3045s/iter; left time: 2326.5610s
	iters: 600, epoch: 10 | loss: 0.2130325
	speed: 0.3033s/iter; left time: 2287.3750s
	iters: 700, epoch: 10 | loss: 0.2256387
	speed: 0.3029s/iter; left time: 2253.5498s
Epoch: 10 cost time: 224.51222038269043
Epoch: 10, Steps: 740 | Train Loss: 0.2319600 Vali Loss: 0.3479758 Test Loss: 0.4258924
Validation loss decreased (0.348250 --> 0.347976).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.1943423
	speed: 0.6110s/iter; left time: 4460.9509s
	iters: 200, epoch: 11 | loss: 0.2182615
	speed: 0.3027s/iter; left time: 2179.6530s
	iters: 300, epoch: 11 | loss: 0.2430334
	speed: 0.3015s/iter; left time: 2140.7749s
	iters: 400, epoch: 11 | loss: 0.2573296
	speed: 0.3048s/iter; left time: 2133.5900s
	iters: 500, epoch: 11 | loss: 0.2364735
	speed: 0.3040s/iter; left time: 2097.8500s
	iters: 600, epoch: 11 | loss: 0.2099809
	speed: 0.3047s/iter; left time: 2072.2598s
	iters: 700, epoch: 11 | loss: 0.2172614
	speed: 0.3053s/iter; left time: 2045.8177s
Epoch: 11 cost time: 224.73681735992432
Epoch: 11, Steps: 740 | Train Loss: 0.2313801 Vali Loss: 0.3480204 Test Loss: 0.4257698
EarlyStopping counter: 1 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.2032537
	speed: 0.6081s/iter; left time: 3989.9810s
	iters: 200, epoch: 12 | loss: 0.2757485
	speed: 0.3014s/iter; left time: 1947.1224s
	iters: 300, epoch: 12 | loss: 0.2451318
	speed: 0.3020s/iter; left time: 1920.7474s
	iters: 400, epoch: 12 | loss: 0.2213846
	speed: 0.3024s/iter; left time: 1893.1230s
	iters: 500, epoch: 12 | loss: 0.2247014
	speed: 0.3032s/iter; left time: 1868.2512s
	iters: 600, epoch: 12 | loss: 0.2201936
	speed: 0.3032s/iter; left time: 1837.7570s
	iters: 700, epoch: 12 | loss: 0.2335083
	speed: 0.3037s/iter; left time: 1810.5410s
Epoch: 12 cost time: 223.91014742851257
Epoch: 12, Steps: 740 | Train Loss: 0.2311192 Vali Loss: 0.3478737 Test Loss: 0.4256503
Validation loss decreased (0.347976 --> 0.347874).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.2306943
	speed: 0.6129s/iter; left time: 3567.7152s
	iters: 200, epoch: 13 | loss: 0.2205883
	speed: 0.3009s/iter; left time: 1721.2563s
	iters: 300, epoch: 13 | loss: 0.2579235
	speed: 0.3021s/iter; left time: 1698.2096s
	iters: 400, epoch: 13 | loss: 0.2489383
	speed: 0.3006s/iter; left time: 1659.8655s
	iters: 500, epoch: 13 | loss: 0.2387192
	speed: 0.3020s/iter; left time: 1637.1874s
	iters: 600, epoch: 13 | loss: 0.2163602
	speed: 0.3030s/iter; left time: 1612.0255s
	iters: 700, epoch: 13 | loss: 0.2247294
	speed: 0.3029s/iter; left time: 1581.2512s
Epoch: 13 cost time: 223.48995351791382
Epoch: 13, Steps: 740 | Train Loss: 0.2309865 Vali Loss: 0.3472493 Test Loss: 0.4255370
Validation loss decreased (0.347874 --> 0.347249).  Saving model ...
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 14 | loss: 0.2247671
	speed: 0.6119s/iter; left time: 3109.2738s
	iters: 200, epoch: 14 | loss: 0.2017043
	speed: 0.3024s/iter; left time: 1506.1156s
	iters: 300, epoch: 14 | loss: 0.2066621
	speed: 0.3008s/iter; left time: 1468.2284s
	iters: 400, epoch: 14 | loss: 0.2561223
	speed: 0.3033s/iter; left time: 1449.9993s
	iters: 500, epoch: 14 | loss: 0.2545328
	speed: 0.3026s/iter; left time: 1416.3042s
	iters: 600, epoch: 14 | loss: 0.2284941
	speed: 0.3022s/iter; left time: 1384.3978s
	iters: 700, epoch: 14 | loss: 0.2296892
	speed: 0.3040s/iter; left time: 1362.1109s
Epoch: 14 cost time: 223.87407398223877
Epoch: 14, Steps: 740 | Train Loss: 0.2308825 Vali Loss: 0.3475442 Test Loss: 0.4255214
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 15 | loss: 0.2250130
	speed: 0.6119s/iter; left time: 2656.1570s
	iters: 200, epoch: 15 | loss: 0.3018004
	speed: 0.3039s/iter; left time: 1288.9922s
	iters: 300, epoch: 15 | loss: 0.2134051
	speed: 0.3042s/iter; left time: 1259.5823s
	iters: 400, epoch: 15 | loss: 0.2103567
	speed: 0.3047s/iter; left time: 1231.1277s
	iters: 500, epoch: 15 | loss: 0.2191099
	speed: 0.3022s/iter; left time: 1191.0466s
	iters: 600, epoch: 15 | loss: 0.2303068
	speed: 0.3018s/iter; left time: 1159.3480s
	iters: 700, epoch: 15 | loss: 0.2416305
	speed: 0.3014s/iter; left time: 1127.3701s
Epoch: 15 cost time: 224.29644417762756
Epoch: 15, Steps: 740 | Train Loss: 0.2308695 Vali Loss: 0.3475565 Test Loss: 0.4255182
EarlyStopping counter: 2 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 16 | loss: 0.2595479
	speed: 0.6090s/iter; left time: 2193.1856s
	iters: 200, epoch: 16 | loss: 0.2567530
	speed: 0.3030s/iter; left time: 1060.9661s
	iters: 300, epoch: 16 | loss: 0.2834806
	speed: 0.3044s/iter; left time: 1035.2203s
	iters: 400, epoch: 16 | loss: 0.1980256
	speed: 0.3022s/iter; left time: 997.5041s
	iters: 500, epoch: 16 | loss: 0.2355470
	speed: 0.3034s/iter; left time: 971.0887s
	iters: 600, epoch: 16 | loss: 0.2340553
	speed: 0.3023s/iter; left time: 937.5838s
	iters: 700, epoch: 16 | loss: 0.2376288
	speed: 0.3022s/iter; left time: 906.9350s
Epoch: 16 cost time: 224.24451065063477
Epoch: 16, Steps: 740 | Train Loss: 0.2307947 Vali Loss: 0.3474918 Test Loss: 0.4255161
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 17 | loss: 0.2361491
	speed: 0.6128s/iter; left time: 1753.1016s
	iters: 200, epoch: 17 | loss: 0.3050988
	speed: 0.3033s/iter; left time: 837.4714s
	iters: 300, epoch: 17 | loss: 0.2506646
	speed: 0.3029s/iter; left time: 806.0631s
	iters: 400, epoch: 17 | loss: 0.2325144
	speed: 0.3036s/iter; left time: 777.5350s
	iters: 500, epoch: 17 | loss: 0.2623839
	speed: 0.3032s/iter; left time: 746.2597s
	iters: 600, epoch: 17 | loss: 0.2342390
	speed: 0.3017s/iter; left time: 712.2897s
	iters: 700, epoch: 17 | loss: 0.2293173
	speed: 0.3018s/iter; left time: 682.2748s
Epoch: 17 cost time: 224.09757947921753
Epoch: 17, Steps: 740 | Train Loss: 0.2308440 Vali Loss: 0.3475611 Test Loss: 0.4255162
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 18 | loss: 0.2185697
	speed: 0.6101s/iter; left time: 1294.1093s
	iters: 200, epoch: 18 | loss: 0.2082310
	speed: 0.3047s/iter; left time: 615.8022s
	iters: 300, epoch: 18 | loss: 0.2268727
	speed: 0.3038s/iter; left time: 583.6708s
	iters: 400, epoch: 18 | loss: 0.2250388
	speed: 0.3031s/iter; left time: 551.9369s
	iters: 500, epoch: 18 | loss: 0.2167286
	speed: 0.3036s/iter; left time: 522.4553s
	iters: 600, epoch: 18 | loss: 0.2572986
	speed: 0.3028s/iter; left time: 490.7921s
	iters: 700, epoch: 18 | loss: 0.2570741
	speed: 0.3026s/iter; left time: 460.2346s
Epoch: 18 cost time: 224.48803615570068
Epoch: 18, Steps: 740 | Train Loss: 0.2308044 Vali Loss: 0.3476411 Test Loss: 0.4255160
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : traffic_336_96_Linear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3144<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3413
mse:0.425792932510376, mae:0.29808083176612854
