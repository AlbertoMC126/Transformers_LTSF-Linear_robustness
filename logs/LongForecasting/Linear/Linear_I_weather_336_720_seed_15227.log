Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='Linear', model_id='weather_336_720', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=720, root_path='./dataset/', save_pred_values=False, seed=15227, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : weather_336_720_Linear_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15227>>>>>>>>>>>>>>>>>>>>>>>>>>
train 35832
val 4551
test 9820
	iters: 100, epoch: 1 | loss: 0.6351331
	speed: 0.0503s/iter; left time: 2249.6487s
	iters: 200, epoch: 1 | loss: 0.8012454
	speed: 0.0503s/iter; left time: 2240.7834s
	iters: 300, epoch: 1 | loss: 0.6965579
	speed: 0.0460s/iter; left time: 2046.0551s
	iters: 400, epoch: 1 | loss: 1.1459314
	speed: 0.0492s/iter; left time: 2183.6113s
	iters: 500, epoch: 1 | loss: 0.6230687
	speed: 0.0507s/iter; left time: 2246.0354s
	iters: 600, epoch: 1 | loss: 1.1885744
	speed: 0.0484s/iter; left time: 2138.1845s
	iters: 700, epoch: 1 | loss: 0.8882521
	speed: 0.0511s/iter; left time: 2250.5186s
	iters: 800, epoch: 1 | loss: 1.7437484
	speed: 0.0505s/iter; left time: 2222.6518s
	iters: 900, epoch: 1 | loss: 2.3163316
	speed: 0.0498s/iter; left time: 2186.7889s
	iters: 1000, epoch: 1 | loss: 0.5576082
	speed: 0.0519s/iter; left time: 2273.3471s
	iters: 1100, epoch: 1 | loss: 0.7870089
	speed: 0.0524s/iter; left time: 2290.2059s
	iters: 1200, epoch: 1 | loss: 0.7423910
	speed: 0.0489s/iter; left time: 2130.9575s
	iters: 1300, epoch: 1 | loss: 0.6553314
	speed: 0.0481s/iter; left time: 2093.3846s
	iters: 1400, epoch: 1 | loss: 0.9048637
	speed: 0.0502s/iter; left time: 2178.2407s
	iters: 1500, epoch: 1 | loss: 0.6125807
	speed: 0.0486s/iter; left time: 2105.5714s
	iters: 1600, epoch: 1 | loss: 0.5537258
	speed: 0.0446s/iter; left time: 1923.7681s
	iters: 1700, epoch: 1 | loss: 0.6019244
	speed: 0.0479s/iter; left time: 2064.8567s
	iters: 1800, epoch: 1 | loss: 0.7302442
	speed: 0.0519s/iter; left time: 2232.3974s
	iters: 1900, epoch: 1 | loss: 0.8963311
	speed: 0.0504s/iter; left time: 2160.2555s
	iters: 2000, epoch: 1 | loss: 0.8950962
	speed: 0.0496s/iter; left time: 2120.6708s
	iters: 2100, epoch: 1 | loss: 0.9944500
	speed: 0.0491s/iter; left time: 2094.8718s
	iters: 2200, epoch: 1 | loss: 0.6492193
	speed: 0.0536s/iter; left time: 2280.4576s
Epoch: 1 cost time: 111.1441650390625
Epoch: 1, Steps: 2239 | Train Loss: 1.2776755 Vali Loss: 0.7446060 Test Loss: 0.4015912
Validation loss decreased (inf --> 0.744606).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.8131813
	speed: 0.1442s/iter; left time: 6118.7269s
	iters: 200, epoch: 2 | loss: 0.5988767
	speed: 0.0490s/iter; left time: 2076.5165s
	iters: 300, epoch: 2 | loss: 1.0397296
	speed: 0.0482s/iter; left time: 2036.8788s
	iters: 400, epoch: 2 | loss: 0.6998572
	speed: 0.0463s/iter; left time: 1952.6836s
	iters: 500, epoch: 2 | loss: 0.8443797
	speed: 0.0496s/iter; left time: 2083.2570s
	iters: 600, epoch: 2 | loss: 0.7248760
	speed: 0.0505s/iter; left time: 2117.2286s
	iters: 700, epoch: 2 | loss: 1.7455695
	speed: 0.0505s/iter; left time: 2111.2124s
	iters: 800, epoch: 2 | loss: 0.9889452
	speed: 0.0475s/iter; left time: 1982.5800s
	iters: 900, epoch: 2 | loss: 0.6187614
	speed: 0.0470s/iter; left time: 1955.7357s
	iters: 1000, epoch: 2 | loss: 0.7939852
	speed: 0.0496s/iter; left time: 2058.8799s
	iters: 1100, epoch: 2 | loss: 0.5930018
	speed: 0.0494s/iter; left time: 2045.4266s
	iters: 1200, epoch: 2 | loss: 0.5555757
	speed: 0.0488s/iter; left time: 2015.6929s
	iters: 1300, epoch: 2 | loss: 0.6882645
	speed: 0.0445s/iter; left time: 1836.7953s
	iters: 1400, epoch: 2 | loss: 0.5616955
	speed: 0.0510s/iter; left time: 2097.7468s
	iters: 1500, epoch: 2 | loss: 0.9859148
	speed: 0.0481s/iter; left time: 1975.5680s
	iters: 1600, epoch: 2 | loss: 2.5403800
	speed: 0.0441s/iter; left time: 1807.5579s
	iters: 1700, epoch: 2 | loss: 0.5943331
	speed: 0.0489s/iter; left time: 1995.8467s
	iters: 1800, epoch: 2 | loss: 0.8812557
	speed: 0.0464s/iter; left time: 1890.0200s
	iters: 1900, epoch: 2 | loss: 0.5961755
	speed: 0.0512s/iter; left time: 2082.3512s
	iters: 2000, epoch: 2 | loss: 0.7535266
	speed: 0.0480s/iter; left time: 1947.3790s
	iters: 2100, epoch: 2 | loss: 0.7277861
	speed: 0.0492s/iter; left time: 1987.7297s
	iters: 2200, epoch: 2 | loss: 1.6806266
	speed: 0.0460s/iter; left time: 1855.5097s
Epoch: 2 cost time: 107.82499098777771
Epoch: 2, Steps: 2239 | Train Loss: 1.0511206 Vali Loss: 0.7517609 Test Loss: 0.3835555
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.4199635
	speed: 0.1427s/iter; left time: 5736.6391s
	iters: 200, epoch: 3 | loss: 0.4368441
	speed: 0.0486s/iter; left time: 1949.4545s
	iters: 300, epoch: 3 | loss: 0.7295854
	speed: 0.0487s/iter; left time: 1946.2514s
	iters: 400, epoch: 3 | loss: 0.5417650
	speed: 0.0464s/iter; left time: 1851.0498s
	iters: 500, epoch: 3 | loss: 0.4730311
	speed: 0.0504s/iter; left time: 2004.9642s
	iters: 600, epoch: 3 | loss: 0.5581656
	speed: 0.0506s/iter; left time: 2010.4702s
	iters: 700, epoch: 3 | loss: 0.7390391
	speed: 0.0508s/iter; left time: 2013.0886s
	iters: 800, epoch: 3 | loss: 0.7559922
	speed: 0.0519s/iter; left time: 2051.0010s
	iters: 900, epoch: 3 | loss: 1.0247248
	speed: 0.0491s/iter; left time: 1933.6336s
	iters: 1000, epoch: 3 | loss: 1.4571230
	speed: 0.0499s/iter; left time: 1959.5760s
	iters: 1100, epoch: 3 | loss: 0.7859862
	speed: 0.0497s/iter; left time: 1949.9999s
	iters: 1200, epoch: 3 | loss: 0.5187408
	speed: 0.0516s/iter; left time: 2016.8640s
	iters: 1300, epoch: 3 | loss: 0.4438974
	speed: 0.0538s/iter; left time: 2098.9146s
	iters: 1400, epoch: 3 | loss: 0.6433495
	speed: 0.0536s/iter; left time: 2085.6651s
	iters: 1500, epoch: 3 | loss: 0.4299580
	speed: 0.0475s/iter; left time: 1841.4854s
	iters: 1600, epoch: 3 | loss: 0.5924559
	speed: 0.0479s/iter; left time: 1855.3538s
	iters: 1700, epoch: 3 | loss: 0.5094255
	speed: 0.0510s/iter; left time: 1967.3478s
	iters: 1800, epoch: 3 | loss: 0.4341896
	speed: 0.0501s/iter; left time: 1929.5566s
	iters: 1900, epoch: 3 | loss: 2.1470699
	speed: 0.0509s/iter; left time: 1953.9606s
	iters: 2000, epoch: 3 | loss: 0.5624283
	speed: 0.0516s/iter; left time: 1976.7725s
	iters: 2100, epoch: 3 | loss: 0.6172245
	speed: 0.0509s/iter; left time: 1945.5589s
	iters: 2200, epoch: 3 | loss: 0.4410447
	speed: 0.0494s/iter; left time: 1880.9869s
Epoch: 3 cost time: 111.0197639465332
Epoch: 3, Steps: 2239 | Train Loss: 0.7918835 Vali Loss: 0.6320847 Test Loss: 0.3346069
Validation loss decreased (0.744606 --> 0.632085).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.6424797
	speed: 0.1529s/iter; left time: 5804.9632s
	iters: 200, epoch: 4 | loss: 0.6108755
	speed: 0.0467s/iter; left time: 1768.6551s
	iters: 300, epoch: 4 | loss: 0.5312518
	speed: 0.0476s/iter; left time: 1799.3179s
	iters: 400, epoch: 4 | loss: 0.5811149
	speed: 0.0546s/iter; left time: 2058.1398s
	iters: 500, epoch: 4 | loss: 0.5761084
	speed: 0.0493s/iter; left time: 1851.0741s
	iters: 600, epoch: 4 | loss: 0.4656827
	speed: 0.0507s/iter; left time: 1899.4091s
	iters: 700, epoch: 4 | loss: 0.7676963
	speed: 0.0497s/iter; left time: 1855.5773s
	iters: 800, epoch: 4 | loss: 0.5146925
	speed: 0.0478s/iter; left time: 1782.2317s
	iters: 900, epoch: 4 | loss: 0.4711901
	speed: 0.0504s/iter; left time: 1873.1253s
	iters: 1000, epoch: 4 | loss: 0.5379890
	speed: 0.0513s/iter; left time: 1902.3821s
	iters: 1100, epoch: 4 | loss: 0.5579633
	speed: 0.0484s/iter; left time: 1787.9040s
	iters: 1200, epoch: 4 | loss: 0.5075980
	speed: 0.0507s/iter; left time: 1868.5833s
	iters: 1300, epoch: 4 | loss: 0.4837749
	speed: 0.0510s/iter; left time: 1875.2938s
	iters: 1400, epoch: 4 | loss: 0.3676283
	speed: 0.0511s/iter; left time: 1873.5855s
	iters: 1500, epoch: 4 | loss: 0.5986438
	speed: 0.0489s/iter; left time: 1787.7859s
	iters: 1600, epoch: 4 | loss: 0.7866386
	speed: 0.0494s/iter; left time: 1802.1006s
	iters: 1700, epoch: 4 | loss: 0.4622172
	speed: 0.0513s/iter; left time: 1864.1207s
	iters: 1800, epoch: 4 | loss: 0.5479359
	speed: 0.0450s/iter; left time: 1630.8603s
	iters: 1900, epoch: 4 | loss: 0.7457078
	speed: 0.0518s/iter; left time: 1873.8627s
	iters: 2000, epoch: 4 | loss: 0.5250010
	speed: 0.0529s/iter; left time: 1906.6594s
	iters: 2100, epoch: 4 | loss: 0.4165483
	speed: 0.0502s/iter; left time: 1806.4154s
	iters: 2200, epoch: 4 | loss: 0.6373897
	speed: 0.0515s/iter; left time: 1847.5423s
Epoch: 4 cost time: 110.89291167259216
Epoch: 4, Steps: 2239 | Train Loss: 0.6474762 Vali Loss: 0.6353939 Test Loss: 0.3348575
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.5333254
	speed: 0.1471s/iter; left time: 5254.3445s
	iters: 200, epoch: 5 | loss: 0.6465802
	speed: 0.0437s/iter; left time: 1557.1188s
	iters: 300, epoch: 5 | loss: 0.5194885
	speed: 0.0480s/iter; left time: 1705.6821s
	iters: 400, epoch: 5 | loss: 0.3904638
	speed: 0.0474s/iter; left time: 1678.4400s
	iters: 500, epoch: 5 | loss: 0.5793301
	speed: 0.0458s/iter; left time: 1618.4969s
	iters: 600, epoch: 5 | loss: 0.5853463
	speed: 0.0451s/iter; left time: 1589.6997s
	iters: 700, epoch: 5 | loss: 0.5772951
	speed: 0.0517s/iter; left time: 1817.3331s
	iters: 800, epoch: 5 | loss: 0.4556478
	speed: 0.0547s/iter; left time: 1915.3758s
	iters: 900, epoch: 5 | loss: 0.8645939
	speed: 0.0480s/iter; left time: 1675.1706s
	iters: 1000, epoch: 5 | loss: 0.3862418
	speed: 0.0473s/iter; left time: 1645.5172s
	iters: 1100, epoch: 5 | loss: 0.5282878
	speed: 0.0495s/iter; left time: 1717.3508s
	iters: 1200, epoch: 5 | loss: 0.4278023
	speed: 0.0508s/iter; left time: 1758.2540s
	iters: 1300, epoch: 5 | loss: 0.7627648
	speed: 0.0498s/iter; left time: 1717.6937s
	iters: 1400, epoch: 5 | loss: 0.9654873
	speed: 0.0498s/iter; left time: 1714.5475s
	iters: 1500, epoch: 5 | loss: 0.5697747
	speed: 0.0532s/iter; left time: 1824.4210s
	iters: 1600, epoch: 5 | loss: 0.7637877
	speed: 0.0492s/iter; left time: 1684.4295s
	iters: 1700, epoch: 5 | loss: 0.8859493
	speed: 0.0469s/iter; left time: 1601.4187s
	iters: 1800, epoch: 5 | loss: 0.6649174
	speed: 0.0480s/iter; left time: 1632.8753s
	iters: 1900, epoch: 5 | loss: 0.7853462
	speed: 0.0458s/iter; left time: 1552.6509s
	iters: 2000, epoch: 5 | loss: 0.7032574
	speed: 0.0496s/iter; left time: 1676.2740s
	iters: 2100, epoch: 5 | loss: 0.7272021
	speed: 0.0482s/iter; left time: 1626.7883s
	iters: 2200, epoch: 5 | loss: 0.5557147
	speed: 0.0509s/iter; left time: 1712.0312s
Epoch: 5 cost time: 108.50929141044617
Epoch: 5, Steps: 2239 | Train Loss: 0.6094133 Vali Loss: 0.5964372 Test Loss: 0.3152010
Validation loss decreased (0.632085 --> 0.596437).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.8205128
	speed: 0.1501s/iter; left time: 5025.4571s
	iters: 200, epoch: 6 | loss: 0.5371539
	speed: 0.0449s/iter; left time: 1499.8509s
	iters: 300, epoch: 6 | loss: 0.4316007
	speed: 0.0489s/iter; left time: 1628.4059s
	iters: 400, epoch: 6 | loss: 0.4647307
	speed: 0.0481s/iter; left time: 1597.7692s
	iters: 500, epoch: 6 | loss: 0.4224663
	speed: 0.0491s/iter; left time: 1625.1267s
	iters: 600, epoch: 6 | loss: 0.5001948
	speed: 0.0525s/iter; left time: 1732.3346s
	iters: 700, epoch: 6 | loss: 0.5587006
	speed: 0.0506s/iter; left time: 1663.2600s
	iters: 800, epoch: 6 | loss: 0.3860990
	speed: 0.0485s/iter; left time: 1591.1010s
	iters: 900, epoch: 6 | loss: 0.4423999
	speed: 0.0461s/iter; left time: 1507.1105s
	iters: 1000, epoch: 6 | loss: 0.7559754
	speed: 0.0474s/iter; left time: 1545.8094s
	iters: 1100, epoch: 6 | loss: 0.7886168
	speed: 0.0503s/iter; left time: 1633.3249s
	iters: 1200, epoch: 6 | loss: 0.3813794
	speed: 0.0471s/iter; left time: 1525.6319s
	iters: 1300, epoch: 6 | loss: 1.0565947
	speed: 0.0479s/iter; left time: 1545.7844s
	iters: 1400, epoch: 6 | loss: 0.4995731
	speed: 0.0519s/iter; left time: 1670.7326s
	iters: 1500, epoch: 6 | loss: 0.5258089
	speed: 0.0509s/iter; left time: 1633.1156s
	iters: 1600, epoch: 6 | loss: 0.5811391
	speed: 0.0495s/iter; left time: 1583.3175s
	iters: 1700, epoch: 6 | loss: 0.4365730
	speed: 0.0502s/iter; left time: 1599.7483s
	iters: 1800, epoch: 6 | loss: 0.4277411
	speed: 0.0479s/iter; left time: 1523.7971s
	iters: 1900, epoch: 6 | loss: 0.7382305
	speed: 0.0521s/iter; left time: 1652.3664s
	iters: 2000, epoch: 6 | loss: 0.6894875
	speed: 0.0514s/iter; left time: 1625.0442s
	iters: 2100, epoch: 6 | loss: 0.4896750
	speed: 0.0505s/iter; left time: 1590.0934s
	iters: 2200, epoch: 6 | loss: 0.5032104
	speed: 0.0491s/iter; left time: 1541.7942s
Epoch: 6 cost time: 109.06884717941284
Epoch: 6, Steps: 2239 | Train Loss: 0.5935850 Vali Loss: 0.5956269 Test Loss: 0.3242204
Validation loss decreased (0.596437 --> 0.595627).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.7851957
	speed: 0.1528s/iter; left time: 4773.1018s
	iters: 200, epoch: 7 | loss: 0.4104464
	speed: 0.0465s/iter; left time: 1449.3488s
	iters: 300, epoch: 7 | loss: 0.6476130
	speed: 0.0472s/iter; left time: 1464.6892s
	iters: 400, epoch: 7 | loss: 0.6050989
	speed: 0.0433s/iter; left time: 1339.8667s
	iters: 500, epoch: 7 | loss: 0.4692502
	speed: 0.0450s/iter; left time: 1388.5035s
	iters: 600, epoch: 7 | loss: 0.4954691
	speed: 0.0480s/iter; left time: 1476.8486s
	iters: 700, epoch: 7 | loss: 0.5817058
	speed: 0.0483s/iter; left time: 1479.9733s
	iters: 800, epoch: 7 | loss: 0.4737098
	speed: 0.0459s/iter; left time: 1401.9918s
	iters: 900, epoch: 7 | loss: 0.4392577
	speed: 0.0576s/iter; left time: 1755.2533s
	iters: 1000, epoch: 7 | loss: 0.6366267
	speed: 0.0518s/iter; left time: 1572.2609s
	iters: 1100, epoch: 7 | loss: 0.8403746
	speed: 0.0532s/iter; left time: 1610.0761s
	iters: 1200, epoch: 7 | loss: 0.4303279
	speed: 0.0508s/iter; left time: 1530.2920s
	iters: 1300, epoch: 7 | loss: 0.7424068
	speed: 0.0537s/iter; left time: 1613.5393s
	iters: 1400, epoch: 7 | loss: 0.4065664
	speed: 0.0497s/iter; left time: 1489.5001s
	iters: 1500, epoch: 7 | loss: 0.3878136
	speed: 0.0538s/iter; left time: 1604.7623s
	iters: 1600, epoch: 7 | loss: 0.7133469
	speed: 0.0483s/iter; left time: 1436.5655s
	iters: 1700, epoch: 7 | loss: 0.5650401
	speed: 0.0513s/iter; left time: 1520.4074s
	iters: 1800, epoch: 7 | loss: 0.4256614
	speed: 0.0525s/iter; left time: 1551.4124s
	iters: 1900, epoch: 7 | loss: 0.6643261
	speed: 0.0518s/iter; left time: 1525.1046s
	iters: 2000, epoch: 7 | loss: 0.5457743
	speed: 0.0500s/iter; left time: 1465.9558s
	iters: 2100, epoch: 7 | loss: 0.4707502
	speed: 0.0451s/iter; left time: 1317.6443s
	iters: 2200, epoch: 7 | loss: 0.4162813
	speed: 0.0510s/iter; left time: 1486.7476s
Epoch: 7 cost time: 109.81742668151855
Epoch: 7, Steps: 2239 | Train Loss: 0.5864051 Vali Loss: 0.5921624 Test Loss: 0.3231710
Validation loss decreased (0.595627 --> 0.592162).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.4589253
	speed: 0.1528s/iter; left time: 4433.7082s
	iters: 200, epoch: 8 | loss: 0.3529530
	speed: 0.0409s/iter; left time: 1181.2964s
	iters: 300, epoch: 8 | loss: 0.4166192
	speed: 0.0482s/iter; left time: 1389.2525s
	iters: 400, epoch: 8 | loss: 0.4892195
	speed: 0.0473s/iter; left time: 1358.7468s
	iters: 500, epoch: 8 | loss: 0.4554808
	speed: 0.0467s/iter; left time: 1334.9524s
	iters: 600, epoch: 8 | loss: 0.4376277
	speed: 0.0508s/iter; left time: 1447.7102s
	iters: 700, epoch: 8 | loss: 0.4379194
	speed: 0.0523s/iter; left time: 1484.4710s
	iters: 800, epoch: 8 | loss: 0.6017836
	speed: 0.0477s/iter; left time: 1350.4088s
	iters: 900, epoch: 8 | loss: 0.4186544
	speed: 0.0496s/iter; left time: 1398.0794s
	iters: 1000, epoch: 8 | loss: 0.4289885
	speed: 0.0462s/iter; left time: 1298.6207s
	iters: 1100, epoch: 8 | loss: 0.4886751
	speed: 0.0496s/iter; left time: 1388.6657s
	iters: 1200, epoch: 8 | loss: 0.5842021
	speed: 0.0494s/iter; left time: 1377.7932s
	iters: 1300, epoch: 8 | loss: 0.4798415
	speed: 0.0537s/iter; left time: 1494.3608s
	iters: 1400, epoch: 8 | loss: 0.6996169
	speed: 0.0462s/iter; left time: 1279.1545s
	iters: 1500, epoch: 8 | loss: 0.5271089
	speed: 0.0524s/iter; left time: 1447.1913s
	iters: 1600, epoch: 8 | loss: 0.7174097
	speed: 0.0542s/iter; left time: 1489.9442s
	iters: 1700, epoch: 8 | loss: 0.6813007
	speed: 0.0498s/iter; left time: 1365.4429s
	iters: 1800, epoch: 8 | loss: 0.7454268
	speed: 0.0472s/iter; left time: 1290.1939s
	iters: 1900, epoch: 8 | loss: 0.4060897
	speed: 0.0501s/iter; left time: 1363.8067s
	iters: 2000, epoch: 8 | loss: 0.9075325
	speed: 0.0497s/iter; left time: 1347.7004s
	iters: 2100, epoch: 8 | loss: 0.4495522
	speed: 0.0544s/iter; left time: 1468.2324s
	iters: 2200, epoch: 8 | loss: 0.3717804
	speed: 0.0433s/iter; left time: 1163.8824s
Epoch: 8 cost time: 108.60276699066162
Epoch: 8, Steps: 2239 | Train Loss: 0.5827071 Vali Loss: 0.5873786 Test Loss: 0.3171975
Validation loss decreased (0.592162 --> 0.587379).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.5711436
	speed: 0.1558s/iter; left time: 4169.2995s
	iters: 200, epoch: 9 | loss: 0.6978257
	speed: 0.0448s/iter; left time: 1193.5609s
	iters: 300, epoch: 9 | loss: 0.4698553
	speed: 0.0432s/iter; left time: 1147.9979s
	iters: 400, epoch: 9 | loss: 0.4656411
	speed: 0.0463s/iter; left time: 1226.6748s
	iters: 500, epoch: 9 | loss: 0.9082482
	speed: 0.0511s/iter; left time: 1348.3182s
	iters: 600, epoch: 9 | loss: 0.5842798
	speed: 0.0494s/iter; left time: 1297.8505s
	iters: 700, epoch: 9 | loss: 1.0013853
	speed: 0.0497s/iter; left time: 1300.4702s
	iters: 800, epoch: 9 | loss: 1.0341347
	speed: 0.0529s/iter; left time: 1379.7447s
	iters: 900, epoch: 9 | loss: 0.4008234
	speed: 0.0525s/iter; left time: 1364.4267s
	iters: 1000, epoch: 9 | loss: 0.7628099
	speed: 0.0529s/iter; left time: 1367.9829s
	iters: 1100, epoch: 9 | loss: 0.4756820
	speed: 0.0469s/iter; left time: 1207.7250s
	iters: 1200, epoch: 9 | loss: 0.5126269
	speed: 0.0539s/iter; left time: 1383.5943s
	iters: 1300, epoch: 9 | loss: 0.7378639
	speed: 0.0494s/iter; left time: 1262.6582s
	iters: 1400, epoch: 9 | loss: 0.4811956
	speed: 0.0522s/iter; left time: 1328.3587s
	iters: 1500, epoch: 9 | loss: 0.4666956
	speed: 0.0515s/iter; left time: 1306.6560s
	iters: 1600, epoch: 9 | loss: 0.6829063
	speed: 0.0512s/iter; left time: 1294.9587s
	iters: 1700, epoch: 9 | loss: 0.4888659
	speed: 0.0534s/iter; left time: 1343.7281s
	iters: 1800, epoch: 9 | loss: 0.4623659
	speed: 0.0481s/iter; left time: 1205.2446s
	iters: 1900, epoch: 9 | loss: 0.4792623
	speed: 0.0476s/iter; left time: 1188.5686s
	iters: 2000, epoch: 9 | loss: 0.5450736
	speed: 0.0540s/iter; left time: 1344.0900s
	iters: 2100, epoch: 9 | loss: 0.4705150
	speed: 0.0525s/iter; left time: 1301.2910s
	iters: 2200, epoch: 9 | loss: 0.4944052
	speed: 0.0484s/iter; left time: 1194.0641s
Epoch: 9 cost time: 110.62745237350464
Epoch: 9, Steps: 2239 | Train Loss: 0.5806770 Vali Loss: 0.5949575 Test Loss: 0.3171951
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.6410893
	speed: 0.1545s/iter; left time: 3789.5562s
	iters: 200, epoch: 10 | loss: 0.4989994
	speed: 0.0420s/iter; left time: 1025.0863s
	iters: 300, epoch: 10 | loss: 0.4053998
	speed: 0.0500s/iter; left time: 1217.6912s
	iters: 400, epoch: 10 | loss: 0.3517066
	speed: 0.0490s/iter; left time: 1187.8030s
	iters: 500, epoch: 10 | loss: 0.7290752
	speed: 0.0540s/iter; left time: 1302.4318s
	iters: 600, epoch: 10 | loss: 0.4793492
	speed: 0.0566s/iter; left time: 1359.4151s
	iters: 700, epoch: 10 | loss: 0.4935397
	speed: 0.0494s/iter; left time: 1183.0180s
	iters: 800, epoch: 10 | loss: 0.4920441
	speed: 0.0492s/iter; left time: 1171.4094s
	iters: 900, epoch: 10 | loss: 0.3505578
	speed: 0.0477s/iter; left time: 1131.0489s
	iters: 1000, epoch: 10 | loss: 0.4793876
	speed: 0.0479s/iter; left time: 1132.3372s
	iters: 1100, epoch: 10 | loss: 0.4553786
	speed: 0.0522s/iter; left time: 1229.1657s
	iters: 1200, epoch: 10 | loss: 0.6518760
	speed: 0.0475s/iter; left time: 1112.0102s
	iters: 1300, epoch: 10 | loss: 0.3960806
	speed: 0.0508s/iter; left time: 1186.1448s
	iters: 1400, epoch: 10 | loss: 0.4318808
	speed: 0.0502s/iter; left time: 1165.8330s
	iters: 1500, epoch: 10 | loss: 0.3977071
	speed: 0.0527s/iter; left time: 1218.8097s
	iters: 1600, epoch: 10 | loss: 0.4201964
	speed: 0.0512s/iter; left time: 1180.1500s
	iters: 1700, epoch: 10 | loss: 5.6525311
	speed: 0.0493s/iter; left time: 1131.1606s
	iters: 1800, epoch: 10 | loss: 0.4569472
	speed: 0.0544s/iter; left time: 1242.1645s
	iters: 1900, epoch: 10 | loss: 0.4019192
	speed: 0.0521s/iter; left time: 1184.7934s
	iters: 2000, epoch: 10 | loss: 0.3772460
	speed: 0.0498s/iter; left time: 1128.1016s
	iters: 2100, epoch: 10 | loss: 0.4219969
	speed: 0.0511s/iter; left time: 1151.2215s
	iters: 2200, epoch: 10 | loss: 0.4042815
	speed: 0.0474s/iter; left time: 1063.1109s
Epoch: 10 cost time: 111.193026304245
Epoch: 10, Steps: 2239 | Train Loss: 0.5798358 Vali Loss: 0.5936826 Test Loss: 0.3184455
EarlyStopping counter: 2 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.4719201
	speed: 0.1530s/iter; left time: 3409.5098s
	iters: 200, epoch: 11 | loss: 0.7440942
	speed: 0.0472s/iter; left time: 1047.9671s
	iters: 300, epoch: 11 | loss: 0.7095802
	speed: 0.0530s/iter; left time: 1171.7087s
	iters: 400, epoch: 11 | loss: 0.4444767
	speed: 0.0498s/iter; left time: 1095.6274s
	iters: 500, epoch: 11 | loss: 0.4281464
	speed: 0.0499s/iter; left time: 1093.4449s
	iters: 600, epoch: 11 | loss: 0.7408845
	speed: 0.0535s/iter; left time: 1164.7939s
	iters: 700, epoch: 11 | loss: 0.9222581
	speed: 0.0467s/iter; left time: 1013.0298s
	iters: 800, epoch: 11 | loss: 0.3655925
	speed: 0.0495s/iter; left time: 1069.0668s
	iters: 900, epoch: 11 | loss: 0.5205935
	speed: 0.0524s/iter; left time: 1125.5845s
	iters: 1000, epoch: 11 | loss: 0.7014940
	speed: 0.0472s/iter; left time: 1009.0061s
	iters: 1100, epoch: 11 | loss: 0.5159070
	speed: 0.0456s/iter; left time: 970.5546s
	iters: 1200, epoch: 11 | loss: 0.4802549
	speed: 0.0474s/iter; left time: 1004.7399s
	iters: 1300, epoch: 11 | loss: 0.8884415
	speed: 0.0498s/iter; left time: 1050.1387s
	iters: 1400, epoch: 11 | loss: 0.4686854
	speed: 0.0511s/iter; left time: 1073.2191s
	iters: 1500, epoch: 11 | loss: 0.4356310
	speed: 0.0460s/iter; left time: 961.2107s
	iters: 1600, epoch: 11 | loss: 0.4384151
	speed: 0.0501s/iter; left time: 1041.4284s
	iters: 1700, epoch: 11 | loss: 0.7072059
	speed: 0.0477s/iter; left time: 987.1770s
	iters: 1800, epoch: 11 | loss: 0.7683671
	speed: 0.0470s/iter; left time: 967.5940s
	iters: 1900, epoch: 11 | loss: 0.6044827
	speed: 0.0501s/iter; left time: 1026.7242s
	iters: 2000, epoch: 11 | loss: 0.5328966
	speed: 0.0509s/iter; left time: 1037.9447s
	iters: 2100, epoch: 11 | loss: 0.5264265
	speed: 0.0455s/iter; left time: 923.5723s
	iters: 2200, epoch: 11 | loss: 0.4050177
	speed: 0.0457s/iter; left time: 923.0492s
Epoch: 11 cost time: 108.8346495628357
Epoch: 11, Steps: 2239 | Train Loss: 0.5793481 Vali Loss: 0.5939516 Test Loss: 0.3165197
EarlyStopping counter: 3 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.4238503
	speed: 0.1598s/iter; left time: 3205.2179s
	iters: 200, epoch: 12 | loss: 0.4907963
	speed: 0.0405s/iter; left time: 807.3872s
	iters: 300, epoch: 12 | loss: 0.4322636
	speed: 0.0451s/iter; left time: 896.0333s
	iters: 400, epoch: 12 | loss: 1.2079967
	speed: 0.0430s/iter; left time: 848.8544s
	iters: 500, epoch: 12 | loss: 0.3599732
	speed: 0.0459s/iter; left time: 901.2880s
	iters: 600, epoch: 12 | loss: 0.6276081
	speed: 0.0436s/iter; left time: 852.6803s
	iters: 700, epoch: 12 | loss: 0.4665498
	speed: 0.0415s/iter; left time: 806.4172s
	iters: 800, epoch: 12 | loss: 0.6451433
	speed: 0.0443s/iter; left time: 857.6197s
	iters: 900, epoch: 12 | loss: 0.5471197
	speed: 0.0460s/iter; left time: 885.5187s
	iters: 1000, epoch: 12 | loss: 0.4323807
	speed: 0.0434s/iter; left time: 830.5968s
	iters: 1100, epoch: 12 | loss: 0.3767473
	speed: 0.0445s/iter; left time: 847.3558s
	iters: 1200, epoch: 12 | loss: 0.6587530
	speed: 0.0467s/iter; left time: 884.7055s
	iters: 1300, epoch: 12 | loss: 0.4152649
	speed: 0.0435s/iter; left time: 820.7159s
	iters: 1400, epoch: 12 | loss: 0.5412477
	speed: 0.0416s/iter; left time: 779.1489s
	iters: 1500, epoch: 12 | loss: 0.4306556
	speed: 0.0419s/iter; left time: 781.8759s
	iters: 1600, epoch: 12 | loss: 0.4504254
	speed: 0.0407s/iter; left time: 754.6870s
	iters: 1700, epoch: 12 | loss: 0.4323837
	speed: 0.0389s/iter; left time: 717.3380s
	iters: 1800, epoch: 12 | loss: 0.5300798
	speed: 0.0406s/iter; left time: 745.8747s
	iters: 1900, epoch: 12 | loss: 0.5825189
	speed: 0.0438s/iter; left time: 800.0203s
	iters: 2000, epoch: 12 | loss: 0.4537604
	speed: 0.0419s/iter; left time: 760.6112s
	iters: 2100, epoch: 12 | loss: 0.5298894
	speed: 0.0419s/iter; left time: 755.8074s
	iters: 2200, epoch: 12 | loss: 0.4997736
	speed: 0.0415s/iter; left time: 744.1646s
Epoch: 12 cost time: 95.46108913421631
Epoch: 12, Steps: 2239 | Train Loss: 0.5789609 Vali Loss: 0.5933794 Test Loss: 0.3177788
EarlyStopping counter: 4 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 1.2749988
	speed: 0.1394s/iter; left time: 2483.5415s
	iters: 200, epoch: 13 | loss: 0.5525630
	speed: 0.0389s/iter; left time: 688.9092s
	iters: 300, epoch: 13 | loss: 0.4221386
	speed: 0.0375s/iter; left time: 660.1933s
	iters: 400, epoch: 13 | loss: 0.8827370
	speed: 0.0405s/iter; left time: 709.6748s
	iters: 500, epoch: 13 | loss: 0.4521120
	speed: 0.0408s/iter; left time: 710.5326s
	iters: 600, epoch: 13 | loss: 0.5108941
	speed: 0.0426s/iter; left time: 737.9672s
	iters: 700, epoch: 13 | loss: 0.3998289
	speed: 0.0415s/iter; left time: 714.5717s
	iters: 800, epoch: 13 | loss: 0.3771652
	speed: 0.0427s/iter; left time: 730.2961s
	iters: 900, epoch: 13 | loss: 0.6145328
	speed: 0.0430s/iter; left time: 731.5600s
	iters: 1000, epoch: 13 | loss: 0.4281059
	speed: 0.0418s/iter; left time: 706.1839s
	iters: 1100, epoch: 13 | loss: 0.5929942
	speed: 0.0416s/iter; left time: 699.1446s
	iters: 1200, epoch: 13 | loss: 0.5351873
	speed: 0.0421s/iter; left time: 704.2289s
	iters: 1300, epoch: 13 | loss: 0.7541618
	speed: 0.0406s/iter; left time: 673.9623s
	iters: 1400, epoch: 13 | loss: 0.7922115
	speed: 0.0423s/iter; left time: 699.1299s
	iters: 1500, epoch: 13 | loss: 1.0340333
	speed: 0.0417s/iter; left time: 684.9106s
	iters: 1600, epoch: 13 | loss: 0.4582904
	speed: 0.0394s/iter; left time: 642.2402s
	iters: 1700, epoch: 13 | loss: 0.4602625
	speed: 0.0412s/iter; left time: 667.6729s
	iters: 1800, epoch: 13 | loss: 1.2480733
	speed: 0.0458s/iter; left time: 738.2098s
	iters: 1900, epoch: 13 | loss: 0.8833761
	speed: 0.0436s/iter; left time: 697.4001s
	iters: 2000, epoch: 13 | loss: 0.4395841
	speed: 0.0401s/iter; left time: 637.9158s
	iters: 2100, epoch: 13 | loss: 0.9315442
	speed: 0.0402s/iter; left time: 636.3757s
	iters: 2200, epoch: 13 | loss: 0.5909251
	speed: 0.0404s/iter; left time: 635.0257s
Epoch: 13 cost time: 92.11456775665283
Epoch: 13, Steps: 2239 | Train Loss: 0.5789618 Vali Loss: 0.5921590 Test Loss: 0.3174207
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : weather_336_720_Linear_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15227<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9820
mse:0.31714025139808655, mae:0.36025547981262207
