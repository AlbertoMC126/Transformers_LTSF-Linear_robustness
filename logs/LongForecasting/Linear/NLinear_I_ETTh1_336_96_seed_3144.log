Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTh1', data_path='ETTh1.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='NLinear', model_id='ETTh1_336_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=3144, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTh1_336_96_NLinear_ETTh1_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3144>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.3815870
	speed: 0.0044s/iter; left time: 22.3145s
	iters: 200, epoch: 1 | loss: 0.3297879
	speed: 0.0043s/iter; left time: 21.2096s
Epoch: 1 cost time: 1.0974209308624268
Epoch: 1, Steps: 256 | Train Loss: 0.4249470 Vali Loss: 0.9073998 Test Loss: 0.4876084
Validation loss decreased (inf --> 0.907400).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.4074449
	speed: 0.0103s/iter; left time: 49.2249s
	iters: 200, epoch: 2 | loss: 0.4450853
	speed: 0.0049s/iter; left time: 22.7270s
Epoch: 2 cost time: 1.2182233333587646
Epoch: 2, Steps: 256 | Train Loss: 0.3972643 Vali Loss: 0.8673165 Test Loss: 0.4936127
Validation loss decreased (0.907400 --> 0.867316).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.3340497
	speed: 0.0103s/iter; left time: 46.3246s
	iters: 200, epoch: 3 | loss: 0.3654937
	speed: 0.0045s/iter; left time: 19.7550s
Epoch: 3 cost time: 1.1923928260803223
Epoch: 3, Steps: 256 | Train Loss: 0.3477594 Vali Loss: 0.7639631 Test Loss: 0.4212255
Validation loss decreased (0.867316 --> 0.763963).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.3441969
	speed: 0.0117s/iter; left time: 49.7303s
	iters: 200, epoch: 4 | loss: 0.3202718
	speed: 0.0046s/iter; left time: 18.9506s
Epoch: 4 cost time: 1.2463109493255615
Epoch: 4, Steps: 256 | Train Loss: 0.3330247 Vali Loss: 0.7189860 Test Loss: 0.3989943
Validation loss decreased (0.763963 --> 0.718986).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.2504279
	speed: 0.0106s/iter; left time: 42.4576s
	iters: 200, epoch: 5 | loss: 0.3748685
	speed: 0.0047s/iter; left time: 18.3569s
Epoch: 5 cost time: 1.1894447803497314
Epoch: 5, Steps: 256 | Train Loss: 0.3234941 Vali Loss: 0.7238824 Test Loss: 0.3882324
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.3135784
	speed: 0.0105s/iter; left time: 39.1764s
	iters: 200, epoch: 6 | loss: 0.3769863
	speed: 0.0048s/iter; left time: 17.4110s
Epoch: 6 cost time: 1.2151949405670166
Epoch: 6, Steps: 256 | Train Loss: 0.3188264 Vali Loss: 0.7049598 Test Loss: 0.3827660
Validation loss decreased (0.718986 --> 0.704960).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.2907110
	speed: 0.0115s/iter; left time: 40.0789s
	iters: 200, epoch: 7 | loss: 0.3122305
	speed: 0.0048s/iter; left time: 16.3158s
Epoch: 7 cost time: 1.2132210731506348
Epoch: 7, Steps: 256 | Train Loss: 0.3164587 Vali Loss: 0.7014688 Test Loss: 0.3811387
Validation loss decreased (0.704960 --> 0.701469).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.3782700
	speed: 0.0120s/iter; left time: 38.6045s
	iters: 200, epoch: 8 | loss: 0.3251309
	speed: 0.0044s/iter; left time: 13.7363s
Epoch: 8 cost time: 1.1853747367858887
Epoch: 8, Steps: 256 | Train Loss: 0.3150162 Vali Loss: 0.7016905 Test Loss: 0.3815629
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.2669269
	speed: 0.0094s/iter; left time: 27.9840s
	iters: 200, epoch: 9 | loss: 0.3023674
	speed: 0.0037s/iter; left time: 10.7163s
Epoch: 9 cost time: 1.0101258754730225
Epoch: 9, Steps: 256 | Train Loss: 0.3142256 Vali Loss: 0.7021143 Test Loss: 0.3799179
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.3133903
	speed: 0.0096s/iter; left time: 26.2060s
	iters: 200, epoch: 10 | loss: 0.3301032
	speed: 0.0044s/iter; left time: 11.5983s
Epoch: 10 cost time: 1.1064929962158203
Epoch: 10, Steps: 256 | Train Loss: 0.3137573 Vali Loss: 0.7005274 Test Loss: 0.3795824
Validation loss decreased (0.701469 --> 0.700527).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.2905207
	speed: 0.0096s/iter; left time: 23.5115s
	iters: 200, epoch: 11 | loss: 0.2756944
	speed: 0.0045s/iter; left time: 10.5773s
Epoch: 11 cost time: 1.1333656311035156
Epoch: 11, Steps: 256 | Train Loss: 0.3135514 Vali Loss: 0.6992785 Test Loss: 0.3796009
Validation loss decreased (0.700527 --> 0.699278).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.3058559
	speed: 0.0090s/iter; left time: 19.8699s
	iters: 200, epoch: 12 | loss: 0.3239882
	speed: 0.0045s/iter; left time: 9.4725s
Epoch: 12 cost time: 1.0331521034240723
Epoch: 12, Steps: 256 | Train Loss: 0.3132617 Vali Loss: 0.6994399 Test Loss: 0.3796473
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.3241393
	speed: 0.0097s/iter; left time: 18.8127s
	iters: 200, epoch: 13 | loss: 0.3537087
	speed: 0.0048s/iter; left time: 8.8811s
Epoch: 13 cost time: 1.1663146018981934
Epoch: 13, Steps: 256 | Train Loss: 0.3131509 Vali Loss: 0.6995849 Test Loss: 0.3795486
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.2855288
	speed: 0.0089s/iter; left time: 15.0556s
	iters: 200, epoch: 14 | loss: 0.3953846
	speed: 0.0042s/iter; left time: 6.6587s
Epoch: 14 cost time: 1.0691001415252686
Epoch: 14, Steps: 256 | Train Loss: 0.3134651 Vali Loss: 0.6997943 Test Loss: 0.3795696
EarlyStopping counter: 3 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.2687387
	speed: 0.0092s/iter; left time: 13.1940s
	iters: 200, epoch: 15 | loss: 0.2883512
	speed: 0.0041s/iter; left time: 5.4712s
Epoch: 15 cost time: 1.052257776260376
Epoch: 15, Steps: 256 | Train Loss: 0.3130167 Vali Loss: 0.6997776 Test Loss: 0.3795594
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.3113086
	speed: 0.0092s/iter; left time: 10.9129s
	iters: 200, epoch: 16 | loss: 0.2954397
	speed: 0.0039s/iter; left time: 4.2391s
Epoch: 16 cost time: 0.9981424808502197
Epoch: 16, Steps: 256 | Train Loss: 0.3134516 Vali Loss: 0.6995390 Test Loss: 0.3795617
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTh1_336_96_NLinear_ETTh1_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3144<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.37783655524253845, mae:0.39753395318984985
