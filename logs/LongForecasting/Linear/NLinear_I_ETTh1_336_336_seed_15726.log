Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTh1', data_path='ETTh1.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='NLinear', model_id='ETTh1_336_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=336, root_path='./dataset/', save_pred_values=False, seed=15726, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTh1_336_336_NLinear_ETTh1_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15726>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7969
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 0.5676284
	speed: 0.0087s/iter; left time: 42.2929s
	iters: 200, epoch: 1 | loss: 0.4800776
	speed: 0.0082s/iter; left time: 39.2156s
Epoch: 1 cost time: 2.135296583175659
Epoch: 1, Steps: 249 | Train Loss: 0.5480496 Vali Loss: 1.4465265 Test Loss: 0.5247554
Validation loss decreased (inf --> 1.446527).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.4960939
	speed: 0.0180s/iter; left time: 83.1891s
	iters: 200, epoch: 2 | loss: 0.5102506
	speed: 0.0093s/iter; left time: 42.2106s
Epoch: 2 cost time: 2.2637765407562256
Epoch: 2, Steps: 249 | Train Loss: 0.5196080 Vali Loss: 1.3415796 Test Loss: 0.5038468
Validation loss decreased (1.446527 --> 1.341580).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.4900359
	speed: 0.0187s/iter; left time: 81.7691s
	iters: 200, epoch: 3 | loss: 0.4719187
	speed: 0.0097s/iter; left time: 41.4259s
Epoch: 3 cost time: 2.187427282333374
Epoch: 3, Steps: 249 | Train Loss: 0.4721522 Vali Loss: 1.3392197 Test Loss: 0.4822424
Validation loss decreased (1.341580 --> 1.339220).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.4836716
	speed: 0.0190s/iter; left time: 78.5633s
	iters: 200, epoch: 4 | loss: 0.4296730
	speed: 0.0084s/iter; left time: 34.0872s
Epoch: 4 cost time: 2.118380069732666
Epoch: 4, Steps: 249 | Train Loss: 0.4496449 Vali Loss: 1.2824856 Test Loss: 0.4574496
Validation loss decreased (1.339220 --> 1.282486).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.4499615
	speed: 0.0157s/iter; left time: 60.9001s
	iters: 200, epoch: 5 | loss: 0.4483922
	speed: 0.0090s/iter; left time: 33.9226s
Epoch: 5 cost time: 2.0935275554656982
Epoch: 5, Steps: 249 | Train Loss: 0.4388535 Vali Loss: 1.2871876 Test Loss: 0.4504065
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.4260809
	speed: 0.0177s/iter; left time: 64.2277s
	iters: 200, epoch: 6 | loss: 0.4138100
	speed: 0.0088s/iter; left time: 30.9476s
Epoch: 6 cost time: 2.096392869949341
Epoch: 6, Steps: 249 | Train Loss: 0.4335986 Vali Loss: 1.2823486 Test Loss: 0.4463664
Validation loss decreased (1.282486 --> 1.282349).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.4431337
	speed: 0.0172s/iter; left time: 58.0904s
	iters: 200, epoch: 7 | loss: 0.3685644
	speed: 0.0085s/iter; left time: 27.9226s
Epoch: 7 cost time: 2.106051445007324
Epoch: 7, Steps: 249 | Train Loss: 0.4306215 Vali Loss: 1.2593102 Test Loss: 0.4406539
Validation loss decreased (1.282349 --> 1.259310).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.3802105
	speed: 0.0174s/iter; left time: 54.4724s
	iters: 200, epoch: 8 | loss: 0.4442757
	speed: 0.0078s/iter; left time: 23.7695s
Epoch: 8 cost time: 1.9930307865142822
Epoch: 8, Steps: 249 | Train Loss: 0.4290620 Vali Loss: 1.2579324 Test Loss: 0.4402658
Validation loss decreased (1.259310 --> 1.257932).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.4582190
	speed: 0.0167s/iter; left time: 48.1914s
	iters: 200, epoch: 9 | loss: 0.4197823
	speed: 0.0091s/iter; left time: 25.2724s
Epoch: 9 cost time: 2.1293835639953613
Epoch: 9, Steps: 249 | Train Loss: 0.4282233 Vali Loss: 1.2586551 Test Loss: 0.4397303
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.3914678
	speed: 0.0181s/iter; left time: 47.7225s
	iters: 200, epoch: 10 | loss: 0.4015043
	speed: 0.0084s/iter; left time: 21.3127s
Epoch: 10 cost time: 2.0174503326416016
Epoch: 10, Steps: 249 | Train Loss: 0.4276788 Vali Loss: 1.2645649 Test Loss: 0.4401741
EarlyStopping counter: 2 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.4317370
	speed: 0.0162s/iter; left time: 38.7388s
	iters: 200, epoch: 11 | loss: 0.3429790
	speed: 0.0073s/iter; left time: 16.8045s
Epoch: 11 cost time: 1.8673079013824463
Epoch: 11, Steps: 249 | Train Loss: 0.4274862 Vali Loss: 1.2616372 Test Loss: 0.4397360
EarlyStopping counter: 3 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.4001071
	speed: 0.0170s/iter; left time: 36.4861s
	iters: 200, epoch: 12 | loss: 0.4031015
	speed: 0.0081s/iter; left time: 16.4660s
Epoch: 12 cost time: 1.9878323078155518
Epoch: 12, Steps: 249 | Train Loss: 0.4273255 Vali Loss: 1.2607983 Test Loss: 0.4396819
EarlyStopping counter: 4 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.3968937
	speed: 0.0160s/iter; left time: 30.2346s
	iters: 200, epoch: 13 | loss: 0.4005613
	speed: 0.0076s/iter; left time: 13.7044s
Epoch: 13 cost time: 1.895155668258667
Epoch: 13, Steps: 249 | Train Loss: 0.4272338 Vali Loss: 1.2603651 Test Loss: 0.4396858
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTh1_336_336_NLinear_ETTh1_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15726<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2545
mse:0.43927085399627686, mae:0.43657055497169495
