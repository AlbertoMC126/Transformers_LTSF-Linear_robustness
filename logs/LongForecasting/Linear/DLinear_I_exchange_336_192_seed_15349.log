Args in experiment:
Namespace(activation='gelu', batch_size=8, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='exchange_rate.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=8, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='mse', lradj='type1', model='DLinear', model_id='Exchange_336_192', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=192, root_path='./dataset/', save_pred_values=False, seed=15349, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : Exchange_336_192_DLinear_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15349>>>>>>>>>>>>>>>>>>>>>>>>>>
train 4784
val 569
test 1326
	iters: 100, epoch: 1 | loss: 0.2711886
	speed: 0.0083s/iter; left time: 98.6836s
	iters: 200, epoch: 1 | loss: 0.2228141
	speed: 0.0086s/iter; left time: 100.7070s
	iters: 300, epoch: 1 | loss: 0.3237579
	speed: 0.0090s/iter; left time: 105.0689s
	iters: 400, epoch: 1 | loss: 0.1494882
	speed: 0.0089s/iter; left time: 103.3817s
	iters: 500, epoch: 1 | loss: 0.3297580
	speed: 0.0088s/iter; left time: 100.9464s
Epoch: 1 cost time: 5.182622909545898
Epoch: 1, Steps: 598 | Train Loss: 0.2659326 Vali Loss: 0.4273110 Test Loss: 0.1866312
Validation loss decreased (inf --> 0.427311).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2389212
	speed: 0.0212s/iter; left time: 239.1278s
	iters: 200, epoch: 2 | loss: 0.3825989
	speed: 0.0081s/iter; left time: 90.4534s
	iters: 300, epoch: 2 | loss: 0.2158838
	speed: 0.0084s/iter; left time: 93.2764s
	iters: 400, epoch: 2 | loss: 0.1978741
	speed: 0.0080s/iter; left time: 87.1559s
	iters: 500, epoch: 2 | loss: 0.2994777
	speed: 0.0084s/iter; left time: 91.4937s
Epoch: 2 cost time: 4.8976194858551025
Epoch: 2, Steps: 598 | Train Loss: 0.2321474 Vali Loss: 0.4840333 Test Loss: 0.2182239
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1555154
	speed: 0.0190s/iter; left time: 202.8196s
	iters: 200, epoch: 3 | loss: 0.1404118
	speed: 0.0074s/iter; left time: 78.5103s
	iters: 300, epoch: 3 | loss: 0.1885915
	speed: 0.0084s/iter; left time: 87.5154s
	iters: 400, epoch: 3 | loss: 0.1433624
	speed: 0.0080s/iter; left time: 82.9261s
	iters: 500, epoch: 3 | loss: 0.0921802
	speed: 0.0090s/iter; left time: 92.8899s
Epoch: 3 cost time: 4.719858884811401
Epoch: 3, Steps: 598 | Train Loss: 0.2188525 Vali Loss: 0.3301816 Test Loss: 0.2448549
Validation loss decreased (0.427311 --> 0.330182).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1946398
	speed: 0.0175s/iter; left time: 176.3050s
	iters: 200, epoch: 4 | loss: 0.3037893
	speed: 0.0073s/iter; left time: 73.0838s
	iters: 300, epoch: 4 | loss: 0.2448598
	speed: 0.0088s/iter; left time: 86.7612s
	iters: 400, epoch: 4 | loss: 0.1959927
	speed: 0.0086s/iter; left time: 83.6238s
	iters: 500, epoch: 4 | loss: 0.2122738
	speed: 0.0080s/iter; left time: 77.8190s
Epoch: 4 cost time: 4.741830587387085
Epoch: 4, Steps: 598 | Train Loss: 0.2136460 Vali Loss: 0.4491827 Test Loss: 0.1855598
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1895042
	speed: 0.0201s/iter; left time: 190.2894s
	iters: 200, epoch: 5 | loss: 0.4167592
	speed: 0.0070s/iter; left time: 65.7705s
	iters: 300, epoch: 5 | loss: 0.2021201
	speed: 0.0071s/iter; left time: 65.7458s
	iters: 400, epoch: 5 | loss: 0.1612920
	speed: 0.0070s/iter; left time: 63.9321s
	iters: 500, epoch: 5 | loss: 0.2887478
	speed: 0.0075s/iter; left time: 68.3043s
Epoch: 5 cost time: 4.364132642745972
Epoch: 5, Steps: 598 | Train Loss: 0.2108151 Vali Loss: 0.4840151 Test Loss: 0.1897995
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.2685657
	speed: 0.0189s/iter; left time: 167.6996s
	iters: 200, epoch: 6 | loss: 0.1940035
	speed: 0.0083s/iter; left time: 72.5648s
	iters: 300, epoch: 6 | loss: 0.1534850
	speed: 0.0082s/iter; left time: 71.0400s
	iters: 400, epoch: 6 | loss: 0.1846888
	speed: 0.0089s/iter; left time: 76.4811s
	iters: 500, epoch: 6 | loss: 0.1797219
	speed: 0.0088s/iter; left time: 74.8945s
Epoch: 6 cost time: 5.0083606243133545
Epoch: 6, Steps: 598 | Train Loss: 0.2096519 Vali Loss: 0.4457467 Test Loss: 0.1729118
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.2731200
	speed: 0.0205s/iter; left time: 169.2293s
	iters: 200, epoch: 7 | loss: 0.1721736
	speed: 0.0080s/iter; left time: 65.0633s
	iters: 300, epoch: 7 | loss: 0.1765516
	speed: 0.0080s/iter; left time: 64.4227s
	iters: 400, epoch: 7 | loss: 0.1774553
	speed: 0.0079s/iter; left time: 63.0087s
	iters: 500, epoch: 7 | loss: 0.2058824
	speed: 0.0080s/iter; left time: 63.3195s
Epoch: 7 cost time: 4.775458812713623
Epoch: 7, Steps: 598 | Train Loss: 0.2090818 Vali Loss: 0.4502838 Test Loss: 0.1852480
EarlyStopping counter: 4 out of 5
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.1591397
	speed: 0.0192s/iter; left time: 147.1152s
	iters: 200, epoch: 8 | loss: 0.3633414
	speed: 0.0067s/iter; left time: 50.7731s
	iters: 300, epoch: 8 | loss: 0.1922024
	speed: 0.0076s/iter; left time: 56.8886s
	iters: 400, epoch: 8 | loss: 0.2168534
	speed: 0.0080s/iter; left time: 59.3537s
	iters: 500, epoch: 8 | loss: 0.1258146
	speed: 0.0080s/iter; left time: 58.4354s
Epoch: 8 cost time: 4.551952362060547
Epoch: 8, Steps: 598 | Train Loss: 0.2086716 Vali Loss: 0.4731817 Test Loss: 0.1856756
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : Exchange_336_192_DLinear_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15349<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 1326
mse:0.24484582245349884, mae:0.369130939245224
