Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='Linear', model_id='Electricity_336_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=3144, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : Electricity_336_96_Linear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3144>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17981
val 2537
test 5165
	iters: 100, epoch: 1 | loss: 0.1941449
	speed: 0.0943s/iter; left time: 2109.1104s
	iters: 200, epoch: 1 | loss: 0.2189827
	speed: 0.0791s/iter; left time: 1761.4133s
	iters: 300, epoch: 1 | loss: 0.1876395
	speed: 0.0791s/iter; left time: 1753.9830s
	iters: 400, epoch: 1 | loss: 0.2005586
	speed: 0.0789s/iter; left time: 1740.6799s
	iters: 500, epoch: 1 | loss: 0.1956903
	speed: 0.0819s/iter; left time: 1799.5330s
	iters: 600, epoch: 1 | loss: 0.1890045
	speed: 0.0842s/iter; left time: 1841.6623s
	iters: 700, epoch: 1 | loss: 0.2286988
	speed: 0.0788s/iter; left time: 1715.4040s
	iters: 800, epoch: 1 | loss: 0.2157876
	speed: 0.0783s/iter; left time: 1696.4329s
	iters: 900, epoch: 1 | loss: 0.2080125
	speed: 0.0785s/iter; left time: 1691.9022s
	iters: 1000, epoch: 1 | loss: 0.2085305
	speed: 0.0789s/iter; left time: 1694.2504s
	iters: 1100, epoch: 1 | loss: 0.1963816
	speed: 0.0799s/iter; left time: 1707.3271s
Epoch: 1 cost time: 91.08513808250427
Epoch: 1, Steps: 1123 | Train Loss: 0.2100686 Vali Loss: 0.1756074 Test Loss: 0.2001173
Validation loss decreased (inf --> 0.175607).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.2371957
	speed: 0.2103s/iter; left time: 4466.1782s
	iters: 200, epoch: 2 | loss: 0.1617058
	speed: 0.0788s/iter; left time: 1664.9035s
	iters: 300, epoch: 2 | loss: 0.2195287
	speed: 0.0778s/iter; left time: 1637.4016s
	iters: 400, epoch: 2 | loss: 0.2057863
	speed: 0.0784s/iter; left time: 1641.5282s
	iters: 500, epoch: 2 | loss: 0.2166320
	speed: 0.0794s/iter; left time: 1653.9844s
	iters: 600, epoch: 2 | loss: 0.1724115
	speed: 0.0794s/iter; left time: 1646.8987s
	iters: 700, epoch: 2 | loss: 0.1935773
	speed: 0.0780s/iter; left time: 1609.3046s
	iters: 800, epoch: 2 | loss: 0.1766376
	speed: 0.0787s/iter; left time: 1617.1204s
	iters: 900, epoch: 2 | loss: 0.2101152
	speed: 0.0791s/iter; left time: 1616.8579s
	iters: 1000, epoch: 2 | loss: 0.2327487
	speed: 0.0795s/iter; left time: 1616.0605s
	iters: 1100, epoch: 2 | loss: 0.2385933
	speed: 0.0790s/iter; left time: 1598.0562s
Epoch: 2 cost time: 88.59341311454773
Epoch: 2, Steps: 1123 | Train Loss: 0.1990849 Vali Loss: 0.1810163 Test Loss: 0.2020885
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.1831066
	speed: 0.1985s/iter; left time: 3993.6933s
	iters: 200, epoch: 3 | loss: 0.1621315
	speed: 0.0797s/iter; left time: 1595.9347s
	iters: 300, epoch: 3 | loss: 0.1577605
	speed: 0.0801s/iter; left time: 1595.9051s
	iters: 400, epoch: 3 | loss: 0.1571970
	speed: 0.0799s/iter; left time: 1583.8098s
	iters: 500, epoch: 3 | loss: 0.1584900
	speed: 0.0811s/iter; left time: 1599.7526s
	iters: 600, epoch: 3 | loss: 0.1519295
	speed: 0.0786s/iter; left time: 1542.1249s
	iters: 700, epoch: 3 | loss: 0.1298573
	speed: 0.0797s/iter; left time: 1555.5304s
	iters: 800, epoch: 3 | loss: 0.1548912
	speed: 0.0795s/iter; left time: 1543.7226s
	iters: 900, epoch: 3 | loss: 0.1329976
	speed: 0.0821s/iter; left time: 1585.3471s
	iters: 1000, epoch: 3 | loss: 0.1526400
	speed: 0.0820s/iter; left time: 1574.8710s
	iters: 1100, epoch: 3 | loss: 0.1728086
	speed: 0.0819s/iter; left time: 1565.7742s
Epoch: 3 cost time: 90.22946882247925
Epoch: 3, Steps: 1123 | Train Loss: 0.1573641 Vali Loss: 0.1425746 Test Loss: 0.1645346
Validation loss decreased (0.175607 --> 0.142575).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.1273076
	speed: 0.2117s/iter; left time: 4021.3424s
	iters: 200, epoch: 4 | loss: 0.1431418
	speed: 0.0785s/iter; left time: 1483.7311s
	iters: 300, epoch: 4 | loss: 0.1224765
	speed: 0.0786s/iter; left time: 1476.7091s
	iters: 400, epoch: 4 | loss: 0.1870578
	speed: 0.0782s/iter; left time: 1462.4384s
	iters: 500, epoch: 4 | loss: 0.1334994
	speed: 0.0791s/iter; left time: 1471.1267s
	iters: 600, epoch: 4 | loss: 0.1262499
	speed: 0.0794s/iter; left time: 1469.1410s
	iters: 700, epoch: 4 | loss: 0.1279131
	speed: 0.0798s/iter; left time: 1467.4108s
	iters: 800, epoch: 4 | loss: 0.1300134
	speed: 0.0778s/iter; left time: 1422.6308s
	iters: 900, epoch: 4 | loss: 0.1526735
	speed: 0.0792s/iter; left time: 1441.6254s
	iters: 1000, epoch: 4 | loss: 0.2025162
	speed: 0.0786s/iter; left time: 1422.8295s
	iters: 1100, epoch: 4 | loss: 0.1259652
	speed: 0.0786s/iter; left time: 1413.7396s
Epoch: 4 cost time: 88.70011329650879
Epoch: 4, Steps: 1123 | Train Loss: 0.1416089 Vali Loss: 0.1270956 Test Loss: 0.1481002
Validation loss decreased (0.142575 --> 0.127096).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.1592074
	speed: 0.2203s/iter; left time: 3936.2888s
	iters: 200, epoch: 5 | loss: 0.1279222
	speed: 0.0780s/iter; left time: 1385.9407s
	iters: 300, epoch: 5 | loss: 0.1248727
	speed: 0.0775s/iter; left time: 1369.7438s
	iters: 400, epoch: 5 | loss: 0.1320266
	speed: 0.0784s/iter; left time: 1378.1424s
	iters: 500, epoch: 5 | loss: 0.1774049
	speed: 0.0784s/iter; left time: 1370.1844s
	iters: 600, epoch: 5 | loss: 0.1207061
	speed: 0.0787s/iter; left time: 1366.7046s
	iters: 700, epoch: 5 | loss: 0.1168295
	speed: 0.0784s/iter; left time: 1353.4836s
	iters: 800, epoch: 5 | loss: 0.1479103
	speed: 0.0785s/iter; left time: 1347.5827s
	iters: 900, epoch: 5 | loss: 0.1392084
	speed: 0.0792s/iter; left time: 1351.8724s
	iters: 1000, epoch: 5 | loss: 0.1489807
	speed: 0.0800s/iter; left time: 1356.6924s
	iters: 1100, epoch: 5 | loss: 0.1577331
	speed: 0.0784s/iter; left time: 1322.9393s
Epoch: 5 cost time: 88.85051727294922
Epoch: 5, Steps: 1123 | Train Loss: 0.1337901 Vali Loss: 0.1212519 Test Loss: 0.1419461
Validation loss decreased (0.127096 --> 0.121252).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.1294623
	speed: 0.2115s/iter; left time: 3542.4846s
	iters: 200, epoch: 6 | loss: 0.1143537
	speed: 0.0786s/iter; left time: 1309.1611s
	iters: 300, epoch: 6 | loss: 0.1261495
	speed: 0.0811s/iter; left time: 1341.8435s
	iters: 400, epoch: 6 | loss: 0.1138230
	speed: 0.0793s/iter; left time: 1303.4151s
	iters: 500, epoch: 6 | loss: 0.1959519
	speed: 0.0780s/iter; left time: 1275.0061s
	iters: 600, epoch: 6 | loss: 0.1153570
	speed: 0.0784s/iter; left time: 1273.2389s
	iters: 700, epoch: 6 | loss: 0.1255994
	speed: 0.0790s/iter; left time: 1275.0427s
	iters: 800, epoch: 6 | loss: 0.1073012
	speed: 0.0793s/iter; left time: 1272.6075s
	iters: 900, epoch: 6 | loss: 0.1507604
	speed: 0.0789s/iter; left time: 1257.6883s
	iters: 1000, epoch: 6 | loss: 0.1823397
	speed: 0.0787s/iter; left time: 1246.8642s
	iters: 1100, epoch: 6 | loss: 0.1322718
	speed: 0.0797s/iter; left time: 1254.1952s
Epoch: 6 cost time: 88.94318842887878
Epoch: 6, Steps: 1123 | Train Loss: 0.1296255 Vali Loss: 0.1180905 Test Loss: 0.1385981
Validation loss decreased (0.121252 --> 0.118091).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.1178524
	speed: 0.2113s/iter; left time: 3301.3457s
	iters: 200, epoch: 7 | loss: 0.1345259
	speed: 0.0803s/iter; left time: 1245.8728s
	iters: 300, epoch: 7 | loss: 0.1182433
	speed: 0.0814s/iter; left time: 1255.9629s
	iters: 400, epoch: 7 | loss: 0.1407882
	speed: 0.0818s/iter; left time: 1253.3383s
	iters: 500, epoch: 7 | loss: 0.1069972
	speed: 0.0802s/iter; left time: 1221.3236s
	iters: 600, epoch: 7 | loss: 0.1122525
	speed: 0.0798s/iter; left time: 1206.8845s
	iters: 700, epoch: 7 | loss: 0.1245385
	speed: 0.0794s/iter; left time: 1192.5719s
	iters: 800, epoch: 7 | loss: 0.1073291
	speed: 0.0781s/iter; left time: 1165.6488s
	iters: 900, epoch: 7 | loss: 0.1162084
	speed: 0.0793s/iter; left time: 1175.0161s
	iters: 1000, epoch: 7 | loss: 0.1056929
	speed: 0.0785s/iter; left time: 1156.3263s
	iters: 1100, epoch: 7 | loss: 0.1286516
	speed: 0.0787s/iter; left time: 1151.2093s
Epoch: 7 cost time: 89.54354906082153
Epoch: 7, Steps: 1123 | Train Loss: 0.1273614 Vali Loss: 0.1158376 Test Loss: 0.1357180
Validation loss decreased (0.118091 --> 0.115838).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.1150274
	speed: 0.2102s/iter; left time: 3047.8766s
	iters: 200, epoch: 8 | loss: 0.1048446
	speed: 0.0790s/iter; left time: 1138.2302s
	iters: 300, epoch: 8 | loss: 0.1509792
	speed: 0.0790s/iter; left time: 1129.7726s
	iters: 400, epoch: 8 | loss: 0.1221138
	speed: 0.0796s/iter; left time: 1130.7156s
	iters: 500, epoch: 8 | loss: 0.1223620
	speed: 0.0810s/iter; left time: 1141.4190s
	iters: 600, epoch: 8 | loss: 0.1142794
	speed: 0.0799s/iter; left time: 1118.8555s
	iters: 700, epoch: 8 | loss: 0.1500242
	speed: 0.0785s/iter; left time: 1090.9780s
	iters: 800, epoch: 8 | loss: 0.1360803
	speed: 0.0824s/iter; left time: 1137.0026s
	iters: 900, epoch: 8 | loss: 0.1113428
	speed: 0.0797s/iter; left time: 1092.2755s
	iters: 1000, epoch: 8 | loss: 0.1057045
	speed: 0.0787s/iter; left time: 1070.7597s
	iters: 1100, epoch: 8 | loss: 0.1236698
	speed: 0.0777s/iter; left time: 1048.4955s
Epoch: 8 cost time: 89.21164321899414
Epoch: 8, Steps: 1123 | Train Loss: 0.1261023 Vali Loss: 0.1148215 Test Loss: 0.1345472
Validation loss decreased (0.115838 --> 0.114822).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.1174248
	speed: 0.2099s/iter; left time: 2807.8219s
	iters: 200, epoch: 9 | loss: 0.1232083
	speed: 0.0794s/iter; left time: 1053.6104s
	iters: 300, epoch: 9 | loss: 0.1058809
	speed: 0.0791s/iter; left time: 1041.6596s
	iters: 400, epoch: 9 | loss: 0.1230014
	speed: 0.0778s/iter; left time: 1016.7848s
	iters: 500, epoch: 9 | loss: 0.1424128
	speed: 0.0773s/iter; left time: 1003.4960s
	iters: 600, epoch: 9 | loss: 0.1139723
	speed: 0.0778s/iter; left time: 1001.7578s
	iters: 700, epoch: 9 | loss: 0.1112885
	speed: 0.0780s/iter; left time: 996.5934s
	iters: 800, epoch: 9 | loss: 0.1078942
	speed: 0.0780s/iter; left time: 988.4648s
	iters: 900, epoch: 9 | loss: 0.1209991
	speed: 0.0771s/iter; left time: 969.4991s
	iters: 1000, epoch: 9 | loss: 0.1686022
	speed: 0.0774s/iter; left time: 965.3655s
	iters: 1100, epoch: 9 | loss: 0.1186917
	speed: 0.0791s/iter; left time: 979.0886s
Epoch: 9 cost time: 87.73216462135315
Epoch: 9, Steps: 1123 | Train Loss: 0.1254163 Vali Loss: 0.1143099 Test Loss: 0.1342926
Validation loss decreased (0.114822 --> 0.114310).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.1197300
	speed: 0.2119s/iter; left time: 2596.7010s
	iters: 200, epoch: 10 | loss: 0.1334703
	speed: 0.0781s/iter; left time: 949.5329s
	iters: 300, epoch: 10 | loss: 0.1213405
	speed: 0.0787s/iter; left time: 949.0561s
	iters: 400, epoch: 10 | loss: 0.1323131
	speed: 0.0797s/iter; left time: 952.1975s
	iters: 500, epoch: 10 | loss: 0.1287690
	speed: 0.0805s/iter; left time: 953.9195s
	iters: 600, epoch: 10 | loss: 0.1179583
	speed: 0.0801s/iter; left time: 940.9477s
	iters: 700, epoch: 10 | loss: 0.1536010
	speed: 0.0795s/iter; left time: 926.4370s
	iters: 800, epoch: 10 | loss: 0.1290105
	speed: 0.0792s/iter; left time: 914.7235s
	iters: 900, epoch: 10 | loss: 0.1471891
	speed: 0.0793s/iter; left time: 908.1300s
	iters: 1000, epoch: 10 | loss: 0.1246016
	speed: 0.0785s/iter; left time: 891.3938s
	iters: 1100, epoch: 10 | loss: 0.1291122
	speed: 0.0808s/iter; left time: 909.8788s
Epoch: 10 cost time: 89.21437287330627
Epoch: 10, Steps: 1123 | Train Loss: 0.1250921 Vali Loss: 0.1140064 Test Loss: 0.1339491
Validation loss decreased (0.114310 --> 0.114006).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.1176778
	speed: 0.2169s/iter; left time: 2413.9087s
	iters: 200, epoch: 11 | loss: 0.1259989
	speed: 0.0794s/iter; left time: 875.3644s
	iters: 300, epoch: 11 | loss: 0.1180878
	speed: 0.0801s/iter; left time: 875.4293s
	iters: 400, epoch: 11 | loss: 0.1168300
	speed: 0.0800s/iter; left time: 866.2164s
	iters: 500, epoch: 11 | loss: 0.1059272
	speed: 0.0793s/iter; left time: 851.3833s
	iters: 600, epoch: 11 | loss: 0.1282897
	speed: 0.0800s/iter; left time: 850.0740s
	iters: 700, epoch: 11 | loss: 0.1259754
	speed: 0.0792s/iter; left time: 834.2902s
	iters: 800, epoch: 11 | loss: 0.1152676
	speed: 0.0804s/iter; left time: 838.4421s
	iters: 900, epoch: 11 | loss: 0.1245737
	speed: 0.0794s/iter; left time: 820.3427s
	iters: 1000, epoch: 11 | loss: 0.1151078
	speed: 0.0790s/iter; left time: 808.2296s
	iters: 1100, epoch: 11 | loss: 0.1137090
	speed: 0.0781s/iter; left time: 791.7274s
Epoch: 11 cost time: 89.441730260849
Epoch: 11, Steps: 1123 | Train Loss: 0.1249081 Vali Loss: 0.1139666 Test Loss: 0.1338524
Validation loss decreased (0.114006 --> 0.113967).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.1126173
	speed: 0.2117s/iter; left time: 2119.1850s
	iters: 200, epoch: 12 | loss: 0.1338840
	speed: 0.0815s/iter; left time: 807.4156s
	iters: 300, epoch: 12 | loss: 0.1049109
	speed: 0.0795s/iter; left time: 779.8368s
	iters: 400, epoch: 12 | loss: 0.1351277
	speed: 0.0785s/iter; left time: 761.6137s
	iters: 500, epoch: 12 | loss: 0.1285350
	speed: 0.0781s/iter; left time: 750.4979s
	iters: 600, epoch: 12 | loss: 0.1230830
	speed: 0.0782s/iter; left time: 743.7144s
	iters: 700, epoch: 12 | loss: 0.0930149
	speed: 0.0784s/iter; left time: 738.0567s
	iters: 800, epoch: 12 | loss: 0.1178819
	speed: 0.0803s/iter; left time: 747.8395s
	iters: 900, epoch: 12 | loss: 0.1209714
	speed: 0.0789s/iter; left time: 726.9684s
	iters: 1000, epoch: 12 | loss: 0.1325393
	speed: 0.0781s/iter; left time: 710.9869s
	iters: 1100, epoch: 12 | loss: 0.1403667
	speed: 0.0785s/iter; left time: 707.5575s
Epoch: 12 cost time: 88.9207239151001
Epoch: 12, Steps: 1123 | Train Loss: 0.1248040 Vali Loss: 0.1139314 Test Loss: 0.1337678
Validation loss decreased (0.113967 --> 0.113931).  Saving model ...
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.1153593
	speed: 0.2100s/iter; left time: 1865.7313s
	iters: 200, epoch: 13 | loss: 0.1079058
	speed: 0.0792s/iter; left time: 695.4799s
	iters: 300, epoch: 13 | loss: 0.1373719
	speed: 0.0794s/iter; left time: 689.1957s
	iters: 400, epoch: 13 | loss: 0.1544549
	speed: 0.0792s/iter; left time: 679.6467s
	iters: 500, epoch: 13 | loss: 0.1171849
	speed: 0.0795s/iter; left time: 674.3319s
	iters: 600, epoch: 13 | loss: 0.1101345
	speed: 0.0797s/iter; left time: 668.3784s
	iters: 700, epoch: 13 | loss: 0.1147955
	speed: 0.0787s/iter; left time: 652.0065s
	iters: 800, epoch: 13 | loss: 0.1136424
	speed: 0.0785s/iter; left time: 642.4934s
	iters: 900, epoch: 13 | loss: 0.0961074
	speed: 0.0789s/iter; left time: 638.0636s
	iters: 1000, epoch: 13 | loss: 0.1042839
	speed: 0.0791s/iter; left time: 631.4791s
	iters: 1100, epoch: 13 | loss: 0.1113971
	speed: 0.0797s/iter; left time: 628.3062s
Epoch: 13 cost time: 88.93789434432983
Epoch: 13, Steps: 1123 | Train Loss: 0.1247427 Vali Loss: 0.1138691 Test Loss: 0.1337527
Validation loss decreased (0.113931 --> 0.113869).  Saving model ...
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.1274449
	speed: 0.2115s/iter; left time: 1641.4498s
	iters: 200, epoch: 14 | loss: 0.1490785
	speed: 0.0791s/iter; left time: 605.7991s
	iters: 300, epoch: 14 | loss: 0.1081697
	speed: 0.0806s/iter; left time: 609.3685s
	iters: 400, epoch: 14 | loss: 0.1131392
	speed: 0.0796s/iter; left time: 593.7427s
	iters: 500, epoch: 14 | loss: 0.1400110
	speed: 0.0805s/iter; left time: 592.7744s
	iters: 600, epoch: 14 | loss: 0.1297595
	speed: 0.0819s/iter; left time: 595.0131s
	iters: 700, epoch: 14 | loss: 0.1114216
	speed: 0.0807s/iter; left time: 577.8410s
	iters: 800, epoch: 14 | loss: 0.1370094
	speed: 0.0814s/iter; left time: 574.5346s
	iters: 900, epoch: 14 | loss: 0.1421171
	speed: 0.0791s/iter; left time: 550.3620s
	iters: 1000, epoch: 14 | loss: 0.1188057
	speed: 0.0789s/iter; left time: 541.1380s
	iters: 1100, epoch: 14 | loss: 0.1268499
	speed: 0.0784s/iter; left time: 530.0793s
Epoch: 14 cost time: 89.81167507171631
Epoch: 14, Steps: 1123 | Train Loss: 0.1246975 Vali Loss: 0.1138531 Test Loss: 0.1337434
Validation loss decreased (0.113869 --> 0.113853).  Saving model ...
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.1338059
	speed: 0.2133s/iter; left time: 1416.0125s
	iters: 200, epoch: 15 | loss: 0.1193733
	speed: 0.0803s/iter; left time: 525.3133s
	iters: 300, epoch: 15 | loss: 0.1154781
	speed: 0.0798s/iter; left time: 513.6541s
	iters: 400, epoch: 15 | loss: 0.1621671
	speed: 0.0795s/iter; left time: 503.7700s
	iters: 500, epoch: 15 | loss: 0.1769128
	speed: 0.0798s/iter; left time: 497.6034s
	iters: 600, epoch: 15 | loss: 0.1336526
	speed: 0.0794s/iter; left time: 487.4926s
	iters: 700, epoch: 15 | loss: 0.1292562
	speed: 0.0802s/iter; left time: 484.5710s
	iters: 800, epoch: 15 | loss: 0.1563699
	speed: 0.0846s/iter; left time: 502.3386s
	iters: 900, epoch: 15 | loss: 0.1405175
	speed: 0.0834s/iter; left time: 486.9915s
	iters: 1000, epoch: 15 | loss: 0.1263508
	speed: 0.0786s/iter; left time: 450.9195s
	iters: 1100, epoch: 15 | loss: 0.1218441
	speed: 0.0788s/iter; left time: 444.1371s
Epoch: 15 cost time: 90.4028582572937
Epoch: 15, Steps: 1123 | Train Loss: 0.1247109 Vali Loss: 0.1138528 Test Loss: 0.1337419
Validation loss decreased (0.113853 --> 0.113853).  Saving model ...
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.1349557
	speed: 0.2069s/iter; left time: 1141.3182s
	iters: 200, epoch: 16 | loss: 0.1512221
	speed: 0.0756s/iter; left time: 409.3414s
	iters: 300, epoch: 16 | loss: 0.1250100
	speed: 0.0775s/iter; left time: 411.9390s
	iters: 400, epoch: 16 | loss: 0.1666011
	speed: 0.0791s/iter; left time: 412.4258s
	iters: 500, epoch: 16 | loss: 0.1127594
	speed: 0.0796s/iter; left time: 407.0545s
	iters: 600, epoch: 16 | loss: 0.1131283
	speed: 0.0791s/iter; left time: 396.9772s
	iters: 700, epoch: 16 | loss: 0.1368132
	speed: 0.0784s/iter; left time: 385.2175s
	iters: 800, epoch: 16 | loss: 0.1208661
	speed: 0.0783s/iter; left time: 376.9406s
	iters: 900, epoch: 16 | loss: 0.1307171
	speed: 0.0795s/iter; left time: 375.0714s
	iters: 1000, epoch: 16 | loss: 0.1174761
	speed: 0.0788s/iter; left time: 363.9706s
	iters: 1100, epoch: 16 | loss: 0.1041905
	speed: 0.0779s/iter; left time: 351.7110s
Epoch: 16 cost time: 87.78562140464783
Epoch: 16, Steps: 1123 | Train Loss: 0.1246592 Vali Loss: 0.1138233 Test Loss: 0.1337414
Validation loss decreased (0.113853 --> 0.113823).  Saving model ...
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 17 | loss: 0.1158586
	speed: 0.2133s/iter; left time: 936.9440s
	iters: 200, epoch: 17 | loss: 0.1174436
	speed: 0.0783s/iter; left time: 336.1925s
	iters: 300, epoch: 17 | loss: 0.1036943
	speed: 0.0784s/iter; left time: 328.7873s
	iters: 400, epoch: 17 | loss: 0.1292412
	speed: 0.0787s/iter; left time: 321.9933s
	iters: 500, epoch: 17 | loss: 0.1350299
	speed: 0.0784s/iter; left time: 313.1974s
	iters: 600, epoch: 17 | loss: 0.1479857
	speed: 0.0788s/iter; left time: 306.8134s
	iters: 700, epoch: 17 | loss: 0.1239319
	speed: 0.0795s/iter; left time: 301.5193s
	iters: 800, epoch: 17 | loss: 0.1134080
	speed: 0.0796s/iter; left time: 294.1232s
	iters: 900, epoch: 17 | loss: 0.1203846
	speed: 0.0795s/iter; left time: 285.5705s
	iters: 1000, epoch: 17 | loss: 0.1143874
	speed: 0.0788s/iter; left time: 275.2811s
	iters: 1100, epoch: 17 | loss: 0.1326593
	speed: 0.0818s/iter; left time: 277.5122s
Epoch: 17 cost time: 88.88075041770935
Epoch: 17, Steps: 1123 | Train Loss: 0.1246921 Vali Loss: 0.1138607 Test Loss: 0.1337412
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 18 | loss: 0.1289985
	speed: 0.2016s/iter; left time: 659.2816s
	iters: 200, epoch: 18 | loss: 0.1514333
	speed: 0.0808s/iter; left time: 256.1360s
	iters: 300, epoch: 18 | loss: 0.1118647
	speed: 0.0805s/iter; left time: 247.0766s
	iters: 400, epoch: 18 | loss: 0.1727262
	speed: 0.0783s/iter; left time: 232.4755s
	iters: 500, epoch: 18 | loss: 0.1348011
	speed: 0.0796s/iter; left time: 228.3246s
	iters: 600, epoch: 18 | loss: 0.1261064
	speed: 0.0794s/iter; left time: 219.8945s
	iters: 700, epoch: 18 | loss: 0.1496288
	speed: 0.0803s/iter; left time: 214.3171s
	iters: 800, epoch: 18 | loss: 0.1036927
	speed: 0.0788s/iter; left time: 202.4955s
	iters: 900, epoch: 18 | loss: 0.1336869
	speed: 0.0786s/iter; left time: 194.0193s
	iters: 1000, epoch: 18 | loss: 0.1138280
	speed: 0.0787s/iter; left time: 186.5708s
	iters: 1100, epoch: 18 | loss: 0.1228867
	speed: 0.0793s/iter; left time: 180.0863s
Epoch: 18 cost time: 89.29288005828857
Epoch: 18, Steps: 1123 | Train Loss: 0.1246884 Vali Loss: 0.1138573 Test Loss: 0.1337411
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 19 | loss: 0.1225021
	speed: 0.1994s/iter; left time: 428.1423s
	iters: 200, epoch: 19 | loss: 0.1392154
	speed: 0.0787s/iter; left time: 161.0498s
	iters: 300, epoch: 19 | loss: 0.1158329
	speed: 0.0780s/iter; left time: 151.9367s
	iters: 400, epoch: 19 | loss: 0.1372997
	speed: 0.0815s/iter; left time: 150.6095s
	iters: 500, epoch: 19 | loss: 0.1085240
	speed: 0.0816s/iter; left time: 142.5381s
	iters: 600, epoch: 19 | loss: 0.1666269
	speed: 0.0799s/iter; left time: 131.5460s
	iters: 700, epoch: 19 | loss: 0.1265029
	speed: 0.0780s/iter; left time: 120.6482s
	iters: 800, epoch: 19 | loss: 0.1137519
	speed: 0.0790s/iter; left time: 114.2938s
	iters: 900, epoch: 19 | loss: 0.1595906
	speed: 0.0797s/iter; left time: 107.3658s
	iters: 1000, epoch: 19 | loss: 0.1414424
	speed: 0.0805s/iter; left time: 100.4205s
	iters: 1100, epoch: 19 | loss: 0.1209104
	speed: 0.0792s/iter; left time: 90.8719s
Epoch: 19 cost time: 89.54444742202759
Epoch: 19, Steps: 1123 | Train Loss: 0.1246853 Vali Loss: 0.1138579 Test Loss: 0.1337410
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.9073486328125e-08
	iters: 100, epoch: 20 | loss: 0.1375744
	speed: 0.1987s/iter; left time: 203.4528s
	iters: 200, epoch: 20 | loss: 0.0991822
	speed: 0.0792s/iter; left time: 73.1983s
	iters: 300, epoch: 20 | loss: 0.1405206
	speed: 0.0801s/iter; left time: 66.0181s
	iters: 400, epoch: 20 | loss: 0.1210328
	speed: 0.0795s/iter; left time: 57.5283s
	iters: 500, epoch: 20 | loss: 0.1215247
	speed: 0.0787s/iter; left time: 49.0877s
	iters: 600, epoch: 20 | loss: 0.1419692
	speed: 0.0794s/iter; left time: 41.6269s
	iters: 700, epoch: 20 | loss: 0.1309528
	speed: 0.0798s/iter; left time: 33.8444s
	iters: 800, epoch: 20 | loss: 0.1069197
	speed: 0.0799s/iter; left time: 25.8997s
	iters: 900, epoch: 20 | loss: 0.1375678
	speed: 0.0785s/iter; left time: 17.5830s
	iters: 1000, epoch: 20 | loss: 0.1309088
	speed: 0.0782s/iter; left time: 9.6934s
	iters: 1100, epoch: 20 | loss: 0.1256479
	speed: 0.0784s/iter; left time: 1.8804s
Epoch: 20 cost time: 88.85521984100342
Epoch: 20, Steps: 1123 | Train Loss: 0.1246869 Vali Loss: 0.1138084 Test Loss: 0.1337410
Validation loss decreased (0.113823 --> 0.113808).  Saving model ...
Updating learning rate to 9.5367431640625e-09
>>>>>>>testing : Electricity_336_96_Linear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3144<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5165
mse:0.13372021913528442, mae:0.23042511940002441
