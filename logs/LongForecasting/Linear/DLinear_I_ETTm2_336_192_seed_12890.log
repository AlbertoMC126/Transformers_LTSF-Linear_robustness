Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='DLinear', model_id='ETTm2_336_192', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=192, root_path='./dataset/', save_pred_values=False, seed=12890, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTm2_336_192_DLinear_ETTm2_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed12890>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34033
val 11329
test 11329
	iters: 100, epoch: 1 | loss: 0.2937072
	speed: 0.0097s/iter; left time: 205.8732s
	iters: 200, epoch: 1 | loss: 0.3543869
	speed: 0.0116s/iter; left time: 243.8977s
	iters: 300, epoch: 1 | loss: 0.6534472
	speed: 0.0122s/iter; left time: 256.0593s
	iters: 400, epoch: 1 | loss: 0.2991921
	speed: 0.0111s/iter; left time: 230.5275s
	iters: 500, epoch: 1 | loss: 0.3310653
	speed: 0.0110s/iter; left time: 227.9697s
	iters: 600, epoch: 1 | loss: 0.7143260
	speed: 0.0104s/iter; left time: 213.9236s
	iters: 700, epoch: 1 | loss: 0.5103349
	speed: 0.0097s/iter; left time: 198.8481s
	iters: 800, epoch: 1 | loss: 0.7831988
	speed: 0.0120s/iter; left time: 245.6048s
	iters: 900, epoch: 1 | loss: 0.5262519
	speed: 0.0123s/iter; left time: 249.4946s
	iters: 1000, epoch: 1 | loss: 0.3630859
	speed: 0.0123s/iter; left time: 249.6566s
Epoch: 1 cost time: 11.860097646713257
Epoch: 1, Steps: 1063 | Train Loss: 0.5510333 Vali Loss: 0.9909647 Test Loss: 2.7409358
Validation loss decreased (inf --> 0.990965).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.5361341
	speed: 0.0494s/iter; left time: 992.4743s
	iters: 200, epoch: 2 | loss: 0.5291395
	speed: 0.0123s/iter; left time: 245.8431s
	iters: 300, epoch: 2 | loss: 0.4473158
	speed: 0.0103s/iter; left time: 205.1772s
	iters: 400, epoch: 2 | loss: 0.5614331
	speed: 0.0113s/iter; left time: 222.9632s
	iters: 500, epoch: 2 | loss: 0.3909562
	speed: 0.0116s/iter; left time: 228.3215s
	iters: 600, epoch: 2 | loss: 0.4498060
	speed: 0.0107s/iter; left time: 209.9396s
	iters: 700, epoch: 2 | loss: 0.4417976
	speed: 0.0108s/iter; left time: 210.4002s
	iters: 800, epoch: 2 | loss: 0.3127932
	speed: 0.0103s/iter; left time: 199.8310s
	iters: 900, epoch: 2 | loss: 0.5616559
	speed: 0.0113s/iter; left time: 217.3289s
	iters: 1000, epoch: 2 | loss: 0.6438867
	speed: 0.0103s/iter; left time: 196.8273s
Epoch: 2 cost time: 11.608477592468262
Epoch: 2, Steps: 1063 | Train Loss: 0.5605129 Vali Loss: 0.7092634 Test Loss: 1.4280709
Validation loss decreased (0.990965 --> 0.709263).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.3296630
	speed: 0.0458s/iter; left time: 871.6789s
	iters: 200, epoch: 3 | loss: 0.3300389
	speed: 0.0106s/iter; left time: 201.1184s
	iters: 300, epoch: 3 | loss: 0.7144861
	speed: 0.0100s/iter; left time: 187.4506s
	iters: 400, epoch: 3 | loss: 0.2761032
	speed: 0.0110s/iter; left time: 206.0937s
	iters: 500, epoch: 3 | loss: 0.3853043
	speed: 0.0090s/iter; left time: 168.4767s
	iters: 600, epoch: 3 | loss: 0.5966796
	speed: 0.0103s/iter; left time: 191.6566s
	iters: 700, epoch: 3 | loss: 0.3003426
	speed: 0.0116s/iter; left time: 213.1469s
	iters: 800, epoch: 3 | loss: 0.2298953
	speed: 0.0106s/iter; left time: 193.9976s
	iters: 900, epoch: 3 | loss: 0.6016185
	speed: 0.0118s/iter; left time: 215.7451s
	iters: 1000, epoch: 3 | loss: 0.2560501
	speed: 0.0103s/iter; left time: 186.6393s
Epoch: 3 cost time: 11.174306154251099
Epoch: 3, Steps: 1063 | Train Loss: 0.3689422 Vali Loss: 0.2837670 Test Loss: 0.5405624
Validation loss decreased (0.709263 --> 0.283767).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.3393086
	speed: 0.0433s/iter; left time: 777.6477s
	iters: 200, epoch: 4 | loss: 0.2248411
	speed: 0.0113s/iter; left time: 201.8243s
	iters: 300, epoch: 4 | loss: 0.3735731
	speed: 0.0099s/iter; left time: 176.0620s
	iters: 400, epoch: 4 | loss: 0.5881851
	speed: 0.0102s/iter; left time: 180.9998s
	iters: 500, epoch: 4 | loss: 0.2449322
	speed: 0.0119s/iter; left time: 209.1361s
	iters: 600, epoch: 4 | loss: 0.2779042
	speed: 0.0094s/iter; left time: 164.5613s
	iters: 700, epoch: 4 | loss: 0.1719691
	speed: 0.0102s/iter; left time: 176.5213s
	iters: 800, epoch: 4 | loss: 0.2444689
	speed: 0.0118s/iter; left time: 203.8505s
	iters: 900, epoch: 4 | loss: 0.2911438
	speed: 0.0114s/iter; left time: 195.5982s
	iters: 1000, epoch: 4 | loss: 0.3019686
	speed: 0.0103s/iter; left time: 176.0569s
Epoch: 4 cost time: 11.400190591812134
Epoch: 4, Steps: 1063 | Train Loss: 0.3221839 Vali Loss: 0.2335748 Test Loss: 0.3735414
Validation loss decreased (0.283767 --> 0.233575).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.5641412
	speed: 0.0452s/iter; left time: 763.4875s
	iters: 200, epoch: 5 | loss: 0.2283893
	speed: 0.0107s/iter; left time: 180.4342s
	iters: 300, epoch: 5 | loss: 0.2009292
	speed: 0.0101s/iter; left time: 168.9730s
	iters: 400, epoch: 5 | loss: 0.2356556
	speed: 0.0109s/iter; left time: 180.5090s
	iters: 500, epoch: 5 | loss: 0.3546180
	speed: 0.0107s/iter; left time: 176.3754s
	iters: 600, epoch: 5 | loss: 0.2219689
	speed: 0.0115s/iter; left time: 188.4158s
	iters: 700, epoch: 5 | loss: 0.2044634
	speed: 0.0118s/iter; left time: 192.3847s
	iters: 800, epoch: 5 | loss: 0.3241202
	speed: 0.0111s/iter; left time: 180.5867s
	iters: 900, epoch: 5 | loss: 0.1916955
	speed: 0.0118s/iter; left time: 189.6123s
	iters: 1000, epoch: 5 | loss: 0.2987477
	speed: 0.0103s/iter; left time: 164.6277s
Epoch: 5 cost time: 11.58881425857544
Epoch: 5, Steps: 1063 | Train Loss: 0.3027838 Vali Loss: 0.2253516 Test Loss: 0.4251563
Validation loss decreased (0.233575 --> 0.225352).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.5495471
	speed: 0.0509s/iter; left time: 806.5796s
	iters: 200, epoch: 6 | loss: 0.2965162
	speed: 0.0102s/iter; left time: 160.1436s
	iters: 300, epoch: 6 | loss: 0.2234664
	speed: 0.0103s/iter; left time: 161.3568s
	iters: 400, epoch: 6 | loss: 0.2714998
	speed: 0.0114s/iter; left time: 177.2735s
	iters: 500, epoch: 6 | loss: 0.3236411
	speed: 0.0112s/iter; left time: 173.3194s
	iters: 600, epoch: 6 | loss: 0.2759149
	speed: 0.0107s/iter; left time: 163.7764s
	iters: 700, epoch: 6 | loss: 0.2112511
	speed: 0.0117s/iter; left time: 178.7373s
	iters: 800, epoch: 6 | loss: 0.3256700
	speed: 0.0107s/iter; left time: 162.5493s
	iters: 900, epoch: 6 | loss: 0.4042657
	speed: 0.0114s/iter; left time: 171.9846s
	iters: 1000, epoch: 6 | loss: 0.4400700
	speed: 0.0087s/iter; left time: 130.5105s
Epoch: 6 cost time: 11.524916172027588
Epoch: 6, Steps: 1063 | Train Loss: 0.2879549 Vali Loss: 0.1930291 Test Loss: 0.3165131
Validation loss decreased (0.225352 --> 0.193029).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.3421008
	speed: 0.0463s/iter; left time: 684.6083s
	iters: 200, epoch: 7 | loss: 0.1933697
	speed: 0.0102s/iter; left time: 150.0720s
	iters: 300, epoch: 7 | loss: 0.2007051
	speed: 0.0085s/iter; left time: 123.5776s
	iters: 400, epoch: 7 | loss: 0.1530744
	speed: 0.0099s/iter; left time: 143.8242s
	iters: 500, epoch: 7 | loss: 0.3455710
	speed: 0.0098s/iter; left time: 141.2603s
	iters: 600, epoch: 7 | loss: 0.4304574
	speed: 0.0103s/iter; left time: 146.5733s
	iters: 700, epoch: 7 | loss: 0.2224432
	speed: 0.0101s/iter; left time: 143.6913s
	iters: 800, epoch: 7 | loss: 0.3723140
	speed: 0.0108s/iter; left time: 151.9921s
	iters: 900, epoch: 7 | loss: 0.2695639
	speed: 0.0116s/iter; left time: 162.5276s
	iters: 1000, epoch: 7 | loss: 0.4338361
	speed: 0.0109s/iter; left time: 151.3674s
Epoch: 7 cost time: 10.966355323791504
Epoch: 7, Steps: 1063 | Train Loss: 0.2811983 Vali Loss: 0.2147370 Test Loss: 0.3977168
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.2238721
	speed: 0.0446s/iter; left time: 611.7099s
	iters: 200, epoch: 8 | loss: 0.2101294
	speed: 0.0123s/iter; left time: 167.1398s
	iters: 300, epoch: 8 | loss: 0.1653391
	speed: 0.0120s/iter; left time: 162.1503s
	iters: 400, epoch: 8 | loss: 0.1546461
	speed: 0.0104s/iter; left time: 139.0577s
	iters: 500, epoch: 8 | loss: 0.3186843
	speed: 0.0103s/iter; left time: 137.4901s
	iters: 600, epoch: 8 | loss: 0.3911651
	speed: 0.0112s/iter; left time: 148.2398s
	iters: 700, epoch: 8 | loss: 0.1401397
	speed: 0.0112s/iter; left time: 146.5544s
	iters: 800, epoch: 8 | loss: 0.6012367
	speed: 0.0110s/iter; left time: 143.7610s
	iters: 900, epoch: 8 | loss: 0.6176820
	speed: 0.0107s/iter; left time: 138.2698s
	iters: 1000, epoch: 8 | loss: 0.2632987
	speed: 0.0112s/iter; left time: 143.2498s
Epoch: 8 cost time: 11.894469499588013
Epoch: 8, Steps: 1063 | Train Loss: 0.2778918 Vali Loss: 0.2198404 Test Loss: 0.4089632
EarlyStopping counter: 2 out of 5
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.1371625
	speed: 0.0460s/iter; left time: 582.7209s
	iters: 200, epoch: 9 | loss: 0.3197252
	speed: 0.0110s/iter; left time: 137.7846s
	iters: 300, epoch: 9 | loss: 0.2960977
	speed: 0.0115s/iter; left time: 143.6385s
	iters: 400, epoch: 9 | loss: 0.2435054
	speed: 0.0106s/iter; left time: 130.8636s
	iters: 500, epoch: 9 | loss: 0.4157810
	speed: 0.0110s/iter; left time: 134.2490s
	iters: 600, epoch: 9 | loss: 0.1938735
	speed: 0.0114s/iter; left time: 138.1289s
	iters: 700, epoch: 9 | loss: 0.1308589
	speed: 0.0109s/iter; left time: 131.2047s
	iters: 800, epoch: 9 | loss: 0.4803939
	speed: 0.0118s/iter; left time: 141.4553s
	iters: 900, epoch: 9 | loss: 0.3091840
	speed: 0.0118s/iter; left time: 140.3145s
	iters: 1000, epoch: 9 | loss: 0.2537522
	speed: 0.0097s/iter; left time: 114.5061s
Epoch: 9 cost time: 11.811319828033447
Epoch: 9, Steps: 1063 | Train Loss: 0.2759796 Vali Loss: 0.1799136 Test Loss: 0.2907830
Validation loss decreased (0.193029 --> 0.179914).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.2363691
	speed: 0.0460s/iter; left time: 533.2353s
	iters: 200, epoch: 10 | loss: 0.2505238
	speed: 0.0096s/iter; left time: 110.3550s
	iters: 300, epoch: 10 | loss: 0.1613269
	speed: 0.0102s/iter; left time: 116.2521s
	iters: 400, epoch: 10 | loss: 0.1903125
	speed: 0.0090s/iter; left time: 101.7878s
	iters: 500, epoch: 10 | loss: 0.1852602
	speed: 0.0114s/iter; left time: 127.7253s
	iters: 600, epoch: 10 | loss: 0.2407208
	speed: 0.0115s/iter; left time: 127.5003s
	iters: 700, epoch: 10 | loss: 0.3565804
	speed: 0.0105s/iter; left time: 115.1280s
	iters: 800, epoch: 10 | loss: 0.2409130
	speed: 0.0105s/iter; left time: 114.2881s
	iters: 900, epoch: 10 | loss: 0.1164146
	speed: 0.0113s/iter; left time: 122.0235s
	iters: 1000, epoch: 10 | loss: 0.1830062
	speed: 0.0107s/iter; left time: 114.5829s
Epoch: 10 cost time: 11.236067533493042
Epoch: 10, Steps: 1063 | Train Loss: 0.2747550 Vali Loss: 0.1924290 Test Loss: 0.3253065
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.5953451
	speed: 0.0453s/iter; left time: 477.0155s
	iters: 200, epoch: 11 | loss: 0.2293692
	speed: 0.0107s/iter; left time: 111.5348s
	iters: 300, epoch: 11 | loss: 0.1815980
	speed: 0.0095s/iter; left time: 97.7621s
	iters: 400, epoch: 11 | loss: 0.1763216
	speed: 0.0088s/iter; left time: 89.7331s
	iters: 500, epoch: 11 | loss: 0.2463905
	speed: 0.0103s/iter; left time: 104.0684s
	iters: 600, epoch: 11 | loss: 0.3169722
	speed: 0.0103s/iter; left time: 103.2277s
	iters: 700, epoch: 11 | loss: 0.2240356
	speed: 0.0114s/iter; left time: 113.5310s
	iters: 800, epoch: 11 | loss: 0.2660676
	speed: 0.0119s/iter; left time: 116.9954s
	iters: 900, epoch: 11 | loss: 0.2325938
	speed: 0.0098s/iter; left time: 94.8808s
	iters: 1000, epoch: 11 | loss: 0.1918610
	speed: 0.0112s/iter; left time: 108.0813s
Epoch: 11 cost time: 11.04177451133728
Epoch: 11, Steps: 1063 | Train Loss: 0.2740637 Vali Loss: 0.1923158 Test Loss: 0.3305612
EarlyStopping counter: 2 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.2354165
	speed: 0.0430s/iter; left time: 407.0414s
	iters: 200, epoch: 12 | loss: 0.1875098
	speed: 0.0115s/iter; left time: 107.9379s
	iters: 300, epoch: 12 | loss: 0.2162115
	speed: 0.0109s/iter; left time: 101.2055s
	iters: 400, epoch: 12 | loss: 0.2623174
	speed: 0.0103s/iter; left time: 94.3423s
	iters: 500, epoch: 12 | loss: 0.2618636
	speed: 0.0097s/iter; left time: 87.5411s
	iters: 600, epoch: 12 | loss: 0.2123832
	speed: 0.0105s/iter; left time: 94.2951s
	iters: 700, epoch: 12 | loss: 0.3781402
	speed: 0.0101s/iter; left time: 89.8745s
	iters: 800, epoch: 12 | loss: 0.7016429
	speed: 0.0100s/iter; left time: 87.4198s
	iters: 900, epoch: 12 | loss: 0.2564400
	speed: 0.0101s/iter; left time: 87.4021s
	iters: 1000, epoch: 12 | loss: 0.3431410
	speed: 0.0100s/iter; left time: 85.8752s
Epoch: 12 cost time: 10.882570028305054
Epoch: 12, Steps: 1063 | Train Loss: 0.2737160 Vali Loss: 0.1996196 Test Loss: 0.3497093
EarlyStopping counter: 3 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.1558135
	speed: 0.0500s/iter; left time: 420.4088s
	iters: 200, epoch: 13 | loss: 0.2395292
	speed: 0.0119s/iter; left time: 98.9348s
	iters: 300, epoch: 13 | loss: 0.2704976
	speed: 0.0109s/iter; left time: 89.6305s
	iters: 400, epoch: 13 | loss: 0.2764130
	speed: 0.0115s/iter; left time: 92.9287s
	iters: 500, epoch: 13 | loss: 0.2401833
	speed: 0.0113s/iter; left time: 90.7173s
	iters: 600, epoch: 13 | loss: 0.8980452
	speed: 0.0100s/iter; left time: 79.3703s
	iters: 700, epoch: 13 | loss: 0.3993487
	speed: 0.0105s/iter; left time: 81.9685s
	iters: 800, epoch: 13 | loss: 0.1536456
	speed: 0.0099s/iter; left time: 75.8986s
	iters: 900, epoch: 13 | loss: 0.2948447
	speed: 0.0098s/iter; left time: 74.2452s
	iters: 1000, epoch: 13 | loss: 0.1914227
	speed: 0.0096s/iter; left time: 72.3682s
Epoch: 13 cost time: 11.330173969268799
Epoch: 13, Steps: 1063 | Train Loss: 0.2737992 Vali Loss: 0.1958213 Test Loss: 0.3395039
EarlyStopping counter: 4 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 14 | loss: 0.2161586
	speed: 0.0410s/iter; left time: 301.2997s
	iters: 200, epoch: 14 | loss: 0.2907179
	speed: 0.0100s/iter; left time: 72.1591s
	iters: 300, epoch: 14 | loss: 0.2377732
	speed: 0.0099s/iter; left time: 71.0110s
	iters: 400, epoch: 14 | loss: 0.2414474
	speed: 0.0098s/iter; left time: 69.3089s
	iters: 500, epoch: 14 | loss: 0.2273253
	speed: 0.0085s/iter; left time: 58.7886s
	iters: 600, epoch: 14 | loss: 0.2415365
	speed: 0.0087s/iter; left time: 59.5964s
	iters: 700, epoch: 14 | loss: 0.2822700
	speed: 0.0076s/iter; left time: 51.2520s
	iters: 800, epoch: 14 | loss: 0.3129337
	speed: 0.0082s/iter; left time: 54.6805s
	iters: 900, epoch: 14 | loss: 0.2631299
	speed: 0.0081s/iter; left time: 53.2694s
	iters: 1000, epoch: 14 | loss: 0.2092831
	speed: 0.0084s/iter; left time: 54.2596s
Epoch: 14 cost time: 9.318273067474365
Epoch: 14, Steps: 1063 | Train Loss: 0.2736720 Vali Loss: 0.1949719 Test Loss: 0.3368607
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTm2_336_192_DLinear_ETTm2_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed12890<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
mse:0.29141202569007874, mae:0.3461638391017914
