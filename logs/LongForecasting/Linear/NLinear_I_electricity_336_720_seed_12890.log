Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='NLinear', model_id='Electricity_336_720', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=720, root_path='./dataset/', save_pred_values=False, seed=12890, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : Electricity_336_720_NLinear_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed12890>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17357
val 1913
test 4541
	iters: 100, epoch: 1 | loss: 0.2984833
	speed: 0.1113s/iter; left time: 2402.9729s
	iters: 200, epoch: 1 | loss: 0.3100196
	speed: 0.0961s/iter; left time: 2065.0892s
	iters: 300, epoch: 1 | loss: 0.3374180
	speed: 0.0960s/iter; left time: 2052.9923s
	iters: 400, epoch: 1 | loss: 0.2882694
	speed: 0.0954s/iter; left time: 2030.4793s
	iters: 500, epoch: 1 | loss: 0.2977065
	speed: 0.0966s/iter; left time: 2045.9089s
	iters: 600, epoch: 1 | loss: 0.3566629
	speed: 0.0960s/iter; left time: 2023.6070s
	iters: 700, epoch: 1 | loss: 0.3353902
	speed: 0.0966s/iter; left time: 2026.8007s
	iters: 800, epoch: 1 | loss: 0.3427587
	speed: 0.0952s/iter; left time: 1988.4671s
	iters: 900, epoch: 1 | loss: 0.3171987
	speed: 0.0952s/iter; left time: 1978.8389s
	iters: 1000, epoch: 1 | loss: 0.2841899
	speed: 0.0957s/iter; left time: 1979.6173s
Epoch: 1 cost time: 105.59696793556213
Epoch: 1, Steps: 1084 | Train Loss: 0.3329676 Vali Loss: 0.2672364 Test Loss: 0.3075289
Validation loss decreased (inf --> 0.267236).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.3019936
	speed: 0.3984s/iter; left time: 8166.2188s
	iters: 200, epoch: 2 | loss: 0.3563884
	speed: 0.1008s/iter; left time: 2056.5412s
	iters: 300, epoch: 2 | loss: 0.2697666
	speed: 0.1013s/iter; left time: 2056.5013s
	iters: 400, epoch: 2 | loss: 0.3019639
	speed: 0.0970s/iter; left time: 1958.1210s
	iters: 500, epoch: 2 | loss: 0.3215276
	speed: 0.0956s/iter; left time: 1920.4654s
	iters: 600, epoch: 2 | loss: 0.3108833
	speed: 0.0954s/iter; left time: 1908.5635s
	iters: 700, epoch: 2 | loss: 0.3086946
	speed: 0.0954s/iter; left time: 1898.8010s
	iters: 800, epoch: 2 | loss: 0.3249393
	speed: 0.0954s/iter; left time: 1888.9338s
	iters: 900, epoch: 2 | loss: 0.3934031
	speed: 0.0958s/iter; left time: 1887.6948s
	iters: 1000, epoch: 2 | loss: 0.3026626
	speed: 0.0961s/iter; left time: 1882.5320s
Epoch: 2 cost time: 105.57402086257935
Epoch: 2, Steps: 1084 | Train Loss: 0.3209512 Vali Loss: 0.2735923 Test Loss: 0.3157165
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.2233831
	speed: 0.3699s/iter; left time: 7181.3495s
	iters: 200, epoch: 3 | loss: 0.2774215
	speed: 0.0950s/iter; left time: 1834.9222s
	iters: 300, epoch: 3 | loss: 0.2979918
	speed: 0.0963s/iter; left time: 1849.6531s
	iters: 400, epoch: 3 | loss: 0.2828436
	speed: 0.0967s/iter; left time: 1848.8779s
	iters: 500, epoch: 3 | loss: 0.2676383
	speed: 0.0949s/iter; left time: 1804.7406s
	iters: 600, epoch: 3 | loss: 0.1995548
	speed: 0.0955s/iter; left time: 1805.5063s
	iters: 700, epoch: 3 | loss: 0.2343911
	speed: 0.0962s/iter; left time: 1809.2781s
	iters: 800, epoch: 3 | loss: 0.2586609
	speed: 0.0965s/iter; left time: 1806.2337s
	iters: 900, epoch: 3 | loss: 0.2447570
	speed: 0.0956s/iter; left time: 1780.0772s
	iters: 1000, epoch: 3 | loss: 0.2678975
	speed: 0.0967s/iter; left time: 1789.7689s
Epoch: 3 cost time: 104.1681125164032
Epoch: 3, Steps: 1084 | Train Loss: 0.2578591 Vali Loss: 0.2108676 Test Loss: 0.2431081
Validation loss decreased (0.267236 --> 0.210868).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.2100368
	speed: 0.3987s/iter; left time: 7308.6163s
	iters: 200, epoch: 4 | loss: 0.1969555
	speed: 0.0992s/iter; left time: 1807.8058s
	iters: 300, epoch: 4 | loss: 0.2292026
	speed: 0.0967s/iter; left time: 1752.5391s
	iters: 400, epoch: 4 | loss: 0.2339893
	speed: 0.0958s/iter; left time: 1727.4793s
	iters: 500, epoch: 4 | loss: 0.2575420
	speed: 0.0959s/iter; left time: 1718.7838s
	iters: 600, epoch: 4 | loss: 0.2226930
	speed: 0.0966s/iter; left time: 1722.0896s
	iters: 700, epoch: 4 | loss: 0.1935239
	speed: 0.0960s/iter; left time: 1702.2691s
	iters: 800, epoch: 4 | loss: 0.1959664
	speed: 0.0949s/iter; left time: 1673.3954s
	iters: 900, epoch: 4 | loss: 0.2306495
	speed: 0.0961s/iter; left time: 1685.3634s
	iters: 1000, epoch: 4 | loss: 0.2161516
	speed: 0.0968s/iter; left time: 1686.8211s
Epoch: 4 cost time: 105.26142024993896
Epoch: 4, Steps: 1084 | Train Loss: 0.2345874 Vali Loss: 0.1951972 Test Loss: 0.2282417
Validation loss decreased (0.210868 --> 0.195197).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.2130405
	speed: 0.4009s/iter; left time: 6914.2655s
	iters: 200, epoch: 5 | loss: 0.2112186
	speed: 0.0984s/iter; left time: 1686.5861s
	iters: 300, epoch: 5 | loss: 0.2029437
	speed: 0.0950s/iter; left time: 1619.1793s
	iters: 400, epoch: 5 | loss: 0.2266896
	speed: 0.0960s/iter; left time: 1626.5789s
	iters: 500, epoch: 5 | loss: 0.1980565
	speed: 0.0960s/iter; left time: 1616.6171s
	iters: 600, epoch: 5 | loss: 0.2223327
	speed: 0.0956s/iter; left time: 1601.5624s
	iters: 700, epoch: 5 | loss: 0.2370147
	speed: 0.0951s/iter; left time: 1582.5479s
	iters: 800, epoch: 5 | loss: 0.2167496
	speed: 0.0954s/iter; left time: 1578.4685s
	iters: 900, epoch: 5 | loss: 0.2191614
	speed: 0.0953s/iter; left time: 1566.9040s
	iters: 1000, epoch: 5 | loss: 0.2163818
	speed: 0.0960s/iter; left time: 1568.8194s
Epoch: 5 cost time: 104.36992287635803
Epoch: 5, Steps: 1084 | Train Loss: 0.2236700 Vali Loss: 0.1859775 Test Loss: 0.2156919
Validation loss decreased (0.195197 --> 0.185978).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.1882322
	speed: 0.3949s/iter; left time: 6382.1235s
	iters: 200, epoch: 6 | loss: 0.2414407
	speed: 0.0958s/iter; left time: 1537.9626s
	iters: 300, epoch: 6 | loss: 0.2228634
	speed: 0.0970s/iter; left time: 1547.5053s
	iters: 400, epoch: 6 | loss: 0.1977780
	speed: 0.0964s/iter; left time: 1528.4750s
	iters: 500, epoch: 6 | loss: 0.1982118
	speed: 0.0960s/iter; left time: 1512.7715s
	iters: 600, epoch: 6 | loss: 0.2323496
	speed: 0.0976s/iter; left time: 1527.9009s
	iters: 700, epoch: 6 | loss: 0.2148198
	speed: 0.0963s/iter; left time: 1497.7602s
	iters: 800, epoch: 6 | loss: 0.2212454
	speed: 0.0977s/iter; left time: 1510.6852s
	iters: 900, epoch: 6 | loss: 0.2073549
	speed: 0.0981s/iter; left time: 1507.4109s
	iters: 1000, epoch: 6 | loss: 0.2290172
	speed: 0.0972s/iter; left time: 1483.3698s
Epoch: 6 cost time: 105.19667148590088
Epoch: 6, Steps: 1084 | Train Loss: 0.2177284 Vali Loss: 0.1834645 Test Loss: 0.2128619
Validation loss decreased (0.185978 --> 0.183464).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.2395230
	speed: 0.3994s/iter; left time: 6022.3118s
	iters: 200, epoch: 7 | loss: 0.1956586
	speed: 0.0966s/iter; left time: 1446.7765s
	iters: 300, epoch: 7 | loss: 0.2613936
	speed: 0.0965s/iter; left time: 1435.5376s
	iters: 400, epoch: 7 | loss: 0.2340111
	speed: 0.0959s/iter; left time: 1417.1466s
	iters: 500, epoch: 7 | loss: 0.1916309
	speed: 0.0954s/iter; left time: 1399.9058s
	iters: 600, epoch: 7 | loss: 0.1864159
	speed: 0.0963s/iter; left time: 1403.6133s
	iters: 700, epoch: 7 | loss: 0.2299990
	speed: 0.0963s/iter; left time: 1394.3237s
	iters: 800, epoch: 7 | loss: 0.1989386
	speed: 0.0996s/iter; left time: 1432.3196s
	iters: 900, epoch: 7 | loss: 0.1929047
	speed: 0.0982s/iter; left time: 1401.8033s
	iters: 1000, epoch: 7 | loss: 0.2091528
	speed: 0.0997s/iter; left time: 1413.2357s
Epoch: 7 cost time: 105.92208981513977
Epoch: 7, Steps: 1084 | Train Loss: 0.2144771 Vali Loss: 0.1794265 Test Loss: 0.2096870
Validation loss decreased (0.183464 --> 0.179427).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.2154166
	speed: 0.3976s/iter; left time: 5562.9418s
	iters: 200, epoch: 8 | loss: 0.1869676
	speed: 0.0953s/iter; left time: 1323.7440s
	iters: 300, epoch: 8 | loss: 0.2251340
	speed: 0.0952s/iter; left time: 1312.4625s
	iters: 400, epoch: 8 | loss: 0.2227051
	speed: 0.0962s/iter; left time: 1317.3600s
	iters: 500, epoch: 8 | loss: 0.2105858
	speed: 0.0958s/iter; left time: 1302.8708s
	iters: 600, epoch: 8 | loss: 0.2067948
	speed: 0.0961s/iter; left time: 1297.0474s
	iters: 700, epoch: 8 | loss: 0.2151346
	speed: 0.0950s/iter; left time: 1271.7621s
	iters: 800, epoch: 8 | loss: 0.1950995
	speed: 0.0952s/iter; left time: 1265.0722s
	iters: 900, epoch: 8 | loss: 0.1879522
	speed: 0.0950s/iter; left time: 1253.5155s
	iters: 1000, epoch: 8 | loss: 0.2253671
	speed: 0.0963s/iter; left time: 1261.2996s
Epoch: 8 cost time: 103.91571354866028
Epoch: 8, Steps: 1084 | Train Loss: 0.2126489 Vali Loss: 0.1784265 Test Loss: 0.2072021
Validation loss decreased (0.179427 --> 0.178427).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.2207128
	speed: 0.3958s/iter; left time: 5109.6287s
	iters: 200, epoch: 9 | loss: 0.2081085
	speed: 0.0959s/iter; left time: 1228.1433s
	iters: 300, epoch: 9 | loss: 0.2341801
	speed: 0.0966s/iter; left time: 1227.9799s
	iters: 400, epoch: 9 | loss: 0.1943916
	speed: 0.0968s/iter; left time: 1220.3458s
	iters: 500, epoch: 9 | loss: 0.2189640
	speed: 0.0958s/iter; left time: 1198.2637s
	iters: 600, epoch: 9 | loss: 0.2024402
	speed: 0.0992s/iter; left time: 1231.1702s
	iters: 700, epoch: 9 | loss: 0.2436683
	speed: 0.0983s/iter; left time: 1210.2656s
	iters: 800, epoch: 9 | loss: 0.2055782
	speed: 0.0976s/iter; left time: 1191.9911s
	iters: 900, epoch: 9 | loss: 0.1933735
	speed: 0.0973s/iter; left time: 1178.1432s
	iters: 1000, epoch: 9 | loss: 0.2242840
	speed: 0.0978s/iter; left time: 1174.9444s
Epoch: 9 cost time: 105.85629463195801
Epoch: 9, Steps: 1084 | Train Loss: 0.2116833 Vali Loss: 0.1775769 Test Loss: 0.2070915
Validation loss decreased (0.178427 --> 0.177577).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.1956257
	speed: 0.4002s/iter; left time: 4732.7111s
	iters: 200, epoch: 10 | loss: 0.2280495
	speed: 0.0960s/iter; left time: 1125.9261s
	iters: 300, epoch: 10 | loss: 0.2101518
	speed: 0.0960s/iter; left time: 1116.5539s
	iters: 400, epoch: 10 | loss: 0.2083882
	speed: 0.0961s/iter; left time: 1107.2501s
	iters: 500, epoch: 10 | loss: 0.2922137
	speed: 0.0969s/iter; left time: 1106.7522s
	iters: 600, epoch: 10 | loss: 0.1972521
	speed: 0.0969s/iter; left time: 1097.1365s
	iters: 700, epoch: 10 | loss: 0.2042831
	speed: 0.0975s/iter; left time: 1094.2557s
	iters: 800, epoch: 10 | loss: 0.2182584
	speed: 0.0970s/iter; left time: 1079.2501s
	iters: 900, epoch: 10 | loss: 0.1944472
	speed: 0.0970s/iter; left time: 1069.4363s
	iters: 1000, epoch: 10 | loss: 0.2344576
	speed: 0.0966s/iter; left time: 1054.8942s
Epoch: 10 cost time: 104.94872951507568
Epoch: 10, Steps: 1084 | Train Loss: 0.2111930 Vali Loss: 0.1771495 Test Loss: 0.2067475
Validation loss decreased (0.177577 --> 0.177150).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.1804940
	speed: 0.3936s/iter; left time: 4227.7248s
	iters: 200, epoch: 11 | loss: 0.2166926
	speed: 0.0953s/iter; left time: 1014.4169s
	iters: 300, epoch: 11 | loss: 0.2089902
	speed: 0.0955s/iter; left time: 1006.1656s
	iters: 400, epoch: 11 | loss: 0.1905834
	speed: 0.0967s/iter; left time: 1009.4358s
	iters: 500, epoch: 11 | loss: 0.1940330
	speed: 0.0957s/iter; left time: 989.4909s
	iters: 600, epoch: 11 | loss: 0.2813165
	speed: 0.0961s/iter; left time: 984.1715s
	iters: 700, epoch: 11 | loss: 0.2069905
	speed: 0.0953s/iter; left time: 966.3382s
	iters: 800, epoch: 11 | loss: 0.2217309
	speed: 0.1030s/iter; left time: 1034.6081s
	iters: 900, epoch: 11 | loss: 0.2118237
	speed: 0.1073s/iter; left time: 1066.8606s
	iters: 1000, epoch: 11 | loss: 0.2285314
	speed: 0.1075s/iter; left time: 1058.3047s
Epoch: 11 cost time: 107.10810041427612
Epoch: 11, Steps: 1084 | Train Loss: 0.2109029 Vali Loss: 0.1769588 Test Loss: 0.2065602
Validation loss decreased (0.177150 --> 0.176959).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.2026736
	speed: 0.3947s/iter; left time: 3811.3182s
	iters: 200, epoch: 12 | loss: 0.1789057
	speed: 0.0963s/iter; left time: 920.0130s
	iters: 300, epoch: 12 | loss: 0.2165936
	speed: 0.0974s/iter; left time: 921.4946s
	iters: 400, epoch: 12 | loss: 0.2300336
	speed: 0.0973s/iter; left time: 910.2912s
	iters: 500, epoch: 12 | loss: 0.1914626
	speed: 0.0988s/iter; left time: 914.8924s
	iters: 600, epoch: 12 | loss: 0.1970276
	speed: 0.0981s/iter; left time: 898.5678s
	iters: 700, epoch: 12 | loss: 0.1945843
	speed: 0.0976s/iter; left time: 884.3011s
	iters: 800, epoch: 12 | loss: 0.1923083
	speed: 0.1000s/iter; left time: 895.9709s
	iters: 900, epoch: 12 | loss: 0.2283161
	speed: 0.1050s/iter; left time: 930.3046s
	iters: 1000, epoch: 12 | loss: 0.2228516
	speed: 0.0974s/iter; left time: 852.5295s
Epoch: 12 cost time: 106.75813889503479
Epoch: 12, Steps: 1084 | Train Loss: 0.2107305 Vali Loss: 0.1769640 Test Loss: 0.2065420
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.2243334
	speed: 0.3733s/iter; left time: 3200.5340s
	iters: 200, epoch: 13 | loss: 0.2098720
	speed: 0.0953s/iter; left time: 807.6331s
	iters: 300, epoch: 13 | loss: 0.2086508
	speed: 0.0984s/iter; left time: 824.0098s
	iters: 400, epoch: 13 | loss: 0.2151702
	speed: 0.0968s/iter; left time: 800.9710s
	iters: 500, epoch: 13 | loss: 0.1750382
	speed: 0.0982s/iter; left time: 802.3832s
	iters: 600, epoch: 13 | loss: 0.1934184
	speed: 0.1007s/iter; left time: 812.8062s
	iters: 700, epoch: 13 | loss: 0.2169147
	speed: 0.1011s/iter; left time: 806.2765s
	iters: 800, epoch: 13 | loss: 0.2181092
	speed: 0.1028s/iter; left time: 809.5475s
	iters: 900, epoch: 13 | loss: 0.1907607
	speed: 0.0976s/iter; left time: 758.9512s
	iters: 1000, epoch: 13 | loss: 0.2047342
	speed: 0.0950s/iter; left time: 728.5541s
Epoch: 13 cost time: 106.27006387710571
Epoch: 13, Steps: 1084 | Train Loss: 0.2106735 Vali Loss: 0.1768735 Test Loss: 0.2065283
Validation loss decreased (0.176959 --> 0.176874).  Saving model ...
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.1904635
	speed: 0.3940s/iter; left time: 2950.5802s
	iters: 200, epoch: 14 | loss: 0.2367292
	speed: 0.0956s/iter; left time: 706.5480s
	iters: 300, epoch: 14 | loss: 0.2103921
	speed: 0.0953s/iter; left time: 694.7929s
	iters: 400, epoch: 14 | loss: 0.1778764
	speed: 0.0956s/iter; left time: 687.4705s
	iters: 500, epoch: 14 | loss: 0.2206967
	speed: 0.0955s/iter; left time: 676.7552s
	iters: 600, epoch: 14 | loss: 0.2021917
	speed: 0.0966s/iter; left time: 675.1812s
	iters: 700, epoch: 14 | loss: 0.2283158
	speed: 0.0952s/iter; left time: 655.8972s
	iters: 800, epoch: 14 | loss: 0.1920870
	speed: 0.0947s/iter; left time: 643.1866s
	iters: 900, epoch: 14 | loss: 0.1983778
	speed: 0.0953s/iter; left time: 637.6231s
	iters: 1000, epoch: 14 | loss: 0.2338045
	speed: 0.0966s/iter; left time: 636.3084s
Epoch: 14 cost time: 103.93499994277954
Epoch: 14, Steps: 1084 | Train Loss: 0.2106284 Vali Loss: 0.1768875 Test Loss: 0.2064988
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.2156430
	speed: 0.3728s/iter; left time: 2388.0306s
	iters: 200, epoch: 15 | loss: 0.2048560
	speed: 0.0971s/iter; left time: 612.4901s
	iters: 300, epoch: 15 | loss: 0.1765987
	speed: 0.0970s/iter; left time: 601.9878s
	iters: 400, epoch: 15 | loss: 0.2000601
	speed: 0.0979s/iter; left time: 597.5803s
	iters: 500, epoch: 15 | loss: 0.2124665
	speed: 0.0967s/iter; left time: 580.4262s
	iters: 600, epoch: 15 | loss: 0.1978788
	speed: 0.0972s/iter; left time: 574.1967s
	iters: 700, epoch: 15 | loss: 0.2129023
	speed: 0.0988s/iter; left time: 573.6729s
	iters: 800, epoch: 15 | loss: 0.2134602
	speed: 0.0963s/iter; left time: 549.1477s
	iters: 900, epoch: 15 | loss: 0.2163617
	speed: 0.0967s/iter; left time: 542.2360s
	iters: 1000, epoch: 15 | loss: 0.2134875
	speed: 0.0953s/iter; left time: 524.8922s
Epoch: 15 cost time: 104.9242935180664
Epoch: 15, Steps: 1084 | Train Loss: 0.2105885 Vali Loss: 0.1768522 Test Loss: 0.2064903
Validation loss decreased (0.176874 --> 0.176852).  Saving model ...
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.2685127
	speed: 0.3925s/iter; left time: 2088.3644s
	iters: 200, epoch: 16 | loss: 0.2281727
	speed: 0.0989s/iter; left time: 516.5476s
	iters: 300, epoch: 16 | loss: 0.2121798
	speed: 0.0998s/iter; left time: 511.2555s
	iters: 400, epoch: 16 | loss: 0.1973358
	speed: 0.1009s/iter; left time: 506.7590s
	iters: 500, epoch: 16 | loss: 0.2162659
	speed: 0.1021s/iter; left time: 502.2094s
	iters: 600, epoch: 16 | loss: 0.1803163
	speed: 0.1004s/iter; left time: 484.0081s
	iters: 700, epoch: 16 | loss: 0.1976033
	speed: 0.0985s/iter; left time: 464.9587s
	iters: 800, epoch: 16 | loss: 0.2218580
	speed: 0.0952s/iter; left time: 439.8955s
	iters: 900, epoch: 16 | loss: 0.1969960
	speed: 0.0964s/iter; left time: 435.7214s
	iters: 1000, epoch: 16 | loss: 0.2299985
	speed: 0.0950s/iter; left time: 419.8122s
Epoch: 16 cost time: 106.61084198951721
Epoch: 16, Steps: 1084 | Train Loss: 0.2105717 Vali Loss: 0.1768271 Test Loss: 0.2064891
Validation loss decreased (0.176852 --> 0.176827).  Saving model ...
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 17 | loss: 0.1989180
	speed: 0.3965s/iter; left time: 1680.1510s
	iters: 200, epoch: 17 | loss: 0.2191972
	speed: 0.0959s/iter; left time: 396.6845s
	iters: 300, epoch: 17 | loss: 0.1968309
	speed: 0.0956s/iter; left time: 386.0870s
	iters: 400, epoch: 17 | loss: 0.2034067
	speed: 0.0965s/iter; left time: 379.9471s
	iters: 500, epoch: 17 | loss: 0.1978141
	speed: 0.0964s/iter; left time: 369.7492s
	iters: 600, epoch: 17 | loss: 0.2014657
	speed: 0.0968s/iter; left time: 361.6222s
	iters: 700, epoch: 17 | loss: 0.1747486
	speed: 0.0954s/iter; left time: 347.0313s
	iters: 800, epoch: 17 | loss: 0.2003576
	speed: 0.0953s/iter; left time: 337.0764s
	iters: 900, epoch: 17 | loss: 0.2141864
	speed: 0.0958s/iter; left time: 329.2779s
	iters: 1000, epoch: 17 | loss: 0.1909324
	speed: 0.0964s/iter; left time: 321.5984s
Epoch: 17 cost time: 104.32365822792053
Epoch: 17, Steps: 1084 | Train Loss: 0.2106043 Vali Loss: 0.1768018 Test Loss: 0.2064884
Validation loss decreased (0.176827 --> 0.176802).  Saving model ...
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 18 | loss: 0.1919420
	speed: 0.3999s/iter; left time: 1260.9981s
	iters: 200, epoch: 18 | loss: 0.2226884
	speed: 0.0983s/iter; left time: 299.9754s
	iters: 300, epoch: 18 | loss: 0.2184659
	speed: 0.0979s/iter; left time: 289.1278s
	iters: 400, epoch: 18 | loss: 0.2038648
	speed: 0.0987s/iter; left time: 281.5080s
	iters: 500, epoch: 18 | loss: 0.2089490
	speed: 0.0981s/iter; left time: 269.9811s
	iters: 600, epoch: 18 | loss: 0.2098283
	speed: 0.0954s/iter; left time: 252.9780s
	iters: 700, epoch: 18 | loss: 0.1846326
	speed: 0.0947s/iter; left time: 241.6551s
	iters: 800, epoch: 18 | loss: 0.2236156
	speed: 0.0959s/iter; left time: 235.2995s
	iters: 900, epoch: 18 | loss: 0.2537759
	speed: 0.0966s/iter; left time: 227.2682s
	iters: 1000, epoch: 18 | loss: 0.2237603
	speed: 0.0963s/iter; left time: 216.8600s
Epoch: 18 cost time: 105.30871963500977
Epoch: 18, Steps: 1084 | Train Loss: 0.2105868 Vali Loss: 0.1767799 Test Loss: 0.2064887
Validation loss decreased (0.176802 --> 0.176780).  Saving model ...
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 19 | loss: 0.2142393
	speed: 0.3994s/iter; left time: 826.4461s
	iters: 200, epoch: 19 | loss: 0.1922404
	speed: 0.0997s/iter; left time: 196.2233s
	iters: 300, epoch: 19 | loss: 0.1998127
	speed: 0.0998s/iter; left time: 186.5020s
	iters: 400, epoch: 19 | loss: 0.2053948
	speed: 0.1002s/iter; left time: 177.2943s
	iters: 500, epoch: 19 | loss: 0.1937582
	speed: 0.0967s/iter; left time: 161.3548s
	iters: 600, epoch: 19 | loss: 0.2046110
	speed: 0.0963s/iter; left time: 151.0305s
	iters: 700, epoch: 19 | loss: 0.2459128
	speed: 0.0959s/iter; left time: 140.9418s
	iters: 800, epoch: 19 | loss: 0.2493324
	speed: 0.0952s/iter; left time: 130.2949s
	iters: 900, epoch: 19 | loss: 0.2433740
	speed: 0.0950s/iter; left time: 120.6064s
	iters: 1000, epoch: 19 | loss: 0.2154482
	speed: 0.0947s/iter; left time: 110.6571s
Epoch: 19 cost time: 105.45698642730713
Epoch: 19, Steps: 1084 | Train Loss: 0.2105759 Vali Loss: 0.1768440 Test Loss: 0.2064887
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.9073486328125e-08
	iters: 100, epoch: 20 | loss: 0.1798819
	speed: 0.3709s/iter; left time: 365.2929s
	iters: 200, epoch: 20 | loss: 0.1942992
	speed: 0.0962s/iter; left time: 85.0971s
	iters: 300, epoch: 20 | loss: 0.1947353
	speed: 0.0951s/iter; left time: 74.6664s
	iters: 400, epoch: 20 | loss: 0.2279470
	speed: 0.0950s/iter; left time: 65.1038s
	iters: 500, epoch: 20 | loss: 0.1980470
	speed: 0.0951s/iter; left time: 55.6367s
	iters: 600, epoch: 20 | loss: 0.2408566
	speed: 0.0960s/iter; left time: 46.5700s
	iters: 700, epoch: 20 | loss: 0.2167704
	speed: 0.0967s/iter; left time: 37.2350s
	iters: 800, epoch: 20 | loss: 0.2214443
	speed: 0.0964s/iter; left time: 27.4615s
	iters: 900, epoch: 20 | loss: 0.2133476
	speed: 0.0968s/iter; left time: 17.9048s
	iters: 1000, epoch: 20 | loss: 0.2010077
	speed: 0.0962s/iter; left time: 8.1751s
Epoch: 20 cost time: 104.05785822868347
Epoch: 20, Steps: 1084 | Train Loss: 0.2105764 Vali Loss: 0.1769271 Test Loss: 0.2064886
EarlyStopping counter: 2 out of 5
Updating learning rate to 9.5367431640625e-09
>>>>>>>testing : Electricity_336_720_NLinear_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed12890<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4541
mse:0.2064010351896286, mae:0.2930176258087158
