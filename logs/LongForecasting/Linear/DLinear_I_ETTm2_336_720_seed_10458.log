Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='DLinear', model_id='ETTm2_336_720', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=720, root_path='./dataset/', save_pred_values=False, seed=10458, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTm2_336_720_DLinear_ETTm2_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed10458>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33505
val 10801
test 10801
	iters: 100, epoch: 1 | loss: 0.6016968
	speed: 0.0355s/iter; left time: 738.9380s
	iters: 200, epoch: 1 | loss: 0.4690570
	speed: 0.0355s/iter; left time: 736.2428s
	iters: 300, epoch: 1 | loss: 0.9744743
	speed: 0.0365s/iter; left time: 754.1884s
	iters: 400, epoch: 1 | loss: 0.5742447
	speed: 0.0371s/iter; left time: 762.6090s
	iters: 500, epoch: 1 | loss: 0.4980358
	speed: 0.0380s/iter; left time: 777.4632s
	iters: 600, epoch: 1 | loss: 0.7458160
	speed: 0.0382s/iter; left time: 776.2801s
	iters: 700, epoch: 1 | loss: 0.5142660
	speed: 0.0351s/iter; left time: 710.1924s
	iters: 800, epoch: 1 | loss: 0.6796216
	speed: 0.0370s/iter; left time: 744.9846s
	iters: 900, epoch: 1 | loss: 0.7362370
	speed: 0.0352s/iter; left time: 706.1721s
	iters: 1000, epoch: 1 | loss: 0.9764844
	speed: 0.0379s/iter; left time: 756.5155s
Epoch: 1 cost time: 38.4369535446167
Epoch: 1, Steps: 1047 | Train Loss: 0.7698182 Vali Loss: 0.6417007 Test Loss: 1.2914460
Validation loss decreased (inf --> 0.641701).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.6413312
	speed: 0.1208s/iter; left time: 2391.8140s
	iters: 200, epoch: 2 | loss: 0.9425738
	speed: 0.0358s/iter; left time: 705.0135s
	iters: 300, epoch: 2 | loss: 1.1290876
	speed: 0.0377s/iter; left time: 738.1003s
	iters: 400, epoch: 2 | loss: 0.7614903
	speed: 0.0407s/iter; left time: 792.8500s
	iters: 500, epoch: 2 | loss: 0.5499418
	speed: 0.0410s/iter; left time: 794.9591s
	iters: 600, epoch: 2 | loss: 1.1686994
	speed: 0.0340s/iter; left time: 656.5788s
	iters: 700, epoch: 2 | loss: 0.5526441
	speed: 0.0347s/iter; left time: 665.7355s
	iters: 800, epoch: 2 | loss: 0.3254808
	speed: 0.0388s/iter; left time: 740.6212s
	iters: 900, epoch: 2 | loss: 0.7973658
	speed: 0.0349s/iter; left time: 662.4648s
	iters: 1000, epoch: 2 | loss: 0.9890047
	speed: 0.0351s/iter; left time: 662.5228s
Epoch: 2 cost time: 38.46202301979065
Epoch: 2, Steps: 1047 | Train Loss: 0.7766479 Vali Loss: 0.6448159 Test Loss: 1.3562052
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.4374045
	speed: 0.1132s/iter; left time: 2121.4527s
	iters: 200, epoch: 3 | loss: 0.4570588
	speed: 0.0384s/iter; left time: 715.2109s
	iters: 300, epoch: 3 | loss: 0.6885814
	speed: 0.0371s/iter; left time: 688.2766s
	iters: 400, epoch: 3 | loss: 0.3936588
	speed: 0.0365s/iter; left time: 672.5151s
	iters: 500, epoch: 3 | loss: 0.3824604
	speed: 0.0382s/iter; left time: 700.3704s
	iters: 600, epoch: 3 | loss: 0.5089556
	speed: 0.0362s/iter; left time: 660.1277s
	iters: 700, epoch: 3 | loss: 0.3569021
	speed: 0.0373s/iter; left time: 676.0992s
	iters: 800, epoch: 3 | loss: 0.7784661
	speed: 0.0391s/iter; left time: 705.3675s
	iters: 900, epoch: 3 | loss: 0.5287203
	speed: 0.0382s/iter; left time: 685.1342s
	iters: 1000, epoch: 3 | loss: 0.4131409
	speed: 0.0358s/iter; left time: 638.1104s
Epoch: 3 cost time: 38.892640113830566
Epoch: 3, Steps: 1047 | Train Loss: 0.5686330 Vali Loss: 0.4804226 Test Loss: 0.9117284
Validation loss decreased (0.641701 --> 0.480423).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.5169665
	speed: 0.1206s/iter; left time: 2134.9192s
	iters: 200, epoch: 4 | loss: 0.6061808
	speed: 0.0355s/iter; left time: 624.3342s
	iters: 300, epoch: 4 | loss: 0.3257443
	speed: 0.0378s/iter; left time: 662.0873s
	iters: 400, epoch: 4 | loss: 0.6788549
	speed: 0.0380s/iter; left time: 660.6366s
	iters: 500, epoch: 4 | loss: 0.6723100
	speed: 0.0400s/iter; left time: 692.1309s
	iters: 600, epoch: 4 | loss: 0.4720832
	speed: 0.0372s/iter; left time: 640.0120s
	iters: 700, epoch: 4 | loss: 0.4190393
	speed: 0.0373s/iter; left time: 638.4729s
	iters: 800, epoch: 4 | loss: 0.5690131
	speed: 0.0362s/iter; left time: 615.3543s
	iters: 900, epoch: 4 | loss: 0.7643434
	speed: 0.0355s/iter; left time: 600.7336s
	iters: 1000, epoch: 4 | loss: 0.6261753
	speed: 0.0349s/iter; left time: 586.5423s
Epoch: 4 cost time: 38.13596773147583
Epoch: 4, Steps: 1047 | Train Loss: 0.5104640 Vali Loss: 0.5230492 Test Loss: 1.1287944
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.4403212
	speed: 0.1115s/iter; left time: 1857.5065s
	iters: 200, epoch: 5 | loss: 0.6486383
	speed: 0.0377s/iter; left time: 624.3327s
	iters: 300, epoch: 5 | loss: 0.6780688
	speed: 0.0336s/iter; left time: 553.1768s
	iters: 400, epoch: 5 | loss: 0.8110721
	speed: 0.0361s/iter; left time: 589.9646s
	iters: 500, epoch: 5 | loss: 0.4348386
	speed: 0.0362s/iter; left time: 589.1549s
	iters: 600, epoch: 5 | loss: 0.4667409
	speed: 0.0373s/iter; left time: 601.8893s
	iters: 700, epoch: 5 | loss: 0.6503041
	speed: 0.0374s/iter; left time: 600.5674s
	iters: 800, epoch: 5 | loss: 0.3503819
	speed: 0.0380s/iter; left time: 605.6351s
	iters: 900, epoch: 5 | loss: 0.3939965
	speed: 0.0357s/iter; left time: 565.9676s
	iters: 1000, epoch: 5 | loss: 0.4433990
	speed: 0.0353s/iter; left time: 556.3873s
Epoch: 5 cost time: 37.86183786392212
Epoch: 5, Steps: 1047 | Train Loss: 0.4828639 Vali Loss: 0.4292672 Test Loss: 0.8753092
Validation loss decreased (0.480423 --> 0.429267).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.6042472
	speed: 0.1185s/iter; left time: 1849.9587s
	iters: 200, epoch: 6 | loss: 0.4574547
	speed: 0.0393s/iter; left time: 609.4311s
	iters: 300, epoch: 6 | loss: 0.4337607
	speed: 0.0380s/iter; left time: 585.0966s
	iters: 400, epoch: 6 | loss: 0.2722134
	speed: 0.0382s/iter; left time: 584.8715s
	iters: 500, epoch: 6 | loss: 0.4780129
	speed: 0.0351s/iter; left time: 533.4971s
	iters: 600, epoch: 6 | loss: 0.5371087
	speed: 0.0354s/iter; left time: 534.6696s
	iters: 700, epoch: 6 | loss: 0.5577003
	speed: 0.0352s/iter; left time: 528.8320s
	iters: 800, epoch: 6 | loss: 0.4522467
	speed: 0.0367s/iter; left time: 547.5013s
	iters: 900, epoch: 6 | loss: 0.3645205
	speed: 0.0373s/iter; left time: 552.2298s
	iters: 1000, epoch: 6 | loss: 0.3458091
	speed: 0.0343s/iter; left time: 503.7149s
Epoch: 6 cost time: 38.26600217819214
Epoch: 6, Steps: 1047 | Train Loss: 0.4670313 Vali Loss: 0.4339781 Test Loss: 0.8642264
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.4967471
	speed: 0.1176s/iter; left time: 1711.9875s
	iters: 200, epoch: 7 | loss: 0.2736694
	speed: 0.0361s/iter; left time: 521.7840s
	iters: 300, epoch: 7 | loss: 0.6223306
	speed: 0.0368s/iter; left time: 528.8105s
	iters: 400, epoch: 7 | loss: 1.0564686
	speed: 0.0358s/iter; left time: 510.7756s
	iters: 500, epoch: 7 | loss: 0.2968470
	speed: 0.0354s/iter; left time: 500.9269s
	iters: 600, epoch: 7 | loss: 0.3501276
	speed: 0.0377s/iter; left time: 529.3467s
	iters: 700, epoch: 7 | loss: 0.4706133
	speed: 0.0381s/iter; left time: 532.2551s
	iters: 800, epoch: 7 | loss: 0.3843344
	speed: 0.0382s/iter; left time: 529.2495s
	iters: 900, epoch: 7 | loss: 0.5952975
	speed: 0.0369s/iter; left time: 507.7550s
	iters: 1000, epoch: 7 | loss: 0.5652009
	speed: 0.0357s/iter; left time: 488.0955s
Epoch: 7 cost time: 38.17124319076538
Epoch: 7, Steps: 1047 | Train Loss: 0.4585154 Vali Loss: 0.4251991 Test Loss: 0.8957798
Validation loss decreased (0.429267 --> 0.425199).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.3432664
	speed: 0.1174s/iter; left time: 1586.4582s
	iters: 200, epoch: 8 | loss: 0.2987650
	speed: 0.0370s/iter; left time: 495.6919s
	iters: 300, epoch: 8 | loss: 0.3730740
	speed: 0.0348s/iter; left time: 463.7331s
	iters: 400, epoch: 8 | loss: 0.2999276
	speed: 0.0352s/iter; left time: 464.8407s
	iters: 500, epoch: 8 | loss: 0.5174888
	speed: 0.0371s/iter; left time: 486.7836s
	iters: 600, epoch: 8 | loss: 0.4698537
	speed: 0.0384s/iter; left time: 499.8436s
	iters: 700, epoch: 8 | loss: 0.4365155
	speed: 0.0404s/iter; left time: 521.2894s
	iters: 800, epoch: 8 | loss: 0.4638232
	speed: 0.0369s/iter; left time: 472.8595s
	iters: 900, epoch: 8 | loss: 0.4049036
	speed: 0.0370s/iter; left time: 470.4518s
	iters: 1000, epoch: 8 | loss: 0.5354685
	speed: 0.0332s/iter; left time: 419.0573s
Epoch: 8 cost time: 37.92919850349426
Epoch: 8, Steps: 1047 | Train Loss: 0.4540249 Vali Loss: 0.4239252 Test Loss: 0.8835761
Validation loss decreased (0.425199 --> 0.423925).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.6692652
	speed: 0.1212s/iter; left time: 1510.4293s
	iters: 200, epoch: 9 | loss: 0.6297230
	speed: 0.0348s/iter; left time: 430.1691s
	iters: 300, epoch: 9 | loss: 0.4270623
	speed: 0.0356s/iter; left time: 436.0626s
	iters: 400, epoch: 9 | loss: 0.2661764
	speed: 0.0356s/iter; left time: 432.9137s
	iters: 500, epoch: 9 | loss: 0.4290366
	speed: 0.0379s/iter; left time: 457.5757s
	iters: 600, epoch: 9 | loss: 0.5016351
	speed: 0.0383s/iter; left time: 458.5601s
	iters: 700, epoch: 9 | loss: 0.4097057
	speed: 0.0393s/iter; left time: 466.8622s
	iters: 800, epoch: 9 | loss: 0.4997460
	speed: 0.0344s/iter; left time: 404.9750s
	iters: 900, epoch: 9 | loss: 0.6470176
	speed: 0.0358s/iter; left time: 417.5291s
	iters: 1000, epoch: 9 | loss: 0.3451119
	speed: 0.0348s/iter; left time: 402.8054s
Epoch: 9 cost time: 37.76563239097595
Epoch: 9, Steps: 1047 | Train Loss: 0.4513544 Vali Loss: 0.4057138 Test Loss: 0.7972337
Validation loss decreased (0.423925 --> 0.405714).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.3432248
	speed: 0.1208s/iter; left time: 1379.6512s
	iters: 200, epoch: 10 | loss: 0.4327107
	speed: 0.0361s/iter; left time: 408.1372s
	iters: 300, epoch: 10 | loss: 0.4794266
	speed: 0.0366s/iter; left time: 410.2574s
	iters: 400, epoch: 10 | loss: 0.5976318
	speed: 0.0328s/iter; left time: 365.0552s
	iters: 500, epoch: 10 | loss: 0.6020172
	speed: 0.0349s/iter; left time: 384.3411s
	iters: 600, epoch: 10 | loss: 0.5110155
	speed: 0.0310s/iter; left time: 338.8543s
	iters: 700, epoch: 10 | loss: 0.5927024
	speed: 0.0355s/iter; left time: 383.6002s
	iters: 800, epoch: 10 | loss: 0.5338697
	speed: 0.0344s/iter; left time: 368.6030s
	iters: 900, epoch: 10 | loss: 0.2938195
	speed: 0.0354s/iter; left time: 376.1546s
	iters: 1000, epoch: 10 | loss: 0.2799723
	speed: 0.0301s/iter; left time: 317.1091s
Epoch: 10 cost time: 35.34347724914551
Epoch: 10, Steps: 1047 | Train Loss: 0.4500322 Vali Loss: 0.3822623 Test Loss: 0.7295981
Validation loss decreased (0.405714 --> 0.382262).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.2325233
	speed: 0.1117s/iter; left time: 1158.7900s
	iters: 200, epoch: 11 | loss: 0.5709209
	speed: 0.0324s/iter; left time: 332.3177s
	iters: 300, epoch: 11 | loss: 0.6981197
	speed: 0.0344s/iter; left time: 350.3757s
	iters: 400, epoch: 11 | loss: 0.2985126
	speed: 0.0313s/iter; left time: 315.3491s
	iters: 500, epoch: 11 | loss: 0.6948064
	speed: 0.0336s/iter; left time: 335.2179s
	iters: 600, epoch: 11 | loss: 0.3716177
	speed: 0.0331s/iter; left time: 327.0485s
	iters: 700, epoch: 11 | loss: 0.4078271
	speed: 0.0327s/iter; left time: 319.4968s
	iters: 800, epoch: 11 | loss: 0.4355576
	speed: 0.0338s/iter; left time: 327.1740s
	iters: 900, epoch: 11 | loss: 0.4990146
	speed: 0.0367s/iter; left time: 351.4674s
	iters: 1000, epoch: 11 | loss: 0.5105673
	speed: 0.0347s/iter; left time: 328.6542s
Epoch: 11 cost time: 34.975098848342896
Epoch: 11, Steps: 1047 | Train Loss: 0.4493354 Vali Loss: 0.4129002 Test Loss: 0.8428731
EarlyStopping counter: 1 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.2925875
	speed: 0.1115s/iter; left time: 1039.4978s
	iters: 200, epoch: 12 | loss: 0.2678172
	speed: 0.0325s/iter; left time: 299.6188s
	iters: 300, epoch: 12 | loss: 0.2720175
	speed: 0.0329s/iter; left time: 300.3589s
	iters: 400, epoch: 12 | loss: 0.7273311
	speed: 0.0311s/iter; left time: 281.0162s
	iters: 500, epoch: 12 | loss: 0.5167141
	speed: 0.0309s/iter; left time: 276.1731s
	iters: 600, epoch: 12 | loss: 0.3896211
	speed: 0.0302s/iter; left time: 266.7220s
	iters: 700, epoch: 12 | loss: 0.3726893
	speed: 0.0309s/iter; left time: 269.5122s
	iters: 800, epoch: 12 | loss: 0.4461047
	speed: 0.0309s/iter; left time: 266.8176s
	iters: 900, epoch: 12 | loss: 0.2800487
	speed: 0.0309s/iter; left time: 263.7979s
	iters: 1000, epoch: 12 | loss: 0.5331575
	speed: 0.0287s/iter; left time: 241.5477s
Epoch: 12 cost time: 32.2414186000824
Epoch: 12, Steps: 1047 | Train Loss: 0.4489061 Vali Loss: 0.4013400 Test Loss: 0.8011003
EarlyStopping counter: 2 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.3529305
	speed: 0.1042s/iter; left time: 862.4603s
	iters: 200, epoch: 13 | loss: 0.3997346
	speed: 0.0307s/iter; left time: 250.8008s
	iters: 300, epoch: 13 | loss: 0.7049306
	speed: 0.0274s/iter; left time: 221.0727s
	iters: 400, epoch: 13 | loss: 0.5102414
	speed: 0.0276s/iter; left time: 220.2404s
	iters: 500, epoch: 13 | loss: 0.4262349
	speed: 0.0279s/iter; left time: 219.7977s
	iters: 600, epoch: 13 | loss: 0.4175144
	speed: 0.0283s/iter; left time: 220.0943s
	iters: 700, epoch: 13 | loss: 0.3777124
	speed: 0.0275s/iter; left time: 211.2757s
	iters: 800, epoch: 13 | loss: 0.5249510
	speed: 0.0272s/iter; left time: 205.8670s
	iters: 900, epoch: 13 | loss: 0.2694707
	speed: 0.0277s/iter; left time: 207.2195s
	iters: 1000, epoch: 13 | loss: 0.4231896
	speed: 0.0268s/iter; left time: 197.3977s
Epoch: 13 cost time: 29.242482662200928
Epoch: 13, Steps: 1047 | Train Loss: 0.4487311 Vali Loss: 0.4070838 Test Loss: 0.8240837
EarlyStopping counter: 3 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 14 | loss: 0.4059493
	speed: 0.0987s/iter; left time: 713.5964s
	iters: 200, epoch: 14 | loss: 0.7099200
	speed: 0.0269s/iter; left time: 191.7557s
	iters: 300, epoch: 14 | loss: 0.4445086
	speed: 0.0272s/iter; left time: 191.4472s
	iters: 400, epoch: 14 | loss: 0.3513792
	speed: 0.0275s/iter; left time: 190.7733s
	iters: 500, epoch: 14 | loss: 0.4211259
	speed: 0.0287s/iter; left time: 196.1724s
	iters: 600, epoch: 14 | loss: 0.4300922
	speed: 0.0288s/iter; left time: 194.0684s
	iters: 700, epoch: 14 | loss: 0.7417754
	speed: 0.0287s/iter; left time: 190.4718s
	iters: 800, epoch: 14 | loss: 0.2438278
	speed: 0.0285s/iter; left time: 186.2064s
	iters: 900, epoch: 14 | loss: 0.4073640
	speed: 0.0285s/iter; left time: 183.1815s
	iters: 1000, epoch: 14 | loss: 0.5181118
	speed: 0.0271s/iter; left time: 171.2779s
Epoch: 14 cost time: 29.140010356903076
Epoch: 14, Steps: 1047 | Train Loss: 0.4486184 Vali Loss: 0.4073156 Test Loss: 0.8216587
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 15 | loss: 0.4140189
	speed: 0.0928s/iter; left time: 573.5999s
	iters: 200, epoch: 15 | loss: 0.3534314
	speed: 0.0265s/iter; left time: 160.9478s
	iters: 300, epoch: 15 | loss: 0.3746659
	speed: 0.0205s/iter; left time: 122.9098s
	iters: 400, epoch: 15 | loss: 0.9514408
	speed: 0.0199s/iter; left time: 116.8082s
	iters: 500, epoch: 15 | loss: 0.5661406
	speed: 0.0198s/iter; left time: 114.5395s
	iters: 600, epoch: 15 | loss: 0.4732642
	speed: 0.0197s/iter; left time: 112.1646s
	iters: 700, epoch: 15 | loss: 0.5417832
	speed: 0.0196s/iter; left time: 109.5746s
	iters: 800, epoch: 15 | loss: 0.3463325
	speed: 0.0196s/iter; left time: 107.5151s
	iters: 900, epoch: 15 | loss: 0.3321563
	speed: 0.0196s/iter; left time: 105.6359s
	iters: 1000, epoch: 15 | loss: 0.3848354
	speed: 0.0230s/iter; left time: 121.6271s
Epoch: 15 cost time: 22.4691002368927
Epoch: 15, Steps: 1047 | Train Loss: 0.4485616 Vali Loss: 0.4072315 Test Loss: 0.8217667
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTm2_336_720_DLinear_ETTm2_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed10458<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10801
mse:0.7301745414733887, mae:0.5581973791122437
