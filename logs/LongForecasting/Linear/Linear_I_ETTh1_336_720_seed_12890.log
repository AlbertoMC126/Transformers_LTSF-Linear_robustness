Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTh1', data_path='ETTh1.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='Linear', model_id='ETTh1_336_720', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=720, root_path='./dataset/', save_pred_values=False, seed=12890, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTh1_336_720_Linear_ETTh1_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed12890>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7585
val 2161
test 2161
	iters: 100, epoch: 1 | loss: 0.5766972
	speed: 0.0183s/iter; left time: 85.1006s
	iters: 200, epoch: 1 | loss: 0.5681298
	speed: 0.0170s/iter; left time: 77.3238s
Epoch: 1 cost time: 4.16712212562561
Epoch: 1, Steps: 237 | Train Loss: 0.6009549 Vali Loss: 1.4354652 Test Loss: 0.5590541
Validation loss decreased (inf --> 1.435465).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.6281673
	speed: 0.0312s/iter; left time: 137.4356s
	iters: 200, epoch: 2 | loss: 0.5606841
	speed: 0.0160s/iter; left time: 69.0442s
Epoch: 2 cost time: 4.005763292312622
Epoch: 2, Steps: 237 | Train Loss: 0.5718819 Vali Loss: 1.4665480 Test Loss: 0.5621597
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.4285484
	speed: 0.0310s/iter; left time: 129.2148s
	iters: 200, epoch: 3 | loss: 0.5071942
	speed: 0.0199s/iter; left time: 80.8659s
Epoch: 3 cost time: 4.23731255531311
Epoch: 3, Steps: 237 | Train Loss: 0.5222258 Vali Loss: 1.3166349 Test Loss: 0.5368088
Validation loss decreased (1.435465 --> 1.316635).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.4793628
	speed: 0.0321s/iter; left time: 126.1417s
	iters: 200, epoch: 4 | loss: 0.4792094
	speed: 0.0191s/iter; left time: 73.1619s
Epoch: 4 cost time: 4.384177923202515
Epoch: 4, Steps: 237 | Train Loss: 0.5007820 Vali Loss: 1.2874597 Test Loss: 0.4956556
Validation loss decreased (1.316635 --> 1.287460).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.5745128
	speed: 0.0297s/iter; left time: 109.6950s
	iters: 200, epoch: 5 | loss: 0.5085602
	speed: 0.0166s/iter; left time: 59.7670s
Epoch: 5 cost time: 3.9486589431762695
Epoch: 5, Steps: 237 | Train Loss: 0.4896408 Vali Loss: 1.2652730 Test Loss: 0.5011360
Validation loss decreased (1.287460 --> 1.265273).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.5168007
	speed: 0.0282s/iter; left time: 97.3974s
	iters: 200, epoch: 6 | loss: 0.4837733
	speed: 0.0172s/iter; left time: 57.6291s
Epoch: 6 cost time: 3.8146963119506836
Epoch: 6, Steps: 237 | Train Loss: 0.4840660 Vali Loss: 1.2559805 Test Loss: 0.4930385
Validation loss decreased (1.265273 --> 1.255980).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.4980274
	speed: 0.0347s/iter; left time: 111.7001s
	iters: 200, epoch: 7 | loss: 0.4614759
	speed: 0.0193s/iter; left time: 60.0900s
Epoch: 7 cost time: 4.471457481384277
Epoch: 7, Steps: 237 | Train Loss: 0.4809283 Vali Loss: 1.2512180 Test Loss: 0.4884073
Validation loss decreased (1.255980 --> 1.251218).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.4020077
	speed: 0.0354s/iter; left time: 105.6243s
	iters: 200, epoch: 8 | loss: 0.4572291
	speed: 0.0202s/iter; left time: 58.3401s
Epoch: 8 cost time: 4.567540884017944
Epoch: 8, Steps: 237 | Train Loss: 0.4791876 Vali Loss: 1.2501750 Test Loss: 0.4893960
Validation loss decreased (1.251218 --> 1.250175).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.4850334
	speed: 0.0341s/iter; left time: 93.4824s
	iters: 200, epoch: 9 | loss: 0.4355482
	speed: 0.0169s/iter; left time: 44.7959s
Epoch: 9 cost time: 4.124768257141113
Epoch: 9, Steps: 237 | Train Loss: 0.4783223 Vali Loss: 1.2414272 Test Loss: 0.4896704
Validation loss decreased (1.250175 --> 1.241427).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.4976495
	speed: 0.0308s/iter; left time: 77.3605s
	iters: 200, epoch: 10 | loss: 0.4669687
	speed: 0.0196s/iter; left time: 47.0866s
Epoch: 10 cost time: 4.2706005573272705
Epoch: 10, Steps: 237 | Train Loss: 0.4778143 Vali Loss: 1.2417034 Test Loss: 0.4868097
EarlyStopping counter: 1 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.4429490
	speed: 0.0326s/iter; left time: 73.9662s
	iters: 200, epoch: 11 | loss: 0.4190979
	speed: 0.0195s/iter; left time: 42.3348s
Epoch: 11 cost time: 4.4099273681640625
Epoch: 11, Steps: 237 | Train Loss: 0.4775983 Vali Loss: 1.2424467 Test Loss: 0.4877301
EarlyStopping counter: 2 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.4172793
	speed: 0.0326s/iter; left time: 66.2847s
	iters: 200, epoch: 12 | loss: 0.5385904
	speed: 0.0185s/iter; left time: 35.7905s
Epoch: 12 cost time: 4.362438440322876
Epoch: 12, Steps: 237 | Train Loss: 0.4774084 Vali Loss: 1.2418388 Test Loss: 0.4874814
EarlyStopping counter: 3 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.4767473
	speed: 0.0330s/iter; left time: 59.3277s
	iters: 200, epoch: 13 | loss: 0.4448686
	speed: 0.0162s/iter; left time: 27.4384s
Epoch: 13 cost time: 3.9281575679779053
Epoch: 13, Steps: 237 | Train Loss: 0.4772642 Vali Loss: 1.2421229 Test Loss: 0.4873715
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.4566703
	speed: 0.0300s/iter; left time: 46.8736s
	iters: 200, epoch: 14 | loss: 0.5160574
	speed: 0.0143s/iter; left time: 20.8597s
Epoch: 14 cost time: 3.5974483489990234
Epoch: 14, Steps: 237 | Train Loss: 0.4772780 Vali Loss: 1.2435396 Test Loss: 0.4875354
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTh1_336_720_Linear_ETTh1_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed12890<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
mse:0.4887271225452423, mae:0.48797065019607544
