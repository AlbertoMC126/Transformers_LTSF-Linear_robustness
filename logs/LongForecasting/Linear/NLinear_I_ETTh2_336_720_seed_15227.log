Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTh2', data_path='ETTh2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='NLinear', model_id='ETTh2_336_720', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=720, root_path='./dataset/', save_pred_values=False, seed=15227, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTh2_336_720_NLinear_ETTh2_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15227>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7585
val 2161
test 2161
Total number of trainable parameters: 1698480
Total number of parameters: 1698480
	iters: 100, epoch: 1 | loss: 0.5234270
	speed: 0.0412s/iter; left time: 191.2347s
	iters: 200, epoch: 1 | loss: 0.6718903
	speed: 0.0429s/iter; left time: 194.6083s
Epoch: 1 cost time: 9.760675191879272
Epoch: 1, Steps: 237 | Train Loss: 0.9260145 Vali Loss: 0.6927543 Test Loss: 0.5178655
Validation loss decreased (inf --> 0.692754).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.7887155
	speed: 0.0659s/iter; left time: 290.3328s
	iters: 200, epoch: 2 | loss: 1.2687619
	speed: 0.0417s/iter; left time: 179.5147s
Epoch: 2 cost time: 9.633187532424927
Epoch: 2, Steps: 237 | Train Loss: 0.9041130 Vali Loss: 0.6961689 Test Loss: 0.4698702
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.9634374
	speed: 0.0673s/iter; left time: 280.5983s
	iters: 200, epoch: 3 | loss: 0.7984414
	speed: 0.0408s/iter; left time: 166.1341s
Epoch: 3 cost time: 9.525698184967041
Epoch: 3, Steps: 237 | Train Loss: 0.8006918 Vali Loss: 0.6541722 Test Loss: 0.4577306
Validation loss decreased (0.692754 --> 0.654172).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.8897538
	speed: 0.0682s/iter; left time: 268.2038s
	iters: 200, epoch: 4 | loss: 0.7688746
	speed: 0.0402s/iter; left time: 153.9034s
Epoch: 4 cost time: 9.5403311252594
Epoch: 4, Steps: 237 | Train Loss: 0.7684324 Vali Loss: 0.6734987 Test Loss: 0.4275262
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.8890023
	speed: 0.0677s/iter; left time: 249.8393s
	iters: 200, epoch: 5 | loss: 0.6145751
	speed: 0.0395s/iter; left time: 141.8862s
Epoch: 5 cost time: 9.574517250061035
Epoch: 5, Steps: 237 | Train Loss: 0.7568996 Vali Loss: 0.6375259 Test Loss: 0.4255939
Validation loss decreased (0.654172 --> 0.637526).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.6057407
	speed: 0.0695s/iter; left time: 240.2606s
	iters: 200, epoch: 6 | loss: 0.6375197
	speed: 0.0406s/iter; left time: 136.3515s
Epoch: 6 cost time: 9.572448253631592
Epoch: 6, Steps: 237 | Train Loss: 0.7513692 Vali Loss: 0.6420981 Test Loss: 0.4240445
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 1.0532463
	speed: 0.0671s/iter; left time: 216.0657s
	iters: 200, epoch: 7 | loss: 0.7219136
	speed: 0.0408s/iter; left time: 127.2940s
Epoch: 7 cost time: 9.567617177963257
Epoch: 7, Steps: 237 | Train Loss: 0.7481947 Vali Loss: 0.6316200 Test Loss: 0.4200865
Validation loss decreased (0.637526 --> 0.631620).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.5076280
	speed: 0.0668s/iter; left time: 199.2955s
	iters: 200, epoch: 8 | loss: 0.7767609
	speed: 0.0400s/iter; left time: 115.1437s
Epoch: 8 cost time: 9.178970098495483
Epoch: 8, Steps: 237 | Train Loss: 0.7463913 Vali Loss: 0.6374656 Test Loss: 0.4184484
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 1.0012263
	speed: 0.0649s/iter; left time: 178.1755s
	iters: 200, epoch: 9 | loss: 0.5368801
	speed: 0.0405s/iter; left time: 107.1837s
Epoch: 9 cost time: 9.229133367538452
Epoch: 9, Steps: 237 | Train Loss: 0.7450188 Vali Loss: 0.6387630 Test Loss: 0.4199768
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.8947537
	speed: 0.0601s/iter; left time: 150.8110s
	iters: 200, epoch: 10 | loss: 0.6023027
	speed: 0.0323s/iter; left time: 77.8298s
Epoch: 10 cost time: 7.864812612533569
Epoch: 10, Steps: 237 | Train Loss: 0.7443156 Vali Loss: 0.6346666 Test Loss: 0.4193235
EarlyStopping counter: 3 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.9280806
	speed: 0.0475s/iter; left time: 107.9798s
	iters: 200, epoch: 11 | loss: 0.4619497
	speed: 0.0269s/iter; left time: 58.4756s
Epoch: 11 cost time: 6.37846565246582
Epoch: 11, Steps: 237 | Train Loss: 0.7444529 Vali Loss: 0.6359286 Test Loss: 0.4187522
EarlyStopping counter: 4 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.6825649
	speed: 0.0400s/iter; left time: 81.3636s
	iters: 200, epoch: 12 | loss: 0.6655277
	speed: 0.0196s/iter; left time: 37.8244s
Epoch: 12 cost time: 4.932659387588501
Epoch: 12, Steps: 237 | Train Loss: 0.7442349 Vali Loss: 0.6359572 Test Loss: 0.4187927
EarlyStopping counter: 5 out of 5
Early stopping
Total training time: 118.4886 seconds
>>>>>>>testing : ETTh2_336_720_NLinear_ETTh2_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15227<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
mse:0.41825801134109497, mae:0.44930499792099
