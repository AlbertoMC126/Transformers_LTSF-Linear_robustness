Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='DLinear', model_id='ETTm2_336_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=336, root_path='./dataset/', save_pred_values=False, seed=15349, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTm2_336_336_DLinear_ETTm2_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15349>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33889
val 11185
test 11185
	iters: 100, epoch: 1 | loss: 0.5173000
	speed: 0.0125s/iter; left time: 263.7845s
	iters: 200, epoch: 1 | loss: 0.5208232
	speed: 0.0166s/iter; left time: 349.1312s
	iters: 300, epoch: 1 | loss: 0.9316535
	speed: 0.0162s/iter; left time: 339.1620s
	iters: 400, epoch: 1 | loss: 0.9005467
	speed: 0.0174s/iter; left time: 362.2970s
	iters: 500, epoch: 1 | loss: 1.1910411
	speed: 0.0159s/iter; left time: 328.2573s
	iters: 600, epoch: 1 | loss: 0.5402230
	speed: 0.0166s/iter; left time: 341.8976s
	iters: 700, epoch: 1 | loss: 0.5807430
	speed: 0.0167s/iter; left time: 342.7894s
	iters: 800, epoch: 1 | loss: 0.5525398
	speed: 0.0165s/iter; left time: 335.8456s
	iters: 900, epoch: 1 | loss: 0.5873467
	speed: 0.0175s/iter; left time: 355.0161s
	iters: 1000, epoch: 1 | loss: 0.7309176
	speed: 0.0175s/iter; left time: 353.4643s
Epoch: 1 cost time: 17.193187952041626
Epoch: 1, Steps: 1059 | Train Loss: 0.6849882 Vali Loss: 0.4571712 Test Loss: 0.8350083
Validation loss decreased (inf --> 0.457171).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.6316003
	speed: 0.0612s/iter; left time: 1224.9944s
	iters: 200, epoch: 2 | loss: 0.5336427
	speed: 0.0141s/iter; left time: 280.0174s
	iters: 300, epoch: 2 | loss: 0.4365267
	speed: 0.0166s/iter; left time: 328.6511s
	iters: 400, epoch: 2 | loss: 0.6790327
	speed: 0.0166s/iter; left time: 326.7218s
	iters: 500, epoch: 2 | loss: 0.9504272
	speed: 0.0172s/iter; left time: 337.1990s
	iters: 600, epoch: 2 | loss: 0.5478790
	speed: 0.0192s/iter; left time: 374.1575s
	iters: 700, epoch: 2 | loss: 0.4330210
	speed: 0.0189s/iter; left time: 366.4011s
	iters: 800, epoch: 2 | loss: 0.4861641
	speed: 0.0176s/iter; left time: 340.1556s
	iters: 900, epoch: 2 | loss: 0.7338889
	speed: 0.0181s/iter; left time: 348.0534s
	iters: 1000, epoch: 2 | loss: 0.9216529
	speed: 0.0184s/iter; left time: 351.7349s
Epoch: 2 cost time: 18.161769151687622
Epoch: 2, Steps: 1059 | Train Loss: 0.6537523 Vali Loss: 0.9832824 Test Loss: 2.1125908
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.3508535
	speed: 0.0651s/iter; left time: 1234.1250s
	iters: 200, epoch: 3 | loss: 0.6854816
	speed: 0.0157s/iter; left time: 295.4868s
	iters: 300, epoch: 3 | loss: 0.3833496
	speed: 0.0169s/iter; left time: 317.9319s
	iters: 400, epoch: 3 | loss: 0.3073663
	speed: 0.0164s/iter; left time: 305.7957s
	iters: 500, epoch: 3 | loss: 0.3566667
	speed: 0.0173s/iter; left time: 320.9155s
	iters: 600, epoch: 3 | loss: 0.5952200
	speed: 0.0174s/iter; left time: 321.3875s
	iters: 700, epoch: 3 | loss: 0.4827701
	speed: 0.0161s/iter; left time: 296.4245s
	iters: 800, epoch: 3 | loss: 0.2981068
	speed: 0.0190s/iter; left time: 346.1972s
	iters: 900, epoch: 3 | loss: 0.5504472
	speed: 0.0183s/iter; left time: 333.0359s
	iters: 1000, epoch: 3 | loss: 0.5355427
	speed: 0.0153s/iter; left time: 277.0052s
Epoch: 3 cost time: 17.788302659988403
Epoch: 3, Steps: 1059 | Train Loss: 0.4608859 Vali Loss: 0.3037417 Test Loss: 0.4921027
Validation loss decreased (0.457171 --> 0.303742).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.3048197
	speed: 0.0637s/iter; left time: 1141.2110s
	iters: 200, epoch: 4 | loss: 0.1681735
	speed: 0.0164s/iter; left time: 291.3890s
	iters: 300, epoch: 4 | loss: 0.3563539
	speed: 0.0161s/iter; left time: 285.8160s
	iters: 400, epoch: 4 | loss: 0.3973923
	speed: 0.0173s/iter; left time: 303.7752s
	iters: 500, epoch: 4 | loss: 0.2719334
	speed: 0.0177s/iter; left time: 309.9081s
	iters: 600, epoch: 4 | loss: 0.4802606
	speed: 0.0177s/iter; left time: 307.6581s
	iters: 700, epoch: 4 | loss: 0.4165594
	speed: 0.0185s/iter; left time: 319.3011s
	iters: 800, epoch: 4 | loss: 0.3476244
	speed: 0.0181s/iter; left time: 311.2974s
	iters: 900, epoch: 4 | loss: 0.3036408
	speed: 0.0171s/iter; left time: 292.2785s
	iters: 1000, epoch: 4 | loss: 0.6258441
	speed: 0.0172s/iter; left time: 292.0232s
Epoch: 4 cost time: 18.221683979034424
Epoch: 4, Steps: 1059 | Train Loss: 0.4035362 Vali Loss: 0.4115062 Test Loss: 0.8416331
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.3766041
	speed: 0.0611s/iter; left time: 1028.6619s
	iters: 200, epoch: 5 | loss: 0.2830255
	speed: 0.0163s/iter; left time: 272.4872s
	iters: 300, epoch: 5 | loss: 0.6564099
	speed: 0.0176s/iter; left time: 292.7151s
	iters: 400, epoch: 5 | loss: 0.5734579
	speed: 0.0177s/iter; left time: 292.5415s
	iters: 500, epoch: 5 | loss: 0.3735148
	speed: 0.0177s/iter; left time: 291.8493s
	iters: 600, epoch: 5 | loss: 0.3022720
	speed: 0.0176s/iter; left time: 287.1061s
	iters: 700, epoch: 5 | loss: 0.6606120
	speed: 0.0184s/iter; left time: 299.4912s
	iters: 800, epoch: 5 | loss: 0.2253084
	speed: 0.0170s/iter; left time: 275.1032s
	iters: 900, epoch: 5 | loss: 0.4021389
	speed: 0.0172s/iter; left time: 276.7649s
	iters: 1000, epoch: 5 | loss: 0.7380444
	speed: 0.0176s/iter; left time: 280.1212s
Epoch: 5 cost time: 18.277296781539917
Epoch: 5, Steps: 1059 | Train Loss: 0.3791942 Vali Loss: 0.3051266 Test Loss: 0.5635800
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.2436147
	speed: 0.0627s/iter; left time: 989.8074s
	iters: 200, epoch: 6 | loss: 0.5357268
	speed: 0.0171s/iter; left time: 268.8961s
	iters: 300, epoch: 6 | loss: 0.3195126
	speed: 0.0170s/iter; left time: 264.8300s
	iters: 400, epoch: 6 | loss: 0.2104367
	speed: 0.0182s/iter; left time: 282.2744s
	iters: 500, epoch: 6 | loss: 0.1913429
	speed: 0.0188s/iter; left time: 288.6952s
	iters: 600, epoch: 6 | loss: 0.2654688
	speed: 0.0179s/iter; left time: 274.0142s
	iters: 700, epoch: 6 | loss: 0.2512790
	speed: 0.0171s/iter; left time: 259.5663s
	iters: 800, epoch: 6 | loss: 0.2464764
	speed: 0.0157s/iter; left time: 236.2040s
	iters: 900, epoch: 6 | loss: 0.3671587
	speed: 0.0162s/iter; left time: 243.1141s
	iters: 1000, epoch: 6 | loss: 0.4839915
	speed: 0.0176s/iter; left time: 262.6549s
Epoch: 6 cost time: 18.04162621498108
Epoch: 6, Steps: 1059 | Train Loss: 0.3649544 Vali Loss: 0.2845441 Test Loss: 0.5085230
Validation loss decreased (0.303742 --> 0.284544).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.1734557
	speed: 0.0585s/iter; left time: 861.9128s
	iters: 200, epoch: 7 | loss: 0.5708362
	speed: 0.0180s/iter; left time: 262.6798s
	iters: 300, epoch: 7 | loss: 0.2465115
	speed: 0.0170s/iter; left time: 247.3545s
	iters: 400, epoch: 7 | loss: 0.5518262
	speed: 0.0172s/iter; left time: 247.6223s
	iters: 500, epoch: 7 | loss: 0.2982366
	speed: 0.0173s/iter; left time: 247.5357s
	iters: 600, epoch: 7 | loss: 0.1860953
	speed: 0.0172s/iter; left time: 245.2223s
	iters: 700, epoch: 7 | loss: 0.4758756
	speed: 0.0173s/iter; left time: 245.0120s
	iters: 800, epoch: 7 | loss: 0.3525574
	speed: 0.0172s/iter; left time: 241.2321s
	iters: 900, epoch: 7 | loss: 0.3728337
	speed: 0.0170s/iter; left time: 236.1516s
	iters: 1000, epoch: 7 | loss: 0.3304418
	speed: 0.0167s/iter; left time: 230.8992s
Epoch: 7 cost time: 18.072515964508057
Epoch: 7, Steps: 1059 | Train Loss: 0.3570201 Vali Loss: 0.2361375 Test Loss: 0.3782877
Validation loss decreased (0.284544 --> 0.236137).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.4704842
	speed: 0.0628s/iter; left time: 857.9773s
	iters: 200, epoch: 8 | loss: 0.5255985
	speed: 0.0160s/iter; left time: 216.4634s
	iters: 300, epoch: 8 | loss: 0.3805348
	speed: 0.0160s/iter; left time: 215.8374s
	iters: 400, epoch: 8 | loss: 0.2802065
	speed: 0.0162s/iter; left time: 217.0235s
	iters: 500, epoch: 8 | loss: 0.2809595
	speed: 0.0177s/iter; left time: 234.3661s
	iters: 600, epoch: 8 | loss: 0.4023912
	speed: 0.0168s/iter; left time: 220.8957s
	iters: 700, epoch: 8 | loss: 0.2157417
	speed: 0.0163s/iter; left time: 213.6335s
	iters: 800, epoch: 8 | loss: 0.3388857
	speed: 0.0158s/iter; left time: 204.4306s
	iters: 900, epoch: 8 | loss: 0.3070353
	speed: 0.0183s/iter; left time: 235.4215s
	iters: 1000, epoch: 8 | loss: 0.2223124
	speed: 0.0162s/iter; left time: 206.9443s
Epoch: 8 cost time: 17.428539752960205
Epoch: 8, Steps: 1059 | Train Loss: 0.3523847 Vali Loss: 0.3202996 Test Loss: 0.6423147
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.2950552
	speed: 0.0637s/iter; left time: 803.4929s
	iters: 200, epoch: 9 | loss: 0.2074297
	speed: 0.0156s/iter; left time: 194.8081s
	iters: 300, epoch: 9 | loss: 0.5762784
	speed: 0.0182s/iter; left time: 225.6794s
	iters: 400, epoch: 9 | loss: 0.2383109
	speed: 0.0159s/iter; left time: 195.8740s
	iters: 500, epoch: 9 | loss: 0.5288564
	speed: 0.0171s/iter; left time: 208.9617s
	iters: 600, epoch: 9 | loss: 0.2980292
	speed: 0.0176s/iter; left time: 213.4263s
	iters: 700, epoch: 9 | loss: 0.2143642
	speed: 0.0138s/iter; left time: 165.9946s
	iters: 800, epoch: 9 | loss: 0.2923823
	speed: 0.0179s/iter; left time: 212.7813s
	iters: 900, epoch: 9 | loss: 0.3119638
	speed: 0.0171s/iter; left time: 201.5903s
	iters: 1000, epoch: 9 | loss: 0.2706876
	speed: 0.0178s/iter; left time: 207.9257s
Epoch: 9 cost time: 17.486811637878418
Epoch: 9, Steps: 1059 | Train Loss: 0.3503781 Vali Loss: 0.2637259 Test Loss: 0.4632665
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.3030755
	speed: 0.0604s/iter; left time: 697.7784s
	iters: 200, epoch: 10 | loss: 0.4261984
	speed: 0.0163s/iter; left time: 186.2311s
	iters: 300, epoch: 10 | loss: 0.1568733
	speed: 0.0177s/iter; left time: 200.3903s
	iters: 400, epoch: 10 | loss: 0.2675526
	speed: 0.0172s/iter; left time: 193.2913s
	iters: 500, epoch: 10 | loss: 0.4296670
	speed: 0.0173s/iter; left time: 192.9626s
	iters: 600, epoch: 10 | loss: 0.3054110
	speed: 0.0161s/iter; left time: 178.1973s
	iters: 700, epoch: 10 | loss: 0.1667316
	speed: 0.0168s/iter; left time: 183.8870s
	iters: 800, epoch: 10 | loss: 0.3487375
	speed: 0.0167s/iter; left time: 181.1381s
	iters: 900, epoch: 10 | loss: 0.5270373
	speed: 0.0147s/iter; left time: 157.8917s
	iters: 1000, epoch: 10 | loss: 0.4531369
	speed: 0.0178s/iter; left time: 189.7020s
Epoch: 10 cost time: 17.5497887134552
Epoch: 10, Steps: 1059 | Train Loss: 0.3491294 Vali Loss: 0.3214075 Test Loss: 0.6503479
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.4454642
	speed: 0.0643s/iter; left time: 675.0404s
	iters: 200, epoch: 11 | loss: 0.1960201
	speed: 0.0156s/iter; left time: 161.5943s
	iters: 300, epoch: 11 | loss: 0.3454000
	speed: 0.0154s/iter; left time: 158.6479s
	iters: 400, epoch: 11 | loss: 0.4220634
	speed: 0.0149s/iter; left time: 151.9860s
	iters: 500, epoch: 11 | loss: 0.3106219
	speed: 0.0181s/iter; left time: 182.8285s
	iters: 600, epoch: 11 | loss: 0.2060253
	speed: 0.0172s/iter; left time: 171.8672s
	iters: 700, epoch: 11 | loss: 0.3258749
	speed: 0.0161s/iter; left time: 158.7700s
	iters: 800, epoch: 11 | loss: 0.3541787
	speed: 0.0166s/iter; left time: 162.5727s
	iters: 900, epoch: 11 | loss: 0.3623271
	speed: 0.0160s/iter; left time: 155.4889s
	iters: 1000, epoch: 11 | loss: 0.4982021
	speed: 0.0168s/iter; left time: 160.6626s
Epoch: 11 cost time: 17.135823249816895
Epoch: 11, Steps: 1059 | Train Loss: 0.3485027 Vali Loss: 0.2939725 Test Loss: 0.5658204
EarlyStopping counter: 4 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.2050021
	speed: 0.0679s/iter; left time: 640.1579s
	iters: 200, epoch: 12 | loss: 0.3978468
	speed: 0.0160s/iter; left time: 149.4330s
	iters: 300, epoch: 12 | loss: 0.3809440
	speed: 0.0159s/iter; left time: 146.8999s
	iters: 400, epoch: 12 | loss: 0.2352134
	speed: 0.0158s/iter; left time: 143.8590s
	iters: 500, epoch: 12 | loss: 0.4616061
	speed: 0.0153s/iter; left time: 138.1512s
	iters: 600, epoch: 12 | loss: 0.2941424
	speed: 0.0150s/iter; left time: 134.1793s
	iters: 700, epoch: 12 | loss: 0.1873506
	speed: 0.0151s/iter; left time: 132.9949s
	iters: 800, epoch: 12 | loss: 0.4710041
	speed: 0.0150s/iter; left time: 130.8463s
	iters: 900, epoch: 12 | loss: 0.2500009
	speed: 0.0151s/iter; left time: 130.0078s
	iters: 1000, epoch: 12 | loss: 0.3163370
	speed: 0.0142s/iter; left time: 120.8350s
Epoch: 12 cost time: 16.139593839645386
Epoch: 12, Steps: 1059 | Train Loss: 0.3480790 Vali Loss: 0.2805123 Test Loss: 0.5229712
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTm2_336_336_DLinear_ETTm2_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15349<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
mse:0.37864741683006287, mae:0.40385857224464417
