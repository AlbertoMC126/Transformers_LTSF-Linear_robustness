Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='NLinear', model_id='ETTm2_336_720', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=720, root_path='./dataset/', save_pred_values=False, seed=28649, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTm2_336_720_NLinear_ETTm2_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed28649>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33505
val 10801
test 10801
	iters: 100, epoch: 1 | loss: 1.2474716
	speed: 0.0204s/iter; left time: 424.9451s
	iters: 200, epoch: 1 | loss: 2.1177258
	speed: 0.0176s/iter; left time: 364.5289s
	iters: 300, epoch: 1 | loss: 0.5106090
	speed: 0.0201s/iter; left time: 414.0379s
	iters: 400, epoch: 1 | loss: 0.5148549
	speed: 0.0199s/iter; left time: 409.6150s
	iters: 500, epoch: 1 | loss: 0.7100423
	speed: 0.0209s/iter; left time: 427.8778s
	iters: 600, epoch: 1 | loss: 0.6681319
	speed: 0.0196s/iter; left time: 398.4400s
	iters: 700, epoch: 1 | loss: 0.3757986
	speed: 0.0193s/iter; left time: 390.4682s
	iters: 800, epoch: 1 | loss: 2.3007543
	speed: 0.0188s/iter; left time: 379.3895s
	iters: 900, epoch: 1 | loss: 0.3481198
	speed: 0.0199s/iter; left time: 398.7593s
	iters: 1000, epoch: 1 | loss: 0.8441344
	speed: 0.0205s/iter; left time: 409.5155s
Epoch: 1 cost time: 20.496896982192993
Epoch: 1, Steps: 1047 | Train Loss: 0.9326521 Vali Loss: 0.4755107 Test Loss: 0.6458174
Validation loss decreased (inf --> 0.475511).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.4712417
	speed: 0.0683s/iter; left time: 1352.4045s
	iters: 200, epoch: 2 | loss: 0.6181439
	speed: 0.0190s/iter; left time: 374.7537s
	iters: 300, epoch: 2 | loss: 1.1071023
	speed: 0.0188s/iter; left time: 368.4604s
	iters: 400, epoch: 2 | loss: 0.7919251
	speed: 0.0205s/iter; left time: 400.5630s
	iters: 500, epoch: 2 | loss: 1.0081490
	speed: 0.0203s/iter; left time: 394.6512s
	iters: 600, epoch: 2 | loss: 1.0734352
	speed: 0.0201s/iter; left time: 388.0681s
	iters: 700, epoch: 2 | loss: 0.5311598
	speed: 0.0199s/iter; left time: 382.8631s
	iters: 800, epoch: 2 | loss: 0.3819283
	speed: 0.0192s/iter; left time: 366.5723s
	iters: 900, epoch: 2 | loss: 0.6978299
	speed: 0.0192s/iter; left time: 365.0847s
	iters: 1000, epoch: 2 | loss: 1.4518166
	speed: 0.0182s/iter; left time: 343.7064s
Epoch: 2 cost time: 20.281489849090576
Epoch: 2, Steps: 1047 | Train Loss: 0.8114029 Vali Loss: 0.3585405 Test Loss: 0.5051857
Validation loss decreased (0.475511 --> 0.358540).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.6949346
	speed: 0.0659s/iter; left time: 1235.3563s
	iters: 200, epoch: 3 | loss: 0.5862880
	speed: 0.0182s/iter; left time: 339.0766s
	iters: 300, epoch: 3 | loss: 0.5983707
	speed: 0.0193s/iter; left time: 357.5502s
	iters: 400, epoch: 3 | loss: 0.7557994
	speed: 0.0186s/iter; left time: 342.9461s
	iters: 500, epoch: 3 | loss: 0.5709752
	speed: 0.0200s/iter; left time: 366.5600s
	iters: 600, epoch: 3 | loss: 0.9627603
	speed: 0.0173s/iter; left time: 315.0826s
	iters: 700, epoch: 3 | loss: 0.6271250
	speed: 0.0162s/iter; left time: 294.5428s
	iters: 800, epoch: 3 | loss: 0.4187768
	speed: 0.0189s/iter; left time: 340.6570s
	iters: 900, epoch: 3 | loss: 0.4137282
	speed: 0.0207s/iter; left time: 370.8896s
	iters: 1000, epoch: 3 | loss: 0.5610569
	speed: 0.0202s/iter; left time: 361.1704s
Epoch: 3 cost time: 19.635088443756104
Epoch: 3, Steps: 1047 | Train Loss: 0.6171048 Vali Loss: 0.3657866 Test Loss: 0.5285031
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.5608048
	speed: 0.0625s/iter; left time: 1106.1169s
	iters: 200, epoch: 4 | loss: 0.4993071
	speed: 0.0221s/iter; left time: 388.9709s
	iters: 300, epoch: 4 | loss: 0.3762066
	speed: 0.0169s/iter; left time: 295.0861s
	iters: 400, epoch: 4 | loss: 0.7847723
	speed: 0.0173s/iter; left time: 301.0803s
	iters: 500, epoch: 4 | loss: 0.5777999
	speed: 0.0199s/iter; left time: 343.6919s
	iters: 600, epoch: 4 | loss: 0.6710677
	speed: 0.0188s/iter; left time: 322.8642s
	iters: 700, epoch: 4 | loss: 0.6929266
	speed: 0.0206s/iter; left time: 351.9000s
	iters: 800, epoch: 4 | loss: 0.4778705
	speed: 0.0178s/iter; left time: 303.2647s
	iters: 900, epoch: 4 | loss: 0.5267788
	speed: 0.0181s/iter; left time: 305.2748s
	iters: 1000, epoch: 4 | loss: 0.5156846
	speed: 0.0207s/iter; left time: 348.5767s
Epoch: 4 cost time: 19.83307647705078
Epoch: 4, Steps: 1047 | Train Loss: 0.5566622 Vali Loss: 0.2891348 Test Loss: 0.4076551
Validation loss decreased (0.358540 --> 0.289135).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.6325691
	speed: 0.0697s/iter; left time: 1159.9326s
	iters: 200, epoch: 5 | loss: 0.5470482
	speed: 0.0197s/iter; left time: 326.2498s
	iters: 300, epoch: 5 | loss: 0.6394228
	speed: 0.0198s/iter; left time: 324.9600s
	iters: 400, epoch: 5 | loss: 0.5302596
	speed: 0.0194s/iter; left time: 317.9163s
	iters: 500, epoch: 5 | loss: 0.3043026
	speed: 0.0197s/iter; left time: 319.9555s
	iters: 600, epoch: 5 | loss: 0.4411258
	speed: 0.0197s/iter; left time: 317.5762s
	iters: 700, epoch: 5 | loss: 0.2892768
	speed: 0.0209s/iter; left time: 335.5502s
	iters: 800, epoch: 5 | loss: 0.5370110
	speed: 0.0179s/iter; left time: 285.7573s
	iters: 900, epoch: 5 | loss: 0.5526649
	speed: 0.0185s/iter; left time: 293.9090s
	iters: 1000, epoch: 5 | loss: 0.3824959
	speed: 0.0174s/iter; left time: 274.3159s
Epoch: 5 cost time: 20.04481267929077
Epoch: 5, Steps: 1047 | Train Loss: 0.5285972 Vali Loss: 0.2702596 Test Loss: 0.3846643
Validation loss decreased (0.289135 --> 0.270260).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.6197773
	speed: 0.0683s/iter; left time: 1066.2058s
	iters: 200, epoch: 6 | loss: 0.5273041
	speed: 0.0195s/iter; left time: 303.0424s
	iters: 300, epoch: 6 | loss: 0.6929108
	speed: 0.0178s/iter; left time: 274.8030s
	iters: 400, epoch: 6 | loss: 0.3254314
	speed: 0.0197s/iter; left time: 302.1289s
	iters: 500, epoch: 6 | loss: 0.2681489
	speed: 0.0197s/iter; left time: 299.4299s
	iters: 600, epoch: 6 | loss: 0.9285517
	speed: 0.0173s/iter; left time: 261.0841s
	iters: 700, epoch: 6 | loss: 0.6777329
	speed: 0.0175s/iter; left time: 262.2752s
	iters: 800, epoch: 6 | loss: 0.4083041
	speed: 0.0193s/iter; left time: 287.0379s
	iters: 900, epoch: 6 | loss: 0.2883002
	speed: 0.0200s/iter; left time: 295.9648s
	iters: 1000, epoch: 6 | loss: 1.0405908
	speed: 0.0178s/iter; left time: 261.8664s
Epoch: 6 cost time: 19.790210962295532
Epoch: 6, Steps: 1047 | Train Loss: 0.5177700 Vali Loss: 0.2689559 Test Loss: 0.3750014
Validation loss decreased (0.270260 --> 0.268956).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.3440261
	speed: 0.0628s/iter; left time: 914.1386s
	iters: 200, epoch: 7 | loss: 0.7565005
	speed: 0.0183s/iter; left time: 265.2900s
	iters: 300, epoch: 7 | loss: 0.6949905
	speed: 0.0200s/iter; left time: 286.9847s
	iters: 400, epoch: 7 | loss: 0.2456287
	speed: 0.0182s/iter; left time: 259.0789s
	iters: 500, epoch: 7 | loss: 0.3341830
	speed: 0.0196s/iter; left time: 277.3379s
	iters: 600, epoch: 7 | loss: 0.3990937
	speed: 0.0194s/iter; left time: 272.7993s
	iters: 700, epoch: 7 | loss: 0.5382876
	speed: 0.0180s/iter; left time: 250.7886s
	iters: 800, epoch: 7 | loss: 0.2861914
	speed: 0.0174s/iter; left time: 241.6288s
	iters: 900, epoch: 7 | loss: 0.3814441
	speed: 0.0191s/iter; left time: 262.1239s
	iters: 1000, epoch: 7 | loss: 0.6063855
	speed: 0.0175s/iter; left time: 238.9952s
Epoch: 7 cost time: 19.21207618713379
Epoch: 7, Steps: 1047 | Train Loss: 0.5126892 Vali Loss: 0.2706107 Test Loss: 0.3788936
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.4632129
	speed: 0.0618s/iter; left time: 835.1002s
	iters: 200, epoch: 8 | loss: 0.3778504
	speed: 0.0187s/iter; left time: 250.4799s
	iters: 300, epoch: 8 | loss: 0.6798573
	speed: 0.0184s/iter; left time: 244.2993s
	iters: 400, epoch: 8 | loss: 0.5040504
	speed: 0.0187s/iter; left time: 247.1894s
	iters: 500, epoch: 8 | loss: 0.5129256
	speed: 0.0193s/iter; left time: 252.9264s
	iters: 600, epoch: 8 | loss: 0.3265963
	speed: 0.0215s/iter; left time: 280.2497s
	iters: 700, epoch: 8 | loss: 0.8481196
	speed: 0.0198s/iter; left time: 255.3109s
	iters: 800, epoch: 8 | loss: 0.4238956
	speed: 0.0189s/iter; left time: 241.9753s
	iters: 900, epoch: 8 | loss: 0.6068212
	speed: 0.0205s/iter; left time: 261.0786s
	iters: 1000, epoch: 8 | loss: 0.2988790
	speed: 0.0175s/iter; left time: 220.9541s
Epoch: 8 cost time: 19.91015100479126
Epoch: 8, Steps: 1047 | Train Loss: 0.5084458 Vali Loss: 0.2691198 Test Loss: 0.3717948
EarlyStopping counter: 2 out of 5
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.7111987
	speed: 0.0660s/iter; left time: 822.9877s
	iters: 200, epoch: 9 | loss: 0.6774279
	speed: 0.0176s/iter; left time: 217.0130s
	iters: 300, epoch: 9 | loss: 0.3464214
	speed: 0.0171s/iter; left time: 210.1959s
	iters: 400, epoch: 9 | loss: 0.5346399
	speed: 0.0181s/iter; left time: 220.0646s
	iters: 500, epoch: 9 | loss: 0.4495038
	speed: 0.0177s/iter; left time: 213.2930s
	iters: 600, epoch: 9 | loss: 0.7181168
	speed: 0.0189s/iter; left time: 225.8066s
	iters: 700, epoch: 9 | loss: 0.2069675
	speed: 0.0183s/iter; left time: 217.0471s
	iters: 800, epoch: 9 | loss: 0.6523777
	speed: 0.0194s/iter; left time: 228.6474s
	iters: 900, epoch: 9 | loss: 0.5513586
	speed: 0.0195s/iter; left time: 227.8299s
	iters: 1000, epoch: 9 | loss: 0.3746037
	speed: 0.0188s/iter; left time: 217.2329s
Epoch: 9 cost time: 19.03876543045044
Epoch: 9, Steps: 1047 | Train Loss: 0.5064269 Vali Loss: 0.2664193 Test Loss: 0.3722114
Validation loss decreased (0.268956 --> 0.266419).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.5615480
	speed: 0.0617s/iter; left time: 704.8724s
	iters: 200, epoch: 10 | loss: 0.4950983
	speed: 0.0186s/iter; left time: 210.4702s
	iters: 300, epoch: 10 | loss: 0.8149087
	speed: 0.0196s/iter; left time: 220.1646s
	iters: 400, epoch: 10 | loss: 0.3186013
	speed: 0.0170s/iter; left time: 189.0352s
	iters: 500, epoch: 10 | loss: 0.5258862
	speed: 0.0189s/iter; left time: 207.7077s
	iters: 600, epoch: 10 | loss: 0.3326439
	speed: 0.0202s/iter; left time: 220.3606s
	iters: 700, epoch: 10 | loss: 0.5565677
	speed: 0.0205s/iter; left time: 222.1564s
	iters: 800, epoch: 10 | loss: 0.4213805
	speed: 0.0208s/iter; left time: 223.3448s
	iters: 900, epoch: 10 | loss: 0.8707740
	speed: 0.0198s/iter; left time: 210.3392s
	iters: 1000, epoch: 10 | loss: 0.7141153
	speed: 0.0190s/iter; left time: 200.1336s
Epoch: 10 cost time: 19.96863293647766
Epoch: 10, Steps: 1047 | Train Loss: 0.5053358 Vali Loss: 0.2681578 Test Loss: 0.3709334
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.4145082
	speed: 0.0668s/iter; left time: 692.4009s
	iters: 200, epoch: 11 | loss: 0.5061406
	speed: 0.0171s/iter; left time: 175.9456s
	iters: 300, epoch: 11 | loss: 0.3255995
	speed: 0.0167s/iter; left time: 169.5873s
	iters: 400, epoch: 11 | loss: 0.3672796
	speed: 0.0189s/iter; left time: 189.8662s
	iters: 500, epoch: 11 | loss: 0.2913414
	speed: 0.0205s/iter; left time: 204.3449s
	iters: 600, epoch: 11 | loss: 0.6496567
	speed: 0.0215s/iter; left time: 212.7191s
	iters: 700, epoch: 11 | loss: 0.2829037
	speed: 0.0212s/iter; left time: 206.8376s
	iters: 800, epoch: 11 | loss: 0.2916779
	speed: 0.0205s/iter; left time: 197.9969s
	iters: 900, epoch: 11 | loss: 0.6063244
	speed: 0.0196s/iter; left time: 187.8962s
	iters: 1000, epoch: 11 | loss: 0.6000593
	speed: 0.0187s/iter; left time: 177.3424s
Epoch: 11 cost time: 19.946315050125122
Epoch: 11, Steps: 1047 | Train Loss: 0.5047826 Vali Loss: 0.2675867 Test Loss: 0.3709980
EarlyStopping counter: 2 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.3804000
	speed: 0.0647s/iter; left time: 603.6553s
	iters: 200, epoch: 12 | loss: 0.3445235
	speed: 0.0180s/iter; left time: 165.8228s
	iters: 300, epoch: 12 | loss: 0.8786700
	speed: 0.0196s/iter; left time: 178.9678s
	iters: 400, epoch: 12 | loss: 0.4889409
	speed: 0.0163s/iter; left time: 146.9731s
	iters: 500, epoch: 12 | loss: 0.6029659
	speed: 0.0198s/iter; left time: 176.5032s
	iters: 600, epoch: 12 | loss: 0.6853526
	speed: 0.0202s/iter; left time: 178.3998s
	iters: 700, epoch: 12 | loss: 0.5015730
	speed: 0.0212s/iter; left time: 184.8254s
	iters: 800, epoch: 12 | loss: 0.9649263
	speed: 0.0209s/iter; left time: 180.0142s
	iters: 900, epoch: 12 | loss: 0.4579709
	speed: 0.0220s/iter; left time: 187.6266s
	iters: 1000, epoch: 12 | loss: 0.6656715
	speed: 0.0198s/iter; left time: 167.0139s
Epoch: 12 cost time: 20.31138777732849
Epoch: 12, Steps: 1047 | Train Loss: 0.5044717 Vali Loss: 0.2672106 Test Loss: 0.3707132
EarlyStopping counter: 3 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.5426012
	speed: 0.0751s/iter; left time: 621.5860s
	iters: 200, epoch: 13 | loss: 0.5861895
	speed: 0.0207s/iter; left time: 169.2543s
	iters: 300, epoch: 13 | loss: 0.8252755
	speed: 0.0191s/iter; left time: 154.3171s
	iters: 400, epoch: 13 | loss: 0.7414112
	speed: 0.0195s/iter; left time: 155.6276s
	iters: 500, epoch: 13 | loss: 0.3663218
	speed: 0.0184s/iter; left time: 145.1821s
	iters: 600, epoch: 13 | loss: 0.5645106
	speed: 0.0171s/iter; left time: 132.6577s
	iters: 700, epoch: 13 | loss: 0.3013117
	speed: 0.0199s/iter; left time: 152.9976s
	iters: 800, epoch: 13 | loss: 0.3926499
	speed: 0.0185s/iter; left time: 139.8877s
	iters: 900, epoch: 13 | loss: 0.3406867
	speed: 0.0197s/iter; left time: 147.4964s
	iters: 1000, epoch: 13 | loss: 0.3025416
	speed: 0.0178s/iter; left time: 131.4044s
Epoch: 13 cost time: 19.96265149116516
Epoch: 13, Steps: 1047 | Train Loss: 0.5043336 Vali Loss: 0.2672259 Test Loss: 0.3709338
EarlyStopping counter: 4 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 14 | loss: 0.6349757
	speed: 0.0665s/iter; left time: 480.4351s
	iters: 200, epoch: 14 | loss: 0.6726545
	speed: 0.0192s/iter; left time: 136.6967s
	iters: 300, epoch: 14 | loss: 0.2544818
	speed: 0.0208s/iter; left time: 146.2787s
	iters: 400, epoch: 14 | loss: 0.9244810
	speed: 0.0199s/iter; left time: 137.6966s
	iters: 500, epoch: 14 | loss: 0.2752794
	speed: 0.0205s/iter; left time: 139.7437s
	iters: 600, epoch: 14 | loss: 0.2730496
	speed: 0.0197s/iter; left time: 132.3126s
	iters: 700, epoch: 14 | loss: 0.6803832
	speed: 0.0200s/iter; left time: 132.7050s
	iters: 800, epoch: 14 | loss: 0.2701565
	speed: 0.0173s/iter; left time: 112.8753s
	iters: 900, epoch: 14 | loss: 0.3239571
	speed: 0.0185s/iter; left time: 118.8806s
	iters: 1000, epoch: 14 | loss: 0.5089725
	speed: 0.0176s/iter; left time: 111.4927s
Epoch: 14 cost time: 20.03119206428528
Epoch: 14, Steps: 1047 | Train Loss: 0.5042517 Vali Loss: 0.2673034 Test Loss: 0.3708634
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTm2_336_720_NLinear_ETTm2_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed28649<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10801
mse:0.3716893196105957, mae:0.3854013979434967
