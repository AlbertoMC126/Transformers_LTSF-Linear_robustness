Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='NLinear', model_id='ETTm2_336_720', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=720, root_path='./dataset/', save_pred_values=False, seed=15227, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTm2_336_720_NLinear_ETTm2_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15227>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33505
val 10801
test 10801
	iters: 100, epoch: 1 | loss: 0.7726899
	speed: 0.0184s/iter; left time: 384.0976s
	iters: 200, epoch: 1 | loss: 0.5180622
	speed: 0.0205s/iter; left time: 425.9201s
	iters: 300, epoch: 1 | loss: 0.9680433
	speed: 0.0203s/iter; left time: 418.1707s
	iters: 400, epoch: 1 | loss: 1.5812563
	speed: 0.0195s/iter; left time: 401.1904s
	iters: 500, epoch: 1 | loss: 0.7199224
	speed: 0.0192s/iter; left time: 392.3370s
	iters: 600, epoch: 1 | loss: 0.9500731
	speed: 0.0181s/iter; left time: 368.1025s
	iters: 700, epoch: 1 | loss: 1.1110303
	speed: 0.0199s/iter; left time: 403.4251s
	iters: 800, epoch: 1 | loss: 1.0786349
	speed: 0.0207s/iter; left time: 416.4494s
	iters: 900, epoch: 1 | loss: 0.6128917
	speed: 0.0201s/iter; left time: 402.7622s
	iters: 1000, epoch: 1 | loss: 1.2368065
	speed: 0.0192s/iter; left time: 383.7953s
Epoch: 1 cost time: 20.380693197250366
Epoch: 1, Steps: 1047 | Train Loss: 0.9248673 Vali Loss: 0.5803173 Test Loss: 0.8351454
Validation loss decreased (inf --> 0.580317).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.3458152
	speed: 0.0666s/iter; left time: 1318.6390s
	iters: 200, epoch: 2 | loss: 1.1639439
	speed: 0.0196s/iter; left time: 385.7038s
	iters: 300, epoch: 2 | loss: 0.8935944
	speed: 0.0197s/iter; left time: 386.6663s
	iters: 400, epoch: 2 | loss: 0.5785165
	speed: 0.0181s/iter; left time: 353.5963s
	iters: 500, epoch: 2 | loss: 1.0710211
	speed: 0.0189s/iter; left time: 366.5066s
	iters: 600, epoch: 2 | loss: 0.6503446
	speed: 0.0175s/iter; left time: 338.0422s
	iters: 700, epoch: 2 | loss: 0.5820989
	speed: 0.0178s/iter; left time: 341.9886s
	iters: 800, epoch: 2 | loss: 0.5933517
	speed: 0.0191s/iter; left time: 363.9196s
	iters: 900, epoch: 2 | loss: 0.7794864
	speed: 0.0193s/iter; left time: 366.3421s
	iters: 1000, epoch: 2 | loss: 0.9871967
	speed: 0.0175s/iter; left time: 330.4916s
Epoch: 2 cost time: 19.482673168182373
Epoch: 2, Steps: 1047 | Train Loss: 0.8216545 Vali Loss: 0.4323832 Test Loss: 0.5329657
Validation loss decreased (0.580317 --> 0.432383).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.5763511
	speed: 0.0647s/iter; left time: 1213.2057s
	iters: 200, epoch: 3 | loss: 0.3677911
	speed: 0.0193s/iter; left time: 359.7586s
	iters: 300, epoch: 3 | loss: 0.4685131
	speed: 0.0186s/iter; left time: 344.1989s
	iters: 400, epoch: 3 | loss: 0.7296063
	speed: 0.0189s/iter; left time: 349.4220s
	iters: 500, epoch: 3 | loss: 0.6048877
	speed: 0.0161s/iter; left time: 294.4998s
	iters: 600, epoch: 3 | loss: 0.4904087
	speed: 0.0201s/iter; left time: 366.5355s
	iters: 700, epoch: 3 | loss: 0.5557425
	speed: 0.0210s/iter; left time: 381.0925s
	iters: 800, epoch: 3 | loss: 0.9473379
	speed: 0.0196s/iter; left time: 353.7152s
	iters: 900, epoch: 3 | loss: 0.4515038
	speed: 0.0202s/iter; left time: 362.4311s
	iters: 1000, epoch: 3 | loss: 0.4824517
	speed: 0.0195s/iter; left time: 348.6978s
Epoch: 3 cost time: 20.12337017059326
Epoch: 3, Steps: 1047 | Train Loss: 0.6149978 Vali Loss: 0.3148575 Test Loss: 0.4286740
Validation loss decreased (0.432383 --> 0.314858).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.5415762
	speed: 0.0684s/iter; left time: 1210.5776s
	iters: 200, epoch: 4 | loss: 0.5600272
	speed: 0.0188s/iter; left time: 330.8537s
	iters: 300, epoch: 4 | loss: 0.5345191
	speed: 0.0191s/iter; left time: 334.4455s
	iters: 400, epoch: 4 | loss: 0.3620800
	speed: 0.0195s/iter; left time: 339.1438s
	iters: 500, epoch: 4 | loss: 0.4722478
	speed: 0.0174s/iter; left time: 301.0624s
	iters: 600, epoch: 4 | loss: 0.3731329
	speed: 0.0200s/iter; left time: 343.8458s
	iters: 700, epoch: 4 | loss: 0.3783449
	speed: 0.0193s/iter; left time: 330.8695s
	iters: 800, epoch: 4 | loss: 0.4486354
	speed: 0.0193s/iter; left time: 327.9128s
	iters: 900, epoch: 4 | loss: 0.6761361
	speed: 0.0198s/iter; left time: 334.4956s
	iters: 1000, epoch: 4 | loss: 0.6033472
	speed: 0.0206s/iter; left time: 345.5683s
Epoch: 4 cost time: 20.18108582496643
Epoch: 4, Steps: 1047 | Train Loss: 0.5571151 Vali Loss: 0.2872278 Test Loss: 0.3934535
Validation loss decreased (0.314858 --> 0.287228).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.3539698
	speed: 0.0660s/iter; left time: 1099.4818s
	iters: 200, epoch: 5 | loss: 0.7663242
	speed: 0.0191s/iter; left time: 315.4083s
	iters: 300, epoch: 5 | loss: 0.5228327
	speed: 0.0195s/iter; left time: 321.1754s
	iters: 400, epoch: 5 | loss: 0.5208170
	speed: 0.0217s/iter; left time: 355.5860s
	iters: 500, epoch: 5 | loss: 0.4013686
	speed: 0.0206s/iter; left time: 335.3442s
	iters: 600, epoch: 5 | loss: 0.6234536
	speed: 0.0204s/iter; left time: 329.9208s
	iters: 700, epoch: 5 | loss: 0.3824965
	speed: 0.0182s/iter; left time: 292.3744s
	iters: 800, epoch: 5 | loss: 0.4675224
	speed: 0.0185s/iter; left time: 294.4807s
	iters: 900, epoch: 5 | loss: 0.9150374
	speed: 0.0195s/iter; left time: 308.4868s
	iters: 1000, epoch: 5 | loss: 0.7439315
	speed: 0.0191s/iter; left time: 301.1534s
Epoch: 5 cost time: 20.383905172348022
Epoch: 5, Steps: 1047 | Train Loss: 0.5323246 Vali Loss: 0.2780629 Test Loss: 0.3976045
Validation loss decreased (0.287228 --> 0.278063).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.3607514
	speed: 0.0674s/iter; left time: 1052.4721s
	iters: 200, epoch: 6 | loss: 1.0492525
	speed: 0.0191s/iter; left time: 295.7542s
	iters: 300, epoch: 6 | loss: 0.4666385
	speed: 0.0198s/iter; left time: 305.3073s
	iters: 400, epoch: 6 | loss: 0.4300571
	speed: 0.0202s/iter; left time: 309.7788s
	iters: 500, epoch: 6 | loss: 0.6988985
	speed: 0.0195s/iter; left time: 296.8480s
	iters: 600, epoch: 6 | loss: 0.6720800
	speed: 0.0199s/iter; left time: 300.6640s
	iters: 700, epoch: 6 | loss: 0.3683805
	speed: 0.0198s/iter; left time: 296.5378s
	iters: 800, epoch: 6 | loss: 0.4548787
	speed: 0.0198s/iter; left time: 294.7702s
	iters: 900, epoch: 6 | loss: 0.4799784
	speed: 0.0171s/iter; left time: 252.6201s
	iters: 1000, epoch: 6 | loss: 0.8851407
	speed: 0.0167s/iter; left time: 245.1804s
Epoch: 6 cost time: 19.79721975326538
Epoch: 6, Steps: 1047 | Train Loss: 0.5198226 Vali Loss: 0.2706242 Test Loss: 0.3750553
Validation loss decreased (0.278063 --> 0.270624).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.2369090
	speed: 0.0623s/iter; left time: 906.4199s
	iters: 200, epoch: 7 | loss: 0.2413830
	speed: 0.0185s/iter; left time: 267.0296s
	iters: 300, epoch: 7 | loss: 0.2054731
	speed: 0.0181s/iter; left time: 259.5583s
	iters: 400, epoch: 7 | loss: 0.7273460
	speed: 0.0196s/iter; left time: 279.0400s
	iters: 500, epoch: 7 | loss: 0.5141582
	speed: 0.0205s/iter; left time: 290.5009s
	iters: 600, epoch: 7 | loss: 0.2796863
	speed: 0.0198s/iter; left time: 278.4273s
	iters: 700, epoch: 7 | loss: 1.0639837
	speed: 0.0204s/iter; left time: 284.4299s
	iters: 800, epoch: 7 | loss: 0.3481231
	speed: 0.0210s/iter; left time: 290.7816s
	iters: 900, epoch: 7 | loss: 0.5590912
	speed: 0.0161s/iter; left time: 221.7720s
	iters: 1000, epoch: 7 | loss: 0.6373723
	speed: 0.0186s/iter; left time: 254.4139s
Epoch: 7 cost time: 19.80108642578125
Epoch: 7, Steps: 1047 | Train Loss: 0.5116407 Vali Loss: 0.2704405 Test Loss: 0.3770031
Validation loss decreased (0.270624 --> 0.270440).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.3687540
	speed: 0.0667s/iter; left time: 901.8555s
	iters: 200, epoch: 8 | loss: 0.6081766
	speed: 0.0173s/iter; left time: 232.5495s
	iters: 300, epoch: 8 | loss: 0.2635690
	speed: 0.0193s/iter; left time: 256.9952s
	iters: 400, epoch: 8 | loss: 0.4346430
	speed: 0.0197s/iter; left time: 260.4869s
	iters: 500, epoch: 8 | loss: 0.5298995
	speed: 0.0202s/iter; left time: 264.4311s
	iters: 600, epoch: 8 | loss: 0.4188105
	speed: 0.0196s/iter; left time: 255.4636s
	iters: 700, epoch: 8 | loss: 0.6569661
	speed: 0.0200s/iter; left time: 258.3383s
	iters: 800, epoch: 8 | loss: 0.4367899
	speed: 0.0205s/iter; left time: 263.1656s
	iters: 900, epoch: 8 | loss: 0.2942958
	speed: 0.0197s/iter; left time: 250.2509s
	iters: 1000, epoch: 8 | loss: 0.6555233
	speed: 0.0168s/iter; left time: 212.2156s
Epoch: 8 cost time: 19.95307755470276
Epoch: 8, Steps: 1047 | Train Loss: 0.5084498 Vali Loss: 0.2687458 Test Loss: 0.3739240
Validation loss decreased (0.270440 --> 0.268746).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.5370103
	speed: 0.0668s/iter; left time: 833.1540s
	iters: 200, epoch: 9 | loss: 0.4040579
	speed: 0.0175s/iter; left time: 216.5819s
	iters: 300, epoch: 9 | loss: 0.4741911
	speed: 0.0163s/iter; left time: 200.4644s
	iters: 400, epoch: 9 | loss: 0.2829827
	speed: 0.0191s/iter; left time: 231.9702s
	iters: 500, epoch: 9 | loss: 0.6282678
	speed: 0.0179s/iter; left time: 215.6612s
	iters: 600, epoch: 9 | loss: 0.4837742
	speed: 0.0198s/iter; left time: 236.4795s
	iters: 700, epoch: 9 | loss: 0.3181800
	speed: 0.0192s/iter; left time: 228.0431s
	iters: 800, epoch: 9 | loss: 0.5445545
	speed: 0.0173s/iter; left time: 203.7630s
	iters: 900, epoch: 9 | loss: 0.3536475
	speed: 0.0212s/iter; left time: 247.8072s
	iters: 1000, epoch: 9 | loss: 0.4626205
	speed: 0.0183s/iter; left time: 211.9427s
Epoch: 9 cost time: 19.23872661590576
Epoch: 9, Steps: 1047 | Train Loss: 0.5065108 Vali Loss: 0.2660846 Test Loss: 0.3709287
Validation loss decreased (0.268746 --> 0.266085).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.3757923
	speed: 0.0678s/iter; left time: 774.3202s
	iters: 200, epoch: 10 | loss: 0.5401531
	speed: 0.0196s/iter; left time: 221.9017s
	iters: 300, epoch: 10 | loss: 0.3451205
	speed: 0.0196s/iter; left time: 219.4237s
	iters: 400, epoch: 10 | loss: 0.5857819
	speed: 0.0193s/iter; left time: 214.9567s
	iters: 500, epoch: 10 | loss: 0.6335204
	speed: 0.0209s/iter; left time: 230.8010s
	iters: 600, epoch: 10 | loss: 0.5645368
	speed: 0.0195s/iter; left time: 213.4163s
	iters: 700, epoch: 10 | loss: 0.9466063
	speed: 0.0192s/iter; left time: 207.4426s
	iters: 800, epoch: 10 | loss: 0.4302441
	speed: 0.0186s/iter; left time: 199.5336s
	iters: 900, epoch: 10 | loss: 0.5200644
	speed: 0.0192s/iter; left time: 204.2684s
	iters: 1000, epoch: 10 | loss: 0.6941809
	speed: 0.0177s/iter; left time: 186.1731s
Epoch: 10 cost time: 19.878294467926025
Epoch: 10, Steps: 1047 | Train Loss: 0.5054927 Vali Loss: 0.2692354 Test Loss: 0.3727832
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.5714242
	speed: 0.0696s/iter; left time: 722.1623s
	iters: 200, epoch: 11 | loss: 0.5479119
	speed: 0.0198s/iter; left time: 203.5632s
	iters: 300, epoch: 11 | loss: 0.6172299
	speed: 0.0176s/iter; left time: 179.3601s
	iters: 400, epoch: 11 | loss: 0.4270564
	speed: 0.0187s/iter; left time: 188.2238s
	iters: 500, epoch: 11 | loss: 1.3251542
	speed: 0.0187s/iter; left time: 186.3705s
	iters: 600, epoch: 11 | loss: 0.5807019
	speed: 0.0180s/iter; left time: 178.1709s
	iters: 700, epoch: 11 | loss: 0.7381092
	speed: 0.0169s/iter; left time: 165.3077s
	iters: 800, epoch: 11 | loss: 0.6419692
	speed: 0.0194s/iter; left time: 187.9655s
	iters: 900, epoch: 11 | loss: 0.3920096
	speed: 0.0182s/iter; left time: 174.3810s
	iters: 1000, epoch: 11 | loss: 0.6147664
	speed: 0.0171s/iter; left time: 162.1267s
Epoch: 11 cost time: 19.163692474365234
Epoch: 11, Steps: 1047 | Train Loss: 0.5048519 Vali Loss: 0.2681444 Test Loss: 0.3716470
EarlyStopping counter: 2 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.5436127
	speed: 0.0710s/iter; left time: 661.7369s
	iters: 200, epoch: 12 | loss: 0.6753668
	speed: 0.0190s/iter; left time: 175.6691s
	iters: 300, epoch: 12 | loss: 0.9935440
	speed: 0.0186s/iter; left time: 169.8615s
	iters: 400, epoch: 12 | loss: 0.6294314
	speed: 0.0173s/iter; left time: 155.8173s
	iters: 500, epoch: 12 | loss: 0.6084529
	speed: 0.0179s/iter; left time: 159.9097s
	iters: 600, epoch: 12 | loss: 0.2447049
	speed: 0.0191s/iter; left time: 168.6575s
	iters: 700, epoch: 12 | loss: 0.4425279
	speed: 0.0202s/iter; left time: 176.6597s
	iters: 800, epoch: 12 | loss: 0.2595988
	speed: 0.0192s/iter; left time: 165.5216s
	iters: 900, epoch: 12 | loss: 0.6903034
	speed: 0.0178s/iter; left time: 151.6995s
	iters: 1000, epoch: 12 | loss: 0.5385519
	speed: 0.0179s/iter; left time: 150.9062s
Epoch: 12 cost time: 19.339560747146606
Epoch: 12, Steps: 1047 | Train Loss: 0.5045557 Vali Loss: 0.2672001 Test Loss: 0.3708636
EarlyStopping counter: 3 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.2508258
	speed: 0.0669s/iter; left time: 553.7963s
	iters: 200, epoch: 13 | loss: 0.7170109
	speed: 0.0201s/iter; left time: 164.3492s
	iters: 300, epoch: 13 | loss: 0.6056682
	speed: 0.0198s/iter; left time: 159.9698s
	iters: 400, epoch: 13 | loss: 0.5034844
	speed: 0.0190s/iter; left time: 151.6419s
	iters: 500, epoch: 13 | loss: 0.3885989
	speed: 0.0189s/iter; left time: 148.8033s
	iters: 600, epoch: 13 | loss: 0.3039211
	speed: 0.0191s/iter; left time: 148.3694s
	iters: 700, epoch: 13 | loss: 0.5716238
	speed: 0.0199s/iter; left time: 152.6884s
	iters: 800, epoch: 13 | loss: 0.3468971
	speed: 0.0178s/iter; left time: 134.7368s
	iters: 900, epoch: 13 | loss: 0.5011932
	speed: 0.0194s/iter; left time: 145.2054s
	iters: 1000, epoch: 13 | loss: 0.3444410
	speed: 0.0182s/iter; left time: 134.4014s
Epoch: 13 cost time: 19.918644905090332
Epoch: 13, Steps: 1047 | Train Loss: 0.5043595 Vali Loss: 0.2674366 Test Loss: 0.3708390
EarlyStopping counter: 4 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 14 | loss: 0.7556203
	speed: 0.0654s/iter; left time: 473.1332s
	iters: 200, epoch: 14 | loss: 0.4992954
	speed: 0.0180s/iter; left time: 128.2723s
	iters: 300, epoch: 14 | loss: 0.5230267
	speed: 0.0182s/iter; left time: 127.8356s
	iters: 400, epoch: 14 | loss: 1.1518775
	speed: 0.0187s/iter; left time: 129.7300s
	iters: 500, epoch: 14 | loss: 0.3341802
	speed: 0.0198s/iter; left time: 134.9504s
	iters: 600, epoch: 14 | loss: 0.4386405
	speed: 0.0189s/iter; left time: 126.8815s
	iters: 700, epoch: 14 | loss: 0.6747365
	speed: 0.0175s/iter; left time: 115.8540s
	iters: 800, epoch: 14 | loss: 0.6206928
	speed: 0.0192s/iter; left time: 125.4447s
	iters: 900, epoch: 14 | loss: 0.5293144
	speed: 0.0195s/iter; left time: 125.1501s
	iters: 1000, epoch: 14 | loss: 0.2651470
	speed: 0.0174s/iter; left time: 110.2664s
Epoch: 14 cost time: 19.065906524658203
Epoch: 14, Steps: 1047 | Train Loss: 0.5042728 Vali Loss: 0.2673543 Test Loss: 0.3707724
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTm2_336_720_NLinear_ETTm2_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15227<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10801
mse:0.37041592597961426, mae:0.3848738670349121
