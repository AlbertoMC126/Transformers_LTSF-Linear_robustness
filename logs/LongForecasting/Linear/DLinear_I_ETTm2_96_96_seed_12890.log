Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='DLinear', model_id='ETTm2_96_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=12890, seq_len=96, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTm2_96_96_DLinear_ETTm2_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed12890>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34369
data_set:  <data_provider.data_loader.Dataset_ETT_minute object at 0x0000023ABB0604E0>
val 11425
data_set:  <data_provider.data_loader.Dataset_ETT_minute object at 0x0000023A88666D68>
test 11425
data_set:  <data_provider.data_loader.Dataset_ETT_minute object at 0x0000023ABB060438>
Total number of trainable parameters: 130368
Total number of parameters: 130368
	iters: 100, epoch: 1 | loss: 0.2677531
	speed: 0.0048s/iter; left time: 103.3612s
	iters: 200, epoch: 1 | loss: 0.2172719
	speed: 0.0056s/iter; left time: 119.2825s
	iters: 300, epoch: 1 | loss: 0.1619775
	speed: 0.0054s/iter; left time: 115.2273s
	iters: 400, epoch: 1 | loss: 0.2199461
	speed: 0.0055s/iter; left time: 116.0497s
	iters: 500, epoch: 1 | loss: 0.4353999
	speed: 0.0063s/iter; left time: 132.1004s
	iters: 600, epoch: 1 | loss: 0.1594783
	speed: 0.0050s/iter; left time: 104.1881s
	iters: 700, epoch: 1 | loss: 0.1962193
	speed: 0.0060s/iter; left time: 125.5825s
	iters: 800, epoch: 1 | loss: 0.3096494
	speed: 0.0054s/iter; left time: 112.3821s
	iters: 900, epoch: 1 | loss: 0.1808695
	speed: 0.0056s/iter; left time: 116.2439s
	iters: 1000, epoch: 1 | loss: 0.2083752
	speed: 0.0047s/iter; left time: 95.7423s
Epoch: 1 cost time: 5.7820093631744385
Epoch: 1, Steps: 1074 | Train Loss: 0.2763910 Vali Loss: 0.2648548 Test Loss: 0.5386392
Validation loss decreased (inf --> 0.264855).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.4474753
	speed: 0.0275s/iter; left time: 557.7510s
	iters: 200, epoch: 2 | loss: 0.1951160
	speed: 0.0041s/iter; left time: 82.7489s
	iters: 300, epoch: 2 | loss: 0.3687361
	speed: 0.0055s/iter; left time: 110.5555s
	iters: 400, epoch: 2 | loss: 0.3270642
	speed: 0.0050s/iter; left time: 99.7455s
	iters: 500, epoch: 2 | loss: 0.1534707
	speed: 0.0055s/iter; left time: 109.7942s
	iters: 600, epoch: 2 | loss: 0.4145654
	speed: 0.0051s/iter; left time: 101.4497s
	iters: 700, epoch: 2 | loss: 0.2884005
	speed: 0.0059s/iter; left time: 115.6227s
	iters: 800, epoch: 2 | loss: 0.4468353
	speed: 0.0059s/iter; left time: 115.8060s
	iters: 900, epoch: 2 | loss: 0.2194460
	speed: 0.0056s/iter; left time: 109.5151s
	iters: 1000, epoch: 2 | loss: 0.3076737
	speed: 0.0061s/iter; left time: 118.5604s
Epoch: 2 cost time: 5.915868043899536
Epoch: 2, Steps: 1074 | Train Loss: 0.2793649 Vali Loss: 0.3856404 Test Loss: 0.9388275
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.2523241
	speed: 0.0243s/iter; left time: 467.9497s
	iters: 200, epoch: 3 | loss: 0.1700506
	speed: 0.0058s/iter; left time: 111.4990s
	iters: 300, epoch: 3 | loss: 0.1944656
	speed: 0.0061s/iter; left time: 115.1580s
	iters: 400, epoch: 3 | loss: 0.1463758
	speed: 0.0057s/iter; left time: 107.8876s
	iters: 500, epoch: 3 | loss: 0.1820853
	speed: 0.0045s/iter; left time: 83.9768s
	iters: 600, epoch: 3 | loss: 0.1569690
	speed: 0.0062s/iter; left time: 115.3199s
	iters: 700, epoch: 3 | loss: 0.2113493
	speed: 0.0058s/iter; left time: 108.4575s
	iters: 800, epoch: 3 | loss: 0.2639199
	speed: 0.0055s/iter; left time: 101.3669s
	iters: 900, epoch: 3 | loss: 0.1815821
	speed: 0.0064s/iter; left time: 117.7013s
	iters: 1000, epoch: 3 | loss: 0.1157780
	speed: 0.0054s/iter; left time: 99.2422s
Epoch: 3 cost time: 6.121312141418457
Epoch: 3, Steps: 1074 | Train Loss: 0.2446020 Vali Loss: 0.2143253 Test Loss: 0.3912593
Validation loss decreased (0.264855 --> 0.214325).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.2164008
	speed: 0.0256s/iter; left time: 464.6114s
	iters: 200, epoch: 4 | loss: 0.5152970
	speed: 0.0058s/iter; left time: 104.2980s
	iters: 300, epoch: 4 | loss: 0.2627522
	speed: 0.0061s/iter; left time: 110.4434s
	iters: 400, epoch: 4 | loss: 0.1773461
	speed: 0.0046s/iter; left time: 83.0099s
	iters: 500, epoch: 4 | loss: 0.1835150
	speed: 0.0056s/iter; left time: 99.9443s
	iters: 600, epoch: 4 | loss: 0.1489004
	speed: 0.0053s/iter; left time: 93.6243s
	iters: 700, epoch: 4 | loss: 0.2078971
	speed: 0.0054s/iter; left time: 94.1333s
	iters: 800, epoch: 4 | loss: 0.1254578
	speed: 0.0052s/iter; left time: 90.0841s
	iters: 900, epoch: 4 | loss: 0.2896247
	speed: 0.0052s/iter; left time: 89.6087s
	iters: 1000, epoch: 4 | loss: 0.1870860
	speed: 0.0047s/iter; left time: 81.1870s
Epoch: 4 cost time: 5.871804714202881
Epoch: 4, Steps: 1074 | Train Loss: 0.2309604 Vali Loss: 0.1345502 Test Loss: 0.1999575
Validation loss decreased (0.214325 --> 0.134550).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.2072078
	speed: 0.0256s/iter; left time: 437.9186s
	iters: 200, epoch: 5 | loss: 0.1456792
	speed: 0.0058s/iter; left time: 97.8101s
	iters: 300, epoch: 5 | loss: 0.1247116
	speed: 0.0051s/iter; left time: 85.4031s
	iters: 400, epoch: 5 | loss: 0.2524394
	speed: 0.0048s/iter; left time: 80.0386s
	iters: 500, epoch: 5 | loss: 0.5762605
	speed: 0.0053s/iter; left time: 87.9281s
	iters: 600, epoch: 5 | loss: 0.1520329
	speed: 0.0052s/iter; left time: 86.5403s
	iters: 700, epoch: 5 | loss: 0.2261873
	speed: 0.0053s/iter; left time: 86.8562s
	iters: 800, epoch: 5 | loss: 0.2272732
	speed: 0.0066s/iter; left time: 108.6347s
	iters: 900, epoch: 5 | loss: 0.1726252
	speed: 0.0053s/iter; left time: 86.5522s
	iters: 1000, epoch: 5 | loss: 0.1682790
	speed: 0.0056s/iter; left time: 90.3735s
Epoch: 5 cost time: 5.817231178283691
Epoch: 5, Steps: 1074 | Train Loss: 0.2232999 Vali Loss: 0.1457508 Test Loss: 0.2343406
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.1667258
	speed: 0.0211s/iter; left time: 338.3567s
	iters: 200, epoch: 6 | loss: 0.1907477
	speed: 0.0059s/iter; left time: 93.2503s
	iters: 300, epoch: 6 | loss: 0.2375239
	speed: 0.0050s/iter; left time: 79.7166s
	iters: 400, epoch: 6 | loss: 0.1982677
	speed: 0.0056s/iter; left time: 87.4627s
	iters: 500, epoch: 6 | loss: 0.1226184
	speed: 0.0059s/iter; left time: 91.6832s
	iters: 600, epoch: 6 | loss: 0.1223269
	speed: 0.0064s/iter; left time: 98.9168s
	iters: 700, epoch: 6 | loss: 0.2177714
	speed: 0.0076s/iter; left time: 116.3904s
	iters: 800, epoch: 6 | loss: 0.1480235
	speed: 0.0048s/iter; left time: 74.1817s
	iters: 900, epoch: 6 | loss: 0.2836865
	speed: 0.0062s/iter; left time: 94.2963s
	iters: 1000, epoch: 6 | loss: 0.3405272
	speed: 0.0043s/iter; left time: 65.0553s
Epoch: 6 cost time: 6.014220952987671
Epoch: 6, Steps: 1074 | Train Loss: 0.2204671 Vali Loss: 0.1744502 Test Loss: 0.3277867
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.1137159
	speed: 0.0244s/iter; left time: 364.4139s
	iters: 200, epoch: 7 | loss: 0.1803039
	speed: 0.0066s/iter; left time: 98.6294s
	iters: 300, epoch: 7 | loss: 0.3210870
	speed: 0.0060s/iter; left time: 88.8612s
	iters: 400, epoch: 7 | loss: 0.2101880
	speed: 0.0049s/iter; left time: 71.5357s
	iters: 500, epoch: 7 | loss: 0.1835284
	speed: 0.0045s/iter; left time: 65.5802s
	iters: 600, epoch: 7 | loss: 0.3528954
	speed: 0.0059s/iter; left time: 85.6841s
	iters: 700, epoch: 7 | loss: 0.1625170
	speed: 0.0058s/iter; left time: 83.8554s
	iters: 800, epoch: 7 | loss: 0.1990265
	speed: 0.0062s/iter; left time: 87.6439s
	iters: 900, epoch: 7 | loss: 0.1227858
	speed: 0.0048s/iter; left time: 67.9701s
	iters: 1000, epoch: 7 | loss: 0.3568876
	speed: 0.0055s/iter; left time: 77.2381s
Epoch: 7 cost time: 5.87921142578125
Epoch: 7, Steps: 1074 | Train Loss: 0.2184111 Vali Loss: 0.1365687 Test Loss: 0.2121068
EarlyStopping counter: 3 out of 5
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.1370096
	speed: 0.0245s/iter; left time: 339.5817s
	iters: 200, epoch: 8 | loss: 0.1464438
	speed: 0.0045s/iter; left time: 61.6510s
	iters: 300, epoch: 8 | loss: 0.1923755
	speed: 0.0049s/iter; left time: 67.0715s
	iters: 400, epoch: 8 | loss: 0.5267964
	speed: 0.0043s/iter; left time: 58.0806s
	iters: 500, epoch: 8 | loss: 0.1176558
	speed: 0.0047s/iter; left time: 62.7345s
	iters: 600, epoch: 8 | loss: 0.4661292
	speed: 0.0043s/iter; left time: 57.3513s
	iters: 700, epoch: 8 | loss: 0.2652853
	speed: 0.0046s/iter; left time: 61.2340s
	iters: 800, epoch: 8 | loss: 0.4483977
	speed: 0.0052s/iter; left time: 68.7023s
	iters: 900, epoch: 8 | loss: 0.1340726
	speed: 0.0052s/iter; left time: 68.2094s
	iters: 1000, epoch: 8 | loss: 0.1917600
	speed: 0.0045s/iter; left time: 58.3274s
Epoch: 8 cost time: 5.1557228565216064
Epoch: 8, Steps: 1074 | Train Loss: 0.2175674 Vali Loss: 0.1625059 Test Loss: 0.2877183
EarlyStopping counter: 4 out of 5
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.1286818
	speed: 0.0231s/iter; left time: 295.5116s
	iters: 200, epoch: 9 | loss: 0.1505721
	speed: 0.0053s/iter; left time: 67.0491s
	iters: 300, epoch: 9 | loss: 0.3031732
	speed: 0.0044s/iter; left time: 54.9936s
	iters: 400, epoch: 9 | loss: 0.3727508
	speed: 0.0053s/iter; left time: 66.0717s
	iters: 500, epoch: 9 | loss: 0.1316380
	speed: 0.0041s/iter; left time: 50.6266s
	iters: 600, epoch: 9 | loss: 0.1722589
	speed: 0.0042s/iter; left time: 52.1074s
	iters: 700, epoch: 9 | loss: 0.2976457
	speed: 0.0045s/iter; left time: 54.4980s
	iters: 800, epoch: 9 | loss: 0.1368347
	speed: 0.0054s/iter; left time: 64.7858s
	iters: 900, epoch: 9 | loss: 0.4158534
	speed: 0.0054s/iter; left time: 64.5705s
	iters: 1000, epoch: 9 | loss: 0.1241467
	speed: 0.0062s/iter; left time: 74.1803s
Epoch: 9 cost time: 5.548990488052368
Epoch: 9, Steps: 1074 | Train Loss: 0.2169727 Vali Loss: 0.1495084 Test Loss: 0.2520129
EarlyStopping counter: 5 out of 5
Early stopping
Total training time: 65.5480 seconds
>>>>>>>testing : ETTm2_96_96_DLinear_ETTm2_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed12890<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
data_set:  <data_provider.data_loader.Dataset_ETT_minute object at 0x0000023ABB0537F0>
mse:0.20030495524406433, mae:0.2920527756214142
