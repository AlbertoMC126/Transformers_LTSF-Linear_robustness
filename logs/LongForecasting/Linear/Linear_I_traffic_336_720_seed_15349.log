Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='Linear', model_id='traffic_336_720', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=720, root_path='./dataset/', save_pred_values=False, seed=15349, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_336_720_Linear_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15349>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11225
val 1037
test 2789
	iters: 100, epoch: 1 | loss: 0.4597988
	speed: 0.3550s/iter; left time: 4941.2985s
	iters: 200, epoch: 1 | loss: 0.4879059
	speed: 0.3379s/iter; left time: 4669.4276s
	iters: 300, epoch: 1 | loss: 0.4896727
	speed: 0.3384s/iter; left time: 4643.4206s
	iters: 400, epoch: 1 | loss: 0.4876109
	speed: 0.3382s/iter; left time: 4606.8982s
	iters: 500, epoch: 1 | loss: 0.5319937
	speed: 0.3380s/iter; left time: 4570.6488s
	iters: 600, epoch: 1 | loss: 0.4939359
	speed: 0.3377s/iter; left time: 4532.2769s
	iters: 700, epoch: 1 | loss: 0.5141554
	speed: 0.3373s/iter; left time: 4493.6066s
Epoch: 1 cost time: 238.81546092033386
Epoch: 1, Steps: 701 | Train Loss: 0.5139429 Vali Loss: 0.6927300 Test Loss: 0.8110781
Validation loss decreased (inf --> 0.692730).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.4682863
	speed: 0.6317s/iter; left time: 8351.1909s
	iters: 200, epoch: 2 | loss: 0.4824694
	speed: 0.8579s/iter; left time: 11255.6105s
	iters: 300, epoch: 2 | loss: 0.5243706
	speed: 0.8904s/iter; left time: 11593.1037s
	iters: 400, epoch: 2 | loss: 0.5179778
	speed: 0.8951s/iter; left time: 11564.2979s
	iters: 500, epoch: 2 | loss: 0.5302361
	speed: 0.8649s/iter; left time: 11088.4069s
	iters: 600, epoch: 2 | loss: 0.4997615
	speed: 0.8796s/iter; left time: 11188.3868s
	iters: 700, epoch: 2 | loss: 0.5195097
	speed: 0.8729s/iter; left time: 11015.6049s
Epoch: 2 cost time: 561.2695276737213
Epoch: 2, Steps: 701 | Train Loss: 0.5055786 Vali Loss: 0.6942247 Test Loss: 0.8056253
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.3534970
	speed: 1.4419s/iter; left time: 18051.6967s
	iters: 200, epoch: 3 | loss: 0.3307729
	speed: 0.8972s/iter; left time: 11142.5776s
	iters: 300, epoch: 3 | loss: 0.3540191
	speed: 0.9066s/iter; left time: 11167.8299s
	iters: 400, epoch: 3 | loss: 0.3310424
	speed: 0.8896s/iter; left time: 10869.9250s
	iters: 500, epoch: 3 | loss: 0.3703129
	speed: 0.8831s/iter; left time: 10702.4410s
	iters: 600, epoch: 3 | loss: 0.3674945
	speed: 0.8912s/iter; left time: 10711.6729s
	iters: 700, epoch: 3 | loss: 0.3838691
	speed: 0.8969s/iter; left time: 10690.4061s
Epoch: 3 cost time: 627.2575278282166
Epoch: 3, Steps: 701 | Train Loss: 0.3620124 Vali Loss: 0.5222150 Test Loss: 0.6080644
Validation loss decreased (0.692730 --> 0.522215).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.3024392
	speed: 1.4666s/iter; left time: 17332.4944s
	iters: 200, epoch: 4 | loss: 0.3127526
	speed: 0.9097s/iter; left time: 10660.0534s
	iters: 300, epoch: 4 | loss: 0.3100803
	speed: 0.9125s/iter; left time: 10601.2679s
	iters: 400, epoch: 4 | loss: 0.2994191
	speed: 0.8881s/iter; left time: 10229.1332s
	iters: 500, epoch: 4 | loss: 0.3344423
	speed: 0.8965s/iter; left time: 10236.0202s
	iters: 600, epoch: 4 | loss: 0.3196434
	speed: 0.8884s/iter; left time: 10055.3384s
	iters: 700, epoch: 4 | loss: 0.3015360
	speed: 0.8972s/iter; left time: 10064.4076s
Epoch: 4 cost time: 631.334422826767
Epoch: 4, Steps: 701 | Train Loss: 0.3122349 Vali Loss: 0.4654456 Test Loss: 0.5366224
Validation loss decreased (0.522215 --> 0.465446).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.2964420
	speed: 1.4538s/iter; left time: 16161.3922s
	iters: 200, epoch: 5 | loss: 0.2683307
	speed: 0.8957s/iter; left time: 9868.3282s
	iters: 300, epoch: 5 | loss: 0.2819790
	speed: 0.8855s/iter; left time: 9667.1319s
	iters: 400, epoch: 5 | loss: 0.3080773
	speed: 0.8843s/iter; left time: 9565.5917s
	iters: 500, epoch: 5 | loss: 0.3121707
	speed: 0.8976s/iter; left time: 9620.1110s
	iters: 600, epoch: 5 | loss: 0.2779086
	speed: 0.9013s/iter; left time: 9568.9353s
	iters: 700, epoch: 5 | loss: 0.2852839
	speed: 0.8897s/iter; left time: 9356.7230s
Epoch: 5 cost time: 626.4015979766846
Epoch: 5, Steps: 701 | Train Loss: 0.2902969 Vali Loss: 0.4409848 Test Loss: 0.5094248
Validation loss decreased (0.465446 --> 0.440985).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.2606124
	speed: 1.4546s/iter; left time: 15151.3448s
	iters: 200, epoch: 6 | loss: 0.2792173
	speed: 0.8986s/iter; left time: 9270.1758s
	iters: 300, epoch: 6 | loss: 0.2651712
	speed: 0.8839s/iter; left time: 9030.3326s
	iters: 400, epoch: 6 | loss: 0.2861940
	speed: 0.9094s/iter; left time: 9199.8736s
	iters: 500, epoch: 6 | loss: 0.2844523
	speed: 0.9112s/iter; left time: 9126.8679s
	iters: 600, epoch: 6 | loss: 0.2743691
	speed: 0.9154s/iter; left time: 9077.1306s
	iters: 700, epoch: 6 | loss: 0.2825027
	speed: 0.9059s/iter; left time: 8892.3952s
Epoch: 6 cost time: 633.5735945701599
Epoch: 6, Steps: 701 | Train Loss: 0.2789216 Vali Loss: 0.4308962 Test Loss: 0.4959750
Validation loss decreased (0.440985 --> 0.430896).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.2873005
	speed: 1.4203s/iter; left time: 13798.0167s
	iters: 200, epoch: 7 | loss: 0.2427497
	speed: 0.8786s/iter; left time: 8448.1165s
	iters: 300, epoch: 7 | loss: 0.2721651
	speed: 0.8947s/iter; left time: 8512.8676s
	iters: 400, epoch: 7 | loss: 0.2872488
	speed: 0.9049s/iter; left time: 8519.2747s
	iters: 500, epoch: 7 | loss: 0.2718321
	speed: 0.9029s/iter; left time: 8410.2518s
	iters: 600, epoch: 7 | loss: 0.2441426
	speed: 0.8925s/iter; left time: 8224.7333s
	iters: 700, epoch: 7 | loss: 0.2713628
	speed: 0.9098s/iter; left time: 8292.6608s
Epoch: 7 cost time: 626.0375244617462
Epoch: 7, Steps: 701 | Train Loss: 0.2727348 Vali Loss: 0.4246464 Test Loss: 0.4882485
Validation loss decreased (0.430896 --> 0.424646).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.2711373
	speed: 1.4629s/iter; left time: 13186.7455s
	iters: 200, epoch: 8 | loss: 0.2569813
	speed: 0.9159s/iter; left time: 8164.3728s
	iters: 300, epoch: 8 | loss: 0.2724961
	speed: 0.9160s/iter; left time: 8073.5266s
	iters: 400, epoch: 8 | loss: 0.2675297
	speed: 0.9017s/iter; left time: 7857.4338s
	iters: 500, epoch: 8 | loss: 0.2656275
	speed: 0.9129s/iter; left time: 7863.6929s
	iters: 600, epoch: 8 | loss: 0.2696938
	speed: 0.9108s/iter; left time: 7754.5769s
	iters: 700, epoch: 8 | loss: 0.2508643
	speed: 0.8880s/iter; left time: 7471.9389s
Epoch: 8 cost time: 635.3958568572998
Epoch: 8, Steps: 701 | Train Loss: 0.2693760 Vali Loss: 0.4220810 Test Loss: 0.4855677
Validation loss decreased (0.424646 --> 0.422081).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.3056478
	speed: 1.4545s/iter; left time: 12091.2991s
	iters: 200, epoch: 9 | loss: 0.2606624
	speed: 0.9107s/iter; left time: 7479.8806s
	iters: 300, epoch: 9 | loss: 0.2642003
	speed: 0.8922s/iter; left time: 7238.1334s
	iters: 400, epoch: 9 | loss: 0.2609737
	speed: 0.9047s/iter; left time: 7249.1519s
	iters: 500, epoch: 9 | loss: 0.2582138
	speed: 0.9002s/iter; left time: 7122.9929s
	iters: 600, epoch: 9 | loss: 0.2730365
	speed: 0.8996s/iter; left time: 7028.4602s
	iters: 700, epoch: 9 | loss: 0.2735178
	speed: 0.8861s/iter; left time: 6834.2650s
Epoch: 9 cost time: 630.9446697235107
Epoch: 9, Steps: 701 | Train Loss: 0.2674978 Vali Loss: 0.4210274 Test Loss: 0.4836004
Validation loss decreased (0.422081 --> 0.421027).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.2550019
	speed: 1.4743s/iter; left time: 11222.2224s
	iters: 200, epoch: 10 | loss: 0.2707857
	speed: 0.8974s/iter; left time: 6741.3001s
	iters: 300, epoch: 10 | loss: 0.2678612
	speed: 0.9155s/iter; left time: 6785.3922s
	iters: 400, epoch: 10 | loss: 0.2503625
	speed: 0.8941s/iter; left time: 6537.7620s
	iters: 500, epoch: 10 | loss: 0.2734546
	speed: 0.9033s/iter; left time: 6514.7558s
	iters: 600, epoch: 10 | loss: 0.2799665
	speed: 0.8742s/iter; left time: 6217.3051s
	iters: 700, epoch: 10 | loss: 0.2719743
	speed: 0.8957s/iter; left time: 6280.8120s
Epoch: 10 cost time: 630.1910333633423
Epoch: 10, Steps: 701 | Train Loss: 0.2664855 Vali Loss: 0.4205892 Test Loss: 0.4836554
Validation loss decreased (0.421027 --> 0.420589).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.2746669
	speed: 1.4628s/iter; left time: 10109.5269s
	iters: 200, epoch: 11 | loss: 0.2528424
	speed: 0.8958s/iter; left time: 6101.2653s
	iters: 300, epoch: 11 | loss: 0.2762070
	speed: 0.9027s/iter; left time: 6058.2208s
	iters: 400, epoch: 11 | loss: 0.2634549
	speed: 0.9170s/iter; left time: 6062.1602s
	iters: 500, epoch: 11 | loss: 0.2606764
	speed: 0.8712s/iter; left time: 5672.1776s
	iters: 600, epoch: 11 | loss: 0.2638138
	speed: 0.8885s/iter; left time: 5696.1453s
	iters: 700, epoch: 11 | loss: 0.2634353
	speed: 0.9087s/iter; left time: 5734.9749s
Epoch: 11 cost time: 629.7667090892792
Epoch: 11, Steps: 701 | Train Loss: 0.2659032 Vali Loss: 0.4202619 Test Loss: 0.4832256
Validation loss decreased (0.420589 --> 0.420262).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.2378772
	speed: 1.4778s/iter; left time: 9177.3245s
	iters: 200, epoch: 12 | loss: 0.2499330
	speed: 0.9179s/iter; left time: 5608.0675s
	iters: 300, epoch: 12 | loss: 0.2594237
	speed: 0.9166s/iter; left time: 5508.6598s
	iters: 400, epoch: 12 | loss: 0.2769009
	speed: 0.8867s/iter; left time: 5240.1135s
	iters: 500, epoch: 12 | loss: 0.2931875
	speed: 0.8856s/iter; left time: 5145.0735s
	iters: 600, epoch: 12 | loss: 0.2702810
	speed: 0.9100s/iter; left time: 5196.2127s
	iters: 700, epoch: 12 | loss: 0.2681983
	speed: 0.9203s/iter; left time: 5162.7288s
Epoch: 12 cost time: 636.1120584011078
Epoch: 12, Steps: 701 | Train Loss: 0.2656551 Vali Loss: 0.4203587 Test Loss: 0.4830778
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.2794656
	speed: 1.4533s/iter; left time: 8006.2546s
	iters: 200, epoch: 13 | loss: 0.2659860
	speed: 0.9162s/iter; left time: 4955.7928s
	iters: 300, epoch: 13 | loss: 0.3118376
	speed: 0.8944s/iter; left time: 4748.1664s
	iters: 400, epoch: 13 | loss: 0.2597940
	speed: 0.8799s/iter; left time: 4583.6512s
	iters: 500, epoch: 13 | loss: 0.2606994
	speed: 0.9050s/iter; left time: 4623.4090s
	iters: 600, epoch: 13 | loss: 0.2523679
	speed: 0.8988s/iter; left time: 4502.2284s
	iters: 700, epoch: 13 | loss: 0.2456935
	speed: 0.9075s/iter; left time: 4454.6962s
Epoch: 13 cost time: 631.8182621002197
Epoch: 13, Steps: 701 | Train Loss: 0.2654807 Vali Loss: 0.4202494 Test Loss: 0.4830220
Validation loss decreased (0.420262 --> 0.420249).  Saving model ...
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 14 | loss: 0.2491376
	speed: 1.4551s/iter; left time: 6996.3476s
	iters: 200, epoch: 14 | loss: 0.2585587
	speed: 0.8950s/iter; left time: 4213.8176s
	iters: 300, epoch: 14 | loss: 0.2636469
	speed: 0.8893s/iter; left time: 4097.7734s
	iters: 400, epoch: 14 | loss: 0.2687077
	speed: 0.9060s/iter; left time: 4084.4159s
	iters: 500, epoch: 14 | loss: 0.2700351
	speed: 0.9179s/iter; left time: 4046.1235s
	iters: 600, epoch: 14 | loss: 0.2646763
	speed: 0.9051s/iter; left time: 3899.0780s
	iters: 700, epoch: 14 | loss: 0.2684541
	speed: 0.9007s/iter; left time: 3790.1587s
Epoch: 14 cost time: 632.4015529155731
Epoch: 14, Steps: 701 | Train Loss: 0.2653978 Vali Loss: 0.4199581 Test Loss: 0.4829736
Validation loss decreased (0.420249 --> 0.419958).  Saving model ...
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 15 | loss: 0.2666651
	speed: 1.4675s/iter; left time: 6027.0536s
	iters: 200, epoch: 15 | loss: 0.2500097
	speed: 0.8804s/iter; left time: 3527.6657s
	iters: 300, epoch: 15 | loss: 0.2428720
	speed: 0.8927s/iter; left time: 3487.6084s
	iters: 400, epoch: 15 | loss: 0.2706008
	speed: 0.9060s/iter; left time: 3449.2756s
	iters: 500, epoch: 15 | loss: 0.2445747
	speed: 0.8909s/iter; left time: 3302.7325s
	iters: 600, epoch: 15 | loss: 0.2632306
	speed: 0.8949s/iter; left time: 3227.8952s
	iters: 700, epoch: 15 | loss: 0.2954322
	speed: 0.8964s/iter; left time: 3143.6247s
Epoch: 15 cost time: 628.2345700263977
Epoch: 15, Steps: 701 | Train Loss: 0.2653366 Vali Loss: 0.4200981 Test Loss: 0.4829656
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 16 | loss: 0.2593060
	speed: 1.4177s/iter; left time: 4828.7601s
	iters: 200, epoch: 16 | loss: 0.2544501
	speed: 0.8901s/iter; left time: 2942.6202s
	iters: 300, epoch: 16 | loss: 0.2767659
	speed: 0.9118s/iter; left time: 2923.1905s
	iters: 400, epoch: 16 | loss: 0.2537716
	speed: 0.9012s/iter; left time: 2799.1964s
	iters: 500, epoch: 16 | loss: 0.2690350
	speed: 0.9012s/iter; left time: 2708.9818s
	iters: 600, epoch: 16 | loss: 0.2668742
	speed: 0.9007s/iter; left time: 2617.3984s
	iters: 700, epoch: 16 | loss: 0.2421607
	speed: 0.8980s/iter; left time: 2519.7949s
Epoch: 16 cost time: 628.3545944690704
Epoch: 16, Steps: 701 | Train Loss: 0.2653279 Vali Loss: 0.4202699 Test Loss: 0.4829610
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 17 | loss: 0.2638744
	speed: 1.4289s/iter; left time: 3865.1406s
	iters: 200, epoch: 17 | loss: 0.2685474
	speed: 0.9160s/iter; left time: 2386.2073s
	iters: 300, epoch: 17 | loss: 0.2617871
	speed: 0.9031s/iter; left time: 2262.3755s
	iters: 400, epoch: 17 | loss: 0.2533857
	speed: 0.9074s/iter; left time: 2182.2223s
	iters: 500, epoch: 17 | loss: 0.2686170
	speed: 0.9044s/iter; left time: 2084.6974s
	iters: 600, epoch: 17 | loss: 0.2588164
	speed: 0.8886s/iter; left time: 1959.3203s
	iters: 700, epoch: 17 | loss: 0.2462994
	speed: 0.8877s/iter; left time: 1868.6296s
Epoch: 17 cost time: 630.3372478485107
Epoch: 17, Steps: 701 | Train Loss: 0.2653119 Vali Loss: 0.4203788 Test Loss: 0.4829580
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 18 | loss: 0.2856176
	speed: 1.4396s/iter; left time: 2884.8911s
	iters: 200, epoch: 18 | loss: 0.2612190
	speed: 0.9157s/iter; left time: 1743.5036s
	iters: 300, epoch: 18 | loss: 0.2627448
	speed: 0.9150s/iter; left time: 1650.5860s
	iters: 400, epoch: 18 | loss: 0.2646466
	speed: 0.9005s/iter; left time: 1534.4665s
	iters: 500, epoch: 18 | loss: 0.2514135
	speed: 0.9200s/iter; left time: 1475.7347s
	iters: 600, epoch: 18 | loss: 0.2641792
	speed: 0.8926s/iter; left time: 1342.4645s
	iters: 700, epoch: 18 | loss: 0.2845805
	speed: 0.8801s/iter; left time: 1235.6925s
Epoch: 18 cost time: 633.1365473270416
Epoch: 18, Steps: 701 | Train Loss: 0.2652996 Vali Loss: 0.4201652 Test Loss: 0.4829574
EarlyStopping counter: 4 out of 5
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 19 | loss: 0.2902175
	speed: 1.4458s/iter; left time: 1883.8282s
	iters: 200, epoch: 19 | loss: 0.2671011
	speed: 0.8974s/iter; left time: 1079.5635s
	iters: 300, epoch: 19 | loss: 0.2870282
	speed: 0.9085s/iter; left time: 1002.0813s
	iters: 400, epoch: 19 | loss: 0.2531220
	speed: 0.8992s/iter; left time: 901.9062s
	iters: 500, epoch: 19 | loss: 0.2717365
	speed: 0.8948s/iter; left time: 807.9899s
	iters: 600, epoch: 19 | loss: 0.2645217
	speed: 0.8689s/iter; left time: 697.7018s
	iters: 700, epoch: 19 | loss: 0.2838319
	speed: 0.9061s/iter; left time: 636.9800s
Epoch: 19 cost time: 628.7343871593475
Epoch: 19, Steps: 701 | Train Loss: 0.2652979 Vali Loss: 0.4199019 Test Loss: 0.4829569
Validation loss decreased (0.419958 --> 0.419902).  Saving model ...
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 20 | loss: 0.2578744
	speed: 1.4667s/iter; left time: 882.9532s
	iters: 200, epoch: 20 | loss: 0.2603735
	speed: 0.8945s/iter; left time: 449.0176s
	iters: 300, epoch: 20 | loss: 0.2579203
	speed: 0.9109s/iter; left time: 366.1951s
	iters: 400, epoch: 20 | loss: 0.2636905
	speed: 0.8890s/iter; left time: 268.4668s
	iters: 500, epoch: 20 | loss: 0.2742243
	speed: 0.8684s/iter; left time: 175.4147s
	iters: 600, epoch: 20 | loss: 0.2486970
	speed: 0.8921s/iter; left time: 90.9930s
	iters: 700, epoch: 20 | loss: 0.2662556
	speed: 0.9089s/iter; left time: 1.8178s
Epoch: 20 cost time: 627.7541425228119
Epoch: 20, Steps: 701 | Train Loss: 0.2652920 Vali Loss: 0.4198217 Test Loss: 0.4829565
Validation loss decreased (0.419902 --> 0.419822).  Saving model ...
Updating learning rate to 1.9073486328125e-08
>>>>>>>testing : traffic_336_720_Linear_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15349<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2789
mse:0.4827730059623718, mae:0.3305223882198334
