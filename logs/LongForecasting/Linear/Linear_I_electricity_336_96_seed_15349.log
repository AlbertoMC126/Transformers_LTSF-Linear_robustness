Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='Linear', model_id='Electricity_336_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=15349, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : Electricity_336_96_Linear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15349>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17981
val 2537
test 5165
	iters: 100, epoch: 1 | loss: 0.2167770
	speed: 0.0936s/iter; left time: 2092.8625s
	iters: 200, epoch: 1 | loss: 0.1763492
	speed: 0.0797s/iter; left time: 1773.9247s
	iters: 300, epoch: 1 | loss: 0.1749892
	speed: 0.0789s/iter; left time: 1749.5544s
	iters: 400, epoch: 1 | loss: 0.1908328
	speed: 0.0782s/iter; left time: 1724.7265s
	iters: 500, epoch: 1 | loss: 0.1776012
	speed: 0.0786s/iter; left time: 1725.9248s
	iters: 600, epoch: 1 | loss: 0.1939576
	speed: 0.0781s/iter; left time: 1707.6927s
	iters: 700, epoch: 1 | loss: 0.1985670
	speed: 0.0792s/iter; left time: 1723.2362s
	iters: 800, epoch: 1 | loss: 0.2011084
	speed: 0.0777s/iter; left time: 1683.8644s
	iters: 900, epoch: 1 | loss: 0.2002877
	speed: 0.0780s/iter; left time: 1682.1044s
	iters: 1000, epoch: 1 | loss: 0.1645474
	speed: 0.0777s/iter; left time: 1667.7524s
	iters: 1100, epoch: 1 | loss: 0.1976580
	speed: 0.0791s/iter; left time: 1689.3845s
Epoch: 1 cost time: 89.75061368942261
Epoch: 1, Steps: 1123 | Train Loss: 0.2095073 Vali Loss: 0.1877629 Test Loss: 0.2152054
Validation loss decreased (inf --> 0.187763).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.2049825
	speed: 0.2095s/iter; left time: 4449.3723s
	iters: 200, epoch: 2 | loss: 0.2056253
	speed: 0.0785s/iter; left time: 1659.3711s
	iters: 300, epoch: 2 | loss: 0.1948591
	speed: 0.0786s/iter; left time: 1653.7090s
	iters: 400, epoch: 2 | loss: 0.2014585
	speed: 0.0797s/iter; left time: 1669.2288s
	iters: 500, epoch: 2 | loss: 0.1740386
	speed: 0.0797s/iter; left time: 1661.0084s
	iters: 600, epoch: 2 | loss: 0.1932907
	speed: 0.0803s/iter; left time: 1664.4481s
	iters: 700, epoch: 2 | loss: 0.2280350
	speed: 0.0800s/iter; left time: 1651.4920s
	iters: 800, epoch: 2 | loss: 0.1988683
	speed: 0.0794s/iter; left time: 1629.8717s
	iters: 900, epoch: 2 | loss: 0.2186756
	speed: 0.0797s/iter; left time: 1628.7190s
	iters: 1000, epoch: 2 | loss: 0.2181503
	speed: 0.0798s/iter; left time: 1623.9013s
	iters: 1100, epoch: 2 | loss: 0.1863453
	speed: 0.0819s/iter; left time: 1657.8830s
Epoch: 2 cost time: 89.55903649330139
Epoch: 2, Steps: 1123 | Train Loss: 0.2000601 Vali Loss: 0.1795274 Test Loss: 0.2038080
Validation loss decreased (0.187763 --> 0.179527).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.1330922
	speed: 0.2129s/iter; left time: 4282.2768s
	iters: 200, epoch: 3 | loss: 0.1617578
	speed: 0.0792s/iter; left time: 1586.1287s
	iters: 300, epoch: 3 | loss: 0.1595934
	speed: 0.0792s/iter; left time: 1576.6719s
	iters: 400, epoch: 3 | loss: 0.1768113
	speed: 0.0799s/iter; left time: 1583.1107s
	iters: 500, epoch: 3 | loss: 0.1467581
	speed: 0.0783s/iter; left time: 1544.1193s
	iters: 600, epoch: 3 | loss: 0.1692802
	speed: 0.0784s/iter; left time: 1537.2518s
	iters: 700, epoch: 3 | loss: 0.1754093
	speed: 0.0793s/iter; left time: 1548.3625s
	iters: 800, epoch: 3 | loss: 0.1340001
	speed: 0.0793s/iter; left time: 1539.7970s
	iters: 900, epoch: 3 | loss: 0.1655265
	speed: 0.0793s/iter; left time: 1531.0849s
	iters: 1000, epoch: 3 | loss: 0.1439219
	speed: 0.0790s/iter; left time: 1518.8947s
	iters: 1100, epoch: 3 | loss: 0.1602667
	speed: 0.0789s/iter; left time: 1508.6307s
Epoch: 3 cost time: 88.74660873413086
Epoch: 3, Steps: 1123 | Train Loss: 0.1571858 Vali Loss: 0.1440551 Test Loss: 0.1675817
Validation loss decreased (0.179527 --> 0.144055).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.1281645
	speed: 0.2154s/iter; left time: 4090.2302s
	iters: 200, epoch: 4 | loss: 0.1221071
	speed: 0.0795s/iter; left time: 1501.8620s
	iters: 300, epoch: 4 | loss: 0.1398672
	speed: 0.0797s/iter; left time: 1497.1763s
	iters: 400, epoch: 4 | loss: 0.1484229
	speed: 0.0781s/iter; left time: 1460.4003s
	iters: 500, epoch: 4 | loss: 0.1367030
	speed: 0.0790s/iter; left time: 1469.3342s
	iters: 600, epoch: 4 | loss: 0.1177619
	speed: 0.0795s/iter; left time: 1470.5940s
	iters: 700, epoch: 4 | loss: 0.1423399
	speed: 0.0785s/iter; left time: 1443.4435s
	iters: 800, epoch: 4 | loss: 0.1287961
	speed: 0.0775s/iter; left time: 1416.9274s
	iters: 900, epoch: 4 | loss: 0.1839927
	speed: 0.0783s/iter; left time: 1423.6680s
	iters: 1000, epoch: 4 | loss: 0.1254834
	speed: 0.0781s/iter; left time: 1413.6549s
	iters: 1100, epoch: 4 | loss: 0.1176245
	speed: 0.0796s/iter; left time: 1432.1089s
Epoch: 4 cost time: 88.65375280380249
Epoch: 4, Steps: 1123 | Train Loss: 0.1415861 Vali Loss: 0.1283630 Test Loss: 0.1498484
Validation loss decreased (0.144055 --> 0.128363).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.1088090
	speed: 0.2069s/iter; left time: 3696.6884s
	iters: 200, epoch: 5 | loss: 0.1608069
	speed: 0.0786s/iter; left time: 1396.2129s
	iters: 300, epoch: 5 | loss: 0.1685210
	speed: 0.0782s/iter; left time: 1381.0393s
	iters: 400, epoch: 5 | loss: 0.1245044
	speed: 0.0789s/iter; left time: 1386.4557s
	iters: 500, epoch: 5 | loss: 0.1356078
	speed: 0.0784s/iter; left time: 1369.8384s
	iters: 600, epoch: 5 | loss: 0.1518025
	speed: 0.0785s/iter; left time: 1363.5774s
	iters: 700, epoch: 5 | loss: 0.1324178
	speed: 0.0778s/iter; left time: 1342.8593s
	iters: 800, epoch: 5 | loss: 0.1961515
	speed: 0.0789s/iter; left time: 1354.1319s
	iters: 900, epoch: 5 | loss: 0.1344559
	speed: 0.0784s/iter; left time: 1339.0501s
	iters: 1000, epoch: 5 | loss: 0.1511700
	speed: 0.0801s/iter; left time: 1359.0399s
	iters: 1100, epoch: 5 | loss: 0.1457198
	speed: 0.0790s/iter; left time: 1332.2337s
Epoch: 5 cost time: 88.2567822933197
Epoch: 5, Steps: 1123 | Train Loss: 0.1338026 Vali Loss: 0.1206783 Test Loss: 0.1412701
Validation loss decreased (0.128363 --> 0.120678).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.1526013
	speed: 0.2105s/iter; left time: 3524.6654s
	iters: 200, epoch: 6 | loss: 0.1207043
	speed: 0.0797s/iter; left time: 1326.5422s
	iters: 300, epoch: 6 | loss: 0.1295390
	speed: 0.0800s/iter; left time: 1323.1801s
	iters: 400, epoch: 6 | loss: 0.1309493
	speed: 0.0790s/iter; left time: 1298.7888s
	iters: 500, epoch: 6 | loss: 0.1192187
	speed: 0.0819s/iter; left time: 1338.8875s
	iters: 600, epoch: 6 | loss: 0.1198708
	speed: 0.0817s/iter; left time: 1327.7603s
	iters: 700, epoch: 6 | loss: 0.1223906
	speed: 0.0805s/iter; left time: 1299.4430s
	iters: 800, epoch: 6 | loss: 0.1375168
	speed: 0.0813s/iter; left time: 1304.0432s
	iters: 900, epoch: 6 | loss: 0.1492289
	speed: 0.0785s/iter; left time: 1251.1082s
	iters: 1000, epoch: 6 | loss: 0.1246871
	speed: 0.0783s/iter; left time: 1240.9979s
	iters: 1100, epoch: 6 | loss: 0.1611870
	speed: 0.0787s/iter; left time: 1239.1653s
Epoch: 6 cost time: 89.66136956214905
Epoch: 6, Steps: 1123 | Train Loss: 0.1296083 Vali Loss: 0.1174638 Test Loss: 0.1376442
Validation loss decreased (0.120678 --> 0.117464).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.1136122
	speed: 0.2116s/iter; left time: 3306.3020s
	iters: 200, epoch: 7 | loss: 0.1104276
	speed: 0.0796s/iter; left time: 1235.8188s
	iters: 300, epoch: 7 | loss: 0.1102512
	speed: 0.0785s/iter; left time: 1210.5670s
	iters: 400, epoch: 7 | loss: 0.1107398
	speed: 0.0815s/iter; left time: 1248.6356s
	iters: 500, epoch: 7 | loss: 0.1155720
	speed: 0.0791s/iter; left time: 1204.4162s
	iters: 600, epoch: 7 | loss: 0.1236086
	speed: 0.0788s/iter; left time: 1191.1271s
	iters: 700, epoch: 7 | loss: 0.1136659
	speed: 0.0789s/iter; left time: 1185.5986s
	iters: 800, epoch: 7 | loss: 0.1089008
	speed: 0.0792s/iter; left time: 1182.2763s
	iters: 900, epoch: 7 | loss: 0.1317481
	speed: 0.0789s/iter; left time: 1169.7598s
	iters: 1000, epoch: 7 | loss: 0.1304416
	speed: 0.0787s/iter; left time: 1157.9946s
	iters: 1100, epoch: 7 | loss: 0.1162445
	speed: 0.0793s/iter; left time: 1159.4832s
Epoch: 7 cost time: 89.08918571472168
Epoch: 7, Steps: 1123 | Train Loss: 0.1273517 Vali Loss: 0.1155898 Test Loss: 0.1357470
Validation loss decreased (0.117464 --> 0.115590).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.1795860
	speed: 0.2080s/iter; left time: 3015.3108s
	iters: 200, epoch: 8 | loss: 0.1362733
	speed: 0.0792s/iter; left time: 1141.1667s
	iters: 300, epoch: 8 | loss: 0.1270765
	speed: 0.0787s/iter; left time: 1125.2511s
	iters: 400, epoch: 8 | loss: 0.1060786
	speed: 0.0789s/iter; left time: 1120.5357s
	iters: 500, epoch: 8 | loss: 0.1476733
	speed: 0.0783s/iter; left time: 1103.7482s
	iters: 600, epoch: 8 | loss: 0.1094753
	speed: 0.0788s/iter; left time: 1103.1357s
	iters: 700, epoch: 8 | loss: 0.1673867
	speed: 0.0775s/iter; left time: 1076.6818s
	iters: 800, epoch: 8 | loss: 0.1202125
	speed: 0.0789s/iter; left time: 1088.1366s
	iters: 900, epoch: 8 | loss: 0.1055434
	speed: 0.0792s/iter; left time: 1084.9672s
	iters: 1000, epoch: 8 | loss: 0.1363873
	speed: 0.0808s/iter; left time: 1099.4463s
	iters: 1100, epoch: 8 | loss: 0.1066670
	speed: 0.0788s/iter; left time: 1064.0861s
Epoch: 8 cost time: 88.53262686729431
Epoch: 8, Steps: 1123 | Train Loss: 0.1260613 Vali Loss: 0.1146204 Test Loss: 0.1347354
Validation loss decreased (0.115590 --> 0.114620).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.1500000
	speed: 0.2110s/iter; left time: 2822.5806s
	iters: 200, epoch: 9 | loss: 0.1282577
	speed: 0.0787s/iter; left time: 1045.0958s
	iters: 300, epoch: 9 | loss: 0.1101928
	speed: 0.0791s/iter; left time: 1042.7371s
	iters: 400, epoch: 9 | loss: 0.1084378
	speed: 0.0779s/iter; left time: 1018.8139s
	iters: 500, epoch: 9 | loss: 0.1148516
	speed: 0.0789s/iter; left time: 1023.3905s
	iters: 600, epoch: 9 | loss: 0.1256431
	speed: 0.0799s/iter; left time: 1028.6902s
	iters: 700, epoch: 9 | loss: 0.1148951
	speed: 0.0806s/iter; left time: 1029.2345s
	iters: 800, epoch: 9 | loss: 0.1068464
	speed: 0.0801s/iter; left time: 1015.3681s
	iters: 900, epoch: 9 | loss: 0.1232190
	speed: 0.0809s/iter; left time: 1016.9951s
	iters: 1000, epoch: 9 | loss: 0.1227393
	speed: 0.0794s/iter; left time: 990.9368s
	iters: 1100, epoch: 9 | loss: 0.1542771
	speed: 0.0796s/iter; left time: 984.6411s
Epoch: 9 cost time: 89.21663069725037
Epoch: 9, Steps: 1123 | Train Loss: 0.1254335 Vali Loss: 0.1140787 Test Loss: 0.1341277
Validation loss decreased (0.114620 --> 0.114079).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.1677931
	speed: 0.2157s/iter; left time: 2643.4004s
	iters: 200, epoch: 10 | loss: 0.1346502
	speed: 0.0811s/iter; left time: 985.8429s
	iters: 300, epoch: 10 | loss: 0.0946431
	speed: 0.0820s/iter; left time: 988.4340s
	iters: 400, epoch: 10 | loss: 0.1425687
	speed: 0.0796s/iter; left time: 951.3595s
	iters: 500, epoch: 10 | loss: 0.1259391
	speed: 0.0792s/iter; left time: 938.3740s
	iters: 600, epoch: 10 | loss: 0.1164907
	speed: 0.0790s/iter; left time: 928.7970s
	iters: 700, epoch: 10 | loss: 0.1812973
	speed: 0.0785s/iter; left time: 914.6355s
	iters: 800, epoch: 10 | loss: 0.1165247
	speed: 0.0792s/iter; left time: 914.9713s
	iters: 900, epoch: 10 | loss: 0.1003418
	speed: 0.0798s/iter; left time: 914.5616s
	iters: 1000, epoch: 10 | loss: 0.1183504
	speed: 0.0793s/iter; left time: 900.6394s
	iters: 1100, epoch: 10 | loss: 0.1011339
	speed: 0.0796s/iter; left time: 896.1530s
Epoch: 10 cost time: 89.61946439743042
Epoch: 10, Steps: 1123 | Train Loss: 0.1250640 Vali Loss: 0.1141084 Test Loss: 0.1339081
EarlyStopping counter: 1 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.1240196
	speed: 0.1972s/iter; left time: 2194.9781s
	iters: 200, epoch: 11 | loss: 0.1178365
	speed: 0.0798s/iter; left time: 880.2486s
	iters: 300, epoch: 11 | loss: 0.1406588
	speed: 0.0791s/iter; left time: 864.5634s
	iters: 400, epoch: 11 | loss: 0.1167645
	speed: 0.0811s/iter; left time: 878.0089s
	iters: 500, epoch: 11 | loss: 0.1267890
	speed: 0.0831s/iter; left time: 891.8001s
	iters: 600, epoch: 11 | loss: 0.1256918
	speed: 0.0788s/iter; left time: 837.8690s
	iters: 700, epoch: 11 | loss: 0.1254189
	speed: 0.0777s/iter; left time: 818.0581s
	iters: 800, epoch: 11 | loss: 0.1225216
	speed: 0.0792s/iter; left time: 826.6369s
	iters: 900, epoch: 11 | loss: 0.1536901
	speed: 0.0788s/iter; left time: 813.8105s
	iters: 1000, epoch: 11 | loss: 0.1125388
	speed: 0.0790s/iter; left time: 808.3484s
	iters: 1100, epoch: 11 | loss: 0.1428682
	speed: 0.0780s/iter; left time: 790.0643s
Epoch: 11 cost time: 89.09018683433533
Epoch: 11, Steps: 1123 | Train Loss: 0.1248597 Vali Loss: 0.1139531 Test Loss: 0.1337904
Validation loss decreased (0.114079 --> 0.113953).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.1143055
	speed: 0.2118s/iter; left time: 2119.2223s
	iters: 200, epoch: 12 | loss: 0.1191415
	speed: 0.0781s/iter; left time: 773.3942s
	iters: 300, epoch: 12 | loss: 0.0988244
	speed: 0.0788s/iter; left time: 773.1874s
	iters: 400, epoch: 12 | loss: 0.1983655
	speed: 0.0777s/iter; left time: 753.9452s
	iters: 500, epoch: 12 | loss: 0.1506948
	speed: 0.0782s/iter; left time: 751.3484s
	iters: 600, epoch: 12 | loss: 0.1184270
	speed: 0.0781s/iter; left time: 742.3443s
	iters: 700, epoch: 12 | loss: 0.1308970
	speed: 0.0783s/iter; left time: 736.6369s
	iters: 800, epoch: 12 | loss: 0.1171262
	speed: 0.0783s/iter; left time: 729.0533s
	iters: 900, epoch: 12 | loss: 0.1495336
	speed: 0.0784s/iter; left time: 722.2055s
	iters: 1000, epoch: 12 | loss: 0.1270738
	speed: 0.0779s/iter; left time: 709.2839s
	iters: 1100, epoch: 12 | loss: 0.1154824
	speed: 0.0792s/iter; left time: 713.8214s
Epoch: 12 cost time: 87.97215604782104
Epoch: 12, Steps: 1123 | Train Loss: 0.1248085 Vali Loss: 0.1137824 Test Loss: 0.1337847
Validation loss decreased (0.113953 --> 0.113782).  Saving model ...
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.1171146
	speed: 0.2118s/iter; left time: 1881.6147s
	iters: 200, epoch: 13 | loss: 0.1213666
	speed: 0.0794s/iter; left time: 697.8500s
	iters: 300, epoch: 13 | loss: 0.0996301
	speed: 0.0787s/iter; left time: 683.4211s
	iters: 400, epoch: 13 | loss: 0.1317048
	speed: 0.0802s/iter; left time: 688.5715s
	iters: 500, epoch: 13 | loss: 0.1135690
	speed: 0.0794s/iter; left time: 674.1126s
	iters: 600, epoch: 13 | loss: 0.1588440
	speed: 0.0801s/iter; left time: 671.8948s
	iters: 700, epoch: 13 | loss: 0.1132413
	speed: 0.0820s/iter; left time: 679.5033s
	iters: 800, epoch: 13 | loss: 0.1135321
	speed: 0.0819s/iter; left time: 670.3979s
	iters: 900, epoch: 13 | loss: 0.1494401
	speed: 0.0803s/iter; left time: 648.9423s
	iters: 1000, epoch: 13 | loss: 0.1171626
	speed: 0.0795s/iter; left time: 634.5733s
	iters: 1100, epoch: 13 | loss: 0.1008537
	speed: 0.0796s/iter; left time: 627.8123s
Epoch: 13 cost time: 90.02953052520752
Epoch: 13, Steps: 1123 | Train Loss: 0.1247605 Vali Loss: 0.1138090 Test Loss: 0.1337422
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.1235925
	speed: 0.1987s/iter; left time: 1542.3093s
	iters: 200, epoch: 14 | loss: 0.1207683
	speed: 0.0795s/iter; left time: 608.9089s
	iters: 300, epoch: 14 | loss: 0.1400526
	speed: 0.0791s/iter; left time: 598.2597s
	iters: 400, epoch: 14 | loss: 0.1192871
	speed: 0.0805s/iter; left time: 600.3379s
	iters: 500, epoch: 14 | loss: 0.1277658
	speed: 0.0789s/iter; left time: 581.0893s
	iters: 600, epoch: 14 | loss: 0.1321710
	speed: 0.0784s/iter; left time: 569.3797s
	iters: 700, epoch: 14 | loss: 0.1066781
	speed: 0.0780s/iter; left time: 558.4866s
	iters: 800, epoch: 14 | loss: 0.1488760
	speed: 0.0808s/iter; left time: 570.7935s
	iters: 900, epoch: 14 | loss: 0.1390153
	speed: 0.0800s/iter; left time: 556.8680s
	iters: 1000, epoch: 14 | loss: 0.1290957
	speed: 0.0793s/iter; left time: 543.9262s
	iters: 1100, epoch: 14 | loss: 0.1735937
	speed: 0.0784s/iter; left time: 530.2932s
Epoch: 14 cost time: 88.93763256072998
Epoch: 14, Steps: 1123 | Train Loss: 0.1246961 Vali Loss: 0.1137640 Test Loss: 0.1337376
Validation loss decreased (0.113782 --> 0.113764).  Saving model ...
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.1376867
	speed: 0.2144s/iter; left time: 1423.3708s
	iters: 200, epoch: 15 | loss: 0.1930664
	speed: 0.0787s/iter; left time: 514.8258s
	iters: 300, epoch: 15 | loss: 0.1426774
	speed: 0.0794s/iter; left time: 511.1891s
	iters: 400, epoch: 15 | loss: 0.1182363
	speed: 0.0783s/iter; left time: 496.1309s
	iters: 500, epoch: 15 | loss: 0.1708774
	speed: 0.0786s/iter; left time: 490.1286s
	iters: 600, epoch: 15 | loss: 0.1105217
	speed: 0.0791s/iter; left time: 485.7960s
	iters: 700, epoch: 15 | loss: 0.1139084
	speed: 0.0798s/iter; left time: 482.0104s
	iters: 800, epoch: 15 | loss: 0.1376034
	speed: 0.0785s/iter; left time: 466.3723s
	iters: 900, epoch: 15 | loss: 0.1059997
	speed: 0.0786s/iter; left time: 459.0844s
	iters: 1000, epoch: 15 | loss: 0.1159770
	speed: 0.0789s/iter; left time: 452.9927s
	iters: 1100, epoch: 15 | loss: 0.1050281
	speed: 0.0788s/iter; left time: 444.3761s
Epoch: 15 cost time: 88.67979741096497
Epoch: 15, Steps: 1123 | Train Loss: 0.1246870 Vali Loss: 0.1138427 Test Loss: 0.1337366
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.1117602
	speed: 0.2017s/iter; left time: 1112.4507s
	iters: 200, epoch: 16 | loss: 0.1020046
	speed: 0.0782s/iter; left time: 423.5944s
	iters: 300, epoch: 16 | loss: 0.1096956
	speed: 0.0778s/iter; left time: 413.4301s
	iters: 400, epoch: 16 | loss: 0.1211019
	speed: 0.0797s/iter; left time: 415.4735s
	iters: 500, epoch: 16 | loss: 0.1172342
	speed: 0.0796s/iter; left time: 407.1546s
	iters: 600, epoch: 16 | loss: 0.1168123
	speed: 0.0789s/iter; left time: 395.6065s
	iters: 700, epoch: 16 | loss: 0.1311681
	speed: 0.0780s/iter; left time: 383.6130s
	iters: 800, epoch: 16 | loss: 0.1124229
	speed: 0.0787s/iter; left time: 379.2531s
	iters: 900, epoch: 16 | loss: 0.1082936
	speed: 0.0796s/iter; left time: 375.2560s
	iters: 1000, epoch: 16 | loss: 0.1128958
	speed: 0.0797s/iter; left time: 368.0176s
	iters: 1100, epoch: 16 | loss: 0.1248072
	speed: 0.0791s/iter; left time: 357.4265s
Epoch: 16 cost time: 88.62806177139282
Epoch: 16, Steps: 1123 | Train Loss: 0.1246950 Vali Loss: 0.1138856 Test Loss: 0.1337367
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 17 | loss: 0.1267117
	speed: 0.1970s/iter; left time: 865.3894s
	iters: 200, epoch: 17 | loss: 0.1355825
	speed: 0.0801s/iter; left time: 343.9453s
	iters: 300, epoch: 17 | loss: 0.1251881
	speed: 0.0805s/iter; left time: 337.4958s
	iters: 400, epoch: 17 | loss: 0.1243474
	speed: 0.0803s/iter; left time: 328.5321s
	iters: 500, epoch: 17 | loss: 0.1353297
	speed: 0.0825s/iter; left time: 329.4160s
	iters: 600, epoch: 17 | loss: 0.1521707
	speed: 0.0803s/iter; left time: 312.6168s
	iters: 700, epoch: 17 | loss: 0.1133676
	speed: 0.0790s/iter; left time: 299.5282s
	iters: 800, epoch: 17 | loss: 0.1170146
	speed: 0.0797s/iter; left time: 294.1583s
	iters: 900, epoch: 17 | loss: 0.1046281
	speed: 0.0786s/iter; left time: 282.3960s
	iters: 1000, epoch: 17 | loss: 0.1256655
	speed: 0.0789s/iter; left time: 275.5864s
	iters: 1100, epoch: 17 | loss: 0.1479967
	speed: 0.0791s/iter; left time: 268.4332s
Epoch: 17 cost time: 89.64568161964417
Epoch: 17, Steps: 1123 | Train Loss: 0.1246944 Vali Loss: 0.1138155 Test Loss: 0.1337372
EarlyStopping counter: 3 out of 5
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 18 | loss: 0.1050559
	speed: 0.2014s/iter; left time: 658.5026s
	iters: 200, epoch: 18 | loss: 0.1321951
	speed: 0.0791s/iter; left time: 250.7375s
	iters: 300, epoch: 18 | loss: 0.1206901
	speed: 0.0796s/iter; left time: 244.4907s
	iters: 400, epoch: 18 | loss: 0.1215441
	speed: 0.0785s/iter; left time: 233.0745s
	iters: 500, epoch: 18 | loss: 0.1246010
	speed: 0.0793s/iter; left time: 227.4563s
	iters: 600, epoch: 18 | loss: 0.1072302
	speed: 0.0789s/iter; left time: 218.5961s
	iters: 700, epoch: 18 | loss: 0.1171332
	speed: 0.0780s/iter; left time: 208.1726s
	iters: 800, epoch: 18 | loss: 0.1047332
	speed: 0.0837s/iter; left time: 215.0663s
	iters: 900, epoch: 18 | loss: 0.1163458
	speed: 0.0785s/iter; left time: 194.0125s
	iters: 1000, epoch: 18 | loss: 0.1404316
	speed: 0.0777s/iter; left time: 184.2508s
	iters: 1100, epoch: 18 | loss: 0.1503705
	speed: 0.0791s/iter; left time: 179.4658s
Epoch: 18 cost time: 89.09706282615662
Epoch: 18, Steps: 1123 | Train Loss: 0.1246985 Vali Loss: 0.1138395 Test Loss: 0.1337373
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 19 | loss: 0.1167913
	speed: 0.1988s/iter; left time: 426.7651s
	iters: 200, epoch: 19 | loss: 0.1161862
	speed: 0.0792s/iter; left time: 162.1789s
	iters: 300, epoch: 19 | loss: 0.1312549
	speed: 0.0791s/iter; left time: 153.9415s
	iters: 400, epoch: 19 | loss: 0.1557221
	speed: 0.0791s/iter; left time: 146.1847s
	iters: 500, epoch: 19 | loss: 0.1035582
	speed: 0.0787s/iter; left time: 137.4725s
	iters: 600, epoch: 19 | loss: 0.1365949
	speed: 0.0783s/iter; left time: 128.9415s
	iters: 700, epoch: 19 | loss: 0.1971602
	speed: 0.0774s/iter; left time: 119.6670s
	iters: 800, epoch: 19 | loss: 0.1137071
	speed: 0.0788s/iter; left time: 113.9849s
	iters: 900, epoch: 19 | loss: 0.1028188
	speed: 0.0787s/iter; left time: 105.9610s
	iters: 1000, epoch: 19 | loss: 0.1525540
	speed: 0.0785s/iter; left time: 97.8882s
	iters: 1100, epoch: 19 | loss: 0.1060296
	speed: 0.0780s/iter; left time: 89.4949s
Epoch: 19 cost time: 88.25002527236938
Epoch: 19, Steps: 1123 | Train Loss: 0.1246788 Vali Loss: 0.1137891 Test Loss: 0.1337373
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : Electricity_336_96_Linear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15349<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5165
mse:0.13371597230434418, mae:0.2304159700870514
