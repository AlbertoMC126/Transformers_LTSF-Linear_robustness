Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='NLinear', model_id='traffic_336_192', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=192, root_path='./dataset/', save_pred_values=False, seed=15726, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_336_192_NLinear_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15726>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11753
val 1565
test 3317
	iters: 100, epoch: 1 | loss: 0.9250107
	speed: 0.3151s/iter; left time: 4594.4488s
	iters: 200, epoch: 1 | loss: 0.6650660
	speed: 0.3006s/iter; left time: 4352.4519s
	iters: 300, epoch: 1 | loss: 0.5847301
	speed: 0.3003s/iter; left time: 4318.1333s
	iters: 400, epoch: 1 | loss: 1.8097806
	speed: 0.3009s/iter; left time: 4296.5064s
	iters: 500, epoch: 1 | loss: 1.2804704
	speed: 0.3016s/iter; left time: 4277.4676s
	iters: 600, epoch: 1 | loss: 1.8304119
	speed: 0.3025s/iter; left time: 4260.1286s
	iters: 700, epoch: 1 | loss: 0.6932420
	speed: 0.3026s/iter; left time: 4231.1215s
Epoch: 1 cost time: 222.8492968082428
Epoch: 1, Steps: 734 | Train Loss: 1.1112491 Vali Loss: 1.2711666 Test Loss: 1.2295171
Validation loss decreased (inf --> 1.271167).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 1.0250218
	speed: 0.6059s/iter; left time: 8390.5356s
	iters: 200, epoch: 2 | loss: 0.8790447
	speed: 0.3007s/iter; left time: 4134.1413s
	iters: 300, epoch: 2 | loss: 1.5350329
	speed: 0.3021s/iter; left time: 4123.2514s
	iters: 400, epoch: 2 | loss: 0.8770845
	speed: 0.3024s/iter; left time: 4096.8999s
	iters: 500, epoch: 2 | loss: 0.8127453
	speed: 0.3017s/iter; left time: 4057.0978s
	iters: 600, epoch: 2 | loss: 1.2831931
	speed: 0.3020s/iter; left time: 4030.6321s
	iters: 700, epoch: 2 | loss: 0.6855252
	speed: 0.3027s/iter; left time: 4009.9363s
Epoch: 2 cost time: 221.46670746803284
Epoch: 2, Steps: 734 | Train Loss: 0.9841122 Vali Loss: 0.9863095 Test Loss: 1.0882872
Validation loss decreased (1.271167 --> 0.986309).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.3542261
	speed: 0.6077s/iter; left time: 7968.1691s
	iters: 200, epoch: 3 | loss: 0.3278990
	speed: 0.3022s/iter; left time: 3933.1544s
	iters: 300, epoch: 3 | loss: 0.3329625
	speed: 0.3027s/iter; left time: 3908.4468s
	iters: 400, epoch: 3 | loss: 0.3241441
	speed: 0.2997s/iter; left time: 3840.5880s
	iters: 500, epoch: 3 | loss: 0.4135573
	speed: 0.3022s/iter; left time: 3842.4230s
	iters: 600, epoch: 3 | loss: 0.3317716
	speed: 0.3004s/iter; left time: 3788.4206s
	iters: 700, epoch: 3 | loss: 0.3589768
	speed: 0.3025s/iter; left time: 3784.9386s
Epoch: 3 cost time: 221.475026845932
Epoch: 3, Steps: 734 | Train Loss: 0.3775461 Vali Loss: 0.5232312 Test Loss: 0.6477026
Validation loss decreased (0.986309 --> 0.523231).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.3015413
	speed: 0.6076s/iter; left time: 7521.0324s
	iters: 200, epoch: 4 | loss: 0.2692270
	speed: 0.3021s/iter; left time: 3709.1520s
	iters: 300, epoch: 4 | loss: 0.3030737
	speed: 0.3017s/iter; left time: 3673.9634s
	iters: 400, epoch: 4 | loss: 0.2827119
	speed: 0.3025s/iter; left time: 3653.3847s
	iters: 500, epoch: 4 | loss: 0.2998123
	speed: 0.3009s/iter; left time: 3604.5177s
	iters: 600, epoch: 4 | loss: 0.2626936
	speed: 0.3014s/iter; left time: 3579.8950s
	iters: 700, epoch: 4 | loss: 0.3037669
	speed: 0.3010s/iter; left time: 3545.9339s
Epoch: 4 cost time: 221.44861149787903
Epoch: 4, Steps: 734 | Train Loss: 0.2881840 Vali Loss: 0.4116765 Test Loss: 0.5060285
Validation loss decreased (0.523231 --> 0.411676).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.2431248
	speed: 0.6058s/iter; left time: 7054.3813s
	iters: 200, epoch: 5 | loss: 0.2652239
	speed: 0.3006s/iter; left time: 3470.5658s
	iters: 300, epoch: 5 | loss: 0.2469918
	speed: 0.3032s/iter; left time: 3470.6590s
	iters: 400, epoch: 5 | loss: 0.2686026
	speed: 0.3024s/iter; left time: 3430.6723s
	iters: 500, epoch: 5 | loss: 0.2613806
	speed: 0.3005s/iter; left time: 3379.3317s
	iters: 600, epoch: 5 | loss: 0.2551318
	speed: 0.3021s/iter; left time: 3366.8045s
	iters: 700, epoch: 5 | loss: 0.2678694
	speed: 0.3009s/iter; left time: 3323.7189s
Epoch: 5 cost time: 221.44388556480408
Epoch: 5, Steps: 734 | Train Loss: 0.2647461 Vali Loss: 0.3746509 Test Loss: 0.4673049
Validation loss decreased (0.411676 --> 0.374651).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.2705594
	speed: 0.6083s/iter; left time: 6636.6575s
	iters: 200, epoch: 6 | loss: 0.2386174
	speed: 0.3026s/iter; left time: 3271.0648s
	iters: 300, epoch: 6 | loss: 0.2483561
	speed: 0.3004s/iter; left time: 3217.1943s
	iters: 400, epoch: 6 | loss: 0.2628539
	speed: 0.3026s/iter; left time: 3210.5671s
	iters: 500, epoch: 6 | loss: 0.2195479
	speed: 0.3022s/iter; left time: 3176.7609s
	iters: 600, epoch: 6 | loss: 0.2654510
	speed: 0.3020s/iter; left time: 3144.5906s
	iters: 700, epoch: 6 | loss: 0.2797888
	speed: 0.3016s/iter; left time: 3109.6686s
Epoch: 6 cost time: 221.70933079719543
Epoch: 6, Steps: 734 | Train Loss: 0.2544242 Vali Loss: 0.3624524 Test Loss: 0.4513465
Validation loss decreased (0.374651 --> 0.362452).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.2639502
	speed: 0.6055s/iter; left time: 6162.4012s
	iters: 200, epoch: 7 | loss: 0.2479348
	speed: 0.3022s/iter; left time: 3045.4720s
	iters: 300, epoch: 7 | loss: 0.2248840
	speed: 0.3017s/iter; left time: 3009.6311s
	iters: 400, epoch: 7 | loss: 0.2503985
	speed: 0.3019s/iter; left time: 2981.3879s
	iters: 500, epoch: 7 | loss: 0.2617359
	speed: 0.3004s/iter; left time: 2937.3915s
	iters: 600, epoch: 7 | loss: 0.2556781
	speed: 0.3020s/iter; left time: 2922.9237s
	iters: 700, epoch: 7 | loss: 0.2433752
	speed: 0.3003s/iter; left time: 2876.3000s
Epoch: 7 cost time: 221.2348370552063
Epoch: 7, Steps: 734 | Train Loss: 0.2488597 Vali Loss: 0.3566559 Test Loss: 0.4442809
Validation loss decreased (0.362452 --> 0.356656).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.2426821
	speed: 0.6075s/iter; left time: 5736.8183s
	iters: 200, epoch: 8 | loss: 0.2368100
	speed: 0.3020s/iter; left time: 2821.4333s
	iters: 300, epoch: 8 | loss: 0.2685952
	speed: 0.3024s/iter; left time: 2795.1676s
	iters: 400, epoch: 8 | loss: 0.2488373
	speed: 0.3027s/iter; left time: 2767.5343s
	iters: 500, epoch: 8 | loss: 0.2367456
	speed: 0.3042s/iter; left time: 2750.6669s
	iters: 600, epoch: 8 | loss: 0.2490321
	speed: 0.3032s/iter; left time: 2711.1561s
	iters: 700, epoch: 8 | loss: 0.2581528
	speed: 0.3029s/iter; left time: 2678.7926s
Epoch: 8 cost time: 222.34264063835144
Epoch: 8, Steps: 734 | Train Loss: 0.2456367 Vali Loss: 0.3527691 Test Loss: 0.4402299
Validation loss decreased (0.356656 --> 0.352769).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.2250467
	speed: 0.6087s/iter; left time: 5301.0642s
	iters: 200, epoch: 9 | loss: 0.2187955
	speed: 0.3041s/iter; left time: 2618.0941s
	iters: 300, epoch: 9 | loss: 0.2509712
	speed: 0.3035s/iter; left time: 2582.8312s
	iters: 400, epoch: 9 | loss: 0.2535694
	speed: 0.3047s/iter; left time: 2561.8430s
	iters: 500, epoch: 9 | loss: 0.2694447
	speed: 0.3037s/iter; left time: 2523.3322s
	iters: 600, epoch: 9 | loss: 0.2537706
	speed: 0.3026s/iter; left time: 2484.0317s
	iters: 700, epoch: 9 | loss: 0.2611069
	speed: 0.3036s/iter; left time: 2462.1061s
Epoch: 9 cost time: 222.94996762275696
Epoch: 9, Steps: 734 | Train Loss: 0.2437364 Vali Loss: 0.3513620 Test Loss: 0.4383939
Validation loss decreased (0.352769 --> 0.351362).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.2241888
	speed: 0.6119s/iter; left time: 4879.8833s
	iters: 200, epoch: 10 | loss: 0.2329071
	speed: 0.3053s/iter; left time: 2403.9369s
	iters: 300, epoch: 10 | loss: 0.2260580
	speed: 0.3039s/iter; left time: 2362.5863s
	iters: 400, epoch: 10 | loss: 0.2282185
	speed: 0.3047s/iter; left time: 2338.2871s
	iters: 500, epoch: 10 | loss: 0.2211664
	speed: 0.3036s/iter; left time: 2299.4625s
	iters: 600, epoch: 10 | loss: 0.2161904
	speed: 0.3044s/iter; left time: 2275.5187s
	iters: 700, epoch: 10 | loss: 0.2405947
	speed: 0.3043s/iter; left time: 2243.9309s
Epoch: 10 cost time: 223.49063277244568
Epoch: 10, Steps: 734 | Train Loss: 0.2426386 Vali Loss: 0.3505737 Test Loss: 0.4373973
Validation loss decreased (0.351362 --> 0.350574).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.2311499
	speed: 0.6097s/iter; left time: 4414.4943s
	iters: 200, epoch: 11 | loss: 0.2507291
	speed: 0.3046s/iter; left time: 2174.8031s
	iters: 300, epoch: 11 | loss: 0.2352175
	speed: 0.3039s/iter; left time: 2139.6778s
	iters: 400, epoch: 11 | loss: 0.2233604
	speed: 0.3043s/iter; left time: 2112.4294s
	iters: 500, epoch: 11 | loss: 0.2448061
	speed: 0.3043s/iter; left time: 2081.5978s
	iters: 600, epoch: 11 | loss: 0.2200921
	speed: 0.3033s/iter; left time: 2044.6036s
	iters: 700, epoch: 11 | loss: 0.2228976
	speed: 0.3045s/iter; left time: 2021.9645s
Epoch: 11 cost time: 223.18530344963074
Epoch: 11, Steps: 734 | Train Loss: 0.2420232 Vali Loss: 0.3497977 Test Loss: 0.4365612
Validation loss decreased (0.350574 --> 0.349798).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.2426343
	speed: 0.6091s/iter; left time: 3963.6178s
	iters: 200, epoch: 12 | loss: 0.2335221
	speed: 0.3039s/iter; left time: 1947.2793s
	iters: 300, epoch: 12 | loss: 0.2613141
	speed: 0.3049s/iter; left time: 1923.2915s
	iters: 400, epoch: 12 | loss: 0.2354001
	speed: 0.3034s/iter; left time: 1883.5007s
	iters: 500, epoch: 12 | loss: 0.2606372
	speed: 0.3032s/iter; left time: 1851.6269s
	iters: 600, epoch: 12 | loss: 0.2376673
	speed: 0.3042s/iter; left time: 1827.5129s
	iters: 700, epoch: 12 | loss: 0.2721475
	speed: 0.3038s/iter; left time: 1794.5088s
Epoch: 12 cost time: 223.11735582351685
Epoch: 12, Steps: 734 | Train Loss: 0.2416921 Vali Loss: 0.3493018 Test Loss: 0.4363387
Validation loss decreased (0.349798 --> 0.349302).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.2588236
	speed: 0.6104s/iter; left time: 3523.6368s
	iters: 200, epoch: 13 | loss: 0.2401712
	speed: 0.3052s/iter; left time: 1731.1702s
	iters: 300, epoch: 13 | loss: 0.2317808
	speed: 0.3039s/iter; left time: 1693.6281s
	iters: 400, epoch: 13 | loss: 0.2564898
	speed: 0.3049s/iter; left time: 1668.8697s
	iters: 500, epoch: 13 | loss: 0.2315477
	speed: 0.3034s/iter; left time: 1630.0341s
	iters: 600, epoch: 13 | loss: 0.2153259
	speed: 0.3042s/iter; left time: 1603.9776s
	iters: 700, epoch: 13 | loss: 0.2580129
	speed: 0.3039s/iter; left time: 1571.8935s
Epoch: 13 cost time: 223.33119130134583
Epoch: 13, Steps: 734 | Train Loss: 0.2415206 Vali Loss: 0.3493512 Test Loss: 0.4362566
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 14 | loss: 0.2272098
	speed: 0.6050s/iter; left time: 3048.4639s
	iters: 200, epoch: 14 | loss: 0.2278314
	speed: 0.3041s/iter; left time: 1502.0121s
	iters: 300, epoch: 14 | loss: 0.2333136
	speed: 0.3052s/iter; left time: 1476.8020s
	iters: 400, epoch: 14 | loss: 0.2459534
	speed: 0.3037s/iter; left time: 1439.4656s
	iters: 500, epoch: 14 | loss: 0.2849120
	speed: 0.3041s/iter; left time: 1410.9439s
	iters: 600, epoch: 14 | loss: 0.2377215
	speed: 0.3037s/iter; left time: 1378.3724s
	iters: 700, epoch: 14 | loss: 0.2292781
	speed: 0.3051s/iter; left time: 1354.4739s
Epoch: 14 cost time: 223.35106110572815
Epoch: 14, Steps: 734 | Train Loss: 0.2414401 Vali Loss: 0.3491875 Test Loss: 0.4362159
Validation loss decreased (0.349302 --> 0.349187).  Saving model ...
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 15 | loss: 0.2837765
	speed: 0.6117s/iter; left time: 2633.4137s
	iters: 200, epoch: 15 | loss: 0.2399798
	speed: 0.3041s/iter; left time: 1278.8153s
	iters: 300, epoch: 15 | loss: 0.2539526
	speed: 0.3044s/iter; left time: 1249.6092s
	iters: 400, epoch: 15 | loss: 0.2212200
	speed: 0.3045s/iter; left time: 1219.4921s
	iters: 500, epoch: 15 | loss: 0.2491957
	speed: 0.3054s/iter; left time: 1192.4487s
	iters: 600, epoch: 15 | loss: 0.2318199
	speed: 0.3037s/iter; left time: 1155.7089s
	iters: 700, epoch: 15 | loss: 0.2388322
	speed: 0.3038s/iter; left time: 1125.6281s
Epoch: 15 cost time: 223.41900181770325
Epoch: 15, Steps: 734 | Train Loss: 0.2413341 Vali Loss: 0.3493237 Test Loss: 0.4361913
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 16 | loss: 0.2749968
	speed: 0.6062s/iter; left time: 2164.8268s
	iters: 200, epoch: 16 | loss: 0.2192315
	speed: 0.3041s/iter; left time: 1055.6603s
	iters: 300, epoch: 16 | loss: 0.2432563
	speed: 0.3036s/iter; left time: 1023.2710s
	iters: 400, epoch: 16 | loss: 0.2484188
	speed: 0.3039s/iter; left time: 994.0305s
	iters: 500, epoch: 16 | loss: 0.2556221
	speed: 0.3044s/iter; left time: 965.2006s
	iters: 600, epoch: 16 | loss: 0.2380444
	speed: 0.3032s/iter; left time: 931.0978s
	iters: 700, epoch: 16 | loss: 0.2051960
	speed: 0.3036s/iter; left time: 901.9286s
Epoch: 16 cost time: 222.95672988891602
Epoch: 16, Steps: 734 | Train Loss: 0.2413362 Vali Loss: 0.3493139 Test Loss: 0.4361829
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 17 | loss: 0.2589065
	speed: 0.6072s/iter; left time: 1722.7027s
	iters: 200, epoch: 17 | loss: 0.2488426
	speed: 0.3038s/iter; left time: 831.6256s
	iters: 300, epoch: 17 | loss: 0.2389022
	speed: 0.3042s/iter; left time: 802.1418s
	iters: 400, epoch: 17 | loss: 0.2513286
	speed: 0.3041s/iter; left time: 771.3833s
	iters: 500, epoch: 17 | loss: 0.2436597
	speed: 0.3038s/iter; left time: 740.2886s
	iters: 600, epoch: 17 | loss: 0.2308064
	speed: 0.3042s/iter; left time: 710.9753s
	iters: 700, epoch: 17 | loss: 0.2173273
	speed: 0.3049s/iter; left time: 681.9655s
Epoch: 17 cost time: 223.26063203811646
Epoch: 17, Steps: 734 | Train Loss: 0.2413187 Vali Loss: 0.3492999 Test Loss: 0.4361801
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 18 | loss: 0.2848395
	speed: 0.6083s/iter; left time: 1279.2584s
	iters: 200, epoch: 18 | loss: 0.2632798
	speed: 0.3036s/iter; left time: 608.1938s
	iters: 300, epoch: 18 | loss: 0.2140269
	speed: 0.3041s/iter; left time: 578.6490s
	iters: 400, epoch: 18 | loss: 0.2408011
	speed: 0.3042s/iter; left time: 548.5089s
	iters: 500, epoch: 18 | loss: 0.2350613
	speed: 0.3037s/iter; left time: 517.1334s
	iters: 600, epoch: 18 | loss: 0.2358507
	speed: 0.3040s/iter; left time: 487.3208s
	iters: 700, epoch: 18 | loss: 0.2490666
	speed: 0.3036s/iter; left time: 456.2562s
Epoch: 18 cost time: 223.0745484828949
Epoch: 18, Steps: 734 | Train Loss: 0.2413250 Vali Loss: 0.3487982 Test Loss: 0.4361802
Validation loss decreased (0.349187 --> 0.348798).  Saving model ...
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 19 | loss: 0.2407380
	speed: 0.6108s/iter; left time: 836.1263s
	iters: 200, epoch: 19 | loss: 0.2494638
	speed: 0.3049s/iter; left time: 386.9639s
	iters: 300, epoch: 19 | loss: 0.2046847
	speed: 0.3041s/iter; left time: 355.5127s
	iters: 400, epoch: 19 | loss: 0.2304528
	speed: 0.3052s/iter; left time: 326.2875s
	iters: 500, epoch: 19 | loss: 0.2292712
	speed: 0.3036s/iter; left time: 294.2073s
	iters: 600, epoch: 19 | loss: 0.2339367
	speed: 0.3028s/iter; left time: 263.1216s
	iters: 700, epoch: 19 | loss: 0.2144805
	speed: 0.3037s/iter; left time: 233.5627s
Epoch: 19 cost time: 223.22493863105774
Epoch: 19, Steps: 734 | Train Loss: 0.2412936 Vali Loss: 0.3494394 Test Loss: 0.4361801
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 20 | loss: 0.2664546
	speed: 0.6064s/iter; left time: 385.0323s
	iters: 200, epoch: 20 | loss: 0.2660651
	speed: 0.3031s/iter; left time: 162.1774s
	iters: 300, epoch: 20 | loss: 0.2164753
	speed: 0.3039s/iter; left time: 132.2130s
	iters: 400, epoch: 20 | loss: 0.2171635
	speed: 0.3038s/iter; left time: 101.7808s
	iters: 500, epoch: 20 | loss: 0.2350780
	speed: 0.3042s/iter; left time: 71.4835s
	iters: 600, epoch: 20 | loss: 0.2194556
	speed: 0.3029s/iter; left time: 40.8863s
	iters: 700, epoch: 20 | loss: 0.2143059
	speed: 0.3039s/iter; left time: 10.6367s
Epoch: 20 cost time: 222.9358332157135
Epoch: 20, Steps: 734 | Train Loss: 0.2413075 Vali Loss: 0.3494132 Test Loss: 0.4361801
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.9073486328125e-08
>>>>>>>testing : traffic_336_192_NLinear_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15726<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3317
mse:0.4358333945274353, mae:0.2988901138305664
