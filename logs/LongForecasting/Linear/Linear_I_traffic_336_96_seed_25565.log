Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='Linear', model_id='traffic_336_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=25565, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_336_96_Linear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed25565>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11849
val 1661
test 3413
	iters: 100, epoch: 1 | loss: 0.4114251
	speed: 0.3174s/iter; left time: 4665.6879s
	iters: 200, epoch: 1 | loss: 0.4727390
	speed: 0.3044s/iter; left time: 4444.1625s
	iters: 300, epoch: 1 | loss: 0.4329515
	speed: 0.3042s/iter; left time: 4411.2480s
	iters: 400, epoch: 1 | loss: 0.4428443
	speed: 0.3048s/iter; left time: 4389.7100s
	iters: 500, epoch: 1 | loss: 0.5099547
	speed: 0.3044s/iter; left time: 4353.6706s
	iters: 600, epoch: 1 | loss: 0.4638898
	speed: 0.3040s/iter; left time: 4317.1326s
	iters: 700, epoch: 1 | loss: 0.4537091
	speed: 0.3035s/iter; left time: 4279.9677s
Epoch: 1 cost time: 226.70091223716736
Epoch: 1, Steps: 740 | Train Loss: 0.4731912 Vali Loss: 0.6399610 Test Loss: 0.7562731
Validation loss decreased (inf --> 0.639961).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.4665368
	speed: 0.6195s/iter; left time: 8649.0127s
	iters: 200, epoch: 2 | loss: 0.4635706
	speed: 0.3050s/iter; left time: 4227.2252s
	iters: 300, epoch: 2 | loss: 0.4630431
	speed: 0.3037s/iter; left time: 4178.7127s
	iters: 400, epoch: 2 | loss: 0.4738100
	speed: 0.3033s/iter; left time: 4143.5220s
	iters: 500, epoch: 2 | loss: 0.5568682
	speed: 0.3055s/iter; left time: 4142.6894s
	iters: 600, epoch: 2 | loss: 0.4517156
	speed: 0.3033s/iter; left time: 4083.2573s
	iters: 700, epoch: 2 | loss: 0.4588852
	speed: 0.3036s/iter; left time: 4056.2303s
Epoch: 2 cost time: 225.0690562725067
Epoch: 2, Steps: 740 | Train Loss: 0.4662845 Vali Loss: 0.6132941 Test Loss: 0.7214805
Validation loss decreased (0.639961 --> 0.613294).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.3215062
	speed: 0.6138s/iter; left time: 8115.2467s
	iters: 200, epoch: 3 | loss: 0.3898482
	speed: 0.3045s/iter; left time: 3995.1371s
	iters: 300, epoch: 3 | loss: 0.2814944
	speed: 0.3041s/iter; left time: 3960.3235s
	iters: 400, epoch: 3 | loss: 0.3443047
	speed: 0.3055s/iter; left time: 3946.8179s
	iters: 500, epoch: 3 | loss: 0.2779911
	speed: 0.3036s/iter; left time: 3892.7589s
	iters: 600, epoch: 3 | loss: 0.3265584
	speed: 0.3042s/iter; left time: 3869.6210s
	iters: 700, epoch: 3 | loss: 0.3588180
	speed: 0.3035s/iter; left time: 3830.0270s
Epoch: 3 cost time: 225.0546908378601
Epoch: 3, Steps: 740 | Train Loss: 0.3229103 Vali Loss: 0.4508375 Test Loss: 0.5393978
Validation loss decreased (0.613294 --> 0.450838).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.2378357
	speed: 0.6130s/iter; left time: 7650.6182s
	iters: 200, epoch: 4 | loss: 0.2829824
	speed: 0.3041s/iter; left time: 3765.3138s
	iters: 300, epoch: 4 | loss: 0.2753913
	speed: 0.3035s/iter; left time: 3727.4593s
	iters: 400, epoch: 4 | loss: 0.2453733
	speed: 0.3030s/iter; left time: 3690.7576s
	iters: 500, epoch: 4 | loss: 0.2442380
	speed: 0.3035s/iter; left time: 3666.2216s
	iters: 600, epoch: 4 | loss: 0.3115932
	speed: 0.3038s/iter; left time: 3639.8946s
	iters: 700, epoch: 4 | loss: 0.2578233
	speed: 0.3036s/iter; left time: 3607.3517s
Epoch: 4 cost time: 224.65841817855835
Epoch: 4, Steps: 740 | Train Loss: 0.2753258 Vali Loss: 0.3916092 Test Loss: 0.4756765
Validation loss decreased (0.450838 --> 0.391609).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.2530569
	speed: 0.6143s/iter; left time: 7212.2176s
	iters: 200, epoch: 5 | loss: 0.2502326
	speed: 0.3039s/iter; left time: 3538.0511s
	iters: 300, epoch: 5 | loss: 0.2500555
	speed: 0.3053s/iter; left time: 3523.9313s
	iters: 400, epoch: 5 | loss: 0.2560287
	speed: 0.3033s/iter; left time: 3470.1000s
	iters: 500, epoch: 5 | loss: 0.2210615
	speed: 0.3036s/iter; left time: 3443.3885s
	iters: 600, epoch: 5 | loss: 0.2385449
	speed: 0.3031s/iter; left time: 3406.6676s
	iters: 700, epoch: 5 | loss: 0.2449981
	speed: 0.3049s/iter; left time: 3397.1946s
Epoch: 5 cost time: 224.96412777900696
Epoch: 5, Steps: 740 | Train Loss: 0.2545182 Vali Loss: 0.3702244 Test Loss: 0.4506255
Validation loss decreased (0.391609 --> 0.370224).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.2191539
	speed: 0.6164s/iter; left time: 6780.9944s
	iters: 200, epoch: 6 | loss: 0.2431203
	speed: 0.3049s/iter; left time: 3323.3003s
	iters: 300, epoch: 6 | loss: 0.2606025
	speed: 0.3043s/iter; left time: 3286.8763s
	iters: 400, epoch: 6 | loss: 0.2460841
	speed: 0.3051s/iter; left time: 3264.7248s
	iters: 500, epoch: 6 | loss: 0.2307749
	speed: 0.3034s/iter; left time: 3216.1490s
	iters: 600, epoch: 6 | loss: 0.2877617
	speed: 0.3041s/iter; left time: 3193.4016s
	iters: 700, epoch: 6 | loss: 0.2409562
	speed: 0.3043s/iter; left time: 3165.0849s
Epoch: 6 cost time: 225.22453093528748
Epoch: 6, Steps: 740 | Train Loss: 0.2438180 Vali Loss: 0.3579929 Test Loss: 0.4375677
Validation loss decreased (0.370224 --> 0.357993).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.2416982
	speed: 0.6161s/iter; left time: 6321.4038s
	iters: 200, epoch: 7 | loss: 0.2135157
	speed: 0.3037s/iter; left time: 3085.9340s
	iters: 300, epoch: 7 | loss: 0.2297551
	speed: 0.3043s/iter; left time: 3061.4189s
	iters: 400, epoch: 7 | loss: 0.2352360
	speed: 0.3033s/iter; left time: 3021.3795s
	iters: 500, epoch: 7 | loss: 0.2276412
	speed: 0.3045s/iter; left time: 3002.5548s
	iters: 600, epoch: 7 | loss: 0.2434509
	speed: 0.3041s/iter; left time: 2968.7554s
	iters: 700, epoch: 7 | loss: 0.2404172
	speed: 0.3037s/iter; left time: 2934.1731s
Epoch: 7 cost time: 225.04320621490479
Epoch: 7, Steps: 740 | Train Loss: 0.2379414 Vali Loss: 0.3529527 Test Loss: 0.4313524
Validation loss decreased (0.357993 --> 0.352953).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.2274009
	speed: 0.6132s/iter; left time: 5837.8646s
	iters: 200, epoch: 8 | loss: 0.2504379
	speed: 0.3040s/iter; left time: 2864.1066s
	iters: 300, epoch: 8 | loss: 0.2462104
	speed: 0.3039s/iter; left time: 2832.9383s
	iters: 400, epoch: 8 | loss: 0.2703050
	speed: 0.3054s/iter; left time: 2815.7059s
	iters: 500, epoch: 8 | loss: 0.2624671
	speed: 0.3046s/iter; left time: 2778.1636s
	iters: 600, epoch: 8 | loss: 0.2706913
	speed: 0.3047s/iter; left time: 2748.9237s
	iters: 700, epoch: 8 | loss: 0.2536781
	speed: 0.3048s/iter; left time: 2719.3590s
Epoch: 8 cost time: 225.3334367275238
Epoch: 8, Steps: 740 | Train Loss: 0.2347075 Vali Loss: 0.3503576 Test Loss: 0.4281760
Validation loss decreased (0.352953 --> 0.350358).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.2424093
	speed: 0.6150s/iter; left time: 5400.1175s
	iters: 200, epoch: 9 | loss: 0.2473051
	speed: 0.3038s/iter; left time: 2637.3171s
	iters: 300, epoch: 9 | loss: 0.2781231
	speed: 0.3026s/iter; left time: 2596.9266s
	iters: 400, epoch: 9 | loss: 0.2172045
	speed: 0.3035s/iter; left time: 2573.7035s
	iters: 500, epoch: 9 | loss: 0.2348769
	speed: 0.3038s/iter; left time: 2545.8843s
	iters: 600, epoch: 9 | loss: 0.2449468
	speed: 0.3034s/iter; left time: 2512.4643s
	iters: 700, epoch: 9 | loss: 0.2161740
	speed: 0.3041s/iter; left time: 2487.5404s
Epoch: 9 cost time: 224.64971780776978
Epoch: 9, Steps: 740 | Train Loss: 0.2329350 Vali Loss: 0.3489738 Test Loss: 0.4267232
Validation loss decreased (0.350358 --> 0.348974).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.2418339
	speed: 0.6141s/iter; left time: 4938.3476s
	iters: 200, epoch: 10 | loss: 0.2026120
	speed: 0.3038s/iter; left time: 2412.3232s
	iters: 300, epoch: 10 | loss: 0.2615250
	speed: 0.3048s/iter; left time: 2390.0247s
	iters: 400, epoch: 10 | loss: 0.2066271
	speed: 0.3053s/iter; left time: 2363.1202s
	iters: 500, epoch: 10 | loss: 0.2052285
	speed: 0.3056s/iter; left time: 2334.7626s
	iters: 600, epoch: 10 | loss: 0.2142519
	speed: 0.3051s/iter; left time: 2300.7037s
	iters: 700, epoch: 10 | loss: 0.2150573
	speed: 0.3059s/iter; left time: 2276.3474s
Epoch: 10 cost time: 225.5753583908081
Epoch: 10, Steps: 740 | Train Loss: 0.2319594 Vali Loss: 0.3481317 Test Loss: 0.4260573
Validation loss decreased (0.348974 --> 0.348132).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.2049747
	speed: 0.6156s/iter; left time: 4494.5887s
	iters: 200, epoch: 11 | loss: 0.2433575
	speed: 0.3045s/iter; left time: 2193.0412s
	iters: 300, epoch: 11 | loss: 0.2158942
	speed: 0.3040s/iter; left time: 2158.9118s
	iters: 400, epoch: 11 | loss: 0.2703177
	speed: 0.3041s/iter; left time: 2128.8102s
	iters: 500, epoch: 11 | loss: 0.2488675
	speed: 0.3034s/iter; left time: 2093.7836s
	iters: 600, epoch: 11 | loss: 0.2564634
	speed: 0.3042s/iter; left time: 2068.6651s
	iters: 700, epoch: 11 | loss: 0.2179738
	speed: 0.3030s/iter; left time: 2030.6156s
Epoch: 11 cost time: 225.0483856201172
Epoch: 11, Steps: 740 | Train Loss: 0.2313860 Vali Loss: 0.3477430 Test Loss: 0.4257103
Validation loss decreased (0.348132 --> 0.347743).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.2011142
	speed: 0.6135s/iter; left time: 4025.4621s
	iters: 200, epoch: 12 | loss: 0.2352844
	speed: 0.3040s/iter; left time: 1963.9066s
	iters: 300, epoch: 12 | loss: 0.2125071
	speed: 0.3025s/iter; left time: 1924.4643s
	iters: 400, epoch: 12 | loss: 0.2227274
	speed: 0.3033s/iter; left time: 1898.7871s
	iters: 500, epoch: 12 | loss: 0.2401109
	speed: 0.3043s/iter; left time: 1874.7414s
	iters: 600, epoch: 12 | loss: 0.2379159
	speed: 0.3050s/iter; left time: 1848.8762s
	iters: 700, epoch: 12 | loss: 0.2207448
	speed: 0.3050s/iter; left time: 1818.0948s
Epoch: 12 cost time: 225.0428385734558
Epoch: 12, Steps: 740 | Train Loss: 0.2311434 Vali Loss: 0.3479333 Test Loss: 0.4256245
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.2457295
	speed: 0.6150s/iter; left time: 3580.0128s
	iters: 200, epoch: 13 | loss: 0.2414189
	speed: 0.3059s/iter; left time: 1749.9367s
	iters: 300, epoch: 13 | loss: 0.2864501
	speed: 0.3053s/iter; left time: 1715.9709s
	iters: 400, epoch: 13 | loss: 0.2057440
	speed: 0.3050s/iter; left time: 1684.0100s
	iters: 500, epoch: 13 | loss: 0.2471091
	speed: 0.3045s/iter; left time: 1650.8137s
	iters: 600, epoch: 13 | loss: 0.2146333
	speed: 0.3045s/iter; left time: 1620.4594s
	iters: 700, epoch: 13 | loss: 0.2173123
	speed: 0.3047s/iter; left time: 1591.0888s
Epoch: 13 cost time: 225.697114944458
Epoch: 13, Steps: 740 | Train Loss: 0.2309555 Vali Loss: 0.3475389 Test Loss: 0.4255850
Validation loss decreased (0.347743 --> 0.347539).  Saving model ...
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 14 | loss: 0.2475169
	speed: 0.6151s/iter; left time: 3125.0760s
	iters: 200, epoch: 14 | loss: 0.2247202
	speed: 0.3059s/iter; left time: 1523.5494s
	iters: 300, epoch: 14 | loss: 0.2384526
	speed: 0.3055s/iter; left time: 1491.1385s
	iters: 400, epoch: 14 | loss: 0.2351584
	speed: 0.3045s/iter; left time: 1455.9216s
	iters: 500, epoch: 14 | loss: 0.2409956
	speed: 0.3047s/iter; left time: 1426.1423s
	iters: 600, epoch: 14 | loss: 0.2452416
	speed: 0.3034s/iter; left time: 1389.7820s
	iters: 700, epoch: 14 | loss: 0.2283126
	speed: 0.3039s/iter; left time: 1361.5663s
Epoch: 14 cost time: 225.41083073616028
Epoch: 14, Steps: 740 | Train Loss: 0.2308973 Vali Loss: 0.3479632 Test Loss: 0.4255436
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 15 | loss: 0.2159850
	speed: 0.6121s/iter; left time: 2657.2203s
	iters: 200, epoch: 15 | loss: 0.2053323
	speed: 0.3041s/iter; left time: 1289.8338s
	iters: 300, epoch: 15 | loss: 0.2292581
	speed: 0.3035s/iter; left time: 1256.6949s
	iters: 400, epoch: 15 | loss: 0.1938697
	speed: 0.3036s/iter; left time: 1226.9085s
	iters: 500, epoch: 15 | loss: 0.2374299
	speed: 0.3039s/iter; left time: 1197.7283s
	iters: 600, epoch: 15 | loss: 0.2193754
	speed: 0.3047s/iter; left time: 1170.2369s
	iters: 700, epoch: 15 | loss: 0.2420048
	speed: 0.3042s/iter; left time: 1138.0708s
Epoch: 15 cost time: 224.99753069877625
Epoch: 15, Steps: 740 | Train Loss: 0.2308779 Vali Loss: 0.3473569 Test Loss: 0.4255359
Validation loss decreased (0.347539 --> 0.347357).  Saving model ...
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 16 | loss: 0.2031968
	speed: 0.6156s/iter; left time: 2216.8514s
	iters: 200, epoch: 16 | loss: 0.2419087
	speed: 0.3045s/iter; left time: 1066.1922s
	iters: 300, epoch: 16 | loss: 0.2394836
	speed: 0.3055s/iter; left time: 1039.0851s
	iters: 400, epoch: 16 | loss: 0.2241583
	speed: 0.3038s/iter; left time: 1002.8579s
	iters: 500, epoch: 16 | loss: 0.2074590
	speed: 0.3059s/iter; left time: 979.2309s
	iters: 600, epoch: 16 | loss: 0.2637030
	speed: 0.3054s/iter; left time: 947.0716s
	iters: 700, epoch: 16 | loss: 0.2330440
	speed: 0.3048s/iter; left time: 914.6757s
Epoch: 16 cost time: 225.83134841918945
Epoch: 16, Steps: 740 | Train Loss: 0.2308476 Vali Loss: 0.3472877 Test Loss: 0.4255347
Validation loss decreased (0.347357 --> 0.347288).  Saving model ...
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 17 | loss: 0.2475587
	speed: 0.6166s/iter; left time: 1764.2103s
	iters: 200, epoch: 17 | loss: 0.2262000
	speed: 0.3051s/iter; left time: 842.3073s
	iters: 300, epoch: 17 | loss: 0.2061011
	speed: 0.3045s/iter; left time: 810.2802s
	iters: 400, epoch: 17 | loss: 0.2470579
	speed: 0.3048s/iter; left time: 780.4999s
	iters: 500, epoch: 17 | loss: 0.2639897
	speed: 0.3034s/iter; left time: 746.7402s
	iters: 600, epoch: 17 | loss: 0.2083295
	speed: 0.3037s/iter; left time: 717.0352s
	iters: 700, epoch: 17 | loss: 0.2380757
	speed: 0.3037s/iter; left time: 686.6941s
Epoch: 17 cost time: 225.33654403686523
Epoch: 17, Steps: 740 | Train Loss: 0.2308440 Vali Loss: 0.3474644 Test Loss: 0.4255338
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 18 | loss: 0.2137402
	speed: 0.6162s/iter; left time: 1306.9764s
	iters: 200, epoch: 18 | loss: 0.2054071
	speed: 0.3051s/iter; left time: 616.5819s
	iters: 300, epoch: 18 | loss: 0.1936132
	speed: 0.3048s/iter; left time: 585.5914s
	iters: 400, epoch: 18 | loss: 0.2259552
	speed: 0.3043s/iter; left time: 554.1729s
	iters: 500, epoch: 18 | loss: 0.2446883
	speed: 0.3055s/iter; left time: 525.8302s
	iters: 600, epoch: 18 | loss: 0.2266341
	speed: 0.3043s/iter; left time: 493.3182s
	iters: 700, epoch: 18 | loss: 0.2024564
	speed: 0.3040s/iter; left time: 462.3299s
Epoch: 18 cost time: 225.5761330127716
Epoch: 18, Steps: 740 | Train Loss: 0.2307815 Vali Loss: 0.3476800 Test Loss: 0.4255338
EarlyStopping counter: 2 out of 5
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 19 | loss: 0.2100466
	speed: 0.6141s/iter; left time: 848.0621s
	iters: 200, epoch: 19 | loss: 0.2136813
	speed: 0.3066s/iter; left time: 392.7485s
	iters: 300, epoch: 19 | loss: 0.2426616
	speed: 0.3055s/iter; left time: 360.7904s
	iters: 400, epoch: 19 | loss: 0.2470157
	speed: 0.3063s/iter; left time: 331.1189s
	iters: 500, epoch: 19 | loss: 0.2456574
	speed: 0.3045s/iter; left time: 298.6731s
	iters: 600, epoch: 19 | loss: 0.1941684
	speed: 0.3042s/iter; left time: 268.0309s
	iters: 700, epoch: 19 | loss: 0.1951946
	speed: 0.3047s/iter; left time: 237.9966s
Epoch: 19 cost time: 225.89614701271057
Epoch: 19, Steps: 740 | Train Loss: 0.2308152 Vali Loss: 0.3480800 Test Loss: 0.4255338
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 20 | loss: 0.2454557
	speed: 0.6153s/iter; left time: 394.3899s
	iters: 200, epoch: 20 | loss: 0.2277509
	speed: 0.3051s/iter; left time: 165.0784s
	iters: 300, epoch: 20 | loss: 0.2156923
	speed: 0.3051s/iter; left time: 134.5448s
	iters: 400, epoch: 20 | loss: 0.2526260
	speed: 0.3050s/iter; left time: 104.0155s
	iters: 500, epoch: 20 | loss: 0.2129418
	speed: 0.3059s/iter; left time: 73.7320s
	iters: 600, epoch: 20 | loss: 0.2183336
	speed: 0.3048s/iter; left time: 42.9798s
	iters: 700, epoch: 20 | loss: 0.2130015
	speed: 0.3053s/iter; left time: 12.5185s
Epoch: 20 cost time: 225.8964400291443
Epoch: 20, Steps: 740 | Train Loss: 0.2308155 Vali Loss: 0.3476416 Test Loss: 0.4255337
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.9073486328125e-08
>>>>>>>testing : traffic_336_96_Linear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed25565<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3413
mse:0.4257890582084656, mae:0.29805415868759155
