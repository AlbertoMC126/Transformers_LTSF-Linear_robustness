Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTh2', data_path='ETTh2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.05, loss='mse', lradj='type1', model='DLinear', model_id='ETTh2_96_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=32598, seq_len=96, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTh2_96_96_DLinear_ETTh2_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed32598>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8449
data_set:  <data_provider.data_loader.Dataset_ETT_hour object at 0x000001921B0504E0>
val 2785
data_set:  <data_provider.data_loader.Dataset_ETT_hour object at 0x0000019268627D68>
test 2785
data_set:  <data_provider.data_loader.Dataset_ETT_hour object at 0x000001921B050438>
Total number of trainable parameters: 130368
Total number of parameters: 130368
	iters: 100, epoch: 1 | loss: 0.9027748
	speed: 0.0046s/iter; left time: 47.6084s
	iters: 200, epoch: 1 | loss: 1.0418562
	speed: 0.0041s/iter; left time: 42.7158s
	iters: 300, epoch: 1 | loss: 1.3207023
	speed: 0.0048s/iter; left time: 49.2437s
	iters: 400, epoch: 1 | loss: 1.0637236
	speed: 0.0044s/iter; left time: 44.7030s
	iters: 500, epoch: 1 | loss: 1.4968157
	speed: 0.0042s/iter; left time: 42.5294s
Epoch: 1 cost time: 2.323761463165283
Epoch: 1, Steps: 528 | Train Loss: 1.4555393 Vali Loss: 1.0853057 Test Loss: 2.3882027
Validation loss decreased (inf --> 1.085306).  Saving model ...
Updating learning rate to 0.05
	iters: 100, epoch: 2 | loss: 0.8432086
	speed: 0.0128s/iter; left time: 126.9631s
	iters: 200, epoch: 2 | loss: 1.3387492
	speed: 0.0049s/iter; left time: 48.1715s
	iters: 300, epoch: 2 | loss: 0.4801476
	speed: 0.0039s/iter; left time: 37.5001s
	iters: 400, epoch: 2 | loss: 1.2355489
	speed: 0.0039s/iter; left time: 37.5842s
	iters: 500, epoch: 2 | loss: 3.2244563
	speed: 0.0049s/iter; left time: 47.0057s
Epoch: 2 cost time: 2.3925065994262695
Epoch: 2, Steps: 528 | Train Loss: 1.6505531 Vali Loss: 2.0391021 Test Loss: 5.1424379
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.025
	iters: 100, epoch: 3 | loss: 1.4947143
	speed: 0.0087s/iter; left time: 82.1497s
	iters: 200, epoch: 3 | loss: 0.3985423
	speed: 0.0046s/iter; left time: 43.2331s
	iters: 300, epoch: 3 | loss: 0.5275820
	speed: 0.0049s/iter; left time: 45.4131s
	iters: 400, epoch: 3 | loss: 0.8038098
	speed: 0.0046s/iter; left time: 41.9175s
	iters: 500, epoch: 3 | loss: 0.3259831
	speed: 0.0044s/iter; left time: 39.5736s
Epoch: 3 cost time: 2.3565585613250732
Epoch: 3, Steps: 528 | Train Loss: 0.6398647 Vali Loss: 0.5338298 Test Loss: 1.0808588
Validation loss decreased (1.085306 --> 0.533830).  Saving model ...
Updating learning rate to 0.0125
	iters: 100, epoch: 4 | loss: 0.5877135
	speed: 0.0106s/iter; left time: 94.0501s
	iters: 200, epoch: 4 | loss: 0.6148669
	speed: 0.0042s/iter; left time: 36.4888s
	iters: 300, epoch: 4 | loss: 0.2334641
	speed: 0.0036s/iter; left time: 31.5841s
	iters: 400, epoch: 4 | loss: 0.2839265
	speed: 0.0049s/iter; left time: 42.1363s
	iters: 500, epoch: 4 | loss: 1.2369131
	speed: 0.0042s/iter; left time: 35.7544s
Epoch: 4 cost time: 2.254702091217041
Epoch: 4, Steps: 528 | Train Loss: 0.4778313 Vali Loss: 0.3297592 Test Loss: 0.5467057
Validation loss decreased (0.533830 --> 0.329759).  Saving model ...
Updating learning rate to 0.00625
	iters: 100, epoch: 5 | loss: 0.2628380
	speed: 0.0117s/iter; left time: 97.8037s
	iters: 200, epoch: 5 | loss: 0.5078364
	speed: 0.0035s/iter; left time: 28.5983s
	iters: 300, epoch: 5 | loss: 0.5660674
	speed: 0.0037s/iter; left time: 30.4966s
	iters: 400, epoch: 5 | loss: 0.4354722
	speed: 0.0036s/iter; left time: 29.0634s
	iters: 500, epoch: 5 | loss: 0.2235591
	speed: 0.0050s/iter; left time: 39.7202s
Epoch: 5 cost time: 2.101865768432617
Epoch: 5, Steps: 528 | Train Loss: 0.4249400 Vali Loss: 0.3162059 Test Loss: 0.5872791
Validation loss decreased (0.329759 --> 0.316206).  Saving model ...
Updating learning rate to 0.003125
	iters: 100, epoch: 6 | loss: 0.3977651
	speed: 0.0117s/iter; left time: 91.5601s
	iters: 200, epoch: 6 | loss: 0.7100677
	speed: 0.0042s/iter; left time: 32.2940s
	iters: 300, epoch: 6 | loss: 0.2859278
	speed: 0.0041s/iter; left time: 31.0120s
	iters: 400, epoch: 6 | loss: 0.2296807
	speed: 0.0038s/iter; left time: 28.2113s
	iters: 500, epoch: 6 | loss: 0.2289383
	speed: 0.0059s/iter; left time: 43.6155s
Epoch: 6 cost time: 2.4432897567749023
Epoch: 6, Steps: 528 | Train Loss: 0.3954545 Vali Loss: 0.3812706 Test Loss: 0.8177094
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0015625
	iters: 100, epoch: 7 | loss: 0.2904478
	speed: 0.0102s/iter; left time: 74.6763s
	iters: 200, epoch: 7 | loss: 0.4613559
	speed: 0.0043s/iter; left time: 30.8400s
	iters: 300, epoch: 7 | loss: 0.3632616
	speed: 0.0040s/iter; left time: 28.5358s
	iters: 400, epoch: 7 | loss: 0.4878687
	speed: 0.0045s/iter; left time: 31.8112s
	iters: 500, epoch: 7 | loss: 0.7586805
	speed: 0.0039s/iter; left time: 27.1454s
Epoch: 7 cost time: 2.294344663619995
Epoch: 7, Steps: 528 | Train Loss: 0.3845010 Vali Loss: 0.2884911 Test Loss: 0.5266016
Validation loss decreased (0.316206 --> 0.288491).  Saving model ...
Updating learning rate to 0.00078125
	iters: 100, epoch: 8 | loss: 0.1685662
	speed: 0.0131s/iter; left time: 88.3735s
	iters: 200, epoch: 8 | loss: 0.3042763
	speed: 0.0033s/iter; left time: 22.2791s
	iters: 300, epoch: 8 | loss: 0.3078493
	speed: 0.0040s/iter; left time: 26.0583s
	iters: 400, epoch: 8 | loss: 0.2440344
	speed: 0.0045s/iter; left time: 28.9015s
	iters: 500, epoch: 8 | loss: 0.3920899
	speed: 0.0047s/iter; left time: 29.6034s
Epoch: 8 cost time: 2.2301666736602783
Epoch: 8, Steps: 528 | Train Loss: 0.3766890 Vali Loss: 0.2964109 Test Loss: 0.5608101
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.000390625
	iters: 100, epoch: 9 | loss: 0.1953429
	speed: 0.0098s/iter; left time: 61.0001s
	iters: 200, epoch: 9 | loss: 0.2949101
	speed: 0.0037s/iter; left time: 22.8473s
	iters: 300, epoch: 9 | loss: 0.2740246
	speed: 0.0040s/iter; left time: 24.0119s
	iters: 400, epoch: 9 | loss: 0.2705019
	speed: 0.0037s/iter; left time: 21.8757s
	iters: 500, epoch: 9 | loss: 0.2195477
	speed: 0.0043s/iter; left time: 25.2162s
Epoch: 9 cost time: 2.108398675918579
Epoch: 9, Steps: 528 | Train Loss: 0.3726973 Vali Loss: 0.3159544 Test Loss: 0.6271849
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.0001953125
	iters: 100, epoch: 10 | loss: 0.3817930
	speed: 0.0118s/iter; left time: 67.1349s
	iters: 200, epoch: 10 | loss: 0.5128290
	speed: 0.0040s/iter; left time: 22.4149s
	iters: 300, epoch: 10 | loss: 0.3200039
	speed: 0.0040s/iter; left time: 21.7808s
	iters: 400, epoch: 10 | loss: 0.3248820
	speed: 0.0045s/iter; left time: 24.3965s
	iters: 500, epoch: 10 | loss: 0.3711821
	speed: 0.0045s/iter; left time: 23.8543s
Epoch: 10 cost time: 2.250370502471924
Epoch: 10, Steps: 528 | Train Loss: 0.3702695 Vali Loss: 0.2969593 Test Loss: 0.5507923
EarlyStopping counter: 3 out of 5
Updating learning rate to 9.765625e-05
	iters: 100, epoch: 11 | loss: 0.3165107
	speed: 0.0079s/iter; left time: 41.1423s
	iters: 200, epoch: 11 | loss: 1.0790564
	speed: 0.0035s/iter; left time: 17.7195s
	iters: 300, epoch: 11 | loss: 0.1637087
	speed: 0.0034s/iter; left time: 17.0111s
	iters: 400, epoch: 11 | loss: 0.6514468
	speed: 0.0044s/iter; left time: 21.6052s
	iters: 500, epoch: 11 | loss: 0.5060081
	speed: 0.0040s/iter; left time: 19.0467s
Epoch: 11 cost time: 1.9433848857879639
Epoch: 11, Steps: 528 | Train Loss: 0.3690276 Vali Loss: 0.3241812 Test Loss: 0.6459396
EarlyStopping counter: 4 out of 5
Updating learning rate to 4.8828125e-05
	iters: 100, epoch: 12 | loss: 0.3824483
	speed: 0.0076s/iter; left time: 35.3348s
	iters: 200, epoch: 12 | loss: 0.3349264
	speed: 0.0029s/iter; left time: 13.2827s
	iters: 300, epoch: 12 | loss: 0.1627426
	speed: 0.0031s/iter; left time: 13.6745s
	iters: 400, epoch: 12 | loss: 0.3322648
	speed: 0.0030s/iter; left time: 12.9534s
	iters: 500, epoch: 12 | loss: 0.2736623
	speed: 0.0026s/iter; left time: 11.1927s
Epoch: 12 cost time: 1.5660595893859863
Epoch: 12, Steps: 528 | Train Loss: 0.3682040 Vali Loss: 0.3076818 Test Loss: 0.5883194
EarlyStopping counter: 5 out of 5
Early stopping
Total training time: 32.1661 seconds
>>>>>>>testing : ETTh2_96_96_DLinear_ETTh2_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed32598<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
data_set:  <data_provider.data_loader.Dataset_ETT_hour object at 0x000001921B0447F0>
mse:0.5285787582397461, mae:0.47307002544403076
