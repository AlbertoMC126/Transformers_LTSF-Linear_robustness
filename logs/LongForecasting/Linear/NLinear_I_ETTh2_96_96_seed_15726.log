Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTh2', data_path='ETTh2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.05, loss='mse', lradj='type1', model='NLinear', model_id='ETTh2_96_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=15726, seq_len=96, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTh2_96_96_NLinear_ETTh2_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15726>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8449
data_set:  <data_provider.data_loader.Dataset_ETT_hour object at 0x0000025EDD8F0CF8>
val 2785
data_set:  <data_provider.data_loader.Dataset_ETT_hour object at 0x0000025EAAEF7D68>
test 2785
data_set:  <data_provider.data_loader.Dataset_ETT_hour object at 0x0000025EA96275F8>
Total number of trainable parameters: 65184
Total number of parameters: 65184
	iters: 100, epoch: 1 | loss: 0.6993618
	speed: 0.0032s/iter; left time: 33.1344s
	iters: 200, epoch: 1 | loss: 0.8475422
	speed: 0.0035s/iter; left time: 36.1372s
	iters: 300, epoch: 1 | loss: 3.4973545
	speed: 0.0030s/iter; left time: 31.1039s
	iters: 400, epoch: 1 | loss: 1.1182508
	speed: 0.0028s/iter; left time: 28.2921s
	iters: 500, epoch: 1 | loss: 1.7404293
	speed: 0.0029s/iter; left time: 29.4110s
Epoch: 1 cost time: 1.6406707763671875
Epoch: 1, Steps: 528 | Train Loss: 1.8355116 Vali Loss: 0.6813170 Test Loss: 0.9730034
Validation loss decreased (inf --> 0.681317).  Saving model ...
Updating learning rate to 0.05
	iters: 100, epoch: 2 | loss: 0.9656498
	speed: 0.0073s/iter; left time: 72.7181s
	iters: 200, epoch: 2 | loss: 0.9649032
	speed: 0.0028s/iter; left time: 27.5361s
	iters: 300, epoch: 2 | loss: 0.5714925
	speed: 0.0037s/iter; left time: 36.4846s
	iters: 400, epoch: 2 | loss: 0.7078156
	speed: 0.0028s/iter; left time: 27.1662s
	iters: 500, epoch: 2 | loss: 3.4242001
	speed: 0.0025s/iter; left time: 23.3805s
Epoch: 2 cost time: 1.5267398357391357
Epoch: 2, Steps: 528 | Train Loss: 1.5399222 Vali Loss: 0.7260973 Test Loss: 0.8703145
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.025
	iters: 100, epoch: 3 | loss: 1.1767634
	speed: 0.0069s/iter; left time: 64.4332s
	iters: 200, epoch: 3 | loss: 0.2783644
	speed: 0.0025s/iter; left time: 23.4179s
	iters: 300, epoch: 3 | loss: 0.4138373
	speed: 0.0030s/iter; left time: 27.3163s
	iters: 400, epoch: 3 | loss: 0.4893654
	speed: 0.0031s/iter; left time: 28.4527s
	iters: 500, epoch: 3 | loss: 0.5077273
	speed: 0.0029s/iter; left time: 25.9289s
Epoch: 3 cost time: 1.4690759181976318
Epoch: 3, Steps: 528 | Train Loss: 0.6741108 Vali Loss: 0.2690524 Test Loss: 0.3895603
Validation loss decreased (0.681317 --> 0.269052).  Saving model ...
Updating learning rate to 0.0125
	iters: 100, epoch: 4 | loss: 0.3466729
	speed: 0.0064s/iter; left time: 56.8418s
	iters: 200, epoch: 4 | loss: 0.8316678
	speed: 0.0032s/iter; left time: 28.3933s
	iters: 300, epoch: 4 | loss: 0.9921411
	speed: 0.0033s/iter; left time: 28.9844s
	iters: 400, epoch: 4 | loss: 0.4007496
	speed: 0.0035s/iter; left time: 30.1614s
	iters: 500, epoch: 4 | loss: 0.3567638
	speed: 0.0033s/iter; left time: 27.8240s
Epoch: 4 cost time: 1.6492931842803955
Epoch: 4, Steps: 528 | Train Loss: 0.4725468 Vali Loss: 0.2602874 Test Loss: 0.3558944
Validation loss decreased (0.269052 --> 0.260287).  Saving model ...
Updating learning rate to 0.00625
	iters: 100, epoch: 5 | loss: 0.2883119
	speed: 0.0090s/iter; left time: 74.8389s
	iters: 200, epoch: 5 | loss: 0.2777783
	speed: 0.0032s/iter; left time: 26.1276s
	iters: 300, epoch: 5 | loss: 0.3283187
	speed: 0.0028s/iter; left time: 23.0197s
	iters: 400, epoch: 5 | loss: 0.1877546
	speed: 0.0025s/iter; left time: 20.4958s
	iters: 500, epoch: 5 | loss: 0.3977736
	speed: 0.0028s/iter; left time: 22.1994s
Epoch: 5 cost time: 1.5162999629974365
Epoch: 5, Steps: 528 | Train Loss: 0.4489869 Vali Loss: 0.2289194 Test Loss: 0.3260662
Validation loss decreased (0.260287 --> 0.228919).  Saving model ...
Updating learning rate to 0.003125
	iters: 100, epoch: 6 | loss: 0.5087979
	speed: 0.0075s/iter; left time: 58.7723s
	iters: 200, epoch: 6 | loss: 0.2101931
	speed: 0.0027s/iter; left time: 20.5194s
	iters: 300, epoch: 6 | loss: 0.5163415
	speed: 0.0027s/iter; left time: 20.2759s
	iters: 400, epoch: 6 | loss: 0.3918422
	speed: 0.0031s/iter; left time: 23.5495s
	iters: 500, epoch: 6 | loss: 0.4588778
	speed: 0.0025s/iter; left time: 18.4839s
Epoch: 6 cost time: 1.4844274520874023
Epoch: 6, Steps: 528 | Train Loss: 0.4240793 Vali Loss: 0.2174224 Test Loss: 0.3012609
Validation loss decreased (0.228919 --> 0.217422).  Saving model ...
Updating learning rate to 0.0015625
	iters: 100, epoch: 7 | loss: 0.2560322
	speed: 0.0086s/iter; left time: 62.7020s
	iters: 200, epoch: 7 | loss: 0.4356723
	speed: 0.0036s/iter; left time: 25.8197s
	iters: 300, epoch: 7 | loss: 0.1879604
	speed: 0.0022s/iter; left time: 15.5308s
	iters: 400, epoch: 7 | loss: 0.3191144
	speed: 0.0028s/iter; left time: 19.6580s
	iters: 500, epoch: 7 | loss: 0.3537602
	speed: 0.0031s/iter; left time: 21.5445s
Epoch: 7 cost time: 1.610905408859253
Epoch: 7, Steps: 528 | Train Loss: 0.4136783 Vali Loss: 0.2125280 Test Loss: 0.2921751
Validation loss decreased (0.217422 --> 0.212528).  Saving model ...
Updating learning rate to 0.00078125
	iters: 100, epoch: 8 | loss: 0.3002888
	speed: 0.0079s/iter; left time: 53.1117s
	iters: 200, epoch: 8 | loss: 0.2075329
	speed: 0.0031s/iter; left time: 20.9246s
	iters: 300, epoch: 8 | loss: 0.2112133
	speed: 0.0029s/iter; left time: 19.1551s
	iters: 400, epoch: 8 | loss: 0.2074434
	speed: 0.0031s/iter; left time: 20.1996s
	iters: 500, epoch: 8 | loss: 0.3457268
	speed: 0.0025s/iter; left time: 15.9190s
Epoch: 8 cost time: 1.5008876323699951
Epoch: 8, Steps: 528 | Train Loss: 0.4083550 Vali Loss: 0.2115886 Test Loss: 0.2906637
Validation loss decreased (0.212528 --> 0.211589).  Saving model ...
Updating learning rate to 0.000390625
	iters: 100, epoch: 9 | loss: 0.4398804
	speed: 0.0077s/iter; left time: 47.7271s
	iters: 200, epoch: 9 | loss: 0.8239094
	speed: 0.0028s/iter; left time: 17.2703s
	iters: 300, epoch: 9 | loss: 0.2822707
	speed: 0.0025s/iter; left time: 15.0956s
	iters: 400, epoch: 9 | loss: 0.3493064
	speed: 0.0033s/iter; left time: 19.4615s
	iters: 500, epoch: 9 | loss: 0.4400345
	speed: 0.0022s/iter; left time: 12.7862s
Epoch: 9 cost time: 1.4847962856292725
Epoch: 9, Steps: 528 | Train Loss: 0.4040968 Vali Loss: 0.2103489 Test Loss: 0.2907614
Validation loss decreased (0.211589 --> 0.210349).  Saving model ...
Updating learning rate to 0.0001953125
	iters: 100, epoch: 10 | loss: 0.3062833
	speed: 0.0070s/iter; left time: 40.1226s
	iters: 200, epoch: 10 | loss: 0.4586187
	speed: 0.0027s/iter; left time: 14.9438s
	iters: 300, epoch: 10 | loss: 0.8406566
	speed: 0.0039s/iter; left time: 21.4901s
	iters: 400, epoch: 10 | loss: 0.1266342
	speed: 0.0034s/iter; left time: 18.6073s
	iters: 500, epoch: 10 | loss: 0.2898291
	speed: 0.0026s/iter; left time: 13.6173s
Epoch: 10 cost time: 1.5637898445129395
Epoch: 10, Steps: 528 | Train Loss: 0.4023829 Vali Loss: 0.2108261 Test Loss: 0.2906207
EarlyStopping counter: 1 out of 5
Updating learning rate to 9.765625e-05
	iters: 100, epoch: 11 | loss: 0.4636621
	speed: 0.0077s/iter; left time: 40.1194s
	iters: 200, epoch: 11 | loss: 0.7424339
	speed: 0.0029s/iter; left time: 14.5457s
	iters: 300, epoch: 11 | loss: 0.3615591
	speed: 0.0028s/iter; left time: 14.0984s
	iters: 400, epoch: 11 | loss: 0.3657890
	speed: 0.0029s/iter; left time: 14.1503s
	iters: 500, epoch: 11 | loss: 0.3737988
	speed: 0.0025s/iter; left time: 11.9824s
Epoch: 11 cost time: 1.5309534072875977
Epoch: 11, Steps: 528 | Train Loss: 0.4013257 Vali Loss: 0.2105272 Test Loss: 0.2895585
EarlyStopping counter: 2 out of 5
Updating learning rate to 4.8828125e-05
	iters: 100, epoch: 12 | loss: 0.3327911
	speed: 0.0078s/iter; left time: 36.3390s
	iters: 200, epoch: 12 | loss: 0.3584409
	speed: 0.0028s/iter; left time: 12.8140s
	iters: 300, epoch: 12 | loss: 0.3124987
	speed: 0.0030s/iter; left time: 13.2212s
	iters: 400, epoch: 12 | loss: 0.2943116
	speed: 0.0031s/iter; left time: 13.5869s
	iters: 500, epoch: 12 | loss: 0.3034987
	speed: 0.0030s/iter; left time: 12.6242s
Epoch: 12 cost time: 1.531585693359375
Epoch: 12, Steps: 528 | Train Loss: 0.4008493 Vali Loss: 0.2102122 Test Loss: 0.2896679
Validation loss decreased (0.210349 --> 0.210212).  Saving model ...
Updating learning rate to 2.44140625e-05
	iters: 100, epoch: 13 | loss: 0.4034628
	speed: 0.0091s/iter; left time: 37.3933s
	iters: 200, epoch: 13 | loss: 0.2659123
	speed: 0.0028s/iter; left time: 11.3192s
	iters: 300, epoch: 13 | loss: 0.2643979
	speed: 0.0036s/iter; left time: 14.1012s
	iters: 400, epoch: 13 | loss: 0.3339265
	speed: 0.0028s/iter; left time: 10.7603s
	iters: 500, epoch: 13 | loss: 0.4421559
	speed: 0.0023s/iter; left time: 8.7232s
Epoch: 13 cost time: 1.5262508392333984
Epoch: 13, Steps: 528 | Train Loss: 0.4005430 Vali Loss: 0.2099078 Test Loss: 0.2894736
Validation loss decreased (0.210212 --> 0.209908).  Saving model ...
Updating learning rate to 1.220703125e-05
	iters: 100, epoch: 14 | loss: 0.3536139
	speed: 0.0070s/iter; left time: 25.3039s
	iters: 200, epoch: 14 | loss: 0.2741447
	speed: 0.0028s/iter; left time: 9.8267s
	iters: 300, epoch: 14 | loss: 0.2796899
	speed: 0.0031s/iter; left time: 10.6188s
	iters: 400, epoch: 14 | loss: 0.2386489
	speed: 0.0034s/iter; left time: 11.3338s
	iters: 500, epoch: 14 | loss: 0.4777145
	speed: 0.0025s/iter; left time: 7.9926s
Epoch: 14 cost time: 1.4688820838928223
Epoch: 14, Steps: 528 | Train Loss: 0.3998657 Vali Loss: 0.2097928 Test Loss: 0.2894875
Validation loss decreased (0.209908 --> 0.209793).  Saving model ...
Updating learning rate to 6.103515625e-06
	iters: 100, epoch: 15 | loss: 0.5315422
	speed: 0.0069s/iter; left time: 21.0977s
	iters: 200, epoch: 15 | loss: 0.3620736
	speed: 0.0031s/iter; left time: 9.2817s
	iters: 300, epoch: 15 | loss: 0.1671457
	speed: 0.0028s/iter; left time: 8.0671s
	iters: 400, epoch: 15 | loss: 0.3046434
	speed: 0.0025s/iter; left time: 6.9286s
	iters: 500, epoch: 15 | loss: 0.9056405
	speed: 0.0023s/iter; left time: 6.2449s
Epoch: 15 cost time: 1.452967643737793
Epoch: 15, Steps: 528 | Train Loss: 0.4002391 Vali Loss: 0.2097096 Test Loss: 0.2894807
Validation loss decreased (0.209793 --> 0.209710).  Saving model ...
Updating learning rate to 3.0517578125e-06
	iters: 100, epoch: 16 | loss: 0.3012446
	speed: 0.0072s/iter; left time: 18.2659s
	iters: 200, epoch: 16 | loss: 0.4629213
	speed: 0.0028s/iter; left time: 6.8592s
	iters: 300, epoch: 16 | loss: 0.5664879
	speed: 0.0025s/iter; left time: 5.8566s
	iters: 400, epoch: 16 | loss: 0.2876080
	speed: 0.0019s/iter; left time: 4.1961s
	iters: 500, epoch: 16 | loss: 0.3620971
	speed: 0.0023s/iter; left time: 5.0298s
Epoch: 16 cost time: 1.265479564666748
Epoch: 16, Steps: 528 | Train Loss: 0.4001768 Vali Loss: 0.2096370 Test Loss: 0.2895010
Validation loss decreased (0.209710 --> 0.209637).  Saving model ...
Updating learning rate to 1.52587890625e-06
	iters: 100, epoch: 17 | loss: 0.1642088
	speed: 0.0064s/iter; left time: 12.8993s
	iters: 200, epoch: 17 | loss: 0.3064893
	speed: 0.0023s/iter; left time: 4.4812s
	iters: 300, epoch: 17 | loss: 0.1909452
	speed: 0.0022s/iter; left time: 3.9624s
	iters: 400, epoch: 17 | loss: 0.5550137
	speed: 0.0022s/iter; left time: 3.7428s
	iters: 500, epoch: 17 | loss: 0.3958558
	speed: 0.0019s/iter; left time: 3.0286s
Epoch: 17 cost time: 1.078136920928955
Epoch: 17, Steps: 528 | Train Loss: 0.4001447 Vali Loss: 0.2096956 Test Loss: 0.2895074
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.62939453125e-07
	iters: 100, epoch: 18 | loss: 0.3260288
	speed: 0.0045s/iter; left time: 6.7293s
	iters: 200, epoch: 18 | loss: 0.1592233
	speed: 0.0016s/iter; left time: 2.1593s
	iters: 300, epoch: 18 | loss: 0.4515760
	speed: 0.0017s/iter; left time: 2.2099s
	iters: 400, epoch: 18 | loss: 0.2829623
	speed: 0.0016s/iter; left time: 1.8552s
	iters: 500, epoch: 18 | loss: 0.2746006
	speed: 0.0016s/iter; left time: 1.6930s
Epoch: 18 cost time: 0.8437166213989258
Epoch: 18, Steps: 528 | Train Loss: 0.4001316 Vali Loss: 0.2097220 Test Loss: 0.2895078
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.814697265625e-07
	iters: 100, epoch: 19 | loss: 0.2081977
	speed: 0.0042s/iter; left time: 4.0383s
	iters: 200, epoch: 19 | loss: 0.2053674
	speed: 0.0017s/iter; left time: 1.4726s
	iters: 300, epoch: 19 | loss: 0.2176980
	speed: 0.0023s/iter; left time: 1.7731s
	iters: 400, epoch: 19 | loss: 0.4573231
	speed: 0.0014s/iter; left time: 0.9247s
	iters: 500, epoch: 19 | loss: 0.3827449
	speed: 0.0016s/iter; left time: 0.8711s
Epoch: 19 cost time: 0.9217469692230225
Epoch: 19, Steps: 528 | Train Loss: 0.4001034 Vali Loss: 0.2097010 Test Loss: 0.2895082
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.9073486328125e-07
	iters: 100, epoch: 20 | loss: 0.1959811
	speed: 0.0038s/iter; left time: 1.6090s
	iters: 200, epoch: 20 | loss: 0.3628578
	speed: 0.0014s/iter; left time: 0.4625s
	iters: 300, epoch: 20 | loss: 0.3558391
	speed: 0.0016s/iter; left time: 0.3570s
	iters: 400, epoch: 20 | loss: 0.6681119
	speed: 0.0014s/iter; left time: 0.1814s
	iters: 500, epoch: 20 | loss: 0.2942421
	speed: 0.0016s/iter; left time: 0.0453s
Epoch: 20 cost time: 0.7658557891845703
Epoch: 20, Steps: 528 | Train Loss: 0.4001111 Vali Loss: 0.2097002 Test Loss: 0.2895090
EarlyStopping counter: 4 out of 5
Updating learning rate to 9.5367431640625e-08
Total training time: 35.1089 seconds
>>>>>>>testing : ETTh2_96_96_NLinear_ETTh2_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15726<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
data_set:  <data_provider.data_loader.Dataset_ETT_hour object at 0x0000025EA96275F8>
mse:0.2905373275279999, mae:0.34065648913383484
