Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='DLinear', model_id='ETTm2_336_720', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=720, root_path='./dataset/', save_pred_values=False, seed=32598, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTm2_336_720_DLinear_ETTm2_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed32598>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33505
val 10801
test 10801
	iters: 100, epoch: 1 | loss: 0.4985114
	speed: 0.0383s/iter; left time: 797.9200s
	iters: 200, epoch: 1 | loss: 0.7900824
	speed: 0.0321s/iter; left time: 666.1322s
	iters: 300, epoch: 1 | loss: 1.0777715
	speed: 0.0398s/iter; left time: 821.4835s
	iters: 400, epoch: 1 | loss: 0.8214614
	speed: 0.0378s/iter; left time: 776.8486s
	iters: 500, epoch: 1 | loss: 0.6163456
	speed: 0.0325s/iter; left time: 664.7640s
	iters: 600, epoch: 1 | loss: 0.7333711
	speed: 0.0330s/iter; left time: 671.4958s
	iters: 700, epoch: 1 | loss: 0.5933454
	speed: 0.0380s/iter; left time: 769.2318s
	iters: 800, epoch: 1 | loss: 1.3428196
	speed: 0.0387s/iter; left time: 779.7195s
	iters: 900, epoch: 1 | loss: 0.7750276
	speed: 0.0388s/iter; left time: 777.7205s
	iters: 1000, epoch: 1 | loss: 1.0463328
	speed: 0.0391s/iter; left time: 780.2598s
Epoch: 1 cost time: 38.515371561050415
Epoch: 1, Steps: 1047 | Train Loss: 0.7771025 Vali Loss: 0.8061451 Test Loss: 1.6899817
Validation loss decreased (inf --> 0.806145).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.9232197
	speed: 0.1130s/iter; left time: 2237.5202s
	iters: 200, epoch: 2 | loss: 0.6655094
	speed: 0.0380s/iter; left time: 748.2185s
	iters: 300, epoch: 2 | loss: 1.0529643
	speed: 0.0370s/iter; left time: 724.1988s
	iters: 400, epoch: 2 | loss: 1.4679445
	speed: 0.0375s/iter; left time: 731.3024s
	iters: 500, epoch: 2 | loss: 0.5918064
	speed: 0.0381s/iter; left time: 738.4107s
	iters: 600, epoch: 2 | loss: 0.7513217
	speed: 0.0370s/iter; left time: 713.3053s
	iters: 700, epoch: 2 | loss: 0.6304123
	speed: 0.0384s/iter; left time: 737.8954s
	iters: 800, epoch: 2 | loss: 1.5921204
	speed: 0.0395s/iter; left time: 754.0137s
	iters: 900, epoch: 2 | loss: 0.7709642
	speed: 0.0369s/iter; left time: 701.2480s
	iters: 1000, epoch: 2 | loss: 0.6419325
	speed: 0.0356s/iter; left time: 672.5373s
Epoch: 2 cost time: 38.75412034988403
Epoch: 2, Steps: 1047 | Train Loss: 0.7875419 Vali Loss: 1.0261849 Test Loss: 2.7697356
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.4392892
	speed: 0.1104s/iter; left time: 2070.2732s
	iters: 200, epoch: 3 | loss: 0.7786726
	speed: 0.0363s/iter; left time: 676.9875s
	iters: 300, epoch: 3 | loss: 0.4449105
	speed: 0.0379s/iter; left time: 702.4646s
	iters: 400, epoch: 3 | loss: 0.5048254
	speed: 0.0367s/iter; left time: 676.2929s
	iters: 500, epoch: 3 | loss: 1.2838742
	speed: 0.0335s/iter; left time: 614.9735s
	iters: 600, epoch: 3 | loss: 0.4873179
	speed: 0.0367s/iter; left time: 670.3133s
	iters: 700, epoch: 3 | loss: 0.4176084
	speed: 0.0367s/iter; left time: 665.9690s
	iters: 800, epoch: 3 | loss: 0.7550936
	speed: 0.0350s/iter; left time: 630.9187s
	iters: 900, epoch: 3 | loss: 0.4971751
	speed: 0.0357s/iter; left time: 640.1515s
	iters: 1000, epoch: 3 | loss: 0.5141838
	speed: 0.0388s/iter; left time: 692.6242s
Epoch: 3 cost time: 37.79847002029419
Epoch: 3, Steps: 1047 | Train Loss: 0.5728354 Vali Loss: 0.5068769 Test Loss: 0.7832174
Validation loss decreased (0.806145 --> 0.506877).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.2899568
	speed: 0.1129s/iter; left time: 1998.1325s
	iters: 200, epoch: 4 | loss: 0.3674719
	speed: 0.0360s/iter; left time: 633.9666s
	iters: 300, epoch: 4 | loss: 0.6503980
	speed: 0.0364s/iter; left time: 637.6398s
	iters: 400, epoch: 4 | loss: 0.3586438
	speed: 0.0373s/iter; left time: 649.0359s
	iters: 500, epoch: 4 | loss: 0.4255307
	speed: 0.0372s/iter; left time: 643.4290s
	iters: 600, epoch: 4 | loss: 0.6624930
	speed: 0.0379s/iter; left time: 651.5730s
	iters: 700, epoch: 4 | loss: 0.4003150
	speed: 0.0369s/iter; left time: 630.4371s
	iters: 800, epoch: 4 | loss: 0.8328802
	speed: 0.0366s/iter; left time: 621.5742s
	iters: 900, epoch: 4 | loss: 0.4615082
	speed: 0.0335s/iter; left time: 566.4637s
	iters: 1000, epoch: 4 | loss: 0.3652259
	speed: 0.0354s/iter; left time: 595.1387s
Epoch: 4 cost time: 37.737635135650635
Epoch: 4, Steps: 1047 | Train Loss: 0.5171077 Vali Loss: 0.3947701 Test Loss: 0.6849297
Validation loss decreased (0.506877 --> 0.394770).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.5884222
	speed: 0.1172s/iter; left time: 1952.5412s
	iters: 200, epoch: 5 | loss: 0.4285905
	speed: 0.0336s/iter; left time: 555.7141s
	iters: 300, epoch: 5 | loss: 0.4437329
	speed: 0.0378s/iter; left time: 622.2642s
	iters: 400, epoch: 5 | loss: 0.2918224
	speed: 0.0357s/iter; left time: 583.7403s
	iters: 500, epoch: 5 | loss: 0.3806140
	speed: 0.0368s/iter; left time: 597.6736s
	iters: 600, epoch: 5 | loss: 0.6213608
	speed: 0.0391s/iter; left time: 631.2637s
	iters: 700, epoch: 5 | loss: 0.3733730
	speed: 0.0385s/iter; left time: 618.5765s
	iters: 800, epoch: 5 | loss: 0.6094609
	speed: 0.0387s/iter; left time: 617.1114s
	iters: 900, epoch: 5 | loss: 0.2874927
	speed: 0.0356s/iter; left time: 563.6072s
	iters: 1000, epoch: 5 | loss: 0.8641270
	speed: 0.0358s/iter; left time: 564.5552s
Epoch: 5 cost time: 38.28122091293335
Epoch: 5, Steps: 1047 | Train Loss: 0.4825633 Vali Loss: 0.4578563 Test Loss: 0.9718972
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.5869477
	speed: 0.1150s/iter; left time: 1794.9992s
	iters: 200, epoch: 6 | loss: 0.3199944
	speed: 0.0357s/iter; left time: 552.9638s
	iters: 300, epoch: 6 | loss: 0.3305067
	speed: 0.0351s/iter; left time: 540.4297s
	iters: 400, epoch: 6 | loss: 0.4862053
	speed: 0.0356s/iter; left time: 544.8606s
	iters: 500, epoch: 6 | loss: 0.3267070
	speed: 0.0360s/iter; left time: 547.1877s
	iters: 600, epoch: 6 | loss: 0.6004665
	speed: 0.0396s/iter; left time: 597.8412s
	iters: 700, epoch: 6 | loss: 0.4081711
	speed: 0.0382s/iter; left time: 572.7495s
	iters: 800, epoch: 6 | loss: 0.2577396
	speed: 0.0374s/iter; left time: 557.0560s
	iters: 900, epoch: 6 | loss: 0.4616855
	speed: 0.0369s/iter; left time: 545.9643s
	iters: 1000, epoch: 6 | loss: 0.3296121
	speed: 0.0395s/iter; left time: 580.2011s
Epoch: 6 cost time: 38.66946792602539
Epoch: 6, Steps: 1047 | Train Loss: 0.4663163 Vali Loss: 0.3851011 Test Loss: 0.7493523
Validation loss decreased (0.394770 --> 0.385101).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.6618315
	speed: 0.1164s/iter; left time: 1694.4059s
	iters: 200, epoch: 7 | loss: 0.5376288
	speed: 0.0366s/iter; left time: 528.6705s
	iters: 300, epoch: 7 | loss: 0.2408954
	speed: 0.0348s/iter; left time: 498.9850s
	iters: 400, epoch: 7 | loss: 0.3062557
	speed: 0.0382s/iter; left time: 545.0315s
	iters: 500, epoch: 7 | loss: 0.3637835
	speed: 0.0376s/iter; left time: 532.8333s
	iters: 600, epoch: 7 | loss: 0.4164248
	speed: 0.0370s/iter; left time: 520.5618s
	iters: 700, epoch: 7 | loss: 0.3334295
	speed: 0.0365s/iter; left time: 509.6198s
	iters: 800, epoch: 7 | loss: 0.3310609
	speed: 0.0370s/iter; left time: 512.3739s
	iters: 900, epoch: 7 | loss: 0.4558912
	speed: 0.0316s/iter; left time: 435.3729s
	iters: 1000, epoch: 7 | loss: 0.3556501
	speed: 0.0348s/iter; left time: 475.9874s
Epoch: 7 cost time: 37.75419068336487
Epoch: 7, Steps: 1047 | Train Loss: 0.4586748 Vali Loss: 0.4067708 Test Loss: 0.8202046
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.4439406
	speed: 0.1153s/iter; left time: 1557.9589s
	iters: 200, epoch: 8 | loss: 0.5573988
	speed: 0.0382s/iter; left time: 512.9597s
	iters: 300, epoch: 8 | loss: 0.2947697
	speed: 0.0371s/iter; left time: 494.1315s
	iters: 400, epoch: 8 | loss: 0.4227303
	speed: 0.0357s/iter; left time: 471.8190s
	iters: 500, epoch: 8 | loss: 0.5094008
	speed: 0.0367s/iter; left time: 481.1893s
	iters: 600, epoch: 8 | loss: 0.4691777
	speed: 0.0359s/iter; left time: 467.1545s
	iters: 700, epoch: 8 | loss: 0.4328483
	speed: 0.0359s/iter; left time: 463.3241s
	iters: 800, epoch: 8 | loss: 0.3030817
	speed: 0.0358s/iter; left time: 458.3865s
	iters: 900, epoch: 8 | loss: 0.4960656
	speed: 0.0363s/iter; left time: 461.1220s
	iters: 1000, epoch: 8 | loss: 0.2432300
	speed: 0.0377s/iter; left time: 475.9801s
Epoch: 8 cost time: 37.93084740638733
Epoch: 8, Steps: 1047 | Train Loss: 0.4542541 Vali Loss: 0.4022537 Test Loss: 0.8009165
EarlyStopping counter: 2 out of 5
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.4707131
	speed: 0.1142s/iter; left time: 1422.9534s
	iters: 200, epoch: 9 | loss: 0.4028496
	speed: 0.0372s/iter; left time: 459.9218s
	iters: 300, epoch: 9 | loss: 0.5754461
	speed: 0.0376s/iter; left time: 461.1092s
	iters: 400, epoch: 9 | loss: 0.5608997
	speed: 0.0376s/iter; left time: 456.8365s
	iters: 500, epoch: 9 | loss: 0.5160876
	speed: 0.0390s/iter; left time: 469.9591s
	iters: 600, epoch: 9 | loss: 0.6425243
	speed: 0.0370s/iter; left time: 443.2721s
	iters: 700, epoch: 9 | loss: 0.5774879
	speed: 0.0359s/iter; left time: 425.9284s
	iters: 800, epoch: 9 | loss: 0.4544071
	speed: 0.0362s/iter; left time: 426.0279s
	iters: 900, epoch: 9 | loss: 0.3566501
	speed: 0.0368s/iter; left time: 429.5417s
	iters: 1000, epoch: 9 | loss: 0.6135768
	speed: 0.0361s/iter; left time: 417.8212s
Epoch: 9 cost time: 38.087013959884644
Epoch: 9, Steps: 1047 | Train Loss: 0.4514210 Vali Loss: 0.4121181 Test Loss: 0.8364891
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.3965636
	speed: 0.1090s/iter; left time: 1244.8265s
	iters: 200, epoch: 10 | loss: 0.2616271
	speed: 0.0347s/iter; left time: 392.5294s
	iters: 300, epoch: 10 | loss: 0.2996473
	speed: 0.0341s/iter; left time: 382.8804s
	iters: 400, epoch: 10 | loss: 0.4806772
	speed: 0.0372s/iter; left time: 413.7213s
	iters: 500, epoch: 10 | loss: 0.3990036
	speed: 0.0357s/iter; left time: 393.2779s
	iters: 600, epoch: 10 | loss: 0.3483929
	speed: 0.0368s/iter; left time: 402.2122s
	iters: 700, epoch: 10 | loss: 0.3569203
	speed: 0.0358s/iter; left time: 386.9998s
	iters: 800, epoch: 10 | loss: 0.5822515
	speed: 0.0368s/iter; left time: 394.9522s
	iters: 900, epoch: 10 | loss: 0.4164969
	speed: 0.0354s/iter; left time: 375.5543s
	iters: 1000, epoch: 10 | loss: 0.3008796
	speed: 0.0354s/iter; left time: 372.4166s
Epoch: 10 cost time: 36.74828267097473
Epoch: 10, Steps: 1047 | Train Loss: 0.4500248 Vali Loss: 0.4092371 Test Loss: 0.8172135
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.2794546
	speed: 0.1173s/iter; left time: 1216.7764s
	iters: 200, epoch: 11 | loss: 0.3185616
	speed: 0.0365s/iter; left time: 374.8539s
	iters: 300, epoch: 11 | loss: 0.2822859
	speed: 0.0364s/iter; left time: 369.9534s
	iters: 400, epoch: 11 | loss: 0.4383938
	speed: 0.0357s/iter; left time: 359.1160s
	iters: 500, epoch: 11 | loss: 0.3589080
	speed: 0.0340s/iter; left time: 338.9210s
	iters: 600, epoch: 11 | loss: 0.3609800
	speed: 0.0330s/iter; left time: 325.3321s
	iters: 700, epoch: 11 | loss: 0.2517783
	speed: 0.0340s/iter; left time: 332.6356s
	iters: 800, epoch: 11 | loss: 0.4624967
	speed: 0.0339s/iter; left time: 328.2356s
	iters: 900, epoch: 11 | loss: 0.4148385
	speed: 0.0327s/iter; left time: 313.0594s
	iters: 1000, epoch: 11 | loss: 0.2569005
	speed: 0.0323s/iter; left time: 305.8136s
Epoch: 11 cost time: 35.53739905357361
Epoch: 11, Steps: 1047 | Train Loss: 0.4493243 Vali Loss: 0.4042981 Test Loss: 0.8138809
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTm2_336_720_DLinear_ETTm2_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed32598<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10801
mse:0.7499494552612305, mae:0.5599527955055237
