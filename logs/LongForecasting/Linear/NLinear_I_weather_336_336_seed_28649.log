Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='NLinear', model_id='weather_336_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=336, root_path='./dataset/', save_pred_values=False, seed=28649, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : weather_336_336_NLinear_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed28649>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36216
val 4935
test 10204
	iters: 100, epoch: 1 | loss: 0.4547000
	speed: 0.0233s/iter; left time: 1054.1603s
	iters: 200, epoch: 1 | loss: 101.0541000
	speed: 0.0238s/iter; left time: 1072.9606s
	iters: 300, epoch: 1 | loss: 0.6829246
	speed: 0.0262s/iter; left time: 1178.4929s
	iters: 400, epoch: 1 | loss: 1.0618590
	speed: 0.0215s/iter; left time: 965.7263s
	iters: 500, epoch: 1 | loss: 0.5872639
	speed: 0.0213s/iter; left time: 953.0208s
	iters: 600, epoch: 1 | loss: 0.9676789
	speed: 0.0227s/iter; left time: 1012.8828s
	iters: 700, epoch: 1 | loss: 0.8916560
	speed: 0.0239s/iter; left time: 1066.2163s
	iters: 800, epoch: 1 | loss: 0.5126034
	speed: 0.0234s/iter; left time: 1038.5360s
	iters: 900, epoch: 1 | loss: 0.7803368
	speed: 0.0248s/iter; left time: 1098.7624s
	iters: 1000, epoch: 1 | loss: 0.7080995
	speed: 0.0248s/iter; left time: 1097.8622s
	iters: 1100, epoch: 1 | loss: 0.4765951
	speed: 0.0203s/iter; left time: 895.5641s
	iters: 1200, epoch: 1 | loss: 0.4307407
	speed: 0.0233s/iter; left time: 1027.4315s
	iters: 1300, epoch: 1 | loss: 0.7067027
	speed: 0.0240s/iter; left time: 1053.0515s
	iters: 1400, epoch: 1 | loss: 0.4357406
	speed: 0.0214s/iter; left time: 937.6322s
	iters: 1500, epoch: 1 | loss: 0.8528057
	speed: 0.0235s/iter; left time: 1026.5428s
	iters: 1600, epoch: 1 | loss: 0.7229112
	speed: 0.0218s/iter; left time: 953.0551s
	iters: 1700, epoch: 1 | loss: 3.4938092
	speed: 0.0239s/iter; left time: 1040.3384s
	iters: 1800, epoch: 1 | loss: 1.1383656
	speed: 0.0229s/iter; left time: 996.5286s
	iters: 1900, epoch: 1 | loss: 0.6266574
	speed: 0.0203s/iter; left time: 879.3508s
	iters: 2000, epoch: 1 | loss: 0.6404839
	speed: 0.0233s/iter; left time: 1008.3988s
	iters: 2100, epoch: 1 | loss: 0.8096444
	speed: 0.0225s/iter; left time: 969.0948s
	iters: 2200, epoch: 1 | loss: 1.0875864
	speed: 0.0231s/iter; left time: 993.7060s
Epoch: 1 cost time: 51.89533996582031
Epoch: 1, Steps: 2263 | Train Loss: 3.4621771 Vali Loss: 3.0896440 Test Loss: 0.4150031
Validation loss decreased (inf --> 3.089644).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.7048947
	speed: 0.0822s/iter; left time: 3526.5457s
	iters: 200, epoch: 2 | loss: 0.6156502
	speed: 0.0217s/iter; left time: 930.3404s
	iters: 300, epoch: 2 | loss: 5.6865029
	speed: 0.0241s/iter; left time: 1029.1644s
	iters: 400, epoch: 2 | loss: 0.8233291
	speed: 0.0224s/iter; left time: 952.1336s
	iters: 500, epoch: 2 | loss: 0.8064812
	speed: 0.0241s/iter; left time: 1025.0491s
	iters: 600, epoch: 2 | loss: 0.4528471
	speed: 0.0233s/iter; left time: 987.1400s
	iters: 700, epoch: 2 | loss: 1.6015515
	speed: 0.0241s/iter; left time: 1019.4420s
	iters: 800, epoch: 2 | loss: 0.6849261
	speed: 0.0221s/iter; left time: 934.1834s
	iters: 900, epoch: 2 | loss: 0.8914340
	speed: 0.0220s/iter; left time: 925.5229s
	iters: 1000, epoch: 2 | loss: 1.0545563
	speed: 0.0237s/iter; left time: 996.0861s
	iters: 1100, epoch: 2 | loss: 0.4973758
	speed: 0.0222s/iter; left time: 928.3777s
	iters: 1200, epoch: 2 | loss: 0.5785416
	speed: 0.0226s/iter; left time: 942.9374s
	iters: 1300, epoch: 2 | loss: 0.7893552
	speed: 0.0231s/iter; left time: 964.3356s
	iters: 1400, epoch: 2 | loss: 1.0878838
	speed: 0.0234s/iter; left time: 971.9371s
	iters: 1500, epoch: 2 | loss: 1.1719396
	speed: 0.0223s/iter; left time: 923.8704s
	iters: 1600, epoch: 2 | loss: 0.5223058
	speed: 0.0207s/iter; left time: 855.5870s
	iters: 1700, epoch: 2 | loss: 1.3059950
	speed: 0.0235s/iter; left time: 970.9316s
	iters: 1800, epoch: 2 | loss: 0.9507505
	speed: 0.0226s/iter; left time: 930.6577s
	iters: 1900, epoch: 2 | loss: 0.5373097
	speed: 0.0234s/iter; left time: 962.0629s
	iters: 2000, epoch: 2 | loss: 0.8006009
	speed: 0.0235s/iter; left time: 963.3486s
	iters: 2100, epoch: 2 | loss: 0.6391069
	speed: 0.0230s/iter; left time: 938.6143s
	iters: 2200, epoch: 2 | loss: 0.4673831
	speed: 0.0199s/iter; left time: 812.1793s
Epoch: 2 cost time: 51.33779239654541
Epoch: 2, Steps: 2263 | Train Loss: 82.6532046 Vali Loss: 0.7681035 Test Loss: 0.3067653
Validation loss decreased (3.089644 --> 0.768104).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.5075302
	speed: 0.0756s/iter; left time: 3070.8334s
	iters: 200, epoch: 3 | loss: 0.4350858
	speed: 0.0237s/iter; left time: 962.1605s
	iters: 300, epoch: 3 | loss: 0.5026506
	speed: 0.0222s/iter; left time: 897.1026s
	iters: 400, epoch: 3 | loss: 0.4589728
	speed: 0.0245s/iter; left time: 988.5360s
	iters: 500, epoch: 3 | loss: 0.4640418
	speed: 0.0229s/iter; left time: 921.5630s
	iters: 600, epoch: 3 | loss: 0.5704717
	speed: 0.0233s/iter; left time: 935.7909s
	iters: 700, epoch: 3 | loss: 0.6282324
	speed: 0.0236s/iter; left time: 945.3036s
	iters: 800, epoch: 3 | loss: 0.4700894
	speed: 0.0239s/iter; left time: 953.8933s
	iters: 900, epoch: 3 | loss: 1.1092666
	speed: 0.0232s/iter; left time: 925.4272s
	iters: 1000, epoch: 3 | loss: 0.8996761
	speed: 0.0226s/iter; left time: 897.3258s
	iters: 1100, epoch: 3 | loss: 0.4865349
	speed: 0.0245s/iter; left time: 970.4755s
	iters: 1200, epoch: 3 | loss: 0.6021177
	speed: 0.0237s/iter; left time: 936.1674s
	iters: 1300, epoch: 3 | loss: 1.9137840
	speed: 0.0220s/iter; left time: 868.3376s
	iters: 1400, epoch: 3 | loss: 0.4942551
	speed: 0.0224s/iter; left time: 881.7262s
	iters: 1500, epoch: 3 | loss: 20.4511051
	speed: 0.0234s/iter; left time: 916.4410s
	iters: 1600, epoch: 3 | loss: 1.2474219
	speed: 0.0236s/iter; left time: 922.3178s
	iters: 1700, epoch: 3 | loss: 0.9631163
	speed: 0.0234s/iter; left time: 912.7909s
	iters: 1800, epoch: 3 | loss: 0.6306780
	speed: 0.0213s/iter; left time: 828.8797s
	iters: 1900, epoch: 3 | loss: 0.9665765
	speed: 0.0189s/iter; left time: 733.9542s
	iters: 2000, epoch: 3 | loss: 0.5090688
	speed: 0.0252s/iter; left time: 976.0331s
	iters: 2100, epoch: 3 | loss: 0.5714291
	speed: 0.0215s/iter; left time: 831.7582s
	iters: 2200, epoch: 3 | loss: 0.4894403
	speed: 0.0254s/iter; left time: 979.3401s
Epoch: 3 cost time: 51.84226393699646
Epoch: 3, Steps: 2263 | Train Loss: 9.3070718 Vali Loss: 0.6385212 Test Loss: 0.2861740
Validation loss decreased (0.768104 --> 0.638521).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.4580659
	speed: 0.0768s/iter; left time: 2945.1797s
	iters: 200, epoch: 4 | loss: 0.4125199
	speed: 0.0224s/iter; left time: 856.1656s
	iters: 300, epoch: 4 | loss: 0.3633234
	speed: 0.0221s/iter; left time: 845.3143s
	iters: 400, epoch: 4 | loss: 0.4905501
	speed: 0.0231s/iter; left time: 878.4103s
	iters: 500, epoch: 4 | loss: 0.4992015
	speed: 0.0252s/iter; left time: 958.6529s
	iters: 600, epoch: 4 | loss: 0.4106250
	speed: 0.0220s/iter; left time: 832.8190s
	iters: 700, epoch: 4 | loss: 1.0252262
	speed: 0.0248s/iter; left time: 937.9823s
	iters: 800, epoch: 4 | loss: 0.5388364
	speed: 0.0221s/iter; left time: 833.0952s
	iters: 900, epoch: 4 | loss: 0.4157472
	speed: 0.0242s/iter; left time: 910.6827s
	iters: 1000, epoch: 4 | loss: 0.3721096
	speed: 0.0224s/iter; left time: 838.5817s
	iters: 1100, epoch: 4 | loss: 0.5005118
	speed: 0.0228s/iter; left time: 852.6269s
	iters: 1200, epoch: 4 | loss: 0.9444281
	speed: 0.0229s/iter; left time: 855.3608s
	iters: 1300, epoch: 4 | loss: 0.9238480
	speed: 0.0233s/iter; left time: 866.1611s
	iters: 1400, epoch: 4 | loss: 0.4621478
	speed: 0.0228s/iter; left time: 845.9788s
	iters: 1500, epoch: 4 | loss: 0.4536727
	speed: 0.0220s/iter; left time: 812.2144s
	iters: 1600, epoch: 4 | loss: 0.5500960
	speed: 0.0235s/iter; left time: 866.3550s
	iters: 1700, epoch: 4 | loss: 0.3977786
	speed: 0.0239s/iter; left time: 880.4371s
	iters: 1800, epoch: 4 | loss: 0.3779688
	speed: 0.0245s/iter; left time: 896.9924s
	iters: 1900, epoch: 4 | loss: 0.5156769
	speed: 0.0241s/iter; left time: 882.2641s
	iters: 2000, epoch: 4 | loss: 0.3820922
	speed: 0.0209s/iter; left time: 762.0908s
	iters: 2100, epoch: 4 | loss: 0.9336669
	speed: 0.0224s/iter; left time: 815.2859s
	iters: 2200, epoch: 4 | loss: 0.4209079
	speed: 0.0208s/iter; left time: 755.1611s
Epoch: 4 cost time: 51.42809224128723
Epoch: 4, Steps: 2263 | Train Loss: 1.2156378 Vali Loss: 0.6003622 Test Loss: 0.2780357
Validation loss decreased (0.638521 --> 0.600362).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 2.1849995
	speed: 0.0740s/iter; left time: 2670.9686s
	iters: 200, epoch: 5 | loss: 0.4730311
	speed: 0.0198s/iter; left time: 712.9803s
	iters: 300, epoch: 5 | loss: 0.4148605
	speed: 0.0245s/iter; left time: 879.0401s
	iters: 400, epoch: 5 | loss: 0.4682441
	speed: 0.0244s/iter; left time: 873.7097s
	iters: 500, epoch: 5 | loss: 0.4474314
	speed: 0.0233s/iter; left time: 830.9599s
	iters: 600, epoch: 5 | loss: 0.2982106
	speed: 0.0209s/iter; left time: 742.5044s
	iters: 700, epoch: 5 | loss: 0.4379529
	speed: 0.0236s/iter; left time: 836.3913s
	iters: 800, epoch: 5 | loss: 0.4764543
	speed: 0.0224s/iter; left time: 791.6923s
	iters: 900, epoch: 5 | loss: 0.4132592
	speed: 0.0225s/iter; left time: 793.2194s
	iters: 1000, epoch: 5 | loss: 2.1929929
	speed: 0.0248s/iter; left time: 873.3565s
	iters: 1100, epoch: 5 | loss: 0.4310229
	speed: 0.0253s/iter; left time: 889.5553s
	iters: 1200, epoch: 5 | loss: 1.3585064
	speed: 0.0241s/iter; left time: 842.7050s
	iters: 1300, epoch: 5 | loss: 1.0716547
	speed: 0.0244s/iter; left time: 850.2776s
	iters: 1400, epoch: 5 | loss: 0.7977710
	speed: 0.0239s/iter; left time: 830.2980s
	iters: 1500, epoch: 5 | loss: 0.4682678
	speed: 0.0253s/iter; left time: 877.3721s
	iters: 1600, epoch: 5 | loss: 0.4067120
	speed: 0.0234s/iter; left time: 810.5384s
	iters: 1700, epoch: 5 | loss: 3.3657954
	speed: 0.0248s/iter; left time: 854.1844s
	iters: 1800, epoch: 5 | loss: 0.4997738
	speed: 0.0236s/iter; left time: 813.4171s
	iters: 1900, epoch: 5 | loss: 0.4156924
	speed: 0.0242s/iter; left time: 829.2986s
	iters: 2000, epoch: 5 | loss: 0.3572772
	speed: 0.0217s/iter; left time: 742.3987s
	iters: 2100, epoch: 5 | loss: 0.4535230
	speed: 0.0232s/iter; left time: 791.6021s
	iters: 2200, epoch: 5 | loss: 0.5316249
	speed: 0.0235s/iter; left time: 800.8938s
Epoch: 5 cost time: 52.606961488723755
Epoch: 5, Steps: 2263 | Train Loss: 1.7680486 Vali Loss: 0.5500425 Test Loss: 0.2477967
Validation loss decreased (0.600362 --> 0.550042).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.3742222
	speed: 0.0830s/iter; left time: 2807.6801s
	iters: 200, epoch: 6 | loss: 0.3150678
	speed: 0.0219s/iter; left time: 737.6532s
	iters: 300, epoch: 6 | loss: 0.5378434
	speed: 0.0232s/iter; left time: 779.9412s
	iters: 400, epoch: 6 | loss: 0.4501007
	speed: 0.0233s/iter; left time: 780.7418s
	iters: 500, epoch: 6 | loss: 0.4105807
	speed: 0.0216s/iter; left time: 722.5177s
	iters: 600, epoch: 6 | loss: 0.4092260
	speed: 0.0235s/iter; left time: 785.2365s
	iters: 700, epoch: 6 | loss: 0.3485035
	speed: 0.0229s/iter; left time: 760.7369s
	iters: 800, epoch: 6 | loss: 0.4084540
	speed: 0.0227s/iter; left time: 751.7885s
	iters: 900, epoch: 6 | loss: 0.4694419
	speed: 0.0248s/iter; left time: 818.3294s
	iters: 1000, epoch: 6 | loss: 0.2929634
	speed: 0.0254s/iter; left time: 836.8233s
	iters: 1100, epoch: 6 | loss: 2.5572481
	speed: 0.0249s/iter; left time: 819.2275s
	iters: 1200, epoch: 6 | loss: 0.9198595
	speed: 0.0237s/iter; left time: 777.2723s
	iters: 1300, epoch: 6 | loss: 1.0509380
	speed: 0.0209s/iter; left time: 683.8721s
	iters: 1400, epoch: 6 | loss: 0.3943877
	speed: 0.0189s/iter; left time: 615.7918s
	iters: 1500, epoch: 6 | loss: 0.4956770
	speed: 0.0241s/iter; left time: 781.8298s
	iters: 1600, epoch: 6 | loss: 0.8758156
	speed: 0.0240s/iter; left time: 776.0021s
	iters: 1700, epoch: 6 | loss: 0.3614551
	speed: 0.0223s/iter; left time: 719.7228s
	iters: 1800, epoch: 6 | loss: 0.5363573
	speed: 0.0233s/iter; left time: 747.9686s
	iters: 1900, epoch: 6 | loss: 1.7373279
	speed: 0.0235s/iter; left time: 751.7244s
	iters: 2000, epoch: 6 | loss: 0.4098255
	speed: 0.0207s/iter; left time: 661.3104s
	iters: 2100, epoch: 6 | loss: 0.9028158
	speed: 0.0235s/iter; left time: 747.0303s
	iters: 2200, epoch: 6 | loss: 0.4715070
	speed: 0.0184s/iter; left time: 584.9673s
Epoch: 6 cost time: 50.951088190078735
Epoch: 6, Steps: 2263 | Train Loss: 0.8400452 Vali Loss: 0.5427590 Test Loss: 0.2423678
Validation loss decreased (0.550042 --> 0.542759).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.4591826
	speed: 0.0734s/iter; left time: 2317.1558s
	iters: 200, epoch: 7 | loss: 0.9555473
	speed: 0.0231s/iter; left time: 728.3957s
	iters: 300, epoch: 7 | loss: 0.3859483
	speed: 0.0231s/iter; left time: 726.4043s
	iters: 400, epoch: 7 | loss: 0.5050676
	speed: 0.0233s/iter; left time: 727.8770s
	iters: 500, epoch: 7 | loss: 0.5577114
	speed: 0.0218s/iter; left time: 679.8306s
	iters: 600, epoch: 7 | loss: 0.4031483
	speed: 0.0235s/iter; left time: 731.7438s
	iters: 700, epoch: 7 | loss: 0.5245847
	speed: 0.0232s/iter; left time: 719.3586s
	iters: 800, epoch: 7 | loss: 0.8159433
	speed: 0.0238s/iter; left time: 736.0632s
	iters: 900, epoch: 7 | loss: 0.5317630
	speed: 0.0234s/iter; left time: 719.1133s
	iters: 1000, epoch: 7 | loss: 0.5200022
	speed: 0.0226s/iter; left time: 692.5922s
	iters: 1100, epoch: 7 | loss: 0.9346291
	speed: 0.0224s/iter; left time: 686.2294s
	iters: 1200, epoch: 7 | loss: 0.3515690
	speed: 0.0197s/iter; left time: 600.4852s
	iters: 1300, epoch: 7 | loss: 0.4242461
	speed: 0.0244s/iter; left time: 741.3290s
	iters: 1400, epoch: 7 | loss: 0.4366262
	speed: 0.0253s/iter; left time: 766.3180s
	iters: 1500, epoch: 7 | loss: 1.9097192
	speed: 0.0222s/iter; left time: 669.6711s
	iters: 1600, epoch: 7 | loss: 0.4349661
	speed: 0.0195s/iter; left time: 586.6680s
	iters: 1700, epoch: 7 | loss: 1.1125896
	speed: 0.0220s/iter; left time: 658.6649s
	iters: 1800, epoch: 7 | loss: 0.4610699
	speed: 0.0231s/iter; left time: 690.2875s
	iters: 1900, epoch: 7 | loss: 0.4965322
	speed: 0.0236s/iter; left time: 703.1223s
	iters: 2000, epoch: 7 | loss: 0.3256218
	speed: 0.0221s/iter; left time: 654.7597s
	iters: 2100, epoch: 7 | loss: 0.3829763
	speed: 0.0236s/iter; left time: 698.5193s
	iters: 2200, epoch: 7 | loss: 2.9603305
	speed: 0.0198s/iter; left time: 582.9788s
Epoch: 7 cost time: 51.089540243148804
Epoch: 7, Steps: 2263 | Train Loss: 0.6730511 Vali Loss: 0.5897685 Test Loss: 0.2422526
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.3279954
	speed: 0.0774s/iter; left time: 2269.5279s
	iters: 200, epoch: 8 | loss: 0.4179082
	speed: 0.0217s/iter; left time: 633.2545s
	iters: 300, epoch: 8 | loss: 0.5725026
	speed: 0.0237s/iter; left time: 691.1397s
	iters: 400, epoch: 8 | loss: 0.9213599
	speed: 0.0231s/iter; left time: 669.2756s
	iters: 500, epoch: 8 | loss: 1.0044267
	speed: 0.0222s/iter; left time: 641.0857s
	iters: 600, epoch: 8 | loss: 0.4421724
	speed: 0.0206s/iter; left time: 595.0626s
	iters: 700, epoch: 8 | loss: 0.4834555
	speed: 0.0232s/iter; left time: 664.9772s
	iters: 800, epoch: 8 | loss: 0.4973141
	speed: 0.0245s/iter; left time: 700.1376s
	iters: 900, epoch: 8 | loss: 0.4467138
	speed: 0.0235s/iter; left time: 669.5643s
	iters: 1000, epoch: 8 | loss: 0.5036966
	speed: 0.0211s/iter; left time: 600.3336s
	iters: 1100, epoch: 8 | loss: 0.5304776
	speed: 0.0220s/iter; left time: 624.3754s
	iters: 1200, epoch: 8 | loss: 0.3329435
	speed: 0.0227s/iter; left time: 640.0268s
	iters: 1300, epoch: 8 | loss: 0.4177695
	speed: 0.0222s/iter; left time: 625.2196s
	iters: 1400, epoch: 8 | loss: 0.5251635
	speed: 0.0253s/iter; left time: 709.8276s
	iters: 1500, epoch: 8 | loss: 0.3868095
	speed: 0.0228s/iter; left time: 637.8541s
	iters: 1600, epoch: 8 | loss: 0.4541086
	speed: 0.0234s/iter; left time: 649.8136s
	iters: 1700, epoch: 8 | loss: 0.3497481
	speed: 0.0231s/iter; left time: 639.5710s
	iters: 1800, epoch: 8 | loss: 0.4472214
	speed: 0.0222s/iter; left time: 613.8626s
	iters: 1900, epoch: 8 | loss: 0.4433600
	speed: 0.0248s/iter; left time: 682.6554s
	iters: 2000, epoch: 8 | loss: 1.3017117
	speed: 0.0236s/iter; left time: 646.7245s
	iters: 2100, epoch: 8 | loss: 0.5126648
	speed: 0.0216s/iter; left time: 589.1406s
	iters: 2200, epoch: 8 | loss: 0.3573934
	speed: 0.0222s/iter; left time: 604.9872s
Epoch: 8 cost time: 51.26719260215759
Epoch: 8, Steps: 2263 | Train Loss: 0.6638953 Vali Loss: 0.5427351 Test Loss: 0.2410412
Validation loss decreased (0.542759 --> 0.542735).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.4949389
	speed: 0.0730s/iter; left time: 1974.8138s
	iters: 200, epoch: 9 | loss: 0.4176487
	speed: 0.0185s/iter; left time: 499.4245s
	iters: 300, epoch: 9 | loss: 0.9858059
	speed: 0.0204s/iter; left time: 547.7819s
	iters: 400, epoch: 9 | loss: 0.4747886
	speed: 0.0214s/iter; left time: 571.9809s
	iters: 500, epoch: 9 | loss: 0.3140696
	speed: 0.0213s/iter; left time: 567.2557s
	iters: 600, epoch: 9 | loss: 0.5221437
	speed: 0.0221s/iter; left time: 587.4884s
	iters: 700, epoch: 9 | loss: 0.3923440
	speed: 0.0213s/iter; left time: 562.2346s
	iters: 800, epoch: 9 | loss: 0.4006537
	speed: 0.0252s/iter; left time: 662.8867s
	iters: 900, epoch: 9 | loss: 0.3728895
	speed: 0.0232s/iter; left time: 609.8903s
	iters: 1000, epoch: 9 | loss: 0.4583583
	speed: 0.0240s/iter; left time: 628.7860s
	iters: 1100, epoch: 9 | loss: 0.3892001
	speed: 0.0226s/iter; left time: 589.9249s
	iters: 1200, epoch: 9 | loss: 0.3539595
	speed: 0.0243s/iter; left time: 632.0127s
	iters: 1300, epoch: 9 | loss: 1.0648566
	speed: 0.0229s/iter; left time: 591.5338s
	iters: 1400, epoch: 9 | loss: 0.5431937
	speed: 0.0218s/iter; left time: 560.4712s
	iters: 1500, epoch: 9 | loss: 0.4759019
	speed: 0.0235s/iter; left time: 602.3721s
	iters: 1600, epoch: 9 | loss: 1.1446024
	speed: 0.0229s/iter; left time: 585.8059s
	iters: 1700, epoch: 9 | loss: 0.3131419
	speed: 0.0246s/iter; left time: 625.4374s
	iters: 1800, epoch: 9 | loss: 0.4325708
	speed: 0.0227s/iter; left time: 574.5752s
	iters: 1900, epoch: 9 | loss: 0.9658098
	speed: 0.0231s/iter; left time: 583.4522s
	iters: 2000, epoch: 9 | loss: 0.4344260
	speed: 0.0232s/iter; left time: 582.4486s
	iters: 2100, epoch: 9 | loss: 0.3802865
	speed: 0.0225s/iter; left time: 563.8915s
	iters: 2200, epoch: 9 | loss: 0.4593149
	speed: 0.0221s/iter; left time: 551.4836s
Epoch: 9 cost time: 50.87281656265259
Epoch: 9, Steps: 2263 | Train Loss: 0.6590503 Vali Loss: 0.5381252 Test Loss: 0.2404002
Validation loss decreased (0.542735 --> 0.538125).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 1.0949868
	speed: 0.0857s/iter; left time: 2124.2145s
	iters: 200, epoch: 10 | loss: 0.3870434
	speed: 0.0217s/iter; left time: 534.9352s
	iters: 300, epoch: 10 | loss: 0.3417199
	speed: 0.0234s/iter; left time: 576.6151s
	iters: 400, epoch: 10 | loss: 1.6047056
	speed: 0.0243s/iter; left time: 594.3296s
	iters: 500, epoch: 10 | loss: 0.4006044
	speed: 0.0247s/iter; left time: 602.2297s
	iters: 600, epoch: 10 | loss: 0.4219961
	speed: 0.0239s/iter; left time: 579.7824s
	iters: 700, epoch: 10 | loss: 2.0780690
	speed: 0.0227s/iter; left time: 548.2602s
	iters: 800, epoch: 10 | loss: 0.3058288
	speed: 0.0235s/iter; left time: 565.4383s
	iters: 900, epoch: 10 | loss: 0.8716616
	speed: 0.0227s/iter; left time: 545.1290s
	iters: 1000, epoch: 10 | loss: 0.5071680
	speed: 0.0257s/iter; left time: 614.6298s
	iters: 1100, epoch: 10 | loss: 0.5072891
	speed: 0.0250s/iter; left time: 595.2605s
	iters: 1200, epoch: 10 | loss: 1.1000227
	speed: 0.0228s/iter; left time: 540.9511s
	iters: 1300, epoch: 10 | loss: 0.2585482
	speed: 0.0233s/iter; left time: 549.8770s
	iters: 1400, epoch: 10 | loss: 0.5276091
	speed: 0.0231s/iter; left time: 543.5756s
	iters: 1500, epoch: 10 | loss: 0.5987772
	speed: 0.0245s/iter; left time: 572.4894s
	iters: 1600, epoch: 10 | loss: 0.4522706
	speed: 0.0221s/iter; left time: 514.8284s
	iters: 1700, epoch: 10 | loss: 0.4235827
	speed: 0.0242s/iter; left time: 561.0952s
	iters: 1800, epoch: 10 | loss: 0.3798685
	speed: 0.0217s/iter; left time: 500.3859s
	iters: 1900, epoch: 10 | loss: 0.3168764
	speed: 0.0233s/iter; left time: 536.5397s
	iters: 2000, epoch: 10 | loss: 0.6161509
	speed: 0.0226s/iter; left time: 516.9884s
	iters: 2100, epoch: 10 | loss: 0.4697358
	speed: 0.0225s/iter; left time: 513.0490s
	iters: 2200, epoch: 10 | loss: 0.4914071
	speed: 0.0197s/iter; left time: 447.8995s
Epoch: 10 cost time: 52.41474628448486
Epoch: 10, Steps: 2263 | Train Loss: 0.6573594 Vali Loss: 0.5361115 Test Loss: 0.2393815
Validation loss decreased (0.538125 --> 0.536112).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.3998200
	speed: 0.0802s/iter; left time: 1806.9610s
	iters: 200, epoch: 11 | loss: 0.3822454
	speed: 0.0205s/iter; left time: 460.0487s
	iters: 300, epoch: 11 | loss: 0.4000082
	speed: 0.0222s/iter; left time: 494.8528s
	iters: 400, epoch: 11 | loss: 0.5117028
	speed: 0.0222s/iter; left time: 492.9892s
	iters: 500, epoch: 11 | loss: 0.2868224
	speed: 0.0214s/iter; left time: 474.4751s
	iters: 600, epoch: 11 | loss: 0.4195250
	speed: 0.0244s/iter; left time: 536.9778s
	iters: 700, epoch: 11 | loss: 0.4543415
	speed: 0.0213s/iter; left time: 468.0871s
	iters: 800, epoch: 11 | loss: 0.5022048
	speed: 0.0207s/iter; left time: 452.7547s
	iters: 900, epoch: 11 | loss: 0.6269186
	speed: 0.0210s/iter; left time: 455.2755s
	iters: 1000, epoch: 11 | loss: 0.3715312
	speed: 0.0233s/iter; left time: 504.0024s
	iters: 1100, epoch: 11 | loss: 1.5209025
	speed: 0.0215s/iter; left time: 462.2091s
	iters: 1200, epoch: 11 | loss: 0.3140026
	speed: 0.0226s/iter; left time: 484.6709s
	iters: 1300, epoch: 11 | loss: 0.3569364
	speed: 0.0234s/iter; left time: 499.9098s
	iters: 1400, epoch: 11 | loss: 0.4170672
	speed: 0.0222s/iter; left time: 471.5321s
	iters: 1500, epoch: 11 | loss: 0.4643849
	speed: 0.0221s/iter; left time: 467.6415s
	iters: 1600, epoch: 11 | loss: 0.4880916
	speed: 0.0210s/iter; left time: 440.8151s
	iters: 1700, epoch: 11 | loss: 0.5086970
	speed: 0.0228s/iter; left time: 476.7268s
	iters: 1800, epoch: 11 | loss: 0.3836239
	speed: 0.0223s/iter; left time: 464.4821s
	iters: 1900, epoch: 11 | loss: 0.8485404
	speed: 0.0243s/iter; left time: 504.7744s
	iters: 2000, epoch: 11 | loss: 1.0892359
	speed: 0.0189s/iter; left time: 388.9161s
	iters: 2100, epoch: 11 | loss: 0.4693005
	speed: 0.0219s/iter; left time: 449.5607s
	iters: 2200, epoch: 11 | loss: 0.4559829
	speed: 0.0225s/iter; left time: 460.4596s
Epoch: 11 cost time: 49.752272605895996
Epoch: 11, Steps: 2263 | Train Loss: 0.6546770 Vali Loss: 0.5342361 Test Loss: 0.2391982
Validation loss decreased (0.536112 --> 0.534236).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.4265186
	speed: 0.0850s/iter; left time: 1723.6817s
	iters: 200, epoch: 12 | loss: 0.5218787
	speed: 0.0199s/iter; left time: 401.0697s
	iters: 300, epoch: 12 | loss: 0.4226677
	speed: 0.0207s/iter; left time: 415.3323s
	iters: 400, epoch: 12 | loss: 0.9740666
	speed: 0.0220s/iter; left time: 438.6885s
	iters: 500, epoch: 12 | loss: 0.4583629
	speed: 0.0230s/iter; left time: 457.7311s
	iters: 600, epoch: 12 | loss: 0.4245654
	speed: 0.0237s/iter; left time: 468.7366s
	iters: 700, epoch: 12 | loss: 0.4007213
	speed: 0.0231s/iter; left time: 453.5385s
	iters: 800, epoch: 12 | loss: 0.9088976
	speed: 0.0229s/iter; left time: 447.7376s
	iters: 900, epoch: 12 | loss: 0.5153922
	speed: 0.0209s/iter; left time: 407.3793s
	iters: 1000, epoch: 12 | loss: 0.3435209
	speed: 0.0254s/iter; left time: 492.4785s
	iters: 1100, epoch: 12 | loss: 0.6470225
	speed: 0.0222s/iter; left time: 428.5823s
	iters: 1200, epoch: 12 | loss: 0.9543075
	speed: 0.0210s/iter; left time: 403.2798s
	iters: 1300, epoch: 12 | loss: 0.4781906
	speed: 0.0222s/iter; left time: 423.5865s
	iters: 1400, epoch: 12 | loss: 0.4910010
	speed: 0.0184s/iter; left time: 348.5121s
	iters: 1500, epoch: 12 | loss: 0.5063611
	speed: 0.0235s/iter; left time: 442.8728s
	iters: 1600, epoch: 12 | loss: 0.7097567
	speed: 0.0228s/iter; left time: 428.4134s
	iters: 1700, epoch: 12 | loss: 0.3899123
	speed: 0.0231s/iter; left time: 431.7479s
	iters: 1800, epoch: 12 | loss: 0.5595727
	speed: 0.0223s/iter; left time: 414.4709s
	iters: 1900, epoch: 12 | loss: 0.3956542
	speed: 0.0226s/iter; left time: 416.9506s
	iters: 2000, epoch: 12 | loss: 1.1547271
	speed: 0.0232s/iter; left time: 426.5372s
	iters: 2100, epoch: 12 | loss: 1.1866308
	speed: 0.0219s/iter; left time: 400.8655s
	iters: 2200, epoch: 12 | loss: 0.6063436
	speed: 0.0221s/iter; left time: 401.1385s
Epoch: 12 cost time: 50.249650716781616
Epoch: 12, Steps: 2263 | Train Loss: 0.6538274 Vali Loss: 0.5345879 Test Loss: 0.2392603
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.3273416
	speed: 0.0815s/iter; left time: 1468.0918s
	iters: 200, epoch: 13 | loss: 0.4567848
	speed: 0.0209s/iter; left time: 374.7598s
	iters: 300, epoch: 13 | loss: 0.3283761
	speed: 0.0197s/iter; left time: 350.6569s
	iters: 400, epoch: 13 | loss: 0.5184736
	speed: 0.0237s/iter; left time: 420.2346s
	iters: 500, epoch: 13 | loss: 0.5617864
	speed: 0.0219s/iter; left time: 385.8526s
	iters: 600, epoch: 13 | loss: 0.9345511
	speed: 0.0226s/iter; left time: 395.3387s
	iters: 700, epoch: 13 | loss: 0.5574935
	speed: 0.0209s/iter; left time: 363.1018s
	iters: 800, epoch: 13 | loss: 3.0846081
	speed: 0.0203s/iter; left time: 351.4268s
	iters: 900, epoch: 13 | loss: 0.4021282
	speed: 0.0238s/iter; left time: 408.7705s
	iters: 1000, epoch: 13 | loss: 0.4891000
	speed: 0.0231s/iter; left time: 394.6972s
	iters: 1100, epoch: 13 | loss: 0.9944261
	speed: 0.0222s/iter; left time: 377.7014s
	iters: 1200, epoch: 13 | loss: 0.5071502
	speed: 0.0245s/iter; left time: 414.4561s
	iters: 1300, epoch: 13 | loss: 0.5222427
	speed: 0.0235s/iter; left time: 395.0778s
	iters: 1400, epoch: 13 | loss: 0.4682931
	speed: 0.0224s/iter; left time: 374.2557s
	iters: 1500, epoch: 13 | loss: 0.5334271
	speed: 0.0209s/iter; left time: 346.7909s
	iters: 1600, epoch: 13 | loss: 0.3174735
	speed: 0.0245s/iter; left time: 404.4172s
	iters: 1700, epoch: 13 | loss: 0.9512939
	speed: 0.0234s/iter; left time: 383.4653s
	iters: 1800, epoch: 13 | loss: 0.9090230
	speed: 0.0230s/iter; left time: 375.0462s
	iters: 1900, epoch: 13 | loss: 0.4417305
	speed: 0.0234s/iter; left time: 379.5055s
	iters: 2000, epoch: 13 | loss: 0.3427551
	speed: 0.0224s/iter; left time: 360.4194s
	iters: 2100, epoch: 13 | loss: 1.0388001
	speed: 0.0208s/iter; left time: 333.2004s
	iters: 2200, epoch: 13 | loss: 0.4157013
	speed: 0.0200s/iter; left time: 317.7075s
Epoch: 13 cost time: 50.40260434150696
Epoch: 13, Steps: 2263 | Train Loss: 0.6533588 Vali Loss: 0.5353488 Test Loss: 0.2394822
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.4785675
	speed: 0.0829s/iter; left time: 1305.2320s
	iters: 200, epoch: 14 | loss: 0.3317512
	speed: 0.0223s/iter; left time: 348.7474s
	iters: 300, epoch: 14 | loss: 0.4236086
	speed: 0.0215s/iter; left time: 334.4386s
	iters: 400, epoch: 14 | loss: 0.4438592
	speed: 0.0208s/iter; left time: 321.5276s
	iters: 500, epoch: 14 | loss: 0.5173631
	speed: 0.0239s/iter; left time: 366.5836s
	iters: 600, epoch: 14 | loss: 0.4318114
	speed: 0.0216s/iter; left time: 328.6317s
	iters: 700, epoch: 14 | loss: 0.5095485
	speed: 0.0257s/iter; left time: 388.8694s
	iters: 800, epoch: 14 | loss: 0.3898564
	speed: 0.0247s/iter; left time: 370.9304s
	iters: 900, epoch: 14 | loss: 1.0678208
	speed: 0.0244s/iter; left time: 364.6796s
	iters: 1000, epoch: 14 | loss: 0.3252105
	speed: 0.0239s/iter; left time: 355.4533s
	iters: 1100, epoch: 14 | loss: 0.4296750
	speed: 0.0232s/iter; left time: 341.3590s
	iters: 1200, epoch: 14 | loss: 0.4686412
	speed: 0.0247s/iter; left time: 362.1506s
	iters: 1300, epoch: 14 | loss: 0.4744851
	speed: 0.0232s/iter; left time: 336.8241s
	iters: 1400, epoch: 14 | loss: 0.4265588
	speed: 0.0239s/iter; left time: 345.0292s
	iters: 1500, epoch: 14 | loss: 0.4291606
	speed: 0.0222s/iter; left time: 318.1046s
	iters: 1600, epoch: 14 | loss: 0.4456989
	speed: 0.0219s/iter; left time: 312.0809s
	iters: 1700, epoch: 14 | loss: 1.0868075
	speed: 0.0247s/iter; left time: 349.8786s
	iters: 1800, epoch: 14 | loss: 0.3456883
	speed: 0.0218s/iter; left time: 306.2454s
	iters: 1900, epoch: 14 | loss: 0.4543246
	speed: 0.0229s/iter; left time: 318.6568s
	iters: 2000, epoch: 14 | loss: 0.9812270
	speed: 0.0245s/iter; left time: 339.3137s
	iters: 2100, epoch: 14 | loss: 0.4495540
	speed: 0.0210s/iter; left time: 289.0613s
	iters: 2200, epoch: 14 | loss: 0.5693446
	speed: 0.0215s/iter; left time: 293.6539s
Epoch: 14 cost time: 51.87559366226196
Epoch: 14, Steps: 2263 | Train Loss: 0.6531687 Vali Loss: 0.5353574 Test Loss: 0.2394232
EarlyStopping counter: 3 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.6046380
	speed: 0.0781s/iter; left time: 1052.3763s
	iters: 200, epoch: 15 | loss: 0.4442941
	speed: 0.0223s/iter; left time: 298.0444s
	iters: 300, epoch: 15 | loss: 0.4752965
	speed: 0.0221s/iter; left time: 292.8266s
	iters: 400, epoch: 15 | loss: 0.4633724
	speed: 0.0225s/iter; left time: 296.8269s
	iters: 500, epoch: 15 | loss: 0.3455134
	speed: 0.0194s/iter; left time: 253.2736s
	iters: 600, epoch: 15 | loss: 0.4142615
	speed: 0.0201s/iter; left time: 261.0754s
	iters: 700, epoch: 15 | loss: 0.3933666
	speed: 0.0200s/iter; left time: 256.9481s
	iters: 800, epoch: 15 | loss: 1.8639946
	speed: 0.0205s/iter; left time: 262.0378s
	iters: 900, epoch: 15 | loss: 0.4435511
	speed: 0.0207s/iter; left time: 262.6408s
	iters: 1000, epoch: 15 | loss: 0.4551360
	speed: 0.0200s/iter; left time: 251.1399s
	iters: 1100, epoch: 15 | loss: 0.9702925
	speed: 0.0203s/iter; left time: 253.3668s
	iters: 1200, epoch: 15 | loss: 0.3929724
	speed: 0.0204s/iter; left time: 252.8314s
	iters: 1300, epoch: 15 | loss: 1.1525013
	speed: 0.0199s/iter; left time: 244.4132s
	iters: 1400, epoch: 15 | loss: 1.2279006
	speed: 0.0200s/iter; left time: 244.1634s
	iters: 1500, epoch: 15 | loss: 0.3894463
	speed: 0.0188s/iter; left time: 226.6499s
	iters: 1600, epoch: 15 | loss: 0.4274044
	speed: 0.0179s/iter; left time: 214.6981s
	iters: 1700, epoch: 15 | loss: 1.4200535
	speed: 0.0189s/iter; left time: 224.5330s
	iters: 1800, epoch: 15 | loss: 0.5369312
	speed: 0.0183s/iter; left time: 215.8360s
	iters: 1900, epoch: 15 | loss: 0.4799356
	speed: 0.0192s/iter; left time: 224.4852s
	iters: 2000, epoch: 15 | loss: 0.4726321
	speed: 0.0193s/iter; left time: 223.4075s
	iters: 2100, epoch: 15 | loss: 1.0062761
	speed: 0.0187s/iter; left time: 214.7280s
	iters: 2200, epoch: 15 | loss: 0.3562449
	speed: 0.0180s/iter; left time: 204.3827s
Epoch: 15 cost time: 45.03127408027649
Epoch: 15, Steps: 2263 | Train Loss: 0.6527862 Vali Loss: 0.5354329 Test Loss: 0.2394527
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.6112039
	speed: 0.0745s/iter; left time: 835.8549s
	iters: 200, epoch: 16 | loss: 0.5573940
	speed: 0.0190s/iter; left time: 211.1183s
	iters: 300, epoch: 16 | loss: 0.5891622
	speed: 0.0182s/iter; left time: 200.8765s
	iters: 400, epoch: 16 | loss: 0.3538611
	speed: 0.0188s/iter; left time: 205.5682s
	iters: 500, epoch: 16 | loss: 1.0087210
	speed: 0.0188s/iter; left time: 203.3801s
	iters: 600, epoch: 16 | loss: 0.3580693
	speed: 0.0189s/iter; left time: 202.7005s
	iters: 700, epoch: 16 | loss: 0.2951063
	speed: 0.0189s/iter; left time: 200.4772s
	iters: 800, epoch: 16 | loss: 0.8971009
	speed: 0.0186s/iter; left time: 195.3951s
	iters: 900, epoch: 16 | loss: 0.4063988
	speed: 0.0189s/iter; left time: 196.5800s
	iters: 1000, epoch: 16 | loss: 0.4506229
	speed: 0.0187s/iter; left time: 193.0206s
	iters: 1100, epoch: 16 | loss: 0.4333830
	speed: 0.0191s/iter; left time: 195.3671s
	iters: 1200, epoch: 16 | loss: 0.3808990
	speed: 0.0189s/iter; left time: 191.2435s
	iters: 1300, epoch: 16 | loss: 0.3608564
	speed: 0.0192s/iter; left time: 191.8813s
	iters: 1400, epoch: 16 | loss: 0.9113663
	speed: 0.0163s/iter; left time: 161.4516s
	iters: 1500, epoch: 16 | loss: 0.4850631
	speed: 0.0196s/iter; left time: 192.1436s
	iters: 1600, epoch: 16 | loss: 0.4414333
	speed: 0.0199s/iter; left time: 192.9215s
	iters: 1700, epoch: 16 | loss: 1.0301424
	speed: 0.0192s/iter; left time: 184.7623s
	iters: 1800, epoch: 16 | loss: 0.8639805
	speed: 0.0188s/iter; left time: 178.9302s
	iters: 1900, epoch: 16 | loss: 0.3947672
	speed: 0.0193s/iter; left time: 181.3210s
	iters: 2000, epoch: 16 | loss: 0.3070343
	speed: 0.0197s/iter; left time: 183.7543s
	iters: 2100, epoch: 16 | loss: 0.6639051
	speed: 0.0200s/iter; left time: 184.2661s
	iters: 2200, epoch: 16 | loss: 0.2992073
	speed: 0.0191s/iter; left time: 173.9702s
Epoch: 16 cost time: 42.742939710617065
Epoch: 16, Steps: 2263 | Train Loss: 0.6529623 Vali Loss: 0.5354755 Test Loss: 0.2394648
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : weather_336_336_NLinear_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed28649<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10204
mse:0.23925496637821198, mae:0.27752500772476196
