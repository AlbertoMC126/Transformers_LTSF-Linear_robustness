Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='NLinear', model_id='Electricity_336_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=336, root_path='./dataset/', save_pred_values=False, seed=15227, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : Electricity_336_336_NLinear_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15227>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17741
val 2297
test 4925
	iters: 100, epoch: 1 | loss: 0.2420984
	speed: 0.0988s/iter; left time: 2180.2174s
	iters: 200, epoch: 1 | loss: 0.2382597
	speed: 0.0839s/iter; left time: 1842.5299s
	iters: 300, epoch: 1 | loss: 0.2753234
	speed: 0.0839s/iter; left time: 1833.6313s
	iters: 400, epoch: 1 | loss: 0.2382259
	speed: 0.0838s/iter; left time: 1824.3982s
	iters: 500, epoch: 1 | loss: 0.3356152
	speed: 0.0840s/iter; left time: 1819.9870s
	iters: 600, epoch: 1 | loss: 0.2185890
	speed: 0.0861s/iter; left time: 1856.6598s
	iters: 700, epoch: 1 | loss: 0.2499775
	speed: 0.0849s/iter; left time: 1823.0271s
	iters: 800, epoch: 1 | loss: 0.2533795
	speed: 0.0951s/iter; left time: 2030.6787s
	iters: 900, epoch: 1 | loss: 0.2770883
	speed: 0.0842s/iter; left time: 1790.5153s
	iters: 1000, epoch: 1 | loss: 0.2677674
	speed: 0.0853s/iter; left time: 1806.0435s
	iters: 1100, epoch: 1 | loss: 0.2952946
	speed: 0.0849s/iter; left time: 1788.4808s
Epoch: 1 cost time: 96.25036931037903
Epoch: 1, Steps: 1108 | Train Loss: 0.2784339 Vali Loss: 0.2587575 Test Loss: 0.2954613
Validation loss decreased (inf --> 0.258757).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.2837074
	speed: 0.2411s/iter; left time: 5052.0917s
	iters: 200, epoch: 2 | loss: 0.2626267
	speed: 0.0860s/iter; left time: 1793.5728s
	iters: 300, epoch: 2 | loss: 0.3231447
	speed: 0.0861s/iter; left time: 1787.2202s
	iters: 400, epoch: 2 | loss: 0.2554919
	speed: 0.0870s/iter; left time: 1797.6565s
	iters: 500, epoch: 2 | loss: 0.2502582
	speed: 0.0858s/iter; left time: 1763.5827s
	iters: 600, epoch: 2 | loss: 0.2379773
	speed: 0.0862s/iter; left time: 1762.6159s
	iters: 700, epoch: 2 | loss: 0.2351829
	speed: 0.0874s/iter; left time: 1779.7832s
	iters: 800, epoch: 2 | loss: 0.3283896
	speed: 0.0891s/iter; left time: 1805.2269s
	iters: 900, epoch: 2 | loss: 0.2659071
	speed: 0.0940s/iter; left time: 1893.7205s
	iters: 1000, epoch: 2 | loss: 0.2790380
	speed: 0.0853s/iter; left time: 1710.6331s
	iters: 1100, epoch: 2 | loss: 0.3045257
	speed: 0.0852s/iter; left time: 1699.0016s
Epoch: 2 cost time: 96.53037166595459
Epoch: 2, Steps: 1108 | Train Loss: 0.2652980 Vali Loss: 0.2281259 Test Loss: 0.2570712
Validation loss decreased (0.258757 --> 0.228126).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.2178955
	speed: 0.2391s/iter; left time: 4745.4577s
	iters: 200, epoch: 3 | loss: 0.2287719
	speed: 0.0846s/iter; left time: 1671.2747s
	iters: 300, epoch: 3 | loss: 0.1943805
	speed: 0.0852s/iter; left time: 1674.3550s
	iters: 400, epoch: 3 | loss: 0.2316408
	speed: 0.0867s/iter; left time: 1694.1023s
	iters: 500, epoch: 3 | loss: 0.2183976
	speed: 0.0866s/iter; left time: 1683.8977s
	iters: 600, epoch: 3 | loss: 0.2091275
	speed: 0.0878s/iter; left time: 1697.9243s
	iters: 700, epoch: 3 | loss: 0.1964904
	speed: 0.0876s/iter; left time: 1685.3990s
	iters: 800, epoch: 3 | loss: 0.2299287
	speed: 0.0893s/iter; left time: 1709.4843s
	iters: 900, epoch: 3 | loss: 0.2448671
	speed: 0.0883s/iter; left time: 1682.3599s
	iters: 1000, epoch: 3 | loss: 0.2005333
	speed: 0.0870s/iter; left time: 1648.5002s
	iters: 1100, epoch: 3 | loss: 0.2264508
	speed: 0.0843s/iter; left time: 1588.1307s
Epoch: 3 cost time: 95.94774055480957
Epoch: 3, Steps: 1108 | Train Loss: 0.2064957 Vali Loss: 0.1841791 Test Loss: 0.2054547
Validation loss decreased (0.228126 --> 0.184179).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.1766033
	speed: 0.2430s/iter; left time: 4553.9158s
	iters: 200, epoch: 4 | loss: 0.1641973
	speed: 0.0845s/iter; left time: 1575.3163s
	iters: 300, epoch: 4 | loss: 0.1876397
	speed: 0.0839s/iter; left time: 1555.8753s
	iters: 400, epoch: 4 | loss: 0.1790968
	speed: 0.0849s/iter; left time: 1565.1772s
	iters: 500, epoch: 4 | loss: 0.1737998
	speed: 0.0855s/iter; left time: 1567.7104s
	iters: 600, epoch: 4 | loss: 0.1795651
	speed: 0.0856s/iter; left time: 1561.4455s
	iters: 700, epoch: 4 | loss: 0.1788752
	speed: 0.0845s/iter; left time: 1533.4360s
	iters: 800, epoch: 4 | loss: 0.1825330
	speed: 0.0844s/iter; left time: 1522.0760s
	iters: 900, epoch: 4 | loss: 0.2249053
	speed: 0.0846s/iter; left time: 1517.7968s
	iters: 1000, epoch: 4 | loss: 0.1681856
	speed: 0.0854s/iter; left time: 1523.2989s
	iters: 1100, epoch: 4 | loss: 0.2367253
	speed: 0.0847s/iter; left time: 1502.8141s
Epoch: 4 cost time: 94.173259973526
Epoch: 4, Steps: 1108 | Train Loss: 0.1873894 Vali Loss: 0.1629615 Test Loss: 0.1865918
Validation loss decreased (0.184179 --> 0.162962).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.1827872
	speed: 0.2416s/iter; left time: 4259.2144s
	iters: 200, epoch: 5 | loss: 0.1823801
	speed: 0.0847s/iter; left time: 1485.3320s
	iters: 300, epoch: 5 | loss: 0.2198130
	speed: 0.0847s/iter; left time: 1476.0728s
	iters: 400, epoch: 5 | loss: 0.1703915
	speed: 0.0852s/iter; left time: 1476.7621s
	iters: 500, epoch: 5 | loss: 0.1873560
	speed: 0.0852s/iter; left time: 1467.3181s
	iters: 600, epoch: 5 | loss: 0.1548328
	speed: 0.0889s/iter; left time: 1522.1508s
	iters: 700, epoch: 5 | loss: 0.1531997
	speed: 0.0884s/iter; left time: 1505.2944s
	iters: 800, epoch: 5 | loss: 0.1625817
	speed: 0.0881s/iter; left time: 1491.2402s
	iters: 900, epoch: 5 | loss: 0.2136406
	speed: 0.0881s/iter; left time: 1482.9052s
	iters: 1000, epoch: 5 | loss: 0.1944708
	speed: 0.0887s/iter; left time: 1483.4390s
	iters: 1100, epoch: 5 | loss: 0.1740613
	speed: 0.0883s/iter; left time: 1468.4975s
Epoch: 5 cost time: 96.33328437805176
Epoch: 5, Steps: 1108 | Train Loss: 0.1773747 Vali Loss: 0.1543917 Test Loss: 0.1780857
Validation loss decreased (0.162962 --> 0.154392).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.1754997
	speed: 0.2477s/iter; left time: 4092.9369s
	iters: 200, epoch: 6 | loss: 0.1696829
	speed: 0.0867s/iter; left time: 1424.4452s
	iters: 300, epoch: 6 | loss: 0.1696123
	speed: 0.0866s/iter; left time: 1413.4932s
	iters: 400, epoch: 6 | loss: 0.1782989
	speed: 0.0858s/iter; left time: 1391.8691s
	iters: 500, epoch: 6 | loss: 0.1831130
	speed: 0.0858s/iter; left time: 1383.6334s
	iters: 600, epoch: 6 | loss: 0.1625212
	speed: 0.0860s/iter; left time: 1377.7771s
	iters: 700, epoch: 6 | loss: 0.1594669
	speed: 0.0862s/iter; left time: 1372.1719s
	iters: 800, epoch: 6 | loss: 0.1751391
	speed: 0.0866s/iter; left time: 1369.7480s
	iters: 900, epoch: 6 | loss: 0.1875327
	speed: 0.0881s/iter; left time: 1385.6687s
	iters: 1000, epoch: 6 | loss: 0.1859242
	speed: 0.0870s/iter; left time: 1359.5726s
	iters: 1100, epoch: 6 | loss: 0.1422284
	speed: 0.0872s/iter; left time: 1353.5302s
Epoch: 6 cost time: 96.04529285430908
Epoch: 6, Steps: 1108 | Train Loss: 0.1719906 Vali Loss: 0.1494397 Test Loss: 0.1729894
Validation loss decreased (0.154392 --> 0.149440).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.1646806
	speed: 0.2428s/iter; left time: 3742.6742s
	iters: 200, epoch: 7 | loss: 0.1322331
	speed: 0.0857s/iter; left time: 1312.1806s
	iters: 300, epoch: 7 | loss: 0.1530146
	speed: 0.0857s/iter; left time: 1303.8997s
	iters: 400, epoch: 7 | loss: 0.1800807
	speed: 0.0865s/iter; left time: 1307.5455s
	iters: 500, epoch: 7 | loss: 0.1927816
	speed: 0.0865s/iter; left time: 1299.1983s
	iters: 600, epoch: 7 | loss: 0.1841955
	speed: 0.0861s/iter; left time: 1284.3326s
	iters: 700, epoch: 7 | loss: 0.1483930
	speed: 0.0861s/iter; left time: 1274.7366s
	iters: 800, epoch: 7 | loss: 0.1591940
	speed: 0.0853s/iter; left time: 1254.6678s
	iters: 900, epoch: 7 | loss: 0.1628986
	speed: 0.0867s/iter; left time: 1267.2352s
	iters: 1000, epoch: 7 | loss: 0.1699338
	speed: 0.0863s/iter; left time: 1252.8373s
	iters: 1100, epoch: 7 | loss: 0.1556949
	speed: 0.0855s/iter; left time: 1233.0183s
Epoch: 7 cost time: 95.36383485794067
Epoch: 7, Steps: 1108 | Train Loss: 0.1690381 Vali Loss: 0.1471349 Test Loss: 0.1700825
Validation loss decreased (0.149440 --> 0.147135).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.1689587
	speed: 0.2436s/iter; left time: 3484.5380s
	iters: 200, epoch: 8 | loss: 0.1751754
	speed: 0.0878s/iter; left time: 1246.4915s
	iters: 300, epoch: 8 | loss: 0.1849588
	speed: 0.0872s/iter; left time: 1229.6226s
	iters: 400, epoch: 8 | loss: 0.1374980
	speed: 0.0869s/iter; left time: 1217.5512s
	iters: 500, epoch: 8 | loss: 0.2025794
	speed: 0.0856s/iter; left time: 1190.6184s
	iters: 600, epoch: 8 | loss: 0.1777558
	speed: 0.0869s/iter; left time: 1199.5011s
	iters: 700, epoch: 8 | loss: 0.1847797
	speed: 0.0871s/iter; left time: 1193.8202s
	iters: 800, epoch: 8 | loss: 0.1486177
	speed: 0.0872s/iter; left time: 1185.7105s
	iters: 900, epoch: 8 | loss: 0.1612314
	speed: 0.0876s/iter; left time: 1183.1117s
	iters: 1000, epoch: 8 | loss: 0.1564134
	speed: 0.0882s/iter; left time: 1182.7630s
	iters: 1100, epoch: 8 | loss: 0.1688842
	speed: 0.0877s/iter; left time: 1166.9852s
Epoch: 8 cost time: 96.51954507827759
Epoch: 8, Steps: 1108 | Train Loss: 0.1674191 Vali Loss: 0.1460071 Test Loss: 0.1690004
Validation loss decreased (0.147135 --> 0.146007).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.1734003
	speed: 0.2497s/iter; left time: 3295.6452s
	iters: 200, epoch: 9 | loss: 0.1860051
	speed: 0.0878s/iter; left time: 1149.8554s
	iters: 300, epoch: 9 | loss: 0.1406751
	speed: 0.0873s/iter; left time: 1134.5054s
	iters: 400, epoch: 9 | loss: 0.1694143
	speed: 0.0870s/iter; left time: 1121.9749s
	iters: 500, epoch: 9 | loss: 0.1674498
	speed: 0.0874s/iter; left time: 1118.8595s
	iters: 600, epoch: 9 | loss: 0.1686497
	speed: 0.0871s/iter; left time: 1105.4816s
	iters: 700, epoch: 9 | loss: 0.1670531
	speed: 0.0865s/iter; left time: 1089.8316s
	iters: 800, epoch: 9 | loss: 0.1692122
	speed: 0.0848s/iter; left time: 1059.8857s
	iters: 900, epoch: 9 | loss: 0.1427877
	speed: 0.0857s/iter; left time: 1062.5969s
	iters: 1000, epoch: 9 | loss: 0.2151622
	speed: 0.0862s/iter; left time: 1060.2445s
	iters: 1100, epoch: 9 | loss: 0.1480896
	speed: 0.0869s/iter; left time: 1059.4762s
Epoch: 9 cost time: 96.45824813842773
Epoch: 9, Steps: 1108 | Train Loss: 0.1665593 Vali Loss: 0.1454503 Test Loss: 0.1684581
Validation loss decreased (0.146007 --> 0.145450).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.1556345
	speed: 0.2488s/iter; left time: 3007.5522s
	iters: 200, epoch: 10 | loss: 0.1516032
	speed: 0.0906s/iter; left time: 1085.6371s
	iters: 300, epoch: 10 | loss: 0.1550619
	speed: 0.0912s/iter; left time: 1083.9546s
	iters: 400, epoch: 10 | loss: 0.1889758
	speed: 0.0864s/iter; left time: 1018.6746s
	iters: 500, epoch: 10 | loss: 0.1774247
	speed: 0.0861s/iter; left time: 1006.0788s
	iters: 600, epoch: 10 | loss: 0.1416816
	speed: 0.0856s/iter; left time: 992.0935s
	iters: 700, epoch: 10 | loss: 0.1490482
	speed: 0.0855s/iter; left time: 982.4297s
	iters: 800, epoch: 10 | loss: 0.1702661
	speed: 0.0868s/iter; left time: 988.5280s
	iters: 900, epoch: 10 | loss: 0.1460158
	speed: 0.0861s/iter; left time: 971.6266s
	iters: 1000, epoch: 10 | loss: 0.1830267
	speed: 0.0852s/iter; left time: 953.5271s
	iters: 1100, epoch: 10 | loss: 0.1532876
	speed: 0.0849s/iter; left time: 940.9500s
Epoch: 10 cost time: 96.54089260101318
Epoch: 10, Steps: 1108 | Train Loss: 0.1660968 Vali Loss: 0.1450403 Test Loss: 0.1680909
Validation loss decreased (0.145450 --> 0.145040).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.1609890
	speed: 0.2446s/iter; left time: 2686.3618s
	iters: 200, epoch: 11 | loss: 0.1736775
	speed: 0.0874s/iter; left time: 951.0340s
	iters: 300, epoch: 11 | loss: 0.1683023
	speed: 0.0883s/iter; left time: 952.0708s
	iters: 400, epoch: 11 | loss: 0.1811703
	speed: 0.0872s/iter; left time: 931.1170s
	iters: 500, epoch: 11 | loss: 0.1924300
	speed: 0.0861s/iter; left time: 911.0000s
	iters: 600, epoch: 11 | loss: 0.1463665
	speed: 0.0865s/iter; left time: 906.9524s
	iters: 700, epoch: 11 | loss: 0.1496470
	speed: 0.0870s/iter; left time: 903.2084s
	iters: 800, epoch: 11 | loss: 0.1912401
	speed: 0.0899s/iter; left time: 924.5091s
	iters: 900, epoch: 11 | loss: 0.1875688
	speed: 0.0860s/iter; left time: 875.9262s
	iters: 1000, epoch: 11 | loss: 0.1737584
	speed: 0.0871s/iter; left time: 878.0774s
	iters: 1100, epoch: 11 | loss: 0.1538285
	speed: 0.0870s/iter; left time: 868.3601s
Epoch: 11 cost time: 96.67256426811218
Epoch: 11, Steps: 1108 | Train Loss: 0.1658557 Vali Loss: 0.1449497 Test Loss: 0.1679108
Validation loss decreased (0.145040 --> 0.144950).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.1571025
	speed: 0.2491s/iter; left time: 2459.8545s
	iters: 200, epoch: 12 | loss: 0.1741392
	speed: 0.0896s/iter; left time: 875.7502s
	iters: 300, epoch: 12 | loss: 0.1349025
	speed: 0.0886s/iter; left time: 856.7921s
	iters: 400, epoch: 12 | loss: 0.1805708
	speed: 0.0883s/iter; left time: 844.8901s
	iters: 500, epoch: 12 | loss: 0.1655467
	speed: 0.0874s/iter; left time: 827.5092s
	iters: 600, epoch: 12 | loss: 0.1556618
	speed: 0.0872s/iter; left time: 817.2534s
	iters: 700, epoch: 12 | loss: 0.1842275
	speed: 0.0879s/iter; left time: 814.8450s
	iters: 800, epoch: 12 | loss: 0.1680365
	speed: 0.0868s/iter; left time: 796.2379s
	iters: 900, epoch: 12 | loss: 0.1655982
	speed: 0.0876s/iter; left time: 795.0420s
	iters: 1000, epoch: 12 | loss: 0.1475991
	speed: 0.0867s/iter; left time: 778.1039s
	iters: 1100, epoch: 12 | loss: 0.1500373
	speed: 0.0848s/iter; left time: 752.8187s
Epoch: 12 cost time: 97.196692943573
Epoch: 12, Steps: 1108 | Train Loss: 0.1656897 Vali Loss: 0.1448455 Test Loss: 0.1678701
Validation loss decreased (0.144950 --> 0.144846).  Saving model ...
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.2262817
	speed: 0.2438s/iter; left time: 2136.8517s
	iters: 200, epoch: 13 | loss: 0.1876047
	speed: 0.0896s/iter; left time: 776.2943s
	iters: 300, epoch: 13 | loss: 0.1882077
	speed: 0.0898s/iter; left time: 769.0638s
	iters: 400, epoch: 13 | loss: 0.1629074
	speed: 0.0867s/iter; left time: 734.0676s
	iters: 500, epoch: 13 | loss: 0.1839411
	speed: 0.0864s/iter; left time: 722.9725s
	iters: 600, epoch: 13 | loss: 0.1562689
	speed: 0.0864s/iter; left time: 713.9792s
	iters: 700, epoch: 13 | loss: 0.1648766
	speed: 0.0869s/iter; left time: 709.2095s
	iters: 800, epoch: 13 | loss: 0.1562002
	speed: 0.0860s/iter; left time: 693.9633s
	iters: 900, epoch: 13 | loss: 0.1711523
	speed: 0.0858s/iter; left time: 683.1021s
	iters: 1000, epoch: 13 | loss: 0.1908735
	speed: 0.0856s/iter; left time: 673.3612s
	iters: 1100, epoch: 13 | loss: 0.1690302
	speed: 0.0858s/iter; left time: 665.9246s
Epoch: 13 cost time: 96.42291021347046
Epoch: 13, Steps: 1108 | Train Loss: 0.1656606 Vali Loss: 0.1448346 Test Loss: 0.1678323
Validation loss decreased (0.144846 --> 0.144835).  Saving model ...
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.1427603
	speed: 0.2474s/iter; left time: 1894.1493s
	iters: 200, epoch: 14 | loss: 0.1630376
	speed: 0.0863s/iter; left time: 651.8085s
	iters: 300, epoch: 14 | loss: 0.1851020
	speed: 0.0880s/iter; left time: 656.3642s
	iters: 400, epoch: 14 | loss: 0.1978278
	speed: 0.0894s/iter; left time: 657.7445s
	iters: 500, epoch: 14 | loss: 0.1628918
	speed: 0.0872s/iter; left time: 632.6783s
	iters: 600, epoch: 14 | loss: 0.1716039
	speed: 0.0869s/iter; left time: 622.1219s
	iters: 700, epoch: 14 | loss: 0.1863809
	speed: 0.0860s/iter; left time: 606.6104s
	iters: 800, epoch: 14 | loss: 0.1647582
	speed: 0.0855s/iter; left time: 594.6680s
	iters: 900, epoch: 14 | loss: 0.1831459
	speed: 0.0861s/iter; left time: 590.5335s
	iters: 1000, epoch: 14 | loss: 0.1444188
	speed: 0.0862s/iter; left time: 582.7824s
	iters: 1100, epoch: 14 | loss: 0.1877150
	speed: 0.0858s/iter; left time: 571.4647s
Epoch: 14 cost time: 96.24136328697205
Epoch: 14, Steps: 1108 | Train Loss: 0.1655916 Vali Loss: 0.1448203 Test Loss: 0.1678279
Validation loss decreased (0.144835 --> 0.144820).  Saving model ...
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.1414150
	speed: 0.2475s/iter; left time: 1620.5502s
	iters: 200, epoch: 15 | loss: 0.1451955
	speed: 0.0873s/iter; left time: 562.9881s
	iters: 300, epoch: 15 | loss: 0.1655145
	speed: 0.0868s/iter; left time: 550.8030s
	iters: 400, epoch: 15 | loss: 0.1431620
	speed: 0.0876s/iter; left time: 547.4395s
	iters: 500, epoch: 15 | loss: 0.1679748
	speed: 0.0898s/iter; left time: 552.2126s
	iters: 600, epoch: 15 | loss: 0.1691877
	speed: 0.0876s/iter; left time: 530.1919s
	iters: 700, epoch: 15 | loss: 0.1551502
	speed: 0.0877s/iter; left time: 521.5085s
	iters: 800, epoch: 15 | loss: 0.1762672
	speed: 0.0870s/iter; left time: 508.6972s
	iters: 900, epoch: 15 | loss: 0.1663983
	speed: 0.0853s/iter; left time: 490.5573s
	iters: 1000, epoch: 15 | loss: 0.1460784
	speed: 0.0856s/iter; left time: 483.4394s
	iters: 1100, epoch: 15 | loss: 0.2156779
	speed: 0.0853s/iter; left time: 473.2105s
Epoch: 15 cost time: 96.46479749679565
Epoch: 15, Steps: 1108 | Train Loss: 0.1655879 Vali Loss: 0.1447653 Test Loss: 0.1678264
Validation loss decreased (0.144820 --> 0.144765).  Saving model ...
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.1621643
	speed: 0.2430s/iter; left time: 1322.3010s
	iters: 200, epoch: 16 | loss: 0.2027106
	speed: 0.0871s/iter; left time: 465.2552s
	iters: 300, epoch: 16 | loss: 0.1432150
	speed: 0.0866s/iter; left time: 453.7677s
	iters: 400, epoch: 16 | loss: 0.1650109
	speed: 0.0867s/iter; left time: 445.8711s
	iters: 500, epoch: 16 | loss: 0.1788035
	speed: 0.0854s/iter; left time: 430.3832s
	iters: 600, epoch: 16 | loss: 0.1691751
	speed: 0.0861s/iter; left time: 425.3262s
	iters: 700, epoch: 16 | loss: 0.1816414
	speed: 0.0911s/iter; left time: 441.0972s
	iters: 800, epoch: 16 | loss: 0.1387891
	speed: 0.0885s/iter; left time: 419.5337s
	iters: 900, epoch: 16 | loss: 0.1692213
	speed: 0.0854s/iter; left time: 396.2406s
	iters: 1000, epoch: 16 | loss: 0.1650480
	speed: 0.0853s/iter; left time: 387.2926s
	iters: 1100, epoch: 16 | loss: 0.1633708
	speed: 0.0848s/iter; left time: 376.7705s
Epoch: 16 cost time: 96.10833930969238
Epoch: 16, Steps: 1108 | Train Loss: 0.1655563 Vali Loss: 0.1447638 Test Loss: 0.1678237
Validation loss decreased (0.144765 --> 0.144764).  Saving model ...
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 17 | loss: 0.1589285
	speed: 0.2427s/iter; left time: 1051.5006s
	iters: 200, epoch: 17 | loss: 0.1548224
	speed: 0.0855s/iter; left time: 361.8960s
	iters: 300, epoch: 17 | loss: 0.1409862
	speed: 0.0857s/iter; left time: 354.0738s
	iters: 400, epoch: 17 | loss: 0.1597867
	speed: 0.0855s/iter; left time: 345.0069s
	iters: 500, epoch: 17 | loss: 0.1701654
	speed: 0.0858s/iter; left time: 337.3847s
	iters: 600, epoch: 17 | loss: 0.1645618
	speed: 0.0853s/iter; left time: 326.8418s
	iters: 700, epoch: 17 | loss: 0.1572820
	speed: 0.0859s/iter; left time: 320.6327s
	iters: 800, epoch: 17 | loss: 0.1508551
	speed: 0.0893s/iter; left time: 324.3375s
	iters: 900, epoch: 17 | loss: 0.1643370
	speed: 0.0850s/iter; left time: 300.2004s
	iters: 1000, epoch: 17 | loss: 0.1426890
	speed: 0.0845s/iter; left time: 290.0968s
	iters: 1100, epoch: 17 | loss: 0.1706585
	speed: 0.0843s/iter; left time: 280.9436s
Epoch: 17 cost time: 95.11682534217834
Epoch: 17, Steps: 1108 | Train Loss: 0.1655635 Vali Loss: 0.1448329 Test Loss: 0.1678240
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 18 | loss: 0.1360672
	speed: 0.2254s/iter; left time: 726.8469s
	iters: 200, epoch: 18 | loss: 0.1908707
	speed: 0.0863s/iter; left time: 269.7071s
	iters: 300, epoch: 18 | loss: 0.1714234
	speed: 0.0867s/iter; left time: 262.2790s
	iters: 400, epoch: 18 | loss: 0.1613505
	speed: 0.0871s/iter; left time: 254.7374s
	iters: 500, epoch: 18 | loss: 0.1481984
	speed: 0.0857s/iter; left time: 242.0583s
	iters: 600, epoch: 18 | loss: 0.1494859
	speed: 0.0864s/iter; left time: 235.5189s
	iters: 700, epoch: 18 | loss: 0.1426926
	speed: 0.0859s/iter; left time: 225.6007s
	iters: 800, epoch: 18 | loss: 0.2375337
	speed: 0.0861s/iter; left time: 217.2907s
	iters: 900, epoch: 18 | loss: 0.1935844
	speed: 0.0865s/iter; left time: 209.7398s
	iters: 1000, epoch: 18 | loss: 0.1801176
	speed: 0.0859s/iter; left time: 199.7262s
	iters: 1100, epoch: 18 | loss: 0.1924332
	speed: 0.0858s/iter; left time: 190.8435s
Epoch: 18 cost time: 95.49498534202576
Epoch: 18, Steps: 1108 | Train Loss: 0.1655779 Vali Loss: 0.1447375 Test Loss: 0.1678238
Validation loss decreased (0.144764 --> 0.144738).  Saving model ...
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 19 | loss: 0.1937556
	speed: 0.2419s/iter; left time: 512.0459s
	iters: 200, epoch: 19 | loss: 0.1475618
	speed: 0.0857s/iter; left time: 172.8038s
	iters: 300, epoch: 19 | loss: 0.1818692
	speed: 0.0865s/iter; left time: 165.8384s
	iters: 400, epoch: 19 | loss: 0.1727752
	speed: 0.0872s/iter; left time: 158.5219s
	iters: 500, epoch: 19 | loss: 0.1987165
	speed: 0.0873s/iter; left time: 149.8801s
	iters: 600, epoch: 19 | loss: 0.1807506
	speed: 0.0853s/iter; left time: 137.9477s
	iters: 700, epoch: 19 | loss: 0.1705972
	speed: 0.0854s/iter; left time: 129.4838s
	iters: 800, epoch: 19 | loss: 0.1521416
	speed: 0.0854s/iter; left time: 120.9838s
	iters: 900, epoch: 19 | loss: 0.1526203
	speed: 0.0862s/iter; left time: 113.5870s
	iters: 1000, epoch: 19 | loss: 0.1926900
	speed: 0.0852s/iter; left time: 103.7089s
	iters: 1100, epoch: 19 | loss: 0.1865106
	speed: 0.0854s/iter; left time: 95.4293s
Epoch: 19 cost time: 95.37491726875305
Epoch: 19, Steps: 1108 | Train Loss: 0.1655517 Vali Loss: 0.1448220 Test Loss: 0.1678239
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.9073486328125e-08
	iters: 100, epoch: 20 | loss: 0.1273679
	speed: 0.2315s/iter; left time: 233.6074s
	iters: 200, epoch: 20 | loss: 0.1556645
	speed: 0.0854s/iter; left time: 77.5917s
	iters: 300, epoch: 20 | loss: 0.1643555
	speed: 0.0853s/iter; left time: 69.0246s
	iters: 400, epoch: 20 | loss: 0.1815784
	speed: 0.0852s/iter; left time: 60.4406s
	iters: 500, epoch: 20 | loss: 0.1595112
	speed: 0.0849s/iter; left time: 51.6951s
	iters: 600, epoch: 20 | loss: 0.1637130
	speed: 0.0848s/iter; left time: 43.1765s
	iters: 700, epoch: 20 | loss: 0.1756794
	speed: 0.0859s/iter; left time: 35.1435s
	iters: 800, epoch: 20 | loss: 0.2001160
	speed: 0.0855s/iter; left time: 26.4156s
	iters: 900, epoch: 20 | loss: 0.1466222
	speed: 0.0849s/iter; left time: 17.7376s
	iters: 1000, epoch: 20 | loss: 0.1948767
	speed: 0.0843s/iter; left time: 9.1922s
	iters: 1100, epoch: 20 | loss: 0.1755595
	speed: 0.0849s/iter; left time: 0.7644s
Epoch: 20 cost time: 94.49100351333618
Epoch: 20, Steps: 1108 | Train Loss: 0.1655524 Vali Loss: 0.1448220 Test Loss: 0.1678238
EarlyStopping counter: 2 out of 5
Updating learning rate to 9.5367431640625e-09
>>>>>>>testing : Electricity_336_336_NLinear_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15227<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4925
mse:0.16771256923675537, mae:0.2601834535598755
