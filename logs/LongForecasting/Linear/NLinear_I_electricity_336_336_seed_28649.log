Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='NLinear', model_id='Electricity_336_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=336, root_path='./dataset/', save_pred_values=False, seed=28649, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : Electricity_336_336_NLinear_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed28649>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17741
val 2297
test 4925
	iters: 100, epoch: 1 | loss: 0.2552347
	speed: 0.1015s/iter; left time: 2239.4334s
	iters: 200, epoch: 1 | loss: 0.2967263
	speed: 0.0856s/iter; left time: 1880.8245s
	iters: 300, epoch: 1 | loss: 0.2787091
	speed: 0.0860s/iter; left time: 1879.0985s
	iters: 400, epoch: 1 | loss: 0.2486769
	speed: 0.0854s/iter; left time: 1857.8435s
	iters: 500, epoch: 1 | loss: 0.2694810
	speed: 0.0854s/iter; left time: 1850.7091s
	iters: 600, epoch: 1 | loss: 0.3066327
	speed: 0.0860s/iter; left time: 1854.6332s
	iters: 700, epoch: 1 | loss: 0.2678418
	speed: 0.0858s/iter; left time: 1840.4695s
	iters: 800, epoch: 1 | loss: 0.2859743
	speed: 0.0851s/iter; left time: 1818.1040s
	iters: 900, epoch: 1 | loss: 0.2355192
	speed: 0.0846s/iter; left time: 1799.3724s
	iters: 1000, epoch: 1 | loss: 0.2645986
	speed: 0.0863s/iter; left time: 1825.7878s
	iters: 1100, epoch: 1 | loss: 0.2764922
	speed: 0.0852s/iter; left time: 1794.2608s
Epoch: 1 cost time: 96.47003293037415
Epoch: 1, Steps: 1108 | Train Loss: 0.2788884 Vali Loss: 0.2311845 Test Loss: 0.2547467
Validation loss decreased (inf --> 0.231184).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.2834550
	speed: 0.2490s/iter; left time: 5217.0594s
	iters: 200, epoch: 2 | loss: 0.2499293
	speed: 0.0861s/iter; left time: 1794.6879s
	iters: 300, epoch: 2 | loss: 0.2936471
	speed: 0.0853s/iter; left time: 1769.8338s
	iters: 400, epoch: 2 | loss: 0.2212355
	speed: 0.0855s/iter; left time: 1766.5483s
	iters: 500, epoch: 2 | loss: 0.2348695
	speed: 0.0848s/iter; left time: 1742.0202s
	iters: 600, epoch: 2 | loss: 0.2557871
	speed: 0.0849s/iter; left time: 1737.4228s
	iters: 700, epoch: 2 | loss: 0.2663149
	speed: 0.0851s/iter; left time: 1731.8705s
	iters: 800, epoch: 2 | loss: 0.2590275
	speed: 0.0851s/iter; left time: 1724.4769s
	iters: 900, epoch: 2 | loss: 0.2640478
	speed: 0.0858s/iter; left time: 1728.7888s
	iters: 1000, epoch: 2 | loss: 0.2557919
	speed: 0.0853s/iter; left time: 1710.1238s
	iters: 1100, epoch: 2 | loss: 0.3166990
	speed: 0.0861s/iter; left time: 1717.2858s
Epoch: 2 cost time: 94.94003987312317
Epoch: 2, Steps: 1108 | Train Loss: 0.2654364 Vali Loss: 0.2353301 Test Loss: 0.2573615
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.1859520
	speed: 0.2354s/iter; left time: 4671.6652s
	iters: 200, epoch: 3 | loss: 0.2422354
	speed: 0.0857s/iter; left time: 1691.4916s
	iters: 300, epoch: 3 | loss: 0.1923503
	speed: 0.0861s/iter; left time: 1691.3827s
	iters: 400, epoch: 3 | loss: 0.1972940
	speed: 0.0857s/iter; left time: 1675.2880s
	iters: 500, epoch: 3 | loss: 0.1958459
	speed: 0.0855s/iter; left time: 1663.3730s
	iters: 600, epoch: 3 | loss: 0.1932400
	speed: 0.0856s/iter; left time: 1655.2878s
	iters: 700, epoch: 3 | loss: 0.2046675
	speed: 0.0861s/iter; left time: 1657.4593s
	iters: 800, epoch: 3 | loss: 0.1964468
	speed: 0.0869s/iter; left time: 1662.9997s
	iters: 900, epoch: 3 | loss: 0.2083367
	speed: 0.0883s/iter; left time: 1680.7539s
	iters: 1000, epoch: 3 | loss: 0.1897410
	speed: 0.0865s/iter; left time: 1638.7608s
	iters: 1100, epoch: 3 | loss: 0.1977054
	speed: 0.0868s/iter; left time: 1635.8632s
Epoch: 3 cost time: 95.8241834640503
Epoch: 3, Steps: 1108 | Train Loss: 0.2066700 Vali Loss: 0.1764246 Test Loss: 0.2035241
Validation loss decreased (0.231184 --> 0.176425).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.1708804
	speed: 0.2466s/iter; left time: 4620.0586s
	iters: 200, epoch: 4 | loss: 0.1953751
	speed: 0.0881s/iter; left time: 1641.0003s
	iters: 300, epoch: 4 | loss: 0.1548669
	speed: 0.0857s/iter; left time: 1588.0085s
	iters: 400, epoch: 4 | loss: 0.1839477
	speed: 0.0862s/iter; left time: 1588.6045s
	iters: 500, epoch: 4 | loss: 0.1720107
	speed: 0.0864s/iter; left time: 1583.5752s
	iters: 600, epoch: 4 | loss: 0.1937473
	speed: 0.0860s/iter; left time: 1567.7641s
	iters: 700, epoch: 4 | loss: 0.1652508
	speed: 0.0854s/iter; left time: 1548.4340s
	iters: 800, epoch: 4 | loss: 0.1870468
	speed: 0.0850s/iter; left time: 1533.6599s
	iters: 900, epoch: 4 | loss: 0.2463019
	speed: 0.0861s/iter; left time: 1544.7316s
	iters: 1000, epoch: 4 | loss: 0.1855949
	speed: 0.0851s/iter; left time: 1518.2407s
	iters: 1100, epoch: 4 | loss: 0.1737717
	speed: 0.0860s/iter; left time: 1524.7970s
Epoch: 4 cost time: 95.57919764518738
Epoch: 4, Steps: 1108 | Train Loss: 0.1872498 Vali Loss: 0.1633407 Test Loss: 0.1892013
Validation loss decreased (0.176425 --> 0.163341).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.1621584
	speed: 0.2485s/iter; left time: 4380.2523s
	iters: 200, epoch: 5 | loss: 0.2000764
	speed: 0.0899s/iter; left time: 1575.7054s
	iters: 300, epoch: 5 | loss: 0.1740907
	speed: 0.0897s/iter; left time: 1564.0731s
	iters: 400, epoch: 5 | loss: 0.1512015
	speed: 0.0853s/iter; left time: 1478.9035s
	iters: 500, epoch: 5 | loss: 0.1911336
	speed: 0.0846s/iter; left time: 1456.8563s
	iters: 600, epoch: 5 | loss: 0.1712144
	speed: 0.0848s/iter; left time: 1451.9561s
	iters: 700, epoch: 5 | loss: 0.1514052
	speed: 0.0851s/iter; left time: 1449.5158s
	iters: 800, epoch: 5 | loss: 0.1821640
	speed: 0.0850s/iter; left time: 1438.5140s
	iters: 900, epoch: 5 | loss: 0.1541819
	speed: 0.0842s/iter; left time: 1417.2923s
	iters: 1000, epoch: 5 | loss: 0.1664605
	speed: 0.0848s/iter; left time: 1418.2101s
	iters: 1100, epoch: 5 | loss: 0.1505043
	speed: 0.0842s/iter; left time: 1399.5086s
Epoch: 5 cost time: 95.45416116714478
Epoch: 5, Steps: 1108 | Train Loss: 0.1773677 Vali Loss: 0.1551297 Test Loss: 0.1791766
Validation loss decreased (0.163341 --> 0.155130).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.1729113
	speed: 0.2464s/iter; left time: 4070.4528s
	iters: 200, epoch: 6 | loss: 0.1565744
	speed: 0.0864s/iter; left time: 1418.4548s
	iters: 300, epoch: 6 | loss: 0.1817013
	speed: 0.0869s/iter; left time: 1419.0675s
	iters: 400, epoch: 6 | loss: 0.1738257
	speed: 0.0856s/iter; left time: 1388.7217s
	iters: 500, epoch: 6 | loss: 0.1376160
	speed: 0.0849s/iter; left time: 1368.3302s
	iters: 600, epoch: 6 | loss: 0.2036791
	speed: 0.0857s/iter; left time: 1372.3941s
	iters: 700, epoch: 6 | loss: 0.1557180
	speed: 0.0854s/iter; left time: 1359.3213s
	iters: 800, epoch: 6 | loss: 0.1496227
	speed: 0.0849s/iter; left time: 1342.7261s
	iters: 900, epoch: 6 | loss: 0.1361836
	speed: 0.0857s/iter; left time: 1347.5930s
	iters: 1000, epoch: 6 | loss: 0.2019996
	speed: 0.0856s/iter; left time: 1337.4880s
	iters: 1100, epoch: 6 | loss: 0.1525961
	speed: 0.0869s/iter; left time: 1348.2226s
Epoch: 6 cost time: 95.11446976661682
Epoch: 6, Steps: 1108 | Train Loss: 0.1719438 Vali Loss: 0.1496974 Test Loss: 0.1732122
Validation loss decreased (0.155130 --> 0.149697).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.1593828
	speed: 0.2511s/iter; left time: 3870.4398s
	iters: 200, epoch: 7 | loss: 0.2024574
	speed: 0.0872s/iter; left time: 1334.6944s
	iters: 300, epoch: 7 | loss: 0.1423192
	speed: 0.0870s/iter; left time: 1323.7598s
	iters: 400, epoch: 7 | loss: 0.1464380
	speed: 0.0867s/iter; left time: 1310.6509s
	iters: 500, epoch: 7 | loss: 0.2185284
	speed: 0.0867s/iter; left time: 1302.2199s
	iters: 600, epoch: 7 | loss: 0.1604254
	speed: 0.0860s/iter; left time: 1282.4207s
	iters: 700, epoch: 7 | loss: 0.1864552
	speed: 0.0855s/iter; left time: 1266.5585s
	iters: 800, epoch: 7 | loss: 0.1560030
	speed: 0.0863s/iter; left time: 1269.5277s
	iters: 900, epoch: 7 | loss: 0.2054111
	speed: 0.0866s/iter; left time: 1265.1320s
	iters: 1000, epoch: 7 | loss: 0.1425534
	speed: 0.0863s/iter; left time: 1251.8899s
	iters: 1100, epoch: 7 | loss: 0.1797941
	speed: 0.0851s/iter; left time: 1226.3638s
Epoch: 7 cost time: 95.96528649330139
Epoch: 7, Steps: 1108 | Train Loss: 0.1690544 Vali Loss: 0.1476697 Test Loss: 0.1704985
Validation loss decreased (0.149697 --> 0.147670).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.2016983
	speed: 0.2423s/iter; left time: 3465.8837s
	iters: 200, epoch: 8 | loss: 0.1836085
	speed: 0.0860s/iter; left time: 1221.6413s
	iters: 300, epoch: 8 | loss: 0.1641954
	speed: 0.0858s/iter; left time: 1210.5167s
	iters: 400, epoch: 8 | loss: 0.1507503
	speed: 0.0900s/iter; left time: 1260.6212s
	iters: 500, epoch: 8 | loss: 0.1552088
	speed: 0.0898s/iter; left time: 1248.7179s
	iters: 600, epoch: 8 | loss: 0.1756757
	speed: 0.0891s/iter; left time: 1230.1526s
	iters: 700, epoch: 8 | loss: 0.1631818
	speed: 0.0858s/iter; left time: 1175.5932s
	iters: 800, epoch: 8 | loss: 0.1572923
	speed: 0.0850s/iter; left time: 1156.3890s
	iters: 900, epoch: 8 | loss: 0.1460698
	speed: 0.0852s/iter; left time: 1150.7975s
	iters: 1000, epoch: 8 | loss: 0.1663603
	speed: 0.0849s/iter; left time: 1137.4835s
	iters: 1100, epoch: 8 | loss: 0.1909166
	speed: 0.0858s/iter; left time: 1141.6574s
Epoch: 8 cost time: 96.15904998779297
Epoch: 8, Steps: 1108 | Train Loss: 0.1674622 Vali Loss: 0.1461146 Test Loss: 0.1689609
Validation loss decreased (0.147670 --> 0.146115).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.2120521
	speed: 0.2449s/iter; left time: 3231.8717s
	iters: 200, epoch: 9 | loss: 0.1559686
	speed: 0.0848s/iter; left time: 1110.8565s
	iters: 300, epoch: 9 | loss: 0.1444303
	speed: 0.0848s/iter; left time: 1101.7424s
	iters: 400, epoch: 9 | loss: 0.1690672
	speed: 0.0848s/iter; left time: 1093.4863s
	iters: 500, epoch: 9 | loss: 0.1730508
	speed: 0.0847s/iter; left time: 1083.3729s
	iters: 600, epoch: 9 | loss: 0.2062588
	speed: 0.0842s/iter; left time: 1069.1390s
	iters: 700, epoch: 9 | loss: 0.1700347
	speed: 0.0843s/iter; left time: 1061.6408s
	iters: 800, epoch: 9 | loss: 0.1501219
	speed: 0.0852s/iter; left time: 1065.2761s
	iters: 900, epoch: 9 | loss: 0.2035730
	speed: 0.0842s/iter; left time: 1043.6818s
	iters: 1000, epoch: 9 | loss: 0.1772225
	speed: 0.0842s/iter; left time: 1035.1296s
	iters: 1100, epoch: 9 | loss: 0.1776186
	speed: 0.0842s/iter; left time: 1027.2730s
Epoch: 9 cost time: 93.90630793571472
Epoch: 9, Steps: 1108 | Train Loss: 0.1665254 Vali Loss: 0.1453250 Test Loss: 0.1685280
Validation loss decreased (0.146115 --> 0.145325).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.1681370
	speed: 0.2427s/iter; left time: 2934.2947s
	iters: 200, epoch: 10 | loss: 0.1677874
	speed: 0.0865s/iter; left time: 1037.6148s
	iters: 300, epoch: 10 | loss: 0.1557822
	speed: 0.0855s/iter; left time: 1016.0167s
	iters: 400, epoch: 10 | loss: 0.1852165
	speed: 0.0867s/iter; left time: 1021.9068s
	iters: 500, epoch: 10 | loss: 0.1618177
	speed: 0.0876s/iter; left time: 1023.5839s
	iters: 600, epoch: 10 | loss: 0.1667573
	speed: 0.0880s/iter; left time: 1019.3515s
	iters: 700, epoch: 10 | loss: 0.1537295
	speed: 0.0869s/iter; left time: 998.7664s
	iters: 800, epoch: 10 | loss: 0.1554730
	speed: 0.0879s/iter; left time: 1001.0667s
	iters: 900, epoch: 10 | loss: 0.1724012
	speed: 0.0862s/iter; left time: 972.6023s
	iters: 1000, epoch: 10 | loss: 0.1536877
	speed: 0.0851s/iter; left time: 952.6415s
	iters: 1100, epoch: 10 | loss: 0.1516522
	speed: 0.0854s/iter; left time: 947.2429s
Epoch: 10 cost time: 95.92301678657532
Epoch: 10, Steps: 1108 | Train Loss: 0.1660869 Vali Loss: 0.1450092 Test Loss: 0.1681996
Validation loss decreased (0.145325 --> 0.145009).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.1487093
	speed: 0.2450s/iter; left time: 2689.9972s
	iters: 200, epoch: 11 | loss: 0.1455569
	speed: 0.0856s/iter; left time: 931.5957s
	iters: 300, epoch: 11 | loss: 0.1863472
	speed: 0.0858s/iter; left time: 924.7514s
	iters: 400, epoch: 11 | loss: 0.1542567
	speed: 0.0855s/iter; left time: 912.7275s
	iters: 500, epoch: 11 | loss: 0.1584378
	speed: 0.0858s/iter; left time: 908.1281s
	iters: 600, epoch: 11 | loss: 0.2239645
	speed: 0.0866s/iter; left time: 908.0434s
	iters: 700, epoch: 11 | loss: 0.1518961
	speed: 0.0887s/iter; left time: 920.6489s
	iters: 800, epoch: 11 | loss: 0.1357580
	speed: 0.0901s/iter; left time: 926.3955s
	iters: 900, epoch: 11 | loss: 0.1875724
	speed: 0.0940s/iter; left time: 957.3784s
	iters: 1000, epoch: 11 | loss: 0.2061940
	speed: 0.0891s/iter; left time: 898.3128s
	iters: 1100, epoch: 11 | loss: 0.1634520
	speed: 0.0865s/iter; left time: 863.1660s
Epoch: 11 cost time: 97.32502222061157
Epoch: 11, Steps: 1108 | Train Loss: 0.1658214 Vali Loss: 0.1449191 Test Loss: 0.1679450
Validation loss decreased (0.145009 --> 0.144919).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.1618286
	speed: 0.2433s/iter; left time: 2402.2254s
	iters: 200, epoch: 12 | loss: 0.1912529
	speed: 0.0859s/iter; left time: 839.9649s
	iters: 300, epoch: 12 | loss: 0.1504750
	speed: 0.0856s/iter; left time: 827.9387s
	iters: 400, epoch: 12 | loss: 0.1879157
	speed: 0.0852s/iter; left time: 815.7102s
	iters: 500, epoch: 12 | loss: 0.1452235
	speed: 0.0852s/iter; left time: 807.5179s
	iters: 600, epoch: 12 | loss: 0.1616545
	speed: 0.0845s/iter; left time: 792.4380s
	iters: 700, epoch: 12 | loss: 0.1514816
	speed: 0.0854s/iter; left time: 791.9946s
	iters: 800, epoch: 12 | loss: 0.1511320
	speed: 0.0853s/iter; left time: 782.4264s
	iters: 900, epoch: 12 | loss: 0.1660171
	speed: 0.0857s/iter; left time: 777.9064s
	iters: 1000, epoch: 12 | loss: 0.1968298
	speed: 0.0892s/iter; left time: 800.4885s
	iters: 1100, epoch: 12 | loss: 0.2220014
	speed: 0.0863s/iter; left time: 765.8258s
Epoch: 12 cost time: 95.21528816223145
Epoch: 12, Steps: 1108 | Train Loss: 0.1657249 Vali Loss: 0.1448264 Test Loss: 0.1679150
Validation loss decreased (0.144919 --> 0.144826).  Saving model ...
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.1439316
	speed: 0.2444s/iter; left time: 2142.5558s
	iters: 200, epoch: 13 | loss: 0.1711712
	speed: 0.0883s/iter; left time: 765.5095s
	iters: 300, epoch: 13 | loss: 0.1572245
	speed: 0.0875s/iter; left time: 749.6853s
	iters: 400, epoch: 13 | loss: 0.1656238
	speed: 0.0872s/iter; left time: 737.7319s
	iters: 500, epoch: 13 | loss: 0.1805263
	speed: 0.0864s/iter; left time: 722.5612s
	iters: 600, epoch: 13 | loss: 0.1901541
	speed: 0.0869s/iter; left time: 718.5909s
	iters: 700, epoch: 13 | loss: 0.1481309
	speed: 0.0873s/iter; left time: 712.7737s
	iters: 800, epoch: 13 | loss: 0.1344003
	speed: 0.0868s/iter; left time: 699.8191s
	iters: 900, epoch: 13 | loss: 0.1521966
	speed: 0.0876s/iter; left time: 697.4161s
	iters: 1000, epoch: 13 | loss: 0.1487907
	speed: 0.0889s/iter; left time: 698.9849s
	iters: 1100, epoch: 13 | loss: 0.1673833
	speed: 0.0864s/iter; left time: 671.2120s
Epoch: 13 cost time: 96.71448373794556
Epoch: 13, Steps: 1108 | Train Loss: 0.1656238 Vali Loss: 0.1448865 Test Loss: 0.1678481
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.1364048
	speed: 0.2293s/iter; left time: 1755.9929s
	iters: 200, epoch: 14 | loss: 0.1529859
	speed: 0.0858s/iter; left time: 648.1838s
	iters: 300, epoch: 14 | loss: 0.1693361
	speed: 0.0850s/iter; left time: 633.5132s
	iters: 400, epoch: 14 | loss: 0.1667479
	speed: 0.0850s/iter; left time: 625.6317s
	iters: 500, epoch: 14 | loss: 0.1872499
	speed: 0.0865s/iter; left time: 627.5984s
	iters: 600, epoch: 14 | loss: 0.1355853
	speed: 0.0867s/iter; left time: 620.2269s
	iters: 700, epoch: 14 | loss: 0.1407560
	speed: 0.0861s/iter; left time: 607.5990s
	iters: 800, epoch: 14 | loss: 0.1611000
	speed: 0.0845s/iter; left time: 587.5715s
	iters: 900, epoch: 14 | loss: 0.1580998
	speed: 0.0859s/iter; left time: 589.1979s
	iters: 1000, epoch: 14 | loss: 0.1420092
	speed: 0.0859s/iter; left time: 580.6456s
	iters: 1100, epoch: 14 | loss: 0.1660592
	speed: 0.0884s/iter; left time: 588.5449s
Epoch: 14 cost time: 95.44236612319946
Epoch: 14, Steps: 1108 | Train Loss: 0.1656166 Vali Loss: 0.1448766 Test Loss: 0.1678412
EarlyStopping counter: 2 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.1902071
	speed: 0.2308s/iter; left time: 1511.7733s
	iters: 200, epoch: 15 | loss: 0.1551570
	speed: 0.0848s/iter; left time: 547.0827s
	iters: 300, epoch: 15 | loss: 0.1402873
	speed: 0.0846s/iter; left time: 536.8271s
	iters: 400, epoch: 15 | loss: 0.2025295
	speed: 0.0849s/iter; left time: 530.8420s
	iters: 500, epoch: 15 | loss: 0.1464204
	speed: 0.0846s/iter; left time: 520.2186s
	iters: 600, epoch: 15 | loss: 0.1567062
	speed: 0.0858s/iter; left time: 519.0330s
	iters: 700, epoch: 15 | loss: 0.1584979
	speed: 0.0850s/iter; left time: 505.9247s
	iters: 800, epoch: 15 | loss: 0.1549773
	speed: 0.0857s/iter; left time: 501.2366s
	iters: 900, epoch: 15 | loss: 0.1499405
	speed: 0.0854s/iter; left time: 490.7806s
	iters: 1000, epoch: 15 | loss: 0.1476950
	speed: 0.0845s/iter; left time: 477.3786s
	iters: 1100, epoch: 15 | loss: 0.1720810
	speed: 0.0851s/iter; left time: 471.9660s
Epoch: 15 cost time: 94.21430587768555
Epoch: 15, Steps: 1108 | Train Loss: 0.1655957 Vali Loss: 0.1448227 Test Loss: 0.1678354
Validation loss decreased (0.144826 --> 0.144823).  Saving model ...
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.1670480
	speed: 0.2506s/iter; left time: 1363.7848s
	iters: 200, epoch: 16 | loss: 0.1753131
	speed: 0.0859s/iter; left time: 458.6555s
	iters: 300, epoch: 16 | loss: 0.1714610
	speed: 0.0854s/iter; left time: 447.6052s
	iters: 400, epoch: 16 | loss: 0.1634127
	speed: 0.0851s/iter; left time: 437.3038s
	iters: 500, epoch: 16 | loss: 0.1884484
	speed: 0.0856s/iter; left time: 431.5659s
	iters: 600, epoch: 16 | loss: 0.1794035
	speed: 0.0862s/iter; left time: 426.0911s
	iters: 700, epoch: 16 | loss: 0.1635700
	speed: 0.0859s/iter; left time: 416.0582s
	iters: 800, epoch: 16 | loss: 0.1810086
	speed: 0.0852s/iter; left time: 404.0031s
	iters: 900, epoch: 16 | loss: 0.1596439
	speed: 0.0862s/iter; left time: 399.8307s
	iters: 1000, epoch: 16 | loss: 0.1407864
	speed: 0.0860s/iter; left time: 390.4588s
	iters: 1100, epoch: 16 | loss: 0.1679097
	speed: 0.0854s/iter; left time: 379.3208s
Epoch: 16 cost time: 95.0860047340393
Epoch: 16, Steps: 1108 | Train Loss: 0.1655647 Vali Loss: 0.1447854 Test Loss: 0.1678353
Validation loss decreased (0.144823 --> 0.144785).  Saving model ...
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 17 | loss: 0.1931736
	speed: 0.2481s/iter; left time: 1075.1482s
	iters: 200, epoch: 17 | loss: 0.1892802
	speed: 0.0875s/iter; left time: 370.5320s
	iters: 300, epoch: 17 | loss: 0.1395392
	speed: 0.0867s/iter; left time: 358.4580s
	iters: 400, epoch: 17 | loss: 0.1927829
	speed: 0.0862s/iter; left time: 347.8390s
	iters: 500, epoch: 17 | loss: 0.1752335
	speed: 0.0861s/iter; left time: 338.6239s
	iters: 600, epoch: 17 | loss: 0.1452975
	speed: 0.0861s/iter; left time: 329.8401s
	iters: 700, epoch: 17 | loss: 0.1557224
	speed: 0.0851s/iter; left time: 317.7470s
	iters: 800, epoch: 17 | loss: 0.1532332
	speed: 0.0869s/iter; left time: 315.7950s
	iters: 900, epoch: 17 | loss: 0.1659090
	speed: 0.0857s/iter; left time: 302.6267s
	iters: 1000, epoch: 17 | loss: 0.1697527
	speed: 0.0849s/iter; left time: 291.5324s
	iters: 1100, epoch: 17 | loss: 0.1577635
	speed: 0.0894s/iter; left time: 297.8932s
Epoch: 17 cost time: 96.06397080421448
Epoch: 17, Steps: 1108 | Train Loss: 0.1655567 Vali Loss: 0.1447849 Test Loss: 0.1678341
Validation loss decreased (0.144785 --> 0.144785).  Saving model ...
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 18 | loss: 0.1582709
	speed: 0.2477s/iter; left time: 798.6945s
	iters: 200, epoch: 18 | loss: 0.1772072
	speed: 0.0890s/iter; left time: 278.1462s
	iters: 300, epoch: 18 | loss: 0.1441298
	speed: 0.0889s/iter; left time: 268.7943s
	iters: 400, epoch: 18 | loss: 0.1605693
	speed: 0.0873s/iter; left time: 255.2373s
	iters: 500, epoch: 18 | loss: 0.1437716
	speed: 0.0855s/iter; left time: 241.4345s
	iters: 600, epoch: 18 | loss: 0.1812519
	speed: 0.0856s/iter; left time: 233.1664s
	iters: 700, epoch: 18 | loss: 0.1544037
	speed: 0.0862s/iter; left time: 226.1932s
	iters: 800, epoch: 18 | loss: 0.1589545
	speed: 0.0854s/iter; left time: 215.5800s
	iters: 900, epoch: 18 | loss: 0.1758853
	speed: 0.0855s/iter; left time: 207.4262s
	iters: 1000, epoch: 18 | loss: 0.1542874
	speed: 0.0848s/iter; left time: 197.0759s
	iters: 1100, epoch: 18 | loss: 0.1659680
	speed: 0.0942s/iter; left time: 209.5028s
Epoch: 18 cost time: 97.0808961391449
Epoch: 18, Steps: 1108 | Train Loss: 0.1655789 Vali Loss: 0.1448961 Test Loss: 0.1678336
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 19 | loss: 0.1703794
	speed: 0.2461s/iter; left time: 521.0807s
	iters: 200, epoch: 19 | loss: 0.1367508
	speed: 0.0862s/iter; left time: 173.9651s
	iters: 300, epoch: 19 | loss: 0.1340148
	speed: 0.0870s/iter; left time: 166.8578s
	iters: 400, epoch: 19 | loss: 0.1451571
	speed: 0.0861s/iter; left time: 156.4990s
	iters: 500, epoch: 19 | loss: 0.1500764
	speed: 0.0880s/iter; left time: 151.1003s
	iters: 600, epoch: 19 | loss: 0.1568038
	speed: 0.0857s/iter; left time: 138.6375s
	iters: 700, epoch: 19 | loss: 0.1586188
	speed: 0.0848s/iter; left time: 128.6852s
	iters: 800, epoch: 19 | loss: 0.1504522
	speed: 0.0850s/iter; left time: 120.3965s
	iters: 900, epoch: 19 | loss: 0.1713720
	speed: 0.0852s/iter; left time: 112.2658s
	iters: 1000, epoch: 19 | loss: 0.1663928
	speed: 0.0859s/iter; left time: 104.5648s
	iters: 1100, epoch: 19 | loss: 0.1981988
	speed: 0.0853s/iter; left time: 95.2990s
Epoch: 19 cost time: 96.30940651893616
Epoch: 19, Steps: 1108 | Train Loss: 0.1655432 Vali Loss: 0.1448086 Test Loss: 0.1678333
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.9073486328125e-08
	iters: 100, epoch: 20 | loss: 0.1502660
	speed: 0.2274s/iter; left time: 229.4951s
	iters: 200, epoch: 20 | loss: 0.1714054
	speed: 0.0858s/iter; left time: 77.9925s
	iters: 300, epoch: 20 | loss: 0.1492306
	speed: 0.0854s/iter; left time: 69.1064s
	iters: 400, epoch: 20 | loss: 0.1794274
	speed: 0.0882s/iter; left time: 62.5174s
	iters: 500, epoch: 20 | loss: 0.1264453
	speed: 0.0886s/iter; left time: 53.9618s
	iters: 600, epoch: 20 | loss: 0.1949888
	speed: 0.0871s/iter; left time: 44.3126s
	iters: 700, epoch: 20 | loss: 0.1457078
	speed: 0.0863s/iter; left time: 35.2856s
	iters: 800, epoch: 20 | loss: 0.1565425
	speed: 0.0863s/iter; left time: 26.6627s
	iters: 900, epoch: 20 | loss: 0.1355849
	speed: 0.0866s/iter; left time: 18.0928s
	iters: 1000, epoch: 20 | loss: 0.1831148
	speed: 0.0853s/iter; left time: 9.2931s
	iters: 1100, epoch: 20 | loss: 0.1652507
	speed: 0.0857s/iter; left time: 0.7710s
Epoch: 20 cost time: 95.74710988998413
Epoch: 20, Steps: 1108 | Train Loss: 0.1655647 Vali Loss: 0.1448591 Test Loss: 0.1678333
EarlyStopping counter: 3 out of 5
Updating learning rate to 9.5367431640625e-09
>>>>>>>testing : Electricity_336_336_NLinear_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed28649<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4925
mse:0.16772283613681793, mae:0.26018112897872925
