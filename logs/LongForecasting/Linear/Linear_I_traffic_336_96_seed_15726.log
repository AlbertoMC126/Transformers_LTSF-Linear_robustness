Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='Linear', model_id='traffic_336_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=15726, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_336_96_Linear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15726>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11849
val 1661
test 3413
	iters: 100, epoch: 1 | loss: 0.4241930
	speed: 0.3164s/iter; left time: 4651.3955s
	iters: 200, epoch: 1 | loss: 0.4643507
	speed: 0.3038s/iter; left time: 4436.4773s
	iters: 300, epoch: 1 | loss: 0.4795531
	speed: 0.3047s/iter; left time: 4418.9268s
	iters: 400, epoch: 1 | loss: 0.5041299
	speed: 0.3037s/iter; left time: 4373.5046s
	iters: 500, epoch: 1 | loss: 0.4974673
	speed: 0.3030s/iter; left time: 4332.9405s
	iters: 600, epoch: 1 | loss: 0.4505645
	speed: 0.3039s/iter; left time: 4315.2307s
	iters: 700, epoch: 1 | loss: 0.5001119
	speed: 0.3033s/iter; left time: 4276.8154s
Epoch: 1 cost time: 226.16653037071228
Epoch: 1, Steps: 740 | Train Loss: 0.4758800 Vali Loss: 0.6305335 Test Loss: 0.7512110
Validation loss decreased (inf --> 0.630533).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.4313422
	speed: 0.6116s/iter; left time: 8539.1948s
	iters: 200, epoch: 2 | loss: 0.4359804
	speed: 0.3031s/iter; left time: 4200.6662s
	iters: 300, epoch: 2 | loss: 0.5044082
	speed: 0.3032s/iter; left time: 4172.0008s
	iters: 400, epoch: 2 | loss: 0.5090507
	speed: 0.3024s/iter; left time: 4131.5524s
	iters: 500, epoch: 2 | loss: 0.4776129
	speed: 0.3028s/iter; left time: 4105.7423s
	iters: 600, epoch: 2 | loss: 0.4457396
	speed: 0.3026s/iter; left time: 4072.6915s
	iters: 700, epoch: 2 | loss: 0.4529909
	speed: 0.3029s/iter; left time: 4046.6212s
Epoch: 2 cost time: 224.04976534843445
Epoch: 2, Steps: 740 | Train Loss: 0.4652516 Vali Loss: 0.6178277 Test Loss: 0.7259112
Validation loss decreased (0.630533 --> 0.617828).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.2857314
	speed: 0.6128s/iter; left time: 8102.2425s
	iters: 200, epoch: 3 | loss: 0.3122626
	speed: 0.3024s/iter; left time: 3968.4442s
	iters: 300, epoch: 3 | loss: 0.3494995
	speed: 0.3030s/iter; left time: 3945.9557s
	iters: 400, epoch: 3 | loss: 0.3081985
	speed: 0.3031s/iter; left time: 3916.4667s
	iters: 500, epoch: 3 | loss: 0.3302423
	speed: 0.3034s/iter; left time: 3890.3789s
	iters: 600, epoch: 3 | loss: 0.3214100
	speed: 0.3046s/iter; left time: 3875.2810s
	iters: 700, epoch: 3 | loss: 0.2922128
	speed: 0.3025s/iter; left time: 3817.7832s
Epoch: 3 cost time: 224.36212015151978
Epoch: 3, Steps: 740 | Train Loss: 0.3225501 Vali Loss: 0.4518794 Test Loss: 0.5437385
Validation loss decreased (0.617828 --> 0.451879).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.2955744
	speed: 0.6090s/iter; left time: 7600.3932s
	iters: 200, epoch: 4 | loss: 0.3131391
	speed: 0.3028s/iter; left time: 3749.3651s
	iters: 300, epoch: 4 | loss: 0.2806143
	speed: 0.3036s/iter; left time: 3728.2450s
	iters: 400, epoch: 4 | loss: 0.2671854
	speed: 0.3038s/iter; left time: 3700.2866s
	iters: 500, epoch: 4 | loss: 0.2891875
	speed: 0.3040s/iter; left time: 3672.8294s
	iters: 600, epoch: 4 | loss: 0.2735526
	speed: 0.3036s/iter; left time: 3637.4865s
	iters: 700, epoch: 4 | loss: 0.2444417
	speed: 0.3023s/iter; left time: 3592.2011s
Epoch: 4 cost time: 224.20930814743042
Epoch: 4, Steps: 740 | Train Loss: 0.2750609 Vali Loss: 0.3950121 Test Loss: 0.4796055
Validation loss decreased (0.451879 --> 0.395012).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.2451162
	speed: 0.6134s/iter; left time: 7201.8022s
	iters: 200, epoch: 5 | loss: 0.2362397
	speed: 0.3029s/iter; left time: 3526.0754s
	iters: 300, epoch: 5 | loss: 0.2589284
	speed: 0.3040s/iter; left time: 3507.9241s
	iters: 400, epoch: 5 | loss: 0.2295655
	speed: 0.3019s/iter; left time: 3454.3825s
	iters: 500, epoch: 5 | loss: 0.2562534
	speed: 0.3039s/iter; left time: 3446.6291s
	iters: 600, epoch: 5 | loss: 0.2731183
	speed: 0.3038s/iter; left time: 3415.0460s
	iters: 700, epoch: 5 | loss: 0.2541733
	speed: 0.3031s/iter; left time: 3377.1945s
Epoch: 5 cost time: 224.427481174469
Epoch: 5, Steps: 740 | Train Loss: 0.2546180 Vali Loss: 0.3703169 Test Loss: 0.4513800
Validation loss decreased (0.395012 --> 0.370317).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.2418095
	speed: 0.6092s/iter; left time: 6701.6829s
	iters: 200, epoch: 6 | loss: 0.2413013
	speed: 0.3020s/iter; left time: 3291.9284s
	iters: 300, epoch: 6 | loss: 0.2839068
	speed: 0.3029s/iter; left time: 3271.4091s
	iters: 400, epoch: 6 | loss: 0.2881049
	speed: 0.3028s/iter; left time: 3240.6583s
	iters: 500, epoch: 6 | loss: 0.2455486
	speed: 0.3035s/iter; left time: 3217.5841s
	iters: 600, epoch: 6 | loss: 0.2705717
	speed: 0.3036s/iter; left time: 3187.9610s
	iters: 700, epoch: 6 | loss: 0.2334034
	speed: 0.3034s/iter; left time: 3155.8421s
Epoch: 6 cost time: 224.15852570533752
Epoch: 6, Steps: 740 | Train Loss: 0.2438176 Vali Loss: 0.3584545 Test Loss: 0.4380844
Validation loss decreased (0.370317 --> 0.358454).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.2587208
	speed: 0.6129s/iter; left time: 6288.7279s
	iters: 200, epoch: 7 | loss: 0.2187111
	speed: 0.3027s/iter; left time: 3075.4467s
	iters: 300, epoch: 7 | loss: 0.2296781
	speed: 0.3034s/iter; left time: 3052.4503s
	iters: 400, epoch: 7 | loss: 0.2323769
	speed: 0.3035s/iter; left time: 3023.2391s
	iters: 500, epoch: 7 | loss: 0.2341036
	speed: 0.3017s/iter; left time: 2974.9292s
	iters: 600, epoch: 7 | loss: 0.2571479
	speed: 0.3023s/iter; left time: 2950.9123s
	iters: 700, epoch: 7 | loss: 0.2492376
	speed: 0.3027s/iter; left time: 2924.2780s
Epoch: 7 cost time: 224.16013979911804
Epoch: 7, Steps: 740 | Train Loss: 0.2380028 Vali Loss: 0.3526671 Test Loss: 0.4308611
Validation loss decreased (0.358454 --> 0.352667).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.2645321
	speed: 0.6141s/iter; left time: 5846.9677s
	iters: 200, epoch: 8 | loss: 0.2018581
	speed: 0.3038s/iter; left time: 2861.8536s
	iters: 300, epoch: 8 | loss: 0.2460136
	speed: 0.3035s/iter; left time: 2829.2442s
	iters: 400, epoch: 8 | loss: 0.2142396
	speed: 0.3032s/iter; left time: 2795.8727s
	iters: 500, epoch: 8 | loss: 0.2644733
	speed: 0.3018s/iter; left time: 2752.3080s
	iters: 600, epoch: 8 | loss: 0.2103162
	speed: 0.3029s/iter; left time: 2732.8914s
	iters: 700, epoch: 8 | loss: 0.2236009
	speed: 0.3032s/iter; left time: 2704.7473s
Epoch: 8 cost time: 224.6180636882782
Epoch: 8, Steps: 740 | Train Loss: 0.2346534 Vali Loss: 0.3500066 Test Loss: 0.4280774
Validation loss decreased (0.352667 --> 0.350007).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.2640787
	speed: 0.6109s/iter; left time: 5364.6796s
	iters: 200, epoch: 9 | loss: 0.2488431
	speed: 0.3034s/iter; left time: 2634.0620s
	iters: 300, epoch: 9 | loss: 0.2784544
	speed: 0.3024s/iter; left time: 2594.5419s
	iters: 400, epoch: 9 | loss: 0.2126589
	speed: 0.3028s/iter; left time: 2567.8643s
	iters: 500, epoch: 9 | loss: 0.2176488
	speed: 0.3038s/iter; left time: 2546.1654s
	iters: 600, epoch: 9 | loss: 0.2036498
	speed: 0.3020s/iter; left time: 2501.1959s
	iters: 700, epoch: 9 | loss: 0.2691480
	speed: 0.3019s/iter; left time: 2469.8194s
Epoch: 9 cost time: 224.02595829963684
Epoch: 9, Steps: 740 | Train Loss: 0.2329147 Vali Loss: 0.3487053 Test Loss: 0.4264859
Validation loss decreased (0.350007 --> 0.348705).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.2412179
	speed: 0.6156s/iter; left time: 4950.1432s
	iters: 200, epoch: 10 | loss: 0.2469943
	speed: 0.3058s/iter; left time: 2428.6948s
	iters: 300, epoch: 10 | loss: 0.1971335
	speed: 0.3042s/iter; left time: 2385.4242s
	iters: 400, epoch: 10 | loss: 0.2251844
	speed: 0.3045s/iter; left time: 2357.0438s
	iters: 500, epoch: 10 | loss: 0.2444641
	speed: 0.3037s/iter; left time: 2320.7851s
	iters: 600, epoch: 10 | loss: 0.2204039
	speed: 0.3034s/iter; left time: 2288.1380s
	iters: 700, epoch: 10 | loss: 0.2476544
	speed: 0.3038s/iter; left time: 2260.6123s
Epoch: 10 cost time: 225.19262433052063
Epoch: 10, Steps: 740 | Train Loss: 0.2319154 Vali Loss: 0.3483536 Test Loss: 0.4259033
Validation loss decreased (0.348705 --> 0.348354).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.2186986
	speed: 0.6116s/iter; left time: 4465.6035s
	iters: 200, epoch: 11 | loss: 0.2395025
	speed: 0.3042s/iter; left time: 2190.7052s
	iters: 300, epoch: 11 | loss: 0.2300008
	speed: 0.3029s/iter; left time: 2150.6939s
	iters: 400, epoch: 11 | loss: 0.2112918
	speed: 0.3048s/iter; left time: 2134.0955s
	iters: 500, epoch: 11 | loss: 0.2135482
	speed: 0.3047s/iter; left time: 2102.7707s
	iters: 600, epoch: 11 | loss: 0.1955541
	speed: 0.3054s/iter; left time: 2076.7686s
	iters: 700, epoch: 11 | loss: 0.2072456
	speed: 0.3038s/iter; left time: 2035.5240s
Epoch: 11 cost time: 224.97324562072754
Epoch: 11, Steps: 740 | Train Loss: 0.2314325 Vali Loss: 0.3481231 Test Loss: 0.4256771
Validation loss decreased (0.348354 --> 0.348123).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.1966021
	speed: 0.6127s/iter; left time: 4020.1991s
	iters: 200, epoch: 12 | loss: 0.2506512
	speed: 0.3029s/iter; left time: 1957.1742s
	iters: 300, epoch: 12 | loss: 0.2864257
	speed: 0.3018s/iter; left time: 1919.9798s
	iters: 400, epoch: 12 | loss: 0.2479296
	speed: 0.3025s/iter; left time: 1894.2074s
	iters: 500, epoch: 12 | loss: 0.2337772
	speed: 0.3035s/iter; left time: 1870.0032s
	iters: 600, epoch: 12 | loss: 0.2249640
	speed: 0.3043s/iter; left time: 1844.5967s
	iters: 700, epoch: 12 | loss: 0.2212500
	speed: 0.3042s/iter; left time: 1813.2188s
Epoch: 12 cost time: 224.33348107337952
Epoch: 12, Steps: 740 | Train Loss: 0.2311604 Vali Loss: 0.3477640 Test Loss: 0.4255019
Validation loss decreased (0.348123 --> 0.347764).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.2197958
	speed: 0.6132s/iter; left time: 3569.2147s
	iters: 200, epoch: 13 | loss: 0.2606861
	speed: 0.3035s/iter; left time: 1736.1659s
	iters: 300, epoch: 13 | loss: 0.2304273
	speed: 0.3033s/iter; left time: 1704.7417s
	iters: 400, epoch: 13 | loss: 0.2134801
	speed: 0.3044s/iter; left time: 1680.4118s
	iters: 500, epoch: 13 | loss: 0.2312930
	speed: 0.3033s/iter; left time: 1644.0433s
	iters: 600, epoch: 13 | loss: 0.1941978
	speed: 0.3061s/iter; left time: 1628.6119s
	iters: 700, epoch: 13 | loss: 0.2095513
	speed: 0.3046s/iter; left time: 1590.1161s
Epoch: 13 cost time: 225.1215307712555
Epoch: 13, Steps: 740 | Train Loss: 0.2310206 Vali Loss: 0.3477637 Test Loss: 0.4254664
Validation loss decreased (0.347764 --> 0.347764).  Saving model ...
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 14 | loss: 0.2144173
	speed: 0.6108s/iter; left time: 3103.7171s
	iters: 200, epoch: 14 | loss: 0.2229720
	speed: 0.3026s/iter; left time: 1507.4683s
	iters: 300, epoch: 14 | loss: 0.2679562
	speed: 0.3028s/iter; left time: 1478.0358s
	iters: 400, epoch: 14 | loss: 0.2788670
	speed: 0.3025s/iter; left time: 1446.3801s
	iters: 500, epoch: 14 | loss: 0.2371852
	speed: 0.3040s/iter; left time: 1422.9134s
	iters: 600, epoch: 14 | loss: 0.2603874
	speed: 0.3032s/iter; left time: 1388.8113s
	iters: 700, epoch: 14 | loss: 0.2343200
	speed: 0.3026s/iter; left time: 1355.8702s
Epoch: 14 cost time: 224.22359371185303
Epoch: 14, Steps: 740 | Train Loss: 0.2309350 Vali Loss: 0.3474049 Test Loss: 0.4254600
Validation loss decreased (0.347764 --> 0.347405).  Saving model ...
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 15 | loss: 0.2300752
	speed: 0.6114s/iter; left time: 2653.8913s
	iters: 200, epoch: 15 | loss: 0.2266312
	speed: 0.3031s/iter; left time: 1285.6565s
	iters: 300, epoch: 15 | loss: 0.2499540
	speed: 0.3051s/iter; left time: 1263.3649s
	iters: 400, epoch: 15 | loss: 0.2483628
	speed: 0.3045s/iter; left time: 1230.4883s
	iters: 500, epoch: 15 | loss: 0.2154245
	speed: 0.3028s/iter; left time: 1193.3092s
	iters: 600, epoch: 15 | loss: 0.2156215
	speed: 0.3037s/iter; left time: 1166.3500s
	iters: 700, epoch: 15 | loss: 0.2144875
	speed: 0.3053s/iter; left time: 1142.0739s
Epoch: 15 cost time: 224.97686052322388
Epoch: 15, Steps: 740 | Train Loss: 0.2308774 Vali Loss: 0.3475966 Test Loss: 0.4254518
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 16 | loss: 0.2135796
	speed: 0.6124s/iter; left time: 2205.2784s
	iters: 200, epoch: 16 | loss: 0.2354236
	speed: 0.3040s/iter; left time: 1064.2787s
	iters: 300, epoch: 16 | loss: 0.2436193
	speed: 0.3024s/iter; left time: 1028.5438s
	iters: 400, epoch: 16 | loss: 0.2452423
	speed: 0.3036s/iter; left time: 1002.2999s
	iters: 500, epoch: 16 | loss: 0.2129696
	speed: 0.3046s/iter; left time: 974.8724s
	iters: 600, epoch: 16 | loss: 0.2374542
	speed: 0.3043s/iter; left time: 943.5852s
	iters: 700, epoch: 16 | loss: 0.2393989
	speed: 0.3027s/iter; left time: 908.4063s
Epoch: 16 cost time: 224.74164009094238
Epoch: 16, Steps: 740 | Train Loss: 0.2308087 Vali Loss: 0.3477242 Test Loss: 0.4254500
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 17 | loss: 0.2438709
	speed: 0.6080s/iter; left time: 1739.4350s
	iters: 200, epoch: 17 | loss: 0.2330180
	speed: 0.3026s/iter; left time: 835.4312s
	iters: 300, epoch: 17 | loss: 0.2105867
	speed: 0.3039s/iter; left time: 808.5939s
	iters: 400, epoch: 17 | loss: 0.2083807
	speed: 0.3037s/iter; left time: 777.7344s
	iters: 500, epoch: 17 | loss: 0.2094945
	speed: 0.3045s/iter; left time: 749.4357s
	iters: 600, epoch: 17 | loss: 0.1885164
	speed: 0.3040s/iter; left time: 717.8426s
	iters: 700, epoch: 17 | loss: 0.2101523
	speed: 0.3045s/iter; left time: 688.5083s
Epoch: 17 cost time: 224.700847864151
Epoch: 17, Steps: 740 | Train Loss: 0.2308125 Vali Loss: 0.3473029 Test Loss: 0.4254498
Validation loss decreased (0.347405 --> 0.347303).  Saving model ...
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 18 | loss: 0.2772436
	speed: 0.6149s/iter; left time: 1304.1373s
	iters: 200, epoch: 18 | loss: 0.2148980
	speed: 0.3052s/iter; left time: 616.8152s
	iters: 300, epoch: 18 | loss: 0.2238891
	speed: 0.3058s/iter; left time: 587.4775s
	iters: 400, epoch: 18 | loss: 0.2109028
	speed: 0.3050s/iter; left time: 555.3257s
	iters: 500, epoch: 18 | loss: 0.2044431
	speed: 0.3051s/iter; left time: 524.9989s
	iters: 600, epoch: 18 | loss: 0.2189400
	speed: 0.3045s/iter; left time: 493.6564s
	iters: 700, epoch: 18 | loss: 0.2336230
	speed: 0.3050s/iter; left time: 463.9720s
Epoch: 18 cost time: 225.70689272880554
Epoch: 18, Steps: 740 | Train Loss: 0.2307948 Vali Loss: 0.3472881 Test Loss: 0.4254498
Validation loss decreased (0.347303 --> 0.347288).  Saving model ...
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 19 | loss: 0.2406604
	speed: 0.6145s/iter; left time: 848.6546s
	iters: 200, epoch: 19 | loss: 0.2068319
	speed: 0.3050s/iter; left time: 390.6730s
	iters: 300, epoch: 19 | loss: 0.2589129
	speed: 0.3040s/iter; left time: 359.0671s
	iters: 400, epoch: 19 | loss: 0.2237250
	speed: 0.3036s/iter; left time: 328.2091s
	iters: 500, epoch: 19 | loss: 0.2244670
	speed: 0.3039s/iter; left time: 298.1345s
	iters: 600, epoch: 19 | loss: 0.2184795
	speed: 0.3038s/iter; left time: 267.6377s
	iters: 700, epoch: 19 | loss: 0.2432877
	speed: 0.3040s/iter; left time: 237.4254s
Epoch: 19 cost time: 225.08626008033752
Epoch: 19, Steps: 740 | Train Loss: 0.2308276 Vali Loss: 0.3477882 Test Loss: 0.4254498
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 20 | loss: 0.2254172
	speed: 0.6104s/iter; left time: 391.2523s
	iters: 200, epoch: 20 | loss: 0.2357826
	speed: 0.3051s/iter; left time: 165.0828s
	iters: 300, epoch: 20 | loss: 0.1952844
	speed: 0.3064s/iter; left time: 135.1120s
	iters: 400, epoch: 20 | loss: 0.2292717
	speed: 0.3058s/iter; left time: 104.2864s
	iters: 500, epoch: 20 | loss: 0.2098062
	speed: 0.3058s/iter; left time: 73.7032s
	iters: 600, epoch: 20 | loss: 0.2301434
	speed: 0.3037s/iter; left time: 42.8178s
	iters: 700, epoch: 20 | loss: 0.2291327
	speed: 0.3035s/iter; left time: 12.4454s
Epoch: 20 cost time: 225.6968822479248
Epoch: 20, Steps: 740 | Train Loss: 0.2308195 Vali Loss: 0.3477115 Test Loss: 0.4254497
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.9073486328125e-08
>>>>>>>testing : traffic_336_96_Linear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15726<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3413
mse:0.42570438981056213, mae:0.2979919910430908
