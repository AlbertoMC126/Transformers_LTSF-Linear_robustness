Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='NLinear', model_id='ETTm2_96_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=25565, seq_len=96, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTm2_96_96_NLinear_ETTm2_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed25565>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34369
data_set:  <data_provider.data_loader.Dataset_ETT_minute object at 0x000002677B7D0D68>
val 11425
data_set:  <data_provider.data_loader.Dataset_ETT_minute object at 0x0000026748DD7DD8>
test 11425
data_set:  <data_provider.data_loader.Dataset_ETT_minute object at 0x000002677B7D0128>
Total number of trainable parameters: 65184
Total number of parameters: 65184
	iters: 100, epoch: 1 | loss: 0.3257295
	speed: 0.0044s/iter; left time: 93.5492s
	iters: 200, epoch: 1 | loss: 0.2011651
	speed: 0.0041s/iter; left time: 86.4920s
	iters: 300, epoch: 1 | loss: 0.1498386
	speed: 0.0036s/iter; left time: 76.0846s
	iters: 400, epoch: 1 | loss: 0.2879626
	speed: 0.0038s/iter; left time: 80.0516s
	iters: 500, epoch: 1 | loss: 0.2507198
	speed: 0.0037s/iter; left time: 76.6115s
	iters: 600, epoch: 1 | loss: 0.5279866
	speed: 0.0040s/iter; left time: 82.6098s
	iters: 700, epoch: 1 | loss: 0.2492226
	speed: 0.0041s/iter; left time: 85.6116s
	iters: 800, epoch: 1 | loss: 0.1871355
	speed: 0.0037s/iter; left time: 76.3630s
	iters: 900, epoch: 1 | loss: 0.2256338
	speed: 0.0037s/iter; left time: 77.1701s
	iters: 1000, epoch: 1 | loss: 0.1711014
	speed: 0.0039s/iter; left time: 79.9823s
Epoch: 1 cost time: 4.218835115432739
Epoch: 1, Steps: 1074 | Train Loss: 0.2730864 Vali Loss: 0.1387299 Test Loss: 0.1996830
Validation loss decreased (inf --> 0.138730).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.2369299
	speed: 0.0174s/iter; left time: 352.6557s
	iters: 200, epoch: 2 | loss: 0.2830579
	speed: 0.0041s/iter; left time: 83.1217s
	iters: 300, epoch: 2 | loss: 0.2617614
	speed: 0.0038s/iter; left time: 76.3748s
	iters: 400, epoch: 2 | loss: 0.1105309
	speed: 0.0038s/iter; left time: 76.0487s
	iters: 500, epoch: 2 | loss: 0.3043932
	speed: 0.0043s/iter; left time: 84.9786s
	iters: 600, epoch: 2 | loss: 0.1787358
	speed: 0.0038s/iter; left time: 76.1275s
	iters: 700, epoch: 2 | loss: 0.1310990
	speed: 0.0034s/iter; left time: 67.6705s
	iters: 800, epoch: 2 | loss: 0.2227904
	speed: 0.0041s/iter; left time: 79.6992s
	iters: 900, epoch: 2 | loss: 0.2412916
	speed: 0.0030s/iter; left time: 58.4571s
	iters: 1000, epoch: 2 | loss: 0.2053095
	speed: 0.0038s/iter; left time: 73.7689s
Epoch: 2 cost time: 4.140573978424072
Epoch: 2, Steps: 1074 | Train Loss: 0.2658300 Vali Loss: 0.1368305 Test Loss: 0.1943979
Validation loss decreased (0.138730 --> 0.136830).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.1438253
	speed: 0.0208s/iter; left time: 399.2760s
	iters: 200, epoch: 3 | loss: 0.2904038
	speed: 0.0038s/iter; left time: 72.6685s
	iters: 300, epoch: 3 | loss: 0.4097455
	speed: 0.0044s/iter; left time: 84.2504s
	iters: 400, epoch: 3 | loss: 0.2170618
	speed: 0.0028s/iter; left time: 53.2626s
	iters: 500, epoch: 3 | loss: 0.3024264
	speed: 0.0030s/iter; left time: 55.9003s
	iters: 600, epoch: 3 | loss: 0.2443151
	speed: 0.0036s/iter; left time: 67.2621s
	iters: 700, epoch: 3 | loss: 0.1608242
	speed: 0.0044s/iter; left time: 81.5508s
	iters: 800, epoch: 3 | loss: 0.2765420
	speed: 0.0037s/iter; left time: 69.4518s
	iters: 900, epoch: 3 | loss: 0.3552802
	speed: 0.0033s/iter; left time: 60.8250s
	iters: 1000, epoch: 3 | loss: 0.3085770
	speed: 0.0032s/iter; left time: 58.0269s
Epoch: 3 cost time: 3.772826671600342
Epoch: 3, Steps: 1074 | Train Loss: 0.2462663 Vali Loss: 0.1308246 Test Loss: 0.1900333
Validation loss decreased (0.136830 --> 0.130825).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.2348538
	speed: 0.0187s/iter; left time: 339.6399s
	iters: 200, epoch: 4 | loss: 0.2563054
	speed: 0.0033s/iter; left time: 59.9852s
	iters: 300, epoch: 4 | loss: 0.4410791
	speed: 0.0033s/iter; left time: 59.8054s
	iters: 400, epoch: 4 | loss: 0.1485471
	speed: 0.0038s/iter; left time: 67.8744s
	iters: 500, epoch: 4 | loss: 0.3188528
	speed: 0.0042s/iter; left time: 75.0166s
	iters: 600, epoch: 4 | loss: 0.2553015
	speed: 0.0041s/iter; left time: 72.6383s
	iters: 700, epoch: 4 | loss: 0.2022409
	speed: 0.0037s/iter; left time: 64.9458s
	iters: 800, epoch: 4 | loss: 0.1132301
	speed: 0.0034s/iter; left time: 59.9972s
	iters: 900, epoch: 4 | loss: 0.2610183
	speed: 0.0036s/iter; left time: 62.5080s
	iters: 1000, epoch: 4 | loss: 0.2499004
	speed: 0.0025s/iter; left time: 43.7029s
Epoch: 4 cost time: 3.7813665866851807
Epoch: 4, Steps: 1074 | Train Loss: 0.2374831 Vali Loss: 0.1241464 Test Loss: 0.1812773
Validation loss decreased (0.130825 --> 0.124146).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.1482434
	speed: 0.0170s/iter; left time: 290.3209s
	iters: 200, epoch: 5 | loss: 0.2954431
	speed: 0.0041s/iter; left time: 69.0236s
	iters: 300, epoch: 5 | loss: 0.3277295
	speed: 0.0030s/iter; left time: 50.1277s
	iters: 400, epoch: 5 | loss: 0.4361759
	speed: 0.0042s/iter; left time: 70.8363s
	iters: 500, epoch: 5 | loss: 0.2978579
	speed: 0.0037s/iter; left time: 62.5226s
	iters: 600, epoch: 5 | loss: 0.2005856
	speed: 0.0035s/iter; left time: 57.5029s
	iters: 700, epoch: 5 | loss: 0.1843319
	speed: 0.0034s/iter; left time: 56.2072s
	iters: 800, epoch: 5 | loss: 0.4113466
	speed: 0.0028s/iter; left time: 46.5759s
	iters: 900, epoch: 5 | loss: 0.2031404
	speed: 0.0040s/iter; left time: 65.6702s
	iters: 1000, epoch: 5 | loss: 0.2780528
	speed: 0.0037s/iter; left time: 60.6726s
Epoch: 5 cost time: 3.900973081588745
Epoch: 5, Steps: 1074 | Train Loss: 0.2344510 Vali Loss: 0.1312334 Test Loss: 0.1832402
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.2314778
	speed: 0.0169s/iter; left time: 270.1718s
	iters: 200, epoch: 6 | loss: 0.1495374
	speed: 0.0036s/iter; left time: 57.2481s
	iters: 300, epoch: 6 | loss: 0.3592859
	speed: 0.0034s/iter; left time: 54.3246s
	iters: 400, epoch: 6 | loss: 0.2249960
	speed: 0.0035s/iter; left time: 54.5282s
	iters: 500, epoch: 6 | loss: 0.1774169
	speed: 0.0035s/iter; left time: 54.3323s
	iters: 600, epoch: 6 | loss: 0.2217574
	speed: 0.0030s/iter; left time: 47.1282s
	iters: 700, epoch: 6 | loss: 0.3420939
	speed: 0.0034s/iter; left time: 53.1488s
	iters: 800, epoch: 6 | loss: 0.1638636
	speed: 0.0041s/iter; left time: 62.3808s
	iters: 900, epoch: 6 | loss: 0.2055638
	speed: 0.0039s/iter; left time: 59.2103s
	iters: 1000, epoch: 6 | loss: 0.1411112
	speed: 0.0041s/iter; left time: 61.4270s
Epoch: 6 cost time: 3.8905274868011475
Epoch: 6, Steps: 1074 | Train Loss: 0.2314412 Vali Loss: 0.1257316 Test Loss: 0.1772412
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.1562324
	speed: 0.0159s/iter; left time: 238.0285s
	iters: 200, epoch: 7 | loss: 0.1809830
	speed: 0.0033s/iter; left time: 48.7169s
	iters: 300, epoch: 7 | loss: 0.2215515
	speed: 0.0031s/iter; left time: 46.0434s
	iters: 400, epoch: 7 | loss: 0.1235840
	speed: 0.0039s/iter; left time: 56.3641s
	iters: 500, epoch: 7 | loss: 0.1875980
	speed: 0.0035s/iter; left time: 50.7211s
	iters: 600, epoch: 7 | loss: 0.1430600
	speed: 0.0038s/iter; left time: 55.2043s
	iters: 700, epoch: 7 | loss: 0.2784242
	speed: 0.0046s/iter; left time: 66.1755s
	iters: 800, epoch: 7 | loss: 0.2718561
	speed: 0.0030s/iter; left time: 42.3440s
	iters: 900, epoch: 7 | loss: 0.2239270
	speed: 0.0041s/iter; left time: 57.6438s
	iters: 1000, epoch: 7 | loss: 0.3283137
	speed: 0.0041s/iter; left time: 57.8496s
Epoch: 7 cost time: 3.9687230587005615
Epoch: 7, Steps: 1074 | Train Loss: 0.2303944 Vali Loss: 0.1246396 Test Loss: 0.1768097
EarlyStopping counter: 3 out of 5
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.1517389
	speed: 0.0165s/iter; left time: 228.4779s
	iters: 200, epoch: 8 | loss: 0.1415980
	speed: 0.0036s/iter; left time: 49.5069s
	iters: 300, epoch: 8 | loss: 0.1520194
	speed: 0.0035s/iter; left time: 47.4808s
	iters: 400, epoch: 8 | loss: 0.1660709
	speed: 0.0029s/iter; left time: 38.6993s
	iters: 500, epoch: 8 | loss: 0.1788848
	speed: 0.0037s/iter; left time: 49.4370s
	iters: 600, epoch: 8 | loss: 0.1753570
	speed: 0.0034s/iter; left time: 46.0352s
	iters: 700, epoch: 8 | loss: 0.6222400
	speed: 0.0030s/iter; left time: 39.7958s
	iters: 800, epoch: 8 | loss: 0.2919218
	speed: 0.0036s/iter; left time: 48.0163s
	iters: 900, epoch: 8 | loss: 0.1256469
	speed: 0.0033s/iter; left time: 43.6736s
	iters: 1000, epoch: 8 | loss: 0.2165823
	speed: 0.0039s/iter; left time: 50.6266s
Epoch: 8 cost time: 3.7221479415893555
Epoch: 8, Steps: 1074 | Train Loss: 0.2299933 Vali Loss: 0.1268511 Test Loss: 0.1783110
EarlyStopping counter: 4 out of 5
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.2843349
	speed: 0.0181s/iter; left time: 230.8724s
	iters: 200, epoch: 9 | loss: 0.1774433
	speed: 0.0034s/iter; left time: 42.5334s
	iters: 300, epoch: 9 | loss: 0.2283907
	speed: 0.0030s/iter; left time: 37.4205s
	iters: 400, epoch: 9 | loss: 0.1927461
	speed: 0.0042s/iter; left time: 52.6458s
	iters: 500, epoch: 9 | loss: 0.2175977
	speed: 0.0038s/iter; left time: 46.4937s
	iters: 600, epoch: 9 | loss: 0.1386402
	speed: 0.0042s/iter; left time: 51.8143s
	iters: 700, epoch: 9 | loss: 0.1981588
	speed: 0.0039s/iter; left time: 47.6015s
	iters: 800, epoch: 9 | loss: 0.1663447
	speed: 0.0039s/iter; left time: 47.2475s
	iters: 900, epoch: 9 | loss: 0.1220177
	speed: 0.0038s/iter; left time: 44.9797s
	iters: 1000, epoch: 9 | loss: 0.2414725
	speed: 0.0031s/iter; left time: 36.2996s
Epoch: 9 cost time: 4.033769130706787
Epoch: 9, Steps: 1074 | Train Loss: 0.2297182 Vali Loss: 0.1253133 Test Loss: 0.1770708
EarlyStopping counter: 5 out of 5
Early stopping
Total training time: 45.5939 seconds
>>>>>>>testing : ETTm2_96_96_NLinear_ETTm2_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed25565<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
data_set:  <data_provider.data_loader.Dataset_ETT_minute object at 0x000002673E251080>
mse:0.18155954778194427, mae:0.2592754065990448
