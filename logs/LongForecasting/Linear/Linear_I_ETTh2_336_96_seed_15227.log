Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTh2', data_path='ETTh2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.05, loss='mse', lradj='type1', model='Linear', model_id='ETTh2_336_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=15227, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTh2_336_96_Linear_ETTh2_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15227>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 1.0754626
	speed: 0.0032s/iter; left time: 32.9217s
	iters: 200, epoch: 1 | loss: 3.3663607
	speed: 0.0030s/iter; left time: 30.5855s
	iters: 300, epoch: 1 | loss: 8.6098948
	speed: 0.0029s/iter; left time: 29.1162s
	iters: 400, epoch: 1 | loss: 10.8450155
	speed: 0.0031s/iter; left time: 30.4704s
	iters: 500, epoch: 1 | loss: 7.5141659
	speed: 0.0034s/iter; left time: 33.3875s
Epoch: 1 cost time: 1.617354154586792
Epoch: 1, Steps: 513 | Train Loss: 6.1797278 Vali Loss: 3.1617374 Test Loss: 6.7181849
Validation loss decreased (inf --> 3.161737).  Saving model ...
Updating learning rate to 0.05
	iters: 100, epoch: 2 | loss: 7.0455418
	speed: 0.0077s/iter; left time: 74.1210s
	iters: 200, epoch: 2 | loss: 2.7852998
	speed: 0.0030s/iter; left time: 28.4530s
	iters: 300, epoch: 2 | loss: 4.0192680
	speed: 0.0035s/iter; left time: 33.0070s
	iters: 400, epoch: 2 | loss: 4.7429781
	speed: 0.0032s/iter; left time: 30.0070s
	iters: 500, epoch: 2 | loss: 1.7143395
	speed: 0.0030s/iter; left time: 27.7440s
Epoch: 2 cost time: 1.662351369857788
Epoch: 2, Steps: 513 | Train Loss: 7.1824704 Vali Loss: 5.9809718 Test Loss: 12.4949360
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.025
	iters: 100, epoch: 3 | loss: 0.6382796
	speed: 0.0062s/iter; left time: 56.5639s
	iters: 200, epoch: 3 | loss: 0.5278225
	speed: 0.0029s/iter; left time: 26.2013s
	iters: 300, epoch: 3 | loss: 0.7933764
	speed: 0.0032s/iter; left time: 28.4352s
	iters: 400, epoch: 3 | loss: 0.5856526
	speed: 0.0038s/iter; left time: 33.3080s
	iters: 500, epoch: 3 | loss: 0.8591847
	speed: 0.0033s/iter; left time: 28.4005s
Epoch: 3 cost time: 1.6324353218078613
Epoch: 3, Steps: 513 | Train Loss: 1.0526186 Vali Loss: 0.9153735 Test Loss: 1.9138829
Validation loss decreased (3.161737 --> 0.915374).  Saving model ...
Updating learning rate to 0.0125
	iters: 100, epoch: 4 | loss: 0.3359745
	speed: 0.0065s/iter; left time: 56.4105s
	iters: 200, epoch: 4 | loss: 1.1815004
	speed: 0.0030s/iter; left time: 25.9066s
	iters: 300, epoch: 4 | loss: 0.8276318
	speed: 0.0027s/iter; left time: 23.0167s
	iters: 400, epoch: 4 | loss: 0.6622682
	speed: 0.0033s/iter; left time: 27.7957s
	iters: 500, epoch: 4 | loss: 1.1565685
	speed: 0.0037s/iter; left time: 30.5861s
Epoch: 4 cost time: 1.6572942733764648
Epoch: 4, Steps: 513 | Train Loss: 0.5325474 Vali Loss: 0.3694977 Test Loss: 0.5614874
Validation loss decreased (0.915374 --> 0.369498).  Saving model ...
Updating learning rate to 0.00625
	iters: 100, epoch: 5 | loss: 0.4799007
	speed: 0.0067s/iter; left time: 54.5871s
	iters: 200, epoch: 5 | loss: 0.5534007
	speed: 0.0034s/iter; left time: 27.0705s
	iters: 300, epoch: 5 | loss: 0.4943089
	speed: 0.0034s/iter; left time: 26.8263s
	iters: 400, epoch: 5 | loss: 0.5658320
	speed: 0.0035s/iter; left time: 27.1752s
	iters: 500, epoch: 5 | loss: 0.3945629
	speed: 0.0033s/iter; left time: 25.2877s
Epoch: 5 cost time: 1.7372097969055176
Epoch: 5, Steps: 513 | Train Loss: 0.4315863 Vali Loss: 0.4644969 Test Loss: 0.9774598
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.003125
	iters: 100, epoch: 6 | loss: 0.1882357
	speed: 0.0056s/iter; left time: 42.8596s
	iters: 200, epoch: 6 | loss: 0.2487833
	speed: 0.0024s/iter; left time: 18.2824s
	iters: 300, epoch: 6 | loss: 0.8479387
	speed: 0.0028s/iter; left time: 21.0046s
	iters: 400, epoch: 6 | loss: 0.2330201
	speed: 0.0031s/iter; left time: 22.9247s
	iters: 500, epoch: 6 | loss: 0.2552750
	speed: 0.0029s/iter; left time: 20.7965s
Epoch: 6 cost time: 1.4491066932678223
Epoch: 6, Steps: 513 | Train Loss: 0.3991774 Vali Loss: 0.3730122 Test Loss: 0.6152067
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.0015625
	iters: 100, epoch: 7 | loss: 0.1712734
	speed: 0.0075s/iter; left time: 53.0663s
	iters: 200, epoch: 7 | loss: 0.2044256
	speed: 0.0027s/iter; left time: 19.1370s
	iters: 300, epoch: 7 | loss: 0.2796158
	speed: 0.0032s/iter; left time: 22.1636s
	iters: 400, epoch: 7 | loss: 0.2426047
	speed: 0.0033s/iter; left time: 22.6668s
	iters: 500, epoch: 7 | loss: 0.4496149
	speed: 0.0027s/iter; left time: 18.1110s
Epoch: 7 cost time: 1.5874321460723877
Epoch: 7, Steps: 513 | Train Loss: 0.3810933 Vali Loss: 0.3049885 Test Loss: 0.5322134
Validation loss decreased (0.369498 --> 0.304988).  Saving model ...
Updating learning rate to 0.00078125
	iters: 100, epoch: 8 | loss: 0.2607871
	speed: 0.0065s/iter; left time: 42.5938s
	iters: 200, epoch: 8 | loss: 0.2507568
	speed: 0.0030s/iter; left time: 19.4748s
	iters: 300, epoch: 8 | loss: 0.1919281
	speed: 0.0026s/iter; left time: 16.8804s
	iters: 400, epoch: 8 | loss: 0.5186192
	speed: 0.0029s/iter; left time: 18.2458s
	iters: 500, epoch: 8 | loss: 0.2669238
	speed: 0.0035s/iter; left time: 21.4277s
Epoch: 8 cost time: 1.4955523014068604
Epoch: 8, Steps: 513 | Train Loss: 0.3701336 Vali Loss: 0.3076219 Test Loss: 0.4879568
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.000390625
	iters: 100, epoch: 9 | loss: 0.2533514
	speed: 0.0060s/iter; left time: 36.0392s
	iters: 200, epoch: 9 | loss: 0.3181444
	speed: 0.0028s/iter; left time: 16.5761s
	iters: 300, epoch: 9 | loss: 0.2585338
	speed: 0.0033s/iter; left time: 19.1064s
	iters: 400, epoch: 9 | loss: 0.4082009
	speed: 0.0033s/iter; left time: 19.1133s
	iters: 500, epoch: 9 | loss: 0.4861134
	speed: 0.0034s/iter; left time: 19.5061s
Epoch: 9 cost time: 1.580291509628296
Epoch: 9, Steps: 513 | Train Loss: 0.3634448 Vali Loss: 0.2981567 Test Loss: 0.4761884
Validation loss decreased (0.304988 --> 0.298157).  Saving model ...
Updating learning rate to 0.0001953125
	iters: 100, epoch: 10 | loss: 0.2744129
	speed: 0.0064s/iter; left time: 35.4816s
	iters: 200, epoch: 10 | loss: 0.3417113
	speed: 0.0031s/iter; left time: 16.7244s
	iters: 300, epoch: 10 | loss: 0.4230609
	speed: 0.0031s/iter; left time: 16.5130s
	iters: 400, epoch: 10 | loss: 0.2090107
	speed: 0.0031s/iter; left time: 16.4136s
	iters: 500, epoch: 10 | loss: 0.4224663
	speed: 0.0032s/iter; left time: 16.5234s
Epoch: 10 cost time: 1.590423583984375
Epoch: 10, Steps: 513 | Train Loss: 0.3594178 Vali Loss: 0.3015384 Test Loss: 0.4815460
EarlyStopping counter: 1 out of 5
Updating learning rate to 9.765625e-05
	iters: 100, epoch: 11 | loss: 0.2596472
	speed: 0.0074s/iter; left time: 36.9821s
	iters: 200, epoch: 11 | loss: 0.4359093
	speed: 0.0030s/iter; left time: 14.9561s
	iters: 300, epoch: 11 | loss: 0.2080586
	speed: 0.0032s/iter; left time: 15.2733s
	iters: 400, epoch: 11 | loss: 0.2080073
	speed: 0.0026s/iter; left time: 12.1601s
	iters: 500, epoch: 11 | loss: 0.2586721
	speed: 0.0030s/iter; left time: 13.8467s
Epoch: 11 cost time: 1.528484582901001
Epoch: 11, Steps: 513 | Train Loss: 0.3571841 Vali Loss: 0.3004960 Test Loss: 0.4828147
EarlyStopping counter: 2 out of 5
Updating learning rate to 4.8828125e-05
	iters: 100, epoch: 12 | loss: 0.2762945
	speed: 0.0064s/iter; left time: 28.7876s
	iters: 200, epoch: 12 | loss: 0.3929728
	speed: 0.0034s/iter; left time: 15.0211s
	iters: 300, epoch: 12 | loss: 0.7271103
	speed: 0.0033s/iter; left time: 14.2627s
	iters: 400, epoch: 12 | loss: 0.1832866
	speed: 0.0034s/iter; left time: 14.3834s
	iters: 500, epoch: 12 | loss: 0.2135373
	speed: 0.0034s/iter; left time: 13.9600s
Epoch: 12 cost time: 1.7063078880310059
Epoch: 12, Steps: 513 | Train Loss: 0.3561387 Vali Loss: 0.2873389 Test Loss: 0.4333406
Validation loss decreased (0.298157 --> 0.287339).  Saving model ...
Updating learning rate to 2.44140625e-05
	iters: 100, epoch: 13 | loss: 0.3162241
	speed: 0.0070s/iter; left time: 28.1177s
	iters: 200, epoch: 13 | loss: 0.4719549
	speed: 0.0038s/iter; left time: 14.6893s
	iters: 300, epoch: 13 | loss: 0.4373199
	speed: 0.0036s/iter; left time: 13.8502s
	iters: 400, epoch: 13 | loss: 0.7716776
	speed: 0.0033s/iter; left time: 12.0783s
	iters: 500, epoch: 13 | loss: 0.3980058
	speed: 0.0028s/iter; left time: 10.0954s
Epoch: 13 cost time: 1.7305352687835693
Epoch: 13, Steps: 513 | Train Loss: 0.3552176 Vali Loss: 0.2873138 Test Loss: 0.4355987
Validation loss decreased (0.287339 --> 0.287314).  Saving model ...
Updating learning rate to 1.220703125e-05
	iters: 100, epoch: 14 | loss: 0.3755322
	speed: 0.0070s/iter; left time: 24.5253s
	iters: 200, epoch: 14 | loss: 0.2394944
	speed: 0.0032s/iter; left time: 10.8604s
	iters: 300, epoch: 14 | loss: 0.2372946
	speed: 0.0029s/iter; left time: 9.4165s
	iters: 400, epoch: 14 | loss: 0.2081785
	speed: 0.0027s/iter; left time: 8.5545s
	iters: 500, epoch: 14 | loss: 0.1716257
	speed: 0.0028s/iter; left time: 8.5958s
Epoch: 14 cost time: 1.5062189102172852
Epoch: 14, Steps: 513 | Train Loss: 0.3547386 Vali Loss: 0.2841595 Test Loss: 0.4296851
Validation loss decreased (0.287314 --> 0.284159).  Saving model ...
Updating learning rate to 6.103515625e-06
	iters: 100, epoch: 15 | loss: 0.2530254
	speed: 0.0065s/iter; left time: 19.2912s
	iters: 200, epoch: 15 | loss: 0.1987414
	speed: 0.0032s/iter; left time: 9.1840s
	iters: 300, epoch: 15 | loss: 0.1553368
	speed: 0.0032s/iter; left time: 8.9002s
	iters: 400, epoch: 15 | loss: 0.2042551
	speed: 0.0032s/iter; left time: 8.5192s
	iters: 500, epoch: 15 | loss: 0.2843028
	speed: 0.0032s/iter; left time: 8.2270s
Epoch: 15 cost time: 1.6376588344573975
Epoch: 15, Steps: 513 | Train Loss: 0.3544685 Vali Loss: 0.2851662 Test Loss: 0.4324207
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.0517578125e-06
	iters: 100, epoch: 16 | loss: 0.3653935
	speed: 0.0061s/iter; left time: 14.9742s
	iters: 200, epoch: 16 | loss: 0.2497620
	speed: 0.0027s/iter; left time: 6.4119s
	iters: 300, epoch: 16 | loss: 0.1929739
	speed: 0.0027s/iter; left time: 6.1408s
	iters: 400, epoch: 16 | loss: 0.3571298
	speed: 0.0027s/iter; left time: 5.8333s
	iters: 500, epoch: 16 | loss: 0.2308147
	speed: 0.0033s/iter; left time: 6.7765s
Epoch: 16 cost time: 1.459312915802002
Epoch: 16, Steps: 513 | Train Loss: 0.3543125 Vali Loss: 0.2837903 Test Loss: 0.4280783
Validation loss decreased (0.284159 --> 0.283790).  Saving model ...
Updating learning rate to 1.52587890625e-06
	iters: 100, epoch: 17 | loss: 0.3904674
	speed: 0.0065s/iter; left time: 12.7196s
	iters: 200, epoch: 17 | loss: 0.4805569
	speed: 0.0029s/iter; left time: 5.4478s
	iters: 300, epoch: 17 | loss: 0.4209997
	speed: 0.0030s/iter; left time: 5.1893s
	iters: 400, epoch: 17 | loss: 0.5806720
	speed: 0.0024s/iter; left time: 3.9341s
	iters: 500, epoch: 17 | loss: 0.2685682
	speed: 0.0022s/iter; left time: 3.3884s
Epoch: 17 cost time: 1.3774957656860352
Epoch: 17, Steps: 513 | Train Loss: 0.3542555 Vali Loss: 0.2837760 Test Loss: 0.4284006
Validation loss decreased (0.283790 --> 0.283776).  Saving model ...
Updating learning rate to 7.62939453125e-07
	iters: 100, epoch: 18 | loss: 0.2202077
	speed: 0.0044s/iter; left time: 6.3504s
	iters: 200, epoch: 18 | loss: 1.0048805
	speed: 0.0021s/iter; left time: 2.8676s
	iters: 300, epoch: 18 | loss: 0.5925311
	speed: 0.0021s/iter; left time: 2.6066s
	iters: 400, epoch: 18 | loss: 0.1668621
	speed: 0.0021s/iter; left time: 2.4054s
	iters: 500, epoch: 18 | loss: 0.4606666
	speed: 0.0021s/iter; left time: 2.1320s
Epoch: 18 cost time: 1.081211805343628
Epoch: 18, Steps: 513 | Train Loss: 0.3542145 Vali Loss: 0.2836356 Test Loss: 0.4277385
Validation loss decreased (0.283776 --> 0.283636).  Saving model ...
Updating learning rate to 3.814697265625e-07
	iters: 100, epoch: 19 | loss: 0.1431419
	speed: 0.0050s/iter; left time: 4.6443s
	iters: 200, epoch: 19 | loss: 0.1892372
	speed: 0.0022s/iter; left time: 1.8220s
	iters: 300, epoch: 19 | loss: 0.7481408
	speed: 0.0023s/iter; left time: 1.6997s
	iters: 400, epoch: 19 | loss: 0.3199472
	speed: 0.0024s/iter; left time: 1.4985s
	iters: 500, epoch: 19 | loss: 0.1927357
	speed: 0.0022s/iter; left time: 1.1541s
Epoch: 19 cost time: 1.183109998703003
Epoch: 19, Steps: 513 | Train Loss: 0.3541678 Vali Loss: 0.2834112 Test Loss: 0.4277239
Validation loss decreased (0.283636 --> 0.283411).  Saving model ...
Updating learning rate to 1.9073486328125e-07
	iters: 100, epoch: 20 | loss: 0.3136307
	speed: 0.0038s/iter; left time: 1.5778s
	iters: 200, epoch: 20 | loss: 0.6507679
	speed: 0.0019s/iter; left time: 0.5903s
	iters: 300, epoch: 20 | loss: 0.2082595
	speed: 0.0019s/iter; left time: 0.4067s
	iters: 400, epoch: 20 | loss: 0.6094302
	speed: 0.0019s/iter; left time: 0.2143s
	iters: 500, epoch: 20 | loss: 0.2171402
	speed: 0.0019s/iter; left time: 0.0265s
Epoch: 20 cost time: 0.9691786766052246
Epoch: 20, Steps: 513 | Train Loss: 0.3541600 Vali Loss: 0.2836182 Test Loss: 0.4276670
EarlyStopping counter: 1 out of 5
Updating learning rate to 9.5367431640625e-08
>>>>>>>testing : ETTh2_336_96_Linear_ETTh2_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15227<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.4290993809700012, mae:0.431423544883728
