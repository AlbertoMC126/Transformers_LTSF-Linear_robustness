Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='NLinear', model_id='weather_96_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=12890, seq_len=96, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_96_96_NLinear_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed12890>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36696
val 5175
test 10444
Total number of trainable parameters: 195552
Total number of parameters: 195552
	iters: 100, epoch: 1 | loss: 0.4396361
	speed: 0.0813s/iter; left time: 3722.5253s
	iters: 200, epoch: 1 | loss: 0.3368198
	speed: 0.0319s/iter; left time: 1457.4119s
	iters: 300, epoch: 1 | loss: 0.3117824
	speed: 0.0317s/iter; left time: 1443.5061s
	iters: 400, epoch: 1 | loss: 0.2382625
	speed: 0.0316s/iter; left time: 1438.0503s
	iters: 500, epoch: 1 | loss: 0.3935760
	speed: 0.0318s/iter; left time: 1441.2474s
	iters: 600, epoch: 1 | loss: 0.3528520
	speed: 0.0316s/iter; left time: 1431.8880s
	iters: 700, epoch: 1 | loss: 0.5596672
	speed: 0.0317s/iter; left time: 1431.3515s
	iters: 800, epoch: 1 | loss: 0.3223970
	speed: 0.0317s/iter; left time: 1427.3944s
	iters: 900, epoch: 1 | loss: 0.4262882
	speed: 0.0315s/iter; left time: 1417.4781s
	iters: 1000, epoch: 1 | loss: 0.3680746
	speed: 0.0317s/iter; left time: 1421.2510s
	iters: 1100, epoch: 1 | loss: 0.4529001
	speed: 0.0317s/iter; left time: 1417.2612s
	iters: 1200, epoch: 1 | loss: 0.3067504
	speed: 0.0318s/iter; left time: 1420.2291s
	iters: 1300, epoch: 1 | loss: 0.3961975
	speed: 0.0318s/iter; left time: 1416.9725s
	iters: 1400, epoch: 1 | loss: 0.2519239
	speed: 0.0316s/iter; left time: 1404.1084s
	iters: 1500, epoch: 1 | loss: 0.4509838
	speed: 0.0316s/iter; left time: 1400.7555s
	iters: 1600, epoch: 1 | loss: 0.3054904
	speed: 0.0315s/iter; left time: 1394.0482s
	iters: 1700, epoch: 1 | loss: 0.3455751
	speed: 0.0317s/iter; left time: 1398.2318s
	iters: 1800, epoch: 1 | loss: 0.4603578
	speed: 0.0314s/iter; left time: 1382.8043s
	iters: 1900, epoch: 1 | loss: 0.2371042
	speed: 0.0317s/iter; left time: 1391.9438s
	iters: 2000, epoch: 1 | loss: 0.2344974
	speed: 0.0314s/iter; left time: 1376.6003s
	iters: 2100, epoch: 1 | loss: 0.5354129
	speed: 0.0316s/iter; left time: 1382.7550s
	iters: 2200, epoch: 1 | loss: 0.5869083
	speed: 0.0316s/iter; left time: 1379.6154s
Epoch: 1 cost time: 77.50680375099182
Epoch: 1, Steps: 2293 | Train Loss: 0.6662584 Vali Loss: 0.5838749 Test Loss: 0.1811473
Validation loss decreased (inf --> 0.583875).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.3282408
	speed: 0.1096s/iter; left time: 4765.2496s
	iters: 200, epoch: 2 | loss: 0.3832230
	speed: 0.0316s/iter; left time: 1371.1465s
	iters: 300, epoch: 2 | loss: 0.4151822
	speed: 0.0318s/iter; left time: 1376.2790s
	iters: 400, epoch: 2 | loss: 0.4694738
	speed: 0.0314s/iter; left time: 1355.0559s
	iters: 500, epoch: 2 | loss: 0.2937058
	speed: 0.0315s/iter; left time: 1357.5651s
	iters: 600, epoch: 2 | loss: 0.3760289
	speed: 0.0316s/iter; left time: 1356.7050s
	iters: 700, epoch: 2 | loss: 0.9305733
	speed: 0.0316s/iter; left time: 1353.8017s
	iters: 800, epoch: 2 | loss: 1.8116924
	speed: 0.0314s/iter; left time: 1341.6347s
	iters: 900, epoch: 2 | loss: 1.2248706
	speed: 0.0317s/iter; left time: 1353.0648s
	iters: 1000, epoch: 2 | loss: 1.1672623
	speed: 0.0317s/iter; left time: 1348.5702s
	iters: 1100, epoch: 2 | loss: 2.7788837
	speed: 0.0317s/iter; left time: 1345.8287s
	iters: 1200, epoch: 2 | loss: 0.8383004
	speed: 0.0317s/iter; left time: 1345.0176s
	iters: 1300, epoch: 2 | loss: 3.3746572
	speed: 0.0317s/iter; left time: 1338.3016s
	iters: 1400, epoch: 2 | loss: 0.2527152
	speed: 0.0317s/iter; left time: 1337.4683s
	iters: 1500, epoch: 2 | loss: 0.3197026
	speed: 0.0318s/iter; left time: 1335.7303s
	iters: 1600, epoch: 2 | loss: 0.2983960
	speed: 0.0317s/iter; left time: 1328.3074s
	iters: 1700, epoch: 2 | loss: 0.3927149
	speed: 0.0318s/iter; left time: 1329.8395s
	iters: 1800, epoch: 2 | loss: 0.2846329
	speed: 0.0318s/iter; left time: 1326.5935s
	iters: 1900, epoch: 2 | loss: 0.3858220
	speed: 0.0314s/iter; left time: 1306.7935s
	iters: 2000, epoch: 2 | loss: 0.7738970
	speed: 0.0315s/iter; left time: 1310.1024s
	iters: 2100, epoch: 2 | loss: 0.3695615
	speed: 0.0318s/iter; left time: 1317.2947s
	iters: 2200, epoch: 2 | loss: 3.5426221
	speed: 0.0314s/iter; left time: 1299.8699s
Epoch: 2 cost time: 72.46898174285889
Epoch: 2, Steps: 2293 | Train Loss: 0.7314412 Vali Loss: 0.4542069 Test Loss: 0.1833910
Validation loss decreased (0.583875 --> 0.454207).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.3789900
	speed: 0.1106s/iter; left time: 4554.6345s
	iters: 200, epoch: 3 | loss: 0.2763196
	speed: 0.0317s/iter; left time: 1302.9053s
	iters: 300, epoch: 3 | loss: 0.3764580
	speed: 0.0316s/iter; left time: 1296.4099s
	iters: 400, epoch: 3 | loss: 0.4245517
	speed: 0.0317s/iter; left time: 1297.7158s
	iters: 500, epoch: 3 | loss: 0.4037197
	speed: 0.0318s/iter; left time: 1296.7104s
	iters: 600, epoch: 3 | loss: 1.4194822
	speed: 0.0316s/iter; left time: 1286.2632s
	iters: 700, epoch: 3 | loss: 0.2961277
	speed: 0.0317s/iter; left time: 1286.1821s
	iters: 800, epoch: 3 | loss: 0.3803941
	speed: 0.0316s/iter; left time: 1280.2402s
	iters: 900, epoch: 3 | loss: 0.2372981
	speed: 0.0315s/iter; left time: 1270.5214s
	iters: 1000, epoch: 3 | loss: 0.3058304
	speed: 0.0315s/iter; left time: 1268.2310s
	iters: 1100, epoch: 3 | loss: 0.4392171
	speed: 0.0318s/iter; left time: 1279.4208s
	iters: 1200, epoch: 3 | loss: 0.4175966
	speed: 0.0316s/iter; left time: 1265.9078s
	iters: 1300, epoch: 3 | loss: 0.3460127
	speed: 0.0317s/iter; left time: 1265.3639s
	iters: 1400, epoch: 3 | loss: 0.5021724
	speed: 0.0315s/iter; left time: 1254.7166s
	iters: 1500, epoch: 3 | loss: 3.1329427
	speed: 0.0314s/iter; left time: 1248.6861s
	iters: 1600, epoch: 3 | loss: 0.3810330
	speed: 0.0314s/iter; left time: 1246.3442s
	iters: 1700, epoch: 3 | loss: 0.3141288
	speed: 0.0315s/iter; left time: 1248.2314s
	iters: 1800, epoch: 3 | loss: 1.7330878
	speed: 0.0315s/iter; left time: 1243.4625s
	iters: 1900, epoch: 3 | loss: 0.3980236
	speed: 0.0316s/iter; left time: 1242.3153s
	iters: 2000, epoch: 3 | loss: 0.5311604
	speed: 0.0316s/iter; left time: 1241.9452s
	iters: 2100, epoch: 3 | loss: 0.3028542
	speed: 0.0314s/iter; left time: 1230.5391s
	iters: 2200, epoch: 3 | loss: 0.3008821
	speed: 0.0314s/iter; left time: 1225.1088s
Epoch: 3 cost time: 72.38334822654724
Epoch: 3, Steps: 2293 | Train Loss: 6.6258778 Vali Loss: 0.4434900 Test Loss: 0.1697304
Validation loss decreased (0.454207 --> 0.443490).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.5744568
	speed: 0.1101s/iter; left time: 4282.7240s
	iters: 200, epoch: 4 | loss: 0.2827740
	speed: 0.0317s/iter; left time: 1229.7191s
	iters: 300, epoch: 4 | loss: 0.2977645
	speed: 0.0314s/iter; left time: 1216.2548s
	iters: 400, epoch: 4 | loss: 0.2996194
	speed: 0.0316s/iter; left time: 1218.1144s
	iters: 500, epoch: 4 | loss: 0.7420574
	speed: 0.0314s/iter; left time: 1209.1501s
	iters: 600, epoch: 4 | loss: 0.2916972
	speed: 0.0315s/iter; left time: 1208.2830s
	iters: 700, epoch: 4 | loss: 0.8874843
	speed: 0.0314s/iter; left time: 1202.3261s
	iters: 800, epoch: 4 | loss: 0.3182552
	speed: 0.0317s/iter; left time: 1208.6382s
	iters: 900, epoch: 4 | loss: 0.1818530
	speed: 0.0316s/iter; left time: 1204.2942s
	iters: 1000, epoch: 4 | loss: 0.3531752
	speed: 0.0318s/iter; left time: 1205.9846s
	iters: 1100, epoch: 4 | loss: 0.2338322
	speed: 0.0314s/iter; left time: 1189.9526s
	iters: 1200, epoch: 4 | loss: 0.4360739
	speed: 0.0316s/iter; left time: 1194.3737s
	iters: 1300, epoch: 4 | loss: 0.9695113
	speed: 0.0317s/iter; left time: 1193.3802s
	iters: 1400, epoch: 4 | loss: 0.4147363
	speed: 0.0316s/iter; left time: 1186.8926s
	iters: 1500, epoch: 4 | loss: 0.2636696
	speed: 0.0317s/iter; left time: 1189.0059s
	iters: 1600, epoch: 4 | loss: 0.3262591
	speed: 0.0315s/iter; left time: 1179.0056s
	iters: 1700, epoch: 4 | loss: 0.2896494
	speed: 0.0317s/iter; left time: 1180.2198s
	iters: 1800, epoch: 4 | loss: 0.2587066
	speed: 0.0315s/iter; left time: 1172.3742s
	iters: 1900, epoch: 4 | loss: 0.5259794
	speed: 0.0318s/iter; left time: 1178.6038s
	iters: 2000, epoch: 4 | loss: 0.4665044
	speed: 0.0315s/iter; left time: 1163.9299s
	iters: 2100, epoch: 4 | loss: 2.1896944
	speed: 0.0315s/iter; left time: 1162.1298s
	iters: 2200, epoch: 4 | loss: 0.2432593
	speed: 0.0319s/iter; left time: 1174.4655s
Epoch: 4 cost time: 72.34757328033447
Epoch: 4, Steps: 2293 | Train Loss: 1.3141876 Vali Loss: 0.9835994 Test Loss: 0.1757638
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.4302360
	speed: 0.1089s/iter; left time: 3983.0277s
	iters: 200, epoch: 5 | loss: 0.8658212
	speed: 0.0317s/iter; left time: 1156.9894s
	iters: 300, epoch: 5 | loss: 1.5437813
	speed: 0.0317s/iter; left time: 1152.4286s
	iters: 400, epoch: 5 | loss: 0.2574856
	speed: 0.0315s/iter; left time: 1142.6482s
	iters: 500, epoch: 5 | loss: 0.2445927
	speed: 0.0316s/iter; left time: 1143.5017s
	iters: 600, epoch: 5 | loss: 0.4885718
	speed: 0.0317s/iter; left time: 1144.0367s
	iters: 700, epoch: 5 | loss: 0.3583876
	speed: 0.0317s/iter; left time: 1142.4824s
	iters: 800, epoch: 5 | loss: 0.5743971
	speed: 0.0315s/iter; left time: 1129.5764s
	iters: 900, epoch: 5 | loss: 0.2875380
	speed: 0.0316s/iter; left time: 1129.6953s
	iters: 1000, epoch: 5 | loss: 0.2589181
	speed: 0.0317s/iter; left time: 1130.9721s
	iters: 1100, epoch: 5 | loss: 0.2476209
	speed: 0.0315s/iter; left time: 1119.7380s
	iters: 1200, epoch: 5 | loss: 0.2512709
	speed: 0.0315s/iter; left time: 1118.8163s
	iters: 1300, epoch: 5 | loss: 0.2578546
	speed: 0.0316s/iter; left time: 1117.1682s
	iters: 1400, epoch: 5 | loss: 0.2469169
	speed: 0.0317s/iter; left time: 1117.1875s
	iters: 1500, epoch: 5 | loss: 0.5111718
	speed: 0.0318s/iter; left time: 1118.3559s
	iters: 1600, epoch: 5 | loss: 0.2545376
	speed: 0.0317s/iter; left time: 1113.2975s
	iters: 1700, epoch: 5 | loss: 0.3949982
	speed: 0.0317s/iter; left time: 1110.6795s
	iters: 1800, epoch: 5 | loss: 0.7830237
	speed: 0.0318s/iter; left time: 1111.0890s
	iters: 1900, epoch: 5 | loss: 0.5951185
	speed: 0.0317s/iter; left time: 1101.4006s
	iters: 2000, epoch: 5 | loss: 0.4288813
	speed: 0.0317s/iter; left time: 1100.7587s
	iters: 2100, epoch: 5 | loss: 0.4580085
	speed: 0.0317s/iter; left time: 1097.6360s
	iters: 2200, epoch: 5 | loss: 0.3031675
	speed: 0.0317s/iter; left time: 1093.2087s
Epoch: 5 cost time: 72.52306079864502
Epoch: 5, Steps: 2293 | Train Loss: 0.5739760 Vali Loss: 0.4194191 Test Loss: 0.1671287
Validation loss decreased (0.443490 --> 0.419419).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 1.2401524
	speed: 0.1101s/iter; left time: 3774.8845s
	iters: 200, epoch: 6 | loss: 0.2099811
	speed: 0.0318s/iter; left time: 1085.8490s
	iters: 300, epoch: 6 | loss: 0.2682023
	speed: 0.0314s/iter; left time: 1071.1983s
	iters: 400, epoch: 6 | loss: 0.2901428
	speed: 0.0316s/iter; left time: 1073.9331s
	iters: 500, epoch: 6 | loss: 0.4113256
	speed: 0.0318s/iter; left time: 1077.1580s
	iters: 600, epoch: 6 | loss: 0.3461143
	speed: 0.0318s/iter; left time: 1073.7958s
	iters: 700, epoch: 6 | loss: 0.2757533
	speed: 0.0316s/iter; left time: 1063.2401s
	iters: 800, epoch: 6 | loss: 0.4547569
	speed: 0.0317s/iter; left time: 1064.7635s
	iters: 900, epoch: 6 | loss: 0.2394403
	speed: 0.0316s/iter; left time: 1057.8534s
	iters: 1000, epoch: 6 | loss: 0.8475115
	speed: 0.0313s/iter; left time: 1046.3052s
	iters: 1100, epoch: 6 | loss: 0.2606059
	speed: 0.0316s/iter; left time: 1051.5463s
	iters: 1200, epoch: 6 | loss: 0.3708812
	speed: 0.0317s/iter; left time: 1051.8673s
	iters: 1300, epoch: 6 | loss: 0.2317483
	speed: 0.0317s/iter; left time: 1047.9315s
	iters: 1400, epoch: 6 | loss: 0.4662373
	speed: 0.0315s/iter; left time: 1038.7491s
	iters: 1500, epoch: 6 | loss: 0.4476300
	speed: 0.0315s/iter; left time: 1036.1498s
	iters: 1600, epoch: 6 | loss: 0.2959985
	speed: 0.0313s/iter; left time: 1026.9861s
	iters: 1700, epoch: 6 | loss: 0.5388843
	speed: 0.0314s/iter; left time: 1028.0970s
	iters: 1800, epoch: 6 | loss: 0.3905656
	speed: 0.0316s/iter; left time: 1029.4548s
	iters: 1900, epoch: 6 | loss: 0.3816823
	speed: 0.0315s/iter; left time: 1024.8039s
	iters: 2000, epoch: 6 | loss: 0.2677923
	speed: 0.0316s/iter; left time: 1023.2290s
	iters: 2100, epoch: 6 | loss: 0.3911501
	speed: 0.0316s/iter; left time: 1020.3182s
	iters: 2200, epoch: 6 | loss: 0.3186110
	speed: 0.0314s/iter; left time: 1010.2211s
Epoch: 6 cost time: 72.32449507713318
Epoch: 6, Steps: 2293 | Train Loss: 0.4577043 Vali Loss: 0.4264483 Test Loss: 0.1662709
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 2.2289822
	speed: 0.1080s/iter; left time: 3455.5862s
	iters: 200, epoch: 7 | loss: 0.3371120
	speed: 0.0319s/iter; left time: 1018.1267s
	iters: 300, epoch: 7 | loss: 0.4420133
	speed: 0.0314s/iter; left time: 999.5364s
	iters: 400, epoch: 7 | loss: 0.3696065
	speed: 0.0316s/iter; left time: 1000.7224s
	iters: 500, epoch: 7 | loss: 0.2924680
	speed: 0.0315s/iter; left time: 994.9558s
	iters: 600, epoch: 7 | loss: 0.2708431
	speed: 0.0317s/iter; left time: 997.2890s
	iters: 700, epoch: 7 | loss: 0.3399025
	speed: 0.0315s/iter; left time: 990.5333s
	iters: 800, epoch: 7 | loss: 0.3017676
	speed: 0.0317s/iter; left time: 993.1074s
	iters: 900, epoch: 7 | loss: 0.8156945
	speed: 0.0316s/iter; left time: 985.1882s
	iters: 1000, epoch: 7 | loss: 0.7991866
	speed: 0.0316s/iter; left time: 983.2192s
	iters: 1100, epoch: 7 | loss: 0.2809645
	speed: 0.0316s/iter; left time: 979.8631s
	iters: 1200, epoch: 7 | loss: 0.2466577
	speed: 0.0315s/iter; left time: 973.5339s
	iters: 1300, epoch: 7 | loss: 0.2390995
	speed: 0.0315s/iter; left time: 970.5318s
	iters: 1400, epoch: 7 | loss: 0.2191433
	speed: 0.0315s/iter; left time: 966.4164s
	iters: 1500, epoch: 7 | loss: 0.4267773
	speed: 0.0316s/iter; left time: 966.9552s
	iters: 1600, epoch: 7 | loss: 0.4513383
	speed: 0.0318s/iter; left time: 968.5393s
	iters: 1700, epoch: 7 | loss: 0.6001874
	speed: 0.0317s/iter; left time: 964.8168s
	iters: 1800, epoch: 7 | loss: 0.2757125
	speed: 0.0316s/iter; left time: 958.8517s
	iters: 1900, epoch: 7 | loss: 0.2489999
	speed: 0.0317s/iter; left time: 957.3068s
	iters: 2000, epoch: 7 | loss: 0.2955928
	speed: 0.0317s/iter; left time: 954.4329s
	iters: 2100, epoch: 7 | loss: 0.4032049
	speed: 0.0318s/iter; left time: 953.8545s
	iters: 2200, epoch: 7 | loss: 0.2986272
	speed: 0.0317s/iter; left time: 947.5682s
Epoch: 7 cost time: 72.41070318222046
Epoch: 7, Steps: 2293 | Train Loss: 0.4524908 Vali Loss: 0.4237813 Test Loss: 0.1654187
EarlyStopping counter: 2 out of 5
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.4793035
	speed: 0.1092s/iter; left time: 3244.4776s
	iters: 200, epoch: 8 | loss: 0.2840781
	speed: 0.0318s/iter; left time: 942.4136s
	iters: 300, epoch: 8 | loss: 0.2694422
	speed: 0.0320s/iter; left time: 943.9811s
	iters: 400, epoch: 8 | loss: 0.3019969
	speed: 0.0318s/iter; left time: 934.2199s
	iters: 500, epoch: 8 | loss: 0.3492958
	speed: 0.0318s/iter; left time: 931.1108s
	iters: 600, epoch: 8 | loss: 0.2917357
	speed: 0.0319s/iter; left time: 930.6937s
	iters: 700, epoch: 8 | loss: 0.2330538
	speed: 0.0316s/iter; left time: 921.2237s
	iters: 800, epoch: 8 | loss: 0.6548925
	speed: 0.0315s/iter; left time: 913.2094s
	iters: 900, epoch: 8 | loss: 0.2288216
	speed: 0.0317s/iter; left time: 915.3791s
	iters: 1000, epoch: 8 | loss: 0.4197731
	speed: 0.0316s/iter; left time: 910.7422s
	iters: 1100, epoch: 8 | loss: 0.3205101
	speed: 0.0315s/iter; left time: 902.9950s
	iters: 1200, epoch: 8 | loss: 0.3392424
	speed: 0.0314s/iter; left time: 899.5695s
	iters: 1300, epoch: 8 | loss: 0.2575198
	speed: 0.0317s/iter; left time: 902.5071s
	iters: 1400, epoch: 8 | loss: 0.3582805
	speed: 0.0317s/iter; left time: 899.8112s
	iters: 1500, epoch: 8 | loss: 0.3489693
	speed: 0.0314s/iter; left time: 889.6490s
	iters: 1600, epoch: 8 | loss: 0.2832268
	speed: 0.0316s/iter; left time: 892.4244s
	iters: 1700, epoch: 8 | loss: 0.2913352
	speed: 0.0316s/iter; left time: 888.9494s
	iters: 1800, epoch: 8 | loss: 0.4039697
	speed: 0.0316s/iter; left time: 885.4770s
	iters: 1900, epoch: 8 | loss: 0.2962563
	speed: 0.0316s/iter; left time: 882.8030s
	iters: 2000, epoch: 8 | loss: 0.3934737
	speed: 0.0317s/iter; left time: 882.5446s
	iters: 2100, epoch: 8 | loss: 0.6157942
	speed: 0.0314s/iter; left time: 871.1700s
	iters: 2200, epoch: 8 | loss: 0.6017443
	speed: 0.0315s/iter; left time: 869.9051s
Epoch: 8 cost time: 72.43473410606384
Epoch: 8, Steps: 2293 | Train Loss: 0.4504436 Vali Loss: 0.4238977 Test Loss: 0.1649408
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.2172559
	speed: 0.1092s/iter; left time: 2993.1727s
	iters: 200, epoch: 9 | loss: 0.3457180
	speed: 0.0317s/iter; left time: 865.5525s
	iters: 300, epoch: 9 | loss: 0.2178027
	speed: 0.0316s/iter; left time: 858.8481s
	iters: 400, epoch: 9 | loss: 0.1914219
	speed: 0.0316s/iter; left time: 856.7678s
	iters: 500, epoch: 9 | loss: 0.3664059
	speed: 0.0317s/iter; left time: 857.5725s
	iters: 600, epoch: 9 | loss: 0.4645111
	speed: 0.0317s/iter; left time: 852.8192s
	iters: 700, epoch: 9 | loss: 0.3685028
	speed: 0.0318s/iter; left time: 854.1142s
	iters: 800, epoch: 9 | loss: 0.2277619
	speed: 0.0316s/iter; left time: 843.8699s
	iters: 900, epoch: 9 | loss: 0.2659677
	speed: 0.0316s/iter; left time: 840.5913s
	iters: 1000, epoch: 9 | loss: 0.2230290
	speed: 0.0317s/iter; left time: 839.8270s
	iters: 1100, epoch: 9 | loss: 0.3604371
	speed: 0.0315s/iter; left time: 831.6023s
	iters: 1200, epoch: 9 | loss: 0.7867070
	speed: 0.0314s/iter; left time: 826.8677s
	iters: 1300, epoch: 9 | loss: 0.3343520
	speed: 0.0316s/iter; left time: 828.8203s
	iters: 1400, epoch: 9 | loss: 0.6399627
	speed: 0.0314s/iter; left time: 818.9638s
	iters: 1500, epoch: 9 | loss: 0.3562933
	speed: 0.0316s/iter; left time: 822.9218s
	iters: 1600, epoch: 9 | loss: 0.3587556
	speed: 0.0314s/iter; left time: 813.3054s
	iters: 1700, epoch: 9 | loss: 0.4167936
	speed: 0.0315s/iter; left time: 813.7655s
	iters: 1800, epoch: 9 | loss: 0.2552893
	speed: 0.0317s/iter; left time: 815.9683s
	iters: 1900, epoch: 9 | loss: 0.2522030
	speed: 0.0317s/iter; left time: 811.8911s
	iters: 2000, epoch: 9 | loss: 0.2316034
	speed: 0.0316s/iter; left time: 805.2284s
	iters: 2100, epoch: 9 | loss: 0.2803223
	speed: 0.0319s/iter; left time: 809.9473s
	iters: 2200, epoch: 9 | loss: 0.9162831
	speed: 0.0317s/iter; left time: 802.9413s
Epoch: 9 cost time: 72.38207364082336
Epoch: 9, Steps: 2293 | Train Loss: 0.4493650 Vali Loss: 0.4210330 Test Loss: 0.1643146
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.7097725
	speed: 0.1091s/iter; left time: 2742.0758s
	iters: 200, epoch: 10 | loss: 0.2321182
	speed: 0.0316s/iter; left time: 790.3227s
	iters: 300, epoch: 10 | loss: 0.4274406
	speed: 0.0314s/iter; left time: 783.3158s
	iters: 400, epoch: 10 | loss: 0.3064148
	speed: 0.0316s/iter; left time: 784.9014s
	iters: 500, epoch: 10 | loss: 0.3036395
	speed: 0.0317s/iter; left time: 784.0807s
	iters: 600, epoch: 10 | loss: 0.2279647
	speed: 0.0316s/iter; left time: 776.9838s
	iters: 700, epoch: 10 | loss: 0.2576932
	speed: 0.0317s/iter; left time: 776.9575s
	iters: 800, epoch: 10 | loss: 0.4880794
	speed: 0.0319s/iter; left time: 779.2187s
	iters: 900, epoch: 10 | loss: 0.9909926
	speed: 0.0318s/iter; left time: 773.2428s
	iters: 1000, epoch: 10 | loss: 0.8968294
	speed: 0.0316s/iter; left time: 765.8675s
	iters: 1100, epoch: 10 | loss: 0.4784864
	speed: 0.0317s/iter; left time: 765.4012s
	iters: 1200, epoch: 10 | loss: 0.2658196
	speed: 0.0315s/iter; left time: 757.6181s
	iters: 1300, epoch: 10 | loss: 0.4971304
	speed: 0.0315s/iter; left time: 753.6965s
	iters: 1400, epoch: 10 | loss: 0.3545717
	speed: 0.0315s/iter; left time: 750.5198s
	iters: 1500, epoch: 10 | loss: 0.2729586
	speed: 0.0317s/iter; left time: 751.3192s
	iters: 1600, epoch: 10 | loss: 0.2883433
	speed: 0.0314s/iter; left time: 742.7328s
	iters: 1700, epoch: 10 | loss: 0.5538848
	speed: 0.0316s/iter; left time: 743.4053s
	iters: 1800, epoch: 10 | loss: 0.2260710
	speed: 0.0316s/iter; left time: 739.8981s
	iters: 1900, epoch: 10 | loss: 0.2968678
	speed: 0.0315s/iter; left time: 735.1115s
	iters: 2000, epoch: 10 | loss: 0.2658304
	speed: 0.0316s/iter; left time: 733.0298s
	iters: 2100, epoch: 10 | loss: 0.3067405
	speed: 0.0315s/iter; left time: 728.9226s
	iters: 2200, epoch: 10 | loss: 0.3261991
	speed: 0.0316s/iter; left time: 727.2563s
Epoch: 10 cost time: 72.33744096755981
Epoch: 10, Steps: 2293 | Train Loss: 0.4486904 Vali Loss: 0.4193237 Test Loss: 0.1647997
Validation loss decreased (0.419419 --> 0.419324).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.2954459
	speed: 0.1122s/iter; left time: 2562.3983s
	iters: 200, epoch: 11 | loss: 0.4596089
	speed: 0.0316s/iter; left time: 719.1994s
	iters: 300, epoch: 11 | loss: 0.2486594
	speed: 0.0316s/iter; left time: 715.2488s
	iters: 400, epoch: 11 | loss: 2.2964313
	speed: 0.0317s/iter; left time: 713.4628s
	iters: 500, epoch: 11 | loss: 0.3197511
	speed: 0.0317s/iter; left time: 709.9948s
	iters: 600, epoch: 11 | loss: 2.3716905
	speed: 0.0316s/iter; left time: 706.4054s
	iters: 700, epoch: 11 | loss: 0.2460528
	speed: 0.0316s/iter; left time: 701.7972s
	iters: 800, epoch: 11 | loss: 0.3049006
	speed: 0.0316s/iter; left time: 699.2492s
	iters: 900, epoch: 11 | loss: 0.4361020
	speed: 0.0316s/iter; left time: 696.5595s
	iters: 1000, epoch: 11 | loss: 0.3204918
	speed: 0.0314s/iter; left time: 689.1241s
	iters: 1100, epoch: 11 | loss: 0.3147235
	speed: 0.0314s/iter; left time: 685.8443s
	iters: 1200, epoch: 11 | loss: 0.2986424
	speed: 0.0317s/iter; left time: 689.4046s
	iters: 1300, epoch: 11 | loss: 0.8083405
	speed: 0.0316s/iter; left time: 684.6056s
	iters: 1400, epoch: 11 | loss: 0.2982367
	speed: 0.0317s/iter; left time: 682.2092s
	iters: 1500, epoch: 11 | loss: 0.2905031
	speed: 0.0318s/iter; left time: 681.5716s
	iters: 1600, epoch: 11 | loss: 0.3023209
	speed: 0.0318s/iter; left time: 677.9910s
	iters: 1700, epoch: 11 | loss: 0.4538851
	speed: 0.0317s/iter; left time: 672.5193s
	iters: 1800, epoch: 11 | loss: 0.4312632
	speed: 0.0318s/iter; left time: 672.8465s
	iters: 1900, epoch: 11 | loss: 0.3751766
	speed: 0.0315s/iter; left time: 661.9475s
	iters: 2000, epoch: 11 | loss: 0.2365123
	speed: 0.0316s/iter; left time: 662.4283s
	iters: 2100, epoch: 11 | loss: 0.4413308
	speed: 0.0317s/iter; left time: 660.3842s
	iters: 2200, epoch: 11 | loss: 0.3371452
	speed: 0.0316s/iter; left time: 654.3864s
Epoch: 11 cost time: 72.41792702674866
Epoch: 11, Steps: 2293 | Train Loss: 0.4482085 Vali Loss: 0.4191059 Test Loss: 0.1645918
Validation loss decreased (0.419324 --> 0.419106).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.3916982
	speed: 0.1054s/iter; left time: 2164.8963s
	iters: 200, epoch: 12 | loss: 0.3969337
	speed: 0.0280s/iter; left time: 572.6573s
	iters: 300, epoch: 12 | loss: 0.2140006
	speed: 0.0257s/iter; left time: 523.3392s
	iters: 400, epoch: 12 | loss: 0.2552512
	speed: 0.0256s/iter; left time: 518.0507s
	iters: 500, epoch: 12 | loss: 0.2384777
	speed: 0.0251s/iter; left time: 506.4510s
	iters: 600, epoch: 12 | loss: 0.5980700
	speed: 0.0253s/iter; left time: 507.5007s
	iters: 700, epoch: 12 | loss: 0.2659060
	speed: 0.0252s/iter; left time: 502.5679s
	iters: 800, epoch: 12 | loss: 0.2539379
	speed: 0.0253s/iter; left time: 501.3670s
	iters: 900, epoch: 12 | loss: 0.4361184
	speed: 0.0253s/iter; left time: 500.0684s
	iters: 1000, epoch: 12 | loss: 0.5248048
	speed: 0.0253s/iter; left time: 496.4000s
	iters: 1100, epoch: 12 | loss: 0.4400941
	speed: 0.0254s/iter; left time: 496.8644s
	iters: 1200, epoch: 12 | loss: 1.6371884
	speed: 0.0254s/iter; left time: 493.5132s
	iters: 1300, epoch: 12 | loss: 0.4369527
	speed: 0.0252s/iter; left time: 488.2738s
	iters: 1400, epoch: 12 | loss: 0.3596340
	speed: 0.0252s/iter; left time: 485.5620s
	iters: 1500, epoch: 12 | loss: 0.4652164
	speed: 0.0252s/iter; left time: 482.3676s
	iters: 1600, epoch: 12 | loss: 0.4377798
	speed: 0.0251s/iter; left time: 477.0731s
	iters: 1700, epoch: 12 | loss: 0.3546422
	speed: 0.0252s/iter; left time: 476.5478s
	iters: 1800, epoch: 12 | loss: 0.4906335
	speed: 0.0253s/iter; left time: 476.6243s
	iters: 1900, epoch: 12 | loss: 0.3356191
	speed: 0.0253s/iter; left time: 474.2750s
	iters: 2000, epoch: 12 | loss: 0.3490471
	speed: 0.0251s/iter; left time: 468.6178s
	iters: 2100, epoch: 12 | loss: 0.2568945
	speed: 0.0250s/iter; left time: 463.6572s
	iters: 2200, epoch: 12 | loss: 2.2395391
	speed: 0.0250s/iter; left time: 461.5616s
Epoch: 12 cost time: 58.403778076171875
Epoch: 12, Steps: 2293 | Train Loss: 0.4482367 Vali Loss: 0.4202146 Test Loss: 0.1645098
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.2454829
	speed: 0.0740s/iter; left time: 1350.4158s
	iters: 200, epoch: 13 | loss: 2.1641512
	speed: 0.0169s/iter; left time: 306.0071s
	iters: 300, epoch: 13 | loss: 0.2915936
	speed: 0.0170s/iter; left time: 306.8585s
	iters: 400, epoch: 13 | loss: 0.3191083
	speed: 0.0146s/iter; left time: 262.7100s
	iters: 500, epoch: 13 | loss: 0.2341387
	speed: 0.0129s/iter; left time: 229.7084s
	iters: 600, epoch: 13 | loss: 0.4027230
	speed: 0.0128s/iter; left time: 226.5532s
	iters: 700, epoch: 13 | loss: 2.2312179
	speed: 0.0124s/iter; left time: 219.4492s
	iters: 800, epoch: 13 | loss: 0.1979152
	speed: 0.0127s/iter; left time: 223.0522s
	iters: 900, epoch: 13 | loss: 0.3568255
	speed: 0.0127s/iter; left time: 222.3984s
	iters: 1000, epoch: 13 | loss: 0.2095740
	speed: 0.0125s/iter; left time: 216.4328s
	iters: 1100, epoch: 13 | loss: 0.2394969
	speed: 0.0126s/iter; left time: 216.4645s
	iters: 1200, epoch: 13 | loss: 2.3487880
	speed: 0.0125s/iter; left time: 214.0375s
	iters: 1300, epoch: 13 | loss: 2.2837474
	speed: 0.0125s/iter; left time: 213.6053s
	iters: 1400, epoch: 13 | loss: 0.5888165
	speed: 0.0128s/iter; left time: 217.6325s
	iters: 1500, epoch: 13 | loss: 0.1905556
	speed: 0.0127s/iter; left time: 214.2612s
	iters: 1600, epoch: 13 | loss: 0.7144117
	speed: 0.0127s/iter; left time: 212.1347s
	iters: 1700, epoch: 13 | loss: 0.2606173
	speed: 0.0127s/iter; left time: 211.0439s
	iters: 1800, epoch: 13 | loss: 1.5171473
	speed: 0.0126s/iter; left time: 208.4584s
	iters: 1900, epoch: 13 | loss: 0.3581913
	speed: 0.0128s/iter; left time: 211.2645s
	iters: 2000, epoch: 13 | loss: 0.5133242
	speed: 0.0124s/iter; left time: 202.0442s
	iters: 2100, epoch: 13 | loss: 0.2818186
	speed: 0.0122s/iter; left time: 198.7897s
	iters: 2200, epoch: 13 | loss: 0.2596576
	speed: 0.0126s/iter; left time: 203.2912s
Epoch: 13 cost time: 30.22303032875061
Epoch: 13, Steps: 2293 | Train Loss: 0.4481025 Vali Loss: 0.4191639 Test Loss: 0.1644870
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.2541464
	speed: 0.0418s/iter; left time: 667.1944s
	iters: 200, epoch: 14 | loss: 0.3846759
	speed: 0.0075s/iter; left time: 118.2073s
	iters: 300, epoch: 14 | loss: 0.2813306
	speed: 0.0075s/iter; left time: 118.1008s
	iters: 400, epoch: 14 | loss: 0.2440387
	speed: 0.0076s/iter; left time: 119.2255s
	iters: 500, epoch: 14 | loss: 0.4891129
	speed: 0.0080s/iter; left time: 125.0294s
	iters: 600, epoch: 14 | loss: 0.2622663
	speed: 0.0072s/iter; left time: 111.5821s
	iters: 700, epoch: 14 | loss: 0.3942751
	speed: 0.0074s/iter; left time: 112.8778s
	iters: 800, epoch: 14 | loss: 0.3955008
	speed: 0.0070s/iter; left time: 106.2999s
	iters: 900, epoch: 14 | loss: 0.3771686
	speed: 0.0070s/iter; left time: 105.7312s
	iters: 1000, epoch: 14 | loss: 0.2444509
	speed: 0.0066s/iter; left time: 99.5552s
	iters: 1100, epoch: 14 | loss: 0.2448285
	speed: 0.0063s/iter; left time: 94.8539s
	iters: 1200, epoch: 14 | loss: 0.3793744
	speed: 0.0063s/iter; left time: 93.9133s
	iters: 1300, epoch: 14 | loss: 0.2586716
	speed: 0.0063s/iter; left time: 93.0802s
	iters: 1400, epoch: 14 | loss: 0.2587220
	speed: 0.0061s/iter; left time: 89.9068s
	iters: 1500, epoch: 14 | loss: 0.7906034
	speed: 0.0066s/iter; left time: 95.8942s
	iters: 1600, epoch: 14 | loss: 0.5132553
	speed: 0.0065s/iter; left time: 93.9092s
	iters: 1700, epoch: 14 | loss: 0.2407698
	speed: 0.0067s/iter; left time: 96.0687s
	iters: 1800, epoch: 14 | loss: 0.3582246
	speed: 0.0063s/iter; left time: 89.5882s
	iters: 1900, epoch: 14 | loss: 0.6513512
	speed: 0.0064s/iter; left time: 89.9051s
	iters: 2000, epoch: 14 | loss: 0.3998316
	speed: 0.0061s/iter; left time: 85.8712s
	iters: 2100, epoch: 14 | loss: 0.2473820
	speed: 0.0063s/iter; left time: 87.5678s
	iters: 2200, epoch: 14 | loss: 0.1941468
	speed: 0.0065s/iter; left time: 89.8551s
Epoch: 14 cost time: 15.655977487564087
Epoch: 14, Steps: 2293 | Train Loss: 0.4480681 Vali Loss: 0.4202383 Test Loss: 0.1645139
EarlyStopping counter: 3 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 2.1729908
	speed: 0.0261s/iter; left time: 356.5142s
	iters: 200, epoch: 15 | loss: 0.3316486
	speed: 0.0059s/iter; left time: 79.8749s
	iters: 300, epoch: 15 | loss: 0.7347010
	speed: 0.0059s/iter; left time: 78.8484s
	iters: 400, epoch: 15 | loss: 0.3478325
	speed: 0.0059s/iter; left time: 78.8404s
	iters: 500, epoch: 15 | loss: 0.3031898
	speed: 0.0058s/iter; left time: 77.3653s
	iters: 600, epoch: 15 | loss: 0.3945182
	speed: 0.0059s/iter; left time: 77.4319s
	iters: 700, epoch: 15 | loss: 0.6169463
	speed: 0.0060s/iter; left time: 78.1307s
	iters: 800, epoch: 15 | loss: 0.7192683
	speed: 0.0059s/iter; left time: 76.1508s
	iters: 900, epoch: 15 | loss: 0.2443996
	speed: 0.0064s/iter; left time: 82.1462s
	iters: 1000, epoch: 15 | loss: 0.3555988
	speed: 0.0064s/iter; left time: 82.2461s
	iters: 1100, epoch: 15 | loss: 0.3324564
	speed: 0.0067s/iter; left time: 85.2023s
	iters: 1200, epoch: 15 | loss: 0.4003621
	speed: 0.0065s/iter; left time: 81.6548s
	iters: 1300, epoch: 15 | loss: 0.3056940
	speed: 0.0067s/iter; left time: 82.8845s
	iters: 1400, epoch: 15 | loss: 0.3026520
	speed: 0.0067s/iter; left time: 82.8147s
	iters: 1500, epoch: 15 | loss: 2.0654910
	speed: 0.0067s/iter; left time: 82.3825s
	iters: 1600, epoch: 15 | loss: 0.4597141
	speed: 0.0065s/iter; left time: 79.6385s
	iters: 1700, epoch: 15 | loss: 0.1863487
	speed: 0.0061s/iter; left time: 73.1100s
	iters: 1800, epoch: 15 | loss: 0.2797083
	speed: 0.0061s/iter; left time: 72.5066s
	iters: 1900, epoch: 15 | loss: 0.4885250
	speed: 0.0064s/iter; left time: 75.4992s
	iters: 2000, epoch: 15 | loss: 0.2470129
	speed: 0.0065s/iter; left time: 76.7795s
	iters: 2100, epoch: 15 | loss: 0.2824090
	speed: 0.0060s/iter; left time: 70.3771s
	iters: 2200, epoch: 15 | loss: 0.3403741
	speed: 0.0065s/iter; left time: 75.3834s
Epoch: 15 cost time: 14.280906915664673
Epoch: 15, Steps: 2293 | Train Loss: 0.4480495 Vali Loss: 0.4204485 Test Loss: 0.1645090
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.2900968
	speed: 0.0262s/iter; left time: 297.8211s
	iters: 200, epoch: 16 | loss: 0.3851451
	speed: 0.0061s/iter; left time: 69.1267s
	iters: 300, epoch: 16 | loss: 0.3299846
	speed: 0.0059s/iter; left time: 65.6427s
	iters: 400, epoch: 16 | loss: 0.4418751
	speed: 0.0061s/iter; left time: 67.3184s
	iters: 500, epoch: 16 | loss: 0.3146727
	speed: 0.0062s/iter; left time: 68.3228s
	iters: 600, epoch: 16 | loss: 0.2934290
	speed: 0.0062s/iter; left time: 67.0799s
	iters: 700, epoch: 16 | loss: 0.4397286
	speed: 0.0060s/iter; left time: 64.4450s
	iters: 800, epoch: 16 | loss: 0.4094164
	speed: 0.0063s/iter; left time: 67.1810s
	iters: 900, epoch: 16 | loss: 0.3543431
	speed: 0.0060s/iter; left time: 63.8946s
	iters: 1000, epoch: 16 | loss: 0.4858573
	speed: 0.0060s/iter; left time: 63.0944s
	iters: 1100, epoch: 16 | loss: 0.5022426
	speed: 0.0060s/iter; left time: 62.5039s
	iters: 1200, epoch: 16 | loss: 0.2519746
	speed: 0.0060s/iter; left time: 61.1436s
	iters: 1300, epoch: 16 | loss: 2.2286062
	speed: 0.0058s/iter; left time: 59.2666s
	iters: 1400, epoch: 16 | loss: 0.4870156
	speed: 0.0059s/iter; left time: 59.3347s
	iters: 1500, epoch: 16 | loss: 0.2521002
	speed: 0.0060s/iter; left time: 59.4729s
	iters: 1600, epoch: 16 | loss: 0.3788696
	speed: 0.0059s/iter; left time: 58.6528s
	iters: 1700, epoch: 16 | loss: 0.2817989
	speed: 0.0059s/iter; left time: 57.2513s
	iters: 1800, epoch: 16 | loss: 0.3168003
	speed: 0.0060s/iter; left time: 57.8504s
	iters: 1900, epoch: 16 | loss: 0.4593333
	speed: 0.0060s/iter; left time: 57.3301s
	iters: 2000, epoch: 16 | loss: 0.4353082
	speed: 0.0061s/iter; left time: 57.4381s
	iters: 2100, epoch: 16 | loss: 0.3043988
	speed: 0.0060s/iter; left time: 55.8541s
	iters: 2200, epoch: 16 | loss: 0.2458462
	speed: 0.0059s/iter; left time: 55.0623s
Epoch: 16 cost time: 13.841180086135864
Epoch: 16, Steps: 2293 | Train Loss: 0.4479615 Vali Loss: 0.4204266 Test Loss: 0.1645101
EarlyStopping counter: 5 out of 5
Early stopping
Total training time: 998.3421 seconds
>>>>>>>testing : weather_96_96_NLinear_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed12890<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
mse:0.16463932394981384, mae:0.20899440348148346
