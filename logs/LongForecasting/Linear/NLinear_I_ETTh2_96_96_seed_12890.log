Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTh2', data_path='ETTh2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.05, loss='mse', lradj='type1', model='NLinear', model_id='ETTh2_96_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=12890, seq_len=96, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTh2_96_96_NLinear_ETTh2_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed12890>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8449
data_set:  <data_provider.data_loader.Dataset_ETT_hour object at 0x000002415A130D68>
val 2785
data_set:  <data_provider.data_loader.Dataset_ETT_hour object at 0x0000024127727DD8>
test 2785
data_set:  <data_provider.data_loader.Dataset_ETT_hour object at 0x000002415A130128>
Total number of trainable parameters: 65184
Total number of parameters: 65184
	iters: 100, epoch: 1 | loss: 0.7675426
	speed: 0.0032s/iter; left time: 33.1344s
	iters: 200, epoch: 1 | loss: 4.6723380
	speed: 0.0028s/iter; left time: 29.2508s
	iters: 300, epoch: 1 | loss: 0.6439207
	speed: 0.0039s/iter; left time: 39.5272s
	iters: 400, epoch: 1 | loss: 1.0445321
	speed: 0.0030s/iter; left time: 30.3272s
	iters: 500, epoch: 1 | loss: 3.9068375
	speed: 0.0030s/iter; left time: 29.7075s
Epoch: 1 cost time: 1.6716666221618652
Epoch: 1, Steps: 528 | Train Loss: 1.5231702 Vali Loss: 0.5297604 Test Loss: 0.7609959
Validation loss decreased (inf --> 0.529760).  Saving model ...
Updating learning rate to 0.05
	iters: 100, epoch: 2 | loss: 0.8347310
	speed: 0.0079s/iter; left time: 78.2451s
	iters: 200, epoch: 2 | loss: 1.2755071
	speed: 0.0031s/iter; left time: 30.8082s
	iters: 300, epoch: 2 | loss: 3.0765991
	speed: 0.0032s/iter; left time: 31.5321s
	iters: 400, epoch: 2 | loss: 3.7796111
	speed: 0.0032s/iter; left time: 31.2975s
	iters: 500, epoch: 2 | loss: 1.7144578
	speed: 0.0029s/iter; left time: 27.4886s
Epoch: 2 cost time: 1.6102678775787354
Epoch: 2, Steps: 528 | Train Loss: 1.6521153 Vali Loss: 0.6570223 Test Loss: 1.0158781
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.025
	iters: 100, epoch: 3 | loss: 0.3032185
	speed: 0.0062s/iter; left time: 58.1328s
	iters: 200, epoch: 3 | loss: 0.2549355
	speed: 0.0033s/iter; left time: 30.5055s
	iters: 300, epoch: 3 | loss: 0.2395888
	speed: 0.0031s/iter; left time: 28.7955s
	iters: 400, epoch: 3 | loss: 0.3932111
	speed: 0.0030s/iter; left time: 26.9522s
	iters: 500, epoch: 3 | loss: 0.4570901
	speed: 0.0027s/iter; left time: 24.1363s
Epoch: 3 cost time: 1.5028388500213623
Epoch: 3, Steps: 528 | Train Loss: 0.6229978 Vali Loss: 0.4120560 Test Loss: 0.5763807
Validation loss decreased (0.529760 --> 0.412056).  Saving model ...
Updating learning rate to 0.0125
	iters: 100, epoch: 4 | loss: 1.0282146
	speed: 0.0072s/iter; left time: 63.8619s
	iters: 200, epoch: 4 | loss: 0.8045840
	speed: 0.0039s/iter; left time: 34.6159s
	iters: 300, epoch: 4 | loss: 0.2654459
	speed: 0.0035s/iter; left time: 30.6584s
	iters: 400, epoch: 4 | loss: 0.1598897
	speed: 0.0028s/iter; left time: 24.0979s
	iters: 500, epoch: 4 | loss: 1.3135383
	speed: 0.0037s/iter; left time: 31.2876s
Epoch: 4 cost time: 1.7566757202148438
Epoch: 4, Steps: 528 | Train Loss: 0.4876976 Vali Loss: 0.2476829 Test Loss: 0.3433957
Validation loss decreased (0.412056 --> 0.247683).  Saving model ...
Updating learning rate to 0.00625
	iters: 100, epoch: 5 | loss: 0.7265758
	speed: 0.0082s/iter; left time: 68.6579s
	iters: 200, epoch: 5 | loss: 0.2197549
	speed: 0.0028s/iter; left time: 22.8812s
	iters: 300, epoch: 5 | loss: 0.1819159
	speed: 0.0025s/iter; left time: 20.0310s
	iters: 400, epoch: 5 | loss: 0.2809339
	speed: 0.0031s/iter; left time: 24.6600s
	iters: 500, epoch: 5 | loss: 0.3925119
	speed: 0.0026s/iter; left time: 20.6868s
Epoch: 5 cost time: 1.479254961013794
Epoch: 5, Steps: 528 | Train Loss: 0.4481920 Vali Loss: 0.2287478 Test Loss: 0.3262114
Validation loss decreased (0.247683 --> 0.228748).  Saving model ...
Updating learning rate to 0.003125
	iters: 100, epoch: 6 | loss: 0.9409670
	speed: 0.0089s/iter; left time: 69.6770s
	iters: 200, epoch: 6 | loss: 0.5561393
	speed: 0.0023s/iter; left time: 18.0858s
	iters: 300, epoch: 6 | loss: 0.4112942
	speed: 0.0023s/iter; left time: 17.8702s
	iters: 400, epoch: 6 | loss: 0.3078217
	speed: 0.0022s/iter; left time: 16.4563s
	iters: 500, epoch: 6 | loss: 0.6559699
	speed: 0.0027s/iter; left time: 19.7058s
Epoch: 6 cost time: 1.2772212028503418
Epoch: 6, Steps: 528 | Train Loss: 0.4237413 Vali Loss: 0.2135463 Test Loss: 0.2983136
Validation loss decreased (0.228748 --> 0.213546).  Saving model ...
Updating learning rate to 0.0015625
	iters: 100, epoch: 7 | loss: 0.2959079
	speed: 0.0077s/iter; left time: 55.8167s
	iters: 200, epoch: 7 | loss: 0.2482297
	speed: 0.0028s/iter; left time: 20.2348s
	iters: 300, epoch: 7 | loss: 0.4233162
	speed: 0.0025s/iter; left time: 17.7265s
	iters: 400, epoch: 7 | loss: 0.2113985
	speed: 0.0036s/iter; left time: 25.1483s
	iters: 500, epoch: 7 | loss: 0.2009678
	speed: 0.0023s/iter; left time: 16.1348s
Epoch: 7 cost time: 1.4915359020233154
Epoch: 7, Steps: 528 | Train Loss: 0.4130780 Vali Loss: 0.2112095 Test Loss: 0.2955817
Validation loss decreased (0.213546 --> 0.211210).  Saving model ...
Updating learning rate to 0.00078125
	iters: 100, epoch: 8 | loss: 0.2920496
	speed: 0.0080s/iter; left time: 53.9312s
	iters: 200, epoch: 8 | loss: 0.3311602
	speed: 0.0026s/iter; left time: 17.3186s
	iters: 300, epoch: 8 | loss: 0.3704987
	speed: 0.0027s/iter; left time: 17.9751s
	iters: 400, epoch: 8 | loss: 0.4801369
	speed: 0.0025s/iter; left time: 15.9815s
	iters: 500, epoch: 8 | loss: 0.3229620
	speed: 0.0030s/iter; left time: 18.9306s
Epoch: 8 cost time: 1.4241108894348145
Epoch: 8, Steps: 528 | Train Loss: 0.4088394 Vali Loss: 0.2116171 Test Loss: 0.2917889
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.000390625
	iters: 100, epoch: 9 | loss: 0.1550172
	speed: 0.0075s/iter; left time: 46.7495s
	iters: 200, epoch: 9 | loss: 0.9310623
	speed: 0.0023s/iter; left time: 14.4124s
	iters: 300, epoch: 9 | loss: 0.3629502
	speed: 0.0023s/iter; left time: 14.1461s
	iters: 400, epoch: 9 | loss: 0.9154772
	speed: 0.0027s/iter; left time: 15.7457s
	iters: 500, epoch: 9 | loss: 0.3153841
	speed: 0.0027s/iter; left time: 15.5024s
Epoch: 9 cost time: 1.4059476852416992
Epoch: 9, Steps: 528 | Train Loss: 0.4040614 Vali Loss: 0.2102240 Test Loss: 0.2905706
Validation loss decreased (0.211210 --> 0.210224).  Saving model ...
Updating learning rate to 0.0001953125
	iters: 100, epoch: 10 | loss: 0.3662149
	speed: 0.0077s/iter; left time: 43.7386s
	iters: 200, epoch: 10 | loss: 0.5052068
	speed: 0.0030s/iter; left time: 16.6151s
	iters: 300, epoch: 10 | loss: 0.9858650
	speed: 0.0025s/iter; left time: 13.7912s
	iters: 400, epoch: 10 | loss: 0.2965615
	speed: 0.0038s/iter; left time: 20.2978s
	iters: 500, epoch: 10 | loss: 0.1750330
	speed: 0.0029s/iter; left time: 15.2207s
Epoch: 10 cost time: 1.533782720565796
Epoch: 10, Steps: 528 | Train Loss: 0.4028525 Vali Loss: 0.2096596 Test Loss: 0.2904946
Validation loss decreased (0.210224 --> 0.209660).  Saving model ...
Updating learning rate to 9.765625e-05
	iters: 100, epoch: 11 | loss: 0.2767123
	speed: 0.0078s/iter; left time: 40.1758s
	iters: 200, epoch: 11 | loss: 0.2507945
	speed: 0.0031s/iter; left time: 15.9005s
	iters: 300, epoch: 11 | loss: 0.3489566
	speed: 0.0023s/iter; left time: 11.6750s
	iters: 400, epoch: 11 | loss: 0.3907850
	speed: 0.0031s/iter; left time: 15.2271s
	iters: 500, epoch: 11 | loss: 0.7682304
	speed: 0.0030s/iter; left time: 14.1901s
Epoch: 11 cost time: 1.5154523849487305
Epoch: 11, Steps: 528 | Train Loss: 0.4015806 Vali Loss: 0.2105879 Test Loss: 0.2899172
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.8828125e-05
	iters: 100, epoch: 12 | loss: 0.2986906
	speed: 0.0072s/iter; left time: 33.4632s
	iters: 200, epoch: 12 | loss: 0.3264755
	speed: 0.0023s/iter; left time: 10.6538s
	iters: 300, epoch: 12 | loss: 0.2297973
	speed: 0.0022s/iter; left time: 9.7509s
	iters: 400, epoch: 12 | loss: 0.6403043
	speed: 0.0034s/iter; left time: 14.9700s
	iters: 500, epoch: 12 | loss: 0.1563279
	speed: 0.0023s/iter; left time: 9.9590s
Epoch: 12 cost time: 1.3593246936798096
Epoch: 12, Steps: 528 | Train Loss: 0.4011193 Vali Loss: 0.2104519 Test Loss: 0.2905206
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.44140625e-05
	iters: 100, epoch: 13 | loss: 0.4400512
	speed: 0.0062s/iter; left time: 25.7796s
	iters: 200, epoch: 13 | loss: 0.4032626
	speed: 0.0023s/iter; left time: 9.4338s
	iters: 300, epoch: 13 | loss: 0.2996930
	speed: 0.0023s/iter; left time: 9.2102s
	iters: 400, epoch: 13 | loss: 0.5752767
	speed: 0.0034s/iter; left time: 13.1415s
	iters: 500, epoch: 13 | loss: 0.2624513
	speed: 0.0025s/iter; left time: 9.3141s
Epoch: 13 cost time: 1.4216065406799316
Epoch: 13, Steps: 528 | Train Loss: 0.4008900 Vali Loss: 0.2100396 Test Loss: 0.2903344
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.220703125e-05
	iters: 100, epoch: 14 | loss: 0.3451521
	speed: 0.0070s/iter; left time: 25.2963s
	iters: 200, epoch: 14 | loss: 0.3048930
	speed: 0.0031s/iter; left time: 10.9348s
	iters: 300, epoch: 14 | loss: 0.2866310
	speed: 0.0027s/iter; left time: 9.0045s
	iters: 400, epoch: 14 | loss: 0.2855898
	speed: 0.0030s/iter; left time: 9.7874s
	iters: 500, epoch: 14 | loss: 0.5174673
	speed: 0.0025s/iter; left time: 7.9991s
Epoch: 14 cost time: 1.4686920642852783
Epoch: 14, Steps: 528 | Train Loss: 0.4005206 Vali Loss: 0.2098646 Test Loss: 0.2899987
EarlyStopping counter: 4 out of 5
Updating learning rate to 6.103515625e-06
	iters: 100, epoch: 15 | loss: 0.1824473
	speed: 0.0091s/iter; left time: 27.8211s
	iters: 200, epoch: 15 | loss: 0.1526244
	speed: 0.0025s/iter; left time: 7.4086s
	iters: 300, epoch: 15 | loss: 0.4192317
	speed: 0.0020s/iter; left time: 5.8299s
	iters: 400, epoch: 15 | loss: 0.1835205
	speed: 0.0028s/iter; left time: 7.7906s
	iters: 500, epoch: 15 | loss: 0.2837703
	speed: 0.0028s/iter; left time: 7.5050s
Epoch: 15 cost time: 1.3900814056396484
Epoch: 15, Steps: 528 | Train Loss: 0.4005344 Vali Loss: 0.2099093 Test Loss: 0.2899266
EarlyStopping counter: 5 out of 5
Early stopping
Total training time: 28.2657 seconds
>>>>>>>testing : ETTh2_96_96_NLinear_ETTh2_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed12890<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
data_set:  <data_provider.data_loader.Dataset_ETT_hour object at 0x000002411CB91080>
mse:0.2915162742137909, mae:0.34191960096359253
