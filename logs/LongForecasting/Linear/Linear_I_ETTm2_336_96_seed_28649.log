Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='Linear', model_id='ETTm2_336_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=28649, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTm2_336_96_Linear_ETTm2_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed28649>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34129
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.3813833
	speed: 0.0043s/iter; left time: 92.1108s
	iters: 200, epoch: 1 | loss: 0.3884278
	speed: 0.0034s/iter; left time: 72.0231s
	iters: 300, epoch: 1 | loss: 0.3605019
	speed: 0.0035s/iter; left time: 74.0541s
	iters: 400, epoch: 1 | loss: 0.1561820
	speed: 0.0036s/iter; left time: 74.6542s
	iters: 500, epoch: 1 | loss: 1.1302137
	speed: 0.0033s/iter; left time: 68.9175s
	iters: 600, epoch: 1 | loss: 0.3609664
	speed: 0.0030s/iter; left time: 61.5865s
	iters: 700, epoch: 1 | loss: 0.1692763
	speed: 0.0037s/iter; left time: 77.1228s
	iters: 800, epoch: 1 | loss: 0.3307121
	speed: 0.0041s/iter; left time: 83.9306s
	iters: 900, epoch: 1 | loss: 0.3267015
	speed: 0.0044s/iter; left time: 89.9191s
	iters: 1000, epoch: 1 | loss: 0.3092825
	speed: 0.0043s/iter; left time: 87.7867s
Epoch: 1 cost time: 3.9749741554260254
Epoch: 1, Steps: 1066 | Train Loss: 0.4088804 Vali Loss: 0.5592889 Test Loss: 1.5269625
Validation loss decreased (inf --> 0.559289).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.3674428
	speed: 0.0150s/iter; left time: 302.0235s
	iters: 200, epoch: 2 | loss: 0.4858002
	speed: 0.0044s/iter; left time: 88.8437s
	iters: 300, epoch: 2 | loss: 0.2933033
	speed: 0.0047s/iter; left time: 94.6569s
	iters: 400, epoch: 2 | loss: 0.1344934
	speed: 0.0042s/iter; left time: 84.1776s
	iters: 500, epoch: 2 | loss: 0.2203370
	speed: 0.0043s/iter; left time: 84.1941s
	iters: 600, epoch: 2 | loss: 0.2594666
	speed: 0.0043s/iter; left time: 83.7362s
	iters: 700, epoch: 2 | loss: 0.5490677
	speed: 0.0042s/iter; left time: 82.5220s
	iters: 800, epoch: 2 | loss: 0.2763077
	speed: 0.0042s/iter; left time: 82.1512s
	iters: 900, epoch: 2 | loss: 0.3917129
	speed: 0.0033s/iter; left time: 64.4608s
	iters: 1000, epoch: 2 | loss: 0.6878661
	speed: 0.0040s/iter; left time: 77.4386s
Epoch: 2 cost time: 4.36821436882019
Epoch: 2, Steps: 1066 | Train Loss: 0.4106428 Vali Loss: 0.5050672 Test Loss: 1.4284407
Validation loss decreased (0.559289 --> 0.505067).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.4639891
	speed: 0.0164s/iter; left time: 312.1638s
	iters: 200, epoch: 3 | loss: 0.1272950
	speed: 0.0038s/iter; left time: 71.2716s
	iters: 300, epoch: 3 | loss: 0.2375227
	speed: 0.0038s/iter; left time: 71.2203s
	iters: 400, epoch: 3 | loss: 0.2933209
	speed: 0.0032s/iter; left time: 60.1242s
	iters: 500, epoch: 3 | loss: 0.3148490
	speed: 0.0034s/iter; left time: 63.2026s
	iters: 600, epoch: 3 | loss: 0.3658324
	speed: 0.0031s/iter; left time: 57.0683s
	iters: 700, epoch: 3 | loss: 0.2165373
	speed: 0.0037s/iter; left time: 67.4912s
	iters: 800, epoch: 3 | loss: 0.2128765
	speed: 0.0035s/iter; left time: 63.4781s
	iters: 900, epoch: 3 | loss: 0.4461005
	speed: 0.0039s/iter; left time: 71.1443s
	iters: 1000, epoch: 3 | loss: 0.4876049
	speed: 0.0039s/iter; left time: 70.3915s
Epoch: 3 cost time: 3.836024761199951
Epoch: 3, Steps: 1066 | Train Loss: 0.2588611 Vali Loss: 0.2783511 Test Loss: 0.6577576
Validation loss decreased (0.505067 --> 0.278351).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.1811460
	speed: 0.0168s/iter; left time: 302.3291s
	iters: 200, epoch: 4 | loss: 0.1440312
	speed: 0.0039s/iter; left time: 69.7203s
	iters: 300, epoch: 4 | loss: 0.3209528
	speed: 0.0039s/iter; left time: 68.6613s
	iters: 400, epoch: 4 | loss: 0.2794324
	speed: 0.0041s/iter; left time: 72.3030s
	iters: 500, epoch: 4 | loss: 0.2361247
	speed: 0.0047s/iter; left time: 83.3890s
	iters: 600, epoch: 4 | loss: 0.3317180
	speed: 0.0041s/iter; left time: 71.8444s
	iters: 700, epoch: 4 | loss: 0.2047826
	speed: 0.0038s/iter; left time: 66.4319s
	iters: 800, epoch: 4 | loss: 0.1708107
	speed: 0.0046s/iter; left time: 79.1748s
	iters: 900, epoch: 4 | loss: 0.1319671
	speed: 0.0049s/iter; left time: 84.0483s
	iters: 1000, epoch: 4 | loss: 0.3419750
	speed: 0.0042s/iter; left time: 72.3153s
Epoch: 4 cost time: 4.559147596359253
Epoch: 4, Steps: 1066 | Train Loss: 0.2301848 Vali Loss: 0.2007870 Test Loss: 0.3726757
Validation loss decreased (0.278351 --> 0.200787).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.3447072
	speed: 0.0188s/iter; left time: 318.5290s
	iters: 200, epoch: 5 | loss: 0.2101153
	speed: 0.0050s/iter; left time: 83.7515s
	iters: 300, epoch: 5 | loss: 0.2897260
	speed: 0.0049s/iter; left time: 82.3171s
	iters: 400, epoch: 5 | loss: 0.2195105
	speed: 0.0050s/iter; left time: 83.2850s
	iters: 500, epoch: 5 | loss: 0.4576430
	speed: 0.0050s/iter; left time: 82.8367s
	iters: 600, epoch: 5 | loss: 0.1788673
	speed: 0.0042s/iter; left time: 68.9639s
	iters: 700, epoch: 5 | loss: 0.1892973
	speed: 0.0044s/iter; left time: 71.6822s
	iters: 800, epoch: 5 | loss: 0.3117363
	speed: 0.0043s/iter; left time: 69.9051s
	iters: 900, epoch: 5 | loss: 0.1911982
	speed: 0.0042s/iter; left time: 68.3513s
	iters: 1000, epoch: 5 | loss: 0.2498995
	speed: 0.0039s/iter; left time: 62.8109s
Epoch: 5 cost time: 4.8551344871521
Epoch: 5, Steps: 1066 | Train Loss: 0.2164149 Vali Loss: 0.1403238 Test Loss: 0.2196403
Validation loss decreased (0.200787 --> 0.140324).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.2991274
	speed: 0.0184s/iter; left time: 292.6562s
	iters: 200, epoch: 6 | loss: 0.1574262
	speed: 0.0047s/iter; left time: 73.4283s
	iters: 300, epoch: 6 | loss: 0.2352801
	speed: 0.0042s/iter; left time: 65.1639s
	iters: 400, epoch: 6 | loss: 0.1656551
	speed: 0.0043s/iter; left time: 67.3535s
	iters: 500, epoch: 6 | loss: 0.2835332
	speed: 0.0037s/iter; left time: 57.7810s
	iters: 600, epoch: 6 | loss: 0.1619864
	speed: 0.0038s/iter; left time: 58.6800s
	iters: 700, epoch: 6 | loss: 0.2687116
	speed: 0.0041s/iter; left time: 63.3048s
	iters: 800, epoch: 6 | loss: 0.2489882
	speed: 0.0040s/iter; left time: 60.3354s
	iters: 900, epoch: 6 | loss: 0.1817212
	speed: 0.0042s/iter; left time: 63.0891s
	iters: 1000, epoch: 6 | loss: 0.2587744
	speed: 0.0044s/iter; left time: 66.5601s
Epoch: 6 cost time: 4.431350946426392
Epoch: 6, Steps: 1066 | Train Loss: 0.2078779 Vali Loss: 0.1461153 Test Loss: 0.2459889
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.1751259
	speed: 0.0171s/iter; left time: 253.4109s
	iters: 200, epoch: 7 | loss: 0.1658866
	speed: 0.0038s/iter; left time: 56.1293s
	iters: 300, epoch: 7 | loss: 0.3373735
	speed: 0.0039s/iter; left time: 57.1910s
	iters: 400, epoch: 7 | loss: 0.1488488
	speed: 0.0038s/iter; left time: 55.4856s
	iters: 500, epoch: 7 | loss: 0.2175040
	speed: 0.0043s/iter; left time: 62.0687s
	iters: 600, epoch: 7 | loss: 0.1291467
	speed: 0.0040s/iter; left time: 57.3087s
	iters: 700, epoch: 7 | loss: 0.2544658
	speed: 0.0043s/iter; left time: 60.9253s
	iters: 800, epoch: 7 | loss: 0.1382596
	speed: 0.0040s/iter; left time: 56.7098s
	iters: 900, epoch: 7 | loss: 0.2187784
	speed: 0.0040s/iter; left time: 55.6794s
	iters: 1000, epoch: 7 | loss: 0.1255374
	speed: 0.0042s/iter; left time: 57.8251s
Epoch: 7 cost time: 4.3145527839660645
Epoch: 7, Steps: 1066 | Train Loss: 0.2045596 Vali Loss: 0.1626166 Test Loss: 0.2972488
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.1661191
	speed: 0.0169s/iter; left time: 232.2820s
	iters: 200, epoch: 8 | loss: 0.2023568
	speed: 0.0048s/iter; left time: 65.8651s
	iters: 300, epoch: 8 | loss: 0.1765104
	speed: 0.0044s/iter; left time: 59.5325s
	iters: 400, epoch: 8 | loss: 0.2218712
	speed: 0.0040s/iter; left time: 53.7415s
	iters: 500, epoch: 8 | loss: 0.2686349
	speed: 0.0042s/iter; left time: 56.5086s
	iters: 600, epoch: 8 | loss: 0.1613974
	speed: 0.0045s/iter; left time: 59.5727s
	iters: 700, epoch: 8 | loss: 0.1604652
	speed: 0.0046s/iter; left time: 60.9263s
	iters: 800, epoch: 8 | loss: 0.1736131
	speed: 0.0042s/iter; left time: 55.1334s
	iters: 900, epoch: 8 | loss: 0.1441340
	speed: 0.0040s/iter; left time: 51.1921s
	iters: 1000, epoch: 8 | loss: 0.1542342
	speed: 0.0043s/iter; left time: 54.6511s
Epoch: 8 cost time: 4.5082879066467285
Epoch: 8, Steps: 1066 | Train Loss: 0.2017279 Vali Loss: 0.1295180 Test Loss: 0.2055719
Validation loss decreased (0.140324 --> 0.129518).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.2138998
	speed: 0.0211s/iter; left time: 267.5378s
	iters: 200, epoch: 9 | loss: 0.1546159
	speed: 0.0046s/iter; left time: 58.0605s
	iters: 300, epoch: 9 | loss: 0.1269929
	speed: 0.0045s/iter; left time: 56.2184s
	iters: 400, epoch: 9 | loss: 0.4246126
	speed: 0.0049s/iter; left time: 60.7528s
	iters: 500, epoch: 9 | loss: 0.1427784
	speed: 0.0050s/iter; left time: 61.6926s
	iters: 600, epoch: 9 | loss: 0.1871919
	speed: 0.0046s/iter; left time: 55.9949s
	iters: 700, epoch: 9 | loss: 0.2343990
	speed: 0.0047s/iter; left time: 56.4641s
	iters: 800, epoch: 9 | loss: 0.3133884
	speed: 0.0050s/iter; left time: 59.3895s
	iters: 900, epoch: 9 | loss: 0.1678051
	speed: 0.0040s/iter; left time: 47.8101s
	iters: 1000, epoch: 9 | loss: 0.1080293
	speed: 0.0040s/iter; left time: 46.8409s
Epoch: 9 cost time: 4.833935499191284
Epoch: 9, Steps: 1066 | Train Loss: 0.2006829 Vali Loss: 0.1334980 Test Loss: 0.2126758
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.1965271
	speed: 0.0160s/iter; left time: 185.9613s
	iters: 200, epoch: 10 | loss: 0.1368112
	speed: 0.0039s/iter; left time: 44.6260s
	iters: 300, epoch: 10 | loss: 0.2245684
	speed: 0.0036s/iter; left time: 41.0228s
	iters: 400, epoch: 10 | loss: 0.1187667
	speed: 0.0033s/iter; left time: 37.6056s
	iters: 500, epoch: 10 | loss: 0.2378519
	speed: 0.0036s/iter; left time: 40.7868s
	iters: 600, epoch: 10 | loss: 0.1834820
	speed: 0.0045s/iter; left time: 50.6183s
	iters: 700, epoch: 10 | loss: 0.2471100
	speed: 0.0046s/iter; left time: 51.1943s
	iters: 800, epoch: 10 | loss: 0.1939241
	speed: 0.0046s/iter; left time: 50.7078s
	iters: 900, epoch: 10 | loss: 0.1120283
	speed: 0.0048s/iter; left time: 52.2220s
	iters: 1000, epoch: 10 | loss: 0.1225437
	speed: 0.0040s/iter; left time: 43.1224s
Epoch: 10 cost time: 4.3971216678619385
Epoch: 10, Steps: 1066 | Train Loss: 0.1998842 Vali Loss: 0.1418878 Test Loss: 0.2373518
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.1678478
	speed: 0.0182s/iter; left time: 192.6841s
	iters: 200, epoch: 11 | loss: 0.1620220
	speed: 0.0043s/iter; left time: 44.5639s
	iters: 300, epoch: 11 | loss: 0.1076996
	speed: 0.0038s/iter; left time: 39.8357s
	iters: 400, epoch: 11 | loss: 0.1903389
	speed: 0.0039s/iter; left time: 40.2282s
	iters: 500, epoch: 11 | loss: 0.1646328
	speed: 0.0043s/iter; left time: 43.4063s
	iters: 600, epoch: 11 | loss: 0.1424561
	speed: 0.0037s/iter; left time: 36.7416s
	iters: 700, epoch: 11 | loss: 0.1511320
	speed: 0.0040s/iter; left time: 39.7444s
	iters: 800, epoch: 11 | loss: 0.1194210
	speed: 0.0040s/iter; left time: 39.3838s
	iters: 900, epoch: 11 | loss: 0.1882183
	speed: 0.0040s/iter; left time: 38.7512s
	iters: 1000, epoch: 11 | loss: 0.1394054
	speed: 0.0041s/iter; left time: 39.4169s
Epoch: 11 cost time: 4.280949115753174
Epoch: 11, Steps: 1066 | Train Loss: 0.1995523 Vali Loss: 0.1353230 Test Loss: 0.2198073
EarlyStopping counter: 3 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.1929587
	speed: 0.0188s/iter; left time: 178.2837s
	iters: 200, epoch: 12 | loss: 0.1644815
	speed: 0.0046s/iter; left time: 43.4338s
	iters: 300, epoch: 12 | loss: 0.1898094
	speed: 0.0047s/iter; left time: 43.9540s
	iters: 400, epoch: 12 | loss: 0.1508402
	speed: 0.0047s/iter; left time: 43.6556s
	iters: 500, epoch: 12 | loss: 0.1440872
	speed: 0.0046s/iter; left time: 41.4732s
	iters: 600, epoch: 12 | loss: 0.3328368
	speed: 0.0045s/iter; left time: 40.8618s
	iters: 700, epoch: 12 | loss: 0.1296680
	speed: 0.0039s/iter; left time: 34.5157s
	iters: 800, epoch: 12 | loss: 0.1692439
	speed: 0.0041s/iter; left time: 35.7956s
	iters: 900, epoch: 12 | loss: 0.4650222
	speed: 0.0042s/iter; left time: 36.1896s
	iters: 1000, epoch: 12 | loss: 0.2731767
	speed: 0.0042s/iter; left time: 36.2751s
Epoch: 12 cost time: 4.634586572647095
Epoch: 12, Steps: 1066 | Train Loss: 0.1992322 Vali Loss: 0.1349292 Test Loss: 0.2193007
EarlyStopping counter: 4 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.1012717
	speed: 0.0165s/iter; left time: 138.9483s
	iters: 200, epoch: 13 | loss: 0.2158551
	speed: 0.0050s/iter; left time: 41.8948s
	iters: 300, epoch: 13 | loss: 0.2045203
	speed: 0.0047s/iter; left time: 38.2838s
	iters: 400, epoch: 13 | loss: 0.1744068
	speed: 0.0042s/iter; left time: 33.8167s
	iters: 500, epoch: 13 | loss: 0.1913969
	speed: 0.0043s/iter; left time: 34.6298s
	iters: 600, epoch: 13 | loss: 0.3229207
	speed: 0.0043s/iter; left time: 34.3326s
	iters: 700, epoch: 13 | loss: 0.2606442
	speed: 0.0043s/iter; left time: 33.8392s
	iters: 800, epoch: 13 | loss: 0.2992951
	speed: 0.0038s/iter; left time: 29.6022s
	iters: 900, epoch: 13 | loss: 0.0952938
	speed: 0.0035s/iter; left time: 26.7777s
	iters: 1000, epoch: 13 | loss: 0.1792398
	speed: 0.0033s/iter; left time: 24.8624s
Epoch: 13 cost time: 4.405188798904419
Epoch: 13, Steps: 1066 | Train Loss: 0.1991421 Vali Loss: 0.1304621 Test Loss: 0.2049221
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTm2_336_96_Linear_ETTm2_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed28649<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.20598828792572021, mae:0.29028570652008057
