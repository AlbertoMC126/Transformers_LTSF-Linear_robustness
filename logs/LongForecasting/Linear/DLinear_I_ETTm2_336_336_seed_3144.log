Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='DLinear', model_id='ETTm2_336_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=336, root_path='./dataset/', save_pred_values=False, seed=3144, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTm2_336_336_DLinear_ETTm2_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3144>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33889
val 11185
test 11185
	iters: 100, epoch: 1 | loss: 0.5756433
	speed: 0.0167s/iter; left time: 352.9569s
	iters: 200, epoch: 1 | loss: 0.8123870
	speed: 0.0158s/iter; left time: 331.9276s
	iters: 300, epoch: 1 | loss: 0.6288892
	speed: 0.0163s/iter; left time: 340.4778s
	iters: 400, epoch: 1 | loss: 0.8141566
	speed: 0.0161s/iter; left time: 334.3819s
	iters: 500, epoch: 1 | loss: 0.5511400
	speed: 0.0175s/iter; left time: 360.9384s
	iters: 600, epoch: 1 | loss: 0.5310403
	speed: 0.0163s/iter; left time: 335.9830s
	iters: 700, epoch: 1 | loss: 0.5981836
	speed: 0.0165s/iter; left time: 338.6389s
	iters: 800, epoch: 1 | loss: 0.6688083
	speed: 0.0166s/iter; left time: 338.9392s
	iters: 900, epoch: 1 | loss: 0.5940397
	speed: 0.0152s/iter; left time: 307.9282s
	iters: 1000, epoch: 1 | loss: 0.4743625
	speed: 0.0158s/iter; left time: 318.5511s
Epoch: 1 cost time: 17.295186042785645
Epoch: 1, Steps: 1059 | Train Loss: 0.6599810 Vali Loss: 0.5545356 Test Loss: 1.1651599
Validation loss decreased (inf --> 0.554536).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.5288906
	speed: 0.0592s/iter; left time: 1186.1525s
	iters: 200, epoch: 2 | loss: 0.9762400
	speed: 0.0181s/iter; left time: 359.9042s
	iters: 300, epoch: 2 | loss: 1.0613045
	speed: 0.0183s/iter; left time: 362.4239s
	iters: 400, epoch: 2 | loss: 0.4871807
	speed: 0.0167s/iter; left time: 328.8176s
	iters: 500, epoch: 2 | loss: 0.6818789
	speed: 0.0175s/iter; left time: 343.6755s
	iters: 600, epoch: 2 | loss: 0.4070027
	speed: 0.0182s/iter; left time: 355.0274s
	iters: 700, epoch: 2 | loss: 1.0557928
	speed: 0.0181s/iter; left time: 351.1040s
	iters: 800, epoch: 2 | loss: 0.3254471
	speed: 0.0161s/iter; left time: 311.5091s
	iters: 900, epoch: 2 | loss: 0.3814363
	speed: 0.0175s/iter; left time: 335.7516s
	iters: 1000, epoch: 2 | loss: 0.6646438
	speed: 0.0165s/iter; left time: 315.7863s
Epoch: 2 cost time: 18.111937999725342
Epoch: 2, Steps: 1059 | Train Loss: 0.6749521 Vali Loss: 0.4187348 Test Loss: 0.7024336
Validation loss decreased (0.554536 --> 0.418735).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.2927884
	speed: 0.0624s/iter; left time: 1183.8822s
	iters: 200, epoch: 3 | loss: 0.2986366
	speed: 0.0167s/iter; left time: 314.3440s
	iters: 300, epoch: 3 | loss: 0.3261836
	speed: 0.0172s/iter; left time: 323.3110s
	iters: 400, epoch: 3 | loss: 0.4274172
	speed: 0.0179s/iter; left time: 334.7811s
	iters: 500, epoch: 3 | loss: 0.3400022
	speed: 0.0171s/iter; left time: 316.6451s
	iters: 600, epoch: 3 | loss: 0.2056401
	speed: 0.0179s/iter; left time: 331.3662s
	iters: 700, epoch: 3 | loss: 0.5850472
	speed: 0.0177s/iter; left time: 325.0605s
	iters: 800, epoch: 3 | loss: 0.3683021
	speed: 0.0177s/iter; left time: 322.4583s
	iters: 900, epoch: 3 | loss: 0.3641762
	speed: 0.0165s/iter; left time: 300.3415s
	iters: 1000, epoch: 3 | loss: 0.6283919
	speed: 0.0175s/iter; left time: 315.4230s
Epoch: 3 cost time: 18.24440026283264
Epoch: 3, Steps: 1059 | Train Loss: 0.4609093 Vali Loss: 0.5637278 Test Loss: 1.3730769
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.2869548
	speed: 0.0666s/iter; left time: 1192.8326s
	iters: 200, epoch: 4 | loss: 0.3092889
	speed: 0.0145s/iter; left time: 258.2714s
	iters: 300, epoch: 4 | loss: 0.5675581
	speed: 0.0169s/iter; left time: 299.2718s
	iters: 400, epoch: 4 | loss: 0.2797493
	speed: 0.0176s/iter; left time: 310.1120s
	iters: 500, epoch: 4 | loss: 0.2624199
	speed: 0.0176s/iter; left time: 308.6999s
	iters: 600, epoch: 4 | loss: 0.5349762
	speed: 0.0182s/iter; left time: 317.1039s
	iters: 700, epoch: 4 | loss: 0.2643135
	speed: 0.0176s/iter; left time: 304.3545s
	iters: 800, epoch: 4 | loss: 0.2231049
	speed: 0.0179s/iter; left time: 307.6857s
	iters: 900, epoch: 4 | loss: 0.7196724
	speed: 0.0173s/iter; left time: 296.2121s
	iters: 1000, epoch: 4 | loss: 0.4942892
	speed: 0.0178s/iter; left time: 302.5659s
Epoch: 4 cost time: 18.143405437469482
Epoch: 4, Steps: 1059 | Train Loss: 0.4053726 Vali Loss: 0.3533087 Test Loss: 0.7130198
Validation loss decreased (0.418735 --> 0.353309).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.1976770
	speed: 0.0654s/iter; left time: 1102.4445s
	iters: 200, epoch: 5 | loss: 0.2030430
	speed: 0.0170s/iter; left time: 284.9205s
	iters: 300, epoch: 5 | loss: 0.1909590
	speed: 0.0182s/iter; left time: 303.5680s
	iters: 400, epoch: 5 | loss: 0.4141983
	speed: 0.0166s/iter; left time: 273.9347s
	iters: 500, epoch: 5 | loss: 0.2930603
	speed: 0.0174s/iter; left time: 286.9156s
	iters: 600, epoch: 5 | loss: 0.6121154
	speed: 0.0166s/iter; left time: 271.4620s
	iters: 700, epoch: 5 | loss: 0.3848840
	speed: 0.0169s/iter; left time: 274.1405s
	iters: 800, epoch: 5 | loss: 0.4928423
	speed: 0.0177s/iter; left time: 286.0431s
	iters: 900, epoch: 5 | loss: 0.5860927
	speed: 0.0163s/iter; left time: 261.6832s
	iters: 1000, epoch: 5 | loss: 0.4298220
	speed: 0.0172s/iter; left time: 274.4378s
Epoch: 5 cost time: 18.13919758796692
Epoch: 5, Steps: 1059 | Train Loss: 0.3802646 Vali Loss: 0.2331883 Test Loss: 0.3422026
Validation loss decreased (0.353309 --> 0.233188).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.3096662
	speed: 0.0652s/iter; left time: 1029.3562s
	iters: 200, epoch: 6 | loss: 0.5199535
	speed: 0.0170s/iter; left time: 266.1498s
	iters: 300, epoch: 6 | loss: 0.2556751
	speed: 0.0181s/iter; left time: 282.1383s
	iters: 400, epoch: 6 | loss: 0.2996177
	speed: 0.0165s/iter; left time: 256.1819s
	iters: 500, epoch: 6 | loss: 0.3977945
	speed: 0.0182s/iter; left time: 279.6271s
	iters: 600, epoch: 6 | loss: 0.5018385
	speed: 0.0173s/iter; left time: 264.9952s
	iters: 700, epoch: 6 | loss: 0.2745985
	speed: 0.0174s/iter; left time: 264.9386s
	iters: 800, epoch: 6 | loss: 0.2546898
	speed: 0.0171s/iter; left time: 257.7050s
	iters: 900, epoch: 6 | loss: 0.2741035
	speed: 0.0168s/iter; left time: 251.7143s
	iters: 1000, epoch: 6 | loss: 0.4799236
	speed: 0.0155s/iter; left time: 231.3933s
Epoch: 6 cost time: 17.807413339614868
Epoch: 6, Steps: 1059 | Train Loss: 0.3644092 Vali Loss: 0.2828062 Test Loss: 0.5137491
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.5181745
	speed: 0.0642s/iter; left time: 945.1456s
	iters: 200, epoch: 7 | loss: 0.3296253
	speed: 0.0172s/iter; left time: 251.7385s
	iters: 300, epoch: 7 | loss: 0.6357020
	speed: 0.0167s/iter; left time: 242.2017s
	iters: 400, epoch: 7 | loss: 0.3752471
	speed: 0.0168s/iter; left time: 242.8952s
	iters: 500, epoch: 7 | loss: 0.3458249
	speed: 0.0170s/iter; left time: 243.9380s
	iters: 600, epoch: 7 | loss: 0.5085428
	speed: 0.0155s/iter; left time: 220.2820s
	iters: 700, epoch: 7 | loss: 0.2537843
	speed: 0.0182s/iter; left time: 257.6707s
	iters: 800, epoch: 7 | loss: 0.5134364
	speed: 0.0176s/iter; left time: 247.2296s
	iters: 900, epoch: 7 | loss: 0.2673552
	speed: 0.0178s/iter; left time: 247.7453s
	iters: 1000, epoch: 7 | loss: 0.2835671
	speed: 0.0169s/iter; left time: 234.1335s
Epoch: 7 cost time: 18.007484674453735
Epoch: 7, Steps: 1059 | Train Loss: 0.3568438 Vali Loss: 0.2877486 Test Loss: 0.5284700
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.3281620
	speed: 0.0631s/iter; left time: 862.9521s
	iters: 200, epoch: 8 | loss: 0.4971074
	speed: 0.0170s/iter; left time: 231.2318s
	iters: 300, epoch: 8 | loss: 0.2191327
	speed: 0.0165s/iter; left time: 221.8801s
	iters: 400, epoch: 8 | loss: 0.4319369
	speed: 0.0162s/iter; left time: 217.1956s
	iters: 500, epoch: 8 | loss: 0.5406317
	speed: 0.0175s/iter; left time: 231.9531s
	iters: 600, epoch: 8 | loss: 0.2900245
	speed: 0.0166s/iter; left time: 218.0212s
	iters: 700, epoch: 8 | loss: 0.2668646
	speed: 0.0156s/iter; left time: 204.5037s
	iters: 800, epoch: 8 | loss: 0.2096927
	speed: 0.0140s/iter; left time: 181.3187s
	iters: 900, epoch: 8 | loss: 0.2224985
	speed: 0.0166s/iter; left time: 214.1818s
	iters: 1000, epoch: 8 | loss: 0.1811369
	speed: 0.0169s/iter; left time: 215.9685s
Epoch: 8 cost time: 17.23846173286438
Epoch: 8, Steps: 1059 | Train Loss: 0.3530242 Vali Loss: 0.3135218 Test Loss: 0.6168435
EarlyStopping counter: 3 out of 5
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.2944024
	speed: 0.0663s/iter; left time: 835.4354s
	iters: 200, epoch: 9 | loss: 0.5385026
	speed: 0.0169s/iter; left time: 211.6902s
	iters: 300, epoch: 9 | loss: 0.2136536
	speed: 0.0165s/iter; left time: 204.5427s
	iters: 400, epoch: 9 | loss: 0.2432956
	speed: 0.0176s/iter; left time: 216.1066s
	iters: 500, epoch: 9 | loss: 0.5407950
	speed: 0.0160s/iter; left time: 195.1789s
	iters: 600, epoch: 9 | loss: 0.5257778
	speed: 0.0186s/iter; left time: 225.1606s
	iters: 700, epoch: 9 | loss: 0.3144666
	speed: 0.0190s/iter; left time: 228.4621s
	iters: 800, epoch: 9 | loss: 0.4179725
	speed: 0.0173s/iter; left time: 206.5625s
	iters: 900, epoch: 9 | loss: 0.2449392
	speed: 0.0169s/iter; left time: 199.6491s
	iters: 1000, epoch: 9 | loss: 0.3105845
	speed: 0.0167s/iter; left time: 195.3521s
Epoch: 9 cost time: 18.180947303771973
Epoch: 9, Steps: 1059 | Train Loss: 0.3504502 Vali Loss: 0.3102571 Test Loss: 0.6171355
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.5053465
	speed: 0.0581s/iter; left time: 670.5037s
	iters: 200, epoch: 10 | loss: 0.3870932
	speed: 0.0176s/iter; left time: 201.4583s
	iters: 300, epoch: 10 | loss: 0.2937558
	speed: 0.0163s/iter; left time: 184.8299s
	iters: 400, epoch: 10 | loss: 0.2151974
	speed: 0.0181s/iter; left time: 203.2437s
	iters: 500, epoch: 10 | loss: 0.4242071
	speed: 0.0165s/iter; left time: 184.3296s
	iters: 600, epoch: 10 | loss: 0.3224863
	speed: 0.0182s/iter; left time: 201.2026s
	iters: 700, epoch: 10 | loss: 0.2291802
	speed: 0.0175s/iter; left time: 191.2352s
	iters: 800, epoch: 10 | loss: 0.3545684
	speed: 0.0180s/iter; left time: 195.0567s
	iters: 900, epoch: 10 | loss: 0.3259186
	speed: 0.0171s/iter; left time: 184.2806s
	iters: 1000, epoch: 10 | loss: 0.3465176
	speed: 0.0175s/iter; left time: 186.2064s
Epoch: 10 cost time: 18.172857522964478
Epoch: 10, Steps: 1059 | Train Loss: 0.3491244 Vali Loss: 0.2978484 Test Loss: 0.5775043
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTm2_336_336_DLinear_ETTm2_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3144<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
mse:0.34245166182518005, mae:0.3835587799549103
