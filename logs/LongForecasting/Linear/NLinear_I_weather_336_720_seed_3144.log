Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='NLinear', model_id='weather_336_720', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=720, root_path='./dataset/', save_pred_values=False, seed=3144, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : weather_336_720_NLinear_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3144>>>>>>>>>>>>>>>>>>>>>>>>>>
train 35832
val 4551
test 9820
	iters: 100, epoch: 1 | loss: 0.7971629
	speed: 0.0502s/iter; left time: 2241.2830s
	iters: 200, epoch: 1 | loss: 1.9543660
	speed: 0.0473s/iter; left time: 2108.9084s
	iters: 300, epoch: 1 | loss: 0.6254157
	speed: 0.0486s/iter; left time: 2160.5786s
	iters: 400, epoch: 1 | loss: 0.7425671
	speed: 0.0490s/iter; left time: 2175.6688s
	iters: 500, epoch: 1 | loss: 1.8368171
	speed: 0.0485s/iter; left time: 2148.5972s
	iters: 600, epoch: 1 | loss: 93.3678970
	speed: 0.0466s/iter; left time: 2059.1324s
	iters: 700, epoch: 1 | loss: 0.8160086
	speed: 0.0524s/iter; left time: 2310.1306s
	iters: 800, epoch: 1 | loss: 1.0288779
	speed: 0.0500s/iter; left time: 2199.6891s
	iters: 900, epoch: 1 | loss: 0.7602777
	speed: 0.0531s/iter; left time: 2329.9303s
	iters: 1000, epoch: 1 | loss: 0.8805012
	speed: 0.0508s/iter; left time: 2222.2077s
	iters: 1100, epoch: 1 | loss: 0.6578877
	speed: 0.0510s/iter; left time: 2227.7742s
	iters: 1200, epoch: 1 | loss: 0.9097718
	speed: 0.0494s/iter; left time: 2154.5449s
	iters: 1300, epoch: 1 | loss: 3.3366981
	speed: 0.0509s/iter; left time: 2211.5603s
	iters: 1400, epoch: 1 | loss: 1.1599996
	speed: 0.0519s/iter; left time: 2252.4835s
	iters: 1500, epoch: 1 | loss: 0.7854815
	speed: 0.0537s/iter; left time: 2325.4630s
	iters: 1600, epoch: 1 | loss: 0.6433895
	speed: 0.0535s/iter; left time: 2309.7191s
	iters: 1700, epoch: 1 | loss: 0.6330923
	speed: 0.0524s/iter; left time: 2256.3832s
	iters: 1800, epoch: 1 | loss: 0.6638181
	speed: 0.0484s/iter; left time: 2081.0859s
	iters: 1900, epoch: 1 | loss: 0.6555172
	speed: 0.0497s/iter; left time: 2131.7950s
	iters: 2000, epoch: 1 | loss: 0.5550265
	speed: 0.0471s/iter; left time: 2015.5817s
	iters: 2100, epoch: 1 | loss: 0.9380841
	speed: 0.0559s/iter; left time: 2385.2426s
	iters: 2200, epoch: 1 | loss: 1.0292362
	speed: 0.0535s/iter; left time: 2276.4381s
Epoch: 1 cost time: 113.25681328773499
Epoch: 1, Steps: 2239 | Train Loss: 3.0639141 Vali Loss: 9.7810392 Test Loss: 0.5486991
Validation loss decreased (inf --> 9.781039).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 3.1002965
	speed: 0.1463s/iter; left time: 6209.6011s
	iters: 200, epoch: 2 | loss: 1.4851528
	speed: 0.0508s/iter; left time: 2152.5874s
	iters: 300, epoch: 2 | loss: 1.0683869
	speed: 0.0497s/iter; left time: 2100.4798s
	iters: 400, epoch: 2 | loss: 7.1077652
	speed: 0.0539s/iter; left time: 2271.9557s
	iters: 500, epoch: 2 | loss: 0.9947430
	speed: 0.0510s/iter; left time: 2143.4901s
	iters: 600, epoch: 2 | loss: 1.1772443
	speed: 0.0519s/iter; left time: 2177.1665s
	iters: 700, epoch: 2 | loss: 0.9069443
	speed: 0.0535s/iter; left time: 2239.2558s
	iters: 800, epoch: 2 | loss: 2.2797160
	speed: 0.0484s/iter; left time: 2020.0184s
	iters: 900, epoch: 2 | loss: 0.9138541
	speed: 0.0511s/iter; left time: 2129.9825s
	iters: 1000, epoch: 2 | loss: 1.0166497
	speed: 0.0502s/iter; left time: 2086.0331s
	iters: 1100, epoch: 2 | loss: 0.7099808
	speed: 0.0521s/iter; left time: 2161.0049s
	iters: 1200, epoch: 2 | loss: 0.7320161
	speed: 0.0505s/iter; left time: 2086.3014s
	iters: 1300, epoch: 2 | loss: 0.6658102
	speed: 0.0439s/iter; left time: 1811.2461s
	iters: 1400, epoch: 2 | loss: 0.7530975
	speed: 0.0504s/iter; left time: 2072.7819s
	iters: 1500, epoch: 2 | loss: 1.6166101
	speed: 0.0501s/iter; left time: 2057.2970s
	iters: 1600, epoch: 2 | loss: 0.7121622
	speed: 0.0508s/iter; left time: 2079.2649s
	iters: 1700, epoch: 2 | loss: 2.6424029
	speed: 0.0557s/iter; left time: 2274.2735s
	iters: 1800, epoch: 2 | loss: 0.7011515
	speed: 0.0499s/iter; left time: 2031.9403s
	iters: 1900, epoch: 2 | loss: 18.6871681
	speed: 0.0517s/iter; left time: 2099.2539s
	iters: 2000, epoch: 2 | loss: 1.7451332
	speed: 0.0478s/iter; left time: 1937.0388s
	iters: 2100, epoch: 2 | loss: 0.7625562
	speed: 0.0476s/iter; left time: 1924.5450s
	iters: 2200, epoch: 2 | loss: 0.5593182
	speed: 0.0496s/iter; left time: 2000.8372s
Epoch: 2 cost time: 112.47728061676025
Epoch: 2, Steps: 2239 | Train Loss: 33.8023312 Vali Loss: 1.0559702 Test Loss: 0.4193819
Validation loss decreased (9.781039 --> 1.055970).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.5669788
	speed: 0.1521s/iter; left time: 6116.2287s
	iters: 200, epoch: 3 | loss: 0.5353536
	speed: 0.0469s/iter; left time: 1882.7828s
	iters: 300, epoch: 3 | loss: 0.8320383
	speed: 0.0507s/iter; left time: 2027.8533s
	iters: 400, epoch: 3 | loss: 0.5137112
	speed: 0.0501s/iter; left time: 2000.9534s
	iters: 500, epoch: 3 | loss: 2.0750406
	speed: 0.0526s/iter; left time: 2094.5988s
	iters: 600, epoch: 3 | loss: 0.7610630
	speed: 0.0508s/iter; left time: 2015.8120s
	iters: 700, epoch: 3 | loss: 0.6125929
	speed: 0.0520s/iter; left time: 2060.9823s
	iters: 800, epoch: 3 | loss: 0.7917404
	speed: 0.0494s/iter; left time: 1951.4191s
	iters: 900, epoch: 3 | loss: 0.9186231
	speed: 0.0525s/iter; left time: 2068.4738s
	iters: 1000, epoch: 3 | loss: 0.5377707
	speed: 0.0509s/iter; left time: 2001.7944s
	iters: 1100, epoch: 3 | loss: 0.5299782
	speed: 0.0501s/iter; left time: 1964.5947s
	iters: 1200, epoch: 3 | loss: 0.8133872
	speed: 0.0524s/iter; left time: 2050.7821s
	iters: 1300, epoch: 3 | loss: 0.5588968
	speed: 0.0458s/iter; left time: 1786.4223s
	iters: 1400, epoch: 3 | loss: 0.8814834
	speed: 0.0533s/iter; left time: 2073.0713s
	iters: 1500, epoch: 3 | loss: 0.9362093
	speed: 0.0503s/iter; left time: 1953.4627s
	iters: 1600, epoch: 3 | loss: 0.5884311
	speed: 0.0486s/iter; left time: 1879.9322s
	iters: 1700, epoch: 3 | loss: 0.5294234
	speed: 0.0488s/iter; left time: 1883.5876s
	iters: 1800, epoch: 3 | loss: 0.7385539
	speed: 0.0542s/iter; left time: 2086.2579s
	iters: 1900, epoch: 3 | loss: 0.6969661
	speed: 0.0498s/iter; left time: 1910.7527s
	iters: 2000, epoch: 3 | loss: 0.6108413
	speed: 0.0475s/iter; left time: 1820.0844s
	iters: 2100, epoch: 3 | loss: 0.8157629
	speed: 0.0529s/iter; left time: 2021.7799s
	iters: 2200, epoch: 3 | loss: 0.7863201
	speed: 0.0514s/iter; left time: 1958.9501s
Epoch: 3 cost time: 112.62474632263184
Epoch: 3, Steps: 2239 | Train Loss: 44.9546227 Vali Loss: 0.7204824 Test Loss: 0.3500875
Validation loss decreased (1.055970 --> 0.720482).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.9595550
	speed: 0.1628s/iter; left time: 6179.5397s
	iters: 200, epoch: 4 | loss: 1.2975136
	speed: 0.0532s/iter; left time: 2014.5859s
	iters: 300, epoch: 4 | loss: 0.5342841
	speed: 0.0475s/iter; left time: 1792.9020s
	iters: 400, epoch: 4 | loss: 1.0356163
	speed: 0.0514s/iter; left time: 1934.3082s
	iters: 500, epoch: 4 | loss: 0.9223344
	speed: 0.0481s/iter; left time: 1807.1096s
	iters: 600, epoch: 4 | loss: 1.0715240
	speed: 0.0506s/iter; left time: 1895.0715s
	iters: 700, epoch: 4 | loss: 1.3839198
	speed: 0.0527s/iter; left time: 1970.0105s
	iters: 800, epoch: 4 | loss: 0.8576335
	speed: 0.0484s/iter; left time: 1803.1047s
	iters: 900, epoch: 4 | loss: 0.6346319
	speed: 0.0526s/iter; left time: 1954.0819s
	iters: 1000, epoch: 4 | loss: 0.5340343
	speed: 0.0515s/iter; left time: 1909.7637s
	iters: 1100, epoch: 4 | loss: 0.5173360
	speed: 0.0520s/iter; left time: 1923.4302s
	iters: 1200, epoch: 4 | loss: 0.5343591
	speed: 0.0495s/iter; left time: 1825.8913s
	iters: 1300, epoch: 4 | loss: 0.4432459
	speed: 0.0497s/iter; left time: 1826.1313s
	iters: 1400, epoch: 4 | loss: 0.6489413
	speed: 0.0537s/iter; left time: 1970.0895s
	iters: 1500, epoch: 4 | loss: 0.8151552
	speed: 0.0483s/iter; left time: 1767.2015s
	iters: 1600, epoch: 4 | loss: 0.7893630
	speed: 0.0499s/iter; left time: 1820.2778s
	iters: 1700, epoch: 4 | loss: 0.5323993
	speed: 0.0537s/iter; left time: 1954.0196s
	iters: 1800, epoch: 4 | loss: 0.4907429
	speed: 0.0497s/iter; left time: 1801.8013s
	iters: 1900, epoch: 4 | loss: 0.6847640
	speed: 0.0446s/iter; left time: 1612.8249s
	iters: 2000, epoch: 4 | loss: 0.6008805
	speed: 0.0503s/iter; left time: 1812.5516s
	iters: 2100, epoch: 4 | loss: 0.4673440
	speed: 0.0460s/iter; left time: 1652.5490s
	iters: 2200, epoch: 4 | loss: 0.5612072
	speed: 0.0476s/iter; left time: 1706.0124s
Epoch: 4 cost time: 111.33367919921875
Epoch: 4, Steps: 2239 | Train Loss: 4.2172300 Vali Loss: 0.6807925 Test Loss: 0.3357855
Validation loss decreased (0.720482 --> 0.680793).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 1.1409732
	speed: 0.1609s/iter; left time: 5746.8516s
	iters: 200, epoch: 5 | loss: 0.4307875
	speed: 0.0450s/iter; left time: 1604.3370s
	iters: 300, epoch: 5 | loss: 0.8784452
	speed: 0.0500s/iter; left time: 1774.8463s
	iters: 400, epoch: 5 | loss: 1.0222230
	speed: 0.0475s/iter; left time: 1682.5896s
	iters: 500, epoch: 5 | loss: 0.7776409
	speed: 0.0525s/iter; left time: 1855.5182s
	iters: 600, epoch: 5 | loss: 0.8490628
	speed: 0.0512s/iter; left time: 1804.0386s
	iters: 700, epoch: 5 | loss: 0.5536899
	speed: 0.0486s/iter; left time: 1707.4479s
	iters: 800, epoch: 5 | loss: 0.4885068
	speed: 0.0478s/iter; left time: 1674.7359s
	iters: 900, epoch: 5 | loss: 0.5555174
	speed: 0.0519s/iter; left time: 1812.2525s
	iters: 1000, epoch: 5 | loss: 1.1501064
	speed: 0.0511s/iter; left time: 1778.7656s
	iters: 1100, epoch: 5 | loss: 0.5381513
	speed: 0.0500s/iter; left time: 1735.2947s
	iters: 1200, epoch: 5 | loss: 0.4436867
	speed: 0.0502s/iter; left time: 1739.3487s
	iters: 1300, epoch: 5 | loss: 1.1560271
	speed: 0.0503s/iter; left time: 1735.1793s
	iters: 1400, epoch: 5 | loss: 0.4653838
	speed: 0.0549s/iter; left time: 1888.4166s
	iters: 1500, epoch: 5 | loss: 0.5514825
	speed: 0.0532s/iter; left time: 1824.9006s
	iters: 1600, epoch: 5 | loss: 0.6757705
	speed: 0.0528s/iter; left time: 1805.9760s
	iters: 1700, epoch: 5 | loss: 0.4725426
	speed: 0.0503s/iter; left time: 1715.3552s
	iters: 1800, epoch: 5 | loss: 0.4379858
	speed: 0.0505s/iter; left time: 1718.7130s
	iters: 1900, epoch: 5 | loss: 0.8215205
	speed: 0.0486s/iter; left time: 1650.4119s
	iters: 2000, epoch: 5 | loss: 0.4595366
	speed: 0.0525s/iter; left time: 1775.8531s
	iters: 2100, epoch: 5 | loss: 0.5090106
	speed: 0.0548s/iter; left time: 1848.1251s
	iters: 2200, epoch: 5 | loss: 0.5782661
	speed: 0.0491s/iter; left time: 1651.7347s
Epoch: 5 cost time: 112.11464428901672
Epoch: 5, Steps: 2239 | Train Loss: 1.2457106 Vali Loss: 0.6613864 Test Loss: 0.3259934
Validation loss decreased (0.680793 --> 0.661386).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.6556439
	speed: 0.1565s/iter; left time: 5241.3664s
	iters: 200, epoch: 6 | loss: 0.5747558
	speed: 0.0481s/iter; left time: 1605.5238s
	iters: 300, epoch: 6 | loss: 0.5185497
	speed: 0.0481s/iter; left time: 1602.4528s
	iters: 400, epoch: 6 | loss: 0.6110881
	speed: 0.0496s/iter; left time: 1646.5973s
	iters: 500, epoch: 6 | loss: 0.5848472
	speed: 0.0522s/iter; left time: 1728.2235s
	iters: 600, epoch: 6 | loss: 0.7750669
	speed: 0.0539s/iter; left time: 1777.9925s
	iters: 700, epoch: 6 | loss: 0.5720279
	speed: 0.0546s/iter; left time: 1796.3883s
	iters: 800, epoch: 6 | loss: 0.5472849
	speed: 0.0519s/iter; left time: 1702.9670s
	iters: 900, epoch: 6 | loss: 0.7968364
	speed: 0.0492s/iter; left time: 1607.7423s
	iters: 1000, epoch: 6 | loss: 0.5852244
	speed: 0.0522s/iter; left time: 1700.2188s
	iters: 1100, epoch: 6 | loss: 0.8151159
	speed: 0.0499s/iter; left time: 1621.3918s
	iters: 1200, epoch: 6 | loss: 0.6440021
	speed: 0.0458s/iter; left time: 1483.1339s
	iters: 1300, epoch: 6 | loss: 0.7728918
	speed: 0.0417s/iter; left time: 1345.4288s
	iters: 1400, epoch: 6 | loss: 0.4751132
	speed: 0.0530s/iter; left time: 1705.4735s
	iters: 1500, epoch: 6 | loss: 0.4289369
	speed: 0.0492s/iter; left time: 1579.3323s
	iters: 1600, epoch: 6 | loss: 0.5492347
	speed: 0.0543s/iter; left time: 1736.0632s
	iters: 1700, epoch: 6 | loss: 0.4892331
	speed: 0.0513s/iter; left time: 1636.7107s
	iters: 1800, epoch: 6 | loss: 0.6598106
	speed: 0.0503s/iter; left time: 1598.1903s
	iters: 1900, epoch: 6 | loss: 0.5507114
	speed: 0.0540s/iter; left time: 1712.6158s
	iters: 2000, epoch: 6 | loss: 0.6895354
	speed: 0.0507s/iter; left time: 1601.8356s
	iters: 2100, epoch: 6 | loss: 0.5602539
	speed: 0.0499s/iter; left time: 1569.8292s
	iters: 2200, epoch: 6 | loss: 1.2938155
	speed: 0.0512s/iter; left time: 1607.0357s
Epoch: 6 cost time: 111.51473212242126
Epoch: 6, Steps: 2239 | Train Loss: 0.8200277 Vali Loss: 0.6588292 Test Loss: 0.3229432
Validation loss decreased (0.661386 --> 0.658829).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.5331266
	speed: 0.1614s/iter; left time: 5043.7560s
	iters: 200, epoch: 7 | loss: 0.4994769
	speed: 0.0436s/iter; left time: 1356.6891s
	iters: 300, epoch: 7 | loss: 0.5857232
	speed: 0.0505s/iter; left time: 1566.8924s
	iters: 400, epoch: 7 | loss: 0.5098884
	speed: 0.0519s/iter; left time: 1606.1458s
	iters: 500, epoch: 7 | loss: 0.4920736
	speed: 0.0486s/iter; left time: 1500.0635s
	iters: 600, epoch: 7 | loss: 0.9968593
	speed: 0.0492s/iter; left time: 1511.8903s
	iters: 700, epoch: 7 | loss: 1.0356023
	speed: 0.0549s/iter; left time: 1682.2257s
	iters: 800, epoch: 7 | loss: 0.4713317
	speed: 0.0527s/iter; left time: 1611.0533s
	iters: 900, epoch: 7 | loss: 0.4357281
	speed: 0.0506s/iter; left time: 1542.0894s
	iters: 1000, epoch: 7 | loss: 0.7038337
	speed: 0.0473s/iter; left time: 1435.0126s
	iters: 1100, epoch: 7 | loss: 0.8435968
	speed: 0.0477s/iter; left time: 1441.8945s
	iters: 1200, epoch: 7 | loss: 0.6218896
	speed: 0.0513s/iter; left time: 1545.5757s
	iters: 1300, epoch: 7 | loss: 0.4522620
	speed: 0.0464s/iter; left time: 1393.8909s
	iters: 1400, epoch: 7 | loss: 0.5609983
	speed: 0.0455s/iter; left time: 1361.9149s
	iters: 1500, epoch: 7 | loss: 0.7559200
	speed: 0.0474s/iter; left time: 1415.8531s
	iters: 1600, epoch: 7 | loss: 0.4674097
	speed: 0.0453s/iter; left time: 1347.4617s
	iters: 1700, epoch: 7 | loss: 0.8126188
	speed: 0.0509s/iter; left time: 1509.1592s
	iters: 1800, epoch: 7 | loss: 0.5013468
	speed: 0.0517s/iter; left time: 1528.7038s
	iters: 1900, epoch: 7 | loss: 0.5027730
	speed: 0.0577s/iter; left time: 1698.9660s
	iters: 2000, epoch: 7 | loss: 0.7231543
	speed: 0.0520s/iter; left time: 1525.3447s
	iters: 2100, epoch: 7 | loss: 0.6306201
	speed: 0.0551s/iter; left time: 1611.1510s
	iters: 2200, epoch: 7 | loss: 0.6153533
	speed: 0.0524s/iter; left time: 1526.3230s
Epoch: 7 cost time: 111.03972434997559
Epoch: 7, Steps: 2239 | Train Loss: 0.7045354 Vali Loss: 0.6474059 Test Loss: 0.3196656
Validation loss decreased (0.658829 --> 0.647406).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.5607044
	speed: 0.1631s/iter; left time: 4730.2074s
	iters: 200, epoch: 8 | loss: 0.5418717
	speed: 0.0425s/iter; left time: 1227.9511s
	iters: 300, epoch: 8 | loss: 0.4354789
	speed: 0.0505s/iter; left time: 1453.9135s
	iters: 400, epoch: 8 | loss: 0.9108101
	speed: 0.0544s/iter; left time: 1562.9990s
	iters: 500, epoch: 8 | loss: 0.5307716
	speed: 0.0527s/iter; left time: 1507.7201s
	iters: 600, epoch: 8 | loss: 0.6593207
	speed: 0.0510s/iter; left time: 1455.2682s
	iters: 700, epoch: 8 | loss: 0.7004420
	speed: 0.0516s/iter; left time: 1466.4798s
	iters: 800, epoch: 8 | loss: 0.4728242
	speed: 0.0507s/iter; left time: 1434.6815s
	iters: 900, epoch: 8 | loss: 0.5396885
	speed: 0.0509s/iter; left time: 1435.3158s
	iters: 1000, epoch: 8 | loss: 0.5118765
	speed: 0.0541s/iter; left time: 1520.5893s
	iters: 1100, epoch: 8 | loss: 0.5015812
	speed: 0.0498s/iter; left time: 1394.4183s
	iters: 1200, epoch: 8 | loss: 0.5257127
	speed: 0.0501s/iter; left time: 1399.2994s
	iters: 1300, epoch: 8 | loss: 0.5402989
	speed: 0.0504s/iter; left time: 1401.1085s
	iters: 1400, epoch: 8 | loss: 0.8413000
	speed: 0.0517s/iter; left time: 1432.3203s
	iters: 1500, epoch: 8 | loss: 1.5940107
	speed: 0.0533s/iter; left time: 1471.3739s
	iters: 1600, epoch: 8 | loss: 0.5093496
	speed: 0.0506s/iter; left time: 1391.6904s
	iters: 1700, epoch: 8 | loss: 0.7729755
	speed: 0.0473s/iter; left time: 1295.7108s
	iters: 1800, epoch: 8 | loss: 0.4493529
	speed: 0.0500s/iter; left time: 1364.5588s
	iters: 1900, epoch: 8 | loss: 0.7309912
	speed: 0.0480s/iter; left time: 1306.9443s
	iters: 2000, epoch: 8 | loss: 0.4357921
	speed: 0.0493s/iter; left time: 1336.5630s
	iters: 2100, epoch: 8 | loss: 0.5517598
	speed: 0.0525s/iter; left time: 1416.6065s
	iters: 2200, epoch: 8 | loss: 0.7317401
	speed: 0.0460s/iter; left time: 1237.6630s
Epoch: 8 cost time: 111.64665579795837
Epoch: 8, Steps: 2239 | Train Loss: 0.6922328 Vali Loss: 0.6474723 Test Loss: 0.3200309
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.7121357
	speed: 0.1640s/iter; left time: 4389.6316s
	iters: 200, epoch: 9 | loss: 0.4507644
	speed: 0.0454s/iter; left time: 1210.4746s
	iters: 300, epoch: 9 | loss: 0.4660532
	speed: 0.0482s/iter; left time: 1281.3302s
	iters: 400, epoch: 9 | loss: 0.4870078
	speed: 0.0540s/iter; left time: 1430.3383s
	iters: 500, epoch: 9 | loss: 0.4689055
	speed: 0.0522s/iter; left time: 1376.1282s
	iters: 600, epoch: 9 | loss: 1.0795338
	speed: 0.0482s/iter; left time: 1266.0729s
	iters: 700, epoch: 9 | loss: 0.5862788
	speed: 0.0512s/iter; left time: 1339.6957s
	iters: 800, epoch: 9 | loss: 0.5284626
	speed: 0.0541s/iter; left time: 1409.7573s
	iters: 900, epoch: 9 | loss: 0.6058732
	speed: 0.0537s/iter; left time: 1393.3854s
	iters: 1000, epoch: 9 | loss: 0.6732776
	speed: 0.0473s/iter; left time: 1224.4781s
	iters: 1100, epoch: 9 | loss: 0.7111205
	speed: 0.0464s/iter; left time: 1195.6117s
	iters: 1200, epoch: 9 | loss: 0.5372394
	speed: 0.0498s/iter; left time: 1278.8374s
	iters: 1300, epoch: 9 | loss: 0.8024803
	speed: 0.0493s/iter; left time: 1261.6341s
	iters: 1400, epoch: 9 | loss: 0.7659662
	speed: 0.0508s/iter; left time: 1294.4160s
	iters: 1500, epoch: 9 | loss: 0.6335347
	speed: 0.0556s/iter; left time: 1409.6184s
	iters: 1600, epoch: 9 | loss: 0.4759737
	speed: 0.0513s/iter; left time: 1295.9639s
	iters: 1700, epoch: 9 | loss: 0.4814615
	speed: 0.0484s/iter; left time: 1218.9907s
	iters: 1800, epoch: 9 | loss: 0.7133456
	speed: 0.0515s/iter; left time: 1290.2360s
	iters: 1900, epoch: 9 | loss: 0.4713376
	speed: 0.0526s/iter; left time: 1312.5828s
	iters: 2000, epoch: 9 | loss: 0.6007798
	speed: 0.0461s/iter; left time: 1145.7924s
	iters: 2100, epoch: 9 | loss: 0.3885354
	speed: 0.0505s/iter; left time: 1249.6656s
	iters: 2200, epoch: 9 | loss: 0.5135604
	speed: 0.0527s/iter; left time: 1299.9363s
Epoch: 9 cost time: 111.37176156044006
Epoch: 9, Steps: 2239 | Train Loss: 0.6559144 Vali Loss: 0.6489117 Test Loss: 0.3187597
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.4833298
	speed: 0.1591s/iter; left time: 3901.5846s
	iters: 200, epoch: 10 | loss: 0.4682912
	speed: 0.0434s/iter; left time: 1060.8365s
	iters: 300, epoch: 10 | loss: 0.7049664
	speed: 0.0500s/iter; left time: 1215.3928s
	iters: 400, epoch: 10 | loss: 0.7775194
	speed: 0.0520s/iter; left time: 1258.8952s
	iters: 500, epoch: 10 | loss: 1.2285936
	speed: 0.0494s/iter; left time: 1192.5798s
	iters: 600, epoch: 10 | loss: 0.6894238
	speed: 0.0512s/iter; left time: 1230.0036s
	iters: 700, epoch: 10 | loss: 0.5497914
	speed: 0.0515s/iter; left time: 1233.5443s
	iters: 800, epoch: 10 | loss: 0.5972367
	speed: 0.0488s/iter; left time: 1163.5297s
	iters: 900, epoch: 10 | loss: 0.5395904
	speed: 0.0471s/iter; left time: 1117.7687s
	iters: 1000, epoch: 10 | loss: 0.5457516
	speed: 0.0533s/iter; left time: 1258.8327s
	iters: 1100, epoch: 10 | loss: 0.5417471
	speed: 0.0541s/iter; left time: 1273.1866s
	iters: 1200, epoch: 10 | loss: 0.5095986
	speed: 0.0520s/iter; left time: 1218.5291s
	iters: 1300, epoch: 10 | loss: 0.4827137
	speed: 0.0516s/iter; left time: 1203.5441s
	iters: 1400, epoch: 10 | loss: 0.5822187
	speed: 0.0524s/iter; left time: 1216.1521s
	iters: 1500, epoch: 10 | loss: 0.7147500
	speed: 0.0496s/iter; left time: 1147.8261s
	iters: 1600, epoch: 10 | loss: 1.0196975
	speed: 0.0494s/iter; left time: 1137.9500s
	iters: 1700, epoch: 10 | loss: 0.4021800
	speed: 0.0524s/iter; left time: 1200.7327s
	iters: 1800, epoch: 10 | loss: 0.4151582
	speed: 0.0489s/iter; left time: 1115.4370s
	iters: 1900, epoch: 10 | loss: 0.4567092
	speed: 0.0525s/iter; left time: 1194.4439s
	iters: 2000, epoch: 10 | loss: 0.4631022
	speed: 0.0508s/iter; left time: 1150.6001s
	iters: 2100, epoch: 10 | loss: 0.4574584
	speed: 0.0553s/iter; left time: 1244.9373s
	iters: 2200, epoch: 10 | loss: 0.4785427
	speed: 0.0500s/iter; left time: 1121.6436s
Epoch: 10 cost time: 112.40167164802551
Epoch: 10, Steps: 2239 | Train Loss: 0.6513156 Vali Loss: 0.6450127 Test Loss: 0.3178251
Validation loss decreased (0.647406 --> 0.645013).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.5234242
	speed: 0.1609s/iter; left time: 3586.9638s
	iters: 200, epoch: 11 | loss: 0.4636957
	speed: 0.0442s/iter; left time: 980.8875s
	iters: 300, epoch: 11 | loss: 0.8627967
	speed: 0.0499s/iter; left time: 1102.6912s
	iters: 400, epoch: 11 | loss: 0.5269649
	speed: 0.0514s/iter; left time: 1129.9170s
	iters: 500, epoch: 11 | loss: 0.5670408
	speed: 0.0511s/iter; left time: 1118.4150s
	iters: 600, epoch: 11 | loss: 0.5743635
	speed: 0.0463s/iter; left time: 1008.8404s
	iters: 700, epoch: 11 | loss: 0.4824398
	speed: 0.0485s/iter; left time: 1051.9074s
	iters: 800, epoch: 11 | loss: 0.4983878
	speed: 0.0507s/iter; left time: 1095.1740s
	iters: 900, epoch: 11 | loss: 0.6504276
	speed: 0.0496s/iter; left time: 1065.2692s
	iters: 1000, epoch: 11 | loss: 0.7859982
	speed: 0.0518s/iter; left time: 1108.6459s
	iters: 1100, epoch: 11 | loss: 0.6548240
	speed: 0.0504s/iter; left time: 1072.1850s
	iters: 1200, epoch: 11 | loss: 0.7791508
	speed: 0.0509s/iter; left time: 1078.6543s
	iters: 1300, epoch: 11 | loss: 0.7508195
	speed: 0.0499s/iter; left time: 1052.6204s
	iters: 1400, epoch: 11 | loss: 0.3865916
	speed: 0.0486s/iter; left time: 1021.0884s
	iters: 1500, epoch: 11 | loss: 0.9845527
	speed: 0.0503s/iter; left time: 1050.3468s
	iters: 1600, epoch: 11 | loss: 0.9938766
	speed: 0.0504s/iter; left time: 1047.3446s
	iters: 1700, epoch: 11 | loss: 1.8128178
	speed: 0.0498s/iter; left time: 1030.0980s
	iters: 1800, epoch: 11 | loss: 0.5490382
	speed: 0.0489s/iter; left time: 1007.7945s
	iters: 1900, epoch: 11 | loss: 0.4953501
	speed: 0.0515s/iter; left time: 1054.9447s
	iters: 2000, epoch: 11 | loss: 0.5218647
	speed: 0.0578s/iter; left time: 1179.0664s
	iters: 2100, epoch: 11 | loss: 0.9159098
	speed: 0.0486s/iter; left time: 986.9399s
	iters: 2200, epoch: 11 | loss: 0.5641302
	speed: 0.0529s/iter; left time: 1068.3285s
Epoch: 11 cost time: 110.84843111038208
Epoch: 11, Steps: 2239 | Train Loss: 0.6492265 Vali Loss: 0.6456019 Test Loss: 0.3186527
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.8311816
	speed: 0.1574s/iter; left time: 3155.5823s
	iters: 200, epoch: 12 | loss: 0.3874045
	speed: 0.0438s/iter; left time: 873.6667s
	iters: 300, epoch: 12 | loss: 0.5233411
	speed: 0.0476s/iter; left time: 945.0647s
	iters: 400, epoch: 12 | loss: 0.5744302
	speed: 0.0481s/iter; left time: 950.6800s
	iters: 500, epoch: 12 | loss: 1.0262214
	speed: 0.0484s/iter; left time: 951.6546s
	iters: 600, epoch: 12 | loss: 0.6831974
	speed: 0.0566s/iter; left time: 1106.9100s
	iters: 700, epoch: 12 | loss: 0.8481461
	speed: 0.0521s/iter; left time: 1013.1135s
	iters: 800, epoch: 12 | loss: 0.5234736
	speed: 0.0488s/iter; left time: 944.2839s
	iters: 900, epoch: 12 | loss: 0.6066397
	speed: 0.0484s/iter; left time: 931.5710s
	iters: 1000, epoch: 12 | loss: 0.5107739
	speed: 0.0498s/iter; left time: 953.5197s
	iters: 1100, epoch: 12 | loss: 0.6468120
	speed: 0.0470s/iter; left time: 895.5349s
	iters: 1200, epoch: 12 | loss: 0.4412587
	speed: 0.0480s/iter; left time: 910.4881s
	iters: 1300, epoch: 12 | loss: 0.9985542
	speed: 0.0527s/iter; left time: 993.4812s
	iters: 1400, epoch: 12 | loss: 0.4907821
	speed: 0.0484s/iter; left time: 907.3208s
	iters: 1500, epoch: 12 | loss: 0.8230324
	speed: 0.0525s/iter; left time: 978.8952s
	iters: 1600, epoch: 12 | loss: 0.5352842
	speed: 0.0491s/iter; left time: 911.6990s
	iters: 1700, epoch: 12 | loss: 0.5753412
	speed: 0.0520s/iter; left time: 958.7176s
	iters: 1800, epoch: 12 | loss: 0.9382858
	speed: 0.0510s/iter; left time: 935.6036s
	iters: 1900, epoch: 12 | loss: 0.6619223
	speed: 0.0529s/iter; left time: 965.1417s
	iters: 2000, epoch: 12 | loss: 0.7085443
	speed: 0.0475s/iter; left time: 862.7322s
	iters: 2100, epoch: 12 | loss: 0.8626053
	speed: 0.0498s/iter; left time: 898.5845s
	iters: 2200, epoch: 12 | loss: 0.7644351
	speed: 0.0507s/iter; left time: 909.5311s
Epoch: 12 cost time: 110.20234847068787
Epoch: 12, Steps: 2239 | Train Loss: 0.6482309 Vali Loss: 0.6454484 Test Loss: 0.3186562
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.9491736
	speed: 0.1602s/iter; left time: 2853.8527s
	iters: 200, epoch: 13 | loss: 0.4961199
	speed: 0.0437s/iter; left time: 774.5795s
	iters: 300, epoch: 13 | loss: 0.5882068
	speed: 0.0460s/iter; left time: 809.4972s
	iters: 400, epoch: 13 | loss: 0.6045378
	speed: 0.0469s/iter; left time: 821.6194s
	iters: 500, epoch: 13 | loss: 0.5782924
	speed: 0.0517s/iter; left time: 899.7476s
	iters: 600, epoch: 13 | loss: 0.7596484
	speed: 0.0527s/iter; left time: 912.0578s
	iters: 700, epoch: 13 | loss: 0.7785505
	speed: 0.0527s/iter; left time: 906.3168s
	iters: 800, epoch: 13 | loss: 0.4925486
	speed: 0.0501s/iter; left time: 857.8385s
	iters: 900, epoch: 13 | loss: 0.6798782
	speed: 0.0498s/iter; left time: 847.9817s
	iters: 1000, epoch: 13 | loss: 1.0687748
	speed: 0.0483s/iter; left time: 816.8786s
	iters: 1100, epoch: 13 | loss: 0.4753228
	speed: 0.0507s/iter; left time: 853.1928s
	iters: 1200, epoch: 13 | loss: 0.8022934
	speed: 0.0516s/iter; left time: 861.7674s
	iters: 1300, epoch: 13 | loss: 0.8357410
	speed: 0.0489s/iter; left time: 811.9681s
	iters: 1400, epoch: 13 | loss: 0.7144797
	speed: 0.0520s/iter; left time: 859.0197s
	iters: 1500, epoch: 13 | loss: 0.4447735
	speed: 0.0522s/iter; left time: 856.2160s
	iters: 1600, epoch: 13 | loss: 0.4437523
	speed: 0.0500s/iter; left time: 816.3544s
	iters: 1700, epoch: 13 | loss: 0.4891152
	speed: 0.0501s/iter; left time: 812.0886s
	iters: 1800, epoch: 13 | loss: 0.6212665
	speed: 0.0478s/iter; left time: 769.5009s
	iters: 1900, epoch: 13 | loss: 0.4482896
	speed: 0.0447s/iter; left time: 714.9820s
	iters: 2000, epoch: 13 | loss: 0.4995603
	speed: 0.0505s/iter; left time: 802.8808s
	iters: 2100, epoch: 13 | loss: 0.6578004
	speed: 0.0517s/iter; left time: 817.7776s
	iters: 2200, epoch: 13 | loss: 0.5105456
	speed: 0.0520s/iter; left time: 816.4207s
Epoch: 13 cost time: 110.11094689369202
Epoch: 13, Steps: 2239 | Train Loss: 0.6477106 Vali Loss: 0.6459422 Test Loss: 0.3184196
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.5487949
	speed: 0.1688s/iter; left time: 2629.2967s
	iters: 200, epoch: 14 | loss: 0.5093474
	speed: 0.0412s/iter; left time: 637.1167s
	iters: 300, epoch: 14 | loss: 0.5196838
	speed: 0.0458s/iter; left time: 704.0558s
	iters: 400, epoch: 14 | loss: 0.5442456
	speed: 0.0447s/iter; left time: 682.8988s
	iters: 500, epoch: 14 | loss: 0.9148793
	speed: 0.0473s/iter; left time: 717.5008s
	iters: 600, epoch: 14 | loss: 0.7328989
	speed: 0.0478s/iter; left time: 720.8171s
	iters: 700, epoch: 14 | loss: 0.9242974
	speed: 0.0542s/iter; left time: 812.0275s
	iters: 800, epoch: 14 | loss: 0.6034567
	speed: 0.0546s/iter; left time: 812.2997s
	iters: 900, epoch: 14 | loss: 0.4559636
	speed: 0.0498s/iter; left time: 736.1711s
	iters: 1000, epoch: 14 | loss: 0.9482324
	speed: 0.0509s/iter; left time: 747.3028s
	iters: 1100, epoch: 14 | loss: 1.2668701
	speed: 0.0482s/iter; left time: 702.2377s
	iters: 1200, epoch: 14 | loss: 0.8507485
	speed: 0.0442s/iter; left time: 639.8584s
	iters: 1300, epoch: 14 | loss: 0.5430640
	speed: 0.0504s/iter; left time: 724.2662s
	iters: 1400, epoch: 14 | loss: 0.4755091
	speed: 0.0477s/iter; left time: 680.8142s
	iters: 1500, epoch: 14 | loss: 0.6740192
	speed: 0.0496s/iter; left time: 702.4173s
	iters: 1600, epoch: 14 | loss: 0.4261427
	speed: 0.0493s/iter; left time: 693.2965s
	iters: 1700, epoch: 14 | loss: 0.7962989
	speed: 0.0451s/iter; left time: 629.5959s
	iters: 1800, epoch: 14 | loss: 0.4699630
	speed: 0.0449s/iter; left time: 622.5726s
	iters: 1900, epoch: 14 | loss: 0.9104668
	speed: 0.0508s/iter; left time: 700.1498s
	iters: 2000, epoch: 14 | loss: 0.4956732
	speed: 0.0532s/iter; left time: 727.2512s
	iters: 2100, epoch: 14 | loss: 0.8249620
	speed: 0.0468s/iter; left time: 635.8380s
	iters: 2200, epoch: 14 | loss: 0.5278789
	speed: 0.0491s/iter; left time: 662.0046s
Epoch: 14 cost time: 107.56134629249573
Epoch: 14, Steps: 2239 | Train Loss: 0.6475070 Vali Loss: 0.6456156 Test Loss: 0.3184488
EarlyStopping counter: 4 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 1.4724174
	speed: 0.1760s/iter; left time: 2346.8260s
	iters: 200, epoch: 15 | loss: 0.5143780
	speed: 0.0400s/iter; left time: 529.7876s
	iters: 300, epoch: 15 | loss: 1.1876954
	speed: 0.0434s/iter; left time: 569.7998s
	iters: 400, epoch: 15 | loss: 1.0391905
	speed: 0.0453s/iter; left time: 591.0362s
	iters: 500, epoch: 15 | loss: 0.4959624
	speed: 0.0461s/iter; left time: 596.5427s
	iters: 600, epoch: 15 | loss: 0.6785700
	speed: 0.0525s/iter; left time: 673.2465s
	iters: 700, epoch: 15 | loss: 0.8492447
	speed: 0.0520s/iter; left time: 662.6603s
	iters: 800, epoch: 15 | loss: 1.4874308
	speed: 0.0489s/iter; left time: 617.8021s
	iters: 900, epoch: 15 | loss: 0.6339206
	speed: 0.0499s/iter; left time: 625.4434s
	iters: 1000, epoch: 15 | loss: 0.5720766
	speed: 0.0519s/iter; left time: 645.8641s
	iters: 1100, epoch: 15 | loss: 0.5693361
	speed: 0.0537s/iter; left time: 662.4448s
	iters: 1200, epoch: 15 | loss: 0.4750397
	speed: 0.0469s/iter; left time: 573.7493s
	iters: 1300, epoch: 15 | loss: 0.7373874
	speed: 0.0512s/iter; left time: 621.7569s
	iters: 1400, epoch: 15 | loss: 0.7167467
	speed: 0.0503s/iter; left time: 605.5120s
	iters: 1500, epoch: 15 | loss: 0.9820949
	speed: 0.0505s/iter; left time: 602.5756s
	iters: 1600, epoch: 15 | loss: 0.4999742
	speed: 0.0497s/iter; left time: 588.3474s
	iters: 1700, epoch: 15 | loss: 0.5034076
	speed: 0.0509s/iter; left time: 597.7962s
	iters: 1800, epoch: 15 | loss: 0.5852848
	speed: 0.0492s/iter; left time: 572.6947s
	iters: 1900, epoch: 15 | loss: 0.5117246
	speed: 0.0487s/iter; left time: 561.9272s
	iters: 2000, epoch: 15 | loss: 0.6026962
	speed: 0.0486s/iter; left time: 555.9554s
	iters: 2100, epoch: 15 | loss: 0.5460121
	speed: 0.0481s/iter; left time: 545.3861s
	iters: 2200, epoch: 15 | loss: 0.4812931
	speed: 0.0521s/iter; left time: 585.7389s
Epoch: 15 cost time: 109.08005905151367
Epoch: 15, Steps: 2239 | Train Loss: 0.6471142 Vali Loss: 0.6453909 Test Loss: 0.3184200
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : weather_336_720_NLinear_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3144<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9820
mse:0.31779295206069946, mae:0.33289554715156555
