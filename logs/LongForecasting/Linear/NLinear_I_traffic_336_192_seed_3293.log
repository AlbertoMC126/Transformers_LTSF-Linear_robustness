Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='NLinear', model_id='traffic_336_192', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=192, root_path='./dataset/', save_pred_values=False, seed=3293, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_336_192_NLinear_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3293>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11753
val 1565
test 3317
	iters: 100, epoch: 1 | loss: 2.0683258
	speed: 0.3148s/iter; left time: 4590.2652s
	iters: 200, epoch: 1 | loss: 0.9923989
	speed: 0.2997s/iter; left time: 4340.3379s
	iters: 300, epoch: 1 | loss: 1.4490150
	speed: 0.2996s/iter; left time: 4308.9308s
	iters: 400, epoch: 1 | loss: 0.8012874
	speed: 0.2998s/iter; left time: 4282.0660s
	iters: 500, epoch: 1 | loss: 0.6714084
	speed: 0.3001s/iter; left time: 4256.0198s
	iters: 600, epoch: 1 | loss: 0.7492431
	speed: 0.2998s/iter; left time: 4221.3635s
	iters: 700, epoch: 1 | loss: 0.9841635
	speed: 0.3001s/iter; left time: 4195.2028s
Epoch: 1 cost time: 221.8159430027008
Epoch: 1, Steps: 734 | Train Loss: 1.0299826 Vali Loss: 0.8484228 Test Loss: 1.0395610
Validation loss decreased (inf --> 0.848423).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.6859463
	speed: 0.6036s/iter; left time: 8358.5065s
	iters: 200, epoch: 2 | loss: 2.3375745
	speed: 0.2995s/iter; left time: 4117.5553s
	iters: 300, epoch: 2 | loss: 0.9159140
	speed: 0.2996s/iter; left time: 4088.4753s
	iters: 400, epoch: 2 | loss: 1.4788394
	speed: 0.3004s/iter; left time: 4070.1406s
	iters: 500, epoch: 2 | loss: 0.8606582
	speed: 0.3003s/iter; left time: 4038.2991s
	iters: 600, epoch: 2 | loss: 1.1421366
	speed: 0.2998s/iter; left time: 4001.1598s
	iters: 700, epoch: 2 | loss: 1.6641454
	speed: 0.3532s/iter; left time: 4679.0592s
Epoch: 2 cost time: 227.40179681777954
Epoch: 2, Steps: 734 | Train Loss: 1.0242685 Vali Loss: 1.4234551 Test Loss: 1.7181827
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.3571593
	speed: 0.6264s/iter; left time: 8214.5904s
	iters: 200, epoch: 3 | loss: 0.3549502
	speed: 0.3037s/iter; left time: 3951.9950s
	iters: 300, epoch: 3 | loss: 0.3469605
	speed: 0.3028s/iter; left time: 3910.1781s
	iters: 400, epoch: 3 | loss: 0.3027707
	speed: 0.3004s/iter; left time: 3849.1893s
	iters: 500, epoch: 3 | loss: 0.3444031
	speed: 0.3026s/iter; left time: 3846.8284s
	iters: 600, epoch: 3 | loss: 0.3070227
	speed: 0.3025s/iter; left time: 3815.0245s
	iters: 700, epoch: 3 | loss: 0.4450102
	speed: 0.3029s/iter; left time: 3789.7165s
Epoch: 3 cost time: 222.017263174057
Epoch: 3, Steps: 734 | Train Loss: 0.3636370 Vali Loss: 0.6490808 Test Loss: 0.7040405
Validation loss decreased (0.848423 --> 0.649081).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.2865723
	speed: 0.6067s/iter; left time: 7510.3280s
	iters: 200, epoch: 4 | loss: 0.3133467
	speed: 0.3000s/iter; left time: 3683.7962s
	iters: 300, epoch: 4 | loss: 0.2842393
	speed: 0.3023s/iter; left time: 3681.3762s
	iters: 400, epoch: 4 | loss: 0.2984226
	speed: 0.3034s/iter; left time: 3665.0537s
	iters: 500, epoch: 4 | loss: 0.3155079
	speed: 0.3024s/iter; left time: 3622.9030s
	iters: 600, epoch: 4 | loss: 0.2706199
	speed: 0.3005s/iter; left time: 3569.1354s
	iters: 700, epoch: 4 | loss: 0.2984198
	speed: 0.3020s/iter; left time: 3557.4891s
Epoch: 4 cost time: 221.31656408309937
Epoch: 4, Steps: 734 | Train Loss: 0.2937462 Vali Loss: 0.4231614 Test Loss: 0.5200160
Validation loss decreased (0.649081 --> 0.423161).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.2634855
	speed: 0.6091s/iter; left time: 7093.0167s
	iters: 200, epoch: 5 | loss: 0.2684384
	speed: 0.3020s/iter; left time: 3486.6826s
	iters: 300, epoch: 5 | loss: 0.2601587
	speed: 0.3011s/iter; left time: 3446.3253s
	iters: 400, epoch: 5 | loss: 0.2568086
	speed: 0.3017s/iter; left time: 3422.7407s
	iters: 500, epoch: 5 | loss: 0.2990869
	speed: 0.3010s/iter; left time: 3384.6634s
	iters: 600, epoch: 5 | loss: 0.2698774
	speed: 0.3007s/iter; left time: 3351.3338s
	iters: 700, epoch: 5 | loss: 0.2590446
	speed: 0.3026s/iter; left time: 3342.5505s
Epoch: 5 cost time: 221.40509796142578
Epoch: 5, Steps: 734 | Train Loss: 0.2653573 Vali Loss: 0.3801058 Test Loss: 0.4728680
Validation loss decreased (0.423161 --> 0.380106).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.2158808
	speed: 0.6088s/iter; left time: 6642.9689s
	iters: 200, epoch: 6 | loss: 0.2738873
	speed: 0.3019s/iter; left time: 3264.1617s
	iters: 300, epoch: 6 | loss: 0.2687251
	speed: 0.3019s/iter; left time: 3233.5841s
	iters: 400, epoch: 6 | loss: 0.2657290
	speed: 0.3013s/iter; left time: 3197.4489s
	iters: 500, epoch: 6 | loss: 0.2564886
	speed: 0.3030s/iter; left time: 3184.5160s
	iters: 600, epoch: 6 | loss: 0.2662108
	speed: 0.3002s/iter; left time: 3125.2336s
	iters: 700, epoch: 6 | loss: 0.2722977
	speed: 0.3004s/iter; left time: 3097.7236s
Epoch: 6 cost time: 221.36446499824524
Epoch: 6, Steps: 734 | Train Loss: 0.2545019 Vali Loss: 0.3625473 Test Loss: 0.4510598
Validation loss decreased (0.380106 --> 0.362547).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.2299789
	speed: 0.6075s/iter; left time: 6182.7852s
	iters: 200, epoch: 7 | loss: 0.2385748
	speed: 0.3001s/iter; left time: 3023.7060s
	iters: 300, epoch: 7 | loss: 0.2673859
	speed: 0.2999s/iter; left time: 2991.8287s
	iters: 400, epoch: 7 | loss: 0.2301370
	speed: 0.2999s/iter; left time: 2961.9949s
	iters: 500, epoch: 7 | loss: 0.2567334
	speed: 0.2996s/iter; left time: 2928.7649s
	iters: 600, epoch: 7 | loss: 0.2393791
	speed: 0.3001s/iter; left time: 2904.0972s
	iters: 700, epoch: 7 | loss: 0.2627561
	speed: 0.2999s/iter; left time: 2872.1371s
Epoch: 7 cost time: 220.14420628547668
Epoch: 7, Steps: 734 | Train Loss: 0.2488641 Vali Loss: 0.3567265 Test Loss: 0.4443059
Validation loss decreased (0.362547 --> 0.356726).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.2258862
	speed: 0.6062s/iter; left time: 5724.8174s
	iters: 200, epoch: 8 | loss: 0.2427524
	speed: 0.3006s/iter; left time: 2808.0468s
	iters: 300, epoch: 8 | loss: 0.2459979
	speed: 0.3003s/iter; left time: 2775.8084s
	iters: 400, epoch: 8 | loss: 0.2275912
	speed: 0.3016s/iter; left time: 2757.8404s
	iters: 500, epoch: 8 | loss: 0.2281580
	speed: 0.3021s/iter; left time: 2731.5958s
	iters: 600, epoch: 8 | loss: 0.2497448
	speed: 0.3004s/iter; left time: 2686.7415s
	iters: 700, epoch: 8 | loss: 0.2791484
	speed: 0.2996s/iter; left time: 2649.2196s
Epoch: 8 cost time: 220.73918986320496
Epoch: 8, Steps: 734 | Train Loss: 0.2456672 Vali Loss: 0.3534545 Test Loss: 0.4406620
Validation loss decreased (0.356726 --> 0.353454).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.2600446
	speed: 0.6032s/iter; left time: 5253.4531s
	iters: 200, epoch: 9 | loss: 0.2588602
	speed: 0.2999s/iter; left time: 2581.7692s
	iters: 300, epoch: 9 | loss: 0.2489831
	speed: 0.2998s/iter; left time: 2551.3740s
	iters: 400, epoch: 9 | loss: 0.2322472
	speed: 0.3009s/iter; left time: 2530.1045s
	iters: 500, epoch: 9 | loss: 0.2428637
	speed: 0.2986s/iter; left time: 2481.1098s
	iters: 600, epoch: 9 | loss: 0.2420738
	speed: 0.3004s/iter; left time: 2465.9748s
	iters: 700, epoch: 9 | loss: 0.2209601
	speed: 0.2999s/iter; left time: 2431.6461s
Epoch: 9 cost time: 220.04815316200256
Epoch: 9, Steps: 734 | Train Loss: 0.2437442 Vali Loss: 0.3513244 Test Loss: 0.4383780
Validation loss decreased (0.353454 --> 0.351324).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.2454465
	speed: 0.6050s/iter; left time: 4824.5713s
	iters: 200, epoch: 10 | loss: 0.2539183
	speed: 0.3002s/iter; left time: 2364.0413s
	iters: 300, epoch: 10 | loss: 0.2540825
	speed: 0.3001s/iter; left time: 2333.6487s
	iters: 400, epoch: 10 | loss: 0.2195712
	speed: 0.3005s/iter; left time: 2306.3749s
	iters: 500, epoch: 10 | loss: 0.2832769
	speed: 0.2996s/iter; left time: 2269.7126s
	iters: 600, epoch: 10 | loss: 0.2231636
	speed: 0.2999s/iter; left time: 2241.5994s
	iters: 700, epoch: 10 | loss: 0.2233136
	speed: 0.2999s/iter; left time: 2211.9355s
Epoch: 10 cost time: 220.26341485977173
Epoch: 10, Steps: 734 | Train Loss: 0.2426955 Vali Loss: 0.3504683 Test Loss: 0.4374368
Validation loss decreased (0.351324 --> 0.350468).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.2391931
	speed: 0.6056s/iter; left time: 4385.1543s
	iters: 200, epoch: 11 | loss: 0.2385611
	speed: 0.3010s/iter; left time: 2149.1794s
	iters: 300, epoch: 11 | loss: 0.2336116
	speed: 0.2998s/iter; left time: 2110.7503s
	iters: 400, epoch: 11 | loss: 0.2452375
	speed: 0.3017s/iter; left time: 2094.2275s
	iters: 500, epoch: 11 | loss: 0.2416446
	speed: 0.3008s/iter; left time: 2057.5714s
	iters: 600, epoch: 11 | loss: 0.2406537
	speed: 0.2996s/iter; left time: 2019.5316s
	iters: 700, epoch: 11 | loss: 0.2371528
	speed: 0.3002s/iter; left time: 1993.4083s
Epoch: 11 cost time: 220.61520552635193
Epoch: 11, Steps: 734 | Train Loss: 0.2420213 Vali Loss: 0.3501807 Test Loss: 0.4369387
Validation loss decreased (0.350468 --> 0.350181).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.2337398
	speed: 0.6060s/iter; left time: 3943.3497s
	iters: 200, epoch: 12 | loss: 0.2637959
	speed: 0.3014s/iter; left time: 1931.3474s
	iters: 300, epoch: 12 | loss: 0.2565067
	speed: 0.3015s/iter; left time: 1901.4969s
	iters: 400, epoch: 12 | loss: 0.2607824
	speed: 0.2998s/iter; left time: 1860.8093s
	iters: 500, epoch: 12 | loss: 0.2502173
	speed: 0.3000s/iter; left time: 1832.3034s
	iters: 600, epoch: 12 | loss: 0.2227283
	speed: 0.2997s/iter; left time: 1800.2058s
	iters: 700, epoch: 12 | loss: 0.2441581
	speed: 0.2996s/iter; left time: 1770.0325s
Epoch: 12 cost time: 220.40355157852173
Epoch: 12, Steps: 734 | Train Loss: 0.2417037 Vali Loss: 0.3497785 Test Loss: 0.4366141
Validation loss decreased (0.350181 --> 0.349779).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.2397265
	speed: 0.6029s/iter; left time: 3480.4515s
	iters: 200, epoch: 13 | loss: 0.2316819
	speed: 0.2998s/iter; left time: 1700.9705s
	iters: 300, epoch: 13 | loss: 0.2597998
	speed: 0.3002s/iter; left time: 1673.1231s
	iters: 400, epoch: 13 | loss: 0.2555910
	speed: 0.3007s/iter; left time: 1645.6086s
	iters: 500, epoch: 13 | loss: 0.2577591
	speed: 0.2993s/iter; left time: 1608.2104s
	iters: 600, epoch: 13 | loss: 0.2148614
	speed: 0.2996s/iter; left time: 1579.8191s
	iters: 700, epoch: 13 | loss: 0.2244518
	speed: 0.2999s/iter; left time: 1551.3616s
Epoch: 13 cost time: 220.06058406829834
Epoch: 13, Steps: 734 | Train Loss: 0.2415260 Vali Loss: 0.3498167 Test Loss: 0.4363958
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 14 | loss: 0.2358269
	speed: 0.6027s/iter; left time: 3037.2504s
	iters: 200, epoch: 14 | loss: 0.2227253
	speed: 0.3002s/iter; left time: 1482.8973s
	iters: 300, epoch: 14 | loss: 0.2411837
	speed: 0.2996s/iter; left time: 1449.8715s
	iters: 400, epoch: 14 | loss: 0.2326390
	speed: 0.3000s/iter; left time: 1421.7209s
	iters: 500, epoch: 14 | loss: 0.2195944
	speed: 0.3003s/iter; left time: 1393.0222s
	iters: 600, epoch: 14 | loss: 0.2275095
	speed: 0.3013s/iter; left time: 1367.7097s
	iters: 700, epoch: 14 | loss: 0.2653156
	speed: 0.3012s/iter; left time: 1337.0388s
Epoch: 14 cost time: 220.56410670280457
Epoch: 14, Steps: 734 | Train Loss: 0.2414244 Vali Loss: 0.3496084 Test Loss: 0.4363720
Validation loss decreased (0.349779 --> 0.349608).  Saving model ...
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 15 | loss: 0.2319942
	speed: 0.6084s/iter; left time: 2619.1687s
	iters: 200, epoch: 15 | loss: 0.2197655
	speed: 0.3003s/iter; left time: 1262.5626s
	iters: 300, epoch: 15 | loss: 0.2264804
	speed: 0.2997s/iter; left time: 1230.4306s
	iters: 400, epoch: 15 | loss: 0.2628326
	speed: 0.3002s/iter; left time: 1202.4813s
	iters: 500, epoch: 15 | loss: 0.2342899
	speed: 0.2999s/iter; left time: 1171.2199s
	iters: 600, epoch: 15 | loss: 0.2316344
	speed: 0.3001s/iter; left time: 1141.8695s
	iters: 700, epoch: 15 | loss: 0.2338107
	speed: 0.2995s/iter; left time: 1109.6142s
Epoch: 15 cost time: 220.25965285301208
Epoch: 15, Steps: 734 | Train Loss: 0.2414003 Vali Loss: 0.3495428 Test Loss: 0.4363670
Validation loss decreased (0.349608 --> 0.349543).  Saving model ...
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 16 | loss: 0.2302191
	speed: 0.6060s/iter; left time: 2163.8742s
	iters: 200, epoch: 16 | loss: 0.2573820
	speed: 0.2998s/iter; left time: 1040.5122s
	iters: 300, epoch: 16 | loss: 0.2442113
	speed: 0.2995s/iter; left time: 1009.6304s
	iters: 400, epoch: 16 | loss: 0.2262558
	speed: 0.3004s/iter; left time: 982.4983s
	iters: 500, epoch: 16 | loss: 0.2430642
	speed: 0.3000s/iter; left time: 951.4339s
	iters: 600, epoch: 16 | loss: 0.2274667
	speed: 0.3000s/iter; left time: 921.1838s
	iters: 700, epoch: 16 | loss: 0.2170124
	speed: 0.2996s/iter; left time: 890.2071s
Epoch: 16 cost time: 220.18878531455994
Epoch: 16, Steps: 734 | Train Loss: 0.2413511 Vali Loss: 0.3496822 Test Loss: 0.4363578
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 17 | loss: 0.2415110
	speed: 0.6031s/iter; left time: 1711.0151s
	iters: 200, epoch: 17 | loss: 0.2235812
	speed: 0.2998s/iter; left time: 820.6519s
	iters: 300, epoch: 17 | loss: 0.2356082
	speed: 0.3000s/iter; left time: 791.1000s
	iters: 400, epoch: 17 | loss: 0.2350616
	speed: 0.2996s/iter; left time: 760.0702s
	iters: 500, epoch: 17 | loss: 0.2455428
	speed: 0.3000s/iter; left time: 731.1516s
	iters: 600, epoch: 17 | loss: 0.2558552
	speed: 0.3001s/iter; left time: 701.3777s
	iters: 700, epoch: 17 | loss: 0.2403128
	speed: 0.3004s/iter; left time: 671.9402s
Epoch: 17 cost time: 220.24575877189636
Epoch: 17, Steps: 734 | Train Loss: 0.2413299 Vali Loss: 0.3497755 Test Loss: 0.4363568
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 18 | loss: 0.2597603
	speed: 0.6031s/iter; left time: 1268.2739s
	iters: 200, epoch: 18 | loss: 0.2428787
	speed: 0.2994s/iter; left time: 599.6366s
	iters: 300, epoch: 18 | loss: 0.2304384
	speed: 0.3004s/iter; left time: 571.7344s
	iters: 400, epoch: 18 | loss: 0.2327120
	speed: 0.2993s/iter; left time: 539.5508s
	iters: 500, epoch: 18 | loss: 0.2657741
	speed: 0.2997s/iter; left time: 510.4204s
	iters: 600, epoch: 18 | loss: 0.2471918
	speed: 0.3000s/iter; left time: 480.9429s
	iters: 700, epoch: 18 | loss: 0.2461807
	speed: 0.2999s/iter; left time: 450.6922s
Epoch: 18 cost time: 220.05271291732788
Epoch: 18, Steps: 734 | Train Loss: 0.2413322 Vali Loss: 0.3494288 Test Loss: 0.4363556
Validation loss decreased (0.349543 --> 0.349429).  Saving model ...
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 19 | loss: 0.2330593
	speed: 0.6059s/iter; left time: 829.4913s
	iters: 200, epoch: 19 | loss: 0.2391964
	speed: 0.2991s/iter; left time: 379.5903s
	iters: 300, epoch: 19 | loss: 0.2293994
	speed: 0.2997s/iter; left time: 350.3633s
	iters: 400, epoch: 19 | loss: 0.2457193
	speed: 0.3008s/iter; left time: 321.5404s
	iters: 500, epoch: 19 | loss: 0.2150664
	speed: 0.2995s/iter; left time: 290.2375s
	iters: 600, epoch: 19 | loss: 0.2674400
	speed: 0.3001s/iter; left time: 260.8147s
	iters: 700, epoch: 19 | loss: 0.2421747
	speed: 0.2999s/iter; left time: 230.6342s
Epoch: 19 cost time: 220.1819748878479
Epoch: 19, Steps: 734 | Train Loss: 0.2413338 Vali Loss: 0.3498547 Test Loss: 0.4363554
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 20 | loss: 0.2584880
	speed: 0.6030s/iter; left time: 382.8977s
	iters: 200, epoch: 20 | loss: 0.2561394
	speed: 0.2998s/iter; left time: 160.4063s
	iters: 300, epoch: 20 | loss: 0.2403810
	speed: 0.3001s/iter; left time: 130.5510s
	iters: 400, epoch: 20 | loss: 0.2389121
	speed: 0.2998s/iter; left time: 100.4246s
	iters: 500, epoch: 20 | loss: 0.2191968
	speed: 0.2997s/iter; left time: 70.4295s
	iters: 600, epoch: 20 | loss: 0.2289510
	speed: 0.3004s/iter; left time: 40.5538s
	iters: 700, epoch: 20 | loss: 0.2656516
	speed: 0.2993s/iter; left time: 10.4766s
Epoch: 20 cost time: 220.10638093948364
Epoch: 20, Steps: 734 | Train Loss: 0.2413195 Vali Loss: 0.3498734 Test Loss: 0.4363551
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.9073486328125e-08
>>>>>>>testing : traffic_336_192_NLinear_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3293<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3317
mse:0.436005175113678, mae:0.29895931482315063
