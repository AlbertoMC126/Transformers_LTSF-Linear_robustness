Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='Linear', model_id='ETTm2_336_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=336, root_path='./dataset/', save_pred_values=False, seed=28649, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTm2_336_336_Linear_ETTm2_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed28649>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33889
val 11185
test 11185
	iters: 100, epoch: 1 | loss: 0.2935486
	speed: 0.0090s/iter; left time: 190.3265s
	iters: 200, epoch: 1 | loss: 0.4817905
	speed: 0.0097s/iter; left time: 202.9440s
	iters: 300, epoch: 1 | loss: 0.6730897
	speed: 0.0094s/iter; left time: 196.1255s
	iters: 400, epoch: 1 | loss: 0.4571092
	speed: 0.0090s/iter; left time: 186.9397s
	iters: 500, epoch: 1 | loss: 0.4741783
	speed: 0.0077s/iter; left time: 159.4105s
	iters: 600, epoch: 1 | loss: 0.5463037
	speed: 0.0082s/iter; left time: 168.3934s
	iters: 700, epoch: 1 | loss: 0.5018651
	speed: 0.0084s/iter; left time: 172.8930s
	iters: 800, epoch: 1 | loss: 0.6065359
	speed: 0.0089s/iter; left time: 181.0503s
	iters: 900, epoch: 1 | loss: 0.3668602
	speed: 0.0083s/iter; left time: 168.3186s
	iters: 1000, epoch: 1 | loss: 0.2880146
	speed: 0.0092s/iter; left time: 185.7210s
Epoch: 1 cost time: 9.297897100448608
Epoch: 1, Steps: 1059 | Train Loss: 0.5991136 Vali Loss: 0.5021461 Test Loss: 1.1800605
Validation loss decreased (inf --> 0.502146).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.6639870
	speed: 0.0300s/iter; left time: 601.2434s
	iters: 200, epoch: 2 | loss: 0.7174682
	speed: 0.0074s/iter; left time: 146.8877s
	iters: 300, epoch: 2 | loss: 0.8786057
	speed: 0.0083s/iter; left time: 163.6290s
	iters: 400, epoch: 2 | loss: 0.5682400
	speed: 0.0084s/iter; left time: 165.7076s
	iters: 500, epoch: 2 | loss: 0.8512667
	speed: 0.0093s/iter; left time: 182.1604s
	iters: 600, epoch: 2 | loss: 0.4983415
	speed: 0.0079s/iter; left time: 154.2035s
	iters: 700, epoch: 2 | loss: 0.4614729
	speed: 0.0081s/iter; left time: 157.1713s
	iters: 800, epoch: 2 | loss: 0.5216297
	speed: 0.0083s/iter; left time: 161.1825s
	iters: 900, epoch: 2 | loss: 1.0027283
	speed: 0.0090s/iter; left time: 172.1181s
	iters: 1000, epoch: 2 | loss: 0.5123149
	speed: 0.0085s/iter; left time: 162.3955s
Epoch: 2 cost time: 8.72104525566101
Epoch: 2, Steps: 1059 | Train Loss: 0.6013751 Vali Loss: 0.7707450 Test Loss: 2.0520105
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.4746819
	speed: 0.0343s/iter; left time: 649.9678s
	iters: 200, epoch: 3 | loss: 0.2669331
	speed: 0.0079s/iter; left time: 148.5147s
	iters: 300, epoch: 3 | loss: 0.4939574
	speed: 0.0073s/iter; left time: 137.7497s
	iters: 400, epoch: 3 | loss: 0.2672248
	speed: 0.0066s/iter; left time: 123.7358s
	iters: 500, epoch: 3 | loss: 0.5452157
	speed: 0.0090s/iter; left time: 167.3108s
	iters: 600, epoch: 3 | loss: 0.4847579
	speed: 0.0083s/iter; left time: 153.0910s
	iters: 700, epoch: 3 | loss: 0.2770663
	speed: 0.0061s/iter; left time: 111.3519s
	iters: 800, epoch: 3 | loss: 0.4542514
	speed: 0.0085s/iter; left time: 154.8757s
	iters: 900, epoch: 3 | loss: 0.4149827
	speed: 0.0094s/iter; left time: 171.1848s
	iters: 1000, epoch: 3 | loss: 0.3273989
	speed: 0.0087s/iter; left time: 156.5799s
Epoch: 3 cost time: 8.496703386306763
Epoch: 3, Steps: 1059 | Train Loss: 0.4368332 Vali Loss: 0.3159679 Test Loss: 0.5234169
Validation loss decreased (0.502146 --> 0.315968).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.3245052
	speed: 0.0399s/iter; left time: 714.5234s
	iters: 200, epoch: 4 | loss: 0.3871909
	speed: 0.0087s/iter; left time: 155.0992s
	iters: 300, epoch: 4 | loss: 0.3534592
	speed: 0.0092s/iter; left time: 162.2184s
	iters: 400, epoch: 4 | loss: 0.6647839
	speed: 0.0095s/iter; left time: 166.7683s
	iters: 500, epoch: 4 | loss: 0.2209066
	speed: 0.0082s/iter; left time: 143.0304s
	iters: 600, epoch: 4 | loss: 0.2293222
	speed: 0.0081s/iter; left time: 141.5500s
	iters: 700, epoch: 4 | loss: 0.3265376
	speed: 0.0084s/iter; left time: 145.2864s
	iters: 800, epoch: 4 | loss: 0.1977479
	speed: 0.0083s/iter; left time: 142.9648s
	iters: 900, epoch: 4 | loss: 0.2595103
	speed: 0.0083s/iter; left time: 142.3346s
	iters: 1000, epoch: 4 | loss: 0.6899726
	speed: 0.0083s/iter; left time: 140.3333s
Epoch: 4 cost time: 9.120566606521606
Epoch: 4, Steps: 1059 | Train Loss: 0.3917039 Vali Loss: 0.3256178 Test Loss: 0.6656470
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.7324183
	speed: 0.0330s/iter; left time: 555.7651s
	iters: 200, epoch: 5 | loss: 0.3183473
	speed: 0.0087s/iter; left time: 145.9052s
	iters: 300, epoch: 5 | loss: 0.1596002
	speed: 0.0085s/iter; left time: 141.5401s
	iters: 400, epoch: 5 | loss: 0.2610192
	speed: 0.0085s/iter; left time: 140.1909s
	iters: 500, epoch: 5 | loss: 0.2915667
	speed: 0.0087s/iter; left time: 142.6191s
	iters: 600, epoch: 5 | loss: 0.3532846
	speed: 0.0093s/iter; left time: 151.8915s
	iters: 700, epoch: 5 | loss: 0.2784590
	speed: 0.0096s/iter; left time: 156.4109s
	iters: 800, epoch: 5 | loss: 0.4916590
	speed: 0.0096s/iter; left time: 155.0438s
	iters: 900, epoch: 5 | loss: 0.3861409
	speed: 0.0079s/iter; left time: 126.4693s
	iters: 1000, epoch: 5 | loss: 0.3315870
	speed: 0.0086s/iter; left time: 136.4844s
Epoch: 5 cost time: 9.251139879226685
Epoch: 5, Steps: 1059 | Train Loss: 0.3731832 Vali Loss: 0.2417307 Test Loss: 0.3731039
Validation loss decreased (0.315968 --> 0.241731).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.2631825
	speed: 0.0317s/iter; left time: 499.6642s
	iters: 200, epoch: 6 | loss: 0.4073531
	speed: 0.0080s/iter; left time: 125.0262s
	iters: 300, epoch: 6 | loss: 0.3482638
	speed: 0.0071s/iter; left time: 110.4217s
	iters: 400, epoch: 6 | loss: 0.3649968
	speed: 0.0080s/iter; left time: 124.5233s
	iters: 500, epoch: 6 | loss: 0.1739290
	speed: 0.0079s/iter; left time: 121.4194s
	iters: 600, epoch: 6 | loss: 0.2338687
	speed: 0.0088s/iter; left time: 134.8704s
	iters: 700, epoch: 6 | loss: 0.1822230
	speed: 0.0093s/iter; left time: 141.2110s
	iters: 800, epoch: 6 | loss: 0.4883260
	speed: 0.0086s/iter; left time: 129.2247s
	iters: 900, epoch: 6 | loss: 0.2765212
	speed: 0.0078s/iter; left time: 116.9321s
	iters: 1000, epoch: 6 | loss: 0.3904213
	speed: 0.0083s/iter; left time: 123.4370s
Epoch: 6 cost time: 8.67927098274231
Epoch: 6, Steps: 1059 | Train Loss: 0.3623610 Vali Loss: 0.2666448 Test Loss: 0.4686879
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.2530899
	speed: 0.0296s/iter; left time: 435.7955s
	iters: 200, epoch: 7 | loss: 0.2653687
	speed: 0.0084s/iter; left time: 122.1640s
	iters: 300, epoch: 7 | loss: 0.4925797
	speed: 0.0075s/iter; left time: 109.5336s
	iters: 400, epoch: 7 | loss: 0.8751237
	speed: 0.0087s/iter; left time: 124.9620s
	iters: 500, epoch: 7 | loss: 0.2292771
	speed: 0.0087s/iter; left time: 124.3886s
	iters: 600, epoch: 7 | loss: 0.5234978
	speed: 0.0080s/iter; left time: 113.3112s
	iters: 700, epoch: 7 | loss: 0.3861496
	speed: 0.0082s/iter; left time: 115.8829s
	iters: 800, epoch: 7 | loss: 0.2417909
	speed: 0.0089s/iter; left time: 124.4325s
	iters: 900, epoch: 7 | loss: 0.3239357
	speed: 0.0067s/iter; left time: 93.8782s
	iters: 1000, epoch: 7 | loss: 0.1596210
	speed: 0.0085s/iter; left time: 117.5413s
Epoch: 7 cost time: 8.69193983078003
Epoch: 7, Steps: 1059 | Train Loss: 0.3557113 Vali Loss: 0.3191539 Test Loss: 0.6328911
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.3685535
	speed: 0.0339s/iter; left time: 462.7145s
	iters: 200, epoch: 8 | loss: 0.5694052
	speed: 0.0081s/iter; left time: 110.4888s
	iters: 300, epoch: 8 | loss: 0.3032290
	speed: 0.0087s/iter; left time: 116.6703s
	iters: 400, epoch: 8 | loss: 0.4485756
	speed: 0.0081s/iter; left time: 108.0349s
	iters: 500, epoch: 8 | loss: 0.2472620
	speed: 0.0084s/iter; left time: 111.3529s
	iters: 600, epoch: 8 | loss: 0.3465350
	speed: 0.0080s/iter; left time: 105.5155s
	iters: 700, epoch: 8 | loss: 0.4682669
	speed: 0.0089s/iter; left time: 116.8604s
	iters: 800, epoch: 8 | loss: 0.6546842
	speed: 0.0090s/iter; left time: 117.2512s
	iters: 900, epoch: 8 | loss: 0.4282226
	speed: 0.0072s/iter; left time: 92.1122s
	iters: 1000, epoch: 8 | loss: 0.2954423
	speed: 0.0081s/iter; left time: 103.3213s
Epoch: 8 cost time: 8.757755517959595
Epoch: 8, Steps: 1059 | Train Loss: 0.3524030 Vali Loss: 0.3149281 Test Loss: 0.6145270
EarlyStopping counter: 3 out of 5
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.2397316
	speed: 0.0349s/iter; left time: 440.1667s
	iters: 200, epoch: 9 | loss: 0.7103004
	speed: 0.0074s/iter; left time: 92.6803s
	iters: 300, epoch: 9 | loss: 0.3491652
	speed: 0.0079s/iter; left time: 98.2957s
	iters: 400, epoch: 9 | loss: 0.2078680
	speed: 0.0087s/iter; left time: 107.4846s
	iters: 500, epoch: 9 | loss: 0.2706070
	speed: 0.0085s/iter; left time: 103.4414s
	iters: 600, epoch: 9 | loss: 0.8700237
	speed: 0.0093s/iter; left time: 112.0274s
	iters: 700, epoch: 9 | loss: 0.2903158
	speed: 0.0094s/iter; left time: 113.4416s
	iters: 800, epoch: 9 | loss: 0.3134620
	speed: 0.0086s/iter; left time: 102.6882s
	iters: 900, epoch: 9 | loss: 0.5442064
	speed: 0.0083s/iter; left time: 97.4308s
	iters: 1000, epoch: 9 | loss: 0.1705766
	speed: 0.0085s/iter; left time: 99.1974s
Epoch: 9 cost time: 8.886885404586792
Epoch: 9, Steps: 1059 | Train Loss: 0.3504097 Vali Loss: 0.3024246 Test Loss: 0.5931748
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.2996075
	speed: 0.0348s/iter; left time: 401.7154s
	iters: 200, epoch: 10 | loss: 0.5279281
	speed: 0.0080s/iter; left time: 91.3344s
	iters: 300, epoch: 10 | loss: 0.4172388
	speed: 0.0087s/iter; left time: 98.7451s
	iters: 400, epoch: 10 | loss: 0.5303766
	speed: 0.0081s/iter; left time: 91.6229s
	iters: 500, epoch: 10 | loss: 0.3094300
	speed: 0.0085s/iter; left time: 94.2472s
	iters: 600, epoch: 10 | loss: 0.4998261
	speed: 0.0097s/iter; left time: 106.8629s
	iters: 700, epoch: 10 | loss: 0.2989182
	speed: 0.0091s/iter; left time: 99.2180s
	iters: 800, epoch: 10 | loss: 0.2595762
	speed: 0.0089s/iter; left time: 97.0311s
	iters: 900, epoch: 10 | loss: 0.2454412
	speed: 0.0084s/iter; left time: 89.7688s
	iters: 1000, epoch: 10 | loss: 0.2970159
	speed: 0.0079s/iter; left time: 84.4382s
Epoch: 10 cost time: 9.022117376327515
Epoch: 10, Steps: 1059 | Train Loss: 0.3493515 Vali Loss: 0.2912507 Test Loss: 0.5544816
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTm2_336_336_Linear_ETTm2_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed28649<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
mse:0.37340235710144043, mae:0.4071914851665497
