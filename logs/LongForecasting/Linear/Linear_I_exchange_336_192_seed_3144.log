Args in experiment:
Namespace(activation='gelu', batch_size=8, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='exchange_rate.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=8, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='mse', lradj='type1', model='Linear', model_id='Exchange_336_192', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=192, root_path='./dataset/', save_pred_values=False, seed=3144, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : Exchange_336_192_Linear_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3144>>>>>>>>>>>>>>>>>>>>>>>>>>
train 4784
val 569
test 1326
	iters: 100, epoch: 1 | loss: 0.4084140
	speed: 0.0042s/iter; left time: 49.9655s
	iters: 200, epoch: 1 | loss: 0.1865153
	speed: 0.0041s/iter; left time: 48.4556s
	iters: 300, epoch: 1 | loss: 0.1612756
	speed: 0.0045s/iter; left time: 52.7499s
	iters: 400, epoch: 1 | loss: 0.1743147
	speed: 0.0040s/iter; left time: 45.8971s
	iters: 500, epoch: 1 | loss: 0.2892608
	speed: 0.0043s/iter; left time: 48.7353s
Epoch: 1 cost time: 2.5159192085266113
Epoch: 1, Steps: 598 | Train Loss: 0.2681032 Vali Loss: 0.7528654 Test Loss: 0.3147693
Validation loss decreased (inf --> 0.752865).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1790263
	speed: 0.0107s/iter; left time: 120.4455s
	iters: 200, epoch: 2 | loss: 0.3006500
	speed: 0.0046s/iter; left time: 51.0149s
	iters: 300, epoch: 2 | loss: 0.1993889
	speed: 0.0043s/iter; left time: 47.4907s
	iters: 400, epoch: 2 | loss: 0.3152806
	speed: 0.0042s/iter; left time: 46.2638s
	iters: 500, epoch: 2 | loss: 0.1618532
	speed: 0.0044s/iter; left time: 47.7975s
Epoch: 2 cost time: 2.6429171562194824
Epoch: 2, Steps: 598 | Train Loss: 0.2330649 Vali Loss: 0.4362099 Test Loss: 0.2338741
Validation loss decreased (0.752865 --> 0.436210).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.2860515
	speed: 0.0107s/iter; left time: 114.3625s
	iters: 200, epoch: 3 | loss: 0.2068383
	speed: 0.0042s/iter; left time: 44.6059s
	iters: 300, epoch: 3 | loss: 0.1641107
	speed: 0.0041s/iter; left time: 43.3315s
	iters: 400, epoch: 3 | loss: 0.1850355
	speed: 0.0042s/iter; left time: 43.3468s
	iters: 500, epoch: 3 | loss: 0.2908793
	speed: 0.0044s/iter; left time: 44.8582s
Epoch: 3 cost time: 2.4948816299438477
Epoch: 3, Steps: 598 | Train Loss: 0.2230475 Vali Loss: 0.5402279 Test Loss: 0.1896861
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.3604428
	speed: 0.0100s/iter; left time: 101.0136s
	iters: 200, epoch: 4 | loss: 0.1686536
	speed: 0.0043s/iter; left time: 42.5887s
	iters: 300, epoch: 4 | loss: 0.2968372
	speed: 0.0035s/iter; left time: 34.5468s
	iters: 400, epoch: 4 | loss: 0.1379156
	speed: 0.0035s/iter; left time: 34.4773s
	iters: 500, epoch: 4 | loss: 0.3753912
	speed: 0.0039s/iter; left time: 37.8163s
Epoch: 4 cost time: 2.291607141494751
Epoch: 4, Steps: 598 | Train Loss: 0.2180195 Vali Loss: 0.4561420 Test Loss: 0.1986518
EarlyStopping counter: 2 out of 5
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.4106678
	speed: 0.0095s/iter; left time: 89.9767s
	iters: 200, epoch: 5 | loss: 0.3203857
	speed: 0.0041s/iter; left time: 38.1317s
	iters: 300, epoch: 5 | loss: 0.1738840
	speed: 0.0038s/iter; left time: 35.0606s
	iters: 400, epoch: 5 | loss: 0.1867162
	speed: 0.0038s/iter; left time: 34.6797s
	iters: 500, epoch: 5 | loss: 0.2941304
	speed: 0.0038s/iter; left time: 34.5989s
Epoch: 5 cost time: 2.269460439682007
Epoch: 5, Steps: 598 | Train Loss: 0.2160766 Vali Loss: 0.4693268 Test Loss: 0.1873571
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.2381946
	speed: 0.0093s/iter; left time: 82.0626s
	iters: 200, epoch: 6 | loss: 0.1539481
	speed: 0.0044s/iter; left time: 38.6980s
	iters: 300, epoch: 6 | loss: 0.1613076
	speed: 0.0036s/iter; left time: 31.1289s
	iters: 400, epoch: 6 | loss: 0.5619469
	speed: 0.0031s/iter; left time: 26.5745s
	iters: 500, epoch: 6 | loss: 0.2177403
	speed: 0.0033s/iter; left time: 27.6401s
Epoch: 6 cost time: 2.2123987674713135
Epoch: 6, Steps: 598 | Train Loss: 0.2148949 Vali Loss: 0.5084591 Test Loss: 0.2033742
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1967843
	speed: 0.0096s/iter; left time: 79.1158s
	iters: 200, epoch: 7 | loss: 0.1430622
	speed: 0.0040s/iter; left time: 32.9370s
	iters: 300, epoch: 7 | loss: 0.2193048
	speed: 0.0035s/iter; left time: 28.1749s
	iters: 400, epoch: 7 | loss: 0.1493577
	speed: 0.0035s/iter; left time: 28.1616s
	iters: 500, epoch: 7 | loss: 0.1485112
	speed: 0.0039s/iter; left time: 30.4543s
Epoch: 7 cost time: 2.350313186645508
Epoch: 7, Steps: 598 | Train Loss: 0.2143554 Vali Loss: 0.4687179 Test Loss: 0.1839665
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : Exchange_336_192_Linear_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3144<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 1326
mse:0.2339085042476654, mae:0.3776049017906189
