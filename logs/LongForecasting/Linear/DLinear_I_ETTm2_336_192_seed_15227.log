Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='DLinear', model_id='ETTm2_336_192', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=192, root_path='./dataset/', save_pred_values=False, seed=15227, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTm2_336_192_DLinear_ETTm2_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15227>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34033
val 11329
test 11329
	iters: 100, epoch: 1 | loss: 0.3005379
	speed: 0.0106s/iter; left time: 225.3407s
	iters: 200, epoch: 1 | loss: 0.7303492
	speed: 0.0103s/iter; left time: 217.8367s
	iters: 300, epoch: 1 | loss: 0.5561396
	speed: 0.0109s/iter; left time: 227.9173s
	iters: 400, epoch: 1 | loss: 0.5240985
	speed: 0.0103s/iter; left time: 215.1198s
	iters: 500, epoch: 1 | loss: 0.4984025
	speed: 0.0102s/iter; left time: 212.1620s
	iters: 600, epoch: 1 | loss: 0.6204816
	speed: 0.0110s/iter; left time: 226.7336s
	iters: 700, epoch: 1 | loss: 0.4510565
	speed: 0.0104s/iter; left time: 213.0348s
	iters: 800, epoch: 1 | loss: 0.5320966
	speed: 0.0088s/iter; left time: 179.5043s
	iters: 900, epoch: 1 | loss: 0.6688482
	speed: 0.0113s/iter; left time: 229.1430s
	iters: 1000, epoch: 1 | loss: 0.4757658
	speed: 0.0120s/iter; left time: 243.5692s
Epoch: 1 cost time: 11.344096183776855
Epoch: 1, Steps: 1063 | Train Loss: 0.5436368 Vali Loss: 0.5584904 Test Loss: 1.3762298
Validation loss decreased (inf --> 0.558490).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 1.0173327
	speed: 0.0452s/iter; left time: 909.0324s
	iters: 200, epoch: 2 | loss: 0.4581550
	speed: 0.0114s/iter; left time: 228.4235s
	iters: 300, epoch: 2 | loss: 0.4601258
	speed: 0.0117s/iter; left time: 233.0725s
	iters: 400, epoch: 2 | loss: 0.5304399
	speed: 0.0117s/iter; left time: 231.6657s
	iters: 500, epoch: 2 | loss: 0.5324818
	speed: 0.0109s/iter; left time: 213.7536s
	iters: 600, epoch: 2 | loss: 0.4972995
	speed: 0.0099s/iter; left time: 194.6362s
	iters: 700, epoch: 2 | loss: 0.4624730
	speed: 0.0118s/iter; left time: 230.5119s
	iters: 800, epoch: 2 | loss: 0.3716945
	speed: 0.0115s/iter; left time: 223.6752s
	iters: 900, epoch: 2 | loss: 0.3708565
	speed: 0.0118s/iter; left time: 228.5829s
	iters: 1000, epoch: 2 | loss: 0.5474633
	speed: 0.0113s/iter; left time: 216.5718s
Epoch: 2 cost time: 11.791044235229492
Epoch: 2, Steps: 1063 | Train Loss: 0.5414464 Vali Loss: 0.3552489 Test Loss: 0.7167513
Validation loss decreased (0.558490 --> 0.355249).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.3246055
	speed: 0.0430s/iter; left time: 817.7805s
	iters: 200, epoch: 3 | loss: 0.2540120
	speed: 0.0111s/iter; left time: 210.0186s
	iters: 300, epoch: 3 | loss: 0.3918906
	speed: 0.0104s/iter; left time: 196.1008s
	iters: 400, epoch: 3 | loss: 0.3767718
	speed: 0.0107s/iter; left time: 199.9449s
	iters: 500, epoch: 3 | loss: 0.2884732
	speed: 0.0124s/iter; left time: 230.8957s
	iters: 600, epoch: 3 | loss: 0.5408347
	speed: 0.0111s/iter; left time: 205.0512s
	iters: 700, epoch: 3 | loss: 0.5123863
	speed: 0.0103s/iter; left time: 190.4389s
	iters: 800, epoch: 3 | loss: 0.3237223
	speed: 0.0097s/iter; left time: 177.6796s
	iters: 900, epoch: 3 | loss: 0.3022192
	speed: 0.0101s/iter; left time: 184.7720s
	iters: 1000, epoch: 3 | loss: 0.2703636
	speed: 0.0109s/iter; left time: 198.2251s
Epoch: 3 cost time: 11.15250825881958
Epoch: 3, Steps: 1063 | Train Loss: 0.3731164 Vali Loss: 0.3301551 Test Loss: 0.6566695
Validation loss decreased (0.355249 --> 0.330155).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.4285875
	speed: 0.0438s/iter; left time: 786.7882s
	iters: 200, epoch: 4 | loss: 0.2338150
	speed: 0.0119s/iter; left time: 212.1708s
	iters: 300, epoch: 4 | loss: 0.3515133
	speed: 0.0097s/iter; left time: 172.0715s
	iters: 400, epoch: 4 | loss: 0.2656614
	speed: 0.0098s/iter; left time: 172.9510s
	iters: 500, epoch: 4 | loss: 0.2557138
	speed: 0.0113s/iter; left time: 198.2421s
	iters: 600, epoch: 4 | loss: 0.2086422
	speed: 0.0105s/iter; left time: 183.1434s
	iters: 700, epoch: 4 | loss: 0.2792344
	speed: 0.0110s/iter; left time: 191.5893s
	iters: 800, epoch: 4 | loss: 0.3422611
	speed: 0.0106s/iter; left time: 183.4907s
	iters: 900, epoch: 4 | loss: 0.2550028
	speed: 0.0088s/iter; left time: 151.6002s
	iters: 1000, epoch: 4 | loss: 0.2081060
	speed: 0.0105s/iter; left time: 179.9764s
Epoch: 4 cost time: 11.052313089370728
Epoch: 4, Steps: 1063 | Train Loss: 0.3233115 Vali Loss: 0.2481687 Test Loss: 0.4561796
Validation loss decreased (0.330155 --> 0.248169).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.2612006
	speed: 0.0428s/iter; left time: 724.4258s
	iters: 200, epoch: 5 | loss: 0.2319029
	speed: 0.0108s/iter; left time: 181.5828s
	iters: 300, epoch: 5 | loss: 0.2430437
	speed: 0.0114s/iter; left time: 190.8904s
	iters: 400, epoch: 5 | loss: 0.2531017
	speed: 0.0105s/iter; left time: 174.2728s
	iters: 500, epoch: 5 | loss: 0.2416979
	speed: 0.0103s/iter; left time: 169.8471s
	iters: 600, epoch: 5 | loss: 0.4126961
	speed: 0.0117s/iter; left time: 192.3720s
	iters: 700, epoch: 5 | loss: 0.2664592
	speed: 0.0112s/iter; left time: 183.3537s
	iters: 800, epoch: 5 | loss: 0.5457599
	speed: 0.0111s/iter; left time: 179.6588s
	iters: 900, epoch: 5 | loss: 0.2846725
	speed: 0.0121s/iter; left time: 194.6525s
	iters: 1000, epoch: 5 | loss: 0.4027870
	speed: 0.0099s/iter; left time: 158.4986s
Epoch: 5 cost time: 11.4584321975708
Epoch: 5, Steps: 1063 | Train Loss: 0.3005561 Vali Loss: 0.2305266 Test Loss: 0.4553236
Validation loss decreased (0.248169 --> 0.230527).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.2442792
	speed: 0.0454s/iter; left time: 718.6443s
	iters: 200, epoch: 6 | loss: 0.4529102
	speed: 0.0096s/iter; left time: 151.8012s
	iters: 300, epoch: 6 | loss: 0.3200264
	speed: 0.0099s/iter; left time: 154.9296s
	iters: 400, epoch: 6 | loss: 0.2021037
	speed: 0.0107s/iter; left time: 165.5661s
	iters: 500, epoch: 6 | loss: 0.3555029
	speed: 0.0115s/iter; left time: 178.1433s
	iters: 600, epoch: 6 | loss: 0.6088046
	speed: 0.0106s/iter; left time: 161.9500s
	iters: 700, epoch: 6 | loss: 0.2917343
	speed: 0.0111s/iter; left time: 169.2794s
	iters: 800, epoch: 6 | loss: 0.3565599
	speed: 0.0107s/iter; left time: 161.9627s
	iters: 900, epoch: 6 | loss: 0.2693470
	speed: 0.0108s/iter; left time: 163.1005s
	iters: 1000, epoch: 6 | loss: 0.6288800
	speed: 0.0107s/iter; left time: 159.2072s
Epoch: 6 cost time: 11.229935884475708
Epoch: 6, Steps: 1063 | Train Loss: 0.2887148 Vali Loss: 0.2334367 Test Loss: 0.4469552
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.6481084
	speed: 0.0447s/iter; left time: 660.7846s
	iters: 200, epoch: 7 | loss: 0.5208015
	speed: 0.0103s/iter; left time: 150.8368s
	iters: 300, epoch: 7 | loss: 0.1480699
	speed: 0.0105s/iter; left time: 153.1418s
	iters: 400, epoch: 7 | loss: 0.2670247
	speed: 0.0108s/iter; left time: 156.2832s
	iters: 500, epoch: 7 | loss: 0.3589313
	speed: 0.0110s/iter; left time: 157.8199s
	iters: 600, epoch: 7 | loss: 0.2145227
	speed: 0.0107s/iter; left time: 152.7509s
	iters: 700, epoch: 7 | loss: 0.3204869
	speed: 0.0106s/iter; left time: 150.4926s
	iters: 800, epoch: 7 | loss: 0.1451905
	speed: 0.0108s/iter; left time: 152.3958s
	iters: 900, epoch: 7 | loss: 0.5350159
	speed: 0.0115s/iter; left time: 160.8407s
	iters: 1000, epoch: 7 | loss: 0.2262471
	speed: 0.0108s/iter; left time: 150.1131s
Epoch: 7 cost time: 11.40950608253479
Epoch: 7, Steps: 1063 | Train Loss: 0.2816007 Vali Loss: 0.1780106 Test Loss: 0.2726452
Validation loss decreased (0.230527 --> 0.178011).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.1552513
	speed: 0.0466s/iter; left time: 639.1429s
	iters: 200, epoch: 8 | loss: 0.2320880
	speed: 0.0103s/iter; left time: 140.0690s
	iters: 300, epoch: 8 | loss: 0.2028523
	speed: 0.0115s/iter; left time: 154.9825s
	iters: 400, epoch: 8 | loss: 0.1994641
	speed: 0.0112s/iter; left time: 149.7858s
	iters: 500, epoch: 8 | loss: 0.3725238
	speed: 0.0113s/iter; left time: 151.1007s
	iters: 600, epoch: 8 | loss: 0.1777694
	speed: 0.0106s/iter; left time: 140.0077s
	iters: 700, epoch: 8 | loss: 0.1870387
	speed: 0.0092s/iter; left time: 120.7204s
	iters: 800, epoch: 8 | loss: 0.3061391
	speed: 0.0118s/iter; left time: 153.9227s
	iters: 900, epoch: 8 | loss: 0.1722361
	speed: 0.0117s/iter; left time: 151.1681s
	iters: 1000, epoch: 8 | loss: 0.2176204
	speed: 0.0108s/iter; left time: 138.8536s
Epoch: 8 cost time: 11.585426092147827
Epoch: 8, Steps: 1063 | Train Loss: 0.2779486 Vali Loss: 0.2017903 Test Loss: 0.3533440
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.2846736
	speed: 0.0493s/iter; left time: 624.3970s
	iters: 200, epoch: 9 | loss: 0.3603943
	speed: 0.0104s/iter; left time: 130.6350s
	iters: 300, epoch: 9 | loss: 0.2729522
	speed: 0.0106s/iter; left time: 131.6752s
	iters: 400, epoch: 9 | loss: 0.2581886
	speed: 0.0102s/iter; left time: 126.3079s
	iters: 500, epoch: 9 | loss: 0.3714579
	speed: 0.0105s/iter; left time: 128.8479s
	iters: 600, epoch: 9 | loss: 0.1755290
	speed: 0.0103s/iter; left time: 124.6430s
	iters: 700, epoch: 9 | loss: 0.2527322
	speed: 0.0112s/iter; left time: 134.8387s
	iters: 800, epoch: 9 | loss: 0.3259991
	speed: 0.0110s/iter; left time: 131.1768s
	iters: 900, epoch: 9 | loss: 0.2516104
	speed: 0.0106s/iter; left time: 125.9252s
	iters: 1000, epoch: 9 | loss: 0.2708017
	speed: 0.0097s/iter; left time: 113.8201s
Epoch: 9 cost time: 11.134119749069214
Epoch: 9, Steps: 1063 | Train Loss: 0.2760054 Vali Loss: 0.1975772 Test Loss: 0.3429322
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.3670124
	speed: 0.0486s/iter; left time: 562.9341s
	iters: 200, epoch: 10 | loss: 0.1484792
	speed: 0.0103s/iter; left time: 118.5107s
	iters: 300, epoch: 10 | loss: 0.2244749
	speed: 0.0101s/iter; left time: 115.4342s
	iters: 400, epoch: 10 | loss: 0.1943924
	speed: 0.0109s/iter; left time: 122.6242s
	iters: 500, epoch: 10 | loss: 0.3478319
	speed: 0.0113s/iter; left time: 127.0293s
	iters: 600, epoch: 10 | loss: 0.2519480
	speed: 0.0124s/iter; left time: 137.4566s
	iters: 700, epoch: 10 | loss: 0.1435647
	speed: 0.0110s/iter; left time: 120.4141s
	iters: 800, epoch: 10 | loss: 0.2846490
	speed: 0.0108s/iter; left time: 117.5667s
	iters: 900, epoch: 10 | loss: 0.1550664
	speed: 0.0098s/iter; left time: 105.4674s
	iters: 1000, epoch: 10 | loss: 0.4050788
	speed: 0.0092s/iter; left time: 98.3085s
Epoch: 10 cost time: 11.172037601470947
Epoch: 10, Steps: 1063 | Train Loss: 0.2748459 Vali Loss: 0.1915324 Test Loss: 0.3265858
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.2587634
	speed: 0.0482s/iter; left time: 507.9376s
	iters: 200, epoch: 11 | loss: 0.1631629
	speed: 0.0108s/iter; left time: 112.2408s
	iters: 300, epoch: 11 | loss: 0.2244941
	speed: 0.0115s/iter; left time: 118.6271s
	iters: 400, epoch: 11 | loss: 0.1817528
	speed: 0.0117s/iter; left time: 119.6309s
	iters: 500, epoch: 11 | loss: 0.1688472
	speed: 0.0108s/iter; left time: 109.1410s
	iters: 600, epoch: 11 | loss: 0.3174641
	speed: 0.0107s/iter; left time: 107.4409s
	iters: 700, epoch: 11 | loss: 0.3095084
	speed: 0.0108s/iter; left time: 106.9761s
	iters: 800, epoch: 11 | loss: 0.4983095
	speed: 0.0106s/iter; left time: 103.8385s
	iters: 900, epoch: 11 | loss: 0.1511828
	speed: 0.0088s/iter; left time: 85.7345s
	iters: 1000, epoch: 11 | loss: 0.2416234
	speed: 0.0095s/iter; left time: 91.2100s
Epoch: 11 cost time: 11.066802024841309
Epoch: 11, Steps: 1063 | Train Loss: 0.2741384 Vali Loss: 0.1953253 Test Loss: 0.3381184
EarlyStopping counter: 4 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.1894796
	speed: 0.0468s/iter; left time: 442.6290s
	iters: 200, epoch: 12 | loss: 0.2524983
	speed: 0.0116s/iter; left time: 108.2124s
	iters: 300, epoch: 12 | loss: 0.3435401
	speed: 0.0117s/iter; left time: 108.8236s
	iters: 400, epoch: 12 | loss: 0.2917995
	speed: 0.0105s/iter; left time: 96.5428s
	iters: 500, epoch: 12 | loss: 0.2281490
	speed: 0.0101s/iter; left time: 91.1645s
	iters: 600, epoch: 12 | loss: 0.2404246
	speed: 0.0102s/iter; left time: 91.7873s
	iters: 700, epoch: 12 | loss: 0.1932552
	speed: 0.0103s/iter; left time: 91.5599s
	iters: 800, epoch: 12 | loss: 0.2576171
	speed: 0.0110s/iter; left time: 96.6263s
	iters: 900, epoch: 12 | loss: 0.2464343
	speed: 0.0112s/iter; left time: 97.1970s
	iters: 1000, epoch: 12 | loss: 0.3293457
	speed: 0.0114s/iter; left time: 97.5276s
Epoch: 12 cost time: 11.573967695236206
Epoch: 12, Steps: 1063 | Train Loss: 0.2739602 Vali Loss: 0.1965102 Test Loss: 0.3409141
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTm2_336_192_DLinear_ETTm2_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15227<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
mse:0.2731187045574188, mae:0.33433520793914795
