Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTh2', data_path='ETTh2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.05, loss='mse', lradj='type1', model='NLinear', model_id='ETTh2_96_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=32598, seq_len=96, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTh2_96_96_NLinear_ETTh2_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed32598>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8449
data_set:  <data_provider.data_loader.Dataset_ETT_hour object at 0x0000021619A80D68>
val 2785
data_set:  <data_provider.data_loader.Dataset_ETT_hour object at 0x0000021667066DD8>
test 2785
data_set:  <data_provider.data_loader.Dataset_ETT_hour object at 0x0000021619A80128>
Total number of trainable parameters: 65184
Total number of parameters: 65184
	iters: 100, epoch: 1 | loss: 0.8875263
	speed: 0.0034s/iter; left time: 35.8080s
	iters: 200, epoch: 1 | loss: 0.8505554
	speed: 0.0029s/iter; left time: 29.8981s
	iters: 300, epoch: 1 | loss: 3.2298868
	speed: 0.0036s/iter; left time: 36.6035s
	iters: 400, epoch: 1 | loss: 1.7854565
	speed: 0.0035s/iter; left time: 35.9746s
	iters: 500, epoch: 1 | loss: 1.3859091
	speed: 0.0033s/iter; left time: 32.7085s
Epoch: 1 cost time: 1.7413313388824463
Epoch: 1, Steps: 528 | Train Loss: 1.8535244 Vali Loss: 1.0428064 Test Loss: 1.5530148
Validation loss decreased (inf --> 1.042806).  Saving model ...
Updating learning rate to 0.05
	iters: 100, epoch: 2 | loss: 1.0744256
	speed: 0.0088s/iter; left time: 87.3030s
	iters: 200, epoch: 2 | loss: 0.8102668
	speed: 0.0033s/iter; left time: 32.3822s
	iters: 300, epoch: 2 | loss: 1.4836920
	speed: 0.0033s/iter; left time: 32.3108s
	iters: 400, epoch: 2 | loss: 1.0900286
	speed: 0.0032s/iter; left time: 31.1048s
	iters: 500, epoch: 2 | loss: 1.0346158
	speed: 0.0025s/iter; left time: 24.1998s
Epoch: 2 cost time: 1.6442346572875977
Epoch: 2, Steps: 528 | Train Loss: 1.7176310 Vali Loss: 1.3195552 Test Loss: 1.5844545
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.025
	iters: 100, epoch: 3 | loss: 0.2735589
	speed: 0.0067s/iter; left time: 62.8251s
	iters: 200, epoch: 3 | loss: 0.4601108
	speed: 0.0034s/iter; left time: 31.4395s
	iters: 300, epoch: 3 | loss: 0.3757865
	speed: 0.0027s/iter; left time: 25.2107s
	iters: 400, epoch: 3 | loss: 0.8647727
	speed: 0.0027s/iter; left time: 24.7895s
	iters: 500, epoch: 3 | loss: 0.3098178
	speed: 0.0029s/iter; left time: 26.1381s
Epoch: 3 cost time: 1.5213043689727783
Epoch: 3, Steps: 528 | Train Loss: 0.6393424 Vali Loss: 0.2994154 Test Loss: 0.3977579
Validation loss decreased (1.042806 --> 0.299415).  Saving model ...
Updating learning rate to 0.0125
	iters: 100, epoch: 4 | loss: 0.3165572
	speed: 0.0070s/iter; left time: 62.0230s
	iters: 200, epoch: 4 | loss: 0.9593870
	speed: 0.0030s/iter; left time: 26.2406s
	iters: 300, epoch: 4 | loss: 1.0915784
	speed: 0.0033s/iter; left time: 28.4737s
	iters: 400, epoch: 4 | loss: 0.3663995
	speed: 0.0027s/iter; left time: 22.7533s
	iters: 500, epoch: 4 | loss: 0.2092219
	speed: 0.0025s/iter; left time: 21.2098s
Epoch: 4 cost time: 1.4934682846069336
Epoch: 4, Steps: 528 | Train Loss: 0.5000186 Vali Loss: 0.2595180 Test Loss: 0.3474361
Validation loss decreased (0.299415 --> 0.259518).  Saving model ...
Updating learning rate to 0.00625
	iters: 100, epoch: 5 | loss: 0.2546629
	speed: 0.0079s/iter; left time: 66.0812s
	iters: 200, epoch: 5 | loss: 0.2712323
	speed: 0.0029s/iter; left time: 24.0213s
	iters: 300, epoch: 5 | loss: 0.2436125
	speed: 0.0031s/iter; left time: 25.0953s
	iters: 400, epoch: 5 | loss: 0.2729947
	speed: 0.0025s/iter; left time: 20.5248s
	iters: 500, epoch: 5 | loss: 0.5855659
	speed: 0.0034s/iter; left time: 26.8972s
Epoch: 5 cost time: 1.5157160758972168
Epoch: 5, Steps: 528 | Train Loss: 0.4451269 Vali Loss: 0.2217987 Test Loss: 0.3011204
Validation loss decreased (0.259518 --> 0.221799).  Saving model ...
Updating learning rate to 0.003125
	iters: 100, epoch: 6 | loss: 0.2960227
	speed: 0.0088s/iter; left time: 68.4796s
	iters: 200, epoch: 6 | loss: 0.2873163
	speed: 0.0025s/iter; left time: 19.2815s
	iters: 300, epoch: 6 | loss: 0.2574626
	speed: 0.0027s/iter; left time: 20.2365s
	iters: 400, epoch: 6 | loss: 0.3608361
	speed: 0.0028s/iter; left time: 21.1941s
	iters: 500, epoch: 6 | loss: 0.2030332
	speed: 0.0027s/iter; left time: 19.6844s
Epoch: 6 cost time: 1.5468201637268066
Epoch: 6, Steps: 528 | Train Loss: 0.4257653 Vali Loss: 0.2388145 Test Loss: 0.3188918
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0015625
	iters: 100, epoch: 7 | loss: 0.3711442
	speed: 0.0066s/iter; left time: 47.8745s
	iters: 200, epoch: 7 | loss: 0.2673938
	speed: 0.0025s/iter; left time: 18.2360s
	iters: 300, epoch: 7 | loss: 0.4037801
	speed: 0.0028s/iter; left time: 19.7121s
	iters: 400, epoch: 7 | loss: 0.7988014
	speed: 0.0023s/iter; left time: 16.3510s
	iters: 500, epoch: 7 | loss: 0.8922078
	speed: 0.0020s/iter; left time: 13.5113s
Epoch: 7 cost time: 1.2916176319122314
Epoch: 7, Steps: 528 | Train Loss: 0.4144183 Vali Loss: 0.2139591 Test Loss: 0.2954304
Validation loss decreased (0.221799 --> 0.213959).  Saving model ...
Updating learning rate to 0.00078125
	iters: 100, epoch: 8 | loss: 0.3241903
	speed: 0.0068s/iter; left time: 45.9322s
	iters: 200, epoch: 8 | loss: 0.2489483
	speed: 0.0030s/iter; left time: 19.6840s
	iters: 300, epoch: 8 | loss: 0.2514272
	speed: 0.0025s/iter; left time: 16.5169s
	iters: 400, epoch: 8 | loss: 0.5749481
	speed: 0.0034s/iter; left time: 22.2319s
	iters: 500, epoch: 8 | loss: 0.9895932
	speed: 0.0034s/iter; left time: 21.9355s
Epoch: 8 cost time: 1.5780560970306396
Epoch: 8, Steps: 528 | Train Loss: 0.4085792 Vali Loss: 0.2097126 Test Loss: 0.2918176
Validation loss decreased (0.213959 --> 0.209713).  Saving model ...
Updating learning rate to 0.000390625
	iters: 100, epoch: 9 | loss: 0.8015464
	speed: 0.0084s/iter; left time: 52.3422s
	iters: 200, epoch: 9 | loss: 0.4869111
	speed: 0.0029s/iter; left time: 17.4906s
	iters: 300, epoch: 9 | loss: 0.2811383
	speed: 0.0028s/iter; left time: 16.9654s
	iters: 400, epoch: 9 | loss: 0.2621046
	speed: 0.0030s/iter; left time: 17.6392s
	iters: 500, epoch: 9 | loss: 0.3828618
	speed: 0.0028s/iter; left time: 16.4121s
Epoch: 9 cost time: 1.5280580520629883
Epoch: 9, Steps: 528 | Train Loss: 0.4058917 Vali Loss: 0.2115336 Test Loss: 0.2907321
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0001953125
	iters: 100, epoch: 10 | loss: 0.8950779
	speed: 0.0070s/iter; left time: 40.1595s
	iters: 200, epoch: 10 | loss: 0.3783251
	speed: 0.0033s/iter; left time: 18.3879s
	iters: 300, epoch: 10 | loss: 0.2522079
	speed: 0.0030s/iter; left time: 16.3522s
	iters: 400, epoch: 10 | loss: 0.8639988
	speed: 0.0033s/iter; left time: 17.7419s
	iters: 500, epoch: 10 | loss: 0.3749425
	speed: 0.0033s/iter; left time: 17.4297s
Epoch: 10 cost time: 1.6294124126434326
Epoch: 10, Steps: 528 | Train Loss: 0.4037235 Vali Loss: 0.2109024 Test Loss: 0.2918997
EarlyStopping counter: 2 out of 5
Updating learning rate to 9.765625e-05
	iters: 100, epoch: 11 | loss: 0.2645834
	speed: 0.0075s/iter; left time: 38.8552s
	iters: 200, epoch: 11 | loss: 0.1975531
	speed: 0.0023s/iter; left time: 11.9135s
	iters: 300, epoch: 11 | loss: 0.1634930
	speed: 0.0027s/iter; left time: 13.2129s
	iters: 400, epoch: 11 | loss: 0.2036763
	speed: 0.0028s/iter; left time: 13.7576s
	iters: 500, epoch: 11 | loss: 0.4711958
	speed: 0.0030s/iter; left time: 14.1658s
Epoch: 11 cost time: 1.4585270881652832
Epoch: 11, Steps: 528 | Train Loss: 0.4025426 Vali Loss: 0.2102904 Test Loss: 0.2908748
EarlyStopping counter: 3 out of 5
Updating learning rate to 4.8828125e-05
	iters: 100, epoch: 12 | loss: 0.7637865
	speed: 0.0073s/iter; left time: 34.1961s
	iters: 200, epoch: 12 | loss: 0.5903903
	speed: 0.0022s/iter; left time: 9.9393s
	iters: 300, epoch: 12 | loss: 0.2347384
	speed: 0.0023s/iter; left time: 10.4315s
	iters: 400, epoch: 12 | loss: 0.2420692
	speed: 0.0023s/iter; left time: 10.2022s
	iters: 500, epoch: 12 | loss: 0.2364699
	speed: 0.0034s/iter; left time: 14.6219s
Epoch: 12 cost time: 1.4216289520263672
Epoch: 12, Steps: 528 | Train Loss: 0.4019952 Vali Loss: 0.2107139 Test Loss: 0.2905633
EarlyStopping counter: 4 out of 5
Updating learning rate to 2.44140625e-05
	iters: 100, epoch: 13 | loss: 0.1325392
	speed: 0.0072s/iter; left time: 29.6456s
	iters: 200, epoch: 13 | loss: 0.4747404
	speed: 0.0025s/iter; left time: 10.0784s
	iters: 300, epoch: 13 | loss: 0.2208331
	speed: 0.0020s/iter; left time: 7.9637s
	iters: 400, epoch: 13 | loss: 0.1606425
	speed: 0.0031s/iter; left time: 11.9676s
	iters: 500, epoch: 13 | loss: 0.1851595
	speed: 0.0030s/iter; left time: 11.0479s
Epoch: 13 cost time: 1.3752505779266357
Epoch: 13, Steps: 528 | Train Loss: 0.4016772 Vali Loss: 0.2105498 Test Loss: 0.2904425
EarlyStopping counter: 5 out of 5
Early stopping
Total training time: 24.7955 seconds
>>>>>>>testing : ETTh2_96_96_NLinear_ETTh2_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed32598<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
data_set:  <data_provider.data_loader.Dataset_ETT_hour object at 0x000002165C4C1080>
mse:0.29285967350006104, mae:0.34290429949760437
