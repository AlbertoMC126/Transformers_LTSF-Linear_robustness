Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='Linear', model_id='weather_336_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=3293, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : weather_336_96_Linear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3293>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36456
val 5175
test 10444
	iters: 100, epoch: 1 | loss: 0.4377370
	speed: 0.0109s/iter; left time: 496.7506s
	iters: 200, epoch: 1 | loss: 0.8103450
	speed: 0.0099s/iter; left time: 447.6922s
	iters: 300, epoch: 1 | loss: 0.4273884
	speed: 0.0098s/iter; left time: 442.6183s
	iters: 400, epoch: 1 | loss: 0.3295331
	speed: 0.0094s/iter; left time: 425.6484s
	iters: 500, epoch: 1 | loss: 2.0748165
	speed: 0.0091s/iter; left time: 409.8984s
	iters: 600, epoch: 1 | loss: 2.4623578
	speed: 0.0095s/iter; left time: 425.0289s
	iters: 700, epoch: 1 | loss: 0.4964936
	speed: 0.0100s/iter; left time: 446.9305s
	iters: 800, epoch: 1 | loss: 0.5762246
	speed: 0.0096s/iter; left time: 428.7015s
	iters: 900, epoch: 1 | loss: 0.8949850
	speed: 0.0095s/iter; left time: 423.7135s
	iters: 1000, epoch: 1 | loss: 0.6191183
	speed: 0.0094s/iter; left time: 419.4480s
	iters: 1100, epoch: 1 | loss: 0.3375476
	speed: 0.0098s/iter; left time: 433.8012s
	iters: 1200, epoch: 1 | loss: 2.5032032
	speed: 0.0096s/iter; left time: 427.0512s
	iters: 1300, epoch: 1 | loss: 0.4545737
	speed: 0.0098s/iter; left time: 434.1483s
	iters: 1400, epoch: 1 | loss: 0.4549431
	speed: 0.0092s/iter; left time: 404.9508s
	iters: 1500, epoch: 1 | loss: 0.2479846
	speed: 0.0098s/iter; left time: 430.4252s
	iters: 1600, epoch: 1 | loss: 0.2432657
	speed: 0.0097s/iter; left time: 427.4052s
	iters: 1700, epoch: 1 | loss: 0.3396917
	speed: 0.0100s/iter; left time: 440.1239s
	iters: 1800, epoch: 1 | loss: 0.2652819
	speed: 0.0095s/iter; left time: 416.4158s
	iters: 1900, epoch: 1 | loss: 6.3809328
	speed: 0.0094s/iter; left time: 408.3229s
	iters: 2000, epoch: 1 | loss: 0.3240605
	speed: 0.0095s/iter; left time: 413.7809s
	iters: 2100, epoch: 1 | loss: 0.7000703
	speed: 0.0096s/iter; left time: 415.8861s
	iters: 2200, epoch: 1 | loss: 1.0626919
	speed: 0.0092s/iter; left time: 397.9201s
Epoch: 1 cost time: 21.946885585784912
Epoch: 1, Steps: 2278 | Train Loss: 1.2441618 Vali Loss: 0.5674556 Test Loss: 0.2628285
Validation loss decreased (inf --> 0.567456).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.4926579
	speed: 0.0379s/iter; left time: 1635.6197s
	iters: 200, epoch: 2 | loss: 1.0079999
	speed: 0.0093s/iter; left time: 400.4616s
	iters: 300, epoch: 2 | loss: 0.4603363
	speed: 0.0090s/iter; left time: 384.9892s
	iters: 400, epoch: 2 | loss: 0.3168035
	speed: 0.0083s/iter; left time: 358.0638s
	iters: 500, epoch: 2 | loss: 0.4543871
	speed: 0.0092s/iter; left time: 393.5766s
	iters: 600, epoch: 2 | loss: 1.1056267
	speed: 0.0088s/iter; left time: 373.5186s
	iters: 700, epoch: 2 | loss: 1.3735920
	speed: 0.0087s/iter; left time: 371.5147s
	iters: 800, epoch: 2 | loss: 0.4068779
	speed: 0.0086s/iter; left time: 366.3967s
	iters: 900, epoch: 2 | loss: 0.3546568
	speed: 0.0093s/iter; left time: 392.3821s
	iters: 1000, epoch: 2 | loss: 0.7723849
	speed: 0.0085s/iter; left time: 359.8090s
	iters: 1100, epoch: 2 | loss: 0.3622369
	speed: 0.0090s/iter; left time: 379.1000s
	iters: 1200, epoch: 2 | loss: 0.6211504
	speed: 0.0086s/iter; left time: 362.2053s
	iters: 1300, epoch: 2 | loss: 2.4448636
	speed: 0.0091s/iter; left time: 381.5030s
	iters: 1400, epoch: 2 | loss: 0.4879131
	speed: 0.0092s/iter; left time: 383.9249s
	iters: 1500, epoch: 2 | loss: 0.5951880
	speed: 0.0089s/iter; left time: 373.7684s
	iters: 1600, epoch: 2 | loss: 0.3569734
	speed: 0.0094s/iter; left time: 392.6732s
	iters: 1700, epoch: 2 | loss: 0.5058500
	speed: 0.0098s/iter; left time: 407.7600s
	iters: 1800, epoch: 2 | loss: 0.4405725
	speed: 0.0093s/iter; left time: 386.2929s
	iters: 1900, epoch: 2 | loss: 0.4030041
	speed: 0.0094s/iter; left time: 389.2201s
	iters: 2000, epoch: 2 | loss: 0.3853621
	speed: 0.0088s/iter; left time: 363.0841s
	iters: 2100, epoch: 2 | loss: 0.6938944
	speed: 0.0087s/iter; left time: 359.0005s
	iters: 2200, epoch: 2 | loss: 0.4070735
	speed: 0.0087s/iter; left time: 357.8547s
Epoch: 2 cost time: 20.451648235321045
Epoch: 2, Steps: 2278 | Train Loss: 0.9579211 Vali Loss: 0.5616219 Test Loss: 0.2641686
Validation loss decreased (0.567456 --> 0.561622).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.3261014
	speed: 0.0316s/iter; left time: 1291.2163s
	iters: 200, epoch: 3 | loss: 0.7841148
	speed: 0.0091s/iter; left time: 371.5097s
	iters: 300, epoch: 3 | loss: 0.9739528
	speed: 0.0097s/iter; left time: 394.9303s
	iters: 400, epoch: 3 | loss: 1.0296503
	speed: 0.0097s/iter; left time: 394.1446s
	iters: 500, epoch: 3 | loss: 0.2009269
	speed: 0.0101s/iter; left time: 409.2278s
	iters: 600, epoch: 3 | loss: 0.3142896
	speed: 0.0104s/iter; left time: 418.4238s
	iters: 700, epoch: 3 | loss: 0.4890894
	speed: 0.0081s/iter; left time: 326.1213s
	iters: 800, epoch: 3 | loss: 0.3095749
	speed: 0.0095s/iter; left time: 383.7410s
	iters: 900, epoch: 3 | loss: 0.2955910
	speed: 0.0091s/iter; left time: 365.7693s
	iters: 1000, epoch: 3 | loss: 0.5075836
	speed: 0.0090s/iter; left time: 360.4384s
	iters: 1100, epoch: 3 | loss: 0.2613880
	speed: 0.0095s/iter; left time: 377.8409s
	iters: 1200, epoch: 3 | loss: 0.3921856
	speed: 0.0099s/iter; left time: 395.4321s
	iters: 1300, epoch: 3 | loss: 0.2479134
	speed: 0.0091s/iter; left time: 359.9861s
	iters: 1400, epoch: 3 | loss: 0.3237718
	speed: 0.0094s/iter; left time: 373.2922s
	iters: 1500, epoch: 3 | loss: 0.3797621
	speed: 0.0082s/iter; left time: 325.3617s
	iters: 1600, epoch: 3 | loss: 0.2729669
	speed: 0.0092s/iter; left time: 363.5685s
	iters: 1700, epoch: 3 | loss: 0.3070112
	speed: 0.0092s/iter; left time: 362.9447s
	iters: 1800, epoch: 3 | loss: 0.5805554
	speed: 0.0079s/iter; left time: 309.3255s
	iters: 1900, epoch: 3 | loss: 0.3664311
	speed: 0.0084s/iter; left time: 327.3785s
	iters: 2000, epoch: 3 | loss: 0.6409331
	speed: 0.0088s/iter; left time: 343.4505s
	iters: 2100, epoch: 3 | loss: 2.2329834
	speed: 0.0091s/iter; left time: 353.4892s
	iters: 2200, epoch: 3 | loss: 0.6056024
	speed: 0.0089s/iter; left time: 346.0141s
Epoch: 3 cost time: 20.729767084121704
Epoch: 3, Steps: 2278 | Train Loss: 0.6384402 Vali Loss: 0.4260971 Test Loss: 0.1670190
Validation loss decreased (0.561622 --> 0.426097).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.3559921
	speed: 0.0364s/iter; left time: 1407.3903s
	iters: 200, epoch: 4 | loss: 0.2236461
	speed: 0.0089s/iter; left time: 343.5299s
	iters: 300, epoch: 4 | loss: 0.4406575
	speed: 0.0090s/iter; left time: 346.1034s
	iters: 400, epoch: 4 | loss: 0.4038765
	speed: 0.0098s/iter; left time: 375.5030s
	iters: 500, epoch: 4 | loss: 0.4001293
	speed: 0.0083s/iter; left time: 317.4693s
	iters: 600, epoch: 4 | loss: 0.2925274
	speed: 0.0084s/iter; left time: 318.4220s
	iters: 700, epoch: 4 | loss: 0.2486054
	speed: 0.0084s/iter; left time: 320.8005s
	iters: 800, epoch: 4 | loss: 0.2607367
	speed: 0.0087s/iter; left time: 330.9773s
	iters: 900, epoch: 4 | loss: 0.3780988
	speed: 0.0098s/iter; left time: 369.2757s
	iters: 1000, epoch: 4 | loss: 0.3020767
	speed: 0.0091s/iter; left time: 345.0917s
	iters: 1100, epoch: 4 | loss: 0.3926515
	speed: 0.0093s/iter; left time: 350.5928s
	iters: 1200, epoch: 4 | loss: 0.7279546
	speed: 0.0103s/iter; left time: 387.1758s
	iters: 1300, epoch: 4 | loss: 0.3308345
	speed: 0.0093s/iter; left time: 347.5116s
	iters: 1400, epoch: 4 | loss: 0.3513565
	speed: 0.0092s/iter; left time: 342.8460s
	iters: 1500, epoch: 4 | loss: 0.3041958
	speed: 0.0084s/iter; left time: 313.7099s
	iters: 1600, epoch: 4 | loss: 0.3016054
	speed: 0.0088s/iter; left time: 327.9084s
	iters: 1700, epoch: 4 | loss: 0.4094808
	speed: 0.0095s/iter; left time: 350.5009s
	iters: 1800, epoch: 4 | loss: 0.2583596
	speed: 0.0094s/iter; left time: 347.3402s
	iters: 1900, epoch: 4 | loss: 0.3200303
	speed: 0.0093s/iter; left time: 343.3258s
	iters: 2000, epoch: 4 | loss: 0.3457181
	speed: 0.0098s/iter; left time: 361.5863s
	iters: 2100, epoch: 4 | loss: 0.4491616
	speed: 0.0097s/iter; left time: 355.3587s
	iters: 2200, epoch: 4 | loss: 0.3170210
	speed: 0.0096s/iter; left time: 348.8376s
Epoch: 4 cost time: 20.991607666015625
Epoch: 4, Steps: 2278 | Train Loss: 0.5008056 Vali Loss: 0.3963642 Test Loss: 0.1567991
Validation loss decreased (0.426097 --> 0.396364).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.5281675
	speed: 0.0373s/iter; left time: 1354.9133s
	iters: 200, epoch: 5 | loss: 0.1812332
	speed: 0.0089s/iter; left time: 322.1373s
	iters: 300, epoch: 5 | loss: 0.2375777
	speed: 0.0097s/iter; left time: 349.6556s
	iters: 400, epoch: 5 | loss: 0.4043559
	speed: 0.0094s/iter; left time: 339.7881s
	iters: 500, epoch: 5 | loss: 0.1876061
	speed: 0.0100s/iter; left time: 358.1479s
	iters: 600, epoch: 5 | loss: 0.2943370
	speed: 0.0094s/iter; left time: 337.9390s
	iters: 700, epoch: 5 | loss: 0.1949985
	speed: 0.0094s/iter; left time: 334.7626s
	iters: 800, epoch: 5 | loss: 0.4288840
	speed: 0.0092s/iter; left time: 326.7171s
	iters: 900, epoch: 5 | loss: 0.3450771
	speed: 0.0083s/iter; left time: 296.0203s
	iters: 1000, epoch: 5 | loss: 0.3904654
	speed: 0.0090s/iter; left time: 318.2170s
	iters: 1100, epoch: 5 | loss: 0.5780461
	speed: 0.0102s/iter; left time: 360.6712s
	iters: 1200, epoch: 5 | loss: 0.2154890
	speed: 0.0095s/iter; left time: 336.3297s
	iters: 1300, epoch: 5 | loss: 0.3796473
	speed: 0.0100s/iter; left time: 352.2781s
	iters: 1400, epoch: 5 | loss: 0.2407406
	speed: 0.0096s/iter; left time: 337.2309s
	iters: 1500, epoch: 5 | loss: 0.3338636
	speed: 0.0096s/iter; left time: 335.0703s
	iters: 1600, epoch: 5 | loss: 2.2567534
	speed: 0.0096s/iter; left time: 333.5740s
	iters: 1700, epoch: 5 | loss: 0.5832282
	speed: 0.0103s/iter; left time: 356.7097s
	iters: 1800, epoch: 5 | loss: 0.3240624
	speed: 0.0101s/iter; left time: 350.6468s
	iters: 1900, epoch: 5 | loss: 0.2331692
	speed: 0.0096s/iter; left time: 332.8905s
	iters: 2000, epoch: 5 | loss: 0.2567971
	speed: 0.0092s/iter; left time: 316.1989s
	iters: 2100, epoch: 5 | loss: 2.3681519
	speed: 0.0096s/iter; left time: 329.9447s
	iters: 2200, epoch: 5 | loss: 0.3486573
	speed: 0.0091s/iter; left time: 311.5504s
Epoch: 5 cost time: 21.60117483139038
Epoch: 5, Steps: 2278 | Train Loss: 0.4613135 Vali Loss: 0.3723831 Test Loss: 0.1466168
Validation loss decreased (0.396364 --> 0.372383).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.2097845
	speed: 0.0358s/iter; left time: 1220.2624s
	iters: 200, epoch: 6 | loss: 0.2372296
	speed: 0.0090s/iter; left time: 304.5324s
	iters: 300, epoch: 6 | loss: 0.2992843
	speed: 0.0094s/iter; left time: 318.4529s
	iters: 400, epoch: 6 | loss: 0.2403869
	speed: 0.0093s/iter; left time: 315.0956s
	iters: 500, epoch: 6 | loss: 0.2359626
	speed: 0.0093s/iter; left time: 311.6982s
	iters: 600, epoch: 6 | loss: 0.2205193
	speed: 0.0092s/iter; left time: 307.2538s
	iters: 700, epoch: 6 | loss: 0.5418218
	speed: 0.0097s/iter; left time: 325.2340s
	iters: 800, epoch: 6 | loss: 0.4736569
	speed: 0.0093s/iter; left time: 308.9271s
	iters: 900, epoch: 6 | loss: 0.5596533
	speed: 0.0088s/iter; left time: 293.0126s
	iters: 1000, epoch: 6 | loss: 0.2614076
	speed: 0.0087s/iter; left time: 289.8400s
	iters: 1100, epoch: 6 | loss: 0.2679560
	speed: 0.0092s/iter; left time: 305.3609s
	iters: 1200, epoch: 6 | loss: 0.4310767
	speed: 0.0092s/iter; left time: 303.6898s
	iters: 1300, epoch: 6 | loss: 0.3019437
	speed: 0.0098s/iter; left time: 323.2101s
	iters: 1400, epoch: 6 | loss: 0.3545387
	speed: 0.0091s/iter; left time: 298.7755s
	iters: 1500, epoch: 6 | loss: 0.8349147
	speed: 0.0096s/iter; left time: 313.9695s
	iters: 1600, epoch: 6 | loss: 0.4422125
	speed: 0.0104s/iter; left time: 337.8352s
	iters: 1700, epoch: 6 | loss: 2.2108192
	speed: 0.0107s/iter; left time: 348.3492s
	iters: 1800, epoch: 6 | loss: 0.3438823
	speed: 0.0093s/iter; left time: 300.7382s
	iters: 1900, epoch: 6 | loss: 0.2581570
	speed: 0.0095s/iter; left time: 305.0584s
	iters: 2000, epoch: 6 | loss: 0.2986011
	speed: 0.0092s/iter; left time: 295.3435s
	iters: 2100, epoch: 6 | loss: 0.1816866
	speed: 0.0090s/iter; left time: 287.8996s
	iters: 2200, epoch: 6 | loss: 0.2287936
	speed: 0.0092s/iter; left time: 293.6602s
Epoch: 6 cost time: 21.322078943252563
Epoch: 6, Steps: 2278 | Train Loss: 0.4444095 Vali Loss: 0.3774347 Test Loss: 0.1548981
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.2404194
	speed: 0.0362s/iter; left time: 1151.7870s
	iters: 200, epoch: 7 | loss: 0.2152656
	speed: 0.0083s/iter; left time: 262.0092s
	iters: 300, epoch: 7 | loss: 0.2757186
	speed: 0.0081s/iter; left time: 255.8995s
	iters: 400, epoch: 7 | loss: 0.2133562
	speed: 0.0089s/iter; left time: 279.5112s
	iters: 500, epoch: 7 | loss: 0.3242060
	speed: 0.0092s/iter; left time: 288.8564s
	iters: 600, epoch: 7 | loss: 0.4112680
	speed: 0.0085s/iter; left time: 267.2965s
	iters: 700, epoch: 7 | loss: 0.2547127
	speed: 0.0087s/iter; left time: 270.3222s
	iters: 800, epoch: 7 | loss: 0.2751946
	speed: 0.0081s/iter; left time: 253.1792s
	iters: 900, epoch: 7 | loss: 0.3328309
	speed: 0.0100s/iter; left time: 308.3997s
	iters: 1000, epoch: 7 | loss: 0.2088650
	speed: 0.0099s/iter; left time: 305.2897s
	iters: 1100, epoch: 7 | loss: 0.4582408
	speed: 0.0085s/iter; left time: 261.5944s
	iters: 1200, epoch: 7 | loss: 0.3965656
	speed: 0.0092s/iter; left time: 282.8934s
	iters: 1300, epoch: 7 | loss: 0.5383195
	speed: 0.0083s/iter; left time: 252.4606s
	iters: 1400, epoch: 7 | loss: 0.2391571
	speed: 0.0079s/iter; left time: 240.8927s
	iters: 1500, epoch: 7 | loss: 0.3289002
	speed: 0.0090s/iter; left time: 274.9632s
	iters: 1600, epoch: 7 | loss: 0.3320424
	speed: 0.0087s/iter; left time: 264.9304s
	iters: 1700, epoch: 7 | loss: 0.6943070
	speed: 0.0088s/iter; left time: 265.0065s
	iters: 1800, epoch: 7 | loss: 0.3111344
	speed: 0.0086s/iter; left time: 258.0427s
	iters: 1900, epoch: 7 | loss: 3.7296340
	speed: 0.0085s/iter; left time: 253.7386s
	iters: 2000, epoch: 7 | loss: 0.3304992
	speed: 0.0090s/iter; left time: 270.2632s
	iters: 2100, epoch: 7 | loss: 0.2212508
	speed: 0.0099s/iter; left time: 294.2754s
	iters: 2200, epoch: 7 | loss: 0.2278450
	speed: 0.0096s/iter; left time: 284.2267s
Epoch: 7 cost time: 20.23892617225647
Epoch: 7, Steps: 2278 | Train Loss: 0.4364784 Vali Loss: 0.3678210 Test Loss: 0.1471021
Validation loss decreased (0.372383 --> 0.367821).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.2925174
	speed: 0.0369s/iter; left time: 1088.2964s
	iters: 200, epoch: 8 | loss: 0.2581766
	speed: 0.0098s/iter; left time: 288.6247s
	iters: 300, epoch: 8 | loss: 0.2897992
	speed: 0.0103s/iter; left time: 301.1422s
	iters: 400, epoch: 8 | loss: 0.2840071
	speed: 0.0096s/iter; left time: 279.7239s
	iters: 500, epoch: 8 | loss: 0.2978096
	speed: 0.0087s/iter; left time: 252.3324s
	iters: 600, epoch: 8 | loss: 0.2374488
	speed: 0.0084s/iter; left time: 245.0540s
	iters: 700, epoch: 8 | loss: 0.3559856
	speed: 0.0083s/iter; left time: 239.9823s
	iters: 800, epoch: 8 | loss: 0.2385798
	speed: 0.0085s/iter; left time: 245.2539s
	iters: 900, epoch: 8 | loss: 0.2199739
	speed: 0.0092s/iter; left time: 264.2322s
	iters: 1000, epoch: 8 | loss: 0.2511911
	speed: 0.0085s/iter; left time: 243.5550s
	iters: 1100, epoch: 8 | loss: 0.1767220
	speed: 0.0086s/iter; left time: 243.9550s
	iters: 1200, epoch: 8 | loss: 0.2285069
	speed: 0.0087s/iter; left time: 246.6293s
	iters: 1300, epoch: 8 | loss: 0.3081452
	speed: 0.0090s/iter; left time: 254.4618s
	iters: 1400, epoch: 8 | loss: 0.2619096
	speed: 0.0096s/iter; left time: 272.0622s
	iters: 1500, epoch: 8 | loss: 0.2710639
	speed: 0.0089s/iter; left time: 250.9859s
	iters: 1600, epoch: 8 | loss: 0.4665514
	speed: 0.0094s/iter; left time: 263.2512s
	iters: 1700, epoch: 8 | loss: 0.2665877
	speed: 0.0087s/iter; left time: 242.7937s
	iters: 1800, epoch: 8 | loss: 0.2771908
	speed: 0.0090s/iter; left time: 251.3660s
	iters: 1900, epoch: 8 | loss: 0.2711456
	speed: 0.0092s/iter; left time: 254.8851s
	iters: 2000, epoch: 8 | loss: 0.2172759
	speed: 0.0094s/iter; left time: 258.5340s
	iters: 2100, epoch: 8 | loss: 0.2778684
	speed: 0.0087s/iter; left time: 240.6475s
	iters: 2200, epoch: 8 | loss: 0.3326559
	speed: 0.0089s/iter; left time: 244.4485s
Epoch: 8 cost time: 20.648478984832764
Epoch: 8, Steps: 2278 | Train Loss: 0.4329411 Vali Loss: 0.3666697 Test Loss: 0.1453899
Validation loss decreased (0.367821 --> 0.366670).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.2935325
	speed: 0.0350s/iter; left time: 953.4842s
	iters: 200, epoch: 9 | loss: 0.1919951
	speed: 0.0086s/iter; left time: 233.5688s
	iters: 300, epoch: 9 | loss: 0.2718685
	speed: 0.0083s/iter; left time: 225.4967s
	iters: 400, epoch: 9 | loss: 0.1880840
	speed: 0.0094s/iter; left time: 252.9275s
	iters: 500, epoch: 9 | loss: 0.1717350
	speed: 0.0095s/iter; left time: 254.5848s
	iters: 600, epoch: 9 | loss: 0.3702275
	speed: 0.0091s/iter; left time: 244.0007s
	iters: 700, epoch: 9 | loss: 0.2969026
	speed: 0.0087s/iter; left time: 230.8451s
	iters: 800, epoch: 9 | loss: 0.2668374
	speed: 0.0095s/iter; left time: 250.9050s
	iters: 900, epoch: 9 | loss: 0.2575833
	speed: 0.0088s/iter; left time: 231.7171s
	iters: 1000, epoch: 9 | loss: 0.2009122
	speed: 0.0092s/iter; left time: 242.7544s
	iters: 1100, epoch: 9 | loss: 0.9462889
	speed: 0.0088s/iter; left time: 229.7567s
	iters: 1200, epoch: 9 | loss: 0.2697349
	speed: 0.0091s/iter; left time: 238.2836s
	iters: 1300, epoch: 9 | loss: 0.2656669
	speed: 0.0095s/iter; left time: 247.9276s
	iters: 1400, epoch: 9 | loss: 0.2504645
	speed: 0.0103s/iter; left time: 267.1682s
	iters: 1500, epoch: 9 | loss: 0.2248111
	speed: 0.0092s/iter; left time: 238.9035s
	iters: 1600, epoch: 9 | loss: 0.5754883
	speed: 0.0092s/iter; left time: 237.6708s
	iters: 1700, epoch: 9 | loss: 0.2075999
	speed: 0.0094s/iter; left time: 239.7114s
	iters: 1800, epoch: 9 | loss: 4.2506170
	speed: 0.0099s/iter; left time: 251.9226s
	iters: 1900, epoch: 9 | loss: 0.4501842
	speed: 0.0098s/iter; left time: 248.1867s
	iters: 2000, epoch: 9 | loss: 0.2598491
	speed: 0.0103s/iter; left time: 260.1499s
	iters: 2100, epoch: 9 | loss: 0.2902449
	speed: 0.0093s/iter; left time: 235.8941s
	iters: 2200, epoch: 9 | loss: 0.2242264
	speed: 0.0090s/iter; left time: 227.4079s
Epoch: 9 cost time: 21.126641750335693
Epoch: 9, Steps: 2278 | Train Loss: 0.4309029 Vali Loss: 0.3670330 Test Loss: 0.1459553
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.3254879
	speed: 0.0372s/iter; left time: 928.3021s
	iters: 200, epoch: 10 | loss: 0.1680463
	speed: 0.0094s/iter; left time: 234.4680s
	iters: 300, epoch: 10 | loss: 0.4869601
	speed: 0.0093s/iter; left time: 229.1873s
	iters: 400, epoch: 10 | loss: 0.6354102
	speed: 0.0093s/iter; left time: 229.5023s
	iters: 500, epoch: 10 | loss: 0.4866481
	speed: 0.0096s/iter; left time: 235.0777s
	iters: 600, epoch: 10 | loss: 0.2100197
	speed: 0.0094s/iter; left time: 230.3696s
	iters: 700, epoch: 10 | loss: 0.2644399
	speed: 0.0096s/iter; left time: 234.4386s
	iters: 800, epoch: 10 | loss: 0.1785767
	speed: 0.0090s/iter; left time: 219.2290s
	iters: 900, epoch: 10 | loss: 0.1570170
	speed: 0.0094s/iter; left time: 227.9856s
	iters: 1000, epoch: 10 | loss: 0.1951831
	speed: 0.0093s/iter; left time: 224.8568s
	iters: 1100, epoch: 10 | loss: 0.2153673
	speed: 0.0096s/iter; left time: 229.6797s
	iters: 1200, epoch: 10 | loss: 0.2664301
	speed: 0.0093s/iter; left time: 222.1785s
	iters: 1300, epoch: 10 | loss: 0.3160856
	speed: 0.0094s/iter; left time: 224.2015s
	iters: 1400, epoch: 10 | loss: 0.1473390
	speed: 0.0096s/iter; left time: 226.2309s
	iters: 1500, epoch: 10 | loss: 0.3533459
	speed: 0.0096s/iter; left time: 226.6320s
	iters: 1600, epoch: 10 | loss: 0.1489858
	speed: 0.0091s/iter; left time: 213.3727s
	iters: 1700, epoch: 10 | loss: 0.3092239
	speed: 0.0095s/iter; left time: 221.0311s
	iters: 1800, epoch: 10 | loss: 0.1821269
	speed: 0.0094s/iter; left time: 217.7792s
	iters: 1900, epoch: 10 | loss: 0.2817506
	speed: 0.0093s/iter; left time: 215.4433s
	iters: 2000, epoch: 10 | loss: 0.8648558
	speed: 0.0095s/iter; left time: 219.5764s
	iters: 2100, epoch: 10 | loss: 0.2917840
	speed: 0.0095s/iter; left time: 217.0174s
	iters: 2200, epoch: 10 | loss: 0.4304377
	speed: 0.0096s/iter; left time: 219.6011s
Epoch: 10 cost time: 21.459638357162476
Epoch: 10, Steps: 2278 | Train Loss: 0.4299919 Vali Loss: 0.3655229 Test Loss: 0.1448441
Validation loss decreased (0.366670 --> 0.365523).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.2410801
	speed: 0.0371s/iter; left time: 841.0645s
	iters: 200, epoch: 11 | loss: 0.2201050
	speed: 0.0093s/iter; left time: 208.9909s
	iters: 300, epoch: 11 | loss: 0.2319861
	speed: 0.0094s/iter; left time: 211.0422s
	iters: 400, epoch: 11 | loss: 0.4548586
	speed: 0.0093s/iter; left time: 208.9635s
	iters: 500, epoch: 11 | loss: 0.4612263
	speed: 0.0096s/iter; left time: 213.0607s
	iters: 600, epoch: 11 | loss: 0.1752384
	speed: 0.0095s/iter; left time: 211.0979s
	iters: 700, epoch: 11 | loss: 0.2336267
	speed: 0.0092s/iter; left time: 204.0839s
	iters: 800, epoch: 11 | loss: 0.2145723
	speed: 0.0093s/iter; left time: 203.6874s
	iters: 900, epoch: 11 | loss: 0.2285893
	speed: 0.0095s/iter; left time: 208.4589s
	iters: 1000, epoch: 11 | loss: 0.4358914
	speed: 0.0093s/iter; left time: 203.3022s
	iters: 1100, epoch: 11 | loss: 0.3058168
	speed: 0.0090s/iter; left time: 196.1483s
	iters: 1200, epoch: 11 | loss: 2.1736870
	speed: 0.0097s/iter; left time: 208.5134s
	iters: 1300, epoch: 11 | loss: 0.3070521
	speed: 0.0095s/iter; left time: 204.9726s
	iters: 1400, epoch: 11 | loss: 0.2585290
	speed: 0.0092s/iter; left time: 197.1858s
	iters: 1500, epoch: 11 | loss: 0.3053818
	speed: 0.0093s/iter; left time: 197.0174s
	iters: 1600, epoch: 11 | loss: 0.2097107
	speed: 0.0094s/iter; left time: 198.7258s
	iters: 1700, epoch: 11 | loss: 0.4451402
	speed: 0.0096s/iter; left time: 201.4499s
	iters: 1800, epoch: 11 | loss: 0.3098200
	speed: 0.0096s/iter; left time: 200.9370s
	iters: 1900, epoch: 11 | loss: 0.2176165
	speed: 0.0095s/iter; left time: 197.4738s
	iters: 2000, epoch: 11 | loss: 0.2441562
	speed: 0.0096s/iter; left time: 199.2229s
	iters: 2100, epoch: 11 | loss: 0.4018678
	speed: 0.0094s/iter; left time: 193.8208s
	iters: 2200, epoch: 11 | loss: 0.1942489
	speed: 0.0095s/iter; left time: 195.5596s
Epoch: 11 cost time: 21.44093108177185
Epoch: 11, Steps: 2278 | Train Loss: 0.4294386 Vali Loss: 0.3669839 Test Loss: 0.1454389
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.4683967
	speed: 0.0368s/iter; left time: 751.1815s
	iters: 200, epoch: 12 | loss: 0.2385183
	speed: 0.0093s/iter; left time: 188.7976s
	iters: 300, epoch: 12 | loss: 0.2822788
	speed: 0.0093s/iter; left time: 188.0232s
	iters: 400, epoch: 12 | loss: 0.2370099
	speed: 0.0096s/iter; left time: 193.0266s
	iters: 500, epoch: 12 | loss: 2.0990152
	speed: 0.0096s/iter; left time: 192.5553s
	iters: 600, epoch: 12 | loss: 0.3095483
	speed: 0.0093s/iter; left time: 184.8045s
	iters: 700, epoch: 12 | loss: 0.9329242
	speed: 0.0090s/iter; left time: 179.0577s
	iters: 800, epoch: 12 | loss: 0.3540714
	speed: 0.0094s/iter; left time: 184.7411s
	iters: 900, epoch: 12 | loss: 0.1577879
	speed: 0.0095s/iter; left time: 185.2789s
	iters: 1000, epoch: 12 | loss: 0.3206430
	speed: 0.0095s/iter; left time: 186.0976s
	iters: 1100, epoch: 12 | loss: 0.3496556
	speed: 0.0095s/iter; left time: 183.8752s
	iters: 1200, epoch: 12 | loss: 0.3074630
	speed: 0.0095s/iter; left time: 182.5472s
	iters: 1300, epoch: 12 | loss: 0.2713940
	speed: 0.0095s/iter; left time: 181.7943s
	iters: 1400, epoch: 12 | loss: 0.2994801
	speed: 0.0096s/iter; left time: 183.4027s
	iters: 1500, epoch: 12 | loss: 0.2968444
	speed: 0.0089s/iter; left time: 169.5444s
	iters: 1600, epoch: 12 | loss: 0.2133777
	speed: 0.0095s/iter; left time: 179.1427s
	iters: 1700, epoch: 12 | loss: 0.1816312
	speed: 0.0092s/iter; left time: 172.7347s
	iters: 1800, epoch: 12 | loss: 0.4388786
	speed: 0.0093s/iter; left time: 174.3135s
	iters: 1900, epoch: 12 | loss: 0.1861486
	speed: 0.0092s/iter; left time: 170.3105s
	iters: 2000, epoch: 12 | loss: 0.3024510
	speed: 0.0092s/iter; left time: 170.1641s
	iters: 2100, epoch: 12 | loss: 0.3285890
	speed: 0.0092s/iter; left time: 169.6411s
	iters: 2200, epoch: 12 | loss: 0.3114001
	speed: 0.0095s/iter; left time: 173.2931s
Epoch: 12 cost time: 21.3238468170166
Epoch: 12, Steps: 2278 | Train Loss: 0.4291486 Vali Loss: 0.3663242 Test Loss: 0.1452188
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.3145277
	speed: 0.0364s/iter; left time: 659.2764s
	iters: 200, epoch: 13 | loss: 0.3998504
	speed: 0.0094s/iter; left time: 168.7445s
	iters: 300, epoch: 13 | loss: 0.3970865
	speed: 0.0094s/iter; left time: 167.7342s
	iters: 400, epoch: 13 | loss: 0.2599979
	speed: 0.0091s/iter; left time: 161.6147s
	iters: 500, epoch: 13 | loss: 0.2630080
	speed: 0.0095s/iter; left time: 168.6827s
	iters: 600, epoch: 13 | loss: 0.2838001
	speed: 0.0094s/iter; left time: 166.4156s
	iters: 700, epoch: 13 | loss: 0.3556526
	speed: 0.0092s/iter; left time: 161.1825s
	iters: 800, epoch: 13 | loss: 0.5882046
	speed: 0.0092s/iter; left time: 160.0742s
	iters: 900, epoch: 13 | loss: 0.3677142
	speed: 0.0091s/iter; left time: 157.9530s
	iters: 1000, epoch: 13 | loss: 0.2329032
	speed: 0.0093s/iter; left time: 159.4430s
	iters: 1100, epoch: 13 | loss: 2.1059074
	speed: 0.0095s/iter; left time: 163.3182s
	iters: 1200, epoch: 13 | loss: 0.3883891
	speed: 0.0093s/iter; left time: 157.6015s
	iters: 1300, epoch: 13 | loss: 0.2635965
	speed: 0.0092s/iter; left time: 156.4329s
	iters: 1400, epoch: 13 | loss: 0.2314908
	speed: 0.0090s/iter; left time: 151.3561s
	iters: 1500, epoch: 13 | loss: 0.2698838
	speed: 0.0091s/iter; left time: 151.6446s
	iters: 1600, epoch: 13 | loss: 0.3329352
	speed: 0.0095s/iter; left time: 157.7739s
	iters: 1700, epoch: 13 | loss: 0.3365684
	speed: 0.0095s/iter; left time: 156.8500s
	iters: 1800, epoch: 13 | loss: 0.2619178
	speed: 0.0095s/iter; left time: 156.0632s
	iters: 1900, epoch: 13 | loss: 0.9644511
	speed: 0.0095s/iter; left time: 154.9178s
	iters: 2000, epoch: 13 | loss: 0.5774024
	speed: 0.0094s/iter; left time: 152.5958s
	iters: 2100, epoch: 13 | loss: 0.2938223
	speed: 0.0097s/iter; left time: 156.3409s
	iters: 2200, epoch: 13 | loss: 1.4924935
	speed: 0.0092s/iter; left time: 148.1804s
Epoch: 13 cost time: 21.25550365447998
Epoch: 13, Steps: 2278 | Train Loss: 0.4290533 Vali Loss: 0.3662973 Test Loss: 0.1452910
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.3213633
	speed: 0.0366s/iter; left time: 580.0998s
	iters: 200, epoch: 14 | loss: 0.2319043
	speed: 0.0094s/iter; left time: 147.4694s
	iters: 300, epoch: 14 | loss: 0.4957524
	speed: 0.0091s/iter; left time: 142.7455s
	iters: 400, epoch: 14 | loss: 0.2224279
	speed: 0.0095s/iter; left time: 147.1115s
	iters: 500, epoch: 14 | loss: 0.4852012
	speed: 0.0097s/iter; left time: 149.3195s
	iters: 600, epoch: 14 | loss: 0.2937109
	speed: 0.0095s/iter; left time: 145.2380s
	iters: 700, epoch: 14 | loss: 0.2157684
	speed: 0.0094s/iter; left time: 143.1025s
	iters: 800, epoch: 14 | loss: 0.3852938
	speed: 0.0095s/iter; left time: 143.4706s
	iters: 900, epoch: 14 | loss: 0.2579649
	speed: 0.0095s/iter; left time: 142.9802s
	iters: 1000, epoch: 14 | loss: 0.4204268
	speed: 0.0095s/iter; left time: 141.5430s
	iters: 1100, epoch: 14 | loss: 0.1526348
	speed: 0.0095s/iter; left time: 141.3007s
	iters: 1200, epoch: 14 | loss: 0.4767357
	speed: 0.0094s/iter; left time: 139.2893s
	iters: 1300, epoch: 14 | loss: 0.1963920
	speed: 0.0097s/iter; left time: 141.3768s
	iters: 1400, epoch: 14 | loss: 0.3700405
	speed: 0.0093s/iter; left time: 135.8452s
	iters: 1500, epoch: 14 | loss: 0.3621915
	speed: 0.0093s/iter; left time: 134.0983s
	iters: 1600, epoch: 14 | loss: 0.3815327
	speed: 0.0093s/iter; left time: 133.2507s
	iters: 1700, epoch: 14 | loss: 0.3696464
	speed: 0.0093s/iter; left time: 133.1719s
	iters: 1800, epoch: 14 | loss: 0.6360559
	speed: 0.0098s/iter; left time: 138.2309s
	iters: 1900, epoch: 14 | loss: 0.2542177
	speed: 0.0094s/iter; left time: 132.2148s
	iters: 2000, epoch: 14 | loss: 0.3469907
	speed: 0.0094s/iter; left time: 131.7949s
	iters: 2100, epoch: 14 | loss: 0.2667743
	speed: 0.0096s/iter; left time: 132.9557s
	iters: 2200, epoch: 14 | loss: 0.1937610
	speed: 0.0091s/iter; left time: 125.0384s
Epoch: 14 cost time: 21.505065202713013
Epoch: 14, Steps: 2278 | Train Loss: 0.4289969 Vali Loss: 0.3660541 Test Loss: 0.1452198
EarlyStopping counter: 4 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.1728334
	speed: 0.0370s/iter; left time: 501.9825s
	iters: 200, epoch: 15 | loss: 0.2743190
	speed: 0.0094s/iter; left time: 126.6436s
	iters: 300, epoch: 15 | loss: 0.2412640
	speed: 0.0093s/iter; left time: 124.4502s
	iters: 400, epoch: 15 | loss: 0.3309338
	speed: 0.0096s/iter; left time: 126.7411s
	iters: 500, epoch: 15 | loss: 0.2341868
	speed: 0.0094s/iter; left time: 124.0646s
	iters: 600, epoch: 15 | loss: 0.1936602
	speed: 0.0099s/iter; left time: 129.0094s
	iters: 700, epoch: 15 | loss: 0.2491170
	speed: 0.0096s/iter; left time: 124.1115s
	iters: 800, epoch: 15 | loss: 0.2194647
	speed: 0.0103s/iter; left time: 132.2946s
	iters: 900, epoch: 15 | loss: 1.9883772
	speed: 0.0096s/iter; left time: 122.4194s
	iters: 1000, epoch: 15 | loss: 0.2878372
	speed: 0.0088s/iter; left time: 111.3565s
	iters: 1100, epoch: 15 | loss: 0.5322104
	speed: 0.0088s/iter; left time: 110.8997s
	iters: 1200, epoch: 15 | loss: 0.2692690
	speed: 0.0088s/iter; left time: 109.5591s
	iters: 1300, epoch: 15 | loss: 0.5107733
	speed: 0.0088s/iter; left time: 109.0032s
	iters: 1400, epoch: 15 | loss: 0.1705094
	speed: 0.0091s/iter; left time: 111.2196s
	iters: 1500, epoch: 15 | loss: 0.2452527
	speed: 0.0089s/iter; left time: 108.3811s
	iters: 1600, epoch: 15 | loss: 0.2683308
	speed: 0.0089s/iter; left time: 107.6190s
	iters: 1700, epoch: 15 | loss: 0.2862852
	speed: 0.0091s/iter; left time: 108.4027s
	iters: 1800, epoch: 15 | loss: 0.1772202
	speed: 0.0089s/iter; left time: 105.1865s
	iters: 1900, epoch: 15 | loss: 0.3089594
	speed: 0.0088s/iter; left time: 103.8861s
	iters: 2000, epoch: 15 | loss: 0.2118701
	speed: 0.0090s/iter; left time: 105.0309s
	iters: 2100, epoch: 15 | loss: 0.3134636
	speed: 0.0089s/iter; left time: 102.7028s
	iters: 2200, epoch: 15 | loss: 0.2578985
	speed: 0.0089s/iter; left time: 102.6092s
Epoch: 15 cost time: 20.930928230285645
Epoch: 15, Steps: 2278 | Train Loss: 0.4289525 Vali Loss: 0.3662968 Test Loss: 0.1452601
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : weather_336_96_Linear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3293<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
mse:0.1448870152235031, mae:0.21051974594593048
