Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='exchange_rate.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=8, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='mse', lradj='type1', model='NLinear', model_id='Exchange_336_720', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=720, root_path='./dataset/', save_pred_values=False, seed=10458, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : Exchange_336_720_NLinear_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed10458>>>>>>>>>>>>>>>>>>>>>>>>>>
train 4256
val 41
test 798
	iters: 100, epoch: 1 | loss: 0.8542103
	speed: 0.0212s/iter; left time: 54.2116s
Epoch: 1 cost time: 2.8572604656219482
Epoch: 1, Steps: 133 | Train Loss: 0.7871879 Vali Loss: 1.2281214 Test Loss: 0.9030039
Validation loss decreased (inf --> 1.228121).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.8329484
	speed: 0.0314s/iter; left time: 76.1950s
Epoch: 2 cost time: 2.914476156234741
Epoch: 2, Steps: 133 | Train Loss: 0.7679242 Vali Loss: 1.2321095 Test Loss: 0.9741211
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.6818835
	speed: 0.0302s/iter; left time: 69.4100s
Epoch: 3 cost time: 2.8274693489074707
Epoch: 3, Steps: 133 | Train Loss: 0.7597356 Vali Loss: 1.2465062 Test Loss: 0.9798304
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.6804239
	speed: 0.0310s/iter; left time: 66.9839s
Epoch: 4 cost time: 2.8839285373687744
Epoch: 4, Steps: 133 | Train Loss: 0.7572447 Vali Loss: 1.2072402 Test Loss: 0.9893860
Validation loss decreased (1.228121 --> 1.207240).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.8159611
	speed: 0.0316s/iter; left time: 64.1513s
Epoch: 5 cost time: 2.963059663772583
Epoch: 5, Steps: 133 | Train Loss: 0.7555785 Vali Loss: 1.2246940 Test Loss: 0.9982853
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.7814965
	speed: 0.0320s/iter; left time: 60.6906s
Epoch: 6 cost time: 2.910470962524414
Epoch: 6, Steps: 133 | Train Loss: 0.7546872 Vali Loss: 1.2050900 Test Loss: 0.9853890
Validation loss decreased (1.207240 --> 1.205090).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.7551707
	speed: 0.0309s/iter; left time: 54.5621s
Epoch: 7 cost time: 2.7753098011016846
Epoch: 7, Steps: 133 | Train Loss: 0.7541875 Vali Loss: 1.2353085 Test Loss: 0.9870068
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.7881630
	speed: 0.0287s/iter; left time: 46.7103s
Epoch: 8 cost time: 2.758492946624756
Epoch: 8, Steps: 133 | Train Loss: 0.7539929 Vali Loss: 1.2199507 Test Loss: 0.9861240
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.6705336
	speed: 0.0292s/iter; left time: 43.6952s
Epoch: 9 cost time: 2.801938772201538
Epoch: 9, Steps: 133 | Train Loss: 0.7538616 Vali Loss: 1.2036337 Test Loss: 0.9863077
Validation loss decreased (1.205090 --> 1.203634).  Saving model ...
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.8529275
	speed: 0.0307s/iter; left time: 41.8182s
Epoch: 10 cost time: 2.6986958980560303
Epoch: 10, Steps: 133 | Train Loss: 0.7538080 Vali Loss: 1.2184294 Test Loss: 0.9860556
EarlyStopping counter: 1 out of 5
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 11 | loss: 0.7981616
	speed: 0.0272s/iter; left time: 33.4562s
Epoch: 11 cost time: 2.543523073196411
Epoch: 11, Steps: 133 | Train Loss: 0.7537804 Vali Loss: 1.2112174 Test Loss: 0.9862913
EarlyStopping counter: 2 out of 5
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 12 | loss: 0.6323597
	speed: 0.0260s/iter; left time: 28.5203s
Epoch: 12 cost time: 2.4031221866607666
Epoch: 12, Steps: 133 | Train Loss: 0.7537620 Vali Loss: 1.2351190 Test Loss: 0.9862748
EarlyStopping counter: 3 out of 5
Updating learning rate to 2.44140625e-07
	iters: 100, epoch: 13 | loss: 0.7794899
	speed: 0.0238s/iter; left time: 22.9352s
Epoch: 13 cost time: 2.13879656791687
Epoch: 13, Steps: 133 | Train Loss: 0.7537548 Vali Loss: 1.1970950 Test Loss: 0.9862496
Validation loss decreased (1.203634 --> 1.197095).  Saving model ...
Updating learning rate to 1.220703125e-07
	iters: 100, epoch: 14 | loss: 0.7274176
	speed: 0.0218s/iter; left time: 18.1574s
Epoch: 14 cost time: 1.9431800842285156
Epoch: 14, Steps: 133 | Train Loss: 0.7537507 Vali Loss: 1.2407838 Test Loss: 0.9862740
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.103515625e-08
	iters: 100, epoch: 15 | loss: 0.7357174
	speed: 0.0202s/iter; left time: 14.1210s
Epoch: 15 cost time: 1.9147610664367676
Epoch: 15, Steps: 133 | Train Loss: 0.7537491 Vali Loss: 1.1828955 Test Loss: 0.9862763
Validation loss decreased (1.197095 --> 1.182896).  Saving model ...
Updating learning rate to 3.0517578125e-08
	iters: 100, epoch: 16 | loss: 0.7511461
	speed: 0.0194s/iter; left time: 10.9846s
Epoch: 16 cost time: 1.7536704540252686
Epoch: 16, Steps: 133 | Train Loss: 0.7537479 Vali Loss: 1.1961478 Test Loss: 0.9862756
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.52587890625e-08
	iters: 100, epoch: 17 | loss: 0.6633539
	speed: 0.0180s/iter; left time: 7.7912s
Epoch: 17 cost time: 1.676372766494751
Epoch: 17, Steps: 133 | Train Loss: 0.7537475 Vali Loss: 1.2373154 Test Loss: 0.9862775
EarlyStopping counter: 2 out of 5
Updating learning rate to 7.62939453125e-09
	iters: 100, epoch: 18 | loss: 0.6758814
	speed: 0.0157s/iter; left time: 4.7152s
Epoch: 18 cost time: 1.3865280151367188
Epoch: 18, Steps: 133 | Train Loss: 0.7537472 Vali Loss: 1.2280803 Test Loss: 0.9862772
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.814697265625e-09
	iters: 100, epoch: 19 | loss: 0.6682320
	speed: 0.0142s/iter; left time: 2.3785s
Epoch: 19 cost time: 1.3484001159667969
Epoch: 19, Steps: 133 | Train Loss: 0.7537471 Vali Loss: 1.2583214 Test Loss: 0.9862779
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.9073486328125e-09
	iters: 100, epoch: 20 | loss: 0.8354505
	speed: 0.0168s/iter; left time: 0.5699s
Epoch: 20 cost time: 1.6760296821594238
Epoch: 20, Steps: 133 | Train Loss: 0.7537471 Vali Loss: 1.2280774 Test Loss: 0.9862779
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : Exchange_336_720_NLinear_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed10458<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 798
mse:0.9876706600189209, mae:0.7274968028068542
