Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='DLinear', model_id='ETTm2_336_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=336, root_path='./dataset/', save_pred_values=False, seed=3293, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTm2_336_336_DLinear_ETTm2_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3293>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33889
val 11185
test 11185
	iters: 100, epoch: 1 | loss: 0.3669540
	speed: 0.0154s/iter; left time: 324.9198s
	iters: 200, epoch: 1 | loss: 0.7044231
	speed: 0.0153s/iter; left time: 320.5968s
	iters: 300, epoch: 1 | loss: 0.8556737
	speed: 0.0163s/iter; left time: 339.5782s
	iters: 400, epoch: 1 | loss: 0.7719333
	speed: 0.0165s/iter; left time: 343.3854s
	iters: 500, epoch: 1 | loss: 0.7035668
	speed: 0.0180s/iter; left time: 371.4830s
	iters: 600, epoch: 1 | loss: 0.6154912
	speed: 0.0180s/iter; left time: 371.3811s
	iters: 700, epoch: 1 | loss: 0.4611963
	speed: 0.0165s/iter; left time: 337.6163s
	iters: 800, epoch: 1 | loss: 0.6896539
	speed: 0.0176s/iter; left time: 357.8869s
	iters: 900, epoch: 1 | loss: 0.6994254
	speed: 0.0182s/iter; left time: 369.2316s
	iters: 1000, epoch: 1 | loss: 0.4835919
	speed: 0.0177s/iter; left time: 357.2984s
Epoch: 1 cost time: 17.899349689483643
Epoch: 1, Steps: 1059 | Train Loss: 0.6598594 Vali Loss: 0.6400671 Test Loss: 1.3840752
Validation loss decreased (inf --> 0.640067).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.5104985
	speed: 0.0585s/iter; left time: 1171.0884s
	iters: 200, epoch: 2 | loss: 0.7573575
	speed: 0.0172s/iter; left time: 342.5229s
	iters: 300, epoch: 2 | loss: 1.0403889
	speed: 0.0173s/iter; left time: 342.4523s
	iters: 400, epoch: 2 | loss: 0.4554176
	speed: 0.0167s/iter; left time: 329.8510s
	iters: 500, epoch: 2 | loss: 0.5263329
	speed: 0.0173s/iter; left time: 340.2789s
	iters: 600, epoch: 2 | loss: 0.3892920
	speed: 0.0178s/iter; left time: 347.8185s
	iters: 700, epoch: 2 | loss: 0.3981288
	speed: 0.0177s/iter; left time: 343.9017s
	iters: 800, epoch: 2 | loss: 0.4962912
	speed: 0.0168s/iter; left time: 325.1196s
	iters: 900, epoch: 2 | loss: 0.6821310
	speed: 0.0176s/iter; left time: 338.3522s
	iters: 1000, epoch: 2 | loss: 0.7360338
	speed: 0.0173s/iter; left time: 330.3392s
Epoch: 2 cost time: 17.9536452293396
Epoch: 2, Steps: 1059 | Train Loss: 0.6618088 Vali Loss: 1.2783376 Test Loss: 3.3299124
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.4580278
	speed: 0.0614s/iter; left time: 1164.1606s
	iters: 200, epoch: 3 | loss: 0.3783358
	speed: 0.0161s/iter; left time: 303.0223s
	iters: 300, epoch: 3 | loss: 0.2804130
	speed: 0.0166s/iter; left time: 310.7437s
	iters: 400, epoch: 3 | loss: 0.5052038
	speed: 0.0176s/iter; left time: 327.8769s
	iters: 500, epoch: 3 | loss: 0.3299392
	speed: 0.0165s/iter; left time: 305.6927s
	iters: 600, epoch: 3 | loss: 0.6231627
	speed: 0.0156s/iter; left time: 288.6700s
	iters: 700, epoch: 3 | loss: 0.3449578
	speed: 0.0146s/iter; left time: 268.7332s
	iters: 800, epoch: 3 | loss: 0.5706753
	speed: 0.0168s/iter; left time: 306.5687s
	iters: 900, epoch: 3 | loss: 0.5378729
	speed: 0.0173s/iter; left time: 314.6555s
	iters: 1000, epoch: 3 | loss: 0.3174005
	speed: 0.0180s/iter; left time: 324.4942s
Epoch: 3 cost time: 17.587180137634277
Epoch: 3, Steps: 1059 | Train Loss: 0.4561333 Vali Loss: 0.2994939 Test Loss: 0.4683037
Validation loss decreased (0.640067 --> 0.299494).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.6622683
	speed: 0.0641s/iter; left time: 1147.1179s
	iters: 200, epoch: 4 | loss: 0.4502680
	speed: 0.0176s/iter; left time: 312.7330s
	iters: 300, epoch: 4 | loss: 0.2367179
	speed: 0.0172s/iter; left time: 303.9472s
	iters: 400, epoch: 4 | loss: 0.4791664
	speed: 0.0158s/iter; left time: 278.4277s
	iters: 500, epoch: 4 | loss: 0.3348543
	speed: 0.0163s/iter; left time: 284.8387s
	iters: 600, epoch: 4 | loss: 0.3072131
	speed: 0.0171s/iter; left time: 296.9025s
	iters: 700, epoch: 4 | loss: 0.2593669
	speed: 0.0181s/iter; left time: 313.9369s
	iters: 800, epoch: 4 | loss: 0.5787194
	speed: 0.0166s/iter; left time: 284.7536s
	iters: 900, epoch: 4 | loss: 0.3119272
	speed: 0.0173s/iter; left time: 296.0272s
	iters: 1000, epoch: 4 | loss: 0.3530315
	speed: 0.0161s/iter; left time: 273.4462s
Epoch: 4 cost time: 17.883233070373535
Epoch: 4, Steps: 1059 | Train Loss: 0.4057389 Vali Loss: 0.2713811 Test Loss: 0.4162750
Validation loss decreased (0.299494 --> 0.271381).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.2853529
	speed: 0.0659s/iter; left time: 1109.4192s
	iters: 200, epoch: 5 | loss: 0.6216397
	speed: 0.0176s/iter; left time: 295.2967s
	iters: 300, epoch: 5 | loss: 0.4418907
	speed: 0.0180s/iter; left time: 298.8711s
	iters: 400, epoch: 5 | loss: 0.7090909
	speed: 0.0179s/iter; left time: 296.3488s
	iters: 500, epoch: 5 | loss: 0.3203222
	speed: 0.0171s/iter; left time: 281.1165s
	iters: 600, epoch: 5 | loss: 0.4013470
	speed: 0.0179s/iter; left time: 292.7071s
	iters: 700, epoch: 5 | loss: 0.2577615
	speed: 0.0180s/iter; left time: 291.8557s
	iters: 800, epoch: 5 | loss: 0.5368332
	speed: 0.0177s/iter; left time: 285.5965s
	iters: 900, epoch: 5 | loss: 0.3960542
	speed: 0.0169s/iter; left time: 270.9179s
	iters: 1000, epoch: 5 | loss: 0.2622802
	speed: 0.0174s/iter; left time: 277.1630s
Epoch: 5 cost time: 18.44543170928955
Epoch: 5, Steps: 1059 | Train Loss: 0.3778308 Vali Loss: 0.4287365 Test Loss: 1.0331210
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.3898078
	speed: 0.0631s/iter; left time: 996.8369s
	iters: 200, epoch: 6 | loss: 0.2303549
	speed: 0.0167s/iter; left time: 261.2832s
	iters: 300, epoch: 6 | loss: 0.2177665
	speed: 0.0171s/iter; left time: 265.8649s
	iters: 400, epoch: 6 | loss: 0.4003836
	speed: 0.0167s/iter; left time: 259.0322s
	iters: 500, epoch: 6 | loss: 0.3724395
	speed: 0.0164s/iter; left time: 252.2696s
	iters: 600, epoch: 6 | loss: 0.2116709
	speed: 0.0158s/iter; left time: 241.7422s
	iters: 700, epoch: 6 | loss: 0.2925437
	speed: 0.0172s/iter; left time: 261.5344s
	iters: 800, epoch: 6 | loss: 0.2624291
	speed: 0.0176s/iter; left time: 265.1522s
	iters: 900, epoch: 6 | loss: 0.2749809
	speed: 0.0177s/iter; left time: 264.7682s
	iters: 1000, epoch: 6 | loss: 0.3447056
	speed: 0.0176s/iter; left time: 261.4824s
Epoch: 6 cost time: 17.760738372802734
Epoch: 6, Steps: 1059 | Train Loss: 0.3647430 Vali Loss: 0.2555170 Test Loss: 0.4338154
Validation loss decreased (0.271381 --> 0.255517).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.2108424
	speed: 0.0685s/iter; left time: 1009.3739s
	iters: 200, epoch: 7 | loss: 0.3697395
	speed: 0.0179s/iter; left time: 261.5847s
	iters: 300, epoch: 7 | loss: 0.2087581
	speed: 0.0168s/iter; left time: 244.7696s
	iters: 400, epoch: 7 | loss: 0.2295882
	speed: 0.0172s/iter; left time: 248.3756s
	iters: 500, epoch: 7 | loss: 0.1662359
	speed: 0.0179s/iter; left time: 256.6919s
	iters: 600, epoch: 7 | loss: 0.3161992
	speed: 0.0169s/iter; left time: 239.9156s
	iters: 700, epoch: 7 | loss: 0.1871457
	speed: 0.0156s/iter; left time: 220.7498s
	iters: 800, epoch: 7 | loss: 0.2178714
	speed: 0.0159s/iter; left time: 222.6804s
	iters: 900, epoch: 7 | loss: 0.4308662
	speed: 0.0165s/iter; left time: 229.4667s
	iters: 1000, epoch: 7 | loss: 0.1420768
	speed: 0.0174s/iter; left time: 240.1636s
Epoch: 7 cost time: 17.822515964508057
Epoch: 7, Steps: 1059 | Train Loss: 0.3571953 Vali Loss: 0.2747825 Test Loss: 0.5080311
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.5920097
	speed: 0.0594s/iter; left time: 811.9161s
	iters: 200, epoch: 8 | loss: 0.2909139
	speed: 0.0177s/iter; left time: 240.3448s
	iters: 300, epoch: 8 | loss: 0.2544318
	speed: 0.0165s/iter; left time: 222.2806s
	iters: 400, epoch: 8 | loss: 0.2662179
	speed: 0.0184s/iter; left time: 245.5167s
	iters: 500, epoch: 8 | loss: 0.2947827
	speed: 0.0179s/iter; left time: 237.0596s
	iters: 600, epoch: 8 | loss: 0.3364972
	speed: 0.0152s/iter; left time: 200.3144s
	iters: 700, epoch: 8 | loss: 0.2959644
	speed: 0.0160s/iter; left time: 209.3222s
	iters: 800, epoch: 8 | loss: 0.2633061
	speed: 0.0164s/iter; left time: 212.1183s
	iters: 900, epoch: 8 | loss: 0.1501788
	speed: 0.0176s/iter; left time: 226.1190s
	iters: 1000, epoch: 8 | loss: 0.5194138
	speed: 0.0159s/iter; left time: 203.6251s
Epoch: 8 cost time: 17.695526838302612
Epoch: 8, Steps: 1059 | Train Loss: 0.3528055 Vali Loss: 0.2788279 Test Loss: 0.5104493
EarlyStopping counter: 2 out of 5
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.2889284
	speed: 0.0607s/iter; left time: 765.7912s
	iters: 200, epoch: 9 | loss: 0.2585570
	speed: 0.0163s/iter; left time: 203.6897s
	iters: 300, epoch: 9 | loss: 0.6708553
	speed: 0.0173s/iter; left time: 214.3283s
	iters: 400, epoch: 9 | loss: 0.2651460
	speed: 0.0175s/iter; left time: 215.3808s
	iters: 500, epoch: 9 | loss: 0.2918461
	speed: 0.0177s/iter; left time: 216.6530s
	iters: 600, epoch: 9 | loss: 0.2512431
	speed: 0.0170s/iter; left time: 206.4033s
	iters: 700, epoch: 9 | loss: 0.3423369
	speed: 0.0171s/iter; left time: 205.0237s
	iters: 800, epoch: 9 | loss: 0.5880055
	speed: 0.0156s/iter; left time: 185.5107s
	iters: 900, epoch: 9 | loss: 0.2041627
	speed: 0.0163s/iter; left time: 192.9003s
	iters: 1000, epoch: 9 | loss: 0.2242003
	speed: 0.0150s/iter; left time: 175.6768s
Epoch: 9 cost time: 17.42701244354248
Epoch: 9, Steps: 1059 | Train Loss: 0.3502560 Vali Loss: 0.2900056 Test Loss: 0.5627298
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.2928108
	speed: 0.0644s/iter; left time: 743.2854s
	iters: 200, epoch: 10 | loss: 0.3325437
	speed: 0.0168s/iter; left time: 192.7501s
	iters: 300, epoch: 10 | loss: 0.1993953
	speed: 0.0176s/iter; left time: 199.3628s
	iters: 400, epoch: 10 | loss: 0.3807679
	speed: 0.0169s/iter; left time: 190.3790s
	iters: 500, epoch: 10 | loss: 0.3468365
	speed: 0.0161s/iter; left time: 179.4725s
	iters: 600, epoch: 10 | loss: 0.3390149
	speed: 0.0168s/iter; left time: 185.8195s
	iters: 700, epoch: 10 | loss: 0.3743089
	speed: 0.0158s/iter; left time: 173.4870s
	iters: 800, epoch: 10 | loss: 0.2240091
	speed: 0.0182s/iter; left time: 197.7377s
	iters: 900, epoch: 10 | loss: 0.3625449
	speed: 0.0170s/iter; left time: 182.5053s
	iters: 1000, epoch: 10 | loss: 0.2282633
	speed: 0.0179s/iter; left time: 190.2635s
Epoch: 10 cost time: 17.778061866760254
Epoch: 10, Steps: 1059 | Train Loss: 0.3490831 Vali Loss: 0.2767453 Test Loss: 0.5119296
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.2822364
	speed: 0.0663s/iter; left time: 695.5777s
	iters: 200, epoch: 11 | loss: 0.2901039
	speed: 0.0158s/iter; left time: 164.1292s
	iters: 300, epoch: 11 | loss: 0.2476773
	speed: 0.0172s/iter; left time: 176.8601s
	iters: 400, epoch: 11 | loss: 0.3203893
	speed: 0.0170s/iter; left time: 173.6142s
	iters: 500, epoch: 11 | loss: 0.2559692
	speed: 0.0160s/iter; left time: 161.7839s
	iters: 600, epoch: 11 | loss: 0.3156491
	speed: 0.0160s/iter; left time: 159.7071s
	iters: 700, epoch: 11 | loss: 0.3646424
	speed: 0.0150s/iter; left time: 148.3677s
	iters: 800, epoch: 11 | loss: 0.3682687
	speed: 0.0154s/iter; left time: 150.8319s
	iters: 900, epoch: 11 | loss: 0.5078509
	speed: 0.0155s/iter; left time: 150.0374s
	iters: 1000, epoch: 11 | loss: 0.8319588
	speed: 0.0164s/iter; left time: 157.4247s
Epoch: 11 cost time: 16.88689947128296
Epoch: 11, Steps: 1059 | Train Loss: 0.3484358 Vali Loss: 0.2759349 Test Loss: 0.5104777
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTm2_336_336_DLinear_ETTm2_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3293<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
mse:0.4342395067214966, mae:0.42902177572250366
