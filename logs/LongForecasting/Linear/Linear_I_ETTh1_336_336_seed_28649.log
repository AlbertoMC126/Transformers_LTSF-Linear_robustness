Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTh1', data_path='ETTh1.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='Linear', model_id='ETTh1_336_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=336, root_path='./dataset/', save_pred_values=False, seed=28649, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTh1_336_336_Linear_ETTh1_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed28649>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7969
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 0.4965960
	speed: 0.0082s/iter; left time: 39.8087s
	iters: 200, epoch: 1 | loss: 0.4597228
	speed: 0.0079s/iter; left time: 37.5350s
Epoch: 1 cost time: 2.0448873043060303
Epoch: 1, Steps: 249 | Train Loss: 0.5292070 Vali Loss: 1.2364000 Test Loss: 0.5237365
Validation loss decreased (inf --> 1.236400).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.4275963
	speed: 0.0183s/iter; left time: 84.5953s
	iters: 200, epoch: 2 | loss: 0.4271880
	speed: 0.0071s/iter; left time: 32.0068s
Epoch: 2 cost time: 1.8042356967926025
Epoch: 2, Steps: 249 | Train Loss: 0.4980529 Vali Loss: 1.4325359 Test Loss: 0.5361349
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.4424809
	speed: 0.0120s/iter; left time: 52.6921s
	iters: 200, epoch: 3 | loss: 0.5322308
	speed: 0.0082s/iter; left time: 35.0498s
Epoch: 3 cost time: 1.8696599006652832
Epoch: 3, Steps: 249 | Train Loss: 0.4516501 Vali Loss: 1.1935806 Test Loss: 0.4957278
Validation loss decreased (1.236400 --> 1.193581).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.4203163
	speed: 0.0172s/iter; left time: 70.9823s
	iters: 200, epoch: 4 | loss: 0.4120099
	speed: 0.0080s/iter; left time: 32.4429s
Epoch: 4 cost time: 2.0765039920806885
Epoch: 4, Steps: 249 | Train Loss: 0.4295515 Vali Loss: 1.1524909 Test Loss: 0.4611562
Validation loss decreased (1.193581 --> 1.152491).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.4378113
	speed: 0.0175s/iter; left time: 67.9817s
	iters: 200, epoch: 5 | loss: 0.3691646
	speed: 0.0083s/iter; left time: 31.2578s
Epoch: 5 cost time: 2.0970826148986816
Epoch: 5, Steps: 249 | Train Loss: 0.4200646 Vali Loss: 1.1662832 Test Loss: 0.4571663
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.4280518
	speed: 0.0151s/iter; left time: 54.9465s
	iters: 200, epoch: 6 | loss: 0.4192398
	speed: 0.0073s/iter; left time: 25.9640s
Epoch: 6 cost time: 1.8121895790100098
Epoch: 6, Steps: 249 | Train Loss: 0.4138871 Vali Loss: 1.1411624 Test Loss: 0.4538953
Validation loss decreased (1.152491 --> 1.141162).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.3762025
	speed: 0.0162s/iter; left time: 54.8151s
	iters: 200, epoch: 7 | loss: 0.4055935
	speed: 0.0077s/iter; left time: 25.2562s
Epoch: 7 cost time: 1.9388740062713623
Epoch: 7, Steps: 249 | Train Loss: 0.4111550 Vali Loss: 1.1566556 Test Loss: 0.4480603
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.4218131
	speed: 0.0175s/iter; left time: 54.7693s
	iters: 200, epoch: 8 | loss: 0.4367945
	speed: 0.0090s/iter; left time: 27.4695s
Epoch: 8 cost time: 2.1494338512420654
Epoch: 8, Steps: 249 | Train Loss: 0.4094322 Vali Loss: 1.1334840 Test Loss: 0.4470307
Validation loss decreased (1.141162 --> 1.133484).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.4489087
	speed: 0.0168s/iter; left time: 48.5220s
	iters: 200, epoch: 9 | loss: 0.3815324
	speed: 0.0074s/iter; left time: 20.5408s
Epoch: 9 cost time: 1.9270069599151611
Epoch: 9, Steps: 249 | Train Loss: 0.4085951 Vali Loss: 1.1392349 Test Loss: 0.4462349
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.4383765
	speed: 0.0160s/iter; left time: 42.1144s
	iters: 200, epoch: 10 | loss: 0.4156379
	speed: 0.0085s/iter; left time: 21.5754s
Epoch: 10 cost time: 2.076463460922241
Epoch: 10, Steps: 249 | Train Loss: 0.4081110 Vali Loss: 1.1408776 Test Loss: 0.4453821
EarlyStopping counter: 2 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.4044680
	speed: 0.0181s/iter; left time: 43.2167s
	iters: 200, epoch: 11 | loss: 0.4423198
	speed: 0.0091s/iter; left time: 20.8414s
Epoch: 11 cost time: 2.222913980484009
Epoch: 11, Steps: 249 | Train Loss: 0.4078081 Vali Loss: 1.1386003 Test Loss: 0.4458676
EarlyStopping counter: 3 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.4518389
	speed: 0.0185s/iter; left time: 39.6700s
	iters: 200, epoch: 12 | loss: 0.4751147
	speed: 0.0083s/iter; left time: 16.9954s
Epoch: 12 cost time: 2.033330202102661
Epoch: 12, Steps: 249 | Train Loss: 0.4076823 Vali Loss: 1.1397295 Test Loss: 0.4457125
EarlyStopping counter: 4 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.4133519
	speed: 0.0147s/iter; left time: 27.8968s
	iters: 200, epoch: 13 | loss: 0.3521800
	speed: 0.0081s/iter; left time: 14.5961s
Epoch: 13 cost time: 1.8935210704803467
Epoch: 13, Steps: 249 | Train Loss: 0.4076177 Vali Loss: 1.1376776 Test Loss: 0.4460223
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTh1_336_336_Linear_ETTh1_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed28649<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2545
mse:0.44652530550956726, mae:0.4419214427471161
