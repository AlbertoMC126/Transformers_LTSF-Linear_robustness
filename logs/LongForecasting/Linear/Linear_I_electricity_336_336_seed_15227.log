Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='Linear', model_id='Electricity_336_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=336, root_path='./dataset/', save_pred_values=False, seed=15227, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : Electricity_336_336_Linear_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15227>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17741
val 2297
test 4925
	iters: 100, epoch: 1 | loss: 0.2187784
	speed: 0.0995s/iter; left time: 2195.5142s
	iters: 200, epoch: 1 | loss: 0.2241583
	speed: 0.0884s/iter; left time: 1941.6541s
	iters: 300, epoch: 1 | loss: 0.2643651
	speed: 0.0862s/iter; left time: 1885.2883s
	iters: 400, epoch: 1 | loss: 0.2290383
	speed: 0.0865s/iter; left time: 1881.2469s
	iters: 500, epoch: 1 | loss: 0.2824357
	speed: 0.0841s/iter; left time: 1820.9632s
	iters: 600, epoch: 1 | loss: 0.1992490
	speed: 0.0844s/iter; left time: 1819.0788s
	iters: 700, epoch: 1 | loss: 0.2366355
	speed: 0.0845s/iter; left time: 1814.3221s
	iters: 800, epoch: 1 | loss: 0.2273538
	speed: 0.0839s/iter; left time: 1791.9995s
	iters: 900, epoch: 1 | loss: 0.2678231
	speed: 0.0843s/iter; left time: 1791.3925s
	iters: 1000, epoch: 1 | loss: 0.2555458
	speed: 0.0849s/iter; left time: 1796.7667s
	iters: 1100, epoch: 1 | loss: 0.2817755
	speed: 0.0855s/iter; left time: 1801.5632s
Epoch: 1 cost time: 95.96928191184998
Epoch: 1, Steps: 1108 | Train Loss: 0.2521562 Vali Loss: 0.2154238 Test Loss: 0.2520461
Validation loss decreased (inf --> 0.215424).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.2669574
	speed: 0.2416s/iter; left time: 5062.6912s
	iters: 200, epoch: 2 | loss: 0.2406221
	speed: 0.0865s/iter; left time: 1803.3270s
	iters: 300, epoch: 2 | loss: 0.2519598
	speed: 0.0857s/iter; left time: 1779.1015s
	iters: 400, epoch: 2 | loss: 0.2320699
	speed: 0.0871s/iter; left time: 1797.8535s
	iters: 500, epoch: 2 | loss: 0.2364745
	speed: 0.0871s/iter; left time: 1789.8853s
	iters: 600, epoch: 2 | loss: 0.2091258
	speed: 0.0855s/iter; left time: 1748.0337s
	iters: 700, epoch: 2 | loss: 0.2324043
	speed: 0.0851s/iter; left time: 1731.8294s
	iters: 800, epoch: 2 | loss: 0.2784557
	speed: 0.0847s/iter; left time: 1715.1714s
	iters: 900, epoch: 2 | loss: 0.2486214
	speed: 0.0836s/iter; left time: 1684.9777s
	iters: 1000, epoch: 2 | loss: 0.2589172
	speed: 0.0841s/iter; left time: 1686.2943s
	iters: 1100, epoch: 2 | loss: 0.2673121
	speed: 0.0853s/iter; left time: 1702.5275s
Epoch: 2 cost time: 94.68514943122864
Epoch: 2, Steps: 1108 | Train Loss: 0.2427949 Vali Loss: 0.2238448 Test Loss: 0.2522885
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.2057035
	speed: 0.2273s/iter; left time: 4510.4297s
	iters: 200, epoch: 3 | loss: 0.1957706
	speed: 0.0861s/iter; left time: 1700.2141s
	iters: 300, epoch: 3 | loss: 0.1826370
	speed: 0.0872s/iter; left time: 1712.7242s
	iters: 400, epoch: 3 | loss: 0.2159815
	speed: 0.0890s/iter; left time: 1739.9577s
	iters: 500, epoch: 3 | loss: 0.2100931
	speed: 0.0888s/iter; left time: 1726.0292s
	iters: 600, epoch: 3 | loss: 0.1983567
	speed: 0.0876s/iter; left time: 1694.3999s
	iters: 700, epoch: 3 | loss: 0.1887922
	speed: 0.0858s/iter; left time: 1650.4086s
	iters: 800, epoch: 3 | loss: 0.2156173
	speed: 0.0846s/iter; left time: 1620.3059s
	iters: 900, epoch: 3 | loss: 0.2287697
	speed: 0.0848s/iter; left time: 1615.5237s
	iters: 1000, epoch: 3 | loss: 0.1887643
	speed: 0.0852s/iter; left time: 1613.8970s
	iters: 1100, epoch: 3 | loss: 0.2142991
	speed: 0.0851s/iter; left time: 1603.3269s
Epoch: 3 cost time: 95.66928887367249
Epoch: 3, Steps: 1108 | Train Loss: 0.1963943 Vali Loss: 0.1726153 Test Loss: 0.1973474
Validation loss decreased (0.215424 --> 0.172615).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.1644972
	speed: 0.2403s/iter; left time: 4502.2695s
	iters: 200, epoch: 4 | loss: 0.1610925
	speed: 0.0855s/iter; left time: 1594.1665s
	iters: 300, epoch: 4 | loss: 0.1812591
	speed: 0.0848s/iter; left time: 1572.6932s
	iters: 400, epoch: 4 | loss: 0.1729005
	speed: 0.0852s/iter; left time: 1570.7295s
	iters: 500, epoch: 4 | loss: 0.1677762
	speed: 0.0840s/iter; left time: 1540.4902s
	iters: 600, epoch: 4 | loss: 0.1731604
	speed: 0.0849s/iter; left time: 1548.8877s
	iters: 700, epoch: 4 | loss: 0.1688260
	speed: 0.0846s/iter; left time: 1534.4721s
	iters: 800, epoch: 4 | loss: 0.1767222
	speed: 0.0842s/iter; left time: 1518.0807s
	iters: 900, epoch: 4 | loss: 0.2098029
	speed: 0.0842s/iter; left time: 1510.6156s
	iters: 1000, epoch: 4 | loss: 0.1574565
	speed: 0.0840s/iter; left time: 1498.0364s
	iters: 1100, epoch: 4 | loss: 0.2234412
	speed: 0.0840s/iter; left time: 1489.3055s
Epoch: 4 cost time: 93.75385880470276
Epoch: 4, Steps: 1108 | Train Loss: 0.1787667 Vali Loss: 0.1593491 Test Loss: 0.1852381
Validation loss decreased (0.172615 --> 0.159349).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.1764219
	speed: 0.2388s/iter; left time: 4210.5437s
	iters: 200, epoch: 5 | loss: 0.1705384
	speed: 0.0835s/iter; left time: 1464.3723s
	iters: 300, epoch: 5 | loss: 0.2126728
	speed: 0.0847s/iter; left time: 1475.5485s
	iters: 400, epoch: 5 | loss: 0.1664977
	speed: 0.0850s/iter; left time: 1473.6144s
	iters: 500, epoch: 5 | loss: 0.1795198
	speed: 0.0853s/iter; left time: 1470.0842s
	iters: 600, epoch: 5 | loss: 0.1497186
	speed: 0.0843s/iter; left time: 1443.2350s
	iters: 700, epoch: 5 | loss: 0.1499451
	speed: 0.0867s/iter; left time: 1476.7085s
	iters: 800, epoch: 5 | loss: 0.1625441
	speed: 0.0864s/iter; left time: 1462.4031s
	iters: 900, epoch: 5 | loss: 0.2059941
	speed: 0.0858s/iter; left time: 1443.9080s
	iters: 1000, epoch: 5 | loss: 0.1827126
	speed: 0.0837s/iter; left time: 1399.5655s
	iters: 1100, epoch: 5 | loss: 0.1649215
	speed: 0.0847s/iter; left time: 1407.7658s
Epoch: 5 cost time: 94.13068437576294
Epoch: 5, Steps: 1108 | Train Loss: 0.1699352 Vali Loss: 0.1478495 Test Loss: 0.1724364
Validation loss decreased (0.159349 --> 0.147850).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.1715780
	speed: 0.2434s/iter; left time: 4020.5702s
	iters: 200, epoch: 6 | loss: 0.1603411
	speed: 0.0860s/iter; left time: 1412.7919s
	iters: 300, epoch: 6 | loss: 0.1586948
	speed: 0.0865s/iter; left time: 1411.8396s
	iters: 400, epoch: 6 | loss: 0.1692999
	speed: 0.0860s/iter; left time: 1395.3144s
	iters: 500, epoch: 6 | loss: 0.1743663
	speed: 0.0855s/iter; left time: 1377.6366s
	iters: 600, epoch: 6 | loss: 0.1554277
	speed: 0.0861s/iter; left time: 1378.9054s
	iters: 700, epoch: 6 | loss: 0.1534371
	speed: 0.0863s/iter; left time: 1373.2896s
	iters: 800, epoch: 6 | loss: 0.1681372
	speed: 0.0866s/iter; left time: 1370.3336s
	iters: 900, epoch: 6 | loss: 0.1799181
	speed: 0.0868s/iter; left time: 1364.8014s
	iters: 1000, epoch: 6 | loss: 0.1798901
	speed: 0.0859s/iter; left time: 1342.5152s
	iters: 1100, epoch: 6 | loss: 0.1411343
	speed: 0.0858s/iter; left time: 1331.6721s
Epoch: 6 cost time: 95.4937264919281
Epoch: 6, Steps: 1108 | Train Loss: 0.1650023 Vali Loss: 0.1444106 Test Loss: 0.1690695
Validation loss decreased (0.147850 --> 0.144411).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.1623742
	speed: 0.2411s/iter; left time: 3716.4503s
	iters: 200, epoch: 7 | loss: 0.1263909
	speed: 0.0852s/iter; left time: 1304.4006s
	iters: 300, epoch: 7 | loss: 0.1516328
	speed: 0.0850s/iter; left time: 1293.4438s
	iters: 400, epoch: 7 | loss: 0.1741213
	speed: 0.0862s/iter; left time: 1302.2149s
	iters: 500, epoch: 7 | loss: 0.1870116
	speed: 0.0851s/iter; left time: 1276.9047s
	iters: 600, epoch: 7 | loss: 0.1778472
	speed: 0.0856s/iter; left time: 1275.9026s
	iters: 700, epoch: 7 | loss: 0.1447353
	speed: 0.0850s/iter; left time: 1259.1117s
	iters: 800, epoch: 7 | loss: 0.1508021
	speed: 0.0865s/iter; left time: 1271.9862s
	iters: 900, epoch: 7 | loss: 0.1560171
	speed: 0.0899s/iter; left time: 1313.9045s
	iters: 1000, epoch: 7 | loss: 0.1649023
	speed: 0.0886s/iter; left time: 1286.5028s
	iters: 1100, epoch: 7 | loss: 0.1465408
	speed: 0.0880s/iter; left time: 1268.7590s
Epoch: 7 cost time: 95.66327929496765
Epoch: 7, Steps: 1108 | Train Loss: 0.1625212 Vali Loss: 0.1429454 Test Loss: 0.1670889
Validation loss decreased (0.144411 --> 0.142945).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.1603095
	speed: 0.2419s/iter; left time: 3459.7656s
	iters: 200, epoch: 8 | loss: 0.1676731
	speed: 0.0846s/iter; left time: 1201.2401s
	iters: 300, epoch: 8 | loss: 0.1808807
	speed: 0.0842s/iter; left time: 1187.9982s
	iters: 400, epoch: 8 | loss: 0.1312384
	speed: 0.0849s/iter; left time: 1189.1476s
	iters: 500, epoch: 8 | loss: 0.1962911
	speed: 0.0845s/iter; left time: 1175.4453s
	iters: 600, epoch: 8 | loss: 0.1714799
	speed: 0.0837s/iter; left time: 1155.8601s
	iters: 700, epoch: 8 | loss: 0.1783615
	speed: 0.0847s/iter; left time: 1160.2427s
	iters: 800, epoch: 8 | loss: 0.1412920
	speed: 0.0842s/iter; left time: 1145.2068s
	iters: 900, epoch: 8 | loss: 0.1523760
	speed: 0.0849s/iter; left time: 1146.5532s
	iters: 1000, epoch: 8 | loss: 0.1465648
	speed: 0.0843s/iter; left time: 1129.6653s
	iters: 1100, epoch: 8 | loss: 0.1602513
	speed: 0.0870s/iter; left time: 1157.0523s
Epoch: 8 cost time: 93.97396302223206
Epoch: 8, Steps: 1108 | Train Loss: 0.1611049 Vali Loss: 0.1422073 Test Loss: 0.1664447
Validation loss decreased (0.142945 --> 0.142207).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.1681666
	speed: 0.2462s/iter; left time: 3249.7573s
	iters: 200, epoch: 9 | loss: 0.1800784
	speed: 0.0832s/iter; left time: 1089.2548s
	iters: 300, epoch: 9 | loss: 0.1374940
	speed: 0.0832s/iter; left time: 1081.4759s
	iters: 400, epoch: 9 | loss: 0.1627680
	speed: 0.0843s/iter; left time: 1086.6304s
	iters: 500, epoch: 9 | loss: 0.1583480
	speed: 0.0860s/iter; left time: 1100.8915s
	iters: 600, epoch: 9 | loss: 0.1602775
	speed: 0.0861s/iter; left time: 1092.8763s
	iters: 700, epoch: 9 | loss: 0.1596655
	speed: 0.0842s/iter; left time: 1061.0286s
	iters: 800, epoch: 9 | loss: 0.1617752
	speed: 0.0863s/iter; left time: 1078.2873s
	iters: 900, epoch: 9 | loss: 0.1372842
	speed: 0.0861s/iter; left time: 1067.7447s
	iters: 1000, epoch: 9 | loss: 0.2075604
	speed: 0.0851s/iter; left time: 1046.7006s
	iters: 1100, epoch: 9 | loss: 0.1400055
	speed: 0.0875s/iter; left time: 1067.0403s
Epoch: 9 cost time: 94.63766074180603
Epoch: 9, Steps: 1108 | Train Loss: 0.1603668 Vali Loss: 0.1412703 Test Loss: 0.1654910
Validation loss decreased (0.142207 --> 0.141270).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.1532562
	speed: 0.2457s/iter; left time: 2970.3627s
	iters: 200, epoch: 10 | loss: 0.1473168
	speed: 0.0854s/iter; left time: 1023.6759s
	iters: 300, epoch: 10 | loss: 0.1508343
	speed: 0.0848s/iter; left time: 1008.5627s
	iters: 400, epoch: 10 | loss: 0.1813963
	speed: 0.0853s/iter; left time: 1005.0424s
	iters: 500, epoch: 10 | loss: 0.1716070
	speed: 0.0849s/iter; left time: 992.2254s
	iters: 600, epoch: 10 | loss: 0.1430406
	speed: 0.0851s/iter; left time: 986.3839s
	iters: 700, epoch: 10 | loss: 0.1430941
	speed: 0.0856s/iter; left time: 983.7888s
	iters: 800, epoch: 10 | loss: 0.1628163
	speed: 0.0858s/iter; left time: 976.9761s
	iters: 900, epoch: 10 | loss: 0.1404183
	speed: 0.0856s/iter; left time: 966.5078s
	iters: 1000, epoch: 10 | loss: 0.1765546
	speed: 0.0846s/iter; left time: 946.7273s
	iters: 1100, epoch: 10 | loss: 0.1486131
	speed: 0.0859s/iter; left time: 952.5874s
Epoch: 10 cost time: 94.79365015029907
Epoch: 10, Steps: 1108 | Train Loss: 0.1599880 Vali Loss: 0.1408760 Test Loss: 0.1654001
Validation loss decreased (0.141270 --> 0.140876).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.1567055
	speed: 0.2428s/iter; left time: 2666.4450s
	iters: 200, epoch: 11 | loss: 0.1662909
	speed: 0.0875s/iter; left time: 951.7926s
	iters: 300, epoch: 11 | loss: 0.1660457
	speed: 0.0855s/iter; left time: 922.0327s
	iters: 400, epoch: 11 | loss: 0.1732395
	speed: 0.0841s/iter; left time: 897.8756s
	iters: 500, epoch: 11 | loss: 0.1846915
	speed: 0.0849s/iter; left time: 897.8524s
	iters: 600, epoch: 11 | loss: 0.1396229
	speed: 0.0844s/iter; left time: 885.0995s
	iters: 700, epoch: 11 | loss: 0.1430287
	speed: 0.0844s/iter; left time: 875.9711s
	iters: 800, epoch: 11 | loss: 0.1835512
	speed: 0.0841s/iter; left time: 864.2861s
	iters: 900, epoch: 11 | loss: 0.1795405
	speed: 0.0846s/iter; left time: 861.2308s
	iters: 1000, epoch: 11 | loss: 0.1679165
	speed: 0.0849s/iter; left time: 856.2226s
	iters: 1100, epoch: 11 | loss: 0.1508100
	speed: 0.0852s/iter; left time: 850.1484s
Epoch: 11 cost time: 94.22618627548218
Epoch: 11, Steps: 1108 | Train Loss: 0.1597810 Vali Loss: 0.1408041 Test Loss: 0.1650451
Validation loss decreased (0.140876 --> 0.140804).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.1493248
	speed: 0.2426s/iter; left time: 2394.7726s
	iters: 200, epoch: 12 | loss: 0.1674049
	speed: 0.0854s/iter; left time: 834.8428s
	iters: 300, epoch: 12 | loss: 0.1293146
	speed: 0.0852s/iter; left time: 824.2484s
	iters: 400, epoch: 12 | loss: 0.1756333
	speed: 0.0858s/iter; left time: 821.0147s
	iters: 500, epoch: 12 | loss: 0.1601581
	speed: 0.0846s/iter; left time: 801.3362s
	iters: 600, epoch: 12 | loss: 0.1503048
	speed: 0.0848s/iter; left time: 795.1528s
	iters: 700, epoch: 12 | loss: 0.1741288
	speed: 0.0845s/iter; left time: 783.9148s
	iters: 800, epoch: 12 | loss: 0.1569892
	speed: 0.0855s/iter; left time: 784.0413s
	iters: 900, epoch: 12 | loss: 0.1547050
	speed: 0.0860s/iter; left time: 780.3247s
	iters: 1000, epoch: 12 | loss: 0.1401962
	speed: 0.0847s/iter; left time: 760.2631s
	iters: 1100, epoch: 12 | loss: 0.1428822
	speed: 0.0858s/iter; left time: 761.2332s
Epoch: 12 cost time: 94.51110482215881
Epoch: 12, Steps: 1108 | Train Loss: 0.1596365 Vali Loss: 0.1406827 Test Loss: 0.1651028
Validation loss decreased (0.140804 --> 0.140683).  Saving model ...
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.2193287
	speed: 0.2436s/iter; left time: 2134.7659s
	iters: 200, epoch: 13 | loss: 0.1810166
	speed: 0.0858s/iter; left time: 743.4715s
	iters: 300, epoch: 13 | loss: 0.1804357
	speed: 0.0874s/iter; left time: 748.8275s
	iters: 400, epoch: 13 | loss: 0.1570060
	speed: 0.0887s/iter; left time: 750.8921s
	iters: 500, epoch: 13 | loss: 0.1767894
	speed: 0.0853s/iter; left time: 713.1532s
	iters: 600, epoch: 13 | loss: 0.1498727
	speed: 0.0853s/iter; left time: 705.1545s
	iters: 700, epoch: 13 | loss: 0.1588668
	speed: 0.0856s/iter; left time: 699.2217s
	iters: 800, epoch: 13 | loss: 0.1505431
	speed: 0.0847s/iter; left time: 682.9934s
	iters: 900, epoch: 13 | loss: 0.1611726
	speed: 0.0852s/iter; left time: 678.3239s
	iters: 1000, epoch: 13 | loss: 0.1861529
	speed: 0.0846s/iter; left time: 665.4535s
	iters: 1100, epoch: 13 | loss: 0.1612722
	speed: 0.0856s/iter; left time: 665.0272s
Epoch: 13 cost time: 95.17084884643555
Epoch: 13, Steps: 1108 | Train Loss: 0.1596120 Vali Loss: 0.1407048 Test Loss: 0.1651014
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.1369386
	speed: 0.2245s/iter; left time: 1718.8175s
	iters: 200, epoch: 14 | loss: 0.1596326
	speed: 0.0831s/iter; left time: 628.3146s
	iters: 300, epoch: 14 | loss: 0.1802510
	speed: 0.0895s/iter; left time: 667.2814s
	iters: 400, epoch: 14 | loss: 0.1954358
	speed: 0.0894s/iter; left time: 657.9495s
	iters: 500, epoch: 14 | loss: 0.1589374
	speed: 0.0890s/iter; left time: 646.2135s
	iters: 600, epoch: 14 | loss: 0.1654269
	speed: 0.0859s/iter; left time: 615.1022s
	iters: 700, epoch: 14 | loss: 0.1768718
	speed: 0.0835s/iter; left time: 589.5376s
	iters: 800, epoch: 14 | loss: 0.1614747
	speed: 0.0835s/iter; left time: 581.2148s
	iters: 900, epoch: 14 | loss: 0.1783387
	speed: 0.0841s/iter; left time: 576.9698s
	iters: 1000, epoch: 14 | loss: 0.1394780
	speed: 0.0841s/iter; left time: 568.0641s
	iters: 1100, epoch: 14 | loss: 0.1845857
	speed: 0.0840s/iter; left time: 559.0770s
Epoch: 14 cost time: 94.69607424736023
Epoch: 14, Steps: 1108 | Train Loss: 0.1595529 Vali Loss: 0.1407167 Test Loss: 0.1650823
EarlyStopping counter: 2 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.1398742
	speed: 0.2238s/iter; left time: 1465.4604s
	iters: 200, epoch: 15 | loss: 0.1435490
	speed: 0.0854s/iter; left time: 550.9055s
	iters: 300, epoch: 15 | loss: 0.1599156
	speed: 0.0851s/iter; left time: 540.3488s
	iters: 400, epoch: 15 | loss: 0.1363009
	speed: 0.0864s/iter; left time: 539.7492s
	iters: 500, epoch: 15 | loss: 0.1650727
	speed: 0.0889s/iter; left time: 546.6093s
	iters: 600, epoch: 15 | loss: 0.1651551
	speed: 0.0869s/iter; left time: 525.5479s
	iters: 700, epoch: 15 | loss: 0.1471470
	speed: 0.0883s/iter; left time: 525.2532s
	iters: 800, epoch: 15 | loss: 0.1662950
	speed: 0.0856s/iter; left time: 500.8260s
	iters: 900, epoch: 15 | loss: 0.1659147
	speed: 0.0857s/iter; left time: 492.8877s
	iters: 1000, epoch: 15 | loss: 0.1413780
	speed: 0.0845s/iter; left time: 477.1449s
	iters: 1100, epoch: 15 | loss: 0.2090153
	speed: 0.0856s/iter; left time: 475.1168s
Epoch: 15 cost time: 95.38106417655945
Epoch: 15, Steps: 1108 | Train Loss: 0.1595500 Vali Loss: 0.1406638 Test Loss: 0.1650795
Validation loss decreased (0.140683 --> 0.140664).  Saving model ...
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.1551461
	speed: 0.2434s/iter; left time: 1324.2923s
	iters: 200, epoch: 16 | loss: 0.1943333
	speed: 0.0859s/iter; left time: 458.7892s
	iters: 300, epoch: 16 | loss: 0.1392264
	speed: 0.0856s/iter; left time: 448.6751s
	iters: 400, epoch: 16 | loss: 0.1584816
	speed: 0.0864s/iter; left time: 444.4387s
	iters: 500, epoch: 16 | loss: 0.1730549
	speed: 0.0854s/iter; left time: 430.4920s
	iters: 600, epoch: 16 | loss: 0.1642966
	speed: 0.0844s/iter; left time: 417.0578s
	iters: 700, epoch: 16 | loss: 0.1733610
	speed: 0.0866s/iter; left time: 419.0691s
	iters: 800, epoch: 16 | loss: 0.1331897
	speed: 0.0868s/iter; left time: 411.5965s
	iters: 900, epoch: 16 | loss: 0.1625586
	speed: 0.0848s/iter; left time: 393.7315s
	iters: 1000, epoch: 16 | loss: 0.1640285
	speed: 0.0858s/iter; left time: 389.4634s
	iters: 1100, epoch: 16 | loss: 0.1564778
	speed: 0.0852s/iter; left time: 378.3696s
Epoch: 16 cost time: 95.02252840995789
Epoch: 16, Steps: 1108 | Train Loss: 0.1595203 Vali Loss: 0.1406662 Test Loss: 0.1650810
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 17 | loss: 0.1555987
	speed: 0.2249s/iter; left time: 974.5615s
	iters: 200, epoch: 17 | loss: 0.1510409
	speed: 0.0847s/iter; left time: 358.5676s
	iters: 300, epoch: 17 | loss: 0.1366313
	speed: 0.0847s/iter; left time: 350.0098s
	iters: 400, epoch: 17 | loss: 0.1537850
	speed: 0.0859s/iter; left time: 346.4799s
	iters: 500, epoch: 17 | loss: 0.1619452
	speed: 0.0852s/iter; left time: 335.1036s
	iters: 600, epoch: 17 | loss: 0.1545377
	speed: 0.0853s/iter; left time: 327.0060s
	iters: 700, epoch: 17 | loss: 0.1515036
	speed: 0.0843s/iter; left time: 314.5648s
	iters: 800, epoch: 17 | loss: 0.1459013
	speed: 0.0851s/iter; left time: 309.2327s
	iters: 900, epoch: 17 | loss: 0.1593876
	speed: 0.0842s/iter; left time: 297.5696s
	iters: 1000, epoch: 17 | loss: 0.1378323
	speed: 0.0836s/iter; left time: 286.8899s
	iters: 1100, epoch: 17 | loss: 0.1649867
	speed: 0.0841s/iter; left time: 280.2550s
Epoch: 17 cost time: 93.84516716003418
Epoch: 17, Steps: 1108 | Train Loss: 0.1595286 Vali Loss: 0.1407160 Test Loss: 0.1650822
EarlyStopping counter: 2 out of 5
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 18 | loss: 0.1353296
	speed: 0.2234s/iter; left time: 720.3787s
	iters: 200, epoch: 18 | loss: 0.1806404
	speed: 0.0842s/iter; left time: 263.2588s
	iters: 300, epoch: 18 | loss: 0.1631683
	speed: 0.0849s/iter; left time: 256.7814s
	iters: 400, epoch: 18 | loss: 0.1569227
	speed: 0.0842s/iter; left time: 246.3175s
	iters: 500, epoch: 18 | loss: 0.1413866
	speed: 0.0844s/iter; left time: 238.4073s
	iters: 600, epoch: 18 | loss: 0.1433969
	speed: 0.0848s/iter; left time: 231.0762s
	iters: 700, epoch: 18 | loss: 0.1385586
	speed: 0.0849s/iter; left time: 222.8569s
	iters: 800, epoch: 18 | loss: 0.2304362
	speed: 0.0837s/iter; left time: 211.4305s
	iters: 900, epoch: 18 | loss: 0.1851496
	speed: 0.0850s/iter; left time: 206.2268s
	iters: 1000, epoch: 18 | loss: 0.1757236
	speed: 0.0888s/iter; left time: 206.5682s
	iters: 1100, epoch: 18 | loss: 0.1865424
	speed: 0.0870s/iter; left time: 193.5620s
Epoch: 18 cost time: 94.2734944820404
Epoch: 18, Steps: 1108 | Train Loss: 0.1595443 Vali Loss: 0.1406519 Test Loss: 0.1650818
Validation loss decreased (0.140664 --> 0.140652).  Saving model ...
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 19 | loss: 0.1879874
	speed: 0.2422s/iter; left time: 512.7530s
	iters: 200, epoch: 19 | loss: 0.1446241
	speed: 0.0835s/iter; left time: 168.3954s
	iters: 300, epoch: 19 | loss: 0.1742750
	speed: 0.0850s/iter; left time: 162.8694s
	iters: 400, epoch: 19 | loss: 0.1635399
	speed: 0.0860s/iter; left time: 156.2838s
	iters: 500, epoch: 19 | loss: 0.1924338
	speed: 0.0856s/iter; left time: 146.9171s
	iters: 600, epoch: 19 | loss: 0.1696628
	speed: 0.0856s/iter; left time: 138.3369s
	iters: 700, epoch: 19 | loss: 0.1623232
	speed: 0.0852s/iter; left time: 129.2620s
	iters: 800, epoch: 19 | loss: 0.1471505
	speed: 0.0851s/iter; left time: 120.5408s
	iters: 900, epoch: 19 | loss: 0.1446517
	speed: 0.0849s/iter; left time: 111.7951s
	iters: 1000, epoch: 19 | loss: 0.1854387
	speed: 0.0866s/iter; left time: 105.3708s
	iters: 1100, epoch: 19 | loss: 0.1758092
	speed: 0.0887s/iter; left time: 99.0503s
Epoch: 19 cost time: 94.91323328018188
Epoch: 19, Steps: 1108 | Train Loss: 0.1595177 Vali Loss: 0.1407283 Test Loss: 0.1650818
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.9073486328125e-08
	iters: 100, epoch: 20 | loss: 0.1247732
	speed: 0.2267s/iter; left time: 228.7846s
	iters: 200, epoch: 20 | loss: 0.1486631
	speed: 0.0856s/iter; left time: 77.8361s
	iters: 300, epoch: 20 | loss: 0.1576464
	speed: 0.0855s/iter; left time: 69.1476s
	iters: 400, epoch: 20 | loss: 0.1699070
	speed: 0.0853s/iter; left time: 60.4566s
	iters: 500, epoch: 20 | loss: 0.1537317
	speed: 0.0845s/iter; left time: 51.4777s
	iters: 600, epoch: 20 | loss: 0.1582310
	speed: 0.0850s/iter; left time: 43.2818s
	iters: 700, epoch: 20 | loss: 0.1687931
	speed: 0.0854s/iter; left time: 34.9277s
	iters: 800, epoch: 20 | loss: 0.1950929
	speed: 0.0855s/iter; left time: 26.4105s
	iters: 900, epoch: 20 | loss: 0.1424239
	speed: 0.0853s/iter; left time: 17.8280s
	iters: 1000, epoch: 20 | loss: 0.1820313
	speed: 0.0847s/iter; left time: 9.2364s
	iters: 1100, epoch: 20 | loss: 0.1657428
	speed: 0.0865s/iter; left time: 0.7781s
Epoch: 20 cost time: 94.66361784934998
Epoch: 20, Steps: 1108 | Train Loss: 0.1595197 Vali Loss: 0.1407293 Test Loss: 0.1650818
EarlyStopping counter: 2 out of 5
Updating learning rate to 9.5367431640625e-09
>>>>>>>testing : Electricity_336_336_Linear_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15227<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4925
mse:0.16496266424655914, mae:0.2633168697357178
