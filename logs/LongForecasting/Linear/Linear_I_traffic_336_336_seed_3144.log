Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='Linear', model_id='traffic_336_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=336, root_path='./dataset/', save_pred_values=False, seed=3144, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_336_336_Linear_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3144>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11609
val 1421
test 3173
	iters: 100, epoch: 1 | loss: 0.4477512
	speed: 0.3248s/iter; left time: 4677.8258s
	iters: 200, epoch: 1 | loss: 0.5054210
	speed: 0.3095s/iter; left time: 4425.6042s
	iters: 300, epoch: 1 | loss: 0.4720923
	speed: 0.3098s/iter; left time: 4399.7029s
	iters: 400, epoch: 1 | loss: 0.4761997
	speed: 0.3115s/iter; left time: 4391.8477s
	iters: 500, epoch: 1 | loss: 0.4866075
	speed: 0.3082s/iter; left time: 4315.1118s
	iters: 600, epoch: 1 | loss: 0.4864386
	speed: 0.3077s/iter; left time: 4277.6168s
	iters: 700, epoch: 1 | loss: 0.4841563
	speed: 0.3078s/iter; left time: 4247.7142s
Epoch: 1 cost time: 226.03366017341614
Epoch: 1, Steps: 725 | Train Loss: 0.4940990 Vali Loss: 0.6354601 Test Loss: 0.7617333
Validation loss decreased (inf --> 0.635460).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.4559691
	speed: 0.6104s/iter; left time: 8347.7617s
	iters: 200, epoch: 2 | loss: 0.5054829
	speed: 0.3103s/iter; left time: 4212.4016s
	iters: 300, epoch: 2 | loss: 0.4804223
	speed: 0.3087s/iter; left time: 4159.8733s
	iters: 400, epoch: 2 | loss: 0.4786060
	speed: 0.3078s/iter; left time: 4117.0331s
	iters: 500, epoch: 2 | loss: 0.5114484
	speed: 0.3091s/iter; left time: 4104.2714s
	iters: 600, epoch: 2 | loss: 0.5058269
	speed: 0.3098s/iter; left time: 4081.7228s
	iters: 700, epoch: 2 | loss: 0.4501759
	speed: 0.3077s/iter; left time: 4023.7498s
Epoch: 2 cost time: 224.14330506324768
Epoch: 2, Steps: 725 | Train Loss: 0.4853957 Vali Loss: 0.6436353 Test Loss: 0.7721882
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.3317234
	speed: 0.6052s/iter; left time: 7838.3686s
	iters: 200, epoch: 3 | loss: 0.3256463
	speed: 0.3099s/iter; left time: 3982.6897s
	iters: 300, epoch: 3 | loss: 0.3194716
	speed: 0.3108s/iter; left time: 3963.0519s
	iters: 400, epoch: 3 | loss: 0.3272848
	speed: 0.3092s/iter; left time: 3912.2392s
	iters: 500, epoch: 3 | loss: 0.3480210
	speed: 0.3110s/iter; left time: 3903.4334s
	iters: 600, epoch: 3 | loss: 0.3441524
	speed: 0.3103s/iter; left time: 3863.7986s
	iters: 700, epoch: 3 | loss: 0.3242463
	speed: 0.3104s/iter; left time: 3833.2812s
Epoch: 3 cost time: 224.82121658325195
Epoch: 3, Steps: 725 | Train Loss: 0.3413249 Vali Loss: 0.4736929 Test Loss: 0.5757062
Validation loss decreased (0.635460 --> 0.473693).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.3128064
	speed: 0.6138s/iter; left time: 7504.1190s
	iters: 200, epoch: 4 | loss: 0.2796532
	speed: 0.3103s/iter; left time: 3762.2708s
	iters: 300, epoch: 4 | loss: 0.2561710
	speed: 0.3100s/iter; left time: 3727.5686s
	iters: 400, epoch: 4 | loss: 0.3126541
	speed: 0.3107s/iter; left time: 3704.9827s
	iters: 500, epoch: 4 | loss: 0.2983730
	speed: 0.3094s/iter; left time: 3658.5314s
	iters: 600, epoch: 4 | loss: 0.3236714
	speed: 0.3093s/iter; left time: 3627.0549s
	iters: 700, epoch: 4 | loss: 0.2839736
	speed: 0.3090s/iter; left time: 3592.7353s
Epoch: 4 cost time: 225.12782526016235
Epoch: 4, Steps: 725 | Train Loss: 0.2939195 Vali Loss: 0.4131339 Test Loss: 0.5069891
Validation loss decreased (0.473693 --> 0.413134).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.2948565
	speed: 0.6116s/iter; left time: 7033.8944s
	iters: 200, epoch: 5 | loss: 0.2520657
	speed: 0.3079s/iter; left time: 3509.9210s
	iters: 300, epoch: 5 | loss: 0.2862933
	speed: 0.3098s/iter; left time: 3501.2538s
	iters: 400, epoch: 5 | loss: 0.2809438
	speed: 0.3093s/iter; left time: 3464.1830s
	iters: 500, epoch: 5 | loss: 0.2607514
	speed: 0.3084s/iter; left time: 3423.6119s
	iters: 600, epoch: 5 | loss: 0.2843430
	speed: 0.3088s/iter; left time: 3397.3482s
	iters: 700, epoch: 5 | loss: 0.2479948
	speed: 0.3086s/iter; left time: 3363.6938s
Epoch: 5 cost time: 224.07748794555664
Epoch: 5, Steps: 725 | Train Loss: 0.2722794 Vali Loss: 0.3928456 Test Loss: 0.4798030
Validation loss decreased (0.413134 --> 0.392846).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.2405810
	speed: 0.6090s/iter; left time: 6562.7812s
	iters: 200, epoch: 6 | loss: 0.2676366
	speed: 0.3098s/iter; left time: 3307.5954s
	iters: 300, epoch: 6 | loss: 0.2567618
	speed: 0.3120s/iter; left time: 3299.8390s
	iters: 400, epoch: 6 | loss: 0.2650585
	speed: 0.3111s/iter; left time: 3258.6864s
	iters: 500, epoch: 6 | loss: 0.2730038
	speed: 0.3092s/iter; left time: 3207.7793s
	iters: 600, epoch: 6 | loss: 0.2844357
	speed: 0.3091s/iter; left time: 3176.4991s
	iters: 700, epoch: 6 | loss: 0.2570074
	speed: 0.3085s/iter; left time: 3139.7905s
Epoch: 6 cost time: 224.69485759735107
Epoch: 6, Steps: 725 | Train Loss: 0.2612481 Vali Loss: 0.3819111 Test Loss: 0.4666397
Validation loss decreased (0.392846 --> 0.381911).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.2294249
	speed: 0.6190s/iter; left time: 6221.6543s
	iters: 200, epoch: 7 | loss: 0.2474158
	speed: 0.3097s/iter; left time: 3081.8993s
	iters: 300, epoch: 7 | loss: 0.2592761
	speed: 0.3074s/iter; left time: 3028.3923s
	iters: 400, epoch: 7 | loss: 0.2545812
	speed: 0.3099s/iter; left time: 3021.5305s
	iters: 500, epoch: 7 | loss: 0.2480887
	speed: 0.3095s/iter; left time: 2987.4386s
	iters: 600, epoch: 7 | loss: 0.2697548
	speed: 0.3086s/iter; left time: 2947.2700s
	iters: 700, epoch: 7 | loss: 0.2563754
	speed: 0.3087s/iter; left time: 2917.8191s
Epoch: 7 cost time: 224.16184759140015
Epoch: 7, Steps: 725 | Train Loss: 0.2552289 Vali Loss: 0.3752737 Test Loss: 0.4589659
Validation loss decreased (0.381911 --> 0.375274).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.2489223
	speed: 0.6118s/iter; left time: 5705.8009s
	iters: 200, epoch: 8 | loss: 0.2572180
	speed: 0.3109s/iter; left time: 2867.9749s
	iters: 300, epoch: 8 | loss: 0.2693611
	speed: 0.3092s/iter; left time: 2822.0647s
	iters: 400, epoch: 8 | loss: 0.2347576
	speed: 0.3084s/iter; left time: 2783.6534s
	iters: 500, epoch: 8 | loss: 0.2362381
	speed: 0.3091s/iter; left time: 2759.0114s
	iters: 600, epoch: 8 | loss: 0.2335183
	speed: 0.3108s/iter; left time: 2742.8977s
	iters: 700, epoch: 8 | loss: 0.2505836
	speed: 0.3108s/iter; left time: 2711.7646s
Epoch: 8 cost time: 224.7207155227661
Epoch: 8, Steps: 725 | Train Loss: 0.2519257 Vali Loss: 0.3730790 Test Loss: 0.4556083
Validation loss decreased (0.375274 --> 0.373079).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.2346732
	speed: 0.6114s/iter; left time: 5258.6642s
	iters: 200, epoch: 9 | loss: 0.2473664
	speed: 0.3112s/iter; left time: 2645.8250s
	iters: 300, epoch: 9 | loss: 0.2601748
	speed: 0.3095s/iter; left time: 2599.7668s
	iters: 400, epoch: 9 | loss: 0.2439821
	speed: 0.3082s/iter; left time: 2558.4645s
	iters: 500, epoch: 9 | loss: 0.2371244
	speed: 0.3087s/iter; left time: 2531.7412s
	iters: 600, epoch: 9 | loss: 0.2655979
	speed: 0.3098s/iter; left time: 2510.0897s
	iters: 700, epoch: 9 | loss: 0.2446666
	speed: 0.3104s/iter; left time: 2483.5332s
Epoch: 9 cost time: 224.61706733703613
Epoch: 9, Steps: 725 | Train Loss: 0.2500615 Vali Loss: 0.3716492 Test Loss: 0.4542744
Validation loss decreased (0.373079 --> 0.371649).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.2622226
	speed: 0.6114s/iter; left time: 4815.6028s
	iters: 200, epoch: 10 | loss: 0.2536259
	speed: 0.3102s/iter; left time: 2411.9393s
	iters: 300, epoch: 10 | loss: 0.2366387
	speed: 0.3129s/iter; left time: 2401.8676s
	iters: 400, epoch: 10 | loss: 0.2496226
	speed: 0.3110s/iter; left time: 2356.0308s
	iters: 500, epoch: 10 | loss: 0.2546127
	speed: 0.3095s/iter; left time: 2313.4618s
	iters: 600, epoch: 10 | loss: 0.2579904
	speed: 0.3097s/iter; left time: 2284.5825s
	iters: 700, epoch: 10 | loss: 0.2433502
	speed: 0.3124s/iter; left time: 2272.9971s
Epoch: 10 cost time: 225.65036821365356
Epoch: 10, Steps: 725 | Train Loss: 0.2490831 Vali Loss: 0.3710273 Test Loss: 0.4537216
Validation loss decreased (0.371649 --> 0.371027).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.2437079
	speed: 0.6130s/iter; left time: 4383.4990s
	iters: 200, epoch: 11 | loss: 0.2737550
	speed: 0.3098s/iter; left time: 2184.4125s
	iters: 300, epoch: 11 | loss: 0.2429690
	speed: 0.3129s/iter; left time: 2174.7204s
	iters: 400, epoch: 11 | loss: 0.2632422
	speed: 0.3110s/iter; left time: 2130.8111s
	iters: 500, epoch: 11 | loss: 0.2391293
	speed: 0.3097s/iter; left time: 2090.6545s
	iters: 600, epoch: 11 | loss: 0.2574005
	speed: 0.3097s/iter; left time: 2060.0155s
	iters: 700, epoch: 11 | loss: 0.2317396
	speed: 0.3116s/iter; left time: 2041.1440s
Epoch: 11 cost time: 225.48653054237366
Epoch: 11, Steps: 725 | Train Loss: 0.2485113 Vali Loss: 0.3710521 Test Loss: 0.4534587
EarlyStopping counter: 1 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.2589970
	speed: 0.6063s/iter; left time: 3896.1948s
	iters: 200, epoch: 12 | loss: 0.2387090
	speed: 0.3107s/iter; left time: 1965.2106s
	iters: 300, epoch: 12 | loss: 0.2663107
	speed: 0.3110s/iter; left time: 1936.4188s
	iters: 400, epoch: 12 | loss: 0.2441758
	speed: 0.3086s/iter; left time: 1890.2827s
	iters: 500, epoch: 12 | loss: 0.2520861
	speed: 0.3089s/iter; left time: 1861.1824s
	iters: 600, epoch: 12 | loss: 0.2470673
	speed: 0.3066s/iter; left time: 1816.9911s
	iters: 700, epoch: 12 | loss: 0.2339965
	speed: 0.3105s/iter; left time: 1808.7011s
Epoch: 12 cost time: 224.3700828552246
Epoch: 12, Steps: 725 | Train Loss: 0.2482558 Vali Loss: 0.3707460 Test Loss: 0.4533400
Validation loss decreased (0.371027 --> 0.370746).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.2454501
	speed: 0.6125s/iter; left time: 3491.7287s
	iters: 200, epoch: 13 | loss: 0.2466482
	speed: 0.3098s/iter; left time: 1735.1417s
	iters: 300, epoch: 13 | loss: 0.2330465
	speed: 0.3098s/iter; left time: 1704.3553s
	iters: 400, epoch: 13 | loss: 0.2633847
	speed: 0.3117s/iter; left time: 1683.6743s
	iters: 500, epoch: 13 | loss: 0.2556065
	speed: 0.3104s/iter; left time: 1645.5380s
	iters: 600, epoch: 13 | loss: 0.2449423
	speed: 0.3106s/iter; left time: 1615.3026s
	iters: 700, epoch: 13 | loss: 0.2542615
	speed: 0.3107s/iter; left time: 1584.6720s
Epoch: 13 cost time: 225.37370467185974
Epoch: 13, Steps: 725 | Train Loss: 0.2481207 Vali Loss: 0.3705145 Test Loss: 0.4532717
Validation loss decreased (0.370746 --> 0.370515).  Saving model ...
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 14 | loss: 0.2261417
	speed: 0.6144s/iter; left time: 3057.3557s
	iters: 200, epoch: 14 | loss: 0.2525920
	speed: 0.3075s/iter; left time: 1499.4486s
	iters: 300, epoch: 14 | loss: 0.2374167
	speed: 0.3083s/iter; left time: 1472.4755s
	iters: 400, epoch: 14 | loss: 0.2550743
	speed: 0.3080s/iter; left time: 1440.3284s
	iters: 500, epoch: 14 | loss: 0.2655924
	speed: 0.3087s/iter; left time: 1412.5612s
	iters: 600, epoch: 14 | loss: 0.2719958
	speed: 0.3094s/iter; left time: 1384.7869s
	iters: 700, epoch: 14 | loss: 0.2402097
	speed: 0.3091s/iter; left time: 1352.7464s
Epoch: 14 cost time: 224.0232813358307
Epoch: 14, Steps: 725 | Train Loss: 0.2480027 Vali Loss: 0.3705490 Test Loss: 0.4532607
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 15 | loss: 0.2574795
	speed: 0.6073s/iter; left time: 2581.7067s
	iters: 200, epoch: 15 | loss: 0.2498867
	speed: 0.3087s/iter; left time: 1281.3452s
	iters: 300, epoch: 15 | loss: 0.2355080
	speed: 0.3085s/iter; left time: 1249.7484s
	iters: 400, epoch: 15 | loss: 0.2775064
	speed: 0.3095s/iter; left time: 1222.9435s
	iters: 500, epoch: 15 | loss: 0.2312197
	speed: 0.3077s/iter; left time: 1184.8277s
	iters: 600, epoch: 15 | loss: 0.2512046
	speed: 0.3075s/iter; left time: 1153.4126s
	iters: 700, epoch: 15 | loss: 0.2680522
	speed: 0.3093s/iter; left time: 1129.1881s
Epoch: 15 cost time: 223.8973524570465
Epoch: 15, Steps: 725 | Train Loss: 0.2479889 Vali Loss: 0.3707767 Test Loss: 0.4532543
EarlyStopping counter: 2 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 16 | loss: 0.2680115
	speed: 0.6073s/iter; left time: 2141.4161s
	iters: 200, epoch: 16 | loss: 0.2539263
	speed: 0.2855s/iter; left time: 978.1503s
	iters: 300, epoch: 16 | loss: 0.2153062
	speed: 0.3092s/iter; left time: 1028.5650s
	iters: 400, epoch: 16 | loss: 0.2214119
	speed: 0.3086s/iter; left time: 995.4315s
	iters: 500, epoch: 16 | loss: 0.2399959
	speed: 0.3099s/iter; left time: 968.8919s
	iters: 600, epoch: 16 | loss: 0.2400386
	speed: 0.3083s/iter; left time: 932.8109s
	iters: 700, epoch: 16 | loss: 0.2317026
	speed: 0.3080s/iter; left time: 901.1978s
Epoch: 16 cost time: 221.72643613815308
Epoch: 16, Steps: 725 | Train Loss: 0.2479683 Vali Loss: 0.3710485 Test Loss: 0.4532546
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 17 | loss: 0.2503371
	speed: 0.6052s/iter; left time: 1695.2131s
	iters: 200, epoch: 17 | loss: 0.2328610
	speed: 0.3107s/iter; left time: 839.3053s
	iters: 300, epoch: 17 | loss: 0.2551115
	speed: 0.3088s/iter; left time: 803.0784s
	iters: 400, epoch: 17 | loss: 0.2388929
	speed: 0.3083s/iter; left time: 771.0779s
	iters: 500, epoch: 17 | loss: 0.2563968
	speed: 0.3087s/iter; left time: 741.1393s
	iters: 600, epoch: 17 | loss: 0.2479481
	speed: 0.3113s/iter; left time: 716.2071s
	iters: 700, epoch: 17 | loss: 0.2451663
	speed: 0.3089s/iter; left time: 679.9767s
Epoch: 17 cost time: 224.27119946479797
Epoch: 17, Steps: 725 | Train Loss: 0.2479165 Vali Loss: 0.3706467 Test Loss: 0.4532544
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 18 | loss: 0.2588329
	speed: 0.6061s/iter; left time: 1258.2432s
	iters: 200, epoch: 18 | loss: 0.2390705
	speed: 0.3109s/iter; left time: 614.2688s
	iters: 300, epoch: 18 | loss: 0.2463724
	speed: 0.3080s/iter; left time: 577.7989s
	iters: 400, epoch: 18 | loss: 0.2390365
	speed: 0.3090s/iter; left time: 548.8713s
	iters: 500, epoch: 18 | loss: 0.2309784
	speed: 0.3091s/iter; left time: 517.9801s
	iters: 600, epoch: 18 | loss: 0.2646151
	speed: 0.3121s/iter; left time: 491.9011s
	iters: 700, epoch: 18 | loss: 0.2355024
	speed: 0.3082s/iter; left time: 454.9011s
Epoch: 18 cost time: 224.44496870040894
Epoch: 18, Steps: 725 | Train Loss: 0.2478806 Vali Loss: 0.3707353 Test Loss: 0.4532545
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : traffic_336_336_Linear_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3144<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3173
mse:0.45229798555374146, mae:0.3120509386062622
