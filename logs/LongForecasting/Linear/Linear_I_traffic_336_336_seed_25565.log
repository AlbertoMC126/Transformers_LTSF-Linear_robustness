Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='Linear', model_id='traffic_336_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=336, root_path='./dataset/', save_pred_values=False, seed=25565, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_336_336_Linear_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed25565>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11609
val 1421
test 3173
	iters: 100, epoch: 1 | loss: 0.4335473
	speed: 0.3266s/iter; left time: 4703.8799s
	iters: 200, epoch: 1 | loss: 0.4686295
	speed: 0.3119s/iter; left time: 4460.1737s
	iters: 300, epoch: 1 | loss: 0.4718685
	speed: 0.3117s/iter; left time: 4427.1514s
	iters: 400, epoch: 1 | loss: 0.4579397
	speed: 0.3134s/iter; left time: 4418.6249s
	iters: 500, epoch: 1 | loss: 0.4639338
	speed: 0.3117s/iter; left time: 4364.1206s
	iters: 600, epoch: 1 | loss: 0.4603861
	speed: 0.3109s/iter; left time: 4321.5953s
	iters: 700, epoch: 1 | loss: 0.4660254
	speed: 0.3099s/iter; left time: 4277.6186s
Epoch: 1 cost time: 227.64547514915466
Epoch: 1, Steps: 725 | Train Loss: 0.4942109 Vali Loss: 0.6416252 Test Loss: 0.7687027
Validation loss decreased (inf --> 0.641625).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.4564368
	speed: 0.6129s/iter; left time: 8381.5197s
	iters: 200, epoch: 2 | loss: 0.4958871
	speed: 0.3110s/iter; left time: 4222.5960s
	iters: 300, epoch: 2 | loss: 0.4865148
	speed: 0.3104s/iter; left time: 4182.4621s
	iters: 400, epoch: 2 | loss: 0.4735125
	speed: 0.3098s/iter; left time: 4144.5293s
	iters: 500, epoch: 2 | loss: 0.4846936
	speed: 0.3138s/iter; left time: 4165.8242s
	iters: 600, epoch: 2 | loss: 0.4970127
	speed: 0.3111s/iter; left time: 4098.4246s
	iters: 700, epoch: 2 | loss: 0.5094834
	speed: 0.3104s/iter; left time: 4058.5329s
Epoch: 2 cost time: 225.67254304885864
Epoch: 2, Steps: 725 | Train Loss: 0.4863751 Vali Loss: 0.6530836 Test Loss: 0.7855940
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.3465791
	speed: 0.6090s/iter; left time: 7886.5414s
	iters: 200, epoch: 3 | loss: 0.3541533
	speed: 0.3098s/iter; left time: 3981.3391s
	iters: 300, epoch: 3 | loss: 0.3281895
	speed: 0.3101s/iter; left time: 3954.5216s
	iters: 400, epoch: 3 | loss: 0.3562579
	speed: 0.3122s/iter; left time: 3949.9153s
	iters: 500, epoch: 3 | loss: 0.3182274
	speed: 0.3113s/iter; left time: 3907.6281s
	iters: 600, epoch: 3 | loss: 0.3453809
	speed: 0.3112s/iter; left time: 3874.4312s
	iters: 700, epoch: 3 | loss: 0.3621627
	speed: 0.3105s/iter; left time: 3835.0985s
Epoch: 3 cost time: 225.47342228889465
Epoch: 3, Steps: 725 | Train Loss: 0.3417738 Vali Loss: 0.4734848 Test Loss: 0.5743892
Validation loss decreased (0.641625 --> 0.473485).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.2784052
	speed: 0.6143s/iter; left time: 7510.6064s
	iters: 200, epoch: 4 | loss: 0.2735051
	speed: 0.3091s/iter; left time: 3748.0702s
	iters: 300, epoch: 4 | loss: 0.3194521
	speed: 0.3095s/iter; left time: 3721.5771s
	iters: 400, epoch: 4 | loss: 0.3040121
	speed: 0.3125s/iter; left time: 3727.3612s
	iters: 500, epoch: 4 | loss: 0.3026382
	speed: 0.3113s/iter; left time: 3682.0014s
	iters: 600, epoch: 4 | loss: 0.2786664
	speed: 0.3117s/iter; left time: 3655.1008s
	iters: 700, epoch: 4 | loss: 0.3085831
	speed: 0.3142s/iter; left time: 3653.4490s
Epoch: 4 cost time: 225.94921612739563
Epoch: 4, Steps: 725 | Train Loss: 0.2939262 Vali Loss: 0.4138249 Test Loss: 0.5049069
Validation loss decreased (0.473485 --> 0.413825).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.2520760
	speed: 0.6165s/iter; left time: 7090.4516s
	iters: 200, epoch: 5 | loss: 0.2517100
	speed: 0.3108s/iter; left time: 3543.7070s
	iters: 300, epoch: 5 | loss: 0.2496266
	speed: 0.3122s/iter; left time: 3528.3980s
	iters: 400, epoch: 5 | loss: 0.2808856
	speed: 0.3106s/iter; left time: 3478.7669s
	iters: 500, epoch: 5 | loss: 0.2868131
	speed: 0.3110s/iter; left time: 3452.2881s
	iters: 600, epoch: 5 | loss: 0.2823232
	speed: 0.3126s/iter; left time: 3439.0980s
	iters: 700, epoch: 5 | loss: 0.2938147
	speed: 0.3112s/iter; left time: 3392.5374s
Epoch: 5 cost time: 226.1229543685913
Epoch: 5, Steps: 725 | Train Loss: 0.2722228 Vali Loss: 0.3910938 Test Loss: 0.4778860
Validation loss decreased (0.413825 --> 0.391094).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.2526009
	speed: 0.6137s/iter; left time: 6613.6741s
	iters: 200, epoch: 6 | loss: 0.2545296
	speed: 0.3137s/iter; left time: 3348.7267s
	iters: 300, epoch: 6 | loss: 0.3068449
	speed: 0.3112s/iter; left time: 3290.8263s
	iters: 400, epoch: 6 | loss: 0.2612565
	speed: 0.3111s/iter; left time: 3259.0170s
	iters: 500, epoch: 6 | loss: 0.2518603
	speed: 0.3115s/iter; left time: 3232.0812s
	iters: 600, epoch: 6 | loss: 0.2541532
	speed: 0.3110s/iter; left time: 3196.1390s
	iters: 700, epoch: 6 | loss: 0.2961312
	speed: 0.3101s/iter; left time: 3155.1778s
Epoch: 6 cost time: 225.9023826122284
Epoch: 6, Steps: 725 | Train Loss: 0.2612695 Vali Loss: 0.3813882 Test Loss: 0.4660214
Validation loss decreased (0.391094 --> 0.381388).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.2795857
	speed: 0.6135s/iter; left time: 6166.3827s
	iters: 200, epoch: 7 | loss: 0.2602817
	speed: 0.3117s/iter; left time: 3101.6785s
	iters: 300, epoch: 7 | loss: 0.2584405
	speed: 0.3111s/iter; left time: 3064.6128s
	iters: 400, epoch: 7 | loss: 0.2407555
	speed: 0.3107s/iter; left time: 3029.7945s
	iters: 500, epoch: 7 | loss: 0.2446538
	speed: 0.3096s/iter; left time: 2987.9184s
	iters: 600, epoch: 7 | loss: 0.2515225
	speed: 0.3105s/iter; left time: 2965.5698s
	iters: 700, epoch: 7 | loss: 0.2608711
	speed: 0.3087s/iter; left time: 2917.7767s
Epoch: 7 cost time: 225.27829384803772
Epoch: 7, Steps: 725 | Train Loss: 0.2552712 Vali Loss: 0.3758498 Test Loss: 0.4592678
Validation loss decreased (0.381388 --> 0.375850).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.2817777
	speed: 0.6112s/iter; left time: 5700.5131s
	iters: 200, epoch: 8 | loss: 0.2559109
	speed: 0.3095s/iter; left time: 2855.1399s
	iters: 300, epoch: 8 | loss: 0.2554541
	speed: 0.3103s/iter; left time: 2831.7657s
	iters: 400, epoch: 8 | loss: 0.2529590
	speed: 0.3100s/iter; left time: 2798.4769s
	iters: 500, epoch: 8 | loss: 0.2307894
	speed: 0.3101s/iter; left time: 2768.3927s
	iters: 600, epoch: 8 | loss: 0.2519318
	speed: 0.3106s/iter; left time: 2741.1150s
	iters: 700, epoch: 8 | loss: 0.2327261
	speed: 0.3122s/iter; left time: 2723.9142s
Epoch: 8 cost time: 225.12204718589783
Epoch: 8, Steps: 725 | Train Loss: 0.2518738 Vali Loss: 0.3730946 Test Loss: 0.4559319
Validation loss decreased (0.375850 --> 0.373095).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.2445446
	speed: 0.6139s/iter; left time: 5280.1349s
	iters: 200, epoch: 9 | loss: 0.2567253
	speed: 0.3115s/iter; left time: 2648.3295s
	iters: 300, epoch: 9 | loss: 0.2565634
	speed: 0.3113s/iter; left time: 2615.1386s
	iters: 400, epoch: 9 | loss: 0.2459984
	speed: 0.3119s/iter; left time: 2589.3149s
	iters: 500, epoch: 9 | loss: 0.2621066
	speed: 0.3118s/iter; left time: 2557.3006s
	iters: 600, epoch: 9 | loss: 0.2652855
	speed: 0.3129s/iter; left time: 2534.6229s
	iters: 700, epoch: 9 | loss: 0.2369464
	speed: 0.3121s/iter; left time: 2497.1165s
Epoch: 9 cost time: 226.22048163414001
Epoch: 9, Steps: 725 | Train Loss: 0.2500746 Vali Loss: 0.3717384 Test Loss: 0.4545271
Validation loss decreased (0.373095 --> 0.371738).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.2594674
	speed: 0.6127s/iter; left time: 4825.6575s
	iters: 200, epoch: 10 | loss: 0.2491558
	speed: 0.3113s/iter; left time: 2420.7860s
	iters: 300, epoch: 10 | loss: 0.2365631
	speed: 0.3126s/iter; left time: 2399.6408s
	iters: 400, epoch: 10 | loss: 0.2304810
	speed: 0.3091s/iter; left time: 2341.7270s
	iters: 500, epoch: 10 | loss: 0.2374504
	speed: 0.3100s/iter; left time: 2317.5830s
	iters: 600, epoch: 10 | loss: 0.2623883
	speed: 0.3123s/iter; left time: 2303.5841s
	iters: 700, epoch: 10 | loss: 0.2473905
	speed: 0.3101s/iter; left time: 2256.4435s
Epoch: 10 cost time: 225.62620544433594
Epoch: 10, Steps: 725 | Train Loss: 0.2490700 Vali Loss: 0.3710495 Test Loss: 0.4537865
Validation loss decreased (0.371738 --> 0.371050).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.2435351
	speed: 0.6138s/iter; left time: 4388.9287s
	iters: 200, epoch: 11 | loss: 0.2321379
	speed: 0.3135s/iter; left time: 2210.5216s
	iters: 300, epoch: 11 | loss: 0.2739494
	speed: 0.3117s/iter; left time: 2166.2990s
	iters: 400, epoch: 11 | loss: 0.2544979
	speed: 0.3112s/iter; left time: 2132.2850s
	iters: 500, epoch: 11 | loss: 0.2515084
	speed: 0.3125s/iter; left time: 2109.9353s
	iters: 600, epoch: 11 | loss: 0.2641012
	speed: 0.3094s/iter; left time: 2058.1469s
	iters: 700, epoch: 11 | loss: 0.2311694
	speed: 0.3110s/iter; left time: 2037.4865s
Epoch: 11 cost time: 226.03266978263855
Epoch: 11, Steps: 725 | Train Loss: 0.2485137 Vali Loss: 0.3705835 Test Loss: 0.4535262
Validation loss decreased (0.371050 --> 0.370584).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.2561893
	speed: 0.6160s/iter; left time: 3958.4661s
	iters: 200, epoch: 12 | loss: 0.2442170
	speed: 0.3100s/iter; left time: 1961.1074s
	iters: 300, epoch: 12 | loss: 0.2314228
	speed: 0.3096s/iter; left time: 1927.4961s
	iters: 400, epoch: 12 | loss: 0.2526206
	speed: 0.3123s/iter; left time: 1913.0876s
	iters: 500, epoch: 12 | loss: 0.2364484
	speed: 0.3110s/iter; left time: 1873.9920s
	iters: 600, epoch: 12 | loss: 0.2290233
	speed: 0.3099s/iter; left time: 1836.4191s
	iters: 700, epoch: 12 | loss: 0.2809822
	speed: 0.3100s/iter; left time: 1805.8584s
Epoch: 12 cost time: 225.57984256744385
Epoch: 12, Steps: 725 | Train Loss: 0.2482497 Vali Loss: 0.3706941 Test Loss: 0.4533844
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.2469079
	speed: 0.6112s/iter; left time: 3484.3748s
	iters: 200, epoch: 13 | loss: 0.2831791
	speed: 0.3111s/iter; left time: 1742.3725s
	iters: 300, epoch: 13 | loss: 0.2701493
	speed: 0.3130s/iter; left time: 1722.0195s
	iters: 400, epoch: 13 | loss: 0.2677913
	speed: 0.3119s/iter; left time: 1684.5054s
	iters: 500, epoch: 13 | loss: 0.2268512
	speed: 0.3114s/iter; left time: 1650.7184s
	iters: 600, epoch: 13 | loss: 0.2377338
	speed: 0.3109s/iter; left time: 1617.0350s
	iters: 700, epoch: 13 | loss: 0.2452930
	speed: 0.3119s/iter; left time: 1590.9324s
Epoch: 13 cost time: 225.93372893333435
Epoch: 13, Steps: 725 | Train Loss: 0.2481181 Vali Loss: 0.3706578 Test Loss: 0.4533382
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 14 | loss: 0.2554568
	speed: 0.6085s/iter; left time: 3027.7276s
	iters: 200, epoch: 14 | loss: 0.2280672
	speed: 0.3120s/iter; left time: 1521.3026s
	iters: 300, epoch: 14 | loss: 0.2490231
	speed: 0.3114s/iter; left time: 1487.2800s
	iters: 400, epoch: 14 | loss: 0.2646802
	speed: 0.3094s/iter; left time: 1446.9449s
	iters: 500, epoch: 14 | loss: 0.2704504
	speed: 0.3094s/iter; left time: 1415.9928s
	iters: 600, epoch: 14 | loss: 0.2814693
	speed: 0.3089s/iter; left time: 1382.8271s
	iters: 700, epoch: 14 | loss: 0.2380223
	speed: 0.3096s/iter; left time: 1354.7392s
Epoch: 14 cost time: 224.8980314731598
Epoch: 14, Steps: 725 | Train Loss: 0.2480039 Vali Loss: 0.3705700 Test Loss: 0.4532904
Validation loss decreased (0.370584 --> 0.370570).  Saving model ...
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 15 | loss: 0.2463700
	speed: 0.6118s/iter; left time: 2600.8993s
	iters: 200, epoch: 15 | loss: 0.2378142
	speed: 0.3089s/iter; left time: 1282.3674s
	iters: 300, epoch: 15 | loss: 0.2417184
	speed: 0.3080s/iter; left time: 1247.7165s
	iters: 400, epoch: 15 | loss: 0.2456731
	speed: 0.3104s/iter; left time: 1226.5326s
	iters: 500, epoch: 15 | loss: 0.2440718
	speed: 0.3102s/iter; left time: 1194.4391s
	iters: 600, epoch: 15 | loss: 0.2431060
	speed: 0.3106s/iter; left time: 1164.9080s
	iters: 700, epoch: 15 | loss: 0.2516161
	speed: 0.3088s/iter; left time: 1127.5121s
Epoch: 15 cost time: 224.67822289466858
Epoch: 15, Steps: 725 | Train Loss: 0.2479640 Vali Loss: 0.3705990 Test Loss: 0.4532849
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 16 | loss: 0.2230075
	speed: 0.6081s/iter; left time: 2144.0819s
	iters: 200, epoch: 16 | loss: 0.2463716
	speed: 0.3099s/iter; left time: 1061.5613s
	iters: 300, epoch: 16 | loss: 0.2355060
	speed: 0.3093s/iter; left time: 1028.7575s
	iters: 400, epoch: 16 | loss: 0.2525787
	speed: 0.3095s/iter; left time: 998.5604s
	iters: 500, epoch: 16 | loss: 0.2480040
	speed: 0.3110s/iter; left time: 972.0647s
	iters: 600, epoch: 16 | loss: 0.2434793
	speed: 0.3116s/iter; left time: 943.0497s
	iters: 700, epoch: 16 | loss: 0.2721738
	speed: 0.3118s/iter; left time: 912.4481s
Epoch: 16 cost time: 225.38914680480957
Epoch: 16, Steps: 725 | Train Loss: 0.2479491 Vali Loss: 0.3707857 Test Loss: 0.4532852
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 17 | loss: 0.2614733
	speed: 0.6091s/iter; left time: 1706.0601s
	iters: 200, epoch: 17 | loss: 0.2599930
	speed: 0.3107s/iter; left time: 839.0953s
	iters: 300, epoch: 17 | loss: 0.2595147
	speed: 0.3098s/iter; left time: 805.7691s
	iters: 400, epoch: 17 | loss: 0.2686677
	speed: 0.3093s/iter; left time: 773.5953s
	iters: 500, epoch: 17 | loss: 0.2580425
	speed: 0.3105s/iter; left time: 745.4588s
	iters: 600, epoch: 17 | loss: 0.2417108
	speed: 0.3117s/iter; left time: 717.1801s
	iters: 700, epoch: 17 | loss: 0.2481204
	speed: 0.3112s/iter; left time: 684.8765s
Epoch: 17 cost time: 225.29949641227722
Epoch: 17, Steps: 725 | Train Loss: 0.2479187 Vali Loss: 0.3707289 Test Loss: 0.4532852
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 18 | loss: 0.2562948
	speed: 0.6106s/iter; left time: 1267.6890s
	iters: 200, epoch: 18 | loss: 0.2386888
	speed: 0.3123s/iter; left time: 617.1495s
	iters: 300, epoch: 18 | loss: 0.2425063
	speed: 0.3107s/iter; left time: 582.8111s
	iters: 400, epoch: 18 | loss: 0.2562641
	speed: 0.3103s/iter; left time: 551.1646s
	iters: 500, epoch: 18 | loss: 0.2593651
	speed: 0.3113s/iter; left time: 521.7202s
	iters: 600, epoch: 18 | loss: 0.2463041
	speed: 0.3102s/iter; left time: 488.8395s
	iters: 700, epoch: 18 | loss: 0.2460120
	speed: 0.3101s/iter; left time: 457.7581s
Epoch: 18 cost time: 225.51537704467773
Epoch: 18, Steps: 725 | Train Loss: 0.2479228 Vali Loss: 0.3703464 Test Loss: 0.4532847
Validation loss decreased (0.370570 --> 0.370346).  Saving model ...
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 19 | loss: 0.2499444
	speed: 0.6156s/iter; left time: 831.6600s
	iters: 200, epoch: 19 | loss: 0.2980882
	speed: 0.3123s/iter; left time: 390.7292s
	iters: 300, epoch: 19 | loss: 0.2397897
	speed: 0.3113s/iter; left time: 358.3060s
	iters: 400, epoch: 19 | loss: 0.2443136
	speed: 0.3111s/iter; left time: 326.9931s
	iters: 500, epoch: 19 | loss: 0.2439632
	speed: 0.3105s/iter; left time: 295.2690s
	iters: 600, epoch: 19 | loss: 0.2303555
	speed: 0.3119s/iter; left time: 265.3963s
	iters: 700, epoch: 19 | loss: 0.2520218
	speed: 0.3103s/iter; left time: 233.0219s
Epoch: 19 cost time: 225.8976309299469
Epoch: 19, Steps: 725 | Train Loss: 0.2478998 Vali Loss: 0.3709326 Test Loss: 0.4532846
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 20 | loss: 0.2441845
	speed: 0.6059s/iter; left time: 379.3063s
	iters: 200, epoch: 20 | loss: 0.2585970
	speed: 0.3122s/iter; left time: 164.2347s
	iters: 300, epoch: 20 | loss: 0.2503490
	speed: 0.3116s/iter; left time: 132.7270s
	iters: 400, epoch: 20 | loss: 0.2264141
	speed: 0.3123s/iter; left time: 101.8106s
	iters: 500, epoch: 20 | loss: 0.2544461
	speed: 0.3131s/iter; left time: 70.7600s
	iters: 600, epoch: 20 | loss: 0.2593724
	speed: 0.3117s/iter; left time: 39.2701s
	iters: 700, epoch: 20 | loss: 0.2303351
	speed: 0.3097s/iter; left time: 8.0526s
Epoch: 20 cost time: 225.73734712600708
Epoch: 20, Steps: 725 | Train Loss: 0.2478833 Vali Loss: 0.3704643 Test Loss: 0.4532847
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.9073486328125e-08
>>>>>>>testing : traffic_336_336_Linear_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed25565<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3173
mse:0.4523140788078308, mae:0.3119848668575287
