Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='NLinear', model_id='ETTm2_96_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=15227, seq_len=96, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTm2_96_96_NLinear_ETTm2_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15227>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34369
data_set:  <data_provider.data_loader.Dataset_ETT_minute object at 0x000001F81FB40D68>
val 11425
data_set:  <data_provider.data_loader.Dataset_ETT_minute object at 0x000001F86D126DD8>
test 11425
data_set:  <data_provider.data_loader.Dataset_ETT_minute object at 0x000001F81FB40128>
Total number of trainable parameters: 65184
Total number of parameters: 65184
	iters: 100, epoch: 1 | loss: 0.4112716
	speed: 0.0042s/iter; left time: 90.2008s
	iters: 200, epoch: 1 | loss: 0.2216836
	speed: 0.0038s/iter; left time: 79.8550s
	iters: 300, epoch: 1 | loss: 0.4630753
	speed: 0.0034s/iter; left time: 72.8852s
	iters: 400, epoch: 1 | loss: 0.5683604
	speed: 0.0034s/iter; left time: 72.3329s
	iters: 500, epoch: 1 | loss: 0.3460629
	speed: 0.0040s/iter; left time: 83.7770s
	iters: 600, epoch: 1 | loss: 0.4105441
	speed: 0.0034s/iter; left time: 71.8388s
	iters: 700, epoch: 1 | loss: 0.2276410
	speed: 0.0040s/iter; left time: 82.5775s
	iters: 800, epoch: 1 | loss: 0.3097177
	speed: 0.0039s/iter; left time: 81.1401s
	iters: 900, epoch: 1 | loss: 0.3390002
	speed: 0.0035s/iter; left time: 71.7176s
	iters: 1000, epoch: 1 | loss: 0.2493121
	speed: 0.0036s/iter; left time: 72.7959s
Epoch: 1 cost time: 3.9836530685424805
Epoch: 1, Steps: 1074 | Train Loss: 0.2712885 Vali Loss: 0.1610721 Test Loss: 0.2197796
Validation loss decreased (inf --> 0.161072).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.5127140
	speed: 0.0176s/iter; left time: 358.0174s
	iters: 200, epoch: 2 | loss: 0.2218876
	speed: 0.0041s/iter; left time: 82.1943s
	iters: 300, epoch: 2 | loss: 0.1887800
	speed: 0.0039s/iter; left time: 78.4604s
	iters: 400, epoch: 2 | loss: 0.1953467
	speed: 0.0035s/iter; left time: 70.7688s
	iters: 500, epoch: 2 | loss: 0.2231425
	speed: 0.0028s/iter; left time: 56.7133s
	iters: 600, epoch: 2 | loss: 0.2057512
	speed: 0.0041s/iter; left time: 81.4269s
	iters: 700, epoch: 2 | loss: 0.7035574
	speed: 0.0043s/iter; left time: 84.2491s
	iters: 800, epoch: 2 | loss: 0.2677048
	speed: 0.0034s/iter; left time: 65.7844s
	iters: 900, epoch: 2 | loss: 0.1061901
	speed: 0.0039s/iter; left time: 76.1374s
	iters: 1000, epoch: 2 | loss: 0.2973257
	speed: 0.0038s/iter; left time: 74.4727s
Epoch: 2 cost time: 4.020257234573364
Epoch: 2, Steps: 1074 | Train Loss: 0.2677632 Vali Loss: 0.1873902 Test Loss: 0.2520852
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.2036448
	speed: 0.0168s/iter; left time: 322.9124s
	iters: 200, epoch: 3 | loss: 0.1431675
	speed: 0.0033s/iter; left time: 62.7459s
	iters: 300, epoch: 3 | loss: 0.2386742
	speed: 0.0038s/iter; left time: 71.8631s
	iters: 400, epoch: 3 | loss: 0.4328200
	speed: 0.0030s/iter; left time: 56.9193s
	iters: 500, epoch: 3 | loss: 0.2229221
	speed: 0.0035s/iter; left time: 65.5671s
	iters: 600, epoch: 3 | loss: 0.3838320
	speed: 0.0038s/iter; left time: 71.1389s
	iters: 700, epoch: 3 | loss: 0.1485057
	speed: 0.0038s/iter; left time: 69.9202s
	iters: 800, epoch: 3 | loss: 0.2854740
	speed: 0.0030s/iter; left time: 55.0320s
	iters: 900, epoch: 3 | loss: 0.1786229
	speed: 0.0030s/iter; left time: 54.6818s
	iters: 1000, epoch: 3 | loss: 0.2139737
	speed: 0.0037s/iter; left time: 67.8901s
Epoch: 3 cost time: 3.578212261199951
Epoch: 3, Steps: 1074 | Train Loss: 0.2466677 Vali Loss: 0.1352567 Test Loss: 0.1937748
Validation loss decreased (0.161072 --> 0.135257).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.2350365
	speed: 0.0167s/iter; left time: 304.0670s
	iters: 200, epoch: 4 | loss: 0.1434679
	speed: 0.0030s/iter; left time: 54.0449s
	iters: 300, epoch: 4 | loss: 0.4835920
	speed: 0.0044s/iter; left time: 78.5562s
	iters: 400, epoch: 4 | loss: 0.2801730
	speed: 0.0041s/iter; left time: 72.5622s
	iters: 500, epoch: 4 | loss: 0.2493046
	speed: 0.0030s/iter; left time: 53.1641s
	iters: 600, epoch: 4 | loss: 0.2251684
	speed: 0.0030s/iter; left time: 53.1377s
	iters: 700, epoch: 4 | loss: 0.1967502
	speed: 0.0038s/iter; left time: 66.8136s
	iters: 800, epoch: 4 | loss: 0.1630442
	speed: 0.0030s/iter; left time: 52.4432s
	iters: 900, epoch: 4 | loss: 0.1493389
	speed: 0.0045s/iter; left time: 78.1223s
	iters: 1000, epoch: 4 | loss: 0.2164831
	speed: 0.0030s/iter; left time: 52.6241s
Epoch: 4 cost time: 3.8363418579101562
Epoch: 4, Steps: 1074 | Train Loss: 0.2382418 Vali Loss: 0.1281408 Test Loss: 0.1823153
Validation loss decreased (0.135257 --> 0.128141).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.1469334
	speed: 0.0185s/iter; left time: 316.0556s
	iters: 200, epoch: 5 | loss: 0.2156141
	speed: 0.0036s/iter; left time: 61.8189s
	iters: 300, epoch: 5 | loss: 0.3420909
	speed: 0.0030s/iter; left time: 50.7217s
	iters: 400, epoch: 5 | loss: 0.1661663
	speed: 0.0046s/iter; left time: 77.1165s
	iters: 500, epoch: 5 | loss: 0.1269847
	speed: 0.0035s/iter; left time: 58.1171s
	iters: 600, epoch: 5 | loss: 0.1799132
	speed: 0.0032s/iter; left time: 52.7984s
	iters: 700, epoch: 5 | loss: 0.3625439
	speed: 0.0040s/iter; left time: 66.1900s
	iters: 800, epoch: 5 | loss: 0.1524130
	speed: 0.0030s/iter; left time: 48.6405s
	iters: 900, epoch: 5 | loss: 0.1295352
	speed: 0.0034s/iter; left time: 56.0231s
	iters: 1000, epoch: 5 | loss: 0.2210156
	speed: 0.0047s/iter; left time: 75.8643s
Epoch: 5 cost time: 3.884415864944458
Epoch: 5, Steps: 1074 | Train Loss: 0.2336503 Vali Loss: 0.1258319 Test Loss: 0.1784851
Validation loss decreased (0.128141 --> 0.125832).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.1501398
	speed: 0.0182s/iter; left time: 290.8732s
	iters: 200, epoch: 6 | loss: 0.4480846
	speed: 0.0041s/iter; left time: 65.5593s
	iters: 300, epoch: 6 | loss: 0.1578195
	speed: 0.0032s/iter; left time: 50.1203s
	iters: 400, epoch: 6 | loss: 0.1233395
	speed: 0.0042s/iter; left time: 66.3897s
	iters: 500, epoch: 6 | loss: 0.1572629
	speed: 0.0030s/iter; left time: 46.3656s
	iters: 600, epoch: 6 | loss: 0.3402980
	speed: 0.0039s/iter; left time: 60.7589s
	iters: 700, epoch: 6 | loss: 0.4802413
	speed: 0.0041s/iter; left time: 62.4600s
	iters: 800, epoch: 6 | loss: 0.5525209
	speed: 0.0035s/iter; left time: 54.2346s
	iters: 900, epoch: 6 | loss: 0.1707128
	speed: 0.0035s/iter; left time: 53.0096s
	iters: 1000, epoch: 6 | loss: 0.2621770
	speed: 0.0034s/iter; left time: 51.9707s
Epoch: 6 cost time: 3.9718589782714844
Epoch: 6, Steps: 1074 | Train Loss: 0.2315166 Vali Loss: 0.1225109 Test Loss: 0.1755859
Validation loss decreased (0.125832 --> 0.122511).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.4694845
	speed: 0.0169s/iter; left time: 252.0736s
	iters: 200, epoch: 7 | loss: 0.3298344
	speed: 0.0039s/iter; left time: 57.9769s
	iters: 300, epoch: 7 | loss: 0.3184409
	speed: 0.0036s/iter; left time: 52.9476s
	iters: 400, epoch: 7 | loss: 0.1777522
	speed: 0.0045s/iter; left time: 66.3513s
	iters: 500, epoch: 7 | loss: 0.2026862
	speed: 0.0030s/iter; left time: 43.1628s
	iters: 600, epoch: 7 | loss: 0.1417661
	speed: 0.0044s/iter; left time: 63.1482s
	iters: 700, epoch: 7 | loss: 0.1241666
	speed: 0.0031s/iter; left time: 45.1223s
	iters: 800, epoch: 7 | loss: 0.1430699
	speed: 0.0038s/iter; left time: 54.0824s
	iters: 900, epoch: 7 | loss: 0.3993237
	speed: 0.0041s/iter; left time: 58.6378s
	iters: 1000, epoch: 7 | loss: 0.1372746
	speed: 0.0044s/iter; left time: 61.4147s
Epoch: 7 cost time: 4.094433307647705
Epoch: 7, Steps: 1074 | Train Loss: 0.2306543 Vali Loss: 0.1253500 Test Loss: 0.1774134
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.1950339
	speed: 0.0178s/iter; left time: 246.9371s
	iters: 200, epoch: 8 | loss: 0.1594160
	speed: 0.0031s/iter; left time: 43.0033s
	iters: 300, epoch: 8 | loss: 0.1714193
	speed: 0.0034s/iter; left time: 46.9642s
	iters: 400, epoch: 8 | loss: 0.3213406
	speed: 0.0031s/iter; left time: 42.3771s
	iters: 500, epoch: 8 | loss: 0.1842593
	speed: 0.0033s/iter; left time: 44.7495s
	iters: 600, epoch: 8 | loss: 0.2180303
	speed: 0.0033s/iter; left time: 44.4482s
	iters: 700, epoch: 8 | loss: 0.1307237
	speed: 0.0030s/iter; left time: 39.8911s
	iters: 800, epoch: 8 | loss: 0.1859835
	speed: 0.0038s/iter; left time: 49.9232s
	iters: 900, epoch: 8 | loss: 0.1636817
	speed: 0.0038s/iter; left time: 49.5630s
	iters: 1000, epoch: 8 | loss: 0.2580760
	speed: 0.0039s/iter; left time: 50.2935s
Epoch: 8 cost time: 3.7103896141052246
Epoch: 8, Steps: 1074 | Train Loss: 0.2300291 Vali Loss: 0.1242164 Test Loss: 0.1768203
EarlyStopping counter: 2 out of 5
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.1547406
	speed: 0.0178s/iter; left time: 227.3969s
	iters: 200, epoch: 9 | loss: 0.1861286
	speed: 0.0035s/iter; left time: 44.6223s
	iters: 300, epoch: 9 | loss: 0.1886524
	speed: 0.0035s/iter; left time: 43.4972s
	iters: 400, epoch: 9 | loss: 0.1011250
	speed: 0.0033s/iter; left time: 41.7241s
	iters: 500, epoch: 9 | loss: 0.4835841
	speed: 0.0039s/iter; left time: 48.4133s
	iters: 600, epoch: 9 | loss: 0.1656779
	speed: 0.0036s/iter; left time: 44.1459s
	iters: 700, epoch: 9 | loss: 0.2454921
	speed: 0.0034s/iter; left time: 41.9344s
	iters: 800, epoch: 9 | loss: 0.1924889
	speed: 0.0041s/iter; left time: 49.0671s
	iters: 900, epoch: 9 | loss: 0.1925833
	speed: 0.0034s/iter; left time: 41.2538s
	iters: 1000, epoch: 9 | loss: 0.1138399
	speed: 0.0041s/iter; left time: 49.2027s
Epoch: 9 cost time: 3.9372427463531494
Epoch: 9, Steps: 1074 | Train Loss: 0.2296564 Vali Loss: 0.1260134 Test Loss: 0.1775468
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.2162126
	speed: 0.0185s/iter; left time: 216.9351s
	iters: 200, epoch: 10 | loss: 0.2363891
	speed: 0.0030s/iter; left time: 34.4684s
	iters: 300, epoch: 10 | loss: 0.3409910
	speed: 0.0044s/iter; left time: 50.3750s
	iters: 400, epoch: 10 | loss: 0.2371670
	speed: 0.0042s/iter; left time: 48.1712s
	iters: 500, epoch: 10 | loss: 0.3263833
	speed: 0.0050s/iter; left time: 56.5658s
	iters: 600, epoch: 10 | loss: 0.1480608
	speed: 0.0039s/iter; left time: 44.0280s
	iters: 700, epoch: 10 | loss: 0.1661552
	speed: 0.0044s/iter; left time: 48.4074s
	iters: 800, epoch: 10 | loss: 0.1722816
	speed: 0.0043s/iter; left time: 47.8932s
	iters: 900, epoch: 10 | loss: 0.1521405
	speed: 0.0035s/iter; left time: 37.8227s
	iters: 1000, epoch: 10 | loss: 0.1430235
	speed: 0.0042s/iter; left time: 45.7489s
Epoch: 10 cost time: 4.3620922565460205
Epoch: 10, Steps: 1074 | Train Loss: 0.2295410 Vali Loss: 0.1249075 Test Loss: 0.1767025
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.1525674
	speed: 0.0184s/iter; left time: 196.0617s
	iters: 200, epoch: 11 | loss: 0.2729650
	speed: 0.0034s/iter; left time: 36.2452s
	iters: 300, epoch: 11 | loss: 0.2011687
	speed: 0.0034s/iter; left time: 35.8743s
	iters: 400, epoch: 11 | loss: 0.1501804
	speed: 0.0028s/iter; left time: 29.1315s
	iters: 500, epoch: 11 | loss: 0.1829414
	speed: 0.0033s/iter; left time: 33.5507s
	iters: 600, epoch: 11 | loss: 0.2694026
	speed: 0.0026s/iter; left time: 26.1882s
	iters: 700, epoch: 11 | loss: 0.1549274
	speed: 0.0032s/iter; left time: 31.7825s
	iters: 800, epoch: 11 | loss: 0.2820892
	speed: 0.0030s/iter; left time: 29.8316s
	iters: 900, epoch: 11 | loss: 0.1312382
	speed: 0.0025s/iter; left time: 24.6143s
	iters: 1000, epoch: 11 | loss: 0.3298376
	speed: 0.0034s/iter; left time: 33.4770s
Epoch: 11 cost time: 3.421808958053589
Epoch: 11, Steps: 1074 | Train Loss: 0.2294149 Vali Loss: 0.1251144 Test Loss: 0.1768775
EarlyStopping counter: 5 out of 5
Early stopping
Total training time: 55.1873 seconds
>>>>>>>testing : ETTm2_96_96_NLinear_ETTm2_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15227<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
data_set:  <data_provider.data_loader.Dataset_ETT_minute object at 0x000001F862571080>
mse:0.17584261298179626, mae:0.2554364502429962
