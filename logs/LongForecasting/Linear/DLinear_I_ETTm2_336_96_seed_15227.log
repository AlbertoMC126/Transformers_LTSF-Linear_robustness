Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='DLinear', model_id='ETTm2_336_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=15227, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTm2_336_96_DLinear_ETTm2_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15227>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34129
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.3879910
	speed: 0.0079s/iter; left time: 167.4698s
	iters: 200, epoch: 1 | loss: 0.4869763
	speed: 0.0071s/iter; left time: 150.4397s
	iters: 300, epoch: 1 | loss: 0.3970837
	speed: 0.0083s/iter; left time: 174.0965s
	iters: 400, epoch: 1 | loss: 0.9074771
	speed: 0.0072s/iter; left time: 151.0611s
	iters: 500, epoch: 1 | loss: 0.5640237
	speed: 0.0084s/iter; left time: 174.9741s
	iters: 600, epoch: 1 | loss: 0.6415866
	speed: 0.0088s/iter; left time: 183.0063s
	iters: 700, epoch: 1 | loss: 0.4235577
	speed: 0.0092s/iter; left time: 188.9469s
	iters: 800, epoch: 1 | loss: 0.3433623
	speed: 0.0082s/iter; left time: 168.1080s
	iters: 900, epoch: 1 | loss: 0.4608305
	speed: 0.0079s/iter; left time: 161.8161s
	iters: 1000, epoch: 1 | loss: 0.3221199
	speed: 0.0076s/iter; left time: 153.4324s
Epoch: 1 cost time: 8.641396522521973
Epoch: 1, Steps: 1066 | Train Loss: 0.4689999 Vali Loss: 0.3282832 Test Loss: 0.5707140
Validation loss decreased (inf --> 0.328283).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.3435857
	speed: 0.0405s/iter; left time: 816.9216s
	iters: 200, epoch: 2 | loss: 0.2238947
	speed: 0.0088s/iter; left time: 176.8850s
	iters: 300, epoch: 2 | loss: 0.6558837
	speed: 0.0095s/iter; left time: 190.2237s
	iters: 400, epoch: 2 | loss: 0.1893698
	speed: 0.0097s/iter; left time: 192.6821s
	iters: 500, epoch: 2 | loss: 0.9587470
	speed: 0.0098s/iter; left time: 193.4420s
	iters: 600, epoch: 2 | loss: 0.5818669
	speed: 0.0097s/iter; left time: 189.7306s
	iters: 700, epoch: 2 | loss: 0.3223047
	speed: 0.0098s/iter; left time: 191.5160s
	iters: 800, epoch: 2 | loss: 0.3147027
	speed: 0.0095s/iter; left time: 184.8576s
	iters: 900, epoch: 2 | loss: 0.3472584
	speed: 0.0080s/iter; left time: 154.2123s
	iters: 1000, epoch: 2 | loss: 0.5748879
	speed: 0.0078s/iter; left time: 150.4160s
Epoch: 2 cost time: 9.707955360412598
Epoch: 2, Steps: 1066 | Train Loss: 0.4308837 Vali Loss: 0.4396834 Test Loss: 0.9464700
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.2031287
	speed: 0.0355s/iter; left time: 677.7979s
	iters: 200, epoch: 3 | loss: 0.4271793
	speed: 0.0083s/iter; left time: 158.2016s
	iters: 300, epoch: 3 | loss: 0.2684750
	speed: 0.0089s/iter; left time: 168.9214s
	iters: 400, epoch: 3 | loss: 0.2310850
	speed: 0.0090s/iter; left time: 168.5871s
	iters: 500, epoch: 3 | loss: 0.6211603
	speed: 0.0075s/iter; left time: 139.4761s
	iters: 600, epoch: 3 | loss: 0.2247559
	speed: 0.0085s/iter; left time: 158.6247s
	iters: 700, epoch: 3 | loss: 0.4295872
	speed: 0.0090s/iter; left time: 165.9986s
	iters: 800, epoch: 3 | loss: 0.4055697
	speed: 0.0097s/iter; left time: 178.7856s
	iters: 900, epoch: 3 | loss: 0.3352109
	speed: 0.0085s/iter; left time: 155.4979s
	iters: 1000, epoch: 3 | loss: 0.1429355
	speed: 0.0079s/iter; left time: 143.7433s
Epoch: 3 cost time: 9.02601933479309
Epoch: 3, Steps: 1066 | Train Loss: 0.2784203 Vali Loss: 0.1768232 Test Loss: 0.2816576
Validation loss decreased (0.328283 --> 0.176823).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.2164432
	speed: 0.0385s/iter; left time: 693.1541s
	iters: 200, epoch: 4 | loss: 0.1535354
	speed: 0.0085s/iter; left time: 151.8757s
	iters: 300, epoch: 4 | loss: 0.1901036
	speed: 0.0080s/iter; left time: 142.0996s
	iters: 400, epoch: 4 | loss: 0.1548638
	speed: 0.0077s/iter; left time: 135.7584s
	iters: 500, epoch: 4 | loss: 0.2242919
	speed: 0.0090s/iter; left time: 158.8239s
	iters: 600, epoch: 4 | loss: 0.2249774
	speed: 0.0088s/iter; left time: 154.3834s
	iters: 700, epoch: 4 | loss: 0.4414324
	speed: 0.0076s/iter; left time: 132.3619s
	iters: 800, epoch: 4 | loss: 0.4753968
	speed: 0.0076s/iter; left time: 131.5236s
	iters: 900, epoch: 4 | loss: 0.2132622
	speed: 0.0074s/iter; left time: 127.7946s
	iters: 1000, epoch: 4 | loss: 0.1781713
	speed: 0.0083s/iter; left time: 142.6871s
Epoch: 4 cost time: 8.661743879318237
Epoch: 4, Steps: 1066 | Train Loss: 0.2386536 Vali Loss: 0.2374107 Test Loss: 0.5457627
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.1707190
	speed: 0.0385s/iter; left time: 653.3025s
	iters: 200, epoch: 5 | loss: 0.1391032
	speed: 0.0078s/iter; left time: 131.1878s
	iters: 300, epoch: 5 | loss: 0.1660558
	speed: 0.0086s/iter; left time: 143.3280s
	iters: 400, epoch: 5 | loss: 0.4341670
	speed: 0.0090s/iter; left time: 149.7694s
	iters: 500, epoch: 5 | loss: 0.1285012
	speed: 0.0090s/iter; left time: 148.2317s
	iters: 600, epoch: 5 | loss: 0.2318735
	speed: 0.0088s/iter; left time: 145.4865s
	iters: 700, epoch: 5 | loss: 0.3230855
	speed: 0.0085s/iter; left time: 138.7630s
	iters: 800, epoch: 5 | loss: 0.4248165
	speed: 0.0080s/iter; left time: 130.2671s
	iters: 900, epoch: 5 | loss: 0.1945464
	speed: 0.0087s/iter; left time: 140.9283s
	iters: 1000, epoch: 5 | loss: 0.1760688
	speed: 0.0092s/iter; left time: 147.6009s
Epoch: 5 cost time: 9.115385055541992
Epoch: 5, Steps: 1066 | Train Loss: 0.2198506 Vali Loss: 0.1562808 Test Loss: 0.2650630
Validation loss decreased (0.176823 --> 0.156281).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.1982848
	speed: 0.0370s/iter; left time: 587.8252s
	iters: 200, epoch: 6 | loss: 0.1673538
	speed: 0.0082s/iter; left time: 130.2472s
	iters: 300, epoch: 6 | loss: 0.3204013
	speed: 0.0086s/iter; left time: 134.6615s
	iters: 400, epoch: 6 | loss: 0.4815663
	speed: 0.0096s/iter; left time: 149.8776s
	iters: 500, epoch: 6 | loss: 0.1891712
	speed: 0.0078s/iter; left time: 120.5556s
	iters: 600, epoch: 6 | loss: 0.1857337
	speed: 0.0065s/iter; left time: 99.3277s
	iters: 700, epoch: 6 | loss: 0.1855330
	speed: 0.0068s/iter; left time: 103.2209s
	iters: 800, epoch: 6 | loss: 0.1360432
	speed: 0.0083s/iter; left time: 126.5908s
	iters: 900, epoch: 6 | loss: 0.1236411
	speed: 0.0077s/iter; left time: 115.9412s
	iters: 1000, epoch: 6 | loss: 0.2266187
	speed: 0.0089s/iter; left time: 133.4813s
Epoch: 6 cost time: 8.55728816986084
Epoch: 6, Steps: 1066 | Train Loss: 0.2113208 Vali Loss: 0.1255966 Test Loss: 0.1872062
Validation loss decreased (0.156281 --> 0.125597).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.2648557
	speed: 0.0351s/iter; left time: 519.8834s
	iters: 200, epoch: 7 | loss: 0.2058875
	speed: 0.0073s/iter; left time: 106.9456s
	iters: 300, epoch: 7 | loss: 0.0941709
	speed: 0.0064s/iter; left time: 93.4979s
	iters: 400, epoch: 7 | loss: 0.2135745
	speed: 0.0070s/iter; left time: 101.8263s
	iters: 500, epoch: 7 | loss: 0.1788211
	speed: 0.0073s/iter; left time: 104.8983s
	iters: 600, epoch: 7 | loss: 0.3482521
	speed: 0.0067s/iter; left time: 96.4173s
	iters: 700, epoch: 7 | loss: 0.1761472
	speed: 0.0074s/iter; left time: 105.8341s
	iters: 800, epoch: 7 | loss: 0.3215824
	speed: 0.0084s/iter; left time: 118.4013s
	iters: 900, epoch: 7 | loss: 0.1514368
	speed: 0.0078s/iter; left time: 109.1662s
	iters: 1000, epoch: 7 | loss: 0.1999209
	speed: 0.0079s/iter; left time: 110.4502s
Epoch: 7 cost time: 7.87496280670166
Epoch: 7, Steps: 1066 | Train Loss: 0.2047366 Vali Loss: 0.1376028 Test Loss: 0.2291171
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.2876216
	speed: 0.0343s/iter; left time: 471.6394s
	iters: 200, epoch: 8 | loss: 0.1661583
	speed: 0.0087s/iter; left time: 119.2639s
	iters: 300, epoch: 8 | loss: 0.2407798
	speed: 0.0083s/iter; left time: 112.3038s
	iters: 400, epoch: 8 | loss: 0.3782740
	speed: 0.0091s/iter; left time: 122.5033s
	iters: 500, epoch: 8 | loss: 0.2360118
	speed: 0.0089s/iter; left time: 118.5410s
	iters: 600, epoch: 8 | loss: 0.3578283
	speed: 0.0074s/iter; left time: 98.6556s
	iters: 700, epoch: 8 | loss: 0.1451824
	speed: 0.0073s/iter; left time: 95.6659s
	iters: 800, epoch: 8 | loss: 0.1385497
	speed: 0.0076s/iter; left time: 98.7375s
	iters: 900, epoch: 8 | loss: 0.2552888
	speed: 0.0077s/iter; left time: 99.2859s
	iters: 1000, epoch: 8 | loss: 0.2797788
	speed: 0.0080s/iter; left time: 103.1756s
Epoch: 8 cost time: 8.684845447540283
Epoch: 8, Steps: 1066 | Train Loss: 0.2021893 Vali Loss: 0.1597196 Test Loss: 0.2958530
EarlyStopping counter: 2 out of 5
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.1683022
	speed: 0.0354s/iter; left time: 448.8976s
	iters: 200, epoch: 9 | loss: 0.1497852
	speed: 0.0082s/iter; left time: 102.9037s
	iters: 300, epoch: 9 | loss: 0.1323245
	speed: 0.0084s/iter; left time: 105.0985s
	iters: 400, epoch: 9 | loss: 0.1177270
	speed: 0.0075s/iter; left time: 93.3451s
	iters: 500, epoch: 9 | loss: 0.1764380
	speed: 0.0075s/iter; left time: 92.0813s
	iters: 600, epoch: 9 | loss: 0.2081337
	speed: 0.0090s/iter; left time: 109.2851s
	iters: 700, epoch: 9 | loss: 0.1147057
	speed: 0.0082s/iter; left time: 98.9303s
	iters: 800, epoch: 9 | loss: 0.2152018
	speed: 0.0075s/iter; left time: 89.4990s
	iters: 900, epoch: 9 | loss: 0.1333555
	speed: 0.0079s/iter; left time: 93.7386s
	iters: 1000, epoch: 9 | loss: 0.2440735
	speed: 0.0076s/iter; left time: 89.2792s
Epoch: 9 cost time: 8.485832214355469
Epoch: 9, Steps: 1066 | Train Loss: 0.2004013 Vali Loss: 0.1260833 Test Loss: 0.1936650
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.0926575
	speed: 0.0383s/iter; left time: 445.7508s
	iters: 200, epoch: 10 | loss: 0.3397711
	speed: 0.0077s/iter; left time: 88.6641s
	iters: 300, epoch: 10 | loss: 0.3429610
	speed: 0.0070s/iter; left time: 80.1434s
	iters: 400, epoch: 10 | loss: 0.1403984
	speed: 0.0084s/iter; left time: 94.5805s
	iters: 500, epoch: 10 | loss: 0.3653123
	speed: 0.0086s/iter; left time: 97.0050s
	iters: 600, epoch: 10 | loss: 0.3135307
	speed: 0.0081s/iter; left time: 89.8021s
	iters: 700, epoch: 10 | loss: 0.1382253
	speed: 0.0084s/iter; left time: 92.4279s
	iters: 800, epoch: 10 | loss: 0.2278386
	speed: 0.0084s/iter; left time: 91.7049s
	iters: 900, epoch: 10 | loss: 0.3559452
	speed: 0.0089s/iter; left time: 96.3965s
	iters: 1000, epoch: 10 | loss: 0.1203055
	speed: 0.0078s/iter; left time: 83.6739s
Epoch: 10 cost time: 8.689790487289429
Epoch: 10, Steps: 1066 | Train Loss: 0.1994636 Vali Loss: 0.1315136 Test Loss: 0.2104493
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.1326910
	speed: 0.0378s/iter; left time: 398.8649s
	iters: 200, epoch: 11 | loss: 0.4363838
	speed: 0.0079s/iter; left time: 82.3550s
	iters: 300, epoch: 11 | loss: 0.1648250
	speed: 0.0082s/iter; left time: 85.2835s
	iters: 400, epoch: 11 | loss: 0.1411259
	speed: 0.0088s/iter; left time: 89.9940s
	iters: 500, epoch: 11 | loss: 0.2061794
	speed: 0.0098s/iter; left time: 99.2951s
	iters: 600, epoch: 11 | loss: 0.1881935
	speed: 0.0085s/iter; left time: 85.4549s
	iters: 700, epoch: 11 | loss: 0.1472169
	speed: 0.0078s/iter; left time: 77.5961s
	iters: 800, epoch: 11 | loss: 0.2026239
	speed: 0.0081s/iter; left time: 79.8013s
	iters: 900, epoch: 11 | loss: 0.2089511
	speed: 0.0081s/iter; left time: 78.6068s
	iters: 1000, epoch: 11 | loss: 0.1336636
	speed: 0.0079s/iter; left time: 76.4277s
Epoch: 11 cost time: 8.850829124450684
Epoch: 11, Steps: 1066 | Train Loss: 0.1990418 Vali Loss: 0.1341117 Test Loss: 0.2178683
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTm2_336_96_DLinear_ETTm2_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15227<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.1875484436750412, mae:0.2832246422767639
