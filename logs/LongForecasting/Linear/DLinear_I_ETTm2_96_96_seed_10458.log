Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='DLinear', model_id='ETTm2_96_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=10458, seq_len=96, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTm2_96_96_DLinear_ETTm2_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed10458>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34369
data_set:  <data_provider.data_loader.Dataset_ETT_minute object at 0x00000221B6A70550>
val 11425
data_set:  <data_provider.data_loader.Dataset_ETT_minute object at 0x0000022184086DD8>
test 11425
data_set:  <data_provider.data_loader.Dataset_ETT_minute object at 0x00000221B6A70208>
Total number of trainable parameters: 130368
Total number of parameters: 130368
	iters: 100, epoch: 1 | loss: 0.5641789
	speed: 0.0049s/iter; left time: 105.3746s
	iters: 200, epoch: 1 | loss: 0.4601679
	speed: 0.0057s/iter; left time: 121.1628s
	iters: 300, epoch: 1 | loss: 0.1432998
	speed: 0.0049s/iter; left time: 104.3080s
	iters: 400, epoch: 1 | loss: 0.2901638
	speed: 0.0055s/iter; left time: 116.0834s
	iters: 500, epoch: 1 | loss: 0.2574885
	speed: 0.0048s/iter; left time: 100.7727s
	iters: 600, epoch: 1 | loss: 0.1845659
	speed: 0.0053s/iter; left time: 111.3205s
	iters: 700, epoch: 1 | loss: 0.2433959
	speed: 0.0040s/iter; left time: 83.5852s
	iters: 800, epoch: 1 | loss: 0.3587263
	speed: 0.0049s/iter; left time: 101.9910s
	iters: 900, epoch: 1 | loss: 0.3286707
	speed: 0.0052s/iter; left time: 106.8695s
	iters: 1000, epoch: 1 | loss: 0.1280382
	speed: 0.0059s/iter; left time: 121.5309s
Epoch: 1 cost time: 5.530622243881226
Epoch: 1, Steps: 1074 | Train Loss: 0.2798838 Vali Loss: 0.3394988 Test Loss: 0.7910642
Validation loss decreased (inf --> 0.339499).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.3175982
	speed: 0.0279s/iter; left time: 566.6000s
	iters: 200, epoch: 2 | loss: 0.3341143
	speed: 0.0057s/iter; left time: 115.1752s
	iters: 300, epoch: 2 | loss: 0.1862473
	speed: 0.0058s/iter; left time: 116.6681s
	iters: 400, epoch: 2 | loss: 0.1684038
	speed: 0.0051s/iter; left time: 101.3611s
	iters: 500, epoch: 2 | loss: 0.1296472
	speed: 0.0059s/iter; left time: 116.9166s
	iters: 600, epoch: 2 | loss: 0.2036216
	speed: 0.0056s/iter; left time: 110.7515s
	iters: 700, epoch: 2 | loss: 0.2139809
	speed: 0.0057s/iter; left time: 113.0302s
	iters: 800, epoch: 2 | loss: 0.3130863
	speed: 0.0051s/iter; left time: 100.2231s
	iters: 900, epoch: 2 | loss: 0.2568810
	speed: 0.0046s/iter; left time: 90.3946s
	iters: 1000, epoch: 2 | loss: 0.4197597
	speed: 0.0052s/iter; left time: 100.3197s
Epoch: 2 cost time: 5.762208938598633
Epoch: 2, Steps: 1074 | Train Loss: 0.2748169 Vali Loss: 0.2625266 Test Loss: 0.4753706
Validation loss decreased (0.339499 --> 0.262527).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.2399369
	speed: 0.0268s/iter; left time: 516.0046s
	iters: 200, epoch: 3 | loss: 0.6182665
	speed: 0.0044s/iter; left time: 84.3254s
	iters: 300, epoch: 3 | loss: 0.1289321
	speed: 0.0067s/iter; left time: 127.6296s
	iters: 400, epoch: 3 | loss: 0.2727832
	speed: 0.0049s/iter; left time: 92.2117s
	iters: 500, epoch: 3 | loss: 0.2426089
	speed: 0.0048s/iter; left time: 90.2643s
	iters: 600, epoch: 3 | loss: 0.1642544
	speed: 0.0066s/iter; left time: 124.0943s
	iters: 700, epoch: 3 | loss: 0.2658088
	speed: 0.0062s/iter; left time: 115.7871s
	iters: 800, epoch: 3 | loss: 0.2341053
	speed: 0.0059s/iter; left time: 109.0090s
	iters: 900, epoch: 3 | loss: 0.2391828
	speed: 0.0058s/iter; left time: 106.9464s
	iters: 1000, epoch: 3 | loss: 0.1445138
	speed: 0.0050s/iter; left time: 91.5817s
Epoch: 3 cost time: 5.946288108825684
Epoch: 3, Steps: 1074 | Train Loss: 0.2415136 Vali Loss: 0.1848919 Test Loss: 0.3356068
Validation loss decreased (0.262527 --> 0.184892).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.1851313
	speed: 0.0256s/iter; left time: 464.8783s
	iters: 200, epoch: 4 | loss: 0.1639155
	speed: 0.0054s/iter; left time: 96.8573s
	iters: 300, epoch: 4 | loss: 0.1612730
	speed: 0.0052s/iter; left time: 92.9829s
	iters: 400, epoch: 4 | loss: 0.1417167
	speed: 0.0053s/iter; left time: 94.1022s
	iters: 500, epoch: 4 | loss: 0.4954502
	speed: 0.0054s/iter; left time: 95.9425s
	iters: 600, epoch: 4 | loss: 0.2473691
	speed: 0.0053s/iter; left time: 93.8836s
	iters: 700, epoch: 4 | loss: 0.2874640
	speed: 0.0050s/iter; left time: 87.2407s
	iters: 800, epoch: 4 | loss: 0.4677523
	speed: 0.0051s/iter; left time: 88.4628s
	iters: 900, epoch: 4 | loss: 0.2654550
	speed: 0.0060s/iter; left time: 103.9707s
	iters: 1000, epoch: 4 | loss: 0.3555709
	speed: 0.0054s/iter; left time: 92.3860s
Epoch: 4 cost time: 5.743245363235474
Epoch: 4, Steps: 1074 | Train Loss: 0.2307167 Vali Loss: 0.1596556 Test Loss: 0.2652728
Validation loss decreased (0.184892 --> 0.159656).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.2316791
	speed: 0.0252s/iter; left time: 431.2762s
	iters: 200, epoch: 5 | loss: 0.1777969
	speed: 0.0057s/iter; left time: 96.7982s
	iters: 300, epoch: 5 | loss: 0.1763083
	speed: 0.0050s/iter; left time: 85.0537s
	iters: 400, epoch: 5 | loss: 0.2230505
	speed: 0.0049s/iter; left time: 81.4717s
	iters: 500, epoch: 5 | loss: 0.1431328
	speed: 0.0056s/iter; left time: 93.3145s
	iters: 600, epoch: 5 | loss: 0.3427537
	speed: 0.0053s/iter; left time: 87.5800s
	iters: 700, epoch: 5 | loss: 0.1763961
	speed: 0.0059s/iter; left time: 97.3024s
	iters: 800, epoch: 5 | loss: 0.1845954
	speed: 0.0046s/iter; left time: 75.0274s
	iters: 900, epoch: 5 | loss: 0.1080822
	speed: 0.0054s/iter; left time: 88.6574s
	iters: 1000, epoch: 5 | loss: 0.1959932
	speed: 0.0056s/iter; left time: 90.2838s
Epoch: 5 cost time: 5.6821448802948
Epoch: 5, Steps: 1074 | Train Loss: 0.2233131 Vali Loss: 0.1268301 Test Loss: 0.1822698
Validation loss decreased (0.159656 --> 0.126830).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.1636015
	speed: 0.0270s/iter; left time: 432.5708s
	iters: 200, epoch: 6 | loss: 0.1598751
	speed: 0.0071s/iter; left time: 113.3551s
	iters: 300, epoch: 6 | loss: 0.5385833
	speed: 0.0049s/iter; left time: 76.6954s
	iters: 400, epoch: 6 | loss: 0.2627074
	speed: 0.0047s/iter; left time: 74.2413s
	iters: 500, epoch: 6 | loss: 0.1145960
	speed: 0.0043s/iter; left time: 67.1916s
	iters: 600, epoch: 6 | loss: 0.1204374
	speed: 0.0056s/iter; left time: 87.3314s
	iters: 700, epoch: 6 | loss: 0.2817125
	speed: 0.0057s/iter; left time: 87.2444s
	iters: 800, epoch: 6 | loss: 0.3186605
	speed: 0.0051s/iter; left time: 78.1263s
	iters: 900, epoch: 6 | loss: 0.1214817
	speed: 0.0057s/iter; left time: 86.8535s
	iters: 1000, epoch: 6 | loss: 0.2763480
	speed: 0.0058s/iter; left time: 87.7961s
Epoch: 6 cost time: 5.9554548263549805
Epoch: 6, Steps: 1074 | Train Loss: 0.2204070 Vali Loss: 0.1725238 Test Loss: 0.3132241
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.1436573
	speed: 0.0234s/iter; left time: 349.1703s
	iters: 200, epoch: 7 | loss: 0.3526677
	speed: 0.0061s/iter; left time: 90.6790s
	iters: 300, epoch: 7 | loss: 0.1798753
	speed: 0.0061s/iter; left time: 90.3462s
	iters: 400, epoch: 7 | loss: 0.2583956
	speed: 0.0057s/iter; left time: 83.1216s
	iters: 500, epoch: 7 | loss: 0.2139765
	speed: 0.0061s/iter; left time: 88.9708s
	iters: 600, epoch: 7 | loss: 0.2295724
	speed: 0.0048s/iter; left time: 69.4200s
	iters: 700, epoch: 7 | loss: 0.1592322
	speed: 0.0059s/iter; left time: 84.2710s
	iters: 800, epoch: 7 | loss: 0.2553610
	speed: 0.0055s/iter; left time: 77.9313s
	iters: 900, epoch: 7 | loss: 0.1856449
	speed: 0.0053s/iter; left time: 75.3256s
	iters: 1000, epoch: 7 | loss: 0.1636561
	speed: 0.0046s/iter; left time: 65.0611s
Epoch: 7 cost time: 5.993248462677002
Epoch: 7, Steps: 1074 | Train Loss: 0.2185479 Vali Loss: 0.1431486 Test Loss: 0.2314753
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.1607662
	speed: 0.0223s/iter; left time: 308.7954s
	iters: 200, epoch: 8 | loss: 0.1926444
	speed: 0.0054s/iter; left time: 74.4846s
	iters: 300, epoch: 8 | loss: 0.1866250
	speed: 0.0059s/iter; left time: 81.1324s
	iters: 400, epoch: 8 | loss: 0.1379757
	speed: 0.0055s/iter; left time: 74.3439s
	iters: 500, epoch: 8 | loss: 0.1943308
	speed: 0.0046s/iter; left time: 62.0447s
	iters: 600, epoch: 8 | loss: 0.2635928
	speed: 0.0046s/iter; left time: 61.1564s
	iters: 700, epoch: 8 | loss: 0.3458068
	speed: 0.0062s/iter; left time: 81.8536s
	iters: 800, epoch: 8 | loss: 0.1323155
	speed: 0.0045s/iter; left time: 58.7265s
	iters: 900, epoch: 8 | loss: 0.1855974
	speed: 0.0057s/iter; left time: 74.1348s
	iters: 1000, epoch: 8 | loss: 0.1782734
	speed: 0.0055s/iter; left time: 71.1147s
Epoch: 8 cost time: 5.763116121292114
Epoch: 8, Steps: 1074 | Train Loss: 0.2173858 Vali Loss: 0.1513759 Test Loss: 0.2589411
EarlyStopping counter: 3 out of 5
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.1503605
	speed: 0.0260s/iter; left time: 332.3269s
	iters: 200, epoch: 9 | loss: 0.1783292
	speed: 0.0061s/iter; left time: 77.0163s
	iters: 300, epoch: 9 | loss: 0.1581315
	speed: 0.0054s/iter; left time: 67.8018s
	iters: 400, epoch: 9 | loss: 0.2582018
	speed: 0.0049s/iter; left time: 61.1339s
	iters: 500, epoch: 9 | loss: 0.4508780
	speed: 0.0047s/iter; left time: 58.0087s
	iters: 600, epoch: 9 | loss: 0.2359682
	speed: 0.0051s/iter; left time: 62.9157s
	iters: 700, epoch: 9 | loss: 0.2305939
	speed: 0.0053s/iter; left time: 64.1678s
	iters: 800, epoch: 9 | loss: 0.2508640
	speed: 0.0052s/iter; left time: 63.0260s
	iters: 900, epoch: 9 | loss: 0.2855414
	speed: 0.0046s/iter; left time: 55.4352s
	iters: 1000, epoch: 9 | loss: 0.1207636
	speed: 0.0053s/iter; left time: 63.3230s
Epoch: 9 cost time: 5.617859125137329
Epoch: 9, Steps: 1074 | Train Loss: 0.2168888 Vali Loss: 0.1498742 Test Loss: 0.2502417
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.2405008
	speed: 0.0238s/iter; left time: 278.2361s
	iters: 200, epoch: 10 | loss: 0.1505831
	speed: 0.0059s/iter; left time: 68.8274s
	iters: 300, epoch: 10 | loss: 0.1838513
	speed: 0.0055s/iter; left time: 63.7407s
	iters: 400, epoch: 10 | loss: 0.2044450
	speed: 0.0056s/iter; left time: 63.6080s
	iters: 500, epoch: 10 | loss: 0.2295822
	speed: 0.0050s/iter; left time: 56.6203s
	iters: 600, epoch: 10 | loss: 0.1523459
	speed: 0.0059s/iter; left time: 66.0150s
	iters: 700, epoch: 10 | loss: 0.2443321
	speed: 0.0060s/iter; left time: 66.6064s
	iters: 800, epoch: 10 | loss: 0.1752243
	speed: 0.0050s/iter; left time: 55.2801s
	iters: 900, epoch: 10 | loss: 0.2659306
	speed: 0.0048s/iter; left time: 52.1541s
	iters: 1000, epoch: 10 | loss: 0.2074306
	speed: 0.0045s/iter; left time: 48.6800s
Epoch: 10 cost time: 5.594717502593994
Epoch: 10, Steps: 1074 | Train Loss: 0.2165567 Vali Loss: 0.1510293 Test Loss: 0.2557896
EarlyStopping counter: 5 out of 5
Early stopping
Total training time: 73.1708 seconds
>>>>>>>testing : ETTm2_96_96_DLinear_ETTm2_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed10458<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
data_set:  <data_provider.data_loader.Dataset_ETT_minute object at 0x00000221B6A63860>
mse:0.18256458640098572, mae:0.2713400721549988
