Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='exchange_rate.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=8, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='mse', lradj='type1', model='NLinear', model_id='Exchange_336_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=336, root_path='./dataset/', save_pred_values=False, seed=28649, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : Exchange_336_336_NLinear_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed28649>>>>>>>>>>>>>>>>>>>>>>>>>>
train 4640
val 425
test 1182
	iters: 100, epoch: 1 | loss: 0.3650883
	speed: 0.0096s/iter; left time: 27.0093s
Epoch: 1 cost time: 1.4112696647644043
Epoch: 1, Steps: 145 | Train Loss: 0.4281729 Vali Loss: 0.3978578 Test Loss: 0.3411284
Validation loss decreased (inf --> 0.397858).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.3905813
	speed: 0.0169s/iter; left time: 44.8737s
Epoch: 2 cost time: 1.53415846824646
Epoch: 2, Steps: 145 | Train Loss: 0.4168321 Vali Loss: 0.3960642 Test Loss: 0.3544929
Validation loss decreased (0.397858 --> 0.396064).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.3800473
	speed: 0.0159s/iter; left time: 40.0093s
Epoch: 3 cost time: 1.36962890625
Epoch: 3, Steps: 145 | Train Loss: 0.4116016 Vali Loss: 0.3906344 Test Loss: 0.3511327
Validation loss decreased (0.396064 --> 0.390634).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.4397588
	speed: 0.0154s/iter; left time: 36.5403s
Epoch: 4 cost time: 1.3771250247955322
Epoch: 4, Steps: 145 | Train Loss: 0.4100851 Vali Loss: 0.3915843 Test Loss: 0.3564345
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.4535912
	speed: 0.0164s/iter; left time: 36.4777s
Epoch: 5 cost time: 1.4601576328277588
Epoch: 5, Steps: 145 | Train Loss: 0.4090445 Vali Loss: 0.3878189 Test Loss: 0.3509123
Validation loss decreased (0.390634 --> 0.387819).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.4181732
	speed: 0.0160s/iter; left time: 33.1615s
Epoch: 6 cost time: 1.3538477420806885
Epoch: 6, Steps: 145 | Train Loss: 0.4085322 Vali Loss: 0.3846523 Test Loss: 0.3490155
Validation loss decreased (0.387819 --> 0.384652).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.3731866
	speed: 0.0156s/iter; left time: 30.1146s
Epoch: 7 cost time: 1.3881516456604004
Epoch: 7, Steps: 145 | Train Loss: 0.4083203 Vali Loss: 0.3867480 Test Loss: 0.3497579
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.4967046
	speed: 0.0152s/iter; left time: 27.1558s
Epoch: 8 cost time: 1.4098114967346191
Epoch: 8, Steps: 145 | Train Loss: 0.4081190 Vali Loss: 0.3864796 Test Loss: 0.3500192
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.4717498
	speed: 0.0157s/iter; left time: 25.7231s
Epoch: 9 cost time: 1.3511972427368164
Epoch: 9, Steps: 145 | Train Loss: 0.4080455 Vali Loss: 0.3845129 Test Loss: 0.3501975
Validation loss decreased (0.384652 --> 0.384513).  Saving model ...
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.3543871
	speed: 0.0162s/iter; left time: 24.2439s
Epoch: 10 cost time: 1.3247926235198975
Epoch: 10, Steps: 145 | Train Loss: 0.4079893 Vali Loss: 0.3857858 Test Loss: 0.3502086
EarlyStopping counter: 1 out of 5
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 11 | loss: 0.4576318
	speed: 0.0133s/iter; left time: 17.9348s
Epoch: 11 cost time: 1.1872999668121338
Epoch: 11, Steps: 145 | Train Loss: 0.4079583 Vali Loss: 0.3857074 Test Loss: 0.3502821
EarlyStopping counter: 2 out of 5
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 12 | loss: 0.3833282
	speed: 0.0141s/iter; left time: 17.0097s
Epoch: 12 cost time: 1.2547264099121094
Epoch: 12, Steps: 145 | Train Loss: 0.4079447 Vali Loss: 0.3852995 Test Loss: 0.3502872
EarlyStopping counter: 3 out of 5
Updating learning rate to 2.44140625e-07
	iters: 100, epoch: 13 | loss: 0.3907365
	speed: 0.0142s/iter; left time: 15.0286s
Epoch: 13 cost time: 1.2561590671539307
Epoch: 13, Steps: 145 | Train Loss: 0.4079399 Vali Loss: 0.3870330 Test Loss: 0.3502848
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.220703125e-07
	iters: 100, epoch: 14 | loss: 0.3792348
	speed: 0.0149s/iter; left time: 13.6403s
Epoch: 14 cost time: 1.426738977432251
Epoch: 14, Steps: 145 | Train Loss: 0.4079366 Vali Loss: 0.3879999 Test Loss: 0.3502779
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : Exchange_336_336_NLinear_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed28649<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 1182
mse:0.35038524866104126, mae:0.4254775941371918
