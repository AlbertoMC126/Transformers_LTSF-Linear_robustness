Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTh1', data_path='ETTh1.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='NLinear', model_id='ETTh1_336_720', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=720, root_path='./dataset/', save_pred_values=False, seed=28649, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTh1_336_720_NLinear_ETTh1_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed28649>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7585
val 2161
test 2161
	iters: 100, epoch: 1 | loss: 0.6512285
	speed: 0.0166s/iter; left time: 76.9079s
	iters: 200, epoch: 1 | loss: 0.6722677
	speed: 0.0179s/iter; left time: 81.3384s
Epoch: 1 cost time: 4.151242017745972
Epoch: 1, Steps: 237 | Train Loss: 0.6759472 Vali Loss: 1.7655246 Test Loss: 0.6011872
Validation loss decreased (inf --> 1.765525).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.6960503
	speed: 0.0294s/iter; left time: 129.5101s
	iters: 200, epoch: 2 | loss: 0.7139785
	speed: 0.0195s/iter; left time: 84.0532s
Epoch: 2 cost time: 4.335681676864624
Epoch: 2, Steps: 237 | Train Loss: 0.6440977 Vali Loss: 1.7605884 Test Loss: 0.5552028
Validation loss decreased (1.765525 --> 1.760588).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.5618331
	speed: 0.0349s/iter; left time: 145.6193s
	iters: 200, epoch: 3 | loss: 0.6239977
	speed: 0.0188s/iter; left time: 76.5869s
Epoch: 3 cost time: 4.374303579330444
Epoch: 3, Steps: 237 | Train Loss: 0.5903231 Vali Loss: 1.5751591 Test Loss: 0.4890635
Validation loss decreased (1.760588 --> 1.575159).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.5641639
	speed: 0.0323s/iter; left time: 127.0408s
	iters: 200, epoch: 4 | loss: 0.5826741
	speed: 0.0200s/iter; left time: 76.4948s
Epoch: 4 cost time: 4.381746530532837
Epoch: 4, Steps: 237 | Train Loss: 0.5655576 Vali Loss: 1.5478983 Test Loss: 0.4713212
Validation loss decreased (1.575159 --> 1.547898).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.5913447
	speed: 0.0326s/iter; left time: 120.4565s
	iters: 200, epoch: 5 | loss: 0.5596459
	speed: 0.0176s/iter; left time: 63.1556s
Epoch: 5 cost time: 4.048964738845825
Epoch: 5, Steps: 237 | Train Loss: 0.5545587 Vali Loss: 1.5587792 Test Loss: 0.4642519
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.5135649
	speed: 0.0324s/iter; left time: 112.0139s
	iters: 200, epoch: 6 | loss: 0.5191443
	speed: 0.0179s/iter; left time: 60.0298s
Epoch: 6 cost time: 4.333643674850464
Epoch: 6, Steps: 237 | Train Loss: 0.5478110 Vali Loss: 1.5164706 Test Loss: 0.4572065
Validation loss decreased (1.547898 --> 1.516471).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.4824316
	speed: 0.0360s/iter; left time: 116.0143s
	iters: 200, epoch: 7 | loss: 0.4268102
	speed: 0.0191s/iter; left time: 59.6344s
Epoch: 7 cost time: 4.503670692443848
Epoch: 7, Steps: 237 | Train Loss: 0.5444325 Vali Loss: 1.5154073 Test Loss: 0.4556853
Validation loss decreased (1.516471 --> 1.515407).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.5136560
	speed: 0.0338s/iter; left time: 100.8611s
	iters: 200, epoch: 8 | loss: 0.6200712
	speed: 0.0176s/iter; left time: 50.5909s
Epoch: 8 cost time: 4.108456611633301
Epoch: 8, Steps: 237 | Train Loss: 0.5427545 Vali Loss: 1.5127764 Test Loss: 0.4549645
Validation loss decreased (1.515407 --> 1.512776).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.5491357
	speed: 0.0326s/iter; left time: 89.5928s
	iters: 200, epoch: 9 | loss: 0.4857720
	speed: 0.0186s/iter; left time: 49.3062s
Epoch: 9 cost time: 4.206103086471558
Epoch: 9, Steps: 237 | Train Loss: 0.5418393 Vali Loss: 1.5178000 Test Loss: 0.4535745
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.6014708
	speed: 0.0300s/iter; left time: 75.3427s
	iters: 200, epoch: 10 | loss: 0.5003037
	speed: 0.0186s/iter; left time: 44.6991s
Epoch: 10 cost time: 4.353090524673462
Epoch: 10, Steps: 237 | Train Loss: 0.5411577 Vali Loss: 1.5127196 Test Loss: 0.4538955
Validation loss decreased (1.512776 --> 1.512720).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.5155570
	speed: 0.0319s/iter; left time: 72.4905s
	iters: 200, epoch: 11 | loss: 0.5644072
	speed: 0.0204s/iter; left time: 44.3785s
Epoch: 11 cost time: 4.515157461166382
Epoch: 11, Steps: 237 | Train Loss: 0.5408809 Vali Loss: 1.5165901 Test Loss: 0.4534914
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.5626200
	speed: 0.0356s/iter; left time: 72.3982s
	iters: 200, epoch: 12 | loss: 0.5112154
	speed: 0.0178s/iter; left time: 34.5169s
Epoch: 12 cost time: 4.2434632778167725
Epoch: 12, Steps: 237 | Train Loss: 0.5407012 Vali Loss: 1.5180413 Test Loss: 0.4535552
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.5070423
	speed: 0.0319s/iter; left time: 57.2826s
	iters: 200, epoch: 13 | loss: 0.5646505
	speed: 0.0171s/iter; left time: 28.9413s
Epoch: 13 cost time: 3.8711373805999756
Epoch: 13, Steps: 237 | Train Loss: 0.5406720 Vali Loss: 1.5154463 Test Loss: 0.4535406
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.4271748
	speed: 0.0286s/iter; left time: 44.6000s
	iters: 200, epoch: 14 | loss: 0.5369217
	speed: 0.0153s/iter; left time: 22.3812s
Epoch: 14 cost time: 3.6462113857269287
Epoch: 14, Steps: 237 | Train Loss: 0.5405834 Vali Loss: 1.5157332 Test Loss: 0.4535427
EarlyStopping counter: 4 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.5966970
	speed: 0.0293s/iter; left time: 38.8099s
	iters: 200, epoch: 15 | loss: 0.5993713
	speed: 0.0147s/iter; left time: 17.9362s
Epoch: 15 cost time: 3.498188018798828
Epoch: 15, Steps: 237 | Train Loss: 0.5406035 Vali Loss: 1.5169944 Test Loss: 0.4535305
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTh1_336_720_NLinear_ETTh1_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed28649<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
mse:0.45278558135032654, mae:0.45976772904396057
