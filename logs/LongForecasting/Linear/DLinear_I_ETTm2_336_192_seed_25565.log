Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='DLinear', model_id='ETTm2_336_192', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=192, root_path='./dataset/', save_pred_values=False, seed=25565, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTm2_336_192_DLinear_ETTm2_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed25565>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34033
val 11329
test 11329
	iters: 100, epoch: 1 | loss: 0.3682320
	speed: 0.0113s/iter; left time: 239.5619s
	iters: 200, epoch: 1 | loss: 0.3237368
	speed: 0.0107s/iter; left time: 224.9538s
	iters: 300, epoch: 1 | loss: 0.8012052
	speed: 0.0097s/iter; left time: 203.3928s
	iters: 400, epoch: 1 | loss: 0.5060724
	speed: 0.0103s/iter; left time: 215.1198s
	iters: 500, epoch: 1 | loss: 0.6975130
	speed: 0.0116s/iter; left time: 241.0202s
	iters: 600, epoch: 1 | loss: 0.6484115
	speed: 0.0118s/iter; left time: 244.5016s
	iters: 700, epoch: 1 | loss: 0.4120368
	speed: 0.0106s/iter; left time: 218.3808s
	iters: 800, epoch: 1 | loss: 1.1468277
	speed: 0.0106s/iter; left time: 217.1643s
	iters: 900, epoch: 1 | loss: 0.3438750
	speed: 0.0100s/iter; left time: 204.4967s
	iters: 1000, epoch: 1 | loss: 0.2615723
	speed: 0.0108s/iter; left time: 218.6472s
Epoch: 1 cost time: 11.35509443283081
Epoch: 1, Steps: 1063 | Train Loss: 0.5546055 Vali Loss: 0.8869900 Test Loss: 2.5237036
Validation loss decreased (inf --> 0.886990).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.8326392
	speed: 0.0431s/iter; left time: 866.7838s
	iters: 200, epoch: 2 | loss: 0.8930086
	speed: 0.0111s/iter; left time: 221.2657s
	iters: 300, epoch: 2 | loss: 0.3567464
	speed: 0.0108s/iter; left time: 215.3634s
	iters: 400, epoch: 2 | loss: 0.5034353
	speed: 0.0115s/iter; left time: 228.1022s
	iters: 500, epoch: 2 | loss: 0.4032820
	speed: 0.0103s/iter; left time: 203.1221s
	iters: 600, epoch: 2 | loss: 0.5074916
	speed: 0.0118s/iter; left time: 230.2991s
	iters: 700, epoch: 2 | loss: 0.4714361
	speed: 0.0115s/iter; left time: 223.6879s
	iters: 800, epoch: 2 | loss: 0.4296793
	speed: 0.0104s/iter; left time: 201.7556s
	iters: 900, epoch: 2 | loss: 0.7098926
	speed: 0.0104s/iter; left time: 200.9247s
	iters: 1000, epoch: 2 | loss: 0.5259616
	speed: 0.0096s/iter; left time: 184.7161s
Epoch: 2 cost time: 11.555404424667358
Epoch: 2, Steps: 1063 | Train Loss: 0.5777302 Vali Loss: 0.4666031 Test Loss: 0.9844102
Validation loss decreased (0.886990 --> 0.466603).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.5386323
	speed: 0.0469s/iter; left time: 893.5874s
	iters: 200, epoch: 3 | loss: 0.4438270
	speed: 0.0107s/iter; left time: 201.8767s
	iters: 300, epoch: 3 | loss: 0.6703095
	speed: 0.0111s/iter; left time: 208.7207s
	iters: 400, epoch: 3 | loss: 0.4914336
	speed: 0.0109s/iter; left time: 204.2531s
	iters: 500, epoch: 3 | loss: 0.4128641
	speed: 0.0098s/iter; left time: 183.0044s
	iters: 600, epoch: 3 | loss: 0.1678339
	speed: 0.0103s/iter; left time: 191.2969s
	iters: 700, epoch: 3 | loss: 0.3592333
	speed: 0.0113s/iter; left time: 207.5834s
	iters: 800, epoch: 3 | loss: 0.2137578
	speed: 0.0113s/iter; left time: 207.5642s
	iters: 900, epoch: 3 | loss: 0.3859686
	speed: 0.0122s/iter; left time: 222.5579s
	iters: 1000, epoch: 3 | loss: 0.3611951
	speed: 0.0105s/iter; left time: 189.8826s
Epoch: 3 cost time: 11.613511085510254
Epoch: 3, Steps: 1063 | Train Loss: 0.3706314 Vali Loss: 0.2814010 Test Loss: 0.5430614
Validation loss decreased (0.466603 --> 0.281401).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.2822224
	speed: 0.0453s/iter; left time: 813.8956s
	iters: 200, epoch: 4 | loss: 0.2269575
	speed: 0.0092s/iter; left time: 163.9468s
	iters: 300, epoch: 4 | loss: 0.2882561
	speed: 0.0107s/iter; left time: 190.0213s
	iters: 400, epoch: 4 | loss: 0.3705094
	speed: 0.0112s/iter; left time: 198.7519s
	iters: 500, epoch: 4 | loss: 0.3905896
	speed: 0.0115s/iter; left time: 202.1449s
	iters: 600, epoch: 4 | loss: 0.2430588
	speed: 0.0106s/iter; left time: 185.4092s
	iters: 700, epoch: 4 | loss: 0.2573276
	speed: 0.0108s/iter; left time: 187.4368s
	iters: 800, epoch: 4 | loss: 0.3018578
	speed: 0.0094s/iter; left time: 163.0621s
	iters: 900, epoch: 4 | loss: 0.6041972
	speed: 0.0104s/iter; left time: 179.1134s
	iters: 1000, epoch: 4 | loss: 0.3143959
	speed: 0.0117s/iter; left time: 199.1037s
Epoch: 4 cost time: 11.184314012527466
Epoch: 4, Steps: 1063 | Train Loss: 0.3243680 Vali Loss: 0.1845953 Test Loss: 0.2839290
Validation loss decreased (0.281401 --> 0.184595).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.3255378
	speed: 0.0457s/iter; left time: 772.5824s
	iters: 200, epoch: 5 | loss: 0.2304942
	speed: 0.0103s/iter; left time: 173.3467s
	iters: 300, epoch: 5 | loss: 0.1502521
	speed: 0.0103s/iter; left time: 171.8412s
	iters: 400, epoch: 5 | loss: 0.4051362
	speed: 0.0107s/iter; left time: 177.5861s
	iters: 500, epoch: 5 | loss: 0.4193496
	speed: 0.0090s/iter; left time: 148.8799s
	iters: 600, epoch: 5 | loss: 0.1137617
	speed: 0.0080s/iter; left time: 131.8235s
	iters: 700, epoch: 5 | loss: 0.3145990
	speed: 0.0098s/iter; left time: 160.3574s
	iters: 800, epoch: 5 | loss: 0.4676669
	speed: 0.0100s/iter; left time: 162.8015s
	iters: 900, epoch: 5 | loss: 0.2244162
	speed: 0.0108s/iter; left time: 173.5133s
	iters: 1000, epoch: 5 | loss: 0.1739148
	speed: 0.0108s/iter; left time: 173.4139s
Epoch: 5 cost time: 10.67843222618103
Epoch: 5, Steps: 1063 | Train Loss: 0.3015210 Vali Loss: 0.2371530 Test Loss: 0.4348986
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.2183353
	speed: 0.0499s/iter; left time: 790.1191s
	iters: 200, epoch: 6 | loss: 0.2620201
	speed: 0.0103s/iter; left time: 161.8786s
	iters: 300, epoch: 6 | loss: 0.2041742
	speed: 0.0110s/iter; left time: 172.4247s
	iters: 400, epoch: 6 | loss: 0.2881687
	speed: 0.0095s/iter; left time: 147.4057s
	iters: 500, epoch: 6 | loss: 0.2520007
	speed: 0.0098s/iter; left time: 151.8850s
	iters: 600, epoch: 6 | loss: 0.5486986
	speed: 0.0104s/iter; left time: 160.2612s
	iters: 700, epoch: 6 | loss: 0.1509346
	speed: 0.0101s/iter; left time: 154.3046s
	iters: 800, epoch: 6 | loss: 0.3766326
	speed: 0.0098s/iter; left time: 148.7678s
	iters: 900, epoch: 6 | loss: 0.3608790
	speed: 0.0086s/iter; left time: 130.0129s
	iters: 1000, epoch: 6 | loss: 0.4940045
	speed: 0.0106s/iter; left time: 158.7640s
Epoch: 6 cost time: 10.737123489379883
Epoch: 6, Steps: 1063 | Train Loss: 0.2883605 Vali Loss: 0.2142580 Test Loss: 0.3949572
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.2832931
	speed: 0.0501s/iter; left time: 740.0534s
	iters: 200, epoch: 7 | loss: 0.1754906
	speed: 0.0083s/iter; left time: 122.4986s
	iters: 300, epoch: 7 | loss: 0.2465116
	speed: 0.0104s/iter; left time: 152.1213s
	iters: 400, epoch: 7 | loss: 0.2327605
	speed: 0.0100s/iter; left time: 144.6971s
	iters: 500, epoch: 7 | loss: 0.2316450
	speed: 0.0110s/iter; left time: 157.8194s
	iters: 600, epoch: 7 | loss: 0.3781726
	speed: 0.0118s/iter; left time: 168.0339s
	iters: 700, epoch: 7 | loss: 0.2639179
	speed: 0.0115s/iter; left time: 162.5479s
	iters: 800, epoch: 7 | loss: 0.2783738
	speed: 0.0111s/iter; left time: 156.6209s
	iters: 900, epoch: 7 | loss: 0.1313944
	speed: 0.0103s/iter; left time: 144.6206s
	iters: 1000, epoch: 7 | loss: 0.3567633
	speed: 0.0111s/iter; left time: 154.1392s
Epoch: 7 cost time: 11.21050214767456
Epoch: 7, Steps: 1063 | Train Loss: 0.2818426 Vali Loss: 0.1943242 Test Loss: 0.3261006
EarlyStopping counter: 3 out of 5
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.6458843
	speed: 0.0438s/iter; left time: 601.3743s
	iters: 200, epoch: 8 | loss: 0.2759211
	speed: 0.0118s/iter; left time: 160.8990s
	iters: 300, epoch: 8 | loss: 0.2224822
	speed: 0.0104s/iter; left time: 140.6980s
	iters: 400, epoch: 8 | loss: 0.5351169
	speed: 0.0100s/iter; left time: 134.6208s
	iters: 500, epoch: 8 | loss: 0.2446395
	speed: 0.0117s/iter; left time: 155.4963s
	iters: 600, epoch: 8 | loss: 0.1071635
	speed: 0.0110s/iter; left time: 145.8246s
	iters: 700, epoch: 8 | loss: 0.2546434
	speed: 0.0118s/iter; left time: 154.4387s
	iters: 800, epoch: 8 | loss: 0.3593177
	speed: 0.0113s/iter; left time: 147.1524s
	iters: 900, epoch: 8 | loss: 0.3069959
	speed: 0.0114s/iter; left time: 147.1627s
	iters: 1000, epoch: 8 | loss: 0.1557949
	speed: 0.0117s/iter; left time: 149.6222s
Epoch: 8 cost time: 11.848629474639893
Epoch: 8, Steps: 1063 | Train Loss: 0.2780485 Vali Loss: 0.2074863 Test Loss: 0.3664111
EarlyStopping counter: 4 out of 5
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.1944957
	speed: 0.0459s/iter; left time: 580.5982s
	iters: 200, epoch: 9 | loss: 0.3600521
	speed: 0.0113s/iter; left time: 141.4396s
	iters: 300, epoch: 9 | loss: 0.3065998
	speed: 0.0117s/iter; left time: 145.2534s
	iters: 400, epoch: 9 | loss: 0.3259961
	speed: 0.0119s/iter; left time: 147.0678s
	iters: 500, epoch: 9 | loss: 0.1566827
	speed: 0.0104s/iter; left time: 126.8861s
	iters: 600, epoch: 9 | loss: 0.1727008
	speed: 0.0109s/iter; left time: 132.5457s
	iters: 700, epoch: 9 | loss: 0.3134031
	speed: 0.0114s/iter; left time: 137.1295s
	iters: 800, epoch: 9 | loss: 0.2097790
	speed: 0.0106s/iter; left time: 126.2745s
	iters: 900, epoch: 9 | loss: 0.2263280
	speed: 0.0106s/iter; left time: 125.9251s
	iters: 1000, epoch: 9 | loss: 0.2156024
	speed: 0.0101s/iter; left time: 118.1701s
Epoch: 9 cost time: 11.500121831893921
Epoch: 9, Steps: 1063 | Train Loss: 0.2758278 Vali Loss: 0.2015090 Test Loss: 0.3592952
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTm2_336_192_DLinear_ETTm2_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed25565<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
mse:0.28434282541275024, mae:0.35097262263298035
