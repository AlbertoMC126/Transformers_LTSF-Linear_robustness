Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='DLinear', model_id='traffic_336_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=336, root_path='./dataset/', save_pred_values=False, seed=32598, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_336_336_DLinear_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed32598>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11609
val 1421
test 3173
	iters: 100, epoch: 1 | loss: 0.5188904
	speed: 0.4624s/iter; left time: 6658.8399s
	iters: 200, epoch: 1 | loss: 0.5296974
	speed: 0.4534s/iter; left time: 6483.7283s
	iters: 300, epoch: 1 | loss: 0.5855392
	speed: 0.4569s/iter; left time: 6487.8641s
	iters: 400, epoch: 1 | loss: 0.5745653
	speed: 0.4511s/iter; left time: 6360.7275s
	iters: 500, epoch: 1 | loss: 0.5775401
	speed: 0.4559s/iter; left time: 6382.8814s
	iters: 600, epoch: 1 | loss: 0.5718457
	speed: 0.4524s/iter; left time: 6288.2474s
	iters: 700, epoch: 1 | loss: 0.6347576
	speed: 0.4483s/iter; left time: 6186.5274s
Epoch: 1 cost time: 329.61855363845825
Epoch: 1, Steps: 725 | Train Loss: 0.5997020 Vali Loss: 0.8071919 Test Loss: 0.9582067
Validation loss decreased (inf --> 0.807192).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.6027148
	speed: 0.9636s/iter; left time: 13178.6947s
	iters: 200, epoch: 2 | loss: 0.5655770
	speed: 0.4590s/iter; left time: 6231.2740s
	iters: 300, epoch: 2 | loss: 0.5969239
	speed: 0.4696s/iter; left time: 6328.2597s
	iters: 400, epoch: 2 | loss: 0.5934611
	speed: 0.4504s/iter; left time: 6024.9188s
	iters: 500, epoch: 2 | loss: 0.5490416
	speed: 0.4585s/iter; left time: 6086.6501s
	iters: 600, epoch: 2 | loss: 0.6144214
	speed: 0.4462s/iter; left time: 5879.2882s
	iters: 700, epoch: 2 | loss: 0.6141119
	speed: 0.4438s/iter; left time: 5803.1302s
Epoch: 2 cost time: 329.8125538825989
Epoch: 2, Steps: 725 | Train Loss: 0.5945052 Vali Loss: 0.8655424 Test Loss: 1.0109433
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.3899204
	speed: 0.8974s/iter; left time: 11622.1078s
	iters: 200, epoch: 3 | loss: 0.4093288
	speed: 0.4511s/iter; left time: 5797.5672s
	iters: 300, epoch: 3 | loss: 0.3678878
	speed: 0.4659s/iter; left time: 5941.0266s
	iters: 400, epoch: 3 | loss: 0.3807078
	speed: 0.4473s/iter; left time: 5659.2303s
	iters: 500, epoch: 3 | loss: 0.3551700
	speed: 0.4791s/iter; left time: 6013.4592s
	iters: 600, epoch: 3 | loss: 0.3817960
	speed: 0.4469s/iter; left time: 5563.9727s
	iters: 700, epoch: 3 | loss: 0.3854474
	speed: 0.4485s/iter; left time: 5539.8428s
Epoch: 3 cost time: 330.70118141174316
Epoch: 3, Steps: 725 | Train Loss: 0.3733952 Vali Loss: 0.5184987 Test Loss: 0.6306830
Validation loss decreased (0.807192 --> 0.518499).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.2893945
	speed: 0.9796s/iter; left time: 11977.1364s
	iters: 200, epoch: 4 | loss: 0.3021440
	speed: 0.4594s/iter; left time: 5570.5920s
	iters: 300, epoch: 4 | loss: 0.3035090
	speed: 0.4586s/iter; left time: 5514.9896s
	iters: 400, epoch: 4 | loss: 0.3013892
	speed: 0.4528s/iter; left time: 5399.6904s
	iters: 500, epoch: 4 | loss: 0.3105858
	speed: 0.4664s/iter; left time: 5516.0027s
	iters: 600, epoch: 4 | loss: 0.3105950
	speed: 0.4429s/iter; left time: 5193.8302s
	iters: 700, epoch: 4 | loss: 0.3255529
	speed: 0.4495s/iter; left time: 5225.3347s
Epoch: 4 cost time: 330.9844720363617
Epoch: 4, Steps: 725 | Train Loss: 0.3060372 Vali Loss: 0.4372121 Test Loss: 0.5334080
Validation loss decreased (0.518499 --> 0.437212).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.2700564
	speed: 0.9809s/iter; left time: 11281.4215s
	iters: 200, epoch: 5 | loss: 0.2704782
	speed: 0.4662s/iter; left time: 5315.1056s
	iters: 300, epoch: 5 | loss: 0.2758083
	speed: 0.4581s/iter; left time: 5177.0209s
	iters: 400, epoch: 5 | loss: 0.2831997
	speed: 0.4481s/iter; left time: 5019.6645s
	iters: 500, epoch: 5 | loss: 0.3058492
	speed: 0.4589s/iter; left time: 5094.7040s
	iters: 600, epoch: 5 | loss: 0.2723883
	speed: 0.4478s/iter; left time: 4926.0460s
	iters: 700, epoch: 5 | loss: 0.2955651
	speed: 0.4589s/iter; left time: 5002.5290s
Epoch: 5 cost time: 332.3433485031128
Epoch: 5, Steps: 725 | Train Loss: 0.2787849 Vali Loss: 0.4041938 Test Loss: 0.4918911
Validation loss decreased (0.437212 --> 0.404194).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.2246845
	speed: 0.9779s/iter; left time: 10537.6801s
	iters: 200, epoch: 6 | loss: 0.2372817
	speed: 0.4709s/iter; left time: 5027.2193s
	iters: 300, epoch: 6 | loss: 0.2575700
	speed: 0.4575s/iter; left time: 4838.0158s
	iters: 400, epoch: 6 | loss: 0.2642273
	speed: 0.4630s/iter; left time: 4850.0599s
	iters: 500, epoch: 6 | loss: 0.3087307
	speed: 0.4579s/iter; left time: 4751.5061s
	iters: 600, epoch: 6 | loss: 0.2593577
	speed: 0.4465s/iter; left time: 4588.0635s
	iters: 700, epoch: 6 | loss: 0.2406382
	speed: 0.4746s/iter; left time: 4829.7807s
Epoch: 6 cost time: 333.9652507305145
Epoch: 6, Steps: 725 | Train Loss: 0.2647469 Vali Loss: 0.3845386 Test Loss: 0.4706050
Validation loss decreased (0.404194 --> 0.384539).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.2627520
	speed: 0.9728s/iter; left time: 9777.6954s
	iters: 200, epoch: 7 | loss: 0.2773748
	speed: 0.4619s/iter; left time: 4596.8634s
	iters: 300, epoch: 7 | loss: 0.2566696
	speed: 0.4548s/iter; left time: 4480.6099s
	iters: 400, epoch: 7 | loss: 0.2810464
	speed: 0.4638s/iter; left time: 4522.9972s
	iters: 500, epoch: 7 | loss: 0.2827332
	speed: 0.4474s/iter; left time: 4318.1446s
	iters: 600, epoch: 7 | loss: 0.2580141
	speed: 0.4457s/iter; left time: 4256.8297s
	iters: 700, epoch: 7 | loss: 0.2800888
	speed: 0.4515s/iter; left time: 4267.0200s
Epoch: 7 cost time: 330.2944104671478
Epoch: 7, Steps: 725 | Train Loss: 0.2572174 Vali Loss: 0.3778265 Test Loss: 0.4622756
Validation loss decreased (0.384539 --> 0.377827).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.2450342
	speed: 0.9792s/iter; left time: 9132.0501s
	iters: 200, epoch: 8 | loss: 0.2595983
	speed: 0.4593s/iter; left time: 4237.1986s
	iters: 300, epoch: 8 | loss: 0.2415685
	speed: 0.4514s/iter; left time: 4119.0228s
	iters: 400, epoch: 8 | loss: 0.2549118
	speed: 0.4642s/iter; left time: 4189.9878s
	iters: 500, epoch: 8 | loss: 0.2639372
	speed: 0.4504s/iter; left time: 4020.7006s
	iters: 600, epoch: 8 | loss: 0.2624362
	speed: 0.4568s/iter; left time: 4031.4903s
	iters: 700, epoch: 8 | loss: 0.2350708
	speed: 0.4758s/iter; left time: 4151.7912s
Epoch: 8 cost time: 333.14918851852417
Epoch: 8, Steps: 725 | Train Loss: 0.2530880 Vali Loss: 0.3742200 Test Loss: 0.4572956
Validation loss decreased (0.377827 --> 0.374220).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.2416582
	speed: 0.9945s/iter; left time: 8553.5399s
	iters: 200, epoch: 9 | loss: 0.2624826
	speed: 0.4562s/iter; left time: 3878.4198s
	iters: 300, epoch: 9 | loss: 0.2710852
	speed: 0.4600s/iter; left time: 3864.5993s
	iters: 400, epoch: 9 | loss: 0.2622054
	speed: 0.4569s/iter; left time: 3792.3879s
	iters: 500, epoch: 9 | loss: 0.2504990
	speed: 0.4508s/iter; left time: 3696.9376s
	iters: 600, epoch: 9 | loss: 0.2754640
	speed: 0.4661s/iter; left time: 3775.7962s
	iters: 700, epoch: 9 | loss: 0.2273838
	speed: 0.4568s/iter; left time: 3654.4996s
Epoch: 9 cost time: 333.4426944255829
Epoch: 9, Steps: 725 | Train Loss: 0.2507648 Vali Loss: 0.3724320 Test Loss: 0.4551449
Validation loss decreased (0.374220 --> 0.372432).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.2431563
	speed: 0.9865s/iter; left time: 7769.6354s
	iters: 200, epoch: 10 | loss: 0.2506325
	speed: 0.4546s/iter; left time: 3534.7200s
	iters: 300, epoch: 10 | loss: 0.2496417
	speed: 0.4570s/iter; left time: 3507.6643s
	iters: 400, epoch: 10 | loss: 0.2546720
	speed: 0.4485s/iter; left time: 3398.1633s
	iters: 500, epoch: 10 | loss: 0.2399875
	speed: 0.4476s/iter; left time: 3345.8997s
	iters: 600, epoch: 10 | loss: 0.2430383
	speed: 0.4554s/iter; left time: 3359.3542s
	iters: 700, epoch: 10 | loss: 0.2836578
	speed: 0.4481s/iter; left time: 3260.3046s
Epoch: 10 cost time: 329.08174324035645
Epoch: 10, Steps: 725 | Train Loss: 0.2495332 Vali Loss: 0.3713004 Test Loss: 0.4542550
Validation loss decreased (0.372432 --> 0.371300).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.2398796
	speed: 0.9813s/iter; left time: 7017.5677s
	iters: 200, epoch: 11 | loss: 0.2653695
	speed: 0.4571s/iter; left time: 3223.2262s
	iters: 300, epoch: 11 | loss: 0.3000081
	speed: 0.4621s/iter; left time: 3211.8863s
	iters: 400, epoch: 11 | loss: 0.2348710
	speed: 0.4479s/iter; left time: 3068.4669s
	iters: 500, epoch: 11 | loss: 0.2407337
	speed: 0.4456s/iter; left time: 3008.4315s
	iters: 600, epoch: 11 | loss: 0.2386829
	speed: 0.4738s/iter; left time: 3151.3959s
	iters: 700, epoch: 11 | loss: 0.2446059
	speed: 0.4486s/iter; left time: 2938.9999s
Epoch: 11 cost time: 331.5683171749115
Epoch: 11, Steps: 725 | Train Loss: 0.2488610 Vali Loss: 0.3717087 Test Loss: 0.4539255
EarlyStopping counter: 1 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.2420739
	speed: 0.9043s/iter; left time: 5811.1610s
	iters: 200, epoch: 12 | loss: 0.2726554
	speed: 0.4512s/iter; left time: 2854.0607s
	iters: 300, epoch: 12 | loss: 0.2330437
	speed: 0.4601s/iter; left time: 2864.6469s
	iters: 400, epoch: 12 | loss: 0.2670107
	speed: 0.4448s/iter; left time: 2724.9872s
	iters: 500, epoch: 12 | loss: 0.2712220
	speed: 0.4465s/iter; left time: 2690.8531s
	iters: 600, epoch: 12 | loss: 0.2569126
	speed: 0.4486s/iter; left time: 2658.3439s
	iters: 700, epoch: 12 | loss: 0.2520747
	speed: 0.4501s/iter; left time: 2622.2169s
Epoch: 12 cost time: 327.6967566013336
Epoch: 12, Steps: 725 | Train Loss: 0.2484686 Vali Loss: 0.3712897 Test Loss: 0.4536993
Validation loss decreased (0.371300 --> 0.371290).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.2238181
	speed: 0.9702s/iter; left time: 5530.9782s
	iters: 200, epoch: 13 | loss: 0.2459268
	speed: 0.4541s/iter; left time: 2543.5436s
	iters: 300, epoch: 13 | loss: 0.2188354
	speed: 0.4544s/iter; left time: 2499.4894s
	iters: 400, epoch: 13 | loss: 0.2431431
	speed: 0.4470s/iter; left time: 2414.1595s
	iters: 500, epoch: 13 | loss: 0.2585195
	speed: 0.4500s/iter; left time: 2385.5224s
	iters: 600, epoch: 13 | loss: 0.2430474
	speed: 0.4506s/iter; left time: 2343.4826s
	iters: 700, epoch: 13 | loss: 0.2474614
	speed: 0.4524s/iter; left time: 2307.6141s
Epoch: 13 cost time: 327.7652997970581
Epoch: 13, Steps: 725 | Train Loss: 0.2482392 Vali Loss: 0.3713489 Test Loss: 0.4535966
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 14 | loss: 0.2530931
	speed: 0.8912s/iter; left time: 4434.8499s
	iters: 200, epoch: 14 | loss: 0.2788944
	speed: 0.4481s/iter; left time: 2185.1112s
	iters: 300, epoch: 14 | loss: 0.2497662
	speed: 0.4541s/iter; left time: 2168.6845s
	iters: 400, epoch: 14 | loss: 0.2626736
	speed: 0.4454s/iter; left time: 2082.7043s
	iters: 500, epoch: 14 | loss: 0.2291718
	speed: 0.4482s/iter; left time: 2051.1042s
	iters: 600, epoch: 14 | loss: 0.2536483
	speed: 0.4498s/iter; left time: 2013.2207s
	iters: 700, epoch: 14 | loss: 0.2481870
	speed: 0.4516s/iter; left time: 1976.3914s
Epoch: 14 cost time: 325.94531321525574
Epoch: 14, Steps: 725 | Train Loss: 0.2481277 Vali Loss: 0.3709443 Test Loss: 0.4535692
Validation loss decreased (0.371290 --> 0.370944).  Saving model ...
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 15 | loss: 0.2332566
	speed: 0.9677s/iter; left time: 4113.7618s
	iters: 200, epoch: 15 | loss: 0.2426765
	speed: 0.4629s/iter; left time: 1921.5555s
	iters: 300, epoch: 15 | loss: 0.2544553
	speed: 0.4617s/iter; left time: 1870.1894s
	iters: 400, epoch: 15 | loss: 0.2544465
	speed: 0.4466s/iter; left time: 1764.6960s
	iters: 500, epoch: 15 | loss: 0.2162760
	speed: 0.4471s/iter; left time: 1721.7365s
	iters: 600, epoch: 15 | loss: 0.2360287
	speed: 0.4478s/iter; left time: 1679.6646s
	iters: 700, epoch: 15 | loss: 0.2313701
	speed: 0.4517s/iter; left time: 1649.0909s
Epoch: 15 cost time: 328.41265869140625
Epoch: 15, Steps: 725 | Train Loss: 0.2480790 Vali Loss: 0.3709020 Test Loss: 0.4535700
Validation loss decreased (0.370944 --> 0.370902).  Saving model ...
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 16 | loss: 0.2406881
	speed: 0.9653s/iter; left time: 3403.5742s
	iters: 200, epoch: 16 | loss: 0.2565282
	speed: 0.4648s/iter; left time: 1592.5296s
	iters: 300, epoch: 16 | loss: 0.2502521
	speed: 0.4579s/iter; left time: 1522.8290s
	iters: 400, epoch: 16 | loss: 0.2447931
	speed: 0.4461s/iter; left time: 1439.1116s
	iters: 500, epoch: 16 | loss: 0.2690836
	speed: 0.4493s/iter; left time: 1404.5119s
	iters: 600, epoch: 16 | loss: 0.2454172
	speed: 0.4485s/iter; left time: 1357.3079s
	iters: 700, epoch: 16 | loss: 0.2483103
	speed: 0.4521s/iter; left time: 1322.8844s
Epoch: 16 cost time: 328.71386313438416
Epoch: 16, Steps: 725 | Train Loss: 0.2480713 Vali Loss: 0.3710802 Test Loss: 0.4535683
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 17 | loss: 0.2623142
	speed: 0.8895s/iter; left time: 2491.5277s
	iters: 200, epoch: 17 | loss: 0.2472520
	speed: 0.4552s/iter; left time: 1229.4115s
	iters: 300, epoch: 17 | loss: 0.2647891
	speed: 0.4464s/iter; left time: 1161.0060s
	iters: 400, epoch: 17 | loss: 0.2695371
	speed: 0.4462s/iter; left time: 1115.8847s
	iters: 500, epoch: 17 | loss: 0.2412281
	speed: 0.4504s/iter; left time: 1081.4110s
	iters: 600, epoch: 17 | loss: 0.2495514
	speed: 0.4544s/iter; left time: 1045.6260s
	iters: 700, epoch: 17 | loss: 0.2417212
	speed: 0.4561s/iter; left time: 1003.7720s
Epoch: 17 cost time: 327.46179819107056
Epoch: 17, Steps: 725 | Train Loss: 0.2480413 Vali Loss: 0.3713737 Test Loss: 0.4535657
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 18 | loss: 0.2429105
	speed: 0.8876s/iter; left time: 1842.6270s
	iters: 200, epoch: 18 | loss: 0.2412712
	speed: 0.4438s/iter; left time: 877.0338s
	iters: 300, epoch: 18 | loss: 0.2614614
	speed: 0.4336s/iter; left time: 813.4584s
	iters: 400, epoch: 18 | loss: 0.2578088
	speed: 0.4398s/iter; left time: 781.0094s
	iters: 500, epoch: 18 | loss: 0.2328479
	speed: 0.4491s/iter; left time: 752.6732s
	iters: 600, epoch: 18 | loss: 0.2605550
	speed: 0.4535s/iter; left time: 714.7474s
	iters: 700, epoch: 18 | loss: 0.2731461
	speed: 0.4533s/iter; left time: 669.0414s
Epoch: 18 cost time: 323.84986424446106
Epoch: 18, Steps: 725 | Train Loss: 0.2480331 Vali Loss: 0.3711991 Test Loss: 0.4535657
EarlyStopping counter: 3 out of 5
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 19 | loss: 0.2446130
	speed: 0.8872s/iter; left time: 1198.5453s
	iters: 200, epoch: 19 | loss: 0.2655246
	speed: 0.4497s/iter; left time: 562.5236s
	iters: 300, epoch: 19 | loss: 0.2544448
	speed: 0.4427s/iter; left time: 509.4987s
	iters: 400, epoch: 19 | loss: 0.2677415
	speed: 0.4458s/iter; left time: 468.5458s
	iters: 500, epoch: 19 | loss: 0.2805627
	speed: 0.4511s/iter; left time: 429.0171s
	iters: 600, epoch: 19 | loss: 0.2447587
	speed: 0.4420s/iter; left time: 376.1589s
	iters: 700, epoch: 19 | loss: 0.2595974
	speed: 0.4495s/iter; left time: 337.5921s
Epoch: 19 cost time: 324.4090859889984
Epoch: 19, Steps: 725 | Train Loss: 0.2480344 Vali Loss: 0.3711317 Test Loss: 0.4535654
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 20 | loss: 0.2457657
	speed: 0.8974s/iter; left time: 561.7519s
	iters: 200, epoch: 20 | loss: 0.2706490
	speed: 0.4599s/iter; left time: 241.9138s
	iters: 300, epoch: 20 | loss: 0.2269900
	speed: 0.4595s/iter; left time: 195.7386s
	iters: 400, epoch: 20 | loss: 0.2605878
	speed: 0.4468s/iter; left time: 145.6611s
	iters: 500, epoch: 20 | loss: 0.2629330
	speed: 0.4455s/iter; left time: 100.6791s
	iters: 600, epoch: 20 | loss: 0.2464325
	speed: 0.4487s/iter; left time: 56.5402s
	iters: 700, epoch: 20 | loss: 0.2505918
	speed: 0.4543s/iter; left time: 11.8110s
Epoch: 20 cost time: 328.58999609947205
Epoch: 20, Steps: 725 | Train Loss: 0.2480300 Vali Loss: 0.3709294 Test Loss: 0.4535651
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : traffic_336_336_DLinear_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed32598<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3173
mse:0.45259493589401245, mae:0.31229352951049805
