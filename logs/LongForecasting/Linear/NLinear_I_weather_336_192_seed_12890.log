Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='NLinear', model_id='weather_336_192', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=192, root_path='./dataset/', save_pred_values=False, seed=12890, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : weather_336_192_NLinear_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed12890>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36360
val 5079
test 10348
	iters: 100, epoch: 1 | loss: 33.6779823
	speed: 0.0138s/iter; left time: 627.2576s
	iters: 200, epoch: 1 | loss: 0.7159755
	speed: 0.0129s/iter; left time: 581.4627s
	iters: 300, epoch: 1 | loss: 1.0385333
	speed: 0.0149s/iter; left time: 672.8057s
	iters: 400, epoch: 1 | loss: 0.5818451
	speed: 0.0140s/iter; left time: 631.5622s
	iters: 500, epoch: 1 | loss: 0.6848454
	speed: 0.0135s/iter; left time: 607.0600s
	iters: 600, epoch: 1 | loss: 0.4802341
	speed: 0.0135s/iter; left time: 604.0652s
	iters: 700, epoch: 1 | loss: 0.4114760
	speed: 0.0124s/iter; left time: 554.8447s
	iters: 800, epoch: 1 | loss: 0.6414171
	speed: 0.0120s/iter; left time: 537.5867s
	iters: 900, epoch: 1 | loss: 1.1640639
	speed: 0.0122s/iter; left time: 544.0284s
	iters: 1000, epoch: 1 | loss: 0.6625417
	speed: 0.0140s/iter; left time: 623.1751s
	iters: 1100, epoch: 1 | loss: 0.6727754
	speed: 0.0121s/iter; left time: 538.2994s
	iters: 1200, epoch: 1 | loss: 0.5467864
	speed: 0.0149s/iter; left time: 658.0164s
	iters: 1300, epoch: 1 | loss: 0.4214402
	speed: 0.0138s/iter; left time: 607.8959s
	iters: 1400, epoch: 1 | loss: 0.5059257
	speed: 0.0134s/iter; left time: 591.9693s
	iters: 1500, epoch: 1 | loss: 0.7545784
	speed: 0.0128s/iter; left time: 562.2071s
	iters: 1600, epoch: 1 | loss: 0.8592798
	speed: 0.0111s/iter; left time: 487.6341s
	iters: 1700, epoch: 1 | loss: 0.5463144
	speed: 0.0140s/iter; left time: 611.5423s
	iters: 1800, epoch: 1 | loss: 0.7976640
	speed: 0.0161s/iter; left time: 700.6816s
	iters: 1900, epoch: 1 | loss: 4.9624491
	speed: 0.0155s/iter; left time: 676.7034s
	iters: 2000, epoch: 1 | loss: 1.1485608
	speed: 0.0154s/iter; left time: 669.7131s
	iters: 2100, epoch: 1 | loss: 5.0988269
	speed: 0.0140s/iter; left time: 606.4314s
	iters: 2200, epoch: 1 | loss: 0.5322084
	speed: 0.0142s/iter; left time: 614.2370s
Epoch: 1 cost time: 31.133947372436523
Epoch: 1, Steps: 2272 | Train Loss: 3.1988667 Vali Loss: 0.5860245 Test Loss: 0.2814654
Validation loss decreased (inf --> 0.586025).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 1.1557053
	speed: 0.0583s/iter; left time: 2509.3436s
	iters: 200, epoch: 2 | loss: 0.6429090
	speed: 0.0125s/iter; left time: 538.5438s
	iters: 300, epoch: 2 | loss: 0.6429130
	speed: 0.0126s/iter; left time: 540.2162s
	iters: 400, epoch: 2 | loss: 0.5165072
	speed: 0.0140s/iter; left time: 596.7683s
	iters: 500, epoch: 2 | loss: 1.4161394
	speed: 0.0133s/iter; left time: 569.4601s
	iters: 600, epoch: 2 | loss: 2.3801069
	speed: 0.0128s/iter; left time: 542.8668s
	iters: 700, epoch: 2 | loss: 0.4492745
	speed: 0.0142s/iter; left time: 601.4539s
	iters: 800, epoch: 2 | loss: 3.0442791
	speed: 0.0138s/iter; left time: 585.3867s
	iters: 900, epoch: 2 | loss: 0.5090703
	speed: 0.0124s/iter; left time: 524.0104s
	iters: 1000, epoch: 2 | loss: 0.4276814
	speed: 0.0156s/iter; left time: 656.2927s
	iters: 1100, epoch: 2 | loss: 0.4575429
	speed: 0.0146s/iter; left time: 614.3257s
	iters: 1200, epoch: 2 | loss: 0.6951781
	speed: 0.0150s/iter; left time: 631.3968s
	iters: 1300, epoch: 2 | loss: 0.4147016
	speed: 0.0143s/iter; left time: 598.4118s
	iters: 1400, epoch: 2 | loss: 1.0089498
	speed: 0.0116s/iter; left time: 485.3883s
	iters: 1500, epoch: 2 | loss: 1.8509465
	speed: 0.0122s/iter; left time: 508.4246s
	iters: 1600, epoch: 2 | loss: 1.8614618
	speed: 0.0144s/iter; left time: 596.6955s
	iters: 1700, epoch: 2 | loss: 2.2713637
	speed: 0.0150s/iter; left time: 623.7731s
	iters: 1800, epoch: 2 | loss: 1.3884846
	speed: 0.0146s/iter; left time: 604.5520s
	iters: 1900, epoch: 2 | loss: 1.5675946
	speed: 0.0126s/iter; left time: 520.4817s
	iters: 2000, epoch: 2 | loss: 0.7959490
	speed: 0.0132s/iter; left time: 544.7345s
	iters: 2100, epoch: 2 | loss: 3.0291018
	speed: 0.0141s/iter; left time: 580.5054s
	iters: 2200, epoch: 2 | loss: 0.6264377
	speed: 0.0131s/iter; left time: 538.3703s
Epoch: 2 cost time: 30.83817958831787
Epoch: 2, Steps: 2272 | Train Loss: 40.8616045 Vali Loss: 1.0973203 Test Loss: 0.2837432
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.7296463
	speed: 0.0547s/iter; left time: 2231.0753s
	iters: 200, epoch: 3 | loss: 0.4231490
	speed: 0.0135s/iter; left time: 551.1860s
	iters: 300, epoch: 3 | loss: 1.5357673
	speed: 0.0145s/iter; left time: 587.9507s
	iters: 400, epoch: 3 | loss: 1.6943524
	speed: 0.0134s/iter; left time: 544.0257s
	iters: 500, epoch: 3 | loss: 0.6682445
	speed: 0.0135s/iter; left time: 547.0636s
	iters: 600, epoch: 3 | loss: 0.5301537
	speed: 0.0136s/iter; left time: 549.9317s
	iters: 700, epoch: 3 | loss: 0.4140657
	speed: 0.0149s/iter; left time: 597.5545s
	iters: 800, epoch: 3 | loss: 0.6105672
	speed: 0.0134s/iter; left time: 537.0167s
	iters: 900, epoch: 3 | loss: 0.4381004
	speed: 0.0132s/iter; left time: 529.0232s
	iters: 1000, epoch: 3 | loss: 0.5430394
	speed: 0.0132s/iter; left time: 528.3203s
	iters: 1100, epoch: 3 | loss: 0.3525666
	speed: 0.0141s/iter; left time: 560.7964s
	iters: 1200, epoch: 3 | loss: 0.6394472
	speed: 0.0137s/iter; left time: 543.2512s
	iters: 1300, epoch: 3 | loss: 0.6123230
	speed: 0.0142s/iter; left time: 563.9116s
	iters: 1400, epoch: 3 | loss: 0.2551936
	speed: 0.0132s/iter; left time: 520.6561s
	iters: 1500, epoch: 3 | loss: 0.6479934
	speed: 0.0146s/iter; left time: 576.5509s
	iters: 1600, epoch: 3 | loss: 0.3555627
	speed: 0.0152s/iter; left time: 596.9460s
	iters: 1700, epoch: 3 | loss: 1.4500837
	speed: 0.0135s/iter; left time: 528.5738s
	iters: 1800, epoch: 3 | loss: 0.3054543
	speed: 0.0122s/iter; left time: 476.3037s
	iters: 1900, epoch: 3 | loss: 0.3994606
	speed: 0.0141s/iter; left time: 550.3010s
	iters: 2000, epoch: 3 | loss: 0.3676656
	speed: 0.0136s/iter; left time: 529.2085s
	iters: 2100, epoch: 3 | loss: 0.3841042
	speed: 0.0145s/iter; left time: 562.5897s
	iters: 2200, epoch: 3 | loss: 0.4125451
	speed: 0.0117s/iter; left time: 451.3013s
Epoch: 3 cost time: 30.951042413711548
Epoch: 3, Steps: 2272 | Train Loss: 37.6775069 Vali Loss: 0.5020395 Test Loss: 0.2080873
Validation loss decreased (0.586025 --> 0.502039).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.3588607
	speed: 0.0499s/iter; left time: 1922.4883s
	iters: 200, epoch: 4 | loss: 1.3225143
	speed: 0.0152s/iter; left time: 583.8968s
	iters: 300, epoch: 4 | loss: 0.3802764
	speed: 0.0138s/iter; left time: 529.7503s
	iters: 400, epoch: 4 | loss: 0.4141994
	speed: 0.0134s/iter; left time: 510.9638s
	iters: 500, epoch: 4 | loss: 0.4436158
	speed: 0.0143s/iter; left time: 546.4398s
	iters: 600, epoch: 4 | loss: 2.1558654
	speed: 0.0156s/iter; left time: 591.9099s
	iters: 700, epoch: 4 | loss: 0.3703778
	speed: 0.0144s/iter; left time: 547.0718s
	iters: 800, epoch: 4 | loss: 0.3989432
	speed: 0.0146s/iter; left time: 550.9162s
	iters: 900, epoch: 4 | loss: 0.3073644
	speed: 0.0149s/iter; left time: 561.3786s
	iters: 1000, epoch: 4 | loss: 0.6564841
	speed: 0.0151s/iter; left time: 567.5209s
	iters: 1100, epoch: 4 | loss: 0.4518544
	speed: 0.0147s/iter; left time: 550.6170s
	iters: 1200, epoch: 4 | loss: 0.4770276
	speed: 0.0151s/iter; left time: 566.7158s
	iters: 1300, epoch: 4 | loss: 2.7854087
	speed: 0.0142s/iter; left time: 531.6511s
	iters: 1400, epoch: 4 | loss: 0.6970108
	speed: 0.0144s/iter; left time: 536.8315s
	iters: 1500, epoch: 4 | loss: 1.6371913
	speed: 0.0129s/iter; left time: 478.0329s
	iters: 1600, epoch: 4 | loss: 0.5642568
	speed: 0.0113s/iter; left time: 419.9474s
	iters: 1700, epoch: 4 | loss: 0.3509787
	speed: 0.0117s/iter; left time: 433.1903s
	iters: 1800, epoch: 4 | loss: 0.5598022
	speed: 0.0128s/iter; left time: 469.9560s
	iters: 1900, epoch: 4 | loss: 0.5069650
	speed: 0.0149s/iter; left time: 548.8683s
	iters: 2000, epoch: 4 | loss: 0.5010917
	speed: 0.0148s/iter; left time: 542.1474s
	iters: 2100, epoch: 4 | loss: 0.5427660
	speed: 0.0134s/iter; left time: 490.7278s
	iters: 2200, epoch: 4 | loss: 1.1377313
	speed: 0.0145s/iter; left time: 528.2025s
Epoch: 4 cost time: 31.75196886062622
Epoch: 4, Steps: 2272 | Train Loss: 2.9114955 Vali Loss: 0.5249347 Test Loss: 0.2009654
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.6548622
	speed: 0.0559s/iter; left time: 2026.7657s
	iters: 200, epoch: 5 | loss: 0.7408833
	speed: 0.0147s/iter; left time: 531.1612s
	iters: 300, epoch: 5 | loss: 0.4389651
	speed: 0.0137s/iter; left time: 493.9922s
	iters: 400, epoch: 5 | loss: 0.9385900
	speed: 0.0130s/iter; left time: 468.6302s
	iters: 500, epoch: 5 | loss: 2.0545087
	speed: 0.0145s/iter; left time: 520.6537s
	iters: 600, epoch: 5 | loss: 0.4244063
	speed: 0.0150s/iter; left time: 535.3603s
	iters: 700, epoch: 5 | loss: 1.2120267
	speed: 0.0139s/iter; left time: 493.8227s
	iters: 800, epoch: 5 | loss: 0.2896927
	speed: 0.0136s/iter; left time: 482.1562s
	iters: 900, epoch: 5 | loss: 0.8436292
	speed: 0.0147s/iter; left time: 522.3999s
	iters: 1000, epoch: 5 | loss: 0.4999630
	speed: 0.0153s/iter; left time: 542.0170s
	iters: 1100, epoch: 5 | loss: 0.3619002
	speed: 0.0137s/iter; left time: 481.3369s
	iters: 1200, epoch: 5 | loss: 0.5367140
	speed: 0.0143s/iter; left time: 500.9632s
	iters: 1300, epoch: 5 | loss: 0.3982655
	speed: 0.0146s/iter; left time: 512.6130s
	iters: 1400, epoch: 5 | loss: 0.3257139
	speed: 0.0154s/iter; left time: 538.2675s
	iters: 1500, epoch: 5 | loss: 0.4616083
	speed: 0.0149s/iter; left time: 517.7165s
	iters: 1600, epoch: 5 | loss: 0.4684100
	speed: 0.0120s/iter; left time: 415.6908s
	iters: 1700, epoch: 5 | loss: 0.4299797
	speed: 0.0136s/iter; left time: 472.5393s
	iters: 1800, epoch: 5 | loss: 0.5270309
	speed: 0.0121s/iter; left time: 419.0724s
	iters: 1900, epoch: 5 | loss: 0.6326894
	speed: 0.0140s/iter; left time: 480.7247s
	iters: 2000, epoch: 5 | loss: 0.5135005
	speed: 0.0135s/iter; left time: 462.0891s
	iters: 2100, epoch: 5 | loss: 0.2595686
	speed: 0.0130s/iter; left time: 446.4579s
	iters: 2200, epoch: 5 | loss: 0.2786999
	speed: 0.0114s/iter; left time: 390.4613s
Epoch: 5 cost time: 31.175037622451782
Epoch: 5, Steps: 2272 | Train Loss: 0.9879804 Vali Loss: 0.4716517 Test Loss: 0.1969249
Validation loss decreased (0.502039 --> 0.471652).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.3761050
	speed: 0.0539s/iter; left time: 1830.4148s
	iters: 200, epoch: 6 | loss: 0.4029384
	speed: 0.0138s/iter; left time: 466.2566s
	iters: 300, epoch: 6 | loss: 0.5659019
	speed: 0.0139s/iter; left time: 469.3917s
	iters: 400, epoch: 6 | loss: 0.4281711
	speed: 0.0121s/iter; left time: 406.6127s
	iters: 500, epoch: 6 | loss: 0.3110181
	speed: 0.0137s/iter; left time: 459.4599s
	iters: 600, epoch: 6 | loss: 0.4392879
	speed: 0.0146s/iter; left time: 489.0478s
	iters: 700, epoch: 6 | loss: 0.3265347
	speed: 0.0125s/iter; left time: 418.6403s
	iters: 800, epoch: 6 | loss: 0.3684313
	speed: 0.0134s/iter; left time: 444.9493s
	iters: 900, epoch: 6 | loss: 1.1853510
	speed: 0.0137s/iter; left time: 454.0468s
	iters: 1000, epoch: 6 | loss: 0.6635588
	speed: 0.0141s/iter; left time: 467.8503s
	iters: 1100, epoch: 6 | loss: 0.2958637
	speed: 0.0149s/iter; left time: 492.8770s
	iters: 1200, epoch: 6 | loss: 0.3772198
	speed: 0.0147s/iter; left time: 484.7362s
	iters: 1300, epoch: 6 | loss: 0.5714154
	speed: 0.0145s/iter; left time: 474.9324s
	iters: 1400, epoch: 6 | loss: 0.2244466
	speed: 0.0144s/iter; left time: 469.0646s
	iters: 1500, epoch: 6 | loss: 0.4812393
	speed: 0.0134s/iter; left time: 435.3271s
	iters: 1600, epoch: 6 | loss: 0.2440191
	speed: 0.0139s/iter; left time: 451.3523s
	iters: 1700, epoch: 6 | loss: 0.3926513
	speed: 0.0149s/iter; left time: 482.8675s
	iters: 1800, epoch: 6 | loss: 0.3183909
	speed: 0.0133s/iter; left time: 429.1535s
	iters: 1900, epoch: 6 | loss: 0.3076974
	speed: 0.0141s/iter; left time: 452.8562s
	iters: 2000, epoch: 6 | loss: 0.4157556
	speed: 0.0139s/iter; left time: 445.3131s
	iters: 2100, epoch: 6 | loss: 1.2916969
	speed: 0.0146s/iter; left time: 466.7343s
	iters: 2200, epoch: 6 | loss: 0.4044926
	speed: 0.0135s/iter; left time: 431.4264s
Epoch: 6 cost time: 31.43976330757141
Epoch: 6, Steps: 2272 | Train Loss: 0.6469203 Vali Loss: 0.4561394 Test Loss: 0.1899277
Validation loss decreased (0.471652 --> 0.456139).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.3330988
	speed: 0.0574s/iter; left time: 1818.6455s
	iters: 200, epoch: 7 | loss: 0.4580794
	speed: 0.0144s/iter; left time: 453.9861s
	iters: 300, epoch: 7 | loss: 0.4390044
	speed: 0.0132s/iter; left time: 414.5124s
	iters: 400, epoch: 7 | loss: 0.4746739
	speed: 0.0119s/iter; left time: 374.8131s
	iters: 500, epoch: 7 | loss: 1.5600625
	speed: 0.0136s/iter; left time: 426.4593s
	iters: 600, epoch: 7 | loss: 0.2701212
	speed: 0.0134s/iter; left time: 417.1587s
	iters: 700, epoch: 7 | loss: 0.3879923
	speed: 0.0135s/iter; left time: 418.7642s
	iters: 800, epoch: 7 | loss: 0.3757967
	speed: 0.0136s/iter; left time: 420.8287s
	iters: 900, epoch: 7 | loss: 0.5200825
	speed: 0.0151s/iter; left time: 465.4251s
	iters: 1000, epoch: 7 | loss: 0.2985431
	speed: 0.0134s/iter; left time: 411.3445s
	iters: 1100, epoch: 7 | loss: 0.3409531
	speed: 0.0142s/iter; left time: 435.3281s
	iters: 1200, epoch: 7 | loss: 0.2725362
	speed: 0.0143s/iter; left time: 438.3908s
	iters: 1300, epoch: 7 | loss: 0.8461061
	speed: 0.0144s/iter; left time: 438.9600s
	iters: 1400, epoch: 7 | loss: 0.3290704
	speed: 0.0140s/iter; left time: 426.7987s
	iters: 1500, epoch: 7 | loss: 0.2521548
	speed: 0.0146s/iter; left time: 442.6147s
	iters: 1600, epoch: 7 | loss: 0.2626682
	speed: 0.0158s/iter; left time: 477.6866s
	iters: 1700, epoch: 7 | loss: 0.4322012
	speed: 0.0147s/iter; left time: 442.6144s
	iters: 1800, epoch: 7 | loss: 0.2047373
	speed: 0.0140s/iter; left time: 419.9375s
	iters: 1900, epoch: 7 | loss: 0.3199500
	speed: 0.0117s/iter; left time: 349.0962s
	iters: 2000, epoch: 7 | loss: 0.3627782
	speed: 0.0135s/iter; left time: 402.3388s
	iters: 2100, epoch: 7 | loss: 0.3142114
	speed: 0.0128s/iter; left time: 379.4941s
	iters: 2200, epoch: 7 | loss: 0.3993895
	speed: 0.0119s/iter; left time: 352.6581s
Epoch: 7 cost time: 31.232460498809814
Epoch: 7, Steps: 2272 | Train Loss: 0.5896931 Vali Loss: 0.4563150 Test Loss: 0.1881517
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.5040229
	speed: 0.0584s/iter; left time: 1719.5754s
	iters: 200, epoch: 8 | loss: 0.4273040
	speed: 0.0144s/iter; left time: 422.2576s
	iters: 300, epoch: 8 | loss: 0.2470162
	speed: 0.0137s/iter; left time: 401.2846s
	iters: 400, epoch: 8 | loss: 0.5091196
	speed: 0.0155s/iter; left time: 452.3394s
	iters: 500, epoch: 8 | loss: 0.3398218
	speed: 0.0140s/iter; left time: 405.1496s
	iters: 600, epoch: 8 | loss: 0.3375188
	speed: 0.0153s/iter; left time: 443.1313s
	iters: 700, epoch: 8 | loss: 0.2400507
	speed: 0.0119s/iter; left time: 341.7838s
	iters: 800, epoch: 8 | loss: 0.3123574
	speed: 0.0133s/iter; left time: 381.9881s
	iters: 900, epoch: 8 | loss: 0.2870058
	speed: 0.0144s/iter; left time: 412.5229s
	iters: 1000, epoch: 8 | loss: 1.0167699
	speed: 0.0133s/iter; left time: 379.6282s
	iters: 1100, epoch: 8 | loss: 0.3713959
	speed: 0.0149s/iter; left time: 424.9679s
	iters: 1200, epoch: 8 | loss: 0.2905565
	speed: 0.0140s/iter; left time: 396.4276s
	iters: 1300, epoch: 8 | loss: 0.4052483
	speed: 0.0147s/iter; left time: 416.4555s
	iters: 1400, epoch: 8 | loss: 0.2992021
	speed: 0.0135s/iter; left time: 379.3186s
	iters: 1500, epoch: 8 | loss: 0.3175756
	speed: 0.0130s/iter; left time: 363.1534s
	iters: 1600, epoch: 8 | loss: 0.2883716
	speed: 0.0140s/iter; left time: 390.9522s
	iters: 1700, epoch: 8 | loss: 0.3217607
	speed: 0.0143s/iter; left time: 398.6608s
	iters: 1800, epoch: 8 | loss: 0.4492380
	speed: 0.0138s/iter; left time: 382.5301s
	iters: 1900, epoch: 8 | loss: 0.2802173
	speed: 0.0141s/iter; left time: 389.7954s
	iters: 2000, epoch: 8 | loss: 0.3276088
	speed: 0.0136s/iter; left time: 375.6253s
	iters: 2100, epoch: 8 | loss: 0.4330059
	speed: 0.0120s/iter; left time: 329.0476s
	iters: 2200, epoch: 8 | loss: 1.2704967
	speed: 0.0137s/iter; left time: 374.0721s
Epoch: 8 cost time: 31.512492179870605
Epoch: 8, Steps: 2272 | Train Loss: 0.5527852 Vali Loss: 0.4498275 Test Loss: 0.1879935
Validation loss decreased (0.456139 --> 0.449827).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.2717444
	speed: 0.0510s/iter; left time: 1386.2249s
	iters: 200, epoch: 9 | loss: 0.4112456
	speed: 0.0133s/iter; left time: 360.8029s
	iters: 300, epoch: 9 | loss: 0.3311083
	speed: 0.0136s/iter; left time: 366.0138s
	iters: 400, epoch: 9 | loss: 0.2706161
	speed: 0.0141s/iter; left time: 377.6424s
	iters: 500, epoch: 9 | loss: 0.2559999
	speed: 0.0156s/iter; left time: 417.8654s
	iters: 600, epoch: 9 | loss: 0.5092574
	speed: 0.0155s/iter; left time: 413.1550s
	iters: 700, epoch: 9 | loss: 1.4913179
	speed: 0.0141s/iter; left time: 373.2869s
	iters: 800, epoch: 9 | loss: 1.0275236
	speed: 0.0112s/iter; left time: 295.2183s
	iters: 900, epoch: 9 | loss: 0.1917462
	speed: 0.0128s/iter; left time: 336.9862s
	iters: 1000, epoch: 9 | loss: 0.3162728
	speed: 0.0130s/iter; left time: 341.2381s
	iters: 1100, epoch: 9 | loss: 0.6465738
	speed: 0.0126s/iter; left time: 328.4161s
	iters: 1200, epoch: 9 | loss: 0.2903914
	speed: 0.0129s/iter; left time: 335.8829s
	iters: 1300, epoch: 9 | loss: 0.9409325
	speed: 0.0147s/iter; left time: 381.2032s
	iters: 1400, epoch: 9 | loss: 0.3992588
	speed: 0.0147s/iter; left time: 379.3623s
	iters: 1500, epoch: 9 | loss: 1.1866659
	speed: 0.0139s/iter; left time: 358.0844s
	iters: 1600, epoch: 9 | loss: 0.3234695
	speed: 0.0131s/iter; left time: 335.7444s
	iters: 1700, epoch: 9 | loss: 0.4042874
	speed: 0.0132s/iter; left time: 338.3258s
	iters: 1800, epoch: 9 | loss: 0.3415077
	speed: 0.0148s/iter; left time: 376.9600s
	iters: 1900, epoch: 9 | loss: 0.3289608
	speed: 0.0141s/iter; left time: 358.3158s
	iters: 2000, epoch: 9 | loss: 1.3687173
	speed: 0.0124s/iter; left time: 314.3153s
	iters: 2100, epoch: 9 | loss: 0.5138825
	speed: 0.0126s/iter; left time: 318.2195s
	iters: 2200, epoch: 9 | loss: 0.3240197
	speed: 0.0114s/iter; left time: 285.9621s
Epoch: 9 cost time: 30.638752460479736
Epoch: 9, Steps: 2272 | Train Loss: 0.5395402 Vali Loss: 0.4491152 Test Loss: 0.1867887
Validation loss decreased (0.449827 --> 0.449115).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.4260032
	speed: 0.0572s/iter; left time: 1423.5860s
	iters: 200, epoch: 10 | loss: 0.4720634
	speed: 0.0145s/iter; left time: 359.8029s
	iters: 300, epoch: 10 | loss: 0.5462965
	speed: 0.0119s/iter; left time: 292.7317s
	iters: 400, epoch: 10 | loss: 1.1521540
	speed: 0.0129s/iter; left time: 318.0121s
	iters: 500, epoch: 10 | loss: 0.2758109
	speed: 0.0140s/iter; left time: 343.4558s
	iters: 600, epoch: 10 | loss: 1.9191439
	speed: 0.0137s/iter; left time: 334.5327s
	iters: 700, epoch: 10 | loss: 0.4182957
	speed: 0.0143s/iter; left time: 347.6423s
	iters: 800, epoch: 10 | loss: 1.3651217
	speed: 0.0152s/iter; left time: 367.6038s
	iters: 900, epoch: 10 | loss: 0.4318329
	speed: 0.0143s/iter; left time: 345.5226s
	iters: 1000, epoch: 10 | loss: 0.4850023
	speed: 0.0126s/iter; left time: 302.5848s
	iters: 1100, epoch: 10 | loss: 0.3028340
	speed: 0.0136s/iter; left time: 325.0832s
	iters: 1200, epoch: 10 | loss: 0.3278948
	speed: 0.0125s/iter; left time: 296.9656s
	iters: 1300, epoch: 10 | loss: 0.6832628
	speed: 0.0129s/iter; left time: 306.3729s
	iters: 1400, epoch: 10 | loss: 1.2753148
	speed: 0.0123s/iter; left time: 289.9844s
	iters: 1500, epoch: 10 | loss: 0.4283004
	speed: 0.0140s/iter; left time: 329.0048s
	iters: 1600, epoch: 10 | loss: 0.7293478
	speed: 0.0138s/iter; left time: 322.8892s
	iters: 1700, epoch: 10 | loss: 0.3558477
	speed: 0.0153s/iter; left time: 356.9645s
	iters: 1800, epoch: 10 | loss: 0.4416808
	speed: 0.0132s/iter; left time: 306.9069s
	iters: 1900, epoch: 10 | loss: 0.3423868
	speed: 0.0139s/iter; left time: 321.9686s
	iters: 2000, epoch: 10 | loss: 0.3195305
	speed: 0.0145s/iter; left time: 333.2899s
	iters: 2100, epoch: 10 | loss: 0.4925341
	speed: 0.0127s/iter; left time: 291.0215s
	iters: 2200, epoch: 10 | loss: 1.2816473
	speed: 0.0123s/iter; left time: 280.3590s
Epoch: 10 cost time: 30.760285139083862
Epoch: 10, Steps: 2272 | Train Loss: 0.5340026 Vali Loss: 0.4500889 Test Loss: 0.1865320
EarlyStopping counter: 1 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.4019364
	speed: 0.0617s/iter; left time: 1396.7157s
	iters: 200, epoch: 11 | loss: 0.4984616
	speed: 0.0151s/iter; left time: 339.1917s
	iters: 300, epoch: 11 | loss: 0.3506743
	speed: 0.0143s/iter; left time: 320.9396s
	iters: 400, epoch: 11 | loss: 0.3739980
	speed: 0.0135s/iter; left time: 300.9313s
	iters: 500, epoch: 11 | loss: 0.6304453
	speed: 0.0147s/iter; left time: 326.6792s
	iters: 600, epoch: 11 | loss: 0.2837181
	speed: 0.0146s/iter; left time: 322.8333s
	iters: 700, epoch: 11 | loss: 0.3532657
	speed: 0.0142s/iter; left time: 312.1119s
	iters: 800, epoch: 11 | loss: 0.5080719
	speed: 0.0133s/iter; left time: 292.5809s
	iters: 900, epoch: 11 | loss: 0.2760489
	speed: 0.0152s/iter; left time: 330.7407s
	iters: 1000, epoch: 11 | loss: 0.3712359
	speed: 0.0139s/iter; left time: 302.5634s
	iters: 1100, epoch: 11 | loss: 0.8171366
	speed: 0.0152s/iter; left time: 329.7133s
	iters: 1200, epoch: 11 | loss: 0.3469382
	speed: 0.0139s/iter; left time: 298.5353s
	iters: 1300, epoch: 11 | loss: 0.3491950
	speed: 0.0147s/iter; left time: 315.0274s
	iters: 1400, epoch: 11 | loss: 0.2719328
	speed: 0.0138s/iter; left time: 293.4485s
	iters: 1500, epoch: 11 | loss: 0.3243264
	speed: 0.0147s/iter; left time: 312.8979s
	iters: 1600, epoch: 11 | loss: 0.4349764
	speed: 0.0115s/iter; left time: 243.5665s
	iters: 1700, epoch: 11 | loss: 0.4210533
	speed: 0.0116s/iter; left time: 243.2562s
	iters: 1800, epoch: 11 | loss: 0.3124588
	speed: 0.0115s/iter; left time: 239.9429s
	iters: 1900, epoch: 11 | loss: 1.0012906
	speed: 0.0124s/iter; left time: 257.3989s
	iters: 2000, epoch: 11 | loss: 0.5024609
	speed: 0.0141s/iter; left time: 292.0305s
	iters: 2100, epoch: 11 | loss: 1.1600678
	speed: 0.0121s/iter; left time: 249.1602s
	iters: 2200, epoch: 11 | loss: 1.1663997
	speed: 0.0123s/iter; left time: 251.3864s
Epoch: 11 cost time: 31.00584602355957
Epoch: 11, Steps: 2272 | Train Loss: 0.5326641 Vali Loss: 0.4479527 Test Loss: 0.1868312
Validation loss decreased (0.449115 --> 0.447953).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.2637278
	speed: 0.0540s/iter; left time: 1098.0605s
	iters: 200, epoch: 12 | loss: 0.3087996
	speed: 0.0154s/iter; left time: 312.6788s
	iters: 300, epoch: 12 | loss: 0.3567584
	speed: 0.0150s/iter; left time: 302.5686s
	iters: 400, epoch: 12 | loss: 0.3123137
	speed: 0.0145s/iter; left time: 289.7353s
	iters: 500, epoch: 12 | loss: 0.4777696
	speed: 0.0146s/iter; left time: 291.9459s
	iters: 600, epoch: 12 | loss: 0.2896520
	speed: 0.0144s/iter; left time: 285.2779s
	iters: 700, epoch: 12 | loss: 0.4616668
	speed: 0.0135s/iter; left time: 267.1784s
	iters: 800, epoch: 12 | loss: 0.5360524
	speed: 0.0147s/iter; left time: 287.9564s
	iters: 900, epoch: 12 | loss: 0.2969675
	speed: 0.0124s/iter; left time: 242.4413s
	iters: 1000, epoch: 12 | loss: 0.5557953
	speed: 0.0123s/iter; left time: 238.2671s
	iters: 1100, epoch: 12 | loss: 1.3607967
	speed: 0.0106s/iter; left time: 204.7309s
	iters: 1200, epoch: 12 | loss: 0.4142223
	speed: 0.0131s/iter; left time: 251.6420s
	iters: 1300, epoch: 12 | loss: 0.5749527
	speed: 0.0112s/iter; left time: 214.9081s
	iters: 1400, epoch: 12 | loss: 0.3678444
	speed: 0.0152s/iter; left time: 289.5682s
	iters: 1500, epoch: 12 | loss: 0.3172716
	speed: 0.0143s/iter; left time: 270.3436s
	iters: 1600, epoch: 12 | loss: 0.3736478
	speed: 0.0136s/iter; left time: 256.0007s
	iters: 1700, epoch: 12 | loss: 0.6758937
	speed: 0.0129s/iter; left time: 242.3806s
	iters: 1800, epoch: 12 | loss: 0.3027768
	speed: 0.0141s/iter; left time: 262.8386s
	iters: 1900, epoch: 12 | loss: 0.3247586
	speed: 0.0131s/iter; left time: 243.5878s
	iters: 2000, epoch: 12 | loss: 0.4091467
	speed: 0.0128s/iter; left time: 236.3555s
	iters: 2100, epoch: 12 | loss: 0.2493645
	speed: 0.0132s/iter; left time: 243.0059s
	iters: 2200, epoch: 12 | loss: 0.3219003
	speed: 0.0131s/iter; left time: 239.8406s
Epoch: 12 cost time: 30.71828818321228
Epoch: 12, Steps: 2272 | Train Loss: 0.5320344 Vali Loss: 0.4484246 Test Loss: 0.1865039
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.3944008
	speed: 0.0570s/iter; left time: 1029.5674s
	iters: 200, epoch: 13 | loss: 0.3282121
	speed: 0.0143s/iter; left time: 256.5663s
	iters: 300, epoch: 13 | loss: 0.1660976
	speed: 0.0137s/iter; left time: 245.1315s
	iters: 400, epoch: 13 | loss: 0.3149181
	speed: 0.0130s/iter; left time: 231.3219s
	iters: 500, epoch: 13 | loss: 0.4105815
	speed: 0.0147s/iter; left time: 260.4075s
	iters: 600, epoch: 13 | loss: 0.3427486
	speed: 0.0132s/iter; left time: 232.8100s
	iters: 700, epoch: 13 | loss: 0.3267359
	speed: 0.0137s/iter; left time: 238.7870s
	iters: 800, epoch: 13 | loss: 0.3631681
	speed: 0.0133s/iter; left time: 230.7947s
	iters: 900, epoch: 13 | loss: 2.2139482
	speed: 0.0141s/iter; left time: 244.3925s
	iters: 1000, epoch: 13 | loss: 0.3208463
	speed: 0.0113s/iter; left time: 193.2714s
	iters: 1100, epoch: 13 | loss: 0.2934536
	speed: 0.0148s/iter; left time: 251.9394s
	iters: 1200, epoch: 13 | loss: 0.6757896
	speed: 0.0133s/iter; left time: 225.5307s
	iters: 1300, epoch: 13 | loss: 0.4990926
	speed: 0.0144s/iter; left time: 242.5616s
	iters: 1400, epoch: 13 | loss: 0.5034138
	speed: 0.0134s/iter; left time: 225.1949s
	iters: 1500, epoch: 13 | loss: 0.3563922
	speed: 0.0146s/iter; left time: 243.0641s
	iters: 1600, epoch: 13 | loss: 0.3083979
	speed: 0.0138s/iter; left time: 229.4516s
	iters: 1700, epoch: 13 | loss: 0.7568370
	speed: 0.0144s/iter; left time: 237.5091s
	iters: 1800, epoch: 13 | loss: 0.4822667
	speed: 0.0153s/iter; left time: 251.0787s
	iters: 1900, epoch: 13 | loss: 0.2567937
	speed: 0.0127s/iter; left time: 205.9263s
	iters: 2000, epoch: 13 | loss: 0.3554704
	speed: 0.0115s/iter; left time: 186.1847s
	iters: 2100, epoch: 13 | loss: 0.4885261
	speed: 0.0119s/iter; left time: 191.8541s
	iters: 2200, epoch: 13 | loss: 0.4545610
	speed: 0.0111s/iter; left time: 176.9082s
Epoch: 13 cost time: 30.426755666732788
Epoch: 13, Steps: 2272 | Train Loss: 0.5316323 Vali Loss: 0.4483413 Test Loss: 0.1867278
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.3376552
	speed: 0.0506s/iter; left time: 800.4376s
	iters: 200, epoch: 14 | loss: 1.3790370
	speed: 0.0158s/iter; left time: 247.5953s
	iters: 300, epoch: 14 | loss: 0.3247987
	speed: 0.0158s/iter; left time: 246.1097s
	iters: 400, epoch: 14 | loss: 0.8290551
	speed: 0.0141s/iter; left time: 219.2956s
	iters: 500, epoch: 14 | loss: 0.2840241
	speed: 0.0135s/iter; left time: 207.3805s
	iters: 600, epoch: 14 | loss: 1.2842581
	speed: 0.0139s/iter; left time: 212.4684s
	iters: 700, epoch: 14 | loss: 1.3271071
	speed: 0.0135s/iter; left time: 204.7466s
	iters: 800, epoch: 14 | loss: 0.4554608
	speed: 0.0143s/iter; left time: 215.6965s
	iters: 900, epoch: 14 | loss: 0.2627276
	speed: 0.0130s/iter; left time: 194.6501s
	iters: 1000, epoch: 14 | loss: 1.2315834
	speed: 0.0151s/iter; left time: 225.5668s
	iters: 1100, epoch: 14 | loss: 0.5615763
	speed: 0.0139s/iter; left time: 205.5040s
	iters: 1200, epoch: 14 | loss: 0.4457288
	speed: 0.0148s/iter; left time: 217.2577s
	iters: 1300, epoch: 14 | loss: 0.2282161
	speed: 0.0131s/iter; left time: 191.7809s
	iters: 1400, epoch: 14 | loss: 0.2747879
	speed: 0.0135s/iter; left time: 196.2807s
	iters: 1500, epoch: 14 | loss: 0.5307015
	speed: 0.0154s/iter; left time: 222.0435s
	iters: 1600, epoch: 14 | loss: 0.3576357
	speed: 0.0133s/iter; left time: 190.7208s
	iters: 1700, epoch: 14 | loss: 0.5443044
	speed: 0.0130s/iter; left time: 184.7292s
	iters: 1800, epoch: 14 | loss: 0.3886658
	speed: 0.0114s/iter; left time: 160.2541s
	iters: 1900, epoch: 14 | loss: 0.2726634
	speed: 0.0133s/iter; left time: 185.8868s
	iters: 2000, epoch: 14 | loss: 0.2245043
	speed: 0.0127s/iter; left time: 177.0954s
	iters: 2100, epoch: 14 | loss: 0.7638726
	speed: 0.0144s/iter; left time: 198.5948s
	iters: 2200, epoch: 14 | loss: 0.3187456
	speed: 0.0130s/iter; left time: 177.7208s
Epoch: 14 cost time: 31.387282371520996
Epoch: 14, Steps: 2272 | Train Loss: 0.5314185 Vali Loss: 0.4480990 Test Loss: 0.1866015
EarlyStopping counter: 3 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.3563016
	speed: 0.0557s/iter; left time: 753.8505s
	iters: 200, epoch: 15 | loss: 0.3861325
	speed: 0.0145s/iter; left time: 194.9178s
	iters: 300, epoch: 15 | loss: 0.3373898
	speed: 0.0120s/iter; left time: 159.3648s
	iters: 400, epoch: 15 | loss: 1.9380522
	speed: 0.0139s/iter; left time: 184.4170s
	iters: 500, epoch: 15 | loss: 0.4174412
	speed: 0.0152s/iter; left time: 200.1732s
	iters: 600, epoch: 15 | loss: 0.4602571
	speed: 0.0146s/iter; left time: 190.0894s
	iters: 700, epoch: 15 | loss: 0.2242679
	speed: 0.0108s/iter; left time: 139.4580s
	iters: 800, epoch: 15 | loss: 0.2087432
	speed: 0.0139s/iter; left time: 178.1415s
	iters: 900, epoch: 15 | loss: 1.3435034
	speed: 0.0141s/iter; left time: 180.1640s
	iters: 1000, epoch: 15 | loss: 0.4534540
	speed: 0.0145s/iter; left time: 182.5627s
	iters: 1100, epoch: 15 | loss: 0.2106348
	speed: 0.0129s/iter; left time: 161.9391s
	iters: 1200, epoch: 15 | loss: 0.3024590
	speed: 0.0133s/iter; left time: 164.9701s
	iters: 1300, epoch: 15 | loss: 0.3991264
	speed: 0.0132s/iter; left time: 162.2115s
	iters: 1400, epoch: 15 | loss: 0.3993914
	speed: 0.0139s/iter; left time: 169.5847s
	iters: 1500, epoch: 15 | loss: 0.3091298
	speed: 0.0136s/iter; left time: 165.5474s
	iters: 1600, epoch: 15 | loss: 1.3785068
	speed: 0.0119s/iter; left time: 142.8373s
	iters: 1700, epoch: 15 | loss: 0.3445145
	speed: 0.0141s/iter; left time: 168.2858s
	iters: 1800, epoch: 15 | loss: 0.3321078
	speed: 0.0146s/iter; left time: 172.8378s
	iters: 1900, epoch: 15 | loss: 0.8104425
	speed: 0.0138s/iter; left time: 162.1738s
	iters: 2000, epoch: 15 | loss: 0.7006131
	speed: 0.0137s/iter; left time: 159.4022s
	iters: 2100, epoch: 15 | loss: 0.3995207
	speed: 0.0127s/iter; left time: 146.7161s
	iters: 2200, epoch: 15 | loss: 0.4226280
	speed: 0.0128s/iter; left time: 145.7733s
Epoch: 15 cost time: 30.63739275932312
Epoch: 15, Steps: 2272 | Train Loss: 0.5313452 Vali Loss: 0.4480698 Test Loss: 0.1866355
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.6589754
	speed: 0.0565s/iter; left time: 636.4168s
	iters: 200, epoch: 16 | loss: 0.3904279
	speed: 0.0147s/iter; left time: 164.0857s
	iters: 300, epoch: 16 | loss: 0.3205298
	speed: 0.0131s/iter; left time: 144.9200s
	iters: 400, epoch: 16 | loss: 0.3319829
	speed: 0.0124s/iter; left time: 136.2963s
	iters: 500, epoch: 16 | loss: 1.5442977
	speed: 0.0144s/iter; left time: 156.3926s
	iters: 600, epoch: 16 | loss: 0.3090781
	speed: 0.0147s/iter; left time: 158.6943s
	iters: 700, epoch: 16 | loss: 0.3071422
	speed: 0.0134s/iter; left time: 142.3520s
	iters: 800, epoch: 16 | loss: 0.3350923
	speed: 0.0137s/iter; left time: 144.5216s
	iters: 900, epoch: 16 | loss: 0.3881803
	speed: 0.0152s/iter; left time: 158.9850s
	iters: 1000, epoch: 16 | loss: 0.2492719
	speed: 0.0147s/iter; left time: 152.6438s
	iters: 1100, epoch: 16 | loss: 0.4367586
	speed: 0.0142s/iter; left time: 145.2582s
	iters: 1200, epoch: 16 | loss: 0.2823373
	speed: 0.0150s/iter; left time: 152.5450s
	iters: 1300, epoch: 16 | loss: 0.4469230
	speed: 0.0152s/iter; left time: 152.5951s
	iters: 1400, epoch: 16 | loss: 0.3507681
	speed: 0.0150s/iter; left time: 149.5973s
	iters: 1500, epoch: 16 | loss: 0.3277630
	speed: 0.0141s/iter; left time: 138.7341s
	iters: 1600, epoch: 16 | loss: 1.1674867
	speed: 0.0141s/iter; left time: 137.6854s
	iters: 1700, epoch: 16 | loss: 0.4484375
	speed: 0.0152s/iter; left time: 147.0992s
	iters: 1800, epoch: 16 | loss: 0.3000563
	speed: 0.0130s/iter; left time: 124.6952s
	iters: 1900, epoch: 16 | loss: 1.3698745
	speed: 0.0119s/iter; left time: 112.4988s
	iters: 2000, epoch: 16 | loss: 0.9158348
	speed: 0.0126s/iter; left time: 118.0648s
	iters: 2100, epoch: 16 | loss: 0.3696379
	speed: 0.0124s/iter; left time: 114.4091s
	iters: 2200, epoch: 16 | loss: 0.2803737
	speed: 0.0120s/iter; left time: 109.8613s
Epoch: 16 cost time: 31.321405172348022
Epoch: 16, Steps: 2272 | Train Loss: 0.5312898 Vali Loss: 0.4482715 Test Loss: 0.1866345
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : weather_336_192_NLinear_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed12890<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10348
mse:0.1868799477815628, mae:0.23639917373657227
