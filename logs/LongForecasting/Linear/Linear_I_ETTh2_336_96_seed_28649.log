Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTh2', data_path='ETTh2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.05, loss='mse', lradj='type1', model='Linear', model_id='ETTh2_336_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=28649, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTh2_336_96_Linear_ETTh2_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed28649>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 6.6817212
	speed: 0.0033s/iter; left time: 33.3281s
	iters: 200, epoch: 1 | loss: 10.0773649
	speed: 0.0033s/iter; left time: 32.7988s
	iters: 300, epoch: 1 | loss: 4.0036230
	speed: 0.0025s/iter; left time: 24.9326s
	iters: 400, epoch: 1 | loss: 5.7729211
	speed: 0.0036s/iter; left time: 35.2086s
	iters: 500, epoch: 1 | loss: 21.1008778
	speed: 0.0035s/iter; left time: 34.1637s
Epoch: 1 cost time: 1.6483523845672607
Epoch: 1, Steps: 513 | Train Loss: 6.6503678 Vali Loss: 7.3572578 Test Loss: 15.5800991
Validation loss decreased (inf --> 7.357258).  Saving model ...
Updating learning rate to 0.05
	iters: 100, epoch: 2 | loss: 12.2259903
	speed: 0.0063s/iter; left time: 60.6138s
	iters: 200, epoch: 2 | loss: 23.6662579
	speed: 0.0033s/iter; left time: 31.6037s
	iters: 300, epoch: 2 | loss: 4.5297294
	speed: 0.0031s/iter; left time: 29.4168s
	iters: 400, epoch: 2 | loss: 14.4110432
	speed: 0.0029s/iter; left time: 26.7353s
	iters: 500, epoch: 2 | loss: 3.6143742
	speed: 0.0030s/iter; left time: 27.9289s
Epoch: 2 cost time: 1.5743520259857178
Epoch: 2, Steps: 513 | Train Loss: 8.6613646 Vali Loss: 5.5293546 Test Loss: 10.2620354
Validation loss decreased (7.357258 --> 5.529355).  Saving model ...
Updating learning rate to 0.025
	iters: 100, epoch: 3 | loss: 0.6020862
	speed: 0.0061s/iter; left time: 55.2848s
	iters: 200, epoch: 3 | loss: 1.3087171
	speed: 0.0033s/iter; left time: 30.2671s
	iters: 300, epoch: 3 | loss: 0.6904863
	speed: 0.0032s/iter; left time: 28.3460s
	iters: 400, epoch: 3 | loss: 0.8475844
	speed: 0.0034s/iter; left time: 30.2156s
	iters: 500, epoch: 3 | loss: 0.6336811
	speed: 0.0030s/iter; left time: 26.3916s
Epoch: 3 cost time: 1.6264383792877197
Epoch: 3, Steps: 513 | Train Loss: 1.0074103 Vali Loss: 0.5802716 Test Loss: 1.2097422
Validation loss decreased (5.529355 --> 0.580272).  Saving model ...
Updating learning rate to 0.0125
	iters: 100, epoch: 4 | loss: 0.6525624
	speed: 0.0055s/iter; left time: 47.2710s
	iters: 200, epoch: 4 | loss: 0.8382607
	speed: 0.0024s/iter; left time: 20.3676s
	iters: 300, epoch: 4 | loss: 0.5545905
	speed: 0.0025s/iter; left time: 20.8024s
	iters: 400, epoch: 4 | loss: 0.5526202
	speed: 0.0029s/iter; left time: 23.9673s
	iters: 500, epoch: 4 | loss: 0.5772509
	speed: 0.0033s/iter; left time: 27.3211s
Epoch: 4 cost time: 1.4255549907684326
Epoch: 4, Steps: 513 | Train Loss: 0.5074151 Vali Loss: 0.4098038 Test Loss: 0.8834890
Validation loss decreased (0.580272 --> 0.409804).  Saving model ...
Updating learning rate to 0.00625
	iters: 100, epoch: 5 | loss: 0.8220230
	speed: 0.0067s/iter; left time: 54.6539s
	iters: 200, epoch: 5 | loss: 0.4727482
	speed: 0.0032s/iter; left time: 25.9636s
	iters: 300, epoch: 5 | loss: 0.5291155
	speed: 0.0037s/iter; left time: 29.5797s
	iters: 400, epoch: 5 | loss: 0.3984426
	speed: 0.0036s/iter; left time: 27.8926s
	iters: 500, epoch: 5 | loss: 0.3468704
	speed: 0.0035s/iter; left time: 26.9045s
Epoch: 5 cost time: 1.720353603363037
Epoch: 5, Steps: 513 | Train Loss: 0.4326450 Vali Loss: 0.3490522 Test Loss: 0.7525483
Validation loss decreased (0.409804 --> 0.349052).  Saving model ...
Updating learning rate to 0.003125
	iters: 100, epoch: 6 | loss: 0.2903606
	speed: 0.0064s/iter; left time: 48.7105s
	iters: 200, epoch: 6 | loss: 0.2190410
	speed: 0.0031s/iter; left time: 23.0128s
	iters: 300, epoch: 6 | loss: 0.3904413
	speed: 0.0029s/iter; left time: 21.7364s
	iters: 400, epoch: 6 | loss: 0.3713364
	speed: 0.0030s/iter; left time: 21.8152s
	iters: 500, epoch: 6 | loss: 0.3980857
	speed: 0.0030s/iter; left time: 21.3872s
Epoch: 6 cost time: 1.5653722286224365
Epoch: 6, Steps: 513 | Train Loss: 0.4008999 Vali Loss: 0.3664945 Test Loss: 0.6909233
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0015625
	iters: 100, epoch: 7 | loss: 0.4564508
	speed: 0.0079s/iter; left time: 55.7579s
	iters: 200, epoch: 7 | loss: 0.9644264
	speed: 0.0038s/iter; left time: 26.6052s
	iters: 300, epoch: 7 | loss: 0.3177020
	speed: 0.0035s/iter; left time: 24.3007s
	iters: 400, epoch: 7 | loss: 0.6058324
	speed: 0.0032s/iter; left time: 21.5137s
	iters: 500, epoch: 7 | loss: 0.4132467
	speed: 0.0033s/iter; left time: 22.1876s
Epoch: 7 cost time: 1.7904324531555176
Epoch: 7, Steps: 513 | Train Loss: 0.3819138 Vali Loss: 0.3064732 Test Loss: 0.5777629
Validation loss decreased (0.349052 --> 0.306473).  Saving model ...
Updating learning rate to 0.00078125
	iters: 100, epoch: 8 | loss: 0.2220599
	speed: 0.0071s/iter; left time: 46.4045s
	iters: 200, epoch: 8 | loss: 0.2923940
	speed: 0.0034s/iter; left time: 22.1922s
	iters: 300, epoch: 8 | loss: 0.1950831
	speed: 0.0038s/iter; left time: 23.9511s
	iters: 400, epoch: 8 | loss: 0.4925994
	speed: 0.0033s/iter; left time: 20.5181s
	iters: 500, epoch: 8 | loss: 0.1696602
	speed: 0.0036s/iter; left time: 22.4000s
Epoch: 8 cost time: 1.7875990867614746
Epoch: 8, Steps: 513 | Train Loss: 0.3704491 Vali Loss: 0.2928854 Test Loss: 0.4432433
Validation loss decreased (0.306473 --> 0.292885).  Saving model ...
Updating learning rate to 0.000390625
	iters: 100, epoch: 9 | loss: 0.2677995
	speed: 0.0075s/iter; left time: 45.5037s
	iters: 200, epoch: 9 | loss: 0.1275131
	speed: 0.0037s/iter; left time: 21.8156s
	iters: 300, epoch: 9 | loss: 0.2328522
	speed: 0.0037s/iter; left time: 21.9166s
	iters: 400, epoch: 9 | loss: 0.2320039
	speed: 0.0036s/iter; left time: 20.9336s
	iters: 500, epoch: 9 | loss: 0.4294727
	speed: 0.0038s/iter; left time: 21.3269s
Epoch: 9 cost time: 1.8942928314208984
Epoch: 9, Steps: 513 | Train Loss: 0.3642970 Vali Loss: 0.3004680 Test Loss: 0.4982294
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0001953125
	iters: 100, epoch: 10 | loss: 0.1624124
	speed: 0.0078s/iter; left time: 43.1438s
	iters: 200, epoch: 10 | loss: 0.1741094
	speed: 0.0033s/iter; left time: 18.0197s
	iters: 300, epoch: 10 | loss: 0.2842505
	speed: 0.0033s/iter; left time: 17.8071s
	iters: 400, epoch: 10 | loss: 0.4171717
	speed: 0.0036s/iter; left time: 19.0924s
	iters: 500, epoch: 10 | loss: 0.2819360
	speed: 0.0038s/iter; left time: 19.3415s
Epoch: 10 cost time: 1.7943010330200195
Epoch: 10, Steps: 513 | Train Loss: 0.3607397 Vali Loss: 0.3089862 Test Loss: 0.5232828
EarlyStopping counter: 2 out of 5
Updating learning rate to 9.765625e-05
	iters: 100, epoch: 11 | loss: 0.3118376
	speed: 0.0080s/iter; left time: 40.1719s
	iters: 200, epoch: 11 | loss: 0.1381023
	speed: 0.0037s/iter; left time: 18.2533s
	iters: 300, epoch: 11 | loss: 0.2920266
	speed: 0.0037s/iter; left time: 17.7782s
	iters: 400, epoch: 11 | loss: 0.7665875
	speed: 0.0038s/iter; left time: 17.7885s
	iters: 500, epoch: 11 | loss: 0.5974256
	speed: 0.0038s/iter; left time: 17.5657s
Epoch: 11 cost time: 1.9356591701507568
Epoch: 11, Steps: 513 | Train Loss: 0.3580238 Vali Loss: 0.2896113 Test Loss: 0.4488147
Validation loss decreased (0.292885 --> 0.289611).  Saving model ...
Updating learning rate to 4.8828125e-05
	iters: 100, epoch: 12 | loss: 0.3188618
	speed: 0.0071s/iter; left time: 32.0327s
	iters: 200, epoch: 12 | loss: 0.3240106
	speed: 0.0033s/iter; left time: 14.5823s
	iters: 300, epoch: 12 | loss: 0.4289880
	speed: 0.0034s/iter; left time: 14.6812s
	iters: 400, epoch: 12 | loss: 0.1881954
	speed: 0.0034s/iter; left time: 14.2146s
	iters: 500, epoch: 12 | loss: 0.2467602
	speed: 0.0037s/iter; left time: 15.1200s
Epoch: 12 cost time: 1.7472338676452637
Epoch: 12, Steps: 513 | Train Loss: 0.3569941 Vali Loss: 0.2691599 Test Loss: 0.3859034
Validation loss decreased (0.289611 --> 0.269160).  Saving model ...
Updating learning rate to 2.44140625e-05
	iters: 100, epoch: 13 | loss: 0.3439810
	speed: 0.0058s/iter; left time: 23.3106s
	iters: 200, epoch: 13 | loss: 0.4772438
	speed: 0.0032s/iter; left time: 12.6260s
	iters: 300, epoch: 13 | loss: 0.2483885
	speed: 0.0031s/iter; left time: 11.7956s
	iters: 400, epoch: 13 | loss: 0.2414274
	speed: 0.0031s/iter; left time: 11.6707s
	iters: 500, epoch: 13 | loss: 0.3401724
	speed: 0.0032s/iter; left time: 11.3637s
Epoch: 13 cost time: 1.6305856704711914
Epoch: 13, Steps: 513 | Train Loss: 0.3561440 Vali Loss: 0.2773019 Test Loss: 0.4067430
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.220703125e-05
	iters: 100, epoch: 14 | loss: 0.1436645
	speed: 0.0069s/iter; left time: 24.1297s
	iters: 200, epoch: 14 | loss: 0.2049762
	speed: 0.0033s/iter; left time: 11.0980s
	iters: 300, epoch: 14 | loss: 0.2408917
	speed: 0.0031s/iter; left time: 10.2510s
	iters: 400, epoch: 14 | loss: 0.2802446
	speed: 0.0027s/iter; left time: 8.6184s
	iters: 500, epoch: 14 | loss: 0.3173450
	speed: 0.0032s/iter; left time: 10.0263s
Epoch: 14 cost time: 1.6028404235839844
Epoch: 14, Steps: 513 | Train Loss: 0.3555369 Vali Loss: 0.2817076 Test Loss: 0.4232813
EarlyStopping counter: 2 out of 5
Updating learning rate to 6.103515625e-06
	iters: 100, epoch: 15 | loss: 0.3406688
	speed: 0.0060s/iter; left time: 18.0229s
	iters: 200, epoch: 15 | loss: 0.4516903
	speed: 0.0028s/iter; left time: 7.9474s
	iters: 300, epoch: 15 | loss: 0.8469254
	speed: 0.0031s/iter; left time: 8.7311s
	iters: 400, epoch: 15 | loss: 0.5319276
	speed: 0.0033s/iter; left time: 8.8675s
	iters: 500, epoch: 15 | loss: 0.2736378
	speed: 0.0033s/iter; left time: 8.5365s
Epoch: 15 cost time: 1.5742261409759521
Epoch: 15, Steps: 513 | Train Loss: 0.3553984 Vali Loss: 0.2831497 Test Loss: 0.4287172
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.0517578125e-06
	iters: 100, epoch: 16 | loss: 0.2426617
	speed: 0.0063s/iter; left time: 15.4448s
	iters: 200, epoch: 16 | loss: 0.2817617
	speed: 0.0026s/iter; left time: 6.0806s
	iters: 300, epoch: 16 | loss: 1.0944353
	speed: 0.0026s/iter; left time: 5.8528s
	iters: 400, epoch: 16 | loss: 0.1807185
	speed: 0.0026s/iter; left time: 5.6316s
	iters: 500, epoch: 16 | loss: 0.2092046
	speed: 0.0026s/iter; left time: 5.2895s
Epoch: 16 cost time: 1.3353102207183838
Epoch: 16, Steps: 513 | Train Loss: 0.3552316 Vali Loss: 0.2832619 Test Loss: 0.4283454
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.52587890625e-06
	iters: 100, epoch: 17 | loss: 0.7872163
	speed: 0.0053s/iter; left time: 10.3935s
	iters: 200, epoch: 17 | loss: 0.2805797
	speed: 0.0026s/iter; left time: 4.7622s
	iters: 300, epoch: 17 | loss: 0.1772851
	speed: 0.0025s/iter; left time: 4.4526s
	iters: 400, epoch: 17 | loss: 0.4689792
	speed: 0.0025s/iter; left time: 4.1656s
	iters: 500, epoch: 17 | loss: 0.4510965
	speed: 0.0023s/iter; left time: 3.5596s
Epoch: 17 cost time: 1.2713921070098877
Epoch: 17, Steps: 513 | Train Loss: 0.3551264 Vali Loss: 0.2832499 Test Loss: 0.4285640
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTh2_336_96_Linear_ETTh2_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed28649<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.38728436827659607, mae:0.4107424020767212
