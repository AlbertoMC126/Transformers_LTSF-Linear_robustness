Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='DLinear', model_id='traffic_336_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=336, root_path='./dataset/', save_pred_values=False, seed=3144, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_336_336_DLinear_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3144>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11609
val 1421
test 3173
	iters: 100, epoch: 1 | loss: 0.5736256
	speed: 0.4688s/iter; left time: 6751.0515s
	iters: 200, epoch: 1 | loss: 0.5897014
	speed: 0.4571s/iter; left time: 6537.3003s
	iters: 300, epoch: 1 | loss: 0.5911397
	speed: 0.4500s/iter; left time: 6390.6961s
	iters: 400, epoch: 1 | loss: 0.6097419
	speed: 0.4786s/iter; left time: 6749.4288s
	iters: 500, epoch: 1 | loss: 0.5658263
	speed: 0.4500s/iter; left time: 6300.5012s
	iters: 600, epoch: 1 | loss: 0.6110246
	speed: 0.4515s/iter; left time: 6275.9980s
	iters: 700, epoch: 1 | loss: 0.6096257
	speed: 0.4670s/iter; left time: 6444.9371s
Epoch: 1 cost time: 333.9471056461334
Epoch: 1, Steps: 725 | Train Loss: 0.6019831 Vali Loss: 0.7893533 Test Loss: 0.9376979
Validation loss decreased (inf --> 0.789353).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.5744413
	speed: 0.9688s/iter; left time: 13248.8490s
	iters: 200, epoch: 2 | loss: 0.5786334
	speed: 0.4508s/iter; left time: 6119.5569s
	iters: 300, epoch: 2 | loss: 0.6338346
	speed: 0.4454s/iter; left time: 6001.9344s
	iters: 400, epoch: 2 | loss: 0.6073760
	speed: 0.4757s/iter; left time: 6362.6073s
	iters: 500, epoch: 2 | loss: 0.5791345
	speed: 0.4525s/iter; left time: 6006.9519s
	iters: 600, epoch: 2 | loss: 0.6628206
	speed: 0.4591s/iter; left time: 6049.5891s
	iters: 700, epoch: 2 | loss: 0.5959360
	speed: 0.4569s/iter; left time: 5974.8065s
Epoch: 2 cost time: 331.54637813568115
Epoch: 2, Steps: 725 | Train Loss: 0.5937097 Vali Loss: 0.8185766 Test Loss: 0.9634448
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.3666424
	speed: 0.8916s/iter; left time: 11547.0556s
	iters: 200, epoch: 3 | loss: 0.3927369
	speed: 0.4456s/iter; left time: 5725.9786s
	iters: 300, epoch: 3 | loss: 0.3718075
	speed: 0.4450s/iter; left time: 5674.7895s
	iters: 400, epoch: 3 | loss: 0.3600888
	speed: 0.4736s/iter; left time: 5991.6462s
	iters: 500, epoch: 3 | loss: 0.3710377
	speed: 0.4507s/iter; left time: 5657.0361s
	iters: 600, epoch: 3 | loss: 0.3473099
	speed: 0.4634s/iter; left time: 5769.3451s
	iters: 700, epoch: 3 | loss: 0.3805373
	speed: 0.4623s/iter; left time: 5709.8920s
Epoch: 3 cost time: 331.661319732666
Epoch: 3, Steps: 725 | Train Loss: 0.3720269 Vali Loss: 0.5134594 Test Loss: 0.6202203
Validation loss decreased (0.789353 --> 0.513459).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.3146851
	speed: 0.9746s/iter; left time: 11914.9579s
	iters: 200, epoch: 4 | loss: 0.3410262
	speed: 0.4531s/iter; left time: 5494.0255s
	iters: 300, epoch: 4 | loss: 0.2965785
	speed: 0.4579s/iter; left time: 5507.1091s
	iters: 400, epoch: 4 | loss: 0.2917332
	speed: 0.4676s/iter; left time: 5576.1487s
	iters: 500, epoch: 4 | loss: 0.2841500
	speed: 0.4468s/iter; left time: 5284.1014s
	iters: 600, epoch: 4 | loss: 0.3335591
	speed: 0.4570s/iter; left time: 5358.5126s
	iters: 700, epoch: 4 | loss: 0.2960473
	speed: 0.4529s/iter; left time: 5265.1243s
Epoch: 4 cost time: 331.32405400276184
Epoch: 4, Steps: 725 | Train Loss: 0.3060507 Vali Loss: 0.4341404 Test Loss: 0.5309026
Validation loss decreased (0.513459 --> 0.434140).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.2621409
	speed: 0.9694s/iter; left time: 11149.2518s
	iters: 200, epoch: 5 | loss: 0.2781426
	speed: 0.4519s/iter; left time: 5152.4146s
	iters: 300, epoch: 5 | loss: 0.2851109
	speed: 0.4657s/iter; left time: 5262.8194s
	iters: 400, epoch: 5 | loss: 0.2799232
	speed: 0.4538s/iter; left time: 5083.4969s
	iters: 500, epoch: 5 | loss: 0.2674751
	speed: 0.4493s/iter; left time: 4988.1249s
	iters: 600, epoch: 5 | loss: 0.2481289
	speed: 0.4698s/iter; left time: 5168.1597s
	iters: 700, epoch: 5 | loss: 0.2973696
	speed: 0.4446s/iter; left time: 4846.4211s
Epoch: 5 cost time: 330.65246200561523
Epoch: 5, Steps: 725 | Train Loss: 0.2787115 Vali Loss: 0.4029974 Test Loss: 0.4913781
Validation loss decreased (0.434140 --> 0.402997).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.2689157
	speed: 0.9624s/iter; left time: 10370.6578s
	iters: 200, epoch: 6 | loss: 0.2807905
	speed: 0.4528s/iter; left time: 4834.2921s
	iters: 300, epoch: 6 | loss: 0.2609961
	speed: 0.4628s/iter; left time: 4894.3000s
	iters: 400, epoch: 6 | loss: 0.2807668
	speed: 0.4502s/iter; left time: 4716.2882s
	iters: 500, epoch: 6 | loss: 0.2656213
	speed: 0.4497s/iter; left time: 4665.8824s
	iters: 600, epoch: 6 | loss: 0.2579098
	speed: 0.4633s/iter; left time: 4761.2480s
	iters: 700, epoch: 6 | loss: 0.2597552
	speed: 0.4462s/iter; left time: 4540.8585s
Epoch: 6 cost time: 329.2620413303375
Epoch: 6, Steps: 725 | Train Loss: 0.2647156 Vali Loss: 0.3861812 Test Loss: 0.4708481
Validation loss decreased (0.402997 --> 0.386181).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.2479841
	speed: 0.9711s/iter; left time: 9760.9719s
	iters: 200, epoch: 7 | loss: 0.2543620
	speed: 0.4533s/iter; left time: 4510.6286s
	iters: 300, epoch: 7 | loss: 0.2648045
	speed: 0.4613s/iter; left time: 4543.9129s
	iters: 400, epoch: 7 | loss: 0.2662567
	speed: 0.4499s/iter; left time: 4386.7118s
	iters: 500, epoch: 7 | loss: 0.2437388
	speed: 0.4524s/iter; left time: 4365.7389s
	iters: 600, epoch: 7 | loss: 0.2499293
	speed: 0.4509s/iter; left time: 4306.4424s
	iters: 700, epoch: 7 | loss: 0.2710912
	speed: 0.4490s/iter; left time: 4243.4976s
Epoch: 7 cost time: 328.25712609291077
Epoch: 7, Steps: 725 | Train Loss: 0.2571969 Vali Loss: 0.3794912 Test Loss: 0.4621529
Validation loss decreased (0.386181 --> 0.379491).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.2792508
	speed: 0.9615s/iter; left time: 8967.0610s
	iters: 200, epoch: 8 | loss: 0.2667733
	speed: 0.4513s/iter; left time: 4163.4026s
	iters: 300, epoch: 8 | loss: 0.2293188
	speed: 0.4624s/iter; left time: 4219.4727s
	iters: 400, epoch: 8 | loss: 0.2861501
	speed: 0.4491s/iter; left time: 4053.7611s
	iters: 500, epoch: 8 | loss: 0.2716683
	speed: 0.4577s/iter; left time: 4085.2960s
	iters: 600, epoch: 8 | loss: 0.2521140
	speed: 0.4506s/iter; left time: 3977.3095s
	iters: 700, epoch: 8 | loss: 0.2765931
	speed: 0.4456s/iter; left time: 3888.5089s
Epoch: 8 cost time: 328.2510883808136
Epoch: 8, Steps: 725 | Train Loss: 0.2530507 Vali Loss: 0.3739843 Test Loss: 0.4576006
Validation loss decreased (0.379491 --> 0.373984).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.2514085
	speed: 0.9704s/iter; left time: 8346.3757s
	iters: 200, epoch: 9 | loss: 0.2378695
	speed: 0.4574s/iter; left time: 3887.9788s
	iters: 300, epoch: 9 | loss: 0.2684432
	speed: 0.4605s/iter; left time: 3868.6910s
	iters: 400, epoch: 9 | loss: 0.2627802
	speed: 0.4542s/iter; left time: 3770.6568s
	iters: 500, epoch: 9 | loss: 0.2512189
	speed: 0.4639s/iter; left time: 3804.6886s
	iters: 600, epoch: 9 | loss: 0.2648975
	speed: 0.4483s/iter; left time: 3631.2933s
	iters: 700, epoch: 9 | loss: 0.2532614
	speed: 0.4514s/iter; left time: 3611.7987s
Epoch: 9 cost time: 330.3469362258911
Epoch: 9, Steps: 725 | Train Loss: 0.2507581 Vali Loss: 0.3723217 Test Loss: 0.4552673
Validation loss decreased (0.373984 --> 0.372322).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.2411418
	speed: 0.9572s/iter; left time: 7538.8760s
	iters: 200, epoch: 10 | loss: 0.2621920
	speed: 0.4636s/iter; left time: 3604.9366s
	iters: 300, epoch: 10 | loss: 0.2903857
	speed: 0.4581s/iter; left time: 3516.7218s
	iters: 400, epoch: 10 | loss: 0.2499613
	speed: 0.4563s/iter; left time: 3457.0913s
	iters: 500, epoch: 10 | loss: 0.2399141
	speed: 0.4591s/iter; left time: 3432.1936s
	iters: 600, epoch: 10 | loss: 0.2471043
	speed: 0.4527s/iter; left time: 3339.3183s
	iters: 700, epoch: 10 | loss: 0.2497977
	speed: 0.4578s/iter; left time: 3331.2239s
Epoch: 10 cost time: 331.21638679504395
Epoch: 10, Steps: 725 | Train Loss: 0.2495016 Vali Loss: 0.3717498 Test Loss: 0.4542709
Validation loss decreased (0.372322 --> 0.371750).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.2556457
	speed: 0.9653s/iter; left time: 6902.8596s
	iters: 200, epoch: 11 | loss: 0.2222549
	speed: 0.4545s/iter; left time: 3204.4376s
	iters: 300, epoch: 11 | loss: 0.2851878
	speed: 0.4533s/iter; left time: 3151.1874s
	iters: 400, epoch: 11 | loss: 0.2421302
	speed: 0.4638s/iter; left time: 3177.5015s
	iters: 500, epoch: 11 | loss: 0.2465776
	speed: 0.4603s/iter; left time: 3107.7688s
	iters: 600, epoch: 11 | loss: 0.2387355
	speed: 0.4534s/iter; left time: 3015.4173s
	iters: 700, epoch: 11 | loss: 0.2485479
	speed: 0.4581s/iter; left time: 3001.2486s
Epoch: 11 cost time: 331.0173258781433
Epoch: 11, Steps: 725 | Train Loss: 0.2488054 Vali Loss: 0.3711104 Test Loss: 0.4537632
Validation loss decreased (0.371750 --> 0.371110).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.2411176
	speed: 0.9579s/iter; left time: 6155.3939s
	iters: 200, epoch: 12 | loss: 0.2549473
	speed: 0.4578s/iter; left time: 2896.1072s
	iters: 300, epoch: 12 | loss: 0.2243395
	speed: 0.4582s/iter; left time: 2852.6314s
	iters: 400, epoch: 12 | loss: 0.2485939
	speed: 0.4576s/iter; left time: 2803.1563s
	iters: 500, epoch: 12 | loss: 0.2544481
	speed: 0.4498s/iter; left time: 2710.7838s
	iters: 600, epoch: 12 | loss: 0.2655110
	speed: 0.4502s/iter; left time: 2668.1594s
	iters: 700, epoch: 12 | loss: 0.2357731
	speed: 0.4524s/iter; left time: 2635.9161s
Epoch: 12 cost time: 328.92755699157715
Epoch: 12, Steps: 725 | Train Loss: 0.2484416 Vali Loss: 0.3713400 Test Loss: 0.4536654
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.2296904
	speed: 0.8758s/iter; left time: 4992.8738s
	iters: 200, epoch: 13 | loss: 0.2760512
	speed: 0.4412s/iter; left time: 2471.3164s
	iters: 300, epoch: 13 | loss: 0.2378506
	speed: 0.4428s/iter; left time: 2436.1004s
	iters: 400, epoch: 13 | loss: 0.2314305
	speed: 0.4507s/iter; left time: 2434.4640s
	iters: 500, epoch: 13 | loss: 0.2508997
	speed: 0.4519s/iter; left time: 2395.5973s
	iters: 600, epoch: 13 | loss: 0.2503413
	speed: 0.4543s/iter; left time: 2362.6654s
	iters: 700, epoch: 13 | loss: 0.2343211
	speed: 0.4582s/iter; left time: 2337.4250s
Epoch: 13 cost time: 325.4708511829376
Epoch: 13, Steps: 725 | Train Loss: 0.2482716 Vali Loss: 0.3708126 Test Loss: 0.4536229
Validation loss decreased (0.371110 --> 0.370813).  Saving model ...
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 14 | loss: 0.2540255
	speed: 0.9612s/iter; left time: 4782.7918s
	iters: 200, epoch: 14 | loss: 0.2325647
	speed: 0.4558s/iter; left time: 2222.6469s
	iters: 300, epoch: 14 | loss: 0.2555587
	speed: 0.4566s/iter; left time: 2180.5074s
	iters: 400, epoch: 14 | loss: 0.2335718
	speed: 0.4627s/iter; left time: 2163.7544s
	iters: 500, epoch: 14 | loss: 0.2538668
	speed: 0.4519s/iter; left time: 2068.0031s
	iters: 600, epoch: 14 | loss: 0.2479598
	speed: 0.4465s/iter; left time: 1998.4801s
	iters: 700, epoch: 14 | loss: 0.2455641
	speed: 0.4494s/iter; left time: 1966.6822s
Epoch: 14 cost time: 328.7122416496277
Epoch: 14, Steps: 725 | Train Loss: 0.2481227 Vali Loss: 0.3708575 Test Loss: 0.4535829
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 15 | loss: 0.2340402
	speed: 0.8783s/iter; left time: 3733.7757s
	iters: 200, epoch: 15 | loss: 0.2232762
	speed: 0.4501s/iter; left time: 1868.2541s
	iters: 300, epoch: 15 | loss: 0.2417851
	speed: 0.4529s/iter; left time: 1834.8078s
	iters: 400, epoch: 15 | loss: 0.2682267
	speed: 0.4586s/iter; left time: 1811.8707s
	iters: 500, epoch: 15 | loss: 0.2600379
	speed: 0.4537s/iter; left time: 1747.2868s
	iters: 600, epoch: 15 | loss: 0.2333906
	speed: 0.4517s/iter; left time: 1694.3369s
	iters: 700, epoch: 15 | loss: 0.2381031
	speed: 0.4531s/iter; left time: 1654.3883s
Epoch: 15 cost time: 327.8786771297455
Epoch: 15, Steps: 725 | Train Loss: 0.2480810 Vali Loss: 0.3709879 Test Loss: 0.4535798
EarlyStopping counter: 2 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 16 | loss: 0.2436371
	speed: 0.9277s/iter; left time: 3271.1502s
	iters: 200, epoch: 16 | loss: 0.2395250
	speed: 0.4500s/iter; left time: 1541.8461s
	iters: 300, epoch: 16 | loss: 0.2532234
	speed: 0.4518s/iter; left time: 1502.7970s
	iters: 400, epoch: 16 | loss: 0.2605064
	speed: 0.4577s/iter; left time: 1476.5876s
	iters: 500, epoch: 16 | loss: 0.2564996
	speed: 0.4550s/iter; left time: 1422.3039s
	iters: 600, epoch: 16 | loss: 0.2406876
	speed: 0.4495s/iter; left time: 1360.0974s
	iters: 700, epoch: 16 | loss: 0.2423331
	speed: 0.4474s/iter; left time: 1309.0485s
Epoch: 16 cost time: 332.032746553421
Epoch: 16, Steps: 725 | Train Loss: 0.2480444 Vali Loss: 0.3712996 Test Loss: 0.4535789
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 17 | loss: 0.2434981
	speed: 0.8814s/iter; left time: 2468.8292s
	iters: 200, epoch: 17 | loss: 0.2233945
	speed: 0.4544s/iter; left time: 1227.2044s
	iters: 300, epoch: 17 | loss: 0.2669246
	speed: 0.4563s/iter; left time: 1186.8391s
	iters: 400, epoch: 17 | loss: 0.2330660
	speed: 0.4554s/iter; left time: 1138.8415s
	iters: 500, epoch: 17 | loss: 0.2531365
	speed: 0.4494s/iter; left time: 1079.0681s
	iters: 600, epoch: 17 | loss: 0.2523457
	speed: 0.4494s/iter; left time: 1034.1146s
	iters: 700, epoch: 17 | loss: 0.2342742
	speed: 0.4506s/iter; left time: 991.7514s
Epoch: 17 cost time: 327.7324709892273
Epoch: 17, Steps: 725 | Train Loss: 0.2479907 Vali Loss: 0.3712742 Test Loss: 0.4535778
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 18 | loss: 0.2652596
	speed: 0.9021s/iter; left time: 1872.6912s
	iters: 200, epoch: 18 | loss: 0.2310990
	speed: 0.4514s/iter; left time: 891.8815s
	iters: 300, epoch: 18 | loss: 0.2438675
	speed: 0.4532s/iter; left time: 850.2567s
	iters: 400, epoch: 18 | loss: 0.2602154
	speed: 0.4524s/iter; left time: 803.4598s
	iters: 500, epoch: 18 | loss: 0.2686827
	speed: 0.4508s/iter; left time: 755.5780s
	iters: 600, epoch: 18 | loss: 0.2494486
	speed: 0.4519s/iter; left time: 712.2476s
	iters: 700, epoch: 18 | loss: 0.2492786
	speed: 0.4577s/iter; left time: 675.5400s
Epoch: 18 cost time: 329.28527569770813
Epoch: 18, Steps: 725 | Train Loss: 0.2480051 Vali Loss: 0.3714983 Test Loss: 0.4535773
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : traffic_336_336_DLinear_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3144<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3173
mse:0.45264923572540283, mae:0.31232720613479614
