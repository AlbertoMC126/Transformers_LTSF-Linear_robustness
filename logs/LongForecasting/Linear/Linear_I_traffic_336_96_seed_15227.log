Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='Linear', model_id='traffic_336_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=15227, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_336_96_Linear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15227>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11849
val 1661
test 3413
	iters: 100, epoch: 1 | loss: 0.4551227
	speed: 0.3182s/iter; left time: 4677.8278s
	iters: 200, epoch: 1 | loss: 0.4767850
	speed: 0.3051s/iter; left time: 4454.8577s
	iters: 300, epoch: 1 | loss: 0.4588625
	speed: 0.3048s/iter; left time: 4419.6143s
	iters: 400, epoch: 1 | loss: 0.4344760
	speed: 0.3057s/iter; left time: 4401.6886s
	iters: 500, epoch: 1 | loss: 0.4599473
	speed: 0.3059s/iter; left time: 4375.0779s
	iters: 600, epoch: 1 | loss: 0.4701597
	speed: 0.3054s/iter; left time: 4336.9155s
	iters: 700, epoch: 1 | loss: 0.4529618
	speed: 0.3050s/iter; left time: 4300.5962s
Epoch: 1 cost time: 227.39537596702576
Epoch: 1, Steps: 740 | Train Loss: 0.4717417 Vali Loss: 0.6209860 Test Loss: 0.7300626
Validation loss decreased (inf --> 0.620986).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.4572217
	speed: 0.6151s/iter; left time: 8586.8410s
	iters: 200, epoch: 2 | loss: 0.4387240
	speed: 0.3033s/iter; left time: 4204.2886s
	iters: 300, epoch: 2 | loss: 0.4714545
	speed: 0.3040s/iter; left time: 4183.6634s
	iters: 400, epoch: 2 | loss: 0.5009205
	speed: 0.3046s/iter; left time: 4161.1419s
	iters: 500, epoch: 2 | loss: 0.4699609
	speed: 0.3051s/iter; left time: 4137.7059s
	iters: 600, epoch: 2 | loss: 0.5093419
	speed: 0.3042s/iter; left time: 4094.2910s
	iters: 700, epoch: 2 | loss: 0.4458499
	speed: 0.3033s/iter; left time: 4051.9323s
Epoch: 2 cost time: 224.9309515953064
Epoch: 2, Steps: 740 | Train Loss: 0.4666199 Vali Loss: 0.6166289 Test Loss: 0.7271536
Validation loss decreased (0.620986 --> 0.616629).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.3267137
	speed: 0.6118s/iter; left time: 8088.8511s
	iters: 200, epoch: 3 | loss: 0.2970686
	speed: 0.3037s/iter; left time: 3984.5062s
	iters: 300, epoch: 3 | loss: 0.3129711
	speed: 0.3041s/iter; left time: 3960.2110s
	iters: 400, epoch: 3 | loss: 0.3073273
	speed: 0.3036s/iter; left time: 3922.6688s
	iters: 500, epoch: 3 | loss: 0.3036170
	speed: 0.3033s/iter; left time: 3888.0825s
	iters: 600, epoch: 3 | loss: 0.3140599
	speed: 0.3046s/iter; left time: 3874.2321s
	iters: 700, epoch: 3 | loss: 0.3145459
	speed: 0.3044s/iter; left time: 3841.6694s
Epoch: 3 cost time: 224.86605429649353
Epoch: 3, Steps: 740 | Train Loss: 0.3224645 Vali Loss: 0.4530056 Test Loss: 0.5444408
Validation loss decreased (0.616629 --> 0.453006).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.2609594
	speed: 0.6168s/iter; left time: 7698.8414s
	iters: 200, epoch: 4 | loss: 0.2545093
	speed: 0.3049s/iter; left time: 3774.9213s
	iters: 300, epoch: 4 | loss: 0.2792729
	speed: 0.3041s/iter; left time: 3734.7610s
	iters: 400, epoch: 4 | loss: 0.2793255
	speed: 0.3048s/iter; left time: 3713.2086s
	iters: 500, epoch: 4 | loss: 0.2680386
	speed: 0.3052s/iter; left time: 3687.0855s
	iters: 600, epoch: 4 | loss: 0.2615455
	speed: 0.3051s/iter; left time: 3655.9194s
	iters: 700, epoch: 4 | loss: 0.3108831
	speed: 0.3053s/iter; left time: 3627.7687s
Epoch: 4 cost time: 225.63909935951233
Epoch: 4, Steps: 740 | Train Loss: 0.2754080 Vali Loss: 0.3945718 Test Loss: 0.4789184
Validation loss decreased (0.453006 --> 0.394572).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.2370614
	speed: 0.6150s/iter; left time: 7220.6145s
	iters: 200, epoch: 5 | loss: 0.2503468
	speed: 0.3037s/iter; left time: 3535.7029s
	iters: 300, epoch: 5 | loss: 0.2333706
	speed: 0.3052s/iter; left time: 3521.7546s
	iters: 400, epoch: 5 | loss: 0.2553398
	speed: 0.3039s/iter; left time: 3476.9381s
	iters: 500, epoch: 5 | loss: 0.2333881
	speed: 0.3039s/iter; left time: 3446.3126s
	iters: 600, epoch: 5 | loss: 0.2534724
	speed: 0.3039s/iter; left time: 3416.3166s
	iters: 700, epoch: 5 | loss: 0.2531426
	speed: 0.3049s/iter; left time: 3396.6446s
Epoch: 5 cost time: 225.0262176990509
Epoch: 5, Steps: 740 | Train Loss: 0.2545582 Vali Loss: 0.3701568 Test Loss: 0.4497948
Validation loss decreased (0.394572 --> 0.370157).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.2311652
	speed: 0.6166s/iter; left time: 6783.7164s
	iters: 200, epoch: 6 | loss: 0.2282200
	speed: 0.3040s/iter; left time: 3313.6088s
	iters: 300, epoch: 6 | loss: 0.2498128
	speed: 0.3036s/iter; left time: 3279.1088s
	iters: 400, epoch: 6 | loss: 0.2449626
	speed: 0.3042s/iter; left time: 3255.3855s
	iters: 500, epoch: 6 | loss: 0.2883456
	speed: 0.3033s/iter; left time: 3215.7149s
	iters: 600, epoch: 6 | loss: 0.2539458
	speed: 0.3042s/iter; left time: 3194.1302s
	iters: 700, epoch: 6 | loss: 0.2425695
	speed: 0.3054s/iter; left time: 3176.7128s
Epoch: 6 cost time: 225.17320489883423
Epoch: 6, Steps: 740 | Train Loss: 0.2437164 Vali Loss: 0.3583201 Test Loss: 0.4379964
Validation loss decreased (0.370157 --> 0.358320).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.2339568
	speed: 0.6143s/iter; left time: 6303.3249s
	iters: 200, epoch: 7 | loss: 0.2382423
	speed: 0.3051s/iter; left time: 3099.6182s
	iters: 300, epoch: 7 | loss: 0.2592663
	speed: 0.3042s/iter; left time: 3060.1102s
	iters: 400, epoch: 7 | loss: 0.2297067
	speed: 0.3047s/iter; left time: 3035.3265s
	iters: 500, epoch: 7 | loss: 0.2104447
	speed: 0.3058s/iter; left time: 3015.6931s
	iters: 600, epoch: 7 | loss: 0.2722492
	speed: 0.3051s/iter; left time: 2977.7741s
	iters: 700, epoch: 7 | loss: 0.2320305
	speed: 0.3049s/iter; left time: 2945.6795s
Epoch: 7 cost time: 225.55897307395935
Epoch: 7, Steps: 740 | Train Loss: 0.2379904 Vali Loss: 0.3523778 Test Loss: 0.4309781
Validation loss decreased (0.358320 --> 0.352378).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.2796843
	speed: 0.6149s/iter; left time: 5854.1317s
	iters: 200, epoch: 8 | loss: 0.2458229
	speed: 0.3052s/iter; left time: 2875.3760s
	iters: 300, epoch: 8 | loss: 0.2004190
	speed: 0.3030s/iter; left time: 2824.2818s
	iters: 400, epoch: 8 | loss: 0.2250620
	speed: 0.3046s/iter; left time: 2808.5427s
	iters: 500, epoch: 8 | loss: 0.2235553
	speed: 0.3036s/iter; left time: 2769.2917s
	iters: 600, epoch: 8 | loss: 0.2047371
	speed: 0.3035s/iter; left time: 2738.2367s
	iters: 700, epoch: 8 | loss: 0.2297455
	speed: 0.3037s/iter; left time: 2709.6293s
Epoch: 8 cost time: 224.9133529663086
Epoch: 8, Steps: 740 | Train Loss: 0.2346796 Vali Loss: 0.3499224 Test Loss: 0.4281605
Validation loss decreased (0.352378 --> 0.349922).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.2368792
	speed: 0.6148s/iter; left time: 5398.4364s
	iters: 200, epoch: 9 | loss: 0.2185766
	speed: 0.3049s/iter; left time: 2646.6973s
	iters: 300, epoch: 9 | loss: 0.2742974
	speed: 0.3038s/iter; left time: 2606.6776s
	iters: 400, epoch: 9 | loss: 0.2697911
	speed: 0.3037s/iter; left time: 2575.8344s
	iters: 500, epoch: 9 | loss: 0.2664783
	speed: 0.3046s/iter; left time: 2552.9995s
	iters: 600, epoch: 9 | loss: 0.2185165
	speed: 0.3053s/iter; left time: 2528.2341s
	iters: 700, epoch: 9 | loss: 0.2192044
	speed: 0.3051s/iter; left time: 2496.3893s
Epoch: 9 cost time: 225.36231684684753
Epoch: 9, Steps: 740 | Train Loss: 0.2328997 Vali Loss: 0.3486722 Test Loss: 0.4266109
Validation loss decreased (0.349922 --> 0.348672).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.2123588
	speed: 0.6175s/iter; left time: 4965.4947s
	iters: 200, epoch: 10 | loss: 0.2408558
	speed: 0.3035s/iter; left time: 2410.0721s
	iters: 300, epoch: 10 | loss: 0.2331609
	speed: 0.3056s/iter; left time: 2396.1112s
	iters: 400, epoch: 10 | loss: 0.2275179
	speed: 0.3045s/iter; left time: 2356.8653s
	iters: 500, epoch: 10 | loss: 0.2136914
	speed: 0.3054s/iter; left time: 2333.8242s
	iters: 600, epoch: 10 | loss: 0.2264201
	speed: 0.3046s/iter; left time: 2296.8763s
	iters: 700, epoch: 10 | loss: 0.2656156
	speed: 0.3041s/iter; left time: 2262.6624s
Epoch: 10 cost time: 225.39708137512207
Epoch: 10, Steps: 740 | Train Loss: 0.2319586 Vali Loss: 0.3479223 Test Loss: 0.4260003
Validation loss decreased (0.348672 --> 0.347922).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.2240849
	speed: 0.6152s/iter; left time: 4491.3866s
	iters: 200, epoch: 11 | loss: 0.1975895
	speed: 0.3042s/iter; left time: 2190.7320s
	iters: 300, epoch: 11 | loss: 0.1966899
	speed: 0.3050s/iter; left time: 2165.7040s
	iters: 400, epoch: 11 | loss: 0.2497473
	speed: 0.3037s/iter; left time: 2126.4197s
	iters: 500, epoch: 11 | loss: 0.2254036
	speed: 0.3045s/iter; left time: 2101.0147s
	iters: 600, epoch: 11 | loss: 0.2412581
	speed: 0.3040s/iter; left time: 2067.7502s
	iters: 700, epoch: 11 | loss: 0.2255282
	speed: 0.3050s/iter; left time: 2044.0180s
Epoch: 11 cost time: 225.21983218193054
Epoch: 11, Steps: 740 | Train Loss: 0.2314118 Vali Loss: 0.3475152 Test Loss: 0.4256607
Validation loss decreased (0.347922 --> 0.347515).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.2661362
	speed: 0.6150s/iter; left time: 4035.0897s
	iters: 200, epoch: 12 | loss: 0.2315684
	speed: 0.3051s/iter; left time: 1971.4633s
	iters: 300, epoch: 12 | loss: 0.2147712
	speed: 0.3052s/iter; left time: 1941.3537s
	iters: 400, epoch: 12 | loss: 0.2114563
	speed: 0.3049s/iter; left time: 1908.8947s
	iters: 500, epoch: 12 | loss: 0.2542222
	speed: 0.3053s/iter; left time: 1880.9332s
	iters: 600, epoch: 12 | loss: 0.2435207
	speed: 0.3049s/iter; left time: 1848.0714s
	iters: 700, epoch: 12 | loss: 0.2315361
	speed: 0.3055s/iter; left time: 1820.8278s
Epoch: 12 cost time: 225.81034922599792
Epoch: 12, Steps: 740 | Train Loss: 0.2311338 Vali Loss: 0.3478765 Test Loss: 0.4255500
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.2109797
	speed: 0.6154s/iter; left time: 3582.1715s
	iters: 200, epoch: 13 | loss: 0.2379804
	speed: 0.3036s/iter; left time: 1736.8445s
	iters: 300, epoch: 13 | loss: 0.2624266
	speed: 0.3037s/iter; left time: 1707.3007s
	iters: 400, epoch: 13 | loss: 0.3070260
	speed: 0.3038s/iter; left time: 1677.5298s
	iters: 500, epoch: 13 | loss: 0.2505067
	speed: 0.3048s/iter; left time: 1652.1410s
	iters: 600, epoch: 13 | loss: 0.2680848
	speed: 0.3058s/iter; left time: 1627.1663s
	iters: 700, epoch: 13 | loss: 0.2449510
	speed: 0.3046s/iter; left time: 1590.3239s
Epoch: 13 cost time: 225.4077775478363
Epoch: 13, Steps: 740 | Train Loss: 0.2310128 Vali Loss: 0.3473365 Test Loss: 0.4255075
Validation loss decreased (0.347515 --> 0.347336).  Saving model ...
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 14 | loss: 0.2429453
	speed: 0.6151s/iter; left time: 3125.3375s
	iters: 200, epoch: 14 | loss: 0.2126708
	speed: 0.3050s/iter; left time: 1519.2968s
	iters: 300, epoch: 14 | loss: 0.2345626
	speed: 0.3047s/iter; left time: 1487.1438s
	iters: 400, epoch: 14 | loss: 0.2365296
	speed: 0.3061s/iter; left time: 1463.6137s
	iters: 500, epoch: 14 | loss: 0.2200037
	speed: 0.3052s/iter; left time: 1428.6726s
	iters: 600, epoch: 14 | loss: 0.2583432
	speed: 0.3049s/iter; left time: 1396.6188s
	iters: 700, epoch: 14 | loss: 0.2448584
	speed: 0.3058s/iter; left time: 1370.1105s
Epoch: 14 cost time: 225.8647699356079
Epoch: 14, Steps: 740 | Train Loss: 0.2308879 Vali Loss: 0.3474936 Test Loss: 0.4254818
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 15 | loss: 0.2222262
	speed: 0.6133s/iter; left time: 2662.4590s
	iters: 200, epoch: 15 | loss: 0.2328629
	speed: 0.3050s/iter; left time: 1293.3173s
	iters: 300, epoch: 15 | loss: 0.2414652
	speed: 0.3052s/iter; left time: 1263.8300s
	iters: 400, epoch: 15 | loss: 0.2275803
	speed: 0.3041s/iter; left time: 1228.8327s
	iters: 500, epoch: 15 | loss: 0.2192105
	speed: 0.3044s/iter; left time: 1199.7490s
	iters: 600, epoch: 15 | loss: 0.2061649
	speed: 0.3047s/iter; left time: 1170.3505s
	iters: 700, epoch: 15 | loss: 0.2192592
	speed: 0.3043s/iter; left time: 1138.2007s
Epoch: 15 cost time: 225.57297563552856
Epoch: 15, Steps: 740 | Train Loss: 0.2308827 Vali Loss: 0.3474907 Test Loss: 0.4254790
EarlyStopping counter: 2 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 16 | loss: 0.2181078
	speed: 0.6155s/iter; left time: 2216.4413s
	iters: 200, epoch: 16 | loss: 0.2762282
	speed: 0.3059s/iter; left time: 1070.8643s
	iters: 300, epoch: 16 | loss: 0.2375954
	speed: 0.3063s/iter; left time: 1041.8129s
	iters: 400, epoch: 16 | loss: 0.2279096
	speed: 0.3047s/iter; left time: 1005.8499s
	iters: 500, epoch: 16 | loss: 0.2222298
	speed: 0.3041s/iter; left time: 973.4585s
	iters: 600, epoch: 16 | loss: 0.2059138
	speed: 0.3034s/iter; left time: 940.8751s
	iters: 700, epoch: 16 | loss: 0.2339707
	speed: 0.3039s/iter; left time: 911.9541s
Epoch: 16 cost time: 225.628351688385
Epoch: 16, Steps: 740 | Train Loss: 0.2308323 Vali Loss: 0.3476854 Test Loss: 0.4254787
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 17 | loss: 0.2595996
	speed: 0.6125s/iter; left time: 1752.4307s
	iters: 200, epoch: 17 | loss: 0.2630889
	speed: 0.3073s/iter; left time: 848.3661s
	iters: 300, epoch: 17 | loss: 0.2117365
	speed: 0.3062s/iter; left time: 814.7225s
	iters: 400, epoch: 17 | loss: 0.2155140
	speed: 0.3049s/iter; left time: 780.7864s
	iters: 500, epoch: 17 | loss: 0.2009583
	speed: 0.3039s/iter; left time: 747.8341s
	iters: 600, epoch: 17 | loss: 0.1949200
	speed: 0.3050s/iter; left time: 720.1112s
	iters: 700, epoch: 17 | loss: 0.2311243
	speed: 0.3056s/iter; left time: 691.0552s
Epoch: 17 cost time: 225.96163201332092
Epoch: 17, Steps: 740 | Train Loss: 0.2307975 Vali Loss: 0.3477081 Test Loss: 0.4254783
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 18 | loss: 0.2870649
	speed: 0.6123s/iter; left time: 1298.7041s
	iters: 200, epoch: 18 | loss: 0.2242540
	speed: 0.3051s/iter; left time: 616.6690s
	iters: 300, epoch: 18 | loss: 0.2293470
	speed: 0.3053s/iter; left time: 586.3996s
	iters: 400, epoch: 18 | loss: 0.2186446
	speed: 0.3060s/iter; left time: 557.3102s
	iters: 500, epoch: 18 | loss: 0.2361505
	speed: 0.3058s/iter; left time: 526.2895s
	iters: 600, epoch: 18 | loss: 0.2339855
	speed: 0.3057s/iter; left time: 495.6087s
	iters: 700, epoch: 18 | loss: 0.2187973
	speed: 0.3050s/iter; left time: 463.8386s
Epoch: 18 cost time: 225.95311069488525
Epoch: 18, Steps: 740 | Train Loss: 0.2308414 Vali Loss: 0.3477508 Test Loss: 0.4254780
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : traffic_336_96_Linear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15227<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3413
mse:0.42576906085014343, mae:0.2980904281139374
