Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='Linear', model_id='weather_336_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=12890, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : weather_336_96_Linear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed12890>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36456
val 5175
test 10444
	iters: 100, epoch: 1 | loss: 0.5219904
	speed: 0.0109s/iter; left time: 497.6617s
	iters: 200, epoch: 1 | loss: 0.3603702
	speed: 0.0098s/iter; left time: 444.9693s
	iters: 300, epoch: 1 | loss: 0.3322654
	speed: 0.0095s/iter; left time: 430.6191s
	iters: 400, epoch: 1 | loss: 0.4728745
	speed: 0.0098s/iter; left time: 442.5898s
	iters: 500, epoch: 1 | loss: 0.9117789
	speed: 0.0095s/iter; left time: 429.9875s
	iters: 600, epoch: 1 | loss: 0.5888936
	speed: 0.0094s/iter; left time: 424.5479s
	iters: 700, epoch: 1 | loss: 0.4502276
	speed: 0.0097s/iter; left time: 433.0227s
	iters: 800, epoch: 1 | loss: 1.4232631
	speed: 0.0104s/iter; left time: 464.0657s
	iters: 900, epoch: 1 | loss: 0.6896417
	speed: 0.0098s/iter; left time: 436.0035s
	iters: 1000, epoch: 1 | loss: 0.4975384
	speed: 0.0097s/iter; left time: 432.8159s
	iters: 1100, epoch: 1 | loss: 0.3209178
	speed: 0.0096s/iter; left time: 427.3474s
	iters: 1200, epoch: 1 | loss: 0.2680887
	speed: 0.0090s/iter; left time: 399.9914s
	iters: 1300, epoch: 1 | loss: 0.4309919
	speed: 0.0094s/iter; left time: 414.4567s
	iters: 1400, epoch: 1 | loss: 2.3680141
	speed: 0.0091s/iter; left time: 400.7521s
	iters: 1500, epoch: 1 | loss: 0.2664349
	speed: 0.0088s/iter; left time: 389.4330s
	iters: 1600, epoch: 1 | loss: 0.5691196
	speed: 0.0091s/iter; left time: 401.4628s
	iters: 1700, epoch: 1 | loss: 2.7819245
	speed: 0.0096s/iter; left time: 423.2285s
	iters: 1800, epoch: 1 | loss: 0.5742649
	speed: 0.0101s/iter; left time: 443.8252s
	iters: 1900, epoch: 1 | loss: 0.2741050
	speed: 0.0095s/iter; left time: 413.5160s
	iters: 2000, epoch: 1 | loss: 0.4451179
	speed: 0.0091s/iter; left time: 395.0473s
	iters: 2100, epoch: 1 | loss: 0.7032652
	speed: 0.0095s/iter; left time: 414.7971s
	iters: 2200, epoch: 1 | loss: 2.4261138
	speed: 0.0086s/iter; left time: 372.7645s
Epoch: 1 cost time: 21.703843593597412
Epoch: 1, Steps: 2278 | Train Loss: 1.3711394 Vali Loss: 0.5541458 Test Loss: 0.2434970
Validation loss decreased (inf --> 0.554146).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.4471132
	speed: 0.0374s/iter; left time: 1616.6210s
	iters: 200, epoch: 2 | loss: 0.4439859
	speed: 0.0090s/iter; left time: 387.7283s
	iters: 300, epoch: 2 | loss: 0.4413393
	speed: 0.0086s/iter; left time: 368.2390s
	iters: 400, epoch: 2 | loss: 0.3396162
	speed: 0.0091s/iter; left time: 389.5967s
	iters: 500, epoch: 2 | loss: 0.4157172
	speed: 0.0092s/iter; left time: 395.5750s
	iters: 600, epoch: 2 | loss: 0.4469962
	speed: 0.0094s/iter; left time: 402.0480s
	iters: 700, epoch: 2 | loss: 3.0339637
	speed: 0.0091s/iter; left time: 388.1209s
	iters: 800, epoch: 2 | loss: 0.5660436
	speed: 0.0094s/iter; left time: 400.8113s
	iters: 900, epoch: 2 | loss: 0.2680046
	speed: 0.0090s/iter; left time: 380.5133s
	iters: 1000, epoch: 2 | loss: 0.3190001
	speed: 0.0097s/iter; left time: 410.5572s
	iters: 1100, epoch: 2 | loss: 0.2762806
	speed: 0.0088s/iter; left time: 369.4003s
	iters: 1200, epoch: 2 | loss: 0.4471242
	speed: 0.0099s/iter; left time: 417.5563s
	iters: 1300, epoch: 2 | loss: 0.6206456
	speed: 0.0089s/iter; left time: 373.9458s
	iters: 1400, epoch: 2 | loss: 1.1379455
	speed: 0.0094s/iter; left time: 392.2415s
	iters: 1500, epoch: 2 | loss: 0.5223639
	speed: 0.0095s/iter; left time: 396.3936s
	iters: 1600, epoch: 2 | loss: 2.3535514
	speed: 0.0083s/iter; left time: 344.9346s
	iters: 1700, epoch: 2 | loss: 0.3837746
	speed: 0.0094s/iter; left time: 392.3727s
	iters: 1800, epoch: 2 | loss: 2.5512276
	speed: 0.0098s/iter; left time: 407.8652s
	iters: 1900, epoch: 2 | loss: 16.8664818
	speed: 0.0103s/iter; left time: 425.8551s
	iters: 2000, epoch: 2 | loss: 0.3190468
	speed: 0.0097s/iter; left time: 401.2746s
	iters: 2100, epoch: 2 | loss: 0.4378212
	speed: 0.0087s/iter; left time: 356.9467s
	iters: 2200, epoch: 2 | loss: 2.6655824
	speed: 0.0078s/iter; left time: 319.0257s
Epoch: 2 cost time: 20.998125314712524
Epoch: 2, Steps: 2278 | Train Loss: 1.0563502 Vali Loss: 0.5060639 Test Loss: 0.1912140
Validation loss decreased (0.554146 --> 0.506064).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.4793212
	speed: 0.0365s/iter; left time: 1493.0305s
	iters: 200, epoch: 3 | loss: 0.5595015
	speed: 0.0098s/iter; left time: 401.5937s
	iters: 300, epoch: 3 | loss: 0.2614974
	speed: 0.0099s/iter; left time: 401.8516s
	iters: 400, epoch: 3 | loss: 0.3011263
	speed: 0.0086s/iter; left time: 349.7205s
	iters: 500, epoch: 3 | loss: 0.3493200
	speed: 0.0090s/iter; left time: 365.2278s
	iters: 600, epoch: 3 | loss: 0.3279898
	speed: 0.0092s/iter; left time: 370.3216s
	iters: 700, epoch: 3 | loss: 2.3597369
	speed: 0.0091s/iter; left time: 367.5683s
	iters: 800, epoch: 3 | loss: 0.3404423
	speed: 0.0093s/iter; left time: 372.5688s
	iters: 900, epoch: 3 | loss: 0.8399234
	speed: 0.0091s/iter; left time: 364.4771s
	iters: 1000, epoch: 3 | loss: 1.9581617
	speed: 0.0081s/iter; left time: 323.2529s
	iters: 1100, epoch: 3 | loss: 0.2214279
	speed: 0.0095s/iter; left time: 380.2557s
	iters: 1200, epoch: 3 | loss: 0.3773689
	speed: 0.0093s/iter; left time: 369.9878s
	iters: 1300, epoch: 3 | loss: 0.3631609
	speed: 0.0080s/iter; left time: 316.0471s
	iters: 1400, epoch: 3 | loss: 2.6331329
	speed: 0.0086s/iter; left time: 340.2755s
	iters: 1500, epoch: 3 | loss: 0.9071003
	speed: 0.0098s/iter; left time: 387.9801s
	iters: 1600, epoch: 3 | loss: 0.2841210
	speed: 0.0100s/iter; left time: 394.4186s
	iters: 1700, epoch: 3 | loss: 0.3710901
	speed: 0.0097s/iter; left time: 380.5325s
	iters: 1800, epoch: 3 | loss: 0.7581400
	speed: 0.0102s/iter; left time: 397.9530s
	iters: 1900, epoch: 3 | loss: 8.5660429
	speed: 0.0090s/iter; left time: 352.5500s
	iters: 2000, epoch: 3 | loss: 0.6376927
	speed: 0.0094s/iter; left time: 367.2683s
	iters: 2100, epoch: 3 | loss: 0.3121388
	speed: 0.0099s/iter; left time: 383.6766s
	iters: 2200, epoch: 3 | loss: 0.6108524
	speed: 0.0088s/iter; left time: 343.3066s
Epoch: 3 cost time: 21.046828746795654
Epoch: 3, Steps: 2278 | Train Loss: 0.7141147 Vali Loss: 0.4265040 Test Loss: 0.1730583
Validation loss decreased (0.506064 --> 0.426504).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.2297484
	speed: 0.0368s/iter; left time: 1420.5086s
	iters: 200, epoch: 4 | loss: 0.5683731
	speed: 0.0090s/iter; left time: 345.8483s
	iters: 300, epoch: 4 | loss: 0.2076189
	speed: 0.0090s/iter; left time: 344.9713s
	iters: 400, epoch: 4 | loss: 0.2680618
	speed: 0.0091s/iter; left time: 348.9629s
	iters: 500, epoch: 4 | loss: 1.0665600
	speed: 0.0102s/iter; left time: 389.6101s
	iters: 600, epoch: 4 | loss: 0.5270491
	speed: 0.0101s/iter; left time: 384.1826s
	iters: 700, epoch: 4 | loss: 0.5717850
	speed: 0.0099s/iter; left time: 375.0357s
	iters: 800, epoch: 4 | loss: 0.3630663
	speed: 0.0093s/iter; left time: 353.3683s
	iters: 900, epoch: 4 | loss: 1.1291196
	speed: 0.0099s/iter; left time: 374.9402s
	iters: 1000, epoch: 4 | loss: 0.3227663
	speed: 0.0092s/iter; left time: 346.4326s
	iters: 1100, epoch: 4 | loss: 0.1824374
	speed: 0.0097s/iter; left time: 363.3025s
	iters: 1200, epoch: 4 | loss: 0.2677001
	speed: 0.0087s/iter; left time: 327.8597s
	iters: 1300, epoch: 4 | loss: 2.6637042
	speed: 0.0104s/iter; left time: 388.8737s
	iters: 1400, epoch: 4 | loss: 0.2304911
	speed: 0.0095s/iter; left time: 354.7022s
	iters: 1500, epoch: 4 | loss: 0.2406422
	speed: 0.0097s/iter; left time: 360.3741s
	iters: 1600, epoch: 4 | loss: 0.3803191
	speed: 0.0102s/iter; left time: 377.0987s
	iters: 1700, epoch: 4 | loss: 0.3915559
	speed: 0.0096s/iter; left time: 355.7336s
	iters: 1800, epoch: 4 | loss: 0.6180480
	speed: 0.0099s/iter; left time: 366.3338s
	iters: 1900, epoch: 4 | loss: 0.3203350
	speed: 0.0093s/iter; left time: 343.8536s
	iters: 2000, epoch: 4 | loss: 0.3037327
	speed: 0.0092s/iter; left time: 337.8893s
	iters: 2100, epoch: 4 | loss: 0.4346239
	speed: 0.0093s/iter; left time: 341.2705s
	iters: 2200, epoch: 4 | loss: 0.2620355
	speed: 0.0097s/iter; left time: 353.6708s
Epoch: 4 cost time: 21.718199968338013
Epoch: 4, Steps: 2278 | Train Loss: 0.5523785 Vali Loss: 0.3988052 Test Loss: 0.1733094
Validation loss decreased (0.426504 --> 0.398805).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.3675086
	speed: 0.0373s/iter; left time: 1354.8935s
	iters: 200, epoch: 5 | loss: 0.2865722
	speed: 0.0095s/iter; left time: 343.4913s
	iters: 300, epoch: 5 | loss: 2.3058176
	speed: 0.0086s/iter; left time: 310.7666s
	iters: 400, epoch: 5 | loss: 0.2436330
	speed: 0.0089s/iter; left time: 320.0190s
	iters: 500, epoch: 5 | loss: 0.4220866
	speed: 0.0090s/iter; left time: 321.9984s
	iters: 600, epoch: 5 | loss: 0.2403370
	speed: 0.0095s/iter; left time: 341.9537s
	iters: 700, epoch: 5 | loss: 0.2544408
	speed: 0.0103s/iter; left time: 367.5237s
	iters: 800, epoch: 5 | loss: 0.4983545
	speed: 0.0092s/iter; left time: 328.9264s
	iters: 900, epoch: 5 | loss: 0.2221109
	speed: 0.0093s/iter; left time: 329.4641s
	iters: 1000, epoch: 5 | loss: 0.1760964
	speed: 0.0099s/iter; left time: 349.2337s
	iters: 1100, epoch: 5 | loss: 0.4314113
	speed: 0.0100s/iter; left time: 352.1565s
	iters: 1200, epoch: 5 | loss: 0.3067050
	speed: 0.0094s/iter; left time: 332.6585s
	iters: 1300, epoch: 5 | loss: 0.1913127
	speed: 0.0094s/iter; left time: 329.0349s
	iters: 1400, epoch: 5 | loss: 0.2405246
	speed: 0.0088s/iter; left time: 308.6961s
	iters: 1500, epoch: 5 | loss: 0.3004516
	speed: 0.0094s/iter; left time: 329.8083s
	iters: 1600, epoch: 5 | loss: 0.6472418
	speed: 0.0101s/iter; left time: 350.5435s
	iters: 1700, epoch: 5 | loss: 0.1997098
	speed: 0.0102s/iter; left time: 355.4655s
	iters: 1800, epoch: 5 | loss: 0.3443905
	speed: 0.0094s/iter; left time: 324.7380s
	iters: 1900, epoch: 5 | loss: 0.3337962
	speed: 0.0094s/iter; left time: 323.9671s
	iters: 2000, epoch: 5 | loss: 1.1564946
	speed: 0.0092s/iter; left time: 315.6122s
	iters: 2100, epoch: 5 | loss: 0.2892910
	speed: 0.0087s/iter; left time: 298.7495s
	iters: 2200, epoch: 5 | loss: 0.2575090
	speed: 0.0089s/iter; left time: 306.1112s
Epoch: 5 cost time: 21.490721225738525
Epoch: 5, Steps: 2278 | Train Loss: 0.5042780 Vali Loss: 0.3836240 Test Loss: 0.1554679
Validation loss decreased (0.398805 --> 0.383624).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.2675962
	speed: 0.0375s/iter; left time: 1277.3722s
	iters: 200, epoch: 6 | loss: 0.2382270
	speed: 0.0093s/iter; left time: 315.1035s
	iters: 300, epoch: 6 | loss: 0.2232710
	speed: 0.0092s/iter; left time: 312.5348s
	iters: 400, epoch: 6 | loss: 0.3092923
	speed: 0.0091s/iter; left time: 308.5702s
	iters: 500, epoch: 6 | loss: 0.5947019
	speed: 0.0093s/iter; left time: 314.0463s
	iters: 600, epoch: 6 | loss: 0.2416407
	speed: 0.0093s/iter; left time: 313.3037s
	iters: 700, epoch: 6 | loss: 0.2760933
	speed: 0.0088s/iter; left time: 295.2090s
	iters: 800, epoch: 6 | loss: 1.4139327
	speed: 0.0093s/iter; left time: 309.1764s
	iters: 900, epoch: 6 | loss: 0.2492194
	speed: 0.0091s/iter; left time: 303.8840s
	iters: 1000, epoch: 6 | loss: 0.4038568
	speed: 0.0087s/iter; left time: 289.7571s
	iters: 1100, epoch: 6 | loss: 0.3320267
	speed: 0.0087s/iter; left time: 286.9510s
	iters: 1200, epoch: 6 | loss: 0.2283296
	speed: 0.0102s/iter; left time: 335.4218s
	iters: 1300, epoch: 6 | loss: 0.2433061
	speed: 0.0100s/iter; left time: 330.0868s
	iters: 1400, epoch: 6 | loss: 0.2803347
	speed: 0.0095s/iter; left time: 312.6428s
	iters: 1500, epoch: 6 | loss: 0.2969945
	speed: 0.0087s/iter; left time: 283.8300s
	iters: 1600, epoch: 6 | loss: 2.1762288
	speed: 0.0083s/iter; left time: 271.7007s
	iters: 1700, epoch: 6 | loss: 0.3844890
	speed: 0.0096s/iter; left time: 310.1127s
	iters: 1800, epoch: 6 | loss: 0.2171611
	speed: 0.0096s/iter; left time: 311.5002s
	iters: 1900, epoch: 6 | loss: 0.6935717
	speed: 0.0092s/iter; left time: 296.2604s
	iters: 2000, epoch: 6 | loss: 0.2986380
	speed: 0.0083s/iter; left time: 267.2426s
	iters: 2100, epoch: 6 | loss: 0.2617067
	speed: 0.0085s/iter; left time: 273.2491s
	iters: 2200, epoch: 6 | loss: 0.4515941
	speed: 0.0097s/iter; left time: 309.2150s
Epoch: 6 cost time: 20.940022945404053
Epoch: 6, Steps: 2278 | Train Loss: 0.4839961 Vali Loss: 0.3734530 Test Loss: 0.1540293
Validation loss decreased (0.383624 --> 0.373453).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.2715648
	speed: 0.0371s/iter; left time: 1179.8954s
	iters: 200, epoch: 7 | loss: 0.4452274
	speed: 0.0097s/iter; left time: 307.7544s
	iters: 300, epoch: 7 | loss: 0.2308744
	speed: 0.0094s/iter; left time: 297.0158s
	iters: 400, epoch: 7 | loss: 0.2386341
	speed: 0.0088s/iter; left time: 277.0391s
	iters: 500, epoch: 7 | loss: 0.2712703
	speed: 0.0092s/iter; left time: 288.3818s
	iters: 600, epoch: 7 | loss: 0.2734202
	speed: 0.0088s/iter; left time: 276.2420s
	iters: 700, epoch: 7 | loss: 0.1908825
	speed: 0.0090s/iter; left time: 280.6035s
	iters: 800, epoch: 7 | loss: 0.2667392
	speed: 0.0098s/iter; left time: 304.7793s
	iters: 900, epoch: 7 | loss: 0.3449874
	speed: 0.0086s/iter; left time: 267.4688s
	iters: 1000, epoch: 7 | loss: 0.3542264
	speed: 0.0091s/iter; left time: 280.7199s
	iters: 1100, epoch: 7 | loss: 0.6177665
	speed: 0.0088s/iter; left time: 269.9755s
	iters: 1200, epoch: 7 | loss: 0.3630393
	speed: 0.0085s/iter; left time: 260.7428s
	iters: 1300, epoch: 7 | loss: 0.2706304
	speed: 0.0089s/iter; left time: 272.0258s
	iters: 1400, epoch: 7 | loss: 0.2777510
	speed: 0.0082s/iter; left time: 248.6871s
	iters: 1500, epoch: 7 | loss: 0.2436712
	speed: 0.0089s/iter; left time: 269.4986s
	iters: 1600, epoch: 7 | loss: 1.6494694
	speed: 0.0098s/iter; left time: 296.2652s
	iters: 1700, epoch: 7 | loss: 0.2467679
	speed: 0.0093s/iter; left time: 281.1039s
	iters: 1800, epoch: 7 | loss: 0.3485411
	speed: 0.0099s/iter; left time: 296.8965s
	iters: 1900, epoch: 7 | loss: 0.3278626
	speed: 0.0103s/iter; left time: 309.7557s
	iters: 2000, epoch: 7 | loss: 0.4843438
	speed: 0.0088s/iter; left time: 262.0721s
	iters: 2100, epoch: 7 | loss: 0.2844275
	speed: 0.0091s/iter; left time: 272.5195s
	iters: 2200, epoch: 7 | loss: 0.2490468
	speed: 0.0093s/iter; left time: 275.4603s
Epoch: 7 cost time: 20.97199010848999
Epoch: 7, Steps: 2278 | Train Loss: 0.4742687 Vali Loss: 0.3679554 Test Loss: 0.1468757
Validation loss decreased (0.373453 --> 0.367955).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.6036426
	speed: 0.0392s/iter; left time: 1156.7957s
	iters: 200, epoch: 8 | loss: 0.2371254
	speed: 0.0090s/iter; left time: 263.3992s
	iters: 300, epoch: 8 | loss: 0.2912959
	speed: 0.0100s/iter; left time: 292.5986s
	iters: 400, epoch: 8 | loss: 0.3866325
	speed: 0.0093s/iter; left time: 270.7222s
	iters: 500, epoch: 8 | loss: 0.2157902
	speed: 0.0088s/iter; left time: 256.6407s
	iters: 600, epoch: 8 | loss: 0.2171731
	speed: 0.0094s/iter; left time: 273.6650s
	iters: 700, epoch: 8 | loss: 0.2306143
	speed: 0.0091s/iter; left time: 261.8692s
	iters: 800, epoch: 8 | loss: 0.1729324
	speed: 0.0090s/iter; left time: 258.3246s
	iters: 900, epoch: 8 | loss: 0.3435588
	speed: 0.0088s/iter; left time: 253.3227s
	iters: 1000, epoch: 8 | loss: 0.2751406
	speed: 0.0089s/iter; left time: 253.3789s
	iters: 1100, epoch: 8 | loss: 0.2331983
	speed: 0.0099s/iter; left time: 281.2318s
	iters: 1200, epoch: 8 | loss: 2.1387618
	speed: 0.0101s/iter; left time: 285.6322s
	iters: 1300, epoch: 8 | loss: 0.2934309
	speed: 0.0087s/iter; left time: 245.1182s
	iters: 1400, epoch: 8 | loss: 0.2615528
	speed: 0.0090s/iter; left time: 253.4888s
	iters: 1500, epoch: 8 | loss: 0.2259584
	speed: 0.0095s/iter; left time: 267.3905s
	iters: 1600, epoch: 8 | loss: 0.2509675
	speed: 0.0095s/iter; left time: 266.7522s
	iters: 1700, epoch: 8 | loss: 0.5476960
	speed: 0.0100s/iter; left time: 277.8169s
	iters: 1800, epoch: 8 | loss: 0.2048820
	speed: 0.0092s/iter; left time: 254.8168s
	iters: 1900, epoch: 8 | loss: 0.1826921
	speed: 0.0092s/iter; left time: 255.1602s
	iters: 2000, epoch: 8 | loss: 5.0479503
	speed: 0.0090s/iter; left time: 248.2970s
	iters: 2100, epoch: 8 | loss: 0.1798619
	speed: 0.0087s/iter; left time: 238.7466s
	iters: 2200, epoch: 8 | loss: 0.5162660
	speed: 0.0098s/iter; left time: 267.6239s
Epoch: 8 cost time: 21.185957670211792
Epoch: 8, Steps: 2278 | Train Loss: 0.4694004 Vali Loss: 0.3687263 Test Loss: 0.1491326
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.2614664
	speed: 0.0360s/iter; left time: 980.3648s
	iters: 200, epoch: 9 | loss: 0.2622046
	speed: 0.0097s/iter; left time: 262.5866s
	iters: 300, epoch: 9 | loss: 0.1998437
	speed: 0.0094s/iter; left time: 254.9890s
	iters: 400, epoch: 9 | loss: 0.2139809
	speed: 0.0099s/iter; left time: 265.3733s
	iters: 500, epoch: 9 | loss: 0.2373429
	speed: 0.0103s/iter; left time: 276.3773s
	iters: 600, epoch: 9 | loss: 0.2409233
	speed: 0.0100s/iter; left time: 266.3650s
	iters: 700, epoch: 9 | loss: 0.1876636
	speed: 0.0092s/iter; left time: 245.7676s
	iters: 800, epoch: 9 | loss: 0.2469022
	speed: 0.0088s/iter; left time: 233.4464s
	iters: 900, epoch: 9 | loss: 0.4507893
	speed: 0.0082s/iter; left time: 217.8928s
	iters: 1000, epoch: 9 | loss: 0.2425386
	speed: 0.0088s/iter; left time: 230.8823s
	iters: 1100, epoch: 9 | loss: 0.2057246
	speed: 0.0094s/iter; left time: 245.4611s
	iters: 1200, epoch: 9 | loss: 0.3856013
	speed: 0.0086s/iter; left time: 224.3720s
	iters: 1300, epoch: 9 | loss: 1.2015938
	speed: 0.0096s/iter; left time: 250.6495s
	iters: 1400, epoch: 9 | loss: 0.2694854
	speed: 0.0090s/iter; left time: 234.0865s
	iters: 1500, epoch: 9 | loss: 0.3605822
	speed: 0.0095s/iter; left time: 244.8022s
	iters: 1600, epoch: 9 | loss: 0.2759636
	speed: 0.0099s/iter; left time: 253.5604s
	iters: 1700, epoch: 9 | loss: 0.2381456
	speed: 0.0091s/iter; left time: 234.5113s
	iters: 1800, epoch: 9 | loss: 0.3990333
	speed: 0.0093s/iter; left time: 236.9097s
	iters: 1900, epoch: 9 | loss: 0.3006291
	speed: 0.0097s/iter; left time: 247.8048s
	iters: 2000, epoch: 9 | loss: 0.2242880
	speed: 0.0095s/iter; left time: 239.7070s
	iters: 2100, epoch: 9 | loss: 0.1972627
	speed: 0.0093s/iter; left time: 233.9952s
	iters: 2200, epoch: 9 | loss: 0.4232851
	speed: 0.0093s/iter; left time: 232.8567s
Epoch: 9 cost time: 21.27840256690979
Epoch: 9, Steps: 2278 | Train Loss: 0.4670652 Vali Loss: 0.3666172 Test Loss: 0.1464657
Validation loss decreased (0.367955 --> 0.366617).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.3092275
	speed: 0.0379s/iter; left time: 945.8918s
	iters: 200, epoch: 10 | loss: 0.2411598
	speed: 0.0091s/iter; left time: 227.3818s
	iters: 300, epoch: 10 | loss: 0.3059662
	speed: 0.0094s/iter; left time: 232.0218s
	iters: 400, epoch: 10 | loss: 0.6674044
	speed: 0.0095s/iter; left time: 234.7921s
	iters: 500, epoch: 10 | loss: 0.1771795
	speed: 0.0093s/iter; left time: 228.8181s
	iters: 600, epoch: 10 | loss: 0.5762612
	speed: 0.0094s/iter; left time: 230.9422s
	iters: 700, epoch: 10 | loss: 0.2525994
	speed: 0.0092s/iter; left time: 224.6112s
	iters: 800, epoch: 10 | loss: 0.3177472
	speed: 0.0093s/iter; left time: 225.0361s
	iters: 900, epoch: 10 | loss: 0.7276019
	speed: 0.0092s/iter; left time: 223.3974s
	iters: 1000, epoch: 10 | loss: 0.2094908
	speed: 0.0092s/iter; left time: 222.3454s
	iters: 1100, epoch: 10 | loss: 0.2348161
	speed: 0.0093s/iter; left time: 222.0269s
	iters: 1200, epoch: 10 | loss: 0.4376736
	speed: 0.0092s/iter; left time: 218.5430s
	iters: 1300, epoch: 10 | loss: 0.2337248
	speed: 0.0094s/iter; left time: 222.9917s
	iters: 1400, epoch: 10 | loss: 0.2688916
	speed: 0.0097s/iter; left time: 228.8383s
	iters: 1500, epoch: 10 | loss: 0.3609531
	speed: 0.0095s/iter; left time: 223.1810s
	iters: 1600, epoch: 10 | loss: 0.9181622
	speed: 0.0094s/iter; left time: 220.4651s
	iters: 1700, epoch: 10 | loss: 0.3563374
	speed: 0.0093s/iter; left time: 217.6408s
	iters: 1800, epoch: 10 | loss: 1.7666448
	speed: 0.0095s/iter; left time: 222.0671s
	iters: 1900, epoch: 10 | loss: 0.1554995
	speed: 0.0094s/iter; left time: 217.0364s
	iters: 2000, epoch: 10 | loss: 0.4423899
	speed: 0.0094s/iter; left time: 217.7239s
	iters: 2100, epoch: 10 | loss: 0.1926724
	speed: 0.0092s/iter; left time: 211.6384s
	iters: 2200, epoch: 10 | loss: 0.2543816
	speed: 0.0096s/iter; left time: 218.4699s
Epoch: 10 cost time: 21.371806859970093
Epoch: 10, Steps: 2278 | Train Loss: 0.4658408 Vali Loss: 0.3665291 Test Loss: 0.1457018
Validation loss decreased (0.366617 --> 0.366529).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.2802321
	speed: 0.0375s/iter; left time: 850.7546s
	iters: 200, epoch: 11 | loss: 0.3436670
	speed: 0.0092s/iter; left time: 207.6812s
	iters: 300, epoch: 11 | loss: 0.1847647
	speed: 0.0095s/iter; left time: 213.0556s
	iters: 400, epoch: 11 | loss: 0.4827853
	speed: 0.0096s/iter; left time: 215.6159s
	iters: 500, epoch: 11 | loss: 0.2139010
	speed: 0.0095s/iter; left time: 211.4518s
	iters: 600, epoch: 11 | loss: 0.2524477
	speed: 0.0094s/iter; left time: 207.7689s
	iters: 700, epoch: 11 | loss: 0.2250600
	speed: 0.0094s/iter; left time: 207.2183s
	iters: 800, epoch: 11 | loss: 0.3326921
	speed: 0.0094s/iter; left time: 205.9965s
	iters: 900, epoch: 11 | loss: 0.1986104
	speed: 0.0093s/iter; left time: 202.9860s
	iters: 1000, epoch: 11 | loss: 0.1794658
	speed: 0.0096s/iter; left time: 208.2709s
	iters: 1100, epoch: 11 | loss: 0.4524875
	speed: 0.0095s/iter; left time: 204.9385s
	iters: 1200, epoch: 11 | loss: 0.2465027
	speed: 0.0093s/iter; left time: 201.0906s
	iters: 1300, epoch: 11 | loss: 0.3068907
	speed: 0.0099s/iter; left time: 212.2800s
	iters: 1400, epoch: 11 | loss: 0.2922715
	speed: 0.0092s/iter; left time: 195.6594s
	iters: 1500, epoch: 11 | loss: 0.3338330
	speed: 0.0095s/iter; left time: 201.1487s
	iters: 1600, epoch: 11 | loss: 2.2432835
	speed: 0.0095s/iter; left time: 200.9461s
	iters: 1700, epoch: 11 | loss: 0.2875257
	speed: 0.0094s/iter; left time: 198.9375s
	iters: 1800, epoch: 11 | loss: 0.6287430
	speed: 0.0095s/iter; left time: 198.7304s
	iters: 1900, epoch: 11 | loss: 0.3263565
	speed: 0.0096s/iter; left time: 199.6635s
	iters: 2000, epoch: 11 | loss: 0.2622186
	speed: 0.0090s/iter; left time: 186.8507s
	iters: 2100, epoch: 11 | loss: 0.2539864
	speed: 0.0092s/iter; left time: 189.3682s
	iters: 2200, epoch: 11 | loss: 0.2320226
	speed: 0.0093s/iter; left time: 191.4501s
Epoch: 11 cost time: 21.42424702644348
Epoch: 11, Steps: 2278 | Train Loss: 0.4651452 Vali Loss: 0.3659345 Test Loss: 0.1454770
Validation loss decreased (0.366529 --> 0.365934).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.2267164
	speed: 0.0368s/iter; left time: 751.4274s
	iters: 200, epoch: 12 | loss: 0.2386293
	speed: 0.0095s/iter; left time: 191.9930s
	iters: 300, epoch: 12 | loss: 0.8021147
	speed: 0.0097s/iter; left time: 196.3795s
	iters: 400, epoch: 12 | loss: 0.4125252
	speed: 0.0099s/iter; left time: 199.2603s
	iters: 500, epoch: 12 | loss: 0.2940893
	speed: 0.0096s/iter; left time: 191.3605s
	iters: 600, epoch: 12 | loss: 0.4137518
	speed: 0.0093s/iter; left time: 184.2311s
	iters: 700, epoch: 12 | loss: 0.1890423
	speed: 0.0091s/iter; left time: 180.9366s
	iters: 800, epoch: 12 | loss: 0.3308052
	speed: 0.0093s/iter; left time: 182.9727s
	iters: 900, epoch: 12 | loss: 0.2212180
	speed: 0.0096s/iter; left time: 187.5407s
	iters: 1000, epoch: 12 | loss: 1.6624186
	speed: 0.0093s/iter; left time: 180.7355s
	iters: 1100, epoch: 12 | loss: 0.3016623
	speed: 0.0092s/iter; left time: 178.4218s
	iters: 1200, epoch: 12 | loss: 0.3103060
	speed: 0.0093s/iter; left time: 179.4617s
	iters: 1300, epoch: 12 | loss: 0.3612492
	speed: 0.0096s/iter; left time: 184.6754s
	iters: 1400, epoch: 12 | loss: 0.2718339
	speed: 0.0094s/iter; left time: 178.9927s
	iters: 1500, epoch: 12 | loss: 0.2240344
	speed: 0.0091s/iter; left time: 172.1049s
	iters: 1600, epoch: 12 | loss: 0.3224623
	speed: 0.0094s/iter; left time: 177.2161s
	iters: 1700, epoch: 12 | loss: 0.6528386
	speed: 0.0093s/iter; left time: 175.7922s
	iters: 1800, epoch: 12 | loss: 0.2250261
	speed: 0.0096s/iter; left time: 180.1215s
	iters: 1900, epoch: 12 | loss: 0.3976301
	speed: 0.0094s/iter; left time: 174.5515s
	iters: 2000, epoch: 12 | loss: 2.3082693
	speed: 0.0093s/iter; left time: 172.3029s
	iters: 2100, epoch: 12 | loss: 0.2495461
	speed: 0.0096s/iter; left time: 175.7725s
	iters: 2200, epoch: 12 | loss: 0.2595835
	speed: 0.0093s/iter; left time: 170.8331s
Epoch: 12 cost time: 21.448360681533813
Epoch: 12, Steps: 2278 | Train Loss: 0.4648469 Vali Loss: 0.3661840 Test Loss: 0.1456294
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.2600017
	speed: 0.0371s/iter; left time: 671.5878s
	iters: 200, epoch: 13 | loss: 0.2697239
	speed: 0.0091s/iter; left time: 164.3250s
	iters: 300, epoch: 13 | loss: 2.1190598
	speed: 0.0095s/iter; left time: 170.0638s
	iters: 400, epoch: 13 | loss: 0.2104404
	speed: 0.0097s/iter; left time: 173.6485s
	iters: 500, epoch: 13 | loss: 0.2385089
	speed: 0.0097s/iter; left time: 172.5018s
	iters: 600, epoch: 13 | loss: 0.2878304
	speed: 0.0093s/iter; left time: 163.6665s
	iters: 700, epoch: 13 | loss: 0.3789653
	speed: 0.0096s/iter; left time: 168.3689s
	iters: 800, epoch: 13 | loss: 0.3175884
	speed: 0.0094s/iter; left time: 164.6135s
	iters: 900, epoch: 13 | loss: 0.2825051
	speed: 0.0096s/iter; left time: 166.3540s
	iters: 1000, epoch: 13 | loss: 0.1751813
	speed: 0.0094s/iter; left time: 162.2171s
	iters: 1100, epoch: 13 | loss: 0.2226573
	speed: 0.0095s/iter; left time: 162.1971s
	iters: 1200, epoch: 13 | loss: 0.1988596
	speed: 0.0094s/iter; left time: 160.7156s
	iters: 1300, epoch: 13 | loss: 0.2104957
	speed: 0.0093s/iter; left time: 157.3453s
	iters: 1400, epoch: 13 | loss: 0.4126058
	speed: 0.0095s/iter; left time: 160.2858s
	iters: 1500, epoch: 13 | loss: 0.1387158
	speed: 0.0095s/iter; left time: 158.3283s
	iters: 1600, epoch: 13 | loss: 0.1729567
	speed: 0.0095s/iter; left time: 157.9301s
	iters: 1700, epoch: 13 | loss: 0.3907970
	speed: 0.0096s/iter; left time: 159.2196s
	iters: 1800, epoch: 13 | loss: 0.2866605
	speed: 0.0093s/iter; left time: 152.0275s
	iters: 1900, epoch: 13 | loss: 0.2500334
	speed: 0.0095s/iter; left time: 155.3585s
	iters: 2000, epoch: 13 | loss: 0.2480764
	speed: 0.0092s/iter; left time: 148.6963s
	iters: 2100, epoch: 13 | loss: 0.2627524
	speed: 0.0097s/iter; left time: 156.2871s
	iters: 2200, epoch: 13 | loss: 0.2446166
	speed: 0.0094s/iter; left time: 151.0628s
Epoch: 13 cost time: 21.59376358985901
Epoch: 13, Steps: 2278 | Train Loss: 0.4647133 Vali Loss: 0.3662264 Test Loss: 0.1455381
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.2570922
	speed: 0.0370s/iter; left time: 585.9101s
	iters: 200, epoch: 14 | loss: 0.2702502
	speed: 0.0093s/iter; left time: 146.3449s
	iters: 300, epoch: 14 | loss: 0.2101243
	speed: 0.0096s/iter; left time: 149.9854s
	iters: 400, epoch: 14 | loss: 0.2244494
	speed: 0.0094s/iter; left time: 146.7933s
	iters: 500, epoch: 14 | loss: 0.5473561
	speed: 0.0095s/iter; left time: 146.6750s
	iters: 600, epoch: 14 | loss: 0.2538296
	speed: 0.0094s/iter; left time: 143.9008s
	iters: 700, epoch: 14 | loss: 0.3473937
	speed: 0.0091s/iter; left time: 138.5467s
	iters: 800, epoch: 14 | loss: 0.2265005
	speed: 0.0093s/iter; left time: 140.8225s
	iters: 900, epoch: 14 | loss: 0.2215189
	speed: 0.0095s/iter; left time: 143.0319s
	iters: 1000, epoch: 14 | loss: 0.2391560
	speed: 0.0094s/iter; left time: 140.5316s
	iters: 1100, epoch: 14 | loss: 0.3763244
	speed: 0.0095s/iter; left time: 141.3196s
	iters: 1200, epoch: 14 | loss: 0.2091105
	speed: 0.0096s/iter; left time: 142.2037s
	iters: 1300, epoch: 14 | loss: 0.3600501
	speed: 0.0095s/iter; left time: 139.6139s
	iters: 1400, epoch: 14 | loss: 0.2098944
	speed: 0.0095s/iter; left time: 137.5621s
	iters: 1500, epoch: 14 | loss: 0.2525080
	speed: 0.0093s/iter; left time: 134.6064s
	iters: 1600, epoch: 14 | loss: 0.2576673
	speed: 0.0096s/iter; left time: 137.9928s
	iters: 1700, epoch: 14 | loss: 0.2786656
	speed: 0.0098s/iter; left time: 139.0281s
	iters: 1800, epoch: 14 | loss: 0.2097907
	speed: 0.0094s/iter; left time: 133.5388s
	iters: 1900, epoch: 14 | loss: 0.2065416
	speed: 0.0096s/iter; left time: 134.4874s
	iters: 2000, epoch: 14 | loss: 0.5419595
	speed: 0.0090s/iter; left time: 126.1745s
	iters: 2100, epoch: 14 | loss: 0.4416843
	speed: 0.0094s/iter; left time: 130.5405s
	iters: 2200, epoch: 14 | loss: 0.2819642
	speed: 0.0093s/iter; left time: 127.5758s
Epoch: 14 cost time: 21.44970464706421
Epoch: 14, Steps: 2278 | Train Loss: 0.4645987 Vali Loss: 0.3664253 Test Loss: 0.1455791
EarlyStopping counter: 3 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.2171359
	speed: 0.0371s/iter; left time: 503.0521s
	iters: 200, epoch: 15 | loss: 0.3001036
	speed: 0.0100s/iter; left time: 134.8228s
	iters: 300, epoch: 15 | loss: 0.2673931
	speed: 0.0098s/iter; left time: 130.4392s
	iters: 400, epoch: 15 | loss: 0.3529245
	speed: 0.0098s/iter; left time: 130.4264s
	iters: 500, epoch: 15 | loss: 0.3264663
	speed: 0.0100s/iter; left time: 131.5018s
	iters: 600, epoch: 15 | loss: 0.2612202
	speed: 0.0093s/iter; left time: 122.1280s
	iters: 700, epoch: 15 | loss: 0.2387843
	speed: 0.0093s/iter; left time: 120.8531s
	iters: 800, epoch: 15 | loss: 0.2559547
	speed: 0.0091s/iter; left time: 117.3182s
	iters: 900, epoch: 15 | loss: 0.7615294
	speed: 0.0092s/iter; left time: 117.7650s
	iters: 1000, epoch: 15 | loss: 0.5251316
	speed: 0.0090s/iter; left time: 114.5919s
	iters: 1100, epoch: 15 | loss: 0.3624512
	speed: 0.0091s/iter; left time: 114.4586s
	iters: 1200, epoch: 15 | loss: 0.4757890
	speed: 0.0088s/iter; left time: 109.5636s
	iters: 1300, epoch: 15 | loss: 0.6233027
	speed: 0.0090s/iter; left time: 110.7877s
	iters: 1400, epoch: 15 | loss: 0.2282758
	speed: 0.0091s/iter; left time: 111.5534s
	iters: 1500, epoch: 15 | loss: 1.0185277
	speed: 0.0091s/iter; left time: 110.4598s
	iters: 1600, epoch: 15 | loss: 0.3947667
	speed: 0.0087s/iter; left time: 105.2517s
	iters: 1700, epoch: 15 | loss: 0.3377519
	speed: 0.0088s/iter; left time: 105.1182s
	iters: 1800, epoch: 15 | loss: 0.2393354
	speed: 0.0089s/iter; left time: 106.1889s
	iters: 1900, epoch: 15 | loss: 0.1753912
	speed: 0.0092s/iter; left time: 108.0069s
	iters: 2000, epoch: 15 | loss: 0.5935028
	speed: 0.0090s/iter; left time: 104.8630s
	iters: 2100, epoch: 15 | loss: 1.5048019
	speed: 0.0090s/iter; left time: 104.3183s
	iters: 2200, epoch: 15 | loss: 0.2698268
	speed: 0.0090s/iter; left time: 102.8894s
Epoch: 15 cost time: 20.97600221633911
Epoch: 15, Steps: 2278 | Train Loss: 0.4645869 Vali Loss: 0.3661915 Test Loss: 0.1454985
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.2674758
	speed: 0.0350s/iter; left time: 395.4204s
	iters: 200, epoch: 16 | loss: 0.3663714
	speed: 0.0091s/iter; left time: 102.3602s
	iters: 300, epoch: 16 | loss: 0.2213951
	speed: 0.0094s/iter; left time: 104.4423s
	iters: 400, epoch: 16 | loss: 0.4541449
	speed: 0.0090s/iter; left time: 99.1011s
	iters: 500, epoch: 16 | loss: 0.2974805
	speed: 0.0087s/iter; left time: 94.7128s
	iters: 600, epoch: 16 | loss: 0.5034227
	speed: 0.0080s/iter; left time: 86.2309s
	iters: 700, epoch: 16 | loss: 1.2492646
	speed: 0.0077s/iter; left time: 82.0119s
	iters: 800, epoch: 16 | loss: 0.1867453
	speed: 0.0091s/iter; left time: 96.8979s
	iters: 900, epoch: 16 | loss: 0.4033804
	speed: 0.0100s/iter; left time: 105.3680s
	iters: 1000, epoch: 16 | loss: 0.2014646
	speed: 0.0087s/iter; left time: 90.2645s
	iters: 1100, epoch: 16 | loss: 0.2900472
	speed: 0.0093s/iter; left time: 96.0326s
	iters: 1200, epoch: 16 | loss: 0.3169235
	speed: 0.0095s/iter; left time: 97.1899s
	iters: 1300, epoch: 16 | loss: 0.3758922
	speed: 0.0092s/iter; left time: 92.7565s
	iters: 1400, epoch: 16 | loss: 0.4244805
	speed: 0.0089s/iter; left time: 89.3876s
	iters: 1500, epoch: 16 | loss: 0.4126403
	speed: 0.0091s/iter; left time: 90.2709s
	iters: 1600, epoch: 16 | loss: 0.3555264
	speed: 0.0081s/iter; left time: 78.9313s
	iters: 1700, epoch: 16 | loss: 0.3478228
	speed: 0.0079s/iter; left time: 76.6682s
	iters: 1800, epoch: 16 | loss: 0.5361061
	speed: 0.0081s/iter; left time: 78.0865s
	iters: 1900, epoch: 16 | loss: 0.4600747
	speed: 0.0086s/iter; left time: 81.6403s
	iters: 2000, epoch: 16 | loss: 0.2538162
	speed: 0.0097s/iter; left time: 91.1103s
	iters: 2100, epoch: 16 | loss: 0.3748768
	speed: 0.0088s/iter; left time: 82.1023s
	iters: 2200, epoch: 16 | loss: 0.2265573
	speed: 0.0081s/iter; left time: 74.0944s
Epoch: 16 cost time: 20.126522302627563
Epoch: 16, Steps: 2278 | Train Loss: 0.4645382 Vali Loss: 0.3660609 Test Loss: 0.1455035
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : weather_336_96_Linear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed12890<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
mse:0.1455203741788864, mae:0.21197551488876343
