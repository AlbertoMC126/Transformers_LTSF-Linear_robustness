Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='DLinear', model_id='traffic_336_720', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=720, root_path='./dataset/', save_pred_values=False, seed=28649, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_336_720_DLinear_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed28649>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11225
val 1037
test 2789
	iters: 100, epoch: 1 | loss: 0.5891709
	speed: 0.5927s/iter; left time: 8251.1215s
	iters: 200, epoch: 1 | loss: 0.5890749
	speed: 0.5797s/iter; left time: 8012.1660s
	iters: 300, epoch: 1 | loss: 0.6019272
	speed: 0.5730s/iter; left time: 7862.2639s
	iters: 400, epoch: 1 | loss: 0.6279340
	speed: 0.5943s/iter; left time: 8094.3550s
	iters: 500, epoch: 1 | loss: 0.6140510
	speed: 0.5769s/iter; left time: 7799.9683s
	iters: 600, epoch: 1 | loss: 0.6000480
	speed: 0.5830s/iter; left time: 7824.0800s
	iters: 700, epoch: 1 | loss: 0.6584191
	speed: 0.5735s/iter; left time: 7639.6184s
Epoch: 1 cost time: 408.2925148010254
Epoch: 1, Steps: 701 | Train Loss: 0.6168824 Vali Loss: 0.8592145 Test Loss: 1.0083811
Validation loss decreased (inf --> 0.859214).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.6381443
	speed: 1.1006s/iter; left time: 14549.6341s
	iters: 200, epoch: 2 | loss: 0.5836772
	speed: 0.5834s/iter; left time: 7654.5453s
	iters: 300, epoch: 2 | loss: 0.6255770
	speed: 0.5758s/iter; left time: 7496.6799s
	iters: 400, epoch: 2 | loss: 0.5968702
	speed: 0.5793s/iter; left time: 7485.0324s
	iters: 500, epoch: 2 | loss: 0.5763974
	speed: 0.5775s/iter; left time: 7403.7799s
	iters: 600, epoch: 2 | loss: 0.6255645
	speed: 0.5821s/iter; left time: 7404.6114s
	iters: 700, epoch: 2 | loss: 0.6383083
	speed: 0.5795s/iter; left time: 7313.4645s
Epoch: 2 cost time: 406.5599913597107
Epoch: 2, Steps: 701 | Train Loss: 0.6106143 Vali Loss: 0.8794165 Test Loss: 1.0112194
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.3918967
	speed: 1.0147s/iter; left time: 12702.9953s
	iters: 200, epoch: 3 | loss: 0.3721336
	speed: 0.5760s/iter; left time: 7152.8206s
	iters: 300, epoch: 3 | loss: 0.3979979
	speed: 0.5843s/iter; left time: 7197.5546s
	iters: 400, epoch: 3 | loss: 0.3713148
	speed: 0.5750s/iter; left time: 7026.3697s
	iters: 500, epoch: 3 | loss: 0.4039962
	speed: 0.5798s/iter; left time: 7026.2448s
	iters: 600, epoch: 3 | loss: 0.4345946
	speed: 0.5724s/iter; left time: 6880.1893s
	iters: 700, epoch: 3 | loss: 0.3902949
	speed: 0.5868s/iter; left time: 6993.9162s
Epoch: 3 cost time: 406.534423828125
Epoch: 3, Steps: 701 | Train Loss: 0.3911802 Vali Loss: 0.5737550 Test Loss: 0.6598499
Validation loss decreased (0.859214 --> 0.573755).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.3012648
	speed: 1.1133s/iter; left time: 13157.4917s
	iters: 200, epoch: 4 | loss: 0.3085533
	speed: 0.5725s/iter; left time: 6709.0029s
	iters: 300, epoch: 4 | loss: 0.3387689
	speed: 0.5770s/iter; left time: 6703.8744s
	iters: 400, epoch: 4 | loss: 0.3016663
	speed: 0.5716s/iter; left time: 6583.9003s
	iters: 500, epoch: 4 | loss: 0.3105040
	speed: 0.5830s/iter; left time: 6656.8850s
	iters: 600, epoch: 4 | loss: 0.3238234
	speed: 0.5783s/iter; left time: 6545.5722s
	iters: 700, epoch: 4 | loss: 0.3151957
	speed: 0.5793s/iter; left time: 6498.4929s
Epoch: 4 cost time: 405.66784286499023
Epoch: 4, Steps: 701 | Train Loss: 0.3244789 Vali Loss: 0.4832830 Test Loss: 0.5603685
Validation loss decreased (0.573755 --> 0.483283).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.2838368
	speed: 1.0979s/iter; left time: 12204.9769s
	iters: 200, epoch: 5 | loss: 0.2871366
	speed: 0.5707s/iter; left time: 6287.2949s
	iters: 300, epoch: 5 | loss: 0.3068146
	speed: 0.5768s/iter; left time: 6297.2320s
	iters: 400, epoch: 5 | loss: 0.2891830
	speed: 0.5756s/iter; left time: 6226.3751s
	iters: 500, epoch: 5 | loss: 0.2947700
	speed: 0.5744s/iter; left time: 6155.3523s
	iters: 600, epoch: 5 | loss: 0.3158010
	speed: 0.5800s/iter; left time: 6157.5825s
	iters: 700, epoch: 5 | loss: 0.3022438
	speed: 0.5723s/iter; left time: 6018.7028s
Epoch: 5 cost time: 403.6752736568451
Epoch: 5, Steps: 701 | Train Loss: 0.2964759 Vali Loss: 0.4504366 Test Loss: 0.5204468
Validation loss decreased (0.483283 --> 0.450437).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.2647296
	speed: 1.0977s/iter; left time: 11433.4472s
	iters: 200, epoch: 6 | loss: 0.3051149
	speed: 0.5847s/iter; left time: 6031.3642s
	iters: 300, epoch: 6 | loss: 0.2725202
	speed: 0.5737s/iter; left time: 5860.5092s
	iters: 400, epoch: 6 | loss: 0.2821001
	speed: 0.5846s/iter; left time: 5913.4289s
	iters: 500, epoch: 6 | loss: 0.2932186
	speed: 0.5728s/iter; left time: 5737.6372s
	iters: 600, epoch: 6 | loss: 0.3032926
	speed: 0.5837s/iter; left time: 5787.8194s
	iters: 700, epoch: 6 | loss: 0.2866699
	speed: 0.5776s/iter; left time: 5670.2022s
Epoch: 6 cost time: 405.9180679321289
Epoch: 6, Steps: 701 | Train Loss: 0.2823578 Vali Loss: 0.4342315 Test Loss: 0.5014172
Validation loss decreased (0.450437 --> 0.434232).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.2891766
	speed: 1.1019s/iter; left time: 10705.3157s
	iters: 200, epoch: 7 | loss: 0.2958947
	speed: 0.5787s/iter; left time: 5564.0142s
	iters: 300, epoch: 7 | loss: 0.2652062
	speed: 0.5751s/iter; left time: 5472.1624s
	iters: 400, epoch: 7 | loss: 0.2634732
	speed: 0.5842s/iter; left time: 5500.0685s
	iters: 500, epoch: 7 | loss: 0.2659180
	speed: 0.5743s/iter; left time: 5349.3418s
	iters: 600, epoch: 7 | loss: 0.2859783
	speed: 0.5886s/iter; left time: 5423.5403s
	iters: 700, epoch: 7 | loss: 0.2687531
	speed: 0.5680s/iter; left time: 5177.6078s
Epoch: 7 cost time: 405.0346670150757
Epoch: 7, Steps: 701 | Train Loss: 0.2747004 Vali Loss: 0.4275410 Test Loss: 0.4916518
Validation loss decreased (0.434232 --> 0.427541).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.2693891
	speed: 1.1052s/iter; left time: 9962.6808s
	iters: 200, epoch: 8 | loss: 0.2841260
	speed: 0.5803s/iter; left time: 5172.8108s
	iters: 300, epoch: 8 | loss: 0.2565028
	speed: 0.5770s/iter; left time: 5085.3890s
	iters: 400, epoch: 8 | loss: 0.2744775
	speed: 0.5734s/iter; left time: 4996.9426s
	iters: 500, epoch: 8 | loss: 0.2710231
	speed: 0.5770s/iter; left time: 4970.5972s
	iters: 600, epoch: 8 | loss: 0.2937703
	speed: 0.5793s/iter; left time: 4932.1424s
	iters: 700, epoch: 8 | loss: 0.2474048
	speed: 0.5798s/iter; left time: 4878.8223s
Epoch: 8 cost time: 405.31890749931335
Epoch: 8, Steps: 701 | Train Loss: 0.2705312 Vali Loss: 0.4238039 Test Loss: 0.4861393
Validation loss decreased (0.427541 --> 0.423804).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.2653006
	speed: 1.1142s/iter; left time: 9262.4990s
	iters: 200, epoch: 9 | loss: 0.2777712
	speed: 0.5768s/iter; left time: 4736.9180s
	iters: 300, epoch: 9 | loss: 0.2710851
	speed: 0.5850s/iter; left time: 4745.8482s
	iters: 400, epoch: 9 | loss: 0.2589797
	speed: 0.5887s/iter; left time: 4716.8873s
	iters: 500, epoch: 9 | loss: 0.2602524
	speed: 0.5779s/iter; left time: 4572.8061s
	iters: 600, epoch: 9 | loss: 0.2674394
	speed: 0.5745s/iter; left time: 4488.5982s
	iters: 700, epoch: 9 | loss: 0.2594494
	speed: 0.5818s/iter; left time: 4487.3157s
Epoch: 9 cost time: 407.13281297683716
Epoch: 9, Steps: 701 | Train Loss: 0.2681847 Vali Loss: 0.4221161 Test Loss: 0.4846747
Validation loss decreased (0.423804 --> 0.422116).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.2782716
	speed: 1.1054s/iter; left time: 8414.0317s
	iters: 200, epoch: 10 | loss: 0.2755416
	speed: 0.5747s/iter; left time: 4317.3848s
	iters: 300, epoch: 10 | loss: 0.2810203
	speed: 0.5844s/iter; left time: 4331.2649s
	iters: 400, epoch: 10 | loss: 0.2651840
	speed: 0.5759s/iter; left time: 4211.0093s
	iters: 500, epoch: 10 | loss: 0.2597429
	speed: 0.5825s/iter; left time: 4200.6939s
	iters: 600, epoch: 10 | loss: 0.2692732
	speed: 0.5735s/iter; left time: 4078.8173s
	iters: 700, epoch: 10 | loss: 0.2677230
	speed: 0.5862s/iter; left time: 4110.1727s
Epoch: 10 cost time: 406.35505270957947
Epoch: 10, Steps: 701 | Train Loss: 0.2669210 Vali Loss: 0.4207116 Test Loss: 0.4838872
Validation loss decreased (0.422116 --> 0.420712).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.2580850
	speed: 1.1189s/iter; left time: 7732.6013s
	iters: 200, epoch: 11 | loss: 0.2601109
	speed: 0.5801s/iter; left time: 3951.2518s
	iters: 300, epoch: 11 | loss: 0.2576148
	speed: 0.5776s/iter; left time: 3876.1430s
	iters: 400, epoch: 11 | loss: 0.2707410
	speed: 0.5781s/iter; left time: 3821.7566s
	iters: 500, epoch: 11 | loss: 0.2908619
	speed: 0.5804s/iter; left time: 3779.2544s
	iters: 600, epoch: 11 | loss: 0.2576291
	speed: 0.5890s/iter; left time: 3775.7777s
	iters: 700, epoch: 11 | loss: 0.2767838
	speed: 0.5771s/iter; left time: 3642.0032s
Epoch: 11 cost time: 407.10160779953003
Epoch: 11, Steps: 701 | Train Loss: 0.2662185 Vali Loss: 0.4205038 Test Loss: 0.4835894
Validation loss decreased (0.420712 --> 0.420504).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.2534670
	speed: 1.1150s/iter; left time: 6923.8569s
	iters: 200, epoch: 12 | loss: 0.3027866
	speed: 0.5818s/iter; left time: 3554.5609s
	iters: 300, epoch: 12 | loss: 0.2685050
	speed: 0.5751s/iter; left time: 3456.0506s
	iters: 400, epoch: 12 | loss: 0.2663752
	speed: 0.5823s/iter; left time: 3441.6725s
	iters: 500, epoch: 12 | loss: 0.2851836
	speed: 0.5766s/iter; left time: 3350.2195s
	iters: 600, epoch: 12 | loss: 0.2820428
	speed: 0.5840s/iter; left time: 3334.6177s
	iters: 700, epoch: 12 | loss: 0.2774192
	speed: 0.5745s/iter; left time: 3223.1691s
Epoch: 12 cost time: 405.98457646369934
Epoch: 12, Steps: 701 | Train Loss: 0.2658293 Vali Loss: 0.4201595 Test Loss: 0.4833518
Validation loss decreased (0.420504 --> 0.420159).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.2661427
	speed: 1.1095s/iter; left time: 6112.2628s
	iters: 200, epoch: 13 | loss: 0.2574445
	speed: 0.5790s/iter; left time: 3131.8824s
	iters: 300, epoch: 13 | loss: 0.2420236
	speed: 0.5779s/iter; left time: 3068.3118s
	iters: 400, epoch: 13 | loss: 0.2992129
	speed: 0.5834s/iter; left time: 3038.7727s
	iters: 500, epoch: 13 | loss: 0.2690218
	speed: 0.5762s/iter; left time: 2943.6675s
	iters: 600, epoch: 13 | loss: 0.2418047
	speed: 0.5843s/iter; left time: 2926.8348s
	iters: 700, epoch: 13 | loss: 0.2647439
	speed: 0.5773s/iter; left time: 2833.9320s
Epoch: 13 cost time: 405.97025513648987
Epoch: 13, Steps: 701 | Train Loss: 0.2656289 Vali Loss: 0.4205941 Test Loss: 0.4831993
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 14 | loss: 0.2614682
	speed: 1.0258s/iter; left time: 4931.9906s
	iters: 200, epoch: 14 | loss: 0.2448938
	speed: 0.5753s/iter; left time: 2708.3019s
	iters: 300, epoch: 14 | loss: 0.2638084
	speed: 0.5854s/iter; left time: 2697.5852s
	iters: 400, epoch: 14 | loss: 0.2520425
	speed: 0.5761s/iter; left time: 2596.9263s
	iters: 500, epoch: 14 | loss: 0.2713328
	speed: 0.5862s/iter; left time: 2584.0798s
	iters: 600, epoch: 14 | loss: 0.2761740
	speed: 0.5739s/iter; left time: 2472.3737s
	iters: 700, epoch: 14 | loss: 0.2719939
	speed: 0.5969s/iter; left time: 2511.6599s
Epoch: 14 cost time: 409.3191816806793
Epoch: 14, Steps: 701 | Train Loss: 0.2655308 Vali Loss: 0.4203964 Test Loss: 0.4831545
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 15 | loss: 0.2537252
	speed: 1.0104s/iter; left time: 4149.7946s
	iters: 200, epoch: 15 | loss: 0.2715649
	speed: 0.5769s/iter; left time: 2311.5870s
	iters: 300, epoch: 15 | loss: 0.2607110
	speed: 0.5882s/iter; left time: 2298.0016s
	iters: 400, epoch: 15 | loss: 0.2867509
	speed: 0.5785s/iter; left time: 2202.3736s
	iters: 500, epoch: 15 | loss: 0.2833272
	speed: 0.5866s/iter; left time: 2174.4702s
	iters: 600, epoch: 15 | loss: 0.2654170
	speed: 0.5829s/iter; left time: 2102.6842s
	iters: 700, epoch: 15 | loss: 0.2592244
	speed: 0.5766s/iter; left time: 2022.2945s
Epoch: 15 cost time: 407.77675461769104
Epoch: 15, Steps: 701 | Train Loss: 0.2654673 Vali Loss: 0.4202955 Test Loss: 0.4831648
EarlyStopping counter: 3 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 16 | loss: 0.2602224
	speed: 1.0123s/iter; left time: 3447.8384s
	iters: 200, epoch: 16 | loss: 0.2504400
	speed: 0.5814s/iter; left time: 1922.0698s
	iters: 300, epoch: 16 | loss: 0.2877648
	speed: 0.5744s/iter; left time: 1841.6569s
	iters: 400, epoch: 16 | loss: 0.2723590
	speed: 0.5877s/iter; left time: 1825.3305s
	iters: 500, epoch: 16 | loss: 0.2662292
	speed: 0.5755s/iter; left time: 1730.0215s
	iters: 600, epoch: 16 | loss: 0.2580748
	speed: 0.5799s/iter; left time: 1685.2431s
	iters: 700, epoch: 16 | loss: 0.2628711
	speed: 0.5824s/iter; left time: 1634.1678s
Epoch: 16 cost time: 407.263525724411
Epoch: 16, Steps: 701 | Train Loss: 0.2654502 Vali Loss: 0.4205301 Test Loss: 0.4831682
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 17 | loss: 0.2683430
	speed: 1.0097s/iter; left time: 2731.2192s
	iters: 200, epoch: 17 | loss: 0.2729218
	speed: 0.5802s/iter; left time: 1511.4772s
	iters: 300, epoch: 17 | loss: 0.2613001
	speed: 0.5801s/iter; left time: 1453.1156s
	iters: 400, epoch: 17 | loss: 0.2712625
	speed: 0.5880s/iter; left time: 1414.1348s
	iters: 500, epoch: 17 | loss: 0.2547356
	speed: 0.5771s/iter; left time: 1330.1397s
	iters: 600, epoch: 17 | loss: 0.2561063
	speed: 0.5741s/iter; left time: 1265.8578s
	iters: 700, epoch: 17 | loss: 0.2795837
	speed: 0.5811s/iter; left time: 1223.2188s
Epoch: 17 cost time: 406.2777624130249
Epoch: 17, Steps: 701 | Train Loss: 0.2654090 Vali Loss: 0.4203113 Test Loss: 0.4831712
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : traffic_336_720_DLinear_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed28649<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2789
mse:0.4831663966178894, mae:0.3309587836265564
