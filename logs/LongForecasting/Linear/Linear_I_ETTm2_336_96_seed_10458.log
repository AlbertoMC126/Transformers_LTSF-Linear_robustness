Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='Linear', model_id='ETTm2_336_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=10458, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTm2_336_96_Linear_ETTm2_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed10458>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34129
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.1936297
	speed: 0.0040s/iter; left time: 84.6721s
	iters: 200, epoch: 1 | loss: 0.2359939
	speed: 0.0040s/iter; left time: 83.6505s
	iters: 300, epoch: 1 | loss: 0.2680296
	speed: 0.0036s/iter; left time: 76.3661s
	iters: 400, epoch: 1 | loss: 0.6059928
	speed: 0.0039s/iter; left time: 80.7220s
	iters: 500, epoch: 1 | loss: 0.2443199
	speed: 0.0038s/iter; left time: 79.9527s
	iters: 600, epoch: 1 | loss: 0.2915603
	speed: 0.0039s/iter; left time: 81.0644s
	iters: 700, epoch: 1 | loss: 0.3703090
	speed: 0.0031s/iter; left time: 63.1004s
	iters: 800, epoch: 1 | loss: 0.3374112
	speed: 0.0028s/iter; left time: 57.4587s
	iters: 900, epoch: 1 | loss: 0.8817374
	speed: 0.0034s/iter; left time: 69.0895s
	iters: 1000, epoch: 1 | loss: 0.1614520
	speed: 0.0027s/iter; left time: 55.6793s
Epoch: 1 cost time: 3.7077255249023438
Epoch: 1, Steps: 1066 | Train Loss: 0.4198116 Vali Loss: 0.2981151 Test Loss: 0.6461673
Validation loss decreased (inf --> 0.298115).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.4477063
	speed: 0.0156s/iter; left time: 314.5197s
	iters: 200, epoch: 2 | loss: 0.1656739
	speed: 0.0044s/iter; left time: 87.4399s
	iters: 300, epoch: 2 | loss: 0.4722370
	speed: 0.0048s/iter; left time: 95.2553s
	iters: 400, epoch: 2 | loss: 0.3717003
	speed: 0.0042s/iter; left time: 83.1927s
	iters: 500, epoch: 2 | loss: 0.3176080
	speed: 0.0030s/iter; left time: 59.4545s
	iters: 600, epoch: 2 | loss: 0.3586136
	speed: 0.0036s/iter; left time: 70.0098s
	iters: 700, epoch: 2 | loss: 0.8598378
	speed: 0.0040s/iter; left time: 78.0303s
	iters: 800, epoch: 2 | loss: 0.3116648
	speed: 0.0047s/iter; left time: 92.2169s
	iters: 900, epoch: 2 | loss: 0.2624592
	speed: 0.0049s/iter; left time: 94.6967s
	iters: 1000, epoch: 2 | loss: 0.3832902
	speed: 0.0029s/iter; left time: 55.6554s
Epoch: 2 cost time: 4.197037220001221
Epoch: 2, Steps: 1066 | Train Loss: 0.4012875 Vali Loss: 0.3565768 Test Loss: 0.8400209
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.3660554
	speed: 0.0187s/iter; left time: 356.6747s
	iters: 200, epoch: 3 | loss: 0.2520537
	speed: 0.0050s/iter; left time: 94.4379s
	iters: 300, epoch: 3 | loss: 0.2893475
	speed: 0.0048s/iter; left time: 91.2425s
	iters: 400, epoch: 3 | loss: 0.1976486
	speed: 0.0035s/iter; left time: 65.1975s
	iters: 500, epoch: 3 | loss: 0.2374060
	speed: 0.0036s/iter; left time: 66.5668s
	iters: 600, epoch: 3 | loss: 0.2505406
	speed: 0.0040s/iter; left time: 74.3622s
	iters: 700, epoch: 3 | loss: 0.5766052
	speed: 0.0027s/iter; left time: 49.9203s
	iters: 800, epoch: 3 | loss: 0.3830722
	speed: 0.0043s/iter; left time: 78.1894s
	iters: 900, epoch: 3 | loss: 0.2200733
	speed: 0.0040s/iter; left time: 72.7904s
	iters: 1000, epoch: 3 | loss: 0.2144946
	speed: 0.0031s/iter; left time: 55.7017s
Epoch: 3 cost time: 4.218023777008057
Epoch: 3, Steps: 1066 | Train Loss: 0.2581184 Vali Loss: 0.2632982 Test Loss: 0.5588161
Validation loss decreased (0.298115 --> 0.263298).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.6137765
	speed: 0.0169s/iter; left time: 304.9898s
	iters: 200, epoch: 4 | loss: 0.1513522
	speed: 0.0038s/iter; left time: 67.4335s
	iters: 300, epoch: 4 | loss: 0.2258492
	speed: 0.0036s/iter; left time: 63.7996s
	iters: 400, epoch: 4 | loss: 0.1782142
	speed: 0.0042s/iter; left time: 74.2591s
	iters: 500, epoch: 4 | loss: 0.2074775
	speed: 0.0045s/iter; left time: 79.1594s
	iters: 600, epoch: 4 | loss: 0.2294108
	speed: 0.0043s/iter; left time: 75.5243s
	iters: 700, epoch: 4 | loss: 0.1480850
	speed: 0.0042s/iter; left time: 73.7582s
	iters: 800, epoch: 4 | loss: 0.1657137
	speed: 0.0042s/iter; left time: 72.0636s
	iters: 900, epoch: 4 | loss: 0.2027741
	speed: 0.0042s/iter; left time: 72.7378s
	iters: 1000, epoch: 4 | loss: 0.2603626
	speed: 0.0046s/iter; left time: 78.4309s
Epoch: 4 cost time: 4.476145267486572
Epoch: 4, Steps: 1066 | Train Loss: 0.2305149 Vali Loss: 0.2131032 Test Loss: 0.4521294
Validation loss decreased (0.263298 --> 0.213103).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.3922096
	speed: 0.0174s/iter; left time: 295.1205s
	iters: 200, epoch: 5 | loss: 0.1014889
	speed: 0.0038s/iter; left time: 64.7032s
	iters: 300, epoch: 5 | loss: 0.2917283
	speed: 0.0043s/iter; left time: 71.5846s
	iters: 400, epoch: 5 | loss: 0.3618459
	speed: 0.0048s/iter; left time: 79.2950s
	iters: 500, epoch: 5 | loss: 0.1223779
	speed: 0.0041s/iter; left time: 68.2152s
	iters: 600, epoch: 5 | loss: 0.3881578
	speed: 0.0037s/iter; left time: 61.4360s
	iters: 700, epoch: 5 | loss: 0.2252430
	speed: 0.0042s/iter; left time: 69.1987s
	iters: 800, epoch: 5 | loss: 0.2863486
	speed: 0.0044s/iter; left time: 71.8945s
	iters: 900, epoch: 5 | loss: 0.3197316
	speed: 0.0044s/iter; left time: 70.4445s
	iters: 1000, epoch: 5 | loss: 0.1638174
	speed: 0.0042s/iter; left time: 67.3136s
Epoch: 5 cost time: 4.454084157943726
Epoch: 5, Steps: 1066 | Train Loss: 0.2162963 Vali Loss: 0.1561044 Test Loss: 0.2753100
Validation loss decreased (0.213103 --> 0.156104).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.2717155
	speed: 0.0212s/iter; left time: 337.3104s
	iters: 200, epoch: 6 | loss: 0.1084230
	speed: 0.0042s/iter; left time: 66.7959s
	iters: 300, epoch: 6 | loss: 0.2060096
	speed: 0.0047s/iter; left time: 73.0097s
	iters: 400, epoch: 6 | loss: 0.1904122
	speed: 0.0043s/iter; left time: 67.6643s
	iters: 500, epoch: 6 | loss: 0.2405716
	speed: 0.0042s/iter; left time: 64.4433s
	iters: 600, epoch: 6 | loss: 0.3627796
	speed: 0.0041s/iter; left time: 62.6817s
	iters: 700, epoch: 6 | loss: 0.2158049
	speed: 0.0037s/iter; left time: 56.1179s
	iters: 800, epoch: 6 | loss: 0.4493960
	speed: 0.0044s/iter; left time: 66.7155s
	iters: 900, epoch: 6 | loss: 0.1781081
	speed: 0.0042s/iter; left time: 62.6365s
	iters: 1000, epoch: 6 | loss: 0.1087654
	speed: 0.0043s/iter; left time: 64.0531s
Epoch: 6 cost time: 4.540351629257202
Epoch: 6, Steps: 1066 | Train Loss: 0.2082961 Vali Loss: 0.1399082 Test Loss: 0.2227958
Validation loss decreased (0.156104 --> 0.139908).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.1571200
	speed: 0.0194s/iter; left time: 287.1709s
	iters: 200, epoch: 7 | loss: 0.1466236
	speed: 0.0038s/iter; left time: 55.6949s
	iters: 300, epoch: 7 | loss: 0.1646531
	speed: 0.0044s/iter; left time: 64.2037s
	iters: 400, epoch: 7 | loss: 0.1550974
	speed: 0.0041s/iter; left time: 58.8677s
	iters: 500, epoch: 7 | loss: 0.1359046
	speed: 0.0042s/iter; left time: 59.8728s
	iters: 600, epoch: 7 | loss: 0.1143570
	speed: 0.0048s/iter; left time: 69.0889s
	iters: 700, epoch: 7 | loss: 0.1976887
	speed: 0.0049s/iter; left time: 69.3449s
	iters: 800, epoch: 7 | loss: 0.2113967
	speed: 0.0047s/iter; left time: 66.5654s
	iters: 900, epoch: 7 | loss: 0.1657905
	speed: 0.0036s/iter; left time: 49.9293s
	iters: 1000, epoch: 7 | loss: 0.1712728
	speed: 0.0040s/iter; left time: 55.8291s
Epoch: 7 cost time: 4.49178147315979
Epoch: 7, Steps: 1066 | Train Loss: 0.2041512 Vali Loss: 0.1338922 Test Loss: 0.2069886
Validation loss decreased (0.139908 --> 0.133892).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.2786232
	speed: 0.0187s/iter; left time: 257.5084s
	iters: 200, epoch: 8 | loss: 0.1524571
	speed: 0.0048s/iter; left time: 65.4672s
	iters: 300, epoch: 8 | loss: 0.2108720
	speed: 0.0043s/iter; left time: 57.8970s
	iters: 400, epoch: 8 | loss: 0.1741927
	speed: 0.0040s/iter; left time: 54.2395s
	iters: 500, epoch: 8 | loss: 0.1929975
	speed: 0.0035s/iter; left time: 46.2626s
	iters: 600, epoch: 8 | loss: 0.1821306
	speed: 0.0036s/iter; left time: 48.2627s
	iters: 700, epoch: 8 | loss: 0.2280358
	speed: 0.0037s/iter; left time: 48.0550s
	iters: 800, epoch: 8 | loss: 0.1364734
	speed: 0.0037s/iter; left time: 48.3224s
	iters: 900, epoch: 8 | loss: 0.2697521
	speed: 0.0034s/iter; left time: 44.5793s
	iters: 1000, epoch: 8 | loss: 0.2047268
	speed: 0.0043s/iter; left time: 54.9331s
Epoch: 8 cost time: 4.308077573776245
Epoch: 8, Steps: 1066 | Train Loss: 0.2020026 Vali Loss: 0.1366601 Test Loss: 0.2228492
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.1630711
	speed: 0.0190s/iter; left time: 240.7307s
	iters: 200, epoch: 9 | loss: 0.1634948
	speed: 0.0043s/iter; left time: 53.7788s
	iters: 300, epoch: 9 | loss: 0.1333744
	speed: 0.0045s/iter; left time: 56.2184s
	iters: 400, epoch: 9 | loss: 0.1704462
	speed: 0.0043s/iter; left time: 53.5649s
	iters: 500, epoch: 9 | loss: 0.3065059
	speed: 0.0044s/iter; left time: 53.5793s
	iters: 600, epoch: 9 | loss: 0.1313896
	speed: 0.0042s/iter; left time: 51.7275s
	iters: 700, epoch: 9 | loss: 0.2561797
	speed: 0.0046s/iter; left time: 56.1012s
	iters: 800, epoch: 9 | loss: 0.1282078
	speed: 0.0043s/iter; left time: 52.0740s
	iters: 900, epoch: 9 | loss: 0.1525238
	speed: 0.0036s/iter; left time: 43.0525s
	iters: 1000, epoch: 9 | loss: 0.2331456
	speed: 0.0038s/iter; left time: 44.3417s
Epoch: 9 cost time: 4.51787543296814
Epoch: 9, Steps: 1066 | Train Loss: 0.2003814 Vali Loss: 0.1282071 Test Loss: 0.1982811
Validation loss decreased (0.133892 --> 0.128207).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.3891958
	speed: 0.0190s/iter; left time: 220.3998s
	iters: 200, epoch: 10 | loss: 0.1392550
	speed: 0.0041s/iter; left time: 47.2772s
	iters: 300, epoch: 10 | loss: 0.4485275
	speed: 0.0041s/iter; left time: 46.9648s
	iters: 400, epoch: 10 | loss: 0.2921717
	speed: 0.0042s/iter; left time: 48.0594s
	iters: 500, epoch: 10 | loss: 0.1386191
	speed: 0.0042s/iter; left time: 47.4903s
	iters: 600, epoch: 10 | loss: 0.4765397
	speed: 0.0042s/iter; left time: 47.2801s
	iters: 700, epoch: 10 | loss: 0.1311012
	speed: 0.0047s/iter; left time: 51.3111s
	iters: 800, epoch: 10 | loss: 0.1239273
	speed: 0.0043s/iter; left time: 46.9862s
	iters: 900, epoch: 10 | loss: 0.1049140
	speed: 0.0041s/iter; left time: 44.4265s
	iters: 1000, epoch: 10 | loss: 0.1855000
	speed: 0.0040s/iter; left time: 43.1226s
Epoch: 10 cost time: 4.432122707366943
Epoch: 10, Steps: 1066 | Train Loss: 0.1998107 Vali Loss: 0.1288032 Test Loss: 0.1994974
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.3133897
	speed: 0.0198s/iter; left time: 209.4760s
	iters: 200, epoch: 11 | loss: 0.2140964
	speed: 0.0042s/iter; left time: 43.9363s
	iters: 300, epoch: 11 | loss: 0.1658688
	speed: 0.0041s/iter; left time: 42.5345s
	iters: 400, epoch: 11 | loss: 0.2119204
	speed: 0.0046s/iter; left time: 47.3224s
	iters: 500, epoch: 11 | loss: 0.1188330
	speed: 0.0045s/iter; left time: 45.4386s
	iters: 600, epoch: 11 | loss: 0.1532102
	speed: 0.0038s/iter; left time: 38.3325s
	iters: 700, epoch: 11 | loss: 0.1406912
	speed: 0.0041s/iter; left time: 40.6796s
	iters: 800, epoch: 11 | loss: 0.2092637
	speed: 0.0049s/iter; left time: 47.9245s
	iters: 900, epoch: 11 | loss: 0.1833034
	speed: 0.0043s/iter; left time: 41.6796s
	iters: 1000, epoch: 11 | loss: 0.1396234
	speed: 0.0041s/iter; left time: 39.8430s
Epoch: 11 cost time: 4.606701850891113
Epoch: 11, Steps: 1066 | Train Loss: 0.1994778 Vali Loss: 0.1294443 Test Loss: 0.2031376
EarlyStopping counter: 2 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.1696912
	speed: 0.0201s/iter; left time: 190.7123s
	iters: 200, epoch: 12 | loss: 0.1448477
	speed: 0.0043s/iter; left time: 40.0594s
	iters: 300, epoch: 12 | loss: 0.1644157
	speed: 0.0040s/iter; left time: 36.8325s
	iters: 400, epoch: 12 | loss: 0.2069183
	speed: 0.0037s/iter; left time: 34.1134s
	iters: 500, epoch: 12 | loss: 0.1903301
	speed: 0.0037s/iter; left time: 33.5605s
	iters: 600, epoch: 12 | loss: 0.1512250
	speed: 0.0037s/iter; left time: 33.1294s
	iters: 700, epoch: 12 | loss: 0.1041900
	speed: 0.0036s/iter; left time: 32.2891s
	iters: 800, epoch: 12 | loss: 0.2253043
	speed: 0.0035s/iter; left time: 31.0648s
	iters: 900, epoch: 12 | loss: 0.1809301
	speed: 0.0037s/iter; left time: 31.9976s
	iters: 1000, epoch: 12 | loss: 0.2573600
	speed: 0.0037s/iter; left time: 31.5478s
Epoch: 12 cost time: 4.09173583984375
Epoch: 12, Steps: 1066 | Train Loss: 0.1992257 Vali Loss: 0.1311631 Test Loss: 0.2071109
EarlyStopping counter: 3 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.1595995
	speed: 0.0163s/iter; left time: 137.3468s
	iters: 200, epoch: 13 | loss: 0.1333523
	speed: 0.0047s/iter; left time: 39.3962s
	iters: 300, epoch: 13 | loss: 0.1964485
	speed: 0.0047s/iter; left time: 38.6954s
	iters: 400, epoch: 13 | loss: 0.1469571
	speed: 0.0042s/iter; left time: 34.3040s
	iters: 500, epoch: 13 | loss: 0.2367897
	speed: 0.0041s/iter; left time: 33.1047s
	iters: 600, epoch: 13 | loss: 0.2394706
	speed: 0.0032s/iter; left time: 25.3727s
	iters: 700, epoch: 13 | loss: 0.1518298
	speed: 0.0031s/iter; left time: 24.5072s
	iters: 800, epoch: 13 | loss: 0.1626792
	speed: 0.0037s/iter; left time: 28.7673s
	iters: 900, epoch: 13 | loss: 0.1446624
	speed: 0.0042s/iter; left time: 31.9655s
	iters: 1000, epoch: 13 | loss: 0.3166257
	speed: 0.0043s/iter; left time: 32.2408s
Epoch: 13 cost time: 4.397188425064087
Epoch: 13, Steps: 1066 | Train Loss: 0.1990436 Vali Loss: 0.1310014 Test Loss: 0.2065462
EarlyStopping counter: 4 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 14 | loss: 0.1636904
	speed: 0.0186s/iter; left time: 136.5921s
	iters: 200, epoch: 14 | loss: 0.1310583
	speed: 0.0045s/iter; left time: 32.7737s
	iters: 300, epoch: 14 | loss: 0.0858437
	speed: 0.0047s/iter; left time: 33.8842s
	iters: 400, epoch: 14 | loss: 0.2501909
	speed: 0.0034s/iter; left time: 24.1080s
	iters: 500, epoch: 14 | loss: 0.2679349
	speed: 0.0039s/iter; left time: 27.0165s
	iters: 600, epoch: 14 | loss: 0.1601783
	speed: 0.0043s/iter; left time: 29.7167s
	iters: 700, epoch: 14 | loss: 0.3055151
	speed: 0.0041s/iter; left time: 27.6198s
	iters: 800, epoch: 14 | loss: 0.1545275
	speed: 0.0044s/iter; left time: 29.1840s
	iters: 900, epoch: 14 | loss: 0.3206560
	speed: 0.0042s/iter; left time: 27.3940s
	iters: 1000, epoch: 14 | loss: 0.3905531
	speed: 0.0040s/iter; left time: 25.8548s
Epoch: 14 cost time: 4.415317058563232
Epoch: 14, Steps: 1066 | Train Loss: 0.1990706 Vali Loss: 0.1321205 Test Loss: 0.2099052
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTm2_336_96_Linear_ETTm2_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed10458<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.19869086146354675, mae:0.28810834884643555
