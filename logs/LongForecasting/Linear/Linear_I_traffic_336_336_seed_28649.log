Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='Linear', model_id='traffic_336_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=336, root_path='./dataset/', save_pred_values=False, seed=28649, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_336_336_Linear_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed28649>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11609
val 1421
test 3173
	iters: 100, epoch: 1 | loss: 0.4294711
	speed: 0.3240s/iter; left time: 4665.4399s
	iters: 200, epoch: 1 | loss: 0.4785078
	speed: 0.3084s/iter; left time: 4410.3014s
	iters: 300, epoch: 1 | loss: 0.4773587
	speed: 0.3075s/iter; left time: 4367.1233s
	iters: 400, epoch: 1 | loss: 0.4588669
	speed: 0.3072s/iter; left time: 4331.6098s
	iters: 500, epoch: 1 | loss: 0.4676183
	speed: 0.3076s/iter; left time: 4306.6134s
	iters: 600, epoch: 1 | loss: 0.4907832
	speed: 0.3077s/iter; left time: 4277.5739s
	iters: 700, epoch: 1 | loss: 0.4824728
	speed: 0.3069s/iter; left time: 4235.5762s
Epoch: 1 cost time: 224.81826853752136
Epoch: 1, Steps: 725 | Train Loss: 0.4949489 Vali Loss: 0.6494923 Test Loss: 0.7838607
Validation loss decreased (inf --> 0.649492).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.5094469
	speed: 0.6084s/iter; left time: 8321.1178s
	iters: 200, epoch: 2 | loss: 0.4815722
	speed: 0.3079s/iter; left time: 4179.4612s
	iters: 300, epoch: 2 | loss: 0.4720956
	speed: 0.3083s/iter; left time: 4154.0951s
	iters: 400, epoch: 2 | loss: 0.5023932
	speed: 0.3093s/iter; left time: 4137.2542s
	iters: 500, epoch: 2 | loss: 0.4861691
	speed: 0.3081s/iter; left time: 4089.9157s
	iters: 600, epoch: 2 | loss: 0.4587759
	speed: 0.3077s/iter; left time: 4054.7524s
	iters: 700, epoch: 2 | loss: 0.4770083
	speed: 0.3076s/iter; left time: 4022.5581s
Epoch: 2 cost time: 223.49195957183838
Epoch: 2, Steps: 725 | Train Loss: 0.4865361 Vali Loss: 0.6394207 Test Loss: 0.7692693
Validation loss decreased (0.649492 --> 0.639421).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.3290189
	speed: 0.6108s/iter; left time: 7910.4856s
	iters: 200, epoch: 3 | loss: 0.3184570
	speed: 0.3089s/iter; left time: 3969.5421s
	iters: 300, epoch: 3 | loss: 0.3130905
	speed: 0.3086s/iter; left time: 3934.6555s
	iters: 400, epoch: 3 | loss: 0.3713135
	speed: 0.3094s/iter; left time: 3914.7210s
	iters: 500, epoch: 3 | loss: 0.3523855
	speed: 0.3085s/iter; left time: 3871.8261s
	iters: 600, epoch: 3 | loss: 0.3357854
	speed: 0.3084s/iter; left time: 3840.0785s
	iters: 700, epoch: 3 | loss: 0.3501872
	speed: 0.3104s/iter; left time: 3834.0890s
Epoch: 3 cost time: 224.124924659729
Epoch: 3, Steps: 725 | Train Loss: 0.3418655 Vali Loss: 0.4678424 Test Loss: 0.5687373
Validation loss decreased (0.639421 --> 0.467842).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.3113902
	speed: 0.6086s/iter; left time: 7440.2606s
	iters: 200, epoch: 4 | loss: 0.2772724
	speed: 0.3072s/iter; left time: 3724.7927s
	iters: 300, epoch: 4 | loss: 0.2828865
	speed: 0.3085s/iter; left time: 3710.1868s
	iters: 400, epoch: 4 | loss: 0.2866752
	speed: 0.3075s/iter; left time: 3667.6931s
	iters: 500, epoch: 4 | loss: 0.2982036
	speed: 0.3074s/iter; left time: 3635.7537s
	iters: 600, epoch: 4 | loss: 0.2558069
	speed: 0.3092s/iter; left time: 3625.2781s
	iters: 700, epoch: 4 | loss: 0.3111733
	speed: 0.3077s/iter; left time: 3576.7792s
Epoch: 4 cost time: 223.39228534698486
Epoch: 4, Steps: 725 | Train Loss: 0.2938252 Vali Loss: 0.4187224 Test Loss: 0.5086717
Validation loss decreased (0.467842 --> 0.418722).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.2614482
	speed: 0.6079s/iter; left time: 6991.8189s
	iters: 200, epoch: 5 | loss: 0.2722538
	speed: 0.3096s/iter; left time: 3529.6456s
	iters: 300, epoch: 5 | loss: 0.2765771
	speed: 0.3074s/iter; left time: 3474.0869s
	iters: 400, epoch: 5 | loss: 0.2581892
	speed: 0.3060s/iter; left time: 3427.4893s
	iters: 500, epoch: 5 | loss: 0.2704524
	speed: 0.3067s/iter; left time: 3404.9033s
	iters: 600, epoch: 5 | loss: 0.2631253
	speed: 0.3097s/iter; left time: 3407.0444s
	iters: 700, epoch: 5 | loss: 0.2817377
	speed: 0.3081s/iter; left time: 3358.4535s
Epoch: 5 cost time: 223.40912795066833
Epoch: 5, Steps: 725 | Train Loss: 0.2723003 Vali Loss: 0.3929255 Test Loss: 0.4789316
Validation loss decreased (0.418722 --> 0.392926).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.2461546
	speed: 0.6109s/iter; left time: 6582.8782s
	iters: 200, epoch: 6 | loss: 0.2517648
	speed: 0.3106s/iter; left time: 3316.4411s
	iters: 300, epoch: 6 | loss: 0.2651104
	speed: 0.3077s/iter; left time: 3254.3396s
	iters: 400, epoch: 6 | loss: 0.2358340
	speed: 0.3079s/iter; left time: 3225.3558s
	iters: 500, epoch: 6 | loss: 0.2612064
	speed: 0.3091s/iter; left time: 3207.2161s
	iters: 600, epoch: 6 | loss: 0.2491853
	speed: 0.3080s/iter; left time: 3164.6276s
	iters: 700, epoch: 6 | loss: 0.2731517
	speed: 0.3075s/iter; left time: 3129.1791s
Epoch: 6 cost time: 223.80451560020447
Epoch: 6, Steps: 725 | Train Loss: 0.2611854 Vali Loss: 0.3814984 Test Loss: 0.4663288
Validation loss decreased (0.392926 --> 0.381498).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.2547170
	speed: 0.6081s/iter; left time: 6112.2722s
	iters: 200, epoch: 7 | loss: 0.2713905
	speed: 0.3063s/iter; left time: 3048.2803s
	iters: 300, epoch: 7 | loss: 0.2806270
	speed: 0.3063s/iter; left time: 3017.1836s
	iters: 400, epoch: 7 | loss: 0.2619132
	speed: 0.3077s/iter; left time: 3000.1046s
	iters: 500, epoch: 7 | loss: 0.2546440
	speed: 0.3058s/iter; left time: 2951.7070s
	iters: 600, epoch: 7 | loss: 0.2941261
	speed: 0.3049s/iter; left time: 2912.3306s
	iters: 700, epoch: 7 | loss: 0.2256598
	speed: 0.3047s/iter; left time: 2879.9220s
Epoch: 7 cost time: 222.28597593307495
Epoch: 7, Steps: 725 | Train Loss: 0.2552096 Vali Loss: 0.3754496 Test Loss: 0.4590500
Validation loss decreased (0.381498 --> 0.375450).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.2396813
	speed: 0.6095s/iter; left time: 5684.4291s
	iters: 200, epoch: 8 | loss: 0.2564941
	speed: 0.3084s/iter; left time: 2844.9007s
	iters: 300, epoch: 8 | loss: 0.2575043
	speed: 0.3093s/iter; left time: 2822.6652s
	iters: 400, epoch: 8 | loss: 0.2437642
	speed: 0.3078s/iter; left time: 2778.0706s
	iters: 500, epoch: 8 | loss: 0.2532957
	speed: 0.3074s/iter; left time: 2743.6246s
	iters: 600, epoch: 8 | loss: 0.2582321
	speed: 0.3063s/iter; left time: 2703.6863s
	iters: 700, epoch: 8 | loss: 0.2441367
	speed: 0.3086s/iter; left time: 2693.0807s
Epoch: 8 cost time: 223.44303560256958
Epoch: 8, Steps: 725 | Train Loss: 0.2519258 Vali Loss: 0.3726635 Test Loss: 0.4560078
Validation loss decreased (0.375450 --> 0.372664).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.2517688
	speed: 0.6079s/iter; left time: 5228.2043s
	iters: 200, epoch: 9 | loss: 0.2567028
	speed: 0.3068s/iter; left time: 2608.1192s
	iters: 300, epoch: 9 | loss: 0.2502138
	speed: 0.3078s/iter; left time: 2586.0705s
	iters: 400, epoch: 9 | loss: 0.2761082
	speed: 0.3078s/iter; left time: 2555.2297s
	iters: 500, epoch: 9 | loss: 0.2349102
	speed: 0.3087s/iter; left time: 2531.3901s
	iters: 600, epoch: 9 | loss: 0.2531858
	speed: 0.3077s/iter; left time: 2492.9029s
	iters: 700, epoch: 9 | loss: 0.2639909
	speed: 0.3077s/iter; left time: 2461.8689s
Epoch: 9 cost time: 223.2921016216278
Epoch: 9, Steps: 725 | Train Loss: 0.2500824 Vali Loss: 0.3715238 Test Loss: 0.4543398
Validation loss decreased (0.372664 --> 0.371524).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.2456404
	speed: 0.6099s/iter; left time: 4803.5513s
	iters: 200, epoch: 10 | loss: 0.2599906
	speed: 0.3066s/iter; left time: 2384.4298s
	iters: 300, epoch: 10 | loss: 0.2384791
	speed: 0.3063s/iter; left time: 2351.0204s
	iters: 400, epoch: 10 | loss: 0.2792860
	speed: 0.3095s/iter; left time: 2344.4215s
	iters: 500, epoch: 10 | loss: 0.2310552
	speed: 0.3078s/iter; left time: 2301.1196s
	iters: 600, epoch: 10 | loss: 0.2377481
	speed: 0.3080s/iter; left time: 2271.9420s
	iters: 700, epoch: 10 | loss: 0.2324503
	speed: 0.3071s/iter; left time: 2234.2781s
Epoch: 10 cost time: 223.18832969665527
Epoch: 10, Steps: 725 | Train Loss: 0.2490569 Vali Loss: 0.3708985 Test Loss: 0.4538361
Validation loss decreased (0.371524 --> 0.370898).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.2706160
	speed: 0.6075s/iter; left time: 4344.1132s
	iters: 200, epoch: 11 | loss: 0.2534608
	speed: 0.3090s/iter; left time: 2178.5244s
	iters: 300, epoch: 11 | loss: 0.2530749
	speed: 0.3070s/iter; left time: 2134.2806s
	iters: 400, epoch: 11 | loss: 0.2470701
	speed: 0.3066s/iter; left time: 2100.4939s
	iters: 500, epoch: 11 | loss: 0.2386974
	speed: 0.3086s/iter; left time: 2083.0237s
	iters: 600, epoch: 11 | loss: 0.2292012
	speed: 0.3068s/iter; left time: 2040.4626s
	iters: 700, epoch: 11 | loss: 0.2280518
	speed: 0.3069s/iter; left time: 2010.3312s
Epoch: 11 cost time: 222.89802503585815
Epoch: 11, Steps: 725 | Train Loss: 0.2485390 Vali Loss: 0.3710827 Test Loss: 0.4535130
EarlyStopping counter: 1 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.2535766
	speed: 0.6027s/iter; left time: 3872.9454s
	iters: 200, epoch: 12 | loss: 0.2545723
	speed: 0.3067s/iter; left time: 1940.3292s
	iters: 300, epoch: 12 | loss: 0.2261219
	speed: 0.3059s/iter; left time: 1904.8152s
	iters: 400, epoch: 12 | loss: 0.2577918
	speed: 0.3080s/iter; left time: 1886.9926s
	iters: 500, epoch: 12 | loss: 0.2307593
	speed: 0.3091s/iter; left time: 1862.3843s
	iters: 600, epoch: 12 | loss: 0.2423293
	speed: 0.3069s/iter; left time: 1818.8118s
	iters: 700, epoch: 12 | loss: 0.2415615
	speed: 0.3066s/iter; left time: 1786.4210s
Epoch: 12 cost time: 222.84765791893005
Epoch: 12, Steps: 725 | Train Loss: 0.2482627 Vali Loss: 0.3710345 Test Loss: 0.4533866
EarlyStopping counter: 2 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.2501628
	speed: 0.6068s/iter; left time: 3459.6006s
	iters: 200, epoch: 13 | loss: 0.2538433
	speed: 0.3083s/iter; left time: 1726.6048s
	iters: 300, epoch: 13 | loss: 0.2368751
	speed: 0.3077s/iter; left time: 1692.6841s
	iters: 400, epoch: 13 | loss: 0.2458545
	speed: 0.3090s/iter; left time: 1668.6555s
	iters: 500, epoch: 13 | loss: 0.2564609
	speed: 0.3061s/iter; left time: 1622.5260s
	iters: 600, epoch: 13 | loss: 0.2400967
	speed: 0.3073s/iter; left time: 1598.2861s
	iters: 700, epoch: 13 | loss: 0.2724071
	speed: 0.3072s/iter; left time: 1566.8034s
Epoch: 13 cost time: 223.36334681510925
Epoch: 13, Steps: 725 | Train Loss: 0.2480956 Vali Loss: 0.3706196 Test Loss: 0.4533195
Validation loss decreased (0.370898 --> 0.370620).  Saving model ...
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 14 | loss: 0.2615561
	speed: 0.6085s/iter; left time: 3027.8878s
	iters: 200, epoch: 14 | loss: 0.2294405
	speed: 0.3064s/iter; left time: 1494.0407s
	iters: 300, epoch: 14 | loss: 0.2710906
	speed: 0.3086s/iter; left time: 1473.8952s
	iters: 400, epoch: 14 | loss: 0.2455509
	speed: 0.3076s/iter; left time: 1438.1121s
	iters: 500, epoch: 14 | loss: 0.2614914
	speed: 0.3073s/iter; left time: 1406.3951s
	iters: 600, epoch: 14 | loss: 0.2707847
	speed: 0.3067s/iter; left time: 1372.6611s
	iters: 700, epoch: 14 | loss: 0.2351145
	speed: 0.3093s/iter; left time: 1353.6961s
Epoch: 14 cost time: 223.1582236289978
Epoch: 14, Steps: 725 | Train Loss: 0.2480105 Vali Loss: 0.3708886 Test Loss: 0.4533047
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 15 | loss: 0.2770293
	speed: 0.6018s/iter; left time: 2558.0878s
	iters: 200, epoch: 15 | loss: 0.2920218
	speed: 0.3076s/iter; left time: 1276.8646s
	iters: 300, epoch: 15 | loss: 0.2377438
	speed: 0.3066s/iter; left time: 1241.8364s
	iters: 400, epoch: 15 | loss: 0.2274141
	speed: 0.3083s/iter; left time: 1218.1491s
	iters: 500, epoch: 15 | loss: 0.2234552
	speed: 0.3067s/iter; left time: 1181.2092s
	iters: 600, epoch: 15 | loss: 0.2700820
	speed: 0.3087s/iter; left time: 1158.0569s
	iters: 700, epoch: 15 | loss: 0.2470964
	speed: 0.3062s/iter; left time: 1117.8908s
Epoch: 15 cost time: 222.6881809234619
Epoch: 15, Steps: 725 | Train Loss: 0.2479599 Vali Loss: 0.3710574 Test Loss: 0.4533014
EarlyStopping counter: 2 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 16 | loss: 0.2325246
	speed: 0.6025s/iter; left time: 2124.3204s
	iters: 200, epoch: 16 | loss: 0.2396288
	speed: 0.3087s/iter; left time: 1057.5233s
	iters: 300, epoch: 16 | loss: 0.2589180
	speed: 0.3058s/iter; left time: 1017.0741s
	iters: 400, epoch: 16 | loss: 0.2548583
	speed: 0.3053s/iter; left time: 984.7776s
	iters: 500, epoch: 16 | loss: 0.2437007
	speed: 0.3070s/iter; left time: 959.7642s
	iters: 600, epoch: 16 | loss: 0.2570647
	speed: 0.3075s/iter; left time: 930.4662s
	iters: 700, epoch: 16 | loss: 0.2443496
	speed: 0.3076s/iter; left time: 899.9731s
Epoch: 16 cost time: 222.5677568912506
Epoch: 16, Steps: 725 | Train Loss: 0.2479498 Vali Loss: 0.3708212 Test Loss: 0.4532975
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 17 | loss: 0.2628789
	speed: 0.6049s/iter; left time: 1694.2319s
	iters: 200, epoch: 17 | loss: 0.2377115
	speed: 0.3072s/iter; left time: 829.8412s
	iters: 300, epoch: 17 | loss: 0.2672928
	speed: 0.3067s/iter; left time: 797.7882s
	iters: 400, epoch: 17 | loss: 0.2397893
	speed: 0.3079s/iter; left time: 769.9837s
	iters: 500, epoch: 17 | loss: 0.2598733
	speed: 0.3085s/iter; left time: 740.6302s
	iters: 600, epoch: 17 | loss: 0.2284841
	speed: 0.3072s/iter; left time: 706.8592s
	iters: 700, epoch: 17 | loss: 0.2414108
	speed: 0.3075s/iter; left time: 676.8754s
Epoch: 17 cost time: 223.13985109329224
Epoch: 17, Steps: 725 | Train Loss: 0.2479027 Vali Loss: 0.3708568 Test Loss: 0.4532968
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 18 | loss: 0.2463268
	speed: 0.6028s/iter; left time: 1251.4836s
	iters: 200, epoch: 18 | loss: 0.2672318
	speed: 0.3074s/iter; left time: 607.3287s
	iters: 300, epoch: 18 | loss: 0.2572541
	speed: 0.3087s/iter; left time: 579.1526s
	iters: 400, epoch: 18 | loss: 0.2447018
	speed: 0.3095s/iter; left time: 549.6045s
	iters: 500, epoch: 18 | loss: 0.2531456
	speed: 0.3087s/iter; left time: 517.2982s
	iters: 600, epoch: 18 | loss: 0.2426955
	speed: 0.3066s/iter; left time: 483.1475s
	iters: 700, epoch: 18 | loss: 0.2410769
	speed: 0.3064s/iter; left time: 452.2412s
Epoch: 18 cost time: 223.1204423904419
Epoch: 18, Steps: 725 | Train Loss: 0.2479399 Vali Loss: 0.3707165 Test Loss: 0.4532964
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : traffic_336_336_Linear_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed28649<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3173
mse:0.45234793424606323, mae:0.31205350160598755
