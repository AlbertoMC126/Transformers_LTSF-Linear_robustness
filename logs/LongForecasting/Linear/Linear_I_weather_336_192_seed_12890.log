Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='Linear', model_id='weather_336_192', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=192, root_path='./dataset/', save_pred_values=False, seed=12890, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : weather_336_192_Linear_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed12890>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36360
val 5079
test 10348
	iters: 100, epoch: 1 | loss: 0.5238077
	speed: 0.0150s/iter; left time: 678.6948s
	iters: 200, epoch: 1 | loss: 0.4062241
	speed: 0.0147s/iter; left time: 666.1062s
	iters: 300, epoch: 1 | loss: 2.0254307
	speed: 0.0141s/iter; left time: 635.5564s
	iters: 400, epoch: 1 | loss: 0.4250800
	speed: 0.0145s/iter; left time: 653.8482s
	iters: 500, epoch: 1 | loss: 0.6931472
	speed: 0.0146s/iter; left time: 655.7867s
	iters: 600, epoch: 1 | loss: 0.4756016
	speed: 0.0145s/iter; left time: 650.7594s
	iters: 700, epoch: 1 | loss: 0.3987983
	speed: 0.0146s/iter; left time: 655.2991s
	iters: 800, epoch: 1 | loss: 0.8644624
	speed: 0.0144s/iter; left time: 643.1113s
	iters: 900, epoch: 1 | loss: 2.2686863
	speed: 0.0144s/iter; left time: 640.6202s
	iters: 1000, epoch: 1 | loss: 0.4907515
	speed: 0.0146s/iter; left time: 648.1273s
	iters: 1100, epoch: 1 | loss: 0.5930964
	speed: 0.0146s/iter; left time: 646.5290s
	iters: 1200, epoch: 1 | loss: 0.5509621
	speed: 0.0141s/iter; left time: 624.9931s
	iters: 1300, epoch: 1 | loss: 0.4329612
	speed: 0.0148s/iter; left time: 653.3176s
	iters: 1400, epoch: 1 | loss: 0.4175990
	speed: 0.0141s/iter; left time: 622.3239s
	iters: 1500, epoch: 1 | loss: 0.5435484
	speed: 0.0146s/iter; left time: 642.2614s
	iters: 1600, epoch: 1 | loss: 0.3776435
	speed: 0.0145s/iter; left time: 634.0953s
	iters: 1700, epoch: 1 | loss: 0.3762354
	speed: 0.0144s/iter; left time: 629.9692s
	iters: 1800, epoch: 1 | loss: 0.5693246
	speed: 0.0144s/iter; left time: 628.2598s
	iters: 1900, epoch: 1 | loss: 5.9302320
	speed: 0.0145s/iter; left time: 632.5039s
	iters: 2000, epoch: 1 | loss: 0.4628050
	speed: 0.0139s/iter; left time: 602.2411s
	iters: 2100, epoch: 1 | loss: 30.8176327
	speed: 0.0146s/iter; left time: 633.2926s
	iters: 2200, epoch: 1 | loss: 0.5304346
	speed: 0.0143s/iter; left time: 616.3356s
Epoch: 1 cost time: 32.857609272003174
Epoch: 1, Steps: 2272 | Train Loss: 1.4886362 Vali Loss: 0.5980737 Test Loss: 0.2795900
Validation loss decreased (inf --> 0.598074).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.5003000
	speed: 0.0532s/iter; left time: 2291.1012s
	iters: 200, epoch: 2 | loss: 0.6289428
	speed: 0.0146s/iter; left time: 626.0267s
	iters: 300, epoch: 2 | loss: 0.5175537
	speed: 0.0145s/iter; left time: 623.3820s
	iters: 400, epoch: 2 | loss: 0.3835080
	speed: 0.0145s/iter; left time: 618.0911s
	iters: 500, epoch: 2 | loss: 1.3859451
	speed: 0.0145s/iter; left time: 616.9135s
	iters: 600, epoch: 2 | loss: 2.9130712
	speed: 0.0145s/iter; left time: 617.8907s
	iters: 700, epoch: 2 | loss: 0.4472949
	speed: 0.0142s/iter; left time: 602.9506s
	iters: 800, epoch: 2 | loss: 1.0348110
	speed: 0.0144s/iter; left time: 609.9002s
	iters: 900, epoch: 2 | loss: 0.4186494
	speed: 0.0146s/iter; left time: 616.3934s
	iters: 1000, epoch: 2 | loss: 0.4272961
	speed: 0.0142s/iter; left time: 600.6065s
	iters: 1100, epoch: 2 | loss: 0.4599159
	speed: 0.0145s/iter; left time: 609.5910s
	iters: 1200, epoch: 2 | loss: 0.6474371
	speed: 0.0139s/iter; left time: 585.1614s
	iters: 1300, epoch: 2 | loss: 0.3839504
	speed: 0.0145s/iter; left time: 606.8446s
	iters: 1400, epoch: 2 | loss: 0.4600211
	speed: 0.0145s/iter; left time: 604.0600s
	iters: 1500, epoch: 2 | loss: 1.6980276
	speed: 0.0140s/iter; left time: 582.9533s
	iters: 1600, epoch: 2 | loss: 0.6356187
	speed: 0.0148s/iter; left time: 615.8951s
	iters: 1700, epoch: 2 | loss: 3.5341573
	speed: 0.0146s/iter; left time: 604.2911s
	iters: 1800, epoch: 2 | loss: 1.2055171
	speed: 0.0145s/iter; left time: 599.6873s
	iters: 1900, epoch: 2 | loss: 1.4025164
	speed: 0.0145s/iter; left time: 596.3978s
	iters: 2000, epoch: 2 | loss: 0.4358123
	speed: 0.0147s/iter; left time: 605.2777s
	iters: 2100, epoch: 2 | loss: 2.4959350
	speed: 0.0145s/iter; left time: 594.5299s
	iters: 2200, epoch: 2 | loss: 6.6544232
	speed: 0.0148s/iter; left time: 604.2945s
Epoch: 2 cost time: 32.834248781204224
Epoch: 2, Steps: 2272 | Train Loss: 1.1884964 Vali Loss: 0.5967429 Test Loss: 0.2537816
Validation loss decreased (0.598074 --> 0.596743).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.7456254
	speed: 0.0521s/iter; left time: 2126.9920s
	iters: 200, epoch: 3 | loss: 0.3900123
	speed: 0.0144s/iter; left time: 584.6434s
	iters: 300, epoch: 3 | loss: 1.3856907
	speed: 0.0146s/iter; left time: 592.0541s
	iters: 400, epoch: 3 | loss: 1.3511524
	speed: 0.0147s/iter; left time: 594.3888s
	iters: 500, epoch: 3 | loss: 0.5823183
	speed: 0.0149s/iter; left time: 601.3712s
	iters: 600, epoch: 3 | loss: 0.4607094
	speed: 0.0147s/iter; left time: 591.4580s
	iters: 700, epoch: 3 | loss: 0.4118834
	speed: 0.0142s/iter; left time: 571.9189s
	iters: 800, epoch: 3 | loss: 0.5716941
	speed: 0.0148s/iter; left time: 592.2985s
	iters: 900, epoch: 3 | loss: 0.4296916
	speed: 0.0145s/iter; left time: 580.8593s
	iters: 1000, epoch: 3 | loss: 0.5260358
	speed: 0.0146s/iter; left time: 581.9597s
	iters: 1100, epoch: 3 | loss: 0.3217742
	speed: 0.0146s/iter; left time: 582.8473s
	iters: 1200, epoch: 3 | loss: 0.5403956
	speed: 0.0147s/iter; left time: 581.7080s
	iters: 1300, epoch: 3 | loss: 0.4618346
	speed: 0.0145s/iter; left time: 572.2236s
	iters: 1400, epoch: 3 | loss: 0.2539103
	speed: 0.0143s/iter; left time: 563.8881s
	iters: 1500, epoch: 3 | loss: 0.5465094
	speed: 0.0147s/iter; left time: 578.3941s
	iters: 1600, epoch: 3 | loss: 0.3189153
	speed: 0.0143s/iter; left time: 563.4046s
	iters: 1700, epoch: 3 | loss: 1.0009922
	speed: 0.0145s/iter; left time: 567.8963s
	iters: 1800, epoch: 3 | loss: 0.2558106
	speed: 0.0148s/iter; left time: 578.6515s
	iters: 1900, epoch: 3 | loss: 0.4285566
	speed: 0.0144s/iter; left time: 561.2531s
	iters: 2000, epoch: 3 | loss: 0.3386925
	speed: 0.0149s/iter; left time: 578.3061s
	iters: 2100, epoch: 3 | loss: 0.3604784
	speed: 0.0147s/iter; left time: 570.6061s
	iters: 2200, epoch: 3 | loss: 0.2818657
	speed: 0.0145s/iter; left time: 561.2371s
Epoch: 3 cost time: 33.01401686668396
Epoch: 3, Steps: 2272 | Train Loss: 0.8192900 Vali Loss: 0.4788050 Test Loss: 0.2142522
Validation loss decreased (0.596743 --> 0.478805).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.3510172
	speed: 0.0527s/iter; left time: 2030.4607s
	iters: 200, epoch: 4 | loss: 1.2953079
	speed: 0.0145s/iter; left time: 555.5392s
	iters: 300, epoch: 4 | loss: 0.3430668
	speed: 0.0145s/iter; left time: 556.5594s
	iters: 400, epoch: 4 | loss: 0.3786296
	speed: 0.0145s/iter; left time: 554.9050s
	iters: 500, epoch: 4 | loss: 0.3878500
	speed: 0.0145s/iter; left time: 552.5041s
	iters: 600, epoch: 4 | loss: 22.7114010
	speed: 0.0146s/iter; left time: 556.6678s
	iters: 700, epoch: 4 | loss: 0.3274362
	speed: 0.0142s/iter; left time: 538.2509s
	iters: 800, epoch: 4 | loss: 0.4013251
	speed: 0.0146s/iter; left time: 553.0691s
	iters: 900, epoch: 4 | loss: 0.3042447
	speed: 0.0145s/iter; left time: 548.7305s
	iters: 1000, epoch: 4 | loss: 0.6556194
	speed: 0.0147s/iter; left time: 554.4991s
	iters: 1100, epoch: 4 | loss: 0.4277251
	speed: 0.0146s/iter; left time: 549.4878s
	iters: 1200, epoch: 4 | loss: 0.4537326
	speed: 0.0150s/iter; left time: 562.4523s
	iters: 1300, epoch: 4 | loss: 0.7077703
	speed: 0.0144s/iter; left time: 538.5107s
	iters: 1400, epoch: 4 | loss: 0.6821500
	speed: 0.0147s/iter; left time: 545.6047s
	iters: 1500, epoch: 4 | loss: 0.5134453
	speed: 0.0144s/iter; left time: 536.0503s
	iters: 1600, epoch: 4 | loss: 0.4958908
	speed: 0.0146s/iter; left time: 539.5293s
	iters: 1700, epoch: 4 | loss: 0.3259650
	speed: 0.0142s/iter; left time: 524.4495s
	iters: 1800, epoch: 4 | loss: 1.0224762
	speed: 0.0144s/iter; left time: 528.8612s
	iters: 1900, epoch: 4 | loss: 0.4912130
	speed: 0.0146s/iter; left time: 536.6344s
	iters: 2000, epoch: 4 | loss: 0.5901484
	speed: 0.0147s/iter; left time: 539.0376s
	iters: 2100, epoch: 4 | loss: 0.4300282
	speed: 0.0150s/iter; left time: 546.2399s
	iters: 2200, epoch: 4 | loss: 0.7648001
	speed: 0.0145s/iter; left time: 526.6778s
Epoch: 4 cost time: 32.990089893341064
Epoch: 4, Steps: 2272 | Train Loss: 0.6502183 Vali Loss: 0.4534911 Test Loss: 0.2066540
Validation loss decreased (0.478805 --> 0.453491).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.6202917
	speed: 0.0533s/iter; left time: 1931.8115s
	iters: 200, epoch: 5 | loss: 0.4803917
	speed: 0.0149s/iter; left time: 537.4700s
	iters: 300, epoch: 5 | loss: 0.4240228
	speed: 0.0147s/iter; left time: 529.1360s
	iters: 400, epoch: 5 | loss: 0.2936513
	speed: 0.0148s/iter; left time: 532.9174s
	iters: 500, epoch: 5 | loss: 0.5241786
	speed: 0.0148s/iter; left time: 532.1508s
	iters: 600, epoch: 5 | loss: 0.4079888
	speed: 0.0147s/iter; left time: 526.8335s
	iters: 700, epoch: 5 | loss: 0.6712754
	speed: 0.0143s/iter; left time: 511.0585s
	iters: 800, epoch: 5 | loss: 0.2936846
	speed: 0.0146s/iter; left time: 520.6471s
	iters: 900, epoch: 5 | loss: 0.3567303
	speed: 0.0146s/iter; left time: 517.2312s
	iters: 1000, epoch: 5 | loss: 0.4909103
	speed: 0.0144s/iter; left time: 507.6098s
	iters: 1100, epoch: 5 | loss: 0.3506347
	speed: 0.0140s/iter; left time: 493.9241s
	iters: 1200, epoch: 5 | loss: 0.5265661
	speed: 0.0147s/iter; left time: 515.2318s
	iters: 1300, epoch: 5 | loss: 0.3741696
	speed: 0.0142s/iter; left time: 499.4398s
	iters: 1400, epoch: 5 | loss: 0.3250803
	speed: 0.0145s/iter; left time: 508.1747s
	iters: 1500, epoch: 5 | loss: 0.4529730
	speed: 0.0143s/iter; left time: 499.3126s
	iters: 1600, epoch: 5 | loss: 0.4413586
	speed: 0.0144s/iter; left time: 500.8578s
	iters: 1700, epoch: 5 | loss: 0.3939693
	speed: 0.0148s/iter; left time: 511.6756s
	iters: 1800, epoch: 5 | loss: 0.4867345
	speed: 0.0144s/iter; left time: 495.8656s
	iters: 1900, epoch: 5 | loss: 0.6235620
	speed: 0.0147s/iter; left time: 507.4056s
	iters: 2000, epoch: 5 | loss: 0.5026700
	speed: 0.0144s/iter; left time: 493.6124s
	iters: 2100, epoch: 5 | loss: 0.2461433
	speed: 0.0143s/iter; left time: 489.6833s
	iters: 2200, epoch: 5 | loss: 0.2660088
	speed: 0.0144s/iter; left time: 492.2595s
Epoch: 5 cost time: 32.93479371070862
Epoch: 5, Steps: 2272 | Train Loss: 0.5973326 Vali Loss: 0.4392118 Test Loss: 0.1986005
Validation loss decreased (0.453491 --> 0.439212).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.3474716
	speed: 0.0525s/iter; left time: 1785.6539s
	iters: 200, epoch: 6 | loss: 0.3716055
	speed: 0.0141s/iter; left time: 478.2945s
	iters: 300, epoch: 6 | loss: 0.4375324
	speed: 0.0143s/iter; left time: 483.1617s
	iters: 400, epoch: 6 | loss: 0.4122401
	speed: 0.0146s/iter; left time: 493.3529s
	iters: 500, epoch: 6 | loss: 0.2864947
	speed: 0.0146s/iter; left time: 489.7092s
	iters: 600, epoch: 6 | loss: 0.4077267
	speed: 0.0145s/iter; left time: 484.6999s
	iters: 700, epoch: 6 | loss: 0.3169203
	speed: 0.0149s/iter; left time: 498.0790s
	iters: 800, epoch: 6 | loss: 0.3515741
	speed: 0.0145s/iter; left time: 483.1522s
	iters: 900, epoch: 6 | loss: 3.5774882
	speed: 0.0144s/iter; left time: 477.0584s
	iters: 1000, epoch: 6 | loss: 0.3951469
	speed: 0.0145s/iter; left time: 480.7433s
	iters: 1100, epoch: 6 | loss: 0.2826056
	speed: 0.0149s/iter; left time: 492.3080s
	iters: 1200, epoch: 6 | loss: 0.3416331
	speed: 0.0143s/iter; left time: 469.5890s
	iters: 1300, epoch: 6 | loss: 0.5737847
	speed: 0.0142s/iter; left time: 467.1042s
	iters: 1400, epoch: 6 | loss: 0.2393654
	speed: 0.0142s/iter; left time: 462.9043s
	iters: 1500, epoch: 6 | loss: 0.4744524
	speed: 0.0142s/iter; left time: 461.7370s
	iters: 1600, epoch: 6 | loss: 0.2447597
	speed: 0.0144s/iter; left time: 466.1716s
	iters: 1700, epoch: 6 | loss: 0.3468381
	speed: 0.0146s/iter; left time: 472.6584s
	iters: 1800, epoch: 6 | loss: 0.2972521
	speed: 0.0143s/iter; left time: 460.0611s
	iters: 1900, epoch: 6 | loss: 0.2884936
	speed: 0.0145s/iter; left time: 467.8200s
	iters: 2000, epoch: 6 | loss: 0.4019278
	speed: 0.0150s/iter; left time: 482.5738s
	iters: 2100, epoch: 6 | loss: 1.2807014
	speed: 0.0144s/iter; left time: 459.0236s
	iters: 2200, epoch: 6 | loss: 0.3804812
	speed: 0.0150s/iter; left time: 479.2378s
Epoch: 6 cost time: 32.809205770492554
Epoch: 6, Steps: 2272 | Train Loss: 0.5742905 Vali Loss: 0.4271955 Test Loss: 0.1918651
Validation loss decreased (0.439212 --> 0.427195).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.3461359
	speed: 0.0530s/iter; left time: 1681.3548s
	iters: 200, epoch: 7 | loss: 0.4595778
	speed: 0.0145s/iter; left time: 458.7464s
	iters: 300, epoch: 7 | loss: 0.4282221
	speed: 0.0145s/iter; left time: 457.1498s
	iters: 400, epoch: 7 | loss: 0.4548984
	speed: 0.0144s/iter; left time: 452.3146s
	iters: 500, epoch: 7 | loss: 4.0109420
	speed: 0.0145s/iter; left time: 453.3167s
	iters: 600, epoch: 7 | loss: 0.2580247
	speed: 0.0145s/iter; left time: 453.8265s
	iters: 700, epoch: 7 | loss: 0.3740405
	speed: 0.0143s/iter; left time: 446.2349s
	iters: 800, epoch: 7 | loss: 0.3788312
	speed: 0.0141s/iter; left time: 437.4373s
	iters: 900, epoch: 7 | loss: 0.5172717
	speed: 0.0144s/iter; left time: 444.8853s
	iters: 1000, epoch: 7 | loss: 0.2912406
	speed: 0.0148s/iter; left time: 456.1866s
	iters: 1100, epoch: 7 | loss: 0.2823155
	speed: 0.0144s/iter; left time: 441.6902s
	iters: 1200, epoch: 7 | loss: 0.2572441
	speed: 0.0146s/iter; left time: 445.4662s
	iters: 1300, epoch: 7 | loss: 0.4722657
	speed: 0.0147s/iter; left time: 448.1080s
	iters: 1400, epoch: 7 | loss: 0.3067973
	speed: 0.0143s/iter; left time: 434.8260s
	iters: 1500, epoch: 7 | loss: 0.2494858
	speed: 0.0142s/iter; left time: 430.5872s
	iters: 1600, epoch: 7 | loss: 0.2381593
	speed: 0.0148s/iter; left time: 448.2740s
	iters: 1700, epoch: 7 | loss: 0.3998909
	speed: 0.0144s/iter; left time: 432.1026s
	iters: 1800, epoch: 7 | loss: 0.2031423
	speed: 0.0143s/iter; left time: 428.6489s
	iters: 1900, epoch: 7 | loss: 0.3149639
	speed: 0.0143s/iter; left time: 427.4596s
	iters: 2000, epoch: 7 | loss: 0.3302935
	speed: 0.0146s/iter; left time: 435.7124s
	iters: 2100, epoch: 7 | loss: 0.3111535
	speed: 0.0145s/iter; left time: 430.2794s
	iters: 2200, epoch: 7 | loss: 0.3474045
	speed: 0.0149s/iter; left time: 439.8969s
Epoch: 7 cost time: 32.78290605545044
Epoch: 7, Steps: 2272 | Train Loss: 0.5634848 Vali Loss: 0.4279369 Test Loss: 0.1931056
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.4618127
	speed: 0.0524s/iter; left time: 1541.5184s
	iters: 200, epoch: 8 | loss: 0.4097348
	speed: 0.0142s/iter; left time: 416.8593s
	iters: 300, epoch: 8 | loss: 0.2379918
	speed: 0.0148s/iter; left time: 433.7231s
	iters: 400, epoch: 8 | loss: 0.4901645
	speed: 0.0142s/iter; left time: 414.5369s
	iters: 500, epoch: 8 | loss: 0.3175593
	speed: 0.0143s/iter; left time: 416.4115s
	iters: 600, epoch: 8 | loss: 0.3087000
	speed: 0.0146s/iter; left time: 423.3269s
	iters: 700, epoch: 8 | loss: 0.2305790
	speed: 0.0143s/iter; left time: 413.3728s
	iters: 800, epoch: 8 | loss: 0.3035346
	speed: 0.0140s/iter; left time: 401.0210s
	iters: 900, epoch: 8 | loss: 0.2736283
	speed: 0.0139s/iter; left time: 397.5719s
	iters: 1000, epoch: 8 | loss: 1.0124704
	speed: 0.0144s/iter; left time: 410.8798s
	iters: 1100, epoch: 8 | loss: 0.3603104
	speed: 0.0141s/iter; left time: 400.1571s
	iters: 1200, epoch: 8 | loss: 0.2805701
	speed: 0.0144s/iter; left time: 408.6974s
	iters: 1300, epoch: 8 | loss: 0.3885683
	speed: 0.0144s/iter; left time: 407.9548s
	iters: 1400, epoch: 8 | loss: 0.2886851
	speed: 0.0143s/iter; left time: 401.8164s
	iters: 1500, epoch: 8 | loss: 0.3113346
	speed: 0.0145s/iter; left time: 407.0373s
	iters: 1600, epoch: 8 | loss: 0.2871146
	speed: 0.0147s/iter; left time: 410.8177s
	iters: 1700, epoch: 8 | loss: 0.2956612
	speed: 0.0144s/iter; left time: 401.8989s
	iters: 1800, epoch: 8 | loss: 0.4425502
	speed: 0.0146s/iter; left time: 405.9987s
	iters: 1900, epoch: 8 | loss: 0.2701695
	speed: 0.0149s/iter; left time: 412.4074s
	iters: 2000, epoch: 8 | loss: 0.3006040
	speed: 0.0141s/iter; left time: 387.9603s
	iters: 2100, epoch: 8 | loss: 0.4205798
	speed: 0.0148s/iter; left time: 405.7333s
	iters: 2200, epoch: 8 | loss: 1.2675672
	speed: 0.0146s/iter; left time: 398.3088s
Epoch: 8 cost time: 32.58006978034973
Epoch: 8, Steps: 2272 | Train Loss: 0.5579606 Vali Loss: 0.4233370 Test Loss: 0.1865968
Validation loss decreased (0.427195 --> 0.423337).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.2414035
	speed: 0.0523s/iter; left time: 1421.6632s
	iters: 200, epoch: 9 | loss: 0.4122642
	speed: 0.0143s/iter; left time: 387.0738s
	iters: 300, epoch: 9 | loss: 0.3243465
	speed: 0.0144s/iter; left time: 387.6019s
	iters: 400, epoch: 9 | loss: 0.2694898
	speed: 0.0150s/iter; left time: 403.0983s
	iters: 500, epoch: 9 | loss: 0.2433850
	speed: 0.0145s/iter; left time: 386.8094s
	iters: 600, epoch: 9 | loss: 0.4879423
	speed: 0.0148s/iter; left time: 394.5567s
	iters: 700, epoch: 9 | loss: 2.3740139
	speed: 0.0142s/iter; left time: 375.9573s
	iters: 800, epoch: 9 | loss: 0.4884264
	speed: 0.0144s/iter; left time: 381.5159s
	iters: 900, epoch: 9 | loss: 0.1974303
	speed: 0.0147s/iter; left time: 387.3598s
	iters: 1000, epoch: 9 | loss: 0.2898953
	speed: 0.0144s/iter; left time: 378.0163s
	iters: 1100, epoch: 9 | loss: 0.6559473
	speed: 0.0143s/iter; left time: 373.9726s
	iters: 1200, epoch: 9 | loss: 0.2847954
	speed: 0.0146s/iter; left time: 380.8002s
	iters: 1300, epoch: 9 | loss: 0.3740434
	speed: 0.0142s/iter; left time: 369.6390s
	iters: 1400, epoch: 9 | loss: 0.3908601
	speed: 0.0146s/iter; left time: 376.8656s
	iters: 1500, epoch: 9 | loss: 0.5155895
	speed: 0.0145s/iter; left time: 373.6630s
	iters: 1600, epoch: 9 | loss: 0.3046080
	speed: 0.0143s/iter; left time: 366.1748s
	iters: 1700, epoch: 9 | loss: 0.3864968
	speed: 0.0152s/iter; left time: 387.8072s
	iters: 1800, epoch: 9 | loss: 0.3245697
	speed: 0.0142s/iter; left time: 360.8987s
	iters: 1900, epoch: 9 | loss: 0.3012162
	speed: 0.0147s/iter; left time: 371.9388s
	iters: 2000, epoch: 9 | loss: 1.3387626
	speed: 0.0147s/iter; left time: 370.7044s
	iters: 2100, epoch: 9 | loss: 0.4752389
	speed: 0.0143s/iter; left time: 360.1688s
	iters: 2200, epoch: 9 | loss: 0.3124713
	speed: 0.0148s/iter; left time: 370.6754s
Epoch: 9 cost time: 32.76452112197876
Epoch: 9, Steps: 2272 | Train Loss: 0.5553549 Vali Loss: 0.4238465 Test Loss: 0.1902594
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.4008175
	speed: 0.0517s/iter; left time: 1286.4904s
	iters: 200, epoch: 10 | loss: 0.4613593
	speed: 0.0140s/iter; left time: 346.9397s
	iters: 300, epoch: 10 | loss: 0.5190617
	speed: 0.0143s/iter; left time: 353.1870s
	iters: 400, epoch: 10 | loss: 0.3759973
	speed: 0.0142s/iter; left time: 348.5472s
	iters: 500, epoch: 10 | loss: 0.2492981
	speed: 0.0146s/iter; left time: 357.4149s
	iters: 600, epoch: 10 | loss: 3.3655322
	speed: 0.0142s/iter; left time: 347.1385s
	iters: 700, epoch: 10 | loss: 0.4030412
	speed: 0.0142s/iter; left time: 344.1506s
	iters: 800, epoch: 10 | loss: 1.3292989
	speed: 0.0144s/iter; left time: 347.2285s
	iters: 900, epoch: 10 | loss: 0.4165959
	speed: 0.0143s/iter; left time: 344.3938s
	iters: 1000, epoch: 10 | loss: 0.4715101
	speed: 0.0147s/iter; left time: 353.2723s
	iters: 1100, epoch: 10 | loss: 0.2862118
	speed: 0.0147s/iter; left time: 351.1464s
	iters: 1200, epoch: 10 | loss: 0.3069808
	speed: 0.0144s/iter; left time: 343.7541s
	iters: 1300, epoch: 10 | loss: 0.6258185
	speed: 0.0143s/iter; left time: 339.1070s
	iters: 1400, epoch: 10 | loss: 1.2581627
	speed: 0.0144s/iter; left time: 340.7274s
	iters: 1500, epoch: 10 | loss: 0.3975366
	speed: 0.0147s/iter; left time: 344.8083s
	iters: 1600, epoch: 10 | loss: 0.7010135
	speed: 0.0145s/iter; left time: 339.8353s
	iters: 1700, epoch: 10 | loss: 0.3425537
	speed: 0.0150s/iter; left time: 350.2640s
	iters: 1800, epoch: 10 | loss: 0.4382195
	speed: 0.0145s/iter; left time: 335.3511s
	iters: 1900, epoch: 10 | loss: 0.3254818
	speed: 0.0144s/iter; left time: 333.2921s
	iters: 2000, epoch: 10 | loss: 0.2933167
	speed: 0.0146s/iter; left time: 336.0666s
	iters: 2100, epoch: 10 | loss: 0.4573213
	speed: 0.0143s/iter; left time: 328.3266s
	iters: 2200, epoch: 10 | loss: 1.2788152
	speed: 0.0143s/iter; left time: 325.3237s
Epoch: 10 cost time: 32.616206884384155
Epoch: 10, Steps: 2272 | Train Loss: 0.5539364 Vali Loss: 0.4237398 Test Loss: 0.1879759
EarlyStopping counter: 2 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.3967658
	speed: 0.0534s/iter; left time: 1208.9187s
	iters: 200, epoch: 11 | loss: 0.4784430
	speed: 0.0141s/iter; left time: 317.0563s
	iters: 300, epoch: 11 | loss: 0.2824738
	speed: 0.0146s/iter; left time: 328.1416s
	iters: 400, epoch: 11 | loss: 0.3475069
	speed: 0.0149s/iter; left time: 332.9693s
	iters: 500, epoch: 11 | loss: 0.6045330
	speed: 0.0144s/iter; left time: 320.4775s
	iters: 600, epoch: 11 | loss: 0.2879435
	speed: 0.0142s/iter; left time: 314.2913s
	iters: 700, epoch: 11 | loss: 0.3366069
	speed: 0.0146s/iter; left time: 321.3738s
	iters: 800, epoch: 11 | loss: 0.4995902
	speed: 0.0145s/iter; left time: 317.8684s
	iters: 900, epoch: 11 | loss: 0.2648619
	speed: 0.0145s/iter; left time: 315.6870s
	iters: 1000, epoch: 11 | loss: 0.3659192
	speed: 0.0147s/iter; left time: 320.3302s
	iters: 1100, epoch: 11 | loss: 0.6337748
	speed: 0.0146s/iter; left time: 314.8444s
	iters: 1200, epoch: 11 | loss: 0.3348841
	speed: 0.0144s/iter; left time: 309.1957s
	iters: 1300, epoch: 11 | loss: 0.3358883
	speed: 0.0144s/iter; left time: 308.6035s
	iters: 1400, epoch: 11 | loss: 0.2450716
	speed: 0.0145s/iter; left time: 308.1868s
	iters: 1500, epoch: 11 | loss: 0.3040865
	speed: 0.0148s/iter; left time: 313.5275s
	iters: 1600, epoch: 11 | loss: 0.4033113
	speed: 0.0143s/iter; left time: 301.8482s
	iters: 1700, epoch: 11 | loss: 0.4053132
	speed: 0.0141s/iter; left time: 295.4349s
	iters: 1800, epoch: 11 | loss: 0.3040089
	speed: 0.0145s/iter; left time: 302.6740s
	iters: 1900, epoch: 11 | loss: 0.5767872
	speed: 0.0147s/iter; left time: 306.3069s
	iters: 2000, epoch: 11 | loss: 0.4914835
	speed: 0.0145s/iter; left time: 300.0710s
	iters: 2100, epoch: 11 | loss: 0.4611071
	speed: 0.0145s/iter; left time: 298.6778s
	iters: 2200, epoch: 11 | loss: 2.4233067
	speed: 0.0150s/iter; left time: 308.3738s
Epoch: 11 cost time: 32.77316212654114
Epoch: 11, Steps: 2272 | Train Loss: 0.5531559 Vali Loss: 0.4245066 Test Loss: 0.1886922
EarlyStopping counter: 3 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.2527589
	speed: 0.0527s/iter; left time: 1072.8143s
	iters: 200, epoch: 12 | loss: 0.2767760
	speed: 0.0145s/iter; left time: 293.3881s
	iters: 300, epoch: 12 | loss: 0.3576504
	speed: 0.0147s/iter; left time: 296.3590s
	iters: 400, epoch: 12 | loss: 0.3054735
	speed: 0.0145s/iter; left time: 289.8760s
	iters: 500, epoch: 12 | loss: 0.4522074
	speed: 0.0144s/iter; left time: 286.5090s
	iters: 600, epoch: 12 | loss: 0.2815245
	speed: 0.0143s/iter; left time: 283.5838s
	iters: 700, epoch: 12 | loss: 0.3311233
	speed: 0.0142s/iter; left time: 279.6317s
	iters: 800, epoch: 12 | loss: 0.5226833
	speed: 0.0145s/iter; left time: 285.5352s
	iters: 900, epoch: 12 | loss: 0.3032293
	speed: 0.0142s/iter; left time: 278.1203s
	iters: 1000, epoch: 12 | loss: 0.5531074
	speed: 0.0144s/iter; left time: 280.4922s
	iters: 1100, epoch: 12 | loss: 1.3410714
	speed: 0.0147s/iter; left time: 284.7898s
	iters: 1200, epoch: 12 | loss: 0.4151902
	speed: 0.0150s/iter; left time: 288.7215s
	iters: 1300, epoch: 12 | loss: 0.2507272
	speed: 0.0148s/iter; left time: 283.4643s
	iters: 1400, epoch: 12 | loss: 0.3628288
	speed: 0.0140s/iter; left time: 267.5061s
	iters: 1500, epoch: 12 | loss: 0.3138887
	speed: 0.0146s/iter; left time: 276.7732s
	iters: 1600, epoch: 12 | loss: 0.3410670
	speed: 0.0146s/iter; left time: 275.8917s
	iters: 1700, epoch: 12 | loss: 0.2537030
	speed: 0.0147s/iter; left time: 276.0116s
	iters: 1800, epoch: 12 | loss: 0.2869209
	speed: 0.0145s/iter; left time: 270.0234s
	iters: 1900, epoch: 12 | loss: 0.2924377
	speed: 0.0145s/iter; left time: 268.1428s
	iters: 2000, epoch: 12 | loss: 0.3863539
	speed: 0.0144s/iter; left time: 266.4407s
	iters: 2100, epoch: 12 | loss: 0.2469433
	speed: 0.0142s/iter; left time: 260.4050s
	iters: 2200, epoch: 12 | loss: 0.3137433
	speed: 0.0143s/iter; left time: 260.0921s
Epoch: 12 cost time: 32.69986701011658
Epoch: 12, Steps: 2272 | Train Loss: 0.5528541 Vali Loss: 0.4246130 Test Loss: 0.1893914
EarlyStopping counter: 4 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.3645983
	speed: 0.0528s/iter; left time: 954.2024s
	iters: 200, epoch: 13 | loss: 0.3122571
	speed: 0.0142s/iter; left time: 254.4150s
	iters: 300, epoch: 13 | loss: 0.1691783
	speed: 0.0149s/iter; left time: 265.6092s
	iters: 400, epoch: 13 | loss: 0.2957173
	speed: 0.0147s/iter; left time: 260.5486s
	iters: 500, epoch: 13 | loss: 0.3902746
	speed: 0.0146s/iter; left time: 258.0138s
	iters: 600, epoch: 13 | loss: 0.3263423
	speed: 0.0151s/iter; left time: 264.7762s
	iters: 700, epoch: 13 | loss: 0.3249036
	speed: 0.0149s/iter; left time: 260.2265s
	iters: 800, epoch: 13 | loss: 0.3416394
	speed: 0.0147s/iter; left time: 255.3563s
	iters: 900, epoch: 13 | loss: 2.1991713
	speed: 0.0145s/iter; left time: 249.7292s
	iters: 1000, epoch: 13 | loss: 0.3059375
	speed: 0.0143s/iter; left time: 245.7034s
	iters: 1100, epoch: 13 | loss: 0.2817164
	speed: 0.0144s/iter; left time: 245.6970s
	iters: 1200, epoch: 13 | loss: 0.6602935
	speed: 0.0145s/iter; left time: 245.6704s
	iters: 1300, epoch: 13 | loss: 0.4918009
	speed: 0.0145s/iter; left time: 244.8874s
	iters: 1400, epoch: 13 | loss: 0.5040293
	speed: 0.0144s/iter; left time: 241.5535s
	iters: 1500, epoch: 13 | loss: 0.3456729
	speed: 0.0142s/iter; left time: 236.9176s
	iters: 1600, epoch: 13 | loss: 0.2827098
	speed: 0.0147s/iter; left time: 243.5452s
	iters: 1700, epoch: 13 | loss: 0.7296513
	speed: 0.0144s/iter; left time: 236.8453s
	iters: 1800, epoch: 13 | loss: 0.3245483
	speed: 0.0146s/iter; left time: 238.9683s
	iters: 1900, epoch: 13 | loss: 0.2464793
	speed: 0.0142s/iter; left time: 230.8542s
	iters: 2000, epoch: 13 | loss: 0.3435012
	speed: 0.0140s/iter; left time: 227.1588s
	iters: 2100, epoch: 13 | loss: 0.2188395
	speed: 0.0143s/iter; left time: 230.1878s
	iters: 2200, epoch: 13 | loss: 0.4146410
	speed: 0.0145s/iter; left time: 231.9803s
Epoch: 13 cost time: 32.7138831615448
Epoch: 13, Steps: 2272 | Train Loss: 0.5526538 Vali Loss: 0.4240328 Test Loss: 0.1887302
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : weather_336_192_Linear_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed12890<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10348
mse:0.18664491176605225, mae:0.2543747127056122
