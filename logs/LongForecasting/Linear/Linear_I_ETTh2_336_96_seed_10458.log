Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTh2', data_path='ETTh2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.05, loss='mse', lradj='type1', model='Linear', model_id='ETTh2_336_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=10458, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTh2_336_96_Linear_ETTh2_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed10458>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 2.3442059
	speed: 0.0037s/iter; left time: 37.9133s
	iters: 200, epoch: 1 | loss: 1.7680417
	speed: 0.0037s/iter; left time: 36.8233s
	iters: 300, epoch: 1 | loss: 2.0996540
	speed: 0.0029s/iter; left time: 28.9172s
	iters: 400, epoch: 1 | loss: 6.6019540
	speed: 0.0030s/iter; left time: 29.4844s
	iters: 500, epoch: 1 | loss: 11.7484961
	speed: 0.0038s/iter; left time: 36.7063s
Epoch: 1 cost time: 1.754478931427002
Epoch: 1, Steps: 513 | Train Loss: 8.7006273 Vali Loss: 6.4771323 Test Loss: 14.5825987
Validation loss decreased (inf --> 6.477132).  Saving model ...
Updating learning rate to 0.05
	iters: 100, epoch: 2 | loss: 4.4055209
	speed: 0.0073s/iter; left time: 70.7440s
	iters: 200, epoch: 2 | loss: 2.0902238
	speed: 0.0036s/iter; left time: 34.0891s
	iters: 300, epoch: 2 | loss: 2.5707123
	speed: 0.0031s/iter; left time: 29.4142s
	iters: 400, epoch: 2 | loss: 1.9911288
	speed: 0.0027s/iter; left time: 25.3330s
	iters: 500, epoch: 2 | loss: 7.0131598
	speed: 0.0029s/iter; left time: 27.1892s
Epoch: 2 cost time: 1.6023504734039307
Epoch: 2, Steps: 513 | Train Loss: 5.0632968 Vali Loss: 4.1680694 Test Loss: 9.9562559
Validation loss decreased (6.477132 --> 4.168069).  Saving model ...
Updating learning rate to 0.025
	iters: 100, epoch: 3 | loss: 1.0680177
	speed: 0.0070s/iter; left time: 64.3283s
	iters: 200, epoch: 3 | loss: 0.7164630
	speed: 0.0034s/iter; left time: 30.8999s
	iters: 300, epoch: 3 | loss: 1.7315788
	speed: 0.0036s/iter; left time: 32.2770s
	iters: 400, epoch: 3 | loss: 0.5228858
	speed: 0.0037s/iter; left time: 32.6130s
	iters: 500, epoch: 3 | loss: 1.2088509
	speed: 0.0032s/iter; left time: 28.2140s
Epoch: 3 cost time: 1.769437551498413
Epoch: 3, Steps: 513 | Train Loss: 1.0519101 Vali Loss: 0.9806855 Test Loss: 1.8575538
Validation loss decreased (4.168069 --> 0.980686).  Saving model ...
Updating learning rate to 0.0125
	iters: 100, epoch: 4 | loss: 0.2720541
	speed: 0.0070s/iter; left time: 60.0318s
	iters: 200, epoch: 4 | loss: 0.3523497
	speed: 0.0032s/iter; left time: 27.6113s
	iters: 300, epoch: 4 | loss: 0.5604281
	speed: 0.0034s/iter; left time: 28.4068s
	iters: 400, epoch: 4 | loss: 0.4241397
	speed: 0.0038s/iter; left time: 31.4572s
	iters: 500, epoch: 4 | loss: 0.1953723
	speed: 0.0034s/iter; left time: 27.6401s
Epoch: 4 cost time: 1.7514665126800537
Epoch: 4, Steps: 513 | Train Loss: 0.5284944 Vali Loss: 0.5815847 Test Loss: 1.3042591
Validation loss decreased (0.980686 --> 0.581585).  Saving model ...
Updating learning rate to 0.00625
	iters: 100, epoch: 5 | loss: 0.2741542
	speed: 0.0071s/iter; left time: 57.5737s
	iters: 200, epoch: 5 | loss: 0.4622855
	speed: 0.0038s/iter; left time: 30.0485s
	iters: 300, epoch: 5 | loss: 0.2026097
	speed: 0.0037s/iter; left time: 29.1842s
	iters: 400, epoch: 5 | loss: 0.9481621
	speed: 0.0035s/iter; left time: 27.5680s
	iters: 500, epoch: 5 | loss: 0.4180680
	speed: 0.0032s/iter; left time: 24.9185s
Epoch: 5 cost time: 1.8244524002075195
Epoch: 5, Steps: 513 | Train Loss: 0.4331915 Vali Loss: 0.5055751 Test Loss: 0.9995151
Validation loss decreased (0.581585 --> 0.505575).  Saving model ...
Updating learning rate to 0.003125
	iters: 100, epoch: 6 | loss: 0.5005838
	speed: 0.0067s/iter; left time: 51.1892s
	iters: 200, epoch: 6 | loss: 0.8310393
	speed: 0.0029s/iter; left time: 21.6791s
	iters: 300, epoch: 6 | loss: 0.2269069
	speed: 0.0028s/iter; left time: 20.5609s
	iters: 400, epoch: 6 | loss: 0.3316812
	speed: 0.0031s/iter; left time: 22.5445s
	iters: 500, epoch: 6 | loss: 0.4507596
	speed: 0.0032s/iter; left time: 23.3302s
Epoch: 6 cost time: 1.5433123111724854
Epoch: 6, Steps: 513 | Train Loss: 0.3984724 Vali Loss: 0.4335883 Test Loss: 0.8209087
Validation loss decreased (0.505575 --> 0.433588).  Saving model ...
Updating learning rate to 0.0015625
	iters: 100, epoch: 7 | loss: 0.2196676
	speed: 0.0077s/iter; left time: 54.8260s
	iters: 200, epoch: 7 | loss: 0.2898219
	speed: 0.0035s/iter; left time: 24.5225s
	iters: 300, epoch: 7 | loss: 0.5752841
	speed: 0.0029s/iter; left time: 19.6166s
	iters: 400, epoch: 7 | loss: 0.2094471
	speed: 0.0032s/iter; left time: 22.0447s
	iters: 500, epoch: 7 | loss: 0.2282832
	speed: 0.0033s/iter; left time: 22.1413s
Epoch: 7 cost time: 1.7045361995697021
Epoch: 7, Steps: 513 | Train Loss: 0.3789372 Vali Loss: 0.2916909 Test Loss: 0.4343216
Validation loss decreased (0.433588 --> 0.291691).  Saving model ...
Updating learning rate to 0.00078125
	iters: 100, epoch: 8 | loss: 0.5240585
	speed: 0.0073s/iter; left time: 47.8952s
	iters: 200, epoch: 8 | loss: 0.3154761
	speed: 0.0033s/iter; left time: 21.1080s
	iters: 300, epoch: 8 | loss: 0.3015600
	speed: 0.0029s/iter; left time: 18.6672s
	iters: 400, epoch: 8 | loss: 0.2849383
	speed: 0.0028s/iter; left time: 17.5560s
	iters: 500, epoch: 8 | loss: 0.7241150
	speed: 0.0028s/iter; left time: 17.3994s
Epoch: 8 cost time: 1.5895493030548096
Epoch: 8, Steps: 513 | Train Loss: 0.3679488 Vali Loss: 0.3007116 Test Loss: 0.5139523
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.000390625
	iters: 100, epoch: 9 | loss: 0.4442074
	speed: 0.0072s/iter; left time: 43.6997s
	iters: 200, epoch: 9 | loss: 0.6494056
	speed: 0.0036s/iter; left time: 21.6129s
	iters: 300, epoch: 9 | loss: 0.4290770
	speed: 0.0036s/iter; left time: 21.2024s
	iters: 400, epoch: 9 | loss: 0.3089922
	speed: 0.0037s/iter; left time: 21.5887s
	iters: 500, epoch: 9 | loss: 0.2020437
	speed: 0.0037s/iter; left time: 20.9993s
Epoch: 9 cost time: 1.877021312713623
Epoch: 9, Steps: 513 | Train Loss: 0.3618431 Vali Loss: 0.2779688 Test Loss: 0.3989096
Validation loss decreased (0.291691 --> 0.277969).  Saving model ...
Updating learning rate to 0.0001953125
	iters: 100, epoch: 10 | loss: 0.2286186
	speed: 0.0073s/iter; left time: 40.5266s
	iters: 200, epoch: 10 | loss: 0.6061496
	speed: 0.0034s/iter; left time: 18.5213s
	iters: 300, epoch: 10 | loss: 0.3231757
	speed: 0.0033s/iter; left time: 17.4793s
	iters: 400, epoch: 10 | loss: 0.4260855
	speed: 0.0033s/iter; left time: 17.4101s
	iters: 500, epoch: 10 | loss: 0.3216006
	speed: 0.0036s/iter; left time: 18.4828s
Epoch: 10 cost time: 1.7546064853668213
Epoch: 10, Steps: 513 | Train Loss: 0.3578127 Vali Loss: 0.2625999 Test Loss: 0.3642378
Validation loss decreased (0.277969 --> 0.262600).  Saving model ...
Updating learning rate to 9.765625e-05
	iters: 100, epoch: 11 | loss: 0.2956740
	speed: 0.0080s/iter; left time: 40.1652s
	iters: 200, epoch: 11 | loss: 0.4349095
	speed: 0.0033s/iter; left time: 16.4202s
	iters: 300, epoch: 11 | loss: 0.1883009
	speed: 0.0037s/iter; left time: 17.6816s
	iters: 400, epoch: 11 | loss: 0.1773883
	speed: 0.0033s/iter; left time: 15.5322s
	iters: 500, epoch: 11 | loss: 0.5162576
	speed: 0.0033s/iter; left time: 15.3286s
Epoch: 11 cost time: 1.7824828624725342
Epoch: 11, Steps: 513 | Train Loss: 0.3551872 Vali Loss: 0.2821474 Test Loss: 0.4346282
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.8828125e-05
	iters: 100, epoch: 12 | loss: 0.4149552
	speed: 0.0076s/iter; left time: 34.1590s
	iters: 200, epoch: 12 | loss: 0.4186145
	speed: 0.0035s/iter; left time: 15.3306s
	iters: 300, epoch: 12 | loss: 0.2416909
	speed: 0.0034s/iter; left time: 14.5947s
	iters: 400, epoch: 12 | loss: 0.2875447
	speed: 0.0033s/iter; left time: 13.8844s
	iters: 500, epoch: 12 | loss: 0.2971670
	speed: 0.0030s/iter; left time: 12.2716s
Epoch: 12 cost time: 1.7252311706542969
Epoch: 12, Steps: 513 | Train Loss: 0.3536987 Vali Loss: 0.2795211 Test Loss: 0.4308924
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.44140625e-05
	iters: 100, epoch: 13 | loss: 0.4406475
	speed: 0.0063s/iter; left time: 25.3263s
	iters: 200, epoch: 13 | loss: 0.5105361
	speed: 0.0032s/iter; left time: 12.6523s
	iters: 300, epoch: 13 | loss: 0.2469480
	speed: 0.0032s/iter; left time: 12.2521s
	iters: 400, epoch: 13 | loss: 0.5126086
	speed: 0.0033s/iter; left time: 12.1235s
	iters: 500, epoch: 13 | loss: 0.2535838
	speed: 0.0032s/iter; left time: 11.4278s
Epoch: 13 cost time: 1.6505486965179443
Epoch: 13, Steps: 513 | Train Loss: 0.3532587 Vali Loss: 0.2791844 Test Loss: 0.4273695
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.220703125e-05
	iters: 100, epoch: 14 | loss: 0.3509107
	speed: 0.0069s/iter; left time: 24.1710s
	iters: 200, epoch: 14 | loss: 0.7660163
	speed: 0.0036s/iter; left time: 12.3262s
	iters: 300, epoch: 14 | loss: 0.2783214
	speed: 0.0036s/iter; left time: 11.9171s
	iters: 400, epoch: 14 | loss: 0.3831365
	speed: 0.0033s/iter; left time: 10.4463s
	iters: 500, epoch: 14 | loss: 0.7569420
	speed: 0.0032s/iter; left time: 9.8326s
Epoch: 14 cost time: 1.7438406944274902
Epoch: 14, Steps: 513 | Train Loss: 0.3526244 Vali Loss: 0.2791410 Test Loss: 0.4245814
EarlyStopping counter: 4 out of 5
Updating learning rate to 6.103515625e-06
	iters: 100, epoch: 15 | loss: 0.2077761
	speed: 0.0065s/iter; left time: 19.2809s
	iters: 200, epoch: 15 | loss: 0.2938465
	speed: 0.0027s/iter; left time: 7.7157s
	iters: 300, epoch: 15 | loss: 0.2031891
	speed: 0.0027s/iter; left time: 7.5311s
	iters: 400, epoch: 15 | loss: 0.4945987
	speed: 0.0027s/iter; left time: 7.2065s
	iters: 500, epoch: 15 | loss: 0.1893960
	speed: 0.0027s/iter; left time: 7.0488s
Epoch: 15 cost time: 1.4034929275512695
Epoch: 15, Steps: 513 | Train Loss: 0.3523915 Vali Loss: 0.2804504 Test Loss: 0.4266745
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTh2_336_96_Linear_ETTh2_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed10458<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.36562085151672363, mae:0.3915966749191284
