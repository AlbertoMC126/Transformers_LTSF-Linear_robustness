Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTh1', data_path='ETTh1.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='NLinear', model_id='ETTh1_336_720', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=720, root_path='./dataset/', save_pred_values=False, seed=15349, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTh1_336_720_NLinear_ETTh1_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15349>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7585
val 2161
test 2161
	iters: 100, epoch: 1 | loss: 0.6861204
	speed: 0.0194s/iter; left time: 90.2283s
	iters: 200, epoch: 1 | loss: 0.6918274
	speed: 0.0180s/iter; left time: 81.8360s
Epoch: 1 cost time: 4.391525983810425
Epoch: 1, Steps: 237 | Train Loss: 0.6759909 Vali Loss: 1.7703502 Test Loss: 0.5759209
Validation loss decreased (inf --> 1.770350).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.6666861
	speed: 0.0331s/iter; left time: 145.8529s
	iters: 200, epoch: 2 | loss: 0.6606809
	speed: 0.0193s/iter; left time: 83.1558s
Epoch: 2 cost time: 4.548178434371948
Epoch: 2, Steps: 237 | Train Loss: 0.6419214 Vali Loss: 1.7261779 Test Loss: 0.5340198
Validation loss decreased (1.770350 --> 1.726178).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.5474734
	speed: 0.0325s/iter; left time: 135.5916s
	iters: 200, epoch: 3 | loss: 0.5636525
	speed: 0.0192s/iter; left time: 77.9061s
Epoch: 3 cost time: 4.433081150054932
Epoch: 3, Steps: 237 | Train Loss: 0.5889795 Vali Loss: 1.5851480 Test Loss: 0.5004773
Validation loss decreased (1.726178 --> 1.585148).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.5741026
	speed: 0.0346s/iter; left time: 135.8016s
	iters: 200, epoch: 4 | loss: 0.5504816
	speed: 0.0188s/iter; left time: 71.8392s
Epoch: 4 cost time: 4.357739210128784
Epoch: 4, Steps: 237 | Train Loss: 0.5646869 Vali Loss: 1.5701187 Test Loss: 0.4728065
Validation loss decreased (1.585148 --> 1.570119).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.5054871
	speed: 0.0320s/iter; left time: 118.0866s
	iters: 200, epoch: 5 | loss: 0.5131281
	speed: 0.0195s/iter; left time: 70.2002s
Epoch: 5 cost time: 4.464368104934692
Epoch: 5, Steps: 237 | Train Loss: 0.5536989 Vali Loss: 1.5406297 Test Loss: 0.4637055
Validation loss decreased (1.570119 --> 1.540630).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.4791866
	speed: 0.0334s/iter; left time: 115.2615s
	iters: 200, epoch: 6 | loss: 0.5290864
	speed: 0.0197s/iter; left time: 66.0823s
Epoch: 6 cost time: 4.491147756576538
Epoch: 6, Steps: 237 | Train Loss: 0.5480176 Vali Loss: 1.5179580 Test Loss: 0.4563816
Validation loss decreased (1.540630 --> 1.517958).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.5620825
	speed: 0.0325s/iter; left time: 104.5182s
	iters: 200, epoch: 7 | loss: 0.5447909
	speed: 0.0194s/iter; left time: 60.5249s
Epoch: 7 cost time: 4.4314703941345215
Epoch: 7, Steps: 237 | Train Loss: 0.5447346 Vali Loss: 1.5282403 Test Loss: 0.4572348
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.5905736
	speed: 0.0333s/iter; left time: 99.4143s
	iters: 200, epoch: 8 | loss: 0.5357544
	speed: 0.0197s/iter; left time: 56.8397s
Epoch: 8 cost time: 4.489129304885864
Epoch: 8, Steps: 237 | Train Loss: 0.5427405 Vali Loss: 1.5210757 Test Loss: 0.4542083
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.5848131
	speed: 0.0332s/iter; left time: 91.1130s
	iters: 200, epoch: 9 | loss: 0.5224988
	speed: 0.0183s/iter; left time: 48.3510s
Epoch: 9 cost time: 4.263574123382568
Epoch: 9, Steps: 237 | Train Loss: 0.5416833 Vali Loss: 1.5198543 Test Loss: 0.4538118
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.4796309
	speed: 0.0333s/iter; left time: 83.4218s
	iters: 200, epoch: 10 | loss: 0.6028733
	speed: 0.0195s/iter; left time: 46.9034s
Epoch: 10 cost time: 4.453972578048706
Epoch: 10, Steps: 237 | Train Loss: 0.5412479 Vali Loss: 1.5149139 Test Loss: 0.4541947
Validation loss decreased (1.517958 --> 1.514914).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.5398425
	speed: 0.0333s/iter; left time: 75.5315s
	iters: 200, epoch: 11 | loss: 0.5100537
	speed: 0.0187s/iter; left time: 40.5807s
Epoch: 11 cost time: 4.328347444534302
Epoch: 11, Steps: 237 | Train Loss: 0.5408439 Vali Loss: 1.5154865 Test Loss: 0.4534342
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.5367492
	speed: 0.0330s/iter; left time: 67.1746s
	iters: 200, epoch: 12 | loss: 0.5735661
	speed: 0.0171s/iter; left time: 33.0974s
Epoch: 12 cost time: 4.095443487167358
Epoch: 12, Steps: 237 | Train Loss: 0.5407520 Vali Loss: 1.5171609 Test Loss: 0.4534544
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.5604199
	speed: 0.0304s/iter; left time: 54.6038s
	iters: 200, epoch: 13 | loss: 0.5287158
	speed: 0.0162s/iter; left time: 27.5224s
Epoch: 13 cost time: 3.8077588081359863
Epoch: 13, Steps: 237 | Train Loss: 0.5406149 Vali Loss: 1.5151235 Test Loss: 0.4535009
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.6091784
	speed: 0.0289s/iter; left time: 45.1196s
	iters: 200, epoch: 14 | loss: 0.5669487
	speed: 0.0168s/iter; left time: 24.5088s
Epoch: 14 cost time: 3.810678005218506
Epoch: 14, Steps: 237 | Train Loss: 0.5405485 Vali Loss: 1.5133876 Test Loss: 0.4535107
Validation loss decreased (1.514914 --> 1.513388).  Saving model ...
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.4486501
	speed: 0.0270s/iter; left time: 35.7227s
	iters: 200, epoch: 15 | loss: 0.5615239
	speed: 0.0151s/iter; left time: 18.5276s
Epoch: 15 cost time: 3.502725124359131
Epoch: 15, Steps: 237 | Train Loss: 0.5406005 Vali Loss: 1.5157360 Test Loss: 0.4535162
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.6027600
	speed: 0.0265s/iter; left time: 28.7965s
	iters: 200, epoch: 16 | loss: 0.4694593
	speed: 0.0138s/iter; left time: 13.6321s
Epoch: 16 cost time: 3.315950393676758
Epoch: 16, Steps: 237 | Train Loss: 0.5405674 Vali Loss: 1.5164658 Test Loss: 0.4535203
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 17 | loss: 0.5734936
	speed: 0.0254s/iter; left time: 21.5641s
	iters: 200, epoch: 17 | loss: 0.5623240
	speed: 0.0134s/iter; left time: 10.0500s
Epoch: 17 cost time: 3.2172746658325195
Epoch: 17, Steps: 237 | Train Loss: 0.5404944 Vali Loss: 1.5161091 Test Loss: 0.4535192
EarlyStopping counter: 3 out of 5
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 18 | loss: 0.5692080
	speed: 0.0239s/iter; left time: 14.6551s
	iters: 200, epoch: 18 | loss: 0.4946460
	speed: 0.0107s/iter; left time: 5.4593s
Epoch: 18 cost time: 2.763913869857788
Epoch: 18, Steps: 237 | Train Loss: 0.5405690 Vali Loss: 1.5177765 Test Loss: 0.4535190
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 19 | loss: 0.6318893
	speed: 0.0229s/iter; left time: 8.5926s
	iters: 200, epoch: 19 | loss: 0.4774207
	speed: 0.0111s/iter; left time: 3.0643s
Epoch: 19 cost time: 2.843303918838501
Epoch: 19, Steps: 237 | Train Loss: 0.5405553 Vali Loss: 1.5148171 Test Loss: 0.4535194
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTh1_336_720_NLinear_ETTh1_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15349<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
mse:0.45238640904426575, mae:0.4597582519054413
