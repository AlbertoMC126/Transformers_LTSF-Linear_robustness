Args in experiment:
Namespace(activation='gelu', batch_size=8, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='exchange_rate.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=8, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='mse', lradj='type1', model='DLinear', model_id='Exchange_336_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=12890, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : Exchange_336_96_DLinear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed12890>>>>>>>>>>>>>>>>>>>>>>>>>>
train 4880
val 665
test 1422
	iters: 100, epoch: 1 | loss: 0.1722253
	speed: 0.0060s/iter; left time: 73.1292s
	iters: 200, epoch: 1 | loss: 0.2152411
	speed: 0.0059s/iter; left time: 70.3259s
	iters: 300, epoch: 1 | loss: 0.1617283
	speed: 0.0063s/iter; left time: 75.0051s
	iters: 400, epoch: 1 | loss: 0.1715219
	speed: 0.0067s/iter; left time: 79.3100s
	iters: 500, epoch: 1 | loss: 0.1931869
	speed: 0.0060s/iter; left time: 69.7785s
	iters: 600, epoch: 1 | loss: 0.2587577
	speed: 0.0059s/iter; left time: 68.6999s
Epoch: 1 cost time: 3.742163896560669
Epoch: 1, Steps: 610 | Train Loss: 0.1643967 Vali Loss: 0.2531705 Test Loss: 0.1195935
Validation loss decreased (inf --> 0.253171).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1162209
	speed: 0.0109s/iter; left time: 125.2910s
	iters: 200, epoch: 2 | loss: 0.2447832
	speed: 0.0052s/iter; left time: 59.6890s
	iters: 300, epoch: 2 | loss: 0.1035603
	speed: 0.0073s/iter; left time: 82.8074s
	iters: 400, epoch: 2 | loss: 0.1350486
	speed: 0.0062s/iter; left time: 69.0700s
	iters: 500, epoch: 2 | loss: 0.0878285
	speed: 0.0062s/iter; left time: 68.2435s
	iters: 600, epoch: 2 | loss: 0.1135651
	speed: 0.0054s/iter; left time: 59.7041s
Epoch: 2 cost time: 3.756441831588745
Epoch: 2, Steps: 610 | Train Loss: 0.1248578 Vali Loss: 0.2344152 Test Loss: 0.1122515
Validation loss decreased (0.253171 --> 0.234415).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.0876895
	speed: 0.0096s/iter; left time: 104.8224s
	iters: 200, epoch: 3 | loss: 0.1540885
	speed: 0.0057s/iter; left time: 61.7752s
	iters: 300, epoch: 3 | loss: 0.2051893
	speed: 0.0059s/iter; left time: 62.9371s
	iters: 400, epoch: 3 | loss: 0.0900207
	speed: 0.0066s/iter; left time: 70.2924s
	iters: 500, epoch: 3 | loss: 0.0633057
	speed: 0.0063s/iter; left time: 66.2216s
	iters: 600, epoch: 3 | loss: 0.1089282
	speed: 0.0069s/iter; left time: 71.5435s
Epoch: 3 cost time: 3.8179519176483154
Epoch: 3, Steps: 610 | Train Loss: 0.1149583 Vali Loss: 0.2324741 Test Loss: 0.1073613
Validation loss decreased (0.234415 --> 0.232474).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.0692981
	speed: 0.0115s/iter; left time: 118.0478s
	iters: 200, epoch: 4 | loss: 0.0930276
	speed: 0.0059s/iter; left time: 59.6203s
	iters: 300, epoch: 4 | loss: 0.0626876
	speed: 0.0063s/iter; left time: 63.0255s
	iters: 400, epoch: 4 | loss: 0.0649902
	speed: 0.0060s/iter; left time: 59.4476s
	iters: 500, epoch: 4 | loss: 0.0611531
	speed: 0.0071s/iter; left time: 70.2908s
	iters: 600, epoch: 4 | loss: 0.1507088
	speed: 0.0069s/iter; left time: 67.7131s
Epoch: 4 cost time: 3.9705958366394043
Epoch: 4, Steps: 610 | Train Loss: 0.1114393 Vali Loss: 0.2051310 Test Loss: 0.0980462
Validation loss decreased (0.232474 --> 0.205131).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1348526
	speed: 0.0118s/iter; left time: 113.5301s
	iters: 200, epoch: 5 | loss: 0.0880333
	speed: 0.0067s/iter; left time: 63.8766s
	iters: 300, epoch: 5 | loss: 0.0652255
	speed: 0.0059s/iter; left time: 55.6468s
	iters: 400, epoch: 5 | loss: 0.1252814
	speed: 0.0065s/iter; left time: 61.2233s
	iters: 500, epoch: 5 | loss: 0.0688946
	speed: 0.0060s/iter; left time: 55.7730s
	iters: 600, epoch: 5 | loss: 0.1173540
	speed: 0.0067s/iter; left time: 61.4011s
Epoch: 5 cost time: 3.9568722248077393
Epoch: 5, Steps: 610 | Train Loss: 0.1099404 Vali Loss: 0.1956685 Test Loss: 0.0885261
Validation loss decreased (0.205131 --> 0.195669).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0509315
	speed: 0.0105s/iter; left time: 94.9672s
	iters: 200, epoch: 6 | loss: 0.3236897
	speed: 0.0068s/iter; left time: 61.1347s
	iters: 300, epoch: 6 | loss: 0.0446915
	speed: 0.0067s/iter; left time: 59.4044s
	iters: 400, epoch: 6 | loss: 0.0850810
	speed: 0.0064s/iter; left time: 55.7709s
	iters: 500, epoch: 6 | loss: 0.0684830
	speed: 0.0064s/iter; left time: 54.9339s
	iters: 600, epoch: 6 | loss: 0.1914999
	speed: 0.0063s/iter; left time: 53.6297s
Epoch: 6 cost time: 3.9538357257843018
Epoch: 6, Steps: 610 | Train Loss: 0.1086972 Vali Loss: 0.2123158 Test Loss: 0.0926496
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.0882461
	speed: 0.0117s/iter; left time: 98.4372s
	iters: 200, epoch: 7 | loss: 0.0987458
	speed: 0.0065s/iter; left time: 54.3217s
	iters: 300, epoch: 7 | loss: 0.1603383
	speed: 0.0061s/iter; left time: 50.0125s
	iters: 400, epoch: 7 | loss: 0.0683064
	speed: 0.0057s/iter; left time: 46.4243s
	iters: 500, epoch: 7 | loss: 0.0691744
	speed: 0.0059s/iter; left time: 47.2811s
	iters: 600, epoch: 7 | loss: 0.0634180
	speed: 0.0062s/iter; left time: 49.4977s
Epoch: 7 cost time: 3.804887294769287
Epoch: 7, Steps: 610 | Train Loss: 0.1083145 Vali Loss: 0.2098152 Test Loss: 0.0936974
EarlyStopping counter: 2 out of 5
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.0803019
	speed: 0.0105s/iter; left time: 82.0904s
	iters: 200, epoch: 8 | loss: 0.0875841
	speed: 0.0059s/iter; left time: 45.7095s
	iters: 300, epoch: 8 | loss: 0.1069011
	speed: 0.0054s/iter; left time: 41.2837s
	iters: 400, epoch: 8 | loss: 0.0922551
	speed: 0.0054s/iter; left time: 40.6957s
	iters: 500, epoch: 8 | loss: 0.0648591
	speed: 0.0054s/iter; left time: 40.1987s
	iters: 600, epoch: 8 | loss: 0.0593765
	speed: 0.0060s/iter; left time: 44.0736s
Epoch: 8 cost time: 3.4647793769836426
Epoch: 8, Steps: 610 | Train Loss: 0.1079949 Vali Loss: 0.1936513 Test Loss: 0.0884292
Validation loss decreased (0.195669 --> 0.193651).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.0978594
	speed: 0.0094s/iter; left time: 68.0372s
	iters: 200, epoch: 9 | loss: 0.1161255
	speed: 0.0062s/iter; left time: 44.3170s
	iters: 300, epoch: 9 | loss: 0.0708249
	speed: 0.0063s/iter; left time: 44.2323s
	iters: 400, epoch: 9 | loss: 0.0867373
	speed: 0.0063s/iter; left time: 43.8260s
	iters: 500, epoch: 9 | loss: 0.0614926
	speed: 0.0062s/iter; left time: 42.5630s
	iters: 600, epoch: 9 | loss: 0.2299735
	speed: 0.0063s/iter; left time: 42.0136s
Epoch: 9 cost time: 3.7598965167999268
Epoch: 9, Steps: 610 | Train Loss: 0.1078566 Vali Loss: 0.2060139 Test Loss: 0.0895007
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.0585925
	speed: 0.0103s/iter; left time: 67.9075s
	iters: 200, epoch: 10 | loss: 0.0766029
	speed: 0.0061s/iter; left time: 39.4726s
	iters: 300, epoch: 10 | loss: 0.1058433
	speed: 0.0061s/iter; left time: 39.1072s
	iters: 400, epoch: 10 | loss: 0.1041669
	speed: 0.0065s/iter; left time: 40.9737s
	iters: 500, epoch: 10 | loss: 0.2118604
	speed: 0.0069s/iter; left time: 42.5594s
	iters: 600, epoch: 10 | loss: 0.1190934
	speed: 0.0061s/iter; left time: 37.2804s
Epoch: 10 cost time: 3.857957363128662
Epoch: 10, Steps: 610 | Train Loss: 0.1078068 Vali Loss: 0.1993063 Test Loss: 0.0885403
EarlyStopping counter: 2 out of 5
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 11 | loss: 0.1369229
	speed: 0.0098s/iter; left time: 58.6398s
	iters: 200, epoch: 11 | loss: 0.2257556
	speed: 0.0060s/iter; left time: 35.6048s
	iters: 300, epoch: 11 | loss: 0.1110081
	speed: 0.0059s/iter; left time: 34.2839s
	iters: 400, epoch: 11 | loss: 0.1132002
	speed: 0.0059s/iter; left time: 33.8210s
	iters: 500, epoch: 11 | loss: 0.1049272
	speed: 0.0058s/iter; left time: 32.6167s
	iters: 600, epoch: 11 | loss: 0.0525235
	speed: 0.0058s/iter; left time: 32.0158s
Epoch: 11 cost time: 3.5769336223602295
Epoch: 11, Steps: 610 | Train Loss: 0.1077592 Vali Loss: 0.1986388 Test Loss: 0.0883764
EarlyStopping counter: 3 out of 5
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 12 | loss: 0.0784093
	speed: 0.0096s/iter; left time: 51.4962s
	iters: 200, epoch: 12 | loss: 0.1108499
	speed: 0.0055s/iter; left time: 28.8471s
	iters: 300, epoch: 12 | loss: 0.0914058
	speed: 0.0048s/iter; left time: 24.7014s
	iters: 400, epoch: 12 | loss: 0.0756189
	speed: 0.0046s/iter; left time: 23.3259s
	iters: 500, epoch: 12 | loss: 0.1578162
	speed: 0.0040s/iter; left time: 20.1666s
	iters: 600, epoch: 12 | loss: 0.0752233
	speed: 0.0040s/iter; left time: 19.6129s
Epoch: 12 cost time: 2.8992960453033447
Epoch: 12, Steps: 610 | Train Loss: 0.1077355 Vali Loss: 0.1989753 Test Loss: 0.0884516
EarlyStopping counter: 4 out of 5
Updating learning rate to 2.44140625e-07
	iters: 100, epoch: 13 | loss: 0.0500648
	speed: 0.0065s/iter; left time: 31.2789s
	iters: 200, epoch: 13 | loss: 0.1311548
	speed: 0.0037s/iter; left time: 17.2737s
	iters: 300, epoch: 13 | loss: 0.0724545
	speed: 0.0044s/iter; left time: 20.2580s
	iters: 400, epoch: 13 | loss: 0.0917372
	speed: 0.0041s/iter; left time: 18.2378s
	iters: 500, epoch: 13 | loss: 0.0909133
	speed: 0.0037s/iter; left time: 16.3946s
	iters: 600, epoch: 13 | loss: 0.1139483
	speed: 0.0037s/iter; left time: 15.9682s
Epoch: 13 cost time: 2.391451835632324
Epoch: 13, Steps: 610 | Train Loss: 0.1077238 Vali Loss: 0.1990436 Test Loss: 0.0885410
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : Exchange_336_96_DLinear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed12890<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 1422
mse:0.08829739689826965, mae:0.21730615198612213
