Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='NLinear', model_id='ETTm2_336_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=336, root_path='./dataset/', save_pred_values=False, seed=3293, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTm2_336_336_NLinear_ETTm2_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3293>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33889
val 11185
test 11185
	iters: 100, epoch: 1 | loss: 0.8704485
	speed: 0.0078s/iter; left time: 164.3322s
	iters: 200, epoch: 1 | loss: 0.6381428
	speed: 0.0090s/iter; left time: 189.2743s
	iters: 300, epoch: 1 | loss: 0.5323194
	speed: 0.0093s/iter; left time: 194.4821s
	iters: 400, epoch: 1 | loss: 0.4468048
	speed: 0.0085s/iter; left time: 176.2646s
	iters: 500, epoch: 1 | loss: 0.5930668
	speed: 0.0083s/iter; left time: 170.6688s
	iters: 600, epoch: 1 | loss: 0.5417099
	speed: 0.0083s/iter; left time: 170.8678s
	iters: 700, epoch: 1 | loss: 0.3944940
	speed: 0.0083s/iter; left time: 170.3563s
	iters: 800, epoch: 1 | loss: 1.1023645
	speed: 0.0086s/iter; left time: 176.0914s
	iters: 900, epoch: 1 | loss: 0.5127409
	speed: 0.0078s/iter; left time: 157.7436s
	iters: 1000, epoch: 1 | loss: 0.5950046
	speed: 0.0075s/iter; left time: 151.8066s
Epoch: 1 cost time: 8.745485782623291
Epoch: 1, Steps: 1059 | Train Loss: 0.7126386 Vali Loss: 0.2945380 Test Loss: 0.4227572
Validation loss decreased (inf --> 0.294538).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.6934035
	speed: 0.0319s/iter; left time: 638.4461s
	iters: 200, epoch: 2 | loss: 0.5700146
	speed: 0.0080s/iter; left time: 159.4089s
	iters: 300, epoch: 2 | loss: 0.3418323
	speed: 0.0070s/iter; left time: 138.4014s
	iters: 400, epoch: 2 | loss: 3.5014436
	speed: 0.0069s/iter; left time: 135.4826s
	iters: 500, epoch: 2 | loss: 0.6741361
	speed: 0.0079s/iter; left time: 154.2838s
	iters: 600, epoch: 2 | loss: 0.4275967
	speed: 0.0091s/iter; left time: 177.6338s
	iters: 700, epoch: 2 | loss: 0.7904084
	speed: 0.0087s/iter; left time: 168.1311s
	iters: 800, epoch: 2 | loss: 0.8128450
	speed: 0.0086s/iter; left time: 165.8221s
	iters: 900, epoch: 2 | loss: 0.5506758
	speed: 0.0088s/iter; left time: 169.3789s
	iters: 1000, epoch: 2 | loss: 1.3315636
	speed: 0.0070s/iter; left time: 133.2809s
Epoch: 2 cost time: 8.441243410110474
Epoch: 2, Steps: 1059 | Train Loss: 0.7664318 Vali Loss: 0.4333639 Test Loss: 0.6507534
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.4224761
	speed: 0.0314s/iter; left time: 596.2308s
	iters: 200, epoch: 3 | loss: 0.4875436
	speed: 0.0073s/iter; left time: 136.9124s
	iters: 300, epoch: 3 | loss: 0.5563359
	speed: 0.0075s/iter; left time: 140.0167s
	iters: 400, epoch: 3 | loss: 0.4399215
	speed: 0.0083s/iter; left time: 155.7051s
	iters: 500, epoch: 3 | loss: 0.2701516
	speed: 0.0095s/iter; left time: 176.7343s
	iters: 600, epoch: 3 | loss: 0.6727851
	speed: 0.0095s/iter; left time: 175.2926s
	iters: 700, epoch: 3 | loss: 0.2023391
	speed: 0.0085s/iter; left time: 155.9449s
	iters: 800, epoch: 3 | loss: 0.3668870
	speed: 0.0088s/iter; left time: 161.0674s
	iters: 900, epoch: 3 | loss: 0.4375806
	speed: 0.0084s/iter; left time: 152.6267s
	iters: 1000, epoch: 3 | loss: 0.5243620
	speed: 0.0078s/iter; left time: 140.5773s
Epoch: 3 cost time: 8.760051965713501
Epoch: 3, Steps: 1059 | Train Loss: 0.4842001 Vali Loss: 0.2222583 Test Loss: 0.3016199
Validation loss decreased (0.294538 --> 0.222258).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.2621468
	speed: 0.0375s/iter; left time: 670.6957s
	iters: 200, epoch: 4 | loss: 0.3984736
	speed: 0.0082s/iter; left time: 146.2414s
	iters: 300, epoch: 4 | loss: 0.2918590
	speed: 0.0073s/iter; left time: 128.8875s
	iters: 400, epoch: 4 | loss: 0.5377496
	speed: 0.0083s/iter; left time: 146.1512s
	iters: 500, epoch: 4 | loss: 0.4261850
	speed: 0.0091s/iter; left time: 159.1535s
	iters: 600, epoch: 4 | loss: 0.2804942
	speed: 0.0097s/iter; left time: 168.3334s
	iters: 700, epoch: 4 | loss: 0.5551277
	speed: 0.0091s/iter; left time: 158.1945s
	iters: 800, epoch: 4 | loss: 0.8135169
	speed: 0.0097s/iter; left time: 167.2608s
	iters: 900, epoch: 4 | loss: 0.3225591
	speed: 0.0093s/iter; left time: 158.4136s
	iters: 1000, epoch: 4 | loss: 0.2714249
	speed: 0.0093s/iter; left time: 158.4988s
Epoch: 4 cost time: 9.297893047332764
Epoch: 4, Steps: 1059 | Train Loss: 0.4254106 Vali Loss: 0.2225013 Test Loss: 0.3221483
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.4665305
	speed: 0.0318s/iter; left time: 535.5927s
	iters: 200, epoch: 5 | loss: 0.2958612
	speed: 0.0073s/iter; left time: 122.4477s
	iters: 300, epoch: 5 | loss: 0.2225389
	speed: 0.0076s/iter; left time: 126.1688s
	iters: 400, epoch: 5 | loss: 0.4462450
	speed: 0.0089s/iter; left time: 146.9705s
	iters: 500, epoch: 5 | loss: 0.2622602
	speed: 0.0091s/iter; left time: 150.0069s
	iters: 600, epoch: 5 | loss: 0.2933539
	speed: 0.0083s/iter; left time: 135.2051s
	iters: 700, epoch: 5 | loss: 0.4082442
	speed: 0.0093s/iter; left time: 150.6396s
	iters: 800, epoch: 5 | loss: 0.3172760
	speed: 0.0089s/iter; left time: 144.0660s
	iters: 900, epoch: 5 | loss: 0.3166102
	speed: 0.0084s/iter; left time: 134.5517s
	iters: 1000, epoch: 5 | loss: 0.2004896
	speed: 0.0089s/iter; left time: 141.7843s
Epoch: 5 cost time: 8.954413652420044
Epoch: 5, Steps: 1059 | Train Loss: 0.4011232 Vali Loss: 0.2044489 Test Loss: 0.2823496
Validation loss decreased (0.222258 --> 0.204449).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.3174223
	speed: 0.0368s/iter; left time: 580.4373s
	iters: 200, epoch: 6 | loss: 0.4971945
	speed: 0.0080s/iter; left time: 125.6801s
	iters: 300, epoch: 6 | loss: 0.2456306
	speed: 0.0084s/iter; left time: 130.4836s
	iters: 400, epoch: 6 | loss: 0.7167788
	speed: 0.0085s/iter; left time: 131.0512s
	iters: 500, epoch: 6 | loss: 0.4007062
	speed: 0.0091s/iter; left time: 140.7111s
	iters: 600, epoch: 6 | loss: 0.5257155
	speed: 0.0069s/iter; left time: 105.7791s
	iters: 700, epoch: 6 | loss: 0.2195089
	speed: 0.0087s/iter; left time: 132.5051s
	iters: 800, epoch: 6 | loss: 0.4209627
	speed: 0.0097s/iter; left time: 146.2099s
	iters: 900, epoch: 6 | loss: 0.5170306
	speed: 0.0094s/iter; left time: 140.1519s
	iters: 1000, epoch: 6 | loss: 0.5165210
	speed: 0.0076s/iter; left time: 112.4202s
Epoch: 6 cost time: 8.6966712474823
Epoch: 6, Steps: 1059 | Train Loss: 0.3896241 Vali Loss: 0.2034579 Test Loss: 0.2796823
Validation loss decreased (0.204449 --> 0.203458).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.2989208
	speed: 0.0368s/iter; left time: 541.2534s
	iters: 200, epoch: 7 | loss: 0.6163412
	speed: 0.0077s/iter; left time: 113.0670s
	iters: 300, epoch: 7 | loss: 0.2027626
	speed: 0.0080s/iter; left time: 115.8093s
	iters: 400, epoch: 7 | loss: 0.2689796
	speed: 0.0077s/iter; left time: 111.4065s
	iters: 500, epoch: 7 | loss: 0.6749521
	speed: 0.0096s/iter; left time: 136.8389s
	iters: 600, epoch: 7 | loss: 0.4052742
	speed: 0.0089s/iter; left time: 126.4036s
	iters: 700, epoch: 7 | loss: 0.2962376
	speed: 0.0080s/iter; left time: 113.0502s
	iters: 800, epoch: 7 | loss: 0.1934433
	speed: 0.0090s/iter; left time: 126.6535s
	iters: 900, epoch: 7 | loss: 0.2376221
	speed: 0.0096s/iter; left time: 133.0124s
	iters: 1000, epoch: 7 | loss: 0.2647958
	speed: 0.0088s/iter; left time: 121.9812s
Epoch: 7 cost time: 9.09162974357605
Epoch: 7, Steps: 1059 | Train Loss: 0.3842333 Vali Loss: 0.2009899 Test Loss: 0.2783866
Validation loss decreased (0.203458 --> 0.200990).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.8242381
	speed: 0.0355s/iter; left time: 485.3787s
	iters: 200, epoch: 8 | loss: 0.3194657
	speed: 0.0078s/iter; left time: 105.7342s
	iters: 300, epoch: 8 | loss: 0.2865222
	speed: 0.0082s/iter; left time: 110.9599s
	iters: 400, epoch: 8 | loss: 0.3394519
	speed: 0.0095s/iter; left time: 127.5636s
	iters: 500, epoch: 8 | loss: 0.4501553
	speed: 0.0087s/iter; left time: 115.5902s
	iters: 600, epoch: 8 | loss: 0.6248921
	speed: 0.0073s/iter; left time: 95.7749s
	iters: 700, epoch: 8 | loss: 0.2364309
	speed: 0.0081s/iter; left time: 105.7376s
	iters: 800, epoch: 8 | loss: 0.3613536
	speed: 0.0078s/iter; left time: 100.9282s
	iters: 900, epoch: 8 | loss: 0.4518484
	speed: 0.0069s/iter; left time: 88.7795s
	iters: 1000, epoch: 8 | loss: 0.8436132
	speed: 0.0084s/iter; left time: 107.2282s
Epoch: 8 cost time: 8.529324293136597
Epoch: 8, Steps: 1059 | Train Loss: 0.3805386 Vali Loss: 0.1983132 Test Loss: 0.2758282
Validation loss decreased (0.200990 --> 0.198313).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.5741030
	speed: 0.0333s/iter; left time: 419.5331s
	iters: 200, epoch: 9 | loss: 0.2276061
	speed: 0.0096s/iter; left time: 120.6155s
	iters: 300, epoch: 9 | loss: 0.3373691
	speed: 0.0086s/iter; left time: 106.2334s
	iters: 400, epoch: 9 | loss: 0.3174454
	speed: 0.0085s/iter; left time: 104.9815s
	iters: 500, epoch: 9 | loss: 0.4041972
	speed: 0.0087s/iter; left time: 105.8770s
	iters: 600, epoch: 9 | loss: 0.2170089
	speed: 0.0066s/iter; left time: 80.0632s
	iters: 700, epoch: 9 | loss: 0.3082609
	speed: 0.0064s/iter; left time: 76.9767s
	iters: 800, epoch: 9 | loss: 0.5207774
	speed: 0.0069s/iter; left time: 82.5461s
	iters: 900, epoch: 9 | loss: 0.3426529
	speed: 0.0079s/iter; left time: 93.0913s
	iters: 1000, epoch: 9 | loss: 0.2776696
	speed: 0.0083s/iter; left time: 97.4704s
Epoch: 9 cost time: 8.491359233856201
Epoch: 9, Steps: 1059 | Train Loss: 0.3786929 Vali Loss: 0.2000774 Test Loss: 0.2732424
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.7334583
	speed: 0.0386s/iter; left time: 446.3624s
	iters: 200, epoch: 10 | loss: 0.6438618
	speed: 0.0084s/iter; left time: 95.8651s
	iters: 300, epoch: 10 | loss: 0.2824349
	speed: 0.0079s/iter; left time: 89.4455s
	iters: 400, epoch: 10 | loss: 0.2165734
	speed: 0.0079s/iter; left time: 88.9975s
	iters: 500, epoch: 10 | loss: 0.4186583
	speed: 0.0079s/iter; left time: 88.5723s
	iters: 600, epoch: 10 | loss: 0.1792840
	speed: 0.0096s/iter; left time: 106.4317s
	iters: 700, epoch: 10 | loss: 0.3832083
	speed: 0.0092s/iter; left time: 101.1099s
	iters: 800, epoch: 10 | loss: 0.3406014
	speed: 0.0093s/iter; left time: 101.3611s
	iters: 900, epoch: 10 | loss: 0.3731343
	speed: 0.0084s/iter; left time: 90.0744s
	iters: 1000, epoch: 10 | loss: 0.2457366
	speed: 0.0084s/iter; left time: 89.8044s
Epoch: 10 cost time: 8.956862449645996
Epoch: 10, Steps: 1059 | Train Loss: 0.3779313 Vali Loss: 0.1989145 Test Loss: 0.2727439
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.3434072
	speed: 0.0370s/iter; left time: 388.4731s
	iters: 200, epoch: 11 | loss: 0.4082480
	speed: 0.0081s/iter; left time: 83.8588s
	iters: 300, epoch: 11 | loss: 0.4935177
	speed: 0.0082s/iter; left time: 84.6147s
	iters: 400, epoch: 11 | loss: 0.3263992
	speed: 0.0081s/iter; left time: 82.1308s
	iters: 500, epoch: 11 | loss: 0.3523830
	speed: 0.0081s/iter; left time: 81.3567s
	iters: 600, epoch: 11 | loss: 0.6404662
	speed: 0.0091s/iter; left time: 90.6414s
	iters: 700, epoch: 11 | loss: 0.1905184
	speed: 0.0091s/iter; left time: 89.8360s
	iters: 800, epoch: 11 | loss: 0.3499710
	speed: 0.0092s/iter; left time: 89.8066s
	iters: 900, epoch: 11 | loss: 0.6215464
	speed: 0.0096s/iter; left time: 92.7581s
	iters: 1000, epoch: 11 | loss: 0.3946786
	speed: 0.0090s/iter; left time: 86.7229s
Epoch: 11 cost time: 9.143741369247437
Epoch: 11, Steps: 1059 | Train Loss: 0.3772539 Vali Loss: 0.1988494 Test Loss: 0.2735571
EarlyStopping counter: 3 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.2336157
	speed: 0.0396s/iter; left time: 373.4180s
	iters: 200, epoch: 12 | loss: 0.5316413
	speed: 0.0073s/iter; left time: 68.4035s
	iters: 300, epoch: 12 | loss: 0.2849174
	speed: 0.0078s/iter; left time: 72.2982s
	iters: 400, epoch: 12 | loss: 0.2016000
	speed: 0.0082s/iter; left time: 74.7231s
	iters: 500, epoch: 12 | loss: 0.5322136
	speed: 0.0085s/iter; left time: 76.7437s
	iters: 600, epoch: 12 | loss: 0.3444483
	speed: 0.0073s/iter; left time: 65.1244s
	iters: 700, epoch: 12 | loss: 0.6539744
	speed: 0.0084s/iter; left time: 74.1004s
	iters: 800, epoch: 12 | loss: 0.3322705
	speed: 0.0085s/iter; left time: 73.8877s
	iters: 900, epoch: 12 | loss: 0.3312407
	speed: 0.0086s/iter; left time: 73.9958s
	iters: 1000, epoch: 12 | loss: 0.2802648
	speed: 0.0075s/iter; left time: 64.1817s
Epoch: 12 cost time: 8.432326078414917
Epoch: 12, Steps: 1059 | Train Loss: 0.3769541 Vali Loss: 0.1988949 Test Loss: 0.2730167
EarlyStopping counter: 4 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.4437281
	speed: 0.0376s/iter; left time: 314.4461s
	iters: 200, epoch: 13 | loss: 0.3199882
	speed: 0.0081s/iter; left time: 67.1766s
	iters: 300, epoch: 13 | loss: 0.1998557
	speed: 0.0088s/iter; left time: 72.2707s
	iters: 400, epoch: 13 | loss: 0.3444498
	speed: 0.0080s/iter; left time: 64.7540s
	iters: 500, epoch: 13 | loss: 0.2925133
	speed: 0.0085s/iter; left time: 68.1110s
	iters: 600, epoch: 13 | loss: 0.2124961
	speed: 0.0096s/iter; left time: 75.6728s
	iters: 700, epoch: 13 | loss: 0.4557260
	speed: 0.0093s/iter; left time: 72.1370s
	iters: 800, epoch: 13 | loss: 0.3401141
	speed: 0.0084s/iter; left time: 64.6996s
	iters: 900, epoch: 13 | loss: 0.2707826
	speed: 0.0074s/iter; left time: 55.6676s
	iters: 1000, epoch: 13 | loss: 0.2393920
	speed: 0.0083s/iter; left time: 61.8018s
Epoch: 13 cost time: 9.114482164382935
Epoch: 13, Steps: 1059 | Train Loss: 0.3768249 Vali Loss: 0.1986378 Test Loss: 0.2730169
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTm2_336_336_NLinear_ETTm2_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3293<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
mse:0.2760620415210724, mae:0.32768285274505615
