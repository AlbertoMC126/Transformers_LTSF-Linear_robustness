Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTh2', data_path='ETTh2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='NLinear', model_id='ETTh2_336_720', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=720, root_path='./dataset/', save_pred_values=False, seed=15349, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTh2_336_720_NLinear_ETTh2_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15349>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7585
val 2161
test 2161
Total number of trainable parameters: 1698480
Total number of parameters: 1698480
	iters: 100, epoch: 1 | loss: 0.7744659
	speed: 0.0412s/iter; left time: 191.2175s
	iters: 200, epoch: 1 | loss: 0.7295403
	speed: 0.0418s/iter; left time: 189.7558s
Epoch: 1 cost time: 9.6624276638031
Epoch: 1, Steps: 237 | Train Loss: 0.9269812 Vali Loss: 0.6904922 Test Loss: 0.4794699
Validation loss decreased (inf --> 0.690492).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.7551928
	speed: 0.0637s/iter; left time: 280.3707s
	iters: 200, epoch: 2 | loss: 1.0309439
	speed: 0.0407s/iter; left time: 175.0459s
Epoch: 2 cost time: 9.354169607162476
Epoch: 2, Steps: 237 | Train Loss: 0.8706547 Vali Loss: 0.7484043 Test Loss: 0.4709206
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.9458640
	speed: 0.0677s/iter; left time: 282.0371s
	iters: 200, epoch: 3 | loss: 1.1904535
	speed: 0.0407s/iter; left time: 165.6189s
Epoch: 3 cost time: 9.605870723724365
Epoch: 3, Steps: 237 | Train Loss: 0.7958384 Vali Loss: 0.6620706 Test Loss: 0.4378486
Validation loss decreased (0.690492 --> 0.662071).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.7702530
	speed: 0.0672s/iter; left time: 264.0922s
	iters: 200, epoch: 4 | loss: 0.7552437
	speed: 0.0401s/iter; left time: 153.6002s
Epoch: 4 cost time: 9.51147747039795
Epoch: 4, Steps: 237 | Train Loss: 0.7706341 Vali Loss: 0.6407227 Test Loss: 0.4295611
Validation loss decreased (0.662071 --> 0.640723).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.6599739
	speed: 0.0689s/iter; left time: 254.3801s
	iters: 200, epoch: 5 | loss: 0.8183002
	speed: 0.0391s/iter; left time: 140.4250s
Epoch: 5 cost time: 9.436463356018066
Epoch: 5, Steps: 237 | Train Loss: 0.7570119 Vali Loss: 0.6457726 Test Loss: 0.4242367
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.8341814
	speed: 0.0659s/iter; left time: 227.6316s
	iters: 200, epoch: 6 | loss: 0.6847851
	speed: 0.0403s/iter; left time: 135.2472s
Epoch: 6 cost time: 9.505523681640625
Epoch: 6, Steps: 237 | Train Loss: 0.7514090 Vali Loss: 0.6504498 Test Loss: 0.4281884
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.9317088
	speed: 0.0676s/iter; left time: 217.6109s
	iters: 200, epoch: 7 | loss: 0.6327413
	speed: 0.0394s/iter; left time: 122.7548s
Epoch: 7 cost time: 9.401352643966675
Epoch: 7, Steps: 237 | Train Loss: 0.7480280 Vali Loss: 0.6365910 Test Loss: 0.4180462
Validation loss decreased (0.640723 --> 0.636591).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.5649382
	speed: 0.0680s/iter; left time: 202.8705s
	iters: 200, epoch: 8 | loss: 0.9290178
	speed: 0.0398s/iter; left time: 114.6824s
Epoch: 8 cost time: 9.19422698020935
Epoch: 8, Steps: 237 | Train Loss: 0.7464402 Vali Loss: 0.6396589 Test Loss: 0.4202158
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.9253852
	speed: 0.0637s/iter; left time: 174.8730s
	iters: 200, epoch: 9 | loss: 1.0675898
	speed: 0.0407s/iter; left time: 107.5534s
Epoch: 9 cost time: 9.18790078163147
Epoch: 9, Steps: 237 | Train Loss: 0.7450927 Vali Loss: 0.6325940 Test Loss: 0.4182671
Validation loss decreased (0.636591 --> 0.632594).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.8252001
	speed: 0.0627s/iter; left time: 157.1313s
	iters: 200, epoch: 10 | loss: 0.5804507
	speed: 0.0321s/iter; left time: 77.1888s
Epoch: 10 cost time: 7.925696611404419
Epoch: 10, Steps: 237 | Train Loss: 0.7448291 Vali Loss: 0.6360362 Test Loss: 0.4185739
EarlyStopping counter: 1 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.4737413
	speed: 0.0484s/iter; left time: 109.9824s
	iters: 200, epoch: 11 | loss: 0.8248015
	speed: 0.0271s/iter; left time: 58.8850s
Epoch: 11 cost time: 6.427892208099365
Epoch: 11, Steps: 237 | Train Loss: 0.7444089 Vali Loss: 0.6368198 Test Loss: 0.4185703
EarlyStopping counter: 2 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.6805662
	speed: 0.0403s/iter; left time: 81.9067s
	iters: 200, epoch: 12 | loss: 0.8424407
	speed: 0.0200s/iter; left time: 38.5867s
Epoch: 12 cost time: 4.952718496322632
Epoch: 12, Steps: 237 | Train Loss: 0.7442558 Vali Loss: 0.6364183 Test Loss: 0.4187821
EarlyStopping counter: 3 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.8471898
	speed: 0.0291s/iter; left time: 52.2600s
	iters: 200, epoch: 13 | loss: 0.5902215
	speed: 0.0130s/iter; left time: 22.1400s
Epoch: 13 cost time: 3.245405673980713
Epoch: 13, Steps: 237 | Train Loss: 0.7441456 Vali Loss: 0.6360458 Test Loss: 0.4188447
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.3772647
	speed: 0.0182s/iter; left time: 28.4056s
	iters: 200, epoch: 14 | loss: 0.8283141
	speed: 0.0091s/iter; left time: 13.2619s
Epoch: 14 cost time: 2.2698476314544678
Epoch: 14, Steps: 237 | Train Loss: 0.7441034 Vali Loss: 0.6363951 Test Loss: 0.4188177
EarlyStopping counter: 5 out of 5
Early stopping
Total training time: 124.2445 seconds
>>>>>>>testing : ETTh2_336_720_NLinear_ETTh2_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15349<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
mse:0.41647806763648987, mae:0.44857102632522583
