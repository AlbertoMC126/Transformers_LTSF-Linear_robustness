Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='NLinear', model_id='Electricity_336_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=336, root_path='./dataset/', save_pred_values=False, seed=3293, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : Electricity_336_336_NLinear_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3293>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17741
val 2297
test 4925
	iters: 100, epoch: 1 | loss: 0.2695332
	speed: 0.0997s/iter; left time: 2200.0507s
	iters: 200, epoch: 1 | loss: 0.2192001
	speed: 0.0844s/iter; left time: 1853.3363s
	iters: 300, epoch: 1 | loss: 0.3295440
	speed: 0.0847s/iter; left time: 1851.7316s
	iters: 400, epoch: 1 | loss: 0.2741626
	speed: 0.0849s/iter; left time: 1847.5151s
	iters: 500, epoch: 1 | loss: 0.2596643
	speed: 0.0858s/iter; left time: 1857.7019s
	iters: 600, epoch: 1 | loss: 0.2346012
	speed: 0.0862s/iter; left time: 1859.4714s
	iters: 700, epoch: 1 | loss: 0.2573752
	speed: 0.0861s/iter; left time: 1848.4288s
	iters: 800, epoch: 1 | loss: 0.3042872
	speed: 0.0856s/iter; left time: 1827.8839s
	iters: 900, epoch: 1 | loss: 0.2244889
	speed: 0.0864s/iter; left time: 1837.1840s
	iters: 1000, epoch: 1 | loss: 0.2659407
	speed: 0.0861s/iter; left time: 1822.1096s
	iters: 1100, epoch: 1 | loss: 0.3024419
	speed: 0.0865s/iter; left time: 1821.2321s
Epoch: 1 cost time: 96.37752842903137
Epoch: 1, Steps: 1108 | Train Loss: 0.2791417 Vali Loss: 0.2574565 Test Loss: 0.2813710
Validation loss decreased (inf --> 0.257456).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.2486404
	speed: 0.2464s/iter; left time: 5162.3006s
	iters: 200, epoch: 2 | loss: 0.2503200
	speed: 0.0867s/iter; left time: 1808.7208s
	iters: 300, epoch: 2 | loss: 0.3018627
	speed: 0.0863s/iter; left time: 1791.9954s
	iters: 400, epoch: 2 | loss: 0.2495547
	speed: 0.0870s/iter; left time: 1797.2310s
	iters: 500, epoch: 2 | loss: 0.2479328
	speed: 0.0871s/iter; left time: 1789.7280s
	iters: 600, epoch: 2 | loss: 0.2584445
	speed: 0.0862s/iter; left time: 1762.3262s
	iters: 700, epoch: 2 | loss: 0.2367428
	speed: 0.0858s/iter; left time: 1746.8883s
	iters: 800, epoch: 2 | loss: 0.3175962
	speed: 0.0869s/iter; left time: 1760.7380s
	iters: 900, epoch: 2 | loss: 0.2143508
	speed: 0.0870s/iter; left time: 1753.1626s
	iters: 1000, epoch: 2 | loss: 0.2682352
	speed: 0.0881s/iter; left time: 1765.8297s
	iters: 1100, epoch: 2 | loss: 0.2887385
	speed: 0.0883s/iter; left time: 1762.6627s
Epoch: 2 cost time: 96.49375486373901
Epoch: 2, Steps: 1108 | Train Loss: 0.2657758 Vali Loss: 0.2798884 Test Loss: 0.2555129
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.1615463
	speed: 0.2334s/iter; left time: 4631.4097s
	iters: 200, epoch: 3 | loss: 0.2204563
	speed: 0.0848s/iter; left time: 1674.7504s
	iters: 300, epoch: 3 | loss: 0.1747278
	speed: 0.0858s/iter; left time: 1685.8753s
	iters: 400, epoch: 3 | loss: 0.2148265
	speed: 0.0850s/iter; left time: 1661.0819s
	iters: 500, epoch: 3 | loss: 0.2225510
	speed: 0.0855s/iter; left time: 1661.8449s
	iters: 600, epoch: 3 | loss: 0.1933106
	speed: 0.0852s/iter; left time: 1648.0693s
	iters: 700, epoch: 3 | loss: 0.2632080
	speed: 0.0854s/iter; left time: 1643.8989s
	iters: 800, epoch: 3 | loss: 0.2305178
	speed: 0.0846s/iter; left time: 1619.5685s
	iters: 900, epoch: 3 | loss: 0.2224315
	speed: 0.0849s/iter; left time: 1616.1216s
	iters: 1000, epoch: 3 | loss: 0.2658346
	speed: 0.0856s/iter; left time: 1621.9235s
	iters: 1100, epoch: 3 | loss: 0.2241458
	speed: 0.0854s/iter; left time: 1609.8273s
Epoch: 3 cost time: 94.74102067947388
Epoch: 3, Steps: 1108 | Train Loss: 0.2065836 Vali Loss: 0.1859588 Test Loss: 0.2127752
Validation loss decreased (0.257456 --> 0.185959).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.2052742
	speed: 0.2499s/iter; left time: 4682.6822s
	iters: 200, epoch: 4 | loss: 0.1930207
	speed: 0.0880s/iter; left time: 1640.4508s
	iters: 300, epoch: 4 | loss: 0.1922324
	speed: 0.0857s/iter; left time: 1587.7912s
	iters: 400, epoch: 4 | loss: 0.1858726
	speed: 0.0870s/iter; left time: 1603.3917s
	iters: 500, epoch: 4 | loss: 0.1764716
	speed: 0.0862s/iter; left time: 1580.5127s
	iters: 600, epoch: 4 | loss: 0.2921270
	speed: 0.0862s/iter; left time: 1571.4258s
	iters: 700, epoch: 4 | loss: 0.1840074
	speed: 0.0859s/iter; left time: 1558.0473s
	iters: 800, epoch: 4 | loss: 0.1770511
	speed: 0.0857s/iter; left time: 1545.1477s
	iters: 900, epoch: 4 | loss: 0.1968095
	speed: 0.0866s/iter; left time: 1553.0397s
	iters: 1000, epoch: 4 | loss: 0.1738522
	speed: 0.0873s/iter; left time: 1556.6366s
	iters: 1100, epoch: 4 | loss: 0.1802050
	speed: 0.0883s/iter; left time: 1566.9523s
Epoch: 4 cost time: 96.32274508476257
Epoch: 4, Steps: 1108 | Train Loss: 0.1872385 Vali Loss: 0.1626266 Test Loss: 0.1861482
Validation loss decreased (0.185959 --> 0.162627).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.1838312
	speed: 0.2448s/iter; left time: 4314.9912s
	iters: 200, epoch: 5 | loss: 0.1572525
	speed: 0.0903s/iter; left time: 1582.5268s
	iters: 300, epoch: 5 | loss: 0.1511665
	speed: 0.0891s/iter; left time: 1552.7595s
	iters: 400, epoch: 5 | loss: 0.1669249
	speed: 0.0855s/iter; left time: 1481.4999s
	iters: 500, epoch: 5 | loss: 0.1758783
	speed: 0.0854s/iter; left time: 1472.0270s
	iters: 600, epoch: 5 | loss: 0.1480212
	speed: 0.0852s/iter; left time: 1459.8265s
	iters: 700, epoch: 5 | loss: 0.2123328
	speed: 0.0862s/iter; left time: 1467.3893s
	iters: 800, epoch: 5 | loss: 0.1684695
	speed: 0.0859s/iter; left time: 1454.1707s
	iters: 900, epoch: 5 | loss: 0.1547138
	speed: 0.0857s/iter; left time: 1441.4102s
	iters: 1000, epoch: 5 | loss: 0.1964944
	speed: 0.0855s/iter; left time: 1430.6490s
	iters: 1100, epoch: 5 | loss: 0.1808951
	speed: 0.0860s/iter; left time: 1430.1804s
Epoch: 5 cost time: 95.86567449569702
Epoch: 5, Steps: 1108 | Train Loss: 0.1773613 Vali Loss: 0.1554442 Test Loss: 0.1789496
Validation loss decreased (0.162627 --> 0.155444).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.1711079
	speed: 0.2459s/iter; left time: 4061.7574s
	iters: 200, epoch: 6 | loss: 0.1575297
	speed: 0.0901s/iter; left time: 1479.0038s
	iters: 300, epoch: 6 | loss: 0.1620397
	speed: 0.0913s/iter; left time: 1489.7644s
	iters: 400, epoch: 6 | loss: 0.1936831
	speed: 0.0896s/iter; left time: 1453.6961s
	iters: 500, epoch: 6 | loss: 0.1663701
	speed: 0.0857s/iter; left time: 1381.0933s
	iters: 600, epoch: 6 | loss: 0.1345421
	speed: 0.0857s/iter; left time: 1372.2389s
	iters: 700, epoch: 6 | loss: 0.1725535
	speed: 0.0852s/iter; left time: 1356.3382s
	iters: 800, epoch: 6 | loss: 0.1585109
	speed: 0.0856s/iter; left time: 1353.9265s
	iters: 900, epoch: 6 | loss: 0.1526911
	speed: 0.0856s/iter; left time: 1345.1721s
	iters: 1000, epoch: 6 | loss: 0.1653728
	speed: 0.0861s/iter; left time: 1344.4929s
	iters: 1100, epoch: 6 | loss: 0.1994466
	speed: 0.0854s/iter; left time: 1325.8945s
Epoch: 6 cost time: 96.62657928466797
Epoch: 6, Steps: 1108 | Train Loss: 0.1720027 Vali Loss: 0.1506775 Test Loss: 0.1732966
Validation loss decreased (0.155444 --> 0.150678).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.1859481
	speed: 0.2425s/iter; left time: 3738.1988s
	iters: 200, epoch: 7 | loss: 0.1649149
	speed: 0.0856s/iter; left time: 1310.0852s
	iters: 300, epoch: 7 | loss: 0.1624364
	speed: 0.0869s/iter; left time: 1321.5361s
	iters: 400, epoch: 7 | loss: 0.1370593
	speed: 0.0866s/iter; left time: 1308.1643s
	iters: 500, epoch: 7 | loss: 0.1591994
	speed: 0.0865s/iter; left time: 1298.3978s
	iters: 600, epoch: 7 | loss: 0.1375639
	speed: 0.0858s/iter; left time: 1279.0598s
	iters: 700, epoch: 7 | loss: 0.1829549
	speed: 0.0856s/iter; left time: 1267.2816s
	iters: 800, epoch: 7 | loss: 0.1710602
	speed: 0.0866s/iter; left time: 1273.4994s
	iters: 900, epoch: 7 | loss: 0.1709143
	speed: 0.0867s/iter; left time: 1266.2479s
	iters: 1000, epoch: 7 | loss: 0.1780771
	speed: 0.0866s/iter; left time: 1256.8926s
	iters: 1100, epoch: 7 | loss: 0.1907913
	speed: 0.0859s/iter; left time: 1238.1254s
Epoch: 7 cost time: 95.68517804145813
Epoch: 7, Steps: 1108 | Train Loss: 0.1690699 Vali Loss: 0.1474900 Test Loss: 0.1711226
Validation loss decreased (0.150678 --> 0.147490).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.1535625
	speed: 0.2447s/iter; left time: 3500.9301s
	iters: 200, epoch: 8 | loss: 0.1641401
	speed: 0.0860s/iter; left time: 1221.3880s
	iters: 300, epoch: 8 | loss: 0.1532825
	speed: 0.0861s/iter; left time: 1214.9548s
	iters: 400, epoch: 8 | loss: 0.1684605
	speed: 0.0877s/iter; left time: 1227.7788s
	iters: 500, epoch: 8 | loss: 0.1399274
	speed: 0.0887s/iter; left time: 1233.8712s
	iters: 600, epoch: 8 | loss: 0.1523342
	speed: 0.0864s/iter; left time: 1192.1422s
	iters: 700, epoch: 8 | loss: 0.1678722
	speed: 0.0871s/iter; left time: 1193.4552s
	iters: 800, epoch: 8 | loss: 0.1971588
	speed: 0.0861s/iter; left time: 1171.8344s
	iters: 900, epoch: 8 | loss: 0.2025608
	speed: 0.0861s/iter; left time: 1163.2909s
	iters: 1000, epoch: 8 | loss: 0.1707005
	speed: 0.0864s/iter; left time: 1157.7214s
	iters: 1100, epoch: 8 | loss: 0.1817203
	speed: 0.0871s/iter; left time: 1159.4904s
Epoch: 8 cost time: 96.33123302459717
Epoch: 8, Steps: 1108 | Train Loss: 0.1674866 Vali Loss: 0.1462362 Test Loss: 0.1691362
Validation loss decreased (0.147490 --> 0.146236).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.2027467
	speed: 0.2440s/iter; left time: 3219.5485s
	iters: 200, epoch: 9 | loss: 0.1484668
	speed: 0.0856s/iter; left time: 1121.7554s
	iters: 300, epoch: 9 | loss: 0.1592236
	speed: 0.0853s/iter; left time: 1108.2516s
	iters: 400, epoch: 9 | loss: 0.1560650
	speed: 0.0856s/iter; left time: 1104.0987s
	iters: 500, epoch: 9 | loss: 0.1789812
	speed: 0.0853s/iter; left time: 1091.4178s
	iters: 600, epoch: 9 | loss: 0.1514729
	speed: 0.0852s/iter; left time: 1081.8219s
	iters: 700, epoch: 9 | loss: 0.1414694
	speed: 0.0898s/iter; left time: 1130.7162s
	iters: 800, epoch: 9 | loss: 0.2091081
	speed: 0.0857s/iter; left time: 1071.5010s
	iters: 900, epoch: 9 | loss: 0.2132622
	speed: 0.0850s/iter; left time: 1053.2194s
	iters: 1000, epoch: 9 | loss: 0.1666891
	speed: 0.0851s/iter; left time: 1046.3283s
	iters: 1100, epoch: 9 | loss: 0.1540789
	speed: 0.0849s/iter; left time: 1035.9342s
Epoch: 9 cost time: 95.24792051315308
Epoch: 9, Steps: 1108 | Train Loss: 0.1665434 Vali Loss: 0.1455288 Test Loss: 0.1684642
Validation loss decreased (0.146236 --> 0.145529).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.1509998
	speed: 0.2425s/iter; left time: 2931.6681s
	iters: 200, epoch: 10 | loss: 0.2089482
	speed: 0.0857s/iter; left time: 1027.5307s
	iters: 300, epoch: 10 | loss: 0.1572383
	speed: 0.0857s/iter; left time: 1018.9715s
	iters: 400, epoch: 10 | loss: 0.1453284
	speed: 0.0857s/iter; left time: 1010.1220s
	iters: 500, epoch: 10 | loss: 0.1445308
	speed: 0.0855s/iter; left time: 999.1684s
	iters: 600, epoch: 10 | loss: 0.1666453
	speed: 0.0889s/iter; left time: 1030.0164s
	iters: 700, epoch: 10 | loss: 0.1700765
	speed: 0.0868s/iter; left time: 997.0751s
	iters: 800, epoch: 10 | loss: 0.2257664
	speed: 0.0858s/iter; left time: 976.9824s
	iters: 900, epoch: 10 | loss: 0.1606478
	speed: 0.0852s/iter; left time: 961.9146s
	iters: 1000, epoch: 10 | loss: 0.1611663
	speed: 0.0846s/iter; left time: 946.5770s
	iters: 1100, epoch: 10 | loss: 0.1410817
	speed: 0.0858s/iter; left time: 951.0883s
Epoch: 10 cost time: 95.31789660453796
Epoch: 10, Steps: 1108 | Train Loss: 0.1660970 Vali Loss: 0.1451968 Test Loss: 0.1682315
Validation loss decreased (0.145529 --> 0.145197).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.1459922
	speed: 0.2430s/iter; left time: 2667.8860s
	iters: 200, epoch: 11 | loss: 0.1574359
	speed: 0.0862s/iter; left time: 937.4826s
	iters: 300, epoch: 11 | loss: 0.1541620
	speed: 0.0868s/iter; left time: 935.3826s
	iters: 400, epoch: 11 | loss: 0.1843407
	speed: 0.0871s/iter; left time: 930.1368s
	iters: 500, epoch: 11 | loss: 0.1659868
	speed: 0.0873s/iter; left time: 924.1718s
	iters: 600, epoch: 11 | loss: 0.1550385
	speed: 0.0871s/iter; left time: 912.9221s
	iters: 700, epoch: 11 | loss: 0.1484871
	speed: 0.0855s/iter; left time: 887.0630s
	iters: 800, epoch: 11 | loss: 0.1903265
	speed: 0.0853s/iter; left time: 877.1318s
	iters: 900, epoch: 11 | loss: 0.1329478
	speed: 0.0865s/iter; left time: 880.8792s
	iters: 1000, epoch: 11 | loss: 0.1513180
	speed: 0.0873s/iter; left time: 880.1991s
	iters: 1100, epoch: 11 | loss: 0.1818575
	speed: 0.0862s/iter; left time: 860.4343s
Epoch: 11 cost time: 95.97110342979431
Epoch: 11, Steps: 1108 | Train Loss: 0.1658258 Vali Loss: 0.1450182 Test Loss: 0.1680083
Validation loss decreased (0.145197 --> 0.145018).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.1410315
	speed: 0.2431s/iter; left time: 2399.7921s
	iters: 200, epoch: 12 | loss: 0.1313471
	speed: 0.0871s/iter; left time: 851.5936s
	iters: 300, epoch: 12 | loss: 0.1389503
	speed: 0.0861s/iter; left time: 832.6401s
	iters: 400, epoch: 12 | loss: 0.1754535
	speed: 0.0875s/iter; left time: 838.1110s
	iters: 500, epoch: 12 | loss: 0.1342303
	speed: 0.0857s/iter; left time: 812.1245s
	iters: 600, epoch: 12 | loss: 0.1674322
	speed: 0.0862s/iter; left time: 808.1639s
	iters: 700, epoch: 12 | loss: 0.1564068
	speed: 0.0871s/iter; left time: 807.9882s
	iters: 800, epoch: 12 | loss: 0.1941961
	speed: 0.0882s/iter; left time: 808.9325s
	iters: 900, epoch: 12 | loss: 0.2019240
	speed: 0.0864s/iter; left time: 784.1963s
	iters: 1000, epoch: 12 | loss: 0.1498459
	speed: 0.0871s/iter; left time: 781.7300s
	iters: 1100, epoch: 12 | loss: 0.1804357
	speed: 0.0850s/iter; left time: 753.7929s
Epoch: 12 cost time: 96.02100419998169
Epoch: 12, Steps: 1108 | Train Loss: 0.1657360 Vali Loss: 0.1448824 Test Loss: 0.1678968
Validation loss decreased (0.145018 --> 0.144882).  Saving model ...
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.1546074
	speed: 0.2416s/iter; left time: 2117.5237s
	iters: 200, epoch: 13 | loss: 0.1633929
	speed: 0.0875s/iter; left time: 758.4682s
	iters: 300, epoch: 13 | loss: 0.1871013
	speed: 0.0859s/iter; left time: 735.9275s
	iters: 400, epoch: 13 | loss: 0.1824061
	speed: 0.0857s/iter; left time: 725.1014s
	iters: 500, epoch: 13 | loss: 0.1550818
	speed: 0.0863s/iter; left time: 721.6908s
	iters: 600, epoch: 13 | loss: 0.1552840
	speed: 0.0856s/iter; left time: 707.5963s
	iters: 700, epoch: 13 | loss: 0.1586273
	speed: 0.0854s/iter; left time: 696.9036s
	iters: 800, epoch: 13 | loss: 0.1573431
	speed: 0.0853s/iter; left time: 688.2596s
	iters: 900, epoch: 13 | loss: 0.1638644
	speed: 0.0856s/iter; left time: 682.0079s
	iters: 1000, epoch: 13 | loss: 0.1468851
	speed: 0.0876s/iter; left time: 689.2575s
	iters: 1100, epoch: 13 | loss: 0.1626497
	speed: 0.0855s/iter; left time: 663.8460s
Epoch: 13 cost time: 95.3597629070282
Epoch: 13, Steps: 1108 | Train Loss: 0.1656590 Vali Loss: 0.1448636 Test Loss: 0.1678586
Validation loss decreased (0.144882 --> 0.144864).  Saving model ...
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.1707503
	speed: 0.2413s/iter; left time: 1847.4886s
	iters: 200, epoch: 14 | loss: 0.1957438
	speed: 0.0860s/iter; left time: 649.7306s
	iters: 300, epoch: 14 | loss: 0.1619177
	speed: 0.0870s/iter; left time: 648.9394s
	iters: 400, epoch: 14 | loss: 0.1466880
	speed: 0.0876s/iter; left time: 644.2595s
	iters: 500, epoch: 14 | loss: 0.1562227
	speed: 0.0859s/iter; left time: 623.5668s
	iters: 600, epoch: 14 | loss: 0.1905186
	speed: 0.0865s/iter; left time: 619.2843s
	iters: 700, epoch: 14 | loss: 0.1326676
	speed: 0.0865s/iter; left time: 610.7315s
	iters: 800, epoch: 14 | loss: 0.1926315
	speed: 0.0870s/iter; left time: 604.9763s
	iters: 900, epoch: 14 | loss: 0.1942104
	speed: 0.0876s/iter; left time: 600.8963s
	iters: 1000, epoch: 14 | loss: 0.1443972
	speed: 0.0866s/iter; left time: 584.8933s
	iters: 1100, epoch: 14 | loss: 0.1792578
	speed: 0.0859s/iter; left time: 571.8478s
Epoch: 14 cost time: 96.04251217842102
Epoch: 14, Steps: 1108 | Train Loss: 0.1655774 Vali Loss: 0.1448901 Test Loss: 0.1678497
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.1540410
	speed: 0.2273s/iter; left time: 1488.5263s
	iters: 200, epoch: 15 | loss: 0.1594966
	speed: 0.0862s/iter; left time: 556.1367s
	iters: 300, epoch: 15 | loss: 0.2073277
	speed: 0.0857s/iter; left time: 543.9066s
	iters: 400, epoch: 15 | loss: 0.1418518
	speed: 0.0854s/iter; left time: 533.4906s
	iters: 500, epoch: 15 | loss: 0.1511491
	speed: 0.0856s/iter; left time: 526.0506s
	iters: 600, epoch: 15 | loss: 0.1581805
	speed: 0.0857s/iter; left time: 518.3387s
	iters: 700, epoch: 15 | loss: 0.1565642
	speed: 0.0861s/iter; left time: 512.4624s
	iters: 800, epoch: 15 | loss: 0.1483010
	speed: 0.0861s/iter; left time: 503.3584s
	iters: 900, epoch: 15 | loss: 0.1790072
	speed: 0.0850s/iter; left time: 488.4646s
	iters: 1000, epoch: 15 | loss: 0.1622142
	speed: 0.0857s/iter; left time: 484.1725s
	iters: 1100, epoch: 15 | loss: 0.1494560
	speed: 0.0868s/iter; left time: 481.6357s
Epoch: 15 cost time: 95.12023282051086
Epoch: 15, Steps: 1108 | Train Loss: 0.1655903 Vali Loss: 0.1448939 Test Loss: 0.1678418
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.1728927
	speed: 0.2319s/iter; left time: 1261.5801s
	iters: 200, epoch: 16 | loss: 0.1586653
	speed: 0.0848s/iter; left time: 452.7949s
	iters: 300, epoch: 16 | loss: 0.1972852
	speed: 0.0851s/iter; left time: 445.8293s
	iters: 400, epoch: 16 | loss: 0.1613149
	speed: 0.0857s/iter; left time: 440.6051s
	iters: 500, epoch: 16 | loss: 0.1532307
	speed: 0.0855s/iter; left time: 430.9746s
	iters: 600, epoch: 16 | loss: 0.1793410
	speed: 0.0854s/iter; left time: 421.7401s
	iters: 700, epoch: 16 | loss: 0.1468745
	speed: 0.0848s/iter; left time: 410.7260s
	iters: 800, epoch: 16 | loss: 0.1489739
	speed: 0.0852s/iter; left time: 404.0628s
	iters: 900, epoch: 16 | loss: 0.1597164
	speed: 0.0853s/iter; left time: 396.0046s
	iters: 1000, epoch: 16 | loss: 0.1492759
	speed: 0.0856s/iter; left time: 388.9360s
	iters: 1100, epoch: 16 | loss: 0.1750336
	speed: 0.0850s/iter; left time: 377.4732s
Epoch: 16 cost time: 94.72539758682251
Epoch: 16, Steps: 1108 | Train Loss: 0.1655837 Vali Loss: 0.1448163 Test Loss: 0.1678445
Validation loss decreased (0.144864 --> 0.144816).  Saving model ...
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 17 | loss: 0.1665189
	speed: 0.2469s/iter; left time: 1069.6132s
	iters: 200, epoch: 17 | loss: 0.1697099
	speed: 0.0882s/iter; left time: 373.4902s
	iters: 300, epoch: 17 | loss: 0.1770128
	speed: 0.0871s/iter; left time: 359.8003s
	iters: 400, epoch: 17 | loss: 0.1733485
	speed: 0.0861s/iter; left time: 347.2587s
	iters: 500, epoch: 17 | loss: 0.1516047
	speed: 0.0864s/iter; left time: 339.9305s
	iters: 600, epoch: 17 | loss: 0.1453547
	speed: 0.0864s/iter; left time: 331.2046s
	iters: 700, epoch: 17 | loss: 0.1588268
	speed: 0.0881s/iter; left time: 328.9221s
	iters: 800, epoch: 17 | loss: 0.1519599
	speed: 0.0844s/iter; left time: 306.6760s
	iters: 900, epoch: 17 | loss: 0.1594053
	speed: 0.0842s/iter; left time: 297.4571s
	iters: 1000, epoch: 17 | loss: 0.1927393
	speed: 0.0842s/iter; left time: 289.1189s
	iters: 1100, epoch: 17 | loss: 0.1810709
	speed: 0.0861s/iter; left time: 286.9788s
Epoch: 17 cost time: 95.665762424469
Epoch: 17, Steps: 1108 | Train Loss: 0.1655321 Vali Loss: 0.1448469 Test Loss: 0.1678448
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 18 | loss: 0.2239624
	speed: 0.2279s/iter; left time: 735.1069s
	iters: 200, epoch: 18 | loss: 0.1989643
	speed: 0.0879s/iter; left time: 274.6262s
	iters: 300, epoch: 18 | loss: 0.1694019
	speed: 0.0888s/iter; left time: 268.6557s
	iters: 400, epoch: 18 | loss: 0.1670688
	speed: 0.0873s/iter; left time: 255.3354s
	iters: 500, epoch: 18 | loss: 0.1816018
	speed: 0.0867s/iter; left time: 244.7944s
	iters: 600, epoch: 18 | loss: 0.1560634
	speed: 0.0864s/iter; left time: 235.3302s
	iters: 700, epoch: 18 | loss: 0.1767389
	speed: 0.0853s/iter; left time: 223.8692s
	iters: 800, epoch: 18 | loss: 0.1455817
	speed: 0.0864s/iter; left time: 218.1910s
	iters: 900, epoch: 18 | loss: 0.1566025
	speed: 0.0866s/iter; left time: 210.0169s
	iters: 1000, epoch: 18 | loss: 0.1867519
	speed: 0.0870s/iter; left time: 202.3587s
	iters: 1100, epoch: 18 | loss: 0.1459876
	speed: 0.0850s/iter; left time: 189.1865s
Epoch: 18 cost time: 96.10112524032593
Epoch: 18, Steps: 1108 | Train Loss: 0.1655735 Vali Loss: 0.1448238 Test Loss: 0.1678447
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 19 | loss: 0.1539270
	speed: 0.2302s/iter; left time: 487.3000s
	iters: 200, epoch: 19 | loss: 0.1354008
	speed: 0.0913s/iter; left time: 184.0749s
	iters: 300, epoch: 19 | loss: 0.1555382
	speed: 0.0891s/iter; left time: 170.8223s
	iters: 400, epoch: 19 | loss: 0.1473984
	speed: 0.0863s/iter; left time: 156.8762s
	iters: 500, epoch: 19 | loss: 0.1596339
	speed: 0.0853s/iter; left time: 146.5305s
	iters: 600, epoch: 19 | loss: 0.1853206
	speed: 0.0843s/iter; left time: 136.3430s
	iters: 700, epoch: 19 | loss: 0.1990595
	speed: 0.0859s/iter; left time: 130.2632s
	iters: 800, epoch: 19 | loss: 0.1718914
	speed: 0.0855s/iter; left time: 121.0852s
	iters: 900, epoch: 19 | loss: 0.1410685
	speed: 0.0854s/iter; left time: 112.4311s
	iters: 1000, epoch: 19 | loss: 0.1739209
	speed: 0.0845s/iter; left time: 102.8399s
	iters: 1100, epoch: 19 | loss: 0.1676646
	speed: 0.0854s/iter; left time: 95.4190s
Epoch: 19 cost time: 95.71093249320984
Epoch: 19, Steps: 1108 | Train Loss: 0.1655499 Vali Loss: 0.1448386 Test Loss: 0.1678447
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.9073486328125e-08
	iters: 100, epoch: 20 | loss: 0.1856891
	speed: 0.2253s/iter; left time: 227.3635s
	iters: 200, epoch: 20 | loss: 0.2024360
	speed: 0.0856s/iter; left time: 77.7808s
	iters: 300, epoch: 20 | loss: 0.1626492
	speed: 0.0855s/iter; left time: 69.1869s
	iters: 400, epoch: 20 | loss: 0.2022939
	speed: 0.0850s/iter; left time: 60.2982s
	iters: 500, epoch: 20 | loss: 0.1809004
	speed: 0.0874s/iter; left time: 53.2239s
	iters: 600, epoch: 20 | loss: 0.1877999
	speed: 0.0876s/iter; left time: 44.5983s
	iters: 700, epoch: 20 | loss: 0.1522401
	speed: 0.0852s/iter; left time: 34.8396s
	iters: 800, epoch: 20 | loss: 0.1557056
	speed: 0.0849s/iter; left time: 26.2326s
	iters: 900, epoch: 20 | loss: 0.1369699
	speed: 0.0846s/iter; left time: 17.6873s
	iters: 1000, epoch: 20 | loss: 0.1387934
	speed: 0.0862s/iter; left time: 9.3950s
	iters: 1100, epoch: 20 | loss: 0.1715908
	speed: 0.0864s/iter; left time: 0.7776s
Epoch: 20 cost time: 95.16613674163818
Epoch: 20, Steps: 1108 | Train Loss: 0.1655845 Vali Loss: 0.1448811 Test Loss: 0.1678447
EarlyStopping counter: 4 out of 5
Updating learning rate to 9.5367431640625e-09
>>>>>>>testing : Electricity_336_336_NLinear_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3293<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4925
mse:0.16773223876953125, mae:0.2601892650127411
