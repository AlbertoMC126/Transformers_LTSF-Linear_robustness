Args in experiment:
Namespace(activation='gelu', batch_size=8, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='exchange_rate.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=8, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='mse', lradj='type1', model='DLinear', model_id='Exchange_336_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=3144, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : Exchange_336_96_DLinear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3144>>>>>>>>>>>>>>>>>>>>>>>>>>
train 4880
val 665
test 1422
	iters: 100, epoch: 1 | loss: 0.1702638
	speed: 0.0067s/iter; left time: 81.2365s
	iters: 200, epoch: 1 | loss: 0.0898387
	speed: 0.0066s/iter; left time: 79.6868s
	iters: 300, epoch: 1 | loss: 0.0931937
	speed: 0.0062s/iter; left time: 74.0605s
	iters: 400, epoch: 1 | loss: 0.2360925
	speed: 0.0061s/iter; left time: 72.0211s
	iters: 500, epoch: 1 | loss: 0.0632823
	speed: 0.0065s/iter; left time: 75.5940s
	iters: 600, epoch: 1 | loss: 0.1004562
	speed: 0.0059s/iter; left time: 68.5842s
Epoch: 1 cost time: 3.8711633682250977
Epoch: 1, Steps: 610 | Train Loss: 0.1656092 Vali Loss: 0.1932255 Test Loss: 0.1252609
Validation loss decreased (inf --> 0.193225).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1114649
	speed: 0.0091s/iter; left time: 104.6073s
	iters: 200, epoch: 2 | loss: 0.0753903
	speed: 0.0062s/iter; left time: 70.6244s
	iters: 300, epoch: 2 | loss: 0.1334468
	speed: 0.0073s/iter; left time: 82.4687s
	iters: 400, epoch: 2 | loss: 0.2621086
	speed: 0.0061s/iter; left time: 67.7268s
	iters: 500, epoch: 2 | loss: 0.1265432
	speed: 0.0056s/iter; left time: 61.9218s
	iters: 600, epoch: 2 | loss: 0.0987200
	speed: 0.0058s/iter; left time: 64.1006s
Epoch: 2 cost time: 3.7158987522125244
Epoch: 2, Steps: 610 | Train Loss: 0.1244747 Vali Loss: 0.3289487 Test Loss: 0.1643111
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.0880282
	speed: 0.0097s/iter; left time: 105.0397s
	iters: 200, epoch: 3 | loss: 0.1217813
	speed: 0.0066s/iter; left time: 70.8517s
	iters: 300, epoch: 3 | loss: 0.1746506
	speed: 0.0061s/iter; left time: 65.0531s
	iters: 400, epoch: 3 | loss: 0.0792877
	speed: 0.0069s/iter; left time: 73.2552s
	iters: 500, epoch: 3 | loss: 0.1627346
	speed: 0.0061s/iter; left time: 64.4400s
	iters: 600, epoch: 3 | loss: 0.1068053
	speed: 0.0062s/iter; left time: 63.8642s
Epoch: 3 cost time: 3.828948974609375
Epoch: 3, Steps: 610 | Train Loss: 0.1153121 Vali Loss: 0.1676353 Test Loss: 0.1027067
Validation loss decreased (0.193225 --> 0.167635).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.0963927
	speed: 0.0102s/iter; left time: 104.4875s
	iters: 200, epoch: 4 | loss: 0.1184811
	speed: 0.0061s/iter; left time: 61.9596s
	iters: 300, epoch: 4 | loss: 0.1092326
	speed: 0.0066s/iter; left time: 66.4494s
	iters: 400, epoch: 4 | loss: 0.1148313
	speed: 0.0063s/iter; left time: 63.0374s
	iters: 500, epoch: 4 | loss: 0.1354434
	speed: 0.0063s/iter; left time: 61.7028s
	iters: 600, epoch: 4 | loss: 0.0891222
	speed: 0.0069s/iter; left time: 67.0292s
Epoch: 4 cost time: 3.8905529975891113
Epoch: 4, Steps: 610 | Train Loss: 0.1114448 Vali Loss: 0.2367135 Test Loss: 0.0858163
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1645399
	speed: 0.0108s/iter; left time: 104.2556s
	iters: 200, epoch: 5 | loss: 0.1122079
	speed: 0.0067s/iter; left time: 64.0677s
	iters: 300, epoch: 5 | loss: 0.0599362
	speed: 0.0067s/iter; left time: 63.7831s
	iters: 400, epoch: 5 | loss: 0.0903398
	speed: 0.0052s/iter; left time: 48.2093s
	iters: 500, epoch: 5 | loss: 0.0710690
	speed: 0.0064s/iter; left time: 59.2946s
	iters: 600, epoch: 5 | loss: 0.1197206
	speed: 0.0057s/iter; left time: 51.9428s
Epoch: 5 cost time: 3.7988274097442627
Epoch: 5, Steps: 610 | Train Loss: 0.1095707 Vali Loss: 0.2265591 Test Loss: 0.0923109
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0973688
	speed: 0.0104s/iter; left time: 94.5188s
	iters: 200, epoch: 6 | loss: 0.0989711
	speed: 0.0063s/iter; left time: 56.4981s
	iters: 300, epoch: 6 | loss: 0.0986179
	speed: 0.0059s/iter; left time: 52.2351s
	iters: 400, epoch: 6 | loss: 0.1093489
	speed: 0.0056s/iter; left time: 48.7432s
	iters: 500, epoch: 6 | loss: 0.0721341
	speed: 0.0057s/iter; left time: 49.5102s
	iters: 600, epoch: 6 | loss: 0.0799285
	speed: 0.0063s/iter; left time: 53.7857s
Epoch: 6 cost time: 3.666806697845459
Epoch: 6, Steps: 610 | Train Loss: 0.1085293 Vali Loss: 0.2098806 Test Loss: 0.0933792
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1117394
	speed: 0.0093s/iter; left time: 78.6006s
	iters: 200, epoch: 7 | loss: 0.0564070
	speed: 0.0053s/iter; left time: 44.5560s
	iters: 300, epoch: 7 | loss: 0.1104855
	speed: 0.0062s/iter; left time: 51.1982s
	iters: 400, epoch: 7 | loss: 0.0743057
	speed: 0.0059s/iter; left time: 47.8588s
	iters: 500, epoch: 7 | loss: 0.0947743
	speed: 0.0060s/iter; left time: 48.1055s
	iters: 600, epoch: 7 | loss: 0.0708024
	speed: 0.0064s/iter; left time: 50.4254s
Epoch: 7 cost time: 3.5695691108703613
Epoch: 7, Steps: 610 | Train Loss: 0.1081930 Vali Loss: 0.1843987 Test Loss: 0.0889023
EarlyStopping counter: 4 out of 5
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.1700112
	speed: 0.0106s/iter; left time: 82.8769s
	iters: 200, epoch: 8 | loss: 0.1020984
	speed: 0.0063s/iter; left time: 48.9584s
	iters: 300, epoch: 8 | loss: 0.0651365
	speed: 0.0059s/iter; left time: 44.8893s
	iters: 400, epoch: 8 | loss: 0.1143795
	speed: 0.0059s/iter; left time: 44.2822s
	iters: 500, epoch: 8 | loss: 0.2138219
	speed: 0.0063s/iter; left time: 47.1405s
	iters: 600, epoch: 8 | loss: 0.0548441
	speed: 0.0059s/iter; left time: 42.9568s
Epoch: 8 cost time: 3.7081336975097656
Epoch: 8, Steps: 610 | Train Loss: 0.1079958 Vali Loss: 0.1977234 Test Loss: 0.0885832
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : Exchange_336_96_DLinear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3144<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 1422
mse:0.10257842391729355, mae:0.23287446796894073
