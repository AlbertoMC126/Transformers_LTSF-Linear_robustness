Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTh2', data_path='ETTh2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='DLinear', model_id='ETTh2_336_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=336, root_path='./dataset/', save_pred_values=False, seed=15227, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTh2_336_336_DLinear_ETTh2_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15227>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7969
val 2545
test 2545
Total number of trainable parameters: 1585248
Total number of parameters: 1585248
	iters: 100, epoch: 1 | loss: 0.6189332
	speed: 0.0281s/iter; left time: 137.3631s
	iters: 200, epoch: 1 | loss: 0.5217878
	speed: 0.0276s/iter; left time: 132.1105s
Epoch: 1 cost time: 7.01598334312439
Epoch: 1, Steps: 249 | Train Loss: 0.6902154 Vali Loss: 0.5758719 Test Loss: 1.0184458
Validation loss decreased (inf --> 0.575872).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.6245573
	speed: 0.0546s/iter; left time: 252.9399s
	iters: 200, epoch: 2 | loss: 0.7292942
	speed: 0.0307s/iter; left time: 139.3073s
Epoch: 2 cost time: 7.432884931564331
Epoch: 2, Steps: 249 | Train Loss: 0.6648174 Vali Loss: 0.6120185 Test Loss: 1.2000940
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.3717428
	speed: 0.0525s/iter; left time: 230.1680s
	iters: 200, epoch: 3 | loss: 0.3834507
	speed: 0.0317s/iter; left time: 135.8243s
Epoch: 3 cost time: 7.413356304168701
Epoch: 3, Steps: 249 | Train Loss: 0.5853120 Vali Loss: 0.5572286 Test Loss: 0.8604938
Validation loss decreased (0.575872 --> 0.557229).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.4776716
	speed: 0.0554s/iter; left time: 229.1870s
	iters: 200, epoch: 4 | loss: 0.5287166
	speed: 0.0293s/iter; left time: 118.3875s
Epoch: 4 cost time: 7.188916206359863
Epoch: 4, Steps: 249 | Train Loss: 0.5474820 Vali Loss: 0.5316941 Test Loss: 0.7705992
Validation loss decreased (0.557229 --> 0.531694).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.5165917
	speed: 0.0561s/iter; left time: 218.0096s
	iters: 200, epoch: 5 | loss: 0.8444214
	speed: 0.0298s/iter; left time: 112.6520s
Epoch: 5 cost time: 7.379952669143677
Epoch: 5, Steps: 249 | Train Loss: 0.5306420 Vali Loss: 0.5003540 Test Loss: 0.6399887
Validation loss decreased (0.531694 --> 0.500354).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.3429081
	speed: 0.0555s/iter; left time: 201.9318s
	iters: 200, epoch: 6 | loss: 0.4944942
	speed: 0.0296s/iter; left time: 104.7743s
Epoch: 6 cost time: 7.297808647155762
Epoch: 6, Steps: 249 | Train Loss: 0.5214855 Vali Loss: 0.4884861 Test Loss: 0.6604597
Validation loss decreased (0.500354 --> 0.488486).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.4574664
	speed: 0.0564s/iter; left time: 191.1935s
	iters: 200, epoch: 7 | loss: 0.3042986
	speed: 0.0302s/iter; left time: 99.3236s
Epoch: 7 cost time: 7.316124677658081
Epoch: 7, Steps: 249 | Train Loss: 0.5167265 Vali Loss: 0.4811250 Test Loss: 0.6918528
Validation loss decreased (0.488486 --> 0.481125).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.5681296
	speed: 0.0539s/iter; left time: 169.1075s
	iters: 200, epoch: 8 | loss: 0.4839403
	speed: 0.0265s/iter; left time: 80.5520s
Epoch: 8 cost time: 6.541067123413086
Epoch: 8, Steps: 249 | Train Loss: 0.5138823 Vali Loss: 0.4935101 Test Loss: 0.7640067
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.3352711
	speed: 0.0486s/iter; left time: 140.4222s
	iters: 200, epoch: 9 | loss: 0.6865566
	speed: 0.0268s/iter; left time: 74.7982s
Epoch: 9 cost time: 6.561228275299072
Epoch: 9, Steps: 249 | Train Loss: 0.5127946 Vali Loss: 0.4848373 Test Loss: 0.7139126
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.4357510
	speed: 0.0478s/iter; left time: 126.1154s
	iters: 200, epoch: 10 | loss: 0.5964097
	speed: 0.0265s/iter; left time: 67.4107s
Epoch: 10 cost time: 6.4744017124176025
Epoch: 10, Steps: 249 | Train Loss: 0.5119316 Vali Loss: 0.4817517 Test Loss: 0.7140550
EarlyStopping counter: 3 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.5030568
	speed: 0.0423s/iter; left time: 101.1875s
	iters: 200, epoch: 11 | loss: 0.4139266
	speed: 0.0161s/iter; left time: 36.8042s
Epoch: 11 cost time: 4.488473653793335
Epoch: 11, Steps: 249 | Train Loss: 0.5116088 Vali Loss: 0.4811080 Test Loss: 0.6983730
Validation loss decreased (0.481125 --> 0.481108).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.4068728
	speed: 0.0289s/iter; left time: 61.8350s
	iters: 200, epoch: 12 | loss: 0.3777544
	speed: 0.0112s/iter; left time: 22.8375s
Epoch: 12 cost time: 3.0371508598327637
Epoch: 12, Steps: 249 | Train Loss: 0.5113309 Vali Loss: 0.4822435 Test Loss: 0.7052743
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.4567195
	speed: 0.0211s/iter; left time: 39.9191s
	iters: 200, epoch: 13 | loss: 0.5410571
	speed: 0.0097s/iter; left time: 17.4556s
Epoch: 13 cost time: 2.714937686920166
Epoch: 13, Steps: 249 | Train Loss: 0.5112577 Vali Loss: 0.4811901 Test Loss: 0.7065806
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.4792373
	speed: 0.0192s/iter; left time: 31.5673s
	iters: 200, epoch: 14 | loss: 0.4533389
	speed: 0.0086s/iter; left time: 13.3409s
Epoch: 14 cost time: 2.2495932579040527
Epoch: 14, Steps: 249 | Train Loss: 0.5111448 Vali Loss: 0.4808896 Test Loss: 0.7069252
Validation loss decreased (0.481108 --> 0.480890).  Saving model ...
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.6602876
	speed: 0.0166s/iter; left time: 23.1709s
	iters: 200, epoch: 15 | loss: 0.7523186
	speed: 0.0086s/iter; left time: 11.0873s
Epoch: 15 cost time: 2.134568214416504
Epoch: 15, Steps: 249 | Train Loss: 0.5111418 Vali Loss: 0.4816419 Test Loss: 0.7067220
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.5465603
	speed: 0.0157s/iter; left time: 17.9921s
	iters: 200, epoch: 16 | loss: 0.3855060
	speed: 0.0084s/iter; left time: 8.7481s
Epoch: 16 cost time: 2.0697457790374756
Epoch: 16, Steps: 249 | Train Loss: 0.5105359 Vali Loss: 0.4816933 Test Loss: 0.7067263
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 17 | loss: 0.2968980
	speed: 0.0154s/iter; left time: 13.7728s
	iters: 200, epoch: 17 | loss: 0.5290931
	speed: 0.0086s/iter; left time: 6.8615s
Epoch: 17 cost time: 2.108428478240967
Epoch: 17, Steps: 249 | Train Loss: 0.5111237 Vali Loss: 0.4809710 Test Loss: 0.7066787
EarlyStopping counter: 3 out of 5
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 18 | loss: 0.3482807
	speed: 0.0160s/iter; left time: 10.3958s
	iters: 200, epoch: 18 | loss: 0.4865971
	speed: 0.0081s/iter; left time: 4.4272s
Epoch: 18 cost time: 2.0440785884857178
Epoch: 18, Steps: 249 | Train Loss: 0.5111259 Vali Loss: 0.4829945 Test Loss: 0.7067209
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 19 | loss: 0.4818152
	speed: 0.0150s/iter; left time: 5.9992s
	iters: 200, epoch: 19 | loss: 0.5478395
	speed: 0.0085s/iter; left time: 2.5268s
Epoch: 19 cost time: 2.0330164432525635
Epoch: 19, Steps: 249 | Train Loss: 0.5110456 Vali Loss: 0.4811892 Test Loss: 0.7067012
EarlyStopping counter: 5 out of 5
Early stopping
Total training time: 108.2929 seconds
>>>>>>>testing : ETTh2_336_336_DLinear_ETTh2_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15227<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2545
mse:0.7049246430397034, mae:0.5627215504646301
