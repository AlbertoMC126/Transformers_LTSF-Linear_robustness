Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='DLinear', model_id='ETTm2_336_192', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=192, root_path='./dataset/', save_pred_values=False, seed=15349, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTm2_336_192_DLinear_ETTm2_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15349>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34033
val 11329
test 11329
	iters: 100, epoch: 1 | loss: 0.6449720
	speed: 0.0109s/iter; left time: 231.4773s
	iters: 200, epoch: 1 | loss: 0.4960454
	speed: 0.0112s/iter; left time: 236.5813s
	iters: 300, epoch: 1 | loss: 0.2108355
	speed: 0.0112s/iter; left time: 235.2537s
	iters: 400, epoch: 1 | loss: 0.5090411
	speed: 0.0101s/iter; left time: 209.6664s
	iters: 500, epoch: 1 | loss: 0.3391153
	speed: 0.0111s/iter; left time: 231.2913s
	iters: 600, epoch: 1 | loss: 0.9845683
	speed: 0.0108s/iter; left time: 223.6343s
	iters: 700, epoch: 1 | loss: 0.4939442
	speed: 0.0106s/iter; left time: 218.1750s
	iters: 800, epoch: 1 | loss: 0.2277401
	speed: 0.0106s/iter; left time: 217.5736s
	iters: 900, epoch: 1 | loss: 0.7728648
	speed: 0.0104s/iter; left time: 211.0123s
	iters: 1000, epoch: 1 | loss: 0.4449843
	speed: 0.0096s/iter; left time: 193.5225s
Epoch: 1 cost time: 11.361097574234009
Epoch: 1, Steps: 1063 | Train Loss: 0.5537030 Vali Loss: 0.4666622 Test Loss: 0.7026371
Validation loss decreased (inf --> 0.466662).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.7514943
	speed: 0.0495s/iter; left time: 994.2266s
	iters: 200, epoch: 2 | loss: 0.4131374
	speed: 0.0097s/iter; left time: 194.2598s
	iters: 300, epoch: 2 | loss: 0.6224735
	speed: 0.0108s/iter; left time: 215.5506s
	iters: 400, epoch: 2 | loss: 0.3909280
	speed: 0.0101s/iter; left time: 200.1866s
	iters: 500, epoch: 2 | loss: 0.5140836
	speed: 0.0102s/iter; left time: 201.7382s
	iters: 600, epoch: 2 | loss: 0.5438949
	speed: 0.0101s/iter; left time: 197.5761s
	iters: 700, epoch: 2 | loss: 0.5688097
	speed: 0.0112s/iter; left time: 218.8129s
	iters: 800, epoch: 2 | loss: 0.4112498
	speed: 0.0106s/iter; left time: 205.2472s
	iters: 900, epoch: 2 | loss: 0.5186468
	speed: 0.0102s/iter; left time: 197.0642s
	iters: 1000, epoch: 2 | loss: 0.7234244
	speed: 0.0105s/iter; left time: 200.8438s
Epoch: 2 cost time: 11.020049095153809
Epoch: 2, Steps: 1063 | Train Loss: 0.5541964 Vali Loss: 0.3918809 Test Loss: 0.6831162
Validation loss decreased (0.466662 --> 0.391881).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.5011071
	speed: 0.0450s/iter; left time: 856.2785s
	iters: 200, epoch: 3 | loss: 0.6109496
	speed: 0.0123s/iter; left time: 233.4986s
	iters: 300, epoch: 3 | loss: 0.3483239
	speed: 0.0125s/iter; left time: 234.5240s
	iters: 400, epoch: 3 | loss: 0.5391933
	speed: 0.0118s/iter; left time: 220.3355s
	iters: 500, epoch: 3 | loss: 0.2991224
	speed: 0.0118s/iter; left time: 219.7620s
	iters: 600, epoch: 3 | loss: 0.4106015
	speed: 0.0113s/iter; left time: 208.9268s
	iters: 700, epoch: 3 | loss: 0.4031389
	speed: 0.0116s/iter; left time: 212.9297s
	iters: 800, epoch: 3 | loss: 0.3442489
	speed: 0.0105s/iter; left time: 193.2639s
	iters: 900, epoch: 3 | loss: 0.6504702
	speed: 0.0107s/iter; left time: 194.5930s
	iters: 1000, epoch: 3 | loss: 0.4083915
	speed: 0.0105s/iter; left time: 189.5151s
Epoch: 3 cost time: 12.13668155670166
Epoch: 3, Steps: 1063 | Train Loss: 0.3731781 Vali Loss: 0.3001687 Test Loss: 0.5796809
Validation loss decreased (0.391881 --> 0.300169).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.5120296
	speed: 0.0461s/iter; left time: 828.1748s
	iters: 200, epoch: 4 | loss: 0.2430590
	speed: 0.0111s/iter; left time: 198.7856s
	iters: 300, epoch: 4 | loss: 0.4600146
	speed: 0.0122s/iter; left time: 216.9381s
	iters: 400, epoch: 4 | loss: 0.2021025
	speed: 0.0117s/iter; left time: 207.1533s
	iters: 500, epoch: 4 | loss: 0.3931977
	speed: 0.0105s/iter; left time: 185.0632s
	iters: 600, epoch: 4 | loss: 0.2946482
	speed: 0.0100s/iter; left time: 175.3943s
	iters: 700, epoch: 4 | loss: 0.3584307
	speed: 0.0106s/iter; left time: 184.6856s
	iters: 800, epoch: 4 | loss: 0.1230817
	speed: 0.0106s/iter; left time: 182.7502s
	iters: 900, epoch: 4 | loss: 0.3072526
	speed: 0.0105s/iter; left time: 179.6569s
	iters: 1000, epoch: 4 | loss: 0.3307732
	speed: 0.0103s/iter; left time: 175.5445s
Epoch: 4 cost time: 11.521197080612183
Epoch: 4, Steps: 1063 | Train Loss: 0.3201070 Vali Loss: 0.2225598 Test Loss: 0.3779278
Validation loss decreased (0.300169 --> 0.222560).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.2228453
	speed: 0.0468s/iter; left time: 791.5566s
	iters: 200, epoch: 5 | loss: 0.4025686
	speed: 0.0109s/iter; left time: 182.7968s
	iters: 300, epoch: 5 | loss: 0.1596816
	speed: 0.0109s/iter; left time: 181.6628s
	iters: 400, epoch: 5 | loss: 0.2105199
	speed: 0.0113s/iter; left time: 187.3183s
	iters: 500, epoch: 5 | loss: 0.2260046
	speed: 0.0105s/iter; left time: 172.6190s
	iters: 600, epoch: 5 | loss: 0.3255110
	speed: 0.0100s/iter; left time: 163.3267s
	iters: 700, epoch: 5 | loss: 0.2755162
	speed: 0.0102s/iter; left time: 165.7442s
	iters: 800, epoch: 5 | loss: 0.2900136
	speed: 0.0115s/iter; left time: 186.0978s
	iters: 900, epoch: 5 | loss: 0.1167499
	speed: 0.0114s/iter; left time: 183.6519s
	iters: 1000, epoch: 5 | loss: 0.3015053
	speed: 0.0113s/iter; left time: 180.1567s
Epoch: 5 cost time: 11.535813331604004
Epoch: 5, Steps: 1063 | Train Loss: 0.3017085 Vali Loss: 0.2053158 Test Loss: 0.3540022
Validation loss decreased (0.222560 --> 0.205316).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.1949111
	speed: 0.0473s/iter; left time: 749.2172s
	iters: 200, epoch: 6 | loss: 0.1478107
	speed: 0.0119s/iter; left time: 186.7543s
	iters: 300, epoch: 6 | loss: 0.2031039
	speed: 0.0114s/iter; left time: 179.0365s
	iters: 400, epoch: 6 | loss: 0.2477157
	speed: 0.0107s/iter; left time: 166.7022s
	iters: 500, epoch: 6 | loss: 0.3092139
	speed: 0.0095s/iter; left time: 146.7715s
	iters: 600, epoch: 6 | loss: 0.3357297
	speed: 0.0115s/iter; left time: 177.1084s
	iters: 700, epoch: 6 | loss: 0.2084036
	speed: 0.0109s/iter; left time: 166.8072s
	iters: 800, epoch: 6 | loss: 0.3539330
	speed: 0.0108s/iter; left time: 163.9174s
	iters: 900, epoch: 6 | loss: 0.4393079
	speed: 0.0107s/iter; left time: 161.4485s
	iters: 1000, epoch: 6 | loss: 0.1893620
	speed: 0.0113s/iter; left time: 168.8085s
Epoch: 6 cost time: 11.640914678573608
Epoch: 6, Steps: 1063 | Train Loss: 0.2879205 Vali Loss: 0.1725843 Test Loss: 0.2639973
Validation loss decreased (0.205316 --> 0.172584).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.2853172
	speed: 0.0470s/iter; left time: 695.1043s
	iters: 200, epoch: 7 | loss: 0.1839672
	speed: 0.0120s/iter; left time: 176.0610s
	iters: 300, epoch: 7 | loss: 0.4351389
	speed: 0.0119s/iter; left time: 173.6054s
	iters: 400, epoch: 7 | loss: 0.1663515
	speed: 0.0125s/iter; left time: 181.0756s
	iters: 500, epoch: 7 | loss: 0.3435779
	speed: 0.0121s/iter; left time: 173.3264s
	iters: 600, epoch: 7 | loss: 0.2019646
	speed: 0.0114s/iter; left time: 163.2727s
	iters: 700, epoch: 7 | loss: 0.1809499
	speed: 0.0115s/iter; left time: 162.8581s
	iters: 800, epoch: 7 | loss: 0.4263220
	speed: 0.0104s/iter; left time: 146.6485s
	iters: 900, epoch: 7 | loss: 0.2083495
	speed: 0.0116s/iter; left time: 162.0111s
	iters: 1000, epoch: 7 | loss: 0.3198357
	speed: 0.0117s/iter; left time: 162.0497s
Epoch: 7 cost time: 12.337609052658081
Epoch: 7, Steps: 1063 | Train Loss: 0.2820565 Vali Loss: 0.1912794 Test Loss: 0.3216007
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.2354322
	speed: 0.0471s/iter; left time: 646.6399s
	iters: 200, epoch: 8 | loss: 0.2047279
	speed: 0.0093s/iter; left time: 127.1211s
	iters: 300, epoch: 8 | loss: 0.6187128
	speed: 0.0113s/iter; left time: 153.2358s
	iters: 400, epoch: 8 | loss: 0.1897383
	speed: 0.0115s/iter; left time: 154.2327s
	iters: 500, epoch: 8 | loss: 0.8376442
	speed: 0.0101s/iter; left time: 134.6723s
	iters: 600, epoch: 8 | loss: 0.2242066
	speed: 0.0112s/iter; left time: 148.3326s
	iters: 700, epoch: 8 | loss: 0.2041042
	speed: 0.0100s/iter; left time: 131.3515s
	iters: 800, epoch: 8 | loss: 0.1834224
	speed: 0.0100s/iter; left time: 130.2261s
	iters: 900, epoch: 8 | loss: 0.2214904
	speed: 0.0102s/iter; left time: 131.3180s
	iters: 1000, epoch: 8 | loss: 0.3313189
	speed: 0.0106s/iter; left time: 136.4109s
Epoch: 8 cost time: 11.06927752494812
Epoch: 8, Steps: 1063 | Train Loss: 0.2779481 Vali Loss: 0.2067416 Test Loss: 0.3748849
EarlyStopping counter: 2 out of 5
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.4534326
	speed: 0.0462s/iter; left time: 584.6478s
	iters: 200, epoch: 9 | loss: 0.3857268
	speed: 0.0090s/iter; left time: 113.5007s
	iters: 300, epoch: 9 | loss: 0.4392765
	speed: 0.0099s/iter; left time: 123.3267s
	iters: 400, epoch: 9 | loss: 0.1795764
	speed: 0.0108s/iter; left time: 133.4773s
	iters: 500, epoch: 9 | loss: 0.2655509
	speed: 0.0118s/iter; left time: 144.5892s
	iters: 600, epoch: 9 | loss: 0.1719918
	speed: 0.0111s/iter; left time: 135.3161s
	iters: 700, epoch: 9 | loss: 0.2037717
	speed: 0.0109s/iter; left time: 131.7869s
	iters: 800, epoch: 9 | loss: 0.6540183
	speed: 0.0115s/iter; left time: 137.7572s
	iters: 900, epoch: 9 | loss: 0.2168831
	speed: 0.0110s/iter; left time: 130.1108s
	iters: 1000, epoch: 9 | loss: 0.3473789
	speed: 0.0106s/iter; left time: 125.0248s
Epoch: 9 cost time: 11.518219947814941
Epoch: 9, Steps: 1063 | Train Loss: 0.2758828 Vali Loss: 0.1947680 Test Loss: 0.3372721
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.1309915
	speed: 0.0473s/iter; left time: 548.1445s
	iters: 200, epoch: 10 | loss: 0.2451178
	speed: 0.0111s/iter; left time: 127.3872s
	iters: 300, epoch: 10 | loss: 0.3879121
	speed: 0.0100s/iter; left time: 113.7411s
	iters: 400, epoch: 10 | loss: 0.1567921
	speed: 0.0101s/iter; left time: 114.1842s
	iters: 500, epoch: 10 | loss: 0.2329350
	speed: 0.0106s/iter; left time: 118.2392s
	iters: 600, epoch: 10 | loss: 0.4583549
	speed: 0.0099s/iter; left time: 110.0728s
	iters: 700, epoch: 10 | loss: 0.2323565
	speed: 0.0112s/iter; left time: 122.8319s
	iters: 800, epoch: 10 | loss: 0.3789220
	speed: 0.0112s/iter; left time: 121.8079s
	iters: 900, epoch: 10 | loss: 0.2801326
	speed: 0.0108s/iter; left time: 116.5010s
	iters: 1000, epoch: 10 | loss: 0.2444190
	speed: 0.0107s/iter; left time: 114.2307s
Epoch: 10 cost time: 11.270220756530762
Epoch: 10, Steps: 1063 | Train Loss: 0.2748514 Vali Loss: 0.1895974 Test Loss: 0.3196490
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.2871575
	speed: 0.0473s/iter; left time: 498.1233s
	iters: 200, epoch: 11 | loss: 0.3617446
	speed: 0.0106s/iter; left time: 110.9126s
	iters: 300, epoch: 11 | loss: 0.4064577
	speed: 0.0114s/iter; left time: 117.6775s
	iters: 400, epoch: 11 | loss: 0.1899673
	speed: 0.0107s/iter; left time: 109.5811s
	iters: 500, epoch: 11 | loss: 0.2217921
	speed: 0.0107s/iter; left time: 108.2434s
	iters: 600, epoch: 11 | loss: 0.1862118
	speed: 0.0108s/iter; left time: 107.8569s
	iters: 700, epoch: 11 | loss: 0.4187540
	speed: 0.0105s/iter; left time: 104.6774s
	iters: 800, epoch: 11 | loss: 0.3185561
	speed: 0.0118s/iter; left time: 115.5187s
	iters: 900, epoch: 11 | loss: 0.3664884
	speed: 0.0116s/iter; left time: 113.2954s
	iters: 1000, epoch: 11 | loss: 0.1814484
	speed: 0.0110s/iter; left time: 106.3367s
Epoch: 11 cost time: 11.683073282241821
Epoch: 11, Steps: 1063 | Train Loss: 0.2742612 Vali Loss: 0.2015676 Test Loss: 0.3575210
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTm2_336_192_DLinear_ETTm2_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15349<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
mse:0.26449260115623474, mae:0.33165639638900757
