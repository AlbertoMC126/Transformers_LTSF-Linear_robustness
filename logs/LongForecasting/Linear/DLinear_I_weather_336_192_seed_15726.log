Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='DLinear', model_id='weather_336_192', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=192, root_path='./dataset/', save_pred_values=False, seed=15726, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : weather_336_192_DLinear_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15726>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36360
val 5079
test 10348
	iters: 100, epoch: 1 | loss: 1.0834486
	speed: 0.0285s/iter; left time: 1292.9569s
	iters: 200, epoch: 1 | loss: 0.3713986
	speed: 0.0268s/iter; left time: 1211.0612s
	iters: 300, epoch: 1 | loss: 0.8241324
	speed: 0.0204s/iter; left time: 919.8240s
	iters: 400, epoch: 1 | loss: 0.4666675
	speed: 0.0262s/iter; left time: 1179.1225s
	iters: 500, epoch: 1 | loss: 0.4979548
	speed: 0.0288s/iter; left time: 1295.7104s
	iters: 600, epoch: 1 | loss: 0.5098807
	speed: 0.0310s/iter; left time: 1391.2306s
	iters: 700, epoch: 1 | loss: 1.3737191
	speed: 0.0278s/iter; left time: 1243.9292s
	iters: 800, epoch: 1 | loss: 0.3967473
	speed: 0.0268s/iter; left time: 1197.6176s
	iters: 900, epoch: 1 | loss: 0.5899864
	speed: 0.0293s/iter; left time: 1304.6840s
	iters: 1000, epoch: 1 | loss: 0.3670674
	speed: 0.0269s/iter; left time: 1193.5011s
	iters: 1100, epoch: 1 | loss: 0.4534147
	speed: 0.0262s/iter; left time: 1160.1080s
	iters: 1200, epoch: 1 | loss: 0.5611560
	speed: 0.0280s/iter; left time: 1240.7794s
	iters: 1300, epoch: 1 | loss: 0.6317541
	speed: 0.0278s/iter; left time: 1227.1868s
	iters: 1400, epoch: 1 | loss: 0.5922795
	speed: 0.0290s/iter; left time: 1276.6756s
	iters: 1500, epoch: 1 | loss: 0.6125429
	speed: 0.0280s/iter; left time: 1231.4113s
	iters: 1600, epoch: 1 | loss: 0.4034328
	speed: 0.0251s/iter; left time: 1098.2939s
	iters: 1700, epoch: 1 | loss: 4.0737381
	speed: 0.0286s/iter; left time: 1252.3361s
	iters: 1800, epoch: 1 | loss: 3.4056084
	speed: 0.0297s/iter; left time: 1296.4221s
	iters: 1900, epoch: 1 | loss: 2.5467236
	speed: 0.0306s/iter; left time: 1330.4873s
	iters: 2000, epoch: 1 | loss: 0.4436693
	speed: 0.0290s/iter; left time: 1258.3761s
	iters: 2100, epoch: 1 | loss: 0.3683913
	speed: 0.0265s/iter; left time: 1149.6184s
	iters: 2200, epoch: 1 | loss: 3.8429124
	speed: 0.0260s/iter; left time: 1125.9632s
Epoch: 1 cost time: 62.76040506362915
Epoch: 1, Steps: 2272 | Train Loss: 1.0393411 Vali Loss: 0.7041978 Test Loss: 0.2683491
Validation loss decreased (inf --> 0.704198).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 1.0809134
	speed: 0.0982s/iter; left time: 4227.2473s
	iters: 200, epoch: 2 | loss: 0.3963724
	speed: 0.0272s/iter; left time: 1170.2472s
	iters: 300, epoch: 2 | loss: 0.4341196
	speed: 0.0271s/iter; left time: 1163.6261s
	iters: 400, epoch: 2 | loss: 0.5823837
	speed: 0.0258s/iter; left time: 1102.5110s
	iters: 500, epoch: 2 | loss: 0.6332118
	speed: 0.0257s/iter; left time: 1094.7981s
	iters: 600, epoch: 2 | loss: 0.6801515
	speed: 0.0274s/iter; left time: 1165.3754s
	iters: 700, epoch: 2 | loss: 0.5699809
	speed: 0.0272s/iter; left time: 1154.3063s
	iters: 800, epoch: 2 | loss: 0.4857956
	speed: 0.0283s/iter; left time: 1199.4401s
	iters: 900, epoch: 2 | loss: 0.5312631
	speed: 0.0281s/iter; left time: 1186.7106s
	iters: 1000, epoch: 2 | loss: 0.7572773
	speed: 0.0279s/iter; left time: 1178.2404s
	iters: 1100, epoch: 2 | loss: 1.1435819
	speed: 0.0283s/iter; left time: 1191.9265s
	iters: 1200, epoch: 2 | loss: 1.5063844
	speed: 0.0281s/iter; left time: 1180.6068s
	iters: 1300, epoch: 2 | loss: 0.4894838
	speed: 0.0272s/iter; left time: 1140.1358s
	iters: 1400, epoch: 2 | loss: 0.5430534
	speed: 0.0279s/iter; left time: 1164.6107s
	iters: 1500, epoch: 2 | loss: 0.4514381
	speed: 0.0279s/iter; left time: 1161.3937s
	iters: 1600, epoch: 2 | loss: 0.6468471
	speed: 0.0288s/iter; left time: 1198.7367s
	iters: 1700, epoch: 2 | loss: 0.5402488
	speed: 0.0267s/iter; left time: 1105.8142s
	iters: 1800, epoch: 2 | loss: 0.7856736
	speed: 0.0279s/iter; left time: 1152.8769s
	iters: 1900, epoch: 2 | loss: 0.5832202
	speed: 0.0295s/iter; left time: 1215.5578s
	iters: 2000, epoch: 2 | loss: 3.3064384
	speed: 0.0288s/iter; left time: 1186.1104s
	iters: 2100, epoch: 2 | loss: 0.5377926
	speed: 0.0277s/iter; left time: 1139.5012s
	iters: 2200, epoch: 2 | loss: 7.1934814
	speed: 0.0284s/iter; left time: 1164.7050s
Epoch: 2 cost time: 62.7276725769043
Epoch: 2, Steps: 2272 | Train Loss: 1.0886480 Vali Loss: 0.6691272 Test Loss: 0.2667905
Validation loss decreased (0.704198 --> 0.669127).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 1.4331986
	speed: 0.1059s/iter; left time: 4321.2868s
	iters: 200, epoch: 3 | loss: 0.3910270
	speed: 0.0250s/iter; left time: 1017.2160s
	iters: 300, epoch: 3 | loss: 0.3721751
	speed: 0.0269s/iter; left time: 1090.1591s
	iters: 400, epoch: 3 | loss: 0.5619023
	speed: 0.0277s/iter; left time: 1122.8535s
	iters: 500, epoch: 3 | loss: 0.4479637
	speed: 0.0274s/iter; left time: 1107.8898s
	iters: 600, epoch: 3 | loss: 4.0052724
	speed: 0.0290s/iter; left time: 1169.7524s
	iters: 700, epoch: 3 | loss: 0.4113357
	speed: 0.0283s/iter; left time: 1137.7676s
	iters: 800, epoch: 3 | loss: 0.3951523
	speed: 0.0275s/iter; left time: 1102.0376s
	iters: 900, epoch: 3 | loss: 1.4585670
	speed: 0.0274s/iter; left time: 1095.1950s
	iters: 1000, epoch: 3 | loss: 0.3310174
	speed: 0.0302s/iter; left time: 1206.4623s
	iters: 1100, epoch: 3 | loss: 1.1404650
	speed: 0.0300s/iter; left time: 1194.9461s
	iters: 1200, epoch: 3 | loss: 0.4512532
	speed: 0.0300s/iter; left time: 1192.0553s
	iters: 1300, epoch: 3 | loss: 0.4233905
	speed: 0.0270s/iter; left time: 1068.1675s
	iters: 1400, epoch: 3 | loss: 0.5786901
	speed: 0.0289s/iter; left time: 1143.3732s
	iters: 1500, epoch: 3 | loss: 0.6196401
	speed: 0.0274s/iter; left time: 1078.6549s
	iters: 1600, epoch: 3 | loss: 0.3404936
	speed: 0.0294s/iter; left time: 1155.6418s
	iters: 1700, epoch: 3 | loss: 0.3195662
	speed: 0.0303s/iter; left time: 1187.3073s
	iters: 1800, epoch: 3 | loss: 0.4641743
	speed: 0.0297s/iter; left time: 1161.2953s
	iters: 1900, epoch: 3 | loss: 1.7358459
	speed: 0.0306s/iter; left time: 1191.6271s
	iters: 2000, epoch: 3 | loss: 0.3656849
	speed: 0.0271s/iter; left time: 1054.0303s
	iters: 2100, epoch: 3 | loss: 0.3518205
	speed: 0.0294s/iter; left time: 1140.0270s
	iters: 2200, epoch: 3 | loss: 0.3153832
	speed: 0.0269s/iter; left time: 1040.8817s
Epoch: 3 cost time: 63.990702867507935
Epoch: 3, Steps: 2272 | Train Loss: 0.7248533 Vali Loss: 0.5279977 Test Loss: 0.2346971
Validation loss decreased (0.669127 --> 0.527998).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.3829047
	speed: 0.1046s/iter; left time: 4029.0856s
	iters: 200, epoch: 4 | loss: 0.3744197
	speed: 0.0283s/iter; left time: 1088.8201s
	iters: 300, epoch: 4 | loss: 1.3412490
	speed: 0.0260s/iter; left time: 997.6840s
	iters: 400, epoch: 4 | loss: 0.3425484
	speed: 0.0281s/iter; left time: 1074.9391s
	iters: 500, epoch: 4 | loss: 0.4098834
	speed: 0.0295s/iter; left time: 1124.5558s
	iters: 600, epoch: 4 | loss: 0.5591941
	speed: 0.0303s/iter; left time: 1151.6582s
	iters: 700, epoch: 4 | loss: 0.4090320
	speed: 0.0302s/iter; left time: 1146.7797s
	iters: 800, epoch: 4 | loss: 0.6121564
	speed: 0.0280s/iter; left time: 1060.5888s
	iters: 900, epoch: 4 | loss: 0.3748266
	speed: 0.0264s/iter; left time: 997.3322s
	iters: 1000, epoch: 4 | loss: 0.6138480
	speed: 0.0274s/iter; left time: 1031.3208s
	iters: 1100, epoch: 4 | loss: 0.5412601
	speed: 0.0281s/iter; left time: 1053.4114s
	iters: 1200, epoch: 4 | loss: 0.2627423
	speed: 0.0269s/iter; left time: 1008.5767s
	iters: 1300, epoch: 4 | loss: 0.5473456
	speed: 0.0271s/iter; left time: 1009.6665s
	iters: 1400, epoch: 4 | loss: 0.3248292
	speed: 0.0279s/iter; left time: 1037.3693s
	iters: 1500, epoch: 4 | loss: 0.4053296
	speed: 0.0292s/iter; left time: 1085.8453s
	iters: 1600, epoch: 4 | loss: 0.6843739
	speed: 0.0287s/iter; left time: 1061.0882s
	iters: 1700, epoch: 4 | loss: 0.3408886
	speed: 0.0275s/iter; left time: 1016.4681s
	iters: 1800, epoch: 4 | loss: 0.6656827
	speed: 0.0287s/iter; left time: 1057.0813s
	iters: 1900, epoch: 4 | loss: 1.3662013
	speed: 0.0288s/iter; left time: 1056.3440s
	iters: 2000, epoch: 4 | loss: 0.2955311
	speed: 0.0313s/iter; left time: 1145.1648s
	iters: 2100, epoch: 4 | loss: 0.5660750
	speed: 0.0299s/iter; left time: 1091.7809s
	iters: 2200, epoch: 4 | loss: 0.3269646
	speed: 0.0318s/iter; left time: 1158.4395s
Epoch: 4 cost time: 64.39781546592712
Epoch: 4, Steps: 2272 | Train Loss: 0.5303616 Vali Loss: 0.4741808 Test Loss: 0.2269925
Validation loss decreased (0.527998 --> 0.474181).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.3749438
	speed: 0.1075s/iter; left time: 3897.1800s
	iters: 200, epoch: 5 | loss: 0.3116116
	speed: 0.0290s/iter; left time: 1046.8817s
	iters: 300, epoch: 5 | loss: 0.5584122
	speed: 0.0274s/iter; left time: 989.5857s
	iters: 400, epoch: 5 | loss: 0.4130560
	speed: 0.0282s/iter; left time: 1013.6581s
	iters: 500, epoch: 5 | loss: 0.4185244
	speed: 0.0252s/iter; left time: 902.3560s
	iters: 600, epoch: 5 | loss: 0.2958559
	speed: 0.0257s/iter; left time: 919.4594s
	iters: 700, epoch: 5 | loss: 0.2895195
	speed: 0.0252s/iter; left time: 900.2107s
	iters: 800, epoch: 5 | loss: 0.4198934
	speed: 0.0273s/iter; left time: 971.6447s
	iters: 900, epoch: 5 | loss: 0.4553016
	speed: 0.0286s/iter; left time: 1012.6453s
	iters: 1000, epoch: 5 | loss: 0.3388995
	speed: 0.0288s/iter; left time: 1018.5124s
	iters: 1100, epoch: 5 | loss: 0.3090959
	speed: 0.0288s/iter; left time: 1015.3080s
	iters: 1200, epoch: 5 | loss: 0.2972399
	speed: 0.0294s/iter; left time: 1032.1711s
	iters: 1300, epoch: 5 | loss: 0.4264208
	speed: 0.0274s/iter; left time: 961.4980s
	iters: 1400, epoch: 5 | loss: 0.5713704
	speed: 0.0278s/iter; left time: 970.8809s
	iters: 1500, epoch: 5 | loss: 0.5786323
	speed: 0.0291s/iter; left time: 1012.9124s
	iters: 1600, epoch: 5 | loss: 0.2977809
	speed: 0.0263s/iter; left time: 915.3805s
	iters: 1700, epoch: 5 | loss: 0.3689754
	speed: 0.0281s/iter; left time: 973.7401s
	iters: 1800, epoch: 5 | loss: 0.3946311
	speed: 0.0288s/iter; left time: 994.3836s
	iters: 1900, epoch: 5 | loss: 0.2991295
	speed: 0.0267s/iter; left time: 920.7231s
	iters: 2000, epoch: 5 | loss: 0.4552186
	speed: 0.0288s/iter; left time: 990.1091s
	iters: 2100, epoch: 5 | loss: 0.4270236
	speed: 0.0287s/iter; left time: 984.0080s
	iters: 2200, epoch: 5 | loss: 0.6074004
	speed: 0.0284s/iter; left time: 969.9783s
Epoch: 5 cost time: 62.84101438522339
Epoch: 5, Steps: 2272 | Train Loss: 0.4769676 Vali Loss: 0.4440965 Test Loss: 0.1954882
Validation loss decreased (0.474181 --> 0.444096).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.3020018
	speed: 0.1072s/iter; left time: 3643.5338s
	iters: 200, epoch: 6 | loss: 0.5939540
	speed: 0.0259s/iter; left time: 879.1777s
	iters: 300, epoch: 6 | loss: 0.5785879
	speed: 0.0278s/iter; left time: 937.6089s
	iters: 400, epoch: 6 | loss: 0.4906584
	speed: 0.0283s/iter; left time: 951.9210s
	iters: 500, epoch: 6 | loss: 0.4211285
	speed: 0.0281s/iter; left time: 944.6110s
	iters: 600, epoch: 6 | loss: 0.4310816
	speed: 0.0281s/iter; left time: 940.9683s
	iters: 700, epoch: 6 | loss: 0.3622790
	speed: 0.0300s/iter; left time: 1002.1762s
	iters: 800, epoch: 6 | loss: 0.2626933
	speed: 0.0290s/iter; left time: 966.4142s
	iters: 900, epoch: 6 | loss: 0.3105553
	speed: 0.0269s/iter; left time: 892.9537s
	iters: 1000, epoch: 6 | loss: 0.4257626
	speed: 0.0295s/iter; left time: 977.5320s
	iters: 1100, epoch: 6 | loss: 0.4799227
	speed: 0.0289s/iter; left time: 951.7291s
	iters: 1200, epoch: 6 | loss: 0.3331795
	speed: 0.0293s/iter; left time: 963.6464s
	iters: 1300, epoch: 6 | loss: 0.3648880
	speed: 0.0275s/iter; left time: 900.7138s
	iters: 1400, epoch: 6 | loss: 0.3879608
	speed: 0.0286s/iter; left time: 935.2820s
	iters: 1500, epoch: 6 | loss: 1.4908354
	speed: 0.0277s/iter; left time: 904.0560s
	iters: 1600, epoch: 6 | loss: 0.3020773
	speed: 0.0287s/iter; left time: 930.8659s
	iters: 1700, epoch: 6 | loss: 0.3115720
	speed: 0.0304s/iter; left time: 982.9534s
	iters: 1800, epoch: 6 | loss: 0.3090446
	speed: 0.0272s/iter; left time: 877.3829s
	iters: 1900, epoch: 6 | loss: 0.2291417
	speed: 0.0294s/iter; left time: 947.4056s
	iters: 2000, epoch: 6 | loss: 0.5906724
	speed: 0.0305s/iter; left time: 977.8968s
	iters: 2100, epoch: 6 | loss: 0.2661808
	speed: 0.0257s/iter; left time: 823.0315s
	iters: 2200, epoch: 6 | loss: 0.3158775
	speed: 0.0273s/iter; left time: 870.9767s
Epoch: 6 cost time: 63.86888146400452
Epoch: 6, Steps: 2272 | Train Loss: 0.4576493 Vali Loss: 0.4317805 Test Loss: 0.1901508
Validation loss decreased (0.444096 --> 0.431781).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.3497185
	speed: 0.1090s/iter; left time: 3455.5683s
	iters: 200, epoch: 7 | loss: 0.4779730
	speed: 0.0281s/iter; left time: 888.2641s
	iters: 300, epoch: 7 | loss: 0.2539097
	speed: 0.0271s/iter; left time: 854.0775s
	iters: 400, epoch: 7 | loss: 0.2035310
	speed: 0.0274s/iter; left time: 860.3887s
	iters: 500, epoch: 7 | loss: 0.4623127
	speed: 0.0299s/iter; left time: 935.2370s
	iters: 600, epoch: 7 | loss: 0.2462634
	speed: 0.0250s/iter; left time: 780.5881s
	iters: 700, epoch: 7 | loss: 1.3618779
	speed: 0.0286s/iter; left time: 890.7453s
	iters: 800, epoch: 7 | loss: 0.2810527
	speed: 0.0295s/iter; left time: 914.7022s
	iters: 900, epoch: 7 | loss: 0.3981864
	speed: 0.0287s/iter; left time: 885.5653s
	iters: 1000, epoch: 7 | loss: 0.3103830
	speed: 0.0272s/iter; left time: 838.2796s
	iters: 1100, epoch: 7 | loss: 1.4602854
	speed: 0.0264s/iter; left time: 810.9657s
	iters: 1200, epoch: 7 | loss: 0.2815381
	speed: 0.0289s/iter; left time: 885.7393s
	iters: 1300, epoch: 7 | loss: 0.3606288
	speed: 0.0276s/iter; left time: 841.0518s
	iters: 1400, epoch: 7 | loss: 0.3570674
	speed: 0.0270s/iter; left time: 822.4579s
	iters: 1500, epoch: 7 | loss: 0.4470541
	speed: 0.0301s/iter; left time: 911.3149s
	iters: 1600, epoch: 7 | loss: 0.3472514
	speed: 0.0282s/iter; left time: 851.0000s
	iters: 1700, epoch: 7 | loss: 0.3495927
	speed: 0.0268s/iter; left time: 806.5819s
	iters: 1800, epoch: 7 | loss: 0.2586555
	speed: 0.0287s/iter; left time: 861.8927s
	iters: 1900, epoch: 7 | loss: 0.4523226
	speed: 0.0303s/iter; left time: 905.0081s
	iters: 2000, epoch: 7 | loss: 0.3281484
	speed: 0.0278s/iter; left time: 828.2970s
	iters: 2100, epoch: 7 | loss: 1.4611782
	speed: 0.0271s/iter; left time: 804.7645s
	iters: 2200, epoch: 7 | loss: 0.2941513
	speed: 0.0308s/iter; left time: 910.6954s
Epoch: 7 cost time: 63.85299897193909
Epoch: 7, Steps: 2272 | Train Loss: 0.4499097 Vali Loss: 0.4286019 Test Loss: 0.1925549
Validation loss decreased (0.431781 --> 0.428602).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.2500989
	speed: 0.1084s/iter; left time: 3191.0075s
	iters: 200, epoch: 8 | loss: 0.3149562
	speed: 0.0278s/iter; left time: 814.1115s
	iters: 300, epoch: 8 | loss: 0.2929907
	speed: 0.0269s/iter; left time: 786.3793s
	iters: 400, epoch: 8 | loss: 0.2733346
	speed: 0.0296s/iter; left time: 862.8123s
	iters: 500, epoch: 8 | loss: 0.2816427
	speed: 0.0276s/iter; left time: 800.7691s
	iters: 600, epoch: 8 | loss: 1.4384552
	speed: 0.0267s/iter; left time: 771.7205s
	iters: 700, epoch: 8 | loss: 0.2326072
	speed: 0.0268s/iter; left time: 773.5284s
	iters: 800, epoch: 8 | loss: 0.4750596
	speed: 0.0293s/iter; left time: 842.5136s
	iters: 900, epoch: 8 | loss: 1.2388982
	speed: 0.0298s/iter; left time: 853.8008s
	iters: 1000, epoch: 8 | loss: 0.2465540
	speed: 0.0288s/iter; left time: 821.6155s
	iters: 1100, epoch: 8 | loss: 0.3252540
	speed: 0.0283s/iter; left time: 805.3766s
	iters: 1200, epoch: 8 | loss: 0.3660629
	speed: 0.0284s/iter; left time: 805.5389s
	iters: 1300, epoch: 8 | loss: 0.4183001
	speed: 0.0242s/iter; left time: 683.2198s
	iters: 1400, epoch: 8 | loss: 0.3728529
	speed: 0.0285s/iter; left time: 803.2494s
	iters: 1500, epoch: 8 | loss: 0.4613962
	speed: 0.0289s/iter; left time: 810.0241s
	iters: 1600, epoch: 8 | loss: 0.2580641
	speed: 0.0297s/iter; left time: 829.4785s
	iters: 1700, epoch: 8 | loss: 0.3720839
	speed: 0.0272s/iter; left time: 756.5034s
	iters: 1800, epoch: 8 | loss: 0.3904004
	speed: 0.0262s/iter; left time: 726.7947s
	iters: 1900, epoch: 8 | loss: 0.2559613
	speed: 0.0283s/iter; left time: 782.0981s
	iters: 2000, epoch: 8 | loss: 1.3092595
	speed: 0.0267s/iter; left time: 733.9276s
	iters: 2100, epoch: 8 | loss: 1.2435207
	speed: 0.0257s/iter; left time: 704.7646s
	iters: 2200, epoch: 8 | loss: 0.3050965
	speed: 0.0273s/iter; left time: 746.5578s
Epoch: 8 cost time: 62.87584447860718
Epoch: 8, Steps: 2272 | Train Loss: 0.4459810 Vali Loss: 0.4253963 Test Loss: 0.1888947
Validation loss decreased (0.428602 --> 0.425396).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 1.3679206
	speed: 0.1012s/iter; left time: 2749.8077s
	iters: 200, epoch: 9 | loss: 0.5055761
	speed: 0.0261s/iter; left time: 706.8824s
	iters: 300, epoch: 9 | loss: 0.3176979
	speed: 0.0266s/iter; left time: 717.4544s
	iters: 400, epoch: 9 | loss: 0.2938470
	speed: 0.0267s/iter; left time: 716.3239s
	iters: 500, epoch: 9 | loss: 0.4012102
	speed: 0.0293s/iter; left time: 784.7527s
	iters: 600, epoch: 9 | loss: 0.4719186
	speed: 0.0271s/iter; left time: 723.6915s
	iters: 700, epoch: 9 | loss: 0.3066701
	speed: 0.0296s/iter; left time: 786.3098s
	iters: 800, epoch: 9 | loss: 0.3536479
	speed: 0.0283s/iter; left time: 748.3944s
	iters: 900, epoch: 9 | loss: 0.4638436
	speed: 0.0281s/iter; left time: 741.5765s
	iters: 1000, epoch: 9 | loss: 0.3959571
	speed: 0.0285s/iter; left time: 749.6506s
	iters: 1100, epoch: 9 | loss: 0.4091119
	speed: 0.0259s/iter; left time: 678.4205s
	iters: 1200, epoch: 9 | loss: 0.3547960
	speed: 0.0276s/iter; left time: 719.8435s
	iters: 1300, epoch: 9 | loss: 0.4215306
	speed: 0.0276s/iter; left time: 716.9695s
	iters: 1400, epoch: 9 | loss: 0.3436920
	speed: 0.0278s/iter; left time: 718.0104s
	iters: 1500, epoch: 9 | loss: 0.3510192
	speed: 0.0274s/iter; left time: 706.3718s
	iters: 1600, epoch: 9 | loss: 0.3044851
	speed: 0.0272s/iter; left time: 699.0639s
	iters: 1700, epoch: 9 | loss: 0.3202069
	speed: 0.0284s/iter; left time: 725.7799s
	iters: 1800, epoch: 9 | loss: 0.3929112
	speed: 0.0270s/iter; left time: 687.8272s
	iters: 1900, epoch: 9 | loss: 0.3995976
	speed: 0.0290s/iter; left time: 735.6656s
	iters: 2000, epoch: 9 | loss: 0.4114167
	speed: 0.0295s/iter; left time: 745.5443s
	iters: 2100, epoch: 9 | loss: 0.3687462
	speed: 0.0296s/iter; left time: 744.3468s
	iters: 2200, epoch: 9 | loss: 0.3592531
	speed: 0.0313s/iter; left time: 785.6588s
Epoch: 9 cost time: 63.30643081665039
Epoch: 9, Steps: 2272 | Train Loss: 0.4439614 Vali Loss: 0.4224765 Test Loss: 0.1874797
Validation loss decreased (0.425396 --> 0.422477).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.3589479
	speed: 0.1048s/iter; left time: 2609.4027s
	iters: 200, epoch: 10 | loss: 0.3030113
	speed: 0.0269s/iter; left time: 668.0931s
	iters: 300, epoch: 10 | loss: 0.2711965
	speed: 0.0292s/iter; left time: 721.0943s
	iters: 400, epoch: 10 | loss: 0.6808566
	speed: 0.0299s/iter; left time: 734.4230s
	iters: 500, epoch: 10 | loss: 0.2572106
	speed: 0.0269s/iter; left time: 658.3914s
	iters: 600, epoch: 10 | loss: 1.2326632
	speed: 0.0296s/iter; left time: 721.6266s
	iters: 700, epoch: 10 | loss: 0.3622280
	speed: 0.0291s/iter; left time: 707.2332s
	iters: 800, epoch: 10 | loss: 0.3555274
	speed: 0.0280s/iter; left time: 677.1115s
	iters: 900, epoch: 10 | loss: 0.4728969
	speed: 0.0286s/iter; left time: 689.7308s
	iters: 1000, epoch: 10 | loss: 1.4287213
	speed: 0.0273s/iter; left time: 654.0309s
	iters: 1100, epoch: 10 | loss: 0.3243800
	speed: 0.0270s/iter; left time: 645.3568s
	iters: 1200, epoch: 10 | loss: 0.4042590
	speed: 0.0292s/iter; left time: 693.7478s
	iters: 1300, epoch: 10 | loss: 0.3165946
	speed: 0.0299s/iter; left time: 708.9724s
	iters: 1400, epoch: 10 | loss: 0.5436648
	speed: 0.0283s/iter; left time: 667.2180s
	iters: 1500, epoch: 10 | loss: 0.4511226
	speed: 0.0290s/iter; left time: 681.1127s
	iters: 1600, epoch: 10 | loss: 0.3502121
	speed: 0.0287s/iter; left time: 671.1346s
	iters: 1700, epoch: 10 | loss: 0.5166737
	speed: 0.0271s/iter; left time: 630.3271s
	iters: 1800, epoch: 10 | loss: 0.3040316
	speed: 0.0247s/iter; left time: 573.2993s
	iters: 1900, epoch: 10 | loss: 0.3960606
	speed: 0.0265s/iter; left time: 611.1362s
	iters: 2000, epoch: 10 | loss: 0.3455553
	speed: 0.0287s/iter; left time: 659.1226s
	iters: 2100, epoch: 10 | loss: 0.3476973
	speed: 0.0280s/iter; left time: 639.9386s
	iters: 2200, epoch: 10 | loss: 0.4669973
	speed: 0.0290s/iter; left time: 660.1078s
Epoch: 10 cost time: 63.57777118682861
Epoch: 10, Steps: 2272 | Train Loss: 0.4429377 Vali Loss: 0.4231503 Test Loss: 0.1891135
EarlyStopping counter: 1 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 1.2359377
	speed: 0.1073s/iter; left time: 2427.4792s
	iters: 200, epoch: 11 | loss: 0.4277028
	speed: 0.0268s/iter; left time: 603.9745s
	iters: 300, epoch: 11 | loss: 0.3628929
	speed: 0.0290s/iter; left time: 650.3624s
	iters: 400, epoch: 11 | loss: 0.3259702
	speed: 0.0287s/iter; left time: 640.2212s
	iters: 500, epoch: 11 | loss: 0.3427899
	speed: 0.0286s/iter; left time: 636.4906s
	iters: 600, epoch: 11 | loss: 0.3547297
	speed: 0.0286s/iter; left time: 631.7612s
	iters: 700, epoch: 11 | loss: 0.3388302
	speed: 0.0287s/iter; left time: 633.0004s
	iters: 800, epoch: 11 | loss: 0.3194868
	speed: 0.0278s/iter; left time: 609.8330s
	iters: 900, epoch: 11 | loss: 0.2520737
	speed: 0.0287s/iter; left time: 625.2405s
	iters: 1000, epoch: 11 | loss: 0.3715978
	speed: 0.0255s/iter; left time: 553.4217s
	iters: 1100, epoch: 11 | loss: 0.3854287
	speed: 0.0283s/iter; left time: 611.4757s
	iters: 1200, epoch: 11 | loss: 0.5315648
	speed: 0.0256s/iter; left time: 551.1616s
	iters: 1300, epoch: 11 | loss: 0.4523144
	speed: 0.0289s/iter; left time: 618.4236s
	iters: 1400, epoch: 11 | loss: 0.3426612
	speed: 0.0301s/iter; left time: 642.2639s
	iters: 1500, epoch: 11 | loss: 0.4901329
	speed: 0.0297s/iter; left time: 629.8455s
	iters: 1600, epoch: 11 | loss: 0.4321086
	speed: 0.0308s/iter; left time: 649.6558s
	iters: 1700, epoch: 11 | loss: 0.2809689
	speed: 0.0285s/iter; left time: 599.3301s
	iters: 1800, epoch: 11 | loss: 0.3471819
	speed: 0.0295s/iter; left time: 616.5482s
	iters: 1900, epoch: 11 | loss: 0.3406492
	speed: 0.0270s/iter; left time: 562.9404s
	iters: 2000, epoch: 11 | loss: 0.3541506
	speed: 0.0278s/iter; left time: 576.1454s
	iters: 2100, epoch: 11 | loss: 0.4816857
	speed: 0.0276s/iter; left time: 568.9052s
	iters: 2200, epoch: 11 | loss: 0.3144079
	speed: 0.0286s/iter; left time: 587.6323s
Epoch: 11 cost time: 63.979432821273804
Epoch: 11, Steps: 2272 | Train Loss: 0.4423750 Vali Loss: 0.4216960 Test Loss: 0.1861878
Validation loss decreased (0.422477 --> 0.421696).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.6961058
	speed: 0.1061s/iter; left time: 2159.1880s
	iters: 200, epoch: 12 | loss: 0.2999976
	speed: 0.0309s/iter; left time: 626.4257s
	iters: 300, epoch: 12 | loss: 0.4656088
	speed: 0.0291s/iter; left time: 585.5151s
	iters: 400, epoch: 12 | loss: 0.3042912
	speed: 0.0294s/iter; left time: 588.9221s
	iters: 500, epoch: 12 | loss: 0.3373748
	speed: 0.0277s/iter; left time: 552.3347s
	iters: 600, epoch: 12 | loss: 0.5025242
	speed: 0.0268s/iter; left time: 531.5493s
	iters: 700, epoch: 12 | loss: 0.4385419
	speed: 0.0292s/iter; left time: 576.4787s
	iters: 800, epoch: 12 | loss: 0.2575401
	speed: 0.0291s/iter; left time: 572.7570s
	iters: 900, epoch: 12 | loss: 1.3370277
	speed: 0.0305s/iter; left time: 595.8822s
	iters: 1000, epoch: 12 | loss: 0.9353397
	speed: 0.0307s/iter; left time: 596.1257s
	iters: 1100, epoch: 12 | loss: 1.1910565
	speed: 0.0300s/iter; left time: 580.4737s
	iters: 1200, epoch: 12 | loss: 1.2543610
	speed: 0.0275s/iter; left time: 528.9589s
	iters: 1300, epoch: 12 | loss: 0.3438873
	speed: 0.0260s/iter; left time: 497.4856s
	iters: 1400, epoch: 12 | loss: 0.3877773
	speed: 0.0281s/iter; left time: 534.4949s
	iters: 1500, epoch: 12 | loss: 0.3319381
	speed: 0.0264s/iter; left time: 500.7180s
	iters: 1600, epoch: 12 | loss: 0.4977996
	speed: 0.0295s/iter; left time: 555.8378s
	iters: 1700, epoch: 12 | loss: 0.3614843
	speed: 0.0271s/iter; left time: 507.7515s
	iters: 1800, epoch: 12 | loss: 0.2422342
	speed: 0.0278s/iter; left time: 519.0055s
	iters: 1900, epoch: 12 | loss: 0.3634548
	speed: 0.0265s/iter; left time: 491.3055s
	iters: 2000, epoch: 12 | loss: 0.3770904
	speed: 0.0285s/iter; left time: 524.9459s
	iters: 2100, epoch: 12 | loss: 0.3987420
	speed: 0.0277s/iter; left time: 507.7828s
	iters: 2200, epoch: 12 | loss: 0.5059034
	speed: 0.0251s/iter; left time: 458.2695s
Epoch: 12 cost time: 63.60710835456848
Epoch: 12, Steps: 2272 | Train Loss: 0.4421712 Vali Loss: 0.4225245 Test Loss: 0.1872148
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.2888908
	speed: 0.1009s/iter; left time: 1823.1863s
	iters: 200, epoch: 13 | loss: 0.4293805
	speed: 0.0259s/iter; left time: 466.1017s
	iters: 300, epoch: 13 | loss: 0.4964676
	speed: 0.0269s/iter; left time: 481.4654s
	iters: 400, epoch: 13 | loss: 0.4423738
	speed: 0.0268s/iter; left time: 476.5998s
	iters: 500, epoch: 13 | loss: 0.4999196
	speed: 0.0272s/iter; left time: 480.4268s
	iters: 600, epoch: 13 | loss: 0.2193931
	speed: 0.0281s/iter; left time: 493.3473s
	iters: 700, epoch: 13 | loss: 0.4065204
	speed: 0.0279s/iter; left time: 487.0831s
	iters: 800, epoch: 13 | loss: 0.2936785
	speed: 0.0259s/iter; left time: 449.2240s
	iters: 900, epoch: 13 | loss: 0.4261054
	speed: 0.0281s/iter; left time: 484.9618s
	iters: 1000, epoch: 13 | loss: 0.3286330
	speed: 0.0280s/iter; left time: 481.0537s
	iters: 1100, epoch: 13 | loss: 0.3036070
	speed: 0.0274s/iter; left time: 467.0921s
	iters: 1200, epoch: 13 | loss: 0.4566388
	speed: 0.0276s/iter; left time: 468.9853s
	iters: 1300, epoch: 13 | loss: 0.4087335
	speed: 0.0299s/iter; left time: 504.9621s
	iters: 1400, epoch: 13 | loss: 0.2739650
	speed: 0.0302s/iter; left time: 506.4843s
	iters: 1500, epoch: 13 | loss: 0.4342509
	speed: 0.0266s/iter; left time: 443.5453s
	iters: 1600, epoch: 13 | loss: 0.3769016
	speed: 0.0264s/iter; left time: 437.0724s
	iters: 1700, epoch: 13 | loss: 0.2871620
	speed: 0.0289s/iter; left time: 476.3390s
	iters: 1800, epoch: 13 | loss: 0.3063568
	speed: 0.0277s/iter; left time: 454.2405s
	iters: 1900, epoch: 13 | loss: 0.4329350
	speed: 0.0273s/iter; left time: 444.9727s
	iters: 2000, epoch: 13 | loss: 0.2828054
	speed: 0.0279s/iter; left time: 452.1103s
	iters: 2100, epoch: 13 | loss: 0.3893147
	speed: 0.0283s/iter; left time: 455.2650s
	iters: 2200, epoch: 13 | loss: 0.4471940
	speed: 0.0298s/iter; left time: 476.8817s
Epoch: 13 cost time: 62.80328130722046
Epoch: 13, Steps: 2272 | Train Loss: 0.4420039 Vali Loss: 0.4231620 Test Loss: 0.1870688
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.4015659
	speed: 0.1093s/iter; left time: 1727.3788s
	iters: 200, epoch: 14 | loss: 0.3231967
	speed: 0.0271s/iter; left time: 425.2655s
	iters: 300, epoch: 14 | loss: 0.3428293
	speed: 0.0291s/iter; left time: 454.6718s
	iters: 400, epoch: 14 | loss: 0.2962945
	speed: 0.0279s/iter; left time: 433.3543s
	iters: 500, epoch: 14 | loss: 0.2793928
	speed: 0.0264s/iter; left time: 406.9608s
	iters: 600, epoch: 14 | loss: 0.2804277
	speed: 0.0271s/iter; left time: 414.2675s
	iters: 700, epoch: 14 | loss: 0.4623975
	speed: 0.0283s/iter; left time: 429.6635s
	iters: 800, epoch: 14 | loss: 0.3070434
	speed: 0.0256s/iter; left time: 387.3816s
	iters: 900, epoch: 14 | loss: 0.5644246
	speed: 0.0276s/iter; left time: 414.5348s
	iters: 1000, epoch: 14 | loss: 0.2808502
	speed: 0.0305s/iter; left time: 455.0300s
	iters: 1100, epoch: 14 | loss: 0.3006007
	speed: 0.0290s/iter; left time: 429.5857s
	iters: 1200, epoch: 14 | loss: 0.4271990
	speed: 0.0275s/iter; left time: 404.5028s
	iters: 1300, epoch: 14 | loss: 0.5837137
	speed: 0.0280s/iter; left time: 409.3994s
	iters: 1400, epoch: 14 | loss: 0.5000214
	speed: 0.0290s/iter; left time: 420.0820s
	iters: 1500, epoch: 14 | loss: 0.2483811
	speed: 0.0268s/iter; left time: 385.8336s
	iters: 1600, epoch: 14 | loss: 0.3492754
	speed: 0.0278s/iter; left time: 397.0749s
	iters: 1700, epoch: 14 | loss: 0.3884710
	speed: 0.0278s/iter; left time: 395.4761s
	iters: 1800, epoch: 14 | loss: 0.3771740
	speed: 0.0268s/iter; left time: 377.4025s
	iters: 1900, epoch: 14 | loss: 0.3927425
	speed: 0.0277s/iter; left time: 387.4717s
	iters: 2000, epoch: 14 | loss: 0.3389160
	speed: 0.0279s/iter; left time: 388.3519s
	iters: 2100, epoch: 14 | loss: 0.3506095
	speed: 0.0266s/iter; left time: 366.9037s
	iters: 2200, epoch: 14 | loss: 1.2970709
	speed: 0.0297s/iter; left time: 406.8456s
Epoch: 14 cost time: 62.87252163887024
Epoch: 14, Steps: 2272 | Train Loss: 0.4419392 Vali Loss: 0.4225386 Test Loss: 0.1869850
EarlyStopping counter: 3 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 1.2615316
	speed: 0.0977s/iter; left time: 1322.8350s
	iters: 200, epoch: 15 | loss: 1.2213652
	speed: 0.0255s/iter; left time: 342.9176s
	iters: 300, epoch: 15 | loss: 1.3733246
	speed: 0.0262s/iter; left time: 348.9853s
	iters: 400, epoch: 15 | loss: 0.3890156
	speed: 0.0251s/iter; left time: 331.6803s
	iters: 500, epoch: 15 | loss: 0.4587740
	speed: 0.0255s/iter; left time: 334.8527s
	iters: 600, epoch: 15 | loss: 0.4491801
	speed: 0.0299s/iter; left time: 389.8893s
	iters: 700, epoch: 15 | loss: 1.3030365
	speed: 0.0264s/iter; left time: 341.5589s
	iters: 800, epoch: 15 | loss: 0.2907952
	speed: 0.0250s/iter; left time: 320.5353s
	iters: 900, epoch: 15 | loss: 0.3040525
	speed: 0.0270s/iter; left time: 343.8406s
	iters: 1000, epoch: 15 | loss: 0.2630756
	speed: 0.0287s/iter; left time: 362.8005s
	iters: 1100, epoch: 15 | loss: 0.3163589
	speed: 0.0268s/iter; left time: 335.3294s
	iters: 1200, epoch: 15 | loss: 0.4473422
	speed: 0.0257s/iter; left time: 319.7628s
	iters: 1300, epoch: 15 | loss: 0.2285949
	speed: 0.0246s/iter; left time: 303.4447s
	iters: 1400, epoch: 15 | loss: 0.1970297
	speed: 0.0260s/iter; left time: 318.0281s
	iters: 1500, epoch: 15 | loss: 0.4880489
	speed: 0.0275s/iter; left time: 333.7187s
	iters: 1600, epoch: 15 | loss: 0.3730998
	speed: 0.0280s/iter; left time: 337.1108s
	iters: 1700, epoch: 15 | loss: 0.3484198
	speed: 0.0273s/iter; left time: 326.0306s
	iters: 1800, epoch: 15 | loss: 1.2464288
	speed: 0.0258s/iter; left time: 305.5766s
	iters: 1900, epoch: 15 | loss: 0.2617765
	speed: 0.0252s/iter; left time: 295.2937s
	iters: 2000, epoch: 15 | loss: 0.3808502
	speed: 0.0254s/iter; left time: 295.2536s
	iters: 2100, epoch: 15 | loss: 1.0995109
	speed: 0.0271s/iter; left time: 312.1059s
	iters: 2200, epoch: 15 | loss: 0.3090006
	speed: 0.0292s/iter; left time: 333.4548s
Epoch: 15 cost time: 60.14607501029968
Epoch: 15, Steps: 2272 | Train Loss: 0.4419109 Vali Loss: 0.4225011 Test Loss: 0.1870628
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.3545435
	speed: 0.1061s/iter; left time: 1194.9533s
	iters: 200, epoch: 16 | loss: 0.2789902
	speed: 0.0237s/iter; left time: 264.3115s
	iters: 300, epoch: 16 | loss: 0.4316889
	speed: 0.0247s/iter; left time: 273.0509s
	iters: 400, epoch: 16 | loss: 0.5740839
	speed: 0.0246s/iter; left time: 270.1386s
	iters: 500, epoch: 16 | loss: 0.4169738
	speed: 0.0254s/iter; left time: 275.6373s
	iters: 600, epoch: 16 | loss: 0.2478245
	speed: 0.0277s/iter; left time: 297.5988s
	iters: 700, epoch: 16 | loss: 0.2719248
	speed: 0.0253s/iter; left time: 270.0118s
	iters: 800, epoch: 16 | loss: 0.2360341
	speed: 0.0246s/iter; left time: 259.5178s
	iters: 900, epoch: 16 | loss: 0.3420719
	speed: 0.0242s/iter; left time: 252.7897s
	iters: 1000, epoch: 16 | loss: 0.4092140
	speed: 0.0246s/iter; left time: 255.1048s
	iters: 1100, epoch: 16 | loss: 0.5330338
	speed: 0.0235s/iter; left time: 240.9115s
	iters: 1200, epoch: 16 | loss: 0.2374307
	speed: 0.0247s/iter; left time: 251.0177s
	iters: 1300, epoch: 16 | loss: 0.4012080
	speed: 0.0244s/iter; left time: 245.8333s
	iters: 1400, epoch: 16 | loss: 0.3223478
	speed: 0.0245s/iter; left time: 244.3642s
	iters: 1500, epoch: 16 | loss: 0.3596308
	speed: 0.0223s/iter; left time: 220.0206s
	iters: 1600, epoch: 16 | loss: 0.2981733
	speed: 0.0232s/iter; left time: 226.9341s
	iters: 1700, epoch: 16 | loss: 0.2656107
	speed: 0.0247s/iter; left time: 238.9466s
	iters: 1800, epoch: 16 | loss: 0.2830271
	speed: 0.0245s/iter; left time: 233.9813s
	iters: 1900, epoch: 16 | loss: 1.3948523
	speed: 0.0237s/iter; left time: 224.0175s
	iters: 2000, epoch: 16 | loss: 0.5109346
	speed: 0.0217s/iter; left time: 203.5699s
	iters: 2100, epoch: 16 | loss: 0.2722156
	speed: 0.0225s/iter; left time: 208.2414s
	iters: 2200, epoch: 16 | loss: 0.2198513
	speed: 0.0237s/iter; left time: 216.6997s
Epoch: 16 cost time: 54.84076929092407
Epoch: 16, Steps: 2272 | Train Loss: 0.4418554 Vali Loss: 0.4227048 Test Loss: 0.1871079
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : weather_336_192_DLinear_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15726<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10348
mse:0.18623724579811096, mae:0.25199970602989197
