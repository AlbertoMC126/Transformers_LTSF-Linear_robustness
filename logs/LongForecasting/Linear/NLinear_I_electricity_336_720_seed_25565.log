Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='NLinear', model_id='Electricity_336_720', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=720, root_path='./dataset/', save_pred_values=False, seed=25565, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : Electricity_336_720_NLinear_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed25565>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17357
val 1913
test 4541
	iters: 100, epoch: 1 | loss: 0.3127164
	speed: 0.1143s/iter; left time: 2466.7287s
	iters: 200, epoch: 1 | loss: 0.3085808
	speed: 0.0981s/iter; left time: 2107.4862s
	iters: 300, epoch: 1 | loss: 0.2770788
	speed: 0.0950s/iter; left time: 2031.0524s
	iters: 400, epoch: 1 | loss: 0.3120937
	speed: 0.0949s/iter; left time: 2018.5807s
	iters: 500, epoch: 1 | loss: 0.3302516
	speed: 0.0946s/iter; left time: 2004.0227s
	iters: 600, epoch: 1 | loss: 0.3005588
	speed: 0.0957s/iter; left time: 2017.6123s
	iters: 700, epoch: 1 | loss: 0.3171240
	speed: 0.0961s/iter; left time: 2017.0366s
	iters: 800, epoch: 1 | loss: 0.3300160
	speed: 0.0950s/iter; left time: 1983.3454s
	iters: 900, epoch: 1 | loss: 0.2812402
	speed: 0.0948s/iter; left time: 1970.0562s
	iters: 1000, epoch: 1 | loss: 0.3272941
	speed: 0.0959s/iter; left time: 1982.8886s
Epoch: 1 cost time: 105.53950643539429
Epoch: 1, Steps: 1084 | Train Loss: 0.3311257 Vali Loss: 0.2604687 Test Loss: 0.3026652
Validation loss decreased (inf --> 0.260469).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.2737877
	speed: 0.3917s/iter; left time: 8027.9466s
	iters: 200, epoch: 2 | loss: 0.3448215
	speed: 0.0952s/iter; left time: 1941.3040s
	iters: 300, epoch: 2 | loss: 0.3183942
	speed: 0.0967s/iter; left time: 1962.5761s
	iters: 400, epoch: 2 | loss: 0.3002792
	speed: 0.0961s/iter; left time: 1940.4375s
	iters: 500, epoch: 2 | loss: 0.3133963
	speed: 0.0957s/iter; left time: 1922.3096s
	iters: 600, epoch: 2 | loss: 0.3250504
	speed: 0.0958s/iter; left time: 1916.6597s
	iters: 700, epoch: 2 | loss: 0.2970109
	speed: 0.0953s/iter; left time: 1895.6071s
	iters: 800, epoch: 2 | loss: 0.3379658
	speed: 0.0971s/iter; left time: 1921.8263s
	iters: 900, epoch: 2 | loss: 0.3011180
	speed: 0.0977s/iter; left time: 1924.0499s
	iters: 1000, epoch: 2 | loss: 0.3017372
	speed: 0.0973s/iter; left time: 1906.5792s
Epoch: 2 cost time: 104.62700200080872
Epoch: 2, Steps: 1084 | Train Loss: 0.3195338 Vali Loss: 0.2622242 Test Loss: 0.2899814
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.2544370
	speed: 0.3804s/iter; left time: 7384.4818s
	iters: 200, epoch: 3 | loss: 0.2976677
	speed: 0.0955s/iter; left time: 1844.7884s
	iters: 300, epoch: 3 | loss: 0.3092896
	speed: 0.0968s/iter; left time: 1860.7161s
	iters: 400, epoch: 3 | loss: 0.2607733
	speed: 0.0967s/iter; left time: 1847.4230s
	iters: 500, epoch: 3 | loss: 0.2844564
	speed: 0.0950s/iter; left time: 1806.5926s
	iters: 600, epoch: 3 | loss: 0.2479193
	speed: 0.0954s/iter; left time: 1803.5914s
	iters: 700, epoch: 3 | loss: 0.2525405
	speed: 0.0954s/iter; left time: 1795.5412s
	iters: 800, epoch: 3 | loss: 0.2543572
	speed: 0.1000s/iter; left time: 1871.8343s
	iters: 900, epoch: 3 | loss: 0.2385418
	speed: 0.0982s/iter; left time: 1827.1210s
	iters: 1000, epoch: 3 | loss: 0.3164120
	speed: 0.0992s/iter; left time: 1836.0388s
Epoch: 3 cost time: 106.23879218101501
Epoch: 3, Steps: 1084 | Train Loss: 0.2564646 Vali Loss: 0.2256667 Test Loss: 0.2548073
Validation loss decreased (0.260469 --> 0.225667).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.2176367
	speed: 0.4071s/iter; left time: 7462.1547s
	iters: 200, epoch: 4 | loss: 0.2512331
	speed: 0.0954s/iter; left time: 1739.9277s
	iters: 300, epoch: 4 | loss: 0.1979062
	speed: 0.0953s/iter; left time: 1727.2770s
	iters: 400, epoch: 4 | loss: 0.2157853
	speed: 0.0952s/iter; left time: 1715.7864s
	iters: 500, epoch: 4 | loss: 0.2187333
	speed: 0.0953s/iter; left time: 1708.6608s
	iters: 600, epoch: 4 | loss: 0.2415691
	speed: 0.0959s/iter; left time: 1709.1219s
	iters: 700, epoch: 4 | loss: 0.2455459
	speed: 0.0947s/iter; left time: 1679.0257s
	iters: 800, epoch: 4 | loss: 0.2711502
	speed: 0.0946s/iter; left time: 1668.4930s
	iters: 900, epoch: 4 | loss: 0.2080926
	speed: 0.0946s/iter; left time: 1658.3744s
	iters: 1000, epoch: 4 | loss: 0.2174189
	speed: 0.0967s/iter; left time: 1685.1083s
Epoch: 4 cost time: 103.55806183815002
Epoch: 4, Steps: 1084 | Train Loss: 0.2347684 Vali Loss: 0.1958159 Test Loss: 0.2289063
Validation loss decreased (0.225667 --> 0.195816).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.2155960
	speed: 0.4072s/iter; left time: 7022.3674s
	iters: 200, epoch: 5 | loss: 0.2431671
	speed: 0.0961s/iter; left time: 1648.1714s
	iters: 300, epoch: 5 | loss: 0.1814733
	speed: 0.0963s/iter; left time: 1641.9658s
	iters: 400, epoch: 5 | loss: 0.2061511
	speed: 0.0966s/iter; left time: 1636.2741s
	iters: 500, epoch: 5 | loss: 0.2375570
	speed: 0.0967s/iter; left time: 1628.6387s
	iters: 600, epoch: 5 | loss: 0.1980349
	speed: 0.0972s/iter; left time: 1627.8709s
	iters: 700, epoch: 5 | loss: 0.2455829
	speed: 0.0982s/iter; left time: 1635.2800s
	iters: 800, epoch: 5 | loss: 0.1991908
	speed: 0.0980s/iter; left time: 1622.1682s
	iters: 900, epoch: 5 | loss: 0.2143131
	speed: 0.0967s/iter; left time: 1590.6818s
	iters: 1000, epoch: 5 | loss: 0.2347034
	speed: 0.0971s/iter; left time: 1587.2583s
Epoch: 5 cost time: 105.47567296028137
Epoch: 5, Steps: 1084 | Train Loss: 0.2236986 Vali Loss: 0.1865341 Test Loss: 0.2172066
Validation loss decreased (0.195816 --> 0.186534).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.1983831
	speed: 0.3949s/iter; left time: 6381.4251s
	iters: 200, epoch: 6 | loss: 0.2245644
	speed: 0.0953s/iter; left time: 1531.3364s
	iters: 300, epoch: 6 | loss: 0.2166795
	speed: 0.0948s/iter; left time: 1513.4741s
	iters: 400, epoch: 6 | loss: 0.2229346
	speed: 0.0951s/iter; left time: 1508.8203s
	iters: 500, epoch: 6 | loss: 0.2132492
	speed: 0.0977s/iter; left time: 1540.2415s
	iters: 600, epoch: 6 | loss: 0.2108759
	speed: 0.1007s/iter; left time: 1577.6759s
	iters: 700, epoch: 6 | loss: 0.2053298
	speed: 0.1010s/iter; left time: 1572.0556s
	iters: 800, epoch: 6 | loss: 0.2442855
	speed: 0.1004s/iter; left time: 1553.0213s
	iters: 900, epoch: 6 | loss: 0.2109206
	speed: 0.1014s/iter; left time: 1557.4990s
	iters: 1000, epoch: 6 | loss: 0.2060290
	speed: 0.1002s/iter; left time: 1529.7101s
Epoch: 6 cost time: 106.72960543632507
Epoch: 6, Steps: 1084 | Train Loss: 0.2176686 Vali Loss: 0.1818145 Test Loss: 0.2115840
Validation loss decreased (0.186534 --> 0.181815).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.2090539
	speed: 0.3959s/iter; left time: 5968.8869s
	iters: 200, epoch: 7 | loss: 0.2059774
	speed: 0.0957s/iter; left time: 1433.1928s
	iters: 300, epoch: 7 | loss: 0.2098068
	speed: 0.0955s/iter; left time: 1420.8477s
	iters: 400, epoch: 7 | loss: 0.2361469
	speed: 0.0958s/iter; left time: 1415.2853s
	iters: 500, epoch: 7 | loss: 0.1892485
	speed: 0.0950s/iter; left time: 1394.2982s
	iters: 600, epoch: 7 | loss: 0.1867898
	speed: 0.0959s/iter; left time: 1397.7211s
	iters: 700, epoch: 7 | loss: 0.2291063
	speed: 0.0956s/iter; left time: 1383.4133s
	iters: 800, epoch: 7 | loss: 0.2175198
	speed: 0.0954s/iter; left time: 1371.2301s
	iters: 900, epoch: 7 | loss: 0.2119714
	speed: 0.0959s/iter; left time: 1369.4375s
	iters: 1000, epoch: 7 | loss: 0.2859856
	speed: 0.0958s/iter; left time: 1358.7014s
Epoch: 7 cost time: 104.01766633987427
Epoch: 7, Steps: 1084 | Train Loss: 0.2144459 Vali Loss: 0.1798927 Test Loss: 0.2087682
Validation loss decreased (0.181815 --> 0.179893).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.1743378
	speed: 0.3949s/iter; left time: 5526.1652s
	iters: 200, epoch: 8 | loss: 0.2111955
	speed: 0.0957s/iter; left time: 1329.4657s
	iters: 300, epoch: 8 | loss: 0.2174847
	speed: 0.0962s/iter; left time: 1326.5415s
	iters: 400, epoch: 8 | loss: 0.2554440
	speed: 0.0975s/iter; left time: 1334.9716s
	iters: 500, epoch: 8 | loss: 0.1925740
	speed: 0.0969s/iter; left time: 1316.9937s
	iters: 600, epoch: 8 | loss: 0.2492693
	speed: 0.0970s/iter; left time: 1309.2042s
	iters: 700, epoch: 8 | loss: 0.2335102
	speed: 0.0971s/iter; left time: 1300.4605s
	iters: 800, epoch: 8 | loss: 0.2460949
	speed: 0.0959s/iter; left time: 1274.6211s
	iters: 900, epoch: 8 | loss: 0.2177975
	speed: 0.0967s/iter; left time: 1275.9654s
	iters: 1000, epoch: 8 | loss: 0.2030908
	speed: 0.0980s/iter; left time: 1283.5074s
Epoch: 8 cost time: 104.88516998291016
Epoch: 8, Steps: 1084 | Train Loss: 0.2127313 Vali Loss: 0.1780902 Test Loss: 0.2077306
Validation loss decreased (0.179893 --> 0.178090).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.2028082
	speed: 0.3950s/iter; left time: 5099.5687s
	iters: 200, epoch: 9 | loss: 0.2143496
	speed: 0.0960s/iter; left time: 1229.0921s
	iters: 300, epoch: 9 | loss: 0.1962416
	speed: 0.0971s/iter; left time: 1234.2816s
	iters: 400, epoch: 9 | loss: 0.1723863
	speed: 0.0980s/iter; left time: 1235.4140s
	iters: 500, epoch: 9 | loss: 0.2005531
	speed: 0.1002s/iter; left time: 1253.0097s
	iters: 600, epoch: 9 | loss: 0.2297180
	speed: 0.0998s/iter; left time: 1238.3587s
	iters: 700, epoch: 9 | loss: 0.2481029
	speed: 0.0994s/iter; left time: 1223.5131s
	iters: 800, epoch: 9 | loss: 0.2084424
	speed: 0.0994s/iter; left time: 1213.4754s
	iters: 900, epoch: 9 | loss: 0.2044249
	speed: 0.0979s/iter; left time: 1185.7410s
	iters: 1000, epoch: 9 | loss: 0.2316728
	speed: 0.0944s/iter; left time: 1133.6718s
Epoch: 9 cost time: 105.93888330459595
Epoch: 9, Steps: 1084 | Train Loss: 0.2116755 Vali Loss: 0.1777619 Test Loss: 0.2072040
Validation loss decreased (0.178090 --> 0.177762).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.1888396
	speed: 0.3938s/iter; left time: 4656.9007s
	iters: 200, epoch: 10 | loss: 0.2315061
	speed: 0.0958s/iter; left time: 1122.9019s
	iters: 300, epoch: 10 | loss: 0.2097627
	speed: 0.0952s/iter; left time: 1106.6777s
	iters: 400, epoch: 10 | loss: 0.1970028
	speed: 0.0951s/iter; left time: 1096.5453s
	iters: 500, epoch: 10 | loss: 0.2358557
	speed: 0.0954s/iter; left time: 1089.6399s
	iters: 600, epoch: 10 | loss: 0.1506083
	speed: 0.0966s/iter; left time: 1093.5789s
	iters: 700, epoch: 10 | loss: 0.2418743
	speed: 0.0960s/iter; left time: 1077.3721s
	iters: 800, epoch: 10 | loss: 0.2236618
	speed: 0.0947s/iter; left time: 1053.1378s
	iters: 900, epoch: 10 | loss: 0.1969878
	speed: 0.0951s/iter; left time: 1048.7983s
	iters: 1000, epoch: 10 | loss: 0.2056872
	speed: 0.0948s/iter; left time: 1035.3027s
Epoch: 10 cost time: 103.69693040847778
Epoch: 10, Steps: 1084 | Train Loss: 0.2111585 Vali Loss: 0.1772690 Test Loss: 0.2069576
Validation loss decreased (0.177762 --> 0.177269).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.2172672
	speed: 0.3947s/iter; left time: 4239.6447s
	iters: 200, epoch: 11 | loss: 0.1967549
	speed: 0.0965s/iter; left time: 1027.0419s
	iters: 300, epoch: 11 | loss: 0.2468511
	speed: 0.0961s/iter; left time: 1012.6040s
	iters: 400, epoch: 11 | loss: 0.2150320
	speed: 0.0966s/iter; left time: 1008.7854s
	iters: 500, epoch: 11 | loss: 0.2249871
	speed: 0.0980s/iter; left time: 1013.8658s
	iters: 600, epoch: 11 | loss: 0.2782804
	speed: 0.0971s/iter; left time: 994.6274s
	iters: 700, epoch: 11 | loss: 0.2436958
	speed: 0.0982s/iter; left time: 995.8753s
	iters: 800, epoch: 11 | loss: 0.1868979
	speed: 0.0969s/iter; left time: 973.2000s
	iters: 900, epoch: 11 | loss: 0.2038428
	speed: 0.0959s/iter; left time: 953.2103s
	iters: 1000, epoch: 11 | loss: 0.1887966
	speed: 0.0953s/iter; left time: 937.6449s
Epoch: 11 cost time: 105.01492619514465
Epoch: 11, Steps: 1084 | Train Loss: 0.2108886 Vali Loss: 0.1769555 Test Loss: 0.2067169
Validation loss decreased (0.177269 --> 0.176955).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.1939952
	speed: 0.3928s/iter; left time: 3793.0747s
	iters: 200, epoch: 12 | loss: 0.2105497
	speed: 0.0999s/iter; left time: 954.7930s
	iters: 300, epoch: 12 | loss: 0.2189306
	speed: 0.0997s/iter; left time: 943.2145s
	iters: 400, epoch: 12 | loss: 0.2038924
	speed: 0.0994s/iter; left time: 930.2940s
	iters: 500, epoch: 12 | loss: 0.2221858
	speed: 0.0990s/iter; left time: 916.6634s
	iters: 600, epoch: 12 | loss: 0.1801258
	speed: 0.1003s/iter; left time: 918.7534s
	iters: 700, epoch: 12 | loss: 0.2017408
	speed: 0.0990s/iter; left time: 896.9785s
	iters: 800, epoch: 12 | loss: 0.1890927
	speed: 0.0956s/iter; left time: 856.6082s
	iters: 900, epoch: 12 | loss: 0.2887149
	speed: 0.0955s/iter; left time: 845.4822s
	iters: 1000, epoch: 12 | loss: 0.2000076
	speed: 0.0943s/iter; left time: 825.7183s
Epoch: 12 cost time: 106.20805716514587
Epoch: 12, Steps: 1084 | Train Loss: 0.2107531 Vali Loss: 0.1770465 Test Loss: 0.2065388
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.1649864
	speed: 0.3691s/iter; left time: 3164.1197s
	iters: 200, epoch: 13 | loss: 0.2428520
	speed: 0.0954s/iter; left time: 808.4121s
	iters: 300, epoch: 13 | loss: 0.2049641
	speed: 0.0954s/iter; left time: 798.6450s
	iters: 400, epoch: 13 | loss: 0.2701582
	speed: 0.0948s/iter; left time: 784.0267s
	iters: 500, epoch: 13 | loss: 0.1837503
	speed: 0.0950s/iter; left time: 776.7149s
	iters: 600, epoch: 13 | loss: 0.2257266
	speed: 0.0957s/iter; left time: 772.9843s
	iters: 700, epoch: 13 | loss: 0.2050383
	speed: 0.0965s/iter; left time: 769.1144s
	iters: 800, epoch: 13 | loss: 0.1845329
	speed: 0.0961s/iter; left time: 756.8516s
	iters: 900, epoch: 13 | loss: 0.1983405
	speed: 0.0955s/iter; left time: 742.6098s
	iters: 1000, epoch: 13 | loss: 0.2179336
	speed: 0.0956s/iter; left time: 733.6378s
Epoch: 13 cost time: 103.73107123374939
Epoch: 13, Steps: 1084 | Train Loss: 0.2106743 Vali Loss: 0.1769183 Test Loss: 0.2065179
Validation loss decreased (0.176955 --> 0.176918).  Saving model ...
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.2068291
	speed: 0.4050s/iter; left time: 3033.0730s
	iters: 200, epoch: 14 | loss: 0.2161805
	speed: 0.0976s/iter; left time: 721.0336s
	iters: 300, epoch: 14 | loss: 0.1867505
	speed: 0.0975s/iter; left time: 710.8305s
	iters: 400, epoch: 14 | loss: 0.1798954
	speed: 0.0973s/iter; left time: 699.3421s
	iters: 500, epoch: 14 | loss: 0.2100374
	speed: 0.0978s/iter; left time: 693.5591s
	iters: 600, epoch: 14 | loss: 0.1976050
	speed: 0.0967s/iter; left time: 676.1495s
	iters: 700, epoch: 14 | loss: 0.1921771
	speed: 0.0954s/iter; left time: 656.9162s
	iters: 800, epoch: 14 | loss: 0.1845200
	speed: 0.0948s/iter; left time: 643.7741s
	iters: 900, epoch: 14 | loss: 0.2136721
	speed: 0.0953s/iter; left time: 637.7093s
	iters: 1000, epoch: 14 | loss: 0.1933545
	speed: 0.0948s/iter; left time: 624.7883s
Epoch: 14 cost time: 105.16533184051514
Epoch: 14, Steps: 1084 | Train Loss: 0.2106155 Vali Loss: 0.1768348 Test Loss: 0.2065044
Validation loss decreased (0.176918 --> 0.176835).  Saving model ...
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.2415125
	speed: 0.3967s/iter; left time: 2540.5861s
	iters: 200, epoch: 15 | loss: 0.1920959
	speed: 0.0998s/iter; left time: 628.9553s
	iters: 300, epoch: 15 | loss: 0.2279112
	speed: 0.1001s/iter; left time: 621.1878s
	iters: 400, epoch: 15 | loss: 0.1973702
	speed: 0.1007s/iter; left time: 614.9592s
	iters: 500, epoch: 15 | loss: 0.2206620
	speed: 0.0996s/iter; left time: 597.9288s
	iters: 600, epoch: 15 | loss: 0.2217835
	speed: 0.0944s/iter; left time: 557.4346s
	iters: 700, epoch: 15 | loss: 0.2193405
	speed: 0.0949s/iter; left time: 551.0486s
	iters: 800, epoch: 15 | loss: 0.2026480
	speed: 0.0957s/iter; left time: 545.8742s
	iters: 900, epoch: 15 | loss: 0.1953858
	speed: 0.0954s/iter; left time: 534.6472s
	iters: 1000, epoch: 15 | loss: 0.1930381
	speed: 0.0949s/iter; left time: 522.5680s
Epoch: 15 cost time: 105.50940465927124
Epoch: 15, Steps: 1084 | Train Loss: 0.2106045 Vali Loss: 0.1768552 Test Loss: 0.2064992
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.2166971
	speed: 0.3681s/iter; left time: 1958.4441s
	iters: 200, epoch: 16 | loss: 0.2239361
	speed: 0.0956s/iter; left time: 499.3162s
	iters: 300, epoch: 16 | loss: 0.2362685
	speed: 0.0955s/iter; left time: 489.2726s
	iters: 400, epoch: 16 | loss: 0.2032897
	speed: 0.0948s/iter; left time: 475.9394s
	iters: 500, epoch: 16 | loss: 0.1907434
	speed: 0.0950s/iter; left time: 467.3317s
	iters: 600, epoch: 16 | loss: 0.2091898
	speed: 0.0953s/iter; left time: 459.6213s
	iters: 700, epoch: 16 | loss: 0.2087151
	speed: 0.0959s/iter; left time: 452.8940s
	iters: 800, epoch: 16 | loss: 0.2366288
	speed: 0.0969s/iter; left time: 447.9485s
	iters: 900, epoch: 16 | loss: 0.2097693
	speed: 0.0980s/iter; left time: 443.2312s
	iters: 1000, epoch: 16 | loss: 0.1725224
	speed: 0.0983s/iter; left time: 434.5406s
Epoch: 16 cost time: 104.46797847747803
Epoch: 16, Steps: 1084 | Train Loss: 0.2105958 Vali Loss: 0.1768384 Test Loss: 0.2064942
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 17 | loss: 0.2189147
	speed: 0.3861s/iter; left time: 1635.8791s
	iters: 200, epoch: 17 | loss: 0.2044770
	speed: 0.0982s/iter; left time: 406.2798s
	iters: 300, epoch: 17 | loss: 0.2383107
	speed: 0.0987s/iter; left time: 398.3998s
	iters: 400, epoch: 17 | loss: 0.1735950
	speed: 0.0978s/iter; left time: 384.8756s
	iters: 500, epoch: 17 | loss: 0.2112227
	speed: 0.0974s/iter; left time: 373.6802s
	iters: 600, epoch: 17 | loss: 0.2660600
	speed: 0.0969s/iter; left time: 362.1907s
	iters: 700, epoch: 17 | loss: 0.1909603
	speed: 0.0956s/iter; left time: 347.5745s
	iters: 800, epoch: 17 | loss: 0.2875827
	speed: 0.0945s/iter; left time: 334.4211s
	iters: 900, epoch: 17 | loss: 0.2291460
	speed: 0.0957s/iter; left time: 329.0100s
	iters: 1000, epoch: 17 | loss: 0.2132450
	speed: 0.0950s/iter; left time: 317.0554s
Epoch: 17 cost time: 105.14143586158752
Epoch: 17, Steps: 1084 | Train Loss: 0.2105740 Vali Loss: 0.1767854 Test Loss: 0.2064930
Validation loss decreased (0.176835 --> 0.176785).  Saving model ...
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 18 | loss: 0.2321389
	speed: 0.3959s/iter; left time: 1248.3354s
	iters: 200, epoch: 18 | loss: 0.1880132
	speed: 0.0996s/iter; left time: 303.9429s
	iters: 300, epoch: 18 | loss: 0.2375814
	speed: 0.0999s/iter; left time: 295.0092s
	iters: 400, epoch: 18 | loss: 0.2002618
	speed: 0.0960s/iter; left time: 273.8318s
	iters: 500, epoch: 18 | loss: 0.2418792
	speed: 0.0955s/iter; left time: 262.8913s
	iters: 600, epoch: 18 | loss: 0.1923829
	speed: 0.0951s/iter; left time: 252.3851s
	iters: 700, epoch: 18 | loss: 0.1837531
	speed: 0.0946s/iter; left time: 241.5105s
	iters: 800, epoch: 18 | loss: 0.1842199
	speed: 0.0963s/iter; left time: 236.3264s
	iters: 900, epoch: 18 | loss: 0.1903085
	speed: 0.0958s/iter; left time: 225.4656s
	iters: 1000, epoch: 18 | loss: 0.2467947
	speed: 0.0950s/iter; left time: 214.1090s
Epoch: 18 cost time: 104.85841464996338
Epoch: 18, Steps: 1084 | Train Loss: 0.2105637 Vali Loss: 0.1768207 Test Loss: 0.2064925
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 19 | loss: 0.1937191
	speed: 0.3684s/iter; left time: 762.2706s
	iters: 200, epoch: 19 | loss: 0.2372274
	speed: 0.0960s/iter; left time: 189.0232s
	iters: 300, epoch: 19 | loss: 0.1893131
	speed: 0.0957s/iter; left time: 178.7945s
	iters: 400, epoch: 19 | loss: 0.1984822
	speed: 0.0956s/iter; left time: 169.0980s
	iters: 500, epoch: 19 | loss: 0.2182159
	speed: 0.0955s/iter; left time: 159.4539s
	iters: 600, epoch: 19 | loss: 0.2310084
	speed: 0.0958s/iter; left time: 150.2459s
	iters: 700, epoch: 19 | loss: 0.1932249
	speed: 0.0969s/iter; left time: 142.3883s
	iters: 800, epoch: 19 | loss: 0.2051282
	speed: 0.0959s/iter; left time: 131.3263s
	iters: 900, epoch: 19 | loss: 0.2175976
	speed: 0.0954s/iter; left time: 121.0738s
	iters: 1000, epoch: 19 | loss: 0.2375363
	speed: 0.0975s/iter; left time: 113.9657s
Epoch: 19 cost time: 104.12359881401062
Epoch: 19, Steps: 1084 | Train Loss: 0.2105861 Vali Loss: 0.1768461 Test Loss: 0.2064923
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.9073486328125e-08
	iters: 100, epoch: 20 | loss: 0.2427529
	speed: 0.3743s/iter; left time: 368.6685s
	iters: 200, epoch: 20 | loss: 0.2184006
	speed: 0.0967s/iter; left time: 85.5451s
	iters: 300, epoch: 20 | loss: 0.2566212
	speed: 0.0967s/iter; left time: 75.9093s
	iters: 400, epoch: 20 | loss: 0.2179478
	speed: 0.0962s/iter; left time: 65.8898s
	iters: 500, epoch: 20 | loss: 0.2164627
	speed: 0.0960s/iter; left time: 56.1594s
	iters: 600, epoch: 20 | loss: 0.2206929
	speed: 0.0958s/iter; left time: 46.4753s
	iters: 700, epoch: 20 | loss: 0.2067207
	speed: 0.0965s/iter; left time: 37.1619s
	iters: 800, epoch: 20 | loss: 0.2354853
	speed: 0.0955s/iter; left time: 27.2073s
	iters: 900, epoch: 20 | loss: 0.1962975
	speed: 0.0966s/iter; left time: 17.8642s
	iters: 1000, epoch: 20 | loss: 0.1883643
	speed: 0.0984s/iter; left time: 8.3640s
Epoch: 20 cost time: 104.73626613616943
Epoch: 20, Steps: 1084 | Train Loss: 0.2105822 Vali Loss: 0.1768650 Test Loss: 0.2064923
EarlyStopping counter: 3 out of 5
Updating learning rate to 9.5367431640625e-09
>>>>>>>testing : Electricity_336_720_NLinear_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed25565<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4541
mse:0.2064053863286972, mae:0.2930152714252472
