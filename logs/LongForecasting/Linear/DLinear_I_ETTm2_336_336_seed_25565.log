Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='DLinear', model_id='ETTm2_336_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=336, root_path='./dataset/', save_pred_values=False, seed=25565, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTm2_336_336_DLinear_ETTm2_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed25565>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33889
val 11185
test 11185
	iters: 100, epoch: 1 | loss: 0.4150785
	speed: 0.0179s/iter; left time: 377.5135s
	iters: 200, epoch: 1 | loss: 0.9939029
	speed: 0.0161s/iter; left time: 338.1186s
	iters: 300, epoch: 1 | loss: 0.7641975
	speed: 0.0177s/iter; left time: 369.0534s
	iters: 400, epoch: 1 | loss: 1.1213458
	speed: 0.0171s/iter; left time: 354.6106s
	iters: 500, epoch: 1 | loss: 0.9062685
	speed: 0.0164s/iter; left time: 338.1503s
	iters: 600, epoch: 1 | loss: 0.6602588
	speed: 0.0167s/iter; left time: 343.1857s
	iters: 700, epoch: 1 | loss: 0.4858477
	speed: 0.0146s/iter; left time: 299.7261s
	iters: 800, epoch: 1 | loss: 0.4671695
	speed: 0.0156s/iter; left time: 317.9455s
	iters: 900, epoch: 1 | loss: 0.6438946
	speed: 0.0170s/iter; left time: 343.8756s
	iters: 1000, epoch: 1 | loss: 0.5053021
	speed: 0.0162s/iter; left time: 327.1803s
Epoch: 1 cost time: 17.469064950942993
Epoch: 1, Steps: 1059 | Train Loss: 0.6713451 Vali Loss: 0.4470859 Test Loss: 0.7390559
Validation loss decreased (inf --> 0.447086).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.3925775
	speed: 0.0656s/iter; left time: 1313.1374s
	iters: 200, epoch: 2 | loss: 0.6496584
	speed: 0.0161s/iter; left time: 320.3643s
	iters: 300, epoch: 2 | loss: 0.4694267
	speed: 0.0165s/iter; left time: 326.5952s
	iters: 400, epoch: 2 | loss: 0.4897862
	speed: 0.0168s/iter; left time: 330.8308s
	iters: 500, epoch: 2 | loss: 0.9245819
	speed: 0.0177s/iter; left time: 348.1336s
	iters: 600, epoch: 2 | loss: 0.7344204
	speed: 0.0173s/iter; left time: 336.8985s
	iters: 700, epoch: 2 | loss: 0.6492251
	speed: 0.0169s/iter; left time: 327.7688s
	iters: 800, epoch: 2 | loss: 0.6286428
	speed: 0.0172s/iter; left time: 332.4628s
	iters: 900, epoch: 2 | loss: 0.5888243
	speed: 0.0171s/iter; left time: 327.9730s
	iters: 1000, epoch: 2 | loss: 0.9545334
	speed: 0.0180s/iter; left time: 343.7234s
Epoch: 2 cost time: 17.887818813323975
Epoch: 2, Steps: 1059 | Train Loss: 0.6488456 Vali Loss: 0.5209725 Test Loss: 1.0386685
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.4761083
	speed: 0.0678s/iter; left time: 1286.3318s
	iters: 200, epoch: 3 | loss: 0.3052137
	speed: 0.0184s/iter; left time: 347.5350s
	iters: 300, epoch: 3 | loss: 0.3506961
	speed: 0.0181s/iter; left time: 340.3116s
	iters: 400, epoch: 3 | loss: 0.3883904
	speed: 0.0179s/iter; left time: 334.5202s
	iters: 500, epoch: 3 | loss: 0.3818350
	speed: 0.0169s/iter; left time: 313.8761s
	iters: 600, epoch: 3 | loss: 0.2974307
	speed: 0.0171s/iter; left time: 314.8870s
	iters: 700, epoch: 3 | loss: 0.3760850
	speed: 0.0154s/iter; left time: 282.4596s
	iters: 800, epoch: 3 | loss: 0.3504583
	speed: 0.0161s/iter; left time: 294.7245s
	iters: 900, epoch: 3 | loss: 0.3366191
	speed: 0.0135s/iter; left time: 245.4172s
	iters: 1000, epoch: 3 | loss: 0.5098161
	speed: 0.0157s/iter; left time: 282.9662s
Epoch: 3 cost time: 17.626243829727173
Epoch: 3, Steps: 1059 | Train Loss: 0.4628334 Vali Loss: 0.3512673 Test Loss: 0.6295394
Validation loss decreased (0.447086 --> 0.351267).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.2596439
	speed: 0.0652s/iter; left time: 1166.4575s
	iters: 200, epoch: 4 | loss: 0.4347920
	speed: 0.0169s/iter; left time: 300.4710s
	iters: 300, epoch: 4 | loss: 0.2753648
	speed: 0.0157s/iter; left time: 278.2593s
	iters: 400, epoch: 4 | loss: 0.2441048
	speed: 0.0165s/iter; left time: 290.6907s
	iters: 500, epoch: 4 | loss: 0.7005292
	speed: 0.0175s/iter; left time: 306.4217s
	iters: 600, epoch: 4 | loss: 0.2333282
	speed: 0.0172s/iter; left time: 299.0037s
	iters: 700, epoch: 4 | loss: 0.4322075
	speed: 0.0182s/iter; left time: 314.7847s
	iters: 800, epoch: 4 | loss: 0.3838779
	speed: 0.0172s/iter; left time: 295.0908s
	iters: 900, epoch: 4 | loss: 0.3027642
	speed: 0.0175s/iter; left time: 299.1088s
	iters: 1000, epoch: 4 | loss: 0.4939751
	speed: 0.0179s/iter; left time: 303.5855s
Epoch: 4 cost time: 18.060404539108276
Epoch: 4, Steps: 1059 | Train Loss: 0.4041356 Vali Loss: 0.3674518 Test Loss: 0.7372514
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.3017637
	speed: 0.0669s/iter; left time: 1126.8689s
	iters: 200, epoch: 5 | loss: 0.2613878
	speed: 0.0179s/iter; left time: 299.9919s
	iters: 300, epoch: 5 | loss: 0.6627297
	speed: 0.0170s/iter; left time: 283.7608s
	iters: 400, epoch: 5 | loss: 0.5580933
	speed: 0.0175s/iter; left time: 289.8902s
	iters: 500, epoch: 5 | loss: 0.5409437
	speed: 0.0177s/iter; left time: 291.8655s
	iters: 600, epoch: 5 | loss: 0.4727216
	speed: 0.0175s/iter; left time: 285.4316s
	iters: 700, epoch: 5 | loss: 0.1884887
	speed: 0.0172s/iter; left time: 278.8522s
	iters: 800, epoch: 5 | loss: 0.2709692
	speed: 0.0190s/iter; left time: 306.7857s
	iters: 900, epoch: 5 | loss: 0.3671795
	speed: 0.0179s/iter; left time: 287.1688s
	iters: 1000, epoch: 5 | loss: 0.2516616
	speed: 0.0154s/iter; left time: 245.3649s
Epoch: 5 cost time: 18.3451931476593
Epoch: 5, Steps: 1059 | Train Loss: 0.3788544 Vali Loss: 0.3865094 Test Loss: 0.8368513
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.1854624
	speed: 0.0635s/iter; left time: 1001.9377s
	iters: 200, epoch: 6 | loss: 0.4518098
	speed: 0.0169s/iter; left time: 264.8860s
	iters: 300, epoch: 6 | loss: 0.4232051
	speed: 0.0163s/iter; left time: 254.3404s
	iters: 400, epoch: 6 | loss: 0.3395341
	speed: 0.0176s/iter; left time: 272.9565s
	iters: 500, epoch: 6 | loss: 0.2713151
	speed: 0.0177s/iter; left time: 271.7469s
	iters: 600, epoch: 6 | loss: 0.4871613
	speed: 0.0163s/iter; left time: 248.9462s
	iters: 700, epoch: 6 | loss: 0.4369580
	speed: 0.0183s/iter; left time: 278.2814s
	iters: 800, epoch: 6 | loss: 0.3867111
	speed: 0.0185s/iter; left time: 279.2080s
	iters: 900, epoch: 6 | loss: 0.2876762
	speed: 0.0185s/iter; left time: 277.0262s
	iters: 1000, epoch: 6 | loss: 0.2347059
	speed: 0.0173s/iter; left time: 257.3799s
Epoch: 6 cost time: 18.35704517364502
Epoch: 6, Steps: 1059 | Train Loss: 0.3648901 Vali Loss: 0.2849446 Test Loss: 0.5115387
Validation loss decreased (0.351267 --> 0.284945).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.2855582
	speed: 0.0641s/iter; left time: 943.8965s
	iters: 200, epoch: 7 | loss: 0.2263694
	speed: 0.0157s/iter; left time: 230.2869s
	iters: 300, epoch: 7 | loss: 0.2677269
	speed: 0.0159s/iter; left time: 231.6639s
	iters: 400, epoch: 7 | loss: 0.4923215
	speed: 0.0161s/iter; left time: 231.9016s
	iters: 500, epoch: 7 | loss: 0.3352228
	speed: 0.0166s/iter; left time: 237.4912s
	iters: 600, epoch: 7 | loss: 0.2216844
	speed: 0.0177s/iter; left time: 251.3453s
	iters: 700, epoch: 7 | loss: 0.4656260
	speed: 0.0173s/iter; left time: 244.7795s
	iters: 800, epoch: 7 | loss: 0.2918404
	speed: 0.0177s/iter; left time: 247.7775s
	iters: 900, epoch: 7 | loss: 0.6025128
	speed: 0.0181s/iter; left time: 252.3418s
	iters: 1000, epoch: 7 | loss: 0.4174906
	speed: 0.0165s/iter; left time: 227.9565s
Epoch: 7 cost time: 17.799343824386597
Epoch: 7, Steps: 1059 | Train Loss: 0.3569768 Vali Loss: 0.2697744 Test Loss: 0.4679805
Validation loss decreased (0.284945 --> 0.269774).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.5009249
	speed: 0.0647s/iter; left time: 884.9133s
	iters: 200, epoch: 8 | loss: 0.5631225
	speed: 0.0174s/iter; left time: 236.7054s
	iters: 300, epoch: 8 | loss: 0.2978399
	speed: 0.0178s/iter; left time: 239.1182s
	iters: 400, epoch: 8 | loss: 0.2835016
	speed: 0.0165s/iter; left time: 221.1946s
	iters: 500, epoch: 8 | loss: 0.2720171
	speed: 0.0174s/iter; left time: 230.6334s
	iters: 600, epoch: 8 | loss: 0.2193021
	speed: 0.0171s/iter; left time: 225.1314s
	iters: 700, epoch: 8 | loss: 0.6249787
	speed: 0.0183s/iter; left time: 239.2504s
	iters: 800, epoch: 8 | loss: 0.1938478
	speed: 0.0177s/iter; left time: 229.5929s
	iters: 900, epoch: 8 | loss: 0.2990805
	speed: 0.0171s/iter; left time: 220.1151s
	iters: 1000, epoch: 8 | loss: 0.1950110
	speed: 0.0155s/iter; left time: 197.5639s
Epoch: 8 cost time: 17.84341049194336
Epoch: 8, Steps: 1059 | Train Loss: 0.3525842 Vali Loss: 0.2769687 Test Loss: 0.5114190
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.2517614
	speed: 0.0585s/iter; left time: 737.1717s
	iters: 200, epoch: 9 | loss: 0.2540020
	speed: 0.0164s/iter; left time: 205.1718s
	iters: 300, epoch: 9 | loss: 0.2844799
	speed: 0.0154s/iter; left time: 190.5755s
	iters: 400, epoch: 9 | loss: 0.2497476
	speed: 0.0155s/iter; left time: 190.3273s
	iters: 500, epoch: 9 | loss: 0.3121490
	speed: 0.0165s/iter; left time: 201.2702s
	iters: 600, epoch: 9 | loss: 0.2612850
	speed: 0.0169s/iter; left time: 204.1028s
	iters: 700, epoch: 9 | loss: 0.2949201
	speed: 0.0155s/iter; left time: 186.5518s
	iters: 800, epoch: 9 | loss: 0.1950412
	speed: 0.0180s/iter; left time: 214.0648s
	iters: 900, epoch: 9 | loss: 0.4212987
	speed: 0.0172s/iter; left time: 203.4286s
	iters: 1000, epoch: 9 | loss: 0.3732720
	speed: 0.0170s/iter; left time: 198.7126s
Epoch: 9 cost time: 17.356645822525024
Epoch: 9, Steps: 1059 | Train Loss: 0.3501635 Vali Loss: 0.2775564 Test Loss: 0.5161853
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.2624893
	speed: 0.0656s/iter; left time: 758.1060s
	iters: 200, epoch: 10 | loss: 0.3012263
	speed: 0.0163s/iter; left time: 186.2473s
	iters: 300, epoch: 10 | loss: 0.3243255
	speed: 0.0173s/iter; left time: 196.0308s
	iters: 400, epoch: 10 | loss: 0.4698345
	speed: 0.0171s/iter; left time: 191.9935s
	iters: 500, epoch: 10 | loss: 0.5242307
	speed: 0.0174s/iter; left time: 193.9696s
	iters: 600, epoch: 10 | loss: 0.5891720
	speed: 0.0186s/iter; left time: 205.3688s
	iters: 700, epoch: 10 | loss: 0.3343156
	speed: 0.0167s/iter; left time: 182.8955s
	iters: 800, epoch: 10 | loss: 0.4085969
	speed: 0.0187s/iter; left time: 202.4306s
	iters: 900, epoch: 10 | loss: 0.3497557
	speed: 0.0175s/iter; left time: 187.8580s
	iters: 1000, epoch: 10 | loss: 0.3762213
	speed: 0.0163s/iter; left time: 173.2102s
Epoch: 10 cost time: 18.24319362640381
Epoch: 10, Steps: 1059 | Train Loss: 0.3489773 Vali Loss: 0.2710312 Test Loss: 0.4906842
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.3492163
	speed: 0.0640s/iter; left time: 671.5685s
	iters: 200, epoch: 11 | loss: 0.2536377
	speed: 0.0162s/iter; left time: 168.2919s
	iters: 300, epoch: 11 | loss: 0.2969775
	speed: 0.0172s/iter; left time: 177.0668s
	iters: 400, epoch: 11 | loss: 0.2027764
	speed: 0.0151s/iter; left time: 153.3998s
	iters: 500, epoch: 11 | loss: 0.6269125
	speed: 0.0159s/iter; left time: 160.1619s
	iters: 600, epoch: 11 | loss: 0.3036518
	speed: 0.0151s/iter; left time: 150.8994s
	iters: 700, epoch: 11 | loss: 0.3257365
	speed: 0.0156s/iter; left time: 154.0546s
	iters: 800, epoch: 11 | loss: 0.3402827
	speed: 0.0158s/iter; left time: 154.9151s
	iters: 900, epoch: 11 | loss: 0.6268746
	speed: 0.0161s/iter; left time: 156.0616s
	iters: 1000, epoch: 11 | loss: 0.4669987
	speed: 0.0147s/iter; left time: 140.8051s
Epoch: 11 cost time: 16.625914812088013
Epoch: 11, Steps: 1059 | Train Loss: 0.3484413 Vali Loss: 0.2954025 Test Loss: 0.5674290
EarlyStopping counter: 4 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.1644087
	speed: 0.0598s/iter; left time: 564.0222s
	iters: 200, epoch: 12 | loss: 0.2841519
	speed: 0.0150s/iter; left time: 140.2013s
	iters: 300, epoch: 12 | loss: 0.1829876
	speed: 0.0152s/iter; left time: 140.6123s
	iters: 400, epoch: 12 | loss: 0.2192780
	speed: 0.0161s/iter; left time: 147.3555s
	iters: 500, epoch: 12 | loss: 0.4108396
	speed: 0.0153s/iter; left time: 137.9396s
	iters: 600, epoch: 12 | loss: 0.2423414
	speed: 0.0156s/iter; left time: 139.0505s
	iters: 700, epoch: 12 | loss: 0.3969343
	speed: 0.0167s/iter; left time: 147.1115s
	iters: 800, epoch: 12 | loss: 0.6705059
	speed: 0.0162s/iter; left time: 141.7201s
	iters: 900, epoch: 12 | loss: 0.4604587
	speed: 0.0161s/iter; left time: 138.8396s
	iters: 1000, epoch: 12 | loss: 0.3207533
	speed: 0.0157s/iter; left time: 134.3165s
Epoch: 12 cost time: 16.68836498260498
Epoch: 12, Steps: 1059 | Train Loss: 0.3481190 Vali Loss: 0.2785881 Test Loss: 0.5155879
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTm2_336_336_DLinear_ETTm2_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed25565<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
mse:0.46840623021125793, mae:0.4581194221973419
