Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='exchange_rate.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=8, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='mse', lradj='type1', model='NLinear', model_id='Exchange_336_720', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=720, root_path='./dataset/', save_pred_values=False, seed=12890, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : Exchange_336_720_NLinear_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed12890>>>>>>>>>>>>>>>>>>>>>>>>>>
train 4256
val 41
test 798
	iters: 100, epoch: 1 | loss: 0.6917266
	speed: 0.0221s/iter; left time: 56.5420s
Epoch: 1 cost time: 2.9342575073242188
Epoch: 1, Steps: 133 | Train Loss: 0.7887059 Vali Loss: 1.2860168 Test Loss: 0.9487321
Validation loss decreased (inf --> 1.286017).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.7979726
	speed: 0.0309s/iter; left time: 75.0539s
Epoch: 2 cost time: 2.8794758319854736
Epoch: 2, Steps: 133 | Train Loss: 0.7682367 Vali Loss: 1.2423402 Test Loss: 0.9922927
Validation loss decreased (1.286017 --> 1.242340).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.7435466
	speed: 0.0306s/iter; left time: 70.2133s
Epoch: 3 cost time: 2.9394633769989014
Epoch: 3, Steps: 133 | Train Loss: 0.7603453 Vali Loss: 1.1876539 Test Loss: 0.9587712
Validation loss decreased (1.242340 --> 1.187654).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.7220249
	speed: 0.0315s/iter; left time: 68.1948s
Epoch: 4 cost time: 2.82592511177063
Epoch: 4, Steps: 133 | Train Loss: 0.7573734 Vali Loss: 1.2339694 Test Loss: 0.9649495
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.7300469
	speed: 0.0316s/iter; left time: 64.0632s
Epoch: 5 cost time: 3.043032646179199
Epoch: 5, Steps: 133 | Train Loss: 0.7557807 Vali Loss: 1.2142547 Test Loss: 0.9795461
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.7915770
	speed: 0.0316s/iter; left time: 59.8308s
Epoch: 6 cost time: 2.9099619388580322
Epoch: 6, Steps: 133 | Train Loss: 0.7550078 Vali Loss: 1.2243419 Test Loss: 0.9739743
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.6987109
	speed: 0.0290s/iter; left time: 51.2061s
Epoch: 7 cost time: 2.8142929077148438
Epoch: 7, Steps: 133 | Train Loss: 0.7546350 Vali Loss: 1.1820711 Test Loss: 0.9792117
Validation loss decreased (1.187654 --> 1.182071).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.8184853
	speed: 0.0296s/iter; left time: 48.2270s
Epoch: 8 cost time: 2.6944730281829834
Epoch: 8, Steps: 133 | Train Loss: 0.7543430 Vali Loss: 1.2426056 Test Loss: 0.9810734
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.7767310
	speed: 0.0287s/iter; left time: 42.9512s
Epoch: 9 cost time: 2.5673093795776367
Epoch: 9, Steps: 133 | Train Loss: 0.7542339 Vali Loss: 1.2207845 Test Loss: 0.9811010
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.7275443
	speed: 0.0281s/iter; left time: 38.3034s
Epoch: 10 cost time: 2.690694570541382
Epoch: 10, Steps: 133 | Train Loss: 0.7541571 Vali Loss: 1.1905729 Test Loss: 0.9814745
EarlyStopping counter: 3 out of 5
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 11 | loss: 0.8621978
	speed: 0.0289s/iter; left time: 35.5657s
Epoch: 11 cost time: 2.5972936153411865
Epoch: 11, Steps: 133 | Train Loss: 0.7541254 Vali Loss: 1.2214437 Test Loss: 0.9816777
EarlyStopping counter: 4 out of 5
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 12 | loss: 0.6830727
	speed: 0.0259s/iter; left time: 28.4215s
Epoch: 12 cost time: 2.3818304538726807
Epoch: 12, Steps: 133 | Train Loss: 0.7541085 Vali Loss: 1.2193930 Test Loss: 0.9816315
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : Exchange_336_720_NLinear_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed12890<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 798
mse:0.9805841445922852, mae:0.7255527377128601
