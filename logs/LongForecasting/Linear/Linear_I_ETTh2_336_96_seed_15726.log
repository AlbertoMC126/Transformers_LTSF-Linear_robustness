Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTh2', data_path='ETTh2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.05, loss='mse', lradj='type1', model='Linear', model_id='ETTh2_336_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=15726, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTh2_336_96_Linear_ETTh2_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15726>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 10.6645079
	speed: 0.0031s/iter; left time: 31.8041s
	iters: 200, epoch: 1 | loss: 3.1993206
	speed: 0.0032s/iter; left time: 32.4970s
	iters: 300, epoch: 1 | loss: 12.1523409
	speed: 0.0034s/iter; left time: 33.7979s
	iters: 400, epoch: 1 | loss: 6.4960923
	speed: 0.0030s/iter; left time: 29.2873s
	iters: 500, epoch: 1 | loss: 4.8578424
	speed: 0.0034s/iter; left time: 32.7043s
Epoch: 1 cost time: 1.6513545513153076
Epoch: 1, Steps: 513 | Train Loss: 7.3566787 Vali Loss: 4.7265286 Test Loss: 17.1535072
Validation loss decreased (inf --> 4.726529).  Saving model ...
Updating learning rate to 0.05
	iters: 100, epoch: 2 | loss: 2.1972630
	speed: 0.0067s/iter; left time: 64.1836s
	iters: 200, epoch: 2 | loss: 4.2331443
	speed: 0.0024s/iter; left time: 22.8195s
	iters: 300, epoch: 2 | loss: 15.1946268
	speed: 0.0030s/iter; left time: 28.2829s
	iters: 400, epoch: 2 | loss: 6.2493215
	speed: 0.0032s/iter; left time: 29.6333s
	iters: 500, epoch: 2 | loss: 3.5065548
	speed: 0.0030s/iter; left time: 27.6516s
Epoch: 2 cost time: 1.4903523921966553
Epoch: 2, Steps: 513 | Train Loss: 9.1941224 Vali Loss: 4.0783882 Test Loss: 8.5883188
Validation loss decreased (4.726529 --> 4.078388).  Saving model ...
Updating learning rate to 0.025
	iters: 100, epoch: 3 | loss: 0.6558589
	speed: 0.0067s/iter; left time: 60.8572s
	iters: 200, epoch: 3 | loss: 1.0425496
	speed: 0.0035s/iter; left time: 31.8932s
	iters: 300, epoch: 3 | loss: 0.5847456
	speed: 0.0035s/iter; left time: 30.8477s
	iters: 400, epoch: 3 | loss: 1.3000187
	speed: 0.0035s/iter; left time: 31.1877s
	iters: 500, epoch: 3 | loss: 0.9158216
	speed: 0.0034s/iter; left time: 29.7107s
Epoch: 3 cost time: 1.7394390106201172
Epoch: 3, Steps: 513 | Train Loss: 1.3235132 Vali Loss: 0.6836793 Test Loss: 1.4421575
Validation loss decreased (4.078388 --> 0.683679).  Saving model ...
Updating learning rate to 0.0125
	iters: 100, epoch: 4 | loss: 0.2719572
	speed: 0.0061s/iter; left time: 52.3582s
	iters: 200, epoch: 4 | loss: 0.4190320
	speed: 0.0035s/iter; left time: 29.7418s
	iters: 300, epoch: 4 | loss: 0.2007399
	speed: 0.0031s/iter; left time: 26.1328s
	iters: 400, epoch: 4 | loss: 0.8765889
	speed: 0.0028s/iter; left time: 23.3849s
	iters: 500, epoch: 4 | loss: 0.2564284
	speed: 0.0032s/iter; left time: 26.4750s
Epoch: 4 cost time: 1.5932953357696533
Epoch: 4, Steps: 513 | Train Loss: 0.5117945 Vali Loss: 0.5493304 Test Loss: 1.3452846
Validation loss decreased (0.683679 --> 0.549330).  Saving model ...
Updating learning rate to 0.00625
	iters: 100, epoch: 5 | loss: 0.3214853
	speed: 0.0070s/iter; left time: 56.8576s
	iters: 200, epoch: 5 | loss: 0.3125246
	speed: 0.0029s/iter; left time: 23.2262s
	iters: 300, epoch: 5 | loss: 0.9618548
	speed: 0.0028s/iter; left time: 22.3825s
	iters: 400, epoch: 5 | loss: 0.3714596
	speed: 0.0029s/iter; left time: 22.5824s
	iters: 500, epoch: 5 | loss: 0.2579301
	speed: 0.0029s/iter; left time: 22.1248s
Epoch: 5 cost time: 1.5203640460968018
Epoch: 5, Steps: 513 | Train Loss: 0.4393262 Vali Loss: 0.4947161 Test Loss: 1.1396519
Validation loss decreased (0.549330 --> 0.494716).  Saving model ...
Updating learning rate to 0.003125
	iters: 100, epoch: 6 | loss: 0.4198892
	speed: 0.0064s/iter; left time: 48.8624s
	iters: 200, epoch: 6 | loss: 0.2820543
	speed: 0.0029s/iter; left time: 21.8134s
	iters: 300, epoch: 6 | loss: 0.3775620
	speed: 0.0026s/iter; left time: 19.3697s
	iters: 400, epoch: 6 | loss: 0.2986844
	speed: 0.0033s/iter; left time: 23.8579s
	iters: 500, epoch: 6 | loss: 0.2418522
	speed: 0.0028s/iter; left time: 19.8761s
Epoch: 6 cost time: 1.5333435535430908
Epoch: 6, Steps: 513 | Train Loss: 0.4048352 Vali Loss: 0.4094744 Test Loss: 0.6388516
Validation loss decreased (0.494716 --> 0.409474).  Saving model ...
Updating learning rate to 0.0015625
	iters: 100, epoch: 7 | loss: 0.4945810
	speed: 0.0067s/iter; left time: 47.3854s
	iters: 200, epoch: 7 | loss: 0.2460218
	speed: 0.0029s/iter; left time: 20.5444s
	iters: 300, epoch: 7 | loss: 0.4452027
	speed: 0.0030s/iter; left time: 20.5838s
	iters: 400, epoch: 7 | loss: 0.2740267
	speed: 0.0035s/iter; left time: 23.7403s
	iters: 500, epoch: 7 | loss: 0.1907914
	speed: 0.0030s/iter; left time: 19.8603s
Epoch: 7 cost time: 1.5754337310791016
Epoch: 7, Steps: 513 | Train Loss: 0.3833131 Vali Loss: 0.3540117 Test Loss: 0.5675544
Validation loss decreased (0.409474 --> 0.354012).  Saving model ...
Updating learning rate to 0.00078125
	iters: 100, epoch: 8 | loss: 0.5683093
	speed: 0.0069s/iter; left time: 45.4674s
	iters: 200, epoch: 8 | loss: 0.2657119
	speed: 0.0026s/iter; left time: 16.8390s
	iters: 300, epoch: 8 | loss: 0.3680684
	speed: 0.0036s/iter; left time: 23.1230s
	iters: 400, epoch: 8 | loss: 0.2413032
	speed: 0.0037s/iter; left time: 22.8857s
	iters: 500, epoch: 8 | loss: 0.3031688
	speed: 0.0029s/iter; left time: 18.0930s
Epoch: 8 cost time: 1.5895988941192627
Epoch: 8, Steps: 513 | Train Loss: 0.3732321 Vali Loss: 0.2852765 Test Loss: 0.4211836
Validation loss decreased (0.354012 --> 0.285277).  Saving model ...
Updating learning rate to 0.000390625
	iters: 100, epoch: 9 | loss: 0.2753051
	speed: 0.0053s/iter; left time: 32.2867s
	iters: 200, epoch: 9 | loss: 0.3210764
	speed: 0.0024s/iter; left time: 14.5945s
	iters: 300, epoch: 9 | loss: 0.2388916
	speed: 0.0028s/iter; left time: 16.4734s
	iters: 400, epoch: 9 | loss: 0.3363163
	speed: 0.0026s/iter; left time: 14.8656s
	iters: 500, epoch: 9 | loss: 0.7537910
	speed: 0.0026s/iter; left time: 14.7648s
Epoch: 9 cost time: 1.3204782009124756
Epoch: 9, Steps: 513 | Train Loss: 0.3667616 Vali Loss: 0.2944807 Test Loss: 0.4946767
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0001953125
	iters: 100, epoch: 10 | loss: 0.6144269
	speed: 0.0062s/iter; left time: 34.4733s
	iters: 200, epoch: 10 | loss: 0.4110007
	speed: 0.0035s/iter; left time: 18.9452s
	iters: 300, epoch: 10 | loss: 0.4309385
	speed: 0.0032s/iter; left time: 17.0050s
	iters: 400, epoch: 10 | loss: 0.5102836
	speed: 0.0027s/iter; left time: 14.2113s
	iters: 500, epoch: 10 | loss: 0.3265580
	speed: 0.0033s/iter; left time: 16.8208s
Epoch: 10 cost time: 1.6388285160064697
Epoch: 10, Steps: 513 | Train Loss: 0.3632793 Vali Loss: 0.2826169 Test Loss: 0.4035662
Validation loss decreased (0.285277 --> 0.282617).  Saving model ...
Updating learning rate to 9.765625e-05
	iters: 100, epoch: 11 | loss: 0.2412285
	speed: 0.0073s/iter; left time: 36.7918s
	iters: 200, epoch: 11 | loss: 0.5020686
	speed: 0.0033s/iter; left time: 16.1242s
	iters: 300, epoch: 11 | loss: 0.2100264
	speed: 0.0034s/iter; left time: 16.1988s
	iters: 400, epoch: 11 | loss: 0.1855027
	speed: 0.0032s/iter; left time: 15.2812s
	iters: 500, epoch: 11 | loss: 0.3973691
	speed: 0.0034s/iter; left time: 15.8000s
Epoch: 11 cost time: 1.6845715045928955
Epoch: 11, Steps: 513 | Train Loss: 0.3605445 Vali Loss: 0.2842458 Test Loss: 0.4274228
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.8828125e-05
	iters: 100, epoch: 12 | loss: 0.5223186
	speed: 0.0071s/iter; left time: 32.1309s
	iters: 200, epoch: 12 | loss: 0.6412082
	speed: 0.0034s/iter; left time: 14.9771s
	iters: 300, epoch: 12 | loss: 0.5742467
	speed: 0.0034s/iter; left time: 14.5649s
	iters: 400, epoch: 12 | loss: 0.2791326
	speed: 0.0031s/iter; left time: 13.0336s
	iters: 500, epoch: 12 | loss: 0.1646776
	speed: 0.0028s/iter; left time: 11.4892s
Epoch: 12 cost time: 1.6423072814941406
Epoch: 12, Steps: 513 | Train Loss: 0.3593698 Vali Loss: 0.2843096 Test Loss: 0.4281310
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.44140625e-05
	iters: 100, epoch: 13 | loss: 0.4384141
	speed: 0.0059s/iter; left time: 23.7523s
	iters: 200, epoch: 13 | loss: 0.2641143
	speed: 0.0032s/iter; left time: 12.4961s
	iters: 300, epoch: 13 | loss: 0.2230227
	speed: 0.0036s/iter; left time: 13.8120s
	iters: 400, epoch: 13 | loss: 0.1741711
	speed: 0.0037s/iter; left time: 13.6406s
	iters: 500, epoch: 13 | loss: 0.5724128
	speed: 0.0036s/iter; left time: 13.1222s
Epoch: 13 cost time: 1.7472317218780518
Epoch: 13, Steps: 513 | Train Loss: 0.3584985 Vali Loss: 0.2828449 Test Loss: 0.4236401
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.220703125e-05
	iters: 100, epoch: 14 | loss: 0.6491351
	speed: 0.0073s/iter; left time: 25.5743s
	iters: 200, epoch: 14 | loss: 0.2054157
	speed: 0.0032s/iter; left time: 10.9901s
	iters: 300, epoch: 14 | loss: 0.4692657
	speed: 0.0033s/iter; left time: 10.7706s
	iters: 400, epoch: 14 | loss: 0.8820447
	speed: 0.0033s/iter; left time: 10.5350s
	iters: 500, epoch: 14 | loss: 0.2839226
	speed: 0.0033s/iter; left time: 10.1108s
Epoch: 14 cost time: 1.675218105316162
Epoch: 14, Steps: 513 | Train Loss: 0.3580328 Vali Loss: 0.2860549 Test Loss: 0.4331245
EarlyStopping counter: 4 out of 5
Updating learning rate to 6.103515625e-06
	iters: 100, epoch: 15 | loss: 0.1403684
	speed: 0.0069s/iter; left time: 20.5424s
	iters: 200, epoch: 15 | loss: 0.3937843
	speed: 0.0032s/iter; left time: 9.1265s
	iters: 300, epoch: 15 | loss: 0.2130106
	speed: 0.0035s/iter; left time: 9.6505s
	iters: 400, epoch: 15 | loss: 0.2122419
	speed: 0.0031s/iter; left time: 8.3585s
	iters: 500, epoch: 15 | loss: 0.3631571
	speed: 0.0033s/iter; left time: 8.5107s
Epoch: 15 cost time: 1.6856591701507568
Epoch: 15, Steps: 513 | Train Loss: 0.3577253 Vali Loss: 0.2863689 Test Loss: 0.4354037
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTh2_336_96_Linear_ETTh2_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15726<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.40505555272102356, mae:0.4227711856365204
