Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTh2', data_path='ETTh2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='DLinear', model_id='ETTh2_336_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=336, root_path='./dataset/', save_pred_values=False, seed=15726, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTh2_336_336_DLinear_ETTh2_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15726>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7969
val 2545
test 2545
Total number of trainable parameters: 1585248
Total number of parameters: 1585248
	iters: 100, epoch: 1 | loss: 0.7620003
	speed: 0.0286s/iter; left time: 139.7363s
	iters: 200, epoch: 1 | loss: 0.6293694
	speed: 0.0275s/iter; left time: 131.4365s
Epoch: 1 cost time: 7.060049772262573
Epoch: 1, Steps: 249 | Train Loss: 0.6811599 Vali Loss: 0.5201408 Test Loss: 0.6804346
Validation loss decreased (inf --> 0.520141).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.4226994
	speed: 0.0540s/iter; left time: 250.2980s
	iters: 200, epoch: 2 | loss: 0.9932812
	speed: 0.0306s/iter; left time: 138.4597s
Epoch: 2 cost time: 7.412770748138428
Epoch: 2, Steps: 249 | Train Loss: 0.6709514 Vali Loss: 0.5944208 Test Loss: 1.3282688
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.9131706
	speed: 0.0531s/iter; left time: 232.9389s
	iters: 200, epoch: 3 | loss: 0.4856246
	speed: 0.0320s/iter; left time: 136.8544s
Epoch: 3 cost time: 7.415829181671143
Epoch: 3, Steps: 249 | Train Loss: 0.5781700 Vali Loss: 0.5941473 Test Loss: 1.0935428
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.4751795
	speed: 0.0524s/iter; left time: 216.5369s
	iters: 200, epoch: 4 | loss: 0.6977264
	speed: 0.0301s/iter; left time: 121.4789s
Epoch: 4 cost time: 7.162103891372681
Epoch: 4, Steps: 249 | Train Loss: 0.5470157 Vali Loss: 0.5319588 Test Loss: 0.8937212
EarlyStopping counter: 3 out of 5
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.4066607
	speed: 0.0520s/iter; left time: 202.0858s
	iters: 200, epoch: 5 | loss: 0.6128137
	speed: 0.0300s/iter; left time: 113.5552s
Epoch: 5 cost time: 7.216429948806763
Epoch: 5, Steps: 249 | Train Loss: 0.5298927 Vali Loss: 0.4907407 Test Loss: 0.7467051
Validation loss decreased (0.520141 --> 0.490741).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.5906978
	speed: 0.0562s/iter; left time: 204.2681s
	iters: 200, epoch: 6 | loss: 0.2639301
	speed: 0.0293s/iter; left time: 103.7422s
Epoch: 6 cost time: 7.150949001312256
Epoch: 6, Steps: 249 | Train Loss: 0.5209150 Vali Loss: 0.5010213 Test Loss: 0.7536727
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.3353736
	speed: 0.0532s/iter; left time: 180.2508s
	iters: 200, epoch: 7 | loss: 0.5423979
	speed: 0.0302s/iter; left time: 99.2334s
Epoch: 7 cost time: 7.198501825332642
Epoch: 7, Steps: 249 | Train Loss: 0.5169099 Vali Loss: 0.4749907 Test Loss: 0.7103938
Validation loss decreased (0.490741 --> 0.474991).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.5114074
	speed: 0.0538s/iter; left time: 168.7926s
	iters: 200, epoch: 8 | loss: 0.4810468
	speed: 0.0273s/iter; left time: 82.9468s
Epoch: 8 cost time: 6.614835739135742
Epoch: 8, Steps: 249 | Train Loss: 0.5140474 Vali Loss: 0.4834299 Test Loss: 0.7265428
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.8600141
	speed: 0.0484s/iter; left time: 139.6880s
	iters: 200, epoch: 9 | loss: 0.7583870
	speed: 0.0273s/iter; left time: 76.1727s
Epoch: 9 cost time: 6.585213899612427
Epoch: 9, Steps: 249 | Train Loss: 0.5127304 Vali Loss: 0.4760228 Test Loss: 0.6785971
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.7081988
	speed: 0.0482s/iter; left time: 127.3600s
	iters: 200, epoch: 10 | loss: 0.7896769
	speed: 0.0267s/iter; left time: 67.7472s
Epoch: 10 cost time: 6.486720561981201
Epoch: 10, Steps: 249 | Train Loss: 0.5119269 Vali Loss: 0.4835109 Test Loss: 0.7244498
EarlyStopping counter: 3 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.4365770
	speed: 0.0435s/iter; left time: 104.0627s
	iters: 200, epoch: 11 | loss: 0.4810735
	speed: 0.0180s/iter; left time: 41.1992s
Epoch: 11 cost time: 4.641390085220337
Epoch: 11, Steps: 249 | Train Loss: 0.5114338 Vali Loss: 0.4812332 Test Loss: 0.7088971
EarlyStopping counter: 4 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.3625625
	speed: 0.0277s/iter; left time: 59.4046s
	iters: 200, epoch: 12 | loss: 0.6357683
	speed: 0.0122s/iter; left time: 24.8265s
Epoch: 12 cost time: 3.1610770225524902
Epoch: 12, Steps: 249 | Train Loss: 0.5113087 Vali Loss: 0.4800014 Test Loss: 0.7058147
EarlyStopping counter: 5 out of 5
Early stopping
Total training time: 90.2546 seconds
>>>>>>>testing : ETTh2_336_336_DLinear_ETTh2_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15726<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2545
mse:0.7083866000175476, mae:0.5598477721214294
