Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='Linear', model_id='traffic_336_720', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=720, root_path='./dataset/', save_pred_values=False, seed=15227, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_336_720_Linear_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15227>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11225
val 1037
test 2789
	iters: 100, epoch: 1 | loss: 0.4696296
	speed: 0.3485s/iter; left time: 4850.8761s
	iters: 200, epoch: 1 | loss: 0.4949112
	speed: 0.3310s/iter; left time: 4575.1241s
	iters: 300, epoch: 1 | loss: 0.5101968
	speed: 0.3320s/iter; left time: 4555.1706s
	iters: 400, epoch: 1 | loss: 0.4912241
	speed: 0.3331s/iter; left time: 4536.5354s
	iters: 500, epoch: 1 | loss: 0.5370225
	speed: 0.3340s/iter; left time: 4515.6977s
	iters: 600, epoch: 1 | loss: 0.5263216
	speed: 0.3329s/iter; left time: 4467.5746s
	iters: 700, epoch: 1 | loss: 0.4918906
	speed: 0.3334s/iter; left time: 4441.1914s
Epoch: 1 cost time: 235.03690433502197
Epoch: 1, Steps: 701 | Train Loss: 0.5149362 Vali Loss: 0.6904490 Test Loss: 0.8041293
Validation loss decreased (inf --> 0.690449).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.4774852
	speed: 0.6276s/iter; left time: 8297.4554s
	iters: 200, epoch: 2 | loss: 0.5236550
	speed: 0.3327s/iter; left time: 4364.5359s
	iters: 300, epoch: 2 | loss: 0.5068706
	speed: 0.3331s/iter; left time: 4337.5952s
	iters: 400, epoch: 2 | loss: 0.4846126
	speed: 0.3318s/iter; left time: 4287.2373s
	iters: 500, epoch: 2 | loss: 0.5270811
	speed: 0.3325s/iter; left time: 4262.1233s
	iters: 600, epoch: 2 | loss: 0.5287040
	speed: 0.3324s/iter; left time: 4228.0367s
	iters: 700, epoch: 2 | loss: 0.5135276
	speed: 0.3312s/iter; left time: 4180.1726s
Epoch: 2 cost time: 233.6646866798401
Epoch: 2, Steps: 701 | Train Loss: 0.5060429 Vali Loss: 0.6881515 Test Loss: 0.8072329
Validation loss decreased (0.690449 --> 0.688152).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.3422928
	speed: 0.6233s/iter; left time: 7802.6228s
	iters: 200, epoch: 3 | loss: 0.3310113
	speed: 0.3336s/iter; left time: 4143.4455s
	iters: 300, epoch: 3 | loss: 0.3497065
	speed: 0.3317s/iter; left time: 4086.3795s
	iters: 400, epoch: 3 | loss: 0.3652172
	speed: 0.3327s/iter; left time: 4065.2700s
	iters: 500, epoch: 3 | loss: 0.3625342
	speed: 0.3312s/iter; left time: 4013.5894s
	iters: 600, epoch: 3 | loss: 0.3608663
	speed: 0.3330s/iter; left time: 4002.5525s
	iters: 700, epoch: 3 | loss: 0.3587928
	speed: 0.3333s/iter; left time: 3972.6279s
Epoch: 3 cost time: 233.28556418418884
Epoch: 3, Steps: 701 | Train Loss: 0.3611810 Vali Loss: 0.5253326 Test Loss: 0.6111058
Validation loss decreased (0.688152 --> 0.525333).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.2986633
	speed: 0.6280s/iter; left time: 7421.4929s
	iters: 200, epoch: 4 | loss: 0.3164691
	speed: 0.3354s/iter; left time: 3930.3327s
	iters: 300, epoch: 4 | loss: 0.3389173
	speed: 0.3333s/iter; left time: 3872.2319s
	iters: 400, epoch: 4 | loss: 0.3147905
	speed: 0.3349s/iter; left time: 3856.9582s
	iters: 500, epoch: 4 | loss: 0.2982053
	speed: 0.3334s/iter; left time: 3806.7425s
	iters: 600, epoch: 4 | loss: 0.2861917
	speed: 0.3331s/iter; left time: 3769.9822s
	iters: 700, epoch: 4 | loss: 0.2716556
	speed: 0.3335s/iter; left time: 3741.1515s
Epoch: 4 cost time: 234.39287734031677
Epoch: 4, Steps: 701 | Train Loss: 0.3121229 Vali Loss: 0.4656404 Test Loss: 0.5371802
Validation loss decreased (0.525333 --> 0.465640).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.2895412
	speed: 0.6252s/iter; left time: 6950.7234s
	iters: 200, epoch: 5 | loss: 0.2937075
	speed: 0.3339s/iter; left time: 3678.7592s
	iters: 300, epoch: 5 | loss: 0.2867105
	speed: 0.3326s/iter; left time: 3630.9312s
	iters: 400, epoch: 5 | loss: 0.2929710
	speed: 0.3334s/iter; left time: 3606.1393s
	iters: 500, epoch: 5 | loss: 0.2755809
	speed: 0.3333s/iter; left time: 3571.5282s
	iters: 600, epoch: 5 | loss: 0.3010155
	speed: 0.3334s/iter; left time: 3539.4320s
	iters: 700, epoch: 5 | loss: 0.2970969
	speed: 0.3336s/iter; left time: 3507.9776s
Epoch: 5 cost time: 233.77120161056519
Epoch: 5, Steps: 701 | Train Loss: 0.2902738 Vali Loss: 0.4412684 Test Loss: 0.5086703
Validation loss decreased (0.465640 --> 0.441268).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.2599678
	speed: 0.6286s/iter; left time: 6547.8929s
	iters: 200, epoch: 6 | loss: 0.2608261
	speed: 0.3368s/iter; left time: 3474.6236s
	iters: 300, epoch: 6 | loss: 0.2554311
	speed: 0.3334s/iter; left time: 3406.4021s
	iters: 400, epoch: 6 | loss: 0.2541927
	speed: 0.3325s/iter; left time: 3363.8107s
	iters: 500, epoch: 6 | loss: 0.2917028
	speed: 0.3332s/iter; left time: 3337.6450s
	iters: 600, epoch: 6 | loss: 0.2603452
	speed: 0.3331s/iter; left time: 3302.8317s
	iters: 700, epoch: 6 | loss: 0.2819970
	speed: 0.3337s/iter; left time: 3275.5735s
Epoch: 6 cost time: 234.5502209663391
Epoch: 6, Steps: 701 | Train Loss: 0.2788882 Vali Loss: 0.4314017 Test Loss: 0.4960218
Validation loss decreased (0.441268 --> 0.431402).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.2813199
	speed: 0.6240s/iter; left time: 6061.9910s
	iters: 200, epoch: 7 | loss: 0.2649276
	speed: 0.3361s/iter; left time: 3231.3415s
	iters: 300, epoch: 7 | loss: 0.2678275
	speed: 0.3329s/iter; left time: 3167.5979s
	iters: 400, epoch: 7 | loss: 0.2629952
	speed: 0.3334s/iter; left time: 3139.3877s
	iters: 500, epoch: 7 | loss: 0.2466806
	speed: 0.3333s/iter; left time: 3104.2751s
	iters: 600, epoch: 7 | loss: 0.2467653
	speed: 0.3334s/iter; left time: 3072.3925s
	iters: 700, epoch: 7 | loss: 0.2681718
	speed: 0.3333s/iter; left time: 3037.8765s
Epoch: 7 cost time: 234.11684560775757
Epoch: 7, Steps: 701 | Train Loss: 0.2727378 Vali Loss: 0.4255857 Test Loss: 0.4899259
Validation loss decreased (0.431402 --> 0.425586).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.2503600
	speed: 0.6284s/iter; left time: 5664.8027s
	iters: 200, epoch: 8 | loss: 0.2893425
	speed: 0.3395s/iter; left time: 3026.1371s
	iters: 300, epoch: 8 | loss: 0.2744096
	speed: 0.3355s/iter; left time: 2957.3191s
	iters: 400, epoch: 8 | loss: 0.2540989
	speed: 0.3339s/iter; left time: 2909.7668s
	iters: 500, epoch: 8 | loss: 0.2709617
	speed: 0.3333s/iter; left time: 2871.1479s
	iters: 600, epoch: 8 | loss: 0.2506956
	speed: 0.3339s/iter; left time: 2842.5646s
	iters: 700, epoch: 8 | loss: 0.2524963
	speed: 0.3342s/iter; left time: 2811.7319s
Epoch: 8 cost time: 235.27049612998962
Epoch: 8, Steps: 701 | Train Loss: 0.2693613 Vali Loss: 0.4226798 Test Loss: 0.4862502
Validation loss decreased (0.425586 --> 0.422680).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.2459811
	speed: 0.6236s/iter; left time: 5183.5919s
	iters: 200, epoch: 9 | loss: 0.2534861
	speed: 0.3346s/iter; left time: 2748.3247s
	iters: 300, epoch: 9 | loss: 0.2477183
	speed: 0.3342s/iter; left time: 2711.2384s
	iters: 400, epoch: 9 | loss: 0.2762998
	speed: 0.3322s/iter; left time: 2661.7367s
	iters: 500, epoch: 9 | loss: 0.2639556
	speed: 0.3331s/iter; left time: 2635.5361s
	iters: 600, epoch: 9 | loss: 0.2851360
	speed: 0.3336s/iter; left time: 2606.1150s
	iters: 700, epoch: 9 | loss: 0.2584263
	speed: 0.3335s/iter; left time: 2572.0590s
Epoch: 9 cost time: 234.16812705993652
Epoch: 9, Steps: 701 | Train Loss: 0.2674964 Vali Loss: 0.4209351 Test Loss: 0.4843250
Validation loss decreased (0.422680 --> 0.420935).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.2787770
	speed: 0.6202s/iter; left time: 4720.6279s
	iters: 200, epoch: 10 | loss: 0.2752047
	speed: 0.3337s/iter; left time: 2507.1273s
	iters: 300, epoch: 10 | loss: 0.2854742
	speed: 0.3329s/iter; left time: 2467.4698s
	iters: 400, epoch: 10 | loss: 0.2605108
	speed: 0.3331s/iter; left time: 2435.4710s
	iters: 500, epoch: 10 | loss: 0.2797056
	speed: 0.3334s/iter; left time: 2404.4572s
	iters: 600, epoch: 10 | loss: 0.2533629
	speed: 0.3334s/iter; left time: 2371.3889s
	iters: 700, epoch: 10 | loss: 0.2436204
	speed: 0.3343s/iter; left time: 2343.8051s
Epoch: 10 cost time: 233.74224758148193
Epoch: 10, Steps: 701 | Train Loss: 0.2664861 Vali Loss: 0.4202685 Test Loss: 0.4835316
Validation loss decreased (0.420935 --> 0.420269).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.2569163
	speed: 0.6272s/iter; left time: 4334.8422s
	iters: 200, epoch: 11 | loss: 0.2770320
	speed: 0.3375s/iter; left time: 2298.6259s
	iters: 300, epoch: 11 | loss: 0.2508609
	speed: 0.3354s/iter; left time: 2251.0983s
	iters: 400, epoch: 11 | loss: 0.2769722
	speed: 0.3331s/iter; left time: 2202.2193s
	iters: 500, epoch: 11 | loss: 0.2482688
	speed: 0.3324s/iter; left time: 2164.4780s
	iters: 600, epoch: 11 | loss: 0.2657889
	speed: 0.3343s/iter; left time: 2143.4098s
	iters: 700, epoch: 11 | loss: 0.2768361
	speed: 0.3324s/iter; left time: 2097.9646s
Epoch: 11 cost time: 234.8481171131134
Epoch: 11, Steps: 701 | Train Loss: 0.2659374 Vali Loss: 0.4200687 Test Loss: 0.4832626
Validation loss decreased (0.420269 --> 0.420069).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.2724802
	speed: 0.6240s/iter; left time: 3874.7445s
	iters: 200, epoch: 12 | loss: 0.2742572
	speed: 0.3341s/iter; left time: 2041.4777s
	iters: 300, epoch: 12 | loss: 0.2581436
	speed: 0.3338s/iter; left time: 2006.3621s
	iters: 400, epoch: 12 | loss: 0.2667301
	speed: 0.3333s/iter; left time: 1969.6823s
	iters: 500, epoch: 12 | loss: 0.2620348
	speed: 0.3334s/iter; left time: 1936.8526s
	iters: 600, epoch: 12 | loss: 0.2559249
	speed: 0.3342s/iter; left time: 1908.4811s
	iters: 700, epoch: 12 | loss: 0.2699619
	speed: 0.3329s/iter; left time: 1867.5441s
Epoch: 12 cost time: 233.92218017578125
Epoch: 12, Steps: 701 | Train Loss: 0.2656400 Vali Loss: 0.4196184 Test Loss: 0.4830090
Validation loss decreased (0.420069 --> 0.419618).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.2674150
	speed: 0.6264s/iter; left time: 3450.6490s
	iters: 200, epoch: 13 | loss: 0.2785834
	speed: 0.3362s/iter; left time: 1818.5195s
	iters: 300, epoch: 13 | loss: 0.2654229
	speed: 0.3349s/iter; left time: 1778.0593s
	iters: 400, epoch: 13 | loss: 0.2597973
	speed: 0.3333s/iter; left time: 1736.0491s
	iters: 500, epoch: 13 | loss: 0.2487357
	speed: 0.3325s/iter; left time: 1698.5633s
	iters: 600, epoch: 13 | loss: 0.2685147
	speed: 0.3343s/iter; left time: 1674.4663s
	iters: 700, epoch: 13 | loss: 0.2615889
	speed: 0.3334s/iter; left time: 1636.7574s
Epoch: 13 cost time: 234.61360263824463
Epoch: 13, Steps: 701 | Train Loss: 0.2654898 Vali Loss: 0.4197034 Test Loss: 0.4830087
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 14 | loss: 0.2605841
	speed: 0.6168s/iter; left time: 2965.3856s
	iters: 200, epoch: 14 | loss: 0.2675500
	speed: 0.3332s/iter; left time: 1568.8715s
	iters: 300, epoch: 14 | loss: 0.2501476
	speed: 0.3334s/iter; left time: 1536.4958s
	iters: 400, epoch: 14 | loss: 0.2774930
	speed: 0.3332s/iter; left time: 1501.8700s
	iters: 500, epoch: 14 | loss: 0.2586535
	speed: 0.3333s/iter; left time: 1469.3151s
	iters: 600, epoch: 14 | loss: 0.2695524
	speed: 0.3334s/iter; left time: 1436.4520s
	iters: 700, epoch: 14 | loss: 0.2529158
	speed: 0.3333s/iter; left time: 1402.3553s
Epoch: 14 cost time: 233.67055368423462
Epoch: 14, Steps: 701 | Train Loss: 0.2653954 Vali Loss: 0.4201574 Test Loss: 0.4829696
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 15 | loss: 0.2691261
	speed: 0.6180s/iter; left time: 2538.2438s
	iters: 200, epoch: 15 | loss: 0.2559839
	speed: 0.3340s/iter; left time: 1338.4486s
	iters: 300, epoch: 15 | loss: 0.2669134
	speed: 0.3335s/iter; left time: 1303.1384s
	iters: 400, epoch: 15 | loss: 0.2652123
	speed: 0.3338s/iter; left time: 1270.6532s
	iters: 500, epoch: 15 | loss: 0.2584258
	speed: 0.3350s/iter; left time: 1241.6661s
	iters: 600, epoch: 15 | loss: 0.2476874
	speed: 0.3334s/iter; left time: 1202.7177s
	iters: 700, epoch: 15 | loss: 0.2570392
	speed: 0.3335s/iter; left time: 1169.6049s
Epoch: 15 cost time: 234.2227327823639
Epoch: 15, Steps: 701 | Train Loss: 0.2653260 Vali Loss: 0.4198418 Test Loss: 0.4829705
EarlyStopping counter: 3 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 16 | loss: 0.2352566
	speed: 0.6154s/iter; left time: 2095.8903s
	iters: 200, epoch: 16 | loss: 0.2503541
	speed: 0.3343s/iter; left time: 1105.0488s
	iters: 300, epoch: 16 | loss: 0.2532896
	speed: 0.3331s/iter; left time: 1067.9872s
	iters: 400, epoch: 16 | loss: 0.2651243
	speed: 0.3327s/iter; left time: 1033.4991s
	iters: 500, epoch: 16 | loss: 0.2943613
	speed: 0.3331s/iter; left time: 1001.3933s
	iters: 600, epoch: 16 | loss: 0.2618231
	speed: 0.3336s/iter; left time: 969.3999s
	iters: 700, epoch: 16 | loss: 0.2926829
	speed: 0.3324s/iter; left time: 932.7998s
Epoch: 16 cost time: 233.70466494560242
Epoch: 16, Steps: 701 | Train Loss: 0.2653147 Vali Loss: 0.4197181 Test Loss: 0.4829692
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 17 | loss: 0.2751127
	speed: 0.6174s/iter; left time: 1670.1984s
	iters: 200, epoch: 17 | loss: 0.2799978
	speed: 0.3333s/iter; left time: 868.2966s
	iters: 300, epoch: 17 | loss: 0.2731616
	speed: 0.3334s/iter; left time: 835.1380s
	iters: 400, epoch: 17 | loss: 0.2528878
	speed: 0.3331s/iter; left time: 801.1799s
	iters: 500, epoch: 17 | loss: 0.2521693
	speed: 0.3335s/iter; left time: 768.7843s
	iters: 600, epoch: 17 | loss: 0.2706714
	speed: 0.3333s/iter; left time: 734.8366s
	iters: 700, epoch: 17 | loss: 0.2467686
	speed: 0.3336s/iter; left time: 702.1940s
Epoch: 17 cost time: 233.80371856689453
Epoch: 17, Steps: 701 | Train Loss: 0.2653108 Vali Loss: 0.4197910 Test Loss: 0.4829706
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : traffic_336_720_Linear_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15227<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2789
mse:0.48282650113105774, mae:0.3305578827857971
