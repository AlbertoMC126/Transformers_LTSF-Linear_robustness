Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='Linear', model_id='Electricity_336_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=25565, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : Electricity_336_96_Linear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed25565>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17981
val 2537
test 5165
	iters: 100, epoch: 1 | loss: 0.2284517
	speed: 0.0934s/iter; left time: 2087.9425s
	iters: 200, epoch: 1 | loss: 0.2191923
	speed: 0.0794s/iter; left time: 1767.7234s
	iters: 300, epoch: 1 | loss: 0.2283126
	speed: 0.0798s/iter; left time: 1767.6346s
	iters: 400, epoch: 1 | loss: 0.2439596
	speed: 0.0782s/iter; left time: 1725.1142s
	iters: 500, epoch: 1 | loss: 0.1781305
	speed: 0.0787s/iter; left time: 1728.0073s
	iters: 600, epoch: 1 | loss: 0.1854684
	speed: 0.0789s/iter; left time: 1724.0121s
	iters: 700, epoch: 1 | loss: 0.2221662
	speed: 0.0788s/iter; left time: 1714.6571s
	iters: 800, epoch: 1 | loss: 0.2201604
	speed: 0.0785s/iter; left time: 1701.1194s
	iters: 900, epoch: 1 | loss: 0.1926868
	speed: 0.0795s/iter; left time: 1713.4430s
	iters: 1000, epoch: 1 | loss: 0.2126928
	speed: 0.0800s/iter; left time: 1716.0324s
	iters: 1100, epoch: 1 | loss: 0.2152794
	speed: 0.0804s/iter; left time: 1718.1496s
Epoch: 1 cost time: 90.4374361038208
Epoch: 1, Steps: 1123 | Train Loss: 0.2089498 Vali Loss: 0.1794028 Test Loss: 0.2085631
Validation loss decreased (inf --> 0.179403).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.1773122
	speed: 0.2092s/iter; left time: 4442.4023s
	iters: 200, epoch: 2 | loss: 0.1957501
	speed: 0.0795s/iter; left time: 1681.3990s
	iters: 300, epoch: 2 | loss: 0.2064717
	speed: 0.0822s/iter; left time: 1729.6704s
	iters: 400, epoch: 2 | loss: 0.2308822
	speed: 0.0792s/iter; left time: 1659.1471s
	iters: 500, epoch: 2 | loss: 0.1590010
	speed: 0.0804s/iter; left time: 1674.8752s
	iters: 600, epoch: 2 | loss: 0.1948037
	speed: 0.0801s/iter; left time: 1661.9407s
	iters: 700, epoch: 2 | loss: 0.2107725
	speed: 0.0795s/iter; left time: 1641.5550s
	iters: 800, epoch: 2 | loss: 0.2069464
	speed: 0.0793s/iter; left time: 1629.6216s
	iters: 900, epoch: 2 | loss: 0.2326809
	speed: 0.0795s/iter; left time: 1625.6699s
	iters: 1000, epoch: 2 | loss: 0.1683969
	speed: 0.0800s/iter; left time: 1627.8191s
	iters: 1100, epoch: 2 | loss: 0.1870297
	speed: 0.0791s/iter; left time: 1600.8575s
Epoch: 2 cost time: 89.7130880355835
Epoch: 2, Steps: 1123 | Train Loss: 0.1991062 Vali Loss: 0.1739788 Test Loss: 0.1991528
Validation loss decreased (0.179403 --> 0.173979).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.1507818
	speed: 0.2102s/iter; left time: 4228.7821s
	iters: 200, epoch: 3 | loss: 0.1314707
	speed: 0.0791s/iter; left time: 1584.0636s
	iters: 300, epoch: 3 | loss: 0.1638808
	speed: 0.0797s/iter; left time: 1586.4613s
	iters: 400, epoch: 3 | loss: 0.1305403
	speed: 0.0801s/iter; left time: 1586.8296s
	iters: 500, epoch: 3 | loss: 0.1750680
	speed: 0.0789s/iter; left time: 1555.8619s
	iters: 600, epoch: 3 | loss: 0.1489975
	speed: 0.0788s/iter; left time: 1546.6183s
	iters: 700, epoch: 3 | loss: 0.1492167
	speed: 0.0800s/iter; left time: 1560.9177s
	iters: 800, epoch: 3 | loss: 0.1477890
	speed: 0.0798s/iter; left time: 1549.5655s
	iters: 900, epoch: 3 | loss: 0.1419739
	speed: 0.0790s/iter; left time: 1526.5219s
	iters: 1000, epoch: 3 | loss: 0.1538084
	speed: 0.0794s/iter; left time: 1526.0371s
	iters: 1100, epoch: 3 | loss: 0.1497316
	speed: 0.0793s/iter; left time: 1515.8127s
Epoch: 3 cost time: 89.13619470596313
Epoch: 3, Steps: 1123 | Train Loss: 0.1573127 Vali Loss: 0.1424697 Test Loss: 0.1656494
Validation loss decreased (0.173979 --> 0.142470).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.1323492
	speed: 0.2111s/iter; left time: 4008.7057s
	iters: 200, epoch: 4 | loss: 0.1201663
	speed: 0.0797s/iter; left time: 1504.9283s
	iters: 300, epoch: 4 | loss: 0.1305618
	speed: 0.0792s/iter; left time: 1487.8162s
	iters: 400, epoch: 4 | loss: 0.1220962
	speed: 0.0786s/iter; left time: 1468.9898s
	iters: 500, epoch: 4 | loss: 0.1431891
	speed: 0.0794s/iter; left time: 1475.7158s
	iters: 600, epoch: 4 | loss: 0.1319231
	speed: 0.0796s/iter; left time: 1471.8750s
	iters: 700, epoch: 4 | loss: 0.1342375
	speed: 0.0794s/iter; left time: 1459.6307s
	iters: 800, epoch: 4 | loss: 0.1150943
	speed: 0.0778s/iter; left time: 1423.3219s
	iters: 900, epoch: 4 | loss: 0.1150528
	speed: 0.0793s/iter; left time: 1442.5775s
	iters: 1000, epoch: 4 | loss: 0.1552804
	speed: 0.0789s/iter; left time: 1427.8447s
	iters: 1100, epoch: 4 | loss: 0.1340264
	speed: 0.0806s/iter; left time: 1450.3684s
Epoch: 4 cost time: 89.16987919807434
Epoch: 4, Steps: 1123 | Train Loss: 0.1415849 Vali Loss: 0.1270325 Test Loss: 0.1479513
Validation loss decreased (0.142470 --> 0.127032).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.1253842
	speed: 0.2121s/iter; left time: 3790.6972s
	iters: 200, epoch: 5 | loss: 0.1146337
	speed: 0.0788s/iter; left time: 1399.4593s
	iters: 300, epoch: 5 | loss: 0.1332599
	speed: 0.0790s/iter; left time: 1396.0030s
	iters: 400, epoch: 5 | loss: 0.1080569
	speed: 0.0796s/iter; left time: 1398.6221s
	iters: 500, epoch: 5 | loss: 0.1305297
	speed: 0.0798s/iter; left time: 1393.4269s
	iters: 600, epoch: 5 | loss: 0.1387345
	speed: 0.0785s/iter; left time: 1363.8704s
	iters: 700, epoch: 5 | loss: 0.1482586
	speed: 0.0784s/iter; left time: 1354.3103s
	iters: 800, epoch: 5 | loss: 0.1213021
	speed: 0.0795s/iter; left time: 1365.6809s
	iters: 900, epoch: 5 | loss: 0.1214395
	speed: 0.0807s/iter; left time: 1378.0259s
	iters: 1000, epoch: 5 | loss: 0.1524828
	speed: 0.0796s/iter; left time: 1350.2116s
	iters: 1100, epoch: 5 | loss: 0.1392613
	speed: 0.0781s/iter; left time: 1317.7206s
Epoch: 5 cost time: 88.89257955551147
Epoch: 5, Steps: 1123 | Train Loss: 0.1337975 Vali Loss: 0.1206350 Test Loss: 0.1418499
Validation loss decreased (0.127032 --> 0.120635).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.1380903
	speed: 0.2178s/iter; left time: 3646.9081s
	iters: 200, epoch: 6 | loss: 0.1206182
	speed: 0.0795s/iter; left time: 1323.4717s
	iters: 300, epoch: 6 | loss: 0.1260600
	speed: 0.0794s/iter; left time: 1313.2148s
	iters: 400, epoch: 6 | loss: 0.1155736
	speed: 0.0787s/iter; left time: 1294.3738s
	iters: 500, epoch: 6 | loss: 0.1191869
	speed: 0.0787s/iter; left time: 1285.7920s
	iters: 600, epoch: 6 | loss: 0.1493483
	speed: 0.0795s/iter; left time: 1291.8227s
	iters: 700, epoch: 6 | loss: 0.1187956
	speed: 0.0799s/iter; left time: 1290.5747s
	iters: 800, epoch: 6 | loss: 0.1111251
	speed: 0.0800s/iter; left time: 1283.2181s
	iters: 900, epoch: 6 | loss: 0.1317460
	speed: 0.0790s/iter; left time: 1259.2074s
	iters: 1000, epoch: 6 | loss: 0.1223879
	speed: 0.0791s/iter; left time: 1252.6876s
	iters: 1100, epoch: 6 | loss: 0.1546924
	speed: 0.0797s/iter; left time: 1254.7958s
Epoch: 6 cost time: 89.45080256462097
Epoch: 6, Steps: 1123 | Train Loss: 0.1295849 Vali Loss: 0.1174041 Test Loss: 0.1378302
Validation loss decreased (0.120635 --> 0.117404).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.1513270
	speed: 0.2128s/iter; left time: 3323.9497s
	iters: 200, epoch: 7 | loss: 0.1401367
	speed: 0.0839s/iter; left time: 1303.1408s
	iters: 300, epoch: 7 | loss: 0.1300624
	speed: 0.0849s/iter; left time: 1308.8952s
	iters: 400, epoch: 7 | loss: 0.1445731
	speed: 0.0808s/iter; left time: 1237.9479s
	iters: 500, epoch: 7 | loss: 0.1370212
	speed: 0.0801s/iter; left time: 1219.5944s
	iters: 600, epoch: 7 | loss: 0.1136583
	speed: 0.0793s/iter; left time: 1199.9392s
	iters: 700, epoch: 7 | loss: 0.1081737
	speed: 0.0799s/iter; left time: 1199.9942s
	iters: 800, epoch: 7 | loss: 0.1176179
	speed: 0.0790s/iter; left time: 1178.3452s
	iters: 900, epoch: 7 | loss: 0.1160007
	speed: 0.0791s/iter; left time: 1172.4614s
	iters: 1000, epoch: 7 | loss: 0.1123417
	speed: 0.0788s/iter; left time: 1160.2013s
	iters: 1100, epoch: 7 | loss: 0.1249400
	speed: 0.0801s/iter; left time: 1171.8594s
Epoch: 7 cost time: 90.5326783657074
Epoch: 7, Steps: 1123 | Train Loss: 0.1273514 Vali Loss: 0.1157001 Test Loss: 0.1359478
Validation loss decreased (0.117404 --> 0.115700).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.1111611
	speed: 0.2098s/iter; left time: 3042.3369s
	iters: 200, epoch: 8 | loss: 0.1335322
	speed: 0.0782s/iter; left time: 1125.5028s
	iters: 300, epoch: 8 | loss: 0.1345085
	speed: 0.0789s/iter; left time: 1128.8670s
	iters: 400, epoch: 8 | loss: 0.1207796
	speed: 0.0787s/iter; left time: 1116.9514s
	iters: 500, epoch: 8 | loss: 0.1408227
	speed: 0.0787s/iter; left time: 1110.0787s
	iters: 600, epoch: 8 | loss: 0.1099045
	speed: 0.0779s/iter; left time: 1090.4111s
	iters: 700, epoch: 8 | loss: 0.1327180
	speed: 0.0776s/iter; left time: 1078.7997s
	iters: 800, epoch: 8 | loss: 0.1232320
	speed: 0.0790s/iter; left time: 1089.5131s
	iters: 900, epoch: 8 | loss: 0.1390317
	speed: 0.0786s/iter; left time: 1077.3573s
	iters: 1000, epoch: 8 | loss: 0.1274288
	speed: 0.0792s/iter; left time: 1077.4585s
	iters: 1100, epoch: 8 | loss: 0.1028735
	speed: 0.0783s/iter; left time: 1057.3924s
Epoch: 8 cost time: 88.16849040985107
Epoch: 8, Steps: 1123 | Train Loss: 0.1260973 Vali Loss: 0.1146894 Test Loss: 0.1347397
Validation loss decreased (0.115700 --> 0.114689).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.1105319
	speed: 0.2100s/iter; left time: 2808.5838s
	iters: 200, epoch: 9 | loss: 0.1007807
	speed: 0.0796s/iter; left time: 1057.4324s
	iters: 300, epoch: 9 | loss: 0.1146545
	speed: 0.0799s/iter; left time: 1053.1225s
	iters: 400, epoch: 9 | loss: 0.1109281
	speed: 0.0834s/iter; left time: 1089.9854s
	iters: 500, epoch: 9 | loss: 0.1408684
	speed: 0.0830s/iter; left time: 1077.4715s
	iters: 600, epoch: 9 | loss: 0.1140408
	speed: 0.0813s/iter; left time: 1047.1579s
	iters: 700, epoch: 9 | loss: 0.1392022
	speed: 0.0805s/iter; left time: 1029.1154s
	iters: 800, epoch: 9 | loss: 0.1322349
	speed: 0.0804s/iter; left time: 1018.7165s
	iters: 900, epoch: 9 | loss: 0.1180657
	speed: 0.0789s/iter; left time: 992.0170s
	iters: 1000, epoch: 9 | loss: 0.1156785
	speed: 0.0791s/iter; left time: 986.5643s
	iters: 1100, epoch: 9 | loss: 0.1226838
	speed: 0.0792s/iter; left time: 980.0499s
Epoch: 9 cost time: 90.21177911758423
Epoch: 9, Steps: 1123 | Train Loss: 0.1254319 Vali Loss: 0.1142089 Test Loss: 0.1341594
Validation loss decreased (0.114689 --> 0.114209).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.1033497
	speed: 0.2120s/iter; left time: 2598.2085s
	iters: 200, epoch: 10 | loss: 0.1407568
	speed: 0.0790s/iter; left time: 960.0770s
	iters: 300, epoch: 10 | loss: 0.1024809
	speed: 0.0791s/iter; left time: 953.3953s
	iters: 400, epoch: 10 | loss: 0.1285695
	speed: 0.0788s/iter; left time: 941.8485s
	iters: 500, epoch: 10 | loss: 0.1165457
	speed: 0.0791s/iter; left time: 937.2385s
	iters: 600, epoch: 10 | loss: 0.1177207
	speed: 0.0789s/iter; left time: 927.4406s
	iters: 700, epoch: 10 | loss: 0.1193776
	speed: 0.0788s/iter; left time: 917.9034s
	iters: 800, epoch: 10 | loss: 0.1215659
	speed: 0.0785s/iter; left time: 906.9810s
	iters: 900, epoch: 10 | loss: 0.1309504
	speed: 0.0812s/iter; left time: 930.0021s
	iters: 1000, epoch: 10 | loss: 0.1236446
	speed: 0.0793s/iter; left time: 900.8189s
	iters: 1100, epoch: 10 | loss: 0.1110021
	speed: 0.0803s/iter; left time: 903.2622s
Epoch: 10 cost time: 89.13586378097534
Epoch: 10, Steps: 1123 | Train Loss: 0.1250824 Vali Loss: 0.1141577 Test Loss: 0.1340655
Validation loss decreased (0.114209 --> 0.114158).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.1088738
	speed: 0.2103s/iter; left time: 2340.6270s
	iters: 200, epoch: 11 | loss: 0.1069880
	speed: 0.0785s/iter; left time: 865.4794s
	iters: 300, epoch: 11 | loss: 0.1111709
	speed: 0.0786s/iter; left time: 859.2989s
	iters: 400, epoch: 11 | loss: 0.1030481
	speed: 0.0789s/iter; left time: 854.9870s
	iters: 500, epoch: 11 | loss: 0.1070043
	speed: 0.0784s/iter; left time: 841.2164s
	iters: 600, epoch: 11 | loss: 0.1186836
	speed: 0.0788s/iter; left time: 837.7286s
	iters: 700, epoch: 11 | loss: 0.1097973
	speed: 0.0787s/iter; left time: 828.5312s
	iters: 800, epoch: 11 | loss: 0.1043564
	speed: 0.0791s/iter; left time: 825.4746s
	iters: 900, epoch: 11 | loss: 0.1478430
	speed: 0.0784s/iter; left time: 809.6219s
	iters: 1000, epoch: 11 | loss: 0.1084931
	speed: 0.0781s/iter; left time: 798.5355s
	iters: 1100, epoch: 11 | loss: 0.1118168
	speed: 0.0778s/iter; left time: 788.6495s
Epoch: 11 cost time: 88.14012026786804
Epoch: 11, Steps: 1123 | Train Loss: 0.1249056 Vali Loss: 0.1139207 Test Loss: 0.1338501
Validation loss decreased (0.114158 --> 0.113921).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.1346679
	speed: 0.2156s/iter; left time: 2157.5327s
	iters: 200, epoch: 12 | loss: 0.1370950
	speed: 0.0797s/iter; left time: 789.8982s
	iters: 300, epoch: 12 | loss: 0.1112913
	speed: 0.0794s/iter; left time: 779.0342s
	iters: 400, epoch: 12 | loss: 0.1078959
	speed: 0.0788s/iter; left time: 764.5583s
	iters: 500, epoch: 12 | loss: 0.1444928
	speed: 0.0792s/iter; left time: 760.6412s
	iters: 600, epoch: 12 | loss: 0.1247398
	speed: 0.0800s/iter; left time: 760.8213s
	iters: 700, epoch: 12 | loss: 0.1496561
	speed: 0.0801s/iter; left time: 753.4283s
	iters: 800, epoch: 12 | loss: 0.1131992
	speed: 0.0791s/iter; left time: 736.6813s
	iters: 900, epoch: 12 | loss: 0.1616607
	speed: 0.0786s/iter; left time: 723.4392s
	iters: 1000, epoch: 12 | loss: 0.0995438
	speed: 0.0798s/iter; left time: 726.7709s
	iters: 1100, epoch: 12 | loss: 0.1146515
	speed: 0.0801s/iter; left time: 721.7140s
Epoch: 12 cost time: 89.29413032531738
Epoch: 12, Steps: 1123 | Train Loss: 0.1247980 Vali Loss: 0.1138232 Test Loss: 0.1337753
Validation loss decreased (0.113921 --> 0.113823).  Saving model ...
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.1273034
	speed: 0.2148s/iter; left time: 1908.7237s
	iters: 200, epoch: 13 | loss: 0.1138788
	speed: 0.0803s/iter; left time: 705.2277s
	iters: 300, epoch: 13 | loss: 0.1687225
	speed: 0.0805s/iter; left time: 699.1353s
	iters: 400, epoch: 13 | loss: 0.1156265
	speed: 0.0796s/iter; left time: 683.5933s
	iters: 500, epoch: 13 | loss: 0.1307524
	speed: 0.0799s/iter; left time: 678.0350s
	iters: 600, epoch: 13 | loss: 0.1225520
	speed: 0.0792s/iter; left time: 663.8284s
	iters: 700, epoch: 13 | loss: 0.1544671
	speed: 0.0791s/iter; left time: 655.2927s
	iters: 800, epoch: 13 | loss: 0.1216660
	speed: 0.0784s/iter; left time: 641.7440s
	iters: 900, epoch: 13 | loss: 0.1085252
	speed: 0.0797s/iter; left time: 644.3195s
	iters: 1000, epoch: 13 | loss: 0.1032537
	speed: 0.0793s/iter; left time: 633.4360s
	iters: 1100, epoch: 13 | loss: 0.1226071
	speed: 0.0797s/iter; left time: 628.5889s
Epoch: 13 cost time: 89.38628482818604
Epoch: 13, Steps: 1123 | Train Loss: 0.1247400 Vali Loss: 0.1138265 Test Loss: 0.1337569
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.1431403
	speed: 0.1986s/iter; left time: 1541.2238s
	iters: 200, epoch: 14 | loss: 0.1322126
	speed: 0.0792s/iter; left time: 607.1369s
	iters: 300, epoch: 14 | loss: 0.1214411
	speed: 0.0794s/iter; left time: 600.3216s
	iters: 400, epoch: 14 | loss: 0.1229584
	speed: 0.0807s/iter; left time: 602.1271s
	iters: 500, epoch: 14 | loss: 0.1353201
	speed: 0.0805s/iter; left time: 592.4536s
	iters: 600, epoch: 14 | loss: 0.1208529
	speed: 0.0795s/iter; left time: 577.4999s
	iters: 700, epoch: 14 | loss: 0.1137235
	speed: 0.0792s/iter; left time: 567.0377s
	iters: 800, epoch: 14 | loss: 0.0977086
	speed: 0.0801s/iter; left time: 565.5363s
	iters: 900, epoch: 14 | loss: 0.1364824
	speed: 0.0789s/iter; left time: 549.3448s
	iters: 1000, epoch: 14 | loss: 0.1109957
	speed: 0.0782s/iter; left time: 536.3986s
	iters: 1100, epoch: 14 | loss: 0.1131009
	speed: 0.0785s/iter; left time: 530.4902s
Epoch: 14 cost time: 89.12320137023926
Epoch: 14, Steps: 1123 | Train Loss: 0.1247041 Vali Loss: 0.1138608 Test Loss: 0.1337512
EarlyStopping counter: 2 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.1579234
	speed: 0.1993s/iter; left time: 1322.9157s
	iters: 200, epoch: 15 | loss: 0.1144769
	speed: 0.0777s/iter; left time: 507.8124s
	iters: 300, epoch: 15 | loss: 0.1221103
	speed: 0.0782s/iter; left time: 503.3898s
	iters: 400, epoch: 15 | loss: 0.1065598
	speed: 0.0778s/iter; left time: 492.8692s
	iters: 500, epoch: 15 | loss: 0.1033267
	speed: 0.0780s/iter; left time: 486.6907s
	iters: 600, epoch: 15 | loss: 0.1077001
	speed: 0.0782s/iter; left time: 479.7674s
	iters: 700, epoch: 15 | loss: 0.1073625
	speed: 0.0777s/iter; left time: 469.4825s
	iters: 800, epoch: 15 | loss: 0.1141402
	speed: 0.0775s/iter; left time: 460.1840s
	iters: 900, epoch: 15 | loss: 0.1279628
	speed: 0.0776s/iter; left time: 453.0945s
	iters: 1000, epoch: 15 | loss: 0.1254555
	speed: 0.0784s/iter; left time: 450.0557s
	iters: 1100, epoch: 15 | loss: 0.1371431
	speed: 0.0789s/iter; left time: 445.0123s
Epoch: 15 cost time: 87.65288352966309
Epoch: 15, Steps: 1123 | Train Loss: 0.1246975 Vali Loss: 0.1138664 Test Loss: 0.1337489
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.1429496
	speed: 0.1993s/iter; left time: 1099.5328s
	iters: 200, epoch: 16 | loss: 0.1276358
	speed: 0.0790s/iter; left time: 428.0559s
	iters: 300, epoch: 16 | loss: 0.1376072
	speed: 0.0787s/iter; left time: 418.1921s
	iters: 400, epoch: 16 | loss: 0.0959125
	speed: 0.0798s/iter; left time: 416.3578s
	iters: 500, epoch: 16 | loss: 0.1463606
	speed: 0.0793s/iter; left time: 405.4966s
	iters: 600, epoch: 16 | loss: 0.1340322
	speed: 0.0802s/iter; left time: 402.5120s
	iters: 700, epoch: 16 | loss: 0.1189238
	speed: 0.0808s/iter; left time: 397.0711s
	iters: 800, epoch: 16 | loss: 0.1685963
	speed: 0.0801s/iter; left time: 385.9679s
	iters: 900, epoch: 16 | loss: 0.1356713
	speed: 0.0806s/iter; left time: 380.3245s
	iters: 1000, epoch: 16 | loss: 0.1098981
	speed: 0.0809s/iter; left time: 373.4290s
	iters: 1100, epoch: 16 | loss: 0.1145415
	speed: 0.0810s/iter; left time: 365.5795s
Epoch: 16 cost time: 89.81815695762634
Epoch: 16, Steps: 1123 | Train Loss: 0.1246889 Vali Loss: 0.1137472 Test Loss: 0.1337476
Validation loss decreased (0.113823 --> 0.113747).  Saving model ...
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 17 | loss: 0.1268290
	speed: 0.2115s/iter; left time: 928.9661s
	iters: 200, epoch: 17 | loss: 0.1569561
	speed: 0.0808s/iter; left time: 346.8392s
	iters: 300, epoch: 17 | loss: 0.1748839
	speed: 0.0796s/iter; left time: 333.5981s
	iters: 400, epoch: 17 | loss: 0.1248125
	speed: 0.0807s/iter; left time: 330.4584s
	iters: 500, epoch: 17 | loss: 0.1055309
	speed: 0.0794s/iter; left time: 317.1109s
	iters: 600, epoch: 17 | loss: 0.0999525
	speed: 0.0794s/iter; left time: 309.0556s
	iters: 700, epoch: 17 | loss: 0.1173144
	speed: 0.0795s/iter; left time: 301.3772s
	iters: 800, epoch: 17 | loss: 0.1202089
	speed: 0.0799s/iter; left time: 294.8971s
	iters: 900, epoch: 17 | loss: 0.1132423
	speed: 0.0788s/iter; left time: 283.1963s
	iters: 1000, epoch: 17 | loss: 0.1225047
	speed: 0.0792s/iter; left time: 276.6704s
	iters: 1100, epoch: 17 | loss: 0.1093919
	speed: 0.0787s/iter; left time: 266.9086s
Epoch: 17 cost time: 89.39923620223999
Epoch: 17, Steps: 1123 | Train Loss: 0.1246782 Vali Loss: 0.1138016 Test Loss: 0.1337469
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 18 | loss: 0.1467047
	speed: 0.2080s/iter; left time: 680.1866s
	iters: 200, epoch: 18 | loss: 0.1104646
	speed: 0.0791s/iter; left time: 250.8973s
	iters: 300, epoch: 18 | loss: 0.1220161
	speed: 0.0786s/iter; left time: 241.3169s
	iters: 400, epoch: 18 | loss: 0.1361391
	speed: 0.0786s/iter; left time: 233.5514s
	iters: 500, epoch: 18 | loss: 0.1534585
	speed: 0.0785s/iter; left time: 225.2612s
	iters: 600, epoch: 18 | loss: 0.1393570
	speed: 0.0792s/iter; left time: 219.2481s
	iters: 700, epoch: 18 | loss: 0.1480463
	speed: 0.0787s/iter; left time: 210.2300s
	iters: 800, epoch: 18 | loss: 0.1067570
	speed: 0.0783s/iter; left time: 201.2529s
	iters: 900, epoch: 18 | loss: 0.1095279
	speed: 0.0787s/iter; left time: 194.4838s
	iters: 1000, epoch: 18 | loss: 0.1417687
	speed: 0.0793s/iter; left time: 187.9486s
	iters: 1100, epoch: 18 | loss: 0.1065541
	speed: 0.0790s/iter; left time: 179.2360s
Epoch: 18 cost time: 88.84426927566528
Epoch: 18, Steps: 1123 | Train Loss: 0.1246687 Vali Loss: 0.1138797 Test Loss: 0.1337468
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 19 | loss: 0.1140593
	speed: 0.2007s/iter; left time: 430.8799s
	iters: 200, epoch: 19 | loss: 0.1516901
	speed: 0.0786s/iter; left time: 160.8033s
	iters: 300, epoch: 19 | loss: 0.1017606
	speed: 0.0810s/iter; left time: 157.6538s
	iters: 400, epoch: 19 | loss: 0.1196565
	speed: 0.0787s/iter; left time: 145.3907s
	iters: 500, epoch: 19 | loss: 0.1019082
	speed: 0.0785s/iter; left time: 137.1381s
	iters: 600, epoch: 19 | loss: 0.1172138
	speed: 0.0774s/iter; left time: 127.4761s
	iters: 700, epoch: 19 | loss: 0.1262218
	speed: 0.0780s/iter; left time: 120.6505s
	iters: 800, epoch: 19 | loss: 0.1148008
	speed: 0.0787s/iter; left time: 113.8704s
	iters: 900, epoch: 19 | loss: 0.1353533
	speed: 0.0801s/iter; left time: 107.9599s
	iters: 1000, epoch: 19 | loss: 0.1167417
	speed: 0.0795s/iter; left time: 99.0763s
	iters: 1100, epoch: 19 | loss: 0.1185029
	speed: 0.0788s/iter; left time: 90.3933s
Epoch: 19 cost time: 88.59382724761963
Epoch: 19, Steps: 1123 | Train Loss: 0.1246843 Vali Loss: 0.1138232 Test Loss: 0.1337466
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.9073486328125e-08
	iters: 100, epoch: 20 | loss: 0.1268158
	speed: 0.1975s/iter; left time: 202.2305s
	iters: 200, epoch: 20 | loss: 0.1533995
	speed: 0.0790s/iter; left time: 73.0352s
	iters: 300, epoch: 20 | loss: 0.1308845
	speed: 0.0804s/iter; left time: 66.2215s
	iters: 400, epoch: 20 | loss: 0.1175343
	speed: 0.0808s/iter; left time: 58.5017s
	iters: 500, epoch: 20 | loss: 0.1216430
	speed: 0.0827s/iter; left time: 51.5961s
	iters: 600, epoch: 20 | loss: 0.1092583
	speed: 0.0804s/iter; left time: 42.1181s
	iters: 700, epoch: 20 | loss: 0.1331300
	speed: 0.0787s/iter; left time: 33.3814s
	iters: 800, epoch: 20 | loss: 0.1156437
	speed: 0.0795s/iter; left time: 25.7573s
	iters: 900, epoch: 20 | loss: 0.1452078
	speed: 0.0785s/iter; left time: 17.5803s
	iters: 1000, epoch: 20 | loss: 0.1332502
	speed: 0.0792s/iter; left time: 9.8149s
	iters: 1100, epoch: 20 | loss: 0.1627267
	speed: 0.0797s/iter; left time: 1.9118s
Epoch: 20 cost time: 89.588205575943
Epoch: 20, Steps: 1123 | Train Loss: 0.1246847 Vali Loss: 0.1138779 Test Loss: 0.1337466
EarlyStopping counter: 4 out of 5
Updating learning rate to 9.5367431640625e-09
>>>>>>>testing : Electricity_336_96_Linear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed25565<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5165
mse:0.13372640311717987, mae:0.23042379319667816
