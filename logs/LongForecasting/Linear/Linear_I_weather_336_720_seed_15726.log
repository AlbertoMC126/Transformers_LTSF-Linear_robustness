Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='Linear', model_id='weather_336_720', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=720, root_path='./dataset/', save_pred_values=False, seed=15726, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : weather_336_720_Linear_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15726>>>>>>>>>>>>>>>>>>>>>>>>>>
train 35832
val 4551
test 9820
	iters: 100, epoch: 1 | loss: 0.6394935
	speed: 0.0516s/iter; left time: 2306.3925s
	iters: 200, epoch: 1 | loss: 0.6741219
	speed: 0.0460s/iter; left time: 2052.6598s
	iters: 300, epoch: 1 | loss: 1.7236711
	speed: 0.0526s/iter; left time: 2338.2927s
	iters: 400, epoch: 1 | loss: 1.0405157
	speed: 0.0546s/iter; left time: 2421.1400s
	iters: 500, epoch: 1 | loss: 0.6024794
	speed: 0.0479s/iter; left time: 2122.4045s
	iters: 600, epoch: 1 | loss: 0.5204579
	speed: 0.0483s/iter; left time: 2135.8150s
	iters: 700, epoch: 1 | loss: 1.8936924
	speed: 0.0524s/iter; left time: 2308.6927s
	iters: 800, epoch: 1 | loss: 0.7724307
	speed: 0.0479s/iter; left time: 2104.9564s
	iters: 900, epoch: 1 | loss: 0.7903486
	speed: 0.0479s/iter; left time: 2100.3190s
	iters: 1000, epoch: 1 | loss: 0.4866678
	speed: 0.0476s/iter; left time: 2085.5484s
	iters: 1100, epoch: 1 | loss: 3.3311486
	speed: 0.0480s/iter; left time: 2098.3026s
	iters: 1200, epoch: 1 | loss: 0.6655096
	speed: 0.0524s/iter; left time: 2284.5002s
	iters: 1300, epoch: 1 | loss: 0.8048464
	speed: 0.0463s/iter; left time: 2014.3941s
	iters: 1400, epoch: 1 | loss: 0.6330817
	speed: 0.0452s/iter; left time: 1960.7067s
	iters: 1500, epoch: 1 | loss: 0.7711948
	speed: 0.0459s/iter; left time: 1987.1105s
	iters: 1600, epoch: 1 | loss: 0.5985335
	speed: 0.0491s/iter; left time: 2119.2484s
	iters: 1700, epoch: 1 | loss: 0.5875880
	speed: 0.0544s/iter; left time: 2344.0709s
	iters: 1800, epoch: 1 | loss: 1.0132996
	speed: 0.0462s/iter; left time: 1985.7451s
	iters: 1900, epoch: 1 | loss: 4.7381229
	speed: 0.0454s/iter; left time: 1946.8019s
	iters: 2000, epoch: 1 | loss: 0.7000408
	speed: 0.0471s/iter; left time: 2015.9136s
	iters: 2100, epoch: 1 | loss: 0.5905242
	speed: 0.0515s/iter; left time: 2199.5179s
	iters: 2200, epoch: 1 | loss: 0.6370522
	speed: 0.0496s/iter; left time: 2112.3009s
Epoch: 1 cost time: 109.86082434654236
Epoch: 1, Steps: 2239 | Train Loss: 1.4018000 Vali Loss: 0.7817883 Test Loss: 0.4404863
Validation loss decreased (inf --> 0.781788).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.6087551
	speed: 0.1392s/iter; left time: 5909.2625s
	iters: 200, epoch: 2 | loss: 0.7162449
	speed: 0.0514s/iter; left time: 2177.3948s
	iters: 300, epoch: 2 | loss: 1.4550374
	speed: 0.0480s/iter; left time: 2025.8839s
	iters: 400, epoch: 2 | loss: 0.8092571
	speed: 0.0486s/iter; left time: 2046.2699s
	iters: 500, epoch: 2 | loss: 1.9387486
	speed: 0.0523s/iter; left time: 2197.8055s
	iters: 600, epoch: 2 | loss: 0.8177302
	speed: 0.0504s/iter; left time: 2112.4221s
	iters: 700, epoch: 2 | loss: 0.5041754
	speed: 0.0471s/iter; left time: 1972.0032s
	iters: 800, epoch: 2 | loss: 0.7831251
	speed: 0.0502s/iter; left time: 2094.7350s
	iters: 900, epoch: 2 | loss: 0.6765618
	speed: 0.0517s/iter; left time: 2151.8939s
	iters: 1000, epoch: 2 | loss: 0.9031653
	speed: 0.0493s/iter; left time: 2047.4456s
	iters: 1100, epoch: 2 | loss: 0.6386279
	speed: 0.0495s/iter; left time: 2051.8048s
	iters: 1200, epoch: 2 | loss: 0.4791438
	speed: 0.0514s/iter; left time: 2124.5760s
	iters: 1300, epoch: 2 | loss: 0.5535085
	speed: 0.0442s/iter; left time: 1821.2392s
	iters: 1400, epoch: 2 | loss: 0.8711495
	speed: 0.0488s/iter; left time: 2005.9675s
	iters: 1500, epoch: 2 | loss: 3.4936759
	speed: 0.0521s/iter; left time: 2140.2621s
	iters: 1600, epoch: 2 | loss: 0.5401247
	speed: 0.0459s/iter; left time: 1878.4736s
	iters: 1700, epoch: 2 | loss: 0.6156724
	speed: 0.0537s/iter; left time: 2192.5036s
	iters: 1800, epoch: 2 | loss: 0.6692505
	speed: 0.0536s/iter; left time: 2185.8071s
	iters: 1900, epoch: 2 | loss: 0.5468446
	speed: 0.0499s/iter; left time: 2028.3912s
	iters: 2000, epoch: 2 | loss: 0.9565483
	speed: 0.0480s/iter; left time: 1945.1812s
	iters: 2100, epoch: 2 | loss: 0.6244352
	speed: 0.0471s/iter; left time: 1904.6976s
	iters: 2200, epoch: 2 | loss: 2.7815683
	speed: 0.0477s/iter; left time: 1926.1637s
Epoch: 2 cost time: 109.84919095039368
Epoch: 2, Steps: 2239 | Train Loss: 1.1164133 Vali Loss: 0.7568682 Test Loss: 0.4199267
Validation loss decreased (0.781788 --> 0.756868).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 3.7121816
	speed: 0.1409s/iter; left time: 5666.1626s
	iters: 200, epoch: 3 | loss: 0.4998316
	speed: 0.0471s/iter; left time: 1889.8650s
	iters: 300, epoch: 3 | loss: 0.8517304
	speed: 0.0479s/iter; left time: 1915.5331s
	iters: 400, epoch: 3 | loss: 0.8194621
	speed: 0.0525s/iter; left time: 2094.0646s
	iters: 500, epoch: 3 | loss: 0.5354564
	speed: 0.0480s/iter; left time: 1911.4383s
	iters: 600, epoch: 3 | loss: 0.5921506
	speed: 0.0531s/iter; left time: 2110.1243s
	iters: 700, epoch: 3 | loss: 0.4874068
	speed: 0.0544s/iter; left time: 2154.8232s
	iters: 800, epoch: 3 | loss: 0.5525848
	speed: 0.0530s/iter; left time: 2094.9140s
	iters: 900, epoch: 3 | loss: 0.4996381
	speed: 0.0478s/iter; left time: 1884.6388s
	iters: 1000, epoch: 3 | loss: 0.9194661
	speed: 0.0496s/iter; left time: 1949.5594s
	iters: 1100, epoch: 3 | loss: 0.6597768
	speed: 0.0525s/iter; left time: 2058.6575s
	iters: 1200, epoch: 3 | loss: 0.5747622
	speed: 0.0544s/iter; left time: 2127.7852s
	iters: 1300, epoch: 3 | loss: 0.5734242
	speed: 0.0528s/iter; left time: 2057.5732s
	iters: 1400, epoch: 3 | loss: 0.7013768
	speed: 0.0517s/iter; left time: 2013.1148s
	iters: 1500, epoch: 3 | loss: 0.8737600
	speed: 0.0470s/iter; left time: 1823.8270s
	iters: 1600, epoch: 3 | loss: 0.7294878
	speed: 0.0449s/iter; left time: 1736.0273s
	iters: 1700, epoch: 3 | loss: 0.5337084
	speed: 0.0491s/iter; left time: 1897.0323s
	iters: 1800, epoch: 3 | loss: 0.7622127
	speed: 0.0466s/iter; left time: 1794.9856s
	iters: 1900, epoch: 3 | loss: 0.5516758
	speed: 0.0488s/iter; left time: 1873.4016s
	iters: 2000, epoch: 3 | loss: 0.6159168
	speed: 0.0504s/iter; left time: 1931.2231s
	iters: 2100, epoch: 3 | loss: 0.6112740
	speed: 0.0488s/iter; left time: 1865.9512s
	iters: 2200, epoch: 3 | loss: 0.7601768
	speed: 0.0478s/iter; left time: 1820.3960s
Epoch: 3 cost time: 110.43076372146606
Epoch: 3, Steps: 2239 | Train Loss: 0.8245995 Vali Loss: 0.6503553 Test Loss: 0.3446393
Validation loss decreased (0.756868 --> 0.650355).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.6611158
	speed: 0.1485s/iter; left time: 5638.1719s
	iters: 200, epoch: 4 | loss: 0.4717964
	speed: 0.0473s/iter; left time: 1789.4594s
	iters: 300, epoch: 4 | loss: 0.6437126
	speed: 0.0500s/iter; left time: 1886.5773s
	iters: 400, epoch: 4 | loss: 0.7436655
	speed: 0.0503s/iter; left time: 1896.3181s
	iters: 500, epoch: 4 | loss: 0.8763846
	speed: 0.0472s/iter; left time: 1773.0828s
	iters: 600, epoch: 4 | loss: 0.4177232
	speed: 0.0450s/iter; left time: 1687.6251s
	iters: 700, epoch: 4 | loss: 0.5890578
	speed: 0.0500s/iter; left time: 1868.5934s
	iters: 800, epoch: 4 | loss: 0.5008984
	speed: 0.0489s/iter; left time: 1820.8270s
	iters: 900, epoch: 4 | loss: 0.5469865
	speed: 0.0536s/iter; left time: 1993.1367s
	iters: 1000, epoch: 4 | loss: 0.4484650
	speed: 0.0550s/iter; left time: 2038.0573s
	iters: 1100, epoch: 4 | loss: 1.0141312
	speed: 0.0529s/iter; left time: 1956.2861s
	iters: 1200, epoch: 4 | loss: 4.0884848
	speed: 0.0500s/iter; left time: 1841.6687s
	iters: 1300, epoch: 4 | loss: 0.6075351
	speed: 0.0475s/iter; left time: 1745.1615s
	iters: 1400, epoch: 4 | loss: 0.7310646
	speed: 0.0511s/iter; left time: 1874.3756s
	iters: 1500, epoch: 4 | loss: 0.8146379
	speed: 0.0490s/iter; left time: 1790.1311s
	iters: 1600, epoch: 4 | loss: 0.6580230
	speed: 0.0506s/iter; left time: 1845.4186s
	iters: 1700, epoch: 4 | loss: 0.5073632
	speed: 0.0491s/iter; left time: 1785.1914s
	iters: 1800, epoch: 4 | loss: 0.5383883
	speed: 0.0505s/iter; left time: 1832.0003s
	iters: 1900, epoch: 4 | loss: 0.5598212
	speed: 0.0491s/iter; left time: 1774.8845s
	iters: 2000, epoch: 4 | loss: 0.7041751
	speed: 0.0507s/iter; left time: 1827.5728s
	iters: 2100, epoch: 4 | loss: 0.7561849
	speed: 0.0496s/iter; left time: 1782.0558s
	iters: 2200, epoch: 4 | loss: 1.0095816
	speed: 0.0497s/iter; left time: 1783.1881s
Epoch: 4 cost time: 110.67455649375916
Epoch: 4, Steps: 2239 | Train Loss: 0.6745622 Vali Loss: 0.6329885 Test Loss: 0.3414747
Validation loss decreased (0.650355 --> 0.632989).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.7897036
	speed: 0.1467s/iter; left time: 5240.5576s
	iters: 200, epoch: 5 | loss: 0.5975764
	speed: 0.0495s/iter; left time: 1763.4364s
	iters: 300, epoch: 5 | loss: 0.5657219
	speed: 0.0503s/iter; left time: 1788.2764s
	iters: 400, epoch: 5 | loss: 0.7942689
	speed: 0.0523s/iter; left time: 1852.7610s
	iters: 500, epoch: 5 | loss: 0.4556355
	speed: 0.0510s/iter; left time: 1800.5337s
	iters: 600, epoch: 5 | loss: 0.7126280
	speed: 0.0505s/iter; left time: 1777.9473s
	iters: 700, epoch: 5 | loss: 0.7011355
	speed: 0.0526s/iter; left time: 1849.0705s
	iters: 800, epoch: 5 | loss: 0.4236521
	speed: 0.0510s/iter; left time: 1787.5344s
	iters: 900, epoch: 5 | loss: 0.7349312
	speed: 0.0509s/iter; left time: 1777.9055s
	iters: 1000, epoch: 5 | loss: 0.4489561
	speed: 0.0516s/iter; left time: 1796.8162s
	iters: 1100, epoch: 5 | loss: 0.4381767
	speed: 0.0492s/iter; left time: 1707.7781s
	iters: 1200, epoch: 5 | loss: 0.4522936
	speed: 0.0492s/iter; left time: 1703.1939s
	iters: 1300, epoch: 5 | loss: 0.4740657
	speed: 0.0461s/iter; left time: 1591.5824s
	iters: 1400, epoch: 5 | loss: 0.5251846
	speed: 0.0486s/iter; left time: 1672.4533s
	iters: 1500, epoch: 5 | loss: 0.4097975
	speed: 0.0493s/iter; left time: 1692.9807s
	iters: 1600, epoch: 5 | loss: 0.9183821
	speed: 0.0513s/iter; left time: 1755.5599s
	iters: 1700, epoch: 5 | loss: 0.4858968
	speed: 0.0497s/iter; left time: 1697.1149s
	iters: 1800, epoch: 5 | loss: 0.6356292
	speed: 0.0475s/iter; left time: 1617.0213s
	iters: 1900, epoch: 5 | loss: 0.7538800
	speed: 0.0502s/iter; left time: 1702.3905s
	iters: 2000, epoch: 5 | loss: 0.4742270
	speed: 0.0475s/iter; left time: 1607.3410s
	iters: 2100, epoch: 5 | loss: 0.7048988
	speed: 0.0446s/iter; left time: 1503.9164s
	iters: 2200, epoch: 5 | loss: 0.4345997
	speed: 0.0483s/iter; left time: 1625.3665s
Epoch: 5 cost time: 109.75070023536682
Epoch: 5, Steps: 2239 | Train Loss: 0.6324381 Vali Loss: 0.6068243 Test Loss: 0.3297019
Validation loss decreased (0.632989 --> 0.606824).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.4828818
	speed: 0.1492s/iter; left time: 4997.2101s
	iters: 200, epoch: 6 | loss: 0.5617133
	speed: 0.0406s/iter; left time: 1354.8068s
	iters: 300, epoch: 6 | loss: 0.6937992
	speed: 0.0434s/iter; left time: 1445.1138s
	iters: 400, epoch: 6 | loss: 0.5614088
	speed: 0.0505s/iter; left time: 1674.6528s
	iters: 500, epoch: 6 | loss: 0.4782803
	speed: 0.0453s/iter; left time: 1500.4004s
	iters: 600, epoch: 6 | loss: 0.7340385
	speed: 0.0502s/iter; left time: 1655.6113s
	iters: 700, epoch: 6 | loss: 0.3702110
	speed: 0.0508s/iter; left time: 1670.5016s
	iters: 800, epoch: 6 | loss: 0.7445453
	speed: 0.0499s/iter; left time: 1637.4296s
	iters: 900, epoch: 6 | loss: 0.5586548
	speed: 0.0494s/iter; left time: 1613.4173s
	iters: 1000, epoch: 6 | loss: 0.4795803
	speed: 0.0517s/iter; left time: 1684.6286s
	iters: 1100, epoch: 6 | loss: 1.0237128
	speed: 0.0557s/iter; left time: 1808.6582s
	iters: 1200, epoch: 6 | loss: 0.4228105
	speed: 0.0522s/iter; left time: 1691.9491s
	iters: 1300, epoch: 6 | loss: 0.4141422
	speed: 0.0518s/iter; left time: 1671.0434s
	iters: 1400, epoch: 6 | loss: 1.0371379
	speed: 0.0462s/iter; left time: 1486.9348s
	iters: 1500, epoch: 6 | loss: 0.6787115
	speed: 0.0519s/iter; left time: 1663.7843s
	iters: 1600, epoch: 6 | loss: 0.4425722
	speed: 0.0538s/iter; left time: 1720.2443s
	iters: 1700, epoch: 6 | loss: 0.6322057
	speed: 0.0461s/iter; left time: 1471.0334s
	iters: 1800, epoch: 6 | loss: 0.5279894
	speed: 0.0500s/iter; left time: 1588.4793s
	iters: 1900, epoch: 6 | loss: 0.7517168
	speed: 0.0501s/iter; left time: 1585.9528s
	iters: 2000, epoch: 6 | loss: 0.4907419
	speed: 0.0468s/iter; left time: 1477.1121s
	iters: 2100, epoch: 6 | loss: 0.4453886
	speed: 0.0523s/iter; left time: 1646.1419s
	iters: 2200, epoch: 6 | loss: 0.4886502
	speed: 0.0493s/iter; left time: 1546.8172s
Epoch: 6 cost time: 109.5453999042511
Epoch: 6, Steps: 2239 | Train Loss: 0.6144088 Vali Loss: 0.5988073 Test Loss: 0.3143190
Validation loss decreased (0.606824 --> 0.598807).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.5444854
	speed: 0.1504s/iter; left time: 4700.5135s
	iters: 200, epoch: 7 | loss: 0.6756154
	speed: 0.0417s/iter; left time: 1299.2782s
	iters: 300, epoch: 7 | loss: 0.5112390
	speed: 0.0511s/iter; left time: 1586.3925s
	iters: 400, epoch: 7 | loss: 0.6638684
	speed: 0.0482s/iter; left time: 1493.0026s
	iters: 500, epoch: 7 | loss: 0.4498220
	speed: 0.0513s/iter; left time: 1581.2015s
	iters: 600, epoch: 7 | loss: 0.7136037
	speed: 0.0450s/iter; left time: 1383.9025s
	iters: 700, epoch: 7 | loss: 0.4682961
	speed: 0.0494s/iter; left time: 1513.4232s
	iters: 800, epoch: 7 | loss: 0.5382529
	speed: 0.0504s/iter; left time: 1539.1567s
	iters: 900, epoch: 7 | loss: 0.4576996
	speed: 0.0483s/iter; left time: 1470.7085s
	iters: 1000, epoch: 7 | loss: 0.4033681
	speed: 0.0527s/iter; left time: 1600.6120s
	iters: 1100, epoch: 7 | loss: 0.5387899
	speed: 0.0535s/iter; left time: 1618.7012s
	iters: 1200, epoch: 7 | loss: 0.3411553
	speed: 0.0507s/iter; left time: 1529.3917s
	iters: 1300, epoch: 7 | loss: 0.4747555
	speed: 0.0463s/iter; left time: 1390.3318s
	iters: 1400, epoch: 7 | loss: 0.4717987
	speed: 0.0448s/iter; left time: 1342.5914s
	iters: 1500, epoch: 7 | loss: 0.5137263
	speed: 0.0487s/iter; left time: 1453.4367s
	iters: 1600, epoch: 7 | loss: 0.5644808
	speed: 0.0502s/iter; left time: 1493.8558s
	iters: 1700, epoch: 7 | loss: 0.6547393
	speed: 0.0497s/iter; left time: 1472.4966s
	iters: 1800, epoch: 7 | loss: 0.3711352
	speed: 0.0516s/iter; left time: 1524.9342s
	iters: 1900, epoch: 7 | loss: 0.7587487
	speed: 0.0508s/iter; left time: 1495.0756s
	iters: 2000, epoch: 7 | loss: 0.7651770
	speed: 0.0528s/iter; left time: 1549.0317s
	iters: 2100, epoch: 7 | loss: 0.5986899
	speed: 0.0538s/iter; left time: 1574.1719s
	iters: 2200, epoch: 7 | loss: 0.4542916
	speed: 0.0563s/iter; left time: 1639.7096s
Epoch: 7 cost time: 110.53407502174377
Epoch: 7, Steps: 2239 | Train Loss: 0.6059597 Vali Loss: 0.5982800 Test Loss: 0.3131918
Validation loss decreased (0.598807 --> 0.598280).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.7385713
	speed: 0.1492s/iter; left time: 4328.0130s
	iters: 200, epoch: 8 | loss: 0.4822843
	speed: 0.0418s/iter; left time: 1209.4202s
	iters: 300, epoch: 8 | loss: 0.4399395
	speed: 0.0471s/iter; left time: 1355.7262s
	iters: 400, epoch: 8 | loss: 0.6099288
	speed: 0.0472s/iter; left time: 1354.0323s
	iters: 500, epoch: 8 | loss: 0.4491681
	speed: 0.0457s/iter; left time: 1307.2602s
	iters: 600, epoch: 8 | loss: 0.4797660
	speed: 0.0538s/iter; left time: 1534.5615s
	iters: 700, epoch: 8 | loss: 0.6598147
	speed: 0.0446s/iter; left time: 1267.3430s
	iters: 800, epoch: 8 | loss: 0.7032272
	speed: 0.0483s/iter; left time: 1366.5884s
	iters: 900, epoch: 8 | loss: 0.9544654
	speed: 0.0498s/iter; left time: 1404.5217s
	iters: 1000, epoch: 8 | loss: 0.8507485
	speed: 0.0505s/iter; left time: 1420.3454s
	iters: 1100, epoch: 8 | loss: 0.4695272
	speed: 0.0510s/iter; left time: 1427.9304s
	iters: 1200, epoch: 8 | loss: 0.5716103
	speed: 0.0445s/iter; left time: 1242.0870s
	iters: 1300, epoch: 8 | loss: 0.5167224
	speed: 0.0487s/iter; left time: 1355.5441s
	iters: 1400, epoch: 8 | loss: 0.4498715
	speed: 0.0499s/iter; left time: 1382.5615s
	iters: 1500, epoch: 8 | loss: 0.4230317
	speed: 0.0523s/iter; left time: 1443.8779s
	iters: 1600, epoch: 8 | loss: 0.4219353
	speed: 0.0467s/iter; left time: 1284.1247s
	iters: 1700, epoch: 8 | loss: 0.5505974
	speed: 0.0478s/iter; left time: 1310.4879s
	iters: 1800, epoch: 8 | loss: 0.9704754
	speed: 0.0510s/iter; left time: 1393.3247s
	iters: 1900, epoch: 8 | loss: 0.5164337
	speed: 0.0533s/iter; left time: 1450.0727s
	iters: 2000, epoch: 8 | loss: 0.5273455
	speed: 0.0497s/iter; left time: 1346.0743s
	iters: 2100, epoch: 8 | loss: 0.4922427
	speed: 0.0476s/iter; left time: 1284.3182s
	iters: 2200, epoch: 8 | loss: 0.4523564
	speed: 0.0541s/iter; left time: 1456.6772s
Epoch: 8 cost time: 108.04432320594788
Epoch: 8, Steps: 2239 | Train Loss: 0.6016114 Vali Loss: 0.6017914 Test Loss: 0.3215557
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.3878405
	speed: 0.1605s/iter; left time: 4295.9546s
	iters: 200, epoch: 9 | loss: 0.6763890
	speed: 0.0416s/iter; left time: 1109.1010s
	iters: 300, epoch: 9 | loss: 0.9319053
	speed: 0.0457s/iter; left time: 1213.0874s
	iters: 400, epoch: 9 | loss: 0.4547139
	speed: 0.0500s/iter; left time: 1324.3698s
	iters: 500, epoch: 9 | loss: 0.8142348
	speed: 0.0482s/iter; left time: 1270.9557s
	iters: 600, epoch: 9 | loss: 0.4581619
	speed: 0.0545s/iter; left time: 1430.5793s
	iters: 700, epoch: 9 | loss: 0.5385852
	speed: 0.0532s/iter; left time: 1391.2771s
	iters: 800, epoch: 9 | loss: 0.4723410
	speed: 0.0465s/iter; left time: 1212.1429s
	iters: 900, epoch: 9 | loss: 0.4662427
	speed: 0.0459s/iter; left time: 1192.2288s
	iters: 1000, epoch: 9 | loss: 0.5526767
	speed: 0.0530s/iter; left time: 1370.7072s
	iters: 1100, epoch: 9 | loss: 0.8736477
	speed: 0.0551s/iter; left time: 1419.6651s
	iters: 1200, epoch: 9 | loss: 0.4243294
	speed: 0.0492s/iter; left time: 1262.8119s
	iters: 1300, epoch: 9 | loss: 0.4829436
	speed: 0.0461s/iter; left time: 1179.0616s
	iters: 1400, epoch: 9 | loss: 0.6858599
	speed: 0.0511s/iter; left time: 1300.5813s
	iters: 1500, epoch: 9 | loss: 0.7330214
	speed: 0.0466s/iter; left time: 1182.3471s
	iters: 1600, epoch: 9 | loss: 0.6480558
	speed: 0.0498s/iter; left time: 1259.6013s
	iters: 1700, epoch: 9 | loss: 0.4158778
	speed: 0.0517s/iter; left time: 1302.3888s
	iters: 1800, epoch: 9 | loss: 0.7202988
	speed: 0.0520s/iter; left time: 1304.8157s
	iters: 1900, epoch: 9 | loss: 0.5632547
	speed: 0.0479s/iter; left time: 1196.0592s
	iters: 2000, epoch: 9 | loss: 1.1183878
	speed: 0.0507s/iter; left time: 1261.9914s
	iters: 2100, epoch: 9 | loss: 0.7163940
	speed: 0.0468s/iter; left time: 1159.9593s
	iters: 2200, epoch: 9 | loss: 0.4582895
	speed: 0.0475s/iter; left time: 1171.2663s
Epoch: 9 cost time: 109.10990142822266
Epoch: 9, Steps: 2239 | Train Loss: 0.5995635 Vali Loss: 0.5912803 Test Loss: 0.3164202
Validation loss decreased (0.598280 --> 0.591280).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.5135668
	speed: 0.1552s/iter; left time: 3808.0760s
	iters: 200, epoch: 10 | loss: 0.5110443
	speed: 0.0434s/iter; left time: 1059.8225s
	iters: 300, epoch: 10 | loss: 0.5541119
	speed: 0.0462s/iter; left time: 1122.9819s
	iters: 400, epoch: 10 | loss: 0.5691647
	speed: 0.0479s/iter; left time: 1160.4023s
	iters: 500, epoch: 10 | loss: 0.7558892
	speed: 0.0499s/iter; left time: 1204.5194s
	iters: 600, epoch: 10 | loss: 0.4596968
	speed: 0.0535s/iter; left time: 1286.0061s
	iters: 700, epoch: 10 | loss: 0.7231652
	speed: 0.0451s/iter; left time: 1079.5153s
	iters: 800, epoch: 10 | loss: 0.3677374
	speed: 0.0561s/iter; left time: 1335.8525s
	iters: 900, epoch: 10 | loss: 0.5529010
	speed: 0.0517s/iter; left time: 1225.8556s
	iters: 1000, epoch: 10 | loss: 0.3773324
	speed: 0.0507s/iter; left time: 1197.1337s
	iters: 1100, epoch: 10 | loss: 0.7483466
	speed: 0.0476s/iter; left time: 1120.1271s
	iters: 1200, epoch: 10 | loss: 0.5921966
	speed: 0.0512s/iter; left time: 1198.8679s
	iters: 1300, epoch: 10 | loss: 1.0270201
	speed: 0.0484s/iter; left time: 1129.6982s
	iters: 1400, epoch: 10 | loss: 0.4243495
	speed: 0.0497s/iter; left time: 1153.9076s
	iters: 1500, epoch: 10 | loss: 0.4717057
	speed: 0.0547s/iter; left time: 1265.7565s
	iters: 1600, epoch: 10 | loss: 0.5253466
	speed: 0.0513s/iter; left time: 1180.6725s
	iters: 1700, epoch: 10 | loss: 0.7001483
	speed: 0.0489s/iter; left time: 1121.2183s
	iters: 1800, epoch: 10 | loss: 0.5795283
	speed: 0.0474s/iter; left time: 1082.1386s
	iters: 1900, epoch: 10 | loss: 0.5223804
	speed: 0.0519s/iter; left time: 1178.5709s
	iters: 2000, epoch: 10 | loss: 0.6865954
	speed: 0.0478s/iter; left time: 1082.6154s
	iters: 2100, epoch: 10 | loss: 0.8960178
	speed: 0.0496s/iter; left time: 1118.1219s
	iters: 2200, epoch: 10 | loss: 0.4255565
	speed: 0.0490s/iter; left time: 1099.1577s
Epoch: 10 cost time: 109.82274150848389
Epoch: 10, Steps: 2239 | Train Loss: 0.5984180 Vali Loss: 0.5919943 Test Loss: 0.3168204
EarlyStopping counter: 1 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.4532863
	speed: 0.1525s/iter; left time: 3400.3164s
	iters: 200, epoch: 11 | loss: 0.8671691
	speed: 0.0447s/iter; left time: 991.0726s
	iters: 300, epoch: 11 | loss: 0.4571134
	speed: 0.0396s/iter; left time: 875.6860s
	iters: 400, epoch: 11 | loss: 0.4509512
	speed: 0.0432s/iter; left time: 949.7934s
	iters: 500, epoch: 11 | loss: 0.6604387
	speed: 0.0435s/iter; left time: 952.3922s
	iters: 600, epoch: 11 | loss: 0.7367746
	speed: 0.0455s/iter; left time: 990.9392s
	iters: 700, epoch: 11 | loss: 0.4823711
	speed: 0.0503s/iter; left time: 1090.2994s
	iters: 800, epoch: 11 | loss: 0.5715412
	speed: 0.0509s/iter; left time: 1098.0639s
	iters: 900, epoch: 11 | loss: 0.6941488
	speed: 0.0475s/iter; left time: 1021.4172s
	iters: 1000, epoch: 11 | loss: 0.3884597
	speed: 0.0521s/iter; left time: 1113.8524s
	iters: 1100, epoch: 11 | loss: 0.4334303
	speed: 0.0487s/iter; left time: 1037.4425s
	iters: 1200, epoch: 11 | loss: 0.4881970
	speed: 0.0493s/iter; left time: 1044.3398s
	iters: 1300, epoch: 11 | loss: 0.5063707
	speed: 0.0516s/iter; left time: 1087.9482s
	iters: 1400, epoch: 11 | loss: 0.7181117
	speed: 0.0513s/iter; left time: 1076.4575s
	iters: 1500, epoch: 11 | loss: 0.3577892
	speed: 0.0480s/iter; left time: 1002.7014s
	iters: 1600, epoch: 11 | loss: 0.7774215
	speed: 0.0494s/iter; left time: 1027.0872s
	iters: 1700, epoch: 11 | loss: 0.4697961
	speed: 0.0477s/iter; left time: 987.5854s
	iters: 1800, epoch: 11 | loss: 0.4730404
	speed: 0.0451s/iter; left time: 928.0499s
	iters: 1900, epoch: 11 | loss: 0.6008239
	speed: 0.0507s/iter; left time: 1037.8923s
	iters: 2000, epoch: 11 | loss: 0.3930455
	speed: 0.0461s/iter; left time: 939.9431s
	iters: 2100, epoch: 11 | loss: 0.3938797
	speed: 0.0445s/iter; left time: 903.4685s
	iters: 2200, epoch: 11 | loss: 0.3942119
	speed: 0.0483s/iter; left time: 976.1516s
Epoch: 11 cost time: 105.62015914916992
Epoch: 11, Steps: 2239 | Train Loss: 0.5979115 Vali Loss: 0.5912936 Test Loss: 0.3173702
EarlyStopping counter: 2 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.5004272
	speed: 0.1585s/iter; left time: 3178.7575s
	iters: 200, epoch: 12 | loss: 1.0939384
	speed: 0.0407s/iter; left time: 811.2380s
	iters: 300, epoch: 12 | loss: 0.6390657
	speed: 0.0419s/iter; left time: 832.4780s
	iters: 400, epoch: 12 | loss: 0.6602021
	speed: 0.0420s/iter; left time: 829.3809s
	iters: 500, epoch: 12 | loss: 0.4523218
	speed: 0.0473s/iter; left time: 929.9670s
	iters: 600, epoch: 12 | loss: 0.5313463
	speed: 0.0428s/iter; left time: 836.2723s
	iters: 700, epoch: 12 | loss: 0.5118583
	speed: 0.0473s/iter; left time: 919.1483s
	iters: 800, epoch: 12 | loss: 0.3987230
	speed: 0.0435s/iter; left time: 841.7894s
	iters: 900, epoch: 12 | loss: 0.3929745
	speed: 0.0425s/iter; left time: 818.3751s
	iters: 1000, epoch: 12 | loss: 0.6661958
	speed: 0.0472s/iter; left time: 904.3613s
	iters: 1100, epoch: 12 | loss: 0.5598642
	speed: 0.0460s/iter; left time: 876.2508s
	iters: 1200, epoch: 12 | loss: 0.5068552
	speed: 0.0434s/iter; left time: 823.1613s
	iters: 1300, epoch: 12 | loss: 0.5719606
	speed: 0.0408s/iter; left time: 768.2254s
	iters: 1400, epoch: 12 | loss: 0.4501484
	speed: 0.0405s/iter; left time: 759.2281s
	iters: 1500, epoch: 12 | loss: 0.5773821
	speed: 0.0424s/iter; left time: 791.4147s
	iters: 1600, epoch: 12 | loss: 0.4197330
	speed: 0.0448s/iter; left time: 831.4094s
	iters: 1700, epoch: 12 | loss: 0.5027365
	speed: 0.0409s/iter; left time: 754.1101s
	iters: 1800, epoch: 12 | loss: 0.6622795
	speed: 0.0412s/iter; left time: 756.8551s
	iters: 1900, epoch: 12 | loss: 0.5788367
	speed: 0.0426s/iter; left time: 777.9791s
	iters: 2000, epoch: 12 | loss: 0.4409246
	speed: 0.0418s/iter; left time: 758.6854s
	iters: 2100, epoch: 12 | loss: 0.4124227
	speed: 0.0388s/iter; left time: 700.3269s
	iters: 2200, epoch: 12 | loss: 0.9460925
	speed: 0.0418s/iter; left time: 749.8770s
Epoch: 12 cost time: 95.64799857139587
Epoch: 12, Steps: 2239 | Train Loss: 0.5975444 Vali Loss: 0.5931793 Test Loss: 0.3175569
EarlyStopping counter: 3 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.5041583
	speed: 0.1489s/iter; left time: 2652.1728s
	iters: 200, epoch: 13 | loss: 0.7215388
	speed: 0.0385s/iter; left time: 682.6000s
	iters: 300, epoch: 13 | loss: 0.4141680
	speed: 0.0387s/iter; left time: 681.6770s
	iters: 400, epoch: 13 | loss: 0.5501301
	speed: 0.0407s/iter; left time: 712.1364s
	iters: 500, epoch: 13 | loss: 0.4553998
	speed: 0.0425s/iter; left time: 739.7510s
	iters: 600, epoch: 13 | loss: 0.3764635
	speed: 0.0417s/iter; left time: 722.7266s
	iters: 700, epoch: 13 | loss: 0.3397883
	speed: 0.0430s/iter; left time: 740.9385s
	iters: 800, epoch: 13 | loss: 0.6555694
	speed: 0.0404s/iter; left time: 692.1049s
	iters: 900, epoch: 13 | loss: 3.0393488
	speed: 0.0427s/iter; left time: 726.5400s
	iters: 1000, epoch: 13 | loss: 0.4993955
	speed: 0.0417s/iter; left time: 705.9487s
	iters: 1100, epoch: 13 | loss: 0.4491425
	speed: 0.0421s/iter; left time: 707.8942s
	iters: 1200, epoch: 13 | loss: 0.9841502
	speed: 0.0429s/iter; left time: 716.3782s
	iters: 1300, epoch: 13 | loss: 0.4445958
	speed: 0.0438s/iter; left time: 727.7583s
	iters: 1400, epoch: 13 | loss: 0.4989654
	speed: 0.0432s/iter; left time: 713.8468s
	iters: 1500, epoch: 13 | loss: 0.5675048
	speed: 0.0422s/iter; left time: 693.4020s
	iters: 1600, epoch: 13 | loss: 0.3896745
	speed: 0.0443s/iter; left time: 722.0616s
	iters: 1700, epoch: 13 | loss: 0.4738914
	speed: 0.0462s/iter; left time: 749.6040s
	iters: 1800, epoch: 13 | loss: 0.4496540
	speed: 0.0439s/iter; left time: 707.7060s
	iters: 1900, epoch: 13 | loss: 0.4203016
	speed: 0.0424s/iter; left time: 679.1437s
	iters: 2000, epoch: 13 | loss: 0.5374740
	speed: 0.0435s/iter; left time: 692.5387s
	iters: 2100, epoch: 13 | loss: 0.3914065
	speed: 0.0449s/iter; left time: 710.0137s
	iters: 2200, epoch: 13 | loss: 0.7173064
	speed: 0.0453s/iter; left time: 711.3914s
Epoch: 13 cost time: 94.92662000656128
Epoch: 13, Steps: 2239 | Train Loss: 0.5973449 Vali Loss: 0.5932217 Test Loss: 0.3173087
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.5855193
	speed: 0.1430s/iter; left time: 2227.7809s
	iters: 200, epoch: 14 | loss: 0.4913712
	speed: 0.0354s/iter; left time: 548.2165s
	iters: 300, epoch: 14 | loss: 0.4134950
	speed: 0.0343s/iter; left time: 526.9583s
	iters: 400, epoch: 14 | loss: 0.4297684
	speed: 0.0390s/iter; left time: 595.3485s
	iters: 500, epoch: 14 | loss: 0.6151599
	speed: 0.0405s/iter; left time: 615.1666s
	iters: 600, epoch: 14 | loss: 0.4479615
	speed: 0.0413s/iter; left time: 622.5086s
	iters: 700, epoch: 14 | loss: 0.4101343
	speed: 0.0377s/iter; left time: 564.0594s
	iters: 800, epoch: 14 | loss: 0.4172416
	speed: 0.0360s/iter; left time: 536.0778s
	iters: 900, epoch: 14 | loss: 0.4663685
	speed: 0.0359s/iter; left time: 529.8704s
	iters: 1000, epoch: 14 | loss: 0.7052301
	speed: 0.0356s/iter; left time: 522.7391s
	iters: 1100, epoch: 14 | loss: 0.4232505
	speed: 0.0342s/iter; left time: 497.9039s
	iters: 1200, epoch: 14 | loss: 0.4826588
	speed: 0.0355s/iter; left time: 513.6703s
	iters: 1300, epoch: 14 | loss: 0.5046276
	speed: 0.0356s/iter; left time: 512.1492s
	iters: 1400, epoch: 14 | loss: 0.7749162
	speed: 0.0349s/iter; left time: 498.1554s
	iters: 1500, epoch: 14 | loss: 0.4957047
	speed: 0.0348s/iter; left time: 493.2007s
	iters: 1600, epoch: 14 | loss: 0.3536369
	speed: 0.0342s/iter; left time: 480.6500s
	iters: 1700, epoch: 14 | loss: 0.6858588
	speed: 0.0340s/iter; left time: 475.2579s
	iters: 1800, epoch: 14 | loss: 0.3780765
	speed: 0.0343s/iter; left time: 475.8465s
	iters: 1900, epoch: 14 | loss: 0.4638890
	speed: 0.0355s/iter; left time: 489.6245s
	iters: 2000, epoch: 14 | loss: 0.5342653
	speed: 0.0352s/iter; left time: 481.7688s
	iters: 2100, epoch: 14 | loss: 0.5107921
	speed: 0.0364s/iter; left time: 493.8457s
	iters: 2200, epoch: 14 | loss: 0.7603838
	speed: 0.0361s/iter; left time: 486.1673s
Epoch: 14 cost time: 80.48823118209839
Epoch: 14, Steps: 2239 | Train Loss: 0.5973158 Vali Loss: 0.5923690 Test Loss: 0.3173511
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : weather_336_720_Linear_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15726<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9820
mse:0.3163602650165558, mae:0.3586321175098419
