Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='NLinear', model_id='traffic_336_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=25565, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_336_96_NLinear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed25565>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11849
val 1661
test 3413
	iters: 100, epoch: 1 | loss: 0.8957997
	speed: 0.3135s/iter; left time: 4608.3379s
	iters: 200, epoch: 1 | loss: 1.0928075
	speed: 0.3001s/iter; left time: 4381.5945s
	iters: 300, epoch: 1 | loss: 0.7352077
	speed: 0.2996s/iter; left time: 4343.9038s
	iters: 400, epoch: 1 | loss: 0.7834923
	speed: 0.2993s/iter; left time: 4309.8564s
	iters: 500, epoch: 1 | loss: 1.0811689
	speed: 0.2997s/iter; left time: 4285.9990s
	iters: 600, epoch: 1 | loss: 0.8654260
	speed: 0.2987s/iter; left time: 4242.5128s
	iters: 700, epoch: 1 | loss: 0.9798471
	speed: 0.2985s/iter; left time: 4209.8150s
Epoch: 1 cost time: 223.11148500442505
Epoch: 1, Steps: 740 | Train Loss: 0.9742742 Vali Loss: 0.9462876 Test Loss: 1.1216356
Validation loss decreased (inf --> 0.946288).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.9731785
	speed: 0.6085s/iter; left time: 8495.1391s
	iters: 200, epoch: 2 | loss: 1.4840020
	speed: 0.2999s/iter; left time: 4157.3177s
	iters: 300, epoch: 2 | loss: 0.9165033
	speed: 0.2992s/iter; left time: 4117.3263s
	iters: 400, epoch: 2 | loss: 1.0786754
	speed: 0.2989s/iter; left time: 4083.1887s
	iters: 500, epoch: 2 | loss: 0.9212235
	speed: 0.2990s/iter; left time: 4054.1762s
	iters: 600, epoch: 2 | loss: 0.9641083
	speed: 0.2998s/iter; left time: 4036.1229s
	iters: 700, epoch: 2 | loss: 1.3511809
	speed: 0.2994s/iter; left time: 4000.3062s
Epoch: 2 cost time: 221.48455333709717
Epoch: 2, Steps: 740 | Train Loss: 1.0550562 Vali Loss: 0.9586811 Test Loss: 1.0532192
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.3414505
	speed: 0.6055s/iter; left time: 8005.6718s
	iters: 200, epoch: 3 | loss: 0.3871033
	speed: 0.2988s/iter; left time: 3920.2471s
	iters: 300, epoch: 3 | loss: 0.2978806
	speed: 0.2986s/iter; left time: 3888.7126s
	iters: 400, epoch: 3 | loss: 0.3271778
	speed: 0.2993s/iter; left time: 3867.5917s
	iters: 500, epoch: 3 | loss: 0.4591385
	speed: 0.2999s/iter; left time: 3845.3300s
	iters: 600, epoch: 3 | loss: 0.3844545
	speed: 0.2997s/iter; left time: 3811.8901s
	iters: 700, epoch: 3 | loss: 0.3625711
	speed: 0.3000s/iter; left time: 3786.3313s
Epoch: 3 cost time: 221.40705108642578
Epoch: 3, Steps: 740 | Train Loss: 0.3748820 Vali Loss: 0.5058644 Test Loss: 0.6064621
Validation loss decreased (0.946288 --> 0.505864).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.2307840
	speed: 0.6089s/iter; left time: 7599.1817s
	iters: 200, epoch: 4 | loss: 0.2799132
	speed: 0.2997s/iter; left time: 3710.7867s
	iters: 300, epoch: 4 | loss: 0.2764059
	speed: 0.2993s/iter; left time: 3675.2543s
	iters: 400, epoch: 4 | loss: 0.2387022
	speed: 0.2996s/iter; left time: 3649.0098s
	iters: 500, epoch: 4 | loss: 0.2485159
	speed: 0.2991s/iter; left time: 3612.8412s
	iters: 600, epoch: 4 | loss: 0.2972923
	speed: 0.2998s/iter; left time: 3592.2969s
	iters: 700, epoch: 4 | loss: 0.2547198
	speed: 0.2999s/iter; left time: 3562.7227s
Epoch: 4 cost time: 221.6223726272583
Epoch: 4, Steps: 740 | Train Loss: 0.2780031 Vali Loss: 0.3948327 Test Loss: 0.4827744
Validation loss decreased (0.505864 --> 0.394833).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.2541429
	speed: 0.6087s/iter; left time: 7147.3208s
	iters: 200, epoch: 5 | loss: 0.2502559
	speed: 0.2980s/iter; left time: 3469.3236s
	iters: 300, epoch: 5 | loss: 0.2493502
	speed: 0.2985s/iter; left time: 3445.1172s
	iters: 400, epoch: 5 | loss: 0.2542423
	speed: 0.2982s/iter; left time: 3411.1417s
	iters: 500, epoch: 5 | loss: 0.2255717
	speed: 0.2987s/iter; left time: 3387.9336s
	iters: 600, epoch: 5 | loss: 0.2433806
	speed: 0.2984s/iter; left time: 3354.6393s
	iters: 700, epoch: 5 | loss: 0.2454155
	speed: 0.2996s/iter; left time: 3338.2685s
Epoch: 5 cost time: 221.16900277137756
Epoch: 5, Steps: 740 | Train Loss: 0.2568521 Vali Loss: 0.3787437 Test Loss: 0.4558654
Validation loss decreased (0.394833 --> 0.378744).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.2221929
	speed: 0.6081s/iter; left time: 6689.1658s
	iters: 200, epoch: 6 | loss: 0.2455713
	speed: 0.2994s/iter; left time: 3263.2484s
	iters: 300, epoch: 6 | loss: 0.2611225
	speed: 0.2992s/iter; left time: 3231.4790s
	iters: 400, epoch: 6 | loss: 0.2522213
	speed: 0.2992s/iter; left time: 3201.6513s
	iters: 500, epoch: 6 | loss: 0.2334316
	speed: 0.2987s/iter; left time: 3166.0031s
	iters: 600, epoch: 6 | loss: 0.2924919
	speed: 0.2981s/iter; left time: 3130.1924s
	iters: 700, epoch: 6 | loss: 0.2451616
	speed: 0.2987s/iter; left time: 3106.7193s
Epoch: 6 cost time: 221.17117643356323
Epoch: 6, Steps: 740 | Train Loss: 0.2469374 Vali Loss: 0.3591538 Test Loss: 0.4378579
Validation loss decreased (0.378744 --> 0.359154).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.2474363
	speed: 0.6082s/iter; left time: 6241.1918s
	iters: 200, epoch: 7 | loss: 0.2167177
	speed: 0.3004s/iter; left time: 3051.8880s
	iters: 300, epoch: 7 | loss: 0.2345411
	speed: 0.2992s/iter; left time: 3010.7528s
	iters: 400, epoch: 7 | loss: 0.2387504
	speed: 0.2996s/iter; left time: 2984.2052s
	iters: 500, epoch: 7 | loss: 0.2321257
	speed: 0.2985s/iter; left time: 2943.2700s
	iters: 600, epoch: 7 | loss: 0.2452222
	speed: 0.2997s/iter; left time: 2924.9983s
	iters: 700, epoch: 7 | loss: 0.2451856
	speed: 0.2993s/iter; left time: 2891.2046s
Epoch: 7 cost time: 221.6389503479004
Epoch: 7, Steps: 740 | Train Loss: 0.2414514 Vali Loss: 0.3532167 Test Loss: 0.4304269
Validation loss decreased (0.359154 --> 0.353217).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.2302966
	speed: 0.6097s/iter; left time: 5805.1794s
	iters: 200, epoch: 8 | loss: 0.2553260
	speed: 0.2989s/iter; left time: 2816.3963s
	iters: 300, epoch: 8 | loss: 0.2484201
	speed: 0.2997s/iter; left time: 2793.1947s
	iters: 400, epoch: 8 | loss: 0.2750376
	speed: 0.2999s/iter; left time: 2765.6141s
	iters: 500, epoch: 8 | loss: 0.2668153
	speed: 0.2997s/iter; left time: 2733.4186s
	iters: 600, epoch: 8 | loss: 0.2746098
	speed: 0.2990s/iter; left time: 2697.3276s
	iters: 700, epoch: 8 | loss: 0.2570364
	speed: 0.2986s/iter; left time: 2663.6333s
Epoch: 8 cost time: 221.5264551639557
Epoch: 8, Steps: 740 | Train Loss: 0.2381879 Vali Loss: 0.3507003 Test Loss: 0.4269956
Validation loss decreased (0.353217 --> 0.350700).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.2446915
	speed: 0.6061s/iter; left time: 5321.9000s
	iters: 200, epoch: 9 | loss: 0.2484163
	speed: 0.3002s/iter; left time: 2606.2619s
	iters: 300, epoch: 9 | loss: 0.2814173
	speed: 0.2991s/iter; left time: 2566.3961s
	iters: 400, epoch: 9 | loss: 0.2196187
	speed: 0.2995s/iter; left time: 2539.6510s
	iters: 500, epoch: 9 | loss: 0.2398377
	speed: 0.2991s/iter; left time: 2507.1251s
	iters: 600, epoch: 9 | loss: 0.2488897
	speed: 0.2999s/iter; left time: 2483.4121s
	iters: 700, epoch: 9 | loss: 0.2181597
	speed: 0.3000s/iter; left time: 2454.1097s
Epoch: 9 cost time: 221.56254196166992
Epoch: 9, Steps: 740 | Train Loss: 0.2363015 Vali Loss: 0.3487068 Test Loss: 0.4245915
Validation loss decreased (0.350700 --> 0.348707).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.2453887
	speed: 0.6089s/iter; left time: 4896.0840s
	iters: 200, epoch: 10 | loss: 0.2049929
	speed: 0.3000s/iter; left time: 2382.5743s
	iters: 300, epoch: 10 | loss: 0.2658989
	speed: 0.2997s/iter; left time: 2349.8638s
	iters: 400, epoch: 10 | loss: 0.2106922
	speed: 0.2999s/iter; left time: 2321.6773s
	iters: 500, epoch: 10 | loss: 0.2090295
	speed: 0.3000s/iter; left time: 2292.4400s
	iters: 600, epoch: 10 | loss: 0.2179480
	speed: 0.3002s/iter; left time: 2263.6571s
	iters: 700, epoch: 10 | loss: 0.2171725
	speed: 0.2998s/iter; left time: 2230.6501s
Epoch: 10 cost time: 221.95443105697632
Epoch: 10, Steps: 740 | Train Loss: 0.2352172 Vali Loss: 0.3471880 Test Loss: 0.4233640
Validation loss decreased (0.348707 --> 0.347188).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.2076530
	speed: 0.6097s/iter; left time: 4451.6287s
	iters: 200, epoch: 11 | loss: 0.2477179
	speed: 0.2995s/iter; left time: 2157.0142s
	iters: 300, epoch: 11 | loss: 0.2180195
	speed: 0.2993s/iter; left time: 2125.2047s
	iters: 400, epoch: 11 | loss: 0.2736366
	speed: 0.2998s/iter; left time: 2099.1311s
	iters: 500, epoch: 11 | loss: 0.2509862
	speed: 0.3000s/iter; left time: 2070.4431s
	iters: 600, epoch: 11 | loss: 0.2587411
	speed: 0.2998s/iter; left time: 2038.7714s
	iters: 700, epoch: 11 | loss: 0.2205875
	speed: 0.3000s/iter; left time: 2010.1389s
Epoch: 11 cost time: 221.88066697120667
Epoch: 11, Steps: 740 | Train Loss: 0.2345570 Vali Loss: 0.3467758 Test Loss: 0.4230153
Validation loss decreased (0.347188 --> 0.346776).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.2031258
	speed: 0.6100s/iter; left time: 4002.5026s
	iters: 200, epoch: 12 | loss: 0.2380344
	speed: 0.2996s/iter; left time: 1935.6955s
	iters: 300, epoch: 12 | loss: 0.2144010
	speed: 0.3001s/iter; left time: 1908.7368s
	iters: 400, epoch: 12 | loss: 0.2244340
	speed: 0.2989s/iter; left time: 1871.3282s
	iters: 500, epoch: 12 | loss: 0.2443354
	speed: 0.2998s/iter; left time: 1847.2635s
	iters: 600, epoch: 12 | loss: 0.2414370
	speed: 0.3000s/iter; left time: 1818.2775s
	iters: 700, epoch: 12 | loss: 0.2228809
	speed: 0.3000s/iter; left time: 1788.3786s
Epoch: 12 cost time: 221.87502193450928
Epoch: 12, Steps: 740 | Train Loss: 0.2342602 Vali Loss: 0.3468891 Test Loss: 0.4229010
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.2499764
	speed: 0.6067s/iter; left time: 3531.4181s
	iters: 200, epoch: 13 | loss: 0.2437499
	speed: 0.2990s/iter; left time: 1710.5942s
	iters: 300, epoch: 13 | loss: 0.2913666
	speed: 0.3000s/iter; left time: 1686.2895s
	iters: 400, epoch: 13 | loss: 0.2091866
	speed: 0.3000s/iter; left time: 1656.2218s
	iters: 500, epoch: 13 | loss: 0.2507396
	speed: 0.2999s/iter; left time: 1625.8310s
	iters: 600, epoch: 13 | loss: 0.2166181
	speed: 0.2997s/iter; left time: 1594.8118s
	iters: 700, epoch: 13 | loss: 0.2190612
	speed: 0.3000s/iter; left time: 1566.4734s
Epoch: 13 cost time: 221.90623307228088
Epoch: 13, Steps: 740 | Train Loss: 0.2340407 Vali Loss: 0.3463556 Test Loss: 0.4226978
Validation loss decreased (0.346776 --> 0.346356).  Saving model ...
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 14 | loss: 0.2505599
	speed: 0.6095s/iter; left time: 3097.0045s
	iters: 200, epoch: 14 | loss: 0.2263742
	speed: 0.2999s/iter; left time: 1493.8561s
	iters: 300, epoch: 14 | loss: 0.2411578
	speed: 0.2998s/iter; left time: 1463.2630s
	iters: 400, epoch: 14 | loss: 0.2373015
	speed: 0.2998s/iter; left time: 1433.2163s
	iters: 500, epoch: 14 | loss: 0.2448522
	speed: 0.2993s/iter; left time: 1400.8250s
	iters: 600, epoch: 14 | loss: 0.2482520
	speed: 0.3000s/iter; left time: 1374.4584s
	iters: 700, epoch: 14 | loss: 0.2327938
	speed: 0.2998s/iter; left time: 1343.5367s
Epoch: 14 cost time: 221.8995623588562
Epoch: 14, Steps: 740 | Train Loss: 0.2339663 Vali Loss: 0.3468075 Test Loss: 0.4226813
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 15 | loss: 0.2190005
	speed: 0.6078s/iter; left time: 2638.3972s
	iters: 200, epoch: 15 | loss: 0.2096038
	speed: 0.3002s/iter; left time: 1272.9677s
	iters: 300, epoch: 15 | loss: 0.2315664
	speed: 0.2997s/iter; left time: 1241.1902s
	iters: 400, epoch: 15 | loss: 0.1973251
	speed: 0.2998s/iter; left time: 1211.4093s
	iters: 500, epoch: 15 | loss: 0.2396297
	speed: 0.3000s/iter; left time: 1182.2244s
	iters: 600, epoch: 15 | loss: 0.2222106
	speed: 0.3002s/iter; left time: 1153.0825s
	iters: 700, epoch: 15 | loss: 0.2471166
	speed: 0.2999s/iter; left time: 1121.9670s
Epoch: 15 cost time: 221.94334983825684
Epoch: 15, Steps: 740 | Train Loss: 0.2339342 Vali Loss: 0.3461820 Test Loss: 0.4226299
Validation loss decreased (0.346356 --> 0.346182).  Saving model ...
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 16 | loss: 0.2054270
	speed: 0.6093s/iter; left time: 2194.1851s
	iters: 200, epoch: 16 | loss: 0.2477462
	speed: 0.3005s/iter; left time: 1052.1149s
	iters: 300, epoch: 16 | loss: 0.2433913
	speed: 0.2996s/iter; left time: 1019.0398s
	iters: 400, epoch: 16 | loss: 0.2275886
	speed: 0.3000s/iter; left time: 990.3329s
	iters: 500, epoch: 16 | loss: 0.2097780
	speed: 0.2997s/iter; left time: 959.4962s
	iters: 600, epoch: 16 | loss: 0.2682462
	speed: 0.2989s/iter; left time: 926.8790s
	iters: 700, epoch: 16 | loss: 0.2353776
	speed: 0.2998s/iter; left time: 899.7155s
Epoch: 16 cost time: 221.9367163181305
Epoch: 16, Steps: 740 | Train Loss: 0.2338946 Vali Loss: 0.3460855 Test Loss: 0.4226214
Validation loss decreased (0.346182 --> 0.346086).  Saving model ...
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 17 | loss: 0.2506728
	speed: 0.6086s/iter; left time: 1741.3063s
	iters: 200, epoch: 17 | loss: 0.2317311
	speed: 0.3005s/iter; left time: 829.6691s
	iters: 300, epoch: 17 | loss: 0.2094226
	speed: 0.2998s/iter; left time: 797.8724s
	iters: 400, epoch: 17 | loss: 0.2487961
	speed: 0.2998s/iter; left time: 767.8039s
	iters: 500, epoch: 17 | loss: 0.2661804
	speed: 0.2998s/iter; left time: 737.8519s
	iters: 600, epoch: 17 | loss: 0.2098432
	speed: 0.3001s/iter; left time: 708.5014s
	iters: 700, epoch: 17 | loss: 0.2410433
	speed: 0.2997s/iter; left time: 677.6003s
Epoch: 17 cost time: 221.9013638496399
Epoch: 17, Steps: 740 | Train Loss: 0.2338858 Vali Loss: 0.3462429 Test Loss: 0.4226183
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 18 | loss: 0.2163940
	speed: 0.6067s/iter; left time: 1286.8293s
	iters: 200, epoch: 18 | loss: 0.2086983
	speed: 0.2986s/iter; left time: 603.5171s
	iters: 300, epoch: 18 | loss: 0.1955875
	speed: 0.2995s/iter; left time: 575.3720s
	iters: 400, epoch: 18 | loss: 0.2272820
	speed: 0.3000s/iter; left time: 546.2286s
	iters: 500, epoch: 18 | loss: 0.2478084
	speed: 0.2998s/iter; left time: 516.0068s
	iters: 600, epoch: 18 | loss: 0.2289822
	speed: 0.2999s/iter; left time: 486.1861s
	iters: 700, epoch: 18 | loss: 0.2047007
	speed: 0.2998s/iter; left time: 456.0087s
Epoch: 18 cost time: 221.74638748168945
Epoch: 18, Steps: 740 | Train Loss: 0.2338215 Vali Loss: 0.3464885 Test Loss: 0.4226193
EarlyStopping counter: 2 out of 5
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 19 | loss: 0.2129603
	speed: 0.6080s/iter; left time: 839.6748s
	iters: 200, epoch: 19 | loss: 0.2171126
	speed: 0.2997s/iter; left time: 383.9517s
	iters: 300, epoch: 19 | loss: 0.2459179
	speed: 0.3000s/iter; left time: 354.2580s
	iters: 400, epoch: 19 | loss: 0.2496160
	speed: 0.2998s/iter; left time: 324.0490s
	iters: 500, epoch: 19 | loss: 0.2478874
	speed: 0.3002s/iter; left time: 294.4539s
	iters: 600, epoch: 19 | loss: 0.1966981
	speed: 0.3000s/iter; left time: 264.2572s
	iters: 700, epoch: 19 | loss: 0.1965993
	speed: 0.2999s/iter; left time: 234.2485s
Epoch: 19 cost time: 221.9604353904724
Epoch: 19, Steps: 740 | Train Loss: 0.2338559 Vali Loss: 0.3468834 Test Loss: 0.4226183
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 20 | loss: 0.2498143
	speed: 0.6066s/iter; left time: 388.8616s
	iters: 200, epoch: 20 | loss: 0.2283664
	speed: 0.2993s/iter; left time: 161.9096s
	iters: 300, epoch: 20 | loss: 0.2206741
	speed: 0.2995s/iter; left time: 132.0797s
	iters: 400, epoch: 20 | loss: 0.2570115
	speed: 0.2997s/iter; left time: 102.2093s
	iters: 500, epoch: 20 | loss: 0.2145199
	speed: 0.3002s/iter; left time: 72.3565s
	iters: 600, epoch: 20 | loss: 0.2208351
	speed: 0.3002s/iter; left time: 42.3288s
	iters: 700, epoch: 20 | loss: 0.2159843
	speed: 0.2998s/iter; left time: 12.2912s
Epoch: 20 cost time: 221.75164008140564
Epoch: 20, Steps: 740 | Train Loss: 0.2338482 Vali Loss: 0.3464234 Test Loss: 0.4226183
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.9073486328125e-08
>>>>>>>testing : traffic_336_96_NLinear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed25565<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3413
mse:0.42289870977401733, mae:0.29413214325904846
