Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='NLinear', model_id='weather_336_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=28649, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : weather_336_96_NLinear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed28649>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36456
val 5175
test 10444
	iters: 100, epoch: 1 | loss: 4.4087930
	speed: 0.0083s/iter; left time: 375.1251s
	iters: 200, epoch: 1 | loss: 1.2071601
	speed: 0.0082s/iter; left time: 369.7406s
	iters: 300, epoch: 1 | loss: 3.6084371
	speed: 0.0075s/iter; left time: 341.3462s
	iters: 400, epoch: 1 | loss: 0.8167418
	speed: 0.0089s/iter; left time: 403.4050s
	iters: 500, epoch: 1 | loss: 0.5418801
	speed: 0.0097s/iter; left time: 434.9272s
	iters: 600, epoch: 1 | loss: 0.4487112
	speed: 0.0082s/iter; left time: 368.2619s
	iters: 700, epoch: 1 | loss: 2.1441872
	speed: 0.0092s/iter; left time: 412.8007s
	iters: 800, epoch: 1 | loss: 1.8211155
	speed: 0.0100s/iter; left time: 448.9809s
	iters: 900, epoch: 1 | loss: 0.5577045
	speed: 0.0084s/iter; left time: 376.1550s
	iters: 1000, epoch: 1 | loss: 1.3272502
	speed: 0.0092s/iter; left time: 411.8518s
	iters: 1100, epoch: 1 | loss: 0.9474309
	speed: 0.0091s/iter; left time: 405.1819s
	iters: 1200, epoch: 1 | loss: 0.9549924
	speed: 0.0089s/iter; left time: 395.4152s
	iters: 1300, epoch: 1 | loss: 1.1564469
	speed: 0.0098s/iter; left time: 434.6995s
	iters: 1400, epoch: 1 | loss: 0.3504748
	speed: 0.0091s/iter; left time: 400.1283s
	iters: 1500, epoch: 1 | loss: 0.5305246
	speed: 0.0095s/iter; left time: 417.7019s
	iters: 1600, epoch: 1 | loss: 0.3746827
	speed: 0.0069s/iter; left time: 305.0932s
	iters: 1700, epoch: 1 | loss: 0.3779774
	speed: 0.0097s/iter; left time: 425.1085s
	iters: 1800, epoch: 1 | loss: 0.6987557
	speed: 0.0091s/iter; left time: 398.2833s
	iters: 1900, epoch: 1 | loss: 0.3734767
	speed: 0.0092s/iter; left time: 399.5371s
	iters: 2000, epoch: 1 | loss: 0.4007212
	speed: 0.0087s/iter; left time: 379.9386s
	iters: 2100, epoch: 1 | loss: 2.9493492
	speed: 0.0087s/iter; left time: 375.9524s
	iters: 2200, epoch: 1 | loss: 0.4261055
	speed: 0.0092s/iter; left time: 398.5877s
Epoch: 1 cost time: 20.35079026222229
Epoch: 1, Steps: 2278 | Train Loss: 2.5349246 Vali Loss: 0.5897196 Test Loss: 0.2112765
Validation loss decreased (inf --> 0.589720).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 1.0922352
	speed: 0.0407s/iter; left time: 1756.7247s
	iters: 200, epoch: 2 | loss: 0.3539852
	speed: 0.0111s/iter; left time: 476.5769s
	iters: 300, epoch: 2 | loss: 0.4793417
	speed: 0.0105s/iter; left time: 450.1949s
	iters: 400, epoch: 2 | loss: 0.5870100
	speed: 0.0090s/iter; left time: 384.3380s
	iters: 500, epoch: 2 | loss: 1.0778685
	speed: 0.0080s/iter; left time: 342.7736s
	iters: 600, epoch: 2 | loss: 0.6814746
	speed: 0.0083s/iter; left time: 356.0881s
	iters: 700, epoch: 2 | loss: 0.9134405
	speed: 0.0088s/iter; left time: 373.4597s
	iters: 800, epoch: 2 | loss: 0.3438055
	speed: 0.0092s/iter; left time: 390.9314s
	iters: 900, epoch: 2 | loss: 0.6985980
	speed: 0.0077s/iter; left time: 325.5244s
	iters: 1000, epoch: 2 | loss: 0.3946725
	speed: 0.0089s/iter; left time: 374.7191s
	iters: 1100, epoch: 2 | loss: 0.3224627
	speed: 0.0096s/iter; left time: 404.6541s
	iters: 1200, epoch: 2 | loss: 0.7175269
	speed: 0.0088s/iter; left time: 371.3213s
	iters: 1300, epoch: 2 | loss: 6.8498545
	speed: 0.0090s/iter; left time: 377.5223s
	iters: 1400, epoch: 2 | loss: 0.9402179
	speed: 0.0080s/iter; left time: 333.4922s
	iters: 1500, epoch: 2 | loss: 2.6787941
	speed: 0.0084s/iter; left time: 351.4004s
	iters: 1600, epoch: 2 | loss: 0.4892576
	speed: 0.0085s/iter; left time: 353.0558s
	iters: 1700, epoch: 2 | loss: 0.6064239
	speed: 0.0084s/iter; left time: 347.7435s
	iters: 1800, epoch: 2 | loss: 0.6088209
	speed: 0.0080s/iter; left time: 333.6555s
	iters: 1900, epoch: 2 | loss: 0.4344259
	speed: 0.0089s/iter; left time: 369.6812s
	iters: 2000, epoch: 2 | loss: 0.3429449
	speed: 0.0091s/iter; left time: 373.7109s
	iters: 2100, epoch: 2 | loss: 0.7653003
	speed: 0.0085s/iter; left time: 348.8995s
	iters: 2200, epoch: 2 | loss: 0.5459139
	speed: 0.0096s/iter; left time: 393.7061s
Epoch: 2 cost time: 20.428675174713135
Epoch: 2, Steps: 2278 | Train Loss: 6.4662412 Vali Loss: 1.3136886 Test Loss: 0.3054914
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.4777827
	speed: 0.0368s/iter; left time: 1505.0075s
	iters: 200, epoch: 3 | loss: 0.5242566
	speed: 0.0093s/iter; left time: 378.0500s
	iters: 300, epoch: 3 | loss: 0.3148982
	speed: 0.0094s/iter; left time: 382.2714s
	iters: 400, epoch: 3 | loss: 0.4093401
	speed: 0.0088s/iter; left time: 355.8081s
	iters: 500, epoch: 3 | loss: 0.6710836
	speed: 0.0102s/iter; left time: 412.4704s
	iters: 600, epoch: 3 | loss: 0.7034765
	speed: 0.0089s/iter; left time: 360.5425s
	iters: 700, epoch: 3 | loss: 2.4762578
	speed: 0.0096s/iter; left time: 386.5123s
	iters: 800, epoch: 3 | loss: 0.7218961
	speed: 0.0089s/iter; left time: 359.5580s
	iters: 900, epoch: 3 | loss: 0.4813727
	speed: 0.0085s/iter; left time: 340.5789s
	iters: 1000, epoch: 3 | loss: 0.4733803
	speed: 0.0097s/iter; left time: 388.9697s
	iters: 1100, epoch: 3 | loss: 0.3389945
	speed: 0.0095s/iter; left time: 380.4479s
	iters: 1200, epoch: 3 | loss: 0.4244266
	speed: 0.0099s/iter; left time: 392.1636s
	iters: 1300, epoch: 3 | loss: 0.3931683
	speed: 0.0091s/iter; left time: 362.0108s
	iters: 1400, epoch: 3 | loss: 0.4527076
	speed: 0.0083s/iter; left time: 330.6351s
	iters: 1500, epoch: 3 | loss: 0.3610078
	speed: 0.0094s/iter; left time: 371.4455s
	iters: 1600, epoch: 3 | loss: 0.2454310
	speed: 0.0096s/iter; left time: 378.7998s
	iters: 1700, epoch: 3 | loss: 2.4505630
	speed: 0.0103s/iter; left time: 404.9484s
	iters: 1800, epoch: 3 | loss: 0.6044759
	speed: 0.0087s/iter; left time: 342.8107s
	iters: 1900, epoch: 3 | loss: 1.7416483
	speed: 0.0091s/iter; left time: 355.8841s
	iters: 2000, epoch: 3 | loss: 0.9133624
	speed: 0.0101s/iter; left time: 392.8899s
	iters: 2100, epoch: 3 | loss: 0.5668086
	speed: 0.0088s/iter; left time: 342.3857s
	iters: 2200, epoch: 3 | loss: 0.9386136
	speed: 0.0085s/iter; left time: 330.3238s
Epoch: 3 cost time: 21.233927488327026
Epoch: 3, Steps: 2278 | Train Loss: 79.8175103 Vali Loss: 0.4462174 Test Loss: 0.1664076
Validation loss decreased (0.589720 --> 0.446217).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 2.1965230
	speed: 0.0405s/iter; left time: 1564.4479s
	iters: 200, epoch: 4 | loss: 1.6593589
	speed: 0.0095s/iter; left time: 365.7533s
	iters: 300, epoch: 4 | loss: 0.3609097
	speed: 0.0093s/iter; left time: 359.0123s
	iters: 400, epoch: 4 | loss: 0.5505909
	speed: 0.0100s/iter; left time: 381.4319s
	iters: 500, epoch: 4 | loss: 0.3743610
	speed: 0.0099s/iter; left time: 379.9974s
	iters: 600, epoch: 4 | loss: 0.5867982
	speed: 0.0085s/iter; left time: 322.3253s
	iters: 700, epoch: 4 | loss: 0.2554547
	speed: 0.0074s/iter; left time: 279.6469s
	iters: 800, epoch: 4 | loss: 0.2885576
	speed: 0.0088s/iter; left time: 333.1001s
	iters: 900, epoch: 4 | loss: 0.1875159
	speed: 0.0092s/iter; left time: 349.1857s
	iters: 1000, epoch: 4 | loss: 0.3534202
	speed: 0.0094s/iter; left time: 353.2732s
	iters: 1100, epoch: 4 | loss: 0.5538161
	speed: 0.0100s/iter; left time: 375.2417s
	iters: 1200, epoch: 4 | loss: 0.2935736
	speed: 0.0101s/iter; left time: 380.6120s
	iters: 1300, epoch: 4 | loss: 0.2912452
	speed: 0.0100s/iter; left time: 373.6531s
	iters: 1400, epoch: 4 | loss: 0.2848916
	speed: 0.0080s/iter; left time: 297.5877s
	iters: 1500, epoch: 4 | loss: 0.2905533
	speed: 0.0075s/iter; left time: 279.3376s
	iters: 1600, epoch: 4 | loss: 0.6042349
	speed: 0.0090s/iter; left time: 333.2794s
	iters: 1700, epoch: 4 | loss: 0.2741420
	speed: 0.0086s/iter; left time: 319.1094s
	iters: 1800, epoch: 4 | loss: 0.3545892
	speed: 0.0101s/iter; left time: 371.9527s
	iters: 1900, epoch: 4 | loss: 0.2579007
	speed: 0.0082s/iter; left time: 301.3164s
	iters: 2000, epoch: 4 | loss: 0.2335962
	speed: 0.0089s/iter; left time: 326.2654s
	iters: 2100, epoch: 4 | loss: 0.3652111
	speed: 0.0088s/iter; left time: 321.2381s
	iters: 2200, epoch: 4 | loss: 0.6422811
	speed: 0.0090s/iter; left time: 329.9246s
Epoch: 4 cost time: 20.678001403808594
Epoch: 4, Steps: 2278 | Train Loss: 10.1731645 Vali Loss: 0.4414730 Test Loss: 0.1617569
Validation loss decreased (0.446217 --> 0.441473).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.2789129
	speed: 0.0365s/iter; left time: 1326.0738s
	iters: 200, epoch: 5 | loss: 0.2747472
	speed: 0.0084s/iter; left time: 306.2553s
	iters: 300, epoch: 5 | loss: 0.3251846
	speed: 0.0089s/iter; left time: 321.4623s
	iters: 400, epoch: 5 | loss: 0.2355077
	speed: 0.0088s/iter; left time: 316.5479s
	iters: 500, epoch: 5 | loss: 0.4178827
	speed: 0.0087s/iter; left time: 314.2975s
	iters: 600, epoch: 5 | loss: 0.3203090
	speed: 0.0087s/iter; left time: 311.6002s
	iters: 700, epoch: 5 | loss: 0.5906842
	speed: 0.0091s/iter; left time: 323.9779s
	iters: 800, epoch: 5 | loss: 0.8956537
	speed: 0.0088s/iter; left time: 313.3845s
	iters: 900, epoch: 5 | loss: 0.3292470
	speed: 0.0092s/iter; left time: 326.4591s
	iters: 1000, epoch: 5 | loss: 0.4696545
	speed: 0.0098s/iter; left time: 348.9445s
	iters: 1100, epoch: 5 | loss: 0.2919001
	speed: 0.0103s/iter; left time: 362.6025s
	iters: 1200, epoch: 5 | loss: 0.3915100
	speed: 0.0100s/iter; left time: 353.2622s
	iters: 1300, epoch: 5 | loss: 0.4596380
	speed: 0.0103s/iter; left time: 361.0193s
	iters: 1400, epoch: 5 | loss: 0.4661834
	speed: 0.0104s/iter; left time: 364.8681s
	iters: 1500, epoch: 5 | loss: 0.4591411
	speed: 0.0086s/iter; left time: 301.6834s
	iters: 1600, epoch: 5 | loss: 0.4371179
	speed: 0.0096s/iter; left time: 332.8891s
	iters: 1700, epoch: 5 | loss: 0.3713820
	speed: 0.0094s/iter; left time: 325.6366s
	iters: 1800, epoch: 5 | loss: 0.2684929
	speed: 0.0080s/iter; left time: 277.5889s
	iters: 1900, epoch: 5 | loss: 0.3286438
	speed: 0.0085s/iter; left time: 294.7181s
	iters: 2000, epoch: 5 | loss: 0.3534265
	speed: 0.0093s/iter; left time: 321.1757s
	iters: 2100, epoch: 5 | loss: 0.3369940
	speed: 0.0103s/iter; left time: 353.5240s
	iters: 2200, epoch: 5 | loss: 0.8246593
	speed: 0.0084s/iter; left time: 287.0213s
Epoch: 5 cost time: 20.854466438293457
Epoch: 5, Steps: 2278 | Train Loss: 1.9748604 Vali Loss: 0.5277274 Test Loss: 0.1565771
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.3975043
	speed: 0.0387s/iter; left time: 1317.7150s
	iters: 200, epoch: 6 | loss: 0.2851291
	speed: 0.0084s/iter; left time: 284.0718s
	iters: 300, epoch: 6 | loss: 0.2506665
	speed: 0.0086s/iter; left time: 289.9536s
	iters: 400, epoch: 6 | loss: 0.3949216
	speed: 0.0091s/iter; left time: 307.3917s
	iters: 500, epoch: 6 | loss: 0.5944632
	speed: 0.0095s/iter; left time: 321.2958s
	iters: 600, epoch: 6 | loss: 0.3314832
	speed: 0.0095s/iter; left time: 319.9826s
	iters: 700, epoch: 6 | loss: 0.3232966
	speed: 0.0096s/iter; left time: 320.4011s
	iters: 800, epoch: 6 | loss: 0.3672744
	speed: 0.0093s/iter; left time: 309.6920s
	iters: 900, epoch: 6 | loss: 0.3389701
	speed: 0.0098s/iter; left time: 327.0844s
	iters: 1000, epoch: 6 | loss: 0.2072557
	speed: 0.0092s/iter; left time: 305.5676s
	iters: 1100, epoch: 6 | loss: 0.2416196
	speed: 0.0094s/iter; left time: 310.2909s
	iters: 1200, epoch: 6 | loss: 0.2260516
	speed: 0.0108s/iter; left time: 357.2154s
	iters: 1300, epoch: 6 | loss: 0.2417835
	speed: 0.0098s/iter; left time: 322.4904s
	iters: 1400, epoch: 6 | loss: 0.3202910
	speed: 0.0090s/iter; left time: 295.6115s
	iters: 1500, epoch: 6 | loss: 2.2931509
	speed: 0.0102s/iter; left time: 331.6296s
	iters: 1600, epoch: 6 | loss: 0.2893761
	speed: 0.0100s/iter; left time: 325.1764s
	iters: 1700, epoch: 6 | loss: 2.0832872
	speed: 0.0086s/iter; left time: 279.0292s
	iters: 1800, epoch: 6 | loss: 0.2061162
	speed: 0.0089s/iter; left time: 289.5196s
	iters: 1900, epoch: 6 | loss: 0.8166549
	speed: 0.0088s/iter; left time: 285.0243s
	iters: 2000, epoch: 6 | loss: 0.2200783
	speed: 0.0100s/iter; left time: 323.0317s
	iters: 2100, epoch: 6 | loss: 0.2484643
	speed: 0.0106s/iter; left time: 338.3491s
	iters: 2200, epoch: 6 | loss: 0.2511310
	speed: 0.0092s/iter; left time: 295.4806s
Epoch: 6 cost time: 21.537187576293945
Epoch: 6, Steps: 2278 | Train Loss: 0.8496950 Vali Loss: 0.9604450 Test Loss: 0.1555409
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.1910639
	speed: 0.0396s/iter; left time: 1257.7741s
	iters: 200, epoch: 7 | loss: 0.3487623
	speed: 0.0081s/iter; left time: 255.7108s
	iters: 300, epoch: 7 | loss: 0.2463167
	speed: 0.0099s/iter; left time: 313.5174s
	iters: 400, epoch: 7 | loss: 0.4036647
	speed: 0.0102s/iter; left time: 321.9180s
	iters: 500, epoch: 7 | loss: 0.2930001
	speed: 0.0113s/iter; left time: 353.5588s
	iters: 600, epoch: 7 | loss: 0.2430480
	speed: 0.0115s/iter; left time: 358.4652s
	iters: 700, epoch: 7 | loss: 0.3929575
	speed: 0.0095s/iter; left time: 295.7880s
	iters: 800, epoch: 7 | loss: 0.6751757
	speed: 0.0090s/iter; left time: 278.9044s
	iters: 900, epoch: 7 | loss: 0.2226600
	speed: 0.0095s/iter; left time: 293.6005s
	iters: 1000, epoch: 7 | loss: 0.4110938
	speed: 0.0103s/iter; left time: 316.7347s
	iters: 1100, epoch: 7 | loss: 0.2828445
	speed: 0.0103s/iter; left time: 316.0359s
	iters: 1200, epoch: 7 | loss: 0.3192966
	speed: 0.0108s/iter; left time: 331.6139s
	iters: 1300, epoch: 7 | loss: 0.4185379
	speed: 0.0111s/iter; left time: 339.3788s
	iters: 1400, epoch: 7 | loss: 0.3519665
	speed: 0.0107s/iter; left time: 326.6687s
	iters: 1500, epoch: 7 | loss: 0.2757739
	speed: 0.0102s/iter; left time: 310.0679s
	iters: 1600, epoch: 7 | loss: 0.4339671
	speed: 0.0102s/iter; left time: 309.3679s
	iters: 1700, epoch: 7 | loss: 0.3298558
	speed: 0.0093s/iter; left time: 280.2831s
	iters: 1800, epoch: 7 | loss: 0.2952063
	speed: 0.0086s/iter; left time: 260.0120s
	iters: 1900, epoch: 7 | loss: 0.3135440
	speed: 0.0082s/iter; left time: 245.0432s
	iters: 2000, epoch: 7 | loss: 0.2166102
	speed: 0.0085s/iter; left time: 253.2614s
	iters: 2100, epoch: 7 | loss: 0.3469482
	speed: 0.0094s/iter; left time: 280.5315s
	iters: 2200, epoch: 7 | loss: 0.2196555
	speed: 0.0100s/iter; left time: 295.5104s
Epoch: 7 cost time: 22.326509952545166
Epoch: 7, Steps: 2278 | Train Loss: 0.4663102 Vali Loss: 0.4292631 Test Loss: 0.1451101
Validation loss decreased (0.441473 --> 0.429263).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.2208930
	speed: 0.0385s/iter; left time: 1135.9261s
	iters: 200, epoch: 8 | loss: 0.3207695
	speed: 0.0096s/iter; left time: 281.0528s
	iters: 300, epoch: 8 | loss: 0.4068915
	speed: 0.0097s/iter; left time: 283.0185s
	iters: 400, epoch: 8 | loss: 0.6301400
	speed: 0.0089s/iter; left time: 260.1081s
	iters: 500, epoch: 8 | loss: 0.3247050
	speed: 0.0098s/iter; left time: 285.1061s
	iters: 600, epoch: 8 | loss: 0.3274605
	speed: 0.0109s/iter; left time: 316.3258s
	iters: 700, epoch: 8 | loss: 0.2640256
	speed: 0.0111s/iter; left time: 321.8288s
	iters: 800, epoch: 8 | loss: 0.2851480
	speed: 0.0107s/iter; left time: 308.0989s
	iters: 900, epoch: 8 | loss: 0.2557861
	speed: 0.0100s/iter; left time: 285.7266s
	iters: 1000, epoch: 8 | loss: 0.2690313
	speed: 0.0096s/iter; left time: 275.3632s
	iters: 1100, epoch: 8 | loss: 0.3542005
	speed: 0.0099s/iter; left time: 282.8981s
	iters: 1200, epoch: 8 | loss: 0.4172992
	speed: 0.0087s/iter; left time: 246.4631s
	iters: 1300, epoch: 8 | loss: 0.3505688
	speed: 0.0084s/iter; left time: 238.4249s
	iters: 1400, epoch: 8 | loss: 0.4090230
	speed: 0.0086s/iter; left time: 242.4821s
	iters: 1500, epoch: 8 | loss: 0.5653366
	speed: 0.0089s/iter; left time: 248.8759s
	iters: 1600, epoch: 8 | loss: 0.1713359
	speed: 0.0089s/iter; left time: 249.8997s
	iters: 1700, epoch: 8 | loss: 0.2725234
	speed: 0.0083s/iter; left time: 230.8582s
	iters: 1800, epoch: 8 | loss: 0.3551052
	speed: 0.0097s/iter; left time: 269.8312s
	iters: 1900, epoch: 8 | loss: 0.2656226
	speed: 0.0111s/iter; left time: 307.7195s
	iters: 2000, epoch: 8 | loss: 0.1960165
	speed: 0.0098s/iter; left time: 269.8343s
	iters: 2100, epoch: 8 | loss: 0.6551346
	speed: 0.0092s/iter; left time: 253.4828s
	iters: 2200, epoch: 8 | loss: 0.4278260
	speed: 0.0103s/iter; left time: 281.0589s
Epoch: 8 cost time: 21.938588857650757
Epoch: 8, Steps: 2278 | Train Loss: 0.4314285 Vali Loss: 0.3761466 Test Loss: 0.1441986
Validation loss decreased (0.429263 --> 0.376147).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.5801215
	speed: 0.0419s/iter; left time: 1141.9298s
	iters: 200, epoch: 9 | loss: 0.3556826
	speed: 0.0105s/iter; left time: 285.5183s
	iters: 300, epoch: 9 | loss: 0.4024127
	speed: 0.0096s/iter; left time: 259.0079s
	iters: 400, epoch: 9 | loss: 0.2207376
	speed: 0.0096s/iter; left time: 257.5715s
	iters: 500, epoch: 9 | loss: 0.3026508
	speed: 0.0085s/iter; left time: 229.0003s
	iters: 600, epoch: 9 | loss: 0.2070330
	speed: 0.0107s/iter; left time: 286.7506s
	iters: 700, epoch: 9 | loss: 0.2100110
	speed: 0.0109s/iter; left time: 289.8965s
	iters: 800, epoch: 9 | loss: 0.1707324
	speed: 0.0109s/iter; left time: 290.3828s
	iters: 900, epoch: 9 | loss: 0.6405563
	speed: 0.0114s/iter; left time: 300.9360s
	iters: 1000, epoch: 9 | loss: 0.2146466
	speed: 0.0115s/iter; left time: 301.9018s
	iters: 1100, epoch: 9 | loss: 0.3866256
	speed: 0.0111s/iter; left time: 290.5618s
	iters: 1200, epoch: 9 | loss: 0.4986631
	speed: 0.0104s/iter; left time: 272.4519s
	iters: 1300, epoch: 9 | loss: 0.2171389
	speed: 0.0107s/iter; left time: 278.1487s
	iters: 1400, epoch: 9 | loss: 0.2669967
	speed: 0.0103s/iter; left time: 266.4720s
	iters: 1500, epoch: 9 | loss: 0.3073800
	speed: 0.0106s/iter; left time: 272.6619s
	iters: 1600, epoch: 9 | loss: 0.3110879
	speed: 0.0098s/iter; left time: 253.0439s
	iters: 1700, epoch: 9 | loss: 0.5919034
	speed: 0.0093s/iter; left time: 238.7418s
	iters: 1800, epoch: 9 | loss: 0.2948594
	speed: 0.0086s/iter; left time: 218.4404s
	iters: 1900, epoch: 9 | loss: 0.4190204
	speed: 0.0111s/iter; left time: 281.8909s
	iters: 2000, epoch: 9 | loss: 0.4612778
	speed: 0.0111s/iter; left time: 281.2888s
	iters: 2100, epoch: 9 | loss: 0.3912118
	speed: 0.0108s/iter; left time: 271.3070s
	iters: 2200, epoch: 9 | loss: 0.1897495
	speed: 0.0093s/iter; left time: 233.5980s
Epoch: 9 cost time: 23.404331922531128
Epoch: 9, Steps: 2278 | Train Loss: 0.4205979 Vali Loss: 0.3785167 Test Loss: 0.1444977
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.6054864
	speed: 0.0422s/iter; left time: 1054.0605s
	iters: 200, epoch: 10 | loss: 0.2979662
	speed: 0.0112s/iter; left time: 279.2398s
	iters: 300, epoch: 10 | loss: 0.2165474
	speed: 0.0109s/iter; left time: 269.2831s
	iters: 400, epoch: 10 | loss: 0.2598095
	speed: 0.0098s/iter; left time: 241.5022s
	iters: 500, epoch: 10 | loss: 0.3294484
	speed: 0.0093s/iter; left time: 229.4387s
	iters: 600, epoch: 10 | loss: 0.6763710
	speed: 0.0091s/iter; left time: 221.6538s
	iters: 700, epoch: 10 | loss: 0.2513628
	speed: 0.0098s/iter; left time: 238.2761s
	iters: 800, epoch: 10 | loss: 0.4388391
	speed: 0.0079s/iter; left time: 190.4892s
	iters: 900, epoch: 10 | loss: 0.2321708
	speed: 0.0073s/iter; left time: 175.9458s
	iters: 1000, epoch: 10 | loss: 0.2559715
	speed: 0.0099s/iter; left time: 238.9558s
	iters: 1100, epoch: 10 | loss: 0.3223324
	speed: 0.0098s/iter; left time: 233.9085s
	iters: 1200, epoch: 10 | loss: 0.4938377
	speed: 0.0090s/iter; left time: 215.3894s
	iters: 1300, epoch: 10 | loss: 0.8326870
	speed: 0.0087s/iter; left time: 207.7003s
	iters: 1400, epoch: 10 | loss: 0.2595576
	speed: 0.0087s/iter; left time: 205.7896s
	iters: 1500, epoch: 10 | loss: 0.5981410
	speed: 0.0093s/iter; left time: 219.8387s
	iters: 1600, epoch: 10 | loss: 0.5510966
	speed: 0.0096s/iter; left time: 225.7372s
	iters: 1700, epoch: 10 | loss: 0.3548663
	speed: 0.0095s/iter; left time: 220.9868s
	iters: 1800, epoch: 10 | loss: 0.2152419
	speed: 0.0099s/iter; left time: 231.1551s
	iters: 1900, epoch: 10 | loss: 0.3002746
	speed: 0.0096s/iter; left time: 222.3924s
	iters: 2000, epoch: 10 | loss: 0.4439493
	speed: 0.0086s/iter; left time: 198.1220s
	iters: 2100, epoch: 10 | loss: 0.2326208
	speed: 0.0087s/iter; left time: 200.2231s
	iters: 2200, epoch: 10 | loss: 0.2350943
	speed: 0.0090s/iter; left time: 206.4765s
Epoch: 10 cost time: 21.284079551696777
Epoch: 10, Steps: 2278 | Train Loss: 0.4181736 Vali Loss: 0.3786265 Test Loss: 0.1436004
EarlyStopping counter: 2 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.4764338
	speed: 0.0417s/iter; left time: 944.8439s
	iters: 200, epoch: 11 | loss: 0.4728616
	speed: 0.0105s/iter; left time: 238.0397s
	iters: 300, epoch: 11 | loss: 0.2636665
	speed: 0.0105s/iter; left time: 236.5921s
	iters: 400, epoch: 11 | loss: 0.1798019
	speed: 0.0100s/iter; left time: 224.7609s
	iters: 500, epoch: 11 | loss: 1.6315690
	speed: 0.0102s/iter; left time: 226.3814s
	iters: 600, epoch: 11 | loss: 0.1715111
	speed: 0.0109s/iter; left time: 240.7169s
	iters: 700, epoch: 11 | loss: 0.2576503
	speed: 0.0098s/iter; left time: 217.3612s
	iters: 800, epoch: 11 | loss: 0.2606640
	speed: 0.0104s/iter; left time: 228.5819s
	iters: 900, epoch: 11 | loss: 0.2875198
	speed: 0.0107s/iter; left time: 234.3735s
	iters: 1000, epoch: 11 | loss: 0.2455033
	speed: 0.0114s/iter; left time: 248.5630s
	iters: 1100, epoch: 11 | loss: 0.3098811
	speed: 0.0107s/iter; left time: 231.6536s
	iters: 1200, epoch: 11 | loss: 2.1697686
	speed: 0.0094s/iter; left time: 203.0405s
	iters: 1300, epoch: 11 | loss: 0.3242848
	speed: 0.0088s/iter; left time: 188.8077s
	iters: 1400, epoch: 11 | loss: 0.3169064
	speed: 0.0102s/iter; left time: 217.2175s
	iters: 1500, epoch: 11 | loss: 0.2855692
	speed: 0.0105s/iter; left time: 224.1016s
	iters: 1600, epoch: 11 | loss: 0.2392937
	speed: 0.0104s/iter; left time: 219.7126s
	iters: 1700, epoch: 11 | loss: 0.6576436
	speed: 0.0105s/iter; left time: 220.9487s
	iters: 1800, epoch: 11 | loss: 0.3975962
	speed: 0.0115s/iter; left time: 240.3422s
	iters: 1900, epoch: 11 | loss: 0.5401174
	speed: 0.0091s/iter; left time: 189.4419s
	iters: 2000, epoch: 11 | loss: 0.2300788
	speed: 0.0085s/iter; left time: 177.6346s
	iters: 2100, epoch: 11 | loss: 0.2929575
	speed: 0.0096s/iter; left time: 197.9708s
	iters: 2200, epoch: 11 | loss: 0.2217679
	speed: 0.0090s/iter; left time: 185.0990s
Epoch: 11 cost time: 22.867910623550415
Epoch: 11, Steps: 2278 | Train Loss: 0.4172483 Vali Loss: 0.3769293 Test Loss: 0.1435131
EarlyStopping counter: 3 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.4204504
	speed: 0.0386s/iter; left time: 786.6597s
	iters: 200, epoch: 12 | loss: 2.0668693
	speed: 0.0091s/iter; left time: 184.6388s
	iters: 300, epoch: 12 | loss: 0.3897395
	speed: 0.0091s/iter; left time: 183.2747s
	iters: 400, epoch: 12 | loss: 0.3663395
	speed: 0.0100s/iter; left time: 200.2332s
	iters: 500, epoch: 12 | loss: 0.5293902
	speed: 0.0099s/iter; left time: 197.2786s
	iters: 600, epoch: 12 | loss: 0.6795450
	speed: 0.0096s/iter; left time: 190.3274s
	iters: 700, epoch: 12 | loss: 0.6496486
	speed: 0.0085s/iter; left time: 167.6251s
	iters: 800, epoch: 12 | loss: 0.2869602
	speed: 0.0079s/iter; left time: 156.5164s
	iters: 900, epoch: 12 | loss: 0.3131432
	speed: 0.0102s/iter; left time: 198.9893s
	iters: 1000, epoch: 12 | loss: 0.3601651
	speed: 0.0084s/iter; left time: 163.6361s
	iters: 1100, epoch: 12 | loss: 0.7416208
	speed: 0.0089s/iter; left time: 172.3624s
	iters: 1200, epoch: 12 | loss: 0.1620081
	speed: 0.0095s/iter; left time: 184.1844s
	iters: 1300, epoch: 12 | loss: 0.5299203
	speed: 0.0106s/iter; left time: 202.7963s
	iters: 1400, epoch: 12 | loss: 0.3865526
	speed: 0.0105s/iter; left time: 200.6329s
	iters: 1500, epoch: 12 | loss: 0.3493495
	speed: 0.0109s/iter; left time: 207.1773s
	iters: 1600, epoch: 12 | loss: 0.2239724
	speed: 0.0111s/iter; left time: 210.7220s
	iters: 1700, epoch: 12 | loss: 0.4909177
	speed: 0.0104s/iter; left time: 196.3553s
	iters: 1800, epoch: 12 | loss: 0.4505097
	speed: 0.0115s/iter; left time: 214.9419s
	iters: 1900, epoch: 12 | loss: 0.1792600
	speed: 0.0112s/iter; left time: 209.1511s
	iters: 2000, epoch: 12 | loss: 0.2359318
	speed: 0.0104s/iter; left time: 192.8505s
	iters: 2100, epoch: 12 | loss: 0.3640162
	speed: 0.0106s/iter; left time: 195.4917s
	iters: 2200, epoch: 12 | loss: 0.1997725
	speed: 0.0106s/iter; left time: 193.3308s
Epoch: 12 cost time: 22.644947290420532
Epoch: 12, Steps: 2278 | Train Loss: 0.4166017 Vali Loss: 0.3783956 Test Loss: 0.1433799
EarlyStopping counter: 4 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.2651474
	speed: 0.0403s/iter; left time: 729.9004s
	iters: 200, epoch: 13 | loss: 0.3631724
	speed: 0.0086s/iter; left time: 155.5640s
	iters: 300, epoch: 13 | loss: 2.1537418
	speed: 0.0106s/iter; left time: 189.6016s
	iters: 400, epoch: 13 | loss: 0.3225942
	speed: 0.0108s/iter; left time: 192.9060s
	iters: 500, epoch: 13 | loss: 0.2708534
	speed: 0.0101s/iter; left time: 179.2431s
	iters: 600, epoch: 13 | loss: 0.3632625
	speed: 0.0097s/iter; left time: 171.5355s
	iters: 700, epoch: 13 | loss: 0.1767900
	speed: 0.0103s/iter; left time: 179.6962s
	iters: 800, epoch: 13 | loss: 0.2926854
	speed: 0.0095s/iter; left time: 164.8633s
	iters: 900, epoch: 13 | loss: 0.2594233
	speed: 0.0101s/iter; left time: 174.6652s
	iters: 1000, epoch: 13 | loss: 0.4969848
	speed: 0.0105s/iter; left time: 181.5930s
	iters: 1100, epoch: 13 | loss: 0.2789931
	speed: 0.0096s/iter; left time: 164.4595s
	iters: 1200, epoch: 13 | loss: 0.3649918
	speed: 0.0101s/iter; left time: 172.3344s
	iters: 1300, epoch: 13 | loss: 0.3566698
	speed: 0.0089s/iter; left time: 150.3174s
	iters: 1400, epoch: 13 | loss: 0.3136435
	speed: 0.0092s/iter; left time: 154.3225s
	iters: 1500, epoch: 13 | loss: 0.2104933
	speed: 0.0079s/iter; left time: 132.3236s
	iters: 1600, epoch: 13 | loss: 0.2728747
	speed: 0.0095s/iter; left time: 158.6094s
	iters: 1700, epoch: 13 | loss: 0.4861861
	speed: 0.0096s/iter; left time: 158.7090s
	iters: 1800, epoch: 13 | loss: 0.1512396
	speed: 0.0093s/iter; left time: 152.0956s
	iters: 1900, epoch: 13 | loss: 0.3123242
	speed: 0.0089s/iter; left time: 144.9954s
	iters: 2000, epoch: 13 | loss: 0.6876289
	speed: 0.0092s/iter; left time: 148.8202s
	iters: 2100, epoch: 13 | loss: 0.2005116
	speed: 0.0099s/iter; left time: 159.0400s
	iters: 2200, epoch: 13 | loss: 0.2786387
	speed: 0.0100s/iter; left time: 160.6182s
Epoch: 13 cost time: 21.88263249397278
Epoch: 13, Steps: 2278 | Train Loss: 0.4163390 Vali Loss: 0.3778937 Test Loss: 0.1433160
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : weather_336_96_NLinear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed28649<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
mse:0.14424006640911102, mae:0.19273805618286133
