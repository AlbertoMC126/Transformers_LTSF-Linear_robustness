Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='DLinear', model_id='traffic_336_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=15227, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_336_96_DLinear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15227>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11849
val 1661
test 3413
	iters: 100, epoch: 1 | loss: 0.4993344
	speed: 0.4091s/iter; left time: 6014.3509s
	iters: 200, epoch: 1 | loss: 0.5691087
	speed: 0.3963s/iter; left time: 5786.6518s
	iters: 300, epoch: 1 | loss: 0.5406876
	speed: 0.3962s/iter; left time: 5745.1773s
	iters: 400, epoch: 1 | loss: 0.6120363
	speed: 0.3957s/iter; left time: 5698.7060s
	iters: 500, epoch: 1 | loss: 0.5893437
	speed: 0.3961s/iter; left time: 5664.0198s
	iters: 600, epoch: 1 | loss: 0.5809153
	speed: 0.4083s/iter; left time: 5798.9499s
	iters: 700, epoch: 1 | loss: 0.6267215
	speed: 0.3971s/iter; left time: 5600.2064s
Epoch: 1 cost time: 296.0508518218994
Epoch: 1, Steps: 740 | Train Loss: 0.5805980 Vali Loss: 0.8152533 Test Loss: 0.9256850
Validation loss decreased (inf --> 0.815253).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.5853586
	speed: 0.8779s/iter; left time: 12255.8548s
	iters: 200, epoch: 2 | loss: 0.6186070
	speed: 0.3966s/iter; left time: 5497.7957s
	iters: 300, epoch: 2 | loss: 0.5862027
	speed: 0.3969s/iter; left time: 5461.2209s
	iters: 400, epoch: 2 | loss: 0.5969486
	speed: 0.4034s/iter; left time: 5510.7984s
	iters: 500, epoch: 2 | loss: 0.5666999
	speed: 0.3962s/iter; left time: 5372.9711s
	iters: 600, epoch: 2 | loss: 0.5674999
	speed: 0.3953s/iter; left time: 5320.6552s
	iters: 700, epoch: 2 | loss: 0.5567697
	speed: 0.4013s/iter; left time: 5362.4253s
Epoch: 2 cost time: 295.1417932510376
Epoch: 2, Steps: 740 | Train Loss: 0.5755464 Vali Loss: 0.8335943 Test Loss: 0.9596108
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.3434000
	speed: 0.8251s/iter; left time: 10908.0641s
	iters: 200, epoch: 3 | loss: 0.3271760
	speed: 0.4039s/iter; left time: 5299.8272s
	iters: 300, epoch: 3 | loss: 0.3155233
	speed: 0.4004s/iter; left time: 5214.1269s
	iters: 400, epoch: 3 | loss: 0.3466038
	speed: 0.4000s/iter; left time: 5168.9117s
	iters: 500, epoch: 3 | loss: 0.3385906
	speed: 0.4086s/iter; left time: 5239.0132s
	iters: 600, epoch: 3 | loss: 0.3233646
	speed: 0.3956s/iter; left time: 5032.8037s
	iters: 700, epoch: 3 | loss: 0.3322853
	speed: 0.3975s/iter; left time: 5016.3986s
Epoch: 3 cost time: 296.9584345817566
Epoch: 3, Steps: 740 | Train Loss: 0.3513922 Vali Loss: 0.4902749 Test Loss: 0.5906487
Validation loss decreased (0.815253 --> 0.490275).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.3279062
	speed: 0.8754s/iter; left time: 10925.7594s
	iters: 200, epoch: 4 | loss: 0.2824573
	speed: 0.4045s/iter; left time: 5008.6775s
	iters: 300, epoch: 4 | loss: 0.2878347
	speed: 0.4045s/iter; left time: 4967.9362s
	iters: 400, epoch: 4 | loss: 0.2950809
	speed: 0.3981s/iter; left time: 4848.8149s
	iters: 500, epoch: 4 | loss: 0.2809985
	speed: 0.4012s/iter; left time: 4847.1543s
	iters: 600, epoch: 4 | loss: 0.3159842
	speed: 0.3996s/iter; left time: 4787.1795s
	iters: 700, epoch: 4 | loss: 0.3047357
	speed: 0.3969s/iter; left time: 4715.8516s
Epoch: 4 cost time: 296.612185716629
Epoch: 4, Steps: 740 | Train Loss: 0.2873782 Vali Loss: 0.4118198 Test Loss: 0.5005619
Validation loss decreased (0.490275 --> 0.411820).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.2441980
	speed: 0.8734s/iter; left time: 10254.7677s
	iters: 200, epoch: 5 | loss: 0.2467014
	speed: 0.4010s/iter; left time: 4667.6265s
	iters: 300, epoch: 5 | loss: 0.2404863
	speed: 0.4025s/iter; left time: 4645.8248s
	iters: 400, epoch: 5 | loss: 0.2337666
	speed: 0.4005s/iter; left time: 4582.1099s
	iters: 500, epoch: 5 | loss: 0.2842480
	speed: 0.4001s/iter; left time: 4537.4649s
	iters: 600, epoch: 5 | loss: 0.2648536
	speed: 0.3986s/iter; left time: 4480.6376s
	iters: 700, epoch: 5 | loss: 0.2971646
	speed: 0.3977s/iter; left time: 4431.0020s
Epoch: 5 cost time: 295.75611901283264
Epoch: 5, Steps: 740 | Train Loss: 0.2607616 Vali Loss: 0.3799035 Test Loss: 0.4626465
Validation loss decreased (0.411820 --> 0.379903).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.2305236
	speed: 0.8855s/iter; left time: 9741.6289s
	iters: 200, epoch: 6 | loss: 0.2526236
	speed: 0.3961s/iter; left time: 4318.0768s
	iters: 300, epoch: 6 | loss: 0.2407502
	speed: 0.4024s/iter; left time: 4346.4685s
	iters: 400, epoch: 6 | loss: 0.2261326
	speed: 0.4002s/iter; left time: 4282.4850s
	iters: 500, epoch: 6 | loss: 0.2439794
	speed: 0.4024s/iter; left time: 4265.7398s
	iters: 600, epoch: 6 | loss: 0.2391910
	speed: 0.4005s/iter; left time: 4206.1495s
	iters: 700, epoch: 6 | loss: 0.2342823
	speed: 0.4068s/iter; left time: 4231.4679s
Epoch: 6 cost time: 298.57131910324097
Epoch: 6, Steps: 740 | Train Loss: 0.2472212 Vali Loss: 0.3645802 Test Loss: 0.4453125
Validation loss decreased (0.379903 --> 0.364580).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.2556889
	speed: 0.8803s/iter; left time: 9033.1123s
	iters: 200, epoch: 7 | loss: 0.2219632
	speed: 0.3964s/iter; left time: 4027.5107s
	iters: 300, epoch: 7 | loss: 0.2305387
	speed: 0.3969s/iter; left time: 3993.3856s
	iters: 400, epoch: 7 | loss: 0.2332205
	speed: 0.4007s/iter; left time: 3991.1386s
	iters: 500, epoch: 7 | loss: 0.2545340
	speed: 0.4024s/iter; left time: 3967.6446s
	iters: 600, epoch: 7 | loss: 0.2139335
	speed: 0.4000s/iter; left time: 3904.6843s
	iters: 700, epoch: 7 | loss: 0.2341377
	speed: 0.4000s/iter; left time: 3864.1733s
Epoch: 7 cost time: 295.4609811306
Epoch: 7, Steps: 740 | Train Loss: 0.2399376 Vali Loss: 0.3555977 Test Loss: 0.4338422
Validation loss decreased (0.364580 --> 0.355598).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.2496051
	speed: 0.8734s/iter; left time: 8315.2914s
	iters: 200, epoch: 8 | loss: 0.2458212
	speed: 0.3974s/iter; left time: 3743.9189s
	iters: 300, epoch: 8 | loss: 0.2109802
	speed: 0.3986s/iter; left time: 3715.0068s
	iters: 400, epoch: 8 | loss: 0.2182634
	speed: 0.3988s/iter; left time: 3677.1637s
	iters: 500, epoch: 8 | loss: 0.2325642
	speed: 0.4046s/iter; left time: 3690.5144s
	iters: 600, epoch: 8 | loss: 0.2197733
	speed: 0.3992s/iter; left time: 3601.4232s
	iters: 700, epoch: 8 | loss: 0.2131238
	speed: 0.4011s/iter; left time: 3578.0035s
Epoch: 8 cost time: 296.02888536453247
Epoch: 8, Steps: 740 | Train Loss: 0.2357878 Vali Loss: 0.3517353 Test Loss: 0.4300047
Validation loss decreased (0.355598 --> 0.351735).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.2280615
	speed: 0.8810s/iter; left time: 7735.9140s
	iters: 200, epoch: 9 | loss: 0.2396147
	speed: 0.3965s/iter; left time: 3441.5894s
	iters: 300, epoch: 9 | loss: 0.2905281
	speed: 0.3953s/iter; left time: 3391.9231s
	iters: 400, epoch: 9 | loss: 0.2255181
	speed: 0.3965s/iter; left time: 3362.8628s
	iters: 500, epoch: 9 | loss: 0.2503068
	speed: 0.3977s/iter; left time: 3333.1347s
	iters: 600, epoch: 9 | loss: 0.2092889
	speed: 0.4049s/iter; left time: 3352.5687s
	iters: 700, epoch: 9 | loss: 0.2320983
	speed: 0.4039s/iter; left time: 3303.9393s
Epoch: 9 cost time: 296.51027750968933
Epoch: 9, Steps: 740 | Train Loss: 0.2336178 Vali Loss: 0.3495884 Test Loss: 0.4276666
Validation loss decreased (0.351735 --> 0.349588).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.2191087
	speed: 0.8714s/iter; left time: 7006.6368s
	iters: 200, epoch: 10 | loss: 0.2738479
	speed: 0.3988s/iter; left time: 3167.2380s
	iters: 300, epoch: 10 | loss: 0.2404934
	speed: 0.3978s/iter; left time: 3119.4910s
	iters: 400, epoch: 10 | loss: 0.2123263
	speed: 0.3980s/iter; left time: 3081.0237s
	iters: 500, epoch: 10 | loss: 0.2113581
	speed: 0.3986s/iter; left time: 3045.6595s
	iters: 600, epoch: 10 | loss: 0.2320743
	speed: 0.4007s/iter; left time: 3021.6143s
	iters: 700, epoch: 10 | loss: 0.2362081
	speed: 0.4065s/iter; left time: 3025.0245s
Epoch: 10 cost time: 296.2717399597168
Epoch: 10, Steps: 740 | Train Loss: 0.2323349 Vali Loss: 0.3487259 Test Loss: 0.4264155
Validation loss decreased (0.349588 --> 0.348726).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.2553481
	speed: 0.8829s/iter; left time: 6446.1327s
	iters: 200, epoch: 11 | loss: 0.2617878
	speed: 0.4017s/iter; left time: 2892.7132s
	iters: 300, epoch: 11 | loss: 0.2565184
	speed: 0.3979s/iter; left time: 2825.3554s
	iters: 400, epoch: 11 | loss: 0.2199074
	speed: 0.3965s/iter; left time: 2775.6214s
	iters: 500, epoch: 11 | loss: 0.2116361
	speed: 0.3963s/iter; left time: 2735.1485s
	iters: 600, epoch: 11 | loss: 0.2333675
	speed: 0.3982s/iter; left time: 2708.3015s
	iters: 700, epoch: 11 | loss: 0.2241581
	speed: 0.4025s/iter; left time: 2697.1595s
Epoch: 11 cost time: 295.8455936908722
Epoch: 11, Steps: 740 | Train Loss: 0.2317125 Vali Loss: 0.3481843 Test Loss: 0.4261366
Validation loss decreased (0.348726 --> 0.348184).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.2551508
	speed: 0.8867s/iter; left time: 5817.8984s
	iters: 200, epoch: 12 | loss: 0.2167347
	speed: 0.3993s/iter; left time: 2579.9929s
	iters: 300, epoch: 12 | loss: 0.2225856
	speed: 0.4001s/iter; left time: 2545.0980s
	iters: 400, epoch: 12 | loss: 0.2275025
	speed: 0.3963s/iter; left time: 2481.1417s
	iters: 500, epoch: 12 | loss: 0.2382074
	speed: 0.3960s/iter; left time: 2439.5777s
	iters: 600, epoch: 12 | loss: 0.2448046
	speed: 0.3976s/iter; left time: 2409.6786s
	iters: 700, epoch: 12 | loss: 0.2477188
	speed: 0.3987s/iter; left time: 2376.7298s
Epoch: 12 cost time: 295.24808263778687
Epoch: 12, Steps: 740 | Train Loss: 0.2313652 Vali Loss: 0.3478897 Test Loss: 0.4259849
Validation loss decreased (0.348184 --> 0.347890).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.2406213
	speed: 0.8924s/iter; left time: 5194.5403s
	iters: 200, epoch: 13 | loss: 0.2020706
	speed: 0.4004s/iter; left time: 2290.6459s
	iters: 300, epoch: 13 | loss: 0.2135536
	speed: 0.3977s/iter; left time: 2235.5994s
	iters: 400, epoch: 13 | loss: 0.2164860
	speed: 0.3962s/iter; left time: 2187.2452s
	iters: 500, epoch: 13 | loss: 0.2106095
	speed: 0.3982s/iter; left time: 2158.5811s
	iters: 600, epoch: 13 | loss: 0.2330990
	speed: 0.3961s/iter; left time: 2107.8406s
	iters: 700, epoch: 13 | loss: 0.2268731
	speed: 0.3968s/iter; left time: 2071.6697s
Epoch: 13 cost time: 295.03723549842834
Epoch: 13, Steps: 740 | Train Loss: 0.2311328 Vali Loss: 0.3478839 Test Loss: 0.4259196
Validation loss decreased (0.347890 --> 0.347884).  Saving model ...
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 14 | loss: 0.2317978
	speed: 0.8815s/iter; left time: 4479.0091s
	iters: 200, epoch: 14 | loss: 0.2273710
	speed: 0.3991s/iter; left time: 1987.8175s
	iters: 300, epoch: 14 | loss: 0.2580336
	speed: 0.3969s/iter; left time: 1937.2184s
	iters: 400, epoch: 14 | loss: 0.2151242
	speed: 0.3958s/iter; left time: 1892.1368s
	iters: 500, epoch: 14 | loss: 0.2173249
	speed: 0.3967s/iter; left time: 1856.8167s
	iters: 600, epoch: 14 | loss: 0.2214660
	speed: 0.3957s/iter; left time: 1812.5956s
	iters: 700, epoch: 14 | loss: 0.2391963
	speed: 0.3967s/iter; left time: 1777.4710s
Epoch: 14 cost time: 294.31590962409973
Epoch: 14, Steps: 740 | Train Loss: 0.2310281 Vali Loss: 0.3484461 Test Loss: 0.4258915
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 15 | loss: 0.2126582
	speed: 0.8262s/iter; left time: 3586.5121s
	iters: 200, epoch: 15 | loss: 0.2448610
	speed: 0.3968s/iter; left time: 1682.7624s
	iters: 300, epoch: 15 | loss: 0.2388315
	speed: 0.4030s/iter; left time: 1668.8245s
	iters: 400, epoch: 15 | loss: 0.2161356
	speed: 0.3981s/iter; left time: 1608.9121s
	iters: 500, epoch: 15 | loss: 0.2385447
	speed: 0.3967s/iter; left time: 1563.5748s
	iters: 600, epoch: 15 | loss: 0.2483207
	speed: 0.4006s/iter; left time: 1538.8085s
	iters: 700, epoch: 15 | loss: 0.2363469
	speed: 0.3946s/iter; left time: 1476.3362s
Epoch: 15 cost time: 294.5316696166992
Epoch: 15, Steps: 740 | Train Loss: 0.2309428 Vali Loss: 0.3483377 Test Loss: 0.4258854
EarlyStopping counter: 2 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 16 | loss: 0.2423089
	speed: 0.8164s/iter; left time: 2939.7950s
	iters: 200, epoch: 16 | loss: 0.2321881
	speed: 0.3972s/iter; left time: 1390.6301s
	iters: 300, epoch: 16 | loss: 0.1969396
	speed: 0.3996s/iter; left time: 1359.0726s
	iters: 400, epoch: 16 | loss: 0.2287672
	speed: 0.3993s/iter; left time: 1317.9386s
	iters: 500, epoch: 16 | loss: 0.2059762
	speed: 0.3980s/iter; left time: 1274.1158s
	iters: 600, epoch: 16 | loss: 0.2251037
	speed: 0.3974s/iter; left time: 1232.2879s
	iters: 700, epoch: 16 | loss: 0.2306359
	speed: 0.4008s/iter; left time: 1202.8097s
Epoch: 16 cost time: 294.97834038734436
Epoch: 16, Steps: 740 | Train Loss: 0.2309468 Vali Loss: 0.3481736 Test Loss: 0.4258842
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 17 | loss: 0.2144881
	speed: 0.8107s/iter; left time: 2319.3363s
	iters: 200, epoch: 17 | loss: 0.2308404
	speed: 0.3986s/iter; left time: 1100.5981s
	iters: 300, epoch: 17 | loss: 0.2229398
	speed: 0.3972s/iter; left time: 1056.9860s
	iters: 400, epoch: 17 | loss: 0.2170467
	speed: 0.3980s/iter; left time: 1019.1815s
	iters: 500, epoch: 17 | loss: 0.2401693
	speed: 0.4022s/iter; left time: 989.8613s
	iters: 600, epoch: 17 | loss: 0.2015040
	speed: 0.3978s/iter; left time: 939.1993s
	iters: 700, epoch: 17 | loss: 0.2093299
	speed: 0.3979s/iter; left time: 899.6048s
Epoch: 17 cost time: 295.0208668708801
Epoch: 17, Steps: 740 | Train Loss: 0.2309728 Vali Loss: 0.3482333 Test Loss: 0.4258827
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 18 | loss: 0.2069072
	speed: 0.8249s/iter; left time: 1749.5081s
	iters: 200, epoch: 18 | loss: 0.2246856
	speed: 0.3950s/iter; left time: 798.2593s
	iters: 300, epoch: 18 | loss: 0.2131286
	speed: 0.3983s/iter; left time: 765.1973s
	iters: 400, epoch: 18 | loss: 0.2384756
	speed: 0.3964s/iter; left time: 721.8075s
	iters: 500, epoch: 18 | loss: 0.2251229
	speed: 0.3977s/iter; left time: 684.3570s
	iters: 600, epoch: 18 | loss: 0.2230266
	speed: 0.4009s/iter; left time: 649.7892s
	iters: 700, epoch: 18 | loss: 0.2347950
	speed: 0.3973s/iter; left time: 604.2476s
Epoch: 18 cost time: 294.0534725189209
Epoch: 18, Steps: 740 | Train Loss: 0.2309207 Vali Loss: 0.3482920 Test Loss: 0.4258821
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : traffic_336_96_DLinear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15227<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3413
mse:0.4261743426322937, mae:0.2983859181404114
