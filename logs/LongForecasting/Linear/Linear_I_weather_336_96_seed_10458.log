Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='Linear', model_id='weather_336_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=10458, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : weather_336_96_Linear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed10458>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36456
val 5175
test 10444
	iters: 100, epoch: 1 | loss: 0.4028397
	speed: 0.0110s/iter; left time: 501.7705s
	iters: 200, epoch: 1 | loss: 0.3870049
	speed: 0.0096s/iter; left time: 434.2850s
	iters: 300, epoch: 1 | loss: 0.6795735
	speed: 0.0098s/iter; left time: 443.9817s
	iters: 400, epoch: 1 | loss: 0.3549441
	speed: 0.0095s/iter; left time: 430.8456s
	iters: 500, epoch: 1 | loss: 0.5123635
	speed: 0.0097s/iter; left time: 435.1609s
	iters: 600, epoch: 1 | loss: 0.3741359
	speed: 0.0093s/iter; left time: 416.2402s
	iters: 700, epoch: 1 | loss: 0.5167871
	speed: 0.0100s/iter; left time: 449.1703s
	iters: 800, epoch: 1 | loss: 0.4287203
	speed: 0.0098s/iter; left time: 438.7971s
	iters: 900, epoch: 1 | loss: 0.3000610
	speed: 0.0091s/iter; left time: 404.9300s
	iters: 1000, epoch: 1 | loss: 0.3711790
	speed: 0.0102s/iter; left time: 453.0983s
	iters: 1100, epoch: 1 | loss: 0.6871881
	speed: 0.0096s/iter; left time: 427.7915s
	iters: 1200, epoch: 1 | loss: 0.3592602
	speed: 0.0093s/iter; left time: 411.3085s
	iters: 1300, epoch: 1 | loss: 0.4223479
	speed: 0.0097s/iter; left time: 430.1642s
	iters: 1400, epoch: 1 | loss: 0.4742474
	speed: 0.0090s/iter; left time: 398.9855s
	iters: 1500, epoch: 1 | loss: 0.4721532
	speed: 0.0091s/iter; left time: 402.8795s
	iters: 1600, epoch: 1 | loss: 0.5969346
	speed: 0.0093s/iter; left time: 406.7409s
	iters: 1700, epoch: 1 | loss: 0.2435134
	speed: 0.0094s/iter; left time: 412.6999s
	iters: 1800, epoch: 1 | loss: 0.2764350
	speed: 0.0089s/iter; left time: 389.3306s
	iters: 1900, epoch: 1 | loss: 0.2973457
	speed: 0.0092s/iter; left time: 399.7567s
	iters: 2000, epoch: 1 | loss: 0.4208520
	speed: 0.0094s/iter; left time: 408.1178s
	iters: 2100, epoch: 1 | loss: 0.4853721
	speed: 0.0093s/iter; left time: 404.1547s
	iters: 2200, epoch: 1 | loss: 0.4451015
	speed: 0.0097s/iter; left time: 422.4199s
Epoch: 1 cost time: 21.699851274490356
Epoch: 1, Steps: 2278 | Train Loss: 1.1800210 Vali Loss: 0.5493912 Test Loss: 0.2370391
Validation loss decreased (inf --> 0.549391).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.4944525
	speed: 0.0375s/iter; left time: 1618.9910s
	iters: 200, epoch: 2 | loss: 0.6730168
	speed: 0.0091s/iter; left time: 391.8427s
	iters: 300, epoch: 2 | loss: 4.0634737
	speed: 0.0090s/iter; left time: 386.2805s
	iters: 400, epoch: 2 | loss: 0.4286971
	speed: 0.0099s/iter; left time: 423.6910s
	iters: 500, epoch: 2 | loss: 0.2704736
	speed: 0.0096s/iter; left time: 409.4062s
	iters: 600, epoch: 2 | loss: 1.5204276
	speed: 0.0091s/iter; left time: 387.3955s
	iters: 700, epoch: 2 | loss: 1.2627012
	speed: 0.0084s/iter; left time: 358.5221s
	iters: 800, epoch: 2 | loss: 0.5397775
	speed: 0.0092s/iter; left time: 389.7622s
	iters: 900, epoch: 2 | loss: 0.4910416
	speed: 0.0084s/iter; left time: 356.3568s
	iters: 1000, epoch: 2 | loss: 0.3667294
	speed: 0.0085s/iter; left time: 360.6530s
	iters: 1100, epoch: 2 | loss: 0.3235338
	speed: 0.0098s/iter; left time: 413.9082s
	iters: 1200, epoch: 2 | loss: 3.2609890
	speed: 0.0088s/iter; left time: 372.3073s
	iters: 1300, epoch: 2 | loss: 0.3573647
	speed: 0.0087s/iter; left time: 367.2297s
	iters: 1400, epoch: 2 | loss: 0.2929697
	speed: 0.0091s/iter; left time: 381.1327s
	iters: 1500, epoch: 2 | loss: 0.5850716
	speed: 0.0088s/iter; left time: 367.1468s
	iters: 1600, epoch: 2 | loss: 0.3363463
	speed: 0.0086s/iter; left time: 358.2741s
	iters: 1700, epoch: 2 | loss: 0.5622853
	speed: 0.0085s/iter; left time: 355.4052s
	iters: 1800, epoch: 2 | loss: 2.2202840
	speed: 0.0081s/iter; left time: 335.6237s
	iters: 1900, epoch: 2 | loss: 0.4006338
	speed: 0.0080s/iter; left time: 332.7245s
	iters: 2000, epoch: 2 | loss: 0.3766683
	speed: 0.0088s/iter; left time: 362.5401s
	iters: 2100, epoch: 2 | loss: 0.3893871
	speed: 0.0092s/iter; left time: 377.2361s
	iters: 2200, epoch: 2 | loss: 0.3079106
	speed: 0.0088s/iter; left time: 360.7535s
Epoch: 2 cost time: 20.244074821472168
Epoch: 2, Steps: 2278 | Train Loss: 0.9053226 Vali Loss: 0.5175475 Test Loss: 0.2035395
Validation loss decreased (0.549391 --> 0.517547).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.2433528
	speed: 0.0364s/iter; left time: 1490.6648s
	iters: 200, epoch: 3 | loss: 0.3955117
	speed: 0.0084s/iter; left time: 344.3659s
	iters: 300, epoch: 3 | loss: 0.1961062
	speed: 0.0092s/iter; left time: 374.7774s
	iters: 400, epoch: 3 | loss: 0.2983528
	speed: 0.0100s/iter; left time: 407.3455s
	iters: 500, epoch: 3 | loss: 0.1850096
	speed: 0.0088s/iter; left time: 354.7380s
	iters: 600, epoch: 3 | loss: 0.2431814
	speed: 0.0084s/iter; left time: 340.8316s
	iters: 700, epoch: 3 | loss: 0.4463381
	speed: 0.0085s/iter; left time: 343.8611s
	iters: 800, epoch: 3 | loss: 0.4558434
	speed: 0.0087s/iter; left time: 350.7690s
	iters: 900, epoch: 3 | loss: 0.2969286
	speed: 0.0088s/iter; left time: 352.7928s
	iters: 1000, epoch: 3 | loss: 1.0453160
	speed: 0.0091s/iter; left time: 365.9688s
	iters: 1100, epoch: 3 | loss: 0.3252011
	speed: 0.0101s/iter; left time: 401.4755s
	iters: 1200, epoch: 3 | loss: 0.3991055
	speed: 0.0097s/iter; left time: 387.2010s
	iters: 1300, epoch: 3 | loss: 0.3552306
	speed: 0.0089s/iter; left time: 352.4388s
	iters: 1400, epoch: 3 | loss: 0.4999183
	speed: 0.0098s/iter; left time: 386.3544s
	iters: 1500, epoch: 3 | loss: 0.4611011
	speed: 0.0100s/iter; left time: 394.3099s
	iters: 1600, epoch: 3 | loss: 0.6589108
	speed: 0.0088s/iter; left time: 345.0530s
	iters: 1700, epoch: 3 | loss: 0.8517390
	speed: 0.0079s/iter; left time: 311.6446s
	iters: 1800, epoch: 3 | loss: 0.2780785
	speed: 0.0083s/iter; left time: 325.4539s
	iters: 1900, epoch: 3 | loss: 0.8349214
	speed: 0.0080s/iter; left time: 314.0168s
	iters: 2000, epoch: 3 | loss: 0.3386276
	speed: 0.0083s/iter; left time: 324.3546s
	iters: 2100, epoch: 3 | loss: 0.3478250
	speed: 0.0095s/iter; left time: 369.4570s
	iters: 2200, epoch: 3 | loss: 0.2511067
	speed: 0.0078s/iter; left time: 302.7137s
Epoch: 3 cost time: 20.304657697677612
Epoch: 3, Steps: 2278 | Train Loss: 0.6309595 Vali Loss: 0.4274164 Test Loss: 0.1685513
Validation loss decreased (0.517547 --> 0.427416).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.2021567
	speed: 0.0339s/iter; left time: 1307.8940s
	iters: 200, epoch: 4 | loss: 0.5460383
	speed: 0.0096s/iter; left time: 368.1695s
	iters: 300, epoch: 4 | loss: 0.4308774
	speed: 0.0098s/iter; left time: 377.4531s
	iters: 400, epoch: 4 | loss: 0.2835746
	speed: 0.0093s/iter; left time: 356.3419s
	iters: 500, epoch: 4 | loss: 0.4973683
	speed: 0.0090s/iter; left time: 345.4458s
	iters: 600, epoch: 4 | loss: 0.3994893
	speed: 0.0100s/iter; left time: 379.3686s
	iters: 700, epoch: 4 | loss: 0.3246940
	speed: 0.0105s/iter; left time: 399.1942s
	iters: 800, epoch: 4 | loss: 0.3114178
	speed: 0.0092s/iter; left time: 350.4712s
	iters: 900, epoch: 4 | loss: 0.3037629
	speed: 0.0089s/iter; left time: 338.0641s
	iters: 1000, epoch: 4 | loss: 0.3908578
	speed: 0.0102s/iter; left time: 384.1447s
	iters: 1100, epoch: 4 | loss: 0.2353016
	speed: 0.0103s/iter; left time: 386.3483s
	iters: 1200, epoch: 4 | loss: 0.2425782
	speed: 0.0098s/iter; left time: 366.9018s
	iters: 1300, epoch: 4 | loss: 0.3131112
	speed: 0.0086s/iter; left time: 322.0609s
	iters: 1400, epoch: 4 | loss: 0.2057591
	speed: 0.0096s/iter; left time: 356.6602s
	iters: 1500, epoch: 4 | loss: 1.1207234
	speed: 0.0101s/iter; left time: 374.7703s
	iters: 1600, epoch: 4 | loss: 2.1317835
	speed: 0.0093s/iter; left time: 346.4259s
	iters: 1700, epoch: 4 | loss: 0.2431668
	speed: 0.0100s/iter; left time: 371.8461s
	iters: 1800, epoch: 4 | loss: 0.3198625
	speed: 0.0100s/iter; left time: 368.5830s
	iters: 1900, epoch: 4 | loss: 0.3275479
	speed: 0.0095s/iter; left time: 351.6044s
	iters: 2000, epoch: 4 | loss: 2.2299709
	speed: 0.0099s/iter; left time: 362.8747s
	iters: 2100, epoch: 4 | loss: 0.2719536
	speed: 0.0095s/iter; left time: 347.5968s
	iters: 2200, epoch: 4 | loss: 0.3036579
	speed: 0.0092s/iter; left time: 335.5711s
Epoch: 4 cost time: 21.85189414024353
Epoch: 4, Steps: 2278 | Train Loss: 0.4944375 Vali Loss: 0.3941568 Test Loss: 0.1595626
Validation loss decreased (0.427416 --> 0.394157).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.2777918
	speed: 0.0381s/iter; left time: 1385.2693s
	iters: 200, epoch: 5 | loss: 0.4091037
	speed: 0.0097s/iter; left time: 350.9832s
	iters: 300, epoch: 5 | loss: 2.3348854
	speed: 0.0094s/iter; left time: 341.2626s
	iters: 400, epoch: 5 | loss: 3.6196408
	speed: 0.0089s/iter; left time: 320.1951s
	iters: 500, epoch: 5 | loss: 0.4947480
	speed: 0.0095s/iter; left time: 339.8102s
	iters: 600, epoch: 5 | loss: 0.3359930
	speed: 0.0096s/iter; left time: 345.8380s
	iters: 700, epoch: 5 | loss: 0.2202527
	speed: 0.0095s/iter; left time: 340.8296s
	iters: 800, epoch: 5 | loss: 0.3222834
	speed: 0.0083s/iter; left time: 294.8039s
	iters: 900, epoch: 5 | loss: 0.4788078
	speed: 0.0096s/iter; left time: 341.8917s
	iters: 1000, epoch: 5 | loss: 0.3399819
	speed: 0.0093s/iter; left time: 330.6536s
	iters: 1100, epoch: 5 | loss: 0.3279321
	speed: 0.0091s/iter; left time: 320.1549s
	iters: 1200, epoch: 5 | loss: 0.2738972
	speed: 0.0097s/iter; left time: 343.3978s
	iters: 1300, epoch: 5 | loss: 0.3304717
	speed: 0.0095s/iter; left time: 334.8608s
	iters: 1400, epoch: 5 | loss: 0.3092695
	speed: 0.0095s/iter; left time: 332.3218s
	iters: 1500, epoch: 5 | loss: 0.4145376
	speed: 0.0096s/iter; left time: 336.4711s
	iters: 1600, epoch: 5 | loss: 0.3847994
	speed: 0.0089s/iter; left time: 308.9943s
	iters: 1700, epoch: 5 | loss: 0.3471377
	speed: 0.0093s/iter; left time: 324.8267s
	iters: 1800, epoch: 5 | loss: 0.2332101
	speed: 0.0101s/iter; left time: 349.8715s
	iters: 1900, epoch: 5 | loss: 0.3199445
	speed: 0.0096s/iter; left time: 331.6736s
	iters: 2000, epoch: 5 | loss: 0.2564406
	speed: 0.0095s/iter; left time: 326.0253s
	iters: 2100, epoch: 5 | loss: 0.3872947
	speed: 0.0102s/iter; left time: 349.1768s
	iters: 2200, epoch: 5 | loss: 0.2975163
	speed: 0.0094s/iter; left time: 323.5575s
Epoch: 5 cost time: 21.545161724090576
Epoch: 5, Steps: 2278 | Train Loss: 0.4559891 Vali Loss: 0.3835992 Test Loss: 0.1612795
Validation loss decreased (0.394157 --> 0.383599).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 2.2937160
	speed: 0.0370s/iter; left time: 1259.7772s
	iters: 200, epoch: 6 | loss: 0.2898010
	speed: 0.0095s/iter; left time: 323.0493s
	iters: 300, epoch: 6 | loss: 0.1663764
	speed: 0.0097s/iter; left time: 329.2432s
	iters: 400, epoch: 6 | loss: 0.2496704
	speed: 0.0092s/iter; left time: 309.7512s
	iters: 500, epoch: 6 | loss: 0.7047760
	speed: 0.0096s/iter; left time: 324.2032s
	iters: 600, epoch: 6 | loss: 0.2976430
	speed: 0.0101s/iter; left time: 337.4187s
	iters: 700, epoch: 6 | loss: 0.1501268
	speed: 0.0093s/iter; left time: 312.0392s
	iters: 800, epoch: 6 | loss: 0.2906174
	speed: 0.0091s/iter; left time: 304.5093s
	iters: 900, epoch: 6 | loss: 0.3726846
	speed: 0.0088s/iter; left time: 294.3962s
	iters: 1000, epoch: 6 | loss: 0.3804668
	speed: 0.0094s/iter; left time: 313.3007s
	iters: 1100, epoch: 6 | loss: 0.2229032
	speed: 0.0094s/iter; left time: 309.7162s
	iters: 1200, epoch: 6 | loss: 0.6205341
	speed: 0.0087s/iter; left time: 286.5802s
	iters: 1300, epoch: 6 | loss: 0.6634323
	speed: 0.0089s/iter; left time: 294.1325s
	iters: 1400, epoch: 6 | loss: 1.5621963
	speed: 0.0095s/iter; left time: 312.6925s
	iters: 1500, epoch: 6 | loss: 0.2537717
	speed: 0.0101s/iter; left time: 328.3525s
	iters: 1600, epoch: 6 | loss: 0.5126414
	speed: 0.0100s/iter; left time: 326.1265s
	iters: 1700, epoch: 6 | loss: 0.2558511
	speed: 0.0103s/iter; left time: 335.8209s
	iters: 1800, epoch: 6 | loss: 0.2327094
	speed: 0.0102s/iter; left time: 328.8272s
	iters: 1900, epoch: 6 | loss: 0.2237701
	speed: 0.0089s/iter; left time: 287.3787s
	iters: 2000, epoch: 6 | loss: 2.1293533
	speed: 0.0088s/iter; left time: 281.5078s
	iters: 2100, epoch: 6 | loss: 0.3590422
	speed: 0.0095s/iter; left time: 305.5395s
	iters: 2200, epoch: 6 | loss: 0.2487489
	speed: 0.0100s/iter; left time: 319.0883s
Epoch: 6 cost time: 21.536108016967773
Epoch: 6, Steps: 2278 | Train Loss: 0.4408432 Vali Loss: 0.3733310 Test Loss: 0.1509300
Validation loss decreased (0.383599 --> 0.373331).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.2920078
	speed: 0.0346s/iter; left time: 1101.0690s
	iters: 200, epoch: 7 | loss: 0.3880168
	speed: 0.0087s/iter; left time: 275.5866s
	iters: 300, epoch: 7 | loss: 0.3678960
	speed: 0.0078s/iter; left time: 247.5293s
	iters: 400, epoch: 7 | loss: 0.1754757
	speed: 0.0097s/iter; left time: 304.0966s
	iters: 500, epoch: 7 | loss: 0.2801888
	speed: 0.0102s/iter; left time: 318.7179s
	iters: 600, epoch: 7 | loss: 0.2403456
	speed: 0.0089s/iter; left time: 278.3875s
	iters: 700, epoch: 7 | loss: 0.3050515
	speed: 0.0085s/iter; left time: 266.3058s
	iters: 800, epoch: 7 | loss: 0.5399452
	speed: 0.0091s/iter; left time: 282.2002s
	iters: 900, epoch: 7 | loss: 0.2997356
	speed: 0.0089s/iter; left time: 276.6747s
	iters: 1000, epoch: 7 | loss: 0.2592644
	speed: 0.0081s/iter; left time: 250.2801s
	iters: 1100, epoch: 7 | loss: 0.2447730
	speed: 0.0085s/iter; left time: 262.6659s
	iters: 1200, epoch: 7 | loss: 0.3409459
	speed: 0.0088s/iter; left time: 271.5534s
	iters: 1300, epoch: 7 | loss: 0.2276578
	speed: 0.0089s/iter; left time: 273.0998s
	iters: 1400, epoch: 7 | loss: 0.4337892
	speed: 0.0099s/iter; left time: 300.9773s
	iters: 1500, epoch: 7 | loss: 0.3271053
	speed: 0.0098s/iter; left time: 297.5738s
	iters: 1600, epoch: 7 | loss: 0.2537597
	speed: 0.0088s/iter; left time: 265.4327s
	iters: 1700, epoch: 7 | loss: 0.3362658
	speed: 0.0094s/iter; left time: 282.4537s
	iters: 1800, epoch: 7 | loss: 0.3514892
	speed: 0.0098s/iter; left time: 293.4144s
	iters: 1900, epoch: 7 | loss: 2.1962717
	speed: 0.0092s/iter; left time: 276.1122s
	iters: 2000, epoch: 7 | loss: 0.1983414
	speed: 0.0088s/iter; left time: 262.9774s
	iters: 2100, epoch: 7 | loss: 2.1531050
	speed: 0.0098s/iter; left time: 292.4812s
	iters: 2200, epoch: 7 | loss: 0.4279491
	speed: 0.0098s/iter; left time: 291.9464s
Epoch: 7 cost time: 20.640560388565063
Epoch: 7, Steps: 2278 | Train Loss: 0.4336990 Vali Loss: 0.3676264 Test Loss: 0.1480585
Validation loss decreased (0.373331 --> 0.367626).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.2847152
	speed: 0.0357s/iter; left time: 1052.7222s
	iters: 200, epoch: 8 | loss: 0.5035330
	speed: 0.0093s/iter; left time: 273.1904s
	iters: 300, epoch: 8 | loss: 0.3225605
	speed: 0.0095s/iter; left time: 278.1967s
	iters: 400, epoch: 8 | loss: 0.3311312
	speed: 0.0089s/iter; left time: 258.7474s
	iters: 500, epoch: 8 | loss: 2.1116636
	speed: 0.0091s/iter; left time: 264.8256s
	iters: 600, epoch: 8 | loss: 0.4446625
	speed: 0.0085s/iter; left time: 245.2204s
	iters: 700, epoch: 8 | loss: 0.4460586
	speed: 0.0093s/iter; left time: 268.4647s
	iters: 800, epoch: 8 | loss: 0.4848599
	speed: 0.0094s/iter; left time: 270.9145s
	iters: 900, epoch: 8 | loss: 0.1665346
	speed: 0.0099s/iter; left time: 285.1421s
	iters: 1000, epoch: 8 | loss: 0.3382991
	speed: 0.0099s/iter; left time: 282.2085s
	iters: 1100, epoch: 8 | loss: 0.1798849
	speed: 0.0097s/iter; left time: 275.3037s
	iters: 1200, epoch: 8 | loss: 0.2387305
	speed: 0.0099s/iter; left time: 280.5312s
	iters: 1300, epoch: 8 | loss: 0.3237517
	speed: 0.0082s/iter; left time: 231.0906s
	iters: 1400, epoch: 8 | loss: 0.2627252
	speed: 0.0096s/iter; left time: 269.8011s
	iters: 1500, epoch: 8 | loss: 0.5159980
	speed: 0.0099s/iter; left time: 277.5089s
	iters: 1600, epoch: 8 | loss: 0.3033753
	speed: 0.0101s/iter; left time: 283.9155s
	iters: 1700, epoch: 8 | loss: 0.2103551
	speed: 0.0091s/iter; left time: 255.3351s
	iters: 1800, epoch: 8 | loss: 0.4833313
	speed: 0.0087s/iter; left time: 241.0799s
	iters: 1900, epoch: 8 | loss: 0.2146912
	speed: 0.0096s/iter; left time: 264.8449s
	iters: 2000, epoch: 8 | loss: 0.2641915
	speed: 0.0085s/iter; left time: 233.9408s
	iters: 2100, epoch: 8 | loss: 0.2403171
	speed: 0.0086s/iter; left time: 237.3579s
	iters: 2200, epoch: 8 | loss: 0.2875048
	speed: 0.0092s/iter; left time: 251.5684s
Epoch: 8 cost time: 21.172082901000977
Epoch: 8, Steps: 2278 | Train Loss: 0.4302682 Vali Loss: 0.3679245 Test Loss: 0.1463763
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.2849084
	speed: 0.0344s/iter; left time: 935.9326s
	iters: 200, epoch: 9 | loss: 0.2617302
	speed: 0.0077s/iter; left time: 208.5543s
	iters: 300, epoch: 9 | loss: 0.2930425
	speed: 0.0090s/iter; left time: 243.4496s
	iters: 400, epoch: 9 | loss: 0.2407540
	speed: 0.0091s/iter; left time: 245.7022s
	iters: 500, epoch: 9 | loss: 0.2922218
	speed: 0.0086s/iter; left time: 230.8224s
	iters: 600, epoch: 9 | loss: 0.4217370
	speed: 0.0089s/iter; left time: 238.9330s
	iters: 700, epoch: 9 | loss: 2.1487827
	speed: 0.0096s/iter; left time: 256.4718s
	iters: 800, epoch: 9 | loss: 0.2355350
	speed: 0.0098s/iter; left time: 260.1262s
	iters: 900, epoch: 9 | loss: 0.3501242
	speed: 0.0089s/iter; left time: 236.5211s
	iters: 1000, epoch: 9 | loss: 0.1006847
	speed: 0.0087s/iter; left time: 230.2325s
	iters: 1100, epoch: 9 | loss: 0.2255358
	speed: 0.0093s/iter; left time: 242.7420s
	iters: 1200, epoch: 9 | loss: 0.2339950
	speed: 0.0094s/iter; left time: 245.3457s
	iters: 1300, epoch: 9 | loss: 0.2791229
	speed: 0.0098s/iter; left time: 256.2224s
	iters: 1400, epoch: 9 | loss: 0.2500033
	speed: 0.0092s/iter; left time: 239.5181s
	iters: 1500, epoch: 9 | loss: 0.4969570
	speed: 0.0089s/iter; left time: 230.1161s
	iters: 1600, epoch: 9 | loss: 0.3100832
	speed: 0.0093s/iter; left time: 240.0037s
	iters: 1700, epoch: 9 | loss: 0.6128443
	speed: 0.0104s/iter; left time: 265.8576s
	iters: 1800, epoch: 9 | loss: 0.2247393
	speed: 0.0098s/iter; left time: 251.4611s
	iters: 1900, epoch: 9 | loss: 0.1863747
	speed: 0.0098s/iter; left time: 248.3234s
	iters: 2000, epoch: 9 | loss: 0.2683198
	speed: 0.0094s/iter; left time: 238.4836s
	iters: 2100, epoch: 9 | loss: 0.2260118
	speed: 0.0094s/iter; left time: 237.5006s
	iters: 2200, epoch: 9 | loss: 0.2663853
	speed: 0.0095s/iter; left time: 239.3466s
Epoch: 9 cost time: 20.995572090148926
Epoch: 9, Steps: 2278 | Train Loss: 0.4283694 Vali Loss: 0.3659964 Test Loss: 0.1447573
Validation loss decreased (0.367626 --> 0.365996).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.2726014
	speed: 0.0371s/iter; left time: 925.9614s
	iters: 200, epoch: 10 | loss: 0.2842381
	speed: 0.0090s/iter; left time: 223.4116s
	iters: 300, epoch: 10 | loss: 0.2378956
	speed: 0.0091s/iter; left time: 226.4598s
	iters: 400, epoch: 10 | loss: 0.2271431
	speed: 0.0096s/iter; left time: 235.6618s
	iters: 500, epoch: 10 | loss: 0.4144540
	speed: 0.0093s/iter; left time: 227.3275s
	iters: 600, epoch: 10 | loss: 0.3909883
	speed: 0.0093s/iter; left time: 227.3808s
	iters: 700, epoch: 10 | loss: 0.3190904
	speed: 0.0096s/iter; left time: 233.2896s
	iters: 800, epoch: 10 | loss: 0.5442324
	speed: 0.0093s/iter; left time: 226.6251s
	iters: 900, epoch: 10 | loss: 0.2260780
	speed: 0.0096s/iter; left time: 231.7056s
	iters: 1000, epoch: 10 | loss: 0.2418113
	speed: 0.0094s/iter; left time: 225.2315s
	iters: 1100, epoch: 10 | loss: 0.2369223
	speed: 0.0095s/iter; left time: 227.5414s
	iters: 1200, epoch: 10 | loss: 0.1992440
	speed: 0.0096s/iter; left time: 229.7972s
	iters: 1300, epoch: 10 | loss: 0.3903105
	speed: 0.0092s/iter; left time: 218.7496s
	iters: 1400, epoch: 10 | loss: 0.2642034
	speed: 0.0095s/iter; left time: 224.6149s
	iters: 1500, epoch: 10 | loss: 0.3899961
	speed: 0.0090s/iter; left time: 213.1352s
	iters: 1600, epoch: 10 | loss: 0.2507210
	speed: 0.0093s/iter; left time: 217.1603s
	iters: 1700, epoch: 10 | loss: 0.2756748
	speed: 0.0095s/iter; left time: 221.9847s
	iters: 1800, epoch: 10 | loss: 0.7180022
	speed: 0.0095s/iter; left time: 219.9934s
	iters: 1900, epoch: 10 | loss: 0.2697142
	speed: 0.0092s/iter; left time: 213.7723s
	iters: 2000, epoch: 10 | loss: 0.1745300
	speed: 0.0092s/iter; left time: 212.1081s
	iters: 2100, epoch: 10 | loss: 0.4725816
	speed: 0.0092s/iter; left time: 211.4904s
	iters: 2200, epoch: 10 | loss: 0.3208219
	speed: 0.0094s/iter; left time: 215.8354s
Epoch: 10 cost time: 21.276227235794067
Epoch: 10, Steps: 2278 | Train Loss: 0.4274422 Vali Loss: 0.3658059 Test Loss: 0.1456716
Validation loss decreased (0.365996 --> 0.365806).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.1805143
	speed: 0.0361s/iter; left time: 818.6782s
	iters: 200, epoch: 11 | loss: 0.2884392
	speed: 0.0094s/iter; left time: 212.5428s
	iters: 300, epoch: 11 | loss: 0.3227219
	speed: 0.0093s/iter; left time: 208.4418s
	iters: 400, epoch: 11 | loss: 0.3352874
	speed: 0.0093s/iter; left time: 208.7510s
	iters: 500, epoch: 11 | loss: 0.3079751
	speed: 0.0091s/iter; left time: 203.3602s
	iters: 600, epoch: 11 | loss: 0.3295907
	speed: 0.0095s/iter; left time: 210.3641s
	iters: 700, epoch: 11 | loss: 0.1876604
	speed: 0.0095s/iter; left time: 209.8815s
	iters: 800, epoch: 11 | loss: 0.1630962
	speed: 0.0095s/iter; left time: 209.3052s
	iters: 900, epoch: 11 | loss: 0.2921208
	speed: 0.0095s/iter; left time: 208.3918s
	iters: 1000, epoch: 11 | loss: 0.5288966
	speed: 0.0094s/iter; left time: 204.8957s
	iters: 1100, epoch: 11 | loss: 0.6335309
	speed: 0.0096s/iter; left time: 209.0461s
	iters: 1200, epoch: 11 | loss: 0.2355425
	speed: 0.0094s/iter; left time: 203.1215s
	iters: 1300, epoch: 11 | loss: 0.1947894
	speed: 0.0095s/iter; left time: 203.4774s
	iters: 1400, epoch: 11 | loss: 0.4031284
	speed: 0.0096s/iter; left time: 205.9665s
	iters: 1500, epoch: 11 | loss: 0.2476560
	speed: 0.0099s/iter; left time: 209.7680s
	iters: 1600, epoch: 11 | loss: 0.2006574
	speed: 0.0092s/iter; left time: 194.9955s
	iters: 1700, epoch: 11 | loss: 0.2417960
	speed: 0.0094s/iter; left time: 197.6740s
	iters: 1800, epoch: 11 | loss: 0.3484589
	speed: 0.0094s/iter; left time: 197.5819s
	iters: 1900, epoch: 11 | loss: 0.2661372
	speed: 0.0096s/iter; left time: 199.9721s
	iters: 2000, epoch: 11 | loss: 0.4266386
	speed: 0.0096s/iter; left time: 200.2674s
	iters: 2100, epoch: 11 | loss: 0.5487468
	speed: 0.0095s/iter; left time: 195.5769s
	iters: 2200, epoch: 11 | loss: 0.1861834
	speed: 0.0092s/iter; left time: 189.5872s
Epoch: 11 cost time: 21.544135570526123
Epoch: 11, Steps: 2278 | Train Loss: 0.4270107 Vali Loss: 0.3661275 Test Loss: 0.1448565
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.3964948
	speed: 0.0375s/iter; left time: 765.7161s
	iters: 200, epoch: 12 | loss: 0.4319643
	speed: 0.0092s/iter; left time: 185.9087s
	iters: 300, epoch: 12 | loss: 0.4267137
	speed: 0.0094s/iter; left time: 190.6511s
	iters: 400, epoch: 12 | loss: 0.2467592
	speed: 0.0094s/iter; left time: 188.5961s
	iters: 500, epoch: 12 | loss: 0.4187358
	speed: 0.0095s/iter; left time: 190.1314s
	iters: 600, epoch: 12 | loss: 0.4003101
	speed: 0.0097s/iter; left time: 193.4955s
	iters: 700, epoch: 12 | loss: 0.5908557
	speed: 0.0093s/iter; left time: 184.5940s
	iters: 800, epoch: 12 | loss: 0.2374943
	speed: 0.0094s/iter; left time: 184.6490s
	iters: 900, epoch: 12 | loss: 0.3094410
	speed: 0.0094s/iter; left time: 184.5978s
	iters: 1000, epoch: 12 | loss: 0.3042899
	speed: 0.0093s/iter; left time: 181.1170s
	iters: 1100, epoch: 12 | loss: 0.2086404
	speed: 0.0094s/iter; left time: 183.2977s
	iters: 1200, epoch: 12 | loss: 0.1769436
	speed: 0.0092s/iter; left time: 178.3021s
	iters: 1300, epoch: 12 | loss: 0.3856118
	speed: 0.0095s/iter; left time: 182.3572s
	iters: 1400, epoch: 12 | loss: 0.2632895
	speed: 0.0093s/iter; left time: 178.1614s
	iters: 1500, epoch: 12 | loss: 0.2676590
	speed: 0.0093s/iter; left time: 177.0498s
	iters: 1600, epoch: 12 | loss: 0.2625089
	speed: 0.0095s/iter; left time: 180.1444s
	iters: 1700, epoch: 12 | loss: 0.2509252
	speed: 0.0095s/iter; left time: 178.1909s
	iters: 1800, epoch: 12 | loss: 0.2551738
	speed: 0.0095s/iter; left time: 177.1234s
	iters: 1900, epoch: 12 | loss: 0.4863009
	speed: 0.0095s/iter; left time: 177.2690s
	iters: 2000, epoch: 12 | loss: 0.3337950
	speed: 0.0097s/iter; left time: 180.3385s
	iters: 2100, epoch: 12 | loss: 0.2237931
	speed: 0.0094s/iter; left time: 172.7515s
	iters: 2200, epoch: 12 | loss: 0.2585295
	speed: 0.0096s/iter; left time: 175.0144s
Epoch: 12 cost time: 21.5123610496521
Epoch: 12, Steps: 2278 | Train Loss: 0.4267439 Vali Loss: 0.3662167 Test Loss: 0.1448366
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.3946404
	speed: 0.0371s/iter; left time: 672.4329s
	iters: 200, epoch: 13 | loss: 0.7388297
	speed: 0.0096s/iter; left time: 172.8857s
	iters: 300, epoch: 13 | loss: 0.1586173
	speed: 0.0095s/iter; left time: 169.6926s
	iters: 400, epoch: 13 | loss: 0.4442348
	speed: 0.0097s/iter; left time: 172.0510s
	iters: 500, epoch: 13 | loss: 0.1912422
	speed: 0.0095s/iter; left time: 168.1582s
	iters: 600, epoch: 13 | loss: 0.3376072
	speed: 0.0095s/iter; left time: 167.1181s
	iters: 700, epoch: 13 | loss: 0.1822014
	speed: 0.0097s/iter; left time: 170.4652s
	iters: 800, epoch: 13 | loss: 0.2440754
	speed: 0.0094s/iter; left time: 162.9439s
	iters: 900, epoch: 13 | loss: 0.2230450
	speed: 0.0096s/iter; left time: 166.7056s
	iters: 1000, epoch: 13 | loss: 0.1630349
	speed: 0.0093s/iter; left time: 160.0575s
	iters: 1100, epoch: 13 | loss: 0.2959460
	speed: 0.0092s/iter; left time: 158.0218s
	iters: 1200, epoch: 13 | loss: 0.3506024
	speed: 0.0093s/iter; left time: 158.7737s
	iters: 1300, epoch: 13 | loss: 0.3244463
	speed: 0.0098s/iter; left time: 165.9014s
	iters: 1400, epoch: 13 | loss: 0.2103259
	speed: 0.0094s/iter; left time: 158.3261s
	iters: 1500, epoch: 13 | loss: 0.3242382
	speed: 0.0092s/iter; left time: 154.3980s
	iters: 1600, epoch: 13 | loss: 0.1704942
	speed: 0.0095s/iter; left time: 158.2963s
	iters: 1700, epoch: 13 | loss: 0.3610336
	speed: 0.0095s/iter; left time: 156.9825s
	iters: 1800, epoch: 13 | loss: 0.1656285
	speed: 0.0093s/iter; left time: 153.1940s
	iters: 1900, epoch: 13 | loss: 0.1839718
	speed: 0.0096s/iter; left time: 157.4311s
	iters: 2000, epoch: 13 | loss: 0.2153716
	speed: 0.0095s/iter; left time: 153.4378s
	iters: 2100, epoch: 13 | loss: 0.3231261
	speed: 0.0094s/iter; left time: 151.4423s
	iters: 2200, epoch: 13 | loss: 0.2855941
	speed: 0.0093s/iter; left time: 149.1071s
Epoch: 13 cost time: 21.57487916946411
Epoch: 13, Steps: 2278 | Train Loss: 0.4266072 Vali Loss: 0.3659699 Test Loss: 0.1454643
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.2118064
	speed: 0.0375s/iter; left time: 594.0553s
	iters: 200, epoch: 14 | loss: 0.2734587
	speed: 0.0095s/iter; left time: 149.7271s
	iters: 300, epoch: 14 | loss: 0.2957344
	speed: 0.0093s/iter; left time: 144.9937s
	iters: 400, epoch: 14 | loss: 0.3280835
	speed: 0.0095s/iter; left time: 148.0633s
	iters: 500, epoch: 14 | loss: 0.2044141
	speed: 0.0096s/iter; left time: 147.9139s
	iters: 600, epoch: 14 | loss: 0.2955244
	speed: 0.0095s/iter; left time: 145.6723s
	iters: 700, epoch: 14 | loss: 0.3071433
	speed: 0.0095s/iter; left time: 145.4905s
	iters: 800, epoch: 14 | loss: 0.3611901
	speed: 0.0095s/iter; left time: 144.0423s
	iters: 900, epoch: 14 | loss: 0.2746179
	speed: 0.0093s/iter; left time: 140.0397s
	iters: 1000, epoch: 14 | loss: 0.2379779
	speed: 0.0093s/iter; left time: 139.5383s
	iters: 1100, epoch: 14 | loss: 0.3802824
	speed: 0.0097s/iter; left time: 143.7537s
	iters: 1200, epoch: 14 | loss: 0.3770821
	speed: 0.0097s/iter; left time: 143.6870s
	iters: 1300, epoch: 14 | loss: 0.2759552
	speed: 0.0094s/iter; left time: 137.6374s
	iters: 1400, epoch: 14 | loss: 0.6383530
	speed: 0.0095s/iter; left time: 137.9473s
	iters: 1500, epoch: 14 | loss: 0.2392102
	speed: 0.0093s/iter; left time: 133.7408s
	iters: 1600, epoch: 14 | loss: 0.2843366
	speed: 0.0097s/iter; left time: 138.4637s
	iters: 1700, epoch: 14 | loss: 0.4394127
	speed: 0.0093s/iter; left time: 132.7416s
	iters: 1800, epoch: 14 | loss: 0.2783702
	speed: 0.0092s/iter; left time: 130.7134s
	iters: 1900, epoch: 14 | loss: 0.1700277
	speed: 0.0096s/iter; left time: 134.7356s
	iters: 2000, epoch: 14 | loss: 0.2056823
	speed: 0.0095s/iter; left time: 132.4372s
	iters: 2100, epoch: 14 | loss: 0.2542182
	speed: 0.0093s/iter; left time: 129.1608s
	iters: 2200, epoch: 14 | loss: 0.2848984
	speed: 0.0092s/iter; left time: 126.5647s
Epoch: 14 cost time: 21.521222829818726
Epoch: 14, Steps: 2278 | Train Loss: 0.4265392 Vali Loss: 0.3661353 Test Loss: 0.1452817
EarlyStopping counter: 4 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.2758593
	speed: 0.0360s/iter; left time: 488.6569s
	iters: 200, epoch: 15 | loss: 0.3046825
	speed: 0.0098s/iter; left time: 132.1415s
	iters: 300, epoch: 15 | loss: 0.3626137
	speed: 0.0097s/iter; left time: 129.4231s
	iters: 400, epoch: 15 | loss: 0.3265138
	speed: 0.0097s/iter; left time: 129.2594s
	iters: 500, epoch: 15 | loss: 0.2402292
	speed: 0.0091s/iter; left time: 120.3249s
	iters: 600, epoch: 15 | loss: 0.3137749
	speed: 0.0101s/iter; left time: 131.7091s
	iters: 700, epoch: 15 | loss: 0.5213824
	speed: 0.0097s/iter; left time: 126.0215s
	iters: 800, epoch: 15 | loss: 0.1938384
	speed: 0.0094s/iter; left time: 120.3867s
	iters: 900, epoch: 15 | loss: 0.3062073
	speed: 0.0093s/iter; left time: 118.4127s
	iters: 1000, epoch: 15 | loss: 0.2253275
	speed: 0.0092s/iter; left time: 115.9410s
	iters: 1100, epoch: 15 | loss: 0.2061377
	speed: 0.0088s/iter; left time: 110.7025s
	iters: 1200, epoch: 15 | loss: 0.2313558
	speed: 0.0089s/iter; left time: 110.7872s
	iters: 1300, epoch: 15 | loss: 0.3423199
	speed: 0.0092s/iter; left time: 114.0603s
	iters: 1400, epoch: 15 | loss: 0.1994332
	speed: 0.0096s/iter; left time: 117.8680s
	iters: 1500, epoch: 15 | loss: 0.4471335
	speed: 0.0094s/iter; left time: 113.8052s
	iters: 1600, epoch: 15 | loss: 0.3796990
	speed: 0.0093s/iter; left time: 111.9089s
	iters: 1700, epoch: 15 | loss: 0.2263994
	speed: 0.0086s/iter; left time: 102.5969s
	iters: 1800, epoch: 15 | loss: 0.9411513
	speed: 0.0099s/iter; left time: 117.5740s
	iters: 1900, epoch: 15 | loss: 0.3554620
	speed: 0.0090s/iter; left time: 106.4217s
	iters: 2000, epoch: 15 | loss: 0.4753699
	speed: 0.0090s/iter; left time: 105.5669s
	iters: 2100, epoch: 15 | loss: 0.2320115
	speed: 0.0093s/iter; left time: 107.6191s
	iters: 2200, epoch: 15 | loss: 0.2597212
	speed: 0.0092s/iter; left time: 105.7046s
Epoch: 15 cost time: 21.214791297912598
Epoch: 15, Steps: 2278 | Train Loss: 0.4265019 Vali Loss: 0.3662140 Test Loss: 0.1453046
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : weather_336_96_Linear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed10458<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
mse:0.14571446180343628, mae:0.2121906876564026
