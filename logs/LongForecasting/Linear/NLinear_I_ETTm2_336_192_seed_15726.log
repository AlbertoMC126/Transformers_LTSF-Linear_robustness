Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='NLinear', model_id='ETTm2_336_192', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=192, root_path='./dataset/', save_pred_values=False, seed=15726, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTm2_336_192_NLinear_ETTm2_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15726>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34033
val 11329
test 11329
	iters: 100, epoch: 1 | loss: 1.7697521
	speed: 0.0054s/iter; left time: 114.4820s
	iters: 200, epoch: 1 | loss: 0.3284533
	speed: 0.0056s/iter; left time: 118.0162s
	iters: 300, epoch: 1 | loss: 0.3901020
	speed: 0.0060s/iter; left time: 124.7776s
	iters: 400, epoch: 1 | loss: 0.6492537
	speed: 0.0055s/iter; left time: 115.7487s
	iters: 500, epoch: 1 | loss: 0.4829645
	speed: 0.0057s/iter; left time: 118.3963s
	iters: 600, epoch: 1 | loss: 0.7120273
	speed: 0.0053s/iter; left time: 109.0583s
	iters: 700, epoch: 1 | loss: 0.3782381
	speed: 0.0050s/iter; left time: 102.8576s
	iters: 800, epoch: 1 | loss: 0.5050797
	speed: 0.0049s/iter; left time: 99.8497s
	iters: 900, epoch: 1 | loss: 0.6369476
	speed: 0.0046s/iter; left time: 93.3953s
	iters: 1000, epoch: 1 | loss: 0.2678993
	speed: 0.0055s/iter; left time: 111.5441s
Epoch: 1 cost time: 5.67530632019043
Epoch: 1, Steps: 1063 | Train Loss: 0.6171416 Vali Loss: 0.2758865 Test Loss: 0.3855628
Validation loss decreased (inf --> 0.275887).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.5566905
	speed: 0.0217s/iter; left time: 436.2148s
	iters: 200, epoch: 2 | loss: 0.2997696
	speed: 0.0047s/iter; left time: 93.6614s
	iters: 300, epoch: 2 | loss: 0.5522958
	speed: 0.0051s/iter; left time: 101.4801s
	iters: 400, epoch: 2 | loss: 0.2478655
	speed: 0.0065s/iter; left time: 128.3009s
	iters: 500, epoch: 2 | loss: 0.4279347
	speed: 0.0062s/iter; left time: 122.1741s
	iters: 600, epoch: 2 | loss: 0.3163846
	speed: 0.0060s/iter; left time: 118.1870s
	iters: 700, epoch: 2 | loss: 0.2710378
	speed: 0.0061s/iter; left time: 118.6198s
	iters: 800, epoch: 2 | loss: 0.7351133
	speed: 0.0052s/iter; left time: 100.4928s
	iters: 900, epoch: 2 | loss: 0.6467494
	speed: 0.0054s/iter; left time: 104.8315s
	iters: 1000, epoch: 2 | loss: 0.2987216
	speed: 0.0056s/iter; left time: 107.7008s
Epoch: 2 cost time: 5.858426570892334
Epoch: 2, Steps: 1063 | Train Loss: 0.6188313 Vali Loss: 0.2199938 Test Loss: 0.3017548
Validation loss decreased (0.275887 --> 0.219994).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.3514034
	speed: 0.0283s/iter; left time: 539.3942s
	iters: 200, epoch: 3 | loss: 0.1970735
	speed: 0.0056s/iter; left time: 105.8978s
	iters: 300, epoch: 3 | loss: 0.2500831
	speed: 0.0064s/iter; left time: 120.7323s
	iters: 400, epoch: 3 | loss: 1.0863078
	speed: 0.0058s/iter; left time: 107.9264s
	iters: 500, epoch: 3 | loss: 0.6977329
	speed: 0.0053s/iter; left time: 98.6179s
	iters: 600, epoch: 3 | loss: 0.3418606
	speed: 0.0059s/iter; left time: 109.6977s
	iters: 700, epoch: 3 | loss: 0.2750899
	speed: 0.0057s/iter; left time: 105.6592s
	iters: 800, epoch: 3 | loss: 0.1875638
	speed: 0.0059s/iter; left time: 107.5735s
	iters: 900, epoch: 3 | loss: 0.3481466
	speed: 0.0055s/iter; left time: 99.9898s
	iters: 1000, epoch: 3 | loss: 0.6050749
	speed: 0.0055s/iter; left time: 100.2866s
Epoch: 3 cost time: 6.171969890594482
Epoch: 3, Steps: 1063 | Train Loss: 0.3787179 Vali Loss: 0.1805388 Test Loss: 0.2500009
Validation loss decreased (0.219994 --> 0.180539).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.1517907
	speed: 0.0258s/iter; left time: 462.9774s
	iters: 200, epoch: 4 | loss: 0.3270166
	speed: 0.0044s/iter; left time: 78.2471s
	iters: 300, epoch: 4 | loss: 0.7665279
	speed: 0.0060s/iter; left time: 106.6722s
	iters: 400, epoch: 4 | loss: 0.2175269
	speed: 0.0062s/iter; left time: 109.2575s
	iters: 500, epoch: 4 | loss: 0.3795874
	speed: 0.0054s/iter; left time: 95.0980s
	iters: 600, epoch: 4 | loss: 0.3963802
	speed: 0.0059s/iter; left time: 103.1411s
	iters: 700, epoch: 4 | loss: 0.7275835
	speed: 0.0049s/iter; left time: 84.9206s
	iters: 800, epoch: 4 | loss: 0.1788036
	speed: 0.0052s/iter; left time: 89.5075s
	iters: 900, epoch: 4 | loss: 0.2753791
	speed: 0.0056s/iter; left time: 95.8190s
	iters: 1000, epoch: 4 | loss: 0.2958064
	speed: 0.0058s/iter; left time: 99.7210s
Epoch: 4 cost time: 5.875142335891724
Epoch: 4, Steps: 1063 | Train Loss: 0.3309253 Vali Loss: 0.1791871 Test Loss: 0.2489345
Validation loss decreased (0.180539 --> 0.179187).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.5612292
	speed: 0.0255s/iter; left time: 430.8200s
	iters: 200, epoch: 5 | loss: 0.2534638
	speed: 0.0058s/iter; left time: 97.6600s
	iters: 300, epoch: 5 | loss: 0.3552474
	speed: 0.0060s/iter; left time: 99.8056s
	iters: 400, epoch: 5 | loss: 0.3090402
	speed: 0.0062s/iter; left time: 103.1421s
	iters: 500, epoch: 5 | loss: 0.2420727
	speed: 0.0059s/iter; left time: 97.2724s
	iters: 600, epoch: 5 | loss: 0.3581195
	speed: 0.0057s/iter; left time: 92.7186s
	iters: 700, epoch: 5 | loss: 0.3585471
	speed: 0.0044s/iter; left time: 71.7930s
	iters: 800, epoch: 5 | loss: 0.8151100
	speed: 0.0051s/iter; left time: 82.4777s
	iters: 900, epoch: 5 | loss: 0.4676725
	speed: 0.0057s/iter; left time: 91.2161s
	iters: 1000, epoch: 5 | loss: 0.2080295
	speed: 0.0052s/iter; left time: 82.4465s
Epoch: 5 cost time: 5.847232103347778
Epoch: 5, Steps: 1063 | Train Loss: 0.3080146 Vali Loss: 0.1605969 Test Loss: 0.2278554
Validation loss decreased (0.179187 --> 0.160597).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.1922348
	speed: 0.0251s/iter; left time: 397.3355s
	iters: 200, epoch: 6 | loss: 0.1593716
	speed: 0.0061s/iter; left time: 96.2542s
	iters: 300, epoch: 6 | loss: 0.1508586
	speed: 0.0043s/iter; left time: 66.9650s
	iters: 400, epoch: 6 | loss: 0.2332050
	speed: 0.0042s/iter; left time: 65.9154s
	iters: 500, epoch: 6 | loss: 0.5240286
	speed: 0.0052s/iter; left time: 80.6645s
	iters: 600, epoch: 6 | loss: 0.7180384
	speed: 0.0067s/iter; left time: 102.2711s
	iters: 700, epoch: 6 | loss: 0.4114572
	speed: 0.0066s/iter; left time: 101.3631s
	iters: 800, epoch: 6 | loss: 0.2461962
	speed: 0.0067s/iter; left time: 101.5115s
	iters: 900, epoch: 6 | loss: 0.3547249
	speed: 0.0068s/iter; left time: 102.8119s
	iters: 1000, epoch: 6 | loss: 0.2338910
	speed: 0.0067s/iter; left time: 100.5863s
Epoch: 6 cost time: 6.291912317276001
Epoch: 6, Steps: 1063 | Train Loss: 0.2990529 Vali Loss: 0.1637408 Test Loss: 0.2316301
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.3340976
	speed: 0.0237s/iter; left time: 350.4595s
	iters: 200, epoch: 7 | loss: 0.2447117
	speed: 0.0061s/iter; left time: 89.2725s
	iters: 300, epoch: 7 | loss: 0.6332475
	speed: 0.0061s/iter; left time: 88.5493s
	iters: 400, epoch: 7 | loss: 0.1519943
	speed: 0.0050s/iter; left time: 71.9806s
	iters: 500, epoch: 7 | loss: 0.2706546
	speed: 0.0060s/iter; left time: 85.6191s
	iters: 600, epoch: 7 | loss: 0.3674123
	speed: 0.0055s/iter; left time: 78.6143s
	iters: 700, epoch: 7 | loss: 0.2671037
	speed: 0.0063s/iter; left time: 89.4949s
	iters: 800, epoch: 7 | loss: 0.2423307
	speed: 0.0064s/iter; left time: 89.5992s
	iters: 900, epoch: 7 | loss: 0.1148881
	speed: 0.0056s/iter; left time: 78.1650s
	iters: 1000, epoch: 7 | loss: 0.2289806
	speed: 0.0057s/iter; left time: 78.8569s
Epoch: 7 cost time: 6.101456880569458
Epoch: 7, Steps: 1063 | Train Loss: 0.2946189 Vali Loss: 0.1558708 Test Loss: 0.2188016
Validation loss decreased (0.160597 --> 0.155871).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.2019304
	speed: 0.0284s/iter; left time: 389.8328s
	iters: 200, epoch: 8 | loss: 0.2938047
	speed: 0.0060s/iter; left time: 82.1285s
	iters: 300, epoch: 8 | loss: 0.3689479
	speed: 0.0055s/iter; left time: 74.3977s
	iters: 400, epoch: 8 | loss: 0.1810238
	speed: 0.0052s/iter; left time: 69.7837s
	iters: 500, epoch: 8 | loss: 0.3216198
	speed: 0.0051s/iter; left time: 68.2387s
	iters: 600, epoch: 8 | loss: 0.2463164
	speed: 0.0057s/iter; left time: 75.8925s
	iters: 700, epoch: 8 | loss: 0.2411246
	speed: 0.0063s/iter; left time: 82.3935s
	iters: 800, epoch: 8 | loss: 0.2064572
	speed: 0.0067s/iter; left time: 87.6590s
	iters: 900, epoch: 8 | loss: 0.2778729
	speed: 0.0062s/iter; left time: 80.1042s
	iters: 1000, epoch: 8 | loss: 0.2132946
	speed: 0.0062s/iter; left time: 79.3813s
Epoch: 8 cost time: 6.274173736572266
Epoch: 8, Steps: 1063 | Train Loss: 0.2913651 Vali Loss: 0.1562907 Test Loss: 0.2190615
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.3007571
	speed: 0.0246s/iter; left time: 311.8871s
	iters: 200, epoch: 9 | loss: 0.2082360
	speed: 0.0050s/iter; left time: 63.2704s
	iters: 300, epoch: 9 | loss: 0.2694591
	speed: 0.0052s/iter; left time: 65.1739s
	iters: 400, epoch: 9 | loss: 0.3398648
	speed: 0.0060s/iter; left time: 73.6827s
	iters: 500, epoch: 9 | loss: 0.2083707
	speed: 0.0060s/iter; left time: 73.0844s
	iters: 600, epoch: 9 | loss: 0.2243178
	speed: 0.0058s/iter; left time: 70.8556s
	iters: 700, epoch: 9 | loss: 0.4468192
	speed: 0.0059s/iter; left time: 70.8435s
	iters: 800, epoch: 9 | loss: 0.2083732
	speed: 0.0057s/iter; left time: 67.7044s
	iters: 900, epoch: 9 | loss: 0.3712986
	speed: 0.0062s/iter; left time: 74.0864s
	iters: 1000, epoch: 9 | loss: 0.1699840
	speed: 0.0056s/iter; left time: 65.8671s
Epoch: 9 cost time: 6.01258111000061
Epoch: 9, Steps: 1063 | Train Loss: 0.2895282 Vali Loss: 0.1548690 Test Loss: 0.2178970
Validation loss decreased (0.155871 --> 0.154869).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.2488402
	speed: 0.0273s/iter; left time: 316.5830s
	iters: 200, epoch: 10 | loss: 0.2897050
	speed: 0.0063s/iter; left time: 72.5558s
	iters: 300, epoch: 10 | loss: 0.1229029
	speed: 0.0060s/iter; left time: 68.5029s
	iters: 400, epoch: 10 | loss: 0.2200517
	speed: 0.0052s/iter; left time: 58.7116s
	iters: 500, epoch: 10 | loss: 0.2155615
	speed: 0.0057s/iter; left time: 63.9449s
	iters: 600, epoch: 10 | loss: 0.2506765
	speed: 0.0066s/iter; left time: 72.9992s
	iters: 700, epoch: 10 | loss: 0.2940153
	speed: 0.0057s/iter; left time: 62.9151s
	iters: 800, epoch: 10 | loss: 0.5166508
	speed: 0.0051s/iter; left time: 55.3748s
	iters: 900, epoch: 10 | loss: 0.5174512
	speed: 0.0050s/iter; left time: 54.2809s
	iters: 1000, epoch: 10 | loss: 0.3141063
	speed: 0.0051s/iter; left time: 54.6679s
Epoch: 10 cost time: 5.866454124450684
Epoch: 10, Steps: 1063 | Train Loss: 0.2891137 Vali Loss: 0.1551459 Test Loss: 0.2183255
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.2583951
	speed: 0.0235s/iter; left time: 247.8692s
	iters: 200, epoch: 11 | loss: 0.3011510
	speed: 0.0062s/iter; left time: 64.8805s
	iters: 300, epoch: 11 | loss: 0.1675977
	speed: 0.0059s/iter; left time: 61.3686s
	iters: 400, epoch: 11 | loss: 0.1465230
	speed: 0.0060s/iter; left time: 60.9967s
	iters: 500, epoch: 11 | loss: 0.1774674
	speed: 0.0062s/iter; left time: 63.2047s
	iters: 600, epoch: 11 | loss: 0.3469331
	speed: 0.0064s/iter; left time: 64.0388s
	iters: 700, epoch: 11 | loss: 0.5090929
	speed: 0.0051s/iter; left time: 50.4498s
	iters: 800, epoch: 11 | loss: 0.3648100
	speed: 0.0054s/iter; left time: 52.9989s
	iters: 900, epoch: 11 | loss: 0.1348327
	speed: 0.0052s/iter; left time: 50.6216s
	iters: 1000, epoch: 11 | loss: 0.4241094
	speed: 0.0052s/iter; left time: 49.8771s
Epoch: 11 cost time: 6.0199878215789795
Epoch: 11, Steps: 1063 | Train Loss: 0.2885255 Vali Loss: 0.1550400 Test Loss: 0.2179536
EarlyStopping counter: 2 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.2471637
	speed: 0.0237s/iter; left time: 224.6216s
	iters: 200, epoch: 12 | loss: 0.3375042
	speed: 0.0062s/iter; left time: 58.1206s
	iters: 300, epoch: 12 | loss: 0.2268554
	speed: 0.0058s/iter; left time: 53.6906s
	iters: 400, epoch: 12 | loss: 0.2627333
	speed: 0.0061s/iter; left time: 56.3671s
	iters: 500, epoch: 12 | loss: 0.2145432
	speed: 0.0059s/iter; left time: 53.3382s
	iters: 600, epoch: 12 | loss: 0.3703730
	speed: 0.0056s/iter; left time: 50.2207s
	iters: 700, epoch: 12 | loss: 0.3791968
	speed: 0.0066s/iter; left time: 58.0962s
	iters: 800, epoch: 12 | loss: 0.2550668
	speed: 0.0067s/iter; left time: 59.1218s
	iters: 900, epoch: 12 | loss: 0.1537324
	speed: 0.0058s/iter; left time: 50.5719s
	iters: 1000, epoch: 12 | loss: 0.2721654
	speed: 0.0056s/iter; left time: 48.1002s
Epoch: 12 cost time: 6.239988803863525
Epoch: 12, Steps: 1063 | Train Loss: 0.2882296 Vali Loss: 0.1550183 Test Loss: 0.2177271
EarlyStopping counter: 3 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.1692805
	speed: 0.0247s/iter; left time: 207.3058s
	iters: 200, epoch: 13 | loss: 0.2588917
	speed: 0.0061s/iter; left time: 50.3319s
	iters: 300, epoch: 13 | loss: 0.1794483
	speed: 0.0064s/iter; left time: 52.6101s
	iters: 400, epoch: 13 | loss: 0.3673427
	speed: 0.0063s/iter; left time: 51.1200s
	iters: 500, epoch: 13 | loss: 0.2679956
	speed: 0.0059s/iter; left time: 47.0572s
	iters: 600, epoch: 13 | loss: 0.9299886
	speed: 0.0055s/iter; left time: 43.4171s
	iters: 700, epoch: 13 | loss: 0.3449564
	speed: 0.0057s/iter; left time: 44.1022s
	iters: 800, epoch: 13 | loss: 0.2126207
	speed: 0.0066s/iter; left time: 50.9459s
	iters: 900, epoch: 13 | loss: 0.1746973
	speed: 0.0066s/iter; left time: 50.3423s
	iters: 1000, epoch: 13 | loss: 0.4766431
	speed: 0.0069s/iter; left time: 51.4300s
Epoch: 13 cost time: 6.641546010971069
Epoch: 13, Steps: 1063 | Train Loss: 0.2881942 Vali Loss: 0.1549146 Test Loss: 0.2180773
EarlyStopping counter: 4 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 14 | loss: 0.2719297
	speed: 0.0282s/iter; left time: 207.2305s
	iters: 200, epoch: 14 | loss: 0.6994992
	speed: 0.0058s/iter; left time: 41.9347s
	iters: 300, epoch: 14 | loss: 0.2331518
	speed: 0.0055s/iter; left time: 39.5168s
	iters: 400, epoch: 14 | loss: 0.2706112
	speed: 0.0058s/iter; left time: 40.9037s
	iters: 500, epoch: 14 | loss: 0.4378304
	speed: 0.0053s/iter; left time: 36.8753s
	iters: 600, epoch: 14 | loss: 0.3099442
	speed: 0.0060s/iter; left time: 41.0056s
	iters: 700, epoch: 14 | loss: 0.1916748
	speed: 0.0066s/iter; left time: 44.2174s
	iters: 800, epoch: 14 | loss: 0.2580691
	speed: 0.0057s/iter; left time: 37.9394s
	iters: 900, epoch: 14 | loss: 0.3736338
	speed: 0.0054s/iter; left time: 35.1858s
	iters: 1000, epoch: 14 | loss: 0.1983389
	speed: 0.0054s/iter; left time: 34.5480s
Epoch: 14 cost time: 6.091102600097656
Epoch: 14, Steps: 1063 | Train Loss: 0.2880853 Vali Loss: 0.1548918 Test Loss: 0.2179767
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTm2_336_192_NLinear_ETTm2_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15726<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
mse:0.21826034784317017, mae:0.28964221477508545
