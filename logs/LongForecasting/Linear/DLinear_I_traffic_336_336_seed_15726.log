Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='DLinear', model_id='traffic_336_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=336, root_path='./dataset/', save_pred_values=False, seed=15726, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_336_336_DLinear_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15726>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11609
val 1421
test 3173
	iters: 100, epoch: 1 | loss: 0.5273017
	speed: 0.4813s/iter; left time: 6931.1268s
	iters: 200, epoch: 1 | loss: 0.5903846
	speed: 0.4436s/iter; left time: 6344.2399s
	iters: 300, epoch: 1 | loss: 0.5831856
	speed: 0.4430s/iter; left time: 6291.3239s
	iters: 400, epoch: 1 | loss: 0.6057534
	speed: 0.4413s/iter; left time: 6222.1672s
	iters: 500, epoch: 1 | loss: 0.6535299
	speed: 0.4398s/iter; left time: 6157.1453s
	iters: 600, epoch: 1 | loss: 0.6013354
	speed: 0.4579s/iter; left time: 6365.2671s
	iters: 700, epoch: 1 | loss: 0.5862786
	speed: 0.4399s/iter; left time: 6071.3011s
Epoch: 1 cost time: 326.0197265148163
Epoch: 1, Steps: 725 | Train Loss: 0.6018198 Vali Loss: 0.8006918 Test Loss: 0.9468822
Validation loss decreased (inf --> 0.800692).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.6148525
	speed: 0.9489s/iter; left time: 12977.6143s
	iters: 200, epoch: 2 | loss: 0.5852851
	speed: 0.4458s/iter; left time: 6052.6724s
	iters: 300, epoch: 2 | loss: 0.5859376
	speed: 0.4554s/iter; left time: 6137.4573s
	iters: 400, epoch: 2 | loss: 0.5819282
	speed: 0.4510s/iter; left time: 6032.2626s
	iters: 500, epoch: 2 | loss: 0.5783406
	speed: 0.4403s/iter; left time: 5845.7037s
	iters: 600, epoch: 2 | loss: 0.5882865
	speed: 0.4554s/iter; left time: 6000.9539s
	iters: 700, epoch: 2 | loss: 0.5693910
	speed: 0.4408s/iter; left time: 5764.1977s
Epoch: 2 cost time: 325.1983890533447
Epoch: 2, Steps: 725 | Train Loss: 0.5951067 Vali Loss: 0.8167334 Test Loss: 0.9584174
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.3413702
	speed: 0.8981s/iter; left time: 11631.7735s
	iters: 200, epoch: 3 | loss: 0.3509322
	speed: 0.4425s/iter; left time: 5686.9363s
	iters: 300, epoch: 3 | loss: 0.3499664
	speed: 0.4523s/iter; left time: 5766.6775s
	iters: 400, epoch: 3 | loss: 0.3652623
	speed: 0.4413s/iter; left time: 5583.1985s
	iters: 500, epoch: 3 | loss: 0.3734266
	speed: 0.4423s/iter; left time: 5551.0676s
	iters: 600, epoch: 3 | loss: 0.3571033
	speed: 0.4547s/iter; left time: 5661.1824s
	iters: 700, epoch: 3 | loss: 0.3581870
	speed: 0.4413s/iter; left time: 5449.9321s
Epoch: 3 cost time: 325.0559184551239
Epoch: 3, Steps: 725 | Train Loss: 0.3711309 Vali Loss: 0.5186369 Test Loss: 0.6278651
Validation loss decreased (0.800692 --> 0.518637).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.2939668
	speed: 0.9726s/iter; left time: 11890.8596s
	iters: 200, epoch: 4 | loss: 0.3109556
	speed: 0.4465s/iter; left time: 5413.9743s
	iters: 300, epoch: 4 | loss: 0.3056528
	speed: 0.4443s/iter; left time: 5342.5675s
	iters: 400, epoch: 4 | loss: 0.3020913
	speed: 0.4392s/iter; left time: 5237.5277s
	iters: 500, epoch: 4 | loss: 0.3077898
	speed: 0.4401s/iter; left time: 5204.4696s
	iters: 600, epoch: 4 | loss: 0.3026589
	speed: 0.4601s/iter; left time: 5394.8595s
	iters: 700, epoch: 4 | loss: 0.3212079
	speed: 0.4400s/iter; left time: 5115.9983s
Epoch: 4 cost time: 324.5376286506653
Epoch: 4, Steps: 725 | Train Loss: 0.3060691 Vali Loss: 0.4365517 Test Loss: 0.5316349
Validation loss decreased (0.518637 --> 0.436552).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.2709684
	speed: 0.9748s/iter; left time: 11211.1952s
	iters: 200, epoch: 5 | loss: 0.2625908
	speed: 0.4477s/iter; left time: 5104.2082s
	iters: 300, epoch: 5 | loss: 0.2679144
	speed: 0.4458s/iter; left time: 5037.6759s
	iters: 400, epoch: 5 | loss: 0.2765921
	speed: 0.4415s/iter; left time: 4945.1476s
	iters: 500, epoch: 5 | loss: 0.2694051
	speed: 0.4406s/iter; left time: 4891.6089s
	iters: 600, epoch: 5 | loss: 0.2924584
	speed: 0.4560s/iter; left time: 5016.6271s
	iters: 700, epoch: 5 | loss: 0.2937356
	speed: 0.4394s/iter; left time: 4790.3880s
Epoch: 5 cost time: 324.70576548576355
Epoch: 5, Steps: 725 | Train Loss: 0.2785286 Vali Loss: 0.4050659 Test Loss: 0.4919850
Validation loss decreased (0.436552 --> 0.405066).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.2572940
	speed: 0.9739s/iter; left time: 10495.1500s
	iters: 200, epoch: 6 | loss: 0.2605434
	speed: 0.4506s/iter; left time: 4810.3375s
	iters: 300, epoch: 6 | loss: 0.2875177
	speed: 0.4474s/iter; left time: 4731.3933s
	iters: 400, epoch: 6 | loss: 0.2752414
	speed: 0.4406s/iter; left time: 4616.1624s
	iters: 500, epoch: 6 | loss: 0.2585856
	speed: 0.4428s/iter; left time: 4594.4949s
	iters: 600, epoch: 6 | loss: 0.2721381
	speed: 0.4472s/iter; left time: 4595.5258s
	iters: 700, epoch: 6 | loss: 0.2501439
	speed: 0.4393s/iter; left time: 4470.3344s
Epoch: 6 cost time: 323.8084955215454
Epoch: 6, Steps: 725 | Train Loss: 0.2646712 Vali Loss: 0.3870833 Test Loss: 0.4715805
Validation loss decreased (0.405066 --> 0.387083).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.2552717
	speed: 0.9524s/iter; left time: 9572.5348s
	iters: 200, epoch: 7 | loss: 0.2476203
	speed: 0.4479s/iter; left time: 4456.7837s
	iters: 300, epoch: 7 | loss: 0.2543111
	speed: 0.4510s/iter; left time: 4442.3724s
	iters: 400, epoch: 7 | loss: 0.2575466
	speed: 0.4402s/iter; left time: 4292.3318s
	iters: 500, epoch: 7 | loss: 0.2418511
	speed: 0.4410s/iter; left time: 4256.0010s
	iters: 600, epoch: 7 | loss: 0.2674872
	speed: 0.4446s/iter; left time: 4246.0560s
	iters: 700, epoch: 7 | loss: 0.2471054
	speed: 0.4385s/iter; left time: 4144.0782s
Epoch: 7 cost time: 321.6130177974701
Epoch: 7, Steps: 725 | Train Loss: 0.2571937 Vali Loss: 0.3788838 Test Loss: 0.4628905
Validation loss decreased (0.387083 --> 0.378884).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.2558533
	speed: 0.9563s/iter; left time: 8918.6048s
	iters: 200, epoch: 8 | loss: 0.2857597
	speed: 0.4489s/iter; left time: 4141.9427s
	iters: 300, epoch: 8 | loss: 0.2536881
	speed: 0.4482s/iter; left time: 4089.8982s
	iters: 400, epoch: 8 | loss: 0.2723080
	speed: 0.4410s/iter; left time: 3980.7673s
	iters: 500, epoch: 8 | loss: 0.2379091
	speed: 0.4418s/iter; left time: 3943.2874s
	iters: 600, epoch: 8 | loss: 0.2355126
	speed: 0.4433s/iter; left time: 3912.7605s
	iters: 700, epoch: 8 | loss: 0.2808900
	speed: 0.4380s/iter; left time: 3822.2841s
Epoch: 8 cost time: 321.6245470046997
Epoch: 8, Steps: 725 | Train Loss: 0.2530394 Vali Loss: 0.3754629 Test Loss: 0.4578401
Validation loss decreased (0.378884 --> 0.375463).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.2625335
	speed: 0.9595s/iter; left time: 8252.2387s
	iters: 200, epoch: 9 | loss: 0.2520324
	speed: 0.4466s/iter; left time: 3796.1394s
	iters: 300, epoch: 9 | loss: 0.2705902
	speed: 0.4501s/iter; left time: 3781.0526s
	iters: 400, epoch: 9 | loss: 0.2272545
	speed: 0.4392s/iter; left time: 3645.6404s
	iters: 500, epoch: 9 | loss: 0.2427259
	speed: 0.4472s/iter; left time: 3667.2477s
	iters: 600, epoch: 9 | loss: 0.2523865
	speed: 0.4485s/iter; left time: 3633.5930s
	iters: 700, epoch: 9 | loss: 0.2324091
	speed: 0.4386s/iter; left time: 3509.0718s
Epoch: 9 cost time: 322.23985981941223
Epoch: 9, Steps: 725 | Train Loss: 0.2507577 Vali Loss: 0.3721917 Test Loss: 0.4552828
Validation loss decreased (0.375463 --> 0.372192).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.2652485
	speed: 0.9518s/iter; left time: 7496.3304s
	iters: 200, epoch: 10 | loss: 0.2854276
	speed: 0.4565s/iter; left time: 3549.3759s
	iters: 300, epoch: 10 | loss: 0.2430428
	speed: 0.4538s/iter; left time: 3483.1036s
	iters: 400, epoch: 10 | loss: 0.2421356
	speed: 0.4400s/iter; left time: 3333.1101s
	iters: 500, epoch: 10 | loss: 0.2322510
	speed: 0.4456s/iter; left time: 3331.1555s
	iters: 600, epoch: 10 | loss: 0.2411133
	speed: 0.4435s/iter; left time: 3270.9429s
	iters: 700, epoch: 10 | loss: 0.2344002
	speed: 0.4374s/iter; left time: 3182.7064s
Epoch: 10 cost time: 323.1604721546173
Epoch: 10, Steps: 725 | Train Loss: 0.2494986 Vali Loss: 0.3721076 Test Loss: 0.4542521
Validation loss decreased (0.372192 --> 0.372108).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.2474192
	speed: 0.9583s/iter; left time: 6852.8328s
	iters: 200, epoch: 11 | loss: 0.2400961
	speed: 0.4474s/iter; left time: 3154.3439s
	iters: 300, epoch: 11 | loss: 0.2343120
	speed: 0.4492s/iter; left time: 3122.4924s
	iters: 400, epoch: 11 | loss: 0.2422908
	speed: 0.4398s/iter; left time: 3013.3869s
	iters: 500, epoch: 11 | loss: 0.2340235
	speed: 0.4543s/iter; left time: 3066.9788s
	iters: 600, epoch: 11 | loss: 0.2674496
	speed: 0.4476s/iter; left time: 2976.8074s
	iters: 700, epoch: 11 | loss: 0.2347370
	speed: 0.4384s/iter; left time: 2871.8808s
Epoch: 11 cost time: 323.1027386188507
Epoch: 11, Steps: 725 | Train Loss: 0.2487991 Vali Loss: 0.3710837 Test Loss: 0.4538026
Validation loss decreased (0.372108 --> 0.371084).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.2574268
	speed: 0.9538s/iter; left time: 6129.2754s
	iters: 200, epoch: 12 | loss: 0.2296272
	speed: 0.4492s/iter; left time: 2841.8940s
	iters: 300, epoch: 12 | loss: 0.2686576
	speed: 0.4506s/iter; left time: 2805.4121s
	iters: 400, epoch: 12 | loss: 0.2631013
	speed: 0.4382s/iter; left time: 2684.4928s
	iters: 500, epoch: 12 | loss: 0.2593230
	speed: 0.4539s/iter; left time: 2735.3237s
	iters: 600, epoch: 12 | loss: 0.2288097
	speed: 0.4451s/iter; left time: 2637.5811s
	iters: 700, epoch: 12 | loss: 0.2488907
	speed: 0.4390s/iter; left time: 2557.8663s
Epoch: 12 cost time: 323.11446166038513
Epoch: 12, Steps: 725 | Train Loss: 0.2484347 Vali Loss: 0.3713812 Test Loss: 0.4536256
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.2364633
	speed: 0.8788s/iter; left time: 5009.9765s
	iters: 200, epoch: 13 | loss: 0.2466404
	speed: 0.4468s/iter; left time: 2502.7685s
	iters: 300, epoch: 13 | loss: 0.2832665
	speed: 0.4455s/iter; left time: 2450.8086s
	iters: 400, epoch: 13 | loss: 0.2763059
	speed: 0.4402s/iter; left time: 2377.6690s
	iters: 500, epoch: 13 | loss: 0.2464802
	speed: 0.4392s/iter; left time: 2328.1404s
	iters: 600, epoch: 13 | loss: 0.2683531
	speed: 0.4422s/iter; left time: 2300.0571s
	iters: 700, epoch: 13 | loss: 0.2473183
	speed: 0.4404s/iter; left time: 2246.6969s
Epoch: 13 cost time: 320.74502968788147
Epoch: 13, Steps: 725 | Train Loss: 0.2482553 Vali Loss: 0.3706588 Test Loss: 0.4536231
Validation loss decreased (0.371084 --> 0.370659).  Saving model ...
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 14 | loss: 0.2358328
	speed: 0.9565s/iter; left time: 4759.5918s
	iters: 200, epoch: 14 | loss: 0.2732885
	speed: 0.4463s/iter; left time: 2176.0519s
	iters: 300, epoch: 14 | loss: 0.2814125
	speed: 0.4459s/iter; left time: 2129.4217s
	iters: 400, epoch: 14 | loss: 0.2466796
	speed: 0.4375s/iter; left time: 2045.7331s
	iters: 500, epoch: 14 | loss: 0.2473864
	speed: 0.4465s/iter; left time: 2043.3884s
	iters: 600, epoch: 14 | loss: 0.2418684
	speed: 0.4465s/iter; left time: 1998.7134s
	iters: 700, epoch: 14 | loss: 0.2681125
	speed: 0.4380s/iter; left time: 1916.8328s
Epoch: 14 cost time: 321.36036562919617
Epoch: 14, Steps: 725 | Train Loss: 0.2480960 Vali Loss: 0.3710673 Test Loss: 0.4535702
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 15 | loss: 0.2643307
	speed: 0.8710s/iter; left time: 3702.6652s
	iters: 200, epoch: 15 | loss: 0.2466221
	speed: 0.4442s/iter; left time: 1844.0382s
	iters: 300, epoch: 15 | loss: 0.2778674
	speed: 0.4445s/iter; left time: 1800.7676s
	iters: 400, epoch: 15 | loss: 0.2371548
	speed: 0.4417s/iter; left time: 1745.0013s
	iters: 500, epoch: 15 | loss: 0.2506454
	speed: 0.4403s/iter; left time: 1695.5894s
	iters: 600, epoch: 15 | loss: 0.2442581
	speed: 0.4391s/iter; left time: 1647.1758s
	iters: 700, epoch: 15 | loss: 0.2409436
	speed: 0.4370s/iter; left time: 1595.6430s
Epoch: 15 cost time: 319.6262402534485
Epoch: 15, Steps: 725 | Train Loss: 0.2480532 Vali Loss: 0.3709725 Test Loss: 0.4535589
EarlyStopping counter: 2 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 16 | loss: 0.2484787
	speed: 0.8867s/iter; left time: 3126.5734s
	iters: 200, epoch: 16 | loss: 0.2440442
	speed: 0.4447s/iter; left time: 1523.4465s
	iters: 300, epoch: 16 | loss: 0.2589511
	speed: 0.4537s/iter; left time: 1508.9803s
	iters: 400, epoch: 16 | loss: 0.2619836
	speed: 0.4429s/iter; left time: 1428.7919s
	iters: 500, epoch: 16 | loss: 0.2580879
	speed: 0.4399s/iter; left time: 1375.1344s
	iters: 600, epoch: 16 | loss: 0.2548850
	speed: 0.4512s/iter; left time: 1365.4326s
	iters: 700, epoch: 16 | loss: 0.2474572
	speed: 0.4431s/iter; left time: 1296.5853s
Epoch: 16 cost time: 322.57515120506287
Epoch: 16, Steps: 725 | Train Loss: 0.2480481 Vali Loss: 0.3713363 Test Loss: 0.4535576
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 17 | loss: 0.2450980
	speed: 0.8974s/iter; left time: 2513.6908s
	iters: 200, epoch: 17 | loss: 0.2424063
	speed: 0.4448s/iter; left time: 1201.3813s
	iters: 300, epoch: 17 | loss: 0.2420841
	speed: 0.4509s/iter; left time: 1172.6919s
	iters: 400, epoch: 17 | loss: 0.2677804
	speed: 0.4421s/iter; left time: 1105.5887s
	iters: 500, epoch: 17 | loss: 0.2627327
	speed: 0.4395s/iter; left time: 1055.3427s
	iters: 600, epoch: 17 | loss: 0.2379691
	speed: 0.4568s/iter; left time: 1051.0499s
	iters: 700, epoch: 17 | loss: 0.2582861
	speed: 0.4392s/iter; left time: 966.7637s
Epoch: 17 cost time: 324.8019759654999
Epoch: 17, Steps: 725 | Train Loss: 0.2480177 Vali Loss: 0.3708155 Test Loss: 0.4535561
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 18 | loss: 0.2498681
	speed: 0.8976s/iter; left time: 1863.4062s
	iters: 200, epoch: 18 | loss: 0.2445550
	speed: 0.4424s/iter; left time: 874.2248s
	iters: 300, epoch: 18 | loss: 0.2506483
	speed: 0.4505s/iter; left time: 845.1230s
	iters: 400, epoch: 18 | loss: 0.2466325
	speed: 0.4448s/iter; left time: 789.9865s
	iters: 500, epoch: 18 | loss: 0.2243759
	speed: 0.4390s/iter; left time: 735.7707s
	iters: 600, epoch: 18 | loss: 0.2614768
	speed: 0.4494s/iter; left time: 708.3193s
	iters: 700, epoch: 18 | loss: 0.2571311
	speed: 0.4381s/iter; left time: 646.6349s
Epoch: 18 cost time: 324.0564603805542
Epoch: 18, Steps: 725 | Train Loss: 0.2479826 Vali Loss: 0.3711158 Test Loss: 0.4535558
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : traffic_336_336_DLinear_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15726<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3173
mse:0.4526432752609253, mae:0.31233951449394226
