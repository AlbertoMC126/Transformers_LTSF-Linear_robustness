Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTh2', data_path='ETTh2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.05, loss='mse', lradj='type1', model='Linear', model_id='ETTh2_336_192', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=192, root_path='./dataset/', save_pred_values=False, seed=15349, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTh2_336_192_Linear_ETTh2_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15349>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8113
val 2689
test 2689
	iters: 100, epoch: 1 | loss: 1.8292917
	speed: 0.0037s/iter; left time: 37.1515s
	iters: 200, epoch: 1 | loss: 1.8677431
	speed: 0.0035s/iter; left time: 35.0140s
	iters: 300, epoch: 1 | loss: 11.4485750
	speed: 0.0034s/iter; left time: 33.3610s
	iters: 400, epoch: 1 | loss: 10.7766037
	speed: 0.0037s/iter; left time: 35.5604s
	iters: 500, epoch: 1 | loss: 3.7260139
	speed: 0.0038s/iter; left time: 37.0534s
Epoch: 1 cost time: 1.8426084518432617
Epoch: 1, Steps: 507 | Train Loss: 7.9918494 Vali Loss: 5.0130339 Test Loss: 9.3248138
Validation loss decreased (inf --> 5.013034).  Saving model ...
Updating learning rate to 0.05
	iters: 100, epoch: 2 | loss: 7.9065704
	speed: 0.0076s/iter; left time: 72.7443s
	iters: 200, epoch: 2 | loss: 1.9719751
	speed: 0.0041s/iter; left time: 39.0812s
	iters: 300, epoch: 2 | loss: 7.2981696
	speed: 0.0041s/iter; left time: 37.9893s
	iters: 400, epoch: 2 | loss: 3.9382484
	speed: 0.0037s/iter; left time: 34.4624s
	iters: 500, epoch: 2 | loss: 4.5837865
	speed: 0.0043s/iter; left time: 39.4427s
Epoch: 2 cost time: 2.0522916316986084
Epoch: 2, Steps: 507 | Train Loss: 6.4070119 Vali Loss: 2.8188448 Test Loss: 7.5652518
Validation loss decreased (5.013034 --> 2.818845).  Saving model ...
Updating learning rate to 0.025
	iters: 100, epoch: 3 | loss: 1.4372455
	speed: 0.0083s/iter; left time: 74.7605s
	iters: 200, epoch: 3 | loss: 1.0025103
	speed: 0.0042s/iter; left time: 37.4981s
	iters: 300, epoch: 3 | loss: 1.0609953
	speed: 0.0042s/iter; left time: 37.0038s
	iters: 400, epoch: 3 | loss: 0.7949845
	speed: 0.0043s/iter; left time: 37.9622s
	iters: 500, epoch: 3 | loss: 0.9180052
	speed: 0.0043s/iter; left time: 37.2876s
Epoch: 3 cost time: 2.1349740028381348
Epoch: 3, Steps: 507 | Train Loss: 1.1771268 Vali Loss: 1.3484656 Test Loss: 3.6929824
Validation loss decreased (2.818845 --> 1.348466).  Saving model ...
Updating learning rate to 0.0125
	iters: 100, epoch: 4 | loss: 0.8365384
	speed: 0.0094s/iter; left time: 80.1210s
	iters: 200, epoch: 4 | loss: 0.4217069
	speed: 0.0046s/iter; left time: 38.3382s
	iters: 300, epoch: 4 | loss: 0.7666764
	speed: 0.0034s/iter; left time: 28.0812s
	iters: 400, epoch: 4 | loss: 0.8225636
	speed: 0.0042s/iter; left time: 34.7880s
	iters: 500, epoch: 4 | loss: 0.6115863
	speed: 0.0043s/iter; left time: 35.1596s
Epoch: 4 cost time: 2.1353960037231445
Epoch: 4, Steps: 507 | Train Loss: 0.6304448 Vali Loss: 0.4304946 Test Loss: 0.6502052
Validation loss decreased (1.348466 --> 0.430495).  Saving model ...
Updating learning rate to 0.00625
	iters: 100, epoch: 5 | loss: 0.6911709
	speed: 0.0093s/iter; left time: 74.7238s
	iters: 200, epoch: 5 | loss: 0.5118011
	speed: 0.0045s/iter; left time: 35.4762s
	iters: 300, epoch: 5 | loss: 0.5562817
	speed: 0.0044s/iter; left time: 34.3043s
	iters: 400, epoch: 5 | loss: 0.9994850
	speed: 0.0042s/iter; left time: 32.3943s
	iters: 500, epoch: 5 | loss: 0.5033159
	speed: 0.0044s/iter; left time: 33.8156s
Epoch: 5 cost time: 2.2395718097686768
Epoch: 5, Steps: 507 | Train Loss: 0.5381343 Vali Loss: 0.3772118 Test Loss: 0.5900195
Validation loss decreased (0.430495 --> 0.377212).  Saving model ...
Updating learning rate to 0.003125
	iters: 100, epoch: 6 | loss: 0.4171019
	speed: 0.0083s/iter; left time: 62.6382s
	iters: 200, epoch: 6 | loss: 0.2994311
	speed: 0.0046s/iter; left time: 33.9195s
	iters: 300, epoch: 6 | loss: 0.8695939
	speed: 0.0047s/iter; left time: 34.2894s
	iters: 400, epoch: 6 | loss: 0.7476308
	speed: 0.0045s/iter; left time: 32.6433s
	iters: 500, epoch: 6 | loss: 0.3198618
	speed: 0.0044s/iter; left time: 30.9326s
Epoch: 6 cost time: 2.2959213256835938
Epoch: 6, Steps: 507 | Train Loss: 0.4930654 Vali Loss: 0.3895654 Test Loss: 0.6145836
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0015625
	iters: 100, epoch: 7 | loss: 0.5084645
	speed: 0.0092s/iter; left time: 64.5283s
	iters: 200, epoch: 7 | loss: 0.5453450
	speed: 0.0048s/iter; left time: 32.7877s
	iters: 300, epoch: 7 | loss: 0.9530400
	speed: 0.0048s/iter; left time: 32.5717s
	iters: 400, epoch: 7 | loss: 0.2307101
	speed: 0.0042s/iter; left time: 28.1488s
	iters: 500, epoch: 7 | loss: 0.3459699
	speed: 0.0040s/iter; left time: 26.7259s
Epoch: 7 cost time: 2.2575135231018066
Epoch: 7, Steps: 507 | Train Loss: 0.4712221 Vali Loss: 0.4597868 Test Loss: 0.8431461
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.00078125
	iters: 100, epoch: 8 | loss: 0.5761828
	speed: 0.0079s/iter; left time: 51.3277s
	iters: 200, epoch: 8 | loss: 0.7399704
	speed: 0.0047s/iter; left time: 29.9973s
	iters: 300, epoch: 8 | loss: 0.5567751
	speed: 0.0043s/iter; left time: 26.9823s
	iters: 400, epoch: 8 | loss: 0.4566184
	speed: 0.0043s/iter; left time: 26.6255s
	iters: 500, epoch: 8 | loss: 0.4143349
	speed: 0.0044s/iter; left time: 26.8184s
Epoch: 8 cost time: 2.251354694366455
Epoch: 8, Steps: 507 | Train Loss: 0.4590385 Vali Loss: 0.3720057 Test Loss: 0.5227807
Validation loss decreased (0.377212 --> 0.372006).  Saving model ...
Updating learning rate to 0.000390625
	iters: 100, epoch: 9 | loss: 0.3930852
	speed: 0.0065s/iter; left time: 39.0855s
	iters: 200, epoch: 9 | loss: 0.4654858
	speed: 0.0038s/iter; left time: 22.3766s
	iters: 300, epoch: 9 | loss: 0.3946011
	speed: 0.0041s/iter; left time: 23.7764s
	iters: 400, epoch: 9 | loss: 0.2432232
	speed: 0.0042s/iter; left time: 23.6087s
	iters: 500, epoch: 9 | loss: 0.2850550
	speed: 0.0045s/iter; left time: 25.3559s
Epoch: 9 cost time: 2.010571241378784
Epoch: 9, Steps: 507 | Train Loss: 0.4522983 Vali Loss: 0.4173524 Test Loss: 0.7014928
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0001953125
	iters: 100, epoch: 10 | loss: 0.2959307
	speed: 0.0090s/iter; left time: 49.4682s
	iters: 200, epoch: 10 | loss: 0.1565017
	speed: 0.0036s/iter; left time: 19.2533s
	iters: 300, epoch: 10 | loss: 0.1979807
	speed: 0.0038s/iter; left time: 20.0151s
	iters: 400, epoch: 10 | loss: 0.4349853
	speed: 0.0037s/iter; left time: 19.0033s
	iters: 500, epoch: 10 | loss: 0.5316808
	speed: 0.0034s/iter; left time: 17.0648s
Epoch: 10 cost time: 1.8533177375793457
Epoch: 10, Steps: 507 | Train Loss: 0.4485383 Vali Loss: 0.3787951 Test Loss: 0.5525361
EarlyStopping counter: 2 out of 5
Updating learning rate to 9.765625e-05
	iters: 100, epoch: 11 | loss: 0.2442296
	speed: 0.0069s/iter; left time: 34.4071s
	iters: 200, epoch: 11 | loss: 0.6586477
	speed: 0.0038s/iter; left time: 18.4258s
	iters: 300, epoch: 11 | loss: 0.2504662
	speed: 0.0041s/iter; left time: 19.7547s
	iters: 400, epoch: 11 | loss: 0.6285577
	speed: 0.0040s/iter; left time: 18.8707s
	iters: 500, epoch: 11 | loss: 0.2982619
	speed: 0.0039s/iter; left time: 17.7044s
Epoch: 11 cost time: 1.9306468963623047
Epoch: 11, Steps: 507 | Train Loss: 0.4455307 Vali Loss: 0.4103235 Test Loss: 0.6687753
EarlyStopping counter: 3 out of 5
Updating learning rate to 4.8828125e-05
	iters: 100, epoch: 12 | loss: 0.2541882
	speed: 0.0083s/iter; left time: 36.9360s
	iters: 200, epoch: 12 | loss: 0.5687790
	speed: 0.0043s/iter; left time: 18.9538s
	iters: 300, epoch: 12 | loss: 0.6534310
	speed: 0.0045s/iter; left time: 19.1026s
	iters: 400, epoch: 12 | loss: 0.1753760
	speed: 0.0046s/iter; left time: 19.1641s
	iters: 500, epoch: 12 | loss: 0.2722202
	speed: 0.0047s/iter; left time: 19.3040s
Epoch: 12 cost time: 2.258906364440918
Epoch: 12, Steps: 507 | Train Loss: 0.4437793 Vali Loss: 0.3851824 Test Loss: 0.5785609
EarlyStopping counter: 4 out of 5
Updating learning rate to 2.44140625e-05
	iters: 100, epoch: 13 | loss: 0.3168609
	speed: 0.0087s/iter; left time: 34.2907s
	iters: 200, epoch: 13 | loss: 0.5587752
	speed: 0.0043s/iter; left time: 16.5993s
	iters: 300, epoch: 13 | loss: 0.3032307
	speed: 0.0047s/iter; left time: 17.6203s
	iters: 400, epoch: 13 | loss: 0.2293541
	speed: 0.0047s/iter; left time: 17.1655s
	iters: 500, epoch: 13 | loss: 0.7451808
	speed: 0.0044s/iter; left time: 15.6863s
Epoch: 13 cost time: 2.2347490787506104
Epoch: 13, Steps: 507 | Train Loss: 0.4433073 Vali Loss: 0.3859744 Test Loss: 0.5771973
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTh2_336_192_Linear_ETTh2_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15349<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2689
mse:0.5241299867630005, mae:0.47507116198539734
