Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTh2', data_path='ETTh2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.05, loss='mse', lradj='type1', model='DLinear', model_id='ETTh2_336_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=15726, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTh2_336_96_DLinear_ETTh2_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15726>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
Total number of trainable parameters: 452928
Total number of parameters: 452928
	iters: 100, epoch: 1 | loss: 1.0144953
	speed: 0.0112s/iter; left time: 56.4771s
	iters: 200, epoch: 1 | loss: 2.9427853
	speed: 0.0101s/iter; left time: 49.8215s
Epoch: 1 cost time: 2.953488826751709
Epoch: 1, Steps: 256 | Train Loss: 4.5504542 Vali Loss: 1.9532008 Test Loss: 4.3751726
Validation loss decreased (inf --> 1.953201).  Saving model ...
Updating learning rate to 0.05
	iters: 100, epoch: 2 | loss: 3.4236369
	speed: 0.0296s/iter; left time: 140.9299s
	iters: 200, epoch: 2 | loss: 3.1810644
	speed: 0.0109s/iter; left time: 50.9983s
Epoch: 2 cost time: 2.712968587875366
Epoch: 2, Steps: 256 | Train Loss: 3.4487875 Vali Loss: 2.4971910 Test Loss: 4.8750839
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.025
	iters: 100, epoch: 3 | loss: 1.2202858
	speed: 0.0235s/iter; left time: 106.0197s
	iters: 200, epoch: 3 | loss: 0.7387208
	speed: 0.0111s/iter; left time: 48.8665s
Epoch: 3 cost time: 2.8795902729034424
Epoch: 3, Steps: 256 | Train Loss: 1.3793829 Vali Loss: 0.4806010 Test Loss: 0.7759098
Validation loss decreased (1.953201 --> 0.480601).  Saving model ...
Updating learning rate to 0.0125
	iters: 100, epoch: 4 | loss: 0.4926070
	speed: 0.0273s/iter; left time: 116.3078s
	iters: 200, epoch: 4 | loss: 0.3606595
	speed: 0.0110s/iter; left time: 45.5007s
Epoch: 4 cost time: 2.921260356903076
Epoch: 4, Steps: 256 | Train Loss: 0.4868072 Vali Loss: 0.3760386 Test Loss: 0.6734341
Validation loss decreased (0.480601 --> 0.376039).  Saving model ...
Updating learning rate to 0.00625
	iters: 100, epoch: 5 | loss: 0.6777725
	speed: 0.0247s/iter; left time: 98.8219s
	iters: 200, epoch: 5 | loss: 0.4006585
	speed: 0.0106s/iter; left time: 41.2725s
Epoch: 5 cost time: 2.6813642978668213
Epoch: 5, Steps: 256 | Train Loss: 0.4140304 Vali Loss: 0.3171260 Test Loss: 0.5151549
Validation loss decreased (0.376039 --> 0.317126).  Saving model ...
Updating learning rate to 0.003125
	iters: 100, epoch: 6 | loss: 0.6494813
	speed: 0.0243s/iter; left time: 90.8371s
	iters: 200, epoch: 6 | loss: 0.5193838
	speed: 0.0125s/iter; left time: 45.4565s
Epoch: 6 cost time: 2.9901371002197266
Epoch: 6, Steps: 256 | Train Loss: 0.3833301 Vali Loss: 0.3059475 Test Loss: 0.4942003
Validation loss decreased (0.317126 --> 0.305948).  Saving model ...
Updating learning rate to 0.0015625
	iters: 100, epoch: 7 | loss: 0.4016641
	speed: 0.0248s/iter; left time: 86.3298s
	iters: 200, epoch: 7 | loss: 0.4680524
	speed: 0.0111s/iter; left time: 37.4096s
Epoch: 7 cost time: 2.8415045738220215
Epoch: 7, Steps: 256 | Train Loss: 0.3680011 Vali Loss: 0.2907829 Test Loss: 0.4269418
Validation loss decreased (0.305948 --> 0.290783).  Saving model ...
Updating learning rate to 0.00078125
	iters: 100, epoch: 8 | loss: 0.3492656
	speed: 0.0237s/iter; left time: 76.5102s
	iters: 200, epoch: 8 | loss: 0.4024293
	speed: 0.0108s/iter; left time: 33.8757s
Epoch: 8 cost time: 2.627990245819092
Epoch: 8, Steps: 256 | Train Loss: 0.3592075 Vali Loss: 0.2823166 Test Loss: 0.4360432
Validation loss decreased (0.290783 --> 0.282317).  Saving model ...
Updating learning rate to 0.000390625
	iters: 100, epoch: 9 | loss: 0.5294937
	speed: 0.0245s/iter; left time: 72.7799s
	iters: 200, epoch: 9 | loss: 0.3370399
	speed: 0.0105s/iter; left time: 30.1124s
Epoch: 9 cost time: 2.6835618019104004
Epoch: 9, Steps: 256 | Train Loss: 0.3549183 Vali Loss: 0.2786343 Test Loss: 0.4284865
Validation loss decreased (0.282317 --> 0.278634).  Saving model ...
Updating learning rate to 0.0001953125
	iters: 100, epoch: 10 | loss: 0.4128318
	speed: 0.0254s/iter; left time: 69.0855s
	iters: 200, epoch: 10 | loss: 0.3204379
	speed: 0.0110s/iter; left time: 28.8196s
Epoch: 10 cost time: 2.9211928844451904
Epoch: 10, Steps: 256 | Train Loss: 0.3508560 Vali Loss: 0.2735139 Test Loss: 0.4061387
Validation loss decreased (0.278634 --> 0.273514).  Saving model ...
Updating learning rate to 9.765625e-05
	iters: 100, epoch: 11 | loss: 0.3029534
	speed: 0.0247s/iter; left time: 60.8564s
	iters: 200, epoch: 11 | loss: 0.4678234
	speed: 0.0102s/iter; left time: 23.9989s
Epoch: 11 cost time: 2.6800503730773926
Epoch: 11, Steps: 256 | Train Loss: 0.3502529 Vali Loss: 0.2758170 Test Loss: 0.4150609
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.8828125e-05
	iters: 100, epoch: 12 | loss: 0.4875883
	speed: 0.0241s/iter; left time: 53.0681s
	iters: 200, epoch: 12 | loss: 0.5548410
	speed: 0.0098s/iter; left time: 20.6977s
Epoch: 12 cost time: 2.6150825023651123
Epoch: 12, Steps: 256 | Train Loss: 0.3490513 Vali Loss: 0.2790593 Test Loss: 0.4252591
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.44140625e-05
	iters: 100, epoch: 13 | loss: 0.2584318
	speed: 0.0204s/iter; left time: 39.6905s
	iters: 200, epoch: 13 | loss: 0.2399737
	speed: 0.0090s/iter; left time: 16.6951s
Epoch: 13 cost time: 2.270068407058716
Epoch: 13, Steps: 256 | Train Loss: 0.3481003 Vali Loss: 0.2785619 Test Loss: 0.4230131
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.220703125e-05
	iters: 100, epoch: 14 | loss: 0.1902403
	speed: 0.0180s/iter; left time: 30.4538s
	iters: 200, epoch: 14 | loss: 0.4720806
	speed: 0.0077s/iter; left time: 12.3160s
Epoch: 14 cost time: 2.0299057960510254
Epoch: 14, Steps: 256 | Train Loss: 0.3485355 Vali Loss: 0.2798035 Test Loss: 0.4283322
EarlyStopping counter: 4 out of 5
Updating learning rate to 6.103515625e-06
	iters: 100, epoch: 15 | loss: 0.2494290
	speed: 0.0161s/iter; left time: 23.0949s
	iters: 200, epoch: 15 | loss: 0.6502852
	speed: 0.0071s/iter; left time: 9.4644s
Epoch: 15 cost time: 1.7790095806121826
Epoch: 15, Steps: 256 | Train Loss: 0.3468233 Vali Loss: 0.2776189 Test Loss: 0.4207276
EarlyStopping counter: 5 out of 5
Early stopping
Total training time: 50.4399 seconds
>>>>>>>testing : ETTh2_336_96_DLinear_ETTh2_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15726<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.40951281785964966, mae:0.42423948645591736
