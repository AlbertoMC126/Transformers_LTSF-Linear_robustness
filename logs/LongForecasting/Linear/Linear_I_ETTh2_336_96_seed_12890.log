Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTh2', data_path='ETTh2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.05, loss='mse', lradj='type1', model='Linear', model_id='ETTh2_336_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=12890, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTh2_336_96_Linear_ETTh2_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed12890>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.7502334
	speed: 0.0028s/iter; left time: 28.8576s
	iters: 200, epoch: 1 | loss: 2.1659296
	speed: 0.0029s/iter; left time: 28.9755s
	iters: 300, epoch: 1 | loss: 6.3333979
	speed: 0.0029s/iter; left time: 29.2159s
	iters: 400, epoch: 1 | loss: 6.7981915
	speed: 0.0030s/iter; left time: 29.6817s
	iters: 500, epoch: 1 | loss: 17.7446537
	speed: 0.0036s/iter; left time: 35.5349s
Epoch: 1 cost time: 1.5833556652069092
Epoch: 1, Steps: 513 | Train Loss: 8.2104387 Vali Loss: 10.5383396 Test Loss: 31.1042156
Validation loss decreased (inf --> 10.538340).  Saving model ...
Updating learning rate to 0.05
	iters: 100, epoch: 2 | loss: 2.5454602
	speed: 0.0072s/iter; left time: 69.8761s
	iters: 200, epoch: 2 | loss: 5.3057928
	speed: 0.0034s/iter; left time: 32.9404s
	iters: 300, epoch: 2 | loss: 3.4239473
	speed: 0.0033s/iter; left time: 31.4009s
	iters: 400, epoch: 2 | loss: 4.3837047
	speed: 0.0034s/iter; left time: 31.7832s
	iters: 500, epoch: 2 | loss: 4.7200155
	speed: 0.0030s/iter; left time: 27.6515s
Epoch: 2 cost time: 1.698352575302124
Epoch: 2, Steps: 513 | Train Loss: 5.1353598 Vali Loss: 7.3896828 Test Loss: 19.4432316
Validation loss decreased (10.538340 --> 7.389683).  Saving model ...
Updating learning rate to 0.025
	iters: 100, epoch: 3 | loss: 0.6192961
	speed: 0.0064s/iter; left time: 58.8474s
	iters: 200, epoch: 3 | loss: 2.0316334
	speed: 0.0032s/iter; left time: 29.1830s
	iters: 300, epoch: 3 | loss: 0.4687398
	speed: 0.0027s/iter; left time: 23.6997s
	iters: 400, epoch: 3 | loss: 0.9090111
	speed: 0.0029s/iter; left time: 25.3566s
	iters: 500, epoch: 3 | loss: 0.6815042
	speed: 0.0031s/iter; left time: 27.4396s
Epoch: 3 cost time: 1.5294392108917236
Epoch: 3, Steps: 513 | Train Loss: 1.0414398 Vali Loss: 0.6022886 Test Loss: 1.1967945
Validation loss decreased (7.389683 --> 0.602289).  Saving model ...
Updating learning rate to 0.0125
	iters: 100, epoch: 4 | loss: 0.9772341
	speed: 0.0063s/iter; left time: 54.4274s
	iters: 200, epoch: 4 | loss: 0.2849040
	speed: 0.0024s/iter; left time: 20.1971s
	iters: 300, epoch: 4 | loss: 0.5082670
	speed: 0.0027s/iter; left time: 22.4024s
	iters: 400, epoch: 4 | loss: 0.3253082
	speed: 0.0030s/iter; left time: 24.5743s
	iters: 500, epoch: 4 | loss: 0.2550997
	speed: 0.0031s/iter; left time: 25.7350s
Epoch: 4 cost time: 1.4332935810089111
Epoch: 4, Steps: 513 | Train Loss: 0.5245407 Vali Loss: 0.5903291 Test Loss: 1.4832990
Validation loss decreased (0.602289 --> 0.590329).  Saving model ...
Updating learning rate to 0.00625
	iters: 100, epoch: 5 | loss: 0.2506431
	speed: 0.0069s/iter; left time: 56.2095s
	iters: 200, epoch: 5 | loss: 0.2672891
	speed: 0.0033s/iter; left time: 26.1090s
	iters: 300, epoch: 5 | loss: 0.5823436
	speed: 0.0032s/iter; left time: 25.5461s
	iters: 400, epoch: 5 | loss: 0.5674919
	speed: 0.0036s/iter; left time: 28.3612s
	iters: 500, epoch: 5 | loss: 0.4276089
	speed: 0.0038s/iter; left time: 29.1400s
Epoch: 5 cost time: 1.7713532447814941
Epoch: 5, Steps: 513 | Train Loss: 0.4327485 Vali Loss: 0.3065609 Test Loss: 0.5547470
Validation loss decreased (0.590329 --> 0.306561).  Saving model ...
Updating learning rate to 0.003125
	iters: 100, epoch: 6 | loss: 0.6247997
	speed: 0.0070s/iter; left time: 53.1161s
	iters: 200, epoch: 6 | loss: 0.3521957
	speed: 0.0037s/iter; left time: 27.8025s
	iters: 300, epoch: 6 | loss: 0.2274495
	speed: 0.0039s/iter; left time: 28.4747s
	iters: 400, epoch: 6 | loss: 0.5458187
	speed: 0.0029s/iter; left time: 21.1736s
	iters: 500, epoch: 6 | loss: 0.5333869
	speed: 0.0028s/iter; left time: 19.9328s
Epoch: 6 cost time: 1.673344373703003
Epoch: 6, Steps: 513 | Train Loss: 0.3967507 Vali Loss: 0.2757421 Test Loss: 0.4019733
Validation loss decreased (0.306561 --> 0.275742).  Saving model ...
Updating learning rate to 0.0015625
	iters: 100, epoch: 7 | loss: 0.4121913
	speed: 0.0074s/iter; left time: 52.7122s
	iters: 200, epoch: 7 | loss: 0.3961412
	speed: 0.0024s/iter; left time: 16.7629s
	iters: 300, epoch: 7 | loss: 0.2989164
	speed: 0.0030s/iter; left time: 20.5801s
	iters: 400, epoch: 7 | loss: 0.2617330
	speed: 0.0030s/iter; left time: 20.2252s
	iters: 500, epoch: 7 | loss: 0.2689912
	speed: 0.0029s/iter; left time: 19.4474s
Epoch: 7 cost time: 1.5014333724975586
Epoch: 7, Steps: 513 | Train Loss: 0.3783507 Vali Loss: 0.2859142 Test Loss: 0.3665434
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00078125
	iters: 100, epoch: 8 | loss: 0.4196301
	speed: 0.0067s/iter; left time: 43.8422s
	iters: 200, epoch: 8 | loss: 0.5204347
	speed: 0.0031s/iter; left time: 20.1218s
	iters: 300, epoch: 8 | loss: 0.5857986
	speed: 0.0030s/iter; left time: 19.3009s
	iters: 400, epoch: 8 | loss: 0.1925019
	speed: 0.0030s/iter; left time: 18.8729s
	iters: 500, epoch: 8 | loss: 0.8317684
	speed: 0.0031s/iter; left time: 19.0216s
Epoch: 8 cost time: 1.6145997047424316
Epoch: 8, Steps: 513 | Train Loss: 0.3673405 Vali Loss: 0.2716641 Test Loss: 0.3937178
Validation loss decreased (0.275742 --> 0.271664).  Saving model ...
Updating learning rate to 0.000390625
	iters: 100, epoch: 9 | loss: 0.2826421
	speed: 0.0063s/iter; left time: 38.2802s
	iters: 200, epoch: 9 | loss: 0.2896816
	speed: 0.0029s/iter; left time: 17.1119s
	iters: 300, epoch: 9 | loss: 0.1892578
	speed: 0.0036s/iter; left time: 21.0980s
	iters: 400, epoch: 9 | loss: 0.5948896
	speed: 0.0033s/iter; left time: 19.2285s
	iters: 500, epoch: 9 | loss: 0.4292061
	speed: 0.0034s/iter; left time: 19.5061s
Epoch: 9 cost time: 1.6502923965454102
Epoch: 9, Steps: 513 | Train Loss: 0.3607992 Vali Loss: 0.2914497 Test Loss: 0.4613234
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0001953125
	iters: 100, epoch: 10 | loss: 0.2283881
	speed: 0.0067s/iter; left time: 37.2003s
	iters: 200, epoch: 10 | loss: 0.5457864
	speed: 0.0027s/iter; left time: 14.4924s
	iters: 300, epoch: 10 | loss: 0.2054196
	speed: 0.0030s/iter; left time: 16.2457s
	iters: 400, epoch: 10 | loss: 0.3773023
	speed: 0.0032s/iter; left time: 16.6235s
	iters: 500, epoch: 10 | loss: 0.1494852
	speed: 0.0032s/iter; left time: 16.5233s
Epoch: 10 cost time: 1.5524277687072754
Epoch: 10, Steps: 513 | Train Loss: 0.3572537 Vali Loss: 0.2746133 Test Loss: 0.4249603
EarlyStopping counter: 2 out of 5
Updating learning rate to 9.765625e-05
	iters: 100, epoch: 11 | loss: 0.1560201
	speed: 0.0067s/iter; left time: 33.9132s
	iters: 200, epoch: 11 | loss: 0.3875670
	speed: 0.0033s/iter; left time: 16.3368s
	iters: 300, epoch: 11 | loss: 0.3823229
	speed: 0.0030s/iter; left time: 14.6452s
	iters: 400, epoch: 11 | loss: 0.1979939
	speed: 0.0026s/iter; left time: 12.2074s
	iters: 500, epoch: 11 | loss: 0.3110645
	speed: 0.0031s/iter; left time: 14.5413s
Epoch: 11 cost time: 1.579660177230835
Epoch: 11, Steps: 513 | Train Loss: 0.3550884 Vali Loss: 0.2856273 Test Loss: 0.4326273
EarlyStopping counter: 3 out of 5
Updating learning rate to 4.8828125e-05
	iters: 100, epoch: 12 | loss: 0.3452378
	speed: 0.0069s/iter; left time: 31.1369s
	iters: 200, epoch: 12 | loss: 0.7952352
	speed: 0.0033s/iter; left time: 14.3606s
	iters: 300, epoch: 12 | loss: 0.3010790
	speed: 0.0030s/iter; left time: 12.9652s
	iters: 400, epoch: 12 | loss: 0.2932487
	speed: 0.0026s/iter; left time: 11.0934s
	iters: 500, epoch: 12 | loss: 0.3114747
	speed: 0.0029s/iter; left time: 11.8188s
Epoch: 12 cost time: 1.5383079051971436
Epoch: 12, Steps: 513 | Train Loss: 0.3535446 Vali Loss: 0.2812548 Test Loss: 0.4177271
EarlyStopping counter: 4 out of 5
Updating learning rate to 2.44140625e-05
	iters: 100, epoch: 13 | loss: 0.2112807
	speed: 0.0056s/iter; left time: 22.3906s
	iters: 200, epoch: 13 | loss: 0.4420711
	speed: 0.0022s/iter; left time: 8.6691s
	iters: 300, epoch: 13 | loss: 0.2976421
	speed: 0.0025s/iter; left time: 9.6266s
	iters: 400, epoch: 13 | loss: 0.6164517
	speed: 0.0026s/iter; left time: 9.6022s
	iters: 500, epoch: 13 | loss: 0.4525204
	speed: 0.0030s/iter; left time: 10.8511s
Epoch: 13 cost time: 1.354168176651001
Epoch: 13, Steps: 513 | Train Loss: 0.3527769 Vali Loss: 0.2754652 Test Loss: 0.4100465
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTh2_336_96_Linear_ETTh2_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed12890<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.39510101079940796, mae:0.41354435682296753
