Args in experiment:
Namespace(activation='gelu', batch_size=8, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='exchange_rate.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=8, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='mse', lradj='type1', model='NLinear', model_id='Exchange_336_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=3144, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : Exchange_336_96_NLinear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3144>>>>>>>>>>>>>>>>>>>>>>>>>>
train 4880
val 665
test 1422
	iters: 100, epoch: 1 | loss: 0.0467736
	speed: 0.0029s/iter; left time: 34.9939s
	iters: 200, epoch: 1 | loss: 0.1570938
	speed: 0.0028s/iter; left time: 34.0830s
	iters: 300, epoch: 1 | loss: 0.1095859
	speed: 0.0033s/iter; left time: 39.7493s
	iters: 400, epoch: 1 | loss: 0.1113647
	speed: 0.0032s/iter; left time: 37.8979s
	iters: 500, epoch: 1 | loss: 0.1037660
	speed: 0.0035s/iter; left time: 40.8366s
	iters: 600, epoch: 1 | loss: 0.0655388
	speed: 0.0033s/iter; left time: 38.3993s
Epoch: 1 cost time: 1.9433255195617676
Epoch: 1, Steps: 610 | Train Loss: 0.1248094 Vali Loss: 0.1455913 Test Loss: 0.0910350
Validation loss decreased (inf --> 0.145591).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.0903538
	speed: 0.0058s/iter; left time: 67.0172s
	iters: 200, epoch: 2 | loss: 0.1171061
	speed: 0.0034s/iter; left time: 38.5017s
	iters: 300, epoch: 2 | loss: 0.0779738
	speed: 0.0033s/iter; left time: 37.6197s
	iters: 400, epoch: 2 | loss: 0.1016806
	speed: 0.0033s/iter; left time: 37.0420s
	iters: 500, epoch: 2 | loss: 0.1239422
	speed: 0.0032s/iter; left time: 34.9421s
	iters: 600, epoch: 2 | loss: 0.1253471
	speed: 0.0028s/iter; left time: 31.2147s
Epoch: 2 cost time: 1.981450080871582
Epoch: 2, Steps: 610 | Train Loss: 0.1197536 Vali Loss: 0.1408596 Test Loss: 0.0985934
Validation loss decreased (0.145591 --> 0.140860).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.0844965
	speed: 0.0054s/iter; left time: 58.8940s
	iters: 200, epoch: 3 | loss: 0.0801654
	speed: 0.0029s/iter; left time: 31.3726s
	iters: 300, epoch: 3 | loss: 0.0706751
	speed: 0.0029s/iter; left time: 30.7892s
	iters: 400, epoch: 3 | loss: 0.1198641
	speed: 0.0030s/iter; left time: 31.2140s
	iters: 500, epoch: 3 | loss: 0.1126869
	speed: 0.0035s/iter; left time: 36.9978s
	iters: 600, epoch: 3 | loss: 0.1180158
	speed: 0.0033s/iter; left time: 33.8598s
Epoch: 3 cost time: 1.9094319343566895
Epoch: 3, Steps: 610 | Train Loss: 0.1158145 Vali Loss: 0.1422462 Test Loss: 0.0952188
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.2619250
	speed: 0.0051s/iter; left time: 52.5708s
	iters: 200, epoch: 4 | loss: 0.1063882
	speed: 0.0033s/iter; left time: 33.1576s
	iters: 300, epoch: 4 | loss: 0.0697107
	speed: 0.0028s/iter; left time: 28.4172s
	iters: 400, epoch: 4 | loss: 0.2796217
	speed: 0.0028s/iter; left time: 28.1183s
	iters: 500, epoch: 4 | loss: 0.0952276
	speed: 0.0028s/iter; left time: 27.8414s
	iters: 600, epoch: 4 | loss: 0.1039947
	speed: 0.0033s/iter; left time: 32.0731s
Epoch: 4 cost time: 1.8244693279266357
Epoch: 4, Steps: 610 | Train Loss: 0.1136499 Vali Loss: 0.1456570 Test Loss: 0.0955350
EarlyStopping counter: 2 out of 5
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1318482
	speed: 0.0058s/iter; left time: 55.9372s
	iters: 200, epoch: 5 | loss: 0.1999487
	speed: 0.0033s/iter; left time: 31.6468s
	iters: 300, epoch: 5 | loss: 0.0691857
	speed: 0.0032s/iter; left time: 30.6862s
	iters: 400, epoch: 5 | loss: 0.0956332
	speed: 0.0031s/iter; left time: 28.5511s
	iters: 500, epoch: 5 | loss: 0.0758137
	speed: 0.0032s/iter; left time: 29.8205s
	iters: 600, epoch: 5 | loss: 0.2330777
	speed: 0.0031s/iter; left time: 27.9628s
Epoch: 5 cost time: 1.9525799751281738
Epoch: 5, Steps: 610 | Train Loss: 0.1128615 Vali Loss: 0.1408484 Test Loss: 0.0956613
Validation loss decreased (0.140860 --> 0.140848).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0879389
	speed: 0.0051s/iter; left time: 45.7131s
	iters: 200, epoch: 6 | loss: 0.0722181
	speed: 0.0033s/iter; left time: 29.3755s
	iters: 300, epoch: 6 | loss: 0.1302121
	speed: 0.0031s/iter; left time: 27.0723s
	iters: 400, epoch: 6 | loss: 0.1360888
	speed: 0.0031s/iter; left time: 26.6906s
	iters: 500, epoch: 6 | loss: 0.0781955
	speed: 0.0032s/iter; left time: 27.8615s
	iters: 600, epoch: 6 | loss: 0.0896065
	speed: 0.0027s/iter; left time: 22.9455s
Epoch: 6 cost time: 1.8754456043243408
Epoch: 6, Steps: 610 | Train Loss: 0.1123056 Vali Loss: 0.1425686 Test Loss: 0.0932728
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.0998771
	speed: 0.0040s/iter; left time: 33.8485s
	iters: 200, epoch: 7 | loss: 0.1749584
	speed: 0.0024s/iter; left time: 20.2687s
	iters: 300, epoch: 7 | loss: 0.1059298
	speed: 0.0029s/iter; left time: 24.0007s
	iters: 400, epoch: 7 | loss: 0.1503372
	speed: 0.0030s/iter; left time: 24.2601s
	iters: 500, epoch: 7 | loss: 0.2023459
	speed: 0.0030s/iter; left time: 23.8817s
	iters: 600, epoch: 7 | loss: 0.1223906
	speed: 0.0035s/iter; left time: 27.7290s
Epoch: 7 cost time: 1.7534210681915283
Epoch: 7, Steps: 610 | Train Loss: 0.1120114 Vali Loss: 0.1421818 Test Loss: 0.0927983
EarlyStopping counter: 2 out of 5
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.2160923
	speed: 0.0050s/iter; left time: 39.3162s
	iters: 200, epoch: 8 | loss: 0.0982293
	speed: 0.0030s/iter; left time: 23.4249s
	iters: 300, epoch: 8 | loss: 0.1395591
	speed: 0.0033s/iter; left time: 25.1179s
	iters: 400, epoch: 8 | loss: 0.1144358
	speed: 0.0027s/iter; left time: 20.4844s
	iters: 500, epoch: 8 | loss: 0.1659042
	speed: 0.0028s/iter; left time: 20.5754s
	iters: 600, epoch: 8 | loss: 0.0720222
	speed: 0.0027s/iter; left time: 19.4383s
Epoch: 8 cost time: 1.7638020515441895
Epoch: 8, Steps: 610 | Train Loss: 0.1118961 Vali Loss: 0.1413344 Test Loss: 0.0938151
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.1136719
	speed: 0.0052s/iter; left time: 37.8780s
	iters: 200, epoch: 9 | loss: 0.0724521
	speed: 0.0036s/iter; left time: 25.3508s
	iters: 300, epoch: 9 | loss: 0.1106409
	speed: 0.0032s/iter; left time: 22.1316s
	iters: 400, epoch: 9 | loss: 0.1079496
	speed: 0.0028s/iter; left time: 19.4480s
	iters: 500, epoch: 9 | loss: 0.1495421
	speed: 0.0029s/iter; left time: 19.7126s
	iters: 600, epoch: 9 | loss: 0.1702251
	speed: 0.0028s/iter; left time: 19.1001s
Epoch: 9 cost time: 1.8874025344848633
Epoch: 9, Steps: 610 | Train Loss: 0.1118001 Vali Loss: 0.1414999 Test Loss: 0.0934712
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.1357983
	speed: 0.0047s/iter; left time: 31.3394s
	iters: 200, epoch: 10 | loss: 0.0602884
	speed: 0.0028s/iter; left time: 18.2308s
	iters: 300, epoch: 10 | loss: 0.0770513
	speed: 0.0032s/iter; left time: 20.3999s
	iters: 400, epoch: 10 | loss: 0.0622813
	speed: 0.0032s/iter; left time: 19.9428s
	iters: 500, epoch: 10 | loss: 0.2925699
	speed: 0.0032s/iter; left time: 20.1236s
	iters: 600, epoch: 10 | loss: 0.0660264
	speed: 0.0032s/iter; left time: 19.6962s
Epoch: 10 cost time: 1.8785595893859863
Epoch: 10, Steps: 610 | Train Loss: 0.1117658 Vali Loss: 0.1414821 Test Loss: 0.0935239
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : Exchange_336_96_NLinear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3144<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 1422
mse:0.09552820026874542, mae:0.2144639939069748
