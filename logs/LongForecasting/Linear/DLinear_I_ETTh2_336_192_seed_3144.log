Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTh2', data_path='ETTh2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.05, loss='mse', lradj='type1', model='DLinear', model_id='ETTh2_336_192', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=192, root_path='./dataset/', save_pred_values=False, seed=3144, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTh2_336_192_DLinear_ETTh2_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3144>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8113
val 2689
test 2689
Total number of trainable parameters: 905856
Total number of parameters: 905856
	iters: 100, epoch: 1 | loss: 2.3145151
	speed: 0.0183s/iter; left time: 90.5902s
	iters: 200, epoch: 1 | loss: 2.6441212
	speed: 0.0178s/iter; left time: 86.6714s
Epoch: 1 cost time: 4.50110650062561
Epoch: 1, Steps: 253 | Train Loss: 4.4988515 Vali Loss: 2.0594747 Test Loss: 5.2259912
Validation loss decreased (inf --> 2.059475).  Saving model ...
Updating learning rate to 0.05
	iters: 100, epoch: 2 | loss: 5.5257139
	speed: 0.0361s/iter; left time: 169.9084s
	iters: 200, epoch: 2 | loss: 10.0430984
	speed: 0.0182s/iter; left time: 83.6385s
Epoch: 2 cost time: 4.689189910888672
Epoch: 2, Steps: 253 | Train Loss: 4.7574827 Vali Loss: 4.5372534 Test Loss: 14.2576170
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.025
	iters: 100, epoch: 3 | loss: 1.5291620
	speed: 0.0371s/iter; left time: 165.2749s
	iters: 200, epoch: 3 | loss: 0.7303609
	speed: 0.0187s/iter; left time: 81.2861s
Epoch: 3 cost time: 4.535788059234619
Epoch: 3, Steps: 253 | Train Loss: 1.1763040 Vali Loss: 0.6636739 Test Loss: 1.2569972
Validation loss decreased (2.059475 --> 0.663674).  Saving model ...
Updating learning rate to 0.0125
	iters: 100, epoch: 4 | loss: 0.5450842
	speed: 0.0346s/iter; left time: 145.2398s
	iters: 200, epoch: 4 | loss: 0.5540503
	speed: 0.0169s/iter; left time: 69.2196s
Epoch: 4 cost time: 4.317697048187256
Epoch: 4, Steps: 253 | Train Loss: 0.5991254 Vali Loss: 0.4714039 Test Loss: 0.6382881
Validation loss decreased (0.663674 --> 0.471404).  Saving model ...
Updating learning rate to 0.00625
	iters: 100, epoch: 5 | loss: 0.2255521
	speed: 0.0392s/iter; left time: 154.7370s
	iters: 200, epoch: 5 | loss: 0.6500144
	speed: 0.0211s/iter; left time: 81.2861s
Epoch: 5 cost time: 4.986733436584473
Epoch: 5, Steps: 253 | Train Loss: 0.5124931 Vali Loss: 0.4969471 Test Loss: 0.8050333
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.003125
	iters: 100, epoch: 6 | loss: 0.8388701
	speed: 0.0356s/iter; left time: 131.4248s
	iters: 200, epoch: 6 | loss: 0.3804294
	speed: 0.0171s/iter; left time: 61.5803s
Epoch: 6 cost time: 4.306559324264526
Epoch: 6, Steps: 253 | Train Loss: 0.4781648 Vali Loss: 0.4150625 Test Loss: 0.7046303
Validation loss decreased (0.471404 --> 0.415063).  Saving model ...
Updating learning rate to 0.0015625
	iters: 100, epoch: 7 | loss: 0.3660837
	speed: 0.0365s/iter; left time: 125.7603s
	iters: 200, epoch: 7 | loss: 0.3488568
	speed: 0.0177s/iter; left time: 59.1454s
Epoch: 7 cost time: 4.318814992904663
Epoch: 7, Steps: 253 | Train Loss: 0.4592260 Vali Loss: 0.4101418 Test Loss: 0.6333414
Validation loss decreased (0.415063 --> 0.410142).  Saving model ...
Updating learning rate to 0.00078125
	iters: 100, epoch: 8 | loss: 0.5501320
	speed: 0.0342s/iter; left time: 109.0766s
	iters: 200, epoch: 8 | loss: 0.6806239
	speed: 0.0176s/iter; left time: 54.4368s
Epoch: 8 cost time: 4.316034555435181
Epoch: 8, Steps: 253 | Train Loss: 0.4487215 Vali Loss: 0.3792848 Test Loss: 0.5231672
Validation loss decreased (0.410142 --> 0.379285).  Saving model ...
Updating learning rate to 0.000390625
	iters: 100, epoch: 9 | loss: 0.4221984
	speed: 0.0349s/iter; left time: 102.3718s
	iters: 200, epoch: 9 | loss: 0.2699236
	speed: 0.0176s/iter; left time: 49.8566s
Epoch: 9 cost time: 4.328293085098267
Epoch: 9, Steps: 253 | Train Loss: 0.4442949 Vali Loss: 0.3690328 Test Loss: 0.5607710
Validation loss decreased (0.379285 --> 0.369033).  Saving model ...
Updating learning rate to 0.0001953125
	iters: 100, epoch: 10 | loss: 0.5531037
	speed: 0.0363s/iter; left time: 97.5380s
	iters: 200, epoch: 10 | loss: 0.3927005
	speed: 0.0176s/iter; left time: 45.5443s
Epoch: 10 cost time: 4.299510717391968
Epoch: 10, Steps: 253 | Train Loss: 0.4413292 Vali Loss: 0.3786844 Test Loss: 0.5618399
EarlyStopping counter: 1 out of 5
Updating learning rate to 9.765625e-05
	iters: 100, epoch: 11 | loss: 0.4309441
	speed: 0.0333s/iter; left time: 80.9886s
	iters: 200, epoch: 11 | loss: 0.3662947
	speed: 0.0177s/iter; left time: 41.3537s
Epoch: 11 cost time: 4.387633323669434
Epoch: 11, Steps: 253 | Train Loss: 0.4391491 Vali Loss: 0.3823982 Test Loss: 0.5765073
EarlyStopping counter: 2 out of 5
Updating learning rate to 4.8828125e-05
	iters: 100, epoch: 12 | loss: 0.3688415
	speed: 0.0321s/iter; left time: 69.9916s
	iters: 200, epoch: 12 | loss: 0.4705400
	speed: 0.0150s/iter; left time: 31.2093s
Epoch: 12 cost time: 3.6950032711029053
Epoch: 12, Steps: 253 | Train Loss: 0.4385866 Vali Loss: 0.3820612 Test Loss: 0.5819364
EarlyStopping counter: 3 out of 5
Updating learning rate to 2.44140625e-05
	iters: 100, epoch: 13 | loss: 0.4960175
	speed: 0.0262s/iter; left time: 50.5099s
	iters: 200, epoch: 13 | loss: 0.4714476
	speed: 0.0111s/iter; left time: 20.3343s
Epoch: 13 cost time: 2.981430768966675
Epoch: 13, Steps: 253 | Train Loss: 0.4379693 Vali Loss: 0.3822825 Test Loss: 0.5820042
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.220703125e-05
	iters: 100, epoch: 14 | loss: 0.3923967
	speed: 0.0210s/iter; left time: 35.1632s
	iters: 200, epoch: 14 | loss: 0.3534687
	speed: 0.0105s/iter; left time: 16.4918s
Epoch: 14 cost time: 2.5605549812316895
Epoch: 14, Steps: 253 | Train Loss: 0.4377510 Vali Loss: 0.3830869 Test Loss: 0.5853870
EarlyStopping counter: 5 out of 5
Early stopping
Total training time: 69.9947 seconds
>>>>>>>testing : ETTh2_336_192_DLinear_ETTh2_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3144<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2689
mse:0.5637852549552917, mae:0.4950270652770996
