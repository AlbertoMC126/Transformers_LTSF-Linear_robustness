Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='Linear', model_id='ETTm2_336_192', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=192, root_path='./dataset/', save_pred_values=False, seed=28649, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTm2_336_192_Linear_ETTm2_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed28649>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34033
val 11329
test 11329
	iters: 100, epoch: 1 | loss: 0.2926795
	speed: 0.0063s/iter; left time: 133.3618s
	iters: 200, epoch: 1 | loss: 0.9642934
	speed: 0.0061s/iter; left time: 128.6889s
	iters: 300, epoch: 1 | loss: 0.1943732
	speed: 0.0057s/iter; left time: 119.7294s
	iters: 400, epoch: 1 | loss: 0.3554798
	speed: 0.0068s/iter; left time: 141.4921s
	iters: 500, epoch: 1 | loss: 0.4542812
	speed: 0.0057s/iter; left time: 117.7150s
	iters: 600, epoch: 1 | loss: 0.4227095
	speed: 0.0053s/iter; left time: 108.5524s
	iters: 700, epoch: 1 | loss: 0.4775747
	speed: 0.0065s/iter; left time: 133.2353s
	iters: 800, epoch: 1 | loss: 0.3533069
	speed: 0.0062s/iter; left time: 126.9196s
	iters: 900, epoch: 1 | loss: 0.5401371
	speed: 0.0055s/iter; left time: 112.9163s
	iters: 1000, epoch: 1 | loss: 0.4565036
	speed: 0.0054s/iter; left time: 108.4455s
Epoch: 1 cost time: 6.279287815093994
Epoch: 1, Steps: 1063 | Train Loss: 0.5081195 Vali Loss: 0.4124070 Test Loss: 0.8359805
Validation loss decreased (inf --> 0.412407).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.2187732
	speed: 0.0203s/iter; left time: 407.7089s
	iters: 200, epoch: 2 | loss: 0.3659474
	speed: 0.0058s/iter; left time: 115.0552s
	iters: 300, epoch: 2 | loss: 0.4168921
	speed: 0.0060s/iter; left time: 119.1999s
	iters: 400, epoch: 2 | loss: 1.1551325
	speed: 0.0061s/iter; left time: 120.2248s
	iters: 500, epoch: 2 | loss: 0.4138783
	speed: 0.0047s/iter; left time: 91.8923s
	iters: 600, epoch: 2 | loss: 0.2731735
	speed: 0.0053s/iter; left time: 104.0373s
	iters: 700, epoch: 2 | loss: 0.5886635
	speed: 0.0051s/iter; left time: 99.0501s
	iters: 800, epoch: 2 | loss: 0.3901666
	speed: 0.0054s/iter; left time: 103.9940s
	iters: 900, epoch: 2 | loss: 1.0247301
	speed: 0.0041s/iter; left time: 78.7348s
	iters: 1000, epoch: 2 | loss: 0.6035603
	speed: 0.0043s/iter; left time: 82.6297s
Epoch: 2 cost time: 5.5579094886779785
Epoch: 2, Steps: 1063 | Train Loss: 0.4973307 Vali Loss: 0.4513612 Test Loss: 0.8577976
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.3737677
	speed: 0.0207s/iter; left time: 393.3805s
	iters: 200, epoch: 3 | loss: 0.2843993
	speed: 0.0051s/iter; left time: 96.9513s
	iters: 300, epoch: 3 | loss: 0.2052417
	speed: 0.0054s/iter; left time: 101.5523s
	iters: 400, epoch: 3 | loss: 0.1973883
	speed: 0.0051s/iter; left time: 95.9229s
	iters: 500, epoch: 3 | loss: 0.2385129
	speed: 0.0062s/iter; left time: 114.8497s
	iters: 600, epoch: 3 | loss: 0.3480019
	speed: 0.0049s/iter; left time: 90.6038s
	iters: 700, epoch: 3 | loss: 0.3957826
	speed: 0.0049s/iter; left time: 90.5582s
	iters: 800, epoch: 3 | loss: 0.3871636
	speed: 0.0050s/iter; left time: 91.6751s
	iters: 900, epoch: 3 | loss: 0.2331311
	speed: 0.0062s/iter; left time: 112.3375s
	iters: 1000, epoch: 3 | loss: 0.3475086
	speed: 0.0066s/iter; left time: 119.0310s
Epoch: 3 cost time: 5.8103861808776855
Epoch: 3, Steps: 1063 | Train Loss: 0.3533023 Vali Loss: 0.3078647 Test Loss: 0.6312038
Validation loss decreased (0.412407 --> 0.307865).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.2905340
	speed: 0.0268s/iter; left time: 481.7569s
	iters: 200, epoch: 4 | loss: 0.6112382
	speed: 0.0060s/iter; left time: 106.3862s
	iters: 300, epoch: 4 | loss: 0.3147049
	speed: 0.0056s/iter; left time: 98.6858s
	iters: 400, epoch: 4 | loss: 0.2349910
	speed: 0.0059s/iter; left time: 104.9441s
	iters: 500, epoch: 4 | loss: 0.5321337
	speed: 0.0067s/iter; left time: 117.2492s
	iters: 600, epoch: 4 | loss: 0.3290589
	speed: 0.0055s/iter; left time: 95.7470s
	iters: 700, epoch: 4 | loss: 0.2301681
	speed: 0.0052s/iter; left time: 90.0233s
	iters: 800, epoch: 4 | loss: 0.3308342
	speed: 0.0062s/iter; left time: 106.7406s
	iters: 900, epoch: 4 | loss: 0.2132704
	speed: 0.0065s/iter; left time: 111.8395s
	iters: 1000, epoch: 4 | loss: 0.3555994
	speed: 0.0061s/iter; left time: 103.8474s
Epoch: 4 cost time: 6.223268985748291
Epoch: 4, Steps: 1063 | Train Loss: 0.3136515 Vali Loss: 0.2913429 Test Loss: 0.5834923
Validation loss decreased (0.307865 --> 0.291343).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.4374191
	speed: 0.0221s/iter; left time: 374.0787s
	iters: 200, epoch: 5 | loss: 0.1872758
	speed: 0.0049s/iter; left time: 81.8696s
	iters: 300, epoch: 5 | loss: 0.1881559
	speed: 0.0055s/iter; left time: 92.4444s
	iters: 400, epoch: 5 | loss: 0.2911918
	speed: 0.0059s/iter; left time: 98.5520s
	iters: 500, epoch: 5 | loss: 0.1901953
	speed: 0.0057s/iter; left time: 94.7720s
	iters: 600, epoch: 5 | loss: 0.2243531
	speed: 0.0051s/iter; left time: 84.0636s
	iters: 700, epoch: 5 | loss: 0.2255946
	speed: 0.0047s/iter; left time: 75.9998s
	iters: 800, epoch: 5 | loss: 0.3082484
	speed: 0.0051s/iter; left time: 82.3926s
	iters: 900, epoch: 5 | loss: 0.3123544
	speed: 0.0047s/iter; left time: 75.8738s
	iters: 1000, epoch: 5 | loss: 0.5334871
	speed: 0.0041s/iter; left time: 66.0107s
Epoch: 5 cost time: 5.576984405517578
Epoch: 5, Steps: 1063 | Train Loss: 0.2943787 Vali Loss: 0.2496231 Test Loss: 0.4913259
Validation loss decreased (0.291343 --> 0.249623).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.3535914
	speed: 0.0260s/iter; left time: 411.8101s
	iters: 200, epoch: 6 | loss: 0.3331039
	speed: 0.0052s/iter; left time: 81.4718s
	iters: 300, epoch: 6 | loss: 0.3241453
	speed: 0.0059s/iter; left time: 92.4679s
	iters: 400, epoch: 6 | loss: 0.1923458
	speed: 0.0067s/iter; left time: 103.7240s
	iters: 500, epoch: 6 | loss: 0.2362680
	speed: 0.0056s/iter; left time: 86.3208s
	iters: 600, epoch: 6 | loss: 0.1939309
	speed: 0.0056s/iter; left time: 86.4331s
	iters: 700, epoch: 6 | loss: 0.4030479
	speed: 0.0052s/iter; left time: 79.3017s
	iters: 800, epoch: 6 | loss: 0.3112411
	speed: 0.0049s/iter; left time: 74.5184s
	iters: 900, epoch: 6 | loss: 0.2777283
	speed: 0.0052s/iter; left time: 77.9707s
	iters: 1000, epoch: 6 | loss: 0.3011627
	speed: 0.0056s/iter; left time: 84.3049s
Epoch: 6 cost time: 5.818499326705933
Epoch: 6, Steps: 1063 | Train Loss: 0.2862946 Vali Loss: 0.1789257 Test Loss: 0.2837257
Validation loss decreased (0.249623 --> 0.178926).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.2456206
	speed: 0.0244s/iter; left time: 361.1486s
	iters: 200, epoch: 7 | loss: 0.4076744
	speed: 0.0055s/iter; left time: 80.4628s
	iters: 300, epoch: 7 | loss: 0.3857844
	speed: 0.0062s/iter; left time: 90.6137s
	iters: 400, epoch: 7 | loss: 0.2642676
	speed: 0.0058s/iter; left time: 83.8567s
	iters: 500, epoch: 7 | loss: 0.4231867
	speed: 0.0056s/iter; left time: 79.8646s
	iters: 600, epoch: 7 | loss: 0.4095778
	speed: 0.0063s/iter; left time: 89.4208s
	iters: 700, epoch: 7 | loss: 0.2665517
	speed: 0.0059s/iter; left time: 83.0178s
	iters: 800, epoch: 7 | loss: 0.2560326
	speed: 0.0057s/iter; left time: 80.4258s
	iters: 900, epoch: 7 | loss: 0.1798577
	speed: 0.0059s/iter; left time: 82.4060s
	iters: 1000, epoch: 7 | loss: 0.1693309
	speed: 0.0053s/iter; left time: 73.0648s
Epoch: 7 cost time: 6.070658922195435
Epoch: 7, Steps: 1063 | Train Loss: 0.2803439 Vali Loss: 0.1955101 Test Loss: 0.3318824
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.1436483
	speed: 0.0227s/iter; left time: 310.9005s
	iters: 200, epoch: 8 | loss: 0.1884258
	speed: 0.0058s/iter; left time: 78.7704s
	iters: 300, epoch: 8 | loss: 0.6376016
	speed: 0.0055s/iter; left time: 73.9544s
	iters: 400, epoch: 8 | loss: 0.2045347
	speed: 0.0065s/iter; left time: 86.5873s
	iters: 500, epoch: 8 | loss: 0.2324473
	speed: 0.0054s/iter; left time: 71.5352s
	iters: 600, epoch: 8 | loss: 0.4705618
	speed: 0.0055s/iter; left time: 72.2091s
	iters: 700, epoch: 8 | loss: 0.2304566
	speed: 0.0063s/iter; left time: 82.6616s
	iters: 800, epoch: 8 | loss: 0.2672143
	speed: 0.0058s/iter; left time: 75.6461s
	iters: 900, epoch: 8 | loss: 0.4015404
	speed: 0.0061s/iter; left time: 78.3387s
	iters: 1000, epoch: 8 | loss: 0.2142358
	speed: 0.0058s/iter; left time: 74.2277s
Epoch: 8 cost time: 6.13064432144165
Epoch: 8, Steps: 1063 | Train Loss: 0.2775900 Vali Loss: 0.2062439 Test Loss: 0.3623231
EarlyStopping counter: 2 out of 5
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.5500476
	speed: 0.0226s/iter; left time: 285.7463s
	iters: 200, epoch: 9 | loss: 0.3022236
	speed: 0.0056s/iter; left time: 69.8251s
	iters: 300, epoch: 9 | loss: 0.4559279
	speed: 0.0053s/iter; left time: 65.6675s
	iters: 400, epoch: 9 | loss: 0.4635212
	speed: 0.0050s/iter; left time: 62.0324s
	iters: 500, epoch: 9 | loss: 0.3041612
	speed: 0.0060s/iter; left time: 73.9275s
	iters: 600, epoch: 9 | loss: 0.4540069
	speed: 0.0054s/iter; left time: 65.4106s
	iters: 700, epoch: 9 | loss: 0.2882496
	speed: 0.0060s/iter; left time: 71.7789s
	iters: 800, epoch: 9 | loss: 0.2847038
	speed: 0.0063s/iter; left time: 75.8141s
	iters: 900, epoch: 9 | loss: 0.3537251
	speed: 0.0059s/iter; left time: 70.3379s
	iters: 1000, epoch: 9 | loss: 0.3927830
	speed: 0.0054s/iter; left time: 63.5120s
Epoch: 9 cost time: 5.915531873703003
Epoch: 9, Steps: 1063 | Train Loss: 0.2759014 Vali Loss: 0.1953369 Test Loss: 0.3370501
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.2272381
	speed: 0.0249s/iter; left time: 288.6433s
	iters: 200, epoch: 10 | loss: 0.2255107
	speed: 0.0054s/iter; left time: 62.2155s
	iters: 300, epoch: 10 | loss: 0.2318091
	speed: 0.0045s/iter; left time: 50.8171s
	iters: 400, epoch: 10 | loss: 0.2234055
	speed: 0.0044s/iter; left time: 49.1518s
	iters: 500, epoch: 10 | loss: 0.1704032
	speed: 0.0061s/iter; left time: 68.0407s
	iters: 600, epoch: 10 | loss: 0.2334719
	speed: 0.0059s/iter; left time: 65.4755s
	iters: 700, epoch: 10 | loss: 0.4044212
	speed: 0.0058s/iter; left time: 63.9250s
	iters: 800, epoch: 10 | loss: 0.2294806
	speed: 0.0054s/iter; left time: 58.7430s
	iters: 900, epoch: 10 | loss: 0.2084098
	speed: 0.0050s/iter; left time: 53.9700s
	iters: 1000, epoch: 10 | loss: 0.1780870
	speed: 0.0051s/iter; left time: 54.0314s
Epoch: 10 cost time: 5.671434164047241
Epoch: 10, Steps: 1063 | Train Loss: 0.2750143 Vali Loss: 0.1871461 Test Loss: 0.3145536
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.1956216
	speed: 0.0220s/iter; left time: 231.9518s
	iters: 200, epoch: 11 | loss: 0.1635831
	speed: 0.0062s/iter; left time: 64.7772s
	iters: 300, epoch: 11 | loss: 0.6265160
	speed: 0.0060s/iter; left time: 62.3297s
	iters: 400, epoch: 11 | loss: 0.5353421
	speed: 0.0054s/iter; left time: 55.2743s
	iters: 500, epoch: 11 | loss: 0.1538314
	speed: 0.0050s/iter; left time: 50.4522s
	iters: 600, epoch: 11 | loss: 0.4229992
	speed: 0.0050s/iter; left time: 50.0848s
	iters: 700, epoch: 11 | loss: 0.1682626
	speed: 0.0052s/iter; left time: 51.4492s
	iters: 800, epoch: 11 | loss: 0.2408653
	speed: 0.0053s/iter; left time: 51.6299s
	iters: 900, epoch: 11 | loss: 0.5074888
	speed: 0.0055s/iter; left time: 53.0340s
	iters: 1000, epoch: 11 | loss: 0.2082969
	speed: 0.0064s/iter; left time: 61.4513s
Epoch: 11 cost time: 5.8451924324035645
Epoch: 11, Steps: 1063 | Train Loss: 0.2746098 Vali Loss: 0.1918772 Test Loss: 0.3276757
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTm2_336_192_Linear_ETTm2_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed28649<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
mse:0.2842967212200165, mae:0.3437538146972656
