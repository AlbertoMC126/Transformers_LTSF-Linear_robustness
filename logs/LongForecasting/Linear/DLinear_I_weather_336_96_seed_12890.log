Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='DLinear', model_id='weather_336_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=12890, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : weather_336_96_DLinear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed12890>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36456
val 5175
test 10444
	iters: 100, epoch: 1 | loss: 0.4251351
	speed: 0.0174s/iter; left time: 791.6571s
	iters: 200, epoch: 1 | loss: 0.5615352
	speed: 0.0188s/iter; left time: 850.5575s
	iters: 300, epoch: 1 | loss: 2.0333040
	speed: 0.0183s/iter; left time: 828.8878s
	iters: 400, epoch: 1 | loss: 1.2515343
	speed: 0.0214s/iter; left time: 965.1500s
	iters: 500, epoch: 1 | loss: 1.7410285
	speed: 0.0195s/iter; left time: 880.6239s
	iters: 600, epoch: 1 | loss: 0.3134612
	speed: 0.0201s/iter; left time: 902.9641s
	iters: 700, epoch: 1 | loss: 0.4623561
	speed: 0.0189s/iter; left time: 850.0948s
	iters: 800, epoch: 1 | loss: 2.3569400
	speed: 0.0197s/iter; left time: 883.3675s
	iters: 900, epoch: 1 | loss: 0.4537641
	speed: 0.0159s/iter; left time: 709.3755s
	iters: 1000, epoch: 1 | loss: 0.4566477
	speed: 0.0169s/iter; left time: 753.6884s
	iters: 1100, epoch: 1 | loss: 0.3689454
	speed: 0.0194s/iter; left time: 860.8773s
	iters: 1200, epoch: 1 | loss: 0.3926292
	speed: 0.0196s/iter; left time: 868.9896s
	iters: 1300, epoch: 1 | loss: 0.4366017
	speed: 0.0176s/iter; left time: 777.2701s
	iters: 1400, epoch: 1 | loss: 0.4261067
	speed: 0.0187s/iter; left time: 826.5024s
	iters: 1500, epoch: 1 | loss: 0.6606483
	speed: 0.0172s/iter; left time: 756.8101s
	iters: 1600, epoch: 1 | loss: 0.3540012
	speed: 0.0201s/iter; left time: 881.5033s
	iters: 1700, epoch: 1 | loss: 1.8092700
	speed: 0.0194s/iter; left time: 848.9624s
	iters: 1800, epoch: 1 | loss: 0.5131732
	speed: 0.0188s/iter; left time: 821.4078s
	iters: 1900, epoch: 1 | loss: 0.3215172
	speed: 0.0207s/iter; left time: 902.6352s
	iters: 2000, epoch: 1 | loss: 1.8647689
	speed: 0.0180s/iter; left time: 783.4319s
	iters: 2100, epoch: 1 | loss: 0.4969822
	speed: 0.0187s/iter; left time: 814.6569s
	iters: 2200, epoch: 1 | loss: 0.4592512
	speed: 0.0199s/iter; left time: 863.3698s
Epoch: 1 cost time: 43.02240967750549
Epoch: 1, Steps: 2278 | Train Loss: 0.9717845 Vali Loss: 0.6451020 Test Loss: 0.2138664
Validation loss decreased (inf --> 0.645102).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.3974901
	speed: 0.0743s/iter; left time: 3209.2827s
	iters: 200, epoch: 2 | loss: 0.7651618
	speed: 0.0195s/iter; left time: 840.4269s
	iters: 300, epoch: 2 | loss: 0.7800475
	speed: 0.0175s/iter; left time: 753.5459s
	iters: 400, epoch: 2 | loss: 0.2822003
	speed: 0.0180s/iter; left time: 773.6972s
	iters: 500, epoch: 2 | loss: 0.3814013
	speed: 0.0194s/iter; left time: 828.9335s
	iters: 600, epoch: 2 | loss: 0.7600204
	speed: 0.0197s/iter; left time: 841.5337s
	iters: 700, epoch: 2 | loss: 0.5109636
	speed: 0.0189s/iter; left time: 804.4549s
	iters: 800, epoch: 2 | loss: 0.5437406
	speed: 0.0166s/iter; left time: 706.1873s
	iters: 900, epoch: 2 | loss: 0.4980792
	speed: 0.0204s/iter; left time: 863.7265s
	iters: 1000, epoch: 2 | loss: 0.4757656
	speed: 0.0204s/iter; left time: 862.9003s
	iters: 1100, epoch: 2 | loss: 0.5151370
	speed: 0.0214s/iter; left time: 902.0705s
	iters: 1200, epoch: 2 | loss: 0.3429525
	speed: 0.0198s/iter; left time: 834.5564s
	iters: 1300, epoch: 2 | loss: 0.4699652
	speed: 0.0203s/iter; left time: 851.9166s
	iters: 1400, epoch: 2 | loss: 2.8916903
	speed: 0.0201s/iter; left time: 843.1212s
	iters: 1500, epoch: 2 | loss: 0.8606889
	speed: 0.0199s/iter; left time: 833.2903s
	iters: 1600, epoch: 2 | loss: 0.4353055
	speed: 0.0182s/iter; left time: 758.7679s
	iters: 1700, epoch: 2 | loss: 0.3240266
	speed: 0.0168s/iter; left time: 700.5028s
	iters: 1800, epoch: 2 | loss: 1.1413035
	speed: 0.0206s/iter; left time: 852.5620s
	iters: 1900, epoch: 2 | loss: 0.4005125
	speed: 0.0183s/iter; left time: 759.2246s
	iters: 2000, epoch: 2 | loss: 1.1253760
	speed: 0.0178s/iter; left time: 734.8195s
	iters: 2100, epoch: 2 | loss: 3.8513997
	speed: 0.0171s/iter; left time: 706.0702s
	iters: 2200, epoch: 2 | loss: 0.9164870
	speed: 0.0187s/iter; left time: 767.9508s
Epoch: 2 cost time: 43.14967203140259
Epoch: 2, Steps: 2278 | Train Loss: 1.0342217 Vali Loss: 0.6325655 Test Loss: 0.2273936
Validation loss decreased (0.645102 --> 0.632565).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.3138117
	speed: 0.0742s/iter; left time: 3036.5090s
	iters: 200, epoch: 3 | loss: 0.2494333
	speed: 0.0170s/iter; left time: 693.3594s
	iters: 300, epoch: 3 | loss: 0.3433855
	speed: 0.0193s/iter; left time: 784.9600s
	iters: 400, epoch: 3 | loss: 0.4084304
	speed: 0.0192s/iter; left time: 778.4850s
	iters: 500, epoch: 3 | loss: 0.3175009
	speed: 0.0193s/iter; left time: 781.8606s
	iters: 600, epoch: 3 | loss: 0.5898919
	speed: 0.0192s/iter; left time: 777.5844s
	iters: 700, epoch: 3 | loss: 0.3195820
	speed: 0.0202s/iter; left time: 813.8175s
	iters: 800, epoch: 3 | loss: 0.4100209
	speed: 0.0188s/iter; left time: 754.9615s
	iters: 900, epoch: 3 | loss: 0.4462346
	speed: 0.0181s/iter; left time: 725.8881s
	iters: 1000, epoch: 3 | loss: 2.2233164
	speed: 0.0182s/iter; left time: 727.1357s
	iters: 1100, epoch: 3 | loss: 1.9188770
	speed: 0.0211s/iter; left time: 841.2801s
	iters: 1200, epoch: 3 | loss: 1.2116416
	speed: 0.0205s/iter; left time: 815.3482s
	iters: 1300, epoch: 3 | loss: 0.4643935
	speed: 0.0207s/iter; left time: 823.3841s
	iters: 1400, epoch: 3 | loss: 0.4598029
	speed: 0.0208s/iter; left time: 824.4647s
	iters: 1500, epoch: 3 | loss: 0.3042922
	speed: 0.0197s/iter; left time: 779.2212s
	iters: 1600, epoch: 3 | loss: 0.3232374
	speed: 0.0206s/iter; left time: 811.0787s
	iters: 1700, epoch: 3 | loss: 0.2616952
	speed: 0.0192s/iter; left time: 753.2793s
	iters: 1800, epoch: 3 | loss: 0.2928832
	speed: 0.0203s/iter; left time: 794.1290s
	iters: 1900, epoch: 3 | loss: 0.5466385
	speed: 0.0197s/iter; left time: 770.0405s
	iters: 2000, epoch: 3 | loss: 0.3261215
	speed: 0.0176s/iter; left time: 687.2426s
	iters: 2100, epoch: 3 | loss: 0.3545491
	speed: 0.0187s/iter; left time: 726.4160s
	iters: 2200, epoch: 3 | loss: 0.3665422
	speed: 0.0199s/iter; left time: 771.3333s
Epoch: 3 cost time: 44.1923394203186
Epoch: 3, Steps: 2278 | Train Loss: 0.6731867 Vali Loss: 0.4573352 Test Loss: 0.1837835
Validation loss decreased (0.632565 --> 0.457335).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.9555562
	speed: 0.0839s/iter; left time: 3240.5432s
	iters: 200, epoch: 4 | loss: 0.3654533
	speed: 0.0212s/iter; left time: 815.4430s
	iters: 300, epoch: 4 | loss: 0.6422637
	speed: 0.0199s/iter; left time: 763.3055s
	iters: 400, epoch: 4 | loss: 0.4594897
	speed: 0.0181s/iter; left time: 694.1120s
	iters: 500, epoch: 4 | loss: 0.2355769
	speed: 0.0197s/iter; left time: 753.5592s
	iters: 600, epoch: 4 | loss: 0.3449120
	speed: 0.0190s/iter; left time: 725.6113s
	iters: 700, epoch: 4 | loss: 0.2895679
	speed: 0.0203s/iter; left time: 772.0582s
	iters: 800, epoch: 4 | loss: 0.2769932
	speed: 0.0196s/iter; left time: 743.1288s
	iters: 900, epoch: 4 | loss: 0.2426368
	speed: 0.0188s/iter; left time: 711.2421s
	iters: 1000, epoch: 4 | loss: 0.2890018
	speed: 0.0202s/iter; left time: 761.4612s
	iters: 1100, epoch: 4 | loss: 0.2894095
	speed: 0.0203s/iter; left time: 762.7499s
	iters: 1200, epoch: 4 | loss: 0.5815859
	speed: 0.0207s/iter; left time: 775.4727s
	iters: 1300, epoch: 4 | loss: 0.2269256
	speed: 0.0189s/iter; left time: 707.6586s
	iters: 1400, epoch: 4 | loss: 0.6857799
	speed: 0.0209s/iter; left time: 781.3130s
	iters: 1500, epoch: 4 | loss: 0.7576822
	speed: 0.0213s/iter; left time: 793.8784s
	iters: 1600, epoch: 4 | loss: 0.2318985
	speed: 0.0193s/iter; left time: 716.7306s
	iters: 1700, epoch: 4 | loss: 0.5078353
	speed: 0.0204s/iter; left time: 754.4426s
	iters: 1800, epoch: 4 | loss: 0.8374025
	speed: 0.0187s/iter; left time: 688.8205s
	iters: 1900, epoch: 4 | loss: 1.5105838
	speed: 0.0197s/iter; left time: 727.0305s
	iters: 2000, epoch: 4 | loss: 0.3882900
	speed: 0.0198s/iter; left time: 725.4495s
	iters: 2100, epoch: 4 | loss: 0.5893250
	speed: 0.0176s/iter; left time: 646.1236s
	iters: 2200, epoch: 4 | loss: 0.3353587
	speed: 0.0195s/iter; left time: 713.1855s
Epoch: 4 cost time: 44.85779857635498
Epoch: 4, Steps: 2278 | Train Loss: 0.4763642 Vali Loss: 0.4165980 Test Loss: 0.1787966
Validation loss decreased (0.457335 --> 0.416598).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.4722826
	speed: 0.0759s/iter; left time: 2758.2337s
	iters: 200, epoch: 5 | loss: 0.2042017
	speed: 0.0174s/iter; left time: 629.8311s
	iters: 300, epoch: 5 | loss: 0.4386161
	speed: 0.0178s/iter; left time: 642.5516s
	iters: 400, epoch: 5 | loss: 0.3311453
	speed: 0.0196s/iter; left time: 707.0876s
	iters: 500, epoch: 5 | loss: 0.2823351
	speed: 0.0207s/iter; left time: 743.5029s
	iters: 600, epoch: 5 | loss: 0.2393307
	speed: 0.0180s/iter; left time: 646.5241s
	iters: 700, epoch: 5 | loss: 0.3179793
	speed: 0.0191s/iter; left time: 681.8914s
	iters: 800, epoch: 5 | loss: 0.1992854
	speed: 0.0207s/iter; left time: 737.6911s
	iters: 900, epoch: 5 | loss: 0.3506916
	speed: 0.0192s/iter; left time: 681.1482s
	iters: 1000, epoch: 5 | loss: 0.3112694
	speed: 0.0176s/iter; left time: 622.5152s
	iters: 1100, epoch: 5 | loss: 2.2751186
	speed: 0.0185s/iter; left time: 654.4429s
	iters: 1200, epoch: 5 | loss: 0.2509119
	speed: 0.0196s/iter; left time: 690.9767s
	iters: 1300, epoch: 5 | loss: 0.2025129
	speed: 0.0188s/iter; left time: 659.5257s
	iters: 1400, epoch: 5 | loss: 0.2823398
	speed: 0.0183s/iter; left time: 640.1142s
	iters: 1500, epoch: 5 | loss: 0.1272145
	speed: 0.0174s/iter; left time: 608.5875s
	iters: 1600, epoch: 5 | loss: 0.2524411
	speed: 0.0179s/iter; left time: 623.0167s
	iters: 1700, epoch: 5 | loss: 0.2159063
	speed: 0.0185s/iter; left time: 643.1639s
	iters: 1800, epoch: 5 | loss: 0.2809009
	speed: 0.0166s/iter; left time: 573.5263s
	iters: 1900, epoch: 5 | loss: 0.2081563
	speed: 0.0162s/iter; left time: 560.1302s
	iters: 2000, epoch: 5 | loss: 0.2341679
	speed: 0.0194s/iter; left time: 668.9304s
	iters: 2100, epoch: 5 | loss: 0.6855930
	speed: 0.0203s/iter; left time: 697.7838s
	iters: 2200, epoch: 5 | loss: 0.2604853
	speed: 0.0194s/iter; left time: 664.9385s
Epoch: 5 cost time: 42.114012479782104
Epoch: 5, Steps: 2278 | Train Loss: 0.4229383 Vali Loss: 0.3862114 Test Loss: 0.1528654
Validation loss decreased (0.416598 --> 0.386211).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.3943263
	speed: 0.0792s/iter; left time: 2699.7650s
	iters: 200, epoch: 6 | loss: 0.2372839
	speed: 0.0192s/iter; left time: 653.7056s
	iters: 300, epoch: 6 | loss: 0.2265466
	speed: 0.0207s/iter; left time: 699.6297s
	iters: 400, epoch: 6 | loss: 0.2343755
	speed: 0.0209s/iter; left time: 706.1888s
	iters: 500, epoch: 6 | loss: 0.2226002
	speed: 0.0203s/iter; left time: 683.0273s
	iters: 600, epoch: 6 | loss: 0.1754625
	speed: 0.0185s/iter; left time: 620.7540s
	iters: 700, epoch: 6 | loss: 0.1848251
	speed: 0.0201s/iter; left time: 673.5370s
	iters: 800, epoch: 6 | loss: 0.2593442
	speed: 0.0216s/iter; left time: 719.7597s
	iters: 900, epoch: 6 | loss: 0.3080507
	speed: 0.0200s/iter; left time: 664.4230s
	iters: 1000, epoch: 6 | loss: 0.2425594
	speed: 0.0168s/iter; left time: 556.6492s
	iters: 1100, epoch: 6 | loss: 1.8743989
	speed: 0.0201s/iter; left time: 665.6354s
	iters: 1200, epoch: 6 | loss: 0.3086024
	speed: 0.0172s/iter; left time: 566.1146s
	iters: 1300, epoch: 6 | loss: 0.3195907
	speed: 0.0182s/iter; left time: 598.7208s
	iters: 1400, epoch: 6 | loss: 0.2691791
	speed: 0.0188s/iter; left time: 614.5335s
	iters: 1500, epoch: 6 | loss: 0.3717655
	speed: 0.0173s/iter; left time: 565.5906s
	iters: 1600, epoch: 6 | loss: 0.2957183
	speed: 0.0182s/iter; left time: 592.6471s
	iters: 1700, epoch: 6 | loss: 0.4473484
	speed: 0.0189s/iter; left time: 615.0921s
	iters: 1800, epoch: 6 | loss: 0.3134280
	speed: 0.0179s/iter; left time: 579.2004s
	iters: 1900, epoch: 6 | loss: 0.3806185
	speed: 0.0192s/iter; left time: 619.4078s
	iters: 2000, epoch: 6 | loss: 0.2920419
	speed: 0.0182s/iter; left time: 586.3376s
	iters: 2100, epoch: 6 | loss: 0.2260631
	speed: 0.0161s/iter; left time: 516.7736s
	iters: 2200, epoch: 6 | loss: 2.1467700
	speed: 0.0175s/iter; left time: 558.9575s
Epoch: 6 cost time: 42.94394826889038
Epoch: 6, Steps: 2278 | Train Loss: 0.4045521 Vali Loss: 0.3703288 Test Loss: 0.1458735
Validation loss decreased (0.386211 --> 0.370329).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.7284486
	speed: 0.0770s/iter; left time: 2446.8203s
	iters: 200, epoch: 7 | loss: 0.3072330
	speed: 0.0184s/iter; left time: 582.9142s
	iters: 300, epoch: 7 | loss: 0.3000540
	speed: 0.0194s/iter; left time: 613.1544s
	iters: 400, epoch: 7 | loss: 0.2259247
	speed: 0.0190s/iter; left time: 597.7567s
	iters: 500, epoch: 7 | loss: 0.3280466
	speed: 0.0208s/iter; left time: 651.9746s
	iters: 600, epoch: 7 | loss: 0.2901869
	speed: 0.0193s/iter; left time: 604.0098s
	iters: 700, epoch: 7 | loss: 0.2589491
	speed: 0.0195s/iter; left time: 606.7812s
	iters: 800, epoch: 7 | loss: 0.3195709
	speed: 0.0195s/iter; left time: 606.7503s
	iters: 900, epoch: 7 | loss: 0.2446220
	speed: 0.0186s/iter; left time: 577.4865s
	iters: 1000, epoch: 7 | loss: 0.3646427
	speed: 0.0184s/iter; left time: 568.5738s
	iters: 1100, epoch: 7 | loss: 0.3354528
	speed: 0.0185s/iter; left time: 569.3586s
	iters: 1200, epoch: 7 | loss: 0.2115566
	speed: 0.0199s/iter; left time: 609.9414s
	iters: 1300, epoch: 7 | loss: 0.4688813
	speed: 0.0202s/iter; left time: 619.4679s
	iters: 1400, epoch: 7 | loss: 2.1699800
	speed: 0.0202s/iter; left time: 617.0551s
	iters: 1500, epoch: 7 | loss: 0.4983895
	speed: 0.0205s/iter; left time: 622.7541s
	iters: 1600, epoch: 7 | loss: 0.2173722
	speed: 0.0202s/iter; left time: 612.6373s
	iters: 1700, epoch: 7 | loss: 0.1944629
	speed: 0.0188s/iter; left time: 568.6410s
	iters: 1800, epoch: 7 | loss: 0.3825411
	speed: 0.0173s/iter; left time: 521.9832s
	iters: 1900, epoch: 7 | loss: 0.2117474
	speed: 0.0172s/iter; left time: 517.1152s
	iters: 2000, epoch: 7 | loss: 0.2364710
	speed: 0.0196s/iter; left time: 586.5271s
	iters: 2100, epoch: 7 | loss: 0.6223803
	speed: 0.0187s/iter; left time: 555.7541s
	iters: 2200, epoch: 7 | loss: 0.3622938
	speed: 0.0166s/iter; left time: 492.1989s
Epoch: 7 cost time: 43.20547604560852
Epoch: 7, Steps: 2278 | Train Loss: 0.3962062 Vali Loss: 0.3730238 Test Loss: 0.1507226
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.2950841
	speed: 0.0792s/iter; left time: 2337.4639s
	iters: 200, epoch: 8 | loss: 2.0157571
	speed: 0.0165s/iter; left time: 483.9866s
	iters: 300, epoch: 8 | loss: 0.3909913
	speed: 0.0172s/iter; left time: 503.4315s
	iters: 400, epoch: 8 | loss: 0.2216305
	speed: 0.0187s/iter; left time: 544.8849s
	iters: 500, epoch: 8 | loss: 0.3507507
	speed: 0.0199s/iter; left time: 580.4721s
	iters: 600, epoch: 8 | loss: 0.4591224
	speed: 0.0210s/iter; left time: 610.2314s
	iters: 700, epoch: 8 | loss: 0.2847739
	speed: 0.0208s/iter; left time: 602.7520s
	iters: 800, epoch: 8 | loss: 0.2451408
	speed: 0.0186s/iter; left time: 536.3959s
	iters: 900, epoch: 8 | loss: 0.2600400
	speed: 0.0205s/iter; left time: 587.6128s
	iters: 1000, epoch: 8 | loss: 0.4840254
	speed: 0.0209s/iter; left time: 598.4513s
	iters: 1100, epoch: 8 | loss: 0.2201245
	speed: 0.0195s/iter; left time: 554.6469s
	iters: 1200, epoch: 8 | loss: 0.2617492
	speed: 0.0208s/iter; left time: 590.5676s
	iters: 1300, epoch: 8 | loss: 0.5573382
	speed: 0.0207s/iter; left time: 587.4023s
	iters: 1400, epoch: 8 | loss: 0.3238146
	speed: 0.0202s/iter; left time: 568.9098s
	iters: 1500, epoch: 8 | loss: 0.2494056
	speed: 0.0196s/iter; left time: 552.2715s
	iters: 1600, epoch: 8 | loss: 0.4153312
	speed: 0.0196s/iter; left time: 549.3787s
	iters: 1700, epoch: 8 | loss: 0.4795551
	speed: 0.0205s/iter; left time: 572.0759s
	iters: 1800, epoch: 8 | loss: 0.5709804
	speed: 0.0193s/iter; left time: 536.9225s
	iters: 1900, epoch: 8 | loss: 0.2145637
	speed: 0.0192s/iter; left time: 532.4809s
	iters: 2000, epoch: 8 | loss: 0.4235573
	speed: 0.0200s/iter; left time: 551.0760s
	iters: 2100, epoch: 8 | loss: 0.1767980
	speed: 0.0192s/iter; left time: 527.2670s
	iters: 2200, epoch: 8 | loss: 2.1439035
	speed: 0.0179s/iter; left time: 489.7235s
Epoch: 8 cost time: 44.415772914886475
Epoch: 8, Steps: 2278 | Train Loss: 0.3922416 Vali Loss: 0.3664136 Test Loss: 0.1448847
Validation loss decreased (0.370329 --> 0.366414).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 1.7115272
	speed: 0.0775s/iter; left time: 2110.5752s
	iters: 200, epoch: 9 | loss: 0.2461182
	speed: 0.0177s/iter; left time: 481.1080s
	iters: 300, epoch: 9 | loss: 0.3272646
	speed: 0.0191s/iter; left time: 517.3138s
	iters: 400, epoch: 9 | loss: 0.2357687
	speed: 0.0182s/iter; left time: 490.5475s
	iters: 500, epoch: 9 | loss: 0.3623019
	speed: 0.0169s/iter; left time: 452.8096s
	iters: 600, epoch: 9 | loss: 0.2067384
	speed: 0.0186s/iter; left time: 497.9976s
	iters: 700, epoch: 9 | loss: 0.2011098
	speed: 0.0193s/iter; left time: 513.0575s
	iters: 800, epoch: 9 | loss: 0.2998105
	speed: 0.0202s/iter; left time: 535.0795s
	iters: 900, epoch: 9 | loss: 1.6848388
	speed: 0.0196s/iter; left time: 518.6290s
	iters: 1000, epoch: 9 | loss: 0.2143530
	speed: 0.0205s/iter; left time: 539.5495s
	iters: 1100, epoch: 9 | loss: 0.2093217
	speed: 0.0182s/iter; left time: 478.0667s
	iters: 1200, epoch: 9 | loss: 0.6177722
	speed: 0.0196s/iter; left time: 511.3342s
	iters: 1300, epoch: 9 | loss: 0.7015045
	speed: 0.0181s/iter; left time: 471.0874s
	iters: 1400, epoch: 9 | loss: 0.4672420
	speed: 0.0193s/iter; left time: 501.6881s
	iters: 1500, epoch: 9 | loss: 0.2882786
	speed: 0.0194s/iter; left time: 501.0713s
	iters: 1600, epoch: 9 | loss: 0.1767470
	speed: 0.0202s/iter; left time: 519.9057s
	iters: 1700, epoch: 9 | loss: 0.2345412
	speed: 0.0188s/iter; left time: 483.0712s
	iters: 1800, epoch: 9 | loss: 0.3531376
	speed: 0.0193s/iter; left time: 492.7149s
	iters: 1900, epoch: 9 | loss: 0.1945345
	speed: 0.0174s/iter; left time: 442.6171s
	iters: 2000, epoch: 9 | loss: 0.2954257
	speed: 0.0181s/iter; left time: 457.6253s
	iters: 2100, epoch: 9 | loss: 1.6988984
	speed: 0.0174s/iter; left time: 438.9390s
	iters: 2200, epoch: 9 | loss: 0.2763489
	speed: 0.0179s/iter; left time: 450.6295s
Epoch: 9 cost time: 42.63284873962402
Epoch: 9, Steps: 2278 | Train Loss: 0.3903258 Vali Loss: 0.3666296 Test Loss: 0.1445286
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.2294519
	speed: 0.0833s/iter; left time: 2080.1950s
	iters: 200, epoch: 10 | loss: 0.4653415
	speed: 0.0185s/iter; left time: 460.4660s
	iters: 300, epoch: 10 | loss: 0.2098314
	speed: 0.0184s/iter; left time: 456.4248s
	iters: 400, epoch: 10 | loss: 0.2466029
	speed: 0.0171s/iter; left time: 421.0192s
	iters: 500, epoch: 10 | loss: 0.3927338
	speed: 0.0162s/iter; left time: 398.1720s
	iters: 600, epoch: 10 | loss: 0.3535355
	speed: 0.0178s/iter; left time: 435.9185s
	iters: 700, epoch: 10 | loss: 0.6943961
	speed: 0.0169s/iter; left time: 411.5258s
	iters: 800, epoch: 10 | loss: 0.2496799
	speed: 0.0167s/iter; left time: 404.3071s
	iters: 900, epoch: 10 | loss: 0.2526863
	speed: 0.0183s/iter; left time: 441.9615s
	iters: 1000, epoch: 10 | loss: 0.2163968
	speed: 0.0203s/iter; left time: 487.5267s
	iters: 1100, epoch: 10 | loss: 0.2535748
	speed: 0.0217s/iter; left time: 519.2928s
	iters: 1200, epoch: 10 | loss: 0.2469969
	speed: 0.0184s/iter; left time: 438.4181s
	iters: 1300, epoch: 10 | loss: 0.2281351
	speed: 0.0192s/iter; left time: 456.5237s
	iters: 1400, epoch: 10 | loss: 0.2185103
	speed: 0.0184s/iter; left time: 435.6412s
	iters: 1500, epoch: 10 | loss: 0.4767930
	speed: 0.0190s/iter; left time: 447.7646s
	iters: 1600, epoch: 10 | loss: 0.2055380
	speed: 0.0203s/iter; left time: 475.3411s
	iters: 1700, epoch: 10 | loss: 0.2364303
	speed: 0.0196s/iter; left time: 458.1304s
	iters: 1800, epoch: 10 | loss: 0.5134338
	speed: 0.0181s/iter; left time: 420.1930s
	iters: 1900, epoch: 10 | loss: 0.1816519
	speed: 0.0198s/iter; left time: 457.9525s
	iters: 2000, epoch: 10 | loss: 2.3873749
	speed: 0.0184s/iter; left time: 424.8180s
	iters: 2100, epoch: 10 | loss: 0.3023197
	speed: 0.0183s/iter; left time: 421.1033s
	iters: 2200, epoch: 10 | loss: 0.2215985
	speed: 0.0184s/iter; left time: 421.1521s
Epoch: 10 cost time: 42.38312840461731
Epoch: 10, Steps: 2278 | Train Loss: 0.3893384 Vali Loss: 0.3653317 Test Loss: 0.1442811
Validation loss decreased (0.366414 --> 0.365332).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.2265943
	speed: 0.0734s/iter; left time: 1664.8903s
	iters: 200, epoch: 11 | loss: 0.1788175
	speed: 0.0164s/iter; left time: 369.2136s
	iters: 300, epoch: 11 | loss: 0.2051119
	speed: 0.0192s/iter; left time: 431.9813s
	iters: 400, epoch: 11 | loss: 0.3625499
	speed: 0.0192s/iter; left time: 430.4186s
	iters: 500, epoch: 11 | loss: 0.2647523
	speed: 0.0193s/iter; left time: 428.9372s
	iters: 600, epoch: 11 | loss: 0.4603907
	speed: 0.0193s/iter; left time: 429.0587s
	iters: 700, epoch: 11 | loss: 0.2074761
	speed: 0.0199s/iter; left time: 440.4250s
	iters: 800, epoch: 11 | loss: 0.1753867
	speed: 0.0206s/iter; left time: 453.6126s
	iters: 900, epoch: 11 | loss: 0.2341549
	speed: 0.0216s/iter; left time: 471.8110s
	iters: 1000, epoch: 11 | loss: 0.3948984
	speed: 0.0195s/iter; left time: 425.2147s
	iters: 1100, epoch: 11 | loss: 0.2255739
	speed: 0.0194s/iter; left time: 420.2482s
	iters: 1200, epoch: 11 | loss: 0.3069963
	speed: 0.0208s/iter; left time: 449.8550s
	iters: 1300, epoch: 11 | loss: 0.1668306
	speed: 0.0168s/iter; left time: 361.5830s
	iters: 1400, epoch: 11 | loss: 0.2515273
	speed: 0.0208s/iter; left time: 445.4970s
	iters: 1500, epoch: 11 | loss: 0.3383899
	speed: 0.0207s/iter; left time: 440.8288s
	iters: 1600, epoch: 11 | loss: 0.3292107
	speed: 0.0199s/iter; left time: 420.7274s
	iters: 1700, epoch: 11 | loss: 0.3959936
	speed: 0.0156s/iter; left time: 329.5457s
	iters: 1800, epoch: 11 | loss: 0.2702764
	speed: 0.0167s/iter; left time: 351.2979s
	iters: 1900, epoch: 11 | loss: 0.4191252
	speed: 0.0183s/iter; left time: 382.1975s
	iters: 2000, epoch: 11 | loss: 0.3872553
	speed: 0.0192s/iter; left time: 399.4699s
	iters: 2100, epoch: 11 | loss: 0.4025223
	speed: 0.0192s/iter; left time: 396.2887s
	iters: 2200, epoch: 11 | loss: 0.2013560
	speed: 0.0190s/iter; left time: 390.7624s
Epoch: 11 cost time: 43.40008091926575
Epoch: 11, Steps: 2278 | Train Loss: 0.3887958 Vali Loss: 0.3650717 Test Loss: 0.1442663
Validation loss decreased (0.365332 --> 0.365072).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.2886247
	speed: 0.0795s/iter; left time: 1622.8271s
	iters: 200, epoch: 12 | loss: 0.2297133
	speed: 0.0193s/iter; left time: 391.5765s
	iters: 300, epoch: 12 | loss: 0.2624362
	speed: 0.0183s/iter; left time: 369.6466s
	iters: 400, epoch: 12 | loss: 0.2879861
	speed: 0.0187s/iter; left time: 376.6493s
	iters: 500, epoch: 12 | loss: 0.2513192
	speed: 0.0188s/iter; left time: 376.6813s
	iters: 600, epoch: 12 | loss: 0.1690515
	speed: 0.0177s/iter; left time: 351.7971s
	iters: 700, epoch: 12 | loss: 0.4981767
	speed: 0.0204s/iter; left time: 404.0460s
	iters: 800, epoch: 12 | loss: 0.2947238
	speed: 0.0193s/iter; left time: 380.8955s
	iters: 900, epoch: 12 | loss: 0.2010484
	speed: 0.0167s/iter; left time: 326.8460s
	iters: 1000, epoch: 12 | loss: 0.5372380
	speed: 0.0171s/iter; left time: 332.9656s
	iters: 1100, epoch: 12 | loss: 0.4079152
	speed: 0.0181s/iter; left time: 351.2400s
	iters: 1200, epoch: 12 | loss: 0.2511247
	speed: 0.0170s/iter; left time: 327.4738s
	iters: 1300, epoch: 12 | loss: 0.3295697
	speed: 0.0183s/iter; left time: 351.0802s
	iters: 1400, epoch: 12 | loss: 0.2726062
	speed: 0.0178s/iter; left time: 340.1035s
	iters: 1500, epoch: 12 | loss: 0.2846001
	speed: 0.0210s/iter; left time: 399.4404s
	iters: 1600, epoch: 12 | loss: 0.2363506
	speed: 0.0198s/iter; left time: 373.7723s
	iters: 1700, epoch: 12 | loss: 0.1545459
	speed: 0.0188s/iter; left time: 354.3167s
	iters: 1800, epoch: 12 | loss: 0.2578156
	speed: 0.0182s/iter; left time: 340.6592s
	iters: 1900, epoch: 12 | loss: 0.3076339
	speed: 0.0178s/iter; left time: 330.9170s
	iters: 2000, epoch: 12 | loss: 0.2266012
	speed: 0.0186s/iter; left time: 344.4681s
	iters: 2100, epoch: 12 | loss: 0.3079668
	speed: 0.0189s/iter; left time: 348.3080s
	iters: 2200, epoch: 12 | loss: 0.3267428
	speed: 0.0179s/iter; left time: 327.9258s
Epoch: 12 cost time: 42.048924684524536
Epoch: 12, Steps: 2278 | Train Loss: 0.3885448 Vali Loss: 0.3654312 Test Loss: 0.1446351
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.1838046
	speed: 0.0762s/iter; left time: 1380.6376s
	iters: 200, epoch: 13 | loss: 0.5421910
	speed: 0.0165s/iter; left time: 297.3016s
	iters: 300, epoch: 13 | loss: 0.4043402
	speed: 0.0176s/iter; left time: 315.7262s
	iters: 400, epoch: 13 | loss: 0.2423833
	speed: 0.0168s/iter; left time: 298.6211s
	iters: 500, epoch: 13 | loss: 0.2223511
	speed: 0.0176s/iter; left time: 312.7094s
	iters: 600, epoch: 13 | loss: 0.1981112
	speed: 0.0193s/iter; left time: 340.9199s
	iters: 700, epoch: 13 | loss: 0.2539236
	speed: 0.0192s/iter; left time: 337.0612s
	iters: 800, epoch: 13 | loss: 0.3152319
	speed: 0.0181s/iter; left time: 315.4698s
	iters: 900, epoch: 13 | loss: 0.2758090
	speed: 0.0196s/iter; left time: 340.3361s
	iters: 1000, epoch: 13 | loss: 0.3547934
	speed: 0.0182s/iter; left time: 313.5422s
	iters: 1100, epoch: 13 | loss: 0.3289850
	speed: 0.0160s/iter; left time: 274.5638s
	iters: 1200, epoch: 13 | loss: 0.2480468
	speed: 0.0190s/iter; left time: 322.8865s
	iters: 1300, epoch: 13 | loss: 0.4498338
	speed: 0.0198s/iter; left time: 334.3521s
	iters: 1400, epoch: 13 | loss: 2.1143486
	speed: 0.0190s/iter; left time: 319.0558s
	iters: 1500, epoch: 13 | loss: 0.2821772
	speed: 0.0182s/iter; left time: 304.6446s
	iters: 1600, epoch: 13 | loss: 0.4096270
	speed: 0.0180s/iter; left time: 299.2596s
	iters: 1700, epoch: 13 | loss: 0.3432815
	speed: 0.0185s/iter; left time: 305.2626s
	iters: 1800, epoch: 13 | loss: 0.2434637
	speed: 0.0184s/iter; left time: 301.9769s
	iters: 1900, epoch: 13 | loss: 0.3308748
	speed: 0.0169s/iter; left time: 276.6588s
	iters: 2000, epoch: 13 | loss: 0.2684902
	speed: 0.0184s/iter; left time: 298.9303s
	iters: 2100, epoch: 13 | loss: 0.3349830
	speed: 0.0208s/iter; left time: 334.7631s
	iters: 2200, epoch: 13 | loss: 0.2767240
	speed: 0.0181s/iter; left time: 289.7769s
Epoch: 13 cost time: 41.69326591491699
Epoch: 13, Steps: 2278 | Train Loss: 0.3883816 Vali Loss: 0.3651789 Test Loss: 0.1442657
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.5683549
	speed: 0.0792s/iter; left time: 1255.3245s
	iters: 200, epoch: 14 | loss: 0.3150654
	speed: 0.0209s/iter; left time: 328.8869s
	iters: 300, epoch: 14 | loss: 0.2392529
	speed: 0.0212s/iter; left time: 331.9452s
	iters: 400, epoch: 14 | loss: 0.1968528
	speed: 0.0180s/iter; left time: 280.3636s
	iters: 500, epoch: 14 | loss: 1.8823761
	speed: 0.0157s/iter; left time: 242.8678s
	iters: 600, epoch: 14 | loss: 0.2712290
	speed: 0.0199s/iter; left time: 304.8813s
	iters: 700, epoch: 14 | loss: 0.4511407
	speed: 0.0197s/iter; left time: 300.1625s
	iters: 800, epoch: 14 | loss: 0.6761026
	speed: 0.0186s/iter; left time: 282.3867s
	iters: 900, epoch: 14 | loss: 0.1773380
	speed: 0.0172s/iter; left time: 259.3518s
	iters: 1000, epoch: 14 | loss: 0.2309669
	speed: 0.0207s/iter; left time: 309.8668s
	iters: 1100, epoch: 14 | loss: 0.5274194
	speed: 0.0208s/iter; left time: 308.4251s
	iters: 1200, epoch: 14 | loss: 0.5407910
	speed: 0.0211s/iter; left time: 310.4888s
	iters: 1300, epoch: 14 | loss: 0.2227110
	speed: 0.0177s/iter; left time: 259.8941s
	iters: 1400, epoch: 14 | loss: 0.3016922
	speed: 0.0191s/iter; left time: 278.3606s
	iters: 1500, epoch: 14 | loss: 0.3539677
	speed: 0.0182s/iter; left time: 263.5666s
	iters: 1600, epoch: 14 | loss: 0.5168976
	speed: 0.0179s/iter; left time: 257.3534s
	iters: 1700, epoch: 14 | loss: 0.3078145
	speed: 0.0181s/iter; left time: 258.2739s
	iters: 1800, epoch: 14 | loss: 0.3471821
	speed: 0.0188s/iter; left time: 265.7856s
	iters: 1900, epoch: 14 | loss: 0.3368474
	speed: 0.0175s/iter; left time: 246.0581s
	iters: 2000, epoch: 14 | loss: 0.3065397
	speed: 0.0150s/iter; left time: 209.2136s
	iters: 2100, epoch: 14 | loss: 0.2782042
	speed: 0.0187s/iter; left time: 258.8180s
	iters: 2200, epoch: 14 | loss: 0.3813036
	speed: 0.0191s/iter; left time: 262.0915s
Epoch: 14 cost time: 42.666380643844604
Epoch: 14, Steps: 2278 | Train Loss: 0.3883166 Vali Loss: 0.3655086 Test Loss: 0.1443299
EarlyStopping counter: 3 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 2.1123874
	speed: 0.0774s/iter; left time: 1049.8994s
	iters: 200, epoch: 15 | loss: 0.3024594
	speed: 0.0159s/iter; left time: 213.7624s
	iters: 300, epoch: 15 | loss: 0.3202973
	speed: 0.0189s/iter; left time: 252.0847s
	iters: 400, epoch: 15 | loss: 0.2398842
	speed: 0.0165s/iter; left time: 218.4384s
	iters: 500, epoch: 15 | loss: 0.2800565
	speed: 0.0154s/iter; left time: 202.9090s
	iters: 600, epoch: 15 | loss: 0.3609382
	speed: 0.0193s/iter; left time: 251.7634s
	iters: 700, epoch: 15 | loss: 0.3238740
	speed: 0.0197s/iter; left time: 254.9296s
	iters: 800, epoch: 15 | loss: 0.7282130
	speed: 0.0165s/iter; left time: 212.7783s
	iters: 900, epoch: 15 | loss: 0.2072875
	speed: 0.0174s/iter; left time: 222.6209s
	iters: 1000, epoch: 15 | loss: 0.2797590
	speed: 0.0193s/iter; left time: 244.5636s
	iters: 1100, epoch: 15 | loss: 0.3035179
	speed: 0.0171s/iter; left time: 215.2070s
	iters: 1200, epoch: 15 | loss: 0.1943302
	speed: 0.0198s/iter; left time: 246.6984s
	iters: 1300, epoch: 15 | loss: 0.4496672
	speed: 0.0186s/iter; left time: 229.6975s
	iters: 1400, epoch: 15 | loss: 0.3747940
	speed: 0.0196s/iter; left time: 240.7234s
	iters: 1500, epoch: 15 | loss: 3.7710845
	speed: 0.0176s/iter; left time: 214.5651s
	iters: 1600, epoch: 15 | loss: 0.4048997
	speed: 0.0163s/iter; left time: 196.2863s
	iters: 1700, epoch: 15 | loss: 0.2317388
	speed: 0.0198s/iter; left time: 236.7645s
	iters: 1800, epoch: 15 | loss: 0.2456159
	speed: 0.0197s/iter; left time: 234.3417s
	iters: 1900, epoch: 15 | loss: 0.4091205
	speed: 0.0188s/iter; left time: 220.7153s
	iters: 2000, epoch: 15 | loss: 0.4076418
	speed: 0.0190s/iter; left time: 221.6321s
	iters: 2100, epoch: 15 | loss: 0.2936848
	speed: 0.0206s/iter; left time: 238.1711s
	iters: 2200, epoch: 15 | loss: 0.2731875
	speed: 0.0194s/iter; left time: 222.5826s
Epoch: 15 cost time: 41.959017753601074
Epoch: 15, Steps: 2278 | Train Loss: 0.3882723 Vali Loss: 0.3652347 Test Loss: 0.1443393
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.2907525
	speed: 0.0750s/iter; left time: 847.2984s
	iters: 200, epoch: 16 | loss: 0.2181948
	speed: 0.0187s/iter; left time: 208.7325s
	iters: 300, epoch: 16 | loss: 0.4061545
	speed: 0.0168s/iter; left time: 186.0273s
	iters: 400, epoch: 16 | loss: 0.3603218
	speed: 0.0186s/iter; left time: 203.9169s
	iters: 500, epoch: 16 | loss: 0.1694211
	speed: 0.0204s/iter; left time: 222.5616s
	iters: 600, epoch: 16 | loss: 0.5849441
	speed: 0.0184s/iter; left time: 198.8879s
	iters: 700, epoch: 16 | loss: 0.2964462
	speed: 0.0154s/iter; left time: 164.4376s
	iters: 800, epoch: 16 | loss: 0.2469089
	speed: 0.0198s/iter; left time: 210.0902s
	iters: 900, epoch: 16 | loss: 0.2963403
	speed: 0.0207s/iter; left time: 217.0142s
	iters: 1000, epoch: 16 | loss: 0.3225448
	speed: 0.0202s/iter; left time: 209.5004s
	iters: 1100, epoch: 16 | loss: 0.5611332
	speed: 0.0196s/iter; left time: 201.6365s
	iters: 1200, epoch: 16 | loss: 0.4172548
	speed: 0.0207s/iter; left time: 210.6861s
	iters: 1300, epoch: 16 | loss: 0.2542842
	speed: 0.0213s/iter; left time: 214.5606s
	iters: 1400, epoch: 16 | loss: 0.3896182
	speed: 0.0212s/iter; left time: 211.5327s
	iters: 1500, epoch: 16 | loss: 2.1524727
	speed: 0.0206s/iter; left time: 203.6925s
	iters: 1600, epoch: 16 | loss: 0.4546530
	speed: 0.0200s/iter; left time: 195.7453s
	iters: 1700, epoch: 16 | loss: 0.3326099
	speed: 0.0172s/iter; left time: 166.4255s
	iters: 1800, epoch: 16 | loss: 0.2773921
	speed: 0.0183s/iter; left time: 175.9082s
	iters: 1900, epoch: 16 | loss: 0.3107686
	speed: 0.0190s/iter; left time: 180.7444s
	iters: 2000, epoch: 16 | loss: 0.2244197
	speed: 0.0192s/iter; left time: 179.9824s
	iters: 2100, epoch: 16 | loss: 0.8109669
	speed: 0.0186s/iter; left time: 173.1383s
	iters: 2200, epoch: 16 | loss: 0.3900978
	speed: 0.0180s/iter; left time: 165.6591s
Epoch: 16 cost time: 43.40889835357666
Epoch: 16, Steps: 2278 | Train Loss: 0.3882442 Vali Loss: 0.3653631 Test Loss: 0.1443450
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : weather_336_96_DLinear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed12890<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
mse:0.14430832862854004, mae:0.20884835720062256
