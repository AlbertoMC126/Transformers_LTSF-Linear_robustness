Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='DLinear', model_id='ETTm2_336_192', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=192, root_path='./dataset/', save_pred_values=False, seed=15726, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTm2_336_192_DLinear_ETTm2_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15726>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34033
val 11329
test 11329
	iters: 100, epoch: 1 | loss: 0.2794937
	speed: 0.0107s/iter; left time: 227.0777s
	iters: 200, epoch: 1 | loss: 0.3074263
	speed: 0.0109s/iter; left time: 229.5869s
	iters: 300, epoch: 1 | loss: 1.0591433
	speed: 0.0111s/iter; left time: 231.8997s
	iters: 400, epoch: 1 | loss: 0.3419448
	speed: 0.0110s/iter; left time: 229.0671s
	iters: 500, epoch: 1 | loss: 0.3728248
	speed: 0.0115s/iter; left time: 237.7278s
	iters: 600, epoch: 1 | loss: 0.4792690
	speed: 0.0073s/iter; left time: 150.7010s
	iters: 700, epoch: 1 | loss: 0.3479047
	speed: 0.0093s/iter; left time: 191.0343s
	iters: 800, epoch: 1 | loss: 0.4404929
	speed: 0.0099s/iter; left time: 202.4210s
	iters: 900, epoch: 1 | loss: 0.3066342
	speed: 0.0117s/iter; left time: 238.5091s
	iters: 1000, epoch: 1 | loss: 0.5532199
	speed: 0.0107s/iter; left time: 216.4195s
Epoch: 1 cost time: 11.122095584869385
Epoch: 1, Steps: 1063 | Train Loss: 0.5496724 Vali Loss: 0.5842032 Test Loss: 1.4094200
Validation loss decreased (inf --> 0.584203).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.7279853
	speed: 0.0469s/iter; left time: 943.3999s
	iters: 200, epoch: 2 | loss: 0.4555127
	speed: 0.0092s/iter; left time: 183.7607s
	iters: 300, epoch: 2 | loss: 0.4562495
	speed: 0.0111s/iter; left time: 220.4048s
	iters: 400, epoch: 2 | loss: 0.5785716
	speed: 0.0113s/iter; left time: 223.1532s
	iters: 500, epoch: 2 | loss: 0.5160205
	speed: 0.0109s/iter; left time: 215.3343s
	iters: 600, epoch: 2 | loss: 0.4172273
	speed: 0.0111s/iter; left time: 217.1893s
	iters: 700, epoch: 2 | loss: 0.4940979
	speed: 0.0116s/iter; left time: 226.2016s
	iters: 800, epoch: 2 | loss: 0.5641513
	speed: 0.0113s/iter; left time: 219.2142s
	iters: 900, epoch: 2 | loss: 0.4270707
	speed: 0.0119s/iter; left time: 228.7121s
	iters: 1000, epoch: 2 | loss: 0.5402362
	speed: 0.0116s/iter; left time: 222.9702s
Epoch: 2 cost time: 11.667044401168823
Epoch: 2, Steps: 1063 | Train Loss: 0.5509265 Vali Loss: 0.5196635 Test Loss: 1.0943335
Validation loss decreased (0.584203 --> 0.519664).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.6848506
	speed: 0.0494s/iter; left time: 939.8000s
	iters: 200, epoch: 3 | loss: 0.4612470
	speed: 0.0108s/iter; left time: 204.7677s
	iters: 300, epoch: 3 | loss: 0.4310537
	speed: 0.0099s/iter; left time: 186.1048s
	iters: 400, epoch: 3 | loss: 0.2533650
	speed: 0.0099s/iter; left time: 184.9228s
	iters: 500, epoch: 3 | loss: 0.6696492
	speed: 0.0099s/iter; left time: 183.7411s
	iters: 600, epoch: 3 | loss: 0.5799765
	speed: 0.0106s/iter; left time: 196.5253s
	iters: 700, epoch: 3 | loss: 0.2355854
	speed: 0.0109s/iter; left time: 201.4998s
	iters: 800, epoch: 3 | loss: 0.3763844
	speed: 0.0108s/iter; left time: 197.1142s
	iters: 900, epoch: 3 | loss: 0.2698815
	speed: 0.0074s/iter; left time: 134.7570s
	iters: 1000, epoch: 3 | loss: 0.2484403
	speed: 0.0091s/iter; left time: 164.6909s
Epoch: 3 cost time: 10.696633100509644
Epoch: 3, Steps: 1063 | Train Loss: 0.3706671 Vali Loss: 0.3254255 Test Loss: 0.4918205
Validation loss decreased (0.519664 --> 0.325426).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.3615879
	speed: 0.0502s/iter; left time: 902.7125s
	iters: 200, epoch: 4 | loss: 0.2390479
	speed: 0.0107s/iter; left time: 190.7551s
	iters: 300, epoch: 4 | loss: 0.3427826
	speed: 0.0109s/iter; left time: 194.5226s
	iters: 400, epoch: 4 | loss: 0.3126099
	speed: 0.0115s/iter; left time: 202.6197s
	iters: 500, epoch: 4 | loss: 0.2381510
	speed: 0.0105s/iter; left time: 185.0625s
	iters: 600, epoch: 4 | loss: 0.8569114
	speed: 0.0108s/iter; left time: 188.6972s
	iters: 700, epoch: 4 | loss: 0.4516160
	speed: 0.0116s/iter; left time: 201.7134s
	iters: 800, epoch: 4 | loss: 0.4103410
	speed: 0.0116s/iter; left time: 200.3698s
	iters: 900, epoch: 4 | loss: 0.3110400
	speed: 0.0110s/iter; left time: 188.0428s
	iters: 1000, epoch: 4 | loss: 0.3562483
	speed: 0.0105s/iter; left time: 178.6173s
Epoch: 4 cost time: 11.68049144744873
Epoch: 4, Steps: 1063 | Train Loss: 0.3239394 Vali Loss: 0.6634349 Test Loss: 1.8273785
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.1935341
	speed: 0.0463s/iter; left time: 783.6090s
	iters: 200, epoch: 5 | loss: 0.5985236
	speed: 0.0106s/iter; left time: 178.0813s
	iters: 300, epoch: 5 | loss: 0.4243697
	speed: 0.0106s/iter; left time: 176.3245s
	iters: 400, epoch: 5 | loss: 0.2463290
	speed: 0.0108s/iter; left time: 179.0145s
	iters: 500, epoch: 5 | loss: 0.2057780
	speed: 0.0104s/iter; left time: 171.2571s
	iters: 600, epoch: 5 | loss: 0.3529208
	speed: 0.0099s/iter; left time: 162.3257s
	iters: 700, epoch: 5 | loss: 0.2506367
	speed: 0.0105s/iter; left time: 171.7974s
	iters: 800, epoch: 5 | loss: 0.2066553
	speed: 0.0113s/iter; left time: 182.6946s
	iters: 900, epoch: 5 | loss: 0.6532785
	speed: 0.0114s/iter; left time: 184.1360s
	iters: 1000, epoch: 5 | loss: 0.6025548
	speed: 0.0117s/iter; left time: 187.5473s
Epoch: 5 cost time: 11.444526195526123
Epoch: 5, Steps: 1063 | Train Loss: 0.3001218 Vali Loss: 0.2367127 Test Loss: 0.4519573
Validation loss decreased (0.325426 --> 0.236713).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.1748550
	speed: 0.0458s/iter; left time: 725.2642s
	iters: 200, epoch: 6 | loss: 0.2889401
	speed: 0.0110s/iter; left time: 173.6837s
	iters: 300, epoch: 6 | loss: 0.2995601
	speed: 0.0112s/iter; left time: 174.6393s
	iters: 400, epoch: 6 | loss: 0.4706566
	speed: 0.0108s/iter; left time: 167.9894s
	iters: 500, epoch: 6 | loss: 0.3383907
	speed: 0.0109s/iter; left time: 169.0222s
	iters: 600, epoch: 6 | loss: 0.2497724
	speed: 0.0116s/iter; left time: 177.5689s
	iters: 700, epoch: 6 | loss: 0.3774776
	speed: 0.0115s/iter; left time: 174.6012s
	iters: 800, epoch: 6 | loss: 0.3914749
	speed: 0.0107s/iter; left time: 161.6269s
	iters: 900, epoch: 6 | loss: 0.2237958
	speed: 0.0106s/iter; left time: 158.9185s
	iters: 1000, epoch: 6 | loss: 0.2535779
	speed: 0.0111s/iter; left time: 166.3576s
Epoch: 6 cost time: 11.690152645111084
Epoch: 6, Steps: 1063 | Train Loss: 0.2882419 Vali Loss: 0.2091285 Test Loss: 0.3517141
Validation loss decreased (0.236713 --> 0.209128).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.3341669
	speed: 0.0447s/iter; left time: 661.0131s
	iters: 200, epoch: 7 | loss: 0.2643834
	speed: 0.0110s/iter; left time: 161.6662s
	iters: 300, epoch: 7 | loss: 0.1811759
	speed: 0.0111s/iter; left time: 161.8338s
	iters: 400, epoch: 7 | loss: 0.6118740
	speed: 0.0097s/iter; left time: 141.1486s
	iters: 500, epoch: 7 | loss: 0.2707890
	speed: 0.0090s/iter; left time: 129.0533s
	iters: 600, epoch: 7 | loss: 0.4911736
	speed: 0.0108s/iter; left time: 154.4101s
	iters: 700, epoch: 7 | loss: 0.2743360
	speed: 0.0104s/iter; left time: 147.9466s
	iters: 800, epoch: 7 | loss: 0.2682379
	speed: 0.0089s/iter; left time: 125.7978s
	iters: 900, epoch: 7 | loss: 0.2582535
	speed: 0.0099s/iter; left time: 138.7497s
	iters: 1000, epoch: 7 | loss: 0.2816669
	speed: 0.0108s/iter; left time: 149.8391s
Epoch: 7 cost time: 10.931356191635132
Epoch: 7, Steps: 1063 | Train Loss: 0.2811597 Vali Loss: 0.2159966 Test Loss: 0.3961187
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.2450738
	speed: 0.0469s/iter; left time: 643.5006s
	iters: 200, epoch: 8 | loss: 0.3091425
	speed: 0.0100s/iter; left time: 136.2471s
	iters: 300, epoch: 8 | loss: 0.2479764
	speed: 0.0108s/iter; left time: 145.9425s
	iters: 400, epoch: 8 | loss: 0.1397819
	speed: 0.0114s/iter; left time: 153.5768s
	iters: 500, epoch: 8 | loss: 0.1850516
	speed: 0.0113s/iter; left time: 149.9914s
	iters: 600, epoch: 8 | loss: 0.2612351
	speed: 0.0108s/iter; left time: 143.0569s
	iters: 700, epoch: 8 | loss: 0.2275905
	speed: 0.0108s/iter; left time: 142.2475s
	iters: 800, epoch: 8 | loss: 0.4014418
	speed: 0.0095s/iter; left time: 123.3034s
	iters: 900, epoch: 8 | loss: 0.2239256
	speed: 0.0100s/iter; left time: 129.0909s
	iters: 1000, epoch: 8 | loss: 0.4118137
	speed: 0.0107s/iter; left time: 137.3346s
Epoch: 8 cost time: 11.122420310974121
Epoch: 8, Steps: 1063 | Train Loss: 0.2781938 Vali Loss: 0.1750678 Test Loss: 0.2724646
Validation loss decreased (0.209128 --> 0.175068).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.2127251
	speed: 0.0451s/iter; left time: 570.8615s
	iters: 200, epoch: 9 | loss: 0.2803281
	speed: 0.0116s/iter; left time: 145.1639s
	iters: 300, epoch: 9 | loss: 0.1648072
	speed: 0.0115s/iter; left time: 143.7733s
	iters: 400, epoch: 9 | loss: 0.3617248
	speed: 0.0109s/iter; left time: 135.0859s
	iters: 500, epoch: 9 | loss: 0.2994232
	speed: 0.0106s/iter; left time: 129.5593s
	iters: 600, epoch: 9 | loss: 0.1625662
	speed: 0.0112s/iter; left time: 135.8279s
	iters: 700, epoch: 9 | loss: 0.1965496
	speed: 0.0095s/iter; left time: 114.0846s
	iters: 800, epoch: 9 | loss: 0.3013136
	speed: 0.0107s/iter; left time: 128.0839s
	iters: 900, epoch: 9 | loss: 0.2270939
	speed: 0.0110s/iter; left time: 129.8378s
	iters: 1000, epoch: 9 | loss: 0.1644072
	speed: 0.0102s/iter; left time: 119.6986s
Epoch: 9 cost time: 11.350911617279053
Epoch: 9, Steps: 1063 | Train Loss: 0.2759116 Vali Loss: 0.2029936 Test Loss: 0.3607624
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.2199189
	speed: 0.0450s/iter; left time: 522.1235s
	iters: 200, epoch: 10 | loss: 0.2357771
	speed: 0.0108s/iter; left time: 124.0279s
	iters: 300, epoch: 10 | loss: 0.1548923
	speed: 0.0111s/iter; left time: 126.5999s
	iters: 400, epoch: 10 | loss: 0.1866078
	speed: 0.0113s/iter; left time: 127.8810s
	iters: 500, epoch: 10 | loss: 0.4349403
	speed: 0.0118s/iter; left time: 132.2112s
	iters: 600, epoch: 10 | loss: 0.3758388
	speed: 0.0101s/iter; left time: 112.0697s
	iters: 700, epoch: 10 | loss: 0.2160194
	speed: 0.0105s/iter; left time: 115.2470s
	iters: 800, epoch: 10 | loss: 0.2571679
	speed: 0.0114s/iter; left time: 124.6474s
	iters: 900, epoch: 10 | loss: 0.3652069
	speed: 0.0110s/iter; left time: 118.3435s
	iters: 1000, epoch: 10 | loss: 0.6241819
	speed: 0.0115s/iter; left time: 123.0059s
Epoch: 10 cost time: 11.617035627365112
Epoch: 10, Steps: 1063 | Train Loss: 0.2747471 Vali Loss: 0.1995851 Test Loss: 0.3543010
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.3328087
	speed: 0.0447s/iter; left time: 470.3172s
	iters: 200, epoch: 11 | loss: 0.2740668
	speed: 0.0116s/iter; left time: 120.6902s
	iters: 300, epoch: 11 | loss: 0.1871632
	speed: 0.0112s/iter; left time: 116.0485s
	iters: 400, epoch: 11 | loss: 0.1969353
	speed: 0.0114s/iter; left time: 117.0927s
	iters: 500, epoch: 11 | loss: 0.4151140
	speed: 0.0114s/iter; left time: 115.2975s
	iters: 600, epoch: 11 | loss: 0.3985980
	speed: 0.0115s/iter; left time: 115.0643s
	iters: 700, epoch: 11 | loss: 0.2966864
	speed: 0.0114s/iter; left time: 112.7361s
	iters: 800, epoch: 11 | loss: 0.4743793
	speed: 0.0104s/iter; left time: 101.8561s
	iters: 900, epoch: 11 | loss: 0.2903376
	speed: 0.0102s/iter; left time: 98.7901s
	iters: 1000, epoch: 11 | loss: 0.2651283
	speed: 0.0102s/iter; left time: 98.0481s
Epoch: 11 cost time: 11.598076343536377
Epoch: 11, Steps: 1063 | Train Loss: 0.2741632 Vali Loss: 0.1995697 Test Loss: 0.3501223
EarlyStopping counter: 3 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.2922084
	speed: 0.0438s/iter; left time: 414.3197s
	iters: 200, epoch: 12 | loss: 0.3240315
	speed: 0.0106s/iter; left time: 99.4251s
	iters: 300, epoch: 12 | loss: 0.9486842
	speed: 0.0107s/iter; left time: 99.3517s
	iters: 400, epoch: 12 | loss: 0.3628350
	speed: 0.0100s/iter; left time: 91.7757s
	iters: 500, epoch: 12 | loss: 0.1677578
	speed: 0.0112s/iter; left time: 101.5017s
	iters: 600, epoch: 12 | loss: 0.4022460
	speed: 0.0111s/iter; left time: 99.9484s
	iters: 700, epoch: 12 | loss: 0.2248317
	speed: 0.0102s/iter; left time: 90.3183s
	iters: 800, epoch: 12 | loss: 0.1914622
	speed: 0.0098s/iter; left time: 86.0168s
	iters: 900, epoch: 12 | loss: 0.2351772
	speed: 0.0098s/iter; left time: 84.7114s
	iters: 1000, epoch: 12 | loss: 0.1051213
	speed: 0.0096s/iter; left time: 81.8521s
Epoch: 12 cost time: 11.012700319290161
Epoch: 12, Steps: 1063 | Train Loss: 0.2739278 Vali Loss: 0.2007707 Test Loss: 0.3528473
EarlyStopping counter: 4 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.2667459
	speed: 0.0449s/iter; left time: 377.5403s
	iters: 200, epoch: 13 | loss: 0.2974887
	speed: 0.0103s/iter; left time: 85.3782s
	iters: 300, epoch: 13 | loss: 0.3471043
	speed: 0.0104s/iter; left time: 85.6002s
	iters: 400, epoch: 13 | loss: 0.4322800
	speed: 0.0101s/iter; left time: 81.9731s
	iters: 500, epoch: 13 | loss: 0.2974303
	speed: 0.0102s/iter; left time: 81.9777s
	iters: 600, epoch: 13 | loss: 0.3631546
	speed: 0.0104s/iter; left time: 81.9336s
	iters: 700, epoch: 13 | loss: 0.1678916
	speed: 0.0112s/iter; left time: 87.5963s
	iters: 800, epoch: 13 | loss: 0.2386199
	speed: 0.0112s/iter; left time: 86.0037s
	iters: 900, epoch: 13 | loss: 0.4250455
	speed: 0.0101s/iter; left time: 76.8148s
	iters: 1000, epoch: 13 | loss: 0.2371152
	speed: 0.0106s/iter; left time: 79.6481s
Epoch: 13 cost time: 11.056331872940063
Epoch: 13, Steps: 1063 | Train Loss: 0.2737888 Vali Loss: 0.1976536 Test Loss: 0.3452771
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTm2_336_192_DLinear_ETTm2_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15726<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
mse:0.27301597595214844, mae:0.33965131640434265
