Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='NLinear', model_id='traffic_336_192', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=192, root_path='./dataset/', save_pred_values=False, seed=12890, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_336_192_NLinear_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed12890>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11753
val 1565
test 3317
	iters: 100, epoch: 1 | loss: 0.8528500
	speed: 0.3165s/iter; left time: 4614.6397s
	iters: 200, epoch: 1 | loss: 0.9085566
	speed: 0.3011s/iter; left time: 4360.1184s
	iters: 300, epoch: 1 | loss: 0.8442547
	speed: 0.3015s/iter; left time: 4336.4877s
	iters: 400, epoch: 1 | loss: 0.8407039
	speed: 0.3012s/iter; left time: 4301.1092s
	iters: 500, epoch: 1 | loss: 1.0374838
	speed: 0.3026s/iter; left time: 4291.6813s
	iters: 600, epoch: 1 | loss: 1.2433487
	speed: 0.3019s/iter; left time: 4251.0902s
	iters: 700, epoch: 1 | loss: 0.9046822
	speed: 0.3023s/iter; left time: 4227.1001s
Epoch: 1 cost time: 223.1865804195404
Epoch: 1, Steps: 734 | Train Loss: 1.1095059 Vali Loss: 1.7688364 Test Loss: 1.9136772
Validation loss decreased (inf --> 1.768836).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 1.3970925
	speed: 0.6072s/iter; left time: 8407.4779s
	iters: 200, epoch: 2 | loss: 1.6251756
	speed: 0.3019s/iter; left time: 4150.4854s
	iters: 300, epoch: 2 | loss: 0.8581306
	speed: 0.3004s/iter; left time: 4099.8461s
	iters: 400, epoch: 2 | loss: 0.9347484
	speed: 0.3015s/iter; left time: 4084.5964s
	iters: 500, epoch: 2 | loss: 1.1022446
	speed: 0.3022s/iter; left time: 4063.5846s
	iters: 600, epoch: 2 | loss: 0.8961788
	speed: 0.3016s/iter; left time: 4025.1346s
	iters: 700, epoch: 2 | loss: 0.8209371
	speed: 0.3022s/iter; left time: 4003.1157s
Epoch: 2 cost time: 221.38753628730774
Epoch: 2, Steps: 734 | Train Loss: 1.1013964 Vali Loss: 1.8592824 Test Loss: 1.6889390
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.3071441
	speed: 0.6073s/iter; left time: 7963.4623s
	iters: 200, epoch: 3 | loss: 0.3476594
	speed: 0.3012s/iter; left time: 3919.2465s
	iters: 300, epoch: 3 | loss: 0.3617041
	speed: 0.3028s/iter; left time: 3909.4894s
	iters: 400, epoch: 3 | loss: 0.3413245
	speed: 0.3026s/iter; left time: 3877.2924s
	iters: 500, epoch: 3 | loss: 0.3881682
	speed: 0.3034s/iter; left time: 3856.7553s
	iters: 600, epoch: 3 | loss: 0.3642226
	speed: 0.3019s/iter; left time: 3808.0648s
	iters: 700, epoch: 3 | loss: 0.3576351
	speed: 0.3019s/iter; left time: 3777.1567s
Epoch: 3 cost time: 221.8142580986023
Epoch: 3, Steps: 734 | Train Loss: 0.3715169 Vali Loss: 0.5350804 Test Loss: 0.6501331
Validation loss decreased (1.768836 --> 0.535080).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.2918572
	speed: 0.6070s/iter; left time: 7514.0611s
	iters: 200, epoch: 4 | loss: 0.2741347
	speed: 0.3019s/iter; left time: 3706.5330s
	iters: 300, epoch: 4 | loss: 0.2813073
	speed: 0.3024s/iter; left time: 3682.4053s
	iters: 400, epoch: 4 | loss: 0.2821939
	speed: 0.3021s/iter; left time: 3649.6075s
	iters: 500, epoch: 4 | loss: 0.2799333
	speed: 0.3027s/iter; left time: 3626.5071s
	iters: 600, epoch: 4 | loss: 0.2770652
	speed: 0.3029s/iter; left time: 3598.2104s
	iters: 700, epoch: 4 | loss: 0.2838285
	speed: 0.3018s/iter; left time: 3554.3840s
Epoch: 4 cost time: 221.7792899608612
Epoch: 4, Steps: 734 | Train Loss: 0.2853672 Vali Loss: 0.4083676 Test Loss: 0.5055954
Validation loss decreased (0.535080 --> 0.408368).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.3128823
	speed: 0.6092s/iter; left time: 7093.9191s
	iters: 200, epoch: 5 | loss: 0.2663850
	speed: 0.3043s/iter; left time: 3513.7059s
	iters: 300, epoch: 5 | loss: 0.2697318
	speed: 0.3010s/iter; left time: 3445.5169s
	iters: 400, epoch: 5 | loss: 0.2932062
	speed: 0.3015s/iter; left time: 3420.4466s
	iters: 500, epoch: 5 | loss: 0.2789440
	speed: 0.3026s/iter; left time: 3402.3954s
	iters: 600, epoch: 5 | loss: 0.2556669
	speed: 0.3023s/iter; left time: 3368.6483s
	iters: 700, epoch: 5 | loss: 0.2603871
	speed: 0.3024s/iter; left time: 3339.6055s
Epoch: 5 cost time: 221.96448397636414
Epoch: 5, Steps: 734 | Train Loss: 0.2647787 Vali Loss: 0.3743929 Test Loss: 0.4646275
Validation loss decreased (0.408368 --> 0.374393).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.2329261
	speed: 0.6057s/iter; left time: 6608.9974s
	iters: 200, epoch: 6 | loss: 0.2547102
	speed: 0.3013s/iter; left time: 3256.8696s
	iters: 300, epoch: 6 | loss: 0.2972128
	speed: 0.3017s/iter; left time: 3231.2439s
	iters: 400, epoch: 6 | loss: 0.2548102
	speed: 0.3010s/iter; left time: 3193.9523s
	iters: 500, epoch: 6 | loss: 0.2602383
	speed: 0.3021s/iter; left time: 3175.7154s
	iters: 600, epoch: 6 | loss: 0.2628506
	speed: 0.3024s/iter; left time: 3148.2568s
	iters: 700, epoch: 6 | loss: 0.2457598
	speed: 0.3024s/iter; left time: 3117.9791s
Epoch: 6 cost time: 221.41045761108398
Epoch: 6, Steps: 734 | Train Loss: 0.2545276 Vali Loss: 0.3623830 Test Loss: 0.4510823
Validation loss decreased (0.374393 --> 0.362383).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.2300048
	speed: 0.6079s/iter; left time: 6186.1095s
	iters: 200, epoch: 7 | loss: 0.2556565
	speed: 0.3030s/iter; left time: 3053.0117s
	iters: 300, epoch: 7 | loss: 0.2691657
	speed: 0.3026s/iter; left time: 3019.0781s
	iters: 400, epoch: 7 | loss: 0.2199979
	speed: 0.3025s/iter; left time: 2987.4337s
	iters: 500, epoch: 7 | loss: 0.2303315
	speed: 0.3022s/iter; left time: 2954.3518s
	iters: 600, epoch: 7 | loss: 0.2233020
	speed: 0.3008s/iter; left time: 2911.0702s
	iters: 700, epoch: 7 | loss: 0.2605846
	speed: 0.3018s/iter; left time: 2890.1885s
Epoch: 7 cost time: 221.8000066280365
Epoch: 7, Steps: 734 | Train Loss: 0.2491443 Vali Loss: 0.3572564 Test Loss: 0.4454308
Validation loss decreased (0.362383 --> 0.357256).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.2450044
	speed: 0.6074s/iter; left time: 5735.4474s
	iters: 200, epoch: 8 | loss: 0.2592551
	speed: 0.3023s/iter; left time: 2824.4482s
	iters: 300, epoch: 8 | loss: 0.2333476
	speed: 0.3020s/iter; left time: 2791.1530s
	iters: 400, epoch: 8 | loss: 0.2635447
	speed: 0.3010s/iter; left time: 2752.0953s
	iters: 500, epoch: 8 | loss: 0.2813804
	speed: 0.3016s/iter; left time: 2727.7358s
	iters: 600, epoch: 8 | loss: 0.2563630
	speed: 0.3022s/iter; left time: 2702.7976s
	iters: 700, epoch: 8 | loss: 0.2802902
	speed: 0.3011s/iter; left time: 2662.5222s
Epoch: 8 cost time: 221.4477882385254
Epoch: 8, Steps: 734 | Train Loss: 0.2457665 Vali Loss: 0.3539745 Test Loss: 0.4413964
Validation loss decreased (0.357256 --> 0.353975).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.2273437
	speed: 0.6057s/iter; left time: 5275.2911s
	iters: 200, epoch: 9 | loss: 0.2314343
	speed: 0.3012s/iter; left time: 2593.3379s
	iters: 300, epoch: 9 | loss: 0.2630472
	speed: 0.3021s/iter; left time: 2570.8796s
	iters: 400, epoch: 9 | loss: 0.2514955
	speed: 0.3015s/iter; left time: 2535.5073s
	iters: 500, epoch: 9 | loss: 0.2619697
	speed: 0.3014s/iter; left time: 2504.2496s
	iters: 600, epoch: 9 | loss: 0.2341750
	speed: 0.3032s/iter; left time: 2488.5923s
	iters: 700, epoch: 9 | loss: 0.2504809
	speed: 0.3020s/iter; left time: 2449.2609s
Epoch: 9 cost time: 221.58017444610596
Epoch: 9, Steps: 734 | Train Loss: 0.2438432 Vali Loss: 0.3515011 Test Loss: 0.4385728
Validation loss decreased (0.353975 --> 0.351501).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.2339063
	speed: 0.6086s/iter; left time: 4853.5502s
	iters: 200, epoch: 10 | loss: 0.2410262
	speed: 0.3015s/iter; left time: 2374.4484s
	iters: 300, epoch: 10 | loss: 0.2349750
	speed: 0.3019s/iter; left time: 2347.5955s
	iters: 400, epoch: 10 | loss: 0.2264986
	speed: 0.3046s/iter; left time: 2337.6741s
	iters: 500, epoch: 10 | loss: 0.2680335
	speed: 0.3086s/iter; left time: 2337.7089s
	iters: 600, epoch: 10 | loss: 0.2164651
	speed: 0.3026s/iter; left time: 2261.9875s
	iters: 700, epoch: 10 | loss: 0.2416562
	speed: 0.3023s/iter; left time: 2229.6750s
Epoch: 10 cost time: 222.71883630752563
Epoch: 10, Steps: 734 | Train Loss: 0.2427497 Vali Loss: 0.3510323 Test Loss: 0.4377235
Validation loss decreased (0.351501 --> 0.351032).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.2457073
	speed: 0.6082s/iter; left time: 4404.1481s
	iters: 200, epoch: 11 | loss: 0.2297329
	speed: 0.3017s/iter; left time: 2154.7546s
	iters: 300, epoch: 11 | loss: 0.2422736
	speed: 0.3035s/iter; left time: 2136.7140s
	iters: 400, epoch: 11 | loss: 0.2589121
	speed: 0.3033s/iter; left time: 2105.4823s
	iters: 500, epoch: 11 | loss: 0.2378694
	speed: 0.3018s/iter; left time: 2064.7662s
	iters: 600, epoch: 11 | loss: 0.2281737
	speed: 0.3025s/iter; left time: 2038.9010s
	iters: 700, epoch: 11 | loss: 0.2251609
	speed: 0.3037s/iter; left time: 2016.7762s
Epoch: 11 cost time: 222.18308544158936
Epoch: 11, Steps: 734 | Train Loss: 0.2421409 Vali Loss: 0.3501652 Test Loss: 0.4371184
Validation loss decreased (0.351032 --> 0.350165).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.2327989
	speed: 0.6095s/iter; left time: 3966.0571s
	iters: 200, epoch: 12 | loss: 0.2265987
	speed: 0.3032s/iter; left time: 1942.9048s
	iters: 300, epoch: 12 | loss: 0.2331630
	speed: 0.3023s/iter; left time: 1906.4909s
	iters: 400, epoch: 12 | loss: 0.2109081
	speed: 0.3022s/iter; left time: 1875.6282s
	iters: 500, epoch: 12 | loss: 0.2270161
	speed: 0.3034s/iter; left time: 1852.6672s
	iters: 600, epoch: 12 | loss: 0.2565364
	speed: 0.3033s/iter; left time: 1822.0619s
	iters: 700, epoch: 12 | loss: 0.2389883
	speed: 0.3026s/iter; left time: 1787.6025s
Epoch: 12 cost time: 222.32170224189758
Epoch: 12, Steps: 734 | Train Loss: 0.2418150 Vali Loss: 0.3497614 Test Loss: 0.4368421
Validation loss decreased (0.350165 --> 0.349761).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.2266448
	speed: 0.6091s/iter; left time: 3516.4750s
	iters: 200, epoch: 13 | loss: 0.2462375
	speed: 0.3026s/iter; left time: 1716.8127s
	iters: 300, epoch: 13 | loss: 0.2623043
	speed: 0.3018s/iter; left time: 1681.6731s
	iters: 400, epoch: 13 | loss: 0.2568037
	speed: 0.3022s/iter; left time: 1653.6897s
	iters: 500, epoch: 13 | loss: 0.2720015
	speed: 0.3022s/iter; left time: 1623.6591s
	iters: 600, epoch: 13 | loss: 0.2910093
	speed: 0.3026s/iter; left time: 1595.3928s
	iters: 700, epoch: 13 | loss: 0.2372905
	speed: 0.3011s/iter; left time: 1557.6598s
Epoch: 13 cost time: 221.777893781662
Epoch: 13, Steps: 734 | Train Loss: 0.2416223 Vali Loss: 0.3496737 Test Loss: 0.4366691
Validation loss decreased (0.349761 --> 0.349674).  Saving model ...
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 14 | loss: 0.2158382
	speed: 0.6081s/iter; left time: 3064.0190s
	iters: 200, epoch: 14 | loss: 0.2407476
	speed: 0.3026s/iter; left time: 1494.5933s
	iters: 300, epoch: 14 | loss: 0.2530772
	speed: 0.3028s/iter; left time: 1465.3493s
	iters: 400, epoch: 14 | loss: 0.2400593
	speed: 0.3012s/iter; left time: 1427.1708s
	iters: 500, epoch: 14 | loss: 0.2553641
	speed: 0.3027s/iter; left time: 1404.0396s
	iters: 600, epoch: 14 | loss: 0.2394001
	speed: 0.3041s/iter; left time: 1380.1701s
	iters: 700, epoch: 14 | loss: 0.2581055
	speed: 0.3034s/iter; left time: 1346.9413s
Epoch: 14 cost time: 222.27668523788452
Epoch: 14, Steps: 734 | Train Loss: 0.2415095 Vali Loss: 0.3499424 Test Loss: 0.4366257
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 15 | loss: 0.2450651
	speed: 0.6072s/iter; left time: 2613.8465s
	iters: 200, epoch: 15 | loss: 0.2245771
	speed: 0.3016s/iter; left time: 1268.2239s
	iters: 300, epoch: 15 | loss: 0.2514663
	speed: 0.3017s/iter; left time: 1238.5425s
	iters: 400, epoch: 15 | loss: 0.2211649
	speed: 0.3024s/iter; left time: 1210.9357s
	iters: 500, epoch: 15 | loss: 0.2499697
	speed: 0.3022s/iter; left time: 1180.0936s
	iters: 600, epoch: 15 | loss: 0.2351587
	speed: 0.3029s/iter; left time: 1152.3610s
	iters: 700, epoch: 15 | loss: 0.2538867
	speed: 0.3028s/iter; left time: 1122.0293s
Epoch: 15 cost time: 221.86701464653015
Epoch: 15, Steps: 734 | Train Loss: 0.2414925 Vali Loss: 0.3496340 Test Loss: 0.4365726
Validation loss decreased (0.349674 --> 0.349634).  Saving model ...
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 16 | loss: 0.2438362
	speed: 0.6089s/iter; left time: 2174.4827s
	iters: 200, epoch: 16 | loss: 0.2314313
	speed: 0.3031s/iter; left time: 1052.2314s
	iters: 300, epoch: 16 | loss: 0.2374844
	speed: 0.3031s/iter; left time: 1021.5827s
	iters: 400, epoch: 16 | loss: 0.2578039
	speed: 0.3025s/iter; left time: 989.5355s
	iters: 500, epoch: 16 | loss: 0.2337232
	speed: 0.3004s/iter; left time: 952.5209s
	iters: 600, epoch: 16 | loss: 0.2397535
	speed: 0.3016s/iter; left time: 926.2356s
	iters: 700, epoch: 16 | loss: 0.2398241
	speed: 0.3018s/iter; left time: 896.5230s
Epoch: 16 cost time: 221.8184459209442
Epoch: 16, Steps: 734 | Train Loss: 0.2414280 Vali Loss: 0.3498384 Test Loss: 0.4365728
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 17 | loss: 0.2626647
	speed: 0.6068s/iter; left time: 1721.4323s
	iters: 200, epoch: 17 | loss: 0.2523437
	speed: 0.3026s/iter; left time: 828.1125s
	iters: 300, epoch: 17 | loss: 0.2310311
	speed: 0.3019s/iter; left time: 796.0401s
	iters: 400, epoch: 17 | loss: 0.2563333
	speed: 0.3025s/iter; left time: 767.3792s
	iters: 500, epoch: 17 | loss: 0.2331690
	speed: 0.3015s/iter; left time: 734.7285s
	iters: 600, epoch: 17 | loss: 0.2236109
	speed: 0.3023s/iter; left time: 706.4053s
	iters: 700, epoch: 17 | loss: 0.2280126
	speed: 0.3023s/iter; left time: 676.1398s
Epoch: 17 cost time: 221.7839696407318
Epoch: 17, Steps: 734 | Train Loss: 0.2414265 Vali Loss: 0.3494899 Test Loss: 0.4365692
Validation loss decreased (0.349634 --> 0.349490).  Saving model ...
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 18 | loss: 0.2397436
	speed: 0.6080s/iter; left time: 1278.5839s
	iters: 200, epoch: 18 | loss: 0.2662277
	speed: 0.3022s/iter; left time: 605.3557s
	iters: 300, epoch: 18 | loss: 0.2467933
	speed: 0.3022s/iter; left time: 575.0949s
	iters: 400, epoch: 18 | loss: 0.2355602
	speed: 0.3031s/iter; left time: 546.4456s
	iters: 500, epoch: 18 | loss: 0.2250269
	speed: 0.3031s/iter; left time: 516.2269s
	iters: 600, epoch: 18 | loss: 0.2511709
	speed: 0.3024s/iter; left time: 484.7324s
	iters: 700, epoch: 18 | loss: 0.2450677
	speed: 0.3023s/iter; left time: 454.3884s
Epoch: 18 cost time: 222.01576280593872
Epoch: 18, Steps: 734 | Train Loss: 0.2414066 Vali Loss: 0.3497176 Test Loss: 0.4365708
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 19 | loss: 0.2207772
	speed: 0.6052s/iter; left time: 828.5402s
	iters: 200, epoch: 19 | loss: 0.2213701
	speed: 0.3022s/iter; left time: 383.5152s
	iters: 300, epoch: 19 | loss: 0.2409306
	speed: 0.3016s/iter; left time: 352.5541s
	iters: 400, epoch: 19 | loss: 0.2352551
	speed: 0.3027s/iter; left time: 323.6004s
	iters: 500, epoch: 19 | loss: 0.2435924
	speed: 0.3020s/iter; left time: 292.6464s
	iters: 600, epoch: 19 | loss: 0.2236522
	speed: 0.3024s/iter; left time: 262.7458s
	iters: 700, epoch: 19 | loss: 0.2524561
	speed: 0.3017s/iter; left time: 232.0338s
Epoch: 19 cost time: 221.79796957969666
Epoch: 19, Steps: 734 | Train Loss: 0.2414201 Vali Loss: 0.3495110 Test Loss: 0.4365700
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 20 | loss: 0.2298962
	speed: 0.6057s/iter; left time: 384.6220s
	iters: 200, epoch: 20 | loss: 0.2420148
	speed: 0.3023s/iter; left time: 161.7290s
	iters: 300, epoch: 20 | loss: 0.2091218
	speed: 0.3021s/iter; left time: 131.3975s
	iters: 400, epoch: 20 | loss: 0.2683512
	speed: 0.3030s/iter; left time: 101.5156s
	iters: 500, epoch: 20 | loss: 0.2323331
	speed: 0.3031s/iter; left time: 71.2187s
	iters: 600, epoch: 20 | loss: 0.2364500
	speed: 0.3033s/iter; left time: 40.9479s
	iters: 700, epoch: 20 | loss: 0.2091982
	speed: 0.3032s/iter; left time: 10.6120s
Epoch: 20 cost time: 222.2923424243927
Epoch: 20, Steps: 734 | Train Loss: 0.2414329 Vali Loss: 0.3495222 Test Loss: 0.4365700
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.9073486328125e-08
>>>>>>>testing : traffic_336_192_NLinear_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed12890<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3317
mse:0.43621981143951416, mae:0.2991597354412079
