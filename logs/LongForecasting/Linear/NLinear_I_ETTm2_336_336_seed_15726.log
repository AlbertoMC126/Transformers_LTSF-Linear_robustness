Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='NLinear', model_id='ETTm2_336_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=336, root_path='./dataset/', save_pred_values=False, seed=15726, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTm2_336_336_NLinear_ETTm2_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15726>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33889
val 11185
test 11185
	iters: 100, epoch: 1 | loss: 0.6127272
	speed: 0.0090s/iter; left time: 190.6193s
	iters: 200, epoch: 1 | loss: 0.4429435
	speed: 0.0088s/iter; left time: 184.6123s
	iters: 300, epoch: 1 | loss: 0.3437525
	speed: 0.0086s/iter; left time: 179.6553s
	iters: 400, epoch: 1 | loss: 0.7715016
	speed: 0.0088s/iter; left time: 182.0836s
	iters: 500, epoch: 1 | loss: 0.5384905
	speed: 0.0098s/iter; left time: 201.6906s
	iters: 600, epoch: 1 | loss: 0.6427278
	speed: 0.0101s/iter; left time: 207.8117s
	iters: 700, epoch: 1 | loss: 0.6727310
	speed: 0.0102s/iter; left time: 208.3481s
	iters: 800, epoch: 1 | loss: 0.9821289
	speed: 0.0102s/iter; left time: 207.2312s
	iters: 900, epoch: 1 | loss: 0.4561951
	speed: 0.0094s/iter; left time: 191.2949s
	iters: 1000, epoch: 1 | loss: 0.2934243
	speed: 0.0090s/iter; left time: 180.6708s
Epoch: 1 cost time: 9.813259601593018
Epoch: 1, Steps: 1059 | Train Loss: 0.6868781 Vali Loss: 0.3385418 Test Loss: 0.4564925
Validation loss decreased (inf --> 0.338542).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.4063126
	speed: 0.0329s/iter; left time: 658.4523s
	iters: 200, epoch: 2 | loss: 0.9440169
	speed: 0.0089s/iter; left time: 176.7510s
	iters: 300, epoch: 2 | loss: 0.7017527
	speed: 0.0091s/iter; left time: 180.8243s
	iters: 400, epoch: 2 | loss: 0.4345636
	speed: 0.0091s/iter; left time: 178.5590s
	iters: 500, epoch: 2 | loss: 0.9034553
	speed: 0.0088s/iter; left time: 172.7143s
	iters: 600, epoch: 2 | loss: 0.3790896
	speed: 0.0086s/iter; left time: 167.9300s
	iters: 700, epoch: 2 | loss: 0.3056380
	speed: 0.0091s/iter; left time: 176.7743s
	iters: 800, epoch: 2 | loss: 0.4726340
	speed: 0.0083s/iter; left time: 160.6232s
	iters: 900, epoch: 2 | loss: 2.0600722
	speed: 0.0085s/iter; left time: 163.7558s
	iters: 1000, epoch: 2 | loss: 1.6339256
	speed: 0.0080s/iter; left time: 152.1614s
Epoch: 2 cost time: 9.068556547164917
Epoch: 2, Steps: 1059 | Train Loss: 0.7627462 Vali Loss: 0.2571847 Test Loss: 0.3691018
Validation loss decreased (0.338542 --> 0.257185).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.3051012
	speed: 0.0359s/iter; left time: 681.4517s
	iters: 200, epoch: 3 | loss: 0.4776092
	speed: 0.0077s/iter; left time: 145.2606s
	iters: 300, epoch: 3 | loss: 0.6240967
	speed: 0.0071s/iter; left time: 132.8417s
	iters: 400, epoch: 3 | loss: 0.4661023
	speed: 0.0074s/iter; left time: 138.5573s
	iters: 500, epoch: 3 | loss: 0.4298957
	speed: 0.0081s/iter; left time: 150.0342s
	iters: 600, epoch: 3 | loss: 0.3446828
	speed: 0.0086s/iter; left time: 159.0123s
	iters: 700, epoch: 3 | loss: 0.4719382
	speed: 0.0084s/iter; left time: 155.0316s
	iters: 800, epoch: 3 | loss: 0.4199163
	speed: 0.0084s/iter; left time: 152.8609s
	iters: 900, epoch: 3 | loss: 0.4424339
	speed: 0.0083s/iter; left time: 151.2365s
	iters: 1000, epoch: 3 | loss: 0.3541389
	speed: 0.0081s/iter; left time: 146.3445s
Epoch: 3 cost time: 8.527527570724487
Epoch: 3, Steps: 1059 | Train Loss: 0.4704121 Vali Loss: 0.2299062 Test Loss: 0.3155005
Validation loss decreased (0.257185 --> 0.229906).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.2087521
	speed: 0.0333s/iter; left time: 595.4202s
	iters: 200, epoch: 4 | loss: 0.2748209
	speed: 0.0101s/iter; left time: 179.8584s
	iters: 300, epoch: 4 | loss: 0.2175908
	speed: 0.0098s/iter; left time: 174.0730s
	iters: 400, epoch: 4 | loss: 0.2127756
	speed: 0.0094s/iter; left time: 165.5153s
	iters: 500, epoch: 4 | loss: 0.3993885
	speed: 0.0095s/iter; left time: 166.1506s
	iters: 600, epoch: 4 | loss: 0.9227490
	speed: 0.0081s/iter; left time: 141.7053s
	iters: 700, epoch: 4 | loss: 0.2561914
	speed: 0.0084s/iter; left time: 145.2116s
	iters: 800, epoch: 4 | loss: 0.4131235
	speed: 0.0090s/iter; left time: 155.3743s
	iters: 900, epoch: 4 | loss: 0.3377610
	speed: 0.0082s/iter; left time: 140.8190s
	iters: 1000, epoch: 4 | loss: 0.3030315
	speed: 0.0080s/iter; left time: 136.6971s
Epoch: 4 cost time: 9.421281814575195
Epoch: 4, Steps: 1059 | Train Loss: 0.4210806 Vali Loss: 0.2165269 Test Loss: 0.2947767
Validation loss decreased (0.229906 --> 0.216527).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.4411926
	speed: 0.0350s/iter; left time: 589.2009s
	iters: 200, epoch: 5 | loss: 0.6037301
	speed: 0.0085s/iter; left time: 142.8791s
	iters: 300, epoch: 5 | loss: 0.3435287
	speed: 0.0085s/iter; left time: 141.5150s
	iters: 400, epoch: 5 | loss: 0.4523080
	speed: 0.0096s/iter; left time: 159.0615s
	iters: 500, epoch: 5 | loss: 0.4364177
	speed: 0.0079s/iter; left time: 130.2296s
	iters: 600, epoch: 5 | loss: 0.1924315
	speed: 0.0077s/iter; left time: 125.6467s
	iters: 700, epoch: 5 | loss: 0.2898123
	speed: 0.0079s/iter; left time: 128.3681s
	iters: 800, epoch: 5 | loss: 0.6463815
	speed: 0.0083s/iter; left time: 133.2300s
	iters: 900, epoch: 5 | loss: 0.3608617
	speed: 0.0084s/iter; left time: 134.6587s
	iters: 1000, epoch: 5 | loss: 0.9561055
	speed: 0.0083s/iter; left time: 133.1210s
Epoch: 5 cost time: 8.853570461273193
Epoch: 5, Steps: 1059 | Train Loss: 0.4010196 Vali Loss: 0.2042879 Test Loss: 0.2789474
Validation loss decreased (0.216527 --> 0.204288).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.4353028
	speed: 0.0376s/iter; left time: 593.9001s
	iters: 200, epoch: 6 | loss: 0.3257923
	speed: 0.0099s/iter; left time: 155.2039s
	iters: 300, epoch: 6 | loss: 0.3917914
	speed: 0.0084s/iter; left time: 131.5992s
	iters: 400, epoch: 6 | loss: 0.2559822
	speed: 0.0085s/iter; left time: 131.1880s
	iters: 500, epoch: 6 | loss: 0.2982523
	speed: 0.0085s/iter; left time: 130.5709s
	iters: 600, epoch: 6 | loss: 0.5615110
	speed: 0.0095s/iter; left time: 144.9371s
	iters: 700, epoch: 6 | loss: 0.5567080
	speed: 0.0102s/iter; left time: 154.9283s
	iters: 800, epoch: 6 | loss: 0.2629651
	speed: 0.0087s/iter; left time: 130.6987s
	iters: 900, epoch: 6 | loss: 0.4605879
	speed: 0.0087s/iter; left time: 130.9705s
	iters: 1000, epoch: 6 | loss: 0.3751241
	speed: 0.0074s/iter; left time: 109.8069s
Epoch: 6 cost time: 9.359273910522461
Epoch: 6, Steps: 1059 | Train Loss: 0.3899992 Vali Loss: 0.2041501 Test Loss: 0.2774827
Validation loss decreased (0.204288 --> 0.204150).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.2469779
	speed: 0.0338s/iter; left time: 497.5809s
	iters: 200, epoch: 7 | loss: 0.3438621
	speed: 0.0082s/iter; left time: 119.9235s
	iters: 300, epoch: 7 | loss: 0.2906942
	speed: 0.0076s/iter; left time: 110.6252s
	iters: 400, epoch: 7 | loss: 0.2977129
	speed: 0.0080s/iter; left time: 114.8659s
	iters: 500, epoch: 7 | loss: 0.5934694
	speed: 0.0071s/iter; left time: 102.0445s
	iters: 600, epoch: 7 | loss: 0.2204950
	speed: 0.0091s/iter; left time: 129.1983s
	iters: 700, epoch: 7 | loss: 0.1945110
	speed: 0.0070s/iter; left time: 98.3238s
	iters: 800, epoch: 7 | loss: 0.3636463
	speed: 0.0071s/iter; left time: 99.4611s
	iters: 900, epoch: 7 | loss: 0.2479237
	speed: 0.0078s/iter; left time: 108.6448s
	iters: 1000, epoch: 7 | loss: 0.3669502
	speed: 0.0091s/iter; left time: 125.9540s
Epoch: 7 cost time: 8.430022716522217
Epoch: 7, Steps: 1059 | Train Loss: 0.3842107 Vali Loss: 0.1991610 Test Loss: 0.2754183
Validation loss decreased (0.204150 --> 0.199161).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.4271459
	speed: 0.0330s/iter; left time: 451.6380s
	iters: 200, epoch: 8 | loss: 0.2796386
	speed: 0.0090s/iter; left time: 122.2791s
	iters: 300, epoch: 8 | loss: 0.2150319
	speed: 0.0085s/iter; left time: 114.3708s
	iters: 400, epoch: 8 | loss: 0.5066296
	speed: 0.0092s/iter; left time: 123.1639s
	iters: 500, epoch: 8 | loss: 0.2892944
	speed: 0.0085s/iter; left time: 112.7781s
	iters: 600, epoch: 8 | loss: 0.3436372
	speed: 0.0076s/iter; left time: 99.4359s
	iters: 700, epoch: 8 | loss: 0.3124052
	speed: 0.0085s/iter; left time: 111.2463s
	iters: 800, epoch: 8 | loss: 0.6239851
	speed: 0.0090s/iter; left time: 117.1310s
	iters: 900, epoch: 8 | loss: 0.3542974
	speed: 0.0090s/iter; left time: 116.4076s
	iters: 1000, epoch: 8 | loss: 0.4297687
	speed: 0.0080s/iter; left time: 102.1666s
Epoch: 8 cost time: 9.044206380844116
Epoch: 8, Steps: 1059 | Train Loss: 0.3803392 Vali Loss: 0.2007201 Test Loss: 0.2779185
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.2758051
	speed: 0.0388s/iter; left time: 488.9297s
	iters: 200, epoch: 9 | loss: 0.2757465
	speed: 0.0072s/iter; left time: 89.5081s
	iters: 300, epoch: 9 | loss: 0.2371309
	speed: 0.0079s/iter; left time: 97.4364s
	iters: 400, epoch: 9 | loss: 0.5935838
	speed: 0.0080s/iter; left time: 98.3707s
	iters: 500, epoch: 9 | loss: 0.8500877
	speed: 0.0076s/iter; left time: 93.0654s
	iters: 600, epoch: 9 | loss: 0.2043760
	speed: 0.0092s/iter; left time: 111.3038s
	iters: 700, epoch: 9 | loss: 0.8553605
	speed: 0.0081s/iter; left time: 96.9177s
	iters: 800, epoch: 9 | loss: 0.2684227
	speed: 0.0084s/iter; left time: 99.8450s
	iters: 900, epoch: 9 | loss: 0.1974253
	speed: 0.0087s/iter; left time: 102.9929s
	iters: 1000, epoch: 9 | loss: 0.3296369
	speed: 0.0076s/iter; left time: 88.4282s
Epoch: 9 cost time: 8.574403285980225
Epoch: 9, Steps: 1059 | Train Loss: 0.3788192 Vali Loss: 0.1988660 Test Loss: 0.2731233
Validation loss decreased (0.199161 --> 0.198866).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.7524638
	speed: 0.0359s/iter; left time: 415.1707s
	iters: 200, epoch: 10 | loss: 0.3545843
	speed: 0.0088s/iter; left time: 100.7749s
	iters: 300, epoch: 10 | loss: 0.1964474
	speed: 0.0084s/iter; left time: 95.2638s
	iters: 400, epoch: 10 | loss: 0.3554869
	speed: 0.0069s/iter; left time: 77.7581s
	iters: 500, epoch: 10 | loss: 0.3073598
	speed: 0.0077s/iter; left time: 85.3395s
	iters: 600, epoch: 10 | loss: 0.5362872
	speed: 0.0090s/iter; left time: 99.1122s
	iters: 700, epoch: 10 | loss: 0.2183486
	speed: 0.0102s/iter; left time: 112.0366s
	iters: 800, epoch: 10 | loss: 0.7337403
	speed: 0.0099s/iter; left time: 107.5344s
	iters: 900, epoch: 10 | loss: 0.2015620
	speed: 0.0090s/iter; left time: 97.2038s
	iters: 1000, epoch: 10 | loss: 0.3244073
	speed: 0.0096s/iter; left time: 102.1377s
Epoch: 10 cost time: 9.300797939300537
Epoch: 10, Steps: 1059 | Train Loss: 0.3778427 Vali Loss: 0.1986883 Test Loss: 0.2731931
Validation loss decreased (0.198866 --> 0.198688).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.1986080
	speed: 0.0374s/iter; left time: 391.9388s
	iters: 200, epoch: 11 | loss: 0.4882213
	speed: 0.0087s/iter; left time: 90.3219s
	iters: 300, epoch: 11 | loss: 0.2884073
	speed: 0.0084s/iter; left time: 86.4597s
	iters: 400, epoch: 11 | loss: 0.1908688
	speed: 0.0087s/iter; left time: 88.7981s
	iters: 500, epoch: 11 | loss: 0.3059072
	speed: 0.0089s/iter; left time: 90.1366s
	iters: 600, epoch: 11 | loss: 0.3041049
	speed: 0.0072s/iter; left time: 72.0290s
	iters: 700, epoch: 11 | loss: 0.2430951
	speed: 0.0094s/iter; left time: 93.3928s
	iters: 800, epoch: 11 | loss: 0.4468342
	speed: 0.0088s/iter; left time: 86.4753s
	iters: 900, epoch: 11 | loss: 0.5313001
	speed: 0.0082s/iter; left time: 78.9984s
	iters: 1000, epoch: 11 | loss: 0.4125395
	speed: 0.0086s/iter; left time: 82.8399s
Epoch: 11 cost time: 9.124234199523926
Epoch: 11, Steps: 1059 | Train Loss: 0.3772283 Vali Loss: 0.1995681 Test Loss: 0.2734371
EarlyStopping counter: 1 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.4174293
	speed: 0.0361s/iter; left time: 340.6161s
	iters: 200, epoch: 12 | loss: 0.2502352
	speed: 0.0084s/iter; left time: 78.1616s
	iters: 300, epoch: 12 | loss: 0.2914835
	speed: 0.0088s/iter; left time: 81.6463s
	iters: 400, epoch: 12 | loss: 0.3265887
	speed: 0.0097s/iter; left time: 88.4074s
	iters: 500, epoch: 12 | loss: 0.2157362
	speed: 0.0094s/iter; left time: 84.4650s
	iters: 600, epoch: 12 | loss: 0.2895246
	speed: 0.0090s/iter; left time: 80.4079s
	iters: 700, epoch: 12 | loss: 0.2655362
	speed: 0.0088s/iter; left time: 78.0072s
	iters: 800, epoch: 12 | loss: 0.3427885
	speed: 0.0092s/iter; left time: 80.3931s
	iters: 900, epoch: 12 | loss: 0.2553254
	speed: 0.0088s/iter; left time: 75.6594s
	iters: 1000, epoch: 12 | loss: 0.3295280
	speed: 0.0094s/iter; left time: 80.1213s
Epoch: 12 cost time: 9.449968576431274
Epoch: 12, Steps: 1059 | Train Loss: 0.3770254 Vali Loss: 0.1984295 Test Loss: 0.2729702
Validation loss decreased (0.198688 --> 0.198429).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.3547181
	speed: 0.0349s/iter; left time: 292.5204s
	iters: 200, epoch: 13 | loss: 0.5148992
	speed: 0.0082s/iter; left time: 67.8610s
	iters: 300, epoch: 13 | loss: 0.2487522
	speed: 0.0078s/iter; left time: 63.5180s
	iters: 400, epoch: 13 | loss: 0.2270939
	speed: 0.0092s/iter; left time: 74.5295s
	iters: 500, epoch: 13 | loss: 0.5470699
	speed: 0.0078s/iter; left time: 62.1774s
	iters: 600, epoch: 13 | loss: 0.7788460
	speed: 0.0082s/iter; left time: 64.7218s
	iters: 700, epoch: 13 | loss: 0.5382687
	speed: 0.0088s/iter; left time: 68.1087s
	iters: 800, epoch: 13 | loss: 0.1727632
	speed: 0.0092s/iter; left time: 70.2147s
	iters: 900, epoch: 13 | loss: 0.7429191
	speed: 0.0086s/iter; left time: 64.9251s
	iters: 1000, epoch: 13 | loss: 0.3025096
	speed: 0.0081s/iter; left time: 60.8391s
Epoch: 13 cost time: 8.991249322891235
Epoch: 13, Steps: 1059 | Train Loss: 0.3768094 Vali Loss: 0.1985611 Test Loss: 0.2729528
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 14 | loss: 0.3718512
	speed: 0.0376s/iter; left time: 274.9032s
	iters: 200, epoch: 14 | loss: 0.3732507
	speed: 0.0081s/iter; left time: 58.2329s
	iters: 300, epoch: 14 | loss: 0.7080991
	speed: 0.0088s/iter; left time: 62.6881s
	iters: 400, epoch: 14 | loss: 0.2059236
	speed: 0.0095s/iter; left time: 66.7807s
	iters: 500, epoch: 14 | loss: 0.2507583
	speed: 0.0095s/iter; left time: 65.6423s
	iters: 600, epoch: 14 | loss: 0.3154287
	speed: 0.0085s/iter; left time: 57.8668s
	iters: 700, epoch: 14 | loss: 0.4040161
	speed: 0.0064s/iter; left time: 43.0946s
	iters: 800, epoch: 14 | loss: 0.3035439
	speed: 0.0092s/iter; left time: 60.8658s
	iters: 900, epoch: 14 | loss: 0.2456817
	speed: 0.0086s/iter; left time: 56.1033s
	iters: 1000, epoch: 14 | loss: 0.2932518
	speed: 0.0084s/iter; left time: 53.6988s
Epoch: 14 cost time: 8.894676208496094
Epoch: 14, Steps: 1059 | Train Loss: 0.3767428 Vali Loss: 0.1984621 Test Loss: 0.2729110
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 15 | loss: 0.2682991
	speed: 0.0329s/iter; left time: 205.5689s
	iters: 200, epoch: 15 | loss: 0.8421916
	speed: 0.0086s/iter; left time: 53.1263s
	iters: 300, epoch: 15 | loss: 0.2229998
	speed: 0.0079s/iter; left time: 48.0299s
	iters: 400, epoch: 15 | loss: 0.3014487
	speed: 0.0082s/iter; left time: 48.6249s
	iters: 500, epoch: 15 | loss: 0.3483480
	speed: 0.0080s/iter; left time: 47.0292s
	iters: 600, epoch: 15 | loss: 0.4752185
	speed: 0.0080s/iter; left time: 45.8608s
	iters: 700, epoch: 15 | loss: 0.5606907
	speed: 0.0078s/iter; left time: 44.0672s
	iters: 800, epoch: 15 | loss: 0.1997740
	speed: 0.0080s/iter; left time: 44.3749s
	iters: 900, epoch: 15 | loss: 0.2872654
	speed: 0.0080s/iter; left time: 43.6468s
	iters: 1000, epoch: 15 | loss: 0.3223598
	speed: 0.0079s/iter; left time: 42.4826s
Epoch: 15 cost time: 8.556374788284302
Epoch: 15, Steps: 1059 | Train Loss: 0.3767083 Vali Loss: 0.1984593 Test Loss: 0.2728982
EarlyStopping counter: 3 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 16 | loss: 0.4141323
	speed: 0.0326s/iter; left time: 169.5406s
	iters: 200, epoch: 16 | loss: 0.3974223
	speed: 0.0078s/iter; left time: 39.6071s
	iters: 300, epoch: 16 | loss: 0.3600395
	speed: 0.0081s/iter; left time: 40.4611s
	iters: 400, epoch: 16 | loss: 0.3381822
	speed: 0.0080s/iter; left time: 39.0722s
	iters: 500, epoch: 16 | loss: 0.2706688
	speed: 0.0083s/iter; left time: 39.9164s
	iters: 600, epoch: 16 | loss: 0.4046904
	speed: 0.0091s/iter; left time: 42.6993s
	iters: 700, epoch: 16 | loss: 0.3271916
	speed: 0.0098s/iter; left time: 45.1427s
	iters: 800, epoch: 16 | loss: 0.4684988
	speed: 0.0093s/iter; left time: 41.6929s
	iters: 900, epoch: 16 | loss: 0.3263460
	speed: 0.0080s/iter; left time: 35.1441s
	iters: 1000, epoch: 16 | loss: 0.2839202
	speed: 0.0088s/iter; left time: 37.8542s
Epoch: 16 cost time: 8.994297504425049
Epoch: 16, Steps: 1059 | Train Loss: 0.3766783 Vali Loss: 0.1984712 Test Loss: 0.2728908
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 17 | loss: 0.2261902
	speed: 0.0392s/iter; left time: 162.2575s
	iters: 200, epoch: 17 | loss: 0.5082520
	speed: 0.0098s/iter; left time: 39.4083s
	iters: 300, epoch: 17 | loss: 0.1754053
	speed: 0.0082s/iter; left time: 32.3719s
	iters: 400, epoch: 17 | loss: 0.3210113
	speed: 0.0089s/iter; left time: 34.2027s
	iters: 500, epoch: 17 | loss: 0.2025636
	speed: 0.0093s/iter; left time: 34.9066s
	iters: 600, epoch: 17 | loss: 0.3947896
	speed: 0.0090s/iter; left time: 32.8879s
	iters: 700, epoch: 17 | loss: 0.7986440
	speed: 0.0084s/iter; left time: 29.6765s
	iters: 800, epoch: 17 | loss: 0.4141750
	speed: 0.0077s/iter; left time: 26.2966s
	iters: 900, epoch: 17 | loss: 0.4109088
	speed: 0.0087s/iter; left time: 29.1114s
	iters: 1000, epoch: 17 | loss: 0.5906031
	speed: 0.0082s/iter; left time: 26.6353s
Epoch: 17 cost time: 9.241336584091187
Epoch: 17, Steps: 1059 | Train Loss: 0.3766678 Vali Loss: 0.1984082 Test Loss: 0.2728982
Validation loss decreased (0.198429 --> 0.198408).  Saving model ...
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 18 | loss: 0.4154000
	speed: 0.0368s/iter; left time: 113.2511s
	iters: 200, epoch: 18 | loss: 0.3043148
	speed: 0.0082s/iter; left time: 24.3446s
	iters: 300, epoch: 18 | loss: 0.2607409
	speed: 0.0081s/iter; left time: 23.2947s
	iters: 400, epoch: 18 | loss: 0.4087954
	speed: 0.0085s/iter; left time: 23.6408s
	iters: 500, epoch: 18 | loss: 0.4740445
	speed: 0.0079s/iter; left time: 21.1999s
	iters: 600, epoch: 18 | loss: 0.3315475
	speed: 0.0085s/iter; left time: 22.0253s
	iters: 700, epoch: 18 | loss: 0.2247021
	speed: 0.0077s/iter; left time: 18.9898s
	iters: 800, epoch: 18 | loss: 0.3677672
	speed: 0.0074s/iter; left time: 17.6708s
	iters: 900, epoch: 18 | loss: 0.2742207
	speed: 0.0073s/iter; left time: 16.6066s
	iters: 1000, epoch: 18 | loss: 0.2390550
	speed: 0.0081s/iter; left time: 17.7365s
Epoch: 18 cost time: 8.506066799163818
Epoch: 18, Steps: 1059 | Train Loss: 0.3766556 Vali Loss: 0.1984008 Test Loss: 0.2729019
Validation loss decreased (0.198408 --> 0.198401).  Saving model ...
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 19 | loss: 0.2448368
	speed: 0.0328s/iter; left time: 66.1615s
	iters: 200, epoch: 19 | loss: 0.5918922
	speed: 0.0083s/iter; left time: 15.9900s
	iters: 300, epoch: 19 | loss: 0.4621957
	speed: 0.0083s/iter; left time: 15.0469s
	iters: 400, epoch: 19 | loss: 0.3266401
	speed: 0.0086s/iter; left time: 14.8571s
	iters: 500, epoch: 19 | loss: 0.2424100
	speed: 0.0086s/iter; left time: 13.9109s
	iters: 600, epoch: 19 | loss: 0.2726812
	speed: 0.0079s/iter; left time: 12.0508s
	iters: 700, epoch: 19 | loss: 0.3158871
	speed: 0.0083s/iter; left time: 11.7926s
	iters: 800, epoch: 19 | loss: 0.3971826
	speed: 0.0078s/iter; left time: 10.2663s
	iters: 900, epoch: 19 | loss: 0.2073406
	speed: 0.0075s/iter; left time: 9.1574s
	iters: 1000, epoch: 19 | loss: 0.3952599
	speed: 0.0076s/iter; left time: 8.4526s
Epoch: 19 cost time: 8.424330472946167
Epoch: 19, Steps: 1059 | Train Loss: 0.3766549 Vali Loss: 0.1984743 Test Loss: 0.2729038
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 20 | loss: 0.5887740
	speed: 0.0318s/iter; left time: 30.5419s
	iters: 200, epoch: 20 | loss: 0.3686512
	speed: 0.0077s/iter; left time: 6.6248s
	iters: 300, epoch: 20 | loss: 0.2105802
	speed: 0.0072s/iter; left time: 5.4492s
	iters: 400, epoch: 20 | loss: 0.2296727
	speed: 0.0075s/iter; left time: 4.9657s
	iters: 500, epoch: 20 | loss: 0.5231879
	speed: 0.0075s/iter; left time: 4.2181s
	iters: 600, epoch: 20 | loss: 0.4647680
	speed: 0.0073s/iter; left time: 3.3645s
	iters: 700, epoch: 20 | loss: 0.3611349
	speed: 0.0071s/iter; left time: 2.5596s
	iters: 800, epoch: 20 | loss: 0.5756937
	speed: 0.0071s/iter; left time: 1.8359s
	iters: 900, epoch: 20 | loss: 0.1817274
	speed: 0.0069s/iter; left time: 1.1093s
	iters: 1000, epoch: 20 | loss: 0.7133871
	speed: 0.0068s/iter; left time: 0.4050s
Epoch: 20 cost time: 7.627312660217285
Epoch: 20, Steps: 1059 | Train Loss: 0.3766544 Vali Loss: 0.1985047 Test Loss: 0.2729045
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.9073486328125e-08
>>>>>>>testing : ETTm2_336_336_NLinear_ETTm2_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15726<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
mse:0.2731471061706543, mae:0.3259960114955902
