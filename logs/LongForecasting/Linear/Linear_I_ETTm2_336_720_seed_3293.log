Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='Linear', model_id='ETTm2_336_720', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=720, root_path='./dataset/', save_pred_values=False, seed=3293, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTm2_336_720_Linear_ETTm2_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3293>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33505
val 10801
test 10801
	iters: 100, epoch: 1 | loss: 0.6311458
	speed: 0.0176s/iter; left time: 365.8429s
	iters: 200, epoch: 1 | loss: 0.8679907
	speed: 0.0195s/iter; left time: 404.2126s
	iters: 300, epoch: 1 | loss: 0.4594458
	speed: 0.0180s/iter; left time: 370.7312s
	iters: 400, epoch: 1 | loss: 0.4860585
	speed: 0.0177s/iter; left time: 363.8647s
	iters: 500, epoch: 1 | loss: 0.4407770
	speed: 0.0186s/iter; left time: 379.2754s
	iters: 600, epoch: 1 | loss: 1.1002738
	speed: 0.0186s/iter; left time: 378.4058s
	iters: 700, epoch: 1 | loss: 1.0535095
	speed: 0.0191s/iter; left time: 385.9699s
	iters: 800, epoch: 1 | loss: 0.4948621
	speed: 0.0192s/iter; left time: 387.1197s
	iters: 900, epoch: 1 | loss: 0.5449082
	speed: 0.0205s/iter; left time: 410.6602s
	iters: 1000, epoch: 1 | loss: 1.9729136
	speed: 0.0204s/iter; left time: 407.5412s
Epoch: 1 cost time: 19.71664524078369
Epoch: 1, Steps: 1047 | Train Loss: 0.7283066 Vali Loss: 0.5595140 Test Loss: 1.1876554
Validation loss decreased (inf --> 0.559514).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.4641217
	speed: 0.0709s/iter; left time: 1403.8289s
	iters: 200, epoch: 2 | loss: 0.5504321
	speed: 0.0208s/iter; left time: 409.9688s
	iters: 300, epoch: 2 | loss: 0.3545085
	speed: 0.0204s/iter; left time: 400.3093s
	iters: 400, epoch: 2 | loss: 0.9369270
	speed: 0.0197s/iter; left time: 384.5751s
	iters: 500, epoch: 2 | loss: 0.4039171
	speed: 0.0194s/iter; left time: 376.7101s
	iters: 600, epoch: 2 | loss: 0.6346000
	speed: 0.0179s/iter; left time: 346.1544s
	iters: 700, epoch: 2 | loss: 0.7543918
	speed: 0.0190s/iter; left time: 364.0916s
	iters: 800, epoch: 2 | loss: 0.5860898
	speed: 0.0186s/iter; left time: 354.5014s
	iters: 900, epoch: 2 | loss: 0.8079352
	speed: 0.0184s/iter; left time: 348.8685s
	iters: 1000, epoch: 2 | loss: 0.9532772
	speed: 0.0166s/iter; left time: 312.8476s
Epoch: 2 cost time: 19.872108936309814
Epoch: 2, Steps: 1047 | Train Loss: 0.7463602 Vali Loss: 0.6522553 Test Loss: 1.5148765
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.3662419
	speed: 0.0667s/iter; left time: 1250.2059s
	iters: 200, epoch: 3 | loss: 0.7557988
	speed: 0.0186s/iter; left time: 346.0763s
	iters: 300, epoch: 3 | loss: 0.3896192
	speed: 0.0191s/iter; left time: 354.0721s
	iters: 400, epoch: 3 | loss: 0.8266169
	speed: 0.0185s/iter; left time: 341.9506s
	iters: 500, epoch: 3 | loss: 0.4449244
	speed: 0.0195s/iter; left time: 357.1888s
	iters: 600, epoch: 3 | loss: 0.9211954
	speed: 0.0186s/iter; left time: 339.2060s
	iters: 700, epoch: 3 | loss: 0.6588514
	speed: 0.0189s/iter; left time: 342.3441s
	iters: 800, epoch: 3 | loss: 0.3768183
	speed: 0.0197s/iter; left time: 354.7920s
	iters: 900, epoch: 3 | loss: 0.5719352
	speed: 0.0199s/iter; left time: 356.2890s
	iters: 1000, epoch: 3 | loss: 0.7318321
	speed: 0.0160s/iter; left time: 286.2634s
Epoch: 3 cost time: 19.532970428466797
Epoch: 3, Steps: 1047 | Train Loss: 0.5413439 Vali Loss: 0.3705698 Test Loss: 0.6227133
Validation loss decreased (0.559514 --> 0.370570).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.4058342
	speed: 0.0694s/iter; left time: 1229.1070s
	iters: 200, epoch: 4 | loss: 0.5111545
	speed: 0.0198s/iter; left time: 348.4780s
	iters: 300, epoch: 4 | loss: 0.2950988
	speed: 0.0189s/iter; left time: 329.9735s
	iters: 400, epoch: 4 | loss: 0.5587682
	speed: 0.0178s/iter; left time: 310.0594s
	iters: 500, epoch: 4 | loss: 0.3994630
	speed: 0.0204s/iter; left time: 353.3360s
	iters: 600, epoch: 4 | loss: 0.7825357
	speed: 0.0198s/iter; left time: 340.3311s
	iters: 700, epoch: 4 | loss: 0.8198683
	speed: 0.0207s/iter; left time: 354.3323s
	iters: 800, epoch: 4 | loss: 0.5654926
	speed: 0.0189s/iter; left time: 321.1163s
	iters: 900, epoch: 4 | loss: 0.3938703
	speed: 0.0154s/iter; left time: 261.0571s
	iters: 1000, epoch: 4 | loss: 0.3875093
	speed: 0.0139s/iter; left time: 233.3987s
Epoch: 4 cost time: 19.216792821884155
Epoch: 4, Steps: 1047 | Train Loss: 0.4976372 Vali Loss: 0.3829156 Test Loss: 0.7370794
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.3416651
	speed: 0.0687s/iter; left time: 1143.6173s
	iters: 200, epoch: 5 | loss: 0.3009197
	speed: 0.0176s/iter; left time: 290.8792s
	iters: 300, epoch: 5 | loss: 0.3791870
	speed: 0.0177s/iter; left time: 291.7923s
	iters: 400, epoch: 5 | loss: 0.4731629
	speed: 0.0179s/iter; left time: 293.4655s
	iters: 500, epoch: 5 | loss: 0.7253412
	speed: 0.0185s/iter; left time: 300.9649s
	iters: 600, epoch: 5 | loss: 0.6440687
	speed: 0.0179s/iter; left time: 288.6117s
	iters: 700, epoch: 5 | loss: 0.7438149
	speed: 0.0169s/iter; left time: 272.0181s
	iters: 800, epoch: 5 | loss: 0.4420734
	speed: 0.0167s/iter; left time: 266.8301s
	iters: 900, epoch: 5 | loss: 0.2929159
	speed: 0.0157s/iter; left time: 248.3913s
	iters: 1000, epoch: 5 | loss: 0.5046313
	speed: 0.0155s/iter; left time: 244.2119s
Epoch: 5 cost time: 17.740898847579956
Epoch: 5, Steps: 1047 | Train Loss: 0.4770905 Vali Loss: 0.3657811 Test Loss: 0.6255460
Validation loss decreased (0.370570 --> 0.365781).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.4615090
	speed: 0.0731s/iter; left time: 1140.8602s
	iters: 200, epoch: 6 | loss: 0.2812589
	speed: 0.0180s/iter; left time: 279.7770s
	iters: 300, epoch: 6 | loss: 0.3380640
	speed: 0.0164s/iter; left time: 253.0620s
	iters: 400, epoch: 6 | loss: 0.4820241
	speed: 0.0179s/iter; left time: 274.5805s
	iters: 500, epoch: 6 | loss: 0.2878788
	speed: 0.0198s/iter; left time: 301.5452s
	iters: 600, epoch: 6 | loss: 0.7186987
	speed: 0.0181s/iter; left time: 273.9985s
	iters: 700, epoch: 6 | loss: 0.4628389
	speed: 0.0187s/iter; left time: 280.7470s
	iters: 800, epoch: 6 | loss: 0.3757211
	speed: 0.0185s/iter; left time: 276.3281s
	iters: 900, epoch: 6 | loss: 0.7798877
	speed: 0.0156s/iter; left time: 231.5230s
	iters: 1000, epoch: 6 | loss: 0.2990138
	speed: 0.0148s/iter; left time: 217.6077s
Epoch: 6 cost time: 18.567595720291138
Epoch: 6, Steps: 1047 | Train Loss: 0.4642593 Vali Loss: 0.4588939 Test Loss: 0.9912341
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.5384220
	speed: 0.0699s/iter; left time: 1017.1937s
	iters: 200, epoch: 7 | loss: 0.3354966
	speed: 0.0201s/iter; left time: 290.7816s
	iters: 300, epoch: 7 | loss: 0.6276360
	speed: 0.0201s/iter; left time: 288.4980s
	iters: 400, epoch: 7 | loss: 0.3801184
	speed: 0.0195s/iter; left time: 277.8777s
	iters: 500, epoch: 7 | loss: 0.7209011
	speed: 0.0196s/iter; left time: 277.5700s
	iters: 600, epoch: 7 | loss: 0.4299437
	speed: 0.0182s/iter; left time: 255.8833s
	iters: 700, epoch: 7 | loss: 0.3877756
	speed: 0.0197s/iter; left time: 275.0708s
	iters: 800, epoch: 7 | loss: 0.4597854
	speed: 0.0175s/iter; left time: 243.1890s
	iters: 900, epoch: 7 | loss: 0.2923615
	speed: 0.0154s/iter; left time: 211.8191s
	iters: 1000, epoch: 7 | loss: 0.2753739
	speed: 0.0151s/iter; left time: 206.5642s
Epoch: 7 cost time: 19.161989212036133
Epoch: 7, Steps: 1047 | Train Loss: 0.4571230 Vali Loss: 0.4067220 Test Loss: 0.7916057
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.4070027
	speed: 0.0723s/iter; left time: 977.4024s
	iters: 200, epoch: 8 | loss: 0.4035443
	speed: 0.0187s/iter; left time: 250.8741s
	iters: 300, epoch: 8 | loss: 0.4084709
	speed: 0.0188s/iter; left time: 250.6923s
	iters: 400, epoch: 8 | loss: 0.4037156
	speed: 0.0174s/iter; left time: 229.3718s
	iters: 500, epoch: 8 | loss: 0.4401624
	speed: 0.0172s/iter; left time: 225.1278s
	iters: 600, epoch: 8 | loss: 0.3397939
	speed: 0.0186s/iter; left time: 242.5115s
	iters: 700, epoch: 8 | loss: 0.4832815
	speed: 0.0187s/iter; left time: 241.1637s
	iters: 800, epoch: 8 | loss: 0.5960826
	speed: 0.0176s/iter; left time: 225.5076s
	iters: 900, epoch: 8 | loss: 0.3757680
	speed: 0.0156s/iter; left time: 197.7446s
	iters: 1000, epoch: 8 | loss: 0.4159767
	speed: 0.0147s/iter; left time: 185.7997s
Epoch: 8 cost time: 18.344116926193237
Epoch: 8, Steps: 1047 | Train Loss: 0.4533415 Vali Loss: 0.4299481 Test Loss: 0.9089456
EarlyStopping counter: 3 out of 5
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.4407567
	speed: 0.0629s/iter; left time: 784.3782s
	iters: 200, epoch: 9 | loss: 0.6603043
	speed: 0.0171s/iter; left time: 211.3318s
	iters: 300, epoch: 9 | loss: 0.5771051
	speed: 0.0198s/iter; left time: 242.3093s
	iters: 400, epoch: 9 | loss: 0.3310425
	speed: 0.0196s/iter; left time: 238.1768s
	iters: 500, epoch: 9 | loss: 0.8941519
	speed: 0.0184s/iter; left time: 221.6323s
	iters: 600, epoch: 9 | loss: 0.1912803
	speed: 0.0180s/iter; left time: 215.4568s
	iters: 700, epoch: 9 | loss: 0.4087681
	speed: 0.0191s/iter; left time: 227.0251s
	iters: 800, epoch: 9 | loss: 0.6387307
	speed: 0.0188s/iter; left time: 220.7048s
	iters: 900, epoch: 9 | loss: 0.3723369
	speed: 0.0164s/iter; left time: 191.0363s
	iters: 1000, epoch: 9 | loss: 0.4517258
	speed: 0.0147s/iter; left time: 169.9815s
Epoch: 9 cost time: 18.570473670959473
Epoch: 9, Steps: 1047 | Train Loss: 0.4514749 Vali Loss: 0.4104674 Test Loss: 0.8375072
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.5448281
	speed: 0.0679s/iter; left time: 775.2864s
	iters: 200, epoch: 10 | loss: 0.4848807
	speed: 0.0173s/iter; left time: 195.4231s
	iters: 300, epoch: 10 | loss: 0.3356354
	speed: 0.0176s/iter; left time: 197.2047s
	iters: 400, epoch: 10 | loss: 0.3094089
	speed: 0.0178s/iter; left time: 197.4461s
	iters: 500, epoch: 10 | loss: 0.4869512
	speed: 0.0165s/iter; left time: 182.0991s
	iters: 600, epoch: 10 | loss: 0.4130204
	speed: 0.0160s/iter; left time: 174.4784s
	iters: 700, epoch: 10 | loss: 0.3693691
	speed: 0.0158s/iter; left time: 171.1060s
	iters: 800, epoch: 10 | loss: 0.4190323
	speed: 0.0148s/iter; left time: 158.3786s
	iters: 900, epoch: 10 | loss: 0.4348474
	speed: 0.0139s/iter; left time: 148.0463s
	iters: 1000, epoch: 10 | loss: 0.2426122
	speed: 0.0137s/iter; left time: 144.5896s
Epoch: 10 cost time: 16.970523357391357
Epoch: 10, Steps: 1047 | Train Loss: 0.4503189 Vali Loss: 0.4133522 Test Loss: 0.8382593
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTm2_336_720_Linear_ETTm2_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3293<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10801
mse:0.6259476542472839, mae:0.5284176468849182
