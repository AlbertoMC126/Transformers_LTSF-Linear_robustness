Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='NLinear', model_id='weather_96_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=10458, seq_len=96, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_96_96_NLinear_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed10458>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36696
val 5175
test 10444
Total number of trainable parameters: 195552
Total number of parameters: 195552
	iters: 100, epoch: 1 | loss: 0.4487440
	speed: 0.0808s/iter; left time: 3695.9385s
	iters: 200, epoch: 1 | loss: 0.2675319
	speed: 0.0319s/iter; left time: 1456.8488s
	iters: 300, epoch: 1 | loss: 0.3600423
	speed: 0.0318s/iter; left time: 1450.8405s
	iters: 400, epoch: 1 | loss: 0.3529017
	speed: 0.0314s/iter; left time: 1428.8764s
	iters: 500, epoch: 1 | loss: 0.2640849
	speed: 0.0317s/iter; left time: 1437.5960s
	iters: 600, epoch: 1 | loss: 0.3118143
	speed: 0.0317s/iter; left time: 1434.6442s
	iters: 700, epoch: 1 | loss: 0.4697929
	speed: 0.0317s/iter; left time: 1432.2490s
	iters: 800, epoch: 1 | loss: 0.3417763
	speed: 0.0317s/iter; left time: 1429.2242s
	iters: 900, epoch: 1 | loss: 0.3191091
	speed: 0.0317s/iter; left time: 1425.1937s
	iters: 1000, epoch: 1 | loss: 0.2948440
	speed: 0.0318s/iter; left time: 1427.1026s
	iters: 1100, epoch: 1 | loss: 0.3980940
	speed: 0.0316s/iter; left time: 1415.8656s
	iters: 1200, epoch: 1 | loss: 0.7605242
	speed: 0.0318s/iter; left time: 1419.3478s
	iters: 1300, epoch: 1 | loss: 0.2990093
	speed: 0.0319s/iter; left time: 1421.9131s
	iters: 1400, epoch: 1 | loss: 0.3278797
	speed: 0.0315s/iter; left time: 1399.2071s
	iters: 1500, epoch: 1 | loss: 0.8755583
	speed: 0.0317s/iter; left time: 1404.7532s
	iters: 1600, epoch: 1 | loss: 0.2801299
	speed: 0.0317s/iter; left time: 1403.8462s
	iters: 1700, epoch: 1 | loss: 0.3487051
	speed: 0.0317s/iter; left time: 1398.2318s
	iters: 1800, epoch: 1 | loss: 0.3478952
	speed: 0.0316s/iter; left time: 1392.9955s
	iters: 1900, epoch: 1 | loss: 0.4940819
	speed: 0.0315s/iter; left time: 1383.5630s
	iters: 2000, epoch: 1 | loss: 0.5700754
	speed: 0.0315s/iter; left time: 1381.9146s
	iters: 2100, epoch: 1 | loss: 0.3440938
	speed: 0.0317s/iter; left time: 1387.5757s
	iters: 2200, epoch: 1 | loss: 0.2800784
	speed: 0.0316s/iter; left time: 1378.2980s
Epoch: 1 cost time: 77.53621935844421
Epoch: 1, Steps: 2293 | Train Loss: 0.9591041 Vali Loss: 0.4484570 Test Loss: 0.1746959
Validation loss decreased (inf --> 0.448457).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.6608464
	speed: 0.1104s/iter; left time: 4800.2958s
	iters: 200, epoch: 2 | loss: 0.3842443
	speed: 0.0319s/iter; left time: 1382.8695s
	iters: 300, epoch: 2 | loss: 1.8954091
	speed: 0.0316s/iter; left time: 1367.1514s
	iters: 400, epoch: 2 | loss: 0.3781872
	speed: 0.0315s/iter; left time: 1360.6679s
	iters: 500, epoch: 2 | loss: 0.5503684
	speed: 0.0315s/iter; left time: 1356.3212s
	iters: 600, epoch: 2 | loss: 1.3368194
	speed: 0.0317s/iter; left time: 1361.9042s
	iters: 700, epoch: 2 | loss: 0.4161527
	speed: 0.0317s/iter; left time: 1356.8124s
	iters: 800, epoch: 2 | loss: 0.3944571
	speed: 0.0317s/iter; left time: 1353.9503s
	iters: 900, epoch: 2 | loss: 0.2932690
	speed: 0.0316s/iter; left time: 1348.8994s
	iters: 1000, epoch: 2 | loss: 0.4842375
	speed: 0.0316s/iter; left time: 1345.1922s
	iters: 1100, epoch: 2 | loss: 0.3063352
	speed: 0.0318s/iter; left time: 1352.0539s
	iters: 1200, epoch: 2 | loss: 1.3301964
	speed: 0.0316s/iter; left time: 1339.6530s
	iters: 1300, epoch: 2 | loss: 0.3243021
	speed: 0.0317s/iter; left time: 1340.8575s
	iters: 1400, epoch: 2 | loss: 0.4383523
	speed: 0.0318s/iter; left time: 1338.8478s
	iters: 1500, epoch: 2 | loss: 0.6540396
	speed: 0.0317s/iter; left time: 1333.9044s
	iters: 1600, epoch: 2 | loss: 0.2811495
	speed: 0.0317s/iter; left time: 1330.3814s
	iters: 1700, epoch: 2 | loss: 0.2153555
	speed: 0.0317s/iter; left time: 1328.9754s
	iters: 1800, epoch: 2 | loss: 0.2773559
	speed: 0.0318s/iter; left time: 1326.1713s
	iters: 1900, epoch: 2 | loss: 0.4600314
	speed: 0.0314s/iter; left time: 1310.1629s
	iters: 2000, epoch: 2 | loss: 0.7210941
	speed: 0.0318s/iter; left time: 1319.7854s
	iters: 2100, epoch: 2 | loss: 0.3579008
	speed: 0.0318s/iter; left time: 1317.2637s
	iters: 2200, epoch: 2 | loss: 0.3630042
	speed: 0.0315s/iter; left time: 1303.2890s
Epoch: 2 cost time: 72.60477495193481
Epoch: 2, Steps: 2293 | Train Loss: 0.8343779 Vali Loss: 0.4691601 Test Loss: 0.1847918
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.3439434
	speed: 0.1102s/iter; left time: 4539.3855s
	iters: 200, epoch: 3 | loss: 1.8150767
	speed: 0.0318s/iter; left time: 1306.2662s
	iters: 300, epoch: 3 | loss: 0.3639702
	speed: 0.0316s/iter; left time: 1293.7456s
	iters: 400, epoch: 3 | loss: 0.2760707
	speed: 0.0317s/iter; left time: 1294.3765s
	iters: 500, epoch: 3 | loss: 0.4452338
	speed: 0.0318s/iter; left time: 1296.7458s
	iters: 600, epoch: 3 | loss: 0.5034914
	speed: 0.0317s/iter; left time: 1289.1649s
	iters: 700, epoch: 3 | loss: 0.3972477
	speed: 0.0317s/iter; left time: 1285.1306s
	iters: 800, epoch: 3 | loss: 0.2292525
	speed: 0.0316s/iter; left time: 1278.9561s
	iters: 900, epoch: 3 | loss: 0.4706134
	speed: 0.0316s/iter; left time: 1276.0020s
	iters: 1000, epoch: 3 | loss: 0.5911430
	speed: 0.0314s/iter; left time: 1266.3991s
	iters: 1100, epoch: 3 | loss: 0.3369497
	speed: 0.0317s/iter; left time: 1275.2809s
	iters: 1200, epoch: 3 | loss: 0.5541119
	speed: 0.0316s/iter; left time: 1267.4066s
	iters: 1300, epoch: 3 | loss: 0.3776955
	speed: 0.0316s/iter; left time: 1264.2939s
	iters: 1400, epoch: 3 | loss: 0.2946325
	speed: 0.0315s/iter; left time: 1255.0272s
	iters: 1500, epoch: 3 | loss: 0.4184342
	speed: 0.0315s/iter; left time: 1251.5976s
	iters: 1600, epoch: 3 | loss: 0.7106192
	speed: 0.0317s/iter; left time: 1255.8366s
	iters: 1700, epoch: 3 | loss: 0.4608899
	speed: 0.0316s/iter; left time: 1249.4488s
	iters: 1800, epoch: 3 | loss: 0.2655561
	speed: 0.0315s/iter; left time: 1245.0540s
	iters: 1900, epoch: 3 | loss: 0.2930016
	speed: 0.0315s/iter; left time: 1241.0683s
	iters: 2000, epoch: 3 | loss: 0.4357777
	speed: 0.0316s/iter; left time: 1242.7201s
	iters: 2100, epoch: 3 | loss: 1.8511040
	speed: 0.0315s/iter; left time: 1232.5170s
	iters: 2200, epoch: 3 | loss: 0.4070862
	speed: 0.0314s/iter; left time: 1227.9357s
Epoch: 3 cost time: 72.4402391910553
Epoch: 3, Steps: 2293 | Train Loss: 6.1109793 Vali Loss: 0.4293579 Test Loss: 0.1705666
Validation loss decreased (0.448457 --> 0.429358).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.3384020
	speed: 0.1103s/iter; left time: 4289.1104s
	iters: 200, epoch: 4 | loss: 0.2977707
	speed: 0.0317s/iter; left time: 1231.1116s
	iters: 300, epoch: 4 | loss: 0.2099830
	speed: 0.0316s/iter; left time: 1221.4778s
	iters: 400, epoch: 4 | loss: 0.3061340
	speed: 0.0317s/iter; left time: 1223.8955s
	iters: 500, epoch: 4 | loss: 0.4052524
	speed: 0.0315s/iter; left time: 1211.0256s
	iters: 600, epoch: 4 | loss: 0.3019525
	speed: 0.0318s/iter; left time: 1218.7150s
	iters: 700, epoch: 4 | loss: 0.4797714
	speed: 0.0316s/iter; left time: 1210.3197s
	iters: 800, epoch: 4 | loss: 0.5308406
	speed: 0.0316s/iter; left time: 1207.2682s
	iters: 900, epoch: 4 | loss: 0.6709967
	speed: 0.0315s/iter; left time: 1198.7561s
	iters: 1000, epoch: 4 | loss: 0.4638042
	speed: 0.0317s/iter; left time: 1203.8566s
	iters: 1100, epoch: 4 | loss: 0.4272159
	speed: 0.0317s/iter; left time: 1202.0587s
	iters: 1200, epoch: 4 | loss: 0.3287447
	speed: 0.0317s/iter; left time: 1196.4982s
	iters: 1300, epoch: 4 | loss: 0.2441653
	speed: 0.0317s/iter; left time: 1192.7983s
	iters: 1400, epoch: 4 | loss: 0.2854315
	speed: 0.0316s/iter; left time: 1185.7433s
	iters: 1500, epoch: 4 | loss: 0.1939753
	speed: 0.0317s/iter; left time: 1188.7074s
	iters: 1600, epoch: 4 | loss: 0.3040012
	speed: 0.0317s/iter; left time: 1183.7960s
	iters: 1700, epoch: 4 | loss: 0.1993059
	speed: 0.0317s/iter; left time: 1181.1546s
	iters: 1800, epoch: 4 | loss: 0.2721850
	speed: 0.0318s/iter; left time: 1182.5066s
	iters: 1900, epoch: 4 | loss: 0.6966562
	speed: 0.0317s/iter; left time: 1173.7533s
	iters: 2000, epoch: 4 | loss: 0.3130702
	speed: 0.0315s/iter; left time: 1166.6855s
	iters: 2100, epoch: 4 | loss: 0.2968578
	speed: 0.0315s/iter; left time: 1163.4040s
	iters: 2200, epoch: 4 | loss: 2.2243528
	speed: 0.0318s/iter; left time: 1169.5817s
Epoch: 4 cost time: 72.54537916183472
Epoch: 4, Steps: 2293 | Train Loss: 1.0601077 Vali Loss: 0.4261015 Test Loss: 0.1666948
Validation loss decreased (0.429358 --> 0.426102).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.2535276
	speed: 0.1114s/iter; left time: 4075.6940s
	iters: 200, epoch: 5 | loss: 0.4412736
	speed: 0.0318s/iter; left time: 1160.4551s
	iters: 300, epoch: 5 | loss: 0.2336944
	speed: 0.0317s/iter; left time: 1154.6314s
	iters: 400, epoch: 5 | loss: 2.1937730
	speed: 0.0318s/iter; left time: 1152.6661s
	iters: 500, epoch: 5 | loss: 0.2559842
	speed: 0.0316s/iter; left time: 1142.4472s
	iters: 600, epoch: 5 | loss: 0.3959454
	speed: 0.0317s/iter; left time: 1144.8903s
	iters: 700, epoch: 5 | loss: 0.3070470
	speed: 0.0317s/iter; left time: 1140.4018s
	iters: 800, epoch: 5 | loss: 1.1141473
	speed: 0.0317s/iter; left time: 1138.0104s
	iters: 900, epoch: 5 | loss: 0.3193641
	speed: 0.0317s/iter; left time: 1133.8779s
	iters: 1000, epoch: 5 | loss: 0.6948464
	speed: 0.0317s/iter; left time: 1130.1297s
	iters: 1100, epoch: 5 | loss: 2.2040784
	speed: 0.0315s/iter; left time: 1122.3714s
	iters: 1200, epoch: 5 | loss: 0.2595128
	speed: 0.0316s/iter; left time: 1120.6394s
	iters: 1300, epoch: 5 | loss: 0.4168736
	speed: 0.0317s/iter; left time: 1122.5479s
	iters: 1400, epoch: 5 | loss: 0.2269685
	speed: 0.0317s/iter; left time: 1118.1724s
	iters: 1500, epoch: 5 | loss: 0.2379114
	speed: 0.0318s/iter; left time: 1119.1109s
	iters: 1600, epoch: 5 | loss: 0.4547237
	speed: 0.0318s/iter; left time: 1115.6730s
	iters: 1700, epoch: 5 | loss: 0.3254643
	speed: 0.0317s/iter; left time: 1108.9000s
	iters: 1800, epoch: 5 | loss: 0.4226655
	speed: 0.0316s/iter; left time: 1103.6454s
	iters: 1900, epoch: 5 | loss: 0.2960387
	speed: 0.0315s/iter; left time: 1097.5822s
	iters: 2000, epoch: 5 | loss: 0.5183736
	speed: 0.0319s/iter; left time: 1106.1842s
	iters: 2100, epoch: 5 | loss: 0.4500426
	speed: 0.0319s/iter; left time: 1104.1253s
	iters: 2200, epoch: 5 | loss: 0.3171507
	speed: 0.0317s/iter; left time: 1094.4279s
Epoch: 5 cost time: 72.60026693344116
Epoch: 5, Steps: 2293 | Train Loss: 0.5539953 Vali Loss: 0.4261034 Test Loss: 0.1663707
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.3491659
	speed: 0.1084s/iter; left time: 3718.8865s
	iters: 200, epoch: 6 | loss: 0.2308837
	speed: 0.0317s/iter; left time: 1083.6428s
	iters: 300, epoch: 6 | loss: 0.3026454
	speed: 0.0315s/iter; left time: 1074.9891s
	iters: 400, epoch: 6 | loss: 2.4444275
	speed: 0.0318s/iter; left time: 1080.9501s
	iters: 500, epoch: 6 | loss: 0.2064207
	speed: 0.0315s/iter; left time: 1067.3705s
	iters: 600, epoch: 6 | loss: 0.3173713
	speed: 0.0317s/iter; left time: 1072.7413s
	iters: 700, epoch: 6 | loss: 0.5029337
	speed: 0.0316s/iter; left time: 1065.9788s
	iters: 800, epoch: 6 | loss: 0.3689784
	speed: 0.0316s/iter; left time: 1062.1714s
	iters: 900, epoch: 6 | loss: 0.3411339
	speed: 0.0317s/iter; left time: 1060.2693s
	iters: 1000, epoch: 6 | loss: 0.3496925
	speed: 0.0316s/iter; left time: 1056.5118s
	iters: 1100, epoch: 6 | loss: 0.3034473
	speed: 0.0314s/iter; left time: 1046.0173s
	iters: 1200, epoch: 6 | loss: 0.6658144
	speed: 0.0315s/iter; left time: 1046.2533s
	iters: 1300, epoch: 6 | loss: 0.2840205
	speed: 0.0317s/iter; left time: 1050.2142s
	iters: 1400, epoch: 6 | loss: 0.4333875
	speed: 0.0316s/iter; left time: 1043.1258s
	iters: 1500, epoch: 6 | loss: 0.2806693
	speed: 0.0317s/iter; left time: 1042.3856s
	iters: 1600, epoch: 6 | loss: 0.3651989
	speed: 0.0315s/iter; left time: 1032.9673s
	iters: 1700, epoch: 6 | loss: 0.4116659
	speed: 0.0315s/iter; left time: 1031.2432s
	iters: 1800, epoch: 6 | loss: 0.3091336
	speed: 0.0315s/iter; left time: 1028.2320s
	iters: 1900, epoch: 6 | loss: 0.3805427
	speed: 0.0315s/iter; left time: 1024.8262s
	iters: 2000, epoch: 6 | loss: 0.2337493
	speed: 0.0315s/iter; left time: 1021.4227s
	iters: 2100, epoch: 6 | loss: 0.3511287
	speed: 0.0317s/iter; left time: 1022.9408s
	iters: 2200, epoch: 6 | loss: 0.4576186
	speed: 0.0313s/iter; left time: 1008.0384s
Epoch: 6 cost time: 72.37420749664307
Epoch: 6, Steps: 2293 | Train Loss: 0.4691891 Vali Loss: 0.4248258 Test Loss: 0.1655424
Validation loss decreased (0.426102 --> 0.424826).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.2667615
	speed: 0.1104s/iter; left time: 3532.9013s
	iters: 200, epoch: 7 | loss: 0.3778199
	speed: 0.0318s/iter; left time: 1015.8640s
	iters: 300, epoch: 7 | loss: 0.3867458
	speed: 0.0317s/iter; left time: 1006.9717s
	iters: 400, epoch: 7 | loss: 0.2724490
	speed: 0.0316s/iter; left time: 1001.0876s
	iters: 500, epoch: 7 | loss: 0.3338603
	speed: 0.0317s/iter; left time: 1002.7003s
	iters: 600, epoch: 7 | loss: 0.7256824
	speed: 0.0316s/iter; left time: 995.2685s
	iters: 700, epoch: 7 | loss: 0.3027264
	speed: 0.0317s/iter; left time: 994.7927s
	iters: 800, epoch: 7 | loss: 0.6260893
	speed: 0.0318s/iter; left time: 994.3828s
	iters: 900, epoch: 7 | loss: 0.3283641
	speed: 0.0318s/iter; left time: 993.0490s
	iters: 1000, epoch: 7 | loss: 0.2711408
	speed: 0.0317s/iter; left time: 986.0988s
	iters: 1100, epoch: 7 | loss: 0.2566533
	speed: 0.0318s/iter; left time: 985.4175s
	iters: 1200, epoch: 7 | loss: 0.3201691
	speed: 0.0317s/iter; left time: 978.6167s
	iters: 1300, epoch: 7 | loss: 0.5181835
	speed: 0.0315s/iter; left time: 969.9455s
	iters: 1400, epoch: 7 | loss: 0.2513431
	speed: 0.0316s/iter; left time: 970.8848s
	iters: 1500, epoch: 7 | loss: 0.2887777
	speed: 0.0317s/iter; left time: 970.1212s
	iters: 1600, epoch: 7 | loss: 1.0055761
	speed: 0.0317s/iter; left time: 968.0494s
	iters: 1700, epoch: 7 | loss: 0.5428684
	speed: 0.0316s/iter; left time: 961.5567s
	iters: 1800, epoch: 7 | loss: 0.4397272
	speed: 0.0317s/iter; left time: 960.1018s
	iters: 1900, epoch: 7 | loss: 0.3680685
	speed: 0.0318s/iter; left time: 960.3100s
	iters: 2000, epoch: 7 | loss: 0.4624434
	speed: 0.0317s/iter; left time: 954.9049s
	iters: 2100, epoch: 7 | loss: 0.2203077
	speed: 0.0318s/iter; left time: 953.2198s
	iters: 2200, epoch: 7 | loss: 0.2426129
	speed: 0.0317s/iter; left time: 949.1558s
Epoch: 7 cost time: 72.56420588493347
Epoch: 7, Steps: 2293 | Train Loss: 0.4536571 Vali Loss: 0.4239221 Test Loss: 0.1649874
Validation loss decreased (0.424826 --> 0.423922).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.3170596
	speed: 0.1118s/iter; left time: 3321.0230s
	iters: 200, epoch: 8 | loss: 0.4755967
	speed: 0.0318s/iter; left time: 942.8475s
	iters: 300, epoch: 8 | loss: 0.3841928
	speed: 0.0319s/iter; left time: 940.3772s
	iters: 400, epoch: 8 | loss: 0.3087867
	speed: 0.0317s/iter; left time: 933.2034s
	iters: 500, epoch: 8 | loss: 0.4997714
	speed: 0.0320s/iter; left time: 936.4701s
	iters: 600, epoch: 8 | loss: 0.3550416
	speed: 0.0317s/iter; left time: 927.3047s
	iters: 700, epoch: 8 | loss: 0.2998086
	speed: 0.0318s/iter; left time: 924.3715s
	iters: 800, epoch: 8 | loss: 0.3546224
	speed: 0.0316s/iter; left time: 917.4226s
	iters: 900, epoch: 8 | loss: 0.2879526
	speed: 0.0317s/iter; left time: 915.3614s
	iters: 1000, epoch: 8 | loss: 0.3199487
	speed: 0.0317s/iter; left time: 912.9793s
	iters: 1100, epoch: 8 | loss: 0.3610339
	speed: 0.0318s/iter; left time: 912.8069s
	iters: 1200, epoch: 8 | loss: 0.4578745
	speed: 0.0316s/iter; left time: 905.2641s
	iters: 1300, epoch: 8 | loss: 2.1425080
	speed: 0.0317s/iter; left time: 904.6154s
	iters: 1400, epoch: 8 | loss: 0.4156338
	speed: 0.0317s/iter; left time: 900.2064s
	iters: 1500, epoch: 8 | loss: 0.2466445
	speed: 0.0316s/iter; left time: 894.9469s
	iters: 1600, epoch: 8 | loss: 0.2818625
	speed: 0.0316s/iter; left time: 890.2571s
	iters: 1700, epoch: 8 | loss: 0.2780493
	speed: 0.0317s/iter; left time: 891.4895s
	iters: 1800, epoch: 8 | loss: 0.5537560
	speed: 0.0316s/iter; left time: 886.3485s
	iters: 1900, epoch: 8 | loss: 0.9915156
	speed: 0.0317s/iter; left time: 884.6704s
	iters: 2000, epoch: 8 | loss: 0.2451864
	speed: 0.0318s/iter; left time: 884.7296s
	iters: 2100, epoch: 8 | loss: 0.3501956
	speed: 0.0318s/iter; left time: 880.5581s
	iters: 2200, epoch: 8 | loss: 0.2901489
	speed: 0.0317s/iter; left time: 874.3612s
Epoch: 8 cost time: 72.62394571304321
Epoch: 8, Steps: 2293 | Train Loss: 0.4512763 Vali Loss: 0.4185622 Test Loss: 0.1657640
Validation loss decreased (0.423922 --> 0.418562).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.3090380
	speed: 0.1115s/iter; left time: 3055.6552s
	iters: 200, epoch: 9 | loss: 0.4889298
	speed: 0.0318s/iter; left time: 867.9665s
	iters: 300, epoch: 9 | loss: 0.4345713
	speed: 0.0318s/iter; left time: 864.9497s
	iters: 400, epoch: 9 | loss: 0.6869031
	speed: 0.0316s/iter; left time: 857.1960s
	iters: 500, epoch: 9 | loss: 0.2278217
	speed: 0.0318s/iter; left time: 858.1748s
	iters: 600, epoch: 9 | loss: 0.2655712
	speed: 0.0318s/iter; left time: 854.6932s
	iters: 700, epoch: 9 | loss: 0.3785943
	speed: 0.0317s/iter; left time: 849.1482s
	iters: 800, epoch: 9 | loss: 0.3794177
	speed: 0.0317s/iter; left time: 846.7430s
	iters: 900, epoch: 9 | loss: 0.6962666
	speed: 0.0316s/iter; left time: 841.2038s
	iters: 1000, epoch: 9 | loss: 0.2532285
	speed: 0.0316s/iter; left time: 837.0560s
	iters: 1100, epoch: 9 | loss: 0.3216927
	speed: 0.0317s/iter; left time: 837.0334s
	iters: 1200, epoch: 9 | loss: 0.2525767
	speed: 0.0316s/iter; left time: 831.4273s
	iters: 1300, epoch: 9 | loss: 0.3327889
	speed: 0.0316s/iter; left time: 828.4564s
	iters: 1400, epoch: 9 | loss: 0.3269869
	speed: 0.0316s/iter; left time: 824.6130s
	iters: 1500, epoch: 9 | loss: 0.2896014
	speed: 0.0317s/iter; left time: 824.3589s
	iters: 1600, epoch: 9 | loss: 0.3237810
	speed: 0.0316s/iter; left time: 819.1587s
	iters: 1700, epoch: 9 | loss: 0.2977477
	speed: 0.0317s/iter; left time: 817.1923s
	iters: 1800, epoch: 9 | loss: 0.3517058
	speed: 0.0317s/iter; left time: 816.3210s
	iters: 1900, epoch: 9 | loss: 0.2252051
	speed: 0.0317s/iter; left time: 810.9401s
	iters: 2000, epoch: 9 | loss: 0.2260090
	speed: 0.0317s/iter; left time: 807.7118s
	iters: 2100, epoch: 9 | loss: 0.3133208
	speed: 0.0318s/iter; left time: 807.1660s
	iters: 2200, epoch: 9 | loss: 0.3203738
	speed: 0.0316s/iter; left time: 799.2409s
Epoch: 9 cost time: 72.48034143447876
Epoch: 9, Steps: 2293 | Train Loss: 0.4506025 Vali Loss: 0.4208435 Test Loss: 0.1649347
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.7461423
	speed: 0.1103s/iter; left time: 2771.4345s
	iters: 200, epoch: 10 | loss: 0.3612185
	speed: 0.0317s/iter; left time: 792.1539s
	iters: 300, epoch: 10 | loss: 0.3448315
	speed: 0.0316s/iter; left time: 787.1864s
	iters: 400, epoch: 10 | loss: 0.3346122
	speed: 0.0316s/iter; left time: 785.4019s
	iters: 500, epoch: 10 | loss: 2.1577063
	speed: 0.0318s/iter; left time: 786.9424s
	iters: 600, epoch: 10 | loss: 0.2422557
	speed: 0.0318s/iter; left time: 782.9772s
	iters: 700, epoch: 10 | loss: 0.6529748
	speed: 0.0318s/iter; left time: 779.5605s
	iters: 800, epoch: 10 | loss: 0.4944886
	speed: 0.0318s/iter; left time: 776.9647s
	iters: 900, epoch: 10 | loss: 0.4516294
	speed: 0.0317s/iter; left time: 771.5112s
	iters: 1000, epoch: 10 | loss: 0.2182794
	speed: 0.0319s/iter; left time: 772.6955s
	iters: 1100, epoch: 10 | loss: 0.2617745
	speed: 0.0318s/iter; left time: 766.5988s
	iters: 1200, epoch: 10 | loss: 0.2665807
	speed: 0.0316s/iter; left time: 759.8275s
	iters: 1300, epoch: 10 | loss: 0.3427423
	speed: 0.0318s/iter; left time: 760.8457s
	iters: 1400, epoch: 10 | loss: 0.5654427
	speed: 0.0318s/iter; left time: 757.7390s
	iters: 1500, epoch: 10 | loss: 0.2185467
	speed: 0.0317s/iter; left time: 752.0491s
	iters: 1600, epoch: 10 | loss: 0.6475117
	speed: 0.0316s/iter; left time: 745.8505s
	iters: 1700, epoch: 10 | loss: 0.5843981
	speed: 0.0318s/iter; left time: 748.1016s
	iters: 1800, epoch: 10 | loss: 0.3025993
	speed: 0.0316s/iter; left time: 739.5561s
	iters: 1900, epoch: 10 | loss: 0.3961207
	speed: 0.0317s/iter; left time: 739.2677s
	iters: 2000, epoch: 10 | loss: 0.2766314
	speed: 0.0317s/iter; left time: 735.8612s
	iters: 2100, epoch: 10 | loss: 0.2032689
	speed: 0.0317s/iter; left time: 731.9799s
	iters: 2200, epoch: 10 | loss: 0.3939442
	speed: 0.0314s/iter; left time: 723.4833s
Epoch: 10 cost time: 72.49304389953613
Epoch: 10, Steps: 2293 | Train Loss: 0.4495946 Vali Loss: 0.4203660 Test Loss: 0.1647433
EarlyStopping counter: 2 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.2942519
	speed: 0.1091s/iter; left time: 2489.7385s
	iters: 200, epoch: 11 | loss: 0.6530109
	speed: 0.0315s/iter; left time: 717.1355s
	iters: 300, epoch: 11 | loss: 0.6865046
	speed: 0.0317s/iter; left time: 717.5994s
	iters: 400, epoch: 11 | loss: 0.5399866
	speed: 0.0316s/iter; left time: 712.3014s
	iters: 500, epoch: 11 | loss: 0.2768702
	speed: 0.0316s/iter; left time: 708.8250s
	iters: 600, epoch: 11 | loss: 0.5364822
	speed: 0.0316s/iter; left time: 704.8828s
	iters: 700, epoch: 11 | loss: 0.2885266
	speed: 0.0318s/iter; left time: 705.8666s
	iters: 800, epoch: 11 | loss: 0.3678828
	speed: 0.0316s/iter; left time: 699.3224s
	iters: 900, epoch: 11 | loss: 0.3429290
	speed: 0.0317s/iter; left time: 698.4185s
	iters: 1000, epoch: 11 | loss: 0.3838115
	speed: 0.0316s/iter; left time: 693.6848s
	iters: 1100, epoch: 11 | loss: 0.5623679
	speed: 0.0317s/iter; left time: 692.6494s
	iters: 1200, epoch: 11 | loss: 0.2448577
	speed: 0.0317s/iter; left time: 689.9128s
	iters: 1300, epoch: 11 | loss: 0.2535723
	speed: 0.0317s/iter; left time: 684.7367s
	iters: 1400, epoch: 11 | loss: 0.5667973
	speed: 0.0317s/iter; left time: 681.6187s
	iters: 1500, epoch: 11 | loss: 0.2509103
	speed: 0.0318s/iter; left time: 681.2913s
	iters: 1600, epoch: 11 | loss: 2.6573875
	speed: 0.0318s/iter; left time: 678.2313s
	iters: 1700, epoch: 11 | loss: 0.2647386
	speed: 0.0317s/iter; left time: 673.6079s
	iters: 1800, epoch: 11 | loss: 0.3656803
	speed: 0.0318s/iter; left time: 670.9101s
	iters: 1900, epoch: 11 | loss: 1.1530230
	speed: 0.0315s/iter; left time: 663.3925s
	iters: 2000, epoch: 11 | loss: 0.4186500
	speed: 0.0316s/iter; left time: 661.5758s
	iters: 2100, epoch: 11 | loss: 0.2578749
	speed: 0.0319s/iter; left time: 663.5036s
	iters: 2200, epoch: 11 | loss: 0.4750715
	speed: 0.0313s/iter; left time: 648.1970s
Epoch: 11 cost time: 72.44738388061523
Epoch: 11, Steps: 2293 | Train Loss: 0.4492327 Vali Loss: 0.4202702 Test Loss: 0.1645301
EarlyStopping counter: 3 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.2116408
	speed: 0.1033s/iter; left time: 2122.0636s
	iters: 200, epoch: 12 | loss: 0.7208953
	speed: 0.0267s/iter; left time: 544.9988s
	iters: 300, epoch: 12 | loss: 0.3201417
	speed: 0.0255s/iter; left time: 519.5704s
	iters: 400, epoch: 12 | loss: 0.2493934
	speed: 0.0255s/iter; left time: 515.6508s
	iters: 500, epoch: 12 | loss: 0.5382900
	speed: 0.0254s/iter; left time: 510.9364s
	iters: 600, epoch: 12 | loss: 0.3847526
	speed: 0.0253s/iter; left time: 507.1019s
	iters: 700, epoch: 12 | loss: 0.3015423
	speed: 0.0252s/iter; left time: 501.9725s
	iters: 800, epoch: 12 | loss: 0.2308293
	speed: 0.0254s/iter; left time: 503.3303s
	iters: 900, epoch: 12 | loss: 0.2804829
	speed: 0.0253s/iter; left time: 500.1929s
	iters: 1000, epoch: 12 | loss: 0.3349172
	speed: 0.0252s/iter; left time: 495.5389s
	iters: 1100, epoch: 12 | loss: 0.9025812
	speed: 0.0254s/iter; left time: 495.4547s
	iters: 1200, epoch: 12 | loss: 0.2106659
	speed: 0.0253s/iter; left time: 491.7458s
	iters: 1300, epoch: 12 | loss: 0.3795932
	speed: 0.0254s/iter; left time: 490.8437s
	iters: 1400, epoch: 12 | loss: 0.3045219
	speed: 0.0254s/iter; left time: 489.0700s
	iters: 1500, epoch: 12 | loss: 1.7461042
	speed: 0.0252s/iter; left time: 482.4039s
	iters: 1600, epoch: 12 | loss: 0.3420970
	speed: 0.0253s/iter; left time: 481.1110s
	iters: 1700, epoch: 12 | loss: 0.2513257
	speed: 0.0252s/iter; left time: 478.0512s
	iters: 1800, epoch: 12 | loss: 0.2062547
	speed: 0.0253s/iter; left time: 477.0015s
	iters: 1900, epoch: 12 | loss: 0.2996858
	speed: 0.0254s/iter; left time: 475.2369s
	iters: 2000, epoch: 12 | loss: 0.6353488
	speed: 0.0254s/iter; left time: 472.5649s
	iters: 2100, epoch: 12 | loss: 0.2934419
	speed: 0.0252s/iter; left time: 466.7048s
	iters: 2200, epoch: 12 | loss: 0.3757085
	speed: 0.0251s/iter; left time: 462.3530s
Epoch: 12 cost time: 58.28918957710266
Epoch: 12, Steps: 2293 | Train Loss: 0.4490883 Vali Loss: 0.4205997 Test Loss: 0.1644961
EarlyStopping counter: 4 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 2.4744234
	speed: 0.0716s/iter; left time: 1307.0494s
	iters: 200, epoch: 13 | loss: 0.7218189
	speed: 0.0170s/iter; left time: 308.5906s
	iters: 300, epoch: 13 | loss: 0.5241480
	speed: 0.0154s/iter; left time: 277.6601s
	iters: 400, epoch: 13 | loss: 0.4050723
	speed: 0.0128s/iter; left time: 230.0764s
	iters: 500, epoch: 13 | loss: 0.2777843
	speed: 0.0124s/iter; left time: 221.0723s
	iters: 600, epoch: 13 | loss: 0.4973761
	speed: 0.0126s/iter; left time: 223.8513s
	iters: 700, epoch: 13 | loss: 0.3952642
	speed: 0.0129s/iter; left time: 226.8869s
	iters: 800, epoch: 13 | loss: 0.4112532
	speed: 0.0129s/iter; left time: 226.0188s
	iters: 900, epoch: 13 | loss: 0.6486742
	speed: 0.0129s/iter; left time: 224.8765s
	iters: 1000, epoch: 13 | loss: 0.3608235
	speed: 0.0127s/iter; left time: 219.7968s
	iters: 1100, epoch: 13 | loss: 0.3019825
	speed: 0.0126s/iter; left time: 216.8764s
	iters: 1200, epoch: 13 | loss: 0.7857562
	speed: 0.0126s/iter; left time: 215.7505s
	iters: 1300, epoch: 13 | loss: 0.2344577
	speed: 0.0122s/iter; left time: 208.4409s
	iters: 1400, epoch: 13 | loss: 0.4226081
	speed: 0.0125s/iter; left time: 212.3294s
	iters: 1500, epoch: 13 | loss: 0.4651970
	speed: 0.0122s/iter; left time: 205.9237s
	iters: 1600, epoch: 13 | loss: 0.2045939
	speed: 0.0125s/iter; left time: 209.8235s
	iters: 1700, epoch: 13 | loss: 0.4762688
	speed: 0.0126s/iter; left time: 209.5022s
	iters: 1800, epoch: 13 | loss: 0.3970130
	speed: 0.0123s/iter; left time: 202.7444s
	iters: 1900, epoch: 13 | loss: 0.5181998
	speed: 0.0126s/iter; left time: 207.7490s
	iters: 2000, epoch: 13 | loss: 0.4112282
	speed: 0.0129s/iter; left time: 211.4627s
	iters: 2100, epoch: 13 | loss: 0.3212174
	speed: 0.0127s/iter; left time: 206.1903s
	iters: 2200, epoch: 13 | loss: 0.2600420
	speed: 0.0127s/iter; left time: 204.9479s
Epoch: 13 cost time: 29.762978076934814
Epoch: 13, Steps: 2293 | Train Loss: 0.4490135 Vali Loss: 0.4191908 Test Loss: 0.1645590
EarlyStopping counter: 5 out of 5
Early stopping
Total training time: 951.0999 seconds
>>>>>>>testing : weather_96_96_NLinear_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed10458<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
mse:0.16581183671951294, mae:0.21000009775161743
