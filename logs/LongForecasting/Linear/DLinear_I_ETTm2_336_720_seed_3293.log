Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='DLinear', model_id='ETTm2_336_720', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=720, root_path='./dataset/', save_pred_values=False, seed=3293, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTm2_336_720_DLinear_ETTm2_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3293>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33505
val 10801
test 10801
	iters: 100, epoch: 1 | loss: 0.3891239
	speed: 0.0382s/iter; left time: 795.6255s
	iters: 200, epoch: 1 | loss: 0.6871812
	speed: 0.0387s/iter; left time: 802.5043s
	iters: 300, epoch: 1 | loss: 0.5873541
	speed: 0.0325s/iter; left time: 671.5351s
	iters: 400, epoch: 1 | loss: 0.7516749
	speed: 0.0372s/iter; left time: 764.1097s
	iters: 500, epoch: 1 | loss: 0.9514443
	speed: 0.0396s/iter; left time: 809.1472s
	iters: 600, epoch: 1 | loss: 0.6779397
	speed: 0.0366s/iter; left time: 745.0870s
	iters: 700, epoch: 1 | loss: 0.6132320
	speed: 0.0383s/iter; left time: 775.7913s
	iters: 800, epoch: 1 | loss: 0.6396636
	speed: 0.0360s/iter; left time: 725.4958s
	iters: 900, epoch: 1 | loss: 0.6106949
	speed: 0.0388s/iter; left time: 777.2726s
	iters: 1000, epoch: 1 | loss: 0.6411234
	speed: 0.0353s/iter; left time: 703.8686s
Epoch: 1 cost time: 38.71137189865112
Epoch: 1, Steps: 1047 | Train Loss: 0.7683224 Vali Loss: 0.5543185 Test Loss: 1.0954590
Validation loss decreased (inf --> 0.554319).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.8981749
	speed: 0.1107s/iter; left time: 2190.4083s
	iters: 200, epoch: 2 | loss: 0.8646427
	speed: 0.0384s/iter; left time: 756.0965s
	iters: 300, epoch: 2 | loss: 1.0710291
	speed: 0.0380s/iter; left time: 744.5762s
	iters: 400, epoch: 2 | loss: 1.0918157
	speed: 0.0350s/iter; left time: 681.5958s
	iters: 500, epoch: 2 | loss: 0.6056423
	speed: 0.0365s/iter; left time: 707.9558s
	iters: 600, epoch: 2 | loss: 0.8068516
	speed: 0.0345s/iter; left time: 665.9382s
	iters: 700, epoch: 2 | loss: 0.6279806
	speed: 0.0376s/iter; left time: 721.6016s
	iters: 800, epoch: 2 | loss: 1.1832896
	speed: 0.0347s/iter; left time: 663.1499s
	iters: 900, epoch: 2 | loss: 0.7432367
	speed: 0.0366s/iter; left time: 695.7576s
	iters: 1000, epoch: 2 | loss: 0.4488293
	speed: 0.0366s/iter; left time: 690.9804s
Epoch: 2 cost time: 37.900575399398804
Epoch: 2, Steps: 1047 | Train Loss: 0.7930214 Vali Loss: 0.6297527 Test Loss: 1.4211321
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.6585324
	speed: 0.1162s/iter; left time: 2178.5167s
	iters: 200, epoch: 3 | loss: 0.6135232
	speed: 0.0348s/iter; left time: 648.9878s
	iters: 300, epoch: 3 | loss: 0.6359190
	speed: 0.0343s/iter; left time: 636.1306s
	iters: 400, epoch: 3 | loss: 0.3987835
	speed: 0.0357s/iter; left time: 658.1223s
	iters: 500, epoch: 3 | loss: 0.4738843
	speed: 0.0371s/iter; left time: 680.1947s
	iters: 600, epoch: 3 | loss: 0.5911337
	speed: 0.0363s/iter; left time: 662.5977s
	iters: 700, epoch: 3 | loss: 0.7211424
	speed: 0.0362s/iter; left time: 657.4069s
	iters: 800, epoch: 3 | loss: 0.5789920
	speed: 0.0370s/iter; left time: 667.7535s
	iters: 900, epoch: 3 | loss: 0.4306528
	speed: 0.0364s/iter; left time: 653.9827s
	iters: 1000, epoch: 3 | loss: 0.5842883
	speed: 0.0383s/iter; left time: 683.7417s
Epoch: 3 cost time: 37.88365817070007
Epoch: 3, Steps: 1047 | Train Loss: 0.5708737 Vali Loss: 0.5319602 Test Loss: 1.2622249
Validation loss decreased (0.554319 --> 0.531960).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.3384748
	speed: 0.1142s/iter; left time: 2021.8627s
	iters: 200, epoch: 4 | loss: 0.6462902
	speed: 0.0351s/iter; left time: 617.5385s
	iters: 300, epoch: 4 | loss: 0.4512437
	speed: 0.0351s/iter; left time: 613.5454s
	iters: 400, epoch: 4 | loss: 0.7340281
	speed: 0.0319s/iter; left time: 555.1058s
	iters: 500, epoch: 4 | loss: 0.6897582
	speed: 0.0331s/iter; left time: 571.8546s
	iters: 600, epoch: 4 | loss: 0.6233299
	speed: 0.0349s/iter; left time: 599.7165s
	iters: 700, epoch: 4 | loss: 0.4415179
	speed: 0.0344s/iter; left time: 589.0370s
	iters: 800, epoch: 4 | loss: 0.5279679
	speed: 0.0368s/iter; left time: 626.2402s
	iters: 900, epoch: 4 | loss: 0.2904793
	speed: 0.0383s/iter; left time: 647.3908s
	iters: 1000, epoch: 4 | loss: 0.7038971
	speed: 0.0382s/iter; left time: 642.0506s
Epoch: 4 cost time: 36.974250078201294
Epoch: 4, Steps: 1047 | Train Loss: 0.5129141 Vali Loss: 0.4845453 Test Loss: 1.0328388
Validation loss decreased (0.531960 --> 0.484545).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.4049814
	speed: 0.1209s/iter; left time: 2013.6702s
	iters: 200, epoch: 5 | loss: 0.3365990
	speed: 0.0377s/iter; left time: 623.2496s
	iters: 300, epoch: 5 | loss: 0.3579605
	speed: 0.0379s/iter; left time: 624.3776s
	iters: 400, epoch: 5 | loss: 0.4612244
	speed: 0.0385s/iter; left time: 629.1412s
	iters: 500, epoch: 5 | loss: 0.3214812
	speed: 0.0358s/iter; left time: 582.1539s
	iters: 600, epoch: 5 | loss: 0.5139861
	speed: 0.0351s/iter; left time: 567.6553s
	iters: 700, epoch: 5 | loss: 0.6560148
	speed: 0.0371s/iter; left time: 595.7025s
	iters: 800, epoch: 5 | loss: 0.4571609
	speed: 0.0335s/iter; left time: 533.9444s
	iters: 900, epoch: 5 | loss: 0.3247990
	speed: 0.0384s/iter; left time: 608.9331s
	iters: 1000, epoch: 5 | loss: 0.5771769
	speed: 0.0379s/iter; left time: 596.6603s
Epoch: 5 cost time: 38.06605005264282
Epoch: 5, Steps: 1047 | Train Loss: 0.4824365 Vali Loss: 0.4127087 Test Loss: 0.7805230
Validation loss decreased (0.484545 --> 0.412709).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.2363062
	speed: 0.1217s/iter; left time: 1899.1677s
	iters: 200, epoch: 6 | loss: 0.4263672
	speed: 0.0342s/iter; left time: 530.8351s
	iters: 300, epoch: 6 | loss: 0.5044023
	speed: 0.0376s/iter; left time: 579.6684s
	iters: 400, epoch: 6 | loss: 0.3514676
	speed: 0.0353s/iter; left time: 539.8098s
	iters: 500, epoch: 6 | loss: 0.6988209
	speed: 0.0355s/iter; left time: 540.4972s
	iters: 600, epoch: 6 | loss: 0.7421708
	speed: 0.0372s/iter; left time: 561.6133s
	iters: 700, epoch: 6 | loss: 0.5407985
	speed: 0.0390s/iter; left time: 585.9197s
	iters: 800, epoch: 6 | loss: 0.3667398
	speed: 0.0379s/iter; left time: 564.3695s
	iters: 900, epoch: 6 | loss: 0.5293539
	speed: 0.0363s/iter; left time: 538.0616s
	iters: 1000, epoch: 6 | loss: 0.3048375
	speed: 0.0391s/iter; left time: 575.6073s
Epoch: 6 cost time: 38.538689613342285
Epoch: 6, Steps: 1047 | Train Loss: 0.4671599 Vali Loss: 0.4942373 Test Loss: 1.1004025
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.5197541
	speed: 0.1117s/iter; left time: 1625.9355s
	iters: 200, epoch: 7 | loss: 0.6431720
	speed: 0.0365s/iter; left time: 527.1769s
	iters: 300, epoch: 7 | loss: 0.5943224
	speed: 0.0382s/iter; left time: 548.7622s
	iters: 400, epoch: 7 | loss: 0.3196558
	speed: 0.0328s/iter; left time: 467.8974s
	iters: 500, epoch: 7 | loss: 0.6750100
	speed: 0.0377s/iter; left time: 533.1217s
	iters: 600, epoch: 7 | loss: 0.6784947
	speed: 0.0392s/iter; left time: 550.4951s
	iters: 700, epoch: 7 | loss: 0.4116851
	speed: 0.0381s/iter; left time: 531.7443s
	iters: 800, epoch: 7 | loss: 0.6027939
	speed: 0.0371s/iter; left time: 513.6782s
	iters: 900, epoch: 7 | loss: 0.8506756
	speed: 0.0379s/iter; left time: 521.7326s
	iters: 1000, epoch: 7 | loss: 0.5669991
	speed: 0.0354s/iter; left time: 483.9101s
Epoch: 7 cost time: 38.130274534225464
Epoch: 7, Steps: 1047 | Train Loss: 0.4594209 Vali Loss: 0.4052431 Test Loss: 0.7926836
Validation loss decreased (0.412709 --> 0.405243).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.4337837
	speed: 0.1114s/iter; left time: 1505.7938s
	iters: 200, epoch: 8 | loss: 0.3679005
	speed: 0.0370s/iter; left time: 496.3788s
	iters: 300, epoch: 8 | loss: 0.6359249
	speed: 0.0388s/iter; left time: 516.9339s
	iters: 400, epoch: 8 | loss: 0.5054195
	speed: 0.0369s/iter; left time: 486.9122s
	iters: 500, epoch: 8 | loss: 0.6899284
	speed: 0.0362s/iter; left time: 475.1774s
	iters: 600, epoch: 8 | loss: 0.5577830
	speed: 0.0391s/iter; left time: 509.1142s
	iters: 700, epoch: 8 | loss: 0.5097186
	speed: 0.0362s/iter; left time: 467.5255s
	iters: 800, epoch: 8 | loss: 0.5308313
	speed: 0.0368s/iter; left time: 471.4545s
	iters: 900, epoch: 8 | loss: 0.1893464
	speed: 0.0365s/iter; left time: 463.5985s
	iters: 1000, epoch: 8 | loss: 0.7623106
	speed: 0.0390s/iter; left time: 491.8130s
Epoch: 8 cost time: 38.52613353729248
Epoch: 8, Steps: 1047 | Train Loss: 0.4540704 Vali Loss: 0.4507062 Test Loss: 0.9812078
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.4556967
	speed: 0.1150s/iter; left time: 1433.7618s
	iters: 200, epoch: 9 | loss: 0.4189068
	speed: 0.0384s/iter; left time: 474.8222s
	iters: 300, epoch: 9 | loss: 0.5189342
	speed: 0.0368s/iter; left time: 451.2674s
	iters: 400, epoch: 9 | loss: 0.5609856
	speed: 0.0372s/iter; left time: 452.6433s
	iters: 500, epoch: 9 | loss: 0.6763846
	speed: 0.0368s/iter; left time: 443.7145s
	iters: 600, epoch: 9 | loss: 0.3117277
	speed: 0.0352s/iter; left time: 421.4966s
	iters: 700, epoch: 9 | loss: 0.3499146
	speed: 0.0370s/iter; left time: 439.5805s
	iters: 800, epoch: 9 | loss: 0.8475447
	speed: 0.0389s/iter; left time: 458.0787s
	iters: 900, epoch: 9 | loss: 0.4869269
	speed: 0.0388s/iter; left time: 452.0624s
	iters: 1000, epoch: 9 | loss: 0.5498643
	speed: 0.0359s/iter; left time: 415.4709s
Epoch: 9 cost time: 38.36925220489502
Epoch: 9, Steps: 1047 | Train Loss: 0.4512505 Vali Loss: 0.4066351 Test Loss: 0.8055215
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.4357719
	speed: 0.1177s/iter; left time: 1344.1386s
	iters: 200, epoch: 10 | loss: 0.6670089
	speed: 0.0340s/iter; left time: 384.6346s
	iters: 300, epoch: 10 | loss: 0.5267224
	speed: 0.0351s/iter; left time: 393.8940s
	iters: 400, epoch: 10 | loss: 0.4605407
	speed: 0.0331s/iter; left time: 368.5284s
	iters: 500, epoch: 10 | loss: 0.3704385
	speed: 0.0314s/iter; left time: 345.9408s
	iters: 600, epoch: 10 | loss: 0.3354715
	speed: 0.0343s/iter; left time: 374.6641s
	iters: 700, epoch: 10 | loss: 0.3235565
	speed: 0.0379s/iter; left time: 410.2566s
	iters: 800, epoch: 10 | loss: 0.7282938
	speed: 0.0355s/iter; left time: 381.0238s
	iters: 900, epoch: 10 | loss: 0.4354112
	speed: 0.0382s/iter; left time: 405.8441s
	iters: 1000, epoch: 10 | loss: 0.2888127
	speed: 0.0341s/iter; left time: 358.4336s
Epoch: 10 cost time: 36.14013385772705
Epoch: 10, Steps: 1047 | Train Loss: 0.4500810 Vali Loss: 0.3961813 Test Loss: 0.7862291
Validation loss decreased (0.405243 --> 0.396181).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.2502159
	speed: 0.1111s/iter; left time: 1152.3364s
	iters: 200, epoch: 11 | loss: 0.5589887
	speed: 0.0360s/iter; left time: 370.0260s
	iters: 300, epoch: 11 | loss: 0.4635718
	speed: 0.0324s/iter; left time: 329.2309s
	iters: 400, epoch: 11 | loss: 0.4551547
	speed: 0.0335s/iter; left time: 337.5994s
	iters: 500, epoch: 11 | loss: 0.3770396
	speed: 0.0374s/iter; left time: 372.7269s
	iters: 600, epoch: 11 | loss: 0.3691086
	speed: 0.0362s/iter; left time: 357.3105s
	iters: 700, epoch: 11 | loss: 0.2469987
	speed: 0.0348s/iter; left time: 339.6736s
	iters: 800, epoch: 11 | loss: 0.4498608
	speed: 0.0338s/iter; left time: 326.3980s
	iters: 900, epoch: 11 | loss: 0.3102902
	speed: 0.0342s/iter; left time: 327.4171s
	iters: 1000, epoch: 11 | loss: 0.6473098
	speed: 0.0335s/iter; left time: 316.8444s
Epoch: 11 cost time: 35.91125226020813
Epoch: 11, Steps: 1047 | Train Loss: 0.4492939 Vali Loss: 0.4091799 Test Loss: 0.8239330
EarlyStopping counter: 1 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.3080809
	speed: 0.1071s/iter; left time: 998.7290s
	iters: 200, epoch: 12 | loss: 0.3319539
	speed: 0.0321s/iter; left time: 295.8411s
	iters: 300, epoch: 12 | loss: 0.4673398
	speed: 0.0331s/iter; left time: 302.2790s
	iters: 400, epoch: 12 | loss: 0.5299729
	speed: 0.0309s/iter; left time: 278.4793s
	iters: 500, epoch: 12 | loss: 0.4313182
	speed: 0.0298s/iter; left time: 266.0005s
	iters: 600, epoch: 12 | loss: 0.2312263
	speed: 0.0309s/iter; left time: 272.5564s
	iters: 700, epoch: 12 | loss: 0.2921417
	speed: 0.0306s/iter; left time: 266.6195s
	iters: 800, epoch: 12 | loss: 0.2734225
	speed: 0.0302s/iter; left time: 260.4296s
	iters: 900, epoch: 12 | loss: 0.2945175
	speed: 0.0317s/iter; left time: 270.0721s
	iters: 1000, epoch: 12 | loss: 0.4794521
	speed: 0.0301s/iter; left time: 253.7169s
Epoch: 12 cost time: 32.22517275810242
Epoch: 12, Steps: 1047 | Train Loss: 0.4489473 Vali Loss: 0.4010152 Test Loss: 0.7980157
EarlyStopping counter: 2 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.3102299
	speed: 0.1026s/iter; left time: 849.4003s
	iters: 200, epoch: 13 | loss: 0.5038100
	speed: 0.0302s/iter; left time: 246.5580s
	iters: 300, epoch: 13 | loss: 0.5772868
	speed: 0.0288s/iter; left time: 233.0095s
	iters: 400, epoch: 13 | loss: 0.3501610
	speed: 0.0283s/iter; left time: 225.4512s
	iters: 500, epoch: 13 | loss: 0.5155796
	speed: 0.0285s/iter; left time: 224.1776s
	iters: 600, epoch: 13 | loss: 0.6327151
	speed: 0.0283s/iter; left time: 219.9299s
	iters: 700, epoch: 13 | loss: 0.5609261
	speed: 0.0279s/iter; left time: 214.3494s
	iters: 800, epoch: 13 | loss: 0.5140316
	speed: 0.0286s/iter; left time: 216.7604s
	iters: 900, epoch: 13 | loss: 0.2568356
	speed: 0.0280s/iter; left time: 209.3699s
	iters: 1000, epoch: 13 | loss: 0.4383776
	speed: 0.0266s/iter; left time: 196.1871s
Epoch: 13 cost time: 29.4206600189209
Epoch: 13, Steps: 1047 | Train Loss: 0.4487326 Vali Loss: 0.4048588 Test Loss: 0.8147359
EarlyStopping counter: 3 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 14 | loss: 0.2532107
	speed: 0.1003s/iter; left time: 725.4497s
	iters: 200, epoch: 14 | loss: 0.3978464
	speed: 0.0291s/iter; left time: 207.5180s
	iters: 300, epoch: 14 | loss: 0.3153845
	speed: 0.0279s/iter; left time: 195.8203s
	iters: 400, epoch: 14 | loss: 0.3599997
	speed: 0.0280s/iter; left time: 193.9612s
	iters: 500, epoch: 14 | loss: 0.2642004
	speed: 0.0281s/iter; left time: 192.2210s
	iters: 600, epoch: 14 | loss: 0.6812286
	speed: 0.0279s/iter; left time: 187.7836s
	iters: 700, epoch: 14 | loss: 0.6127896
	speed: 0.0285s/iter; left time: 188.9447s
	iters: 800, epoch: 14 | loss: 0.4235287
	speed: 0.0284s/iter; left time: 185.6874s
	iters: 900, epoch: 14 | loss: 0.4209125
	speed: 0.0288s/iter; left time: 185.4505s
	iters: 1000, epoch: 14 | loss: 0.2756873
	speed: 0.0271s/iter; left time: 171.7272s
Epoch: 14 cost time: 29.40301251411438
Epoch: 14, Steps: 1047 | Train Loss: 0.4485840 Vali Loss: 0.4088848 Test Loss: 0.8281736
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 15 | loss: 0.6080466
	speed: 0.0932s/iter; left time: 576.4342s
	iters: 200, epoch: 15 | loss: 0.3193291
	speed: 0.0262s/iter; left time: 159.1186s
	iters: 300, epoch: 15 | loss: 0.3213515
	speed: 0.0250s/iter; left time: 149.4785s
	iters: 400, epoch: 15 | loss: 0.4814737
	speed: 0.0237s/iter; left time: 139.6365s
	iters: 500, epoch: 15 | loss: 0.3617315
	speed: 0.0240s/iter; left time: 138.9565s
	iters: 600, epoch: 15 | loss: 0.4647622
	speed: 0.0241s/iter; left time: 136.7739s
	iters: 700, epoch: 15 | loss: 0.2988608
	speed: 0.0251s/iter; left time: 140.3140s
	iters: 800, epoch: 15 | loss: 0.3587951
	speed: 0.0250s/iter; left time: 137.3095s
	iters: 900, epoch: 15 | loss: 0.3850522
	speed: 0.0243s/iter; left time: 130.6283s
	iters: 1000, epoch: 15 | loss: 0.5951825
	speed: 0.0212s/iter; left time: 112.1379s
Epoch: 15 cost time: 25.50735378265381
Epoch: 15, Steps: 1047 | Train Loss: 0.4485549 Vali Loss: 0.4089229 Test Loss: 0.8277093
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTm2_336_720_DLinear_ETTm2_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3293<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10801
mse:0.7868765592575073, mae:0.5766467452049255
