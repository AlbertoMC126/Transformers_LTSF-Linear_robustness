Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='Linear', model_id='traffic_336_720', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=720, root_path='./dataset/', save_pred_values=False, seed=10458, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_336_720_Linear_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed10458>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11225
val 1037
test 2789
	iters: 100, epoch: 1 | loss: 0.4842747
	speed: 0.3452s/iter; left time: 4806.0190s
	iters: 200, epoch: 1 | loss: 0.5302681
	speed: 0.3313s/iter; left time: 4578.3757s
	iters: 300, epoch: 1 | loss: 0.5112680
	speed: 0.3305s/iter; left time: 4535.1553s
	iters: 400, epoch: 1 | loss: 0.5409867
	speed: 0.3297s/iter; left time: 4491.3240s
	iters: 500, epoch: 1 | loss: 0.5289946
	speed: 0.3297s/iter; left time: 4457.7344s
	iters: 600, epoch: 1 | loss: 0.4996039
	speed: 0.3318s/iter; left time: 4453.6685s
	iters: 700, epoch: 1 | loss: 0.4897781
	speed: 0.3300s/iter; left time: 4396.3090s
Epoch: 1 cost time: 233.37755036354065
Epoch: 1, Steps: 701 | Train Loss: 0.5128784 Vali Loss: 0.7081649 Test Loss: 0.8177464
Validation loss decreased (inf --> 0.708165).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.4987068
	speed: 0.6250s/iter; left time: 8262.2466s
	iters: 200, epoch: 2 | loss: 0.4960084
	speed: 0.3328s/iter; left time: 4366.8787s
	iters: 300, epoch: 2 | loss: 0.5100811
	speed: 0.3322s/iter; left time: 4324.9516s
	iters: 400, epoch: 2 | loss: 0.5112788
	speed: 0.3313s/iter; left time: 4280.4443s
	iters: 500, epoch: 2 | loss: 0.5265883
	speed: 0.3320s/iter; left time: 4256.3073s
	iters: 600, epoch: 2 | loss: 0.5193193
	speed: 0.3334s/iter; left time: 4241.0488s
	iters: 700, epoch: 2 | loss: 0.4754982
	speed: 0.3320s/iter; left time: 4189.2107s
Epoch: 2 cost time: 233.41818571090698
Epoch: 2, Steps: 701 | Train Loss: 0.5057922 Vali Loss: 0.6928853 Test Loss: 0.8091319
Validation loss decreased (0.708165 --> 0.692885).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.3530558
	speed: 0.6276s/iter; left time: 7857.1494s
	iters: 200, epoch: 3 | loss: 0.3675182
	speed: 0.3374s/iter; left time: 4190.0146s
	iters: 300, epoch: 3 | loss: 0.3373621
	speed: 0.3331s/iter; left time: 4103.1085s
	iters: 400, epoch: 3 | loss: 0.3664267
	speed: 0.3333s/iter; left time: 4072.2277s
	iters: 500, epoch: 3 | loss: 0.3593761
	speed: 0.3348s/iter; left time: 4057.3499s
	iters: 600, epoch: 3 | loss: 0.3606851
	speed: 0.3337s/iter; left time: 4010.9644s
	iters: 700, epoch: 3 | loss: 0.3806466
	speed: 0.3319s/iter; left time: 3955.3658s
Epoch: 3 cost time: 234.58520770072937
Epoch: 3, Steps: 701 | Train Loss: 0.3620280 Vali Loss: 0.5224258 Test Loss: 0.6073439
Validation loss decreased (0.692885 --> 0.522426).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.2956331
	speed: 0.6210s/iter; left time: 7338.4000s
	iters: 200, epoch: 4 | loss: 0.3178871
	speed: 0.3335s/iter; left time: 3908.4009s
	iters: 300, epoch: 4 | loss: 0.3324538
	speed: 0.3316s/iter; left time: 3852.4413s
	iters: 400, epoch: 4 | loss: 0.3353822
	speed: 0.3307s/iter; left time: 3808.7523s
	iters: 500, epoch: 4 | loss: 0.3279263
	speed: 0.3328s/iter; left time: 3799.9648s
	iters: 600, epoch: 4 | loss: 0.3162768
	speed: 0.3325s/iter; left time: 3762.8978s
	iters: 700, epoch: 4 | loss: 0.3016073
	speed: 0.3316s/iter; left time: 3719.5108s
Epoch: 4 cost time: 232.86822962760925
Epoch: 4, Steps: 701 | Train Loss: 0.3120540 Vali Loss: 0.4681768 Test Loss: 0.5406755
Validation loss decreased (0.522426 --> 0.468177).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.2883185
	speed: 0.6278s/iter; left time: 6979.3128s
	iters: 200, epoch: 5 | loss: 0.2951543
	speed: 0.3356s/iter; left time: 3696.9122s
	iters: 300, epoch: 5 | loss: 0.2706459
	speed: 0.3326s/iter; left time: 3631.0914s
	iters: 400, epoch: 5 | loss: 0.2733572
	speed: 0.3300s/iter; left time: 3570.0146s
	iters: 500, epoch: 5 | loss: 0.3099089
	speed: 0.3300s/iter; left time: 3536.6516s
	iters: 600, epoch: 5 | loss: 0.2790748
	speed: 0.3305s/iter; left time: 3508.6366s
	iters: 700, epoch: 5 | loss: 0.2943581
	speed: 0.3301s/iter; left time: 3471.3524s
Epoch: 5 cost time: 233.02720499038696
Epoch: 5, Steps: 701 | Train Loss: 0.2903473 Vali Loss: 0.4419713 Test Loss: 0.5087638
Validation loss decreased (0.468177 --> 0.441971).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.2530746
	speed: 0.6279s/iter; left time: 6539.9036s
	iters: 200, epoch: 6 | loss: 0.2668165
	speed: 0.3326s/iter; left time: 3431.4650s
	iters: 300, epoch: 6 | loss: 0.2869164
	speed: 0.3304s/iter; left time: 3374.9080s
	iters: 400, epoch: 6 | loss: 0.3003140
	speed: 0.3301s/iter; left time: 3338.9387s
	iters: 500, epoch: 6 | loss: 0.2809800
	speed: 0.3302s/iter; left time: 3306.8630s
	iters: 600, epoch: 6 | loss: 0.2585745
	speed: 0.3306s/iter; left time: 3278.5451s
	iters: 700, epoch: 6 | loss: 0.2967641
	speed: 0.3305s/iter; left time: 3244.1558s
Epoch: 6 cost time: 232.45243906974792
Epoch: 6, Steps: 701 | Train Loss: 0.2789328 Vali Loss: 0.4301503 Test Loss: 0.4949624
Validation loss decreased (0.441971 --> 0.430150).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.2766674
	speed: 0.6240s/iter; left time: 6062.3070s
	iters: 200, epoch: 7 | loss: 0.2875239
	speed: 0.3350s/iter; left time: 3221.0599s
	iters: 300, epoch: 7 | loss: 0.2694762
	speed: 0.3318s/iter; left time: 3157.5272s
	iters: 400, epoch: 7 | loss: 0.2602524
	speed: 0.3328s/iter; left time: 3133.7126s
	iters: 500, epoch: 7 | loss: 0.2887141
	speed: 0.3313s/iter; left time: 3086.3731s
	iters: 600, epoch: 7 | loss: 0.2644410
	speed: 0.3321s/iter; left time: 3060.1082s
	iters: 700, epoch: 7 | loss: 0.2544501
	speed: 0.3301s/iter; left time: 3008.9289s
Epoch: 7 cost time: 233.15613293647766
Epoch: 7, Steps: 701 | Train Loss: 0.2727600 Vali Loss: 0.4250833 Test Loss: 0.4898479
Validation loss decreased (0.430150 --> 0.425083).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.2764615
	speed: 0.6217s/iter; left time: 5603.6747s
	iters: 200, epoch: 8 | loss: 0.2586387
	speed: 0.3333s/iter; left time: 2970.6669s
	iters: 300, epoch: 8 | loss: 0.2627148
	speed: 0.3308s/iter; left time: 2915.4086s
	iters: 400, epoch: 8 | loss: 0.2654760
	speed: 0.3306s/iter; left time: 2881.1447s
	iters: 500, epoch: 8 | loss: 0.2825001
	speed: 0.3301s/iter; left time: 2843.4908s
	iters: 600, epoch: 8 | loss: 0.2675939
	speed: 0.3302s/iter; left time: 2811.7374s
	iters: 700, epoch: 8 | loss: 0.3025263
	speed: 0.3306s/iter; left time: 2781.3423s
Epoch: 8 cost time: 232.17909359931946
Epoch: 8, Steps: 701 | Train Loss: 0.2693479 Vali Loss: 0.4224381 Test Loss: 0.4855165
Validation loss decreased (0.425083 --> 0.422438).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.2588545
	speed: 0.6246s/iter; left time: 5192.3588s
	iters: 200, epoch: 9 | loss: 0.2914517
	speed: 0.3336s/iter; left time: 2739.9851s
	iters: 300, epoch: 9 | loss: 0.2659473
	speed: 0.3311s/iter; left time: 2686.0555s
	iters: 400, epoch: 9 | loss: 0.2554485
	speed: 0.3315s/iter; left time: 2656.3120s
	iters: 500, epoch: 9 | loss: 0.2511168
	speed: 0.3306s/iter; left time: 2616.1418s
	iters: 600, epoch: 9 | loss: 0.2722719
	speed: 0.3315s/iter; left time: 2590.1226s
	iters: 700, epoch: 9 | loss: 0.2664880
	speed: 0.3306s/iter; left time: 2549.8366s
Epoch: 9 cost time: 232.79762625694275
Epoch: 9, Steps: 701 | Train Loss: 0.2674861 Vali Loss: 0.4210910 Test Loss: 0.4839478
Validation loss decreased (0.422438 --> 0.421091).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.2599150
	speed: 0.6286s/iter; left time: 4784.6138s
	iters: 200, epoch: 10 | loss: 0.2779571
	speed: 0.3347s/iter; left time: 2514.2601s
	iters: 300, epoch: 10 | loss: 0.2485066
	speed: 0.3328s/iter; left time: 2466.4841s
	iters: 400, epoch: 10 | loss: 0.2752303
	speed: 0.3331s/iter; left time: 2435.6872s
	iters: 500, epoch: 10 | loss: 0.2570752
	speed: 0.3336s/iter; left time: 2406.1362s
	iters: 600, epoch: 10 | loss: 0.2522216
	speed: 0.3330s/iter; left time: 2368.1284s
	iters: 700, epoch: 10 | loss: 0.2569704
	speed: 0.3309s/iter; left time: 2320.5911s
Epoch: 10 cost time: 233.97974371910095
Epoch: 10, Steps: 701 | Train Loss: 0.2664881 Vali Loss: 0.4204749 Test Loss: 0.4832271
Validation loss decreased (0.421091 --> 0.420475).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.2574458
	speed: 0.6263s/iter; left time: 4328.6750s
	iters: 200, epoch: 11 | loss: 0.2652703
	speed: 0.3357s/iter; left time: 2286.5032s
	iters: 300, epoch: 11 | loss: 0.2765716
	speed: 0.3306s/iter; left time: 2218.7074s
	iters: 400, epoch: 11 | loss: 0.2561354
	speed: 0.3314s/iter; left time: 2190.8582s
	iters: 500, epoch: 11 | loss: 0.2725447
	speed: 0.3320s/iter; left time: 2161.7448s
	iters: 600, epoch: 11 | loss: 0.2656447
	speed: 0.3323s/iter; left time: 2130.0640s
	iters: 700, epoch: 11 | loss: 0.2699574
	speed: 0.3310s/iter; left time: 2088.7659s
Epoch: 11 cost time: 233.4113688468933
Epoch: 11, Steps: 701 | Train Loss: 0.2659384 Vali Loss: 0.4204122 Test Loss: 0.4830935
Validation loss decreased (0.420475 --> 0.420412).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.2593249
	speed: 0.6276s/iter; left time: 3897.5605s
	iters: 200, epoch: 12 | loss: 0.2612258
	speed: 0.3358s/iter; left time: 2051.6551s
	iters: 300, epoch: 12 | loss: 0.2590431
	speed: 0.3323s/iter; left time: 1997.2960s
	iters: 400, epoch: 12 | loss: 0.2615472
	speed: 0.3323s/iter; left time: 1963.7460s
	iters: 500, epoch: 12 | loss: 0.2927567
	speed: 0.3320s/iter; left time: 1928.7597s
	iters: 600, epoch: 12 | loss: 0.2786530
	speed: 0.3315s/iter; left time: 1892.7700s
	iters: 700, epoch: 12 | loss: 0.2582254
	speed: 0.3316s/iter; left time: 1860.4191s
Epoch: 12 cost time: 233.6795551776886
Epoch: 12, Steps: 701 | Train Loss: 0.2656204 Vali Loss: 0.4206004 Test Loss: 0.4829358
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.2566435
	speed: 0.6187s/iter; left time: 3408.4858s
	iters: 200, epoch: 13 | loss: 0.2774955
	speed: 0.3329s/iter; left time: 1800.4316s
	iters: 300, epoch: 13 | loss: 0.2644148
	speed: 0.3320s/iter; left time: 1762.7657s
	iters: 400, epoch: 13 | loss: 0.2850509
	speed: 0.3333s/iter; left time: 1736.0410s
	iters: 500, epoch: 13 | loss: 0.2731520
	speed: 0.3314s/iter; left time: 1693.2920s
	iters: 600, epoch: 13 | loss: 0.2613228
	speed: 0.3320s/iter; left time: 1662.9001s
	iters: 700, epoch: 13 | loss: 0.2890684
	speed: 0.3321s/iter; left time: 1630.2995s
Epoch: 13 cost time: 233.1517403125763
Epoch: 13, Steps: 701 | Train Loss: 0.2654738 Vali Loss: 0.4205096 Test Loss: 0.4829273
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 14 | loss: 0.2744977
	speed: 0.6208s/iter; left time: 2984.6761s
	iters: 200, epoch: 14 | loss: 0.2582414
	speed: 0.3339s/iter; left time: 1571.8658s
	iters: 300, epoch: 14 | loss: 0.2520887
	speed: 0.3332s/iter; left time: 1535.5137s
	iters: 400, epoch: 14 | loss: 0.2785259
	speed: 0.3341s/iter; left time: 1506.2031s
	iters: 500, epoch: 14 | loss: 0.2683097
	speed: 0.3324s/iter; left time: 1465.4250s
	iters: 600, epoch: 14 | loss: 0.2782025
	speed: 0.3312s/iter; left time: 1426.8806s
	iters: 700, epoch: 14 | loss: 0.2635385
	speed: 0.3315s/iter; left time: 1394.8518s
Epoch: 14 cost time: 233.50485610961914
Epoch: 14, Steps: 701 | Train Loss: 0.2653794 Vali Loss: 0.4195939 Test Loss: 0.4829349
Validation loss decreased (0.420412 --> 0.419594).  Saving model ...
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 15 | loss: 0.2537747
	speed: 0.6308s/iter; left time: 2590.6023s
	iters: 200, epoch: 15 | loss: 0.2418854
	speed: 0.3368s/iter; left time: 1349.4695s
	iters: 300, epoch: 15 | loss: 0.2718326
	speed: 0.3343s/iter; left time: 1306.0023s
	iters: 400, epoch: 15 | loss: 0.2684745
	speed: 0.3316s/iter; left time: 1262.3334s
	iters: 500, epoch: 15 | loss: 0.2711431
	speed: 0.3312s/iter; left time: 1227.7156s
	iters: 600, epoch: 15 | loss: 0.2569293
	speed: 0.3318s/iter; left time: 1196.8677s
	iters: 700, epoch: 15 | loss: 0.2689109
	speed: 0.3320s/iter; left time: 1164.3854s
Epoch: 15 cost time: 234.01888632774353
Epoch: 15, Steps: 701 | Train Loss: 0.2653323 Vali Loss: 0.4199707 Test Loss: 0.4829338
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 16 | loss: 0.2638068
	speed: 0.6211s/iter; left time: 2115.5299s
	iters: 200, epoch: 16 | loss: 0.2692924
	speed: 0.3363s/iter; left time: 1111.8739s
	iters: 300, epoch: 16 | loss: 0.2806955
	speed: 0.3352s/iter; left time: 1074.5063s
	iters: 400, epoch: 16 | loss: 0.2822123
	speed: 0.3316s/iter; left time: 1029.9924s
	iters: 500, epoch: 16 | loss: 0.2511008
	speed: 0.3312s/iter; left time: 995.7100s
	iters: 600, epoch: 16 | loss: 0.2535300
	speed: 0.3303s/iter; left time: 959.9416s
	iters: 700, epoch: 16 | loss: 0.2651841
	speed: 0.3316s/iter; left time: 930.3454s
Epoch: 16 cost time: 233.66827273368835
Epoch: 16, Steps: 701 | Train Loss: 0.2653110 Vali Loss: 0.4199440 Test Loss: 0.4829320
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 17 | loss: 0.2788429
	speed: 0.6156s/iter; left time: 1665.1389s
	iters: 200, epoch: 17 | loss: 0.2674184
	speed: 0.3328s/iter; left time: 866.8493s
	iters: 300, epoch: 17 | loss: 0.2584438
	speed: 0.3336s/iter; left time: 835.7754s
	iters: 400, epoch: 17 | loss: 0.2599458
	speed: 0.3331s/iter; left time: 801.0685s
	iters: 500, epoch: 17 | loss: 0.2451280
	speed: 0.3322s/iter; left time: 765.6815s
	iters: 600, epoch: 17 | loss: 0.2544154
	speed: 0.3314s/iter; left time: 730.7049s
	iters: 700, epoch: 17 | loss: 0.2710310
	speed: 0.3316s/iter; left time: 697.9340s
Epoch: 17 cost time: 233.01204442977905
Epoch: 17, Steps: 701 | Train Loss: 0.2653224 Vali Loss: 0.4199757 Test Loss: 0.4829299
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 18 | loss: 0.2688196
	speed: 0.6206s/iter; left time: 1243.7546s
	iters: 200, epoch: 18 | loss: 0.2594891
	speed: 0.3349s/iter; left time: 637.6741s
	iters: 300, epoch: 18 | loss: 0.2937478
	speed: 0.3340s/iter; left time: 602.4940s
	iters: 400, epoch: 18 | loss: 0.2819688
	speed: 0.3319s/iter; left time: 565.6078s
	iters: 500, epoch: 18 | loss: 0.2707708
	speed: 0.3330s/iter; left time: 534.1286s
	iters: 600, epoch: 18 | loss: 0.2901013
	speed: 0.3331s/iter; left time: 501.0479s
	iters: 700, epoch: 18 | loss: 0.2760652
	speed: 0.3318s/iter; left time: 465.8126s
Epoch: 18 cost time: 234.0994598865509
Epoch: 18, Steps: 701 | Train Loss: 0.2653012 Vali Loss: 0.4201301 Test Loss: 0.4829283
EarlyStopping counter: 4 out of 5
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 19 | loss: 0.2596435
	speed: 0.6171s/iter; left time: 804.1408s
	iters: 200, epoch: 19 | loss: 0.2727875
	speed: 0.3330s/iter; left time: 400.5446s
	iters: 300, epoch: 19 | loss: 0.2538666
	speed: 0.3329s/iter; left time: 367.2244s
	iters: 400, epoch: 19 | loss: 0.2705969
	speed: 0.3324s/iter; left time: 333.4248s
	iters: 500, epoch: 19 | loss: 0.2841412
	speed: 0.3333s/iter; left time: 300.9911s
	iters: 600, epoch: 19 | loss: 0.2512272
	speed: 0.3333s/iter; left time: 267.6551s
	iters: 700, epoch: 19 | loss: 0.2679548
	speed: 0.3344s/iter; left time: 235.0740s
Epoch: 19 cost time: 233.71960306167603
Epoch: 19, Steps: 701 | Train Loss: 0.2652931 Vali Loss: 0.4199771 Test Loss: 0.4829282
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : traffic_336_720_Linear_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed10458<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2789
mse:0.48275333642959595, mae:0.3305128812789917
