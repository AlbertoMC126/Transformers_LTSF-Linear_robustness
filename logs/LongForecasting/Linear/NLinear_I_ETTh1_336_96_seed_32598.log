Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTh1', data_path='ETTh1.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='NLinear', model_id='ETTh1_336_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=32598, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTh1_336_96_NLinear_ETTh1_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed32598>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.3709880
	speed: 0.0042s/iter; left time: 21.2098s
	iters: 200, epoch: 1 | loss: 0.5154456
	speed: 0.0040s/iter; left time: 19.4872s
Epoch: 1 cost time: 1.0394206047058105
Epoch: 1, Steps: 256 | Train Loss: 0.4276269 Vali Loss: 0.8669409 Test Loss: 0.4674250
Validation loss decreased (inf --> 0.866941).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.3392832
	speed: 0.0100s/iter; left time: 47.6525s
	iters: 200, epoch: 2 | loss: 0.4156378
	speed: 0.0051s/iter; left time: 23.9865s
Epoch: 2 cost time: 1.2322280406951904
Epoch: 2, Steps: 256 | Train Loss: 0.3935378 Vali Loss: 0.8886810 Test Loss: 0.5290070
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.3200237
	speed: 0.0074s/iter; left time: 33.3689s
	iters: 200, epoch: 3 | loss: 0.4028912
	speed: 0.0037s/iter; left time: 16.5042s
Epoch: 3 cost time: 1.0093333721160889
Epoch: 3, Steps: 256 | Train Loss: 0.3523880 Vali Loss: 0.7944717 Test Loss: 0.4165681
Validation loss decreased (0.866941 --> 0.794472).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.3721318
	speed: 0.0116s/iter; left time: 49.1375s
	iters: 200, epoch: 4 | loss: 0.3115171
	speed: 0.0054s/iter; left time: 22.3432s
Epoch: 4 cost time: 1.3296074867248535
Epoch: 4, Steps: 256 | Train Loss: 0.3319689 Vali Loss: 0.7194813 Test Loss: 0.3944018
Validation loss decreased (0.794472 --> 0.719481).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.2827216
	speed: 0.0113s/iter; left time: 45.2984s
	iters: 200, epoch: 5 | loss: 0.3501704
	speed: 0.0048s/iter; left time: 18.8338s
Epoch: 5 cost time: 1.2082886695861816
Epoch: 5, Steps: 256 | Train Loss: 0.3234850 Vali Loss: 0.7117587 Test Loss: 0.3848918
Validation loss decreased (0.719481 --> 0.711759).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.2716960
	speed: 0.0119s/iter; left time: 44.3763s
	iters: 200, epoch: 6 | loss: 0.3010031
	speed: 0.0045s/iter; left time: 16.4644s
Epoch: 6 cost time: 1.218132734298706
Epoch: 6, Steps: 256 | Train Loss: 0.3186417 Vali Loss: 0.7095773 Test Loss: 0.3840251
Validation loss decreased (0.711759 --> 0.709577).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.3316318
	speed: 0.0106s/iter; left time: 37.0819s
	iters: 200, epoch: 7 | loss: 0.3266243
	speed: 0.0039s/iter; left time: 13.2354s
Epoch: 7 cost time: 1.0700421333312988
Epoch: 7, Steps: 256 | Train Loss: 0.3162468 Vali Loss: 0.7008769 Test Loss: 0.3825268
Validation loss decreased (0.709577 --> 0.700877).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.3437155
	speed: 0.0093s/iter; left time: 30.1665s
	iters: 200, epoch: 8 | loss: 0.3246115
	speed: 0.0044s/iter; left time: 13.6425s
Epoch: 8 cost time: 1.0973761081695557
Epoch: 8, Steps: 256 | Train Loss: 0.3151051 Vali Loss: 0.7062554 Test Loss: 0.3795746
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.3098763
	speed: 0.0107s/iter; left time: 31.7330s
	iters: 200, epoch: 9 | loss: 0.3222978
	speed: 0.0051s/iter; left time: 14.6011s
Epoch: 9 cost time: 1.295271396636963
Epoch: 9, Steps: 256 | Train Loss: 0.3143650 Vali Loss: 0.7029937 Test Loss: 0.3795893
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.3701763
	speed: 0.0119s/iter; left time: 32.2378s
	iters: 200, epoch: 10 | loss: 0.3097129
	speed: 0.0049s/iter; left time: 12.8806s
Epoch: 10 cost time: 1.1934480667114258
Epoch: 10, Steps: 256 | Train Loss: 0.3138008 Vali Loss: 0.7014478 Test Loss: 0.3795400
EarlyStopping counter: 3 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.2888494
	speed: 0.0095s/iter; left time: 23.2900s
	iters: 200, epoch: 11 | loss: 0.3606721
	speed: 0.0045s/iter; left time: 10.6009s
Epoch: 11 cost time: 1.1333658695220947
Epoch: 11, Steps: 256 | Train Loss: 0.3135672 Vali Loss: 0.7011781 Test Loss: 0.3795036
EarlyStopping counter: 4 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.2866843
	speed: 0.0113s/iter; left time: 24.8091s
	iters: 200, epoch: 12 | loss: 0.3052694
	speed: 0.0047s/iter; left time: 9.8565s
Epoch: 12 cost time: 1.1781537532806396
Epoch: 12, Steps: 256 | Train Loss: 0.3136245 Vali Loss: 0.7006444 Test Loss: 0.3795081
Validation loss decreased (0.700877 --> 0.700644).  Saving model ...
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.3078152
	speed: 0.0102s/iter; left time: 19.9446s
	iters: 200, epoch: 13 | loss: 0.2756773
	speed: 0.0041s/iter; left time: 7.5440s
Epoch: 13 cost time: 1.0823163986206055
Epoch: 13, Steps: 256 | Train Loss: 0.3134435 Vali Loss: 0.7008026 Test Loss: 0.3794910
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.3044064
	speed: 0.0083s/iter; left time: 14.0398s
	iters: 200, epoch: 14 | loss: 0.3145068
	speed: 0.0036s/iter; left time: 5.7826s
Epoch: 14 cost time: 0.9318141937255859
Epoch: 14, Steps: 256 | Train Loss: 0.3134590 Vali Loss: 0.7005262 Test Loss: 0.3794810
Validation loss decreased (0.700644 --> 0.700526).  Saving model ...
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.3115717
	speed: 0.0089s/iter; left time: 12.8204s
	iters: 200, epoch: 15 | loss: 0.3306817
	speed: 0.0035s/iter; left time: 4.7225s
Epoch: 15 cost time: 0.9782557487487793
Epoch: 15, Steps: 256 | Train Loss: 0.3134664 Vali Loss: 0.7007844 Test Loss: 0.3794713
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.2867818
	speed: 0.0094s/iter; left time: 11.0665s
	iters: 200, epoch: 16 | loss: 0.3596090
	speed: 0.0036s/iter; left time: 3.8391s
Epoch: 16 cost time: 0.9081430435180664
Epoch: 16, Steps: 256 | Train Loss: 0.3131946 Vali Loss: 0.7006302 Test Loss: 0.3794713
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 17 | loss: 0.3027279
	speed: 0.0077s/iter; left time: 7.1159s
	iters: 200, epoch: 17 | loss: 0.3348556
	speed: 0.0032s/iter; left time: 2.6565s
Epoch: 17 cost time: 0.8322808742523193
Epoch: 17, Steps: 256 | Train Loss: 0.3132645 Vali Loss: 0.7007049 Test Loss: 0.3794695
EarlyStopping counter: 3 out of 5
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 18 | loss: 0.3196310
	speed: 0.0073s/iter; left time: 4.8850s
	iters: 200, epoch: 18 | loss: 0.2399454
	speed: 0.0032s/iter; left time: 1.8094s
Epoch: 18 cost time: 0.825200080871582
Epoch: 18, Steps: 256 | Train Loss: 0.3133107 Vali Loss: 0.7007211 Test Loss: 0.3794692
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 19 | loss: 0.2805043
	speed: 0.0072s/iter; left time: 2.9786s
	iters: 200, epoch: 19 | loss: 0.2436803
	speed: 0.0031s/iter; left time: 0.9798s
Epoch: 19 cost time: 0.7762205600738525
Epoch: 19, Steps: 256 | Train Loss: 0.3133843 Vali Loss: 0.7007675 Test Loss: 0.3794695
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTh1_336_96_NLinear_ETTh1_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed32598<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.3779079020023346, mae:0.3976685702800751
