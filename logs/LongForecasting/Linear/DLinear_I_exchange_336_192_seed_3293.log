Args in experiment:
Namespace(activation='gelu', batch_size=8, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='exchange_rate.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=8, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='mse', lradj='type1', model='DLinear', model_id='Exchange_336_192', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=192, root_path='./dataset/', save_pred_values=False, seed=3293, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : Exchange_336_192_DLinear_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3293>>>>>>>>>>>>>>>>>>>>>>>>>>
train 4784
val 569
test 1326
	iters: 100, epoch: 1 | loss: 0.1696597
	speed: 0.0085s/iter; left time: 101.1744s
	iters: 200, epoch: 1 | loss: 0.1552369
	speed: 0.0085s/iter; left time: 100.3540s
	iters: 300, epoch: 1 | loss: 0.2771548
	speed: 0.0082s/iter; left time: 95.5278s
	iters: 400, epoch: 1 | loss: 0.1793435
	speed: 0.0080s/iter; left time: 92.4943s
	iters: 500, epoch: 1 | loss: 0.2655941
	speed: 0.0080s/iter; left time: 91.7773s
Epoch: 1 cost time: 5.008620977401733
Epoch: 1, Steps: 598 | Train Loss: 0.2684816 Vali Loss: 0.5578420 Test Loss: 0.2943769
Validation loss decreased (inf --> 0.557842).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.3595044
	speed: 0.0207s/iter; left time: 233.2712s
	iters: 200, epoch: 2 | loss: 0.1712628
	speed: 0.0086s/iter; left time: 96.1465s
	iters: 300, epoch: 2 | loss: 0.2587438
	speed: 0.0085s/iter; left time: 93.9249s
	iters: 400, epoch: 2 | loss: 0.1755788
	speed: 0.0077s/iter; left time: 84.5398s
	iters: 500, epoch: 2 | loss: 0.2635556
	speed: 0.0072s/iter; left time: 78.6756s
Epoch: 2 cost time: 4.788619041442871
Epoch: 2, Steps: 598 | Train Loss: 0.2291912 Vali Loss: 0.5482968 Test Loss: 0.2063815
Validation loss decreased (0.557842 --> 0.548297).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1961983
	speed: 0.0202s/iter; left time: 215.2974s
	iters: 200, epoch: 3 | loss: 0.1539128
	speed: 0.0085s/iter; left time: 89.3924s
	iters: 300, epoch: 3 | loss: 0.1717654
	speed: 0.0087s/iter; left time: 90.8642s
	iters: 400, epoch: 3 | loss: 0.1986405
	speed: 0.0088s/iter; left time: 90.8034s
	iters: 500, epoch: 3 | loss: 0.1918159
	speed: 0.0089s/iter; left time: 91.0420s
Epoch: 3 cost time: 5.07485818862915
Epoch: 3, Steps: 598 | Train Loss: 0.2188976 Vali Loss: 0.4165615 Test Loss: 0.1813492
Validation loss decreased (0.548297 --> 0.416562).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.2677167
	speed: 0.0198s/iter; left time: 199.5601s
	iters: 200, epoch: 4 | loss: 0.2316326
	speed: 0.0083s/iter; left time: 82.2435s
	iters: 300, epoch: 4 | loss: 0.1770445
	speed: 0.0081s/iter; left time: 80.3575s
	iters: 400, epoch: 4 | loss: 0.1981692
	speed: 0.0081s/iter; left time: 79.2286s
	iters: 500, epoch: 4 | loss: 0.2168167
	speed: 0.0078s/iter; left time: 75.7296s
Epoch: 4 cost time: 4.713830232620239
Epoch: 4, Steps: 598 | Train Loss: 0.2133144 Vali Loss: 0.4971999 Test Loss: 0.1934502
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1184611
	speed: 0.0185s/iter; left time: 174.8898s
	iters: 200, epoch: 5 | loss: 0.2426590
	speed: 0.0086s/iter; left time: 80.6904s
	iters: 300, epoch: 5 | loss: 0.1270406
	speed: 0.0081s/iter; left time: 75.3854s
	iters: 400, epoch: 5 | loss: 0.1130607
	speed: 0.0086s/iter; left time: 79.0760s
	iters: 500, epoch: 5 | loss: 0.2378854
	speed: 0.0085s/iter; left time: 77.3855s
Epoch: 5 cost time: 5.014259576797485
Epoch: 5, Steps: 598 | Train Loss: 0.2112913 Vali Loss: 0.4010943 Test Loss: 0.1789701
Validation loss decreased (0.416562 --> 0.401094).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.3450581
	speed: 0.0210s/iter; left time: 186.6864s
	iters: 200, epoch: 6 | loss: 0.2441439
	speed: 0.0086s/iter; left time: 75.6307s
	iters: 300, epoch: 6 | loss: 0.6030762
	speed: 0.0083s/iter; left time: 71.7372s
	iters: 400, epoch: 6 | loss: 0.1877296
	speed: 0.0081s/iter; left time: 69.6714s
	iters: 500, epoch: 6 | loss: 0.3062328
	speed: 0.0085s/iter; left time: 71.6016s
Epoch: 6 cost time: 4.922353029251099
Epoch: 6, Steps: 598 | Train Loss: 0.2098887 Vali Loss: 0.4398409 Test Loss: 0.1801047
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.2560181
	speed: 0.0201s/iter; left time: 166.4061s
	iters: 200, epoch: 7 | loss: 0.1439278
	speed: 0.0086s/iter; left time: 70.6310s
	iters: 300, epoch: 7 | loss: 0.2289882
	speed: 0.0087s/iter; left time: 69.8537s
	iters: 400, epoch: 7 | loss: 0.1564459
	speed: 0.0077s/iter; left time: 61.3333s
	iters: 500, epoch: 7 | loss: 0.1531798
	speed: 0.0080s/iter; left time: 62.6357s
Epoch: 7 cost time: 4.90449857711792
Epoch: 7, Steps: 598 | Train Loss: 0.2089926 Vali Loss: 0.4601284 Test Loss: 0.1838182
EarlyStopping counter: 2 out of 5
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.2321277
	speed: 0.0193s/iter; left time: 148.4769s
	iters: 200, epoch: 8 | loss: 0.1658424
	speed: 0.0082s/iter; left time: 61.8120s
	iters: 300, epoch: 8 | loss: 0.3485729
	speed: 0.0081s/iter; left time: 60.7569s
	iters: 400, epoch: 8 | loss: 0.2273000
	speed: 0.0080s/iter; left time: 59.1648s
	iters: 500, epoch: 8 | loss: 0.2104256
	speed: 0.0076s/iter; left time: 55.4618s
Epoch: 8 cost time: 4.770911693572998
Epoch: 8, Steps: 598 | Train Loss: 0.2087029 Vali Loss: 0.4613669 Test Loss: 0.1843224
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.1581555
	speed: 0.0186s/iter; left time: 131.4518s
	iters: 200, epoch: 9 | loss: 0.1585261
	speed: 0.0080s/iter; left time: 55.6793s
	iters: 300, epoch: 9 | loss: 0.3288808
	speed: 0.0080s/iter; left time: 54.6943s
	iters: 400, epoch: 9 | loss: 0.1822831
	speed: 0.0078s/iter; left time: 52.7463s
	iters: 500, epoch: 9 | loss: 0.2393395
	speed: 0.0070s/iter; left time: 46.6187s
Epoch: 9 cost time: 4.494142532348633
Epoch: 9, Steps: 598 | Train Loss: 0.2085391 Vali Loss: 0.4493511 Test Loss: 0.1802998
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.1645953
	speed: 0.0167s/iter; left time: 108.1915s
	iters: 200, epoch: 10 | loss: 0.2713847
	speed: 0.0064s/iter; left time: 41.1052s
	iters: 300, epoch: 10 | loss: 0.1251485
	speed: 0.0064s/iter; left time: 40.4538s
	iters: 400, epoch: 10 | loss: 0.1620038
	speed: 0.0057s/iter; left time: 34.9672s
	iters: 500, epoch: 10 | loss: 0.2116383
	speed: 0.0061s/iter; left time: 37.0970s
Epoch: 10 cost time: 3.747617721557617
Epoch: 10, Steps: 598 | Train Loss: 0.2084127 Vali Loss: 0.4567139 Test Loss: 0.1818870
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : Exchange_336_192_DLinear_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3293<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 1326
mse:0.17882230877876282, mae:0.3193356990814209
