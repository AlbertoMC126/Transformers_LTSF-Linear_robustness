Args in experiment:
Namespace(activation='gelu', batch_size=8, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='exchange_rate.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=8, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='mse', lradj='type1', model='NLinear', model_id='Exchange_336_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=3293, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : Exchange_336_96_NLinear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3293>>>>>>>>>>>>>>>>>>>>>>>>>>
train 4880
val 665
test 1422
	iters: 100, epoch: 1 | loss: 0.0780501
	speed: 0.0031s/iter; left time: 37.8984s
	iters: 200, epoch: 1 | loss: 0.1938074
	speed: 0.0030s/iter; left time: 36.4829s
	iters: 300, epoch: 1 | loss: 0.0997266
	speed: 0.0030s/iter; left time: 35.7101s
	iters: 400, epoch: 1 | loss: 0.1190744
	speed: 0.0027s/iter; left time: 31.9904s
	iters: 500, epoch: 1 | loss: 0.0830710
	speed: 0.0034s/iter; left time: 39.3154s
	iters: 600, epoch: 1 | loss: 0.0872230
	speed: 0.0035s/iter; left time: 40.6034s
Epoch: 1 cost time: 1.9023253917694092
Epoch: 1, Steps: 610 | Train Loss: 0.1240266 Vali Loss: 0.1422335 Test Loss: 0.0962123
Validation loss decreased (inf --> 0.142233).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1282906
	speed: 0.0047s/iter; left time: 53.5727s
	iters: 200, epoch: 2 | loss: 0.0759853
	speed: 0.0029s/iter; left time: 33.0341s
	iters: 300, epoch: 2 | loss: 0.1280087
	speed: 0.0029s/iter; left time: 33.1955s
	iters: 400, epoch: 2 | loss: 0.1067864
	speed: 0.0029s/iter; left time: 32.2509s
	iters: 500, epoch: 2 | loss: 0.1486439
	speed: 0.0028s/iter; left time: 30.9436s
	iters: 600, epoch: 2 | loss: 0.1165733
	speed: 0.0028s/iter; left time: 30.6703s
Epoch: 2 cost time: 1.7584471702575684
Epoch: 2, Steps: 610 | Train Loss: 0.1197960 Vali Loss: 0.1402036 Test Loss: 0.0933127
Validation loss decreased (0.142233 --> 0.140204).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.0670639
	speed: 0.0053s/iter; left time: 58.1327s
	iters: 200, epoch: 3 | loss: 0.0763344
	speed: 0.0032s/iter; left time: 34.9302s
	iters: 300, epoch: 3 | loss: 0.1791117
	speed: 0.0033s/iter; left time: 34.7134s
	iters: 400, epoch: 3 | loss: 0.0817316
	speed: 0.0032s/iter; left time: 33.8868s
	iters: 500, epoch: 3 | loss: 0.1489504
	speed: 0.0028s/iter; left time: 29.2421s
	iters: 600, epoch: 3 | loss: 0.0966859
	speed: 0.0028s/iter; left time: 28.9627s
Epoch: 3 cost time: 1.8755145072937012
Epoch: 3, Steps: 610 | Train Loss: 0.1149363 Vali Loss: 0.1427415 Test Loss: 0.0969941
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1425065
	speed: 0.0051s/iter; left time: 52.4856s
	iters: 200, epoch: 4 | loss: 0.0738542
	speed: 0.0032s/iter; left time: 32.0388s
	iters: 300, epoch: 4 | loss: 0.1546323
	speed: 0.0029s/iter; left time: 29.5079s
	iters: 400, epoch: 4 | loss: 0.3622310
	speed: 0.0035s/iter; left time: 35.3143s
	iters: 500, epoch: 4 | loss: 0.0716402
	speed: 0.0036s/iter; left time: 36.0291s
	iters: 600, epoch: 4 | loss: 0.0755716
	speed: 0.0036s/iter; left time: 35.1807s
Epoch: 4 cost time: 2.0402281284332275
Epoch: 4, Steps: 610 | Train Loss: 0.1137117 Vali Loss: 0.1389889 Test Loss: 0.0946472
Validation loss decreased (0.140204 --> 0.138989).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0914484
	speed: 0.0057s/iter; left time: 54.8986s
	iters: 200, epoch: 5 | loss: 0.1060870
	speed: 0.0036s/iter; left time: 34.8021s
	iters: 300, epoch: 5 | loss: 0.0856750
	speed: 0.0036s/iter; left time: 34.4706s
	iters: 400, epoch: 5 | loss: 0.1142000
	speed: 0.0037s/iter; left time: 34.5419s
	iters: 500, epoch: 5 | loss: 0.0584155
	speed: 0.0034s/iter; left time: 31.3022s
	iters: 600, epoch: 5 | loss: 0.0797572
	speed: 0.0027s/iter; left time: 24.9396s
Epoch: 5 cost time: 2.075582265853882
Epoch: 5, Steps: 610 | Train Loss: 0.1126420 Vali Loss: 0.1423707 Test Loss: 0.0953364
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0891898
	speed: 0.0056s/iter; left time: 50.7816s
	iters: 200, epoch: 6 | loss: 0.1235272
	speed: 0.0037s/iter; left time: 32.8546s
	iters: 300, epoch: 6 | loss: 0.0626317
	speed: 0.0033s/iter; left time: 29.1198s
	iters: 400, epoch: 6 | loss: 0.0712718
	speed: 0.0032s/iter; left time: 27.8334s
	iters: 500, epoch: 6 | loss: 0.1237809
	speed: 0.0033s/iter; left time: 28.2315s
	iters: 600, epoch: 6 | loss: 0.1584715
	speed: 0.0031s/iter; left time: 26.2515s
Epoch: 6 cost time: 2.039445400238037
Epoch: 6, Steps: 610 | Train Loss: 0.1123859 Vali Loss: 0.1428335 Test Loss: 0.0936528
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1454026
	speed: 0.0048s/iter; left time: 40.6856s
	iters: 200, epoch: 7 | loss: 0.1404194
	speed: 0.0027s/iter; left time: 22.7906s
	iters: 300, epoch: 7 | loss: 0.0736442
	speed: 0.0033s/iter; left time: 27.1953s
	iters: 400, epoch: 7 | loss: 0.1825958
	speed: 0.0033s/iter; left time: 27.1096s
	iters: 500, epoch: 7 | loss: 0.1563396
	speed: 0.0033s/iter; left time: 26.7913s
	iters: 600, epoch: 7 | loss: 0.0751919
	speed: 0.0034s/iter; left time: 26.7659s
Epoch: 7 cost time: 1.9294800758361816
Epoch: 7, Steps: 610 | Train Loss: 0.1120484 Vali Loss: 0.1417530 Test Loss: 0.0944737
EarlyStopping counter: 3 out of 5
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.1288068
	speed: 0.0057s/iter; left time: 44.9621s
	iters: 200, epoch: 8 | loss: 0.1955448
	speed: 0.0029s/iter; left time: 22.4199s
	iters: 300, epoch: 8 | loss: 0.0673901
	speed: 0.0033s/iter; left time: 24.8008s
	iters: 400, epoch: 8 | loss: 0.0937160
	speed: 0.0037s/iter; left time: 27.5662s
	iters: 500, epoch: 8 | loss: 0.0464775
	speed: 0.0034s/iter; left time: 25.0838s
	iters: 600, epoch: 8 | loss: 0.0970578
	speed: 0.0031s/iter; left time: 22.9459s
Epoch: 8 cost time: 1.991748332977295
Epoch: 8, Steps: 610 | Train Loss: 0.1118683 Vali Loss: 0.1408799 Test Loss: 0.0940985
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.0626616
	speed: 0.0053s/iter; left time: 38.0705s
	iters: 200, epoch: 9 | loss: 0.2542732
	speed: 0.0029s/iter; left time: 20.2950s
	iters: 300, epoch: 9 | loss: 0.0899376
	speed: 0.0032s/iter; left time: 22.4673s
	iters: 400, epoch: 9 | loss: 0.0821334
	speed: 0.0033s/iter; left time: 22.6444s
	iters: 500, epoch: 9 | loss: 0.0815708
	speed: 0.0035s/iter; left time: 23.9417s
	iters: 600, epoch: 9 | loss: 0.1670782
	speed: 0.0035s/iter; left time: 23.5940s
Epoch: 9 cost time: 1.9904515743255615
Epoch: 9, Steps: 610 | Train Loss: 0.1118083 Vali Loss: 0.1410511 Test Loss: 0.0937848
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : Exchange_336_96_NLinear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3293<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 1422
mse:0.09450862556695938, mae:0.21351897716522217
