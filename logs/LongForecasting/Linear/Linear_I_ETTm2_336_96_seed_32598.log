Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='Linear', model_id='ETTm2_336_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=32598, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTm2_336_96_Linear_ETTm2_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed32598>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34129
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.2104648
	speed: 0.0045s/iter; left time: 96.1428s
	iters: 200, epoch: 1 | loss: 0.4754863
	speed: 0.0051s/iter; left time: 106.9320s
	iters: 300, epoch: 1 | loss: 0.5981692
	speed: 0.0051s/iter; left time: 106.3335s
	iters: 400, epoch: 1 | loss: 0.2563174
	speed: 0.0050s/iter; left time: 104.2319s
	iters: 500, epoch: 1 | loss: 0.5538031
	speed: 0.0045s/iter; left time: 94.7355s
	iters: 600, epoch: 1 | loss: 0.4186337
	speed: 0.0045s/iter; left time: 92.8302s
	iters: 700, epoch: 1 | loss: 0.7344218
	speed: 0.0044s/iter; left time: 91.0058s
	iters: 800, epoch: 1 | loss: 0.2816947
	speed: 0.0046s/iter; left time: 94.6019s
	iters: 900, epoch: 1 | loss: 0.2861258
	speed: 0.0040s/iter; left time: 82.1429s
	iters: 1000, epoch: 1 | loss: 0.3057685
	speed: 0.0038s/iter; left time: 77.6382s
Epoch: 1 cost time: 4.805032253265381
Epoch: 1, Steps: 1066 | Train Loss: 0.4185764 Vali Loss: 0.3519615 Test Loss: 0.7090395
Validation loss decreased (inf --> 0.351961).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.3420736
	speed: 0.0152s/iter; left time: 306.6681s
	iters: 200, epoch: 2 | loss: 0.4720400
	speed: 0.0043s/iter; left time: 87.2316s
	iters: 300, epoch: 2 | loss: 0.3075490
	speed: 0.0043s/iter; left time: 85.6451s
	iters: 400, epoch: 2 | loss: 0.4227660
	speed: 0.0043s/iter; left time: 84.5884s
	iters: 500, epoch: 2 | loss: 0.3984544
	speed: 0.0045s/iter; left time: 89.6876s
	iters: 600, epoch: 2 | loss: 0.2977071
	speed: 0.0046s/iter; left time: 89.8749s
	iters: 700, epoch: 2 | loss: 0.8590490
	speed: 0.0038s/iter; left time: 73.3399s
	iters: 800, epoch: 2 | loss: 0.3416759
	speed: 0.0038s/iter; left time: 74.7414s
	iters: 900, epoch: 2 | loss: 0.9393914
	speed: 0.0040s/iter; left time: 76.8395s
	iters: 1000, epoch: 2 | loss: 0.3106928
	speed: 0.0040s/iter; left time: 77.7903s
Epoch: 2 cost time: 4.40532112121582
Epoch: 2, Steps: 1066 | Train Loss: 0.3804840 Vali Loss: 0.2859859 Test Loss: 0.5891997
Validation loss decreased (0.351961 --> 0.285986).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.1736560
	speed: 0.0182s/iter; left time: 346.5951s
	iters: 200, epoch: 3 | loss: 0.3238276
	speed: 0.0043s/iter; left time: 82.0670s
	iters: 300, epoch: 3 | loss: 0.1675603
	speed: 0.0043s/iter; left time: 81.0404s
	iters: 400, epoch: 3 | loss: 0.1387751
	speed: 0.0047s/iter; left time: 87.5937s
	iters: 500, epoch: 3 | loss: 0.2573307
	speed: 0.0040s/iter; left time: 75.5034s
	iters: 600, epoch: 3 | loss: 0.2366219
	speed: 0.0039s/iter; left time: 72.1253s
	iters: 700, epoch: 3 | loss: 0.1774075
	speed: 0.0046s/iter; left time: 84.1692s
	iters: 800, epoch: 3 | loss: 0.1908590
	speed: 0.0042s/iter; left time: 76.4980s
	iters: 900, epoch: 3 | loss: 0.2646057
	speed: 0.0043s/iter; left time: 78.6748s
	iters: 1000, epoch: 3 | loss: 0.1838606
	speed: 0.0044s/iter; left time: 79.3132s
Epoch: 3 cost time: 4.5429158210754395
Epoch: 3, Steps: 1066 | Train Loss: 0.2600908 Vali Loss: 0.2479429 Test Loss: 0.5146137
Validation loss decreased (0.285986 --> 0.247943).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.2354745
	speed: 0.0196s/iter; left time: 353.1397s
	iters: 200, epoch: 4 | loss: 0.2643130
	speed: 0.0045s/iter; left time: 80.2950s
	iters: 300, epoch: 4 | loss: 0.1699809
	speed: 0.0041s/iter; left time: 73.3129s
	iters: 400, epoch: 4 | loss: 0.1559156
	speed: 0.0046s/iter; left time: 80.8168s
	iters: 500, epoch: 4 | loss: 0.2287833
	speed: 0.0041s/iter; left time: 71.4311s
	iters: 600, epoch: 4 | loss: 0.2937860
	speed: 0.0042s/iter; left time: 73.7798s
	iters: 700, epoch: 4 | loss: 0.2089395
	speed: 0.0045s/iter; left time: 78.2582s
	iters: 800, epoch: 4 | loss: 0.2706103
	speed: 0.0041s/iter; left time: 71.0243s
	iters: 900, epoch: 4 | loss: 0.1973092
	speed: 0.0043s/iter; left time: 73.3789s
	iters: 1000, epoch: 4 | loss: 0.2182333
	speed: 0.0045s/iter; left time: 77.7703s
Epoch: 4 cost time: 4.585951805114746
Epoch: 4, Steps: 1066 | Train Loss: 0.2342340 Vali Loss: 0.1605062 Test Loss: 0.2834346
Validation loss decreased (0.247943 --> 0.160506).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.2491108
	speed: 0.0212s/iter; left time: 359.7237s
	iters: 200, epoch: 5 | loss: 0.1166172
	speed: 0.0049s/iter; left time: 82.4798s
	iters: 300, epoch: 5 | loss: 0.2220910
	speed: 0.0040s/iter; left time: 67.5306s
	iters: 400, epoch: 5 | loss: 0.3209156
	speed: 0.0043s/iter; left time: 72.1249s
	iters: 500, epoch: 5 | loss: 0.1608890
	speed: 0.0046s/iter; left time: 76.0327s
	iters: 600, epoch: 5 | loss: 0.6090600
	speed: 0.0038s/iter; left time: 61.8785s
	iters: 700, epoch: 5 | loss: 0.1314934
	speed: 0.0037s/iter; left time: 59.9178s
	iters: 800, epoch: 5 | loss: 0.3160342
	speed: 0.0037s/iter; left time: 60.3230s
	iters: 900, epoch: 5 | loss: 0.1200181
	speed: 0.0034s/iter; left time: 55.4185s
	iters: 1000, epoch: 5 | loss: 0.3106918
	speed: 0.0039s/iter; left time: 62.6666s
Epoch: 5 cost time: 4.3291566371917725
Epoch: 5, Steps: 1066 | Train Loss: 0.2169671 Vali Loss: 0.1475596 Test Loss: 0.2395286
Validation loss decreased (0.160506 --> 0.147560).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.2761016
	speed: 0.0131s/iter; left time: 207.7426s
	iters: 200, epoch: 6 | loss: 0.1352988
	speed: 0.0048s/iter; left time: 75.3229s
	iters: 300, epoch: 6 | loss: 0.1856428
	speed: 0.0044s/iter; left time: 69.3954s
	iters: 400, epoch: 6 | loss: 0.1811415
	speed: 0.0042s/iter; left time: 65.0145s
	iters: 500, epoch: 6 | loss: 0.1306493
	speed: 0.0034s/iter; left time: 52.2324s
	iters: 600, epoch: 6 | loss: 0.1862059
	speed: 0.0040s/iter; left time: 61.1112s
	iters: 700, epoch: 6 | loss: 0.2396480
	speed: 0.0039s/iter; left time: 59.7877s
	iters: 800, epoch: 6 | loss: 0.3028380
	speed: 0.0038s/iter; left time: 57.1608s
	iters: 900, epoch: 6 | loss: 0.2212367
	speed: 0.0038s/iter; left time: 57.4828s
	iters: 1000, epoch: 6 | loss: 0.1635235
	speed: 0.0045s/iter; left time: 67.6337s
Epoch: 6 cost time: 4.295847654342651
Epoch: 6, Steps: 1066 | Train Loss: 0.2081195 Vali Loss: 0.1377818 Test Loss: 0.2296337
Validation loss decreased (0.147560 --> 0.137782).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.2363749
	speed: 0.0191s/iter; left time: 282.7898s
	iters: 200, epoch: 7 | loss: 0.1860721
	speed: 0.0038s/iter; left time: 55.9549s
	iters: 300, epoch: 7 | loss: 0.1784248
	speed: 0.0037s/iter; left time: 54.2676s
	iters: 400, epoch: 7 | loss: 0.1561048
	speed: 0.0038s/iter; left time: 54.9476s
	iters: 500, epoch: 7 | loss: 0.2405735
	speed: 0.0041s/iter; left time: 58.6356s
	iters: 600, epoch: 7 | loss: 0.1308599
	speed: 0.0043s/iter; left time: 61.0620s
	iters: 700, epoch: 7 | loss: 0.0935105
	speed: 0.0038s/iter; left time: 53.3438s
	iters: 800, epoch: 7 | loss: 0.2067982
	speed: 0.0035s/iter; left time: 49.0036s
	iters: 900, epoch: 7 | loss: 0.1475941
	speed: 0.0035s/iter; left time: 48.8390s
	iters: 1000, epoch: 7 | loss: 0.1404879
	speed: 0.0036s/iter; left time: 50.5565s
Epoch: 7 cost time: 4.0426106452941895
Epoch: 7, Steps: 1066 | Train Loss: 0.2042523 Vali Loss: 0.1290396 Test Loss: 0.2013243
Validation loss decreased (0.137782 --> 0.129040).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.1185362
	speed: 0.0189s/iter; left time: 259.8482s
	iters: 200, epoch: 8 | loss: 0.1192231
	speed: 0.0041s/iter; left time: 56.2750s
	iters: 300, epoch: 8 | loss: 0.1600007
	speed: 0.0034s/iter; left time: 46.1416s
	iters: 400, epoch: 8 | loss: 0.2216846
	speed: 0.0043s/iter; left time: 57.3353s
	iters: 500, epoch: 8 | loss: 0.1489732
	speed: 0.0036s/iter; left time: 48.3596s
	iters: 600, epoch: 8 | loss: 0.1319607
	speed: 0.0042s/iter; left time: 55.5802s
	iters: 700, epoch: 8 | loss: 0.1949066
	speed: 0.0041s/iter; left time: 53.6929s
	iters: 800, epoch: 8 | loss: 0.2567598
	speed: 0.0035s/iter; left time: 45.4711s
	iters: 900, epoch: 8 | loss: 0.1288057
	speed: 0.0042s/iter; left time: 54.9462s
	iters: 1000, epoch: 8 | loss: 0.1744526
	speed: 0.0044s/iter; left time: 57.1010s
Epoch: 8 cost time: 4.299375534057617
Epoch: 8, Steps: 1066 | Train Loss: 0.2016674 Vali Loss: 0.1267778 Test Loss: 0.1914841
Validation loss decreased (0.129040 --> 0.126778).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.3770874
	speed: 0.0196s/iter; left time: 248.6002s
	iters: 200, epoch: 9 | loss: 0.2968276
	speed: 0.0039s/iter; left time: 48.7624s
	iters: 300, epoch: 9 | loss: 0.2158543
	speed: 0.0036s/iter; left time: 44.8315s
	iters: 400, epoch: 9 | loss: 0.1213637
	speed: 0.0035s/iter; left time: 43.9951s
	iters: 500, epoch: 9 | loss: 0.2390611
	speed: 0.0035s/iter; left time: 42.9318s
	iters: 600, epoch: 9 | loss: 0.1584213
	speed: 0.0037s/iter; left time: 45.5914s
	iters: 700, epoch: 9 | loss: 0.2132400
	speed: 0.0043s/iter; left time: 52.0247s
	iters: 800, epoch: 9 | loss: 0.2309341
	speed: 0.0046s/iter; left time: 55.1678s
	iters: 900, epoch: 9 | loss: 0.3821463
	speed: 0.0041s/iter; left time: 48.9031s
	iters: 1000, epoch: 9 | loss: 0.1607111
	speed: 0.0042s/iter; left time: 49.3017s
Epoch: 9 cost time: 4.25467848777771
Epoch: 9, Steps: 1066 | Train Loss: 0.2003407 Vali Loss: 0.1435908 Test Loss: 0.2370047
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.3882754
	speed: 0.0179s/iter; left time: 207.9461s
	iters: 200, epoch: 10 | loss: 0.1150686
	speed: 0.0035s/iter; left time: 40.8057s
	iters: 300, epoch: 10 | loss: 0.2764952
	speed: 0.0036s/iter; left time: 41.3727s
	iters: 400, epoch: 10 | loss: 0.2598367
	speed: 0.0038s/iter; left time: 42.7288s
	iters: 500, epoch: 10 | loss: 0.1050981
	speed: 0.0041s/iter; left time: 46.5824s
	iters: 600, epoch: 10 | loss: 0.1930037
	speed: 0.0044s/iter; left time: 48.9884s
	iters: 700, epoch: 10 | loss: 0.1311096
	speed: 0.0044s/iter; left time: 48.4150s
	iters: 800, epoch: 10 | loss: 0.1356922
	speed: 0.0041s/iter; left time: 44.2904s
	iters: 900, epoch: 10 | loss: 0.1482133
	speed: 0.0035s/iter; left time: 37.6780s
	iters: 1000, epoch: 10 | loss: 0.2641390
	speed: 0.0032s/iter; left time: 34.1181s
Epoch: 10 cost time: 4.084059476852417
Epoch: 10, Steps: 1066 | Train Loss: 0.1998524 Vali Loss: 0.1318067 Test Loss: 0.2066918
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.1858254
	speed: 0.0190s/iter; left time: 201.1267s
	iters: 200, epoch: 11 | loss: 0.1831876
	speed: 0.0047s/iter; left time: 49.4258s
	iters: 300, epoch: 11 | loss: 0.1884443
	speed: 0.0044s/iter; left time: 45.8008s
	iters: 400, epoch: 11 | loss: 0.1818748
	speed: 0.0046s/iter; left time: 47.1170s
	iters: 500, epoch: 11 | loss: 0.1295272
	speed: 0.0047s/iter; left time: 47.4709s
	iters: 600, epoch: 11 | loss: 0.2441868
	speed: 0.0045s/iter; left time: 44.9774s
	iters: 700, epoch: 11 | loss: 0.1517797
	speed: 0.0047s/iter; left time: 46.4525s
	iters: 800, epoch: 11 | loss: 0.1571870
	speed: 0.0036s/iter; left time: 35.4996s
	iters: 900, epoch: 11 | loss: 0.2153603
	speed: 0.0036s/iter; left time: 35.5644s
	iters: 1000, epoch: 11 | loss: 0.2306098
	speed: 0.0043s/iter; left time: 41.5480s
Epoch: 11 cost time: 4.62670111656189
Epoch: 11, Steps: 1066 | Train Loss: 0.1993768 Vali Loss: 0.1424655 Test Loss: 0.2416195
EarlyStopping counter: 3 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.1492809
	speed: 0.0172s/iter; left time: 162.9869s
	iters: 200, epoch: 12 | loss: 0.2040139
	speed: 0.0043s/iter; left time: 40.1993s
	iters: 300, epoch: 12 | loss: 0.1557356
	speed: 0.0045s/iter; left time: 41.6206s
	iters: 400, epoch: 12 | loss: 0.1321378
	speed: 0.0038s/iter; left time: 35.2168s
	iters: 500, epoch: 12 | loss: 0.1618654
	speed: 0.0029s/iter; left time: 26.6484s
	iters: 600, epoch: 12 | loss: 0.2614250
	speed: 0.0028s/iter; left time: 25.3904s
	iters: 700, epoch: 12 | loss: 0.1463463
	speed: 0.0046s/iter; left time: 40.7422s
	iters: 800, epoch: 12 | loss: 0.2360658
	speed: 0.0044s/iter; left time: 38.9620s
	iters: 900, epoch: 12 | loss: 0.1209216
	speed: 0.0041s/iter; left time: 35.5810s
	iters: 1000, epoch: 12 | loss: 0.1365637
	speed: 0.0042s/iter; left time: 36.0173s
Epoch: 12 cost time: 4.223735332489014
Epoch: 12, Steps: 1066 | Train Loss: 0.1992005 Vali Loss: 0.1290693 Test Loss: 0.2009525
EarlyStopping counter: 4 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.1120302
	speed: 0.0182s/iter; left time: 153.6146s
	iters: 200, epoch: 13 | loss: 0.2062884
	speed: 0.0037s/iter; left time: 30.8173s
	iters: 300, epoch: 13 | loss: 0.2050922
	speed: 0.0037s/iter; left time: 30.3841s
	iters: 400, epoch: 13 | loss: 0.1832284
	speed: 0.0043s/iter; left time: 35.1983s
	iters: 500, epoch: 13 | loss: 0.1447141
	speed: 0.0046s/iter; left time: 36.6373s
	iters: 600, epoch: 13 | loss: 0.1981176
	speed: 0.0043s/iter; left time: 34.4143s
	iters: 700, epoch: 13 | loss: 0.1687042
	speed: 0.0040s/iter; left time: 31.4098s
	iters: 800, epoch: 13 | loss: 0.2140620
	speed: 0.0037s/iter; left time: 28.9065s
	iters: 900, epoch: 13 | loss: 0.1218608
	speed: 0.0037s/iter; left time: 28.1510s
	iters: 1000, epoch: 13 | loss: 0.3765436
	speed: 0.0037s/iter; left time: 27.7235s
Epoch: 13 cost time: 4.271991968154907
Epoch: 13, Steps: 1066 | Train Loss: 0.1990659 Vali Loss: 0.1306309 Test Loss: 0.2054954
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTm2_336_96_Linear_ETTm2_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed32598<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.19187086820602417, mae:0.2827506959438324
