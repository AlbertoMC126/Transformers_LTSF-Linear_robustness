Args in experiment:
Namespace(activation='gelu', batch_size=8, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='exchange_rate.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=8, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='mse', lradj='type1', model='Linear', model_id='Exchange_336_192', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=192, root_path='./dataset/', save_pred_values=False, seed=25565, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : Exchange_336_192_Linear_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed25565>>>>>>>>>>>>>>>>>>>>>>>>>>
train 4784
val 569
test 1326
	iters: 100, epoch: 1 | loss: 0.3153312
	speed: 0.0041s/iter; left time: 48.0678s
	iters: 200, epoch: 1 | loss: 0.4554338
	speed: 0.0041s/iter; left time: 48.3376s
	iters: 300, epoch: 1 | loss: 0.2150922
	speed: 0.0039s/iter; left time: 45.6371s
	iters: 400, epoch: 1 | loss: 0.2192848
	speed: 0.0044s/iter; left time: 51.0994s
	iters: 500, epoch: 1 | loss: 0.1967513
	speed: 0.0045s/iter; left time: 51.1425s
Epoch: 1 cost time: 2.399919033050537
Epoch: 1, Steps: 598 | Train Loss: 0.2716094 Vali Loss: 0.4963212 Test Loss: 0.1992408
Validation loss decreased (inf --> 0.496321).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2161533
	speed: 0.0083s/iter; left time: 93.8282s
	iters: 200, epoch: 2 | loss: 0.2417082
	speed: 0.0036s/iter; left time: 40.2225s
	iters: 300, epoch: 2 | loss: 0.2670497
	speed: 0.0034s/iter; left time: 37.3933s
	iters: 400, epoch: 2 | loss: 0.1758581
	speed: 0.0037s/iter; left time: 40.4589s
	iters: 500, epoch: 2 | loss: 0.2531903
	speed: 0.0040s/iter; left time: 43.1505s
Epoch: 2 cost time: 2.1815972328186035
Epoch: 2, Steps: 598 | Train Loss: 0.2335118 Vali Loss: 0.5037937 Test Loss: 0.2098243
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.3334100
	speed: 0.0086s/iter; left time: 91.6463s
	iters: 200, epoch: 3 | loss: 0.1645330
	speed: 0.0036s/iter; left time: 37.8228s
	iters: 300, epoch: 3 | loss: 0.1612858
	speed: 0.0037s/iter; left time: 39.1390s
	iters: 400, epoch: 3 | loss: 0.1716563
	speed: 0.0038s/iter; left time: 39.7195s
	iters: 500, epoch: 3 | loss: 0.1966337
	speed: 0.0035s/iter; left time: 35.7281s
Epoch: 3 cost time: 2.1797828674316406
Epoch: 3, Steps: 598 | Train Loss: 0.2223888 Vali Loss: 0.5942040 Test Loss: 0.2165695
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.2458525
	speed: 0.0084s/iter; left time: 84.8856s
	iters: 200, epoch: 4 | loss: 0.2302097
	speed: 0.0036s/iter; left time: 36.0869s
	iters: 300, epoch: 4 | loss: 0.2708288
	speed: 0.0038s/iter; left time: 37.6279s
	iters: 400, epoch: 4 | loss: 0.3185701
	speed: 0.0035s/iter; left time: 33.8916s
	iters: 500, epoch: 4 | loss: 0.1832815
	speed: 0.0043s/iter; left time: 41.2101s
Epoch: 4 cost time: 2.259833574295044
Epoch: 4, Steps: 598 | Train Loss: 0.2182823 Vali Loss: 0.4772480 Test Loss: 0.1982463
Validation loss decreased (0.496321 --> 0.477248).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1619366
	speed: 0.0099s/iter; left time: 93.8722s
	iters: 200, epoch: 5 | loss: 0.1886748
	speed: 0.0041s/iter; left time: 38.0331s
	iters: 300, epoch: 5 | loss: 0.2129700
	speed: 0.0041s/iter; left time: 38.2808s
	iters: 400, epoch: 5 | loss: 0.2296800
	speed: 0.0041s/iter; left time: 37.5220s
	iters: 500, epoch: 5 | loss: 0.1283198
	speed: 0.0042s/iter; left time: 37.7268s
Epoch: 5 cost time: 2.428898572921753
Epoch: 5, Steps: 598 | Train Loss: 0.2158997 Vali Loss: 0.4785552 Test Loss: 0.1818101
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.4329526
	speed: 0.0101s/iter; left time: 89.5079s
	iters: 200, epoch: 6 | loss: 0.1929979
	speed: 0.0042s/iter; left time: 37.0347s
	iters: 300, epoch: 6 | loss: 0.2205238
	speed: 0.0041s/iter; left time: 35.4491s
	iters: 400, epoch: 6 | loss: 0.1871586
	speed: 0.0044s/iter; left time: 37.5410s
	iters: 500, epoch: 6 | loss: 0.2163077
	speed: 0.0044s/iter; left time: 37.6285s
Epoch: 6 cost time: 2.5458309650421143
Epoch: 6, Steps: 598 | Train Loss: 0.2148946 Vali Loss: 0.4380323 Test Loss: 0.1762389
Validation loss decreased (0.477248 --> 0.438032).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.3704886
	speed: 0.0109s/iter; left time: 90.0413s
	iters: 200, epoch: 7 | loss: 0.4107734
	speed: 0.0045s/iter; left time: 37.0236s
	iters: 300, epoch: 7 | loss: 0.1837249
	speed: 0.0044s/iter; left time: 35.2210s
	iters: 400, epoch: 7 | loss: 0.1727260
	speed: 0.0045s/iter; left time: 35.4799s
	iters: 500, epoch: 7 | loss: 0.1757092
	speed: 0.0046s/iter; left time: 35.8388s
Epoch: 7 cost time: 2.6573426723480225
Epoch: 7, Steps: 598 | Train Loss: 0.2143005 Vali Loss: 0.4582823 Test Loss: 0.1839556
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.1623677
	speed: 0.0104s/iter; left time: 80.1425s
	iters: 200, epoch: 8 | loss: 0.1877484
	speed: 0.0041s/iter; left time: 31.1358s
	iters: 300, epoch: 8 | loss: 0.2234358
	speed: 0.0043s/iter; left time: 32.3073s
	iters: 400, epoch: 8 | loss: 0.1664527
	speed: 0.0039s/iter; left time: 28.4944s
	iters: 500, epoch: 8 | loss: 0.1734520
	speed: 0.0037s/iter; left time: 27.1357s
Epoch: 8 cost time: 2.3942880630493164
Epoch: 8, Steps: 598 | Train Loss: 0.2138590 Vali Loss: 0.4635105 Test Loss: 0.1900296
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.1987330
	speed: 0.0104s/iter; left time: 73.6221s
	iters: 200, epoch: 9 | loss: 0.4290011
	speed: 0.0040s/iter; left time: 27.7863s
	iters: 300, epoch: 9 | loss: 0.3007642
	speed: 0.0038s/iter; left time: 25.9297s
	iters: 400, epoch: 9 | loss: 0.1596593
	speed: 0.0037s/iter; left time: 25.2253s
	iters: 500, epoch: 9 | loss: 0.1960230
	speed: 0.0040s/iter; left time: 26.3742s
Epoch: 9 cost time: 2.3613553047180176
Epoch: 9, Steps: 598 | Train Loss: 0.2138527 Vali Loss: 0.4707360 Test Loss: 0.1852770
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.1825250
	speed: 0.0093s/iter; left time: 60.3878s
	iters: 200, epoch: 10 | loss: 0.2589881
	speed: 0.0036s/iter; left time: 22.8369s
	iters: 300, epoch: 10 | loss: 0.1553634
	speed: 0.0036s/iter; left time: 22.8025s
	iters: 400, epoch: 10 | loss: 0.1423997
	speed: 0.0038s/iter; left time: 23.6067s
	iters: 500, epoch: 10 | loss: 0.1996672
	speed: 0.0040s/iter; left time: 24.2552s
Epoch: 10 cost time: 2.2595150470733643
Epoch: 10, Steps: 598 | Train Loss: 0.2137538 Vali Loss: 0.4655051 Test Loss: 0.1837203
EarlyStopping counter: 4 out of 5
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 11 | loss: 0.3120352
	speed: 0.0101s/iter; left time: 59.5929s
	iters: 200, epoch: 11 | loss: 0.1359357
	speed: 0.0036s/iter; left time: 20.8777s
	iters: 300, epoch: 11 | loss: 0.1454985
	speed: 0.0038s/iter; left time: 21.3606s
	iters: 400, epoch: 11 | loss: 0.3004529
	speed: 0.0039s/iter; left time: 21.6532s
	iters: 500, epoch: 11 | loss: 0.2888252
	speed: 0.0034s/iter; left time: 18.9094s
Epoch: 11 cost time: 2.1941239833831787
Epoch: 11, Steps: 598 | Train Loss: 0.2136959 Vali Loss: 0.4625867 Test Loss: 0.1834343
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : Exchange_336_192_Linear_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed25565<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 1326
mse:0.17612484097480774, mae:0.3165252208709717
