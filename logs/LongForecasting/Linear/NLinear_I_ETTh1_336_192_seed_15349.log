Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTh1', data_path='ETTh1.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='NLinear', model_id='ETTh1_336_192', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=192, root_path='./dataset/', save_pred_values=False, seed=15349, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTh1_336_192_NLinear_ETTh1_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15349>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8113
val 2689
test 2689
	iters: 100, epoch: 1 | loss: 0.3979633
	speed: 0.0056s/iter; left time: 27.7989s
	iters: 200, epoch: 1 | loss: 0.4016427
	speed: 0.0052s/iter; left time: 25.4230s
Epoch: 1 cost time: 1.3375506401062012
Epoch: 1, Steps: 253 | Train Loss: 0.4828442 Vali Loss: 1.2578497 Test Loss: 0.5395363
Validation loss decreased (inf --> 1.257850).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.5122410
	speed: 0.0113s/iter; left time: 53.1349s
	iters: 200, epoch: 2 | loss: 0.4833303
	speed: 0.0062s/iter; left time: 28.6618s
Epoch: 2 cost time: 1.4246487617492676
Epoch: 2, Steps: 253 | Train Loss: 0.4572284 Vali Loss: 1.1221956 Test Loss: 0.5001923
Validation loss decreased (1.257850 --> 1.122196).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.4290143
	speed: 0.0123s/iter; left time: 54.9880s
	iters: 200, epoch: 3 | loss: 0.4274951
	speed: 0.0058s/iter; left time: 25.2267s
Epoch: 3 cost time: 1.4622571468353271
Epoch: 3, Steps: 253 | Train Loss: 0.4079066 Vali Loss: 1.0522280 Test Loss: 0.4353600
Validation loss decreased (1.122196 --> 1.052228).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.3705111
	speed: 0.0142s/iter; left time: 59.6750s
	iters: 200, epoch: 4 | loss: 0.5129170
	speed: 0.0049s/iter; left time: 20.2779s
Epoch: 4 cost time: 1.4043927192687988
Epoch: 4, Steps: 253 | Train Loss: 0.3885978 Vali Loss: 1.0387243 Test Loss: 0.4241927
Validation loss decreased (1.052228 --> 1.038724).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.3206595
	speed: 0.0131s/iter; left time: 51.8933s
	iters: 200, epoch: 5 | loss: 0.4000874
	speed: 0.0061s/iter; left time: 23.4893s
Epoch: 5 cost time: 1.452270746231079
Epoch: 5, Steps: 253 | Train Loss: 0.3803113 Vali Loss: 1.0128580 Test Loss: 0.4228019
Validation loss decreased (1.038724 --> 1.012858).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.3248218
	speed: 0.0122s/iter; left time: 45.0977s
	iters: 200, epoch: 6 | loss: 0.3834013
	speed: 0.0059s/iter; left time: 21.2310s
Epoch: 6 cost time: 1.5334093570709229
Epoch: 6, Steps: 253 | Train Loss: 0.3740508 Vali Loss: 1.0064592 Test Loss: 0.4167305
Validation loss decreased (1.012858 --> 1.006459).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.3200143
	speed: 0.0143s/iter; left time: 49.3638s
	iters: 200, epoch: 7 | loss: 0.3926397
	speed: 0.0055s/iter; left time: 18.3293s
Epoch: 7 cost time: 1.4726817607879639
Epoch: 7, Steps: 253 | Train Loss: 0.3717649 Vali Loss: 0.9918990 Test Loss: 0.4151300
Validation loss decreased (1.006459 --> 0.991899).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.3480354
	speed: 0.0137s/iter; left time: 43.8011s
	iters: 200, epoch: 8 | loss: 0.3896068
	speed: 0.0057s/iter; left time: 17.6835s
Epoch: 8 cost time: 1.4605047702789307
Epoch: 8, Steps: 253 | Train Loss: 0.3702786 Vali Loss: 0.9973783 Test Loss: 0.4144520
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.3457467
	speed: 0.0126s/iter; left time: 37.0979s
	iters: 200, epoch: 9 | loss: 0.4059297
	speed: 0.0068s/iter; left time: 19.3870s
Epoch: 9 cost time: 1.6863341331481934
Epoch: 9, Steps: 253 | Train Loss: 0.3692778 Vali Loss: 0.9897260 Test Loss: 0.4143065
Validation loss decreased (0.991899 --> 0.989726).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.3942790
	speed: 0.0134s/iter; left time: 35.8862s
	iters: 200, epoch: 10 | loss: 0.3993079
	speed: 0.0055s/iter; left time: 14.2650s
Epoch: 10 cost time: 1.4815490245819092
Epoch: 10, Steps: 253 | Train Loss: 0.3688167 Vali Loss: 0.9871467 Test Loss: 0.4142250
Validation loss decreased (0.989726 --> 0.987147).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.3698380
	speed: 0.0146s/iter; left time: 35.5271s
	iters: 200, epoch: 11 | loss: 0.3920842
	speed: 0.0056s/iter; left time: 13.0063s
Epoch: 11 cost time: 1.5083043575286865
Epoch: 11, Steps: 253 | Train Loss: 0.3688384 Vali Loss: 0.9862646 Test Loss: 0.4137717
Validation loss decreased (0.987147 --> 0.986265).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.3252698
	speed: 0.0128s/iter; left time: 27.9281s
	iters: 200, epoch: 12 | loss: 0.2935520
	speed: 0.0059s/iter; left time: 12.3641s
Epoch: 12 cost time: 1.4571411609649658
Epoch: 12, Steps: 253 | Train Loss: 0.3685481 Vali Loss: 0.9867965 Test Loss: 0.4138272
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.3297431
	speed: 0.0108s/iter; left time: 20.7733s
	iters: 200, epoch: 13 | loss: 0.3234555
	speed: 0.0047s/iter; left time: 8.5104s
Epoch: 13 cost time: 1.2053239345550537
Epoch: 13, Steps: 253 | Train Loss: 0.3686096 Vali Loss: 0.9869804 Test Loss: 0.4138063
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.4538775
	speed: 0.0112s/iter; left time: 18.6906s
	iters: 200, epoch: 14 | loss: 0.3417788
	speed: 0.0046s/iter; left time: 7.2935s
Epoch: 14 cost time: 1.2501697540283203
Epoch: 14, Steps: 253 | Train Loss: 0.3685073 Vali Loss: 0.9863453 Test Loss: 0.4137852
EarlyStopping counter: 3 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.3972906
	speed: 0.0105s/iter; left time: 14.9670s
	iters: 200, epoch: 15 | loss: 0.4527884
	speed: 0.0047s/iter; left time: 6.1334s
Epoch: 15 cost time: 1.1676077842712402
Epoch: 15, Steps: 253 | Train Loss: 0.3684639 Vali Loss: 0.9866474 Test Loss: 0.4137835
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.3873868
	speed: 0.0093s/iter; left time: 10.8149s
	iters: 200, epoch: 16 | loss: 0.3329291
	speed: 0.0045s/iter; left time: 4.7544s
Epoch: 16 cost time: 1.12152099609375
Epoch: 16, Steps: 253 | Train Loss: 0.3680257 Vali Loss: 0.9870620 Test Loss: 0.4137838
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTh1_336_192_NLinear_ETTh1_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15349<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2689
mse:0.41321393847465515, mae:0.42062175273895264
