Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTh1', data_path='ETTh1.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='DLinear', model_id='ETTh1_336_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=15349, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTh1_336_96_DLinear_ETTh1_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15349>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.3788309
	speed: 0.0076s/iter; left time: 38.0697s
	iters: 200, epoch: 1 | loss: 0.4258653
	speed: 0.0074s/iter; left time: 36.3683s
Epoch: 1 cost time: 1.978602409362793
Epoch: 1, Steps: 256 | Train Loss: 0.4455913 Vali Loss: 0.8360726 Test Loss: 0.4801154
Validation loss decreased (inf --> 0.836073).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.4081865
	speed: 0.0183s/iter; left time: 86.9789s
	iters: 200, epoch: 2 | loss: 0.4335619
	speed: 0.0081s/iter; left time: 37.5650s
Epoch: 2 cost time: 2.0524322986602783
Epoch: 2, Steps: 256 | Train Loss: 0.4183612 Vali Loss: 0.8694280 Test Loss: 0.4884427
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.3569972
	speed: 0.0176s/iter; left time: 79.2609s
	iters: 200, epoch: 3 | loss: 0.3062048
	speed: 0.0070s/iter; left time: 30.9181s
Epoch: 3 cost time: 1.9554851055145264
Epoch: 3, Steps: 256 | Train Loss: 0.3596958 Vali Loss: 0.7907411 Test Loss: 0.4150962
Validation loss decreased (0.836073 --> 0.790741).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.3130937
	speed: 0.0189s/iter; left time: 80.3087s
	iters: 200, epoch: 4 | loss: 0.3302297
	speed: 0.0073s/iter; left time: 30.4941s
Epoch: 4 cost time: 2.0465261936187744
Epoch: 4, Steps: 256 | Train Loss: 0.3344158 Vali Loss: 0.7503821 Test Loss: 0.3971009
Validation loss decreased (0.790741 --> 0.750382).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.2718776
	speed: 0.0169s/iter; left time: 67.6904s
	iters: 200, epoch: 5 | loss: 0.3644013
	speed: 0.0086s/iter; left time: 33.3295s
Epoch: 5 cost time: 2.078805923461914
Epoch: 5, Steps: 256 | Train Loss: 0.3223255 Vali Loss: 0.6972933 Test Loss: 0.3856549
Validation loss decreased (0.750382 --> 0.697293).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.3027117
	speed: 0.0193s/iter; left time: 72.3870s
	iters: 200, epoch: 6 | loss: 0.3062598
	speed: 0.0085s/iter; left time: 30.8527s
Epoch: 6 cost time: 2.215658187866211
Epoch: 6, Steps: 256 | Train Loss: 0.3156855 Vali Loss: 0.6872252 Test Loss: 0.3848067
Validation loss decreased (0.697293 --> 0.687225).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.3360526
	speed: 0.0186s/iter; left time: 64.7941s
	iters: 200, epoch: 7 | loss: 0.2960948
	speed: 0.0066s/iter; left time: 22.3824s
Epoch: 7 cost time: 1.8663115501403809
Epoch: 7, Steps: 256 | Train Loss: 0.3123013 Vali Loss: 0.6800041 Test Loss: 0.3806253
Validation loss decreased (0.687225 --> 0.680004).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.3083351
	speed: 0.0178s/iter; left time: 57.4647s
	iters: 200, epoch: 8 | loss: 0.3138998
	speed: 0.0094s/iter; left time: 29.2589s
Epoch: 8 cost time: 2.3784427642822266
Epoch: 8, Steps: 256 | Train Loss: 0.3105059 Vali Loss: 0.6807016 Test Loss: 0.3803202
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.3488410
	speed: 0.0217s/iter; left time: 64.5614s
	iters: 200, epoch: 9 | loss: 0.2811138
	speed: 0.0082s/iter; left time: 23.5850s
Epoch: 9 cost time: 2.3092703819274902
Epoch: 9, Steps: 256 | Train Loss: 0.3091602 Vali Loss: 0.6827839 Test Loss: 0.3791045
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.3092622
	speed: 0.0194s/iter; left time: 52.7446s
	iters: 200, epoch: 10 | loss: 0.3593407
	speed: 0.0079s/iter; left time: 20.6493s
Epoch: 10 cost time: 2.1052513122558594
Epoch: 10, Steps: 256 | Train Loss: 0.3088581 Vali Loss: 0.6802106 Test Loss: 0.3784890
EarlyStopping counter: 3 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.3182406
	speed: 0.0189s/iter; left time: 46.6300s
	iters: 200, epoch: 11 | loss: 0.3473015
	speed: 0.0084s/iter; left time: 19.7453s
Epoch: 11 cost time: 2.125730037689209
Epoch: 11, Steps: 256 | Train Loss: 0.3082499 Vali Loss: 0.6786885 Test Loss: 0.3789694
Validation loss decreased (0.680004 --> 0.678688).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.3473623
	speed: 0.0206s/iter; left time: 45.3931s
	iters: 200, epoch: 12 | loss: 0.2970345
	speed: 0.0087s/iter; left time: 18.3978s
Epoch: 12 cost time: 2.385596513748169
Epoch: 12, Steps: 256 | Train Loss: 0.3083202 Vali Loss: 0.6787289 Test Loss: 0.3791720
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.2803048
	speed: 0.0200s/iter; left time: 39.0289s
	iters: 200, epoch: 13 | loss: 0.2404441
	speed: 0.0085s/iter; left time: 15.7495s
Epoch: 13 cost time: 2.210055112838745
Epoch: 13, Steps: 256 | Train Loss: 0.3083160 Vali Loss: 0.6784347 Test Loss: 0.3790312
Validation loss decreased (0.678688 --> 0.678435).  Saving model ...
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.2591214
	speed: 0.0198s/iter; left time: 33.4602s
	iters: 200, epoch: 14 | loss: 0.3082983
	speed: 0.0081s/iter; left time: 12.8925s
Epoch: 14 cost time: 2.123481512069702
Epoch: 14, Steps: 256 | Train Loss: 0.3082916 Vali Loss: 0.6784926 Test Loss: 0.3790283
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.3078263
	speed: 0.0184s/iter; left time: 26.4909s
	iters: 200, epoch: 15 | loss: 0.2761987
	speed: 0.0081s/iter; left time: 10.8302s
Epoch: 15 cost time: 2.096522331237793
Epoch: 15, Steps: 256 | Train Loss: 0.3082989 Vali Loss: 0.6788475 Test Loss: 0.3790190
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.2816692
	speed: 0.0184s/iter; left time: 21.7134s
	iters: 200, epoch: 16 | loss: 0.3074656
	speed: 0.0084s/iter; left time: 9.0725s
Epoch: 16 cost time: 2.1296491622924805
Epoch: 16, Steps: 256 | Train Loss: 0.3082086 Vali Loss: 0.6789358 Test Loss: 0.3790235
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 17 | loss: 0.3529057
	speed: 0.0178s/iter; left time: 16.4874s
	iters: 200, epoch: 17 | loss: 0.3659338
	speed: 0.0069s/iter; left time: 5.6518s
Epoch: 17 cost time: 1.8143479824066162
Epoch: 17, Steps: 256 | Train Loss: 0.3082624 Vali Loss: 0.6788530 Test Loss: 0.3790230
EarlyStopping counter: 4 out of 5
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 18 | loss: 0.3048684
	speed: 0.0139s/iter; left time: 9.2878s
	iters: 200, epoch: 18 | loss: 0.3856224
	speed: 0.0054s/iter; left time: 3.0509s
Epoch: 18 cost time: 1.422487735748291
Epoch: 18, Steps: 256 | Train Loss: 0.3082382 Vali Loss: 0.6788010 Test Loss: 0.3790243
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTh1_336_96_DLinear_ETTh1_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15349<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.3773227035999298, mae:0.3964325189590454
