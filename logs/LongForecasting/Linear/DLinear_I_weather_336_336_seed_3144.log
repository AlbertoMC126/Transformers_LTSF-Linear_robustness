Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='DLinear', model_id='weather_336_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=336, root_path='./dataset/', save_pred_values=False, seed=3144, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : weather_336_336_DLinear_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3144>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36216
val 4935
test 10204
	iters: 100, epoch: 1 | loss: 1.7527999
	speed: 0.0480s/iter; left time: 2167.0293s
	iters: 200, epoch: 1 | loss: 0.5202941
	speed: 0.0436s/iter; left time: 1966.4008s
	iters: 300, epoch: 1 | loss: 0.4862904
	speed: 0.0443s/iter; left time: 1993.5851s
	iters: 400, epoch: 1 | loss: 0.5304668
	speed: 0.0456s/iter; left time: 2046.0192s
	iters: 500, epoch: 1 | loss: 1.0932598
	speed: 0.0459s/iter; left time: 2052.8912s
	iters: 600, epoch: 1 | loss: 1.6173571
	speed: 0.0462s/iter; left time: 2064.6686s
	iters: 700, epoch: 1 | loss: 1.8980418
	speed: 0.0454s/iter; left time: 2023.6432s
	iters: 800, epoch: 1 | loss: 0.5220809
	speed: 0.0447s/iter; left time: 1986.8346s
	iters: 900, epoch: 1 | loss: 1.2595466
	speed: 0.0452s/iter; left time: 2006.0169s
	iters: 1000, epoch: 1 | loss: 0.6289631
	speed: 0.0466s/iter; left time: 2060.5330s
	iters: 1100, epoch: 1 | loss: 0.4203298
	speed: 0.0429s/iter; left time: 1895.5445s
	iters: 1200, epoch: 1 | loss: 0.4919497
	speed: 0.0449s/iter; left time: 1977.9657s
	iters: 1300, epoch: 1 | loss: 1.1851887
	speed: 0.0451s/iter; left time: 1981.5169s
	iters: 1400, epoch: 1 | loss: 3.0033722
	speed: 0.0436s/iter; left time: 1913.0068s
	iters: 1500, epoch: 1 | loss: 0.9642707
	speed: 0.0479s/iter; left time: 2094.1945s
	iters: 1600, epoch: 1 | loss: 0.6244894
	speed: 0.0470s/iter; left time: 2051.9427s
	iters: 1700, epoch: 1 | loss: 1.1853621
	speed: 0.0443s/iter; left time: 1928.4703s
	iters: 1800, epoch: 1 | loss: 0.6209508
	speed: 0.0439s/iter; left time: 1906.4799s
	iters: 1900, epoch: 1 | loss: 0.4879246
	speed: 0.0461s/iter; left time: 1996.7751s
	iters: 2000, epoch: 1 | loss: 0.5596914
	speed: 0.0449s/iter; left time: 1942.6647s
	iters: 2100, epoch: 1 | loss: 3.5715935
	speed: 0.0460s/iter; left time: 1984.6605s
	iters: 2200, epoch: 1 | loss: 0.5000876
	speed: 0.0489s/iter; left time: 2104.9896s
Epoch: 1 cost time: 102.81723999977112
Epoch: 1, Steps: 2263 | Train Loss: 1.0620137 Vali Loss: 0.7211074 Test Loss: 0.3082816
Validation loss decreased (inf --> 0.721107).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.6623787
	speed: 0.1530s/iter; left time: 6561.4951s
	iters: 200, epoch: 2 | loss: 0.5666258
	speed: 0.0470s/iter; left time: 2009.8657s
	iters: 300, epoch: 2 | loss: 0.4307852
	speed: 0.0459s/iter; left time: 1960.9482s
	iters: 400, epoch: 2 | loss: 0.4576054
	speed: 0.0452s/iter; left time: 1926.7723s
	iters: 500, epoch: 2 | loss: 3.5563686
	speed: 0.0436s/iter; left time: 1854.4150s
	iters: 600, epoch: 2 | loss: 0.8304392
	speed: 0.0457s/iter; left time: 1936.6947s
	iters: 700, epoch: 2 | loss: 0.4443967
	speed: 0.0458s/iter; left time: 1937.7680s
	iters: 800, epoch: 2 | loss: 0.5868057
	speed: 0.0456s/iter; left time: 1923.0001s
	iters: 900, epoch: 2 | loss: 2.4360161
	speed: 0.0465s/iter; left time: 1957.6194s
	iters: 1000, epoch: 2 | loss: 0.6824456
	speed: 0.0431s/iter; left time: 1808.9165s
	iters: 1100, epoch: 2 | loss: 0.5561525
	speed: 0.0428s/iter; left time: 1795.3260s
	iters: 1200, epoch: 2 | loss: 2.7427087
	speed: 0.0451s/iter; left time: 1887.0081s
	iters: 1300, epoch: 2 | loss: 0.5465751
	speed: 0.0455s/iter; left time: 1895.8866s
	iters: 1400, epoch: 2 | loss: 0.6208647
	speed: 0.0460s/iter; left time: 1915.0393s
	iters: 1500, epoch: 2 | loss: 0.5402368
	speed: 0.0469s/iter; left time: 1948.2289s
	iters: 1600, epoch: 2 | loss: 0.6422129
	speed: 0.0463s/iter; left time: 1915.4494s
	iters: 1700, epoch: 2 | loss: 0.4996469
	speed: 0.0449s/iter; left time: 1852.3695s
	iters: 1800, epoch: 2 | loss: 0.8835243
	speed: 0.0458s/iter; left time: 1887.2850s
	iters: 1900, epoch: 2 | loss: 0.8508610
	speed: 0.0458s/iter; left time: 1882.2794s
	iters: 2000, epoch: 2 | loss: 0.7178778
	speed: 0.0443s/iter; left time: 1818.1286s
	iters: 2100, epoch: 2 | loss: 0.5420514
	speed: 0.0444s/iter; left time: 1814.9614s
	iters: 2200, epoch: 2 | loss: 2.8129935
	speed: 0.0477s/iter; left time: 1945.5267s
Epoch: 2 cost time: 102.56664800643921
Epoch: 2, Steps: 2263 | Train Loss: 1.1799196 Vali Loss: 0.7545133 Test Loss: 0.3570701
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 3.0831552
	speed: 0.1523s/iter; left time: 6189.3289s
	iters: 200, epoch: 3 | loss: 0.4157208
	speed: 0.0435s/iter; left time: 1764.2334s
	iters: 300, epoch: 3 | loss: 0.4254785
	speed: 0.0456s/iter; left time: 1845.1494s
	iters: 400, epoch: 3 | loss: 3.4594183
	speed: 0.0438s/iter; left time: 1768.1157s
	iters: 500, epoch: 3 | loss: 0.5226623
	speed: 0.0451s/iter; left time: 1812.9838s
	iters: 600, epoch: 3 | loss: 0.5274403
	speed: 0.0442s/iter; left time: 1774.3452s
	iters: 700, epoch: 3 | loss: 1.1093845
	speed: 0.0459s/iter; left time: 1839.5243s
	iters: 800, epoch: 3 | loss: 0.4880756
	speed: 0.0450s/iter; left time: 1797.5684s
	iters: 900, epoch: 3 | loss: 0.4722296
	speed: 0.0421s/iter; left time: 1676.5237s
	iters: 1000, epoch: 3 | loss: 0.5625686
	speed: 0.0468s/iter; left time: 1860.7844s
	iters: 1100, epoch: 3 | loss: 0.3937156
	speed: 0.0420s/iter; left time: 1665.7381s
	iters: 1200, epoch: 3 | loss: 0.4854608
	speed: 0.0460s/iter; left time: 1819.6629s
	iters: 1300, epoch: 3 | loss: 0.3413695
	speed: 0.0441s/iter; left time: 1737.3428s
	iters: 1400, epoch: 3 | loss: 0.6945250
	speed: 0.0466s/iter; left time: 1834.2946s
	iters: 1500, epoch: 3 | loss: 1.0802333
	speed: 0.0471s/iter; left time: 1848.9700s
	iters: 1600, epoch: 3 | loss: 1.4474196
	speed: 0.0437s/iter; left time: 1709.1265s
	iters: 1700, epoch: 3 | loss: 1.7826548
	speed: 0.0467s/iter; left time: 1823.2159s
	iters: 1800, epoch: 3 | loss: 0.4279354
	speed: 0.0489s/iter; left time: 1905.2027s
	iters: 1900, epoch: 3 | loss: 1.4153397
	speed: 0.0455s/iter; left time: 1765.2361s
	iters: 2000, epoch: 3 | loss: 0.5079778
	speed: 0.0473s/iter; left time: 1833.5912s
	iters: 2100, epoch: 3 | loss: 1.0813472
	speed: 0.0468s/iter; left time: 1809.1007s
	iters: 2200, epoch: 3 | loss: 0.4988188
	speed: 0.0453s/iter; left time: 1745.7757s
Epoch: 3 cost time: 102.3799614906311
Epoch: 3, Steps: 2263 | Train Loss: 0.7847324 Vali Loss: 0.5976496 Test Loss: 0.2785204
Validation loss decreased (0.721107 --> 0.597650).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.4762332
	speed: 0.1452s/iter; left time: 5573.5295s
	iters: 200, epoch: 4 | loss: 0.9956129
	speed: 0.0456s/iter; left time: 1745.7017s
	iters: 300, epoch: 4 | loss: 0.9844638
	speed: 0.0451s/iter; left time: 1720.9162s
	iters: 400, epoch: 4 | loss: 0.5632589
	speed: 0.0439s/iter; left time: 1670.1392s
	iters: 500, epoch: 4 | loss: 0.5674778
	speed: 0.0450s/iter; left time: 1709.5754s
	iters: 600, epoch: 4 | loss: 0.5077397
	speed: 0.0456s/iter; left time: 1725.6961s
	iters: 700, epoch: 4 | loss: 0.5039702
	speed: 0.0466s/iter; left time: 1759.9124s
	iters: 800, epoch: 4 | loss: 0.5538307
	speed: 0.0465s/iter; left time: 1753.5640s
	iters: 900, epoch: 4 | loss: 0.4913146
	speed: 0.0451s/iter; left time: 1693.4043s
	iters: 1000, epoch: 4 | loss: 0.3582198
	speed: 0.0451s/iter; left time: 1690.8909s
	iters: 1100, epoch: 4 | loss: 0.7211467
	speed: 0.0473s/iter; left time: 1768.9746s
	iters: 1200, epoch: 4 | loss: 1.0606402
	speed: 0.0425s/iter; left time: 1583.4057s
	iters: 1300, epoch: 4 | loss: 0.4589556
	speed: 0.0459s/iter; left time: 1707.8670s
	iters: 1400, epoch: 4 | loss: 0.9063333
	speed: 0.0463s/iter; left time: 1718.1144s
	iters: 1500, epoch: 4 | loss: 0.3593489
	speed: 0.0442s/iter; left time: 1635.9097s
	iters: 1600, epoch: 4 | loss: 0.3994562
	speed: 0.0452s/iter; left time: 1666.4201s
	iters: 1700, epoch: 4 | loss: 0.3251519
	speed: 0.0460s/iter; left time: 1691.0817s
	iters: 1800, epoch: 4 | loss: 1.0739105
	speed: 0.0464s/iter; left time: 1702.0491s
	iters: 1900, epoch: 4 | loss: 0.2794185
	speed: 0.0458s/iter; left time: 1674.2371s
	iters: 2000, epoch: 4 | loss: 0.4513457
	speed: 0.0476s/iter; left time: 1734.8861s
	iters: 2100, epoch: 4 | loss: 0.4043871
	speed: 0.0471s/iter; left time: 1712.7861s
	iters: 2200, epoch: 4 | loss: 1.5164691
	speed: 0.0451s/iter; left time: 1634.1488s
Epoch: 4 cost time: 102.88120031356812
Epoch: 4, Steps: 2263 | Train Loss: 0.5817772 Vali Loss: 0.5359744 Test Loss: 0.2534515
Validation loss decreased (0.597650 --> 0.535974).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.3211837
	speed: 0.1583s/iter; left time: 5717.2535s
	iters: 200, epoch: 5 | loss: 0.8646111
	speed: 0.0458s/iter; left time: 1648.8128s
	iters: 300, epoch: 5 | loss: 0.4510549
	speed: 0.0437s/iter; left time: 1567.8736s
	iters: 400, epoch: 5 | loss: 0.5002054
	speed: 0.0455s/iter; left time: 1628.2488s
	iters: 500, epoch: 5 | loss: 0.4534210
	speed: 0.0460s/iter; left time: 1642.1739s
	iters: 600, epoch: 5 | loss: 0.3851239
	speed: 0.0464s/iter; left time: 1652.6217s
	iters: 700, epoch: 5 | loss: 0.3354412
	speed: 0.0455s/iter; left time: 1616.4541s
	iters: 800, epoch: 5 | loss: 0.2785641
	speed: 0.0463s/iter; left time: 1641.1534s
	iters: 900, epoch: 5 | loss: 0.4079037
	speed: 0.0456s/iter; left time: 1610.7357s
	iters: 1000, epoch: 5 | loss: 0.4201001
	speed: 0.0444s/iter; left time: 1564.5131s
	iters: 1100, epoch: 5 | loss: 0.4940785
	speed: 0.0437s/iter; left time: 1535.9823s
	iters: 1200, epoch: 5 | loss: 0.4528623
	speed: 0.0467s/iter; left time: 1634.4123s
	iters: 1300, epoch: 5 | loss: 0.4392094
	speed: 0.0465s/iter; left time: 1624.3881s
	iters: 1400, epoch: 5 | loss: 0.5025097
	speed: 0.0456s/iter; left time: 1588.7299s
	iters: 1500, epoch: 5 | loss: 0.5536003
	speed: 0.0471s/iter; left time: 1635.2668s
	iters: 1600, epoch: 5 | loss: 0.5391905
	speed: 0.0463s/iter; left time: 1600.7305s
	iters: 1700, epoch: 5 | loss: 0.4203917
	speed: 0.0467s/iter; left time: 1610.7941s
	iters: 1800, epoch: 5 | loss: 0.4561807
	speed: 0.0428s/iter; left time: 1473.6928s
	iters: 1900, epoch: 5 | loss: 0.4673353
	speed: 0.0426s/iter; left time: 1460.1679s
	iters: 2000, epoch: 5 | loss: 0.3878632
	speed: 0.0439s/iter; left time: 1501.0574s
	iters: 2100, epoch: 5 | loss: 0.9216853
	speed: 0.0451s/iter; left time: 1539.9101s
	iters: 2200, epoch: 5 | loss: 0.3690749
	speed: 0.0459s/iter; left time: 1561.9203s
Epoch: 5 cost time: 102.04161763191223
Epoch: 5, Steps: 2263 | Train Loss: 0.5288601 Vali Loss: 0.5093998 Test Loss: 0.2498398
Validation loss decreased (0.535974 --> 0.509400).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 1.1231437
	speed: 0.1493s/iter; left time: 5054.3722s
	iters: 200, epoch: 6 | loss: 0.3790186
	speed: 0.0435s/iter; left time: 1467.8558s
	iters: 300, epoch: 6 | loss: 0.4249028
	speed: 0.0466s/iter; left time: 1569.4531s
	iters: 400, epoch: 6 | loss: 1.3925498
	speed: 0.0446s/iter; left time: 1497.0715s
	iters: 500, epoch: 6 | loss: 0.5763479
	speed: 0.0462s/iter; left time: 1545.7257s
	iters: 600, epoch: 6 | loss: 0.4871226
	speed: 0.0481s/iter; left time: 1603.9327s
	iters: 700, epoch: 6 | loss: 0.5901963
	speed: 0.0464s/iter; left time: 1541.0129s
	iters: 800, epoch: 6 | loss: 0.3651587
	speed: 0.0451s/iter; left time: 1494.1388s
	iters: 900, epoch: 6 | loss: 0.3768999
	speed: 0.0433s/iter; left time: 1431.2926s
	iters: 1000, epoch: 6 | loss: 0.5100312
	speed: 0.0444s/iter; left time: 1461.3727s
	iters: 1100, epoch: 6 | loss: 0.6142462
	speed: 0.0456s/iter; left time: 1496.5467s
	iters: 1200, epoch: 6 | loss: 0.8572864
	speed: 0.0426s/iter; left time: 1396.5594s
	iters: 1300, epoch: 6 | loss: 0.4607383
	speed: 0.0441s/iter; left time: 1438.4391s
	iters: 1400, epoch: 6 | loss: 0.4203587
	speed: 0.0458s/iter; left time: 1491.5224s
	iters: 1500, epoch: 6 | loss: 0.3265096
	speed: 0.0464s/iter; left time: 1505.2374s
	iters: 1600, epoch: 6 | loss: 0.3737273
	speed: 0.0463s/iter; left time: 1496.3094s
	iters: 1700, epoch: 6 | loss: 0.5844451
	speed: 0.0469s/iter; left time: 1511.5838s
	iters: 1800, epoch: 6 | loss: 0.4741085
	speed: 0.0463s/iter; left time: 1488.6105s
	iters: 1900, epoch: 6 | loss: 0.4479460
	speed: 0.0471s/iter; left time: 1509.4746s
	iters: 2000, epoch: 6 | loss: 0.4322428
	speed: 0.0465s/iter; left time: 1486.9514s
	iters: 2100, epoch: 6 | loss: 0.4351984
	speed: 0.0470s/iter; left time: 1496.0260s
	iters: 2200, epoch: 6 | loss: 0.3893909
	speed: 0.0416s/iter; left time: 1319.6395s
Epoch: 6 cost time: 102.39732646942139
Epoch: 6, Steps: 2263 | Train Loss: 0.5095814 Vali Loss: 0.4964715 Test Loss: 0.2421716
Validation loss decreased (0.509400 --> 0.496471).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.8674197
	speed: 0.1502s/iter; left time: 4743.3113s
	iters: 200, epoch: 7 | loss: 0.4709535
	speed: 0.0462s/iter; left time: 1454.5076s
	iters: 300, epoch: 7 | loss: 0.3607713
	speed: 0.0449s/iter; left time: 1409.8073s
	iters: 400, epoch: 7 | loss: 0.4439569
	speed: 0.0440s/iter; left time: 1377.9556s
	iters: 500, epoch: 7 | loss: 0.5426902
	speed: 0.0465s/iter; left time: 1450.3668s
	iters: 600, epoch: 7 | loss: 0.3915703
	speed: 0.0454s/iter; left time: 1411.9575s
	iters: 700, epoch: 7 | loss: 0.5024360
	speed: 0.0453s/iter; left time: 1402.8480s
	iters: 800, epoch: 7 | loss: 0.9680376
	speed: 0.0446s/iter; left time: 1378.1750s
	iters: 900, epoch: 7 | loss: 0.3934557
	speed: 0.0440s/iter; left time: 1355.4490s
	iters: 1000, epoch: 7 | loss: 0.3911884
	speed: 0.0450s/iter; left time: 1380.1037s
	iters: 1100, epoch: 7 | loss: 0.3889970
	speed: 0.0463s/iter; left time: 1416.6124s
	iters: 1200, epoch: 7 | loss: 0.3382924
	speed: 0.0455s/iter; left time: 1387.4772s
	iters: 1300, epoch: 7 | loss: 0.3664110
	speed: 0.0451s/iter; left time: 1370.4192s
	iters: 1400, epoch: 7 | loss: 0.4568584
	speed: 0.0442s/iter; left time: 1337.1991s
	iters: 1500, epoch: 7 | loss: 0.9022535
	speed: 0.0438s/iter; left time: 1321.4599s
	iters: 1600, epoch: 7 | loss: 0.9496984
	speed: 0.0438s/iter; left time: 1316.6913s
	iters: 1700, epoch: 7 | loss: 0.3026116
	speed: 0.0441s/iter; left time: 1321.3370s
	iters: 1800, epoch: 7 | loss: 0.3364645
	speed: 0.0469s/iter; left time: 1402.8911s
	iters: 1900, epoch: 7 | loss: 0.4553422
	speed: 0.0456s/iter; left time: 1359.3643s
	iters: 2000, epoch: 7 | loss: 0.4531550
	speed: 0.0469s/iter; left time: 1392.8205s
	iters: 2100, epoch: 7 | loss: 0.4298806
	speed: 0.0429s/iter; left time: 1269.5408s
	iters: 2200, epoch: 7 | loss: 0.3473065
	speed: 0.0447s/iter; left time: 1317.0851s
Epoch: 7 cost time: 100.99187469482422
Epoch: 7, Steps: 2263 | Train Loss: 0.5012258 Vali Loss: 0.4998357 Test Loss: 0.2437183
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.8660561
	speed: 0.1469s/iter; left time: 4306.6629s
	iters: 200, epoch: 8 | loss: 0.3391121
	speed: 0.0458s/iter; left time: 1337.7611s
	iters: 300, epoch: 8 | loss: 0.7389143
	speed: 0.0448s/iter; left time: 1303.9378s
	iters: 400, epoch: 8 | loss: 0.9601320
	speed: 0.0433s/iter; left time: 1257.0973s
	iters: 500, epoch: 8 | loss: 0.3872492
	speed: 0.0435s/iter; left time: 1258.3804s
	iters: 600, epoch: 8 | loss: 0.4972590
	speed: 0.0466s/iter; left time: 1342.4076s
	iters: 700, epoch: 8 | loss: 0.4715827
	speed: 0.0480s/iter; left time: 1377.1786s
	iters: 800, epoch: 8 | loss: 0.3686574
	speed: 0.0455s/iter; left time: 1302.0685s
	iters: 900, epoch: 8 | loss: 1.0355586
	speed: 0.0449s/iter; left time: 1280.6204s
	iters: 1000, epoch: 8 | loss: 0.9214731
	speed: 0.0436s/iter; left time: 1239.2234s
	iters: 1100, epoch: 8 | loss: 0.3310343
	speed: 0.0468s/iter; left time: 1324.2233s
	iters: 1200, epoch: 8 | loss: 0.5100523
	speed: 0.0455s/iter; left time: 1283.9439s
	iters: 1300, epoch: 8 | loss: 0.3739899
	speed: 0.0452s/iter; left time: 1271.8259s
	iters: 1400, epoch: 8 | loss: 0.2855165
	speed: 0.0460s/iter; left time: 1287.6167s
	iters: 1500, epoch: 8 | loss: 0.4015161
	speed: 0.0470s/iter; left time: 1311.5838s
	iters: 1600, epoch: 8 | loss: 0.4482538
	speed: 0.0464s/iter; left time: 1290.9241s
	iters: 1700, epoch: 8 | loss: 0.3532313
	speed: 0.0455s/iter; left time: 1260.2442s
	iters: 1800, epoch: 8 | loss: 0.8647425
	speed: 0.0445s/iter; left time: 1228.3980s
	iters: 1900, epoch: 8 | loss: 0.3408858
	speed: 0.0455s/iter; left time: 1253.0644s
	iters: 2000, epoch: 8 | loss: 0.3667617
	speed: 0.0468s/iter; left time: 1283.9678s
	iters: 2100, epoch: 8 | loss: 0.9478651
	speed: 0.0448s/iter; left time: 1222.7210s
	iters: 2200, epoch: 8 | loss: 0.3638572
	speed: 0.0441s/iter; left time: 1200.2239s
Epoch: 8 cost time: 101.7574074268341
Epoch: 8, Steps: 2263 | Train Loss: 0.4971457 Vali Loss: 0.4965634 Test Loss: 0.2423028
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.2858844
	speed: 0.1440s/iter; left time: 3895.6718s
	iters: 200, epoch: 9 | loss: 0.4625410
	speed: 0.0456s/iter; left time: 1230.4377s
	iters: 300, epoch: 9 | loss: 0.3454350
	speed: 0.0467s/iter; left time: 1252.9826s
	iters: 400, epoch: 9 | loss: 0.4290717
	speed: 0.0439s/iter; left time: 1175.8999s
	iters: 500, epoch: 9 | loss: 0.4744291
	speed: 0.0461s/iter; left time: 1229.6874s
	iters: 600, epoch: 9 | loss: 0.4402269
	speed: 0.0458s/iter; left time: 1217.6148s
	iters: 700, epoch: 9 | loss: 0.2998868
	speed: 0.0456s/iter; left time: 1206.6677s
	iters: 800, epoch: 9 | loss: 0.3262906
	speed: 0.0418s/iter; left time: 1101.4559s
	iters: 900, epoch: 9 | loss: 0.4585178
	speed: 0.0449s/iter; left time: 1178.5736s
	iters: 1000, epoch: 9 | loss: 1.0340751
	speed: 0.0435s/iter; left time: 1138.3598s
	iters: 1100, epoch: 9 | loss: 0.2987563
	speed: 0.0467s/iter; left time: 1216.4484s
	iters: 1200, epoch: 9 | loss: 0.6361910
	speed: 0.0437s/iter; left time: 1133.4044s
	iters: 1300, epoch: 9 | loss: 0.3885710
	speed: 0.0448s/iter; left time: 1159.6763s
	iters: 1400, epoch: 9 | loss: 0.3509052
	speed: 0.0456s/iter; left time: 1173.6101s
	iters: 1500, epoch: 9 | loss: 0.3626147
	speed: 0.0441s/iter; left time: 1130.4985s
	iters: 1600, epoch: 9 | loss: 1.0478328
	speed: 0.0462s/iter; left time: 1180.0688s
	iters: 1700, epoch: 9 | loss: 0.3937562
	speed: 0.0461s/iter; left time: 1173.7799s
	iters: 1800, epoch: 9 | loss: 0.5189973
	speed: 0.0474s/iter; left time: 1202.5203s
	iters: 1900, epoch: 9 | loss: 0.3169967
	speed: 0.0447s/iter; left time: 1128.8287s
	iters: 2000, epoch: 9 | loss: 0.9323757
	speed: 0.0468s/iter; left time: 1177.9811s
	iters: 2100, epoch: 9 | loss: 0.3885924
	speed: 0.0445s/iter; left time: 1116.1099s
	iters: 2200, epoch: 9 | loss: 0.5243439
	speed: 0.0450s/iter; left time: 1123.1306s
Epoch: 9 cost time: 101.44705963134766
Epoch: 9, Steps: 2263 | Train Loss: 0.4950668 Vali Loss: 0.4949705 Test Loss: 0.2424478
Validation loss decreased (0.496471 --> 0.494971).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.4472010
	speed: 0.1530s/iter; left time: 3793.9199s
	iters: 200, epoch: 10 | loss: 0.3287796
	speed: 0.0423s/iter; left time: 1043.3541s
	iters: 300, epoch: 10 | loss: 0.8281285
	speed: 0.0449s/iter; left time: 1103.2307s
	iters: 400, epoch: 10 | loss: 0.3979469
	speed: 0.0448s/iter; left time: 1097.4286s
	iters: 500, epoch: 10 | loss: 0.6798695
	speed: 0.0461s/iter; left time: 1123.6898s
	iters: 600, epoch: 10 | loss: 0.2699920
	speed: 0.0473s/iter; left time: 1148.6042s
	iters: 700, epoch: 10 | loss: 1.0604074
	speed: 0.0461s/iter; left time: 1114.5587s
	iters: 800, epoch: 10 | loss: 0.5700246
	speed: 0.0457s/iter; left time: 1101.5363s
	iters: 900, epoch: 10 | loss: 0.4324422
	speed: 0.0447s/iter; left time: 1072.9660s
	iters: 1000, epoch: 10 | loss: 0.9159770
	speed: 0.0445s/iter; left time: 1064.4607s
	iters: 1100, epoch: 10 | loss: 0.3450094
	speed: 0.0441s/iter; left time: 1048.7570s
	iters: 1200, epoch: 10 | loss: 0.4293927
	speed: 0.0457s/iter; left time: 1082.6776s
	iters: 1300, epoch: 10 | loss: 0.5252981
	speed: 0.0432s/iter; left time: 1020.4307s
	iters: 1400, epoch: 10 | loss: 0.3940378
	speed: 0.0459s/iter; left time: 1077.5174s
	iters: 1500, epoch: 10 | loss: 0.3422128
	speed: 0.0456s/iter; left time: 1066.9563s
	iters: 1600, epoch: 10 | loss: 0.3284138
	speed: 0.0446s/iter; left time: 1038.3331s
	iters: 1700, epoch: 10 | loss: 0.4204678
	speed: 0.0431s/iter; left time: 999.2802s
	iters: 1800, epoch: 10 | loss: 0.4470065
	speed: 0.0456s/iter; left time: 1053.3759s
	iters: 1900, epoch: 10 | loss: 1.0439802
	speed: 0.0427s/iter; left time: 981.4921s
	iters: 2000, epoch: 10 | loss: 0.4569519
	speed: 0.0451s/iter; left time: 1033.3623s
	iters: 2100, epoch: 10 | loss: 0.2591801
	speed: 0.0453s/iter; left time: 1032.0728s
	iters: 2200, epoch: 10 | loss: 0.3319010
	speed: 0.0458s/iter; left time: 1038.9945s
Epoch: 10 cost time: 101.03177833557129
Epoch: 10, Steps: 2263 | Train Loss: 0.4940553 Vali Loss: 0.4926864 Test Loss: 0.2411366
Validation loss decreased (0.494971 --> 0.492686).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.9857714
	speed: 0.1584s/iter; left time: 3567.8524s
	iters: 200, epoch: 11 | loss: 0.4635027
	speed: 0.0432s/iter; left time: 969.0973s
	iters: 300, epoch: 11 | loss: 0.3557611
	speed: 0.0445s/iter; left time: 994.2700s
	iters: 400, epoch: 11 | loss: 0.3381284
	speed: 0.0462s/iter; left time: 1026.3084s
	iters: 500, epoch: 11 | loss: 0.2982219
	speed: 0.0448s/iter; left time: 992.0534s
	iters: 600, epoch: 11 | loss: 0.4317519
	speed: 0.0436s/iter; left time: 960.5293s
	iters: 700, epoch: 11 | loss: 0.3990206
	speed: 0.0449s/iter; left time: 984.5958s
	iters: 800, epoch: 11 | loss: 0.9845010
	speed: 0.0453s/iter; left time: 988.5308s
	iters: 900, epoch: 11 | loss: 0.5418617
	speed: 0.0450s/iter; left time: 978.2864s
	iters: 1000, epoch: 11 | loss: 0.5685993
	speed: 0.0451s/iter; left time: 974.7228s
	iters: 1100, epoch: 11 | loss: 0.2910605
	speed: 0.0450s/iter; left time: 969.8066s
	iters: 1200, epoch: 11 | loss: 0.4956799
	speed: 0.0451s/iter; left time: 966.4869s
	iters: 1300, epoch: 11 | loss: 0.4885916
	speed: 0.0459s/iter; left time: 978.1746s
	iters: 1400, epoch: 11 | loss: 0.4543246
	speed: 0.0445s/iter; left time: 944.8023s
	iters: 1500, epoch: 11 | loss: 0.4072690
	speed: 0.0477s/iter; left time: 1007.3281s
	iters: 1600, epoch: 11 | loss: 0.5182786
	speed: 0.0448s/iter; left time: 942.4765s
	iters: 1700, epoch: 11 | loss: 0.3146420
	speed: 0.0475s/iter; left time: 994.7565s
	iters: 1800, epoch: 11 | loss: 0.5163196
	speed: 0.0434s/iter; left time: 904.8793s
	iters: 1900, epoch: 11 | loss: 0.4293392
	speed: 0.0475s/iter; left time: 983.8367s
	iters: 2000, epoch: 11 | loss: 0.3188585
	speed: 0.0465s/iter; left time: 960.1721s
	iters: 2100, epoch: 11 | loss: 1.1255801
	speed: 0.0479s/iter; left time: 982.4523s
	iters: 2200, epoch: 11 | loss: 0.4632209
	speed: 0.0429s/iter; left time: 875.5345s
Epoch: 11 cost time: 101.90491127967834
Epoch: 11, Steps: 2263 | Train Loss: 0.4935259 Vali Loss: 0.4935437 Test Loss: 0.2407534
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.3978987
	speed: 0.1487s/iter; left time: 3014.1488s
	iters: 200, epoch: 12 | loss: 0.3448308
	speed: 0.0410s/iter; left time: 826.8344s
	iters: 300, epoch: 12 | loss: 0.4544530
	speed: 0.0441s/iter; left time: 884.3040s
	iters: 400, epoch: 12 | loss: 0.4083166
	speed: 0.0408s/iter; left time: 814.8720s
	iters: 500, epoch: 12 | loss: 0.4173137
	speed: 0.0450s/iter; left time: 893.1474s
	iters: 600, epoch: 12 | loss: 0.7271093
	speed: 0.0447s/iter; left time: 883.1215s
	iters: 700, epoch: 12 | loss: 0.3149154
	speed: 0.0455s/iter; left time: 895.2782s
	iters: 800, epoch: 12 | loss: 0.4870043
	speed: 0.0449s/iter; left time: 878.0774s
	iters: 900, epoch: 12 | loss: 0.3134755
	speed: 0.0449s/iter; left time: 873.9957s
	iters: 1000, epoch: 12 | loss: 0.4730825
	speed: 0.0461s/iter; left time: 893.0936s
	iters: 1100, epoch: 12 | loss: 0.5242040
	speed: 0.0444s/iter; left time: 855.9558s
	iters: 1200, epoch: 12 | loss: 0.3622351
	speed: 0.0430s/iter; left time: 824.8230s
	iters: 1300, epoch: 12 | loss: 0.5332772
	speed: 0.0470s/iter; left time: 896.2318s
	iters: 1400, epoch: 12 | loss: 0.4484129
	speed: 0.0466s/iter; left time: 884.7004s
	iters: 1500, epoch: 12 | loss: 0.9878857
	speed: 0.0430s/iter; left time: 811.7635s
	iters: 1600, epoch: 12 | loss: 0.5022476
	speed: 0.0452s/iter; left time: 847.6868s
	iters: 1700, epoch: 12 | loss: 0.3400086
	speed: 0.0455s/iter; left time: 848.5531s
	iters: 1800, epoch: 12 | loss: 0.5067894
	speed: 0.0469s/iter; left time: 871.6404s
	iters: 1900, epoch: 12 | loss: 0.3845054
	speed: 0.0445s/iter; left time: 822.5051s
	iters: 2000, epoch: 12 | loss: 0.8824099
	speed: 0.0413s/iter; left time: 758.5988s
	iters: 2100, epoch: 12 | loss: 0.8757640
	speed: 0.0460s/iter; left time: 840.6567s
	iters: 2200, epoch: 12 | loss: 0.3472840
	speed: 0.0456s/iter; left time: 829.1071s
Epoch: 12 cost time: 100.30661916732788
Epoch: 12, Steps: 2263 | Train Loss: 0.4932042 Vali Loss: 0.4934286 Test Loss: 0.2397627
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.4696350
	speed: 0.1557s/iter; left time: 2802.7819s
	iters: 200, epoch: 13 | loss: 0.9179577
	speed: 0.0448s/iter; left time: 802.2322s
	iters: 300, epoch: 13 | loss: 0.3166825
	speed: 0.0451s/iter; left time: 802.1544s
	iters: 400, epoch: 13 | loss: 0.4341732
	speed: 0.0455s/iter; left time: 805.5792s
	iters: 500, epoch: 13 | loss: 0.4264920
	speed: 0.0458s/iter; left time: 805.7369s
	iters: 600, epoch: 13 | loss: 0.3831499
	speed: 0.0462s/iter; left time: 808.1353s
	iters: 700, epoch: 13 | loss: 0.4171855
	speed: 0.0461s/iter; left time: 801.5409s
	iters: 800, epoch: 13 | loss: 0.3450288
	speed: 0.0429s/iter; left time: 742.9856s
	iters: 900, epoch: 13 | loss: 0.4072719
	speed: 0.0441s/iter; left time: 758.1704s
	iters: 1000, epoch: 13 | loss: 0.4368443
	speed: 0.0454s/iter; left time: 777.3359s
	iters: 1100, epoch: 13 | loss: 0.6126395
	speed: 0.0455s/iter; left time: 773.5728s
	iters: 1200, epoch: 13 | loss: 0.4204074
	speed: 0.0460s/iter; left time: 777.6873s
	iters: 1300, epoch: 13 | loss: 0.3369946
	speed: 0.0472s/iter; left time: 793.0985s
	iters: 1400, epoch: 13 | loss: 0.4569059
	speed: 0.0469s/iter; left time: 783.5742s
	iters: 1500, epoch: 13 | loss: 0.4552560
	speed: 0.0466s/iter; left time: 773.0124s
	iters: 1600, epoch: 13 | loss: 1.0654027
	speed: 0.0452s/iter; left time: 745.6121s
	iters: 1700, epoch: 13 | loss: 0.3265963
	speed: 0.0434s/iter; left time: 711.6223s
	iters: 1800, epoch: 13 | loss: 0.3735163
	speed: 0.0436s/iter; left time: 711.5096s
	iters: 1900, epoch: 13 | loss: 0.4138221
	speed: 0.0450s/iter; left time: 729.2881s
	iters: 2000, epoch: 13 | loss: 0.4144236
	speed: 0.0450s/iter; left time: 724.8605s
	iters: 2100, epoch: 13 | loss: 0.5051060
	speed: 0.0458s/iter; left time: 732.8766s
	iters: 2200, epoch: 13 | loss: 0.8749961
	speed: 0.0467s/iter; left time: 742.4743s
Epoch: 13 cost time: 101.95036578178406
Epoch: 13, Steps: 2263 | Train Loss: 0.4930655 Vali Loss: 0.4930322 Test Loss: 0.2401052
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.3286051
	speed: 0.1558s/iter; left time: 2452.3734s
	iters: 200, epoch: 14 | loss: 0.4935761
	speed: 0.0445s/iter; left time: 696.3382s
	iters: 300, epoch: 14 | loss: 0.6939679
	speed: 0.0434s/iter; left time: 674.3072s
	iters: 400, epoch: 14 | loss: 0.3565468
	speed: 0.0475s/iter; left time: 734.0260s
	iters: 500, epoch: 14 | loss: 0.4797480
	speed: 0.0471s/iter; left time: 722.8692s
	iters: 600, epoch: 14 | loss: 0.4177393
	speed: 0.0444s/iter; left time: 676.1132s
	iters: 700, epoch: 14 | loss: 0.9119999
	speed: 0.0405s/iter; left time: 612.7798s
	iters: 800, epoch: 14 | loss: 0.3821315
	speed: 0.0444s/iter; left time: 667.3957s
	iters: 900, epoch: 14 | loss: 0.4045234
	speed: 0.0450s/iter; left time: 672.3318s
	iters: 1000, epoch: 14 | loss: 0.9574900
	speed: 0.0461s/iter; left time: 684.9043s
	iters: 1100, epoch: 14 | loss: 0.4021190
	speed: 0.0433s/iter; left time: 638.0832s
	iters: 1200, epoch: 14 | loss: 0.5327121
	speed: 0.0412s/iter; left time: 603.2166s
	iters: 1300, epoch: 14 | loss: 0.4465635
	speed: 0.0466s/iter; left time: 677.6978s
	iters: 1400, epoch: 14 | loss: 0.3782220
	speed: 0.0480s/iter; left time: 692.5625s
	iters: 1500, epoch: 14 | loss: 0.5691441
	speed: 0.0429s/iter; left time: 615.0458s
	iters: 1600, epoch: 14 | loss: 0.3606426
	speed: 0.0441s/iter; left time: 627.9055s
	iters: 1700, epoch: 14 | loss: 1.0125699
	speed: 0.0415s/iter; left time: 586.9527s
	iters: 1800, epoch: 14 | loss: 0.4246386
	speed: 0.0461s/iter; left time: 647.2552s
	iters: 1900, epoch: 14 | loss: 0.3889883
	speed: 0.0466s/iter; left time: 650.1000s
	iters: 2000, epoch: 14 | loss: 0.5175548
	speed: 0.0448s/iter; left time: 619.7761s
	iters: 2100, epoch: 14 | loss: 0.3228787
	speed: 0.0422s/iter; left time: 579.3221s
	iters: 2200, epoch: 14 | loss: 1.0498759
	speed: 0.0424s/iter; left time: 578.7567s
Epoch: 14 cost time: 99.94134259223938
Epoch: 14, Steps: 2263 | Train Loss: 0.4930040 Vali Loss: 0.4940781 Test Loss: 0.2402797
EarlyStopping counter: 4 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.9652343
	speed: 0.1430s/iter; left time: 1928.1256s
	iters: 200, epoch: 15 | loss: 0.3405167
	speed: 0.0367s/iter; left time: 490.4182s
	iters: 300, epoch: 15 | loss: 0.5063162
	speed: 0.0365s/iter; left time: 485.1315s
	iters: 400, epoch: 15 | loss: 0.4560124
	speed: 0.0419s/iter; left time: 552.2159s
	iters: 500, epoch: 15 | loss: 0.3650703
	speed: 0.0376s/iter; left time: 492.0812s
	iters: 600, epoch: 15 | loss: 0.4300546
	speed: 0.0369s/iter; left time: 478.8483s
	iters: 700, epoch: 15 | loss: 0.9264114
	speed: 0.0358s/iter; left time: 461.4087s
	iters: 800, epoch: 15 | loss: 0.6170718
	speed: 0.0352s/iter; left time: 450.0963s
	iters: 900, epoch: 15 | loss: 0.3850702
	speed: 0.0351s/iter; left time: 445.6412s
	iters: 1000, epoch: 15 | loss: 0.3892847
	speed: 0.0353s/iter; left time: 443.9258s
	iters: 1100, epoch: 15 | loss: 0.2900240
	speed: 0.0348s/iter; left time: 434.8227s
	iters: 1200, epoch: 15 | loss: 0.9260517
	speed: 0.0371s/iter; left time: 458.9461s
	iters: 1300, epoch: 15 | loss: 0.3431688
	speed: 0.0359s/iter; left time: 440.4210s
	iters: 1400, epoch: 15 | loss: 0.9442728
	speed: 0.0337s/iter; left time: 410.0648s
	iters: 1500, epoch: 15 | loss: 0.4414648
	speed: 0.0341s/iter; left time: 411.6498s
	iters: 1600, epoch: 15 | loss: 0.4478156
	speed: 0.0355s/iter; left time: 424.6661s
	iters: 1700, epoch: 15 | loss: 0.8521819
	speed: 0.0353s/iter; left time: 418.9153s
	iters: 1800, epoch: 15 | loss: 0.3713240
	speed: 0.0348s/iter; left time: 409.8858s
	iters: 1900, epoch: 15 | loss: 0.4730593
	speed: 0.0349s/iter; left time: 407.6343s
	iters: 2000, epoch: 15 | loss: 0.9096800
	speed: 0.0348s/iter; left time: 402.3791s
	iters: 2100, epoch: 15 | loss: 0.2789716
	speed: 0.0352s/iter; left time: 403.6940s
	iters: 2200, epoch: 15 | loss: 0.9612924
	speed: 0.0344s/iter; left time: 391.7491s
Epoch: 15 cost time: 80.7616446018219
Epoch: 15, Steps: 2263 | Train Loss: 0.4929389 Vali Loss: 0.4935026 Test Loss: 0.2401455
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : weather_336_336_DLinear_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3144<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10204
mse:0.24120473861694336, mae:0.29996511340141296
