Args in experiment:
Namespace(activation='gelu', batch_size=8, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='exchange_rate.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=8, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='mse', lradj='type1', model='NLinear', model_id='Exchange_336_192', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=192, root_path='./dataset/', save_pred_values=False, seed=10458, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : Exchange_336_192_NLinear_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed10458>>>>>>>>>>>>>>>>>>>>>>>>>>
train 4784
val 569
test 1326
	iters: 100, epoch: 1 | loss: 0.1273807
	speed: 0.0044s/iter; left time: 51.7375s
	iters: 200, epoch: 1 | loss: 0.2312056
	speed: 0.0036s/iter; left time: 42.4577s
	iters: 300, epoch: 1 | loss: 0.2033664
	speed: 0.0040s/iter; left time: 47.2172s
	iters: 400, epoch: 1 | loss: 0.2257682
	speed: 0.0041s/iter; left time: 46.8389s
	iters: 500, epoch: 1 | loss: 0.3128275
	speed: 0.0045s/iter; left time: 51.9184s
Epoch: 1 cost time: 2.4936962127685547
Epoch: 1, Steps: 598 | Train Loss: 0.2462020 Vali Loss: 0.2512940 Test Loss: 0.1951216
Validation loss decreased (inf --> 0.251294).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2615772
	speed: 0.0093s/iter; left time: 104.3510s
	iters: 200, epoch: 2 | loss: 0.1496807
	speed: 0.0040s/iter; left time: 44.5692s
	iters: 300, epoch: 2 | loss: 0.2705211
	speed: 0.0041s/iter; left time: 45.3583s
	iters: 400, epoch: 2 | loss: 0.3049641
	speed: 0.0040s/iter; left time: 43.7492s
	iters: 500, epoch: 2 | loss: 0.1881236
	speed: 0.0038s/iter; left time: 41.3103s
Epoch: 2 cost time: 2.3106038570404053
Epoch: 2, Steps: 598 | Train Loss: 0.2401516 Vali Loss: 0.2627878 Test Loss: 0.2003982
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.2010953
	speed: 0.0099s/iter; left time: 105.9418s
	iters: 200, epoch: 3 | loss: 0.2225325
	speed: 0.0038s/iter; left time: 40.5696s
	iters: 300, epoch: 3 | loss: 0.2599127
	speed: 0.0040s/iter; left time: 41.6507s
	iters: 400, epoch: 3 | loss: 0.4193606
	speed: 0.0040s/iter; left time: 41.7760s
	iters: 500, epoch: 3 | loss: 0.1418982
	speed: 0.0041s/iter; left time: 42.1892s
Epoch: 3 cost time: 2.426649570465088
Epoch: 3, Steps: 598 | Train Loss: 0.2346728 Vali Loss: 0.2481889 Test Loss: 0.1941354
Validation loss decreased (0.251294 --> 0.248189).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1893269
	speed: 0.0096s/iter; left time: 96.4709s
	iters: 200, epoch: 4 | loss: 0.1969172
	speed: 0.0040s/iter; left time: 40.1060s
	iters: 300, epoch: 4 | loss: 0.1184337
	speed: 0.0045s/iter; left time: 44.1149s
	iters: 400, epoch: 4 | loss: 0.1392854
	speed: 0.0039s/iter; left time: 38.4660s
	iters: 500, epoch: 4 | loss: 0.4419482
	speed: 0.0037s/iter; left time: 35.6910s
Epoch: 4 cost time: 2.299569845199585
Epoch: 4, Steps: 598 | Train Loss: 0.2319068 Vali Loss: 0.2481795 Test Loss: 0.1982889
Validation loss decreased (0.248189 --> 0.248179).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1664633
	speed: 0.0095s/iter; left time: 90.0851s
	iters: 200, epoch: 5 | loss: 0.2854541
	speed: 0.0043s/iter; left time: 39.8238s
	iters: 300, epoch: 5 | loss: 0.1727185
	speed: 0.0038s/iter; left time: 34.8822s
	iters: 400, epoch: 5 | loss: 0.1585343
	speed: 0.0038s/iter; left time: 34.5656s
	iters: 500, epoch: 5 | loss: 0.1564489
	speed: 0.0038s/iter; left time: 34.3715s
Epoch: 5 cost time: 2.3059873580932617
Epoch: 5, Steps: 598 | Train Loss: 0.2309316 Vali Loss: 0.2476046 Test Loss: 0.1965861
Validation loss decreased (0.248179 --> 0.247605).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.2019825
	speed: 0.0089s/iter; left time: 79.3283s
	iters: 200, epoch: 6 | loss: 0.2068059
	speed: 0.0038s/iter; left time: 33.4398s
	iters: 300, epoch: 6 | loss: 0.2148363
	speed: 0.0041s/iter; left time: 35.2404s
	iters: 400, epoch: 6 | loss: 0.2447088
	speed: 0.0037s/iter; left time: 31.8159s
	iters: 500, epoch: 6 | loss: 0.4235605
	speed: 0.0032s/iter; left time: 26.9580s
Epoch: 6 cost time: 2.219175100326538
Epoch: 6, Steps: 598 | Train Loss: 0.2302624 Vali Loss: 0.2450157 Test Loss: 0.1965524
Validation loss decreased (0.247605 --> 0.245016).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1763136
	speed: 0.0100s/iter; left time: 82.5032s
	iters: 200, epoch: 7 | loss: 0.6065418
	speed: 0.0040s/iter; left time: 33.0191s
	iters: 300, epoch: 7 | loss: 0.1996918
	speed: 0.0043s/iter; left time: 34.3400s
	iters: 400, epoch: 7 | loss: 0.2829810
	speed: 0.0043s/iter; left time: 34.6802s
	iters: 500, epoch: 7 | loss: 0.2301794
	speed: 0.0040s/iter; left time: 31.6493s
Epoch: 7 cost time: 2.471813440322876
Epoch: 7, Steps: 598 | Train Loss: 0.2297618 Vali Loss: 0.2451307 Test Loss: 0.1953817
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.2521559
	speed: 0.0102s/iter; left time: 78.1523s
	iters: 200, epoch: 8 | loss: 0.1965582
	speed: 0.0042s/iter; left time: 31.6789s
	iters: 300, epoch: 8 | loss: 0.1673633
	speed: 0.0040s/iter; left time: 29.9044s
	iters: 400, epoch: 8 | loss: 0.3952532
	speed: 0.0037s/iter; left time: 27.4522s
	iters: 500, epoch: 8 | loss: 0.2050701
	speed: 0.0039s/iter; left time: 28.5180s
Epoch: 8 cost time: 2.425555944442749
Epoch: 8, Steps: 598 | Train Loss: 0.2296342 Vali Loss: 0.2447226 Test Loss: 0.1957366
Validation loss decreased (0.245016 --> 0.244723).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.1722205
	speed: 0.0106s/iter; left time: 74.9762s
	iters: 200, epoch: 9 | loss: 0.7051466
	speed: 0.0042s/iter; left time: 29.2335s
	iters: 300, epoch: 9 | loss: 0.2219126
	speed: 0.0046s/iter; left time: 31.8553s
	iters: 400, epoch: 9 | loss: 0.3654301
	speed: 0.0046s/iter; left time: 31.1065s
	iters: 500, epoch: 9 | loss: 0.1785396
	speed: 0.0045s/iter; left time: 30.2659s
Epoch: 9 cost time: 2.5814058780670166
Epoch: 9, Steps: 598 | Train Loss: 0.2294995 Vali Loss: 0.2451949 Test Loss: 0.1954609
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.1213435
	speed: 0.0092s/iter; left time: 59.6157s
	iters: 200, epoch: 10 | loss: 0.1301528
	speed: 0.0036s/iter; left time: 22.9006s
	iters: 300, epoch: 10 | loss: 0.1556253
	speed: 0.0035s/iter; left time: 22.0431s
	iters: 400, epoch: 10 | loss: 0.2110893
	speed: 0.0038s/iter; left time: 23.3158s
	iters: 500, epoch: 10 | loss: 0.1786518
	speed: 0.0037s/iter; left time: 22.7962s
Epoch: 10 cost time: 2.2018816471099854
Epoch: 10, Steps: 598 | Train Loss: 0.2294447 Vali Loss: 0.2447722 Test Loss: 0.1954692
EarlyStopping counter: 2 out of 5
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 11 | loss: 0.2448480
	speed: 0.0110s/iter; left time: 64.5921s
	iters: 200, epoch: 11 | loss: 0.1363533
	speed: 0.0045s/iter; left time: 25.7317s
	iters: 300, epoch: 11 | loss: 0.2078561
	speed: 0.0046s/iter; left time: 26.0190s
	iters: 400, epoch: 11 | loss: 0.4417870
	speed: 0.0046s/iter; left time: 25.4646s
	iters: 500, epoch: 11 | loss: 0.2105883
	speed: 0.0042s/iter; left time: 23.1845s
Epoch: 11 cost time: 2.648609161376953
Epoch: 11, Steps: 598 | Train Loss: 0.2294118 Vali Loss: 0.2447072 Test Loss: 0.1954726
Validation loss decreased (0.244723 --> 0.244707).  Saving model ...
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 12 | loss: 0.1509946
	speed: 0.0105s/iter; left time: 55.4339s
	iters: 200, epoch: 12 | loss: 0.1086393
	speed: 0.0038s/iter; left time: 19.6559s
	iters: 300, epoch: 12 | loss: 0.1662706
	speed: 0.0037s/iter; left time: 19.0136s
	iters: 400, epoch: 12 | loss: 0.2154398
	speed: 0.0043s/iter; left time: 21.1778s
	iters: 500, epoch: 12 | loss: 0.1476780
	speed: 0.0038s/iter; left time: 18.3708s
Epoch: 12 cost time: 2.338520050048828
Epoch: 12, Steps: 598 | Train Loss: 0.2293929 Vali Loss: 0.2449080 Test Loss: 0.1954536
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.44140625e-07
	iters: 100, epoch: 13 | loss: 0.3131652
	speed: 0.0097s/iter; left time: 45.5009s
	iters: 200, epoch: 13 | loss: 0.1440548
	speed: 0.0037s/iter; left time: 17.0565s
	iters: 300, epoch: 13 | loss: 0.1264965
	speed: 0.0036s/iter; left time: 16.0114s
	iters: 400, epoch: 13 | loss: 0.1650995
	speed: 0.0039s/iter; left time: 17.2858s
	iters: 500, epoch: 13 | loss: 0.4286697
	speed: 0.0039s/iter; left time: 16.5830s
Epoch: 13 cost time: 2.261626720428467
Epoch: 13, Steps: 598 | Train Loss: 0.2293842 Vali Loss: 0.2449320 Test Loss: 0.1954463
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.220703125e-07
	iters: 100, epoch: 14 | loss: 0.1676802
	speed: 0.0092s/iter; left time: 37.7655s
	iters: 200, epoch: 14 | loss: 0.1681103
	speed: 0.0033s/iter; left time: 12.9976s
	iters: 300, epoch: 14 | loss: 0.1469538
	speed: 0.0033s/iter; left time: 12.9161s
	iters: 400, epoch: 14 | loss: 0.2736535
	speed: 0.0033s/iter; left time: 12.5728s
	iters: 500, epoch: 14 | loss: 0.2573550
	speed: 0.0034s/iter; left time: 12.4081s
Epoch: 14 cost time: 1.9608221054077148
Epoch: 14, Steps: 598 | Train Loss: 0.2293800 Vali Loss: 0.2449674 Test Loss: 0.1954510
EarlyStopping counter: 3 out of 5
Updating learning rate to 6.103515625e-08
	iters: 100, epoch: 15 | loss: 0.1883105
	speed: 0.0071s/iter; left time: 24.8123s
	iters: 200, epoch: 15 | loss: 0.1639006
	speed: 0.0027s/iter; left time: 9.1503s
	iters: 300, epoch: 15 | loss: 0.1935224
	speed: 0.0031s/iter; left time: 10.2700s
	iters: 400, epoch: 15 | loss: 0.3122192
	speed: 0.0032s/iter; left time: 10.1091s
	iters: 500, epoch: 15 | loss: 0.1823813
	speed: 0.0035s/iter; left time: 10.7806s
Epoch: 15 cost time: 1.8504719734191895
Epoch: 15, Steps: 598 | Train Loss: 0.2293775 Vali Loss: 0.2449639 Test Loss: 0.1954493
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.0517578125e-08
	iters: 100, epoch: 16 | loss: 0.2737628
	speed: 0.0084s/iter; left time: 24.4076s
	iters: 200, epoch: 16 | loss: 0.2666233
	speed: 0.0034s/iter; left time: 9.4423s
	iters: 300, epoch: 16 | loss: 0.1805266
	speed: 0.0035s/iter; left time: 9.2856s
	iters: 400, epoch: 16 | loss: 0.1817153
	speed: 0.0034s/iter; left time: 8.8871s
	iters: 500, epoch: 16 | loss: 0.3396785
	speed: 0.0032s/iter; left time: 8.0793s
Epoch: 16 cost time: 1.970754623413086
Epoch: 16, Steps: 598 | Train Loss: 0.2293764 Vali Loss: 0.2446586 Test Loss: 0.1954495
Validation loss decreased (0.244707 --> 0.244659).  Saving model ...
Updating learning rate to 1.52587890625e-08
	iters: 100, epoch: 17 | loss: 0.2248998
	speed: 0.0070s/iter; left time: 16.0969s
	iters: 200, epoch: 17 | loss: 0.2380131
	speed: 0.0023s/iter; left time: 5.0259s
	iters: 300, epoch: 17 | loss: 0.2116513
	speed: 0.0024s/iter; left time: 5.0023s
	iters: 400, epoch: 17 | loss: 0.1526864
	speed: 0.0023s/iter; left time: 4.5254s
	iters: 500, epoch: 17 | loss: 0.1709200
	speed: 0.0022s/iter; left time: 4.2025s
Epoch: 17 cost time: 1.385249137878418
Epoch: 17, Steps: 598 | Train Loss: 0.2293758 Vali Loss: 0.2448884 Test Loss: 0.1954486
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.62939453125e-09
	iters: 100, epoch: 18 | loss: 0.1673717
	speed: 0.0056s/iter; left time: 9.4431s
	iters: 200, epoch: 18 | loss: 0.3347665
	speed: 0.0022s/iter; left time: 3.5728s
	iters: 300, epoch: 18 | loss: 0.4062110
	speed: 0.0022s/iter; left time: 3.3189s
	iters: 400, epoch: 18 | loss: 0.4064094
	speed: 0.0022s/iter; left time: 3.1109s
	iters: 500, epoch: 18 | loss: 0.1665192
	speed: 0.0022s/iter; left time: 2.8899s
Epoch: 18 cost time: 1.3321099281311035
Epoch: 18, Steps: 598 | Train Loss: 0.2293755 Vali Loss: 0.2448574 Test Loss: 0.1954489
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.814697265625e-09
	iters: 100, epoch: 19 | loss: 0.2442740
	speed: 0.0056s/iter; left time: 6.1103s
	iters: 200, epoch: 19 | loss: 0.1286310
	speed: 0.0022s/iter; left time: 2.2034s
	iters: 300, epoch: 19 | loss: 0.1483493
	speed: 0.0022s/iter; left time: 2.0113s
	iters: 400, epoch: 19 | loss: 0.3291321
	speed: 0.0022s/iter; left time: 1.7693s
	iters: 500, epoch: 19 | loss: 0.2876612
	speed: 0.0022s/iter; left time: 1.5543s
Epoch: 19 cost time: 1.331221342086792
Epoch: 19, Steps: 598 | Train Loss: 0.2293753 Vali Loss: 0.2446800 Test Loss: 0.1954492
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.9073486328125e-09
	iters: 100, epoch: 20 | loss: 0.2140230
	speed: 0.0056s/iter; left time: 2.7802s
	iters: 200, epoch: 20 | loss: 0.4071805
	speed: 0.0023s/iter; left time: 0.9019s
	iters: 300, epoch: 20 | loss: 0.6068263
	speed: 0.0022s/iter; left time: 0.6668s
	iters: 400, epoch: 20 | loss: 0.2008775
	speed: 0.0022s/iter; left time: 0.4398s
	iters: 500, epoch: 20 | loss: 0.2012018
	speed: 0.0022s/iter; left time: 0.2219s
Epoch: 20 cost time: 1.3363571166992188
Epoch: 20, Steps: 598 | Train Loss: 0.2293752 Vali Loss: 0.2444815 Test Loss: 0.1954492
Validation loss decreased (0.244659 --> 0.244482).  Saving model ...
Updating learning rate to 9.5367431640625e-10
>>>>>>>testing : Exchange_336_192_NLinear_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed10458<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 1326
mse:0.1954105645418167, mae:0.31017714738845825
