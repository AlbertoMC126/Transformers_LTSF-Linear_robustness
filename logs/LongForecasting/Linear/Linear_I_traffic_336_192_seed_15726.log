Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='Linear', model_id='traffic_336_192', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=192, root_path='./dataset/', save_pred_values=False, seed=15726, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_336_192_Linear_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15726>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11753
val 1565
test 3317
	iters: 100, epoch: 1 | loss: 0.4699651
	speed: 0.3170s/iter; left time: 4621.9063s
	iters: 200, epoch: 1 | loss: 0.4564098
	speed: 0.3010s/iter; left time: 4358.1677s
	iters: 300, epoch: 1 | loss: 0.4838728
	speed: 0.3023s/iter; left time: 4347.8997s
	iters: 400, epoch: 1 | loss: 0.4686701
	speed: 0.3007s/iter; left time: 4294.3142s
	iters: 500, epoch: 1 | loss: 0.4524079
	speed: 0.3015s/iter; left time: 4276.2514s
	iters: 600, epoch: 1 | loss: 0.4645049
	speed: 0.3030s/iter; left time: 4266.8417s
	iters: 700, epoch: 1 | loss: 0.4466657
	speed: 0.3032s/iter; left time: 4238.5051s
Epoch: 1 cost time: 223.2856547832489
Epoch: 1, Steps: 734 | Train Loss: 0.4810557 Vali Loss: 0.6263461 Test Loss: 0.7483183
Validation loss decreased (inf --> 0.626346).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.4796236
	speed: 0.6061s/iter; left time: 8392.0001s
	iters: 200, epoch: 2 | loss: 0.4542864
	speed: 0.3030s/iter; left time: 4165.4561s
	iters: 300, epoch: 2 | loss: 0.4898247
	speed: 0.3025s/iter; left time: 4128.6771s
	iters: 400, epoch: 2 | loss: 0.4811414
	speed: 0.3029s/iter; left time: 4103.3503s
	iters: 500, epoch: 2 | loss: 0.4910178
	speed: 0.3029s/iter; left time: 4073.5355s
	iters: 600, epoch: 2 | loss: 0.4516775
	speed: 0.2999s/iter; left time: 4002.2139s
	iters: 700, epoch: 2 | loss: 0.4855517
	speed: 0.3004s/iter; left time: 3978.7576s
Epoch: 2 cost time: 221.62870979309082
Epoch: 2, Steps: 734 | Train Loss: 0.4735126 Vali Loss: 0.6310142 Test Loss: 0.7524061
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.3417248
	speed: 0.6026s/iter; left time: 7901.8935s
	iters: 200, epoch: 3 | loss: 0.3124220
	speed: 0.2996s/iter; left time: 3898.7511s
	iters: 300, epoch: 3 | loss: 0.3355348
	speed: 0.3006s/iter; left time: 3881.6899s
	iters: 400, epoch: 3 | loss: 0.3159548
	speed: 0.3033s/iter; left time: 3885.6568s
	iters: 500, epoch: 3 | loss: 0.3331619
	speed: 0.3028s/iter; left time: 3849.1520s
	iters: 600, epoch: 3 | loss: 0.2933030
	speed: 0.3022s/iter; left time: 3811.3664s
	iters: 700, epoch: 3 | loss: 0.3331874
	speed: 0.3020s/iter; left time: 3778.3652s
Epoch: 3 cost time: 221.34029603004456
Epoch: 3, Steps: 734 | Train Loss: 0.3307657 Vali Loss: 0.4574763 Test Loss: 0.5579353
Validation loss decreased (0.626346 --> 0.457476).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.2897345
	speed: 0.6069s/iter; left time: 7512.5534s
	iters: 200, epoch: 4 | loss: 0.2742356
	speed: 0.3013s/iter; left time: 3699.9814s
	iters: 300, epoch: 4 | loss: 0.3015684
	speed: 0.3019s/iter; left time: 3676.9083s
	iters: 400, epoch: 4 | loss: 0.2683643
	speed: 0.3021s/iter; left time: 3649.0674s
	iters: 500, epoch: 4 | loss: 0.2849737
	speed: 0.3012s/iter; left time: 3608.2791s
	iters: 600, epoch: 4 | loss: 0.2680290
	speed: 0.3023s/iter; left time: 3590.7820s
	iters: 700, epoch: 4 | loss: 0.3019332
	speed: 0.3032s/iter; left time: 3571.6646s
Epoch: 4 cost time: 221.5549120903015
Epoch: 4, Steps: 734 | Train Loss: 0.2823787 Vali Loss: 0.4009445 Test Loss: 0.4915113
Validation loss decreased (0.457476 --> 0.400945).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.2432594
	speed: 0.6082s/iter; left time: 7082.2332s
	iters: 200, epoch: 5 | loss: 0.2563082
	speed: 0.2998s/iter; left time: 3460.7494s
	iters: 300, epoch: 5 | loss: 0.2431622
	speed: 0.3005s/iter; left time: 3439.0141s
	iters: 400, epoch: 5 | loss: 0.2605365
	speed: 0.3025s/iter; left time: 3432.1753s
	iters: 500, epoch: 5 | loss: 0.2591653
	speed: 0.3005s/iter; left time: 3379.3927s
	iters: 600, epoch: 5 | loss: 0.2530248
	speed: 0.2999s/iter; left time: 3342.5479s
	iters: 700, epoch: 5 | loss: 0.2695478
	speed: 0.3020s/iter; left time: 3335.0534s
Epoch: 5 cost time: 220.88956761360168
Epoch: 5, Steps: 734 | Train Loss: 0.2614491 Vali Loss: 0.3775358 Test Loss: 0.4649698
Validation loss decreased (0.400945 --> 0.377536).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.2672291
	speed: 0.6079s/iter; left time: 6633.2962s
	iters: 200, epoch: 6 | loss: 0.2353826
	speed: 0.3021s/iter; left time: 3266.4726s
	iters: 300, epoch: 6 | loss: 0.2460506
	speed: 0.3040s/iter; left time: 3255.9658s
	iters: 400, epoch: 6 | loss: 0.2599577
	speed: 0.3021s/iter; left time: 3205.7289s
	iters: 500, epoch: 6 | loss: 0.2148402
	speed: 0.3017s/iter; left time: 3171.4969s
	iters: 600, epoch: 6 | loss: 0.2606325
	speed: 0.3007s/iter; left time: 3131.0730s
	iters: 700, epoch: 6 | loss: 0.2757623
	speed: 0.3019s/iter; left time: 3112.4358s
Epoch: 6 cost time: 221.77821373939514
Epoch: 6, Steps: 734 | Train Loss: 0.2505547 Vali Loss: 0.3661685 Test Loss: 0.4519004
Validation loss decreased (0.377536 --> 0.366168).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.2587022
	speed: 0.6099s/iter; left time: 6207.1669s
	iters: 200, epoch: 7 | loss: 0.2433296
	speed: 0.3029s/iter; left time: 3052.2360s
	iters: 300, epoch: 7 | loss: 0.2224177
	speed: 0.3018s/iter; left time: 3010.9751s
	iters: 400, epoch: 7 | loss: 0.2458556
	speed: 0.3021s/iter; left time: 2983.9582s
	iters: 500, epoch: 7 | loss: 0.2607104
	speed: 0.3013s/iter; left time: 2945.4108s
	iters: 600, epoch: 7 | loss: 0.2507133
	speed: 0.3005s/iter; left time: 2908.1381s
	iters: 700, epoch: 7 | loss: 0.2379006
	speed: 0.3014s/iter; left time: 2886.4451s
Epoch: 7 cost time: 221.4257640838623
Epoch: 7, Steps: 734 | Train Loss: 0.2446593 Vali Loss: 0.3606279 Test Loss: 0.4451822
Validation loss decreased (0.366168 --> 0.360628).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.2388156
	speed: 0.6094s/iter; left time: 5755.0080s
	iters: 200, epoch: 8 | loss: 0.2319169
	speed: 0.3030s/iter; left time: 2831.0151s
	iters: 300, epoch: 8 | loss: 0.2624864
	speed: 0.3026s/iter; left time: 2797.3169s
	iters: 400, epoch: 8 | loss: 0.2449477
	speed: 0.3021s/iter; left time: 2762.4722s
	iters: 500, epoch: 8 | loss: 0.2315814
	speed: 0.3018s/iter; left time: 2728.7505s
	iters: 600, epoch: 8 | loss: 0.2430975
	speed: 0.3024s/iter; left time: 2704.0993s
	iters: 700, epoch: 8 | loss: 0.2543423
	speed: 0.3030s/iter; left time: 2679.0578s
Epoch: 8 cost time: 222.05368995666504
Epoch: 8, Steps: 734 | Train Loss: 0.2413728 Vali Loss: 0.3576827 Test Loss: 0.4416474
Validation loss decreased (0.360628 --> 0.357683).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.2211774
	speed: 0.6132s/iter; left time: 5339.9947s
	iters: 200, epoch: 9 | loss: 0.2137005
	speed: 0.3020s/iter; left time: 2599.7739s
	iters: 300, epoch: 9 | loss: 0.2472194
	speed: 0.3024s/iter; left time: 2572.7798s
	iters: 400, epoch: 9 | loss: 0.2501157
	speed: 0.3028s/iter; left time: 2546.0627s
	iters: 500, epoch: 9 | loss: 0.2634256
	speed: 0.3038s/iter; left time: 2523.9159s
	iters: 600, epoch: 9 | loss: 0.2506129
	speed: 0.3027s/iter; left time: 2484.9141s
	iters: 700, epoch: 9 | loss: 0.2573438
	speed: 0.3032s/iter; left time: 2458.8098s
Epoch: 9 cost time: 222.41897797584534
Epoch: 9, Steps: 734 | Train Loss: 0.2395945 Vali Loss: 0.3561858 Test Loss: 0.4401692
Validation loss decreased (0.357683 --> 0.356186).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.2200857
	speed: 0.6122s/iter; left time: 4881.9192s
	iters: 200, epoch: 10 | loss: 0.2274760
	speed: 0.3033s/iter; left time: 2388.1936s
	iters: 300, epoch: 10 | loss: 0.2218897
	speed: 0.3032s/iter; left time: 2357.4823s
	iters: 400, epoch: 10 | loss: 0.2257674
	speed: 0.3034s/iter; left time: 2328.7071s
	iters: 500, epoch: 10 | loss: 0.2184018
	speed: 0.3030s/iter; left time: 2295.3375s
	iters: 600, epoch: 10 | loss: 0.2130925
	speed: 0.3033s/iter; left time: 2267.3539s
	iters: 700, epoch: 10 | loss: 0.2365725
	speed: 0.3029s/iter; left time: 2234.0700s
Epoch: 10 cost time: 222.6337170600891
Epoch: 10, Steps: 734 | Train Loss: 0.2386049 Vali Loss: 0.3558885 Test Loss: 0.4395063
Validation loss decreased (0.356186 --> 0.355888).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.2273971
	speed: 0.6118s/iter; left time: 4430.1693s
	iters: 200, epoch: 11 | loss: 0.2482139
	speed: 0.3028s/iter; left time: 2162.3620s
	iters: 300, epoch: 11 | loss: 0.2299242
	speed: 0.3018s/iter; left time: 2125.2294s
	iters: 400, epoch: 11 | loss: 0.2203132
	speed: 0.3023s/iter; left time: 2098.5265s
	iters: 500, epoch: 11 | loss: 0.2401626
	speed: 0.3030s/iter; left time: 2072.8508s
	iters: 600, epoch: 11 | loss: 0.2168774
	speed: 0.3022s/iter; left time: 2037.1625s
	iters: 700, epoch: 11 | loss: 0.2195377
	speed: 0.3022s/iter; left time: 2007.1268s
Epoch: 11 cost time: 221.9099440574646
Epoch: 11, Steps: 734 | Train Loss: 0.2380652 Vali Loss: 0.3554352 Test Loss: 0.4391446
Validation loss decreased (0.355888 --> 0.355435).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.2385375
	speed: 0.6096s/iter; left time: 3966.5217s
	iters: 200, epoch: 12 | loss: 0.2294995
	speed: 0.3039s/iter; left time: 1946.7707s
	iters: 300, epoch: 12 | loss: 0.2562504
	speed: 0.3036s/iter; left time: 1915.0777s
	iters: 400, epoch: 12 | loss: 0.2326166
	speed: 0.3042s/iter; left time: 1888.3034s
	iters: 500, epoch: 12 | loss: 0.2568806
	speed: 0.3047s/iter; left time: 1860.6806s
	iters: 600, epoch: 12 | loss: 0.2337250
	speed: 0.3039s/iter; left time: 1825.5119s
	iters: 700, epoch: 12 | loss: 0.2668532
	speed: 0.3026s/iter; left time: 1787.3992s
Epoch: 12 cost time: 222.92912769317627
Epoch: 12, Steps: 734 | Train Loss: 0.2377863 Vali Loss: 0.3551019 Test Loss: 0.4390193
Validation loss decreased (0.355435 --> 0.355102).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.2542226
	speed: 0.6104s/iter; left time: 3523.6635s
	iters: 200, epoch: 13 | loss: 0.2371678
	speed: 0.3034s/iter; left time: 1720.9736s
	iters: 300, epoch: 13 | loss: 0.2278708
	speed: 0.3036s/iter; left time: 1692.2146s
	iters: 400, epoch: 13 | loss: 0.2513513
	speed: 0.3051s/iter; left time: 1669.8829s
	iters: 500, epoch: 13 | loss: 0.2278546
	speed: 0.3044s/iter; left time: 1635.2820s
	iters: 600, epoch: 13 | loss: 0.2119686
	speed: 0.3026s/iter; left time: 1595.5064s
	iters: 700, epoch: 13 | loss: 0.2507282
	speed: 0.3032s/iter; left time: 1568.3530s
Epoch: 13 cost time: 222.78274536132812
Epoch: 13, Steps: 734 | Train Loss: 0.2376425 Vali Loss: 0.3551642 Test Loss: 0.4389558
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 14 | loss: 0.2233948
	speed: 0.6073s/iter; left time: 3060.0642s
	iters: 200, epoch: 14 | loss: 0.2236284
	speed: 0.3030s/iter; left time: 1496.3484s
	iters: 300, epoch: 14 | loss: 0.2300900
	speed: 0.3029s/iter; left time: 1465.7624s
	iters: 400, epoch: 14 | loss: 0.2413029
	speed: 0.3038s/iter; left time: 1439.8667s
	iters: 500, epoch: 14 | loss: 0.2789364
	speed: 0.3041s/iter; left time: 1410.7377s
	iters: 600, epoch: 14 | loss: 0.2340654
	speed: 0.3039s/iter; left time: 1379.3529s
	iters: 700, epoch: 14 | loss: 0.2270650
	speed: 0.3041s/iter; left time: 1350.0315s
Epoch: 14 cost time: 222.75604796409607
Epoch: 14, Steps: 734 | Train Loss: 0.2375805 Vali Loss: 0.3550014 Test Loss: 0.4389436
Validation loss decreased (0.355102 --> 0.355001).  Saving model ...
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 15 | loss: 0.2781111
	speed: 0.6122s/iter; left time: 2635.3386s
	iters: 200, epoch: 15 | loss: 0.2361590
	speed: 0.3022s/iter; left time: 1270.8915s
	iters: 300, epoch: 15 | loss: 0.2471544
	speed: 0.3007s/iter; left time: 1234.3875s
	iters: 400, epoch: 15 | loss: 0.2162577
	speed: 0.3024s/iter; left time: 1211.2830s
	iters: 500, epoch: 15 | loss: 0.2448780
	speed: 0.3019s/iter; left time: 1179.1015s
	iters: 600, epoch: 15 | loss: 0.2302555
	speed: 0.3036s/iter; left time: 1155.3767s
	iters: 700, epoch: 15 | loss: 0.2372804
	speed: 0.3021s/iter; left time: 1119.1467s
Epoch: 15 cost time: 221.92908477783203
Epoch: 15, Steps: 734 | Train Loss: 0.2374851 Vali Loss: 0.3551445 Test Loss: 0.4389398
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 16 | loss: 0.2728599
	speed: 0.6075s/iter; left time: 2169.2041s
	iters: 200, epoch: 16 | loss: 0.2170916
	speed: 0.3010s/iter; left time: 1044.9159s
	iters: 300, epoch: 16 | loss: 0.2384223
	speed: 0.3030s/iter; left time: 1021.2698s
	iters: 400, epoch: 16 | loss: 0.2437128
	speed: 0.3023s/iter; left time: 988.6755s
	iters: 500, epoch: 16 | loss: 0.2522454
	speed: 0.3018s/iter; left time: 956.9639s
	iters: 600, epoch: 16 | loss: 0.2339448
	speed: 0.3028s/iter; left time: 929.8967s
	iters: 700, epoch: 16 | loss: 0.2019187
	speed: 0.3036s/iter; left time: 901.8548s
Epoch: 16 cost time: 221.93914580345154
Epoch: 16, Steps: 734 | Train Loss: 0.2374965 Vali Loss: 0.3551664 Test Loss: 0.4389381
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 17 | loss: 0.2522930
	speed: 0.6122s/iter; left time: 1736.6836s
	iters: 200, epoch: 17 | loss: 0.2424066
	speed: 0.3035s/iter; left time: 830.5602s
	iters: 300, epoch: 17 | loss: 0.2347199
	speed: 0.3038s/iter; left time: 801.0589s
	iters: 400, epoch: 17 | loss: 0.2459742
	speed: 0.3015s/iter; left time: 764.8261s
	iters: 500, epoch: 17 | loss: 0.2403077
	speed: 0.3026s/iter; left time: 737.4407s
	iters: 600, epoch: 17 | loss: 0.2273295
	speed: 0.3024s/iter; left time: 706.7703s
	iters: 700, epoch: 17 | loss: 0.2143396
	speed: 0.3028s/iter; left time: 677.3516s
Epoch: 17 cost time: 222.48090291023254
Epoch: 17, Steps: 734 | Train Loss: 0.2374834 Vali Loss: 0.3551226 Test Loss: 0.4389377
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 18 | loss: 0.2790953
	speed: 0.6080s/iter; left time: 1278.6480s
	iters: 200, epoch: 18 | loss: 0.2587052
	speed: 0.3032s/iter; left time: 607.3488s
	iters: 300, epoch: 18 | loss: 0.2120717
	speed: 0.3026s/iter; left time: 575.8271s
	iters: 400, epoch: 18 | loss: 0.2368033
	speed: 0.3033s/iter; left time: 546.8254s
	iters: 500, epoch: 18 | loss: 0.2321696
	speed: 0.3032s/iter; left time: 516.2753s
	iters: 600, epoch: 18 | loss: 0.2319482
	speed: 0.3039s/iter; left time: 487.1294s
	iters: 700, epoch: 18 | loss: 0.2460001
	speed: 0.3044s/iter; left time: 457.5092s
Epoch: 18 cost time: 222.79291462898254
Epoch: 18, Steps: 734 | Train Loss: 0.2374927 Vali Loss: 0.3546229 Test Loss: 0.4389371
Validation loss decreased (0.355001 --> 0.354623).  Saving model ...
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 19 | loss: 0.2356627
	speed: 0.6124s/iter; left time: 838.4229s
	iters: 200, epoch: 19 | loss: 0.2448854
	speed: 0.3042s/iter; left time: 386.0588s
	iters: 300, epoch: 19 | loss: 0.2020129
	speed: 0.3030s/iter; left time: 354.1932s
	iters: 400, epoch: 19 | loss: 0.2269236
	speed: 0.3030s/iter; left time: 323.9353s
	iters: 500, epoch: 19 | loss: 0.2260375
	speed: 0.3037s/iter; left time: 294.3023s
	iters: 600, epoch: 19 | loss: 0.2297081
	speed: 0.3036s/iter; left time: 263.8137s
	iters: 700, epoch: 19 | loss: 0.2106560
	speed: 0.3041s/iter; left time: 233.8313s
Epoch: 19 cost time: 223.0265543460846
Epoch: 19, Steps: 734 | Train Loss: 0.2374619 Vali Loss: 0.3552735 Test Loss: 0.4389371
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 20 | loss: 0.2613484
	speed: 0.6057s/iter; left time: 384.6435s
	iters: 200, epoch: 20 | loss: 0.2604666
	speed: 0.3017s/iter; left time: 161.4233s
	iters: 300, epoch: 20 | loss: 0.2138256
	speed: 0.3002s/iter; left time: 130.5740s
	iters: 400, epoch: 20 | loss: 0.2134099
	speed: 0.3005s/iter; left time: 100.6587s
	iters: 500, epoch: 20 | loss: 0.2302275
	speed: 0.3023s/iter; left time: 71.0389s
	iters: 600, epoch: 20 | loss: 0.2160696
	speed: 0.3032s/iter; left time: 40.9332s
	iters: 700, epoch: 20 | loss: 0.2112870
	speed: 0.3034s/iter; left time: 10.6190s
Epoch: 20 cost time: 221.5044915676117
Epoch: 20, Steps: 734 | Train Loss: 0.2374769 Vali Loss: 0.3552490 Test Loss: 0.4389370
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.9073486328125e-08
>>>>>>>testing : traffic_336_192_Linear_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15726<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3317
mse:0.43863028287887573, mae:0.30401521921157837
