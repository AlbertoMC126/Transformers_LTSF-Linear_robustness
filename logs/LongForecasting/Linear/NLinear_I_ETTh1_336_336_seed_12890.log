Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTh1', data_path='ETTh1.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='NLinear', model_id='ETTh1_336_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=336, root_path='./dataset/', save_pred_values=False, seed=12890, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTh1_336_336_NLinear_ETTh1_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed12890>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7969
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 0.4242219
	speed: 0.0095s/iter; left time: 46.3439s
	iters: 200, epoch: 1 | loss: 0.6086400
	speed: 0.0093s/iter; left time: 44.4923s
Epoch: 1 cost time: 2.311293601989746
Epoch: 1, Steps: 249 | Train Loss: 0.5573650 Vali Loss: 1.5285832 Test Loss: 0.5232483
Validation loss decreased (inf --> 1.528583).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.5396413
	speed: 0.0189s/iter; left time: 87.3411s
	iters: 200, epoch: 2 | loss: 0.4995962
	speed: 0.0086s/iter; left time: 38.8114s
Epoch: 2 cost time: 2.055776834487915
Epoch: 2, Steps: 249 | Train Loss: 0.5183445 Vali Loss: 1.4718539 Test Loss: 0.5119358
Validation loss decreased (1.528583 --> 1.471854).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.5391124
	speed: 0.0158s/iter; left time: 69.2776s
	iters: 200, epoch: 3 | loss: 0.5184186
	speed: 0.0088s/iter; left time: 37.6569s
Epoch: 3 cost time: 2.086430072784424
Epoch: 3, Steps: 249 | Train Loss: 0.4711136 Vali Loss: 1.3018812 Test Loss: 0.4759732
Validation loss decreased (1.471854 --> 1.301881).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.4758988
	speed: 0.0175s/iter; left time: 72.5144s
	iters: 200, epoch: 4 | loss: 0.4531173
	speed: 0.0094s/iter; left time: 38.0938s
Epoch: 4 cost time: 2.217647075653076
Epoch: 4, Steps: 249 | Train Loss: 0.4494942 Vali Loss: 1.3361992 Test Loss: 0.4614723
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.4484626
	speed: 0.0178s/iter; left time: 69.2140s
	iters: 200, epoch: 5 | loss: 0.4477709
	speed: 0.0091s/iter; left time: 34.4905s
Epoch: 5 cost time: 2.154534101486206
Epoch: 5, Steps: 249 | Train Loss: 0.4386288 Vali Loss: 1.2601026 Test Loss: 0.4479838
Validation loss decreased (1.301881 --> 1.260103).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.4921824
	speed: 0.0171s/iter; left time: 62.3370s
	iters: 200, epoch: 6 | loss: 0.4545544
	speed: 0.0074s/iter; left time: 25.9896s
Epoch: 6 cost time: 1.8205339908599854
Epoch: 6, Steps: 249 | Train Loss: 0.4338086 Vali Loss: 1.2671989 Test Loss: 0.4428988
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.4445621
	speed: 0.0170s/iter; left time: 57.4880s
	iters: 200, epoch: 7 | loss: 0.4504257
	speed: 0.0087s/iter; left time: 28.4815s
Epoch: 7 cost time: 2.1667346954345703
Epoch: 7, Steps: 249 | Train Loss: 0.4308216 Vali Loss: 1.2582039 Test Loss: 0.4423188
Validation loss decreased (1.260103 --> 1.258204).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.4371155
	speed: 0.0195s/iter; left time: 61.2507s
	iters: 200, epoch: 8 | loss: 0.4381941
	speed: 0.0081s/iter; left time: 24.4985s
Epoch: 8 cost time: 2.1070289611816406
Epoch: 8, Steps: 249 | Train Loss: 0.4291110 Vali Loss: 1.2639499 Test Loss: 0.4404977
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.4506213
	speed: 0.0157s/iter; left time: 45.3314s
	iters: 200, epoch: 9 | loss: 0.3637105
	speed: 0.0087s/iter; left time: 24.2682s
Epoch: 9 cost time: 2.097378730773926
Epoch: 9, Steps: 249 | Train Loss: 0.4282848 Vali Loss: 1.2568306 Test Loss: 0.4399694
Validation loss decreased (1.258204 --> 1.256831).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.4200827
	speed: 0.0173s/iter; left time: 45.5841s
	iters: 200, epoch: 10 | loss: 0.3562275
	speed: 0.0090s/iter; left time: 22.8113s
Epoch: 10 cost time: 2.0975120067596436
Epoch: 10, Steps: 249 | Train Loss: 0.4278163 Vali Loss: 1.2651405 Test Loss: 0.4398349
EarlyStopping counter: 1 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.3985451
	speed: 0.0161s/iter; left time: 38.4519s
	iters: 200, epoch: 11 | loss: 0.4335958
	speed: 0.0086s/iter; left time: 19.6808s
Epoch: 11 cost time: 2.029308795928955
Epoch: 11, Steps: 249 | Train Loss: 0.4275012 Vali Loss: 1.2623897 Test Loss: 0.4397771
EarlyStopping counter: 2 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.4123734
	speed: 0.0191s/iter; left time: 40.9296s
	iters: 200, epoch: 12 | loss: 0.4214687
	speed: 0.0086s/iter; left time: 17.5492s
Epoch: 12 cost time: 2.152829170227051
Epoch: 12, Steps: 249 | Train Loss: 0.4273462 Vali Loss: 1.2610049 Test Loss: 0.4398158
EarlyStopping counter: 3 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.4660023
	speed: 0.0165s/iter; left time: 31.2811s
	iters: 200, epoch: 13 | loss: 0.3904153
	speed: 0.0091s/iter; left time: 16.3572s
Epoch: 13 cost time: 2.1484835147857666
Epoch: 13, Steps: 249 | Train Loss: 0.4273014 Vali Loss: 1.2609509 Test Loss: 0.4398015
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.4504163
	speed: 0.0165s/iter; left time: 27.0461s
	iters: 200, epoch: 14 | loss: 0.3405240
	speed: 0.0074s/iter; left time: 11.4606s
Epoch: 14 cost time: 1.8593649864196777
Epoch: 14, Steps: 249 | Train Loss: 0.4273215 Vali Loss: 1.2605599 Test Loss: 0.4397957
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTh1_336_336_NLinear_ETTh1_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed12890<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2545
mse:0.43896615505218506, mae:0.43674084544181824
