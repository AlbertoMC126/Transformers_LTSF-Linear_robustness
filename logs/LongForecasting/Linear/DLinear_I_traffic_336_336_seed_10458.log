Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='DLinear', model_id='traffic_336_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=336, root_path='./dataset/', save_pred_values=False, seed=10458, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_336_336_DLinear_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed10458>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11609
val 1421
test 3173
	iters: 100, epoch: 1 | loss: 0.5754248
	speed: 0.4591s/iter; left time: 6611.3143s
	iters: 200, epoch: 1 | loss: 0.6167047
	speed: 0.4621s/iter; left time: 6608.7475s
	iters: 300, epoch: 1 | loss: 0.5666565
	speed: 0.4442s/iter; left time: 6308.6129s
	iters: 400, epoch: 1 | loss: 0.6131890
	speed: 0.4433s/iter; left time: 6251.3909s
	iters: 500, epoch: 1 | loss: 0.5515984
	speed: 0.4586s/iter; left time: 6421.4882s
	iters: 600, epoch: 1 | loss: 0.5809492
	speed: 0.4418s/iter; left time: 6141.5053s
	iters: 700, epoch: 1 | loss: 0.5911011
	speed: 0.4589s/iter; left time: 6333.1012s
Epoch: 1 cost time: 329.63568782806396
Epoch: 1, Steps: 725 | Train Loss: 0.6015784 Vali Loss: 0.8056059 Test Loss: 0.9493491
Validation loss decreased (inf --> 0.805606).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.5508447
	speed: 0.9976s/iter; left time: 13643.2027s
	iters: 200, epoch: 2 | loss: 0.5656437
	speed: 0.4574s/iter; left time: 6209.7551s
	iters: 300, epoch: 2 | loss: 0.5413534
	speed: 0.4464s/iter; left time: 6015.4359s
	iters: 400, epoch: 2 | loss: 0.6091539
	speed: 0.4444s/iter; left time: 5943.9946s
	iters: 500, epoch: 2 | loss: 0.6162501
	speed: 0.4501s/iter; left time: 5975.1669s
	iters: 600, epoch: 2 | loss: 0.6034443
	speed: 0.4416s/iter; left time: 5818.4507s
	iters: 700, epoch: 2 | loss: 0.6122355
	speed: 0.4538s/iter; left time: 5933.7464s
Epoch: 2 cost time: 328.5747694969177
Epoch: 2, Steps: 725 | Train Loss: 0.5934178 Vali Loss: 0.8189728 Test Loss: 0.9534901
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.3518199
	speed: 0.8788s/iter; left time: 11381.6333s
	iters: 200, epoch: 3 | loss: 0.3472560
	speed: 0.4587s/iter; left time: 5894.5899s
	iters: 300, epoch: 3 | loss: 0.3575028
	speed: 0.4409s/iter; left time: 5622.4731s
	iters: 400, epoch: 3 | loss: 0.3633153
	speed: 0.4482s/iter; left time: 5669.5597s
	iters: 500, epoch: 3 | loss: 0.3533163
	speed: 0.4550s/iter; left time: 5711.2759s
	iters: 600, epoch: 3 | loss: 0.3411685
	speed: 0.4424s/iter; left time: 5507.8088s
	iters: 700, epoch: 3 | loss: 0.3503846
	speed: 0.4615s/iter; left time: 5700.4510s
Epoch: 3 cost time: 326.8358151912689
Epoch: 3, Steps: 725 | Train Loss: 0.3716173 Vali Loss: 0.5162215 Test Loss: 0.6248720
Validation loss decreased (0.805606 --> 0.516221).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.3173174
	speed: 0.9708s/iter; left time: 11868.7339s
	iters: 200, epoch: 4 | loss: 0.3187071
	speed: 0.4479s/iter; left time: 5431.3845s
	iters: 300, epoch: 4 | loss: 0.3084215
	speed: 0.4448s/iter; left time: 5349.5843s
	iters: 400, epoch: 4 | loss: 0.3149596
	speed: 0.4488s/iter; left time: 5352.4543s
	iters: 500, epoch: 4 | loss: 0.3001208
	speed: 0.4472s/iter; left time: 5288.9202s
	iters: 600, epoch: 4 | loss: 0.3160807
	speed: 0.4442s/iter; left time: 5208.6439s
	iters: 700, epoch: 4 | loss: 0.3381918
	speed: 0.4431s/iter; left time: 5152.0568s
Epoch: 4 cost time: 324.0805127620697
Epoch: 4, Steps: 725 | Train Loss: 0.3060883 Vali Loss: 0.4346923 Test Loss: 0.5313773
Validation loss decreased (0.516221 --> 0.434692).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.2984011
	speed: 0.9802s/iter; left time: 11273.3851s
	iters: 200, epoch: 5 | loss: 0.2712475
	speed: 0.4467s/iter; left time: 5092.4725s
	iters: 300, epoch: 5 | loss: 0.2795261
	speed: 0.4473s/iter; left time: 5055.2217s
	iters: 400, epoch: 5 | loss: 0.2776851
	speed: 0.4434s/iter; left time: 4966.9575s
	iters: 500, epoch: 5 | loss: 0.2962029
	speed: 0.4409s/iter; left time: 4894.5179s
	iters: 600, epoch: 5 | loss: 0.2673556
	speed: 0.4418s/iter; left time: 4860.2727s
	iters: 700, epoch: 5 | loss: 0.2787880
	speed: 0.4443s/iter; left time: 4843.3070s
Epoch: 5 cost time: 323.3421311378479
Epoch: 5, Steps: 725 | Train Loss: 0.2787090 Vali Loss: 0.4025755 Test Loss: 0.4912455
Validation loss decreased (0.434692 --> 0.402575).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.2732075
	speed: 0.9638s/iter; left time: 10386.2118s
	iters: 200, epoch: 6 | loss: 0.2494726
	speed: 0.4529s/iter; left time: 4834.6605s
	iters: 300, epoch: 6 | loss: 0.2637558
	speed: 0.4452s/iter; left time: 4708.1451s
	iters: 400, epoch: 6 | loss: 0.2812600
	speed: 0.4584s/iter; left time: 4802.3451s
	iters: 500, epoch: 6 | loss: 0.2563040
	speed: 0.4429s/iter; left time: 4595.1440s
	iters: 600, epoch: 6 | loss: 0.2610640
	speed: 0.4420s/iter; left time: 4542.1906s
	iters: 700, epoch: 6 | loss: 0.2766663
	speed: 0.4422s/iter; left time: 4500.2131s
Epoch: 6 cost time: 325.08567094802856
Epoch: 6, Steps: 725 | Train Loss: 0.2647321 Vali Loss: 0.3861080 Test Loss: 0.4720398
Validation loss decreased (0.402575 --> 0.386108).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.2490760
	speed: 0.9716s/iter; left time: 9765.1375s
	iters: 200, epoch: 7 | loss: 0.2482458
	speed: 0.4493s/iter; left time: 4470.7475s
	iters: 300, epoch: 7 | loss: 0.2557950
	speed: 0.4497s/iter; left time: 4429.7218s
	iters: 400, epoch: 7 | loss: 0.2313754
	speed: 0.4525s/iter; left time: 4411.9822s
	iters: 500, epoch: 7 | loss: 0.2421124
	speed: 0.4407s/iter; left time: 4253.5892s
	iters: 600, epoch: 7 | loss: 0.2537666
	speed: 0.4417s/iter; left time: 4218.6699s
	iters: 700, epoch: 7 | loss: 0.3018690
	speed: 0.4417s/iter; left time: 4174.0430s
Epoch: 7 cost time: 324.1243009567261
Epoch: 7, Steps: 725 | Train Loss: 0.2572124 Vali Loss: 0.3787748 Test Loss: 0.4618988
Validation loss decreased (0.386108 --> 0.378775).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.2641414
	speed: 0.9677s/iter; left time: 9025.0424s
	iters: 200, epoch: 8 | loss: 0.2664798
	speed: 0.4529s/iter; left time: 4178.8904s
	iters: 300, epoch: 8 | loss: 0.2485934
	speed: 0.4473s/iter; left time: 4081.8551s
	iters: 400, epoch: 8 | loss: 0.2512124
	speed: 0.4464s/iter; left time: 4028.9561s
	iters: 500, epoch: 8 | loss: 0.2752652
	speed: 0.4384s/iter; left time: 3912.7725s
	iters: 600, epoch: 8 | loss: 0.2567534
	speed: 0.4405s/iter; left time: 3887.9232s
	iters: 700, epoch: 8 | loss: 0.2772555
	speed: 0.4434s/iter; left time: 3868.9810s
Epoch: 8 cost time: 323.23908042907715
Epoch: 8, Steps: 725 | Train Loss: 0.2530690 Vali Loss: 0.3739916 Test Loss: 0.4574249
Validation loss decreased (0.378775 --> 0.373992).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.2553863
	speed: 0.9622s/iter; left time: 8276.0410s
	iters: 200, epoch: 9 | loss: 0.2324743
	speed: 0.4497s/iter; left time: 3822.6182s
	iters: 300, epoch: 9 | loss: 0.2448949
	speed: 0.4483s/iter; left time: 3766.2575s
	iters: 400, epoch: 9 | loss: 0.2426482
	speed: 0.4417s/iter; left time: 3666.5110s
	iters: 500, epoch: 9 | loss: 0.2535340
	speed: 0.4393s/iter; left time: 3602.4640s
	iters: 600, epoch: 9 | loss: 0.2437569
	speed: 0.4401s/iter; left time: 3565.5101s
	iters: 700, epoch: 9 | loss: 0.2517502
	speed: 0.4463s/iter; left time: 3571.1357s
Epoch: 9 cost time: 323.0352921485901
Epoch: 9, Steps: 725 | Train Loss: 0.2507519 Vali Loss: 0.3723223 Test Loss: 0.4553262
Validation loss decreased (0.373992 --> 0.372322).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.2292546
	speed: 0.9726s/iter; left time: 7660.0242s
	iters: 200, epoch: 10 | loss: 0.2635109
	speed: 0.4503s/iter; left time: 3501.3510s
	iters: 300, epoch: 10 | loss: 0.2593750
	speed: 0.4491s/iter; left time: 3447.6369s
	iters: 400, epoch: 10 | loss: 0.2541708
	speed: 0.4505s/iter; left time: 3413.1973s
	iters: 500, epoch: 10 | loss: 0.2489256
	speed: 0.4421s/iter; left time: 3305.3885s
	iters: 600, epoch: 10 | loss: 0.2603875
	speed: 0.4420s/iter; left time: 3260.2061s
	iters: 700, epoch: 10 | loss: 0.2604339
	speed: 0.4423s/iter; left time: 3218.4834s
Epoch: 10 cost time: 324.4569425582886
Epoch: 10, Steps: 725 | Train Loss: 0.2495005 Vali Loss: 0.3715088 Test Loss: 0.4542027
Validation loss decreased (0.372322 --> 0.371509).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.2771098
	speed: 0.9745s/iter; left time: 6968.8296s
	iters: 200, epoch: 11 | loss: 0.2290872
	speed: 0.4497s/iter; left time: 3170.7269s
	iters: 300, epoch: 11 | loss: 0.2414607
	speed: 0.4521s/iter; left time: 3142.7060s
	iters: 400, epoch: 11 | loss: 0.2558603
	speed: 0.4526s/iter; left time: 3100.9960s
	iters: 500, epoch: 11 | loss: 0.2534665
	speed: 0.4430s/iter; left time: 2990.4372s
	iters: 600, epoch: 11 | loss: 0.2570619
	speed: 0.4438s/iter; left time: 2951.4789s
	iters: 700, epoch: 11 | loss: 0.2550343
	speed: 0.4446s/iter; left time: 2912.3401s
Epoch: 11 cost time: 325.42818808555603
Epoch: 11, Steps: 725 | Train Loss: 0.2488265 Vali Loss: 0.3712502 Test Loss: 0.4538823
Validation loss decreased (0.371509 --> 0.371250).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.2558122
	speed: 0.9628s/iter; left time: 6186.8803s
	iters: 200, epoch: 12 | loss: 0.2332110
	speed: 0.4496s/iter; left time: 2844.3253s
	iters: 300, epoch: 12 | loss: 0.2554214
	speed: 0.4531s/iter; left time: 2821.1819s
	iters: 400, epoch: 12 | loss: 0.2653502
	speed: 0.4482s/iter; left time: 2745.8089s
	iters: 500, epoch: 12 | loss: 0.2675669
	speed: 0.4431s/iter; left time: 2669.9248s
	iters: 600, epoch: 12 | loss: 0.2445808
	speed: 0.4422s/iter; left time: 2620.2996s
	iters: 700, epoch: 12 | loss: 0.2374616
	speed: 0.4424s/iter; left time: 2577.3139s
Epoch: 12 cost time: 324.538455247879
Epoch: 12, Steps: 725 | Train Loss: 0.2484422 Vali Loss: 0.3709120 Test Loss: 0.4536222
Validation loss decreased (0.371250 --> 0.370912).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.2523909
	speed: 0.9845s/iter; left time: 5612.4391s
	iters: 200, epoch: 13 | loss: 0.2404052
	speed: 0.4475s/iter; left time: 2506.4709s
	iters: 300, epoch: 13 | loss: 0.2365192
	speed: 0.4539s/iter; left time: 2496.9829s
	iters: 400, epoch: 13 | loss: 0.2310693
	speed: 0.4487s/iter; left time: 2423.2974s
	iters: 500, epoch: 13 | loss: 0.2483164
	speed: 0.4419s/iter; left time: 2342.6230s
	iters: 600, epoch: 13 | loss: 0.2472405
	speed: 0.4415s/iter; left time: 2296.2343s
	iters: 700, epoch: 13 | loss: 0.2642342
	speed: 0.4486s/iter; left time: 2288.2096s
Epoch: 13 cost time: 325.6969316005707
Epoch: 13, Steps: 725 | Train Loss: 0.2482519 Vali Loss: 0.3706566 Test Loss: 0.4535766
Validation loss decreased (0.370912 --> 0.370657).  Saving model ...
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 14 | loss: 0.2324514
	speed: 0.9862s/iter; left time: 4907.1806s
	iters: 200, epoch: 14 | loss: 0.2429366
	speed: 0.4504s/iter; left time: 2196.0083s
	iters: 300, epoch: 14 | loss: 0.2508794
	speed: 0.4491s/iter; left time: 2144.7253s
	iters: 400, epoch: 14 | loss: 0.2268640
	speed: 0.4512s/iter; left time: 2109.8303s
	iters: 500, epoch: 14 | loss: 0.2529329
	speed: 0.4428s/iter; left time: 2026.3443s
	iters: 600, epoch: 14 | loss: 0.2588255
	speed: 0.4660s/iter; left time: 2085.7507s
	iters: 700, epoch: 14 | loss: 0.2208064
	speed: 0.4449s/iter; left time: 1947.0064s
Epoch: 14 cost time: 327.837774515152
Epoch: 14, Steps: 725 | Train Loss: 0.2481608 Vali Loss: 0.3710488 Test Loss: 0.4535527
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 15 | loss: 0.2470627
	speed: 0.8899s/iter; left time: 3783.0404s
	iters: 200, epoch: 15 | loss: 0.2482040
	speed: 0.4456s/iter; left time: 1849.5136s
	iters: 300, epoch: 15 | loss: 0.2359893
	speed: 0.4506s/iter; left time: 1825.2668s
	iters: 400, epoch: 15 | loss: 0.2747876
	speed: 0.4504s/iter; left time: 1779.4204s
	iters: 500, epoch: 15 | loss: 0.2603777
	speed: 0.4432s/iter; left time: 1706.6993s
	iters: 600, epoch: 15 | loss: 0.2467481
	speed: 0.4684s/iter; left time: 1756.8353s
	iters: 700, epoch: 15 | loss: 0.2525112
	speed: 0.4445s/iter; left time: 1623.0241s
Epoch: 15 cost time: 327.35998034477234
Epoch: 15, Steps: 725 | Train Loss: 0.2480292 Vali Loss: 0.3708983 Test Loss: 0.4535515
EarlyStopping counter: 2 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 16 | loss: 0.2526001
	speed: 0.8935s/iter; left time: 3150.5421s
	iters: 200, epoch: 16 | loss: 0.2833747
	speed: 0.4416s/iter; left time: 1512.8684s
	iters: 300, epoch: 16 | loss: 0.2785909
	speed: 0.4556s/iter; left time: 1515.1844s
	iters: 400, epoch: 16 | loss: 0.2526288
	speed: 0.4510s/iter; left time: 1454.8507s
	iters: 500, epoch: 16 | loss: 0.2248171
	speed: 0.4427s/iter; left time: 1383.8895s
	iters: 600, epoch: 16 | loss: 0.2561453
	speed: 0.4678s/iter; left time: 1415.5320s
	iters: 700, epoch: 16 | loss: 0.2586856
	speed: 0.4463s/iter; left time: 1305.9351s
Epoch: 16 cost time: 327.1770107746124
Epoch: 16, Steps: 725 | Train Loss: 0.2480711 Vali Loss: 0.3708415 Test Loss: 0.4535480
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 17 | loss: 0.2613357
	speed: 0.8924s/iter; left time: 2499.5971s
	iters: 200, epoch: 17 | loss: 0.2596178
	speed: 0.4425s/iter; left time: 1195.1939s
	iters: 300, epoch: 17 | loss: 0.2454865
	speed: 0.4566s/iter; left time: 1187.7138s
	iters: 400, epoch: 17 | loss: 0.2510726
	speed: 0.4527s/iter; left time: 1132.2419s
	iters: 500, epoch: 17 | loss: 0.2383018
	speed: 0.4412s/iter; left time: 1059.2094s
	iters: 600, epoch: 17 | loss: 0.2433021
	speed: 0.4676s/iter; left time: 1075.8966s
	iters: 700, epoch: 17 | loss: 0.2742814
	speed: 0.4461s/iter; left time: 981.8514s
Epoch: 17 cost time: 328.2328929901123
Epoch: 17, Steps: 725 | Train Loss: 0.2480249 Vali Loss: 0.3709782 Test Loss: 0.4535479
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 18 | loss: 0.2359765
	speed: 0.8986s/iter; left time: 1865.4937s
	iters: 200, epoch: 18 | loss: 0.2623795
	speed: 0.4464s/iter; left time: 882.0778s
	iters: 300, epoch: 18 | loss: 0.2394746
	speed: 0.5060s/iter; left time: 949.3241s
	iters: 400, epoch: 18 | loss: 0.2695745
	speed: 0.4923s/iter; left time: 874.3601s
	iters: 500, epoch: 18 | loss: 0.2669573
	speed: 0.4833s/iter; left time: 810.0497s
	iters: 600, epoch: 18 | loss: 0.2510814
	speed: 0.4849s/iter; left time: 764.1901s
	iters: 700, epoch: 18 | loss: 0.2625526
	speed: 0.4890s/iter; left time: 721.7375s
Epoch: 18 cost time: 348.46668791770935
Epoch: 18, Steps: 725 | Train Loss: 0.2480266 Vali Loss: 0.3712503 Test Loss: 0.4535473
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : traffic_336_336_DLinear_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed10458<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3173
mse:0.45260003209114075, mae:0.3122992515563965
