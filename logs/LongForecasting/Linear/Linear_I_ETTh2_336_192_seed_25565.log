Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTh2', data_path='ETTh2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.05, loss='mse', lradj='type1', model='Linear', model_id='ETTh2_336_192', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=192, root_path='./dataset/', save_pred_values=False, seed=25565, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTh2_336_192_Linear_ETTh2_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed25565>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8113
val 2689
test 2689
	iters: 100, epoch: 1 | loss: 2.6216633
	speed: 0.0045s/iter; left time: 44.8837s
	iters: 200, epoch: 1 | loss: 1.2898362
	speed: 0.0048s/iter; left time: 47.8380s
	iters: 300, epoch: 1 | loss: 6.7032237
	speed: 0.0048s/iter; left time: 46.8486s
	iters: 400, epoch: 1 | loss: 4.7543302
	speed: 0.0040s/iter; left time: 39.2888s
	iters: 500, epoch: 1 | loss: 6.5813723
	speed: 0.0045s/iter; left time: 43.8665s
Epoch: 1 cost time: 2.295610189437866
Epoch: 1, Steps: 507 | Train Loss: 6.1114666 Vali Loss: 14.4660416 Test Loss: 29.8360672
Validation loss decreased (inf --> 14.466042).  Saving model ...
Updating learning rate to 0.05
	iters: 100, epoch: 2 | loss: 4.4300041
	speed: 0.0098s/iter; left time: 93.7435s
	iters: 200, epoch: 2 | loss: 2.8189433
	speed: 0.0048s/iter; left time: 45.3032s
	iters: 300, epoch: 2 | loss: 4.9152384
	speed: 0.0048s/iter; left time: 44.8800s
	iters: 400, epoch: 2 | loss: 1.9624158
	speed: 0.0043s/iter; left time: 39.3544s
	iters: 500, epoch: 2 | loss: 3.9557669
	speed: 0.0039s/iter; left time: 35.2570s
Epoch: 2 cost time: 2.2812228202819824
Epoch: 2, Steps: 507 | Train Loss: 10.4392575 Vali Loss: 3.7351255 Test Loss: 14.9790354
Validation loss decreased (14.466042 --> 3.735126).  Saving model ...
Updating learning rate to 0.025
	iters: 100, epoch: 3 | loss: 0.4075255
	speed: 0.0082s/iter; left time: 73.8647s
	iters: 200, epoch: 3 | loss: 0.7016988
	speed: 0.0044s/iter; left time: 39.6360s
	iters: 300, epoch: 3 | loss: 0.4824633
	speed: 0.0042s/iter; left time: 37.3574s
	iters: 400, epoch: 3 | loss: 1.1764780
	speed: 0.0035s/iter; left time: 30.1115s
	iters: 500, epoch: 3 | loss: 1.1579672
	speed: 0.0037s/iter; left time: 32.1788s
Epoch: 3 cost time: 2.0174689292907715
Epoch: 3, Steps: 507 | Train Loss: 1.0435817 Vali Loss: 1.4836631 Test Loss: 2.6970024
Validation loss decreased (3.735126 --> 1.483663).  Saving model ...
Updating learning rate to 0.0125
	iters: 100, epoch: 4 | loss: 0.6797069
	speed: 0.0072s/iter; left time: 61.1892s
	iters: 200, epoch: 4 | loss: 0.4201751
	speed: 0.0030s/iter; left time: 25.2603s
	iters: 300, epoch: 4 | loss: 0.6785421
	speed: 0.0037s/iter; left time: 30.6352s
	iters: 400, epoch: 4 | loss: 1.0552680
	speed: 0.0041s/iter; left time: 34.1128s
	iters: 500, epoch: 4 | loss: 0.8925556
	speed: 0.0045s/iter; left time: 36.5020s
Epoch: 4 cost time: 1.89058518409729
Epoch: 4, Steps: 507 | Train Loss: 0.6214256 Vali Loss: 0.5453485 Test Loss: 0.8959427
Validation loss decreased (1.483663 --> 0.545348).  Saving model ...
Updating learning rate to 0.00625
	iters: 100, epoch: 5 | loss: 0.3568216
	speed: 0.0096s/iter; left time: 77.2715s
	iters: 200, epoch: 5 | loss: 0.5634969
	speed: 0.0046s/iter; left time: 36.0092s
	iters: 300, epoch: 5 | loss: 0.9601232
	speed: 0.0047s/iter; left time: 36.4870s
	iters: 400, epoch: 5 | loss: 0.3661249
	speed: 0.0040s/iter; left time: 31.0201s
	iters: 500, epoch: 5 | loss: 0.6295363
	speed: 0.0036s/iter; left time: 27.3450s
Epoch: 5 cost time: 2.165762424468994
Epoch: 5, Steps: 507 | Train Loss: 0.5337916 Vali Loss: 0.4440725 Test Loss: 0.8346879
Validation loss decreased (0.545348 --> 0.444072).  Saving model ...
Updating learning rate to 0.003125
	iters: 100, epoch: 6 | loss: 0.8916485
	speed: 0.0085s/iter; left time: 64.1251s
	iters: 200, epoch: 6 | loss: 0.3394910
	speed: 0.0046s/iter; left time: 34.3147s
	iters: 300, epoch: 6 | loss: 0.3304490
	speed: 0.0047s/iter; left time: 34.7035s
	iters: 400, epoch: 6 | loss: 0.6265881
	speed: 0.0046s/iter; left time: 33.0035s
	iters: 500, epoch: 6 | loss: 0.4151548
	speed: 0.0045s/iter; left time: 32.2803s
Epoch: 6 cost time: 2.3146021366119385
Epoch: 6, Steps: 507 | Train Loss: 0.4911350 Vali Loss: 0.4151062 Test Loss: 0.6545936
Validation loss decreased (0.444072 --> 0.415106).  Saving model ...
Updating learning rate to 0.0015625
	iters: 100, epoch: 7 | loss: 0.5161095
	speed: 0.0090s/iter; left time: 62.9390s
	iters: 200, epoch: 7 | loss: 0.9736195
	speed: 0.0046s/iter; left time: 31.6017s
	iters: 300, epoch: 7 | loss: 0.5293587
	speed: 0.0042s/iter; left time: 28.4331s
	iters: 400, epoch: 7 | loss: 0.7019288
	speed: 0.0045s/iter; left time: 30.0114s
	iters: 500, epoch: 7 | loss: 0.3265878
	speed: 0.0044s/iter; left time: 28.8131s
Epoch: 7 cost time: 2.223142147064209
Epoch: 7, Steps: 507 | Train Loss: 0.4700979 Vali Loss: 0.4019696 Test Loss: 0.7054852
Validation loss decreased (0.415106 --> 0.401970).  Saving model ...
Updating learning rate to 0.00078125
	iters: 100, epoch: 8 | loss: 0.2988801
	speed: 0.0091s/iter; left time: 59.0964s
	iters: 200, epoch: 8 | loss: 0.3702350
	speed: 0.0041s/iter; left time: 26.2710s
	iters: 300, epoch: 8 | loss: 0.5627052
	speed: 0.0044s/iter; left time: 27.4858s
	iters: 400, epoch: 8 | loss: 0.3290140
	speed: 0.0028s/iter; left time: 17.1039s
	iters: 500, epoch: 8 | loss: 0.6041036
	speed: 0.0035s/iter; left time: 21.6265s
Epoch: 8 cost time: 1.9223551750183105
Epoch: 8, Steps: 507 | Train Loss: 0.4587849 Vali Loss: 0.4395717 Test Loss: 0.7395654
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.000390625
	iters: 100, epoch: 9 | loss: 0.4930953
	speed: 0.0088s/iter; left time: 52.3861s
	iters: 200, epoch: 9 | loss: 0.5734441
	speed: 0.0043s/iter; left time: 25.3643s
	iters: 300, epoch: 9 | loss: 0.5814016
	speed: 0.0044s/iter; left time: 25.7019s
	iters: 400, epoch: 9 | loss: 0.6477454
	speed: 0.0040s/iter; left time: 22.8535s
	iters: 500, epoch: 9 | loss: 0.7511279
	speed: 0.0038s/iter; left time: 21.4581s
Epoch: 9 cost time: 2.1277217864990234
Epoch: 9, Steps: 507 | Train Loss: 0.4524993 Vali Loss: 0.3944359 Test Loss: 0.5970571
Validation loss decreased (0.401970 --> 0.394436).  Saving model ...
Updating learning rate to 0.0001953125
	iters: 100, epoch: 10 | loss: 0.2061295
	speed: 0.0080s/iter; left time: 43.7596s
	iters: 200, epoch: 10 | loss: 0.2877287
	speed: 0.0041s/iter; left time: 21.9003s
	iters: 300, epoch: 10 | loss: 0.4038951
	speed: 0.0039s/iter; left time: 20.7954s
	iters: 400, epoch: 10 | loss: 0.4097896
	speed: 0.0039s/iter; left time: 20.0528s
	iters: 500, epoch: 10 | loss: 0.8612451
	speed: 0.0041s/iter; left time: 21.0706s
Epoch: 10 cost time: 2.024256467819214
Epoch: 10, Steps: 507 | Train Loss: 0.4476349 Vali Loss: 0.4009016 Test Loss: 0.6238135
EarlyStopping counter: 1 out of 5
Updating learning rate to 9.765625e-05
	iters: 100, epoch: 11 | loss: 0.3433567
	speed: 0.0090s/iter; left time: 44.6063s
	iters: 200, epoch: 11 | loss: 0.9454228
	speed: 0.0047s/iter; left time: 22.7475s
	iters: 300, epoch: 11 | loss: 0.2633948
	speed: 0.0046s/iter; left time: 21.7710s
	iters: 400, epoch: 11 | loss: 1.0595223
	speed: 0.0041s/iter; left time: 18.9672s
	iters: 500, epoch: 11 | loss: 0.5249316
	speed: 0.0049s/iter; left time: 22.1856s
Epoch: 11 cost time: 2.301067352294922
Epoch: 11, Steps: 507 | Train Loss: 0.4454375 Vali Loss: 0.3825137 Test Loss: 0.5571904
Validation loss decreased (0.394436 --> 0.382514).  Saving model ...
Updating learning rate to 4.8828125e-05
	iters: 100, epoch: 12 | loss: 0.2587948
	speed: 0.0086s/iter; left time: 38.3256s
	iters: 200, epoch: 12 | loss: 0.6181071
	speed: 0.0044s/iter; left time: 19.0272s
	iters: 300, epoch: 12 | loss: 0.7087556
	speed: 0.0043s/iter; left time: 18.2073s
	iters: 400, epoch: 12 | loss: 0.8079343
	speed: 0.0044s/iter; left time: 18.4708s
	iters: 500, epoch: 12 | loss: 0.3839108
	speed: 0.0038s/iter; left time: 15.4433s
Epoch: 12 cost time: 2.141815423965454
Epoch: 12, Steps: 507 | Train Loss: 0.4437642 Vali Loss: 0.3898546 Test Loss: 0.6064841
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.44140625e-05
	iters: 100, epoch: 13 | loss: 0.3443298
	speed: 0.0078s/iter; left time: 30.8790s
	iters: 200, epoch: 13 | loss: 0.6242406
	speed: 0.0039s/iter; left time: 15.0056s
	iters: 300, epoch: 13 | loss: 0.5518326
	speed: 0.0039s/iter; left time: 14.6274s
	iters: 400, epoch: 13 | loss: 0.4724611
	speed: 0.0037s/iter; left time: 13.5673s
	iters: 500, epoch: 13 | loss: 0.5882320
	speed: 0.0036s/iter; left time: 12.8052s
Epoch: 13 cost time: 1.9235751628875732
Epoch: 13, Steps: 507 | Train Loss: 0.4429860 Vali Loss: 0.3898880 Test Loss: 0.6046492
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.220703125e-05
	iters: 100, epoch: 14 | loss: 0.5357462
	speed: 0.0070s/iter; left time: 24.0538s
	iters: 200, epoch: 14 | loss: 0.5003474
	speed: 0.0036s/iter; left time: 11.9706s
	iters: 300, epoch: 14 | loss: 0.1876707
	speed: 0.0041s/iter; left time: 13.1635s
	iters: 400, epoch: 14 | loss: 0.5154317
	speed: 0.0041s/iter; left time: 12.8835s
	iters: 500, epoch: 14 | loss: 0.3963284
	speed: 0.0039s/iter; left time: 11.9394s
Epoch: 14 cost time: 1.9398219585418701
Epoch: 14, Steps: 507 | Train Loss: 0.4425061 Vali Loss: 0.3889979 Test Loss: 0.6000520
EarlyStopping counter: 3 out of 5
Updating learning rate to 6.103515625e-06
	iters: 100, epoch: 15 | loss: 0.3030715
	speed: 0.0076s/iter; left time: 22.2496s
	iters: 200, epoch: 15 | loss: 0.5836486
	speed: 0.0043s/iter; left time: 12.3430s
	iters: 300, epoch: 15 | loss: 0.7992494
	speed: 0.0038s/iter; left time: 10.5058s
	iters: 400, epoch: 15 | loss: 0.2355957
	speed: 0.0034s/iter; left time: 8.8626s
	iters: 500, epoch: 15 | loss: 0.5170362
	speed: 0.0032s/iter; left time: 8.0116s
Epoch: 15 cost time: 1.8625454902648926
Epoch: 15, Steps: 507 | Train Loss: 0.4421883 Vali Loss: 0.3868477 Test Loss: 0.5897676
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.0517578125e-06
	iters: 100, epoch: 16 | loss: 0.5172757
	speed: 0.0055s/iter; left time: 13.3312s
	iters: 200, epoch: 16 | loss: 0.2113367
	speed: 0.0035s/iter; left time: 8.2242s
	iters: 300, epoch: 16 | loss: 0.4519127
	speed: 0.0034s/iter; left time: 7.6248s
	iters: 400, epoch: 16 | loss: 0.5713825
	speed: 0.0034s/iter; left time: 7.1593s
	iters: 500, epoch: 16 | loss: 0.7328894
	speed: 0.0024s/iter; left time: 4.7846s
Epoch: 16 cost time: 1.5564980506896973
Epoch: 16, Steps: 507 | Train Loss: 0.4420395 Vali Loss: 0.3869143 Test Loss: 0.5907335
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTh2_336_192_Linear_ETTh2_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed25565<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2689
mse:0.5582969784736633, mae:0.5021372437477112
