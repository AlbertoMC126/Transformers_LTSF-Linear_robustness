Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='NLinear', model_id='weather_96_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=15349, seq_len=96, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_96_96_NLinear_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15349>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36696
val 5175
test 10444
Total number of trainable parameters: 195552
Total number of parameters: 195552
	iters: 100, epoch: 1 | loss: 0.3735782
	speed: 0.0813s/iter; left time: 3722.6174s
	iters: 200, epoch: 1 | loss: 0.4584829
	speed: 0.0320s/iter; left time: 1463.3985s
	iters: 300, epoch: 1 | loss: 0.4427371
	speed: 0.0319s/iter; left time: 1451.5277s
	iters: 400, epoch: 1 | loss: 0.7523915
	speed: 0.0317s/iter; left time: 1442.6686s
	iters: 500, epoch: 1 | loss: 0.3490893
	speed: 0.0318s/iter; left time: 1442.0984s
	iters: 600, epoch: 1 | loss: 0.2049040
	speed: 0.0317s/iter; left time: 1434.0936s
	iters: 700, epoch: 1 | loss: 0.7265668
	speed: 0.0316s/iter; left time: 1424.8562s
	iters: 800, epoch: 1 | loss: 2.7811868
	speed: 0.0316s/iter; left time: 1422.0072s
	iters: 900, epoch: 1 | loss: 0.3144508
	speed: 0.0317s/iter; left time: 1423.4487s
	iters: 1000, epoch: 1 | loss: 0.3611465
	speed: 0.0314s/iter; left time: 1408.1135s
	iters: 1100, epoch: 1 | loss: 0.3382615
	speed: 0.0315s/iter; left time: 1412.1105s
	iters: 1200, epoch: 1 | loss: 0.3284318
	speed: 0.0314s/iter; left time: 1403.4238s
	iters: 1300, epoch: 1 | loss: 2.1622436
	speed: 0.0314s/iter; left time: 1400.6828s
	iters: 1400, epoch: 1 | loss: 0.4160654
	speed: 0.0316s/iter; left time: 1403.5373s
	iters: 1500, epoch: 1 | loss: 2.5843792
	speed: 0.0317s/iter; left time: 1404.1638s
	iters: 1600, epoch: 1 | loss: 0.5745192
	speed: 0.0314s/iter; left time: 1391.4678s
	iters: 1700, epoch: 1 | loss: 0.2897044
	speed: 0.0315s/iter; left time: 1388.9459s
	iters: 1800, epoch: 1 | loss: 0.2641000
	speed: 0.0314s/iter; left time: 1381.4566s
	iters: 1900, epoch: 1 | loss: 0.4198517
	speed: 0.0314s/iter; left time: 1381.1200s
	iters: 2000, epoch: 1 | loss: 0.2704562
	speed: 0.0320s/iter; left time: 1404.8412s
	iters: 2100, epoch: 1 | loss: 0.5083492
	speed: 0.0321s/iter; left time: 1403.2518s
	iters: 2200, epoch: 1 | loss: 0.2093349
	speed: 0.0313s/iter; left time: 1368.5123s
Epoch: 1 cost time: 77.45289731025696
Epoch: 1, Steps: 2293 | Train Loss: 0.7169599 Vali Loss: 0.5361723 Test Loss: 0.1794291
Validation loss decreased (inf --> 0.536172).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.2727621
	speed: 0.1091s/iter; left time: 4743.4248s
	iters: 200, epoch: 2 | loss: 6.6984711
	speed: 0.0319s/iter; left time: 1382.8293s
	iters: 300, epoch: 2 | loss: 0.3282164
	speed: 0.0316s/iter; left time: 1368.2041s
	iters: 400, epoch: 2 | loss: 0.5560032
	speed: 0.0316s/iter; left time: 1365.3253s
	iters: 500, epoch: 2 | loss: 0.4369523
	speed: 0.0316s/iter; left time: 1362.9160s
	iters: 600, epoch: 2 | loss: 0.3881843
	speed: 0.0317s/iter; left time: 1362.8659s
	iters: 700, epoch: 2 | loss: 0.4170330
	speed: 0.0316s/iter; left time: 1353.4391s
	iters: 800, epoch: 2 | loss: 4.3360395
	speed: 0.0317s/iter; left time: 1356.4823s
	iters: 900, epoch: 2 | loss: 0.3295969
	speed: 0.0317s/iter; left time: 1352.3780s
	iters: 1000, epoch: 2 | loss: 0.4173853
	speed: 0.0315s/iter; left time: 1339.6471s
	iters: 1100, epoch: 2 | loss: 0.3716914
	speed: 0.0316s/iter; left time: 1340.7909s
	iters: 1200, epoch: 2 | loss: 0.4422423
	speed: 0.0314s/iter; left time: 1329.5784s
	iters: 1300, epoch: 2 | loss: 0.4617315
	speed: 0.0317s/iter; left time: 1339.7817s
	iters: 1400, epoch: 2 | loss: 0.3026327
	speed: 0.0318s/iter; left time: 1339.2842s
	iters: 1500, epoch: 2 | loss: 0.3115106
	speed: 0.0316s/iter; left time: 1331.3001s
	iters: 1600, epoch: 2 | loss: 0.6456914
	speed: 0.0316s/iter; left time: 1324.5047s
	iters: 1700, epoch: 2 | loss: 0.2697366
	speed: 0.0317s/iter; left time: 1329.0000s
	iters: 1800, epoch: 2 | loss: 0.3958448
	speed: 0.0316s/iter; left time: 1318.1830s
	iters: 1900, epoch: 2 | loss: 0.3718489
	speed: 0.0317s/iter; left time: 1318.9800s
	iters: 2000, epoch: 2 | loss: 0.3050577
	speed: 0.0316s/iter; left time: 1314.9367s
	iters: 2100, epoch: 2 | loss: 0.3241189
	speed: 0.0318s/iter; left time: 1320.3996s
	iters: 2200, epoch: 2 | loss: 0.4877115
	speed: 0.0316s/iter; left time: 1309.2835s
Epoch: 2 cost time: 72.53462362289429
Epoch: 2, Steps: 2293 | Train Loss: 5.5692544 Vali Loss: 0.4486067 Test Loss: 0.1868151
Validation loss decreased (0.536172 --> 0.448607).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 1.1997231
	speed: 0.1115s/iter; left time: 4589.6224s
	iters: 200, epoch: 3 | loss: 0.2693834
	speed: 0.0317s/iter; left time: 1303.8170s
	iters: 300, epoch: 3 | loss: 0.2912641
	speed: 0.0316s/iter; left time: 1294.4923s
	iters: 400, epoch: 3 | loss: 0.2595737
	speed: 0.0317s/iter; left time: 1296.1478s
	iters: 500, epoch: 3 | loss: 0.2563652
	speed: 0.0316s/iter; left time: 1288.2361s
	iters: 600, epoch: 3 | loss: 0.3119705
	speed: 0.0316s/iter; left time: 1284.8500s
	iters: 700, epoch: 3 | loss: 0.3522952
	speed: 0.0314s/iter; left time: 1276.0491s
	iters: 800, epoch: 3 | loss: 0.3897903
	speed: 0.0316s/iter; left time: 1277.4393s
	iters: 900, epoch: 3 | loss: 0.7521406
	speed: 0.0316s/iter; left time: 1275.6094s
	iters: 1000, epoch: 3 | loss: 0.3574080
	speed: 0.0315s/iter; left time: 1267.7068s
	iters: 1100, epoch: 3 | loss: 0.2659150
	speed: 0.0316s/iter; left time: 1269.9825s
	iters: 1200, epoch: 3 | loss: 0.3526248
	speed: 0.0316s/iter; left time: 1265.7089s
	iters: 1300, epoch: 3 | loss: 2.5812287
	speed: 0.0317s/iter; left time: 1268.4519s
	iters: 1400, epoch: 3 | loss: 0.3361389
	speed: 0.0317s/iter; left time: 1263.1445s
	iters: 1500, epoch: 3 | loss: 0.2808879
	speed: 0.0316s/iter; left time: 1258.8137s
	iters: 1600, epoch: 3 | loss: 0.2440000
	speed: 0.0316s/iter; left time: 1253.3153s
	iters: 1700, epoch: 3 | loss: 0.4967689
	speed: 0.0315s/iter; left time: 1244.9433s
	iters: 1800, epoch: 3 | loss: 2.2492943
	speed: 0.0315s/iter; left time: 1244.9863s
	iters: 1900, epoch: 3 | loss: 0.3394456
	speed: 0.0317s/iter; left time: 1246.9829s
	iters: 2000, epoch: 3 | loss: 0.4725381
	speed: 0.0317s/iter; left time: 1244.9798s
	iters: 2100, epoch: 3 | loss: 0.1968734
	speed: 0.0317s/iter; left time: 1239.9749s
	iters: 2200, epoch: 3 | loss: 0.3050468
	speed: 0.0316s/iter; left time: 1235.6531s
Epoch: 3 cost time: 72.445237159729
Epoch: 3, Steps: 2293 | Train Loss: 1.7568509 Vali Loss: 0.6120834 Test Loss: 0.1759569
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.4262214
	speed: 0.1091s/iter; left time: 4243.5699s
	iters: 200, epoch: 4 | loss: 0.4625652
	speed: 0.0318s/iter; left time: 1234.7673s
	iters: 300, epoch: 4 | loss: 0.4659306
	speed: 0.0317s/iter; left time: 1226.3856s
	iters: 400, epoch: 4 | loss: 0.2252111
	speed: 0.0317s/iter; left time: 1221.4375s
	iters: 500, epoch: 4 | loss: 0.7885780
	speed: 0.0317s/iter; left time: 1220.1124s
	iters: 600, epoch: 4 | loss: 0.2572741
	speed: 0.0317s/iter; left time: 1214.9115s
	iters: 700, epoch: 4 | loss: 0.2918352
	speed: 0.0318s/iter; left time: 1216.1743s
	iters: 800, epoch: 4 | loss: 0.3567489
	speed: 0.0317s/iter; left time: 1211.5194s
	iters: 900, epoch: 4 | loss: 0.2830446
	speed: 0.0315s/iter; left time: 1199.2543s
	iters: 1000, epoch: 4 | loss: 0.2109152
	speed: 0.0316s/iter; left time: 1201.1813s
	iters: 1100, epoch: 4 | loss: 0.1866423
	speed: 0.0315s/iter; left time: 1193.0638s
	iters: 1200, epoch: 4 | loss: 0.5959774
	speed: 0.0314s/iter; left time: 1185.9488s
	iters: 1300, epoch: 4 | loss: 0.3139569
	speed: 0.0316s/iter; left time: 1191.8252s
	iters: 1400, epoch: 4 | loss: 0.3263456
	speed: 0.0314s/iter; left time: 1181.0896s
	iters: 1500, epoch: 4 | loss: 0.2450583
	speed: 0.0317s/iter; left time: 1187.6994s
	iters: 1600, epoch: 4 | loss: 0.2523172
	speed: 0.0317s/iter; left time: 1186.2764s
	iters: 1700, epoch: 4 | loss: 0.2550895
	speed: 0.0316s/iter; left time: 1178.2299s
	iters: 1800, epoch: 4 | loss: 0.4945701
	speed: 0.0314s/iter; left time: 1167.5718s
	iters: 1900, epoch: 4 | loss: 1.7814987
	speed: 0.0316s/iter; left time: 1170.9064s
	iters: 2000, epoch: 4 | loss: 0.4853890
	speed: 0.0314s/iter; left time: 1160.5629s
	iters: 2100, epoch: 4 | loss: 0.5336755
	speed: 0.0315s/iter; left time: 1162.1516s
	iters: 2200, epoch: 4 | loss: 1.7335122
	speed: 0.0314s/iter; left time: 1154.4899s
Epoch: 4 cost time: 72.3658766746521
Epoch: 4, Steps: 2293 | Train Loss: 0.6967907 Vali Loss: 0.4259538 Test Loss: 0.1668195
Validation loss decreased (0.448607 --> 0.425954).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.3975748
	speed: 0.1100s/iter; left time: 4025.5441s
	iters: 200, epoch: 5 | loss: 0.3465834
	speed: 0.0316s/iter; left time: 1153.1018s
	iters: 300, epoch: 5 | loss: 0.2584076
	speed: 0.0313s/iter; left time: 1140.7215s
	iters: 400, epoch: 5 | loss: 0.3588941
	speed: 0.0314s/iter; left time: 1140.5989s
	iters: 500, epoch: 5 | loss: 0.2479485
	speed: 0.0315s/iter; left time: 1138.6341s
	iters: 600, epoch: 5 | loss: 0.2970150
	speed: 0.0317s/iter; left time: 1142.6006s
	iters: 700, epoch: 5 | loss: 0.2387118
	speed: 0.0316s/iter; left time: 1136.7767s
	iters: 800, epoch: 5 | loss: 0.3631126
	speed: 0.0316s/iter; left time: 1132.7811s
	iters: 900, epoch: 5 | loss: 0.4438157
	speed: 0.0317s/iter; left time: 1135.1491s
	iters: 1000, epoch: 5 | loss: 0.7405397
	speed: 0.0316s/iter; left time: 1127.1784s
	iters: 1100, epoch: 5 | loss: 0.2349924
	speed: 0.0315s/iter; left time: 1119.3400s
	iters: 1200, epoch: 5 | loss: 0.3358538
	speed: 0.0316s/iter; left time: 1122.5440s
	iters: 1300, epoch: 5 | loss: 0.3530576
	speed: 0.0316s/iter; left time: 1117.6177s
	iters: 1400, epoch: 5 | loss: 0.4554690
	speed: 0.0316s/iter; left time: 1114.6205s
	iters: 1500, epoch: 5 | loss: 1.0465914
	speed: 0.0316s/iter; left time: 1111.4660s
	iters: 1600, epoch: 5 | loss: 0.3229444
	speed: 0.0316s/iter; left time: 1109.5412s
	iters: 1700, epoch: 5 | loss: 0.2645714
	speed: 0.0314s/iter; left time: 1098.8250s
	iters: 1800, epoch: 5 | loss: 0.3324786
	speed: 0.0317s/iter; left time: 1104.9356s
	iters: 1900, epoch: 5 | loss: 0.2540705
	speed: 0.0316s/iter; left time: 1099.1681s
	iters: 2000, epoch: 5 | loss: 0.2656635
	speed: 0.0316s/iter; left time: 1094.4643s
	iters: 2100, epoch: 5 | loss: 0.4914924
	speed: 0.0316s/iter; left time: 1093.3688s
	iters: 2200, epoch: 5 | loss: 0.3539093
	speed: 0.0313s/iter; left time: 1080.1354s
Epoch: 5 cost time: 72.28477191925049
Epoch: 5, Steps: 2293 | Train Loss: 0.5147852 Vali Loss: 0.4225196 Test Loss: 0.1668410
Validation loss decreased (0.425954 --> 0.422520).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.5538096
	speed: 0.1101s/iter; left time: 3774.5470s
	iters: 200, epoch: 6 | loss: 0.3401259
	speed: 0.0316s/iter; left time: 1080.7507s
	iters: 300, epoch: 6 | loss: 2.2467082
	speed: 0.0316s/iter; left time: 1078.7993s
	iters: 400, epoch: 6 | loss: 0.3726420
	speed: 0.0316s/iter; left time: 1073.2842s
	iters: 500, epoch: 6 | loss: 0.3258598
	speed: 0.0316s/iter; left time: 1072.3486s
	iters: 600, epoch: 6 | loss: 0.3705701
	speed: 0.0318s/iter; left time: 1074.6480s
	iters: 700, epoch: 6 | loss: 0.6405500
	speed: 0.0316s/iter; left time: 1064.6892s
	iters: 800, epoch: 6 | loss: 0.4488191
	speed: 0.0317s/iter; left time: 1064.8109s
	iters: 900, epoch: 6 | loss: 0.3553168
	speed: 0.0317s/iter; left time: 1062.8782s
	iters: 1000, epoch: 6 | loss: 0.2863415
	speed: 0.0317s/iter; left time: 1058.0612s
	iters: 1100, epoch: 6 | loss: 0.3042214
	speed: 0.0317s/iter; left time: 1056.6864s
	iters: 1200, epoch: 6 | loss: 0.2430585
	speed: 0.0317s/iter; left time: 1052.5456s
	iters: 1300, epoch: 6 | loss: 0.4623246
	speed: 0.0317s/iter; left time: 1049.4039s
	iters: 1400, epoch: 6 | loss: 1.0155747
	speed: 0.0316s/iter; left time: 1042.9687s
	iters: 1500, epoch: 6 | loss: 0.2709497
	speed: 0.0319s/iter; left time: 1048.8664s
	iters: 1600, epoch: 6 | loss: 0.3950020
	speed: 0.0318s/iter; left time: 1041.3620s
	iters: 1700, epoch: 6 | loss: 0.2777303
	speed: 0.0317s/iter; left time: 1037.8610s
	iters: 1800, epoch: 6 | loss: 0.3461049
	speed: 0.0317s/iter; left time: 1034.0655s
	iters: 1900, epoch: 6 | loss: 0.3825326
	speed: 0.0317s/iter; left time: 1030.9191s
	iters: 2000, epoch: 6 | loss: 0.4179480
	speed: 0.0317s/iter; left time: 1026.5487s
	iters: 2100, epoch: 6 | loss: 0.3767380
	speed: 0.0316s/iter; left time: 1021.8973s
	iters: 2200, epoch: 6 | loss: 0.2599559
	speed: 0.0317s/iter; left time: 1019.7903s
Epoch: 6 cost time: 72.58514976501465
Epoch: 6, Steps: 2293 | Train Loss: 0.4786498 Vali Loss: 0.4586643 Test Loss: 0.1646155
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.2885617
	speed: 0.1104s/iter; left time: 3532.9704s
	iters: 200, epoch: 7 | loss: 0.4014546
	speed: 0.0317s/iter; left time: 1010.4967s
	iters: 300, epoch: 7 | loss: 0.2238663
	speed: 0.0317s/iter; left time: 1008.7886s
	iters: 400, epoch: 7 | loss: 0.4445626
	speed: 0.0316s/iter; left time: 1002.3104s
	iters: 500, epoch: 7 | loss: 0.2598806
	speed: 0.0315s/iter; left time: 996.8274s
	iters: 600, epoch: 7 | loss: 0.1909655
	speed: 0.0318s/iter; left time: 1000.3765s
	iters: 700, epoch: 7 | loss: 0.3653041
	speed: 0.0317s/iter; left time: 995.1425s
	iters: 800, epoch: 7 | loss: 0.4969453
	speed: 0.0316s/iter; left time: 989.3945s
	iters: 900, epoch: 7 | loss: 0.3234806
	speed: 0.0317s/iter; left time: 989.5014s
	iters: 1000, epoch: 7 | loss: 0.2519199
	speed: 0.0317s/iter; left time: 986.5109s
	iters: 1100, epoch: 7 | loss: 0.2471871
	speed: 0.0316s/iter; left time: 979.5137s
	iters: 1200, epoch: 7 | loss: 0.2658006
	speed: 0.0317s/iter; left time: 978.0842s
	iters: 1300, epoch: 7 | loss: 0.3685572
	speed: 0.0315s/iter; left time: 969.3452s
	iters: 1400, epoch: 7 | loss: 0.4488239
	speed: 0.0316s/iter; left time: 969.1564s
	iters: 1500, epoch: 7 | loss: 0.3772503
	speed: 0.0313s/iter; left time: 957.6226s
	iters: 1600, epoch: 7 | loss: 0.3282968
	speed: 0.0315s/iter; left time: 959.9563s
	iters: 1700, epoch: 7 | loss: 0.2601182
	speed: 0.0313s/iter; left time: 953.1298s
	iters: 1800, epoch: 7 | loss: 0.2330184
	speed: 0.0314s/iter; left time: 951.2627s
	iters: 1900, epoch: 7 | loss: 0.4230962
	speed: 0.0315s/iter; left time: 951.0037s
	iters: 2000, epoch: 7 | loss: 0.2092138
	speed: 0.0316s/iter; left time: 950.9380s
	iters: 2100, epoch: 7 | loss: 0.4038453
	speed: 0.0314s/iter; left time: 941.1461s
	iters: 2200, epoch: 7 | loss: 0.2458166
	speed: 0.0317s/iter; left time: 947.1107s
Epoch: 7 cost time: 72.28290939331055
Epoch: 7, Steps: 2293 | Train Loss: 0.4697024 Vali Loss: 0.4206671 Test Loss: 0.1649426
Validation loss decreased (0.422520 --> 0.420667).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.5375582
	speed: 0.1108s/iter; left time: 3291.6226s
	iters: 200, epoch: 8 | loss: 0.3653511
	speed: 0.0318s/iter; left time: 941.9835s
	iters: 300, epoch: 8 | loss: 0.2751762
	speed: 0.0317s/iter; left time: 935.6488s
	iters: 400, epoch: 8 | loss: 0.4940805
	speed: 0.0313s/iter; left time: 920.6610s
	iters: 500, epoch: 8 | loss: 0.3212418
	speed: 0.0316s/iter; left time: 926.4401s
	iters: 600, epoch: 8 | loss: 0.2693989
	speed: 0.0314s/iter; left time: 916.7852s
	iters: 700, epoch: 8 | loss: 0.2848116
	speed: 0.0317s/iter; left time: 922.0630s
	iters: 800, epoch: 8 | loss: 0.2552378
	speed: 0.0318s/iter; left time: 921.8903s
	iters: 900, epoch: 8 | loss: 0.3129424
	speed: 0.0315s/iter; left time: 911.0814s
	iters: 1000, epoch: 8 | loss: 0.4147077
	speed: 0.0315s/iter; left time: 906.9594s
	iters: 1100, epoch: 8 | loss: 0.2349105
	speed: 0.0316s/iter; left time: 907.5133s
	iters: 1200, epoch: 8 | loss: 0.6009172
	speed: 0.0318s/iter; left time: 908.8218s
	iters: 1300, epoch: 8 | loss: 0.3810320
	speed: 0.0316s/iter; left time: 901.0496s
	iters: 1400, epoch: 8 | loss: 0.2654401
	speed: 0.0317s/iter; left time: 900.2513s
	iters: 1500, epoch: 8 | loss: 0.3107937
	speed: 0.0316s/iter; left time: 893.5806s
	iters: 1600, epoch: 8 | loss: 0.4400294
	speed: 0.0317s/iter; left time: 893.1335s
	iters: 1700, epoch: 8 | loss: 0.2268847
	speed: 0.0318s/iter; left time: 893.5084s
	iters: 1800, epoch: 8 | loss: 0.2256558
	speed: 0.0317s/iter; left time: 887.0088s
	iters: 1900, epoch: 8 | loss: 0.6433465
	speed: 0.0317s/iter; left time: 884.4617s
	iters: 2000, epoch: 8 | loss: 0.3207714
	speed: 0.0317s/iter; left time: 880.5562s
	iters: 2100, epoch: 8 | loss: 0.2698102
	speed: 0.0318s/iter; left time: 880.8822s
	iters: 2200, epoch: 8 | loss: 0.2073004
	speed: 0.0316s/iter; left time: 871.4930s
Epoch: 8 cost time: 72.3982481956482
Epoch: 8, Steps: 2293 | Train Loss: 0.4652526 Vali Loss: 0.4200280 Test Loss: 0.1652525
Validation loss decreased (0.420667 --> 0.420028).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.3432902
	speed: 0.1112s/iter; left time: 3049.9803s
	iters: 200, epoch: 9 | loss: 0.3880107
	speed: 0.0316s/iter; left time: 863.3066s
	iters: 300, epoch: 9 | loss: 0.4504188
	speed: 0.0318s/iter; left time: 865.1865s
	iters: 400, epoch: 9 | loss: 0.5931320
	speed: 0.0316s/iter; left time: 857.4817s
	iters: 500, epoch: 9 | loss: 0.2563318
	speed: 0.0316s/iter; left time: 855.0223s
	iters: 600, epoch: 9 | loss: 0.3972129
	speed: 0.0314s/iter; left time: 845.6339s
	iters: 700, epoch: 9 | loss: 0.6503346
	speed: 0.0317s/iter; left time: 848.7975s
	iters: 800, epoch: 9 | loss: 0.3032540
	speed: 0.0317s/iter; left time: 845.9743s
	iters: 900, epoch: 9 | loss: 0.4450267
	speed: 0.0318s/iter; left time: 845.7347s
	iters: 1000, epoch: 9 | loss: 0.3216125
	speed: 0.0316s/iter; left time: 837.6639s
	iters: 1100, epoch: 9 | loss: 0.2839829
	speed: 0.0317s/iter; left time: 838.3598s
	iters: 1200, epoch: 9 | loss: 0.7516296
	speed: 0.0316s/iter; left time: 831.2733s
	iters: 1300, epoch: 9 | loss: 0.3228161
	speed: 0.0317s/iter; left time: 830.1455s
	iters: 1400, epoch: 9 | loss: 0.2131688
	speed: 0.0316s/iter; left time: 824.1841s
	iters: 1500, epoch: 9 | loss: 0.6654689
	speed: 0.0316s/iter; left time: 821.9417s
	iters: 1600, epoch: 9 | loss: 0.2158930
	speed: 0.0317s/iter; left time: 821.9470s
	iters: 1700, epoch: 9 | loss: 0.3974244
	speed: 0.0318s/iter; left time: 820.2446s
	iters: 1800, epoch: 9 | loss: 0.2481426
	speed: 0.0318s/iter; left time: 816.7569s
	iters: 1900, epoch: 9 | loss: 0.7513977
	speed: 0.0317s/iter; left time: 811.0060s
	iters: 2000, epoch: 9 | loss: 0.3711349
	speed: 0.0317s/iter; left time: 807.9455s
	iters: 2100, epoch: 9 | loss: 0.3207087
	speed: 0.0316s/iter; left time: 803.9855s
	iters: 2200, epoch: 9 | loss: 0.4473546
	speed: 0.0313s/iter; left time: 792.4972s
Epoch: 9 cost time: 72.41049313545227
Epoch: 9, Steps: 2293 | Train Loss: 0.4635569 Vali Loss: 0.4199117 Test Loss: 0.1644411
Validation loss decreased (0.420028 --> 0.419912).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.3421857
	speed: 0.1111s/iter; left time: 2791.7168s
	iters: 200, epoch: 10 | loss: 0.3143543
	speed: 0.0317s/iter; left time: 793.4557s
	iters: 300, epoch: 10 | loss: 0.2487102
	speed: 0.0316s/iter; left time: 786.6399s
	iters: 400, epoch: 10 | loss: 0.2248585
	speed: 0.0316s/iter; left time: 783.2938s
	iters: 500, epoch: 10 | loss: 0.3571646
	speed: 0.0317s/iter; left time: 784.1611s
	iters: 600, epoch: 10 | loss: 0.1791153
	speed: 0.0316s/iter; left time: 777.0577s
	iters: 700, epoch: 10 | loss: 0.2717441
	speed: 0.0317s/iter; left time: 776.2641s
	iters: 800, epoch: 10 | loss: 0.4568290
	speed: 0.0317s/iter; left time: 773.2170s
	iters: 900, epoch: 10 | loss: 0.2732991
	speed: 0.0315s/iter; left time: 766.4273s
	iters: 1000, epoch: 10 | loss: 0.5564133
	speed: 0.0318s/iter; left time: 771.0357s
	iters: 1100, epoch: 10 | loss: 0.2876152
	speed: 0.0317s/iter; left time: 764.9755s
	iters: 1200, epoch: 10 | loss: 0.3321496
	speed: 0.0317s/iter; left time: 761.1752s
	iters: 1300, epoch: 10 | loss: 2.2093883
	speed: 0.0317s/iter; left time: 757.4751s
	iters: 1400, epoch: 10 | loss: 0.2345974
	speed: 0.0316s/iter; left time: 753.8770s
	iters: 1500, epoch: 10 | loss: 0.3596341
	speed: 0.0315s/iter; left time: 747.5068s
	iters: 1600, epoch: 10 | loss: 0.3377204
	speed: 0.0315s/iter; left time: 744.8923s
	iters: 1700, epoch: 10 | loss: 0.4790419
	speed: 0.0316s/iter; left time: 743.2857s
	iters: 1800, epoch: 10 | loss: 0.2713208
	speed: 0.0314s/iter; left time: 735.2633s
	iters: 1900, epoch: 10 | loss: 0.6827036
	speed: 0.0313s/iter; left time: 730.2562s
	iters: 2000, epoch: 10 | loss: 0.2190252
	speed: 0.0314s/iter; left time: 729.5237s
	iters: 2100, epoch: 10 | loss: 0.3722559
	speed: 0.0315s/iter; left time: 729.0830s
	iters: 2200, epoch: 10 | loss: 1.2174555
	speed: 0.0311s/iter; left time: 716.6643s
Epoch: 10 cost time: 72.24003887176514
Epoch: 10, Steps: 2293 | Train Loss: 0.4625572 Vali Loss: 0.4213225 Test Loss: 0.1644956
EarlyStopping counter: 1 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 2.3573613
	speed: 0.1103s/iter; left time: 2518.0942s
	iters: 200, epoch: 11 | loss: 0.3303297
	speed: 0.0315s/iter; left time: 716.1416s
	iters: 300, epoch: 11 | loss: 0.2633117
	speed: 0.0315s/iter; left time: 713.7474s
	iters: 400, epoch: 11 | loss: 0.3204545
	speed: 0.0315s/iter; left time: 710.2760s
	iters: 500, epoch: 11 | loss: 0.3753093
	speed: 0.0316s/iter; left time: 709.5218s
	iters: 600, epoch: 11 | loss: 0.3955533
	speed: 0.0316s/iter; left time: 706.2939s
	iters: 700, epoch: 11 | loss: 0.3760301
	speed: 0.0316s/iter; left time: 701.9738s
	iters: 800, epoch: 11 | loss: 0.2510645
	speed: 0.0315s/iter; left time: 696.1697s
	iters: 900, epoch: 11 | loss: 0.2134547
	speed: 0.0320s/iter; left time: 704.0242s
	iters: 1000, epoch: 11 | loss: 0.3479936
	speed: 0.0318s/iter; left time: 697.6113s
	iters: 1100, epoch: 11 | loss: 0.2485259
	speed: 0.0318s/iter; left time: 693.3504s
	iters: 1200, epoch: 11 | loss: 0.2020221
	speed: 0.0317s/iter; left time: 689.6589s
	iters: 1300, epoch: 11 | loss: 0.4528276
	speed: 0.0317s/iter; left time: 686.6492s
	iters: 1400, epoch: 11 | loss: 1.0030750
	speed: 0.0319s/iter; left time: 687.3502s
	iters: 1500, epoch: 11 | loss: 0.2936973
	speed: 0.0317s/iter; left time: 678.4260s
	iters: 1600, epoch: 11 | loss: 0.3211731
	speed: 0.0316s/iter; left time: 674.0127s
	iters: 1700, epoch: 11 | loss: 0.3343485
	speed: 0.0316s/iter; left time: 670.4041s
	iters: 1800, epoch: 11 | loss: 0.4485539
	speed: 0.0318s/iter; left time: 671.6347s
	iters: 1900, epoch: 11 | loss: 0.2769799
	speed: 0.0317s/iter; left time: 666.5900s
	iters: 2000, epoch: 11 | loss: 0.3100617
	speed: 0.0316s/iter; left time: 661.3625s
	iters: 2100, epoch: 11 | loss: 0.3641111
	speed: 0.0317s/iter; left time: 659.3635s
	iters: 2200, epoch: 11 | loss: 0.3468928
	speed: 0.0313s/iter; left time: 647.8916s
Epoch: 11 cost time: 72.4184205532074
Epoch: 11, Steps: 2293 | Train Loss: 0.4619407 Vali Loss: 0.4201174 Test Loss: 0.1645349
EarlyStopping counter: 2 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.2575094
	speed: 0.1097s/iter; left time: 2252.3426s
	iters: 200, epoch: 12 | loss: 0.5811068
	speed: 0.0316s/iter; left time: 646.3738s
	iters: 300, epoch: 12 | loss: 0.3090008
	speed: 0.0316s/iter; left time: 642.2838s
	iters: 400, epoch: 12 | loss: 0.4118954
	speed: 0.0316s/iter; left time: 639.5771s
	iters: 500, epoch: 12 | loss: 0.2807504
	speed: 0.0315s/iter; left time: 633.3736s
	iters: 600, epoch: 12 | loss: 0.1955006
	speed: 0.0315s/iter; left time: 631.8020s
	iters: 700, epoch: 12 | loss: 0.5149121
	speed: 0.0315s/iter; left time: 627.4076s
	iters: 800, epoch: 12 | loss: 0.2908435
	speed: 0.0316s/iter; left time: 627.5758s
	iters: 900, epoch: 12 | loss: 0.4709978
	speed: 0.0315s/iter; left time: 622.4521s
	iters: 1000, epoch: 12 | loss: 0.4369598
	speed: 0.0316s/iter; left time: 620.3941s
	iters: 1100, epoch: 12 | loss: 0.2052678
	speed: 0.0316s/iter; left time: 616.8354s
	iters: 1200, epoch: 12 | loss: 0.2389296
	speed: 0.0316s/iter; left time: 613.6728s
	iters: 1300, epoch: 12 | loss: 0.2094866
	speed: 0.0315s/iter; left time: 609.8161s
	iters: 1400, epoch: 12 | loss: 0.6855643
	speed: 0.0318s/iter; left time: 611.7189s
	iters: 1500, epoch: 12 | loss: 0.5811912
	speed: 0.0317s/iter; left time: 606.0906s
	iters: 1600, epoch: 12 | loss: 0.4867798
	speed: 0.0317s/iter; left time: 602.7508s
	iters: 1700, epoch: 12 | loss: 0.2709420
	speed: 0.0316s/iter; left time: 597.9117s
	iters: 1800, epoch: 12 | loss: 0.2912193
	speed: 0.0315s/iter; left time: 593.4383s
	iters: 1900, epoch: 12 | loss: 0.3364927
	speed: 0.0316s/iter; left time: 591.8051s
	iters: 2000, epoch: 12 | loss: 0.3691350
	speed: 0.0316s/iter; left time: 588.3395s
	iters: 2100, epoch: 12 | loss: 0.3689477
	speed: 0.0315s/iter; left time: 584.5608s
	iters: 2200, epoch: 12 | loss: 0.2378930
	speed: 0.0308s/iter; left time: 567.7524s
Epoch: 12 cost time: 72.16221189498901
Epoch: 12, Steps: 2293 | Train Loss: 0.4617982 Vali Loss: 0.4203665 Test Loss: 0.1645213
EarlyStopping counter: 3 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.3235593
	speed: 0.1106s/iter; left time: 2017.8027s
	iters: 200, epoch: 13 | loss: 0.3255602
	speed: 0.0316s/iter; left time: 572.6837s
	iters: 300, epoch: 13 | loss: 0.6849028
	speed: 0.0317s/iter; left time: 571.6238s
	iters: 400, epoch: 13 | loss: 0.3410951
	speed: 0.0316s/iter; left time: 567.0819s
	iters: 500, epoch: 13 | loss: 0.3427399
	speed: 0.0317s/iter; left time: 564.8825s
	iters: 600, epoch: 13 | loss: 0.3762536
	speed: 0.0317s/iter; left time: 562.4440s
	iters: 700, epoch: 13 | loss: 0.2520194
	speed: 0.0317s/iter; left time: 558.4889s
	iters: 800, epoch: 13 | loss: 0.1644288
	speed: 0.0316s/iter; left time: 554.3627s
	iters: 900, epoch: 13 | loss: 0.2624229
	speed: 0.0318s/iter; left time: 554.1902s
	iters: 1000, epoch: 13 | loss: 0.3520116
	speed: 0.0315s/iter; left time: 546.9477s
	iters: 1100, epoch: 13 | loss: 1.2226223
	speed: 0.0316s/iter; left time: 545.7096s
	iters: 1200, epoch: 13 | loss: 0.3249696
	speed: 0.0316s/iter; left time: 541.3794s
	iters: 1300, epoch: 13 | loss: 0.7235427
	speed: 0.0317s/iter; left time: 539.6332s
	iters: 1400, epoch: 13 | loss: 0.5065444
	speed: 0.0316s/iter; left time: 535.8687s
	iters: 1500, epoch: 13 | loss: 0.4724769
	speed: 0.0318s/iter; left time: 535.1192s
	iters: 1600, epoch: 13 | loss: 0.3154714
	speed: 0.0317s/iter; left time: 531.0092s
	iters: 1700, epoch: 13 | loss: 0.3310683
	speed: 0.0316s/iter; left time: 526.6009s
	iters: 1800, epoch: 13 | loss: 2.1584399
	speed: 0.0316s/iter; left time: 522.1747s
	iters: 1900, epoch: 13 | loss: 0.3554067
	speed: 0.0315s/iter; left time: 518.8312s
	iters: 2000, epoch: 13 | loss: 0.3144536
	speed: 0.0314s/iter; left time: 513.2696s
	iters: 2100, epoch: 13 | loss: 0.4408322
	speed: 0.0316s/iter; left time: 513.6062s
	iters: 2200, epoch: 13 | loss: 0.2904882
	speed: 0.0309s/iter; left time: 498.5847s
Epoch: 13 cost time: 72.28778767585754
Epoch: 13, Steps: 2293 | Train Loss: 0.4617215 Vali Loss: 0.4200252 Test Loss: 0.1644907
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.3792279
	speed: 0.1103s/iter; left time: 1759.9193s
	iters: 200, epoch: 14 | loss: 0.2816505
	speed: 0.0315s/iter; left time: 500.1226s
	iters: 300, epoch: 14 | loss: 0.3933083
	speed: 0.0315s/iter; left time: 496.2722s
	iters: 400, epoch: 14 | loss: 2.3763812
	speed: 0.0315s/iter; left time: 493.1537s
	iters: 500, epoch: 14 | loss: 0.4158353
	speed: 0.0316s/iter; left time: 491.8552s
	iters: 600, epoch: 14 | loss: 0.2151092
	speed: 0.0315s/iter; left time: 486.3177s
	iters: 700, epoch: 14 | loss: 0.5535632
	speed: 0.0313s/iter; left time: 480.8639s
	iters: 800, epoch: 14 | loss: 0.2601531
	speed: 0.0314s/iter; left time: 479.0937s
	iters: 900, epoch: 14 | loss: 1.5156858
	speed: 0.0316s/iter; left time: 478.8407s
	iters: 1000, epoch: 14 | loss: 0.2592620
	speed: 0.0315s/iter; left time: 473.7182s
	iters: 1100, epoch: 14 | loss: 0.6865833
	speed: 0.0316s/iter; left time: 472.2075s
	iters: 1200, epoch: 14 | loss: 0.6062507
	speed: 0.0315s/iter; left time: 467.3362s
	iters: 1300, epoch: 14 | loss: 0.7704839
	speed: 0.0316s/iter; left time: 466.5167s
	iters: 1400, epoch: 14 | loss: 0.4143547
	speed: 0.0315s/iter; left time: 461.5855s
	iters: 1500, epoch: 14 | loss: 0.2266332
	speed: 0.0316s/iter; left time: 459.7406s
	iters: 1600, epoch: 14 | loss: 0.2558098
	speed: 0.0317s/iter; left time: 457.6029s
	iters: 1700, epoch: 14 | loss: 0.5052826
	speed: 0.0317s/iter; left time: 454.8498s
	iters: 1800, epoch: 14 | loss: 0.2293554
	speed: 0.0316s/iter; left time: 450.2052s
	iters: 1900, epoch: 14 | loss: 0.3195543
	speed: 0.0317s/iter; left time: 448.6853s
	iters: 2000, epoch: 14 | loss: 0.5069367
	speed: 0.0315s/iter; left time: 442.8968s
	iters: 2100, epoch: 14 | loss: 0.6427902
	speed: 0.0316s/iter; left time: 441.5113s
	iters: 2200, epoch: 14 | loss: 0.2781103
	speed: 0.0306s/iter; left time: 423.8468s
Epoch: 14 cost time: 72.06925225257874
Epoch: 14, Steps: 2293 | Train Loss: 0.4614322 Vali Loss: 0.4203329 Test Loss: 0.1645041
EarlyStopping counter: 5 out of 5
Early stopping
Total training time: 1088.5927 seconds
>>>>>>>testing : weather_96_96_NLinear_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15349<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
mse:0.16448864340782166, mae:0.20908533036708832
