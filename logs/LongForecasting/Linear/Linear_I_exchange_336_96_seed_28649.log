Args in experiment:
Namespace(activation='gelu', batch_size=8, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='exchange_rate.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=8, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='mse', lradj='type1', model='Linear', model_id='Exchange_336_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=28649, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : Exchange_336_96_Linear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed28649>>>>>>>>>>>>>>>>>>>>>>>>>>
train 4880
val 665
test 1422
	iters: 100, epoch: 1 | loss: 0.1227781
	speed: 0.0028s/iter; left time: 33.5197s
	iters: 200, epoch: 1 | loss: 0.0828126
	speed: 0.0027s/iter; left time: 32.4252s
	iters: 300, epoch: 1 | loss: 0.2263111
	speed: 0.0027s/iter; left time: 32.0138s
	iters: 400, epoch: 1 | loss: 0.1001227
	speed: 0.0033s/iter; left time: 38.4484s
	iters: 500, epoch: 1 | loss: 0.1129984
	speed: 0.0033s/iter; left time: 38.0286s
	iters: 600, epoch: 1 | loss: 0.1167091
	speed: 0.0029s/iter; left time: 33.0814s
Epoch: 1 cost time: 1.7811565399169922
Epoch: 1, Steps: 610 | Train Loss: 0.1669721 Vali Loss: 0.2358811 Test Loss: 0.1027872
Validation loss decreased (inf --> 0.235881).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.0768981
	speed: 0.0048s/iter; left time: 54.7004s
	iters: 200, epoch: 2 | loss: 0.2700852
	speed: 0.0030s/iter; left time: 34.5396s
	iters: 300, epoch: 2 | loss: 0.1002728
	speed: 0.0024s/iter; left time: 27.5503s
	iters: 400, epoch: 2 | loss: 0.1027947
	speed: 0.0026s/iter; left time: 28.6489s
	iters: 500, epoch: 2 | loss: 0.1353316
	speed: 0.0026s/iter; left time: 28.8365s
	iters: 600, epoch: 2 | loss: 0.1073120
	speed: 0.0026s/iter; left time: 28.2640s
Epoch: 2 cost time: 1.655433177947998
Epoch: 2, Steps: 610 | Train Loss: 0.1285399 Vali Loss: 0.3058902 Test Loss: 0.1245403
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1680426
	speed: 0.0045s/iter; left time: 48.6414s
	iters: 200, epoch: 3 | loss: 0.1145010
	speed: 0.0026s/iter; left time: 28.4617s
	iters: 300, epoch: 3 | loss: 0.0966835
	speed: 0.0026s/iter; left time: 28.2223s
	iters: 400, epoch: 3 | loss: 0.1011777
	speed: 0.0032s/iter; left time: 33.3303s
	iters: 500, epoch: 3 | loss: 0.0890693
	speed: 0.0028s/iter; left time: 29.3518s
	iters: 600, epoch: 3 | loss: 0.1145124
	speed: 0.0027s/iter; left time: 28.4439s
Epoch: 3 cost time: 1.6962788105010986
Epoch: 3, Steps: 610 | Train Loss: 0.1203271 Vali Loss: 0.2435638 Test Loss: 0.1044840
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.0923176
	speed: 0.0045s/iter; left time: 46.6501s
	iters: 200, epoch: 4 | loss: 0.0880382
	speed: 0.0030s/iter; left time: 30.7162s
	iters: 300, epoch: 4 | loss: 0.1419870
	speed: 0.0028s/iter; left time: 28.0025s
	iters: 400, epoch: 4 | loss: 0.0750470
	speed: 0.0030s/iter; left time: 29.6402s
	iters: 500, epoch: 4 | loss: 0.1605671
	speed: 0.0025s/iter; left time: 24.4801s
	iters: 600, epoch: 4 | loss: 0.0624286
	speed: 0.0025s/iter; left time: 24.3298s
Epoch: 4 cost time: 1.6773147583007812
Epoch: 4, Steps: 610 | Train Loss: 0.1164935 Vali Loss: 0.2268671 Test Loss: 0.1057121
Validation loss decreased (0.235881 --> 0.226867).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0966403
	speed: 0.0040s/iter; left time: 38.3695s
	iters: 200, epoch: 5 | loss: 0.1433992
	speed: 0.0029s/iter; left time: 27.8271s
	iters: 300, epoch: 5 | loss: 0.1066120
	speed: 0.0029s/iter; left time: 27.2476s
	iters: 400, epoch: 5 | loss: 0.1575008
	speed: 0.0027s/iter; left time: 25.2747s
	iters: 500, epoch: 5 | loss: 0.0766793
	speed: 0.0030s/iter; left time: 27.4121s
	iters: 600, epoch: 5 | loss: 0.1089515
	speed: 0.0031s/iter; left time: 28.8569s
Epoch: 5 cost time: 1.7492001056671143
Epoch: 5, Steps: 610 | Train Loss: 0.1148863 Vali Loss: 0.2138248 Test Loss: 0.0934407
Validation loss decreased (0.226867 --> 0.213825).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1521414
	speed: 0.0052s/iter; left time: 46.9919s
	iters: 200, epoch: 6 | loss: 0.0727409
	speed: 0.0033s/iter; left time: 29.7174s
	iters: 300, epoch: 6 | loss: 0.0964381
	speed: 0.0036s/iter; left time: 31.5093s
	iters: 400, epoch: 6 | loss: 0.1126437
	speed: 0.0032s/iter; left time: 28.3748s
	iters: 500, epoch: 6 | loss: 0.0736473
	speed: 0.0035s/iter; left time: 30.4515s
	iters: 600, epoch: 6 | loss: 0.1814611
	speed: 0.0032s/iter; left time: 27.4487s
Epoch: 6 cost time: 2.031433582305908
Epoch: 6, Steps: 610 | Train Loss: 0.1141684 Vali Loss: 0.2191612 Test Loss: 0.0931648
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.0499786
	speed: 0.0050s/iter; left time: 41.8098s
	iters: 200, epoch: 7 | loss: 0.2423320
	speed: 0.0025s/iter; left time: 21.0194s
	iters: 300, epoch: 7 | loss: 0.0899207
	speed: 0.0028s/iter; left time: 22.6628s
	iters: 400, epoch: 7 | loss: 0.0949077
	speed: 0.0026s/iter; left time: 21.5160s
	iters: 500, epoch: 7 | loss: 0.0914657
	speed: 0.0033s/iter; left time: 26.7767s
	iters: 600, epoch: 7 | loss: 0.1454002
	speed: 0.0029s/iter; left time: 23.1917s
Epoch: 7 cost time: 1.74839448928833
Epoch: 7, Steps: 610 | Train Loss: 0.1136717 Vali Loss: 0.2084694 Test Loss: 0.0905803
Validation loss decreased (0.213825 --> 0.208469).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.0732086
	speed: 0.0042s/iter; left time: 32.8175s
	iters: 200, epoch: 8 | loss: 0.0863305
	speed: 0.0033s/iter; left time: 25.8987s
	iters: 300, epoch: 8 | loss: 0.1216786
	speed: 0.0033s/iter; left time: 24.8008s
	iters: 400, epoch: 8 | loss: 0.2027915
	speed: 0.0031s/iter; left time: 23.3625s
	iters: 500, epoch: 8 | loss: 0.1601340
	speed: 0.0033s/iter; left time: 24.6710s
	iters: 600, epoch: 8 | loss: 0.1047583
	speed: 0.0033s/iter; left time: 23.9722s
Epoch: 8 cost time: 1.9352846145629883
Epoch: 8, Steps: 610 | Train Loss: 0.1133766 Vali Loss: 0.2123417 Test Loss: 0.0933431
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.0766415
	speed: 0.0050s/iter; left time: 36.2615s
	iters: 200, epoch: 9 | loss: 0.1558882
	speed: 0.0033s/iter; left time: 23.4772s
	iters: 300, epoch: 9 | loss: 0.0749937
	speed: 0.0031s/iter; left time: 21.7652s
	iters: 400, epoch: 9 | loss: 0.0608804
	speed: 0.0031s/iter; left time: 21.6100s
	iters: 500, epoch: 9 | loss: 0.0951102
	speed: 0.0031s/iter; left time: 21.0086s
	iters: 600, epoch: 9 | loss: 0.0629879
	speed: 0.0030s/iter; left time: 20.4338s
Epoch: 9 cost time: 1.8589563369750977
Epoch: 9, Steps: 610 | Train Loss: 0.1132632 Vali Loss: 0.2074041 Test Loss: 0.0921447
Validation loss decreased (0.208469 --> 0.207404).  Saving model ...
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.1520238
	speed: 0.0055s/iter; left time: 36.0452s
	iters: 200, epoch: 10 | loss: 0.0864725
	speed: 0.0034s/iter; left time: 22.3314s
	iters: 300, epoch: 10 | loss: 0.0608030
	speed: 0.0034s/iter; left time: 21.8724s
	iters: 400, epoch: 10 | loss: 0.1146993
	speed: 0.0034s/iter; left time: 21.6483s
	iters: 500, epoch: 10 | loss: 0.0909865
	speed: 0.0034s/iter; left time: 21.3658s
	iters: 600, epoch: 10 | loss: 0.0904887
	speed: 0.0032s/iter; left time: 19.5078s
Epoch: 10 cost time: 2.0534000396728516
Epoch: 10, Steps: 610 | Train Loss: 0.1132059 Vali Loss: 0.2114386 Test Loss: 0.0923458
EarlyStopping counter: 1 out of 5
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 11 | loss: 0.1578347
	speed: 0.0051s/iter; left time: 30.4870s
	iters: 200, epoch: 11 | loss: 0.1180211
	speed: 0.0031s/iter; left time: 18.2476s
	iters: 300, epoch: 11 | loss: 0.0966835
	speed: 0.0031s/iter; left time: 17.9921s
	iters: 400, epoch: 11 | loss: 0.0949525
	speed: 0.0033s/iter; left time: 18.5853s
	iters: 500, epoch: 11 | loss: 0.1583947
	speed: 0.0030s/iter; left time: 16.8061s
	iters: 600, epoch: 11 | loss: 0.0788106
	speed: 0.0029s/iter; left time: 15.9674s
Epoch: 11 cost time: 1.8697354793548584
Epoch: 11, Steps: 610 | Train Loss: 0.1131711 Vali Loss: 0.2099020 Test Loss: 0.0918724
EarlyStopping counter: 2 out of 5
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 12 | loss: 0.0770305
	speed: 0.0048s/iter; left time: 25.9306s
	iters: 200, epoch: 12 | loss: 0.1578315
	speed: 0.0024s/iter; left time: 12.6455s
	iters: 300, epoch: 12 | loss: 0.0768328
	speed: 0.0024s/iter; left time: 12.4168s
	iters: 400, epoch: 12 | loss: 0.0680285
	speed: 0.0024s/iter; left time: 12.0672s
	iters: 500, epoch: 12 | loss: 0.0966485
	speed: 0.0023s/iter; left time: 11.7288s
	iters: 600, epoch: 12 | loss: 0.0700653
	speed: 0.0024s/iter; left time: 11.5428s
Epoch: 12 cost time: 1.480224370956421
Epoch: 12, Steps: 610 | Train Loss: 0.1131458 Vali Loss: 0.2099142 Test Loss: 0.0919283
EarlyStopping counter: 3 out of 5
Updating learning rate to 2.44140625e-07
	iters: 100, epoch: 13 | loss: 0.0985402
	speed: 0.0040s/iter; left time: 18.9145s
	iters: 200, epoch: 13 | loss: 0.0905746
	speed: 0.0024s/iter; left time: 11.2812s
	iters: 300, epoch: 13 | loss: 0.1364509
	speed: 0.0024s/iter; left time: 10.9945s
	iters: 400, epoch: 13 | loss: 0.1225022
	speed: 0.0023s/iter; left time: 10.5303s
	iters: 500, epoch: 13 | loss: 0.1089740
	speed: 0.0024s/iter; left time: 10.3052s
	iters: 600, epoch: 13 | loss: 0.0951224
	speed: 0.0024s/iter; left time: 10.0604s
Epoch: 13 cost time: 1.4508428573608398
Epoch: 13, Steps: 610 | Train Loss: 0.1131352 Vali Loss: 0.2098482 Test Loss: 0.0919185
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.220703125e-07
	iters: 100, epoch: 14 | loss: 0.0627716
	speed: 0.0036s/iter; left time: 15.0573s
	iters: 200, epoch: 14 | loss: 0.1193946
	speed: 0.0019s/iter; left time: 7.7769s
	iters: 300, epoch: 14 | loss: 0.2845298
	speed: 0.0019s/iter; left time: 7.5499s
	iters: 400, epoch: 14 | loss: 0.0873978
	speed: 0.0019s/iter; left time: 7.3936s
	iters: 500, epoch: 14 | loss: 0.0885853
	speed: 0.0019s/iter; left time: 7.1649s
	iters: 600, epoch: 14 | loss: 0.0820354
	speed: 0.0019s/iter; left time: 7.0116s
Epoch: 14 cost time: 1.182157039642334
Epoch: 14, Steps: 610 | Train Loss: 0.1131295 Vali Loss: 0.2095656 Test Loss: 0.0919078
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : Exchange_336_96_Linear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed28649<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 1422
mse:0.09202495962381363, mae:0.22286012768745422
