Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='NLinear', model_id='ETTm2_96_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=15349, seq_len=96, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTm2_96_96_NLinear_ETTm2_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15349>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34369
data_set:  <data_provider.data_loader.Dataset_ETT_minute object at 0x000002CC3B020D68>
val 11425
data_set:  <data_provider.data_loader.Dataset_ETT_minute object at 0x000002CC08626DD8>
test 11425
data_set:  <data_provider.data_loader.Dataset_ETT_minute object at 0x000002CC3B020128>
Total number of trainable parameters: 65184
Total number of parameters: 65184
	iters: 100, epoch: 1 | loss: 0.2558899
	speed: 0.0041s/iter; left time: 86.8890s
	iters: 200, epoch: 1 | loss: 0.2080970
	speed: 0.0033s/iter; left time: 69.8042s
	iters: 300, epoch: 1 | loss: 0.1446681
	speed: 0.0030s/iter; left time: 62.8917s
	iters: 400, epoch: 1 | loss: 0.2140923
	speed: 0.0038s/iter; left time: 79.6329s
	iters: 500, epoch: 1 | loss: 0.3468614
	speed: 0.0043s/iter; left time: 89.8805s
	iters: 600, epoch: 1 | loss: 0.3036821
	speed: 0.0038s/iter; left time: 79.3947s
	iters: 700, epoch: 1 | loss: 0.1614911
	speed: 0.0036s/iter; left time: 75.2695s
	iters: 800, epoch: 1 | loss: 0.1738378
	speed: 0.0038s/iter; left time: 78.6120s
	iters: 900, epoch: 1 | loss: 0.3422405
	speed: 0.0041s/iter; left time: 84.7155s
	iters: 1000, epoch: 1 | loss: 0.1655320
	speed: 0.0036s/iter; left time: 74.3243s
Epoch: 1 cost time: 4.000320911407471
Epoch: 1, Steps: 1074 | Train Loss: 0.2730345 Vali Loss: 0.1362415 Test Loss: 0.1966496
Validation loss decreased (inf --> 0.136241).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.2589672
	speed: 0.0162s/iter; left time: 329.9337s
	iters: 200, epoch: 2 | loss: 0.1888332
	speed: 0.0033s/iter; left time: 67.0515s
	iters: 300, epoch: 2 | loss: 0.1758956
	speed: 0.0033s/iter; left time: 66.7831s
	iters: 400, epoch: 2 | loss: 0.5637578
	speed: 0.0035s/iter; left time: 69.6630s
	iters: 500, epoch: 2 | loss: 0.3656266
	speed: 0.0036s/iter; left time: 72.4797s
	iters: 600, epoch: 2 | loss: 0.4162877
	speed: 0.0037s/iter; left time: 74.0933s
	iters: 700, epoch: 2 | loss: 0.2679579
	speed: 0.0032s/iter; left time: 63.4613s
	iters: 800, epoch: 2 | loss: 0.1952919
	speed: 0.0030s/iter; left time: 59.3827s
	iters: 900, epoch: 2 | loss: 0.2090395
	speed: 0.0033s/iter; left time: 63.9828s
	iters: 1000, epoch: 2 | loss: 0.2587521
	speed: 0.0033s/iter; left time: 63.6670s
Epoch: 2 cost time: 3.5629630088806152
Epoch: 2, Steps: 1074 | Train Loss: 0.2661851 Vali Loss: 0.1571146 Test Loss: 0.2124687
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.2217799
	speed: 0.0163s/iter; left time: 312.5485s
	iters: 200, epoch: 3 | loss: 0.1642116
	speed: 0.0025s/iter; left time: 47.8607s
	iters: 300, epoch: 3 | loss: 0.3473255
	speed: 0.0042s/iter; left time: 79.6113s
	iters: 400, epoch: 3 | loss: 0.1792642
	speed: 0.0031s/iter; left time: 57.7462s
	iters: 500, epoch: 3 | loss: 0.3231858
	speed: 0.0041s/iter; left time: 77.5004s
	iters: 600, epoch: 3 | loss: 0.3044758
	speed: 0.0041s/iter; left time: 77.0886s
	iters: 700, epoch: 3 | loss: 0.1248011
	speed: 0.0036s/iter; left time: 67.1025s
	iters: 800, epoch: 3 | loss: 0.1365518
	speed: 0.0041s/iter; left time: 76.7078s
	iters: 900, epoch: 3 | loss: 0.3869795
	speed: 0.0043s/iter; left time: 79.1819s
	iters: 1000, epoch: 3 | loss: 0.1914591
	speed: 0.0038s/iter; left time: 68.7800s
Epoch: 3 cost time: 3.9376862049102783
Epoch: 3, Steps: 1074 | Train Loss: 0.2451323 Vali Loss: 0.1320873 Test Loss: 0.1881993
Validation loss decreased (0.136241 --> 0.132087).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.4429133
	speed: 0.0175s/iter; left time: 317.7200s
	iters: 200, epoch: 4 | loss: 0.3122338
	speed: 0.0031s/iter; left time: 56.5147s
	iters: 300, epoch: 4 | loss: 0.1454244
	speed: 0.0042s/iter; left time: 75.7597s
	iters: 400, epoch: 4 | loss: 0.1676175
	speed: 0.0030s/iter; left time: 53.1665s
	iters: 500, epoch: 4 | loss: 0.2462134
	speed: 0.0033s/iter; left time: 58.9888s
	iters: 600, epoch: 4 | loss: 0.2002857
	speed: 0.0035s/iter; left time: 62.5406s
	iters: 700, epoch: 4 | loss: 0.2558205
	speed: 0.0031s/iter; left time: 54.9157s
	iters: 800, epoch: 4 | loss: 0.2540783
	speed: 0.0038s/iter; left time: 65.4950s
	iters: 900, epoch: 4 | loss: 0.1350731
	speed: 0.0038s/iter; left time: 66.4302s
	iters: 1000, epoch: 4 | loss: 0.1484690
	speed: 0.0031s/iter; left time: 53.8548s
Epoch: 4 cost time: 3.800712823867798
Epoch: 4, Steps: 1074 | Train Loss: 0.2378918 Vali Loss: 0.1306394 Test Loss: 0.1816376
Validation loss decreased (0.132087 --> 0.130639).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.1574842
	speed: 0.0185s/iter; left time: 316.0982s
	iters: 200, epoch: 5 | loss: 0.2062129
	speed: 0.0035s/iter; left time: 59.0300s
	iters: 300, epoch: 5 | loss: 0.4119017
	speed: 0.0046s/iter; left time: 77.5756s
	iters: 400, epoch: 5 | loss: 0.2659591
	speed: 0.0038s/iter; left time: 63.7789s
	iters: 500, epoch: 5 | loss: 0.5309084
	speed: 0.0035s/iter; left time: 57.7574s
	iters: 600, epoch: 5 | loss: 0.1688954
	speed: 0.0038s/iter; left time: 62.1964s
	iters: 700, epoch: 5 | loss: 0.6021286
	speed: 0.0030s/iter; left time: 48.8920s
	iters: 800, epoch: 5 | loss: 0.2712144
	speed: 0.0027s/iter; left time: 43.5476s
	iters: 900, epoch: 5 | loss: 0.2592098
	speed: 0.0028s/iter; left time: 45.7984s
	iters: 1000, epoch: 5 | loss: 0.1280544
	speed: 0.0042s/iter; left time: 68.2937s
Epoch: 5 cost time: 3.7748255729675293
Epoch: 5, Steps: 1074 | Train Loss: 0.2334629 Vali Loss: 0.1245802 Test Loss: 0.1779737
Validation loss decreased (0.130639 --> 0.124580).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.4357661
	speed: 0.0172s/iter; left time: 275.8317s
	iters: 200, epoch: 6 | loss: 0.1225173
	speed: 0.0029s/iter; left time: 45.3900s
	iters: 300, epoch: 6 | loss: 0.3069182
	speed: 0.0029s/iter; left time: 45.0682s
	iters: 400, epoch: 6 | loss: 0.1353897
	speed: 0.0040s/iter; left time: 62.2988s
	iters: 500, epoch: 6 | loss: 0.1468429
	speed: 0.0036s/iter; left time: 55.7621s
	iters: 600, epoch: 6 | loss: 0.1637948
	speed: 0.0041s/iter; left time: 63.2679s
	iters: 700, epoch: 6 | loss: 0.1257539
	speed: 0.0035s/iter; left time: 53.2540s
	iters: 800, epoch: 6 | loss: 0.6247567
	speed: 0.0032s/iter; left time: 48.4423s
	iters: 900, epoch: 6 | loss: 0.2761067
	speed: 0.0026s/iter; left time: 39.2840s
	iters: 1000, epoch: 6 | loss: 0.4489884
	speed: 0.0026s/iter; left time: 39.9746s
Epoch: 6 cost time: 3.671952486038208
Epoch: 6, Steps: 1074 | Train Loss: 0.2316721 Vali Loss: 0.1271930 Test Loss: 0.1780801
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.2553556
	speed: 0.0192s/iter; left time: 287.2416s
	iters: 200, epoch: 7 | loss: 0.1926789
	speed: 0.0031s/iter; left time: 46.3496s
	iters: 300, epoch: 7 | loss: 0.1499440
	speed: 0.0027s/iter; left time: 39.1692s
	iters: 400, epoch: 7 | loss: 0.1469984
	speed: 0.0034s/iter; left time: 50.3006s
	iters: 500, epoch: 7 | loss: 0.1306943
	speed: 0.0048s/iter; left time: 70.4250s
	iters: 600, epoch: 7 | loss: 0.1217610
	speed: 0.0030s/iter; left time: 42.8656s
	iters: 700, epoch: 7 | loss: 0.3314057
	speed: 0.0036s/iter; left time: 51.5404s
	iters: 800, epoch: 7 | loss: 0.1964366
	speed: 0.0038s/iter; left time: 53.7478s
	iters: 900, epoch: 7 | loss: 0.2832938
	speed: 0.0028s/iter; left time: 40.2762s
	iters: 1000, epoch: 7 | loss: 0.1537005
	speed: 0.0035s/iter; left time: 48.9150s
Epoch: 7 cost time: 3.7096736431121826
Epoch: 7, Steps: 1074 | Train Loss: 0.2305783 Vali Loss: 0.1251644 Test Loss: 0.1771158
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.2026705
	speed: 0.0178s/iter; left time: 247.3452s
	iters: 200, epoch: 8 | loss: 0.4976558
	speed: 0.0039s/iter; left time: 53.9995s
	iters: 300, epoch: 8 | loss: 0.2846037
	speed: 0.0033s/iter; left time: 44.8424s
	iters: 400, epoch: 8 | loss: 0.4385445
	speed: 0.0034s/iter; left time: 46.6721s
	iters: 500, epoch: 8 | loss: 0.1818013
	speed: 0.0034s/iter; left time: 46.2066s
	iters: 600, epoch: 8 | loss: 0.1147934
	speed: 0.0039s/iter; left time: 52.5438s
	iters: 700, epoch: 8 | loss: 0.2615342
	speed: 0.0040s/iter; left time: 53.5017s
	iters: 800, epoch: 8 | loss: 0.4078731
	speed: 0.0029s/iter; left time: 38.6665s
	iters: 900, epoch: 8 | loss: 0.1786447
	speed: 0.0035s/iter; left time: 45.4095s
	iters: 1000, epoch: 8 | loss: 0.2461660
	speed: 0.0032s/iter; left time: 40.9729s
Epoch: 8 cost time: 3.7116000652313232
Epoch: 8, Steps: 1074 | Train Loss: 0.2299949 Vali Loss: 0.1249055 Test Loss: 0.1771069
EarlyStopping counter: 3 out of 5
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.1655527
	speed: 0.0187s/iter; left time: 238.5795s
	iters: 200, epoch: 9 | loss: 0.3986860
	speed: 0.0051s/iter; left time: 64.1828s
	iters: 300, epoch: 9 | loss: 0.5068502
	speed: 0.0041s/iter; left time: 51.9402s
	iters: 400, epoch: 9 | loss: 0.1275791
	speed: 0.0038s/iter; left time: 47.9432s
	iters: 500, epoch: 9 | loss: 0.1512772
	speed: 0.0041s/iter; left time: 50.3269s
	iters: 600, epoch: 9 | loss: 0.1583958
	speed: 0.0044s/iter; left time: 53.7851s
	iters: 700, epoch: 9 | loss: 0.3246979
	speed: 0.0034s/iter; left time: 41.8853s
	iters: 800, epoch: 9 | loss: 0.1920926
	speed: 0.0033s/iter; left time: 39.6758s
	iters: 900, epoch: 9 | loss: 0.2229436
	speed: 0.0041s/iter; left time: 48.6942s
	iters: 1000, epoch: 9 | loss: 0.1067075
	speed: 0.0041s/iter; left time: 48.3104s
Epoch: 9 cost time: 4.244994640350342
Epoch: 9, Steps: 1074 | Train Loss: 0.2295784 Vali Loss: 0.1254599 Test Loss: 0.1769912
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.0894451
	speed: 0.0164s/iter; left time: 192.1618s
	iters: 200, epoch: 10 | loss: 0.2598071
	speed: 0.0028s/iter; left time: 32.7140s
	iters: 300, epoch: 10 | loss: 0.1962459
	speed: 0.0028s/iter; left time: 32.3849s
	iters: 400, epoch: 10 | loss: 0.2786004
	speed: 0.0042s/iter; left time: 48.1675s
	iters: 500, epoch: 10 | loss: 0.1802210
	speed: 0.0036s/iter; left time: 40.6314s
	iters: 600, epoch: 10 | loss: 0.2077070
	speed: 0.0042s/iter; left time: 47.3162s
	iters: 700, epoch: 10 | loss: 0.5495107
	speed: 0.0036s/iter; left time: 39.9324s
	iters: 800, epoch: 10 | loss: 0.1765842
	speed: 0.0030s/iter; left time: 33.0028s
	iters: 900, epoch: 10 | loss: 0.3057334
	speed: 0.0036s/iter; left time: 38.9436s
	iters: 1000, epoch: 10 | loss: 0.2210532
	speed: 0.0031s/iter; left time: 33.8188s
Epoch: 10 cost time: 3.726970911026001
Epoch: 10, Steps: 1074 | Train Loss: 0.2294572 Vali Loss: 0.1242660 Test Loss: 0.1763691
Validation loss decreased (0.124580 --> 0.124266).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.2610345
	speed: 0.0225s/iter; left time: 239.4000s
	iters: 200, epoch: 11 | loss: 0.3302871
	speed: 0.0037s/iter; left time: 39.5044s
	iters: 300, epoch: 11 | loss: 0.2055659
	speed: 0.0039s/iter; left time: 40.7881s
	iters: 400, epoch: 11 | loss: 0.1203711
	speed: 0.0028s/iter; left time: 29.1234s
	iters: 500, epoch: 11 | loss: 0.2012248
	speed: 0.0031s/iter; left time: 31.9646s
	iters: 600, epoch: 11 | loss: 0.3443848
	speed: 0.0033s/iter; left time: 33.6674s
	iters: 700, epoch: 11 | loss: 0.1288063
	speed: 0.0030s/iter; left time: 30.1740s
	iters: 800, epoch: 11 | loss: 0.2544183
	speed: 0.0030s/iter; left time: 29.9128s
	iters: 900, epoch: 11 | loss: 0.2942244
	speed: 0.0029s/iter; left time: 28.0552s
	iters: 1000, epoch: 11 | loss: 0.2041260
	speed: 0.0030s/iter; left time: 28.9580s
Epoch: 11 cost time: 3.4851150512695312
Epoch: 11, Steps: 1074 | Train Loss: 0.2294330 Vali Loss: 0.1245527 Test Loss: 0.1765237
EarlyStopping counter: 1 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.2452933
	speed: 0.0139s/iter; left time: 132.8392s
	iters: 200, epoch: 12 | loss: 0.2263187
	speed: 0.0024s/iter; left time: 22.3952s
	iters: 300, epoch: 12 | loss: 0.1874505
	speed: 0.0027s/iter; left time: 24.8939s
	iters: 400, epoch: 12 | loss: 0.1992272
	speed: 0.0028s/iter; left time: 26.0453s
	iters: 500, epoch: 12 | loss: 0.1843713
	speed: 0.0033s/iter; left time: 30.0679s
	iters: 600, epoch: 12 | loss: 0.2144434
	speed: 0.0030s/iter; left time: 27.0485s
	iters: 700, epoch: 12 | loss: 0.1544545
	speed: 0.0030s/iter; left time: 26.9796s
	iters: 800, epoch: 12 | loss: 0.1830239
	speed: 0.0031s/iter; left time: 27.2529s
	iters: 900, epoch: 12 | loss: 0.2984741
	speed: 0.0028s/iter; left time: 24.3834s
	iters: 1000, epoch: 12 | loss: 0.2309969
	speed: 0.0033s/iter; left time: 28.7064s
Epoch: 12 cost time: 3.14070200920105
Epoch: 12, Steps: 1074 | Train Loss: 0.2293712 Vali Loss: 0.1247138 Test Loss: 0.1766200
EarlyStopping counter: 2 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.2395914
	speed: 0.0137s/iter; left time: 116.4645s
	iters: 200, epoch: 13 | loss: 0.3550669
	speed: 0.0032s/iter; left time: 26.5682s
	iters: 300, epoch: 13 | loss: 0.2098945
	speed: 0.0025s/iter; left time: 20.7043s
	iters: 400, epoch: 13 | loss: 0.1560716
	speed: 0.0027s/iter; left time: 21.7297s
	iters: 500, epoch: 13 | loss: 0.5070862
	speed: 0.0021s/iter; left time: 16.8365s
	iters: 600, epoch: 13 | loss: 0.2120708
	speed: 0.0021s/iter; left time: 16.4710s
	iters: 700, epoch: 13 | loss: 0.1827326
	speed: 0.0024s/iter; left time: 19.1491s
	iters: 800, epoch: 13 | loss: 0.1447160
	speed: 0.0025s/iter; left time: 19.2763s
	iters: 900, epoch: 13 | loss: 0.1922257
	speed: 0.0022s/iter; left time: 16.9975s
	iters: 1000, epoch: 13 | loss: 0.4261697
	speed: 0.0022s/iter; left time: 16.6459s
Epoch: 13 cost time: 2.6010971069335938
Epoch: 13, Steps: 1074 | Train Loss: 0.2293459 Vali Loss: 0.1247595 Test Loss: 0.1766650
EarlyStopping counter: 3 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 14 | loss: 0.2084256
	speed: 0.0106s/iter; left time: 78.8267s
	iters: 200, epoch: 14 | loss: 0.1600207
	speed: 0.0022s/iter; left time: 16.2118s
	iters: 300, epoch: 14 | loss: 0.1643107
	speed: 0.0025s/iter; left time: 17.8305s
	iters: 400, epoch: 14 | loss: 0.3546730
	speed: 0.0022s/iter; left time: 15.5568s
	iters: 500, epoch: 14 | loss: 0.1439300
	speed: 0.0020s/iter; left time: 13.9946s
	iters: 600, epoch: 14 | loss: 0.1271832
	speed: 0.0019s/iter; left time: 13.1594s
	iters: 700, epoch: 14 | loss: 0.3320215
	speed: 0.0019s/iter; left time: 12.8775s
	iters: 800, epoch: 14 | loss: 0.1494101
	speed: 0.0020s/iter; left time: 13.6305s
	iters: 900, epoch: 14 | loss: 0.2682145
	speed: 0.0022s/iter; left time: 14.4938s
	iters: 1000, epoch: 14 | loss: 0.1399024
	speed: 0.0024s/iter; left time: 15.3543s
Epoch: 14 cost time: 2.331908941268921
Epoch: 14, Steps: 1074 | Train Loss: 0.2293319 Vali Loss: 0.1247507 Test Loss: 0.1766747
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 15 | loss: 0.1715262
	speed: 0.0112s/iter; left time: 71.3718s
	iters: 200, epoch: 15 | loss: 0.1828182
	speed: 0.0022s/iter; left time: 13.8589s
	iters: 300, epoch: 15 | loss: 0.4556450
	speed: 0.0019s/iter; left time: 11.6678s
	iters: 400, epoch: 15 | loss: 0.2224192
	speed: 0.0022s/iter; left time: 13.3889s
	iters: 500, epoch: 15 | loss: 0.1930135
	speed: 0.0023s/iter; left time: 13.3798s
	iters: 600, epoch: 15 | loss: 0.2057605
	speed: 0.0025s/iter; left time: 14.6210s
	iters: 700, epoch: 15 | loss: 0.2406981
	speed: 0.0019s/iter; left time: 10.7493s
	iters: 800, epoch: 15 | loss: 0.1614418
	speed: 0.0022s/iter; left time: 12.5333s
	iters: 900, epoch: 15 | loss: 0.1231025
	speed: 0.0022s/iter; left time: 12.1493s
	iters: 1000, epoch: 15 | loss: 0.2974614
	speed: 0.0025s/iter; left time: 13.7859s
Epoch: 15 cost time: 2.477811813354492
Epoch: 15, Steps: 1074 | Train Loss: 0.2293121 Vali Loss: 0.1247518 Test Loss: 0.1766771
EarlyStopping counter: 5 out of 5
Early stopping
Total training time: 67.7501 seconds
>>>>>>>testing : ETTm2_96_96_NLinear_ETTm2_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15349<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
data_set:  <data_provider.data_loader.Dataset_ETT_minute object at 0x000002CC6F081080>
mse:0.176621675491333, mae:0.2566729784011841
