Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='exchange_rate.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=8, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='mse', lradj='type1', model='NLinear', model_id='Exchange_336_720', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=720, root_path='./dataset/', save_pred_values=False, seed=15726, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : Exchange_336_720_NLinear_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15726>>>>>>>>>>>>>>>>>>>>>>>>>>
train 4256
val 41
test 798
	iters: 100, epoch: 1 | loss: 0.8009379
	speed: 0.0242s/iter; left time: 61.9232s
Epoch: 1 cost time: 3.097379446029663
Epoch: 1, Steps: 133 | Train Loss: 0.7867939 Vali Loss: 1.2007611 Test Loss: 0.8858855
Validation loss decreased (inf --> 1.200761).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.7503722
	speed: 0.0313s/iter; left time: 76.0917s
Epoch: 2 cost time: 2.9574763774871826
Epoch: 2, Steps: 133 | Train Loss: 0.7669765 Vali Loss: 1.2280430 Test Loss: 0.9786838
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.6986999
	speed: 0.0332s/iter; left time: 76.1586s
Epoch: 3 cost time: 3.1054394245147705
Epoch: 3, Steps: 133 | Train Loss: 0.7608086 Vali Loss: 1.2424966 Test Loss: 0.9803875
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.7546044
	speed: 0.0299s/iter; left time: 64.5989s
Epoch: 4 cost time: 2.8067448139190674
Epoch: 4, Steps: 133 | Train Loss: 0.7572305 Vali Loss: 1.2272053 Test Loss: 0.9853374
EarlyStopping counter: 3 out of 5
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.6303569
	speed: 0.0297s/iter; left time: 60.1986s
Epoch: 5 cost time: 2.5732603073120117
Epoch: 5, Steps: 133 | Train Loss: 0.7556251 Vali Loss: 1.1955653 Test Loss: 0.9831558
Validation loss decreased (1.200761 --> 1.195565).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.6974250
	speed: 0.0299s/iter; left time: 56.7777s
Epoch: 6 cost time: 3.0061709880828857
Epoch: 6, Steps: 133 | Train Loss: 0.7546139 Vali Loss: 1.1869974 Test Loss: 0.9889069
Validation loss decreased (1.195565 --> 1.186997).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.7888389
	speed: 0.0311s/iter; left time: 54.8030s
Epoch: 7 cost time: 2.8415186405181885
Epoch: 7, Steps: 133 | Train Loss: 0.7542212 Vali Loss: 1.1865300 Test Loss: 0.9866779
Validation loss decreased (1.186997 --> 1.186530).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.7738752
	speed: 0.0277s/iter; left time: 45.0973s
Epoch: 8 cost time: 2.5152852535247803
Epoch: 8, Steps: 133 | Train Loss: 0.7539938 Vali Loss: 1.2110701 Test Loss: 0.9857619
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.7072827
	speed: 0.0282s/iter; left time: 42.1581s
Epoch: 9 cost time: 2.639843225479126
Epoch: 9, Steps: 133 | Train Loss: 0.7538713 Vali Loss: 1.2261008 Test Loss: 0.9860053
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.7335641
	speed: 0.0268s/iter; left time: 36.4892s
Epoch: 10 cost time: 2.6247293949127197
Epoch: 10, Steps: 133 | Train Loss: 0.7538116 Vali Loss: 1.1907554 Test Loss: 0.9860561
EarlyStopping counter: 3 out of 5
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 11 | loss: 0.7292293
	speed: 0.0270s/iter; left time: 33.2268s
Epoch: 11 cost time: 2.380868911743164
Epoch: 11, Steps: 133 | Train Loss: 0.7537793 Vali Loss: 1.1954408 Test Loss: 0.9860658
EarlyStopping counter: 4 out of 5
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 12 | loss: 0.9032549
	speed: 0.0254s/iter; left time: 27.8671s
Epoch: 12 cost time: 2.4280359745025635
Epoch: 12, Steps: 133 | Train Loss: 0.7537615 Vali Loss: 1.2175730 Test Loss: 0.9860140
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : Exchange_336_720_NLinear_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15726<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 798
mse:0.9880843758583069, mae:0.7275117039680481
