Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='Linear', model_id='ETTm2_336_720', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=720, root_path='./dataset/', save_pred_values=False, seed=15349, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTm2_336_720_Linear_ETTm2_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15349>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33505
val 10801
test 10801
	iters: 100, epoch: 1 | loss: 0.6831703
	speed: 0.0199s/iter; left time: 414.8188s
	iters: 200, epoch: 1 | loss: 0.6471763
	speed: 0.0192s/iter; left time: 397.3816s
	iters: 300, epoch: 1 | loss: 0.5370434
	speed: 0.0158s/iter; left time: 325.5162s
	iters: 400, epoch: 1 | loss: 0.6251881
	speed: 0.0141s/iter; left time: 289.9168s
	iters: 500, epoch: 1 | loss: 1.1073266
	speed: 0.0189s/iter; left time: 385.4068s
	iters: 600, epoch: 1 | loss: 1.2052386
	speed: 0.0218s/iter; left time: 443.0905s
	iters: 700, epoch: 1 | loss: 0.5814942
	speed: 0.0180s/iter; left time: 365.3235s
	iters: 800, epoch: 1 | loss: 0.9704667
	speed: 0.0175s/iter; left time: 353.0741s
	iters: 900, epoch: 1 | loss: 0.6396520
	speed: 0.0183s/iter; left time: 366.0772s
	iters: 1000, epoch: 1 | loss: 0.8795614
	speed: 0.0171s/iter; left time: 341.1847s
Epoch: 1 cost time: 18.898277521133423
Epoch: 1, Steps: 1047 | Train Loss: 0.7585379 Vali Loss: 0.6937907 Test Loss: 1.5141987
Validation loss decreased (inf --> 0.693791).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.4406621
	speed: 0.0565s/iter; left time: 1117.6746s
	iters: 200, epoch: 2 | loss: 0.6868368
	speed: 0.0164s/iter; left time: 323.1134s
	iters: 300, epoch: 2 | loss: 0.6826962
	speed: 0.0175s/iter; left time: 343.0124s
	iters: 400, epoch: 2 | loss: 0.6413678
	speed: 0.0190s/iter; left time: 370.7800s
	iters: 500, epoch: 2 | loss: 0.7219298
	speed: 0.0188s/iter; left time: 365.0888s
	iters: 600, epoch: 2 | loss: 0.8231344
	speed: 0.0173s/iter; left time: 334.2400s
	iters: 700, epoch: 2 | loss: 0.3809049
	speed: 0.0168s/iter; left time: 321.8267s
	iters: 800, epoch: 2 | loss: 1.0467319
	speed: 0.0182s/iter; left time: 347.1495s
	iters: 900, epoch: 2 | loss: 0.4831057
	speed: 0.0196s/iter; left time: 371.7670s
	iters: 1000, epoch: 2 | loss: 0.6635976
	speed: 0.0195s/iter; left time: 369.2279s
Epoch: 2 cost time: 18.70871114730835
Epoch: 2, Steps: 1047 | Train Loss: 0.6952099 Vali Loss: 0.7046239 Test Loss: 1.4845135
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.6164196
	speed: 0.0558s/iter; left time: 1046.5182s
	iters: 200, epoch: 3 | loss: 0.3450083
	speed: 0.0173s/iter; left time: 322.3932s
	iters: 300, epoch: 3 | loss: 0.4427414
	speed: 0.0208s/iter; left time: 386.3625s
	iters: 400, epoch: 3 | loss: 0.5092816
	speed: 0.0212s/iter; left time: 391.2479s
	iters: 500, epoch: 3 | loss: 0.3020325
	speed: 0.0214s/iter; left time: 391.8977s
	iters: 600, epoch: 3 | loss: 0.5576900
	speed: 0.0180s/iter; left time: 329.2138s
	iters: 700, epoch: 3 | loss: 0.3203461
	speed: 0.0181s/iter; left time: 329.2500s
	iters: 800, epoch: 3 | loss: 0.3334183
	speed: 0.0184s/iter; left time: 332.0579s
	iters: 900, epoch: 3 | loss: 0.5033439
	speed: 0.0195s/iter; left time: 350.5971s
	iters: 1000, epoch: 3 | loss: 0.3414995
	speed: 0.0182s/iter; left time: 324.4435s
Epoch: 3 cost time: 19.662474870681763
Epoch: 3, Steps: 1047 | Train Loss: 0.5463669 Vali Loss: 0.5422869 Test Loss: 1.3264426
Validation loss decreased (0.693791 --> 0.542287).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.9015253
	speed: 0.0642s/iter; left time: 1136.9186s
	iters: 200, epoch: 4 | loss: 0.3198347
	speed: 0.0176s/iter; left time: 310.5446s
	iters: 300, epoch: 4 | loss: 0.4604322
	speed: 0.0178s/iter; left time: 311.8717s
	iters: 400, epoch: 4 | loss: 0.9044645
	speed: 0.0184s/iter; left time: 320.1393s
	iters: 500, epoch: 4 | loss: 0.6048824
	speed: 0.0204s/iter; left time: 352.0876s
	iters: 600, epoch: 4 | loss: 0.4920797
	speed: 0.0174s/iter; left time: 299.7903s
	iters: 700, epoch: 4 | loss: 0.4763182
	speed: 0.0179s/iter; left time: 306.2165s
	iters: 800, epoch: 4 | loss: 0.4119356
	speed: 0.0174s/iter; left time: 295.4817s
	iters: 900, epoch: 4 | loss: 0.3577403
	speed: 0.0187s/iter; left time: 315.6107s
	iters: 1000, epoch: 4 | loss: 0.7919520
	speed: 0.0181s/iter; left time: 304.1725s
Epoch: 4 cost time: 18.85875964164734
Epoch: 4, Steps: 1047 | Train Loss: 0.4997215 Vali Loss: 0.6860993 Test Loss: 1.8003291
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.2432472
	speed: 0.0650s/iter; left time: 1082.4032s
	iters: 200, epoch: 5 | loss: 0.8599559
	speed: 0.0165s/iter; left time: 273.6337s
	iters: 300, epoch: 5 | loss: 0.6047609
	speed: 0.0177s/iter; left time: 290.8060s
	iters: 400, epoch: 5 | loss: 0.1930338
	speed: 0.0185s/iter; left time: 302.1402s
	iters: 500, epoch: 5 | loss: 0.6513776
	speed: 0.0160s/iter; left time: 259.3597s
	iters: 600, epoch: 5 | loss: 0.5739907
	speed: 0.0197s/iter; left time: 317.4930s
	iters: 700, epoch: 5 | loss: 0.4021488
	speed: 0.0190s/iter; left time: 305.4804s
	iters: 800, epoch: 5 | loss: 0.2322652
	speed: 0.0194s/iter; left time: 310.0324s
	iters: 900, epoch: 5 | loss: 0.4621790
	speed: 0.0194s/iter; left time: 307.0631s
	iters: 1000, epoch: 5 | loss: 0.2684726
	speed: 0.0189s/iter; left time: 297.8594s
Epoch: 5 cost time: 18.966739177703857
Epoch: 5, Steps: 1047 | Train Loss: 0.4771600 Vali Loss: 0.5452574 Test Loss: 1.2048309
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.2911033
	speed: 0.0610s/iter; left time: 952.0487s
	iters: 200, epoch: 6 | loss: 0.2341524
	speed: 0.0158s/iter; left time: 245.3393s
	iters: 300, epoch: 6 | loss: 0.5546051
	speed: 0.0185s/iter; left time: 285.1659s
	iters: 400, epoch: 6 | loss: 0.5375970
	speed: 0.0187s/iter; left time: 286.4899s
	iters: 500, epoch: 6 | loss: 0.4090497
	speed: 0.0165s/iter; left time: 251.4020s
	iters: 600, epoch: 6 | loss: 0.3367853
	speed: 0.0184s/iter; left time: 277.8269s
	iters: 700, epoch: 6 | loss: 0.5125830
	speed: 0.0186s/iter; left time: 278.7723s
	iters: 800, epoch: 6 | loss: 0.4971485
	speed: 0.0191s/iter; left time: 284.2108s
	iters: 900, epoch: 6 | loss: 0.5339147
	speed: 0.0188s/iter; left time: 278.3699s
	iters: 1000, epoch: 6 | loss: 0.2999663
	speed: 0.0185s/iter; left time: 272.3023s
Epoch: 6 cost time: 18.697383642196655
Epoch: 6, Steps: 1047 | Train Loss: 0.4643496 Vali Loss: 0.3848413 Test Loss: 0.7721923
Validation loss decreased (0.542287 --> 0.384841).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.6266279
	speed: 0.0553s/iter; left time: 805.4772s
	iters: 200, epoch: 7 | loss: 0.2974311
	speed: 0.0158s/iter; left time: 228.2132s
	iters: 300, epoch: 7 | loss: 0.3089834
	speed: 0.0185s/iter; left time: 265.9283s
	iters: 400, epoch: 7 | loss: 0.5168974
	speed: 0.0184s/iter; left time: 263.0542s
	iters: 500, epoch: 7 | loss: 0.4728318
	speed: 0.0183s/iter; left time: 259.0991s
	iters: 600, epoch: 7 | loss: 0.4711404
	speed: 0.0203s/iter; left time: 285.0042s
	iters: 700, epoch: 7 | loss: 0.4848837
	speed: 0.0209s/iter; left time: 291.6904s
	iters: 800, epoch: 7 | loss: 0.6611838
	speed: 0.0172s/iter; left time: 237.8114s
	iters: 900, epoch: 7 | loss: 0.6439003
	speed: 0.0188s/iter; left time: 259.0923s
	iters: 1000, epoch: 7 | loss: 0.3479237
	speed: 0.0192s/iter; left time: 262.7461s
Epoch: 7 cost time: 19.032254219055176
Epoch: 7, Steps: 1047 | Train Loss: 0.4571844 Vali Loss: 0.4028682 Test Loss: 0.7910309
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.4268925
	speed: 0.0609s/iter; left time: 822.9676s
	iters: 200, epoch: 8 | loss: 0.2769038
	speed: 0.0153s/iter; left time: 205.2166s
	iters: 300, epoch: 8 | loss: 0.9040043
	speed: 0.0176s/iter; left time: 234.4207s
	iters: 400, epoch: 8 | loss: 0.4391480
	speed: 0.0184s/iter; left time: 242.8616s
	iters: 500, epoch: 8 | loss: 0.6377578
	speed: 0.0178s/iter; left time: 233.8079s
	iters: 600, epoch: 8 | loss: 0.6462670
	speed: 0.0198s/iter; left time: 257.4434s
	iters: 700, epoch: 8 | loss: 0.3561115
	speed: 0.0175s/iter; left time: 226.5023s
	iters: 800, epoch: 8 | loss: 0.6145419
	speed: 0.0179s/iter; left time: 229.7372s
	iters: 900, epoch: 8 | loss: 0.6024372
	speed: 0.0174s/iter; left time: 221.6867s
	iters: 1000, epoch: 8 | loss: 0.3107449
	speed: 0.0185s/iter; left time: 233.9028s
Epoch: 8 cost time: 18.38669466972351
Epoch: 8, Steps: 1047 | Train Loss: 0.4536679 Vali Loss: 0.4183215 Test Loss: 0.8701835
EarlyStopping counter: 2 out of 5
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.4337147
	speed: 0.0666s/iter; left time: 829.7695s
	iters: 200, epoch: 9 | loss: 0.3129576
	speed: 0.0170s/iter; left time: 210.7353s
	iters: 300, epoch: 9 | loss: 0.7733743
	speed: 0.0181s/iter; left time: 222.3162s
	iters: 400, epoch: 9 | loss: 0.3674538
	speed: 0.0188s/iter; left time: 228.4249s
	iters: 500, epoch: 9 | loss: 0.3119756
	speed: 0.0198s/iter; left time: 238.5414s
	iters: 600, epoch: 9 | loss: 0.4671372
	speed: 0.0195s/iter; left time: 233.3936s
	iters: 700, epoch: 9 | loss: 0.5926292
	speed: 0.0213s/iter; left time: 253.1828s
	iters: 800, epoch: 9 | loss: 0.4332919
	speed: 0.0213s/iter; left time: 250.3585s
	iters: 900, epoch: 9 | loss: 0.3354394
	speed: 0.0202s/iter; left time: 235.6006s
	iters: 1000, epoch: 9 | loss: 0.2582058
	speed: 0.0190s/iter; left time: 219.8969s
Epoch: 9 cost time: 19.884007215499878
Epoch: 9, Steps: 1047 | Train Loss: 0.4513898 Vali Loss: 0.3888428 Test Loss: 0.7664074
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.4418734
	speed: 0.0620s/iter; left time: 708.2174s
	iters: 200, epoch: 10 | loss: 0.4984475
	speed: 0.0148s/iter; left time: 167.2020s
	iters: 300, epoch: 10 | loss: 0.5241504
	speed: 0.0176s/iter; left time: 197.8379s
	iters: 400, epoch: 10 | loss: 0.3558676
	speed: 0.0161s/iter; left time: 178.6537s
	iters: 500, epoch: 10 | loss: 0.2474697
	speed: 0.0173s/iter; left time: 191.1307s
	iters: 600, epoch: 10 | loss: 0.3567860
	speed: 0.0143s/iter; left time: 156.1873s
	iters: 700, epoch: 10 | loss: 0.4516242
	speed: 0.0166s/iter; left time: 179.2386s
	iters: 800, epoch: 10 | loss: 0.6383573
	speed: 0.0171s/iter; left time: 183.5385s
	iters: 900, epoch: 10 | loss: 0.5087826
	speed: 0.0172s/iter; left time: 183.0963s
	iters: 1000, epoch: 10 | loss: 0.7407042
	speed: 0.0174s/iter; left time: 183.4456s
Epoch: 10 cost time: 17.191885709762573
Epoch: 10, Steps: 1047 | Train Loss: 0.4502281 Vali Loss: 0.4163269 Test Loss: 0.8558509
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.3056198
	speed: 0.0615s/iter; left time: 638.0164s
	iters: 200, epoch: 11 | loss: 0.3097687
	speed: 0.0153s/iter; left time: 157.0706s
	iters: 300, epoch: 11 | loss: 0.5255749
	speed: 0.0157s/iter; left time: 159.8051s
	iters: 400, epoch: 11 | loss: 0.2658136
	speed: 0.0158s/iter; left time: 159.5809s
	iters: 500, epoch: 11 | loss: 0.4996241
	speed: 0.0173s/iter; left time: 172.4238s
	iters: 600, epoch: 11 | loss: 0.6085401
	speed: 0.0153s/iter; left time: 151.1628s
	iters: 700, epoch: 11 | loss: 0.5083998
	speed: 0.0158s/iter; left time: 154.2231s
	iters: 800, epoch: 11 | loss: 0.4511310
	speed: 0.0140s/iter; left time: 135.3522s
	iters: 900, epoch: 11 | loss: 0.4372599
	speed: 0.0144s/iter; left time: 137.7771s
	iters: 1000, epoch: 11 | loss: 0.2112481
	speed: 0.0151s/iter; left time: 143.0941s
Epoch: 11 cost time: 16.006157875061035
Epoch: 11, Steps: 1047 | Train Loss: 0.4496634 Vali Loss: 0.4097162 Test Loss: 0.8275428
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTm2_336_720_Linear_ETTm2_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15349<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10801
mse:0.7727770805358887, mae:0.5561588406562805
