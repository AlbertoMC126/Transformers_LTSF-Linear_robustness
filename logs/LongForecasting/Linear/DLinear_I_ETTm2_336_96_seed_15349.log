Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='DLinear', model_id='ETTm2_336_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=15349, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTm2_336_96_DLinear_ETTm2_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15349>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34129
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.3820512
	speed: 0.0074s/iter; left time: 156.6478s
	iters: 200, epoch: 1 | loss: 0.4711761
	speed: 0.0077s/iter; left time: 163.1124s
	iters: 300, epoch: 1 | loss: 0.3908461
	speed: 0.0081s/iter; left time: 169.4716s
	iters: 400, epoch: 1 | loss: 0.4076664
	speed: 0.0079s/iter; left time: 165.9806s
	iters: 500, epoch: 1 | loss: 0.6285100
	speed: 0.0086s/iter; left time: 178.2401s
	iters: 600, epoch: 1 | loss: 0.3668028
	speed: 0.0081s/iter; left time: 167.0513s
	iters: 700, epoch: 1 | loss: 0.4093231
	speed: 0.0081s/iter; left time: 167.7072s
	iters: 800, epoch: 1 | loss: 0.6036954
	speed: 0.0085s/iter; left time: 174.0590s
	iters: 900, epoch: 1 | loss: 0.5406910
	speed: 0.0074s/iter; left time: 150.9930s
	iters: 1000, epoch: 1 | loss: 0.6149831
	speed: 0.0067s/iter; left time: 135.9477s
Epoch: 1 cost time: 8.346397876739502
Epoch: 1, Steps: 1066 | Train Loss: 0.4667989 Vali Loss: 0.2469496 Test Loss: 0.4484563
Validation loss decreased (inf --> 0.246950).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.1959339
	speed: 0.0391s/iter; left time: 787.2520s
	iters: 200, epoch: 2 | loss: 0.3470385
	speed: 0.0096s/iter; left time: 191.9764s
	iters: 300, epoch: 2 | loss: 0.4685584
	speed: 0.0093s/iter; left time: 184.8358s
	iters: 400, epoch: 2 | loss: 0.4025967
	speed: 0.0095s/iter; left time: 187.9051s
	iters: 500, epoch: 2 | loss: 0.5717541
	speed: 0.0085s/iter; left time: 168.7600s
	iters: 600, epoch: 2 | loss: 0.3779568
	speed: 0.0085s/iter; left time: 167.5205s
	iters: 700, epoch: 2 | loss: 0.6798129
	speed: 0.0085s/iter; left time: 166.6697s
	iters: 800, epoch: 2 | loss: 0.3207315
	speed: 0.0097s/iter; left time: 189.3435s
	iters: 900, epoch: 2 | loss: 0.4775752
	speed: 0.0093s/iter; left time: 180.6900s
	iters: 1000, epoch: 2 | loss: 0.3325334
	speed: 0.0079s/iter; left time: 152.7308s
Epoch: 2 cost time: 9.63724136352539
Epoch: 2, Steps: 1066 | Train Loss: 0.4201086 Vali Loss: 0.6155423 Test Loss: 1.4613192
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.2277227
	speed: 0.0362s/iter; left time: 691.7671s
	iters: 200, epoch: 3 | loss: 0.1885558
	speed: 0.0067s/iter; left time: 127.4392s
	iters: 300, epoch: 3 | loss: 0.2190638
	speed: 0.0071s/iter; left time: 135.0563s
	iters: 400, epoch: 3 | loss: 0.3716807
	speed: 0.0076s/iter; left time: 142.8499s
	iters: 500, epoch: 3 | loss: 0.3526350
	speed: 0.0071s/iter; left time: 132.9283s
	iters: 600, epoch: 3 | loss: 0.2432670
	speed: 0.0080s/iter; left time: 148.5819s
	iters: 700, epoch: 3 | loss: 0.2679376
	speed: 0.0092s/iter; left time: 170.6536s
	iters: 800, epoch: 3 | loss: 0.1399656
	speed: 0.0087s/iter; left time: 160.0113s
	iters: 900, epoch: 3 | loss: 0.1869626
	speed: 0.0078s/iter; left time: 141.7741s
	iters: 1000, epoch: 3 | loss: 0.2968856
	speed: 0.0083s/iter; left time: 151.3839s
Epoch: 3 cost time: 8.298118829727173
Epoch: 3, Steps: 1066 | Train Loss: 0.2785595 Vali Loss: 0.2252545 Test Loss: 0.4356471
Validation loss decreased (0.246950 --> 0.225255).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.1347550
	speed: 0.0361s/iter; left time: 651.1405s
	iters: 200, epoch: 4 | loss: 0.2689037
	speed: 0.0089s/iter; left time: 158.9772s
	iters: 300, epoch: 4 | loss: 0.2143627
	speed: 0.0063s/iter; left time: 112.1760s
	iters: 400, epoch: 4 | loss: 0.2650498
	speed: 0.0059s/iter; left time: 105.3414s
	iters: 500, epoch: 4 | loss: 0.1827456
	speed: 0.0072s/iter; left time: 127.4217s
	iters: 600, epoch: 4 | loss: 0.7069566
	speed: 0.0084s/iter; left time: 146.3593s
	iters: 700, epoch: 4 | loss: 0.2422475
	speed: 0.0080s/iter; left time: 139.4242s
	iters: 800, epoch: 4 | loss: 0.2338346
	speed: 0.0077s/iter; left time: 132.8730s
	iters: 900, epoch: 4 | loss: 0.1409984
	speed: 0.0076s/iter; left time: 130.1538s
	iters: 1000, epoch: 4 | loss: 0.2305371
	speed: 0.0076s/iter; left time: 130.4867s
Epoch: 4 cost time: 8.096346616744995
Epoch: 4, Steps: 1066 | Train Loss: 0.2377220 Vali Loss: 0.2012839 Test Loss: 0.3468367
Validation loss decreased (0.225255 --> 0.201284).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.1778918
	speed: 0.0398s/iter; left time: 674.5165s
	iters: 200, epoch: 5 | loss: 0.1408512
	speed: 0.0092s/iter; left time: 154.2664s
	iters: 300, epoch: 5 | loss: 0.2347012
	speed: 0.0095s/iter; left time: 158.3940s
	iters: 400, epoch: 5 | loss: 0.2754273
	speed: 0.0092s/iter; left time: 153.9577s
	iters: 500, epoch: 5 | loss: 0.1414826
	speed: 0.0096s/iter; left time: 158.4986s
	iters: 600, epoch: 5 | loss: 0.2574535
	speed: 0.0092s/iter; left time: 151.0980s
	iters: 700, epoch: 5 | loss: 0.1587374
	speed: 0.0087s/iter; left time: 143.0128s
	iters: 800, epoch: 5 | loss: 0.2354543
	speed: 0.0083s/iter; left time: 134.9798s
	iters: 900, epoch: 5 | loss: 0.1829796
	speed: 0.0081s/iter; left time: 130.7185s
	iters: 1000, epoch: 5 | loss: 0.2525693
	speed: 0.0082s/iter; left time: 132.0367s
Epoch: 5 cost time: 9.434385299682617
Epoch: 5, Steps: 1066 | Train Loss: 0.2212800 Vali Loss: 0.1514931 Test Loss: 0.2406201
Validation loss decreased (0.201284 --> 0.151493).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.2304530
	speed: 0.0403s/iter; left time: 640.8910s
	iters: 200, epoch: 6 | loss: 0.4215835
	speed: 0.0089s/iter; left time: 140.4197s
	iters: 300, epoch: 6 | loss: 0.1317167
	speed: 0.0084s/iter; left time: 131.3519s
	iters: 400, epoch: 6 | loss: 0.2070455
	speed: 0.0077s/iter; left time: 119.2963s
	iters: 500, epoch: 6 | loss: 0.1428668
	speed: 0.0077s/iter; left time: 119.3358s
	iters: 600, epoch: 6 | loss: 0.1685826
	speed: 0.0086s/iter; left time: 132.6705s
	iters: 700, epoch: 6 | loss: 0.1285724
	speed: 0.0084s/iter; left time: 128.4795s
	iters: 800, epoch: 6 | loss: 0.2224779
	speed: 0.0076s/iter; left time: 115.2094s
	iters: 900, epoch: 6 | loss: 0.2296799
	speed: 0.0075s/iter; left time: 113.5338s
	iters: 1000, epoch: 6 | loss: 0.1638788
	speed: 0.0085s/iter; left time: 127.1658s
Epoch: 6 cost time: 8.776320219039917
Epoch: 6, Steps: 1066 | Train Loss: 0.2097403 Vali Loss: 0.1520687 Test Loss: 0.2586438
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.2943609
	speed: 0.0356s/iter; left time: 527.4572s
	iters: 200, epoch: 7 | loss: 0.1294662
	speed: 0.0078s/iter; left time: 115.0497s
	iters: 300, epoch: 7 | loss: 0.1722916
	speed: 0.0073s/iter; left time: 106.6580s
	iters: 400, epoch: 7 | loss: 0.2354635
	speed: 0.0087s/iter; left time: 125.8304s
	iters: 500, epoch: 7 | loss: 0.0990508
	speed: 0.0075s/iter; left time: 108.3381s
	iters: 600, epoch: 7 | loss: 0.1208273
	speed: 0.0076s/iter; left time: 109.3281s
	iters: 700, epoch: 7 | loss: 0.2524789
	speed: 0.0084s/iter; left time: 119.9266s
	iters: 800, epoch: 7 | loss: 0.1326139
	speed: 0.0082s/iter; left time: 115.7096s
	iters: 900, epoch: 7 | loss: 0.4112207
	speed: 0.0076s/iter; left time: 106.0811s
	iters: 1000, epoch: 7 | loss: 0.1570283
	speed: 0.0080s/iter; left time: 110.9895s
Epoch: 7 cost time: 8.469260215759277
Epoch: 7, Steps: 1066 | Train Loss: 0.2051616 Vali Loss: 0.1332807 Test Loss: 0.2088834
Validation loss decreased (0.151493 --> 0.133281).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.3069054
	speed: 0.0367s/iter; left time: 505.3660s
	iters: 200, epoch: 8 | loss: 0.1276490
	speed: 0.0082s/iter; left time: 112.5787s
	iters: 300, epoch: 8 | loss: 0.2632044
	speed: 0.0071s/iter; left time: 95.7544s
	iters: 400, epoch: 8 | loss: 0.1099130
	speed: 0.0077s/iter; left time: 103.1035s
	iters: 500, epoch: 8 | loss: 0.1621390
	speed: 0.0077s/iter; left time: 102.8972s
	iters: 600, epoch: 8 | loss: 0.1160154
	speed: 0.0084s/iter; left time: 111.8127s
	iters: 700, epoch: 8 | loss: 0.5257131
	speed: 0.0083s/iter; left time: 109.3601s
	iters: 800, epoch: 8 | loss: 0.1820883
	speed: 0.0088s/iter; left time: 115.3367s
	iters: 900, epoch: 8 | loss: 0.2301903
	speed: 0.0074s/iter; left time: 96.0119s
	iters: 1000, epoch: 8 | loss: 0.6729530
	speed: 0.0080s/iter; left time: 102.2560s
Epoch: 8 cost time: 8.455980777740479
Epoch: 8, Steps: 1066 | Train Loss: 0.2020700 Vali Loss: 0.1347135 Test Loss: 0.2131806
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.2679295
	speed: 0.0369s/iter; left time: 467.9687s
	iters: 200, epoch: 9 | loss: 0.1724752
	speed: 0.0084s/iter; left time: 105.9332s
	iters: 300, epoch: 9 | loss: 0.1791599
	speed: 0.0073s/iter; left time: 90.9489s
	iters: 400, epoch: 9 | loss: 0.0871640
	speed: 0.0081s/iter; left time: 100.0437s
	iters: 500, epoch: 9 | loss: 0.1077514
	speed: 0.0079s/iter; left time: 97.2701s
	iters: 600, epoch: 9 | loss: 0.1349880
	speed: 0.0089s/iter; left time: 108.1874s
	iters: 700, epoch: 9 | loss: 0.3218341
	speed: 0.0094s/iter; left time: 113.5629s
	iters: 800, epoch: 9 | loss: 0.1365394
	speed: 0.0069s/iter; left time: 82.4168s
	iters: 900, epoch: 9 | loss: 0.2241470
	speed: 0.0083s/iter; left time: 98.2425s
	iters: 1000, epoch: 9 | loss: 0.3206258
	speed: 0.0075s/iter; left time: 88.5931s
Epoch: 9 cost time: 8.728832483291626
Epoch: 9, Steps: 1066 | Train Loss: 0.2001680 Vali Loss: 0.1218875 Test Loss: 0.1799805
Validation loss decreased (0.133281 --> 0.121887).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.1786781
	speed: 0.0368s/iter; left time: 427.5011s
	iters: 200, epoch: 10 | loss: 0.4108548
	speed: 0.0096s/iter; left time: 111.0219s
	iters: 300, epoch: 10 | loss: 0.1827954
	speed: 0.0095s/iter; left time: 108.5967s
	iters: 400, epoch: 10 | loss: 0.1821516
	speed: 0.0089s/iter; left time: 100.3782s
	iters: 500, epoch: 10 | loss: 0.1414302
	speed: 0.0077s/iter; left time: 86.4307s
	iters: 600, epoch: 10 | loss: 0.1820443
	speed: 0.0065s/iter; left time: 72.4437s
	iters: 700, epoch: 10 | loss: 0.2377415
	speed: 0.0077s/iter; left time: 84.8195s
	iters: 800, epoch: 10 | loss: 0.1139606
	speed: 0.0089s/iter; left time: 97.6054s
	iters: 900, epoch: 10 | loss: 0.1847139
	speed: 0.0086s/iter; left time: 92.7154s
	iters: 1000, epoch: 10 | loss: 0.1305425
	speed: 0.0081s/iter; left time: 86.9993s
Epoch: 10 cost time: 8.908787488937378
Epoch: 10, Steps: 1066 | Train Loss: 0.1996739 Vali Loss: 0.1337689 Test Loss: 0.2184101
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.1727382
	speed: 0.0372s/iter; left time: 392.8452s
	iters: 200, epoch: 11 | loss: 0.1662335
	speed: 0.0086s/iter; left time: 89.4684s
	iters: 300, epoch: 11 | loss: 0.1316213
	speed: 0.0077s/iter; left time: 79.3779s
	iters: 400, epoch: 11 | loss: 0.2381797
	speed: 0.0079s/iter; left time: 81.3698s
	iters: 500, epoch: 11 | loss: 0.1785341
	speed: 0.0088s/iter; left time: 89.4217s
	iters: 600, epoch: 11 | loss: 0.1264398
	speed: 0.0079s/iter; left time: 79.9108s
	iters: 700, epoch: 11 | loss: 0.1087265
	speed: 0.0085s/iter; left time: 85.0987s
	iters: 800, epoch: 11 | loss: 0.1517027
	speed: 0.0087s/iter; left time: 86.0137s
	iters: 900, epoch: 11 | loss: 0.2350495
	speed: 0.0069s/iter; left time: 67.3671s
	iters: 1000, epoch: 11 | loss: 0.1305786
	speed: 0.0079s/iter; left time: 76.5296s
Epoch: 11 cost time: 8.676774501800537
Epoch: 11, Steps: 1066 | Train Loss: 0.1990731 Vali Loss: 0.1399525 Test Loss: 0.2329408
EarlyStopping counter: 2 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.1397184
	speed: 0.0377s/iter; left time: 357.7559s
	iters: 200, epoch: 12 | loss: 0.2682122
	speed: 0.0093s/iter; left time: 87.7664s
	iters: 300, epoch: 12 | loss: 0.2610793
	speed: 0.0096s/iter; left time: 89.4282s
	iters: 400, epoch: 12 | loss: 0.1656059
	speed: 0.0092s/iter; left time: 84.6963s
	iters: 500, epoch: 12 | loss: 0.1998350
	speed: 0.0091s/iter; left time: 82.5210s
	iters: 600, epoch: 12 | loss: 0.2459048
	speed: 0.0079s/iter; left time: 71.0908s
	iters: 700, epoch: 12 | loss: 0.1261143
	speed: 0.0077s/iter; left time: 68.3173s
	iters: 800, epoch: 12 | loss: 0.2208334
	speed: 0.0075s/iter; left time: 65.9643s
	iters: 900, epoch: 12 | loss: 0.1856548
	speed: 0.0076s/iter; left time: 66.4505s
	iters: 1000, epoch: 12 | loss: 0.1660627
	speed: 0.0075s/iter; left time: 64.1394s
Epoch: 12 cost time: 8.995675086975098
Epoch: 12, Steps: 1066 | Train Loss: 0.1988753 Vali Loss: 0.1319247 Test Loss: 0.2104362
EarlyStopping counter: 3 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.5671684
	speed: 0.0332s/iter; left time: 279.7395s
	iters: 200, epoch: 13 | loss: 0.1741285
	speed: 0.0084s/iter; left time: 69.6572s
	iters: 300, epoch: 13 | loss: 0.1149372
	speed: 0.0084s/iter; left time: 69.0471s
	iters: 400, epoch: 13 | loss: 0.1476913
	speed: 0.0083s/iter; left time: 67.8771s
	iters: 500, epoch: 13 | loss: 0.1630463
	speed: 0.0084s/iter; left time: 67.5546s
	iters: 600, epoch: 13 | loss: 0.1224944
	speed: 0.0084s/iter; left time: 66.7136s
	iters: 700, epoch: 13 | loss: 0.3261507
	speed: 0.0083s/iter; left time: 65.3180s
	iters: 800, epoch: 13 | loss: 0.2509820
	speed: 0.0083s/iter; left time: 64.4017s
	iters: 900, epoch: 13 | loss: 0.2287842
	speed: 0.0083s/iter; left time: 63.1085s
	iters: 1000, epoch: 13 | loss: 0.2374409
	speed: 0.0081s/iter; left time: 61.3613s
Epoch: 13 cost time: 8.886498212814331
Epoch: 13, Steps: 1066 | Train Loss: 0.1986999 Vali Loss: 0.1306156 Test Loss: 0.2066217
EarlyStopping counter: 4 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 14 | loss: 0.1447053
	speed: 0.0426s/iter; left time: 313.4341s
	iters: 200, epoch: 14 | loss: 0.3178750
	speed: 0.0075s/iter; left time: 54.5875s
	iters: 300, epoch: 14 | loss: 0.1598039
	speed: 0.0076s/iter; left time: 54.3108s
	iters: 400, epoch: 14 | loss: 0.1251656
	speed: 0.0070s/iter; left time: 49.5362s
	iters: 500, epoch: 14 | loss: 0.2483529
	speed: 0.0071s/iter; left time: 49.3124s
	iters: 600, epoch: 14 | loss: 0.2431577
	speed: 0.0070s/iter; left time: 47.7686s
	iters: 700, epoch: 14 | loss: 0.3569495
	speed: 0.0070s/iter; left time: 47.4870s
	iters: 800, epoch: 14 | loss: 0.2164181
	speed: 0.0076s/iter; left time: 50.7855s
	iters: 900, epoch: 14 | loss: 0.2959368
	speed: 0.0076s/iter; left time: 49.8263s
	iters: 1000, epoch: 14 | loss: 0.1721704
	speed: 0.0075s/iter; left time: 48.7310s
Epoch: 14 cost time: 8.04645037651062
Epoch: 14, Steps: 1066 | Train Loss: 0.1985786 Vali Loss: 0.1320812 Test Loss: 0.2112126
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTm2_336_96_DLinear_ETTm2_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15349<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.18033790588378906, mae:0.2716556191444397
