Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='DLinear', model_id='ETTm2_336_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=336, root_path='./dataset/', save_pred_values=False, seed=28649, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTm2_336_336_DLinear_ETTm2_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed28649>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33889
val 11185
test 11185
	iters: 100, epoch: 1 | loss: 0.3269765
	speed: 0.0156s/iter; left time: 328.7182s
	iters: 200, epoch: 1 | loss: 0.9438576
	speed: 0.0147s/iter; left time: 309.0525s
	iters: 300, epoch: 1 | loss: 0.4398144
	speed: 0.0171s/iter; left time: 356.7006s
	iters: 400, epoch: 1 | loss: 0.9572083
	speed: 0.0165s/iter; left time: 342.5544s
	iters: 500, epoch: 1 | loss: 0.8651322
	speed: 0.0175s/iter; left time: 362.7965s
	iters: 600, epoch: 1 | loss: 0.5132300
	speed: 0.0176s/iter; left time: 361.9149s
	iters: 700, epoch: 1 | loss: 0.4283207
	speed: 0.0158s/iter; left time: 322.6641s
	iters: 800, epoch: 1 | loss: 0.4859310
	speed: 0.0163s/iter; left time: 332.2127s
	iters: 900, epoch: 1 | loss: 0.7366721
	speed: 0.0160s/iter; left time: 324.9653s
	iters: 1000, epoch: 1 | loss: 0.6863164
	speed: 0.0175s/iter; left time: 354.0700s
Epoch: 1 cost time: 17.41606569290161
Epoch: 1, Steps: 1059 | Train Loss: 0.6663584 Vali Loss: 1.0177748 Test Loss: 2.4409027
Validation loss decreased (inf --> 1.017775).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.8455074
	speed: 0.0603s/iter; left time: 1207.7754s
	iters: 200, epoch: 2 | loss: 0.9635741
	speed: 0.0163s/iter; left time: 325.5119s
	iters: 300, epoch: 2 | loss: 0.6156444
	speed: 0.0169s/iter; left time: 334.9974s
	iters: 400, epoch: 2 | loss: 0.5837906
	speed: 0.0168s/iter; left time: 331.1835s
	iters: 500, epoch: 2 | loss: 0.5780603
	speed: 0.0168s/iter; left time: 330.3310s
	iters: 600, epoch: 2 | loss: 0.7500324
	speed: 0.0177s/iter; left time: 344.8803s
	iters: 700, epoch: 2 | loss: 0.4590510
	speed: 0.0159s/iter; left time: 308.3235s
	iters: 800, epoch: 2 | loss: 0.8390605
	speed: 0.0175s/iter; left time: 338.0296s
	iters: 900, epoch: 2 | loss: 0.5543984
	speed: 0.0186s/iter; left time: 357.2809s
	iters: 1000, epoch: 2 | loss: 0.6231062
	speed: 0.0175s/iter; left time: 334.9071s
Epoch: 2 cost time: 17.910477876663208
Epoch: 2, Steps: 1059 | Train Loss: 0.6654384 Vali Loss: 2.1111059 Test Loss: 6.8451228
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.2551704
	speed: 0.0610s/iter; left time: 1156.9549s
	iters: 200, epoch: 3 | loss: 0.3132595
	speed: 0.0174s/iter; left time: 328.4536s
	iters: 300, epoch: 3 | loss: 0.3210902
	speed: 0.0175s/iter; left time: 328.2266s
	iters: 400, epoch: 3 | loss: 0.2872717
	speed: 0.0177s/iter; left time: 330.8625s
	iters: 500, epoch: 3 | loss: 0.4709373
	speed: 0.0171s/iter; left time: 317.3891s
	iters: 600, epoch: 3 | loss: 0.4840089
	speed: 0.0178s/iter; left time: 328.6215s
	iters: 700, epoch: 3 | loss: 0.4951778
	speed: 0.0185s/iter; left time: 340.2755s
	iters: 800, epoch: 3 | loss: 0.4326285
	speed: 0.0169s/iter; left time: 309.1270s
	iters: 900, epoch: 3 | loss: 0.3651513
	speed: 0.0165s/iter; left time: 299.4475s
	iters: 1000, epoch: 3 | loss: 0.2976657
	speed: 0.0166s/iter; left time: 300.5972s
Epoch: 3 cost time: 18.081182718276978
Epoch: 3, Steps: 1059 | Train Loss: 0.4581581 Vali Loss: 0.7388866 Test Loss: 1.9547379
Validation loss decreased (1.017775 --> 0.738887).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.2789694
	speed: 0.0678s/iter; left time: 1213.4224s
	iters: 200, epoch: 4 | loss: 0.4086438
	speed: 0.0177s/iter; left time: 315.6055s
	iters: 300, epoch: 4 | loss: 0.4244650
	speed: 0.0176s/iter; left time: 311.3646s
	iters: 400, epoch: 4 | loss: 0.3530766
	speed: 0.0179s/iter; left time: 314.4538s
	iters: 500, epoch: 4 | loss: 0.3557141
	speed: 0.0184s/iter; left time: 321.3024s
	iters: 600, epoch: 4 | loss: 0.5075350
	speed: 0.0187s/iter; left time: 326.2518s
	iters: 700, epoch: 4 | loss: 0.3861448
	speed: 0.0173s/iter; left time: 299.1136s
	iters: 800, epoch: 4 | loss: 0.3320250
	speed: 0.0167s/iter; left time: 286.5560s
	iters: 900, epoch: 4 | loss: 0.6547765
	speed: 0.0161s/iter; left time: 274.5835s
	iters: 1000, epoch: 4 | loss: 0.3967264
	speed: 0.0174s/iter; left time: 295.2540s
Epoch: 4 cost time: 18.522635459899902
Epoch: 4, Steps: 1059 | Train Loss: 0.4051727 Vali Loss: 0.3105780 Test Loss: 0.5201930
Validation loss decreased (0.738887 --> 0.310578).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.5158641
	speed: 0.0652s/iter; left time: 1098.0639s
	iters: 200, epoch: 5 | loss: 0.4164352
	speed: 0.0182s/iter; left time: 304.6803s
	iters: 300, epoch: 5 | loss: 0.3957295
	speed: 0.0179s/iter; left time: 298.5749s
	iters: 400, epoch: 5 | loss: 0.4487662
	speed: 0.0178s/iter; left time: 295.1839s
	iters: 500, epoch: 5 | loss: 0.2881775
	speed: 0.0178s/iter; left time: 293.1818s
	iters: 600, epoch: 5 | loss: 0.3550977
	speed: 0.0170s/iter; left time: 277.7490s
	iters: 700, epoch: 5 | loss: 0.3604963
	speed: 0.0173s/iter; left time: 281.6129s
	iters: 800, epoch: 5 | loss: 0.2779262
	speed: 0.0168s/iter; left time: 271.2689s
	iters: 900, epoch: 5 | loss: 0.3303240
	speed: 0.0163s/iter; left time: 262.0860s
	iters: 1000, epoch: 5 | loss: 0.7443340
	speed: 0.0165s/iter; left time: 263.1154s
Epoch: 5 cost time: 18.221211910247803
Epoch: 5, Steps: 1059 | Train Loss: 0.3793307 Vali Loss: 0.3673406 Test Loss: 0.7548096
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.4920250
	speed: 0.0602s/iter; left time: 950.1137s
	iters: 200, epoch: 6 | loss: 0.5970573
	speed: 0.0160s/iter; left time: 250.9364s
	iters: 300, epoch: 6 | loss: 0.5317793
	speed: 0.0171s/iter; left time: 266.6388s
	iters: 400, epoch: 6 | loss: 0.1946737
	speed: 0.0170s/iter; left time: 263.8457s
	iters: 500, epoch: 6 | loss: 0.6246485
	speed: 0.0180s/iter; left time: 276.2314s
	iters: 600, epoch: 6 | loss: 0.3225329
	speed: 0.0165s/iter; left time: 252.2442s
	iters: 700, epoch: 6 | loss: 0.2592071
	speed: 0.0160s/iter; left time: 243.0773s
	iters: 800, epoch: 6 | loss: 0.5138468
	speed: 0.0152s/iter; left time: 228.9625s
	iters: 900, epoch: 6 | loss: 0.2047236
	speed: 0.0168s/iter; left time: 251.5098s
	iters: 1000, epoch: 6 | loss: 0.2302362
	speed: 0.0176s/iter; left time: 262.3538s
Epoch: 6 cost time: 17.670697927474976
Epoch: 6, Steps: 1059 | Train Loss: 0.3652416 Vali Loss: 0.2689770 Test Loss: 0.4707948
Validation loss decreased (0.310578 --> 0.268977).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.6578076
	speed: 0.0671s/iter; left time: 987.8948s
	iters: 200, epoch: 7 | loss: 0.2715197
	speed: 0.0178s/iter; left time: 260.2685s
	iters: 300, epoch: 7 | loss: 0.5129395
	speed: 0.0172s/iter; left time: 250.4355s
	iters: 400, epoch: 7 | loss: 0.2417765
	speed: 0.0183s/iter; left time: 263.8151s
	iters: 500, epoch: 7 | loss: 0.4294581
	speed: 0.0175s/iter; left time: 251.3879s
	iters: 600, epoch: 7 | loss: 0.4546263
	speed: 0.0170s/iter; left time: 241.9550s
	iters: 700, epoch: 7 | loss: 0.5807545
	speed: 0.0169s/iter; left time: 239.2587s
	iters: 800, epoch: 7 | loss: 0.2131775
	speed: 0.0145s/iter; left time: 203.1842s
	iters: 900, epoch: 7 | loss: 0.3191296
	speed: 0.0165s/iter; left time: 230.1687s
	iters: 1000, epoch: 7 | loss: 0.2062063
	speed: 0.0146s/iter; left time: 201.9454s
Epoch: 7 cost time: 17.624513864517212
Epoch: 7, Steps: 1059 | Train Loss: 0.3570240 Vali Loss: 0.3423589 Test Loss: 0.7056398
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.3082018
	speed: 0.0675s/iter; left time: 922.2524s
	iters: 200, epoch: 8 | loss: 0.4164099
	speed: 0.0169s/iter; left time: 229.2152s
	iters: 300, epoch: 8 | loss: 0.2989256
	speed: 0.0175s/iter; left time: 235.7524s
	iters: 400, epoch: 8 | loss: 0.2589471
	speed: 0.0159s/iter; left time: 212.9008s
	iters: 500, epoch: 8 | loss: 0.2180008
	speed: 0.0180s/iter; left time: 238.3385s
	iters: 600, epoch: 8 | loss: 0.3515880
	speed: 0.0171s/iter; left time: 225.2636s
	iters: 700, epoch: 8 | loss: 0.1922948
	speed: 0.0169s/iter; left time: 220.3157s
	iters: 800, epoch: 8 | loss: 0.2190567
	speed: 0.0179s/iter; left time: 231.5474s
	iters: 900, epoch: 8 | loss: 0.5078546
	speed: 0.0180s/iter; left time: 231.1653s
	iters: 1000, epoch: 8 | loss: 0.4526056
	speed: 0.0157s/iter; left time: 200.9091s
Epoch: 8 cost time: 17.99838089942932
Epoch: 8, Steps: 1059 | Train Loss: 0.3528566 Vali Loss: 0.3176273 Test Loss: 0.6374118
EarlyStopping counter: 2 out of 5
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.3339899
	speed: 0.0667s/iter; left time: 841.5801s
	iters: 200, epoch: 9 | loss: 0.4927397
	speed: 0.0172s/iter; left time: 214.8046s
	iters: 300, epoch: 9 | loss: 0.1892936
	speed: 0.0181s/iter; left time: 224.3290s
	iters: 400, epoch: 9 | loss: 0.4894896
	speed: 0.0170s/iter; left time: 208.8258s
	iters: 500, epoch: 9 | loss: 0.1496779
	speed: 0.0146s/iter; left time: 177.6709s
	iters: 600, epoch: 9 | loss: 0.5733861
	speed: 0.0170s/iter; left time: 206.0405s
	iters: 700, epoch: 9 | loss: 0.3317287
	speed: 0.0151s/iter; left time: 180.9081s
	iters: 800, epoch: 9 | loss: 0.2232699
	speed: 0.0179s/iter; left time: 212.9925s
	iters: 900, epoch: 9 | loss: 0.3193069
	speed: 0.0182s/iter; left time: 214.8830s
	iters: 1000, epoch: 9 | loss: 0.5797555
	speed: 0.0174s/iter; left time: 203.8995s
Epoch: 9 cost time: 17.837992906570435
Epoch: 9, Steps: 1059 | Train Loss: 0.3505294 Vali Loss: 0.2769112 Test Loss: 0.5041772
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.2439061
	speed: 0.0614s/iter; left time: 709.6846s
	iters: 200, epoch: 10 | loss: 0.4949799
	speed: 0.0170s/iter; left time: 194.7126s
	iters: 300, epoch: 10 | loss: 0.1434081
	speed: 0.0156s/iter; left time: 177.5300s
	iters: 400, epoch: 10 | loss: 0.3102644
	speed: 0.0152s/iter; left time: 171.4066s
	iters: 500, epoch: 10 | loss: 0.2526055
	speed: 0.0169s/iter; left time: 188.9017s
	iters: 600, epoch: 10 | loss: 0.2693991
	speed: 0.0179s/iter; left time: 197.6610s
	iters: 700, epoch: 10 | loss: 0.7031826
	speed: 0.0180s/iter; left time: 196.8241s
	iters: 800, epoch: 10 | loss: 0.7568249
	speed: 0.0170s/iter; left time: 184.6412s
	iters: 900, epoch: 10 | loss: 0.2699772
	speed: 0.0170s/iter; left time: 182.7758s
	iters: 1000, epoch: 10 | loss: 0.3073560
	speed: 0.0163s/iter; left time: 173.7454s
Epoch: 10 cost time: 17.717854499816895
Epoch: 10, Steps: 1059 | Train Loss: 0.3492234 Vali Loss: 0.2764742 Test Loss: 0.5088874
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.5221821
	speed: 0.0619s/iter; left time: 649.5180s
	iters: 200, epoch: 11 | loss: 0.3924676
	speed: 0.0152s/iter; left time: 157.5919s
	iters: 300, epoch: 11 | loss: 0.2603364
	speed: 0.0163s/iter; left time: 167.7816s
	iters: 400, epoch: 11 | loss: 0.2196294
	speed: 0.0174s/iter; left time: 177.4051s
	iters: 500, epoch: 11 | loss: 0.2285626
	speed: 0.0162s/iter; left time: 163.1936s
	iters: 600, epoch: 11 | loss: 0.4635271
	speed: 0.0165s/iter; left time: 165.1708s
	iters: 700, epoch: 11 | loss: 0.2554520
	speed: 0.0162s/iter; left time: 160.3756s
	iters: 800, epoch: 11 | loss: 0.5665435
	speed: 0.0173s/iter; left time: 169.8219s
	iters: 900, epoch: 11 | loss: 0.3028023
	speed: 0.0172s/iter; left time: 166.6017s
	iters: 1000, epoch: 11 | loss: 0.2866989
	speed: 0.0158s/iter; left time: 151.8576s
Epoch: 11 cost time: 17.226824283599854
Epoch: 11, Steps: 1059 | Train Loss: 0.3483649 Vali Loss: 0.2841697 Test Loss: 0.5358937
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTm2_336_336_DLinear_ETTm2_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed28649<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
mse:0.4712262749671936, mae:0.4514954090118408
