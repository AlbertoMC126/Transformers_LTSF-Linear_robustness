Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='NLinear', model_id='traffic_336_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=15349, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_336_96_NLinear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15349>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11849
val 1661
test 3413
	iters: 100, epoch: 1 | loss: 0.5706747
	speed: 0.3148s/iter; left time: 4627.2320s
	iters: 200, epoch: 1 | loss: 0.9921672
	speed: 0.3000s/iter; left time: 4379.8530s
	iters: 300, epoch: 1 | loss: 0.9062440
	speed: 0.2998s/iter; left time: 4347.4003s
	iters: 400, epoch: 1 | loss: 4.6584396
	speed: 0.3001s/iter; left time: 4321.7697s
	iters: 500, epoch: 1 | loss: 0.8457752
	speed: 0.3002s/iter; left time: 4292.6484s
	iters: 600, epoch: 1 | loss: 1.0447927
	speed: 0.3005s/iter; left time: 4266.7740s
	iters: 700, epoch: 1 | loss: 0.8433015
	speed: 0.3004s/iter; left time: 4236.2493s
Epoch: 1 cost time: 223.78933334350586
Epoch: 1, Steps: 740 | Train Loss: 1.0689083 Vali Loss: 1.5941317 Test Loss: 1.6378065
Validation loss decreased (inf --> 1.594132).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 1.0850672
	speed: 0.6097s/iter; left time: 8512.4859s
	iters: 200, epoch: 2 | loss: 1.2059226
	speed: 0.2997s/iter; left time: 4154.7316s
	iters: 300, epoch: 2 | loss: 1.2165670
	speed: 0.3000s/iter; left time: 4128.1127s
	iters: 400, epoch: 2 | loss: 0.7624872
	speed: 0.3000s/iter; left time: 4097.6365s
	iters: 500, epoch: 2 | loss: 1.7169131
	speed: 0.2997s/iter; left time: 4064.3092s
	iters: 600, epoch: 2 | loss: 1.1890132
	speed: 0.3000s/iter; left time: 4038.8348s
	iters: 700, epoch: 2 | loss: 0.9659300
	speed: 0.2999s/iter; left time: 4006.9071s
Epoch: 2 cost time: 221.98826241493225
Epoch: 2, Steps: 740 | Train Loss: 1.1748343 Vali Loss: 1.6784557 Test Loss: 1.6136104
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.3695526
	speed: 0.6088s/iter; left time: 8049.1905s
	iters: 200, epoch: 3 | loss: 0.3646277
	speed: 0.3003s/iter; left time: 3939.9779s
	iters: 300, epoch: 3 | loss: 0.3093088
	speed: 0.3007s/iter; left time: 3915.7171s
	iters: 400, epoch: 3 | loss: 0.2805937
	speed: 0.2997s/iter; left time: 3871.8625s
	iters: 500, epoch: 3 | loss: 0.3498071
	speed: 0.3009s/iter; left time: 3857.9729s
	iters: 600, epoch: 3 | loss: 0.3367274
	speed: 0.3001s/iter; left time: 3817.5762s
	iters: 700, epoch: 3 | loss: 0.3079625
	speed: 0.2996s/iter; left time: 3781.3039s
Epoch: 3 cost time: 222.15470623970032
Epoch: 3, Steps: 740 | Train Loss: 0.3484081 Vali Loss: 0.4960785 Test Loss: 0.5710020
Validation loss decreased (1.594132 --> 0.496079).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.2728175
	speed: 0.6100s/iter; left time: 7613.1934s
	iters: 200, epoch: 4 | loss: 0.2780916
	speed: 0.3000s/iter; left time: 3714.6719s
	iters: 300, epoch: 4 | loss: 0.2725208
	speed: 0.3001s/iter; left time: 3685.8251s
	iters: 400, epoch: 4 | loss: 0.2384625
	speed: 0.2994s/iter; left time: 3646.4467s
	iters: 500, epoch: 4 | loss: 0.2943217
	speed: 0.3002s/iter; left time: 3626.5080s
	iters: 600, epoch: 4 | loss: 0.2735412
	speed: 0.3000s/iter; left time: 3594.8578s
	iters: 700, epoch: 4 | loss: 0.2604706
	speed: 0.2997s/iter; left time: 3560.8982s
Epoch: 4 cost time: 222.00276589393616
Epoch: 4, Steps: 740 | Train Loss: 0.2781183 Vali Loss: 0.4042768 Test Loss: 0.4878166
Validation loss decreased (0.496079 --> 0.404277).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.2674775
	speed: 0.6098s/iter; left time: 7159.9259s
	iters: 200, epoch: 5 | loss: 0.2484333
	speed: 0.2999s/iter; left time: 3491.4511s
	iters: 300, epoch: 5 | loss: 0.2922265
	speed: 0.3010s/iter; left time: 3473.4852s
	iters: 400, epoch: 5 | loss: 0.2308567
	speed: 0.3001s/iter; left time: 3433.3864s
	iters: 500, epoch: 5 | loss: 0.2372988
	speed: 0.2999s/iter; left time: 3401.0828s
	iters: 600, epoch: 5 | loss: 0.2784333
	speed: 0.2997s/iter; left time: 3369.4705s
	iters: 700, epoch: 5 | loss: 0.2422176
	speed: 0.3001s/iter; left time: 3343.0554s
Epoch: 5 cost time: 222.06267666816711
Epoch: 5, Steps: 740 | Train Loss: 0.2571754 Vali Loss: 0.3704268 Test Loss: 0.4510680
Validation loss decreased (0.404277 --> 0.370427).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.2420516
	speed: 0.6096s/iter; left time: 6706.1895s
	iters: 200, epoch: 6 | loss: 0.2600294
	speed: 0.3003s/iter; left time: 3273.3651s
	iters: 300, epoch: 6 | loss: 0.2524240
	speed: 0.2997s/iter; left time: 3237.5099s
	iters: 400, epoch: 6 | loss: 0.3025263
	speed: 0.3000s/iter; left time: 3210.5549s
	iters: 500, epoch: 6 | loss: 0.2634867
	speed: 0.3005s/iter; left time: 3185.6717s
	iters: 600, epoch: 6 | loss: 0.2651888
	speed: 0.3003s/iter; left time: 3153.4576s
	iters: 700, epoch: 6 | loss: 0.2226524
	speed: 0.2998s/iter; left time: 3118.1177s
Epoch: 6 cost time: 222.1664650440216
Epoch: 6, Steps: 740 | Train Loss: 0.2467397 Vali Loss: 0.3601690 Test Loss: 0.4382944
Validation loss decreased (0.370427 --> 0.360169).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.2423985
	speed: 0.6081s/iter; left time: 6239.5162s
	iters: 200, epoch: 7 | loss: 0.2076654
	speed: 0.2997s/iter; left time: 3045.7366s
	iters: 300, epoch: 7 | loss: 0.2309732
	speed: 0.2998s/iter; left time: 3016.4829s
	iters: 400, epoch: 7 | loss: 0.2228149
	speed: 0.2998s/iter; left time: 2986.1627s
	iters: 500, epoch: 7 | loss: 0.2682222
	speed: 0.3001s/iter; left time: 2959.5848s
	iters: 600, epoch: 7 | loss: 0.2186571
	speed: 0.2998s/iter; left time: 2926.1320s
	iters: 700, epoch: 7 | loss: 0.2849481
	speed: 0.2999s/iter; left time: 2897.0323s
Epoch: 7 cost time: 221.96758651733398
Epoch: 7, Steps: 740 | Train Loss: 0.2414001 Vali Loss: 0.3534365 Test Loss: 0.4306501
Validation loss decreased (0.360169 --> 0.353436).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.2090048
	speed: 0.6120s/iter; left time: 5826.5842s
	iters: 200, epoch: 8 | loss: 0.2353403
	speed: 0.3006s/iter; left time: 2832.3041s
	iters: 300, epoch: 8 | loss: 0.2523448
	speed: 0.2999s/iter; left time: 2795.8105s
	iters: 400, epoch: 8 | loss: 0.2483262
	speed: 0.3000s/iter; left time: 2766.4590s
	iters: 500, epoch: 8 | loss: 0.2340713
	speed: 0.3001s/iter; left time: 2736.8064s
	iters: 600, epoch: 8 | loss: 0.2265940
	speed: 0.2996s/iter; left time: 2703.0976s
	iters: 700, epoch: 8 | loss: 0.2424123
	speed: 0.3000s/iter; left time: 2676.0785s
Epoch: 8 cost time: 222.18420720100403
Epoch: 8, Steps: 740 | Train Loss: 0.2382489 Vali Loss: 0.3507029 Test Loss: 0.4274062
Validation loss decreased (0.353436 --> 0.350703).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.2411681
	speed: 0.6110s/iter; left time: 5364.8678s
	iters: 200, epoch: 9 | loss: 0.2379770
	speed: 0.3000s/iter; left time: 2604.1993s
	iters: 300, epoch: 9 | loss: 0.2215159
	speed: 0.3009s/iter; left time: 2582.2185s
	iters: 400, epoch: 9 | loss: 0.2079357
	speed: 0.3000s/iter; left time: 2544.5242s
	iters: 500, epoch: 9 | loss: 0.2519950
	speed: 0.2997s/iter; left time: 2511.4688s
	iters: 600, epoch: 9 | loss: 0.2479642
	speed: 0.3000s/iter; left time: 2483.9197s
	iters: 700, epoch: 9 | loss: 0.2110986
	speed: 0.3000s/iter; left time: 2454.6237s
Epoch: 9 cost time: 222.10751938819885
Epoch: 9, Steps: 740 | Train Loss: 0.2363831 Vali Loss: 0.3493319 Test Loss: 0.4249668
Validation loss decreased (0.350703 --> 0.349332).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.2263262
	speed: 0.6098s/iter; left time: 4903.1911s
	iters: 200, epoch: 10 | loss: 0.2410869
	speed: 0.3010s/iter; left time: 2390.4914s
	iters: 300, epoch: 10 | loss: 0.2724223
	speed: 0.3011s/iter; left time: 2360.9798s
	iters: 400, epoch: 10 | loss: 0.2552174
	speed: 0.3014s/iter; left time: 2333.3231s
	iters: 500, epoch: 10 | loss: 0.2227727
	speed: 0.3002s/iter; left time: 2293.5199s
	iters: 600, epoch: 10 | loss: 0.2130049
	speed: 0.3006s/iter; left time: 2266.6841s
	iters: 700, epoch: 10 | loss: 0.2231741
	speed: 0.3011s/iter; left time: 2240.1647s
Epoch: 10 cost time: 222.63910031318665
Epoch: 10, Steps: 740 | Train Loss: 0.2352414 Vali Loss: 0.3478031 Test Loss: 0.4242062
Validation loss decreased (0.349332 --> 0.347803).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.1934237
	speed: 0.6104s/iter; left time: 4456.7931s
	iters: 200, epoch: 11 | loss: 0.2697406
	speed: 0.3005s/iter; left time: 2163.8210s
	iters: 300, epoch: 11 | loss: 0.2370057
	speed: 0.3008s/iter; left time: 2135.7108s
	iters: 400, epoch: 11 | loss: 0.2496461
	speed: 0.2999s/iter; left time: 2099.7298s
	iters: 500, epoch: 11 | loss: 0.2448450
	speed: 0.3002s/iter; left time: 2071.5537s
	iters: 600, epoch: 11 | loss: 0.2211108
	speed: 0.3008s/iter; left time: 2045.8316s
	iters: 700, epoch: 11 | loss: 0.2118404
	speed: 0.3010s/iter; left time: 2017.0909s
Epoch: 11 cost time: 222.56513571739197
Epoch: 11, Steps: 740 | Train Loss: 0.2346929 Vali Loss: 0.3470666 Test Loss: 0.4234975
Validation loss decreased (0.347803 --> 0.347067).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.2568591
	speed: 0.6116s/iter; left time: 4012.8538s
	iters: 200, epoch: 12 | loss: 0.2506177
	speed: 0.3001s/iter; left time: 1938.8811s
	iters: 300, epoch: 12 | loss: 0.2548526
	speed: 0.3006s/iter; left time: 1912.3679s
	iters: 400, epoch: 12 | loss: 0.2371454
	speed: 0.3002s/iter; left time: 1879.4498s
	iters: 500, epoch: 12 | loss: 0.2115714
	speed: 0.3012s/iter; left time: 1855.6298s
	iters: 600, epoch: 12 | loss: 0.2164120
	speed: 0.3005s/iter; left time: 1821.4832s
	iters: 700, epoch: 12 | loss: 0.2606388
	speed: 0.3006s/iter; left time: 1791.8050s
Epoch: 12 cost time: 222.54612803459167
Epoch: 12, Steps: 740 | Train Loss: 0.2343060 Vali Loss: 0.3468685 Test Loss: 0.4232184
Validation loss decreased (0.347067 --> 0.346868).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.2439289
	speed: 0.6090s/iter; left time: 3544.8443s
	iters: 200, epoch: 13 | loss: 0.2191071
	speed: 0.3009s/iter; left time: 1721.2012s
	iters: 300, epoch: 13 | loss: 0.2308003
	speed: 0.3001s/iter; left time: 1686.9780s
	iters: 400, epoch: 13 | loss: 0.2167808
	speed: 0.3009s/iter; left time: 1661.4617s
	iters: 500, epoch: 13 | loss: 0.2281518
	speed: 0.3006s/iter; left time: 1629.6770s
	iters: 600, epoch: 13 | loss: 0.2655829
	speed: 0.3002s/iter; left time: 1597.2815s
	iters: 700, epoch: 13 | loss: 0.2300028
	speed: 0.3009s/iter; left time: 1571.0362s
Epoch: 13 cost time: 222.34772992134094
Epoch: 13, Steps: 740 | Train Loss: 0.2341746 Vali Loss: 0.3469602 Test Loss: 0.4231106
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 14 | loss: 0.2486196
	speed: 0.6079s/iter; left time: 3088.5038s
	iters: 200, epoch: 14 | loss: 0.2577052
	speed: 0.2999s/iter; left time: 1493.9301s
	iters: 300, epoch: 14 | loss: 0.2202023
	speed: 0.2999s/iter; left time: 1463.9255s
	iters: 400, epoch: 14 | loss: 0.2234678
	speed: 0.3007s/iter; left time: 1437.5794s
	iters: 500, epoch: 14 | loss: 0.2450345
	speed: 0.3010s/iter; left time: 1408.9432s
	iters: 600, epoch: 14 | loss: 0.2238237
	speed: 0.3037s/iter; left time: 1391.0655s
	iters: 700, epoch: 14 | loss: 0.2130834
	speed: 0.3033s/iter; left time: 1359.2692s
Epoch: 14 cost time: 222.94860363006592
Epoch: 14, Steps: 740 | Train Loss: 0.2340534 Vali Loss: 0.3467405 Test Loss: 0.4231144
Validation loss decreased (0.346868 --> 0.346741).  Saving model ...
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 15 | loss: 0.2283639
	speed: 0.6105s/iter; left time: 2650.3162s
	iters: 200, epoch: 15 | loss: 0.2693641
	speed: 0.3001s/iter; left time: 1272.9223s
	iters: 300, epoch: 15 | loss: 0.2463724
	speed: 0.2998s/iter; left time: 1241.4841s
	iters: 400, epoch: 15 | loss: 0.2307646
	speed: 0.3001s/iter; left time: 1212.5610s
	iters: 500, epoch: 15 | loss: 0.2378050
	speed: 0.3009s/iter; left time: 1185.8161s
	iters: 600, epoch: 15 | loss: 0.2425077
	speed: 0.3008s/iter; left time: 1155.2562s
	iters: 700, epoch: 15 | loss: 0.2170254
	speed: 0.3001s/iter; left time: 1122.7958s
Epoch: 15 cost time: 222.23945426940918
Epoch: 15, Steps: 740 | Train Loss: 0.2339950 Vali Loss: 0.3464605 Test Loss: 0.4230558
Validation loss decreased (0.346741 --> 0.346461).  Saving model ...
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 16 | loss: 0.2185539
	speed: 0.6089s/iter; left time: 2192.6380s
	iters: 200, epoch: 16 | loss: 0.1887926
	speed: 0.3002s/iter; left time: 1050.8728s
	iters: 300, epoch: 16 | loss: 0.2046039
	speed: 0.3004s/iter; left time: 1021.5216s
	iters: 400, epoch: 16 | loss: 0.2281470
	speed: 0.3010s/iter; left time: 993.5331s
	iters: 500, epoch: 16 | loss: 0.2165096
	speed: 0.3018s/iter; left time: 965.9250s
	iters: 600, epoch: 16 | loss: 0.2245055
	speed: 0.3008s/iter; left time: 932.6320s
	iters: 700, epoch: 16 | loss: 0.2225737
	speed: 0.3003s/iter; left time: 901.0665s
Epoch: 16 cost time: 222.48915791511536
Epoch: 16, Steps: 740 | Train Loss: 0.2339282 Vali Loss: 0.3463924 Test Loss: 0.4230483
Validation loss decreased (0.346461 --> 0.346392).  Saving model ...
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 17 | loss: 0.2425252
	speed: 0.6096s/iter; left time: 1744.1811s
	iters: 200, epoch: 17 | loss: 0.2776366
	speed: 0.3001s/iter; left time: 828.5780s
	iters: 300, epoch: 17 | loss: 0.2456066
	speed: 0.3000s/iter; left time: 798.2688s
	iters: 400, epoch: 17 | loss: 0.2072007
	speed: 0.2999s/iter; left time: 768.0074s
	iters: 500, epoch: 17 | loss: 0.2018156
	speed: 0.3009s/iter; left time: 740.5156s
	iters: 600, epoch: 17 | loss: 0.2766151
	speed: 0.3101s/iter; left time: 732.0684s
	iters: 700, epoch: 17 | loss: 0.2497751
	speed: 0.3060s/iter; left time: 691.8272s
Epoch: 17 cost time: 223.95157670974731
Epoch: 17, Steps: 740 | Train Loss: 0.2339540 Vali Loss: 0.3468032 Test Loss: 0.4230453
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 18 | loss: 0.2249638
	speed: 0.6135s/iter; left time: 1301.2151s
	iters: 200, epoch: 18 | loss: 0.2192621
	speed: 0.3027s/iter; left time: 611.7743s
	iters: 300, epoch: 18 | loss: 0.2297475
	speed: 0.3023s/iter; left time: 580.7700s
	iters: 400, epoch: 18 | loss: 0.2242531
	speed: 0.3000s/iter; left time: 546.2264s
	iters: 500, epoch: 18 | loss: 0.2469310
	speed: 0.3035s/iter; left time: 522.3502s
	iters: 600, epoch: 18 | loss: 0.2221614
	speed: 0.3029s/iter; left time: 490.9875s
	iters: 700, epoch: 18 | loss: 0.2368893
	speed: 0.3015s/iter; left time: 458.5714s
Epoch: 18 cost time: 223.80070853233337
Epoch: 18, Steps: 740 | Train Loss: 0.2339225 Vali Loss: 0.3466967 Test Loss: 0.4230450
EarlyStopping counter: 2 out of 5
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 19 | loss: 0.2096697
	speed: 0.6117s/iter; left time: 844.7540s
	iters: 200, epoch: 19 | loss: 0.2551751
	speed: 0.3017s/iter; left time: 386.4731s
	iters: 300, epoch: 19 | loss: 0.2299889
	speed: 0.3015s/iter; left time: 356.0418s
	iters: 400, epoch: 19 | loss: 0.1952327
	speed: 0.3015s/iter; left time: 325.9273s
	iters: 500, epoch: 19 | loss: 0.2327317
	speed: 0.3018s/iter; left time: 296.1108s
	iters: 600, epoch: 19 | loss: 0.2233384
	speed: 0.3018s/iter; left time: 265.8485s
	iters: 700, epoch: 19 | loss: 0.2339780
	speed: 0.3013s/iter; left time: 235.2905s
Epoch: 19 cost time: 223.2377893924713
Epoch: 19, Steps: 740 | Train Loss: 0.2338916 Vali Loss: 0.3470410 Test Loss: 0.4230447
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 20 | loss: 0.2407405
	speed: 0.6097s/iter; left time: 390.8330s
	iters: 200, epoch: 20 | loss: 0.2422284
	speed: 0.3015s/iter; left time: 163.1314s
	iters: 300, epoch: 20 | loss: 0.2455242
	speed: 0.3015s/iter; left time: 132.9771s
	iters: 400, epoch: 20 | loss: 0.2327398
	speed: 0.3019s/iter; left time: 102.9557s
	iters: 500, epoch: 20 | loss: 0.2285563
	speed: 0.3018s/iter; left time: 72.7397s
	iters: 600, epoch: 20 | loss: 0.2226073
	speed: 0.3017s/iter; left time: 42.5333s
	iters: 700, epoch: 20 | loss: 0.2567103
	speed: 0.3011s/iter; left time: 12.3447s
Epoch: 20 cost time: 223.16793942451477
Epoch: 20, Steps: 740 | Train Loss: 0.2339322 Vali Loss: 0.3465852 Test Loss: 0.4230449
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.9073486328125e-08
>>>>>>>testing : traffic_336_96_NLinear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15349<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3413
mse:0.4233287572860718, mae:0.294404536485672
