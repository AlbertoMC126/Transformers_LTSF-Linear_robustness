Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='Linear', model_id='ETTm2_336_192', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=192, root_path='./dataset/', save_pred_values=False, seed=3293, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTm2_336_192_Linear_ETTm2_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3293>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34033
val 11329
test 11329
	iters: 100, epoch: 1 | loss: 0.4084415
	speed: 0.0058s/iter; left time: 122.1467s
	iters: 200, epoch: 1 | loss: 0.3225134
	speed: 0.0053s/iter; left time: 112.4718s
	iters: 300, epoch: 1 | loss: 0.7544416
	speed: 0.0053s/iter; left time: 110.9252s
	iters: 400, epoch: 1 | loss: 0.4378669
	speed: 0.0062s/iter; left time: 128.7241s
	iters: 500, epoch: 1 | loss: 0.2687081
	speed: 0.0061s/iter; left time: 127.5159s
	iters: 600, epoch: 1 | loss: 0.8149440
	speed: 0.0059s/iter; left time: 122.1882s
	iters: 700, epoch: 1 | loss: 0.3222377
	speed: 0.0059s/iter; left time: 120.4878s
	iters: 800, epoch: 1 | loss: 0.6549165
	speed: 0.0061s/iter; left time: 123.8392s
	iters: 900, epoch: 1 | loss: 0.3413801
	speed: 0.0054s/iter; left time: 109.2628s
	iters: 1000, epoch: 1 | loss: 0.8869814
	speed: 0.0040s/iter; left time: 80.4850s
Epoch: 1 cost time: 5.836228609085083
Epoch: 1, Steps: 1063 | Train Loss: 0.5143857 Vali Loss: 0.6574211 Test Loss: 1.7377744
Validation loss decreased (inf --> 0.657421).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.2647701
	speed: 0.0194s/iter; left time: 389.4196s
	iters: 200, epoch: 2 | loss: 0.3418637
	speed: 0.0056s/iter; left time: 110.9892s
	iters: 300, epoch: 2 | loss: 0.2729476
	speed: 0.0064s/iter; left time: 127.2146s
	iters: 400, epoch: 2 | loss: 0.6509930
	speed: 0.0062s/iter; left time: 121.9663s
	iters: 500, epoch: 2 | loss: 1.6500480
	speed: 0.0064s/iter; left time: 126.5124s
	iters: 600, epoch: 2 | loss: 0.2943747
	speed: 0.0056s/iter; left time: 110.4077s
	iters: 700, epoch: 2 | loss: 0.2311270
	speed: 0.0052s/iter; left time: 101.5847s
	iters: 800, epoch: 2 | loss: 0.3072086
	speed: 0.0053s/iter; left time: 101.8598s
	iters: 900, epoch: 2 | loss: 0.4611645
	speed: 0.0053s/iter; left time: 102.8578s
	iters: 1000, epoch: 2 | loss: 0.3766311
	speed: 0.0057s/iter; left time: 109.8915s
Epoch: 2 cost time: 6.089910984039307
Epoch: 2, Steps: 1063 | Train Loss: 0.4999797 Vali Loss: 0.6976625 Test Loss: 1.5478213
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.2606247
	speed: 0.0243s/iter; left time: 462.1003s
	iters: 200, epoch: 3 | loss: 0.5402144
	speed: 0.0053s/iter; left time: 99.6604s
	iters: 300, epoch: 3 | loss: 0.3727625
	speed: 0.0061s/iter; left time: 115.2399s
	iters: 400, epoch: 3 | loss: 0.2939476
	speed: 0.0052s/iter; left time: 97.6677s
	iters: 500, epoch: 3 | loss: 0.3943110
	speed: 0.0049s/iter; left time: 91.4653s
	iters: 600, epoch: 3 | loss: 0.2701972
	speed: 0.0055s/iter; left time: 102.3559s
	iters: 700, epoch: 3 | loss: 0.2746424
	speed: 0.0064s/iter; left time: 117.8091s
	iters: 800, epoch: 3 | loss: 0.2744589
	speed: 0.0057s/iter; left time: 104.3262s
	iters: 900, epoch: 3 | loss: 0.2396985
	speed: 0.0055s/iter; left time: 99.8116s
	iters: 1000, epoch: 3 | loss: 0.2274734
	speed: 0.0057s/iter; left time: 103.7362s
Epoch: 3 cost time: 5.933305025100708
Epoch: 3, Steps: 1063 | Train Loss: 0.3495956 Vali Loss: 0.2955251 Test Loss: 0.6418933
Validation loss decreased (0.657421 --> 0.295525).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.3149187
	speed: 0.0219s/iter; left time: 393.1505s
	iters: 200, epoch: 4 | loss: 0.2137582
	speed: 0.0059s/iter; left time: 106.2077s
	iters: 300, epoch: 4 | loss: 0.2048444
	speed: 0.0053s/iter; left time: 93.8873s
	iters: 400, epoch: 4 | loss: 0.2160671
	speed: 0.0056s/iter; left time: 99.1125s
	iters: 500, epoch: 4 | loss: 0.2525149
	speed: 0.0060s/iter; left time: 105.6513s
	iters: 600, epoch: 4 | loss: 0.1888606
	speed: 0.0049s/iter; left time: 84.8202s
	iters: 700, epoch: 4 | loss: 0.4303857
	speed: 0.0054s/iter; left time: 94.2863s
	iters: 800, epoch: 4 | loss: 0.2210005
	speed: 0.0062s/iter; left time: 106.9138s
	iters: 900, epoch: 4 | loss: 0.5242333
	speed: 0.0058s/iter; left time: 99.1321s
	iters: 1000, epoch: 4 | loss: 0.3790526
	speed: 0.0048s/iter; left time: 82.6283s
Epoch: 4 cost time: 5.915440797805786
Epoch: 4, Steps: 1063 | Train Loss: 0.3102759 Vali Loss: 0.2075297 Test Loss: 0.3207862
Validation loss decreased (0.295525 --> 0.207530).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.3112391
	speed: 0.0238s/iter; left time: 403.2112s
	iters: 200, epoch: 5 | loss: 0.4471044
	speed: 0.0054s/iter; left time: 90.2748s
	iters: 300, epoch: 5 | loss: 0.3117775
	speed: 0.0054s/iter; left time: 90.1044s
	iters: 400, epoch: 5 | loss: 0.1878180
	speed: 0.0053s/iter; left time: 87.8619s
	iters: 500, epoch: 5 | loss: 0.4774615
	speed: 0.0045s/iter; left time: 74.3510s
	iters: 600, epoch: 5 | loss: 0.3310631
	speed: 0.0062s/iter; left time: 102.2382s
	iters: 700, epoch: 5 | loss: 0.2808986
	speed: 0.0061s/iter; left time: 99.3709s
	iters: 800, epoch: 5 | loss: 0.3260878
	speed: 0.0053s/iter; left time: 85.9588s
	iters: 900, epoch: 5 | loss: 0.3032541
	speed: 0.0054s/iter; left time: 87.6329s
	iters: 1000, epoch: 5 | loss: 0.2467832
	speed: 0.0055s/iter; left time: 87.3032s
Epoch: 5 cost time: 5.7240355014801025
Epoch: 5, Steps: 1063 | Train Loss: 0.2956076 Vali Loss: 0.2050256 Test Loss: 0.3578126
Validation loss decreased (0.207530 --> 0.205026).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.3803442
	speed: 0.0230s/iter; left time: 363.9548s
	iters: 200, epoch: 6 | loss: 0.1761158
	speed: 0.0047s/iter; left time: 73.3766s
	iters: 300, epoch: 6 | loss: 0.2334176
	speed: 0.0055s/iter; left time: 85.9610s
	iters: 400, epoch: 6 | loss: 0.2938637
	speed: 0.0057s/iter; left time: 88.7999s
	iters: 500, epoch: 6 | loss: 0.3892308
	speed: 0.0056s/iter; left time: 85.8575s
	iters: 600, epoch: 6 | loss: 0.4195743
	speed: 0.0059s/iter; left time: 90.4227s
	iters: 700, epoch: 6 | loss: 0.1413694
	speed: 0.0064s/iter; left time: 98.3293s
	iters: 800, epoch: 6 | loss: 0.5230621
	speed: 0.0058s/iter; left time: 88.1797s
	iters: 900, epoch: 6 | loss: 0.1535027
	speed: 0.0059s/iter; left time: 88.9545s
	iters: 1000, epoch: 6 | loss: 0.2920428
	speed: 0.0050s/iter; left time: 74.2907s
Epoch: 6 cost time: 5.833130598068237
Epoch: 6, Steps: 1063 | Train Loss: 0.2853479 Vali Loss: 0.1745711 Test Loss: 0.2677956
Validation loss decreased (0.205026 --> 0.174571).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.2667981
	speed: 0.0227s/iter; left time: 335.9636s
	iters: 200, epoch: 7 | loss: 0.2357281
	speed: 0.0051s/iter; left time: 74.4965s
	iters: 300, epoch: 7 | loss: 0.5555323
	speed: 0.0047s/iter; left time: 67.9632s
	iters: 400, epoch: 7 | loss: 0.3700025
	speed: 0.0047s/iter; left time: 68.2615s
	iters: 500, epoch: 7 | loss: 0.2332344
	speed: 0.0058s/iter; left time: 83.8529s
	iters: 600, epoch: 7 | loss: 0.4257281
	speed: 0.0063s/iter; left time: 90.3071s
	iters: 700, epoch: 7 | loss: 0.2158818
	speed: 0.0060s/iter; left time: 85.0131s
	iters: 800, epoch: 7 | loss: 0.1808226
	speed: 0.0048s/iter; left time: 68.3025s
	iters: 900, epoch: 7 | loss: 0.1966209
	speed: 0.0051s/iter; left time: 70.7654s
	iters: 1000, epoch: 7 | loss: 0.3199772
	speed: 0.0064s/iter; left time: 89.1748s
Epoch: 7 cost time: 5.619105339050293
Epoch: 7, Steps: 1063 | Train Loss: 0.2805617 Vali Loss: 0.1919431 Test Loss: 0.3208424
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.2277890
	speed: 0.0247s/iter; left time: 339.4775s
	iters: 200, epoch: 8 | loss: 0.2068601
	speed: 0.0053s/iter; left time: 72.1862s
	iters: 300, epoch: 8 | loss: 0.1668335
	speed: 0.0051s/iter; left time: 68.9985s
	iters: 400, epoch: 8 | loss: 0.2137475
	speed: 0.0061s/iter; left time: 82.1305s
	iters: 500, epoch: 8 | loss: 0.1657228
	speed: 0.0056s/iter; left time: 73.9541s
	iters: 600, epoch: 8 | loss: 0.2164240
	speed: 0.0054s/iter; left time: 71.6592s
	iters: 700, epoch: 8 | loss: 0.1725259
	speed: 0.0053s/iter; left time: 69.5635s
	iters: 800, epoch: 8 | loss: 0.3958777
	speed: 0.0052s/iter; left time: 67.6851s
	iters: 900, epoch: 8 | loss: 0.1826199
	speed: 0.0063s/iter; left time: 81.2914s
	iters: 1000, epoch: 8 | loss: 0.1819241
	speed: 0.0062s/iter; left time: 79.2707s
Epoch: 8 cost time: 6.010472774505615
Epoch: 8, Steps: 1063 | Train Loss: 0.2772913 Vali Loss: 0.2182743 Test Loss: 0.4094148
EarlyStopping counter: 2 out of 5
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.2398220
	speed: 0.0256s/iter; left time: 324.1901s
	iters: 200, epoch: 9 | loss: 0.2246812
	speed: 0.0061s/iter; left time: 76.1365s
	iters: 300, epoch: 9 | loss: 0.1793735
	speed: 0.0044s/iter; left time: 55.4248s
	iters: 400, epoch: 9 | loss: 0.3829615
	speed: 0.0050s/iter; left time: 61.3184s
	iters: 500, epoch: 9 | loss: 0.1841956
	speed: 0.0060s/iter; left time: 73.7779s
	iters: 600, epoch: 9 | loss: 0.1209344
	speed: 0.0059s/iter; left time: 72.2395s
	iters: 700, epoch: 9 | loss: 0.2495457
	speed: 0.0053s/iter; left time: 63.4654s
	iters: 800, epoch: 9 | loss: 0.1662979
	speed: 0.0053s/iter; left time: 63.4918s
	iters: 900, epoch: 9 | loss: 0.4891715
	speed: 0.0060s/iter; left time: 71.0561s
	iters: 1000, epoch: 9 | loss: 0.6025649
	speed: 0.0054s/iter; left time: 63.1349s
Epoch: 9 cost time: 5.815358877182007
Epoch: 9, Steps: 1063 | Train Loss: 0.2759346 Vali Loss: 0.1916536 Test Loss: 0.3250880
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.2670541
	speed: 0.0228s/iter; left time: 263.9297s
	iters: 200, epoch: 10 | loss: 0.2562470
	speed: 0.0055s/iter; left time: 62.7991s
	iters: 300, epoch: 10 | loss: 0.2323626
	speed: 0.0051s/iter; left time: 58.4841s
	iters: 400, epoch: 10 | loss: 0.2880932
	speed: 0.0051s/iter; left time: 57.5993s
	iters: 500, epoch: 10 | loss: 0.4780530
	speed: 0.0055s/iter; left time: 61.2538s
	iters: 600, epoch: 10 | loss: 0.5017800
	speed: 0.0054s/iter; left time: 59.7781s
	iters: 700, epoch: 10 | loss: 0.2250426
	speed: 0.0055s/iter; left time: 60.1580s
	iters: 800, epoch: 10 | loss: 0.4123880
	speed: 0.0054s/iter; left time: 59.1973s
	iters: 900, epoch: 10 | loss: 0.3550006
	speed: 0.0051s/iter; left time: 54.6481s
	iters: 1000, epoch: 10 | loss: 0.3399839
	speed: 0.0040s/iter; left time: 43.3105s
Epoch: 10 cost time: 5.471600770950317
Epoch: 10, Steps: 1063 | Train Loss: 0.2750629 Vali Loss: 0.2103375 Test Loss: 0.3820502
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.2081723
	speed: 0.0228s/iter; left time: 240.1699s
	iters: 200, epoch: 11 | loss: 0.1853156
	speed: 0.0056s/iter; left time: 58.4358s
	iters: 300, epoch: 11 | loss: 0.2120812
	speed: 0.0058s/iter; left time: 59.8173s
	iters: 400, epoch: 11 | loss: 0.3535131
	speed: 0.0059s/iter; left time: 60.8057s
	iters: 500, epoch: 11 | loss: 0.5240384
	speed: 0.0049s/iter; left time: 49.1572s
	iters: 600, epoch: 11 | loss: 0.2085700
	speed: 0.0057s/iter; left time: 56.6796s
	iters: 700, epoch: 11 | loss: 0.1716937
	speed: 0.0051s/iter; left time: 50.6777s
	iters: 800, epoch: 11 | loss: 0.2354433
	speed: 0.0051s/iter; left time: 50.3416s
	iters: 900, epoch: 11 | loss: 0.2622803
	speed: 0.0050s/iter; left time: 48.2828s
	iters: 1000, epoch: 11 | loss: 0.1687943
	speed: 0.0040s/iter; left time: 38.8128s
Epoch: 11 cost time: 5.590261936187744
Epoch: 11, Steps: 1063 | Train Loss: 0.2745674 Vali Loss: 0.1877998 Test Loss: 0.3139107
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTm2_336_192_Linear_ETTm2_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3293<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
mse:0.2682911455631256, mae:0.33794498443603516
