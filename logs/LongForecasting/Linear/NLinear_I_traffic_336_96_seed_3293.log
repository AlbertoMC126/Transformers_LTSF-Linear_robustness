Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='NLinear', model_id='traffic_336_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=3293, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_336_96_NLinear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3293>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11849
val 1661
test 3413
	iters: 100, epoch: 1 | loss: 0.7757828
	speed: 0.3132s/iter; left time: 4604.7537s
	iters: 200, epoch: 1 | loss: 1.2759255
	speed: 0.2998s/iter; left time: 4377.6039s
	iters: 300, epoch: 1 | loss: 1.7557496
	speed: 0.3004s/iter; left time: 4356.6515s
	iters: 400, epoch: 1 | loss: 0.8146178
	speed: 0.3008s/iter; left time: 4331.8747s
	iters: 500, epoch: 1 | loss: 0.7952013
	speed: 0.2996s/iter; left time: 4284.8408s
	iters: 600, epoch: 1 | loss: 1.1946992
	speed: 0.2999s/iter; left time: 4258.6741s
	iters: 700, epoch: 1 | loss: 0.9206005
	speed: 0.2997s/iter; left time: 4226.2136s
Epoch: 1 cost time: 223.5763967037201
Epoch: 1, Steps: 740 | Train Loss: 1.1081155 Vali Loss: 1.0868369 Test Loss: 1.1388414
Validation loss decreased (inf --> 1.086837).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 1.4225888
	speed: 0.6101s/iter; left time: 8517.7071s
	iters: 200, epoch: 2 | loss: 1.3198597
	speed: 0.3013s/iter; left time: 4176.0688s
	iters: 300, epoch: 2 | loss: 0.7379237
	speed: 0.3008s/iter; left time: 4139.3645s
	iters: 400, epoch: 2 | loss: 0.7894813
	speed: 0.3013s/iter; left time: 4115.7205s
	iters: 500, epoch: 2 | loss: 0.9801106
	speed: 0.3014s/iter; left time: 4086.7256s
	iters: 600, epoch: 2 | loss: 1.7819656
	speed: 0.3007s/iter; left time: 4048.2827s
	iters: 700, epoch: 2 | loss: 0.7549908
	speed: 0.3006s/iter; left time: 4016.2151s
Epoch: 2 cost time: 222.75949621200562
Epoch: 2, Steps: 740 | Train Loss: 1.0581860 Vali Loss: 1.1595830 Test Loss: 1.2646753
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.3694922
	speed: 0.6094s/iter; left time: 8056.6246s
	iters: 200, epoch: 3 | loss: 0.2785722
	speed: 0.3013s/iter; left time: 3952.8709s
	iters: 300, epoch: 3 | loss: 0.3316607
	speed: 0.3018s/iter; left time: 3929.9616s
	iters: 400, epoch: 3 | loss: 0.3893151
	speed: 0.3017s/iter; left time: 3897.7751s
	iters: 500, epoch: 3 | loss: 0.3278659
	speed: 0.3028s/iter; left time: 3881.9633s
	iters: 600, epoch: 3 | loss: 0.3213736
	speed: 0.3017s/iter; left time: 3837.3323s
	iters: 700, epoch: 3 | loss: 0.3514856
	speed: 0.3001s/iter; left time: 3787.7383s
Epoch: 3 cost time: 223.04714608192444
Epoch: 3, Steps: 740 | Train Loss: 0.3568436 Vali Loss: 0.5036877 Test Loss: 0.5887544
Validation loss decreased (1.086837 --> 0.503688).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.2793406
	speed: 0.6098s/iter; left time: 7610.4787s
	iters: 200, epoch: 4 | loss: 0.2739991
	speed: 0.3000s/iter; left time: 3713.7179s
	iters: 300, epoch: 4 | loss: 0.2881314
	speed: 0.3005s/iter; left time: 3690.7069s
	iters: 400, epoch: 4 | loss: 0.2803960
	speed: 0.3021s/iter; left time: 3679.4346s
	iters: 500, epoch: 4 | loss: 0.2881089
	speed: 0.3010s/iter; left time: 3636.2480s
	iters: 600, epoch: 4 | loss: 0.2820915
	speed: 0.3009s/iter; left time: 3605.5332s
	iters: 700, epoch: 4 | loss: 0.2664077
	speed: 0.3010s/iter; left time: 3576.1589s
Epoch: 4 cost time: 222.67668628692627
Epoch: 4, Steps: 740 | Train Loss: 0.2787704 Vali Loss: 0.4029898 Test Loss: 0.4852148
Validation loss decreased (0.503688 --> 0.402990).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.2602168
	speed: 0.6091s/iter; left time: 7151.6266s
	iters: 200, epoch: 5 | loss: 0.2382297
	speed: 0.3008s/iter; left time: 3501.2717s
	iters: 300, epoch: 5 | loss: 0.2337001
	speed: 0.3007s/iter; left time: 3470.8480s
	iters: 400, epoch: 5 | loss: 0.2381291
	speed: 0.3003s/iter; left time: 3435.9825s
	iters: 500, epoch: 5 | loss: 0.2972005
	speed: 0.3027s/iter; left time: 3432.5877s
	iters: 600, epoch: 5 | loss: 0.2792612
	speed: 0.3018s/iter; left time: 3392.4455s
	iters: 700, epoch: 5 | loss: 0.2473975
	speed: 0.3030s/iter; left time: 3375.2501s
Epoch: 5 cost time: 223.04874849319458
Epoch: 5, Steps: 740 | Train Loss: 0.2567827 Vali Loss: 0.3732715 Test Loss: 0.4538527
Validation loss decreased (0.402990 --> 0.373271).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.2131752
	speed: 0.6102s/iter; left time: 6712.9553s
	iters: 200, epoch: 6 | loss: 0.2691336
	speed: 0.3022s/iter; left time: 3294.0810s
	iters: 300, epoch: 6 | loss: 0.2622679
	speed: 0.3022s/iter; left time: 3264.5752s
	iters: 400, epoch: 6 | loss: 0.2185819
	speed: 0.3023s/iter; left time: 3234.7312s
	iters: 500, epoch: 6 | loss: 0.2745289
	speed: 0.3016s/iter; left time: 3197.3453s
	iters: 600, epoch: 6 | loss: 0.2219806
	speed: 0.3023s/iter; left time: 3174.0145s
	iters: 700, epoch: 6 | loss: 0.2453254
	speed: 0.3020s/iter; left time: 3140.7730s
Epoch: 6 cost time: 223.5374836921692
Epoch: 6, Steps: 740 | Train Loss: 0.2470526 Vali Loss: 0.3598215 Test Loss: 0.4378960
Validation loss decreased (0.373271 --> 0.359821).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.2503270
	speed: 0.6132s/iter; left time: 6292.0483s
	iters: 200, epoch: 7 | loss: 0.2249464
	speed: 0.3013s/iter; left time: 3061.1996s
	iters: 300, epoch: 7 | loss: 0.2319570
	speed: 0.3009s/iter; left time: 3027.2297s
	iters: 400, epoch: 7 | loss: 0.2271154
	speed: 0.3020s/iter; left time: 3008.3634s
	iters: 500, epoch: 7 | loss: 0.2384664
	speed: 0.3017s/iter; left time: 2975.0596s
	iters: 600, epoch: 7 | loss: 0.2233150
	speed: 0.3022s/iter; left time: 2949.8038s
	iters: 700, epoch: 7 | loss: 0.2588899
	speed: 0.3022s/iter; left time: 2919.1537s
Epoch: 7 cost time: 223.427472114563
Epoch: 7, Steps: 740 | Train Loss: 0.2414437 Vali Loss: 0.3533094 Test Loss: 0.4303838
Validation loss decreased (0.359821 --> 0.353309).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.2042495
	speed: 0.6124s/iter; left time: 5830.9341s
	iters: 200, epoch: 8 | loss: 0.2226159
	speed: 0.3012s/iter; left time: 2837.4408s
	iters: 300, epoch: 8 | loss: 0.2532310
	speed: 0.3017s/iter; left time: 2812.2612s
	iters: 400, epoch: 8 | loss: 0.2115433
	speed: 0.3010s/iter; left time: 2775.4088s
	iters: 500, epoch: 8 | loss: 0.2589197
	speed: 0.3012s/iter; left time: 2747.1431s
	iters: 600, epoch: 8 | loss: 0.2197718
	speed: 0.3022s/iter; left time: 2725.7182s
	iters: 700, epoch: 8 | loss: 0.2934610
	speed: 0.3017s/iter; left time: 2691.8937s
Epoch: 8 cost time: 223.21390533447266
Epoch: 8, Steps: 740 | Train Loss: 0.2382693 Vali Loss: 0.3513791 Test Loss: 0.4279331
Validation loss decreased (0.353309 --> 0.351379).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.2184235
	speed: 0.6124s/iter; left time: 5377.6968s
	iters: 200, epoch: 9 | loss: 0.2416700
	speed: 0.3019s/iter; left time: 2620.5266s
	iters: 300, epoch: 9 | loss: 0.2252814
	speed: 0.3026s/iter; left time: 2596.7835s
	iters: 400, epoch: 9 | loss: 0.2142880
	speed: 0.3011s/iter; left time: 2553.6158s
	iters: 500, epoch: 9 | loss: 0.2517672
	speed: 0.2999s/iter; left time: 2513.7680s
	iters: 600, epoch: 9 | loss: 0.2108834
	speed: 0.3010s/iter; left time: 2492.6138s
	iters: 700, epoch: 9 | loss: 0.2198988
	speed: 0.3003s/iter; left time: 2456.3705s
Epoch: 9 cost time: 222.95463347434998
Epoch: 9, Steps: 740 | Train Loss: 0.2364086 Vali Loss: 0.3488967 Test Loss: 0.4252670
Validation loss decreased (0.351379 --> 0.348897).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.2393445
	speed: 0.6133s/iter; left time: 4931.4355s
	iters: 200, epoch: 10 | loss: 0.2512045
	speed: 0.3035s/iter; left time: 2410.4842s
	iters: 300, epoch: 10 | loss: 0.2135376
	speed: 0.3037s/iter; left time: 2381.2289s
	iters: 400, epoch: 10 | loss: 0.2302271
	speed: 0.3023s/iter; left time: 2340.2862s
	iters: 500, epoch: 10 | loss: 0.2679417
	speed: 0.3031s/iter; left time: 2316.2317s
	iters: 600, epoch: 10 | loss: 0.2101994
	speed: 0.3025s/iter; left time: 2280.8258s
	iters: 700, epoch: 10 | loss: 0.2549355
	speed: 0.3029s/iter; left time: 2253.7013s
Epoch: 10 cost time: 224.27746748924255
Epoch: 10, Steps: 740 | Train Loss: 0.2353243 Vali Loss: 0.3473580 Test Loss: 0.4234349
Validation loss decreased (0.348897 --> 0.347358).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.2168198
	speed: 0.6106s/iter; left time: 4458.1919s
	iters: 200, epoch: 11 | loss: 0.2755847
	speed: 0.3023s/iter; left time: 2176.9950s
	iters: 300, epoch: 11 | loss: 0.2451711
	speed: 0.3040s/iter; left time: 2158.5498s
	iters: 400, epoch: 11 | loss: 0.2372084
	speed: 0.3038s/iter; left time: 2127.0866s
	iters: 500, epoch: 11 | loss: 0.2288781
	speed: 0.3034s/iter; left time: 2093.9331s
	iters: 600, epoch: 11 | loss: 0.2058399
	speed: 0.3027s/iter; left time: 2058.9390s
	iters: 700, epoch: 11 | loss: 0.2338341
	speed: 0.3013s/iter; left time: 2019.2954s
Epoch: 11 cost time: 224.00972819328308
Epoch: 11, Steps: 740 | Train Loss: 0.2346572 Vali Loss: 0.3471912 Test Loss: 0.4236701
Validation loss decreased (0.347358 --> 0.347191).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.2724564
	speed: 0.6119s/iter; left time: 4014.4771s
	iters: 200, epoch: 12 | loss: 0.1996304
	speed: 0.3017s/iter; left time: 1949.1238s
	iters: 300, epoch: 12 | loss: 0.2691229
	speed: 0.3027s/iter; left time: 1925.4238s
	iters: 400, epoch: 12 | loss: 0.2842078
	speed: 0.3026s/iter; left time: 1894.4870s
	iters: 500, epoch: 12 | loss: 0.2516777
	speed: 0.3032s/iter; left time: 1867.8862s
	iters: 600, epoch: 12 | loss: 0.1887800
	speed: 0.3017s/iter; left time: 1828.9012s
	iters: 700, epoch: 12 | loss: 0.2644914
	speed: 0.3030s/iter; left time: 1806.4585s
Epoch: 12 cost time: 223.76450300216675
Epoch: 12, Steps: 740 | Train Loss: 0.2343559 Vali Loss: 0.3470007 Test Loss: 0.4231473
Validation loss decreased (0.347191 --> 0.347001).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.2428645
	speed: 0.6111s/iter; left time: 3556.9397s
	iters: 200, epoch: 13 | loss: 0.2578330
	speed: 0.3022s/iter; left time: 1728.9995s
	iters: 300, epoch: 13 | loss: 0.2264596
	speed: 0.3019s/iter; left time: 1696.7613s
	iters: 400, epoch: 13 | loss: 0.1974898
	speed: 0.3024s/iter; left time: 1669.7854s
	iters: 500, epoch: 13 | loss: 0.2258669
	speed: 0.3039s/iter; left time: 1647.3934s
	iters: 600, epoch: 13 | loss: 0.2304596
	speed: 0.3033s/iter; left time: 1614.0938s
	iters: 700, epoch: 13 | loss: 0.2669281
	speed: 0.3036s/iter; left time: 1584.9579s
Epoch: 13 cost time: 224.02633833885193
Epoch: 13, Steps: 740 | Train Loss: 0.2341148 Vali Loss: 0.3467507 Test Loss: 0.4230424
Validation loss decreased (0.347001 --> 0.346751).  Saving model ...
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 14 | loss: 0.2079254
	speed: 0.6118s/iter; left time: 3108.5541s
	iters: 200, epoch: 14 | loss: 0.2340432
	speed: 0.3021s/iter; left time: 1504.5419s
	iters: 300, epoch: 14 | loss: 0.2447753
	speed: 0.3015s/iter; left time: 1471.6684s
	iters: 400, epoch: 14 | loss: 0.2075390
	speed: 0.3024s/iter; left time: 1445.7270s
	iters: 500, epoch: 14 | loss: 0.2273997
	speed: 0.3024s/iter; left time: 1415.7510s
	iters: 600, epoch: 14 | loss: 0.2564774
	speed: 0.2778s/iter; left time: 1272.5453s
	iters: 700, epoch: 14 | loss: 0.1930055
	speed: 0.3042s/iter; left time: 1363.2386s
Epoch: 14 cost time: 221.43591690063477
Epoch: 14, Steps: 740 | Train Loss: 0.2340751 Vali Loss: 0.3465488 Test Loss: 0.4229220
Validation loss decreased (0.346751 --> 0.346549).  Saving model ...
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 15 | loss: 0.2113449
	speed: 0.6153s/iter; left time: 2671.1175s
	iters: 200, epoch: 15 | loss: 0.2214626
	speed: 0.3024s/iter; left time: 1282.5606s
	iters: 300, epoch: 15 | loss: 0.2681811
	speed: 0.3018s/iter; left time: 1249.5540s
	iters: 400, epoch: 15 | loss: 0.2197858
	speed: 0.3014s/iter; left time: 1218.1527s
	iters: 500, epoch: 15 | loss: 0.3084846
	speed: 0.3016s/iter; left time: 1188.7808s
	iters: 600, epoch: 15 | loss: 0.2011694
	speed: 0.3029s/iter; left time: 1163.2805s
	iters: 700, epoch: 15 | loss: 0.2119962
	speed: 0.3031s/iter; left time: 1133.7677s
Epoch: 15 cost time: 223.8470106124878
Epoch: 15, Steps: 740 | Train Loss: 0.2340021 Vali Loss: 0.3467227 Test Loss: 0.4229074
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 16 | loss: 0.2371552
	speed: 0.6115s/iter; left time: 2202.1210s
	iters: 200, epoch: 16 | loss: 0.2322562
	speed: 0.3032s/iter; left time: 1061.5653s
	iters: 300, epoch: 16 | loss: 0.2436621
	speed: 0.3026s/iter; left time: 1029.2081s
	iters: 400, epoch: 16 | loss: 0.2018913
	speed: 0.3024s/iter; left time: 998.3364s
	iters: 500, epoch: 16 | loss: 0.2352777
	speed: 0.3015s/iter; left time: 965.2172s
	iters: 600, epoch: 16 | loss: 0.2099213
	speed: 0.3023s/iter; left time: 937.4502s
	iters: 700, epoch: 16 | loss: 0.2349225
	speed: 0.3027s/iter; left time: 908.3160s
Epoch: 16 cost time: 223.85993909835815
Epoch: 16, Steps: 740 | Train Loss: 0.2339732 Vali Loss: 0.3467686 Test Loss: 0.4229025
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 17 | loss: 0.2180243
	speed: 0.6110s/iter; left time: 1748.1068s
	iters: 200, epoch: 17 | loss: 0.2472381
	speed: 0.3037s/iter; left time: 838.5584s
	iters: 300, epoch: 17 | loss: 0.3018950
	speed: 0.3036s/iter; left time: 807.8551s
	iters: 400, epoch: 17 | loss: 0.2042692
	speed: 0.3021s/iter; left time: 773.7129s
	iters: 500, epoch: 17 | loss: 0.2557743
	speed: 0.3014s/iter; left time: 741.8045s
	iters: 600, epoch: 17 | loss: 0.2142206
	speed: 0.3024s/iter; left time: 713.9847s
	iters: 700, epoch: 17 | loss: 0.2414791
	speed: 0.3021s/iter; left time: 683.0958s
Epoch: 17 cost time: 224.07152390480042
Epoch: 17, Steps: 740 | Train Loss: 0.2339701 Vali Loss: 0.3470424 Test Loss: 0.4228991
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 18 | loss: 0.2726179
	speed: 0.6105s/iter; left time: 1294.7784s
	iters: 200, epoch: 18 | loss: 0.2305026
	speed: 0.3023s/iter; left time: 610.8934s
	iters: 300, epoch: 18 | loss: 0.2324958
	speed: 0.3029s/iter; left time: 581.9356s
	iters: 400, epoch: 18 | loss: 0.2382322
	speed: 0.3046s/iter; left time: 554.6147s
	iters: 500, epoch: 18 | loss: 0.2773244
	speed: 0.3041s/iter; left time: 523.3189s
	iters: 600, epoch: 18 | loss: 0.2263703
	speed: 0.3024s/iter; left time: 490.1269s
	iters: 700, epoch: 18 | loss: 0.2344845
	speed: 0.3019s/iter; left time: 459.2418s
Epoch: 18 cost time: 224.17608046531677
Epoch: 18, Steps: 740 | Train Loss: 0.2339638 Vali Loss: 0.3466204 Test Loss: 0.4228988
EarlyStopping counter: 4 out of 5
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 19 | loss: 0.2927472
	speed: 0.6099s/iter; left time: 842.2084s
	iters: 200, epoch: 19 | loss: 0.2366176
	speed: 0.3032s/iter; left time: 388.3969s
	iters: 300, epoch: 19 | loss: 0.2764041
	speed: 0.3025s/iter; left time: 357.2343s
	iters: 400, epoch: 19 | loss: 0.2303310
	speed: 0.3031s/iter; left time: 327.6150s
	iters: 500, epoch: 19 | loss: 0.2218637
	speed: 0.3024s/iter; left time: 296.6306s
	iters: 600, epoch: 19 | loss: 0.2246401
	speed: 0.3019s/iter; left time: 266.0172s
	iters: 700, epoch: 19 | loss: 0.2184992
	speed: 0.3028s/iter; left time: 236.5190s
Epoch: 19 cost time: 223.88254690170288
Epoch: 19, Steps: 740 | Train Loss: 0.2339427 Vali Loss: 0.3467335 Test Loss: 0.4228986
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : traffic_336_96_NLinear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3293<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3413
mse:0.4231993854045868, mae:0.2943325638771057
