Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTh2', data_path='ETTh2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.05, loss='mse', lradj='type1', model='DLinear', model_id='ETTh2_96_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=15227, seq_len=96, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTh2_96_96_DLinear_ETTh2_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15227>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8449
data_set:  <data_provider.data_loader.Dataset_ETT_hour object at 0x0000020F3B0D04E0>
val 2785
data_set:  <data_provider.data_loader.Dataset_ETT_hour object at 0x0000020F086C7D68>
test 2785
data_set:  <data_provider.data_loader.Dataset_ETT_hour object at 0x0000020F3B0D0438>
Total number of trainable parameters: 130368
Total number of parameters: 130368
	iters: 100, epoch: 1 | loss: 0.5728632
	speed: 0.0054s/iter; left time: 56.1506s
	iters: 200, epoch: 1 | loss: 1.0863310
	speed: 0.0042s/iter; left time: 43.1578s
	iters: 300, epoch: 1 | loss: 1.8103274
	speed: 0.0048s/iter; left time: 49.6920s
	iters: 400, epoch: 1 | loss: 0.8536864
	speed: 0.0041s/iter; left time: 41.4376s
	iters: 500, epoch: 1 | loss: 1.4518707
	speed: 0.0040s/iter; left time: 40.5703s
Epoch: 1 cost time: 2.3724207878112793
Epoch: 1, Steps: 528 | Train Loss: 1.4947188 Vali Loss: 1.6807836 Test Loss: 3.8340640
Validation loss decreased (inf --> 1.680784).  Saving model ...
Updating learning rate to 0.05
	iters: 100, epoch: 2 | loss: 1.4603413
	speed: 0.0134s/iter; left time: 133.4081s
	iters: 200, epoch: 2 | loss: 3.2862713
	speed: 0.0052s/iter; left time: 51.0185s
	iters: 300, epoch: 2 | loss: 0.9401126
	speed: 0.0045s/iter; left time: 43.5229s
	iters: 400, epoch: 2 | loss: 2.0827196
	speed: 0.0043s/iter; left time: 41.1485s
	iters: 500, epoch: 2 | loss: 1.2575037
	speed: 0.0045s/iter; left time: 42.8949s
Epoch: 2 cost time: 2.5393943786621094
Epoch: 2, Steps: 528 | Train Loss: 1.4541217 Vali Loss: 0.8288539 Test Loss: 1.4619436
Validation loss decreased (1.680784 --> 0.828854).  Saving model ...
Updating learning rate to 0.025
	iters: 100, epoch: 3 | loss: 0.6035434
	speed: 0.0102s/iter; left time: 96.3307s
	iters: 200, epoch: 3 | loss: 0.3636940
	speed: 0.0050s/iter; left time: 46.1036s
	iters: 300, epoch: 3 | loss: 0.3345074
	speed: 0.0045s/iter; left time: 41.1338s
	iters: 400, epoch: 3 | loss: 0.6324059
	speed: 0.0047s/iter; left time: 42.9905s
	iters: 500, epoch: 3 | loss: 0.3810459
	speed: 0.0047s/iter; left time: 42.5960s
Epoch: 3 cost time: 2.46610426902771
Epoch: 3, Steps: 528 | Train Loss: 0.6097906 Vali Loss: 0.4948432 Test Loss: 1.0766373
Validation loss decreased (0.828854 --> 0.494843).  Saving model ...
Updating learning rate to 0.0125
	iters: 100, epoch: 4 | loss: 0.2375126
	speed: 0.0110s/iter; left time: 97.2093s
	iters: 200, epoch: 4 | loss: 0.2001056
	speed: 0.0043s/iter; left time: 37.8552s
	iters: 300, epoch: 4 | loss: 0.4470214
	speed: 0.0057s/iter; left time: 49.0872s
	iters: 400, epoch: 4 | loss: 0.3817938
	speed: 0.0043s/iter; left time: 37.1044s
	iters: 500, epoch: 4 | loss: 0.5895633
	speed: 0.0056s/iter; left time: 47.2267s
Epoch: 4 cost time: 2.5837604999542236
Epoch: 4, Steps: 528 | Train Loss: 0.4655417 Vali Loss: 0.2957608 Test Loss: 0.4731359
Validation loss decreased (0.494843 --> 0.295761).  Saving model ...
Updating learning rate to 0.00625
	iters: 100, epoch: 5 | loss: 0.9541653
	speed: 0.0110s/iter; left time: 91.5406s
	iters: 200, epoch: 5 | loss: 0.4593411
	speed: 0.0040s/iter; left time: 32.7976s
	iters: 300, epoch: 5 | loss: 0.7926766
	speed: 0.0048s/iter; left time: 38.7821s
	iters: 400, epoch: 5 | loss: 0.6425599
	speed: 0.0040s/iter; left time: 32.4196s
	iters: 500, epoch: 5 | loss: 0.3940635
	speed: 0.0036s/iter; left time: 28.5131s
Epoch: 5 cost time: 2.213331937789917
Epoch: 5, Steps: 528 | Train Loss: 0.4248158 Vali Loss: 0.5904174 Test Loss: 1.5203338
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.003125
	iters: 100, epoch: 6 | loss: 0.2036940
	speed: 0.0098s/iter; left time: 76.5745s
	iters: 200, epoch: 6 | loss: 0.2578514
	speed: 0.0048s/iter; left time: 37.1726s
	iters: 300, epoch: 6 | loss: 1.0178719
	speed: 0.0034s/iter; left time: 26.2317s
	iters: 400, epoch: 6 | loss: 0.2245516
	speed: 0.0041s/iter; left time: 30.5602s
	iters: 500, epoch: 6 | loss: 0.1556386
	speed: 0.0042s/iter; left time: 30.9102s
Epoch: 6 cost time: 2.1617414951324463
Epoch: 6, Steps: 528 | Train Loss: 0.4003972 Vali Loss: 0.3663449 Test Loss: 0.7854271
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.0015625
	iters: 100, epoch: 7 | loss: 0.1526595
	speed: 0.0087s/iter; left time: 63.5111s
	iters: 200, epoch: 7 | loss: 0.6856683
	speed: 0.0051s/iter; left time: 36.9789s
	iters: 300, epoch: 7 | loss: 0.3394356
	speed: 0.0041s/iter; left time: 29.4299s
	iters: 400, epoch: 7 | loss: 0.2429578
	speed: 0.0048s/iter; left time: 33.6751s
	iters: 500, epoch: 7 | loss: 0.2582756
	speed: 0.0038s/iter; left time: 25.8679s
Epoch: 7 cost time: 2.338247537612915
Epoch: 7, Steps: 528 | Train Loss: 0.3849384 Vali Loss: 0.3666330 Test Loss: 0.7922491
EarlyStopping counter: 3 out of 5
Updating learning rate to 0.00078125
	iters: 100, epoch: 8 | loss: 0.2275099
	speed: 0.0106s/iter; left time: 71.6623s
	iters: 200, epoch: 8 | loss: 0.3353651
	speed: 0.0042s/iter; left time: 28.2369s
	iters: 300, epoch: 8 | loss: 0.5725443
	speed: 0.0039s/iter; left time: 25.6823s
	iters: 400, epoch: 8 | loss: 0.2548158
	speed: 0.0038s/iter; left time: 24.6533s
	iters: 500, epoch: 8 | loss: 0.2537292
	speed: 0.0045s/iter; left time: 28.9177s
Epoch: 8 cost time: 2.263993740081787
Epoch: 8, Steps: 528 | Train Loss: 0.3770085 Vali Loss: 0.3372213 Test Loss: 0.6811874
EarlyStopping counter: 4 out of 5
Updating learning rate to 0.000390625
	iters: 100, epoch: 9 | loss: 0.2871051
	speed: 0.0088s/iter; left time: 54.5766s
	iters: 200, epoch: 9 | loss: 0.2374386
	speed: 0.0048s/iter; left time: 29.6903s
	iters: 300, epoch: 9 | loss: 0.2847203
	speed: 0.0042s/iter; left time: 25.6360s
	iters: 400, epoch: 9 | loss: 0.6584235
	speed: 0.0042s/iter; left time: 25.0224s
	iters: 500, epoch: 9 | loss: 0.2122560
	speed: 0.0043s/iter; left time: 25.3795s
Epoch: 9 cost time: 2.2340219020843506
Epoch: 9, Steps: 528 | Train Loss: 0.3726300 Vali Loss: 0.3311705 Test Loss: 0.6692777
EarlyStopping counter: 5 out of 5
Early stopping
Total training time: 25.5869 seconds
>>>>>>>testing : ETTh2_96_96_DLinear_ETTh2_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15227<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
data_set:  <data_provider.data_loader.Dataset_ETT_hour object at 0x0000020F3B0C37F0>
mse:0.47437286376953125, mae:0.4679912030696869
