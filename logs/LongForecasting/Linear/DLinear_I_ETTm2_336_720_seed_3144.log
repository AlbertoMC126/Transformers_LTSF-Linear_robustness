Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='DLinear', model_id='ETTm2_336_720', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=720, root_path='./dataset/', save_pred_values=False, seed=3144, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTm2_336_720_DLinear_ETTm2_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3144>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33505
val 10801
test 10801
	iters: 100, epoch: 1 | loss: 0.3784370
	speed: 0.0368s/iter; left time: 766.8648s
	iters: 200, epoch: 1 | loss: 1.0078655
	speed: 0.0354s/iter; left time: 734.1650s
	iters: 300, epoch: 1 | loss: 0.6837705
	speed: 0.0372s/iter; left time: 768.0216s
	iters: 400, epoch: 1 | loss: 0.3760410
	speed: 0.0365s/iter; left time: 749.9387s
	iters: 500, epoch: 1 | loss: 0.5005372
	speed: 0.0367s/iter; left time: 750.4154s
	iters: 600, epoch: 1 | loss: 1.0625083
	speed: 0.0351s/iter; left time: 713.6308s
	iters: 700, epoch: 1 | loss: 0.6828851
	speed: 0.0383s/iter; left time: 776.1759s
	iters: 800, epoch: 1 | loss: 0.8257309
	speed: 0.0371s/iter; left time: 747.2028s
	iters: 900, epoch: 1 | loss: 0.6353415
	speed: 0.0385s/iter; left time: 772.5110s
	iters: 1000, epoch: 1 | loss: 0.4491613
	speed: 0.0385s/iter; left time: 766.8967s
Epoch: 1 cost time: 38.658382177352905
Epoch: 1, Steps: 1047 | Train Loss: 0.7681687 Vali Loss: 1.0591800 Test Loss: 2.4618776
Validation loss decreased (inf --> 1.059180).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.5015646
	speed: 0.1143s/iter; left time: 2263.3344s
	iters: 200, epoch: 2 | loss: 0.9297590
	speed: 0.0353s/iter; left time: 694.3730s
	iters: 300, epoch: 2 | loss: 0.4463983
	speed: 0.0384s/iter; left time: 752.6074s
	iters: 400, epoch: 2 | loss: 1.3472023
	speed: 0.0390s/iter; left time: 760.4533s
	iters: 500, epoch: 2 | loss: 0.5632911
	speed: 0.0379s/iter; left time: 735.0970s
	iters: 600, epoch: 2 | loss: 0.5578264
	speed: 0.0388s/iter; left time: 748.3350s
	iters: 700, epoch: 2 | loss: 0.8462724
	speed: 0.0369s/iter; left time: 707.8258s
	iters: 800, epoch: 2 | loss: 0.3726392
	speed: 0.0378s/iter; left time: 720.9521s
	iters: 900, epoch: 2 | loss: 0.7983961
	speed: 0.0365s/iter; left time: 692.9231s
	iters: 1000, epoch: 2 | loss: 0.6795901
	speed: 0.0365s/iter; left time: 689.8514s
Epoch: 2 cost time: 38.849539041519165
Epoch: 2, Steps: 1047 | Train Loss: 0.7599818 Vali Loss: 0.7411778 Test Loss: 1.8246442
Validation loss decreased (1.059180 --> 0.741178).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.4323010
	speed: 0.1105s/iter; left time: 2072.1487s
	iters: 200, epoch: 3 | loss: 0.6427101
	speed: 0.0385s/iter; left time: 717.8216s
	iters: 300, epoch: 3 | loss: 0.7865885
	speed: 0.0386s/iter; left time: 715.3541s
	iters: 400, epoch: 3 | loss: 0.5587036
	speed: 0.0371s/iter; left time: 684.6091s
	iters: 500, epoch: 3 | loss: 0.8456513
	speed: 0.0365s/iter; left time: 669.0782s
	iters: 600, epoch: 3 | loss: 0.6140004
	speed: 0.0380s/iter; left time: 693.9394s
	iters: 700, epoch: 3 | loss: 0.6065673
	speed: 0.0336s/iter; left time: 609.3655s
	iters: 800, epoch: 3 | loss: 0.7596135
	speed: 0.0393s/iter; left time: 708.6421s
	iters: 900, epoch: 3 | loss: 0.5645496
	speed: 0.0364s/iter; left time: 653.7806s
	iters: 1000, epoch: 3 | loss: 0.5431962
	speed: 0.0356s/iter; left time: 634.7479s
Epoch: 3 cost time: 38.08937311172485
Epoch: 3, Steps: 1047 | Train Loss: 0.5793271 Vali Loss: 0.4439310 Test Loss: 0.7493259
Validation loss decreased (0.741178 --> 0.443931).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.4823254
	speed: 0.1112s/iter; left time: 1969.1151s
	iters: 200, epoch: 4 | loss: 0.5550417
	speed: 0.0360s/iter; left time: 633.3651s
	iters: 300, epoch: 4 | loss: 0.5262603
	speed: 0.0365s/iter; left time: 638.7383s
	iters: 400, epoch: 4 | loss: 0.8584734
	speed: 0.0383s/iter; left time: 666.0580s
	iters: 500, epoch: 4 | loss: 0.4391657
	speed: 0.0363s/iter; left time: 627.8417s
	iters: 600, epoch: 4 | loss: 0.6465505
	speed: 0.0379s/iter; left time: 652.2608s
	iters: 700, epoch: 4 | loss: 0.7726148
	speed: 0.0402s/iter; left time: 688.0219s
	iters: 800, epoch: 4 | loss: 0.5799325
	speed: 0.0395s/iter; left time: 671.8568s
	iters: 900, epoch: 4 | loss: 0.4915735
	speed: 0.0384s/iter; left time: 648.6017s
	iters: 1000, epoch: 4 | loss: 0.6357961
	speed: 0.0364s/iter; left time: 612.1739s
Epoch: 4 cost time: 38.85591721534729
Epoch: 4, Steps: 1047 | Train Loss: 0.5119674 Vali Loss: 0.4344396 Test Loss: 0.8852698
Validation loss decreased (0.443931 --> 0.434440).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.4901261
	speed: 0.1219s/iter; left time: 2030.0763s
	iters: 200, epoch: 5 | loss: 0.3515756
	speed: 0.0359s/iter; left time: 594.3237s
	iters: 300, epoch: 5 | loss: 0.3397410
	speed: 0.0369s/iter; left time: 606.3803s
	iters: 400, epoch: 5 | loss: 0.4903776
	speed: 0.0372s/iter; left time: 608.4482s
	iters: 500, epoch: 5 | loss: 0.3500555
	speed: 0.0370s/iter; left time: 600.7889s
	iters: 600, epoch: 5 | loss: 0.3556136
	speed: 0.0372s/iter; left time: 601.1524s
	iters: 700, epoch: 5 | loss: 0.4286484
	speed: 0.0343s/iter; left time: 550.4631s
	iters: 800, epoch: 5 | loss: 0.3677256
	speed: 0.0349s/iter; left time: 557.0933s
	iters: 900, epoch: 5 | loss: 0.2841884
	speed: 0.0355s/iter; left time: 563.1139s
	iters: 1000, epoch: 5 | loss: 0.3066868
	speed: 0.0358s/iter; left time: 564.4214s
Epoch: 5 cost time: 37.44383192062378
Epoch: 5, Steps: 1047 | Train Loss: 0.4824160 Vali Loss: 0.4338572 Test Loss: 0.8836319
Validation loss decreased (0.434440 --> 0.433857).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.3057583
	speed: 0.1132s/iter; left time: 1766.9366s
	iters: 200, epoch: 6 | loss: 0.4692820
	speed: 0.0356s/iter; left time: 551.3261s
	iters: 300, epoch: 6 | loss: 0.6329033
	speed: 0.0351s/iter; left time: 540.0020s
	iters: 400, epoch: 6 | loss: 0.4025229
	speed: 0.0351s/iter; left time: 537.0751s
	iters: 500, epoch: 6 | loss: 0.4026688
	speed: 0.0364s/iter; left time: 553.1135s
	iters: 600, epoch: 6 | loss: 0.2965878
	speed: 0.0354s/iter; left time: 534.7955s
	iters: 700, epoch: 6 | loss: 0.2680505
	speed: 0.0364s/iter; left time: 545.8555s
	iters: 800, epoch: 6 | loss: 0.3626717
	speed: 0.0374s/iter; left time: 556.8496s
	iters: 900, epoch: 6 | loss: 0.3233956
	speed: 0.0379s/iter; left time: 561.6218s
	iters: 1000, epoch: 6 | loss: 0.4187610
	speed: 0.0381s/iter; left time: 560.0057s
Epoch: 6 cost time: 37.85100984573364
Epoch: 6, Steps: 1047 | Train Loss: 0.4669293 Vali Loss: 0.4182402 Test Loss: 0.8522888
Validation loss decreased (0.433857 --> 0.418240).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.3223964
	speed: 0.1134s/iter; left time: 1650.9495s
	iters: 200, epoch: 7 | loss: 0.5274963
	speed: 0.0378s/iter; left time: 547.1966s
	iters: 300, epoch: 7 | loss: 0.2911893
	speed: 0.0373s/iter; left time: 535.0537s
	iters: 400, epoch: 7 | loss: 0.3565124
	speed: 0.0360s/iter; left time: 513.5932s
	iters: 500, epoch: 7 | loss: 0.4348090
	speed: 0.0367s/iter; left time: 519.4388s
	iters: 600, epoch: 7 | loss: 0.4180467
	speed: 0.0373s/iter; left time: 524.8077s
	iters: 700, epoch: 7 | loss: 0.7718255
	speed: 0.0360s/iter; left time: 502.5398s
	iters: 800, epoch: 7 | loss: 0.2530133
	speed: 0.0374s/iter; left time: 517.6342s
	iters: 900, epoch: 7 | loss: 0.3731603
	speed: 0.0357s/iter; left time: 491.1356s
	iters: 1000, epoch: 7 | loss: 0.4142775
	speed: 0.0356s/iter; left time: 486.6535s
Epoch: 7 cost time: 38.21637678146362
Epoch: 7, Steps: 1047 | Train Loss: 0.4589238 Vali Loss: 0.3731255 Test Loss: 0.6948507
Validation loss decreased (0.418240 --> 0.373125).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.4657993
	speed: 0.1167s/iter; left time: 1576.5871s
	iters: 200, epoch: 8 | loss: 0.5755908
	speed: 0.0358s/iter; left time: 480.4963s
	iters: 300, epoch: 8 | loss: 0.5421736
	speed: 0.0355s/iter; left time: 472.6831s
	iters: 400, epoch: 8 | loss: 0.8576691
	speed: 0.0360s/iter; left time: 475.1350s
	iters: 500, epoch: 8 | loss: 0.6415403
	speed: 0.0357s/iter; left time: 468.4699s
	iters: 600, epoch: 8 | loss: 0.6052772
	speed: 0.0374s/iter; left time: 486.0626s
	iters: 700, epoch: 8 | loss: 0.4720099
	speed: 0.0369s/iter; left time: 476.6972s
	iters: 800, epoch: 8 | loss: 0.4840160
	speed: 0.0340s/iter; left time: 435.2010s
	iters: 900, epoch: 8 | loss: 0.3562931
	speed: 0.0371s/iter; left time: 471.6040s
	iters: 1000, epoch: 8 | loss: 0.5491334
	speed: 0.0396s/iter; left time: 499.0941s
Epoch: 8 cost time: 37.942391872406006
Epoch: 8, Steps: 1047 | Train Loss: 0.4539374 Vali Loss: 0.4013455 Test Loss: 0.7933541
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.5637168
	speed: 0.1122s/iter; left time: 1398.7572s
	iters: 200, epoch: 9 | loss: 0.3015321
	speed: 0.0379s/iter; left time: 468.1697s
	iters: 300, epoch: 9 | loss: 0.4928865
	speed: 0.0386s/iter; left time: 473.0898s
	iters: 400, epoch: 9 | loss: 0.5225114
	speed: 0.0359s/iter; left time: 437.3068s
	iters: 500, epoch: 9 | loss: 0.4955128
	speed: 0.0362s/iter; left time: 436.7399s
	iters: 600, epoch: 9 | loss: 0.2795098
	speed: 0.0347s/iter; left time: 415.0394s
	iters: 700, epoch: 9 | loss: 0.4058780
	speed: 0.0372s/iter; left time: 441.4249s
	iters: 800, epoch: 9 | loss: 0.6857553
	speed: 0.0407s/iter; left time: 478.3600s
	iters: 900, epoch: 9 | loss: 0.4653444
	speed: 0.0390s/iter; left time: 454.8241s
	iters: 1000, epoch: 9 | loss: 0.4019790
	speed: 0.0373s/iter; left time: 431.2609s
Epoch: 9 cost time: 38.72140121459961
Epoch: 9, Steps: 1047 | Train Loss: 0.4512805 Vali Loss: 0.4384443 Test Loss: 0.9073739
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.4569642
	speed: 0.1101s/iter; left time: 1257.0682s
	iters: 200, epoch: 10 | loss: 0.2679538
	speed: 0.0358s/iter; left time: 404.7780s
	iters: 300, epoch: 10 | loss: 0.6738666
	speed: 0.0352s/iter; left time: 395.0161s
	iters: 400, epoch: 10 | loss: 0.2940977
	speed: 0.0345s/iter; left time: 383.6533s
	iters: 500, epoch: 10 | loss: 0.3491623
	speed: 0.0342s/iter; left time: 376.5747s
	iters: 600, epoch: 10 | loss: 0.4917951
	speed: 0.0344s/iter; left time: 375.1426s
	iters: 700, epoch: 10 | loss: 0.3520330
	speed: 0.0357s/iter; left time: 385.8634s
	iters: 800, epoch: 10 | loss: 0.3466672
	speed: 0.0358s/iter; left time: 383.7574s
	iters: 900, epoch: 10 | loss: 0.3263086
	speed: 0.0347s/iter; left time: 367.9940s
	iters: 1000, epoch: 10 | loss: 0.6387007
	speed: 0.0324s/iter; left time: 340.8807s
Epoch: 10 cost time: 35.798131465911865
Epoch: 10, Steps: 1047 | Train Loss: 0.4500960 Vali Loss: 0.4276411 Test Loss: 0.8925990
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.4877713
	speed: 0.1093s/iter; left time: 1133.3960s
	iters: 200, epoch: 11 | loss: 0.4881352
	speed: 0.0330s/iter; left time: 338.4444s
	iters: 300, epoch: 11 | loss: 0.5214984
	speed: 0.0348s/iter; left time: 353.8480s
	iters: 400, epoch: 11 | loss: 1.0156713
	speed: 0.0348s/iter; left time: 350.6874s
	iters: 500, epoch: 11 | loss: 0.3667890
	speed: 0.0342s/iter; left time: 341.1514s
	iters: 600, epoch: 11 | loss: 0.6377172
	speed: 0.0345s/iter; left time: 340.8305s
	iters: 700, epoch: 11 | loss: 0.5035910
	speed: 0.0349s/iter; left time: 341.1538s
	iters: 800, epoch: 11 | loss: 0.3781487
	speed: 0.0324s/iter; left time: 312.8846s
	iters: 900, epoch: 11 | loss: 0.4301504
	speed: 0.0328s/iter; left time: 313.9464s
	iters: 1000, epoch: 11 | loss: 0.4627971
	speed: 0.0315s/iter; left time: 298.3252s
Epoch: 11 cost time: 34.896252393722534
Epoch: 11, Steps: 1047 | Train Loss: 0.4493288 Vali Loss: 0.4081534 Test Loss: 0.8225771
EarlyStopping counter: 4 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.3866230
	speed: 0.1005s/iter; left time: 936.8023s
	iters: 200, epoch: 12 | loss: 0.2516191
	speed: 0.0301s/iter; left time: 277.2637s
	iters: 300, epoch: 12 | loss: 0.4628768
	speed: 0.0344s/iter; left time: 313.7990s
	iters: 400, epoch: 12 | loss: 0.2757120
	speed: 0.0312s/iter; left time: 281.5438s
	iters: 500, epoch: 12 | loss: 0.8051632
	speed: 0.0311s/iter; left time: 277.1880s
	iters: 600, epoch: 12 | loss: 0.3622205
	speed: 0.0301s/iter; left time: 265.6688s
	iters: 700, epoch: 12 | loss: 0.6477722
	speed: 0.0291s/iter; left time: 254.1013s
	iters: 800, epoch: 12 | loss: 0.4893303
	speed: 0.0298s/iter; left time: 256.6948s
	iters: 900, epoch: 12 | loss: 0.2245412
	speed: 0.0294s/iter; left time: 250.3884s
	iters: 1000, epoch: 12 | loss: 0.4495579
	speed: 0.0294s/iter; left time: 247.4767s
Epoch: 12 cost time: 31.747414350509644
Epoch: 12, Steps: 1047 | Train Loss: 0.4489106 Vali Loss: 0.4164740 Test Loss: 0.8579775
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTm2_336_720_DLinear_ETTm2_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3144<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10801
mse:0.6953836679458618, mae:0.5442003011703491
