Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTh1', data_path='ETTh1.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='NLinear', model_id='ETTh1_336_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=336, root_path='./dataset/', save_pred_values=False, seed=10458, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTh1_336_336_NLinear_ETTh1_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed10458>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7969
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 0.5387205
	speed: 0.0077s/iter; left time: 37.6558s
	iters: 200, epoch: 1 | loss: 0.6156833
	speed: 0.0084s/iter; left time: 39.9808s
Epoch: 1 cost time: 2.026085376739502
Epoch: 1, Steps: 249 | Train Loss: 0.5519291 Vali Loss: 1.3875915 Test Loss: 0.5179750
Validation loss decreased (inf --> 1.387591).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.5166798
	speed: 0.0197s/iter; left time: 91.2027s
	iters: 200, epoch: 2 | loss: 0.5163792
	speed: 0.0082s/iter; left time: 37.1799s
Epoch: 2 cost time: 2.1067800521850586
Epoch: 2, Steps: 249 | Train Loss: 0.5192835 Vali Loss: 1.4468431 Test Loss: 0.5174398
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.4610207
	speed: 0.0160s/iter; left time: 70.3174s
	iters: 200, epoch: 3 | loss: 0.4166532
	speed: 0.0095s/iter; left time: 40.7432s
Epoch: 3 cost time: 2.236431837081909
Epoch: 3, Steps: 249 | Train Loss: 0.4702141 Vali Loss: 1.3339801 Test Loss: 0.4884516
Validation loss decreased (1.387591 --> 1.333980).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.4804645
	speed: 0.0181s/iter; left time: 74.6729s
	iters: 200, epoch: 4 | loss: 0.3895287
	speed: 0.0074s/iter; left time: 29.9854s
Epoch: 4 cost time: 1.8834683895111084
Epoch: 4, Steps: 249 | Train Loss: 0.4478351 Vali Loss: 1.2870170 Test Loss: 0.4564960
Validation loss decreased (1.333980 --> 1.287017).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.4481033
	speed: 0.0170s/iter; left time: 66.1818s
	iters: 200, epoch: 5 | loss: 0.4557898
	speed: 0.0087s/iter; left time: 32.8179s
Epoch: 5 cost time: 2.130628824234009
Epoch: 5, Steps: 249 | Train Loss: 0.4389658 Vali Loss: 1.2472684 Test Loss: 0.4472626
Validation loss decreased (1.287017 --> 1.247268).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.4883681
	speed: 0.0171s/iter; left time: 62.1520s
	iters: 200, epoch: 6 | loss: 0.3413239
	speed: 0.0095s/iter; left time: 33.5682s
Epoch: 6 cost time: 2.2427477836608887
Epoch: 6, Steps: 249 | Train Loss: 0.4337429 Vali Loss: 1.2634350 Test Loss: 0.4447599
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.4587782
	speed: 0.0187s/iter; left time: 63.1781s
	iters: 200, epoch: 7 | loss: 0.4056145
	speed: 0.0096s/iter; left time: 31.4397s
Epoch: 7 cost time: 2.2207343578338623
Epoch: 7, Steps: 249 | Train Loss: 0.4306878 Vali Loss: 1.2671752 Test Loss: 0.4418120
EarlyStopping counter: 2 out of 5
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.5039170
	speed: 0.0173s/iter; left time: 54.3784s
	iters: 200, epoch: 8 | loss: 0.3694338
	speed: 0.0089s/iter; left time: 26.9593s
Epoch: 8 cost time: 2.0920329093933105
Epoch: 8, Steps: 249 | Train Loss: 0.4290093 Vali Loss: 1.2686138 Test Loss: 0.4399974
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.4004911
	speed: 0.0173s/iter; left time: 50.0982s
	iters: 200, epoch: 9 | loss: 0.4363182
	speed: 0.0092s/iter; left time: 25.7743s
Epoch: 9 cost time: 2.2436323165893555
Epoch: 9, Steps: 249 | Train Loss: 0.4281586 Vali Loss: 1.2653967 Test Loss: 0.4405850
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.4186582
	speed: 0.0195s/iter; left time: 51.5242s
	iters: 200, epoch: 10 | loss: 0.4316291
	speed: 0.0091s/iter; left time: 23.0654s
Epoch: 10 cost time: 2.208740711212158
Epoch: 10, Steps: 249 | Train Loss: 0.4277099 Vali Loss: 1.2637657 Test Loss: 0.4404896
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTh1_336_336_NLinear_ETTh1_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed10458<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2545
mse:0.44627028703689575, mae:0.4419499635696411
