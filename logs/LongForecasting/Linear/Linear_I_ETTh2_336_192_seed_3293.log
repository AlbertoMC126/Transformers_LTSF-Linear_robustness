Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTh2', data_path='ETTh2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.05, loss='mse', lradj='type1', model='Linear', model_id='ETTh2_336_192', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=192, root_path='./dataset/', save_pred_values=False, seed=3293, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTh2_336_192_Linear_ETTh2_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3293>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8113
val 2689
test 2689
	iters: 100, epoch: 1 | loss: 2.1572080
	speed: 0.0041s/iter; left time: 41.2684s
	iters: 200, epoch: 1 | loss: 2.1712210
	speed: 0.0044s/iter; left time: 43.3646s
	iters: 300, epoch: 1 | loss: 78.7511063
	speed: 0.0045s/iter; left time: 44.1861s
	iters: 400, epoch: 1 | loss: 8.0641279
	speed: 0.0044s/iter; left time: 42.8980s
	iters: 500, epoch: 1 | loss: 19.0625095
	speed: 0.0044s/iter; left time: 41.9386s
Epoch: 1 cost time: 2.2036068439483643
Epoch: 1, Steps: 507 | Train Loss: 8.3033475 Vali Loss: 12.2089787 Test Loss: 34.5865021
Validation loss decreased (inf --> 12.208979).  Saving model ...
Updating learning rate to 0.05
	iters: 100, epoch: 2 | loss: 10.9120131
	speed: 0.0096s/iter; left time: 91.1698s
	iters: 200, epoch: 2 | loss: 3.0988402
	speed: 0.0049s/iter; left time: 46.4152s
	iters: 300, epoch: 2 | loss: 4.3644872
	speed: 0.0049s/iter; left time: 45.9264s
	iters: 400, epoch: 2 | loss: 5.5649543
	speed: 0.0045s/iter; left time: 41.6452s
	iters: 500, epoch: 2 | loss: 4.4219770
	speed: 0.0040s/iter; left time: 36.7357s
Epoch: 2 cost time: 2.3482823371887207
Epoch: 2, Steps: 507 | Train Loss: 7.6791803 Vali Loss: 2.9394176 Test Loss: 5.1769457
Validation loss decreased (12.208979 --> 2.939418).  Saving model ...
Updating learning rate to 0.025
	iters: 100, epoch: 3 | loss: 0.7125066
	speed: 0.0073s/iter; left time: 65.4695s
	iters: 200, epoch: 3 | loss: 0.5224720
	speed: 0.0041s/iter; left time: 36.9578s
	iters: 300, epoch: 3 | loss: 0.8315033
	speed: 0.0040s/iter; left time: 35.1315s
	iters: 400, epoch: 3 | loss: 1.0581068
	speed: 0.0041s/iter; left time: 35.3670s
	iters: 500, epoch: 3 | loss: 0.5316613
	speed: 0.0040s/iter; left time: 34.6804s
Epoch: 3 cost time: 2.0275158882141113
Epoch: 3, Steps: 507 | Train Loss: 0.9883008 Vali Loss: 0.9835167 Test Loss: 1.5981116
Validation loss decreased (2.939418 --> 0.983517).  Saving model ...
Updating learning rate to 0.0125
	iters: 100, epoch: 4 | loss: 0.7091747
	speed: 0.0094s/iter; left time: 80.0185s
	iters: 200, epoch: 4 | loss: 0.3348311
	speed: 0.0045s/iter; left time: 38.0764s
	iters: 300, epoch: 4 | loss: 0.3947570
	speed: 0.0046s/iter; left time: 38.0226s
	iters: 400, epoch: 4 | loss: 0.6072337
	speed: 0.0039s/iter; left time: 32.2276s
	iters: 500, epoch: 4 | loss: 0.9273234
	speed: 0.0036s/iter; left time: 29.3510s
Epoch: 4 cost time: 2.1705825328826904
Epoch: 4, Steps: 507 | Train Loss: 0.6284772 Vali Loss: 0.5407701 Test Loss: 0.8551016
Validation loss decreased (0.983517 --> 0.540770).  Saving model ...
Updating learning rate to 0.00625
	iters: 100, epoch: 5 | loss: 0.4402898
	speed: 0.0065s/iter; left time: 52.4851s
	iters: 200, epoch: 5 | loss: 0.2934014
	speed: 0.0040s/iter; left time: 31.9206s
	iters: 300, epoch: 5 | loss: 0.3645224
	speed: 0.0043s/iter; left time: 33.9084s
	iters: 400, epoch: 5 | loss: 0.6570401
	speed: 0.0044s/iter; left time: 34.2596s
	iters: 500, epoch: 5 | loss: 0.5177227
	speed: 0.0041s/iter; left time: 30.9231s
Epoch: 5 cost time: 2.0217623710632324
Epoch: 5, Steps: 507 | Train Loss: 0.5333769 Vali Loss: 0.5153966 Test Loss: 1.0237041
Validation loss decreased (0.540770 --> 0.515397).  Saving model ...
Updating learning rate to 0.003125
	iters: 100, epoch: 6 | loss: 0.3482696
	speed: 0.0078s/iter; left time: 58.4207s
	iters: 200, epoch: 6 | loss: 0.2724938
	speed: 0.0040s/iter; left time: 29.8463s
	iters: 300, epoch: 6 | loss: 0.3522248
	speed: 0.0042s/iter; left time: 31.0016s
	iters: 400, epoch: 6 | loss: 0.2716316
	speed: 0.0047s/iter; left time: 33.7964s
	iters: 500, epoch: 6 | loss: 0.5807661
	speed: 0.0047s/iter; left time: 33.4881s
Epoch: 6 cost time: 2.1606006622314453
Epoch: 6, Steps: 507 | Train Loss: 0.4915361 Vali Loss: 0.3566968 Test Loss: 0.4803918
Validation loss decreased (0.515397 --> 0.356697).  Saving model ...
Updating learning rate to 0.0015625
	iters: 100, epoch: 7 | loss: 0.5472407
	speed: 0.0080s/iter; left time: 56.0619s
	iters: 200, epoch: 7 | loss: 0.3347213
	speed: 0.0042s/iter; left time: 28.6486s
	iters: 300, epoch: 7 | loss: 0.4352856
	speed: 0.0044s/iter; left time: 29.7160s
	iters: 400, epoch: 7 | loss: 0.5025969
	speed: 0.0043s/iter; left time: 28.5508s
	iters: 500, epoch: 7 | loss: 0.2367773
	speed: 0.0043s/iter; left time: 28.5735s
Epoch: 7 cost time: 2.1135144233703613
Epoch: 7, Steps: 507 | Train Loss: 0.4708373 Vali Loss: 0.3603401 Test Loss: 0.4892026
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00078125
	iters: 100, epoch: 8 | loss: 0.3926375
	speed: 0.0086s/iter; left time: 55.6123s
	iters: 200, epoch: 8 | loss: 0.7173995
	speed: 0.0039s/iter; left time: 24.9927s
	iters: 300, epoch: 8 | loss: 0.4532623
	speed: 0.0045s/iter; left time: 28.0808s
	iters: 400, epoch: 8 | loss: 1.0595019
	speed: 0.0043s/iter; left time: 26.6156s
	iters: 500, epoch: 8 | loss: 0.4692701
	speed: 0.0043s/iter; left time: 26.2702s
Epoch: 8 cost time: 2.120356321334839
Epoch: 8, Steps: 507 | Train Loss: 0.4607813 Vali Loss: 0.3916987 Test Loss: 0.5987076
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.000390625
	iters: 100, epoch: 9 | loss: 0.3676668
	speed: 0.0085s/iter; left time: 51.0093s
	iters: 200, epoch: 9 | loss: 0.3421846
	speed: 0.0043s/iter; left time: 25.3055s
	iters: 300, epoch: 9 | loss: 0.4609978
	speed: 0.0043s/iter; left time: 24.7600s
	iters: 400, epoch: 9 | loss: 0.2145085
	speed: 0.0045s/iter; left time: 25.4280s
	iters: 500, epoch: 9 | loss: 0.3108211
	speed: 0.0047s/iter; left time: 26.1936s
Epoch: 9 cost time: 2.2325727939605713
Epoch: 9, Steps: 507 | Train Loss: 0.4526896 Vali Loss: 0.3741763 Test Loss: 0.5338964
EarlyStopping counter: 3 out of 5
Updating learning rate to 0.0001953125
	iters: 100, epoch: 10 | loss: 0.5900861
	speed: 0.0095s/iter; left time: 52.2074s
	iters: 200, epoch: 10 | loss: 0.2015063
	speed: 0.0045s/iter; left time: 24.3202s
	iters: 300, epoch: 10 | loss: 0.2602840
	speed: 0.0047s/iter; left time: 24.7010s
	iters: 400, epoch: 10 | loss: 0.7774602
	speed: 0.0045s/iter; left time: 23.5190s
	iters: 500, epoch: 10 | loss: 0.2934611
	speed: 0.0043s/iter; left time: 21.8862s
Epoch: 10 cost time: 2.2832586765289307
Epoch: 10, Steps: 507 | Train Loss: 0.4488756 Vali Loss: 0.4013460 Test Loss: 0.6294996
EarlyStopping counter: 4 out of 5
Updating learning rate to 9.765625e-05
	iters: 100, epoch: 11 | loss: 0.5106571
	speed: 0.0089s/iter; left time: 44.3577s
	iters: 200, epoch: 11 | loss: 0.3462421
	speed: 0.0043s/iter; left time: 21.0915s
	iters: 300, epoch: 11 | loss: 0.7726962
	speed: 0.0044s/iter; left time: 20.8643s
	iters: 400, epoch: 11 | loss: 0.5329934
	speed: 0.0043s/iter; left time: 19.8548s
	iters: 500, epoch: 11 | loss: 0.6229652
	speed: 0.0043s/iter; left time: 19.5344s
Epoch: 11 cost time: 2.1937901973724365
Epoch: 11, Steps: 507 | Train Loss: 0.4465705 Vali Loss: 0.3899192 Test Loss: 0.5981759
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTh2_336_192_Linear_ETTh2_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3293<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2689
mse:0.4799071252346039, mae:0.4715897738933563
