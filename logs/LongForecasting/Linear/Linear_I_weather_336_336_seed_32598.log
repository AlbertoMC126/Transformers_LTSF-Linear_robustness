Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='Linear', model_id='weather_336_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=336, root_path='./dataset/', save_pred_values=False, seed=32598, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : weather_336_336_Linear_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed32598>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36216
val 4935
test 10204
	iters: 100, epoch: 1 | loss: 0.4904059
	speed: 0.0243s/iter; left time: 1098.1020s
	iters: 200, epoch: 1 | loss: 0.4197278
	speed: 0.0248s/iter; left time: 1119.3138s
	iters: 300, epoch: 1 | loss: 0.4818667
	speed: 0.0245s/iter; left time: 1102.0524s
	iters: 400, epoch: 1 | loss: 0.6972053
	speed: 0.0247s/iter; left time: 1108.7981s
	iters: 500, epoch: 1 | loss: 0.4804917
	speed: 0.0248s/iter; left time: 1112.2840s
	iters: 600, epoch: 1 | loss: 0.5151839
	speed: 0.0249s/iter; left time: 1113.6385s
	iters: 700, epoch: 1 | loss: 0.5249252
	speed: 0.0247s/iter; left time: 1098.9680s
	iters: 800, epoch: 1 | loss: 0.7871372
	speed: 0.0248s/iter; left time: 1100.4625s
	iters: 900, epoch: 1 | loss: 0.5697495
	speed: 0.0244s/iter; left time: 1081.5464s
	iters: 1000, epoch: 1 | loss: 1.9406265
	speed: 0.0244s/iter; left time: 1081.6730s
	iters: 1100, epoch: 1 | loss: 1.6155447
	speed: 0.0247s/iter; left time: 1091.1254s
	iters: 1200, epoch: 1 | loss: 1.0378485
	speed: 0.0248s/iter; left time: 1093.0623s
	iters: 1300, epoch: 1 | loss: 0.5310308
	speed: 0.0246s/iter; left time: 1082.3380s
	iters: 1400, epoch: 1 | loss: 4.5626955
	speed: 0.0242s/iter; left time: 1063.0356s
	iters: 1500, epoch: 1 | loss: 5.2651224
	speed: 0.0245s/iter; left time: 1074.2003s
	iters: 1600, epoch: 1 | loss: 0.5195218
	speed: 0.0249s/iter; left time: 1085.8470s
	iters: 1700, epoch: 1 | loss: 0.4536828
	speed: 0.0245s/iter; left time: 1065.5253s
	iters: 1800, epoch: 1 | loss: 0.6078581
	speed: 0.0246s/iter; left time: 1069.1543s
	iters: 1900, epoch: 1 | loss: 0.9565568
	speed: 0.0243s/iter; left time: 1054.6691s
	iters: 2000, epoch: 1 | loss: 0.6949636
	speed: 0.0246s/iter; left time: 1065.5379s
	iters: 2100, epoch: 1 | loss: 1.0148096
	speed: 0.0250s/iter; left time: 1078.5132s
	iters: 2200, epoch: 1 | loss: 0.5155942
	speed: 0.0244s/iter; left time: 1049.6759s
Epoch: 1 cost time: 55.677748680114746
Epoch: 1, Steps: 2263 | Train Loss: 1.2844922 Vali Loss: 0.6862205 Test Loss: 0.3335341
Validation loss decreased (inf --> 0.686220).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.6760139
	speed: 0.0793s/iter; left time: 3401.6400s
	iters: 200, epoch: 2 | loss: 0.6170663
	speed: 0.0241s/iter; left time: 1032.2600s
	iters: 300, epoch: 2 | loss: 1.1855242
	speed: 0.0244s/iter; left time: 1041.2861s
	iters: 400, epoch: 2 | loss: 0.5500562
	speed: 0.0249s/iter; left time: 1059.6967s
	iters: 500, epoch: 2 | loss: 1.7859849
	speed: 0.0245s/iter; left time: 1042.7351s
	iters: 600, epoch: 2 | loss: 0.6413652
	speed: 0.0246s/iter; left time: 1041.1573s
	iters: 700, epoch: 2 | loss: 2.9615829
	speed: 0.0243s/iter; left time: 1028.0727s
	iters: 800, epoch: 2 | loss: 0.3982819
	speed: 0.0240s/iter; left time: 1014.7441s
	iters: 900, epoch: 2 | loss: 0.6769351
	speed: 0.0247s/iter; left time: 1041.0085s
	iters: 1000, epoch: 2 | loss: 0.5186313
	speed: 0.0248s/iter; left time: 1039.7714s
	iters: 1100, epoch: 2 | loss: 0.7692781
	speed: 0.0247s/iter; left time: 1036.0383s
	iters: 1200, epoch: 2 | loss: 1.0000304
	speed: 0.0246s/iter; left time: 1026.8293s
	iters: 1300, epoch: 2 | loss: 2.6519878
	speed: 0.0246s/iter; left time: 1024.7401s
	iters: 1400, epoch: 2 | loss: 0.5282038
	speed: 0.0244s/iter; left time: 1013.0156s
	iters: 1500, epoch: 2 | loss: 0.4137952
	speed: 0.0241s/iter; left time: 999.1032s
	iters: 1600, epoch: 2 | loss: 1.0711511
	speed: 0.0244s/iter; left time: 1008.2163s
	iters: 1700, epoch: 2 | loss: 0.9118183
	speed: 0.0243s/iter; left time: 1005.3399s
	iters: 1800, epoch: 2 | loss: 0.5853755
	speed: 0.0249s/iter; left time: 1025.4681s
	iters: 1900, epoch: 2 | loss: 0.5665473
	speed: 0.0240s/iter; left time: 987.8247s
	iters: 2000, epoch: 2 | loss: 0.8090812
	speed: 0.0245s/iter; left time: 1006.4761s
	iters: 2100, epoch: 2 | loss: 1.1102210
	speed: 0.0243s/iter; left time: 993.6890s
	iters: 2200, epoch: 2 | loss: 0.5625027
	speed: 0.0242s/iter; left time: 985.9047s
Epoch: 2 cost time: 55.21465444564819
Epoch: 2, Steps: 2263 | Train Loss: 1.0280025 Vali Loss: 0.6621174 Test Loss: 0.3497004
Validation loss decreased (0.686220 --> 0.662117).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.8115248
	speed: 0.0789s/iter; left time: 3204.5141s
	iters: 200, epoch: 3 | loss: 0.9391239
	speed: 0.0245s/iter; left time: 994.9531s
	iters: 300, epoch: 3 | loss: 0.4929765
	speed: 0.0247s/iter; left time: 998.5587s
	iters: 400, epoch: 3 | loss: 1.8692359
	speed: 0.0246s/iter; left time: 993.3451s
	iters: 500, epoch: 3 | loss: 0.8988557
	speed: 0.0243s/iter; left time: 979.5229s
	iters: 600, epoch: 3 | loss: 1.5638614
	speed: 0.0242s/iter; left time: 971.7462s
	iters: 700, epoch: 3 | loss: 1.0652602
	speed: 0.0248s/iter; left time: 994.2690s
	iters: 800, epoch: 3 | loss: 0.5161083
	speed: 0.0246s/iter; left time: 983.1636s
	iters: 900, epoch: 3 | loss: 0.3950129
	speed: 0.0244s/iter; left time: 972.4994s
	iters: 1000, epoch: 3 | loss: 0.3555332
	speed: 0.0241s/iter; left time: 956.2966s
	iters: 1100, epoch: 3 | loss: 0.5167288
	speed: 0.0246s/iter; left time: 973.4172s
	iters: 1200, epoch: 3 | loss: 0.4270436
	speed: 0.0248s/iter; left time: 979.6563s
	iters: 1300, epoch: 3 | loss: 0.4077879
	speed: 0.0246s/iter; left time: 968.7231s
	iters: 1400, epoch: 3 | loss: 0.4128952
	speed: 0.0244s/iter; left time: 958.2974s
	iters: 1500, epoch: 3 | loss: 1.1077237
	speed: 0.0240s/iter; left time: 941.0915s
	iters: 1600, epoch: 3 | loss: 1.8485243
	speed: 0.0243s/iter; left time: 950.2868s
	iters: 1700, epoch: 3 | loss: 0.4343878
	speed: 0.0244s/iter; left time: 951.0280s
	iters: 1800, epoch: 3 | loss: 0.6659566
	speed: 0.0246s/iter; left time: 959.7173s
	iters: 1900, epoch: 3 | loss: 0.4839509
	speed: 0.0243s/iter; left time: 942.7627s
	iters: 2000, epoch: 3 | loss: 0.4842116
	speed: 0.0240s/iter; left time: 928.3524s
	iters: 2100, epoch: 3 | loss: 1.0832587
	speed: 0.0238s/iter; left time: 918.8966s
	iters: 2200, epoch: 3 | loss: 1.4758445
	speed: 0.0243s/iter; left time: 936.7319s
Epoch: 3 cost time: 55.08715057373047
Epoch: 3, Steps: 2263 | Train Loss: 0.7226886 Vali Loss: 0.5449199 Test Loss: 0.2778914
Validation loss decreased (0.662117 --> 0.544920).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.5178106
	speed: 0.0795s/iter; left time: 3050.0719s
	iters: 200, epoch: 4 | loss: 0.4430927
	speed: 0.0243s/iter; left time: 929.8494s
	iters: 300, epoch: 4 | loss: 0.3751520
	speed: 0.0245s/iter; left time: 936.4592s
	iters: 400, epoch: 4 | loss: 0.9268149
	speed: 0.0242s/iter; left time: 922.7197s
	iters: 500, epoch: 4 | loss: 0.4986446
	speed: 0.0245s/iter; left time: 930.6076s
	iters: 600, epoch: 4 | loss: 0.4564615
	speed: 0.0240s/iter; left time: 909.2221s
	iters: 700, epoch: 4 | loss: 1.0594180
	speed: 0.0244s/iter; left time: 923.2830s
	iters: 800, epoch: 4 | loss: 0.4916630
	speed: 0.0244s/iter; left time: 919.1742s
	iters: 900, epoch: 4 | loss: 1.0141997
	speed: 0.0246s/iter; left time: 924.8699s
	iters: 1000, epoch: 4 | loss: 0.5648558
	speed: 0.0238s/iter; left time: 891.8410s
	iters: 1100, epoch: 4 | loss: 0.5532048
	speed: 0.0245s/iter; left time: 917.3727s
	iters: 1200, epoch: 4 | loss: 0.5787020
	speed: 0.0240s/iter; left time: 895.7905s
	iters: 1300, epoch: 4 | loss: 0.5518224
	speed: 0.0246s/iter; left time: 912.8053s
	iters: 1400, epoch: 4 | loss: 0.4584073
	speed: 0.0246s/iter; left time: 912.4400s
	iters: 1500, epoch: 4 | loss: 0.5486003
	speed: 0.0243s/iter; left time: 897.7028s
	iters: 1600, epoch: 4 | loss: 1.0344598
	speed: 0.0246s/iter; left time: 905.8364s
	iters: 1700, epoch: 4 | loss: 0.4215043
	speed: 0.0245s/iter; left time: 902.4462s
	iters: 1800, epoch: 4 | loss: 0.3628537
	speed: 0.0242s/iter; left time: 888.6055s
	iters: 1900, epoch: 4 | loss: 0.3375992
	speed: 0.0242s/iter; left time: 884.6081s
	iters: 2000, epoch: 4 | loss: 0.7840775
	speed: 0.0244s/iter; left time: 890.2691s
	iters: 2100, epoch: 4 | loss: 0.4375728
	speed: 0.0245s/iter; left time: 890.9989s
	iters: 2200, epoch: 4 | loss: 0.4388350
	speed: 0.0240s/iter; left time: 871.0893s
Epoch: 4 cost time: 54.99350190162659
Epoch: 4, Steps: 2263 | Train Loss: 0.5860485 Vali Loss: 0.5162820 Test Loss: 0.2462404
Validation loss decreased (0.544920 --> 0.516282).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.5874327
	speed: 0.0793s/iter; left time: 2865.1841s
	iters: 200, epoch: 5 | loss: 0.9566594
	speed: 0.0248s/iter; left time: 891.4471s
	iters: 300, epoch: 5 | loss: 0.3625399
	speed: 0.0242s/iter; left time: 868.5163s
	iters: 400, epoch: 5 | loss: 0.4527096
	speed: 0.0246s/iter; left time: 880.3671s
	iters: 500, epoch: 5 | loss: 0.4568266
	speed: 0.0244s/iter; left time: 872.8458s
	iters: 600, epoch: 5 | loss: 0.5125169
	speed: 0.0242s/iter; left time: 861.5983s
	iters: 700, epoch: 5 | loss: 0.3501645
	speed: 0.0242s/iter; left time: 859.4709s
	iters: 800, epoch: 5 | loss: 0.4020585
	speed: 0.0245s/iter; left time: 867.2642s
	iters: 900, epoch: 5 | loss: 0.3093112
	speed: 0.0243s/iter; left time: 857.3984s
	iters: 1000, epoch: 5 | loss: 0.4496137
	speed: 0.0245s/iter; left time: 861.0455s
	iters: 1100, epoch: 5 | loss: 0.3613954
	speed: 0.0246s/iter; left time: 862.2890s
	iters: 1200, epoch: 5 | loss: 0.4042458
	speed: 0.0241s/iter; left time: 844.3520s
	iters: 1300, epoch: 5 | loss: 0.4155532
	speed: 0.0248s/iter; left time: 866.3410s
	iters: 1400, epoch: 5 | loss: 0.3803062
	speed: 0.0241s/iter; left time: 839.3281s
	iters: 1500, epoch: 5 | loss: 0.3325892
	speed: 0.0244s/iter; left time: 846.7668s
	iters: 1600, epoch: 5 | loss: 0.3650914
	speed: 0.0241s/iter; left time: 833.6124s
	iters: 1700, epoch: 5 | loss: 0.3981042
	speed: 0.0241s/iter; left time: 832.5730s
	iters: 1800, epoch: 5 | loss: 0.3542420
	speed: 0.0244s/iter; left time: 840.9647s
	iters: 1900, epoch: 5 | loss: 0.5008792
	speed: 0.0243s/iter; left time: 833.9041s
	iters: 2000, epoch: 5 | loss: 0.4874803
	speed: 0.0243s/iter; left time: 831.3535s
	iters: 2100, epoch: 5 | loss: 0.4220766
	speed: 0.0241s/iter; left time: 821.8920s
	iters: 2200, epoch: 5 | loss: 0.5142566
	speed: 0.0242s/iter; left time: 821.3206s
Epoch: 5 cost time: 54.89231014251709
Epoch: 5, Steps: 2263 | Train Loss: 0.5483640 Vali Loss: 0.5123533 Test Loss: 0.2496097
Validation loss decreased (0.516282 --> 0.512353).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.3902203
	speed: 0.0777s/iter; left time: 2631.2019s
	iters: 200, epoch: 6 | loss: 0.2789361
	speed: 0.0244s/iter; left time: 824.3537s
	iters: 300, epoch: 6 | loss: 0.8775784
	speed: 0.0240s/iter; left time: 806.0551s
	iters: 400, epoch: 6 | loss: 0.5164250
	speed: 0.0248s/iter; left time: 831.3214s
	iters: 500, epoch: 6 | loss: 0.8457622
	speed: 0.0247s/iter; left time: 824.6628s
	iters: 600, epoch: 6 | loss: 0.3543605
	speed: 0.0245s/iter; left time: 816.3070s
	iters: 700, epoch: 6 | loss: 0.4689829
	speed: 0.0241s/iter; left time: 802.0313s
	iters: 800, epoch: 6 | loss: 0.5379317
	speed: 0.0243s/iter; left time: 804.4832s
	iters: 900, epoch: 6 | loss: 0.9259873
	speed: 0.0245s/iter; left time: 811.1475s
	iters: 1000, epoch: 6 | loss: 0.4434701
	speed: 0.0242s/iter; left time: 795.7628s
	iters: 1100, epoch: 6 | loss: 0.7127457
	speed: 0.0246s/iter; left time: 808.6415s
	iters: 1200, epoch: 6 | loss: 0.3910885
	speed: 0.0247s/iter; left time: 810.0915s
	iters: 1300, epoch: 6 | loss: 0.4142707
	speed: 0.0247s/iter; left time: 806.3132s
	iters: 1400, epoch: 6 | loss: 0.3521829
	speed: 0.0244s/iter; left time: 794.1475s
	iters: 1500, epoch: 6 | loss: 0.8425333
	speed: 0.0241s/iter; left time: 783.2827s
	iters: 1600, epoch: 6 | loss: 0.4492108
	speed: 0.0245s/iter; left time: 792.8146s
	iters: 1700, epoch: 6 | loss: 0.4473480
	speed: 0.0242s/iter; left time: 781.3587s
	iters: 1800, epoch: 6 | loss: 0.3889840
	speed: 0.0244s/iter; left time: 782.9875s
	iters: 1900, epoch: 6 | loss: 0.3464969
	speed: 0.0243s/iter; left time: 778.2192s
	iters: 2000, epoch: 6 | loss: 0.3909677
	speed: 0.0242s/iter; left time: 773.0784s
	iters: 2100, epoch: 6 | loss: 0.4197050
	speed: 0.0240s/iter; left time: 765.2586s
	iters: 2200, epoch: 6 | loss: 0.3511424
	speed: 0.0237s/iter; left time: 750.8172s
Epoch: 6 cost time: 54.70442867279053
Epoch: 6, Steps: 2263 | Train Loss: 0.5324271 Vali Loss: 0.4991923 Test Loss: 0.2427874
Validation loss decreased (0.512353 --> 0.499192).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.3497102
	speed: 0.0795s/iter; left time: 2510.0035s
	iters: 200, epoch: 7 | loss: 0.6148793
	speed: 0.0240s/iter; left time: 756.5792s
	iters: 300, epoch: 7 | loss: 0.9117635
	speed: 0.0241s/iter; left time: 757.2148s
	iters: 400, epoch: 7 | loss: 1.0330631
	speed: 0.0246s/iter; left time: 770.8852s
	iters: 500, epoch: 7 | loss: 0.4855871
	speed: 0.0240s/iter; left time: 747.4488s
	iters: 600, epoch: 7 | loss: 0.4998190
	speed: 0.0237s/iter; left time: 735.1940s
	iters: 700, epoch: 7 | loss: 0.5761598
	speed: 0.0246s/iter; left time: 762.6888s
	iters: 800, epoch: 7 | loss: 0.3608931
	speed: 0.0245s/iter; left time: 756.3723s
	iters: 900, epoch: 7 | loss: 0.3537935
	speed: 0.0245s/iter; left time: 755.2262s
	iters: 1000, epoch: 7 | loss: 0.3755717
	speed: 0.0243s/iter; left time: 744.6281s
	iters: 1100, epoch: 7 | loss: 1.0668942
	speed: 0.0244s/iter; left time: 746.7894s
	iters: 1200, epoch: 7 | loss: 0.3237345
	speed: 0.0241s/iter; left time: 734.6429s
	iters: 1300, epoch: 7 | loss: 0.5325721
	speed: 0.0246s/iter; left time: 746.2527s
	iters: 1400, epoch: 7 | loss: 0.3158074
	speed: 0.0241s/iter; left time: 730.7532s
	iters: 1500, epoch: 7 | loss: 0.3940884
	speed: 0.0245s/iter; left time: 738.4914s
	iters: 1600, epoch: 7 | loss: 0.4539796
	speed: 0.0243s/iter; left time: 730.9128s
	iters: 1700, epoch: 7 | loss: 0.3861224
	speed: 0.0241s/iter; left time: 722.9639s
	iters: 1800, epoch: 7 | loss: 0.3163001
	speed: 0.0240s/iter; left time: 717.2437s
	iters: 1900, epoch: 7 | loss: 0.3599335
	speed: 0.0242s/iter; left time: 720.9405s
	iters: 2000, epoch: 7 | loss: 0.5011097
	speed: 0.0248s/iter; left time: 737.1867s
	iters: 2100, epoch: 7 | loss: 0.3491359
	speed: 0.0242s/iter; left time: 716.0609s
	iters: 2200, epoch: 7 | loss: 0.4519819
	speed: 0.0247s/iter; left time: 727.9139s
Epoch: 7 cost time: 54.61099028587341
Epoch: 7, Steps: 2263 | Train Loss: 0.5251997 Vali Loss: 0.4951465 Test Loss: 0.2404320
Validation loss decreased (0.499192 --> 0.495147).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.3648319
	speed: 0.0786s/iter; left time: 2304.7167s
	iters: 200, epoch: 8 | loss: 0.5190762
	speed: 0.0243s/iter; left time: 709.8611s
	iters: 300, epoch: 8 | loss: 0.9452909
	speed: 0.0246s/iter; left time: 715.5751s
	iters: 400, epoch: 8 | loss: 0.4679774
	speed: 0.0246s/iter; left time: 712.7453s
	iters: 500, epoch: 8 | loss: 0.9263563
	speed: 0.0239s/iter; left time: 691.0461s
	iters: 600, epoch: 8 | loss: 1.0357699
	speed: 0.0240s/iter; left time: 690.9502s
	iters: 700, epoch: 8 | loss: 0.5515382
	speed: 0.0246s/iter; left time: 706.2089s
	iters: 800, epoch: 8 | loss: 0.5554086
	speed: 0.0244s/iter; left time: 699.4322s
	iters: 900, epoch: 8 | loss: 0.4626598
	speed: 0.0245s/iter; left time: 698.0616s
	iters: 1000, epoch: 8 | loss: 0.4148133
	speed: 0.0241s/iter; left time: 684.4677s
	iters: 1100, epoch: 8 | loss: 1.0344207
	speed: 0.0251s/iter; left time: 711.5404s
	iters: 1200, epoch: 8 | loss: 0.4422220
	speed: 0.0244s/iter; left time: 687.3802s
	iters: 1300, epoch: 8 | loss: 0.5048919
	speed: 0.0244s/iter; left time: 686.5358s
	iters: 1400, epoch: 8 | loss: 0.4864162
	speed: 0.0244s/iter; left time: 684.2083s
	iters: 1500, epoch: 8 | loss: 0.3270577
	speed: 0.0246s/iter; left time: 687.1053s
	iters: 1600, epoch: 8 | loss: 0.3411203
	speed: 0.0245s/iter; left time: 680.9460s
	iters: 1700, epoch: 8 | loss: 0.3454989
	speed: 0.0242s/iter; left time: 670.5850s
	iters: 1800, epoch: 8 | loss: 0.4971267
	speed: 0.0243s/iter; left time: 670.8370s
	iters: 1900, epoch: 8 | loss: 0.9396778
	speed: 0.0245s/iter; left time: 673.9009s
	iters: 2000, epoch: 8 | loss: 0.5418638
	speed: 0.0241s/iter; left time: 662.0749s
	iters: 2100, epoch: 8 | loss: 0.5737470
	speed: 0.0246s/iter; left time: 671.5292s
	iters: 2200, epoch: 8 | loss: 0.3635940
	speed: 0.0240s/iter; left time: 653.9041s
Epoch: 8 cost time: 54.765674352645874
Epoch: 8, Steps: 2263 | Train Loss: 0.5214295 Vali Loss: 0.4928974 Test Loss: 0.2429335
Validation loss decreased (0.495147 --> 0.492897).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.3644544
	speed: 0.0794s/iter; left time: 2149.2642s
	iters: 200, epoch: 9 | loss: 0.4743233
	speed: 0.0236s/iter; left time: 637.0844s
	iters: 300, epoch: 9 | loss: 0.4465609
	speed: 0.0254s/iter; left time: 681.5181s
	iters: 400, epoch: 9 | loss: 0.5759896
	speed: 0.0259s/iter; left time: 692.4640s
	iters: 500, epoch: 9 | loss: 0.3846678
	speed: 0.0254s/iter; left time: 677.7835s
	iters: 600, epoch: 9 | loss: 0.5381196
	speed: 0.0250s/iter; left time: 663.4708s
	iters: 700, epoch: 9 | loss: 0.4536389
	speed: 0.0249s/iter; left time: 659.9409s
	iters: 800, epoch: 9 | loss: 0.9233043
	speed: 0.0256s/iter; left time: 673.5182s
	iters: 900, epoch: 9 | loss: 0.3267886
	speed: 0.0245s/iter; left time: 643.6190s
	iters: 1000, epoch: 9 | loss: 0.4821578
	speed: 0.0252s/iter; left time: 658.3098s
	iters: 1100, epoch: 9 | loss: 0.3836078
	speed: 0.0236s/iter; left time: 614.7008s
	iters: 1200, epoch: 9 | loss: 0.3987411
	speed: 0.0242s/iter; left time: 628.8186s
	iters: 1300, epoch: 9 | loss: 0.3495141
	speed: 0.0244s/iter; left time: 631.4018s
	iters: 1400, epoch: 9 | loss: 0.3950723
	speed: 0.0240s/iter; left time: 618.9204s
	iters: 1500, epoch: 9 | loss: 0.3550069
	speed: 0.0242s/iter; left time: 619.7867s
	iters: 1600, epoch: 9 | loss: 0.9189127
	speed: 0.0232s/iter; left time: 593.2699s
	iters: 1700, epoch: 9 | loss: 0.4480432
	speed: 0.0231s/iter; left time: 588.7705s
	iters: 1800, epoch: 9 | loss: 0.4974251
	speed: 0.0236s/iter; left time: 597.2659s
	iters: 1900, epoch: 9 | loss: 0.4303804
	speed: 0.0236s/iter; left time: 594.8658s
	iters: 2000, epoch: 9 | loss: 1.0315213
	speed: 0.0216s/iter; left time: 543.8647s
	iters: 2100, epoch: 9 | loss: 0.5072104
	speed: 0.0231s/iter; left time: 577.6130s
	iters: 2200, epoch: 9 | loss: 0.4679240
	speed: 0.0233s/iter; left time: 581.2119s
Epoch: 9 cost time: 54.227856397628784
Epoch: 9, Steps: 2263 | Train Loss: 0.5195029 Vali Loss: 0.4922248 Test Loss: 0.2409628
Validation loss decreased (0.492897 --> 0.492225).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.3288599
	speed: 0.0740s/iter; left time: 1833.7986s
	iters: 200, epoch: 10 | loss: 0.4210660
	speed: 0.0225s/iter; left time: 556.4655s
	iters: 300, epoch: 10 | loss: 0.4157208
	speed: 0.0235s/iter; left time: 578.6861s
	iters: 400, epoch: 10 | loss: 0.3421641
	speed: 0.0250s/iter; left time: 613.0983s
	iters: 500, epoch: 10 | loss: 0.2933592
	speed: 0.0245s/iter; left time: 597.9055s
	iters: 600, epoch: 10 | loss: 0.3686471
	speed: 0.0207s/iter; left time: 504.0610s
	iters: 700, epoch: 10 | loss: 0.4476656
	speed: 0.0243s/iter; left time: 587.8380s
	iters: 800, epoch: 10 | loss: 0.4280895
	speed: 0.0242s/iter; left time: 582.5803s
	iters: 900, epoch: 10 | loss: 0.3780467
	speed: 0.0214s/iter; left time: 514.4096s
	iters: 1000, epoch: 10 | loss: 0.4114845
	speed: 0.0239s/iter; left time: 570.0288s
	iters: 1100, epoch: 10 | loss: 0.4372508
	speed: 0.0228s/iter; left time: 542.9263s
	iters: 1200, epoch: 10 | loss: 0.5520459
	speed: 0.0240s/iter; left time: 568.5696s
	iters: 1300, epoch: 10 | loss: 0.4353457
	speed: 0.0212s/iter; left time: 500.4519s
	iters: 1400, epoch: 10 | loss: 0.5007703
	speed: 0.0238s/iter; left time: 559.8420s
	iters: 1500, epoch: 10 | loss: 0.3117576
	speed: 0.0214s/iter; left time: 500.3522s
	iters: 1600, epoch: 10 | loss: 0.9468830
	speed: 0.0225s/iter; left time: 524.0278s
	iters: 1700, epoch: 10 | loss: 0.2755394
	speed: 0.0223s/iter; left time: 516.4590s
	iters: 1800, epoch: 10 | loss: 0.4322248
	speed: 0.0213s/iter; left time: 491.4229s
	iters: 1900, epoch: 10 | loss: 0.4350206
	speed: 0.0220s/iter; left time: 505.3684s
	iters: 2000, epoch: 10 | loss: 0.6925801
	speed: 0.0240s/iter; left time: 550.3410s
	iters: 2100, epoch: 10 | loss: 0.3885120
	speed: 0.0249s/iter; left time: 568.4843s
	iters: 2200, epoch: 10 | loss: 0.3598955
	speed: 0.0239s/iter; left time: 542.0799s
Epoch: 10 cost time: 51.88666296005249
Epoch: 10, Steps: 2263 | Train Loss: 0.5185460 Vali Loss: 0.4965278 Test Loss: 0.2408711
EarlyStopping counter: 1 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.3497902
	speed: 0.0788s/iter; left time: 1774.5597s
	iters: 200, epoch: 11 | loss: 0.8817834
	speed: 0.0229s/iter; left time: 513.2668s
	iters: 300, epoch: 11 | loss: 0.4710186
	speed: 0.0241s/iter; left time: 537.3203s
	iters: 400, epoch: 11 | loss: 0.3810137
	speed: 0.0239s/iter; left time: 530.9130s
	iters: 500, epoch: 11 | loss: 0.5462452
	speed: 0.0217s/iter; left time: 479.9271s
	iters: 600, epoch: 11 | loss: 0.3312844
	speed: 0.0206s/iter; left time: 453.8343s
	iters: 700, epoch: 11 | loss: 0.4669542
	speed: 0.0219s/iter; left time: 480.6847s
	iters: 800, epoch: 11 | loss: 0.3061962
	speed: 0.0216s/iter; left time: 471.9889s
	iters: 900, epoch: 11 | loss: 0.5124043
	speed: 0.0202s/iter; left time: 438.5768s
	iters: 1000, epoch: 11 | loss: 0.8991119
	speed: 0.0233s/iter; left time: 503.1738s
	iters: 1100, epoch: 11 | loss: 0.3580127
	speed: 0.0233s/iter; left time: 501.2491s
	iters: 1200, epoch: 11 | loss: 0.9156739
	speed: 0.0241s/iter; left time: 517.1161s
	iters: 1300, epoch: 11 | loss: 0.3950795
	speed: 0.0237s/iter; left time: 505.0867s
	iters: 1400, epoch: 11 | loss: 0.2779502
	speed: 0.0235s/iter; left time: 499.9132s
	iters: 1500, epoch: 11 | loss: 0.4341155
	speed: 0.0230s/iter; left time: 486.7245s
	iters: 1600, epoch: 11 | loss: 0.4587395
	speed: 0.0235s/iter; left time: 493.8420s
	iters: 1700, epoch: 11 | loss: 0.5070577
	speed: 0.0214s/iter; left time: 447.1347s
	iters: 1800, epoch: 11 | loss: 0.4021195
	speed: 0.0206s/iter; left time: 428.4835s
	iters: 1900, epoch: 11 | loss: 0.4171676
	speed: 0.0230s/iter; left time: 476.7109s
	iters: 2000, epoch: 11 | loss: 0.3055013
	speed: 0.0234s/iter; left time: 483.1980s
	iters: 2100, epoch: 11 | loss: 0.3105131
	speed: 0.0241s/iter; left time: 494.4999s
	iters: 2200, epoch: 11 | loss: 0.8681155
	speed: 0.0245s/iter; left time: 499.9295s
Epoch: 11 cost time: 51.25628685951233
Epoch: 11, Steps: 2263 | Train Loss: 0.5181192 Vali Loss: 0.4944145 Test Loss: 0.2414306
EarlyStopping counter: 2 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.3773894
	speed: 0.0797s/iter; left time: 1615.9331s
	iters: 200, epoch: 12 | loss: 0.3505781
	speed: 0.0196s/iter; left time: 394.9897s
	iters: 300, epoch: 12 | loss: 0.4013221
	speed: 0.0194s/iter; left time: 388.6473s
	iters: 400, epoch: 12 | loss: 0.3485318
	speed: 0.0205s/iter; left time: 408.9155s
	iters: 500, epoch: 12 | loss: 0.4052441
	speed: 0.0224s/iter; left time: 444.7983s
	iters: 600, epoch: 12 | loss: 0.4269730
	speed: 0.0229s/iter; left time: 451.8807s
	iters: 700, epoch: 12 | loss: 0.3332357
	speed: 0.0242s/iter; left time: 476.0470s
	iters: 800, epoch: 12 | loss: 0.3690439
	speed: 0.0239s/iter; left time: 468.0234s
	iters: 900, epoch: 12 | loss: 0.3162673
	speed: 0.0189s/iter; left time: 368.1613s
	iters: 1000, epoch: 12 | loss: 0.4735232
	speed: 0.0204s/iter; left time: 395.4395s
	iters: 1100, epoch: 12 | loss: 0.3163885
	speed: 0.0201s/iter; left time: 387.6351s
	iters: 1200, epoch: 12 | loss: 0.5347381
	speed: 0.0203s/iter; left time: 389.2203s
	iters: 1300, epoch: 12 | loss: 0.4579609
	speed: 0.0186s/iter; left time: 355.2917s
	iters: 1400, epoch: 12 | loss: 0.9431437
	speed: 0.0196s/iter; left time: 372.4233s
	iters: 1500, epoch: 12 | loss: 0.4515374
	speed: 0.0178s/iter; left time: 335.0362s
	iters: 1600, epoch: 12 | loss: 0.3564447
	speed: 0.0176s/iter; left time: 330.6821s
	iters: 1700, epoch: 12 | loss: 0.4620091
	speed: 0.0200s/iter; left time: 373.5837s
	iters: 1800, epoch: 12 | loss: 0.3331090
	speed: 0.0207s/iter; left time: 383.9465s
	iters: 1900, epoch: 12 | loss: 0.6880406
	speed: 0.0211s/iter; left time: 389.8204s
	iters: 2000, epoch: 12 | loss: 0.5756183
	speed: 0.0217s/iter; left time: 399.4312s
	iters: 2100, epoch: 12 | loss: 0.3814352
	speed: 0.0210s/iter; left time: 383.5123s
	iters: 2200, epoch: 12 | loss: 0.4802925
	speed: 0.0216s/iter; left time: 391.9130s
Epoch: 12 cost time: 46.71057438850403
Epoch: 12, Steps: 2263 | Train Loss: 0.5178712 Vali Loss: 0.4943493 Test Loss: 0.2414971
EarlyStopping counter: 3 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.3313160
	speed: 0.0745s/iter; left time: 1341.8475s
	iters: 200, epoch: 13 | loss: 0.3902967
	speed: 0.0180s/iter; left time: 322.5143s
	iters: 300, epoch: 13 | loss: 0.8870834
	speed: 0.0195s/iter; left time: 347.4650s
	iters: 400, epoch: 13 | loss: 0.3859391
	speed: 0.0202s/iter; left time: 356.9964s
	iters: 500, epoch: 13 | loss: 0.3172415
	speed: 0.0210s/iter; left time: 370.3813s
	iters: 600, epoch: 13 | loss: 0.4329326
	speed: 0.0213s/iter; left time: 372.5839s
	iters: 700, epoch: 13 | loss: 0.4008025
	speed: 0.0194s/iter; left time: 336.8999s
	iters: 800, epoch: 13 | loss: 0.4586874
	speed: 0.0198s/iter; left time: 343.0749s
	iters: 900, epoch: 13 | loss: 0.4241638
	speed: 0.0192s/iter; left time: 329.5335s
	iters: 1000, epoch: 13 | loss: 0.3228107
	speed: 0.0196s/iter; left time: 335.6945s
	iters: 1100, epoch: 13 | loss: 0.4529187
	speed: 0.0202s/iter; left time: 343.4299s
	iters: 1200, epoch: 13 | loss: 0.3883689
	speed: 0.0209s/iter; left time: 353.2816s
	iters: 1300, epoch: 13 | loss: 0.4669922
	speed: 0.0214s/iter; left time: 360.0727s
	iters: 1400, epoch: 13 | loss: 0.9515900
	speed: 0.0210s/iter; left time: 350.4663s
	iters: 1500, epoch: 13 | loss: 0.3924851
	speed: 0.0206s/iter; left time: 341.3433s
	iters: 1600, epoch: 13 | loss: 0.4205467
	speed: 0.0201s/iter; left time: 331.8047s
	iters: 1700, epoch: 13 | loss: 0.5567577
	speed: 0.0206s/iter; left time: 337.3511s
	iters: 1800, epoch: 13 | loss: 0.2914536
	speed: 0.0191s/iter; left time: 311.0587s
	iters: 1900, epoch: 13 | loss: 0.3113809
	speed: 0.0191s/iter; left time: 310.0901s
	iters: 2000, epoch: 13 | loss: 0.4263676
	speed: 0.0196s/iter; left time: 314.9791s
	iters: 2100, epoch: 13 | loss: 0.4313545
	speed: 0.0204s/iter; left time: 326.4328s
	iters: 2200, epoch: 13 | loss: 0.4089550
	speed: 0.0200s/iter; left time: 318.1990s
Epoch: 13 cost time: 45.14805269241333
Epoch: 13, Steps: 2263 | Train Loss: 0.5177190 Vali Loss: 0.4945661 Test Loss: 0.2407110
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.3580833
	speed: 0.0700s/iter; left time: 1102.1722s
	iters: 200, epoch: 14 | loss: 0.3320391
	speed: 0.0195s/iter; left time: 305.2436s
	iters: 300, epoch: 14 | loss: 0.2992035
	speed: 0.0195s/iter; left time: 302.8020s
	iters: 400, epoch: 14 | loss: 0.4784999
	speed: 0.0188s/iter; left time: 290.6343s
	iters: 500, epoch: 14 | loss: 0.3863922
	speed: 0.0195s/iter; left time: 299.8555s
	iters: 600, epoch: 14 | loss: 1.4363750
	speed: 0.0204s/iter; left time: 310.2908s
	iters: 700, epoch: 14 | loss: 0.3874441
	speed: 0.0175s/iter; left time: 264.8818s
	iters: 800, epoch: 14 | loss: 0.3983874
	speed: 0.0192s/iter; left time: 288.4576s
	iters: 900, epoch: 14 | loss: 0.4409710
	speed: 0.0181s/iter; left time: 271.1448s
	iters: 1000, epoch: 14 | loss: 0.4488329
	speed: 0.0161s/iter; left time: 239.1624s
	iters: 1100, epoch: 14 | loss: 0.2887039
	speed: 0.0182s/iter; left time: 268.6303s
	iters: 1200, epoch: 14 | loss: 0.4764769
	speed: 0.0165s/iter; left time: 241.7991s
	iters: 1300, epoch: 14 | loss: 0.3887681
	speed: 0.0177s/iter; left time: 257.4666s
	iters: 1400, epoch: 14 | loss: 0.5584003
	speed: 0.0176s/iter; left time: 254.5402s
	iters: 1500, epoch: 14 | loss: 0.3517162
	speed: 0.0188s/iter; left time: 269.5064s
	iters: 1600, epoch: 14 | loss: 0.3510480
	speed: 0.0177s/iter; left time: 252.1643s
	iters: 1700, epoch: 14 | loss: 0.3650732
	speed: 0.0177s/iter; left time: 250.9442s
	iters: 1800, epoch: 14 | loss: 0.4428335
	speed: 0.0193s/iter; left time: 270.9124s
	iters: 1900, epoch: 14 | loss: 1.0829402
	speed: 0.0187s/iter; left time: 261.3368s
	iters: 2000, epoch: 14 | loss: 0.4410035
	speed: 0.0196s/iter; left time: 271.7289s
	iters: 2100, epoch: 14 | loss: 0.4280159
	speed: 0.0196s/iter; left time: 268.8736s
	iters: 2200, epoch: 14 | loss: 0.4493679
	speed: 0.0181s/iter; left time: 246.3215s
Epoch: 14 cost time: 41.74818682670593
Epoch: 14, Steps: 2263 | Train Loss: 0.5176212 Vali Loss: 0.4938661 Test Loss: 0.2410384
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : weather_336_336_Linear_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed32598<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10204
mse:0.2410302311182022, mae:0.30012306571006775
