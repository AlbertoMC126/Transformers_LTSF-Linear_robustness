Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTh2', data_path='ETTh2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='NLinear', model_id='ETTh2_336_192', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=192, root_path='./dataset/', save_pred_values=False, seed=15227, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTh2_336_192_NLinear_ETTh2_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15227>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8113
val 2689
test 2689
Total number of trainable parameters: 452928
Total number of parameters: 452928
	iters: 100, epoch: 1 | loss: 0.5957808
	speed: 0.0107s/iter; left time: 52.9440s
	iters: 200, epoch: 1 | loss: 1.2764363
	speed: 0.0102s/iter; left time: 49.5324s
Epoch: 1 cost time: 2.625328540802002
Epoch: 1, Steps: 253 | Train Loss: 0.6284426 Vali Loss: 0.3682643 Test Loss: 0.4013236
Validation loss decreased (inf --> 0.368264).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.5016543
	speed: 0.0217s/iter; left time: 102.1276s
	iters: 200, epoch: 2 | loss: 0.5771840
	speed: 0.0098s/iter; left time: 45.3854s
Epoch: 2 cost time: 2.469987630844116
Epoch: 2, Steps: 253 | Train Loss: 0.6032486 Vali Loss: 0.3427255 Test Loss: 0.4250230
Validation loss decreased (0.368264 --> 0.342726).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.4427192
	speed: 0.0210s/iter; left time: 93.5067s
	iters: 200, epoch: 3 | loss: 0.4688197
	speed: 0.0098s/iter; left time: 42.8523s
Epoch: 3 cost time: 2.474900007247925
Epoch: 3, Steps: 253 | Train Loss: 0.5196725 Vali Loss: 0.3266461 Test Loss: 0.3782850
Validation loss decreased (0.342726 --> 0.326646).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.4077629
	speed: 0.0207s/iter; left time: 86.9828s
	iters: 200, epoch: 4 | loss: 0.7639615
	speed: 0.0095s/iter; left time: 39.1233s
Epoch: 4 cost time: 2.4615893363952637
Epoch: 4, Steps: 253 | Train Loss: 0.4889930 Vali Loss: 0.3450411 Test Loss: 0.3711618
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.7975544
	speed: 0.0200s/iter; left time: 79.0083s
	iters: 200, epoch: 5 | loss: 0.3992031
	speed: 0.0096s/iter; left time: 36.9456s
Epoch: 5 cost time: 2.514857530593872
Epoch: 5, Steps: 253 | Train Loss: 0.4761272 Vali Loss: 0.2993525 Test Loss: 0.3551072
Validation loss decreased (0.326646 --> 0.299352).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.3659723
	speed: 0.0208s/iter; left time: 76.7543s
	iters: 200, epoch: 6 | loss: 0.5614218
	speed: 0.0094s/iter; left time: 33.8472s
Epoch: 6 cost time: 2.442471742630005
Epoch: 6, Steps: 253 | Train Loss: 0.4677978 Vali Loss: 0.3065388 Test Loss: 0.3503803
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.3809550
	speed: 0.0201s/iter; left time: 69.2951s
	iters: 200, epoch: 7 | loss: 0.6397977
	speed: 0.0094s/iter; left time: 31.4857s
Epoch: 7 cost time: 2.4346811771392822
Epoch: 7, Steps: 253 | Train Loss: 0.4652272 Vali Loss: 0.3046941 Test Loss: 0.3465227
EarlyStopping counter: 2 out of 5
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.4771462
	speed: 0.0207s/iter; left time: 66.0975s
	iters: 200, epoch: 8 | loss: 0.3914201
	speed: 0.0099s/iter; left time: 30.5281s
Epoch: 8 cost time: 2.520453929901123
Epoch: 8, Steps: 253 | Train Loss: 0.4630571 Vali Loss: 0.3045672 Test Loss: 0.3444389
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.3703882
	speed: 0.0198s/iter; left time: 58.0195s
	iters: 200, epoch: 9 | loss: 0.5600539
	speed: 0.0098s/iter; left time: 27.6764s
Epoch: 9 cost time: 2.431105613708496
Epoch: 9, Steps: 253 | Train Loss: 0.4630864 Vali Loss: 0.3043506 Test Loss: 0.3460426
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.2950839
	speed: 0.0189s/iter; left time: 50.6138s
	iters: 200, epoch: 10 | loss: 0.2977740
	speed: 0.0093s/iter; left time: 24.0574s
Epoch: 10 cost time: 2.268890619277954
Epoch: 10, Steps: 253 | Train Loss: 0.4624520 Vali Loss: 0.3040114 Test Loss: 0.3458599
EarlyStopping counter: 5 out of 5
Early stopping
Total training time: 29.9704 seconds
>>>>>>>testing : ETTh2_336_192_NLinear_ETTh2_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15227<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2689
mse:0.3506574034690857, mae:0.391472727060318
