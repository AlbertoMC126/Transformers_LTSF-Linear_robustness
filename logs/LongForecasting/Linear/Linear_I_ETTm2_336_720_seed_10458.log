Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='Linear', model_id='ETTm2_336_720', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=720, root_path='./dataset/', save_pred_values=False, seed=10458, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTm2_336_720_Linear_ETTm2_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed10458>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33505
val 10801
test 10801
	iters: 100, epoch: 1 | loss: 0.3038513
	speed: 0.0164s/iter; left time: 341.0419s
	iters: 200, epoch: 1 | loss: 0.5364573
	speed: 0.0188s/iter; left time: 389.4054s
	iters: 300, epoch: 1 | loss: 0.5297297
	speed: 0.0181s/iter; left time: 372.5818s
	iters: 400, epoch: 1 | loss: 0.4366814
	speed: 0.0194s/iter; left time: 399.2852s
	iters: 500, epoch: 1 | loss: 0.8208703
	speed: 0.0161s/iter; left time: 329.8063s
	iters: 600, epoch: 1 | loss: 0.6401141
	speed: 0.0180s/iter; left time: 365.9992s
	iters: 700, epoch: 1 | loss: 1.0530972
	speed: 0.0200s/iter; left time: 404.3897s
	iters: 800, epoch: 1 | loss: 0.7259985
	speed: 0.0173s/iter; left time: 347.5646s
	iters: 900, epoch: 1 | loss: 0.6825000
	speed: 0.0164s/iter; left time: 329.2657s
	iters: 1000, epoch: 1 | loss: 0.8559318
	speed: 0.0188s/iter; left time: 374.2927s
Epoch: 1 cost time: 18.857308626174927
Epoch: 1, Steps: 1047 | Train Loss: 0.7183988 Vali Loss: 0.6302359 Test Loss: 1.3820194
Validation loss decreased (inf --> 0.630236).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.6772144
	speed: 0.0646s/iter; left time: 1279.1817s
	iters: 200, epoch: 2 | loss: 1.0666194
	speed: 0.0180s/iter; left time: 353.7121s
	iters: 300, epoch: 2 | loss: 0.6983851
	speed: 0.0197s/iter; left time: 386.9115s
	iters: 400, epoch: 2 | loss: 0.6000685
	speed: 0.0169s/iter; left time: 330.2377s
	iters: 500, epoch: 2 | loss: 0.5298790
	speed: 0.0180s/iter; left time: 348.4619s
	iters: 600, epoch: 2 | loss: 2.1142063
	speed: 0.0204s/iter; left time: 392.7127s
	iters: 700, epoch: 2 | loss: 1.1248882
	speed: 0.0176s/iter; left time: 338.1013s
	iters: 800, epoch: 2 | loss: 0.6667091
	speed: 0.0204s/iter; left time: 388.6032s
	iters: 900, epoch: 2 | loss: 0.8338096
	speed: 0.0181s/iter; left time: 344.5879s
	iters: 1000, epoch: 2 | loss: 0.6737750
	speed: 0.0188s/iter; left time: 355.8616s
Epoch: 2 cost time: 19.32349395751953
Epoch: 2, Steps: 1047 | Train Loss: 0.7262673 Vali Loss: 0.4129105 Test Loss: 0.7822074
Validation loss decreased (0.630236 --> 0.412911).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.3456426
	speed: 0.0558s/iter; left time: 1045.7793s
	iters: 200, epoch: 3 | loss: 0.9361303
	speed: 0.0180s/iter; left time: 336.1558s
	iters: 300, epoch: 3 | loss: 0.4215195
	speed: 0.0188s/iter; left time: 349.1507s
	iters: 400, epoch: 3 | loss: 0.6795356
	speed: 0.0188s/iter; left time: 347.3501s
	iters: 500, epoch: 3 | loss: 0.4206933
	speed: 0.0198s/iter; left time: 362.7736s
	iters: 600, epoch: 3 | loss: 0.4119094
	speed: 0.0196s/iter; left time: 358.5427s
	iters: 700, epoch: 3 | loss: 0.4003369
	speed: 0.0199s/iter; left time: 361.1800s
	iters: 800, epoch: 3 | loss: 0.5436186
	speed: 0.0178s/iter; left time: 321.6861s
	iters: 900, epoch: 3 | loss: 0.7171119
	speed: 0.0186s/iter; left time: 332.9954s
	iters: 1000, epoch: 3 | loss: 0.6208757
	speed: 0.0197s/iter; left time: 350.9372s
Epoch: 3 cost time: 19.535542726516724
Epoch: 3, Steps: 1047 | Train Loss: 0.5490599 Vali Loss: 0.6537012 Test Loss: 1.6290318
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.3764518
	speed: 0.0634s/iter; left time: 1122.7543s
	iters: 200, epoch: 4 | loss: 0.2084911
	speed: 0.0187s/iter; left time: 328.6437s
	iters: 300, epoch: 4 | loss: 0.4720680
	speed: 0.0182s/iter; left time: 319.3599s
	iters: 400, epoch: 4 | loss: 0.4200890
	speed: 0.0168s/iter; left time: 291.9737s
	iters: 500, epoch: 4 | loss: 0.4342814
	speed: 0.0195s/iter; left time: 337.2752s
	iters: 600, epoch: 4 | loss: 0.7782674
	speed: 0.0190s/iter; left time: 326.1032s
	iters: 700, epoch: 4 | loss: 0.2960867
	speed: 0.0182s/iter; left time: 310.6031s
	iters: 800, epoch: 4 | loss: 0.3048255
	speed: 0.0196s/iter; left time: 333.3141s
	iters: 900, epoch: 4 | loss: 0.4903266
	speed: 0.0177s/iter; left time: 298.6427s
	iters: 1000, epoch: 4 | loss: 0.5713443
	speed: 0.0161s/iter; left time: 271.1537s
Epoch: 4 cost time: 18.907660007476807
Epoch: 4, Steps: 1047 | Train Loss: 0.4984675 Vali Loss: 0.6275009 Test Loss: 1.6608708
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.4611472
	speed: 0.0611s/iter; left time: 1017.6550s
	iters: 200, epoch: 5 | loss: 0.3418841
	speed: 0.0178s/iter; left time: 293.9286s
	iters: 300, epoch: 5 | loss: 0.5064431
	speed: 0.0189s/iter; left time: 310.2169s
	iters: 400, epoch: 5 | loss: 0.3416919
	speed: 0.0187s/iter; left time: 305.7968s
	iters: 500, epoch: 5 | loss: 0.3388667
	speed: 0.0185s/iter; left time: 299.9446s
	iters: 600, epoch: 5 | loss: 0.3904757
	speed: 0.0178s/iter; left time: 287.3354s
	iters: 700, epoch: 5 | loss: 0.4580142
	speed: 0.0171s/iter; left time: 274.9763s
	iters: 800, epoch: 5 | loss: 0.5850224
	speed: 0.0196s/iter; left time: 312.6913s
	iters: 900, epoch: 5 | loss: 0.3433324
	speed: 0.0185s/iter; left time: 292.7956s
	iters: 1000, epoch: 5 | loss: 0.4163530
	speed: 0.0175s/iter; left time: 276.2790s
Epoch: 5 cost time: 18.91364336013794
Epoch: 5, Steps: 1047 | Train Loss: 0.4755150 Vali Loss: 0.5232530 Test Loss: 1.2537069
EarlyStopping counter: 3 out of 5
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.4771581
	speed: 0.0620s/iter; left time: 967.9656s
	iters: 200, epoch: 6 | loss: 0.4847424
	speed: 0.0170s/iter; left time: 264.1745s
	iters: 300, epoch: 6 | loss: 0.3027155
	speed: 0.0189s/iter; left time: 290.5371s
	iters: 400, epoch: 6 | loss: 0.3470242
	speed: 0.0168s/iter; left time: 257.5538s
	iters: 500, epoch: 6 | loss: 0.3892260
	speed: 0.0177s/iter; left time: 268.3910s
	iters: 600, epoch: 6 | loss: 0.4488165
	speed: 0.0183s/iter; left time: 277.0806s
	iters: 700, epoch: 6 | loss: 0.3242316
	speed: 0.0177s/iter; left time: 265.7978s
	iters: 800, epoch: 6 | loss: 0.3550526
	speed: 0.0190s/iter; left time: 283.0129s
	iters: 900, epoch: 6 | loss: 0.3576621
	speed: 0.0197s/iter; left time: 292.1130s
	iters: 1000, epoch: 6 | loss: 0.4766366
	speed: 0.0200s/iter; left time: 294.2289s
Epoch: 6 cost time: 18.944576740264893
Epoch: 6, Steps: 1047 | Train Loss: 0.4643510 Vali Loss: 0.3716937 Test Loss: 0.7004362
Validation loss decreased (0.412911 --> 0.371694).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.2646747
	speed: 0.0622s/iter; left time: 905.4779s
	iters: 200, epoch: 7 | loss: 0.4275963
	speed: 0.0191s/iter; left time: 276.7245s
	iters: 300, epoch: 7 | loss: 0.6418184
	speed: 0.0205s/iter; left time: 294.2104s
	iters: 400, epoch: 7 | loss: 0.2786057
	speed: 0.0201s/iter; left time: 286.5994s
	iters: 500, epoch: 7 | loss: 0.3593360
	speed: 0.0211s/iter; left time: 299.3467s
	iters: 600, epoch: 7 | loss: 0.3822723
	speed: 0.0194s/iter; left time: 272.5507s
	iters: 700, epoch: 7 | loss: 0.3211321
	speed: 0.0189s/iter; left time: 264.2339s
	iters: 800, epoch: 7 | loss: 0.5070741
	speed: 0.0168s/iter; left time: 233.1181s
	iters: 900, epoch: 7 | loss: 0.7540579
	speed: 0.0160s/iter; left time: 220.7801s
	iters: 1000, epoch: 7 | loss: 0.3963856
	speed: 0.0187s/iter; left time: 255.8590s
Epoch: 7 cost time: 19.550588130950928
Epoch: 7, Steps: 1047 | Train Loss: 0.4574147 Vali Loss: 0.4080867 Test Loss: 0.8098578
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.4356683
	speed: 0.0611s/iter; left time: 825.9278s
	iters: 200, epoch: 8 | loss: 0.2921779
	speed: 0.0183s/iter; left time: 245.4344s
	iters: 300, epoch: 8 | loss: 0.1901062
	speed: 0.0173s/iter; left time: 230.1904s
	iters: 400, epoch: 8 | loss: 1.1509107
	speed: 0.0192s/iter; left time: 254.2881s
	iters: 500, epoch: 8 | loss: 0.4887658
	speed: 0.0195s/iter; left time: 256.0269s
	iters: 600, epoch: 8 | loss: 0.3309249
	speed: 0.0170s/iter; left time: 220.7600s
	iters: 700, epoch: 8 | loss: 0.3846805
	speed: 0.0197s/iter; left time: 253.9962s
	iters: 800, epoch: 8 | loss: 0.2944504
	speed: 0.0205s/iter; left time: 263.0596s
	iters: 900, epoch: 8 | loss: 0.3177176
	speed: 0.0189s/iter; left time: 240.3452s
	iters: 1000, epoch: 8 | loss: 0.5999120
	speed: 0.0181s/iter; left time: 228.1278s
Epoch: 8 cost time: 19.132607460021973
Epoch: 8, Steps: 1047 | Train Loss: 0.4537082 Vali Loss: 0.4184842 Test Loss: 0.8491787
EarlyStopping counter: 2 out of 5
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.4815601
	speed: 0.0615s/iter; left time: 766.2072s
	iters: 200, epoch: 9 | loss: 0.2540189
	speed: 0.0181s/iter; left time: 223.8819s
	iters: 300, epoch: 9 | loss: 0.6194193
	speed: 0.0188s/iter; left time: 230.9177s
	iters: 400, epoch: 9 | loss: 0.2879315
	speed: 0.0194s/iter; left time: 236.5074s
	iters: 500, epoch: 9 | loss: 0.3279800
	speed: 0.0192s/iter; left time: 232.0802s
	iters: 600, epoch: 9 | loss: 0.2699741
	speed: 0.0181s/iter; left time: 216.6720s
	iters: 700, epoch: 9 | loss: 0.5543664
	speed: 0.0195s/iter; left time: 231.0101s
	iters: 800, epoch: 9 | loss: 0.4956736
	speed: 0.0158s/iter; left time: 185.7919s
	iters: 900, epoch: 9 | loss: 0.8293808
	speed: 0.0171s/iter; left time: 199.2813s
	iters: 1000, epoch: 9 | loss: 0.5101146
	speed: 0.0190s/iter; left time: 219.3876s
Epoch: 9 cost time: 18.89465856552124
Epoch: 9, Steps: 1047 | Train Loss: 0.4513509 Vali Loss: 0.4218580 Test Loss: 0.8805901
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.6070985
	speed: 0.0608s/iter; left time: 693.7186s
	iters: 200, epoch: 10 | loss: 0.3069495
	speed: 0.0159s/iter; left time: 179.8505s
	iters: 300, epoch: 10 | loss: 0.2865086
	speed: 0.0176s/iter; left time: 197.7465s
	iters: 400, epoch: 10 | loss: 0.3733551
	speed: 0.0172s/iter; left time: 191.2166s
	iters: 500, epoch: 10 | loss: 0.3668705
	speed: 0.0151s/iter; left time: 165.9657s
	iters: 600, epoch: 10 | loss: 0.4457132
	speed: 0.0172s/iter; left time: 187.5652s
	iters: 700, epoch: 10 | loss: 0.4036933
	speed: 0.0184s/iter; left time: 199.2569s
	iters: 800, epoch: 10 | loss: 0.2148674
	speed: 0.0165s/iter; left time: 176.8879s
	iters: 900, epoch: 10 | loss: 0.3471870
	speed: 0.0163s/iter; left time: 172.9080s
	iters: 1000, epoch: 10 | loss: 0.3259261
	speed: 0.0161s/iter; left time: 169.3657s
Epoch: 10 cost time: 17.29172921180725
Epoch: 10, Steps: 1047 | Train Loss: 0.4502978 Vali Loss: 0.4143587 Test Loss: 0.8474805
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.3280985
	speed: 0.0602s/iter; left time: 624.3982s
	iters: 200, epoch: 11 | loss: 0.5597804
	speed: 0.0155s/iter; left time: 159.6172s
	iters: 300, epoch: 11 | loss: 0.5938385
	speed: 0.0143s/iter; left time: 145.7829s
	iters: 400, epoch: 11 | loss: 0.4531426
	speed: 0.0159s/iter; left time: 160.5762s
	iters: 500, epoch: 11 | loss: 0.3131799
	speed: 0.0156s/iter; left time: 155.2888s
	iters: 600, epoch: 11 | loss: 0.4904474
	speed: 0.0149s/iter; left time: 146.9944s
	iters: 700, epoch: 11 | loss: 0.2977180
	speed: 0.0153s/iter; left time: 149.9570s
	iters: 800, epoch: 11 | loss: 0.4284180
	speed: 0.0153s/iter; left time: 148.0194s
	iters: 900, epoch: 11 | loss: 0.2924962
	speed: 0.0152s/iter; left time: 145.0683s
	iters: 1000, epoch: 11 | loss: 0.3061784
	speed: 0.0144s/iter; left time: 136.3128s
Epoch: 11 cost time: 15.771054744720459
Epoch: 11, Steps: 1047 | Train Loss: 0.4497436 Vali Loss: 0.4111888 Test Loss: 0.8351892
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTm2_336_720_Linear_ETTm2_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed10458<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10801
mse:0.7010063529014587, mae:0.5397276878356934
