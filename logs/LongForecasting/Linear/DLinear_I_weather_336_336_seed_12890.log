Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='DLinear', model_id='weather_336_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=336, root_path='./dataset/', save_pred_values=False, seed=12890, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : weather_336_336_DLinear_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed12890>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36216
val 4935
test 10204
	iters: 100, epoch: 1 | loss: 0.5203853
	speed: 0.0431s/iter; left time: 1947.0923s
	iters: 200, epoch: 1 | loss: 0.7209005
	speed: 0.0465s/iter; left time: 2096.8232s
	iters: 300, epoch: 1 | loss: 2.5870175
	speed: 0.0453s/iter; left time: 2037.9033s
	iters: 400, epoch: 1 | loss: 2.6881933
	speed: 0.0466s/iter; left time: 2089.5360s
	iters: 500, epoch: 1 | loss: 0.5317827
	speed: 0.0471s/iter; left time: 2106.6104s
	iters: 600, epoch: 1 | loss: 0.5450601
	speed: 0.0428s/iter; left time: 1913.1029s
	iters: 700, epoch: 1 | loss: 0.5244907
	speed: 0.0440s/iter; left time: 1959.6276s
	iters: 800, epoch: 1 | loss: 0.6639152
	speed: 0.0469s/iter; left time: 2085.3593s
	iters: 900, epoch: 1 | loss: 0.4641866
	speed: 0.0440s/iter; left time: 1949.8634s
	iters: 1000, epoch: 1 | loss: 0.6728811
	speed: 0.0485s/iter; left time: 2147.2853s
	iters: 1100, epoch: 1 | loss: 0.5475063
	speed: 0.0454s/iter; left time: 2005.2003s
	iters: 1200, epoch: 1 | loss: 0.4548741
	speed: 0.0450s/iter; left time: 1982.2347s
	iters: 1300, epoch: 1 | loss: 0.6960239
	speed: 0.0461s/iter; left time: 2027.8473s
	iters: 1400, epoch: 1 | loss: 0.5622304
	speed: 0.0463s/iter; left time: 2031.3800s
	iters: 1500, epoch: 1 | loss: 0.6368980
	speed: 0.0461s/iter; left time: 2016.1762s
	iters: 1600, epoch: 1 | loss: 0.6498464
	speed: 0.0455s/iter; left time: 1988.2002s
	iters: 1700, epoch: 1 | loss: 0.5205967
	speed: 0.0459s/iter; left time: 2001.2193s
	iters: 1800, epoch: 1 | loss: 0.5910128
	speed: 0.0470s/iter; left time: 2042.6573s
	iters: 1900, epoch: 1 | loss: 0.4172151
	speed: 0.0478s/iter; left time: 2072.6348s
	iters: 2000, epoch: 1 | loss: 1.2063403
	speed: 0.0452s/iter; left time: 1957.5020s
	iters: 2100, epoch: 1 | loss: 0.4110799
	speed: 0.0457s/iter; left time: 1973.8581s
	iters: 2200, epoch: 1 | loss: 1.0244304
	speed: 0.0466s/iter; left time: 2005.2932s
Epoch: 1 cost time: 103.35326194763184
Epoch: 1, Steps: 2263 | Train Loss: 1.0597152 Vali Loss: 0.7232866 Test Loss: 0.3532383
Validation loss decreased (inf --> 0.723287).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 3.7193055
	speed: 0.1500s/iter; left time: 6434.0845s
	iters: 200, epoch: 2 | loss: 1.0826365
	speed: 0.0448s/iter; left time: 1919.1252s
	iters: 300, epoch: 2 | loss: 0.5423768
	speed: 0.0419s/iter; left time: 1788.4481s
	iters: 400, epoch: 2 | loss: 0.5709574
	speed: 0.0449s/iter; left time: 1912.1333s
	iters: 500, epoch: 2 | loss: 1.1231775
	speed: 0.0462s/iter; left time: 1964.2121s
	iters: 600, epoch: 2 | loss: 0.6364937
	speed: 0.0451s/iter; left time: 1912.9535s
	iters: 700, epoch: 2 | loss: 0.6217304
	speed: 0.0446s/iter; left time: 1885.5861s
	iters: 800, epoch: 2 | loss: 5.1888041
	speed: 0.0471s/iter; left time: 1986.8745s
	iters: 900, epoch: 2 | loss: 0.6083218
	speed: 0.0447s/iter; left time: 1883.1073s
	iters: 1000, epoch: 2 | loss: 0.5343193
	speed: 0.0444s/iter; left time: 1863.0946s
	iters: 1100, epoch: 2 | loss: 0.5099931
	speed: 0.0434s/iter; left time: 1819.3752s
	iters: 1200, epoch: 2 | loss: 0.8230824
	speed: 0.0438s/iter; left time: 1831.9418s
	iters: 1300, epoch: 2 | loss: 0.5291049
	speed: 0.0438s/iter; left time: 1827.2269s
	iters: 1400, epoch: 2 | loss: 0.5997846
	speed: 0.0453s/iter; left time: 1883.6230s
	iters: 1500, epoch: 2 | loss: 0.5859297
	speed: 0.0459s/iter; left time: 1906.5326s
	iters: 1600, epoch: 2 | loss: 1.0140579
	speed: 0.0462s/iter; left time: 1913.3780s
	iters: 1700, epoch: 2 | loss: 1.2637854
	speed: 0.0466s/iter; left time: 1925.4260s
	iters: 1800, epoch: 2 | loss: 0.7679099
	speed: 0.0457s/iter; left time: 1881.9699s
	iters: 1900, epoch: 2 | loss: 0.5607141
	speed: 0.0489s/iter; left time: 2009.2737s
	iters: 2000, epoch: 2 | loss: 0.4733399
	speed: 0.0469s/iter; left time: 1922.6849s
	iters: 2100, epoch: 2 | loss: 1.5666567
	speed: 0.0457s/iter; left time: 1867.7096s
	iters: 2200, epoch: 2 | loss: 1.1350207
	speed: 0.0453s/iter; left time: 1849.2378s
Epoch: 2 cost time: 102.3076479434967
Epoch: 2, Steps: 2263 | Train Loss: 1.1698016 Vali Loss: 0.7732880 Test Loss: 0.3513311
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.4364368
	speed: 0.1390s/iter; left time: 5648.3917s
	iters: 200, epoch: 3 | loss: 1.5643619
	speed: 0.0443s/iter; left time: 1797.3748s
	iters: 300, epoch: 3 | loss: 0.5567929
	speed: 0.0440s/iter; left time: 1779.6598s
	iters: 400, epoch: 3 | loss: 0.6898252
	speed: 0.0451s/iter; left time: 1820.8619s
	iters: 500, epoch: 3 | loss: 0.6134458
	speed: 0.0447s/iter; left time: 1796.5224s
	iters: 600, epoch: 3 | loss: 0.9460453
	speed: 0.0450s/iter; left time: 1807.1210s
	iters: 700, epoch: 3 | loss: 0.4478511
	speed: 0.0440s/iter; left time: 1763.2415s
	iters: 800, epoch: 3 | loss: 0.4638032
	speed: 0.0472s/iter; left time: 1884.0620s
	iters: 900, epoch: 3 | loss: 0.4891375
	speed: 0.0426s/iter; left time: 1695.3675s
	iters: 1000, epoch: 3 | loss: 0.4727744
	speed: 0.0451s/iter; left time: 1792.0013s
	iters: 1100, epoch: 3 | loss: 0.5066136
	speed: 0.0463s/iter; left time: 1837.0073s
	iters: 1200, epoch: 3 | loss: 0.4395545
	speed: 0.0445s/iter; left time: 1760.7285s
	iters: 1300, epoch: 3 | loss: 0.6837250
	speed: 0.0453s/iter; left time: 1784.5062s
	iters: 1400, epoch: 3 | loss: 0.7347355
	speed: 0.0428s/iter; left time: 1681.8027s
	iters: 1500, epoch: 3 | loss: 0.4332613
	speed: 0.0479s/iter; left time: 1879.8858s
	iters: 1600, epoch: 3 | loss: 0.4233316
	speed: 0.0461s/iter; left time: 1805.7123s
	iters: 1700, epoch: 3 | loss: 0.4517100
	speed: 0.0471s/iter; left time: 1839.2564s
	iters: 1800, epoch: 3 | loss: 0.6110577
	speed: 0.0457s/iter; left time: 1780.4239s
	iters: 1900, epoch: 3 | loss: 1.0706780
	speed: 0.0428s/iter; left time: 1662.1502s
	iters: 2000, epoch: 3 | loss: 0.5316345
	speed: 0.0425s/iter; left time: 1647.3037s
	iters: 2100, epoch: 3 | loss: 0.4106818
	speed: 0.0449s/iter; left time: 1735.0368s
	iters: 2200, epoch: 3 | loss: 0.3664483
	speed: 0.0466s/iter; left time: 1795.3548s
Epoch: 3 cost time: 101.41331219673157
Epoch: 3, Steps: 2263 | Train Loss: 0.7839871 Vali Loss: 0.6143595 Test Loss: 0.2826016
Validation loss decreased (0.723287 --> 0.614359).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.9582914
	speed: 0.1422s/iter; left time: 5457.1314s
	iters: 200, epoch: 4 | loss: 0.3903914
	speed: 0.0467s/iter; left time: 1788.0847s
	iters: 300, epoch: 4 | loss: 1.6277757
	speed: 0.0454s/iter; left time: 1734.7282s
	iters: 400, epoch: 4 | loss: 0.7663365
	speed: 0.0472s/iter; left time: 1797.8025s
	iters: 500, epoch: 4 | loss: 1.1759567
	speed: 0.0450s/iter; left time: 1709.9091s
	iters: 600, epoch: 4 | loss: 1.2222030
	speed: 0.0436s/iter; left time: 1651.2565s
	iters: 700, epoch: 4 | loss: 0.6316467
	speed: 0.0461s/iter; left time: 1741.9242s
	iters: 800, epoch: 4 | loss: 0.5207067
	speed: 0.0450s/iter; left time: 1695.6638s
	iters: 900, epoch: 4 | loss: 0.3351276
	speed: 0.0459s/iter; left time: 1724.6426s
	iters: 1000, epoch: 4 | loss: 1.0157701
	speed: 0.0454s/iter; left time: 1701.3035s
	iters: 1100, epoch: 4 | loss: 0.6546593
	speed: 0.0437s/iter; left time: 1632.0234s
	iters: 1200, epoch: 4 | loss: 0.4646759
	speed: 0.0475s/iter; left time: 1772.1895s
	iters: 1300, epoch: 4 | loss: 0.4952910
	speed: 0.0453s/iter; left time: 1683.3769s
	iters: 1400, epoch: 4 | loss: 1.3559390
	speed: 0.0443s/iter; left time: 1643.5066s
	iters: 1500, epoch: 4 | loss: 0.4751759
	speed: 0.0467s/iter; left time: 1727.7964s
	iters: 1600, epoch: 4 | loss: 0.3454024
	speed: 0.0467s/iter; left time: 1721.2101s
	iters: 1700, epoch: 4 | loss: 0.9432099
	speed: 0.0462s/iter; left time: 1699.2405s
	iters: 1800, epoch: 4 | loss: 0.4288373
	speed: 0.0453s/iter; left time: 1661.5522s
	iters: 1900, epoch: 4 | loss: 0.3392059
	speed: 0.0466s/iter; left time: 1702.6260s
	iters: 2000, epoch: 4 | loss: 0.4579284
	speed: 0.0446s/iter; left time: 1628.3478s
	iters: 2100, epoch: 4 | loss: 0.6252307
	speed: 0.0440s/iter; left time: 1602.0062s
	iters: 2200, epoch: 4 | loss: 0.5003182
	speed: 0.0458s/iter; left time: 1661.6426s
Epoch: 4 cost time: 102.43276786804199
Epoch: 4, Steps: 2263 | Train Loss: 0.5839323 Vali Loss: 0.5359163 Test Loss: 0.2634686
Validation loss decreased (0.614359 --> 0.535916).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.4762404
	speed: 0.1426s/iter; left time: 5147.5335s
	iters: 200, epoch: 5 | loss: 0.4353968
	speed: 0.0443s/iter; left time: 1593.8655s
	iters: 300, epoch: 5 | loss: 0.5314927
	speed: 0.0410s/iter; left time: 1473.6690s
	iters: 400, epoch: 5 | loss: 0.3622881
	speed: 0.0451s/iter; left time: 1615.4278s
	iters: 500, epoch: 5 | loss: 0.5525758
	speed: 0.0447s/iter; left time: 1595.2209s
	iters: 600, epoch: 5 | loss: 0.4019900
	speed: 0.0441s/iter; left time: 1571.6132s
	iters: 700, epoch: 5 | loss: 0.5178640
	speed: 0.0453s/iter; left time: 1607.4403s
	iters: 800, epoch: 5 | loss: 0.4149937
	speed: 0.0457s/iter; left time: 1617.6251s
	iters: 900, epoch: 5 | loss: 0.3305823
	speed: 0.0461s/iter; left time: 1627.6944s
	iters: 1000, epoch: 5 | loss: 0.4615747
	speed: 0.0445s/iter; left time: 1567.8016s
	iters: 1100, epoch: 5 | loss: 0.4961026
	speed: 0.0418s/iter; left time: 1468.2335s
	iters: 1200, epoch: 5 | loss: 0.3961850
	speed: 0.0449s/iter; left time: 1572.4116s
	iters: 1300, epoch: 5 | loss: 0.5036556
	speed: 0.0432s/iter; left time: 1507.6752s
	iters: 1400, epoch: 5 | loss: 0.4629737
	speed: 0.0413s/iter; left time: 1439.2669s
	iters: 1500, epoch: 5 | loss: 0.5013274
	speed: 0.0464s/iter; left time: 1611.7532s
	iters: 1600, epoch: 5 | loss: 0.4001257
	speed: 0.0481s/iter; left time: 1665.3135s
	iters: 1700, epoch: 5 | loss: 0.3894958
	speed: 0.0445s/iter; left time: 1535.8718s
	iters: 1800, epoch: 5 | loss: 1.1637455
	speed: 0.0445s/iter; left time: 1532.1253s
	iters: 1900, epoch: 5 | loss: 0.8739997
	speed: 0.0457s/iter; left time: 1566.4787s
	iters: 2000, epoch: 5 | loss: 0.5893077
	speed: 0.0468s/iter; left time: 1602.0450s
	iters: 2100, epoch: 5 | loss: 0.3176511
	speed: 0.0479s/iter; left time: 1634.0385s
	iters: 2200, epoch: 5 | loss: 0.5252175
	speed: 0.0444s/iter; left time: 1509.9693s
Epoch: 5 cost time: 100.42596292495728
Epoch: 5, Steps: 2263 | Train Loss: 0.5289689 Vali Loss: 0.5202714 Test Loss: 0.2565614
Validation loss decreased (0.535916 --> 0.520271).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.4181091
	speed: 0.1612s/iter; left time: 5455.5007s
	iters: 200, epoch: 6 | loss: 0.4707689
	speed: 0.0437s/iter; left time: 1475.4247s
	iters: 300, epoch: 6 | loss: 0.5381351
	speed: 0.0442s/iter; left time: 1487.5776s
	iters: 400, epoch: 6 | loss: 0.3554662
	speed: 0.0447s/iter; left time: 1498.2085s
	iters: 500, epoch: 6 | loss: 0.5242551
	speed: 0.0464s/iter; left time: 1551.1520s
	iters: 600, epoch: 6 | loss: 0.6453733
	speed: 0.0486s/iter; left time: 1619.6080s
	iters: 700, epoch: 6 | loss: 0.3868425
	speed: 0.0488s/iter; left time: 1620.7557s
	iters: 800, epoch: 6 | loss: 0.3738315
	speed: 0.0445s/iter; left time: 1473.8981s
	iters: 900, epoch: 6 | loss: 0.6336217
	speed: 0.0451s/iter; left time: 1488.9113s
	iters: 1000, epoch: 6 | loss: 0.5550499
	speed: 0.0458s/iter; left time: 1509.8969s
	iters: 1100, epoch: 6 | loss: 0.4487211
	speed: 0.0472s/iter; left time: 1549.9008s
	iters: 1200, epoch: 6 | loss: 0.4599915
	speed: 0.0432s/iter; left time: 1414.3199s
	iters: 1300, epoch: 6 | loss: 0.3328033
	speed: 0.0458s/iter; left time: 1494.5339s
	iters: 1400, epoch: 6 | loss: 0.5022805
	speed: 0.0458s/iter; left time: 1489.3754s
	iters: 1500, epoch: 6 | loss: 0.5552574
	speed: 0.0455s/iter; left time: 1475.4724s
	iters: 1600, epoch: 6 | loss: 1.0087248
	speed: 0.0458s/iter; left time: 1481.0586s
	iters: 1700, epoch: 6 | loss: 0.3913471
	speed: 0.0440s/iter; left time: 1418.3967s
	iters: 1800, epoch: 6 | loss: 0.5117494
	speed: 0.0445s/iter; left time: 1430.5281s
	iters: 1900, epoch: 6 | loss: 0.3721632
	speed: 0.0466s/iter; left time: 1492.4700s
	iters: 2000, epoch: 6 | loss: 0.5122753
	speed: 0.0445s/iter; left time: 1421.6489s
	iters: 2100, epoch: 6 | loss: 0.4763972
	speed: 0.0448s/iter; left time: 1428.0777s
	iters: 2200, epoch: 6 | loss: 0.3369149
	speed: 0.0433s/iter; left time: 1376.0656s
Epoch: 6 cost time: 101.58016586303711
Epoch: 6, Steps: 2263 | Train Loss: 0.5094937 Vali Loss: 0.4965275 Test Loss: 0.2429809
Validation loss decreased (0.520271 --> 0.496527).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.5602351
	speed: 0.1514s/iter; left time: 4781.6911s
	iters: 200, epoch: 7 | loss: 0.4029430
	speed: 0.0429s/iter; left time: 1351.1794s
	iters: 300, epoch: 7 | loss: 0.3836269
	speed: 0.0437s/iter; left time: 1371.6106s
	iters: 400, epoch: 7 | loss: 0.8769850
	speed: 0.0447s/iter; left time: 1398.4319s
	iters: 500, epoch: 7 | loss: 0.4205798
	speed: 0.0456s/iter; left time: 1421.5766s
	iters: 600, epoch: 7 | loss: 0.3549836
	speed: 0.0457s/iter; left time: 1421.7830s
	iters: 700, epoch: 7 | loss: 0.4679580
	speed: 0.0462s/iter; left time: 1431.5703s
	iters: 800, epoch: 7 | loss: 1.0333382
	speed: 0.0463s/iter; left time: 1428.5931s
	iters: 900, epoch: 7 | loss: 0.4245349
	speed: 0.0465s/iter; left time: 1430.1886s
	iters: 1000, epoch: 7 | loss: 0.3183773
	speed: 0.0463s/iter; left time: 1419.6567s
	iters: 1100, epoch: 7 | loss: 0.9849511
	speed: 0.0460s/iter; left time: 1406.8751s
	iters: 1200, epoch: 7 | loss: 1.0187210
	speed: 0.0464s/iter; left time: 1415.8153s
	iters: 1300, epoch: 7 | loss: 0.9895762
	speed: 0.0448s/iter; left time: 1359.6756s
	iters: 1400, epoch: 7 | loss: 0.3678744
	speed: 0.0464s/iter; left time: 1405.8817s
	iters: 1500, epoch: 7 | loss: 0.4318188
	speed: 0.0447s/iter; left time: 1350.3119s
	iters: 1600, epoch: 7 | loss: 1.4544808
	speed: 0.0467s/iter; left time: 1405.5035s
	iters: 1700, epoch: 7 | loss: 0.3547530
	speed: 0.0487s/iter; left time: 1459.9939s
	iters: 1800, epoch: 7 | loss: 0.3333096
	speed: 0.0423s/iter; left time: 1263.8154s
	iters: 1900, epoch: 7 | loss: 0.3535711
	speed: 0.0424s/iter; left time: 1262.7626s
	iters: 2000, epoch: 7 | loss: 0.3048348
	speed: 0.0450s/iter; left time: 1336.0749s
	iters: 2100, epoch: 7 | loss: 0.4146430
	speed: 0.0451s/iter; left time: 1333.9949s
	iters: 2200, epoch: 7 | loss: 0.3116638
	speed: 0.0465s/iter; left time: 1370.0532s
Epoch: 7 cost time: 101.73412680625916
Epoch: 7, Steps: 2263 | Train Loss: 0.5011667 Vali Loss: 0.4939978 Test Loss: 0.2399383
Validation loss decreased (0.496527 --> 0.493998).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.4317966
	speed: 0.1496s/iter; left time: 4386.5259s
	iters: 200, epoch: 8 | loss: 0.3809850
	speed: 0.0416s/iter; left time: 1214.8462s
	iters: 300, epoch: 8 | loss: 0.4651428
	speed: 0.0436s/iter; left time: 1270.7398s
	iters: 400, epoch: 8 | loss: 0.3593928
	speed: 0.0457s/iter; left time: 1327.4038s
	iters: 500, epoch: 8 | loss: 0.4827830
	speed: 0.0449s/iter; left time: 1297.8800s
	iters: 600, epoch: 8 | loss: 0.3697101
	speed: 0.0467s/iter; left time: 1345.9339s
	iters: 700, epoch: 8 | loss: 0.3926049
	speed: 0.0459s/iter; left time: 1318.4794s
	iters: 800, epoch: 8 | loss: 0.4553347
	speed: 0.0451s/iter; left time: 1290.1240s
	iters: 900, epoch: 8 | loss: 0.4167055
	speed: 0.0450s/iter; left time: 1284.2040s
	iters: 1000, epoch: 8 | loss: 0.4342268
	speed: 0.0468s/iter; left time: 1331.1092s
	iters: 1100, epoch: 8 | loss: 0.3857944
	speed: 0.0448s/iter; left time: 1269.2635s
	iters: 1200, epoch: 8 | loss: 1.0529453
	speed: 0.0464s/iter; left time: 1310.6601s
	iters: 1300, epoch: 8 | loss: 0.3808874
	speed: 0.0446s/iter; left time: 1255.5418s
	iters: 1400, epoch: 8 | loss: 0.9170132
	speed: 0.0454s/iter; left time: 1271.4203s
	iters: 1500, epoch: 8 | loss: 0.4203170
	speed: 0.0446s/iter; left time: 1244.7490s
	iters: 1600, epoch: 8 | loss: 0.7571940
	speed: 0.0479s/iter; left time: 1331.5717s
	iters: 1700, epoch: 8 | loss: 0.3899461
	speed: 0.0466s/iter; left time: 1293.0614s
	iters: 1800, epoch: 8 | loss: 0.3834336
	speed: 0.0444s/iter; left time: 1226.0838s
	iters: 1900, epoch: 8 | loss: 0.3094559
	speed: 0.0458s/iter; left time: 1259.7954s
	iters: 2000, epoch: 8 | loss: 0.9735993
	speed: 0.0457s/iter; left time: 1253.1257s
	iters: 2100, epoch: 8 | loss: 1.0466291
	speed: 0.0474s/iter; left time: 1294.0360s
	iters: 2200, epoch: 8 | loss: 0.4031479
	speed: 0.0468s/iter; left time: 1274.6643s
Epoch: 8 cost time: 102.02598237991333
Epoch: 8, Steps: 2263 | Train Loss: 0.4971812 Vali Loss: 0.4933487 Test Loss: 0.2383527
Validation loss decreased (0.493998 --> 0.493349).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.5500898
	speed: 0.1550s/iter; left time: 4193.6699s
	iters: 200, epoch: 9 | loss: 0.5641862
	speed: 0.0434s/iter; left time: 1169.4309s
	iters: 300, epoch: 9 | loss: 0.4111645
	speed: 0.0459s/iter; left time: 1232.1836s
	iters: 400, epoch: 9 | loss: 0.4973051
	speed: 0.0437s/iter; left time: 1168.7831s
	iters: 500, epoch: 9 | loss: 0.8628299
	speed: 0.0469s/iter; left time: 1249.7142s
	iters: 600, epoch: 9 | loss: 0.4032099
	speed: 0.0459s/iter; left time: 1217.7365s
	iters: 700, epoch: 9 | loss: 0.4436208
	speed: 0.0463s/iter; left time: 1224.4351s
	iters: 800, epoch: 9 | loss: 0.3659517
	speed: 0.0446s/iter; left time: 1176.4247s
	iters: 900, epoch: 9 | loss: 0.4560379
	speed: 0.0428s/iter; left time: 1123.2556s
	iters: 1000, epoch: 9 | loss: 0.4272562
	speed: 0.0454s/iter; left time: 1187.6326s
	iters: 1100, epoch: 9 | loss: 0.2472784
	speed: 0.0442s/iter; left time: 1151.3360s
	iters: 1200, epoch: 9 | loss: 0.4902734
	speed: 0.0446s/iter; left time: 1156.9440s
	iters: 1300, epoch: 9 | loss: 0.4142832
	speed: 0.0433s/iter; left time: 1118.7086s
	iters: 1400, epoch: 9 | loss: 0.8612679
	speed: 0.0449s/iter; left time: 1156.3766s
	iters: 1500, epoch: 9 | loss: 0.4912830
	speed: 0.0463s/iter; left time: 1188.1118s
	iters: 1600, epoch: 9 | loss: 0.2645925
	speed: 0.0486s/iter; left time: 1242.6884s
	iters: 1700, epoch: 9 | loss: 0.4185129
	speed: 0.0493s/iter; left time: 1256.0264s
	iters: 1800, epoch: 9 | loss: 0.4331449
	speed: 0.0428s/iter; left time: 1084.9786s
	iters: 1900, epoch: 9 | loss: 0.3230781
	speed: 0.0431s/iter; left time: 1087.7239s
	iters: 2000, epoch: 9 | loss: 0.4296331
	speed: 0.0439s/iter; left time: 1103.2230s
	iters: 2100, epoch: 9 | loss: 0.4711499
	speed: 0.0444s/iter; left time: 1113.6544s
	iters: 2200, epoch: 9 | loss: 0.3498829
	speed: 0.0452s/iter; left time: 1128.6659s
Epoch: 9 cost time: 101.19241523742676
Epoch: 9, Steps: 2263 | Train Loss: 0.4950959 Vali Loss: 0.4923062 Test Loss: 0.2421648
Validation loss decreased (0.493349 --> 0.492306).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.5297614
	speed: 0.1557s/iter; left time: 3861.3688s
	iters: 200, epoch: 10 | loss: 0.3964239
	speed: 0.0436s/iter; left time: 1075.8557s
	iters: 300, epoch: 10 | loss: 0.4582368
	speed: 0.0445s/iter; left time: 1095.3051s
	iters: 400, epoch: 10 | loss: 0.3348560
	speed: 0.0460s/iter; left time: 1127.0256s
	iters: 500, epoch: 10 | loss: 0.9720624
	speed: 0.0456s/iter; left time: 1111.9375s
	iters: 600, epoch: 10 | loss: 0.5185015
	speed: 0.0449s/iter; left time: 1090.0499s
	iters: 700, epoch: 10 | loss: 0.3501424
	speed: 0.0440s/iter; left time: 1063.4492s
	iters: 800, epoch: 10 | loss: 0.5259807
	speed: 0.0441s/iter; left time: 1062.0940s
	iters: 900, epoch: 10 | loss: 0.3930602
	speed: 0.0448s/iter; left time: 1075.0965s
	iters: 1000, epoch: 10 | loss: 0.3489446
	speed: 0.0461s/iter; left time: 1101.1344s
	iters: 1100, epoch: 10 | loss: 0.4010419
	speed: 0.0435s/iter; left time: 1035.7197s
	iters: 1200, epoch: 10 | loss: 0.4439581
	speed: 0.0457s/iter; left time: 1082.4171s
	iters: 1300, epoch: 10 | loss: 0.2867711
	speed: 0.0461s/iter; left time: 1088.7539s
	iters: 1400, epoch: 10 | loss: 0.5422624
	speed: 0.0453s/iter; left time: 1064.6740s
	iters: 1500, epoch: 10 | loss: 0.3558978
	speed: 0.0445s/iter; left time: 1040.4990s
	iters: 1600, epoch: 10 | loss: 0.3679999
	speed: 0.0456s/iter; left time: 1061.8858s
	iters: 1700, epoch: 10 | loss: 0.3919137
	speed: 0.0449s/iter; left time: 1042.0651s
	iters: 1800, epoch: 10 | loss: 0.4655485
	speed: 0.0448s/iter; left time: 1034.5011s
	iters: 1900, epoch: 10 | loss: 0.9322156
	speed: 0.0428s/iter; left time: 983.4703s
	iters: 2000, epoch: 10 | loss: 0.4684117
	speed: 0.0468s/iter; left time: 1072.1703s
	iters: 2100, epoch: 10 | loss: 0.3249455
	speed: 0.0452s/iter; left time: 1029.9492s
	iters: 2200, epoch: 10 | loss: 0.3391956
	speed: 0.0462s/iter; left time: 1049.3377s
Epoch: 10 cost time: 101.19881510734558
Epoch: 10, Steps: 2263 | Train Loss: 0.4940992 Vali Loss: 0.4937464 Test Loss: 0.2401777
EarlyStopping counter: 1 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.8132455
	speed: 0.1580s/iter; left time: 3560.9411s
	iters: 200, epoch: 11 | loss: 0.3529208
	speed: 0.0435s/iter; left time: 975.3983s
	iters: 300, epoch: 11 | loss: 0.4718346
	speed: 0.0451s/iter; left time: 1006.9942s
	iters: 400, epoch: 11 | loss: 0.3560071
	speed: 0.0445s/iter; left time: 990.3138s
	iters: 500, epoch: 11 | loss: 0.5413217
	speed: 0.0449s/iter; left time: 994.1740s
	iters: 600, epoch: 11 | loss: 0.3034169
	speed: 0.0465s/iter; left time: 1024.7167s
	iters: 700, epoch: 11 | loss: 0.3713043
	speed: 0.0476s/iter; left time: 1043.8450s
	iters: 800, epoch: 11 | loss: 0.5222021
	speed: 0.0466s/iter; left time: 1017.3375s
	iters: 900, epoch: 11 | loss: 0.4734497
	speed: 0.0429s/iter; left time: 931.1890s
	iters: 1000, epoch: 11 | loss: 0.3058468
	speed: 0.0462s/iter; left time: 998.4729s
	iters: 1100, epoch: 11 | loss: 0.4936089
	speed: 0.0444s/iter; left time: 956.2893s
	iters: 1200, epoch: 11 | loss: 0.3048551
	speed: 0.0463s/iter; left time: 991.8099s
	iters: 1300, epoch: 11 | loss: 0.3341556
	speed: 0.0408s/iter; left time: 870.7645s
	iters: 1400, epoch: 11 | loss: 0.2580985
	speed: 0.0437s/iter; left time: 928.3806s
	iters: 1500, epoch: 11 | loss: 0.2773651
	speed: 0.0433s/iter; left time: 915.8254s
	iters: 1600, epoch: 11 | loss: 0.4348745
	speed: 0.0461s/iter; left time: 969.0816s
	iters: 1700, epoch: 11 | loss: 0.5267071
	speed: 0.0458s/iter; left time: 958.8347s
	iters: 1800, epoch: 11 | loss: 0.4956435
	speed: 0.0462s/iter; left time: 962.5814s
	iters: 1900, epoch: 11 | loss: 0.2917031
	speed: 0.0472s/iter; left time: 978.4767s
	iters: 2000, epoch: 11 | loss: 0.4665416
	speed: 0.0473s/iter; left time: 975.3790s
	iters: 2100, epoch: 11 | loss: 0.3610582
	speed: 0.0446s/iter; left time: 914.7738s
	iters: 2200, epoch: 11 | loss: 0.3248146
	speed: 0.0454s/iter; left time: 928.5479s
Epoch: 11 cost time: 101.45198059082031
Epoch: 11, Steps: 2263 | Train Loss: 0.4935596 Vali Loss: 0.4927361 Test Loss: 0.2402926
EarlyStopping counter: 2 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.3871987
	speed: 0.1515s/iter; left time: 3070.0581s
	iters: 200, epoch: 12 | loss: 0.3992470
	speed: 0.0462s/iter; left time: 931.8915s
	iters: 300, epoch: 12 | loss: 0.3763871
	speed: 0.0447s/iter; left time: 896.6087s
	iters: 400, epoch: 12 | loss: 0.3987401
	speed: 0.0446s/iter; left time: 890.5542s
	iters: 500, epoch: 12 | loss: 0.4279573
	speed: 0.0443s/iter; left time: 880.9016s
	iters: 600, epoch: 12 | loss: 0.5207538
	speed: 0.0434s/iter; left time: 858.5254s
	iters: 700, epoch: 12 | loss: 0.4633265
	speed: 0.0428s/iter; left time: 841.4573s
	iters: 800, epoch: 12 | loss: 0.6036857
	speed: 0.0420s/iter; left time: 821.8905s
	iters: 900, epoch: 12 | loss: 0.4802166
	speed: 0.0453s/iter; left time: 882.7242s
	iters: 1000, epoch: 12 | loss: 0.4034295
	speed: 0.0409s/iter; left time: 791.4628s
	iters: 1100, epoch: 12 | loss: 0.3543409
	speed: 0.0465s/iter; left time: 895.8774s
	iters: 1200, epoch: 12 | loss: 0.4173657
	speed: 0.0476s/iter; left time: 912.1429s
	iters: 1300, epoch: 12 | loss: 0.4388047
	speed: 0.0445s/iter; left time: 848.3683s
	iters: 1400, epoch: 12 | loss: 0.3742847
	speed: 0.0473s/iter; left time: 897.6011s
	iters: 1500, epoch: 12 | loss: 0.3958520
	speed: 0.0440s/iter; left time: 829.4439s
	iters: 1600, epoch: 12 | loss: 0.4356081
	speed: 0.0455s/iter; left time: 854.4814s
	iters: 1700, epoch: 12 | loss: 0.3105817
	speed: 0.0443s/iter; left time: 827.6223s
	iters: 1800, epoch: 12 | loss: 0.3504027
	speed: 0.0452s/iter; left time: 839.6579s
	iters: 1900, epoch: 12 | loss: 0.4171587
	speed: 0.0455s/iter; left time: 840.6659s
	iters: 2000, epoch: 12 | loss: 0.4163438
	speed: 0.0456s/iter; left time: 837.2326s
	iters: 2100, epoch: 12 | loss: 0.3475421
	speed: 0.0468s/iter; left time: 854.4935s
	iters: 2200, epoch: 12 | loss: 0.4265237
	speed: 0.0467s/iter; left time: 848.1969s
Epoch: 12 cost time: 101.40483570098877
Epoch: 12, Steps: 2263 | Train Loss: 0.4932699 Vali Loss: 0.4933143 Test Loss: 0.2402806
EarlyStopping counter: 3 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.4177160
	speed: 0.1530s/iter; left time: 2754.9390s
	iters: 200, epoch: 13 | loss: 0.4450820
	speed: 0.0396s/iter; left time: 709.5847s
	iters: 300, epoch: 13 | loss: 0.4298872
	speed: 0.0420s/iter; left time: 748.4657s
	iters: 400, epoch: 13 | loss: 0.4115794
	speed: 0.0439s/iter; left time: 777.7754s
	iters: 500, epoch: 13 | loss: 0.3359079
	speed: 0.0446s/iter; left time: 785.3155s
	iters: 600, epoch: 13 | loss: 0.9476309
	speed: 0.0435s/iter; left time: 761.5279s
	iters: 700, epoch: 13 | loss: 0.3290369
	speed: 0.0442s/iter; left time: 768.8254s
	iters: 800, epoch: 13 | loss: 0.6877519
	speed: 0.0457s/iter; left time: 790.3508s
	iters: 900, epoch: 13 | loss: 0.9218725
	speed: 0.0439s/iter; left time: 754.7127s
	iters: 1000, epoch: 13 | loss: 0.8448899
	speed: 0.0452s/iter; left time: 773.0587s
	iters: 1100, epoch: 13 | loss: 0.5083131
	speed: 0.0448s/iter; left time: 762.5019s
	iters: 1200, epoch: 13 | loss: 0.4331010
	speed: 0.0444s/iter; left time: 751.2651s
	iters: 1300, epoch: 13 | loss: 0.3753563
	speed: 0.0464s/iter; left time: 779.1138s
	iters: 1400, epoch: 13 | loss: 0.2675880
	speed: 0.0468s/iter; left time: 781.8513s
	iters: 1500, epoch: 13 | loss: 0.4022841
	speed: 0.0434s/iter; left time: 720.6685s
	iters: 1600, epoch: 13 | loss: 0.4564551
	speed: 0.0428s/iter; left time: 707.1501s
	iters: 1700, epoch: 13 | loss: 0.4510403
	speed: 0.0460s/iter; left time: 753.8847s
	iters: 1800, epoch: 13 | loss: 0.5141826
	speed: 0.0447s/iter; left time: 729.0135s
	iters: 1900, epoch: 13 | loss: 0.4060443
	speed: 0.0471s/iter; left time: 762.9353s
	iters: 2000, epoch: 13 | loss: 0.9652612
	speed: 0.0451s/iter; left time: 726.2235s
	iters: 2100, epoch: 13 | loss: 0.2792764
	speed: 0.0450s/iter; left time: 720.6791s
	iters: 2200, epoch: 13 | loss: 0.3852915
	speed: 0.0427s/iter; left time: 678.8540s
Epoch: 13 cost time: 100.05617380142212
Epoch: 13, Steps: 2263 | Train Loss: 0.4928921 Vali Loss: 0.4933209 Test Loss: 0.2400930
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.9548736
	speed: 0.1518s/iter; left time: 2389.7872s
	iters: 200, epoch: 14 | loss: 0.4540383
	speed: 0.0416s/iter; left time: 649.9699s
	iters: 300, epoch: 14 | loss: 0.3797899
	speed: 0.0432s/iter; left time: 670.9043s
	iters: 400, epoch: 14 | loss: 0.2640769
	speed: 0.0438s/iter; left time: 675.7809s
	iters: 500, epoch: 14 | loss: 1.0049992
	speed: 0.0468s/iter; left time: 718.3806s
	iters: 600, epoch: 14 | loss: 0.3453782
	speed: 0.0459s/iter; left time: 699.9300s
	iters: 700, epoch: 14 | loss: 0.4602242
	speed: 0.0481s/iter; left time: 728.0929s
	iters: 800, epoch: 14 | loss: 0.4484386
	speed: 0.0456s/iter; left time: 685.6408s
	iters: 900, epoch: 14 | loss: 0.9140588
	speed: 0.0466s/iter; left time: 696.1155s
	iters: 1000, epoch: 14 | loss: 0.5395426
	speed: 0.0478s/iter; left time: 709.6551s
	iters: 1100, epoch: 14 | loss: 0.2805214
	speed: 0.0428s/iter; left time: 630.8191s
	iters: 1200, epoch: 14 | loss: 0.2975286
	speed: 0.0448s/iter; left time: 656.3336s
	iters: 1300, epoch: 14 | loss: 0.4523427
	speed: 0.0457s/iter; left time: 664.7520s
	iters: 1400, epoch: 14 | loss: 1.1890632
	speed: 0.0480s/iter; left time: 693.6822s
	iters: 1500, epoch: 14 | loss: 0.2646405
	speed: 0.0491s/iter; left time: 703.6787s
	iters: 1600, epoch: 14 | loss: 0.3966429
	speed: 0.0458s/iter; left time: 651.8729s
	iters: 1700, epoch: 14 | loss: 0.4344183
	speed: 0.0447s/iter; left time: 632.8181s
	iters: 1800, epoch: 14 | loss: 0.9147387
	speed: 0.0466s/iter; left time: 653.7711s
	iters: 1900, epoch: 14 | loss: 0.3372604
	speed: 0.0449s/iter; left time: 626.4850s
	iters: 2000, epoch: 14 | loss: 0.3061235
	speed: 0.0485s/iter; left time: 671.3519s
	iters: 2100, epoch: 14 | loss: 0.9631065
	speed: 0.0453s/iter; left time: 623.1342s
	iters: 2200, epoch: 14 | loss: 0.3911851
	speed: 0.0445s/iter; left time: 607.2536s
Epoch: 14 cost time: 102.47437810897827
Epoch: 14, Steps: 2263 | Train Loss: 0.4929847 Vali Loss: 0.4936325 Test Loss: 0.2401656
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : weather_336_336_DLinear_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed12890<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10204
mse:0.2422330528497696, mae:0.30115655064582825
