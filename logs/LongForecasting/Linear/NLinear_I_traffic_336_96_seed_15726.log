Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='NLinear', model_id='traffic_336_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=15726, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_336_96_NLinear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15726>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11849
val 1661
test 3413
	iters: 100, epoch: 1 | loss: 0.6759226
	speed: 0.3141s/iter; left time: 4618.2457s
	iters: 200, epoch: 1 | loss: 0.7616061
	speed: 0.2997s/iter; left time: 4376.3123s
	iters: 300, epoch: 1 | loss: 0.8233013
	speed: 0.3001s/iter; left time: 4351.6887s
	iters: 400, epoch: 1 | loss: 1.4080638
	speed: 0.2999s/iter; left time: 4318.9326s
	iters: 500, epoch: 1 | loss: 0.9188305
	speed: 0.3003s/iter; left time: 4294.3143s
	iters: 600, epoch: 1 | loss: 0.9869474
	speed: 0.3012s/iter; left time: 4277.4052s
	iters: 700, epoch: 1 | loss: 0.6138127
	speed: 0.2999s/iter; left time: 4229.5380s
Epoch: 1 cost time: 223.76377487182617
Epoch: 1, Steps: 740 | Train Loss: 1.0400003 Vali Loss: 0.8560711 Test Loss: 0.9900191
Validation loss decreased (inf --> 0.856071).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.8025733
	speed: 0.6091s/iter; left time: 8503.5695s
	iters: 200, epoch: 2 | loss: 1.3819573
	speed: 0.2998s/iter; left time: 4156.1104s
	iters: 300, epoch: 2 | loss: 0.9276075
	speed: 0.3002s/iter; left time: 4130.6476s
	iters: 400, epoch: 2 | loss: 1.4713901
	speed: 0.3014s/iter; left time: 4116.9390s
	iters: 500, epoch: 2 | loss: 0.5621760
	speed: 0.3011s/iter; left time: 4083.7082s
	iters: 600, epoch: 2 | loss: 0.8067346
	speed: 0.2999s/iter; left time: 4037.5368s
	iters: 700, epoch: 2 | loss: 1.2451619
	speed: 0.3001s/iter; left time: 4009.7260s
Epoch: 2 cost time: 222.22892832756042
Epoch: 2, Steps: 740 | Train Loss: 1.0863593 Vali Loss: 1.4300154 Test Loss: 1.2988708
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.3126490
	speed: 0.6106s/iter; left time: 8072.4384s
	iters: 200, epoch: 3 | loss: 0.3050590
	speed: 0.3008s/iter; left time: 3947.1813s
	iters: 300, epoch: 3 | loss: 0.3494925
	speed: 0.3003s/iter; left time: 3910.5570s
	iters: 400, epoch: 3 | loss: 0.3623325
	speed: 0.2997s/iter; left time: 3871.7847s
	iters: 500, epoch: 3 | loss: 0.3391103
	speed: 0.3017s/iter; left time: 3868.3473s
	iters: 600, epoch: 3 | loss: 0.3448737
	speed: 0.3009s/iter; left time: 3827.3425s
	iters: 700, epoch: 3 | loss: 0.3508509
	speed: 0.3002s/iter; left time: 3789.1344s
Epoch: 3 cost time: 222.54933166503906
Epoch: 3, Steps: 740 | Train Loss: 0.3605510 Vali Loss: 0.4617442 Test Loss: 0.5523139
Validation loss decreased (0.856071 --> 0.461744).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.2944752
	speed: 0.6083s/iter; left time: 7592.5318s
	iters: 200, epoch: 4 | loss: 0.3218122
	speed: 0.3005s/iter; left time: 3720.1233s
	iters: 300, epoch: 4 | loss: 0.2846295
	speed: 0.2999s/iter; left time: 3683.1487s
	iters: 400, epoch: 4 | loss: 0.2647667
	speed: 0.2999s/iter; left time: 3652.7942s
	iters: 500, epoch: 4 | loss: 0.2899183
	speed: 0.3002s/iter; left time: 3626.2357s
	iters: 600, epoch: 4 | loss: 0.2677143
	speed: 0.3005s/iter; left time: 3600.5287s
	iters: 700, epoch: 4 | loss: 0.2538857
	speed: 0.3001s/iter; left time: 3565.7531s
Epoch: 4 cost time: 222.14400553703308
Epoch: 4, Steps: 740 | Train Loss: 0.2779577 Vali Loss: 0.4038641 Test Loss: 0.4975648
Validation loss decreased (0.461744 --> 0.403864).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.2486557
	speed: 0.6089s/iter; left time: 7149.2345s
	iters: 200, epoch: 5 | loss: 0.2434838
	speed: 0.3004s/iter; left time: 3497.2005s
	iters: 300, epoch: 5 | loss: 0.2600574
	speed: 0.3011s/iter; left time: 3474.6493s
	iters: 400, epoch: 5 | loss: 0.2400024
	speed: 0.3005s/iter; left time: 3438.0693s
	iters: 500, epoch: 5 | loss: 0.2589108
	speed: 0.3007s/iter; left time: 3410.5510s
	iters: 600, epoch: 5 | loss: 0.2760045
	speed: 0.3008s/iter; left time: 3381.2615s
	iters: 700, epoch: 5 | loss: 0.2517236
	speed: 0.3009s/iter; left time: 3352.7771s
Epoch: 5 cost time: 222.55857849121094
Epoch: 5, Steps: 740 | Train Loss: 0.2571695 Vali Loss: 0.3707488 Test Loss: 0.4511530
Validation loss decreased (0.403864 --> 0.370749).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.2457709
	speed: 0.6110s/iter; left time: 6721.7084s
	iters: 200, epoch: 6 | loss: 0.2437777
	speed: 0.3011s/iter; left time: 3282.8188s
	iters: 300, epoch: 6 | loss: 0.2867051
	speed: 0.3002s/iter; left time: 3242.4832s
	iters: 400, epoch: 6 | loss: 0.2904371
	speed: 0.3001s/iter; left time: 3211.4271s
	iters: 500, epoch: 6 | loss: 0.2485926
	speed: 0.2997s/iter; left time: 3177.6295s
	iters: 600, epoch: 6 | loss: 0.2726724
	speed: 0.3000s/iter; left time: 3149.8575s
	iters: 700, epoch: 6 | loss: 0.2371634
	speed: 0.3004s/iter; left time: 3124.3676s
Epoch: 6 cost time: 222.35939693450928
Epoch: 6, Steps: 740 | Train Loss: 0.2470867 Vali Loss: 0.3604423 Test Loss: 0.4399535
Validation loss decreased (0.370749 --> 0.360442).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.2631452
	speed: 0.6093s/iter; left time: 6252.4200s
	iters: 200, epoch: 7 | loss: 0.2203937
	speed: 0.3010s/iter; left time: 3058.3680s
	iters: 300, epoch: 7 | loss: 0.2337526
	speed: 0.2998s/iter; left time: 3016.6295s
	iters: 400, epoch: 7 | loss: 0.2342192
	speed: 0.3003s/iter; left time: 2991.2294s
	iters: 500, epoch: 7 | loss: 0.2396617
	speed: 0.2996s/iter; left time: 2954.1621s
	iters: 600, epoch: 7 | loss: 0.2595010
	speed: 0.3002s/iter; left time: 2930.2889s
	iters: 700, epoch: 7 | loss: 0.2510310
	speed: 0.3006s/iter; left time: 2904.5292s
Epoch: 7 cost time: 222.19642233848572
Epoch: 7, Steps: 740 | Train Loss: 0.2414906 Vali Loss: 0.3545792 Test Loss: 0.4318556
Validation loss decreased (0.360442 --> 0.354579).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.2703444
	speed: 0.6085s/iter; left time: 5793.5336s
	iters: 200, epoch: 8 | loss: 0.2029651
	speed: 0.3015s/iter; left time: 2840.0165s
	iters: 300, epoch: 8 | loss: 0.2487799
	speed: 0.3009s/iter; left time: 2804.7671s
	iters: 400, epoch: 8 | loss: 0.2162409
	speed: 0.3003s/iter; left time: 2768.6586s
	iters: 500, epoch: 8 | loss: 0.2724108
	speed: 0.3008s/iter; left time: 2743.5996s
	iters: 600, epoch: 8 | loss: 0.2151340
	speed: 0.2995s/iter; left time: 2701.9731s
	iters: 700, epoch: 8 | loss: 0.2262933
	speed: 0.3002s/iter; left time: 2678.4643s
Epoch: 8 cost time: 222.43620991706848
Epoch: 8, Steps: 740 | Train Loss: 0.2381734 Vali Loss: 0.3501078 Test Loss: 0.4264516
Validation loss decreased (0.354579 --> 0.350108).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.2709281
	speed: 0.6088s/iter; left time: 5346.1290s
	iters: 200, epoch: 9 | loss: 0.2506176
	speed: 0.2997s/iter; left time: 2601.7983s
	iters: 300, epoch: 9 | loss: 0.2827808
	speed: 0.3002s/iter; left time: 2576.2289s
	iters: 400, epoch: 9 | loss: 0.2153797
	speed: 0.3015s/iter; left time: 2556.9287s
	iters: 500, epoch: 9 | loss: 0.2218291
	speed: 0.3011s/iter; left time: 2523.2351s
	iters: 600, epoch: 9 | loss: 0.2061540
	speed: 0.3009s/iter; left time: 2491.7605s
	iters: 700, epoch: 9 | loss: 0.2730837
	speed: 0.2998s/iter; left time: 2452.6169s
Epoch: 9 cost time: 222.3111493587494
Epoch: 9, Steps: 740 | Train Loss: 0.2363485 Vali Loss: 0.3487089 Test Loss: 0.4250430
Validation loss decreased (0.350108 --> 0.348709).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.2446069
	speed: 0.6092s/iter; left time: 4898.7432s
	iters: 200, epoch: 10 | loss: 0.2522430
	speed: 0.3008s/iter; left time: 2388.3110s
	iters: 300, epoch: 10 | loss: 0.1991123
	speed: 0.3018s/iter; left time: 2366.5811s
	iters: 400, epoch: 10 | loss: 0.2269713
	speed: 0.3015s/iter; left time: 2334.2819s
	iters: 500, epoch: 10 | loss: 0.2470357
	speed: 0.3011s/iter; left time: 2300.9955s
	iters: 600, epoch: 10 | loss: 0.2223582
	speed: 0.3014s/iter; left time: 2272.8149s
	iters: 700, epoch: 10 | loss: 0.2517507
	speed: 0.3014s/iter; left time: 2242.8287s
Epoch: 10 cost time: 222.91621208190918
Epoch: 10, Steps: 740 | Train Loss: 0.2352315 Vali Loss: 0.3479908 Test Loss: 0.4239044
Validation loss decreased (0.348709 --> 0.347991).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.2232602
	speed: 0.6081s/iter; left time: 4439.5645s
	iters: 200, epoch: 11 | loss: 0.2422913
	speed: 0.3007s/iter; left time: 2165.5497s
	iters: 300, epoch: 11 | loss: 0.2355193
	speed: 0.3006s/iter; left time: 2134.2446s
	iters: 400, epoch: 11 | loss: 0.2133632
	speed: 0.3007s/iter; left time: 2105.0898s
	iters: 500, epoch: 11 | loss: 0.2157614
	speed: 0.3004s/iter; left time: 2073.3278s
	iters: 600, epoch: 11 | loss: 0.1993226
	speed: 0.3022s/iter; left time: 2055.2271s
	iters: 700, epoch: 11 | loss: 0.2107264
	speed: 0.3028s/iter; left time: 2028.7893s
Epoch: 11 cost time: 223.08437323570251
Epoch: 11, Steps: 740 | Train Loss: 0.2346611 Vali Loss: 0.3472411 Test Loss: 0.4231369
Validation loss decreased (0.347991 --> 0.347241).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.1979907
	speed: 0.6120s/iter; left time: 4015.5482s
	iters: 200, epoch: 12 | loss: 0.2528140
	speed: 0.3008s/iter; left time: 1943.3383s
	iters: 300, epoch: 12 | loss: 0.2911939
	speed: 0.3004s/iter; left time: 1911.1051s
	iters: 400, epoch: 12 | loss: 0.2503142
	speed: 0.3002s/iter; left time: 1879.8548s
	iters: 500, epoch: 12 | loss: 0.2362984
	speed: 0.3020s/iter; left time: 1860.3503s
	iters: 600, epoch: 12 | loss: 0.2269562
	speed: 0.3013s/iter; left time: 1826.1610s
	iters: 700, epoch: 12 | loss: 0.2236345
	speed: 0.3017s/iter; left time: 1798.2359s
Epoch: 12 cost time: 222.78158617019653
Epoch: 12, Steps: 740 | Train Loss: 0.2343312 Vali Loss: 0.3469007 Test Loss: 0.4229903
Validation loss decreased (0.347241 --> 0.346901).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.2224590
	speed: 0.6109s/iter; left time: 3555.7599s
	iters: 200, epoch: 13 | loss: 0.2640109
	speed: 0.3010s/iter; left time: 1721.9551s
	iters: 300, epoch: 13 | loss: 0.2345416
	speed: 0.3005s/iter; left time: 1689.0670s
	iters: 400, epoch: 13 | loss: 0.2171830
	speed: 0.3008s/iter; left time: 1660.8050s
	iters: 500, epoch: 13 | loss: 0.2329784
	speed: 0.3014s/iter; left time: 1633.6198s
	iters: 600, epoch: 13 | loss: 0.1950649
	speed: 0.3019s/iter; left time: 1606.4575s
	iters: 700, epoch: 13 | loss: 0.2106375
	speed: 0.3017s/iter; left time: 1575.2004s
Epoch: 13 cost time: 223.01244354248047
Epoch: 13, Steps: 740 | Train Loss: 0.2341608 Vali Loss: 0.3467385 Test Loss: 0.4226584
Validation loss decreased (0.346901 --> 0.346738).  Saving model ...
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 14 | loss: 0.2183237
	speed: 0.6113s/iter; left time: 3105.9490s
	iters: 200, epoch: 14 | loss: 0.2272256
	speed: 0.3017s/iter; left time: 1502.7133s
	iters: 300, epoch: 14 | loss: 0.2721793
	speed: 0.3008s/iter; left time: 1468.2020s
	iters: 400, epoch: 14 | loss: 0.2833069
	speed: 0.3013s/iter; left time: 1440.6620s
	iters: 500, epoch: 14 | loss: 0.2406415
	speed: 0.3003s/iter; left time: 1405.8638s
	iters: 600, epoch: 14 | loss: 0.2650657
	speed: 0.3012s/iter; left time: 1379.8564s
	iters: 700, epoch: 14 | loss: 0.2388906
	speed: 0.3008s/iter; left time: 1347.8214s
Epoch: 14 cost time: 222.84165501594543
Epoch: 14, Steps: 740 | Train Loss: 0.2340575 Vali Loss: 0.3464075 Test Loss: 0.4226549
Validation loss decreased (0.346738 --> 0.346408).  Saving model ...
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 15 | loss: 0.2350534
	speed: 0.6079s/iter; left time: 2638.8730s
	iters: 200, epoch: 15 | loss: 0.2314714
	speed: 0.3007s/iter; left time: 1275.1294s
	iters: 300, epoch: 15 | loss: 0.2549726
	speed: 0.3010s/iter; left time: 1246.2831s
	iters: 400, epoch: 15 | loss: 0.2521095
	speed: 0.3012s/iter; left time: 1217.0678s
	iters: 500, epoch: 15 | loss: 0.2192797
	speed: 0.3011s/iter; left time: 1186.6219s
	iters: 600, epoch: 15 | loss: 0.2175506
	speed: 0.3016s/iter; left time: 1158.3904s
	iters: 700, epoch: 15 | loss: 0.2190948
	speed: 0.3007s/iter; left time: 1124.8507s
Epoch: 15 cost time: 222.71235847473145
Epoch: 15, Steps: 740 | Train Loss: 0.2339880 Vali Loss: 0.3466032 Test Loss: 0.4226585
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 16 | loss: 0.2172381
	speed: 0.6080s/iter; left time: 2189.4582s
	iters: 200, epoch: 16 | loss: 0.2372245
	speed: 0.3018s/iter; left time: 1056.5755s
	iters: 300, epoch: 16 | loss: 0.2463098
	speed: 0.3009s/iter; left time: 1023.4661s
	iters: 400, epoch: 16 | loss: 0.2496520
	speed: 0.3013s/iter; left time: 994.6683s
	iters: 500, epoch: 16 | loss: 0.2190520
	speed: 0.3019s/iter; left time: 966.3022s
	iters: 600, epoch: 16 | loss: 0.2397747
	speed: 0.3029s/iter; left time: 939.2844s
	iters: 700, epoch: 16 | loss: 0.2421481
	speed: 0.3015s/iter; left time: 904.8479s
Epoch: 16 cost time: 223.17607069015503
Epoch: 16, Steps: 740 | Train Loss: 0.2339092 Vali Loss: 0.3467431 Test Loss: 0.4226628
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 17 | loss: 0.2492894
	speed: 0.6089s/iter; left time: 1742.0298s
	iters: 200, epoch: 17 | loss: 0.2355970
	speed: 0.3008s/iter; left time: 830.5673s
	iters: 300, epoch: 17 | loss: 0.2123519
	speed: 0.3009s/iter; left time: 800.7955s
	iters: 400, epoch: 17 | loss: 0.2112952
	speed: 0.3011s/iter; left time: 771.1109s
	iters: 500, epoch: 17 | loss: 0.2122186
	speed: 0.3008s/iter; left time: 740.1589s
	iters: 600, epoch: 17 | loss: 0.1911301
	speed: 0.3012s/iter; left time: 711.1825s
	iters: 700, epoch: 17 | loss: 0.2117366
	speed: 0.3007s/iter; left time: 679.8753s
Epoch: 17 cost time: 222.7725157737732
Epoch: 17, Steps: 740 | Train Loss: 0.2339089 Vali Loss: 0.3462857 Test Loss: 0.4226602
Validation loss decreased (0.346408 --> 0.346286).  Saving model ...
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 18 | loss: 0.2812554
	speed: 0.6095s/iter; left time: 1292.7411s
	iters: 200, epoch: 18 | loss: 0.2179419
	speed: 0.3014s/iter; left time: 609.2058s
	iters: 300, epoch: 18 | loss: 0.2269102
	speed: 0.3016s/iter; left time: 579.3340s
	iters: 400, epoch: 18 | loss: 0.2130459
	speed: 0.3017s/iter; left time: 549.3497s
	iters: 500, epoch: 18 | loss: 0.2074054
	speed: 0.3022s/iter; left time: 520.1034s
	iters: 600, epoch: 18 | loss: 0.2215543
	speed: 0.3013s/iter; left time: 488.3564s
	iters: 700, epoch: 18 | loss: 0.2374705
	speed: 0.3013s/iter; left time: 458.2135s
Epoch: 18 cost time: 223.09617638587952
Epoch: 18, Steps: 740 | Train Loss: 0.2338879 Vali Loss: 0.3462575 Test Loss: 0.4226606
Validation loss decreased (0.346286 --> 0.346258).  Saving model ...
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 19 | loss: 0.2443545
	speed: 0.6087s/iter; left time: 840.6661s
	iters: 200, epoch: 19 | loss: 0.2098153
	speed: 0.3016s/iter; left time: 386.3055s
	iters: 300, epoch: 19 | loss: 0.2620709
	speed: 0.3013s/iter; left time: 355.7807s
	iters: 400, epoch: 19 | loss: 0.2285717
	speed: 0.3014s/iter; left time: 325.8550s
	iters: 500, epoch: 19 | loss: 0.2279872
	speed: 0.3013s/iter; left time: 295.6139s
	iters: 600, epoch: 19 | loss: 0.2234715
	speed: 0.3022s/iter; left time: 266.2453s
	iters: 700, epoch: 19 | loss: 0.2437531
	speed: 0.3016s/iter; left time: 235.5696s
Epoch: 19 cost time: 223.10735821723938
Epoch: 19, Steps: 740 | Train Loss: 0.2339227 Vali Loss: 0.3467823 Test Loss: 0.4226599
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 20 | loss: 0.2265652
	speed: 0.6096s/iter; left time: 390.7799s
	iters: 200, epoch: 20 | loss: 0.2387981
	speed: 0.3015s/iter; left time: 163.1203s
	iters: 300, epoch: 20 | loss: 0.1970579
	speed: 0.3012s/iter; left time: 132.8462s
	iters: 400, epoch: 20 | loss: 0.2310975
	speed: 0.3016s/iter; left time: 102.8321s
	iters: 500, epoch: 20 | loss: 0.2128460
	speed: 0.3021s/iter; left time: 72.8150s
	iters: 600, epoch: 20 | loss: 0.2332563
	speed: 0.3020s/iter; left time: 42.5793s
	iters: 700, epoch: 20 | loss: 0.2308407
	speed: 0.3011s/iter; left time: 12.3453s
Epoch: 20 cost time: 223.09197163581848
Epoch: 20, Steps: 740 | Train Loss: 0.2339111 Vali Loss: 0.3466980 Test Loss: 0.4226593
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.9073486328125e-08
>>>>>>>testing : traffic_336_96_NLinear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15726<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3413
mse:0.4229409992694855, mae:0.2940734028816223
