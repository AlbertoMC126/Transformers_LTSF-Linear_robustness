Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='Linear', model_id='Electricity_336_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=32598, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : Electricity_336_96_Linear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed32598>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17981
val 2537
test 5165
	iters: 100, epoch: 1 | loss: 0.2174122
	speed: 0.0952s/iter; left time: 2128.1736s
	iters: 200, epoch: 1 | loss: 0.1787570
	speed: 0.0792s/iter; left time: 1762.3515s
	iters: 300, epoch: 1 | loss: 0.1864483
	speed: 0.0802s/iter; left time: 1778.0683s
	iters: 400, epoch: 1 | loss: 0.1785448
	speed: 0.0784s/iter; left time: 1728.7078s
	iters: 500, epoch: 1 | loss: 0.2055074
	speed: 0.0792s/iter; left time: 1738.7536s
	iters: 600, epoch: 1 | loss: 0.1906729
	speed: 0.0801s/iter; left time: 1750.6334s
	iters: 700, epoch: 1 | loss: 0.2332391
	speed: 0.0797s/iter; left time: 1734.9797s
	iters: 800, epoch: 1 | loss: 0.1960357
	speed: 0.0825s/iter; left time: 1786.4983s
	iters: 900, epoch: 1 | loss: 0.2056263
	speed: 0.0807s/iter; left time: 1740.0696s
	iters: 1000, epoch: 1 | loss: 0.2132625
	speed: 0.0792s/iter; left time: 1699.1437s
	iters: 1100, epoch: 1 | loss: 0.1873560
	speed: 0.0805s/iter; left time: 1718.5102s
Epoch: 1 cost time: 91.3664345741272
Epoch: 1, Steps: 1123 | Train Loss: 0.2090673 Vali Loss: 0.1821282 Test Loss: 0.2088090
Validation loss decreased (inf --> 0.182128).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.2078385
	speed: 0.2091s/iter; left time: 4440.0052s
	iters: 200, epoch: 2 | loss: 0.2179606
	speed: 0.0787s/iter; left time: 1663.8758s
	iters: 300, epoch: 2 | loss: 0.2095318
	speed: 0.0782s/iter; left time: 1645.0952s
	iters: 400, epoch: 2 | loss: 0.1949703
	speed: 0.0795s/iter; left time: 1664.2137s
	iters: 500, epoch: 2 | loss: 0.2121761
	speed: 0.0789s/iter; left time: 1644.1443s
	iters: 600, epoch: 2 | loss: 0.2081411
	speed: 0.0797s/iter; left time: 1652.9903s
	iters: 700, epoch: 2 | loss: 0.1905574
	speed: 0.0784s/iter; left time: 1617.2054s
	iters: 800, epoch: 2 | loss: 0.1901228
	speed: 0.0791s/iter; left time: 1624.1452s
	iters: 900, epoch: 2 | loss: 0.2296640
	speed: 0.0788s/iter; left time: 1611.0743s
	iters: 1000, epoch: 2 | loss: 0.1901023
	speed: 0.0795s/iter; left time: 1615.9572s
	iters: 1100, epoch: 2 | loss: 0.2400233
	speed: 0.0792s/iter; left time: 1603.0638s
Epoch: 2 cost time: 88.7452404499054
Epoch: 2, Steps: 1123 | Train Loss: 0.2008768 Vali Loss: 0.1780918 Test Loss: 0.2073165
Validation loss decreased (0.182128 --> 0.178092).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.1781622
	speed: 0.2075s/iter; left time: 4172.8570s
	iters: 200, epoch: 3 | loss: 0.1434979
	speed: 0.0790s/iter; left time: 1580.7002s
	iters: 300, epoch: 3 | loss: 0.1476405
	speed: 0.0788s/iter; left time: 1569.5164s
	iters: 400, epoch: 3 | loss: 0.1909743
	speed: 0.0787s/iter; left time: 1560.2119s
	iters: 500, epoch: 3 | loss: 0.1438048
	speed: 0.0780s/iter; left time: 1537.7442s
	iters: 600, epoch: 3 | loss: 0.1400691
	speed: 0.0788s/iter; left time: 1545.2120s
	iters: 700, epoch: 3 | loss: 0.1741718
	speed: 0.0782s/iter; left time: 1526.1287s
	iters: 800, epoch: 3 | loss: 0.1464508
	speed: 0.0785s/iter; left time: 1523.4654s
	iters: 900, epoch: 3 | loss: 0.1555573
	speed: 0.0780s/iter; left time: 1507.3271s
	iters: 1000, epoch: 3 | loss: 0.1770781
	speed: 0.0784s/iter; left time: 1506.5511s
	iters: 1100, epoch: 3 | loss: 0.2128627
	speed: 0.0790s/iter; left time: 1510.9587s
Epoch: 3 cost time: 88.14066290855408
Epoch: 3, Steps: 1123 | Train Loss: 0.1571439 Vali Loss: 0.1428471 Test Loss: 0.1666923
Validation loss decreased (0.178092 --> 0.142847).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.1293787
	speed: 0.2158s/iter; left time: 4098.6356s
	iters: 200, epoch: 4 | loss: 0.1365975
	speed: 0.0784s/iter; left time: 1480.5528s
	iters: 300, epoch: 4 | loss: 0.1460336
	speed: 0.0779s/iter; left time: 1464.7253s
	iters: 400, epoch: 4 | loss: 0.1376637
	speed: 0.0772s/iter; left time: 1443.8838s
	iters: 500, epoch: 4 | loss: 0.1227014
	speed: 0.0778s/iter; left time: 1446.6154s
	iters: 600, epoch: 4 | loss: 0.1583629
	speed: 0.0793s/iter; left time: 1465.7665s
	iters: 700, epoch: 4 | loss: 0.1287810
	speed: 0.0803s/iter; left time: 1476.6273s
	iters: 800, epoch: 4 | loss: 0.1309141
	speed: 0.0782s/iter; left time: 1430.7718s
	iters: 900, epoch: 4 | loss: 0.1492896
	speed: 0.0794s/iter; left time: 1444.8402s
	iters: 1000, epoch: 4 | loss: 0.1307500
	speed: 0.0791s/iter; left time: 1431.4631s
	iters: 1100, epoch: 4 | loss: 0.1187219
	speed: 0.0804s/iter; left time: 1447.4321s
Epoch: 4 cost time: 88.64516091346741
Epoch: 4, Steps: 1123 | Train Loss: 0.1414524 Vali Loss: 0.1278352 Test Loss: 0.1490825
Validation loss decreased (0.142847 --> 0.127835).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.1355361
	speed: 0.2160s/iter; left time: 3858.9894s
	iters: 200, epoch: 5 | loss: 0.1268816
	speed: 0.0809s/iter; left time: 1437.2684s
	iters: 300, epoch: 5 | loss: 0.1247030
	speed: 0.0822s/iter; left time: 1453.0668s
	iters: 400, epoch: 5 | loss: 0.1272644
	speed: 0.0807s/iter; left time: 1417.4622s
	iters: 500, epoch: 5 | loss: 0.1489917
	speed: 0.0800s/iter; left time: 1396.7064s
	iters: 600, epoch: 5 | loss: 0.1477550
	speed: 0.0803s/iter; left time: 1394.8482s
	iters: 700, epoch: 5 | loss: 0.1215723
	speed: 0.0785s/iter; left time: 1355.8986s
	iters: 800, epoch: 5 | loss: 0.1164569
	speed: 0.0792s/iter; left time: 1359.6320s
	iters: 900, epoch: 5 | loss: 0.1101274
	speed: 0.0794s/iter; left time: 1354.5365s
	iters: 1000, epoch: 5 | loss: 0.1270473
	speed: 0.0807s/iter; left time: 1368.6696s
	iters: 1100, epoch: 5 | loss: 0.1704326
	speed: 0.0789s/iter; left time: 1331.3499s
Epoch: 5 cost time: 90.03579449653625
Epoch: 5, Steps: 1123 | Train Loss: 0.1337706 Vali Loss: 0.1203224 Test Loss: 0.1414037
Validation loss decreased (0.127835 --> 0.120322).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.1225396
	speed: 0.2063s/iter; left time: 3455.2457s
	iters: 200, epoch: 6 | loss: 0.1268496
	speed: 0.0791s/iter; left time: 1316.1691s
	iters: 300, epoch: 6 | loss: 0.1220217
	speed: 0.0794s/iter; left time: 1314.5591s
	iters: 400, epoch: 6 | loss: 0.1283532
	speed: 0.0792s/iter; left time: 1302.1599s
	iters: 500, epoch: 6 | loss: 0.1284004
	speed: 0.0804s/iter; left time: 1314.7011s
	iters: 600, epoch: 6 | loss: 0.1134611
	speed: 0.0785s/iter; left time: 1275.8440s
	iters: 700, epoch: 6 | loss: 0.1805918
	speed: 0.0792s/iter; left time: 1278.8389s
	iters: 800, epoch: 6 | loss: 0.1366731
	speed: 0.0794s/iter; left time: 1273.5843s
	iters: 900, epoch: 6 | loss: 0.1339000
	speed: 0.0796s/iter; left time: 1268.9055s
	iters: 1000, epoch: 6 | loss: 0.1452269
	speed: 0.0787s/iter; left time: 1246.5758s
	iters: 1100, epoch: 6 | loss: 0.1148908
	speed: 0.0791s/iter; left time: 1244.8475s
Epoch: 6 cost time: 88.87038040161133
Epoch: 6, Steps: 1123 | Train Loss: 0.1296347 Vali Loss: 0.1176074 Test Loss: 0.1377769
Validation loss decreased (0.120322 --> 0.117607).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.1094220
	speed: 0.2108s/iter; left time: 3293.4522s
	iters: 200, epoch: 7 | loss: 0.1164471
	speed: 0.0786s/iter; left time: 1219.8875s
	iters: 300, epoch: 7 | loss: 0.1043159
	speed: 0.0788s/iter; left time: 1215.0452s
	iters: 400, epoch: 7 | loss: 0.1218809
	speed: 0.0776s/iter; left time: 1189.5455s
	iters: 500, epoch: 7 | loss: 0.1044607
	speed: 0.0785s/iter; left time: 1195.1370s
	iters: 600, epoch: 7 | loss: 0.1259796
	speed: 0.0788s/iter; left time: 1192.2123s
	iters: 700, epoch: 7 | loss: 0.1192638
	speed: 0.0795s/iter; left time: 1194.7533s
	iters: 800, epoch: 7 | loss: 0.1568783
	speed: 0.0782s/iter; left time: 1167.4032s
	iters: 900, epoch: 7 | loss: 0.1189993
	speed: 0.0785s/iter; left time: 1163.5241s
	iters: 1000, epoch: 7 | loss: 0.1640552
	speed: 0.0789s/iter; left time: 1161.4608s
	iters: 1100, epoch: 7 | loss: 0.1348279
	speed: 0.0795s/iter; left time: 1162.9456s
Epoch: 7 cost time: 88.39180278778076
Epoch: 7, Steps: 1123 | Train Loss: 0.1273330 Vali Loss: 0.1156162 Test Loss: 0.1357107
Validation loss decreased (0.117607 --> 0.115616).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.1132777
	speed: 0.2111s/iter; left time: 3061.0615s
	iters: 200, epoch: 8 | loss: 0.1151454
	speed: 0.0788s/iter; left time: 1134.6411s
	iters: 300, epoch: 8 | loss: 0.1194182
	speed: 0.0782s/iter; left time: 1118.7209s
	iters: 400, epoch: 8 | loss: 0.1196885
	speed: 0.0794s/iter; left time: 1127.9789s
	iters: 500, epoch: 8 | loss: 0.0984934
	speed: 0.0794s/iter; left time: 1120.2281s
	iters: 600, epoch: 8 | loss: 0.1127374
	speed: 0.0785s/iter; left time: 1099.2798s
	iters: 700, epoch: 8 | loss: 0.1269259
	speed: 0.0780s/iter; left time: 1084.3158s
	iters: 800, epoch: 8 | loss: 0.1722182
	speed: 0.0808s/iter; left time: 1114.8303s
	iters: 900, epoch: 8 | loss: 0.1470209
	speed: 0.0803s/iter; left time: 1100.0501s
	iters: 1000, epoch: 8 | loss: 0.1209170
	speed: 0.0800s/iter; left time: 1087.5740s
	iters: 1100, epoch: 8 | loss: 0.1051028
	speed: 0.0806s/iter; left time: 1088.6225s
Epoch: 8 cost time: 89.20735168457031
Epoch: 8, Steps: 1123 | Train Loss: 0.1260334 Vali Loss: 0.1147903 Test Loss: 0.1347034
Validation loss decreased (0.115616 --> 0.114790).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.1066756
	speed: 0.2109s/iter; left time: 2820.5564s
	iters: 200, epoch: 9 | loss: 0.1406719
	speed: 0.0794s/iter; left time: 1054.0561s
	iters: 300, epoch: 9 | loss: 0.1324591
	speed: 0.0798s/iter; left time: 1052.0536s
	iters: 400, epoch: 9 | loss: 0.1086982
	speed: 0.0793s/iter; left time: 1037.2205s
	iters: 500, epoch: 9 | loss: 0.1477084
	speed: 0.0790s/iter; left time: 1025.1370s
	iters: 600, epoch: 9 | loss: 0.1334641
	speed: 0.0793s/iter; left time: 1021.1677s
	iters: 700, epoch: 9 | loss: 0.1467216
	speed: 0.0799s/iter; left time: 1020.6572s
	iters: 800, epoch: 9 | loss: 0.1065941
	speed: 0.0805s/iter; left time: 1020.3936s
	iters: 900, epoch: 9 | loss: 0.1441797
	speed: 0.0794s/iter; left time: 998.3368s
	iters: 1000, epoch: 9 | loss: 0.1305889
	speed: 0.0793s/iter; left time: 988.8970s
	iters: 1100, epoch: 9 | loss: 0.1293347
	speed: 0.0793s/iter; left time: 981.9213s
Epoch: 9 cost time: 89.22869205474854
Epoch: 9, Steps: 1123 | Train Loss: 0.1254167 Vali Loss: 0.1143034 Test Loss: 0.1342026
Validation loss decreased (0.114790 --> 0.114303).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.1072982
	speed: 0.2192s/iter; left time: 2685.5452s
	iters: 200, epoch: 10 | loss: 0.1556471
	speed: 0.0797s/iter; left time: 969.0974s
	iters: 300, epoch: 10 | loss: 0.0962308
	speed: 0.0794s/iter; left time: 957.5957s
	iters: 400, epoch: 10 | loss: 0.1555259
	speed: 0.0788s/iter; left time: 941.4289s
	iters: 500, epoch: 10 | loss: 0.1260042
	speed: 0.0800s/iter; left time: 948.9042s
	iters: 600, epoch: 10 | loss: 0.1142977
	speed: 0.0794s/iter; left time: 933.6633s
	iters: 700, epoch: 10 | loss: 0.1678372
	speed: 0.0802s/iter; left time: 934.5776s
	iters: 800, epoch: 10 | loss: 0.1402007
	speed: 0.0783s/iter; left time: 904.3944s
	iters: 900, epoch: 10 | loss: 0.1243480
	speed: 0.0778s/iter; left time: 890.8495s
	iters: 1000, epoch: 10 | loss: 0.1400875
	speed: 0.0782s/iter; left time: 887.6666s
	iters: 1100, epoch: 10 | loss: 0.1183777
	speed: 0.0783s/iter; left time: 881.2156s
Epoch: 10 cost time: 88.94055390357971
Epoch: 10, Steps: 1123 | Train Loss: 0.1250795 Vali Loss: 0.1140047 Test Loss: 0.1339722
Validation loss decreased (0.114303 --> 0.114005).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.1443336
	speed: 0.2139s/iter; left time: 2380.4577s
	iters: 200, epoch: 11 | loss: 0.1007688
	speed: 0.0784s/iter; left time: 864.5086s
	iters: 300, epoch: 11 | loss: 0.1154548
	speed: 0.0777s/iter; left time: 849.5911s
	iters: 400, epoch: 11 | loss: 0.1214189
	speed: 0.0783s/iter; left time: 847.8692s
	iters: 500, epoch: 11 | loss: 0.1083933
	speed: 0.0791s/iter; left time: 849.1372s
	iters: 600, epoch: 11 | loss: 0.1400742
	speed: 0.0794s/iter; left time: 844.2721s
	iters: 700, epoch: 11 | loss: 0.1229726
	speed: 0.0788s/iter; left time: 829.4095s
	iters: 800, epoch: 11 | loss: 0.1528337
	speed: 0.0795s/iter; left time: 829.6272s
	iters: 900, epoch: 11 | loss: 0.1539403
	speed: 0.0798s/iter; left time: 824.0518s
	iters: 1000, epoch: 11 | loss: 0.1071594
	speed: 0.0800s/iter; left time: 818.7075s
	iters: 1100, epoch: 11 | loss: 0.1723927
	speed: 0.0781s/iter; left time: 791.3653s
Epoch: 11 cost time: 88.62939453125
Epoch: 11, Steps: 1123 | Train Loss: 0.1248978 Vali Loss: 0.1139796 Test Loss: 0.1338376
Validation loss decreased (0.114005 --> 0.113980).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.1216778
	speed: 0.2075s/iter; left time: 2076.2137s
	iters: 200, epoch: 12 | loss: 0.1153558
	speed: 0.0793s/iter; left time: 785.4381s
	iters: 300, epoch: 12 | loss: 0.1110157
	speed: 0.0804s/iter; left time: 788.8500s
	iters: 400, epoch: 12 | loss: 0.1118065
	speed: 0.0812s/iter; left time: 788.1101s
	iters: 500, epoch: 12 | loss: 0.1463349
	speed: 0.0838s/iter; left time: 805.3884s
	iters: 600, epoch: 12 | loss: 0.1100325
	speed: 0.0787s/iter; left time: 748.7183s
	iters: 700, epoch: 12 | loss: 0.1207273
	speed: 0.0798s/iter; left time: 750.9645s
	iters: 800, epoch: 12 | loss: 0.1335450
	speed: 0.0793s/iter; left time: 738.5766s
	iters: 900, epoch: 12 | loss: 0.1546041
	speed: 0.0792s/iter; left time: 729.1331s
	iters: 1000, epoch: 12 | loss: 0.1234434
	speed: 0.0791s/iter; left time: 720.7255s
	iters: 1100, epoch: 12 | loss: 0.1217409
	speed: 0.0785s/iter; left time: 706.7538s
Epoch: 12 cost time: 89.5689046382904
Epoch: 12, Steps: 1123 | Train Loss: 0.1248023 Vali Loss: 0.1139398 Test Loss: 0.1337721
Validation loss decreased (0.113980 --> 0.113940).  Saving model ...
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.1353895
	speed: 0.2116s/iter; left time: 1879.8486s
	iters: 200, epoch: 13 | loss: 0.1286573
	speed: 0.0785s/iter; left time: 689.9042s
	iters: 300, epoch: 13 | loss: 0.1097498
	speed: 0.0786s/iter; left time: 682.8906s
	iters: 400, epoch: 13 | loss: 0.1070371
	speed: 0.0779s/iter; left time: 669.1120s
	iters: 500, epoch: 13 | loss: 0.1609852
	speed: 0.0784s/iter; left time: 665.2192s
	iters: 600, epoch: 13 | loss: 0.1159443
	speed: 0.0784s/iter; left time: 657.2238s
	iters: 700, epoch: 13 | loss: 0.1240354
	speed: 0.0795s/iter; left time: 658.4083s
	iters: 800, epoch: 13 | loss: 0.1306345
	speed: 0.0783s/iter; left time: 641.0494s
	iters: 900, epoch: 13 | loss: 0.1201328
	speed: 0.0781s/iter; left time: 631.4516s
	iters: 1000, epoch: 13 | loss: 0.1074265
	speed: 0.0781s/iter; left time: 623.3996s
	iters: 1100, epoch: 13 | loss: 0.1467785
	speed: 0.0784s/iter; left time: 617.8248s
Epoch: 13 cost time: 88.22318983078003
Epoch: 13, Steps: 1123 | Train Loss: 0.1247474 Vali Loss: 0.1139033 Test Loss: 0.1337689
Validation loss decreased (0.113940 --> 0.113903).  Saving model ...
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.1455965
	speed: 0.2108s/iter; left time: 1636.4204s
	iters: 200, epoch: 14 | loss: 0.1514757
	speed: 0.0790s/iter; left time: 605.2769s
	iters: 300, epoch: 14 | loss: 0.1337935
	speed: 0.0790s/iter; left time: 597.7536s
	iters: 400, epoch: 14 | loss: 0.1088466
	speed: 0.0796s/iter; left time: 594.2751s
	iters: 500, epoch: 14 | loss: 0.1688323
	speed: 0.0791s/iter; left time: 582.3944s
	iters: 600, epoch: 14 | loss: 0.1126646
	speed: 0.0789s/iter; left time: 572.8161s
	iters: 700, epoch: 14 | loss: 0.1132897
	speed: 0.0783s/iter; left time: 560.5245s
	iters: 800, epoch: 14 | loss: 0.1089426
	speed: 0.0791s/iter; left time: 558.4281s
	iters: 900, epoch: 14 | loss: 0.1655765
	speed: 0.0791s/iter; left time: 550.7770s
	iters: 1000, epoch: 14 | loss: 0.1325138
	speed: 0.0788s/iter; left time: 540.8570s
	iters: 1100, epoch: 14 | loss: 0.1347046
	speed: 0.0781s/iter; left time: 528.2920s
Epoch: 14 cost time: 88.63399767875671
Epoch: 14, Steps: 1123 | Train Loss: 0.1247174 Vali Loss: 0.1138620 Test Loss: 0.1337577
Validation loss decreased (0.113903 --> 0.113862).  Saving model ...
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.1215917
	speed: 0.2099s/iter; left time: 1393.2090s
	iters: 200, epoch: 15 | loss: 0.1112576
	speed: 0.0792s/iter; left time: 517.7538s
	iters: 300, epoch: 15 | loss: 0.1179966
	speed: 0.0797s/iter; left time: 513.3412s
	iters: 400, epoch: 15 | loss: 0.0937208
	speed: 0.0793s/iter; left time: 502.7429s
	iters: 500, epoch: 15 | loss: 0.1228907
	speed: 0.0793s/iter; left time: 495.0564s
	iters: 600, epoch: 15 | loss: 0.1231503
	speed: 0.0798s/iter; left time: 489.9816s
	iters: 700, epoch: 15 | loss: 0.1145233
	speed: 0.0797s/iter; left time: 481.5621s
	iters: 800, epoch: 15 | loss: 0.1232798
	speed: 0.0792s/iter; left time: 470.2154s
	iters: 900, epoch: 15 | loss: 0.1113742
	speed: 0.0792s/iter; left time: 462.7402s
	iters: 1000, epoch: 15 | loss: 0.1093137
	speed: 0.0815s/iter; left time: 467.7740s
	iters: 1100, epoch: 15 | loss: 0.1330790
	speed: 0.0807s/iter; left time: 455.2628s
Epoch: 15 cost time: 89.59233379364014
Epoch: 15, Steps: 1123 | Train Loss: 0.1247100 Vali Loss: 0.1139374 Test Loss: 0.1337532
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.1433979
	speed: 0.2045s/iter; left time: 1128.0428s
	iters: 200, epoch: 16 | loss: 0.1303658
	speed: 0.0790s/iter; left time: 427.7672s
	iters: 300, epoch: 16 | loss: 0.1259552
	speed: 0.0791s/iter; left time: 420.3366s
	iters: 400, epoch: 16 | loss: 0.1749156
	speed: 0.0789s/iter; left time: 411.7887s
	iters: 500, epoch: 16 | loss: 0.1495117
	speed: 0.0793s/iter; left time: 405.8381s
	iters: 600, epoch: 16 | loss: 0.1253244
	speed: 0.0792s/iter; left time: 397.3003s
	iters: 700, epoch: 16 | loss: 0.1221413
	speed: 0.0796s/iter; left time: 391.4183s
	iters: 800, epoch: 16 | loss: 0.1119763
	speed: 0.0782s/iter; left time: 376.7808s
	iters: 900, epoch: 16 | loss: 0.1310421
	speed: 0.0796s/iter; left time: 375.2359s
	iters: 1000, epoch: 16 | loss: 0.1284702
	speed: 0.0791s/iter; left time: 365.0344s
	iters: 1100, epoch: 16 | loss: 0.1174904
	speed: 0.0801s/iter; left time: 361.7297s
Epoch: 16 cost time: 89.05168986320496
Epoch: 16, Steps: 1123 | Train Loss: 0.1246837 Vali Loss: 0.1138575 Test Loss: 0.1337526
Validation loss decreased (0.113862 --> 0.113858).  Saving model ...
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 17 | loss: 0.1292202
	speed: 0.2189s/iter; left time: 961.7937s
	iters: 200, epoch: 17 | loss: 0.1432384
	speed: 0.0843s/iter; left time: 361.9407s
	iters: 300, epoch: 17 | loss: 0.1297998
	speed: 0.0803s/iter; left time: 336.4975s
	iters: 400, epoch: 17 | loss: 0.1064845
	speed: 0.0787s/iter; left time: 322.0624s
	iters: 500, epoch: 17 | loss: 0.1129043
	speed: 0.0783s/iter; left time: 312.7535s
	iters: 600, epoch: 17 | loss: 0.1084844
	speed: 0.0779s/iter; left time: 303.2793s
	iters: 700, epoch: 17 | loss: 0.1210764
	speed: 0.0775s/iter; left time: 294.0615s
	iters: 800, epoch: 17 | loss: 0.1117131
	speed: 0.0789s/iter; left time: 291.5411s
	iters: 900, epoch: 17 | loss: 0.1092147
	speed: 0.0786s/iter; left time: 282.3698s
	iters: 1000, epoch: 17 | loss: 0.1281878
	speed: 0.0787s/iter; left time: 274.9600s
	iters: 1100, epoch: 17 | loss: 0.0952820
	speed: 0.0781s/iter; left time: 265.1468s
Epoch: 17 cost time: 89.25321578979492
Epoch: 17, Steps: 1123 | Train Loss: 0.1246793 Vali Loss: 0.1138762 Test Loss: 0.1337523
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 18 | loss: 0.1442913
	speed: 0.1965s/iter; left time: 642.7117s
	iters: 200, epoch: 18 | loss: 0.1046633
	speed: 0.0792s/iter; left time: 251.0505s
	iters: 300, epoch: 18 | loss: 0.1178845
	speed: 0.0795s/iter; left time: 243.9878s
	iters: 400, epoch: 18 | loss: 0.1189473
	speed: 0.0780s/iter; left time: 231.6935s
	iters: 500, epoch: 18 | loss: 0.1172755
	speed: 0.0781s/iter; left time: 224.1757s
	iters: 600, epoch: 18 | loss: 0.1214332
	speed: 0.0783s/iter; left time: 216.9001s
	iters: 700, epoch: 18 | loss: 0.1301778
	speed: 0.0790s/iter; left time: 210.9347s
	iters: 800, epoch: 18 | loss: 0.1609314
	speed: 0.0787s/iter; left time: 202.3113s
	iters: 900, epoch: 18 | loss: 0.1086415
	speed: 0.0779s/iter; left time: 192.4151s
	iters: 1000, epoch: 18 | loss: 0.1506332
	speed: 0.0783s/iter; left time: 185.6272s
	iters: 1100, epoch: 18 | loss: 0.1162405
	speed: 0.0791s/iter; left time: 179.6085s
Epoch: 18 cost time: 88.25992059707642
Epoch: 18, Steps: 1123 | Train Loss: 0.1246443 Vali Loss: 0.1139006 Test Loss: 0.1337522
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 19 | loss: 0.1505382
	speed: 0.2018s/iter; left time: 433.2253s
	iters: 200, epoch: 19 | loss: 0.1233478
	speed: 0.0800s/iter; left time: 163.6631s
	iters: 300, epoch: 19 | loss: 0.1126099
	speed: 0.0805s/iter; left time: 156.8151s
	iters: 400, epoch: 19 | loss: 0.1466234
	speed: 0.0811s/iter; left time: 149.8316s
	iters: 500, epoch: 19 | loss: 0.1231943
	speed: 0.0813s/iter; left time: 142.0315s
	iters: 600, epoch: 19 | loss: 0.1277176
	speed: 0.0815s/iter; left time: 134.2771s
	iters: 700, epoch: 19 | loss: 0.1283611
	speed: 0.0813s/iter; left time: 125.7189s
	iters: 800, epoch: 19 | loss: 0.1140463
	speed: 0.0815s/iter; left time: 117.9115s
	iters: 900, epoch: 19 | loss: 0.1215732
	speed: 0.0796s/iter; left time: 107.2870s
	iters: 1000, epoch: 19 | loss: 0.1252598
	speed: 0.0804s/iter; left time: 100.2987s
	iters: 1100, epoch: 19 | loss: 0.1273101
	speed: 0.0812s/iter; left time: 93.0946s
Epoch: 19 cost time: 90.71123838424683
Epoch: 19, Steps: 1123 | Train Loss: 0.1246761 Vali Loss: 0.1138268 Test Loss: 0.1337522
Validation loss decreased (0.113858 --> 0.113827).  Saving model ...
Updating learning rate to 1.9073486328125e-08
	iters: 100, epoch: 20 | loss: 0.1233460
	speed: 0.2133s/iter; left time: 218.3965s
	iters: 200, epoch: 20 | loss: 0.1331420
	speed: 0.0799s/iter; left time: 73.8008s
	iters: 300, epoch: 20 | loss: 0.1182187
	speed: 0.0798s/iter; left time: 65.7350s
	iters: 400, epoch: 20 | loss: 0.1543098
	speed: 0.0805s/iter; left time: 58.3166s
	iters: 500, epoch: 20 | loss: 0.1558332
	speed: 0.0792s/iter; left time: 49.4162s
	iters: 600, epoch: 20 | loss: 0.1252791
	speed: 0.0798s/iter; left time: 41.8226s
	iters: 700, epoch: 20 | loss: 0.1319454
	speed: 0.0785s/iter; left time: 33.3040s
	iters: 800, epoch: 20 | loss: 0.1832027
	speed: 0.0798s/iter; left time: 25.8414s
	iters: 900, epoch: 20 | loss: 0.1138530
	speed: 0.0797s/iter; left time: 17.8539s
	iters: 1000, epoch: 20 | loss: 0.1234043
	speed: 0.0788s/iter; left time: 9.7757s
	iters: 1100, epoch: 20 | loss: 0.1199346
	speed: 0.0787s/iter; left time: 1.8894s
Epoch: 20 cost time: 89.2951807975769
Epoch: 20, Steps: 1123 | Train Loss: 0.1246860 Vali Loss: 0.1139053 Test Loss: 0.1337522
EarlyStopping counter: 1 out of 5
Updating learning rate to 9.5367431640625e-09
>>>>>>>testing : Electricity_336_96_Linear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed32598<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5165
mse:0.13373146951198578, mae:0.23042526841163635
