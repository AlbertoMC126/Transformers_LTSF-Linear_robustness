Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTh1', data_path='ETTh1.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='Linear', model_id='ETTh1_336_720', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=720, root_path='./dataset/', save_pred_values=False, seed=32598, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTh1_336_720_Linear_ETTh1_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed32598>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7585
val 2161
test 2161
	iters: 100, epoch: 1 | loss: 0.6338311
	speed: 0.0196s/iter; left time: 90.9474s
	iters: 200, epoch: 1 | loss: 0.5475958
	speed: 0.0191s/iter; left time: 86.9054s
Epoch: 1 cost time: 4.519113779067993
Epoch: 1, Steps: 237 | Train Loss: 0.6014828 Vali Loss: 1.5437214 Test Loss: 0.5515517
Validation loss decreased (inf --> 1.543721).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.6046187
	speed: 0.0330s/iter; left time: 145.2906s
	iters: 200, epoch: 2 | loss: 0.6931256
	speed: 0.0181s/iter; left time: 78.0041s
Epoch: 2 cost time: 4.315716028213501
Epoch: 2, Steps: 237 | Train Loss: 0.5702770 Vali Loss: 1.4454954 Test Loss: 0.5774708
Validation loss decreased (1.543721 --> 1.445495).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.4872563
	speed: 0.0316s/iter; left time: 131.5729s
	iters: 200, epoch: 3 | loss: 0.5109692
	speed: 0.0187s/iter; left time: 76.0199s
Epoch: 3 cost time: 4.288287162780762
Epoch: 3, Steps: 237 | Train Loss: 0.5236351 Vali Loss: 1.3044494 Test Loss: 0.5146481
Validation loss decreased (1.445495 --> 1.304449).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.5436198
	speed: 0.0305s/iter; left time: 119.9004s
	iters: 200, epoch: 4 | loss: 0.5165487
	speed: 0.0172s/iter; left time: 66.0004s
Epoch: 4 cost time: 3.98695707321167
Epoch: 4, Steps: 237 | Train Loss: 0.5011377 Vali Loss: 1.2669024 Test Loss: 0.4927871
Validation loss decreased (1.304449 --> 1.266902).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.4816990
	speed: 0.0293s/iter; left time: 108.3588s
	iters: 200, epoch: 5 | loss: 0.4390031
	speed: 0.0188s/iter; left time: 67.5745s
Epoch: 5 cost time: 4.271355152130127
Epoch: 5, Steps: 237 | Train Loss: 0.4896370 Vali Loss: 1.2716860 Test Loss: 0.5016670
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.4530129
	speed: 0.0316s/iter; left time: 109.2561s
	iters: 200, epoch: 6 | loss: 0.4588659
	speed: 0.0174s/iter; left time: 58.4276s
Epoch: 6 cost time: 4.0776941776275635
Epoch: 6, Steps: 237 | Train Loss: 0.4840713 Vali Loss: 1.2461622 Test Loss: 0.4896716
Validation loss decreased (1.266902 --> 1.246162).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.5312191
	speed: 0.0307s/iter; left time: 98.7524s
	iters: 200, epoch: 7 | loss: 0.4314450
	speed: 0.0189s/iter; left time: 59.0696s
Epoch: 7 cost time: 4.202740669250488
Epoch: 7, Steps: 237 | Train Loss: 0.4808901 Vali Loss: 1.2519224 Test Loss: 0.4847620
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.4715843
	speed: 0.0323s/iter; left time: 96.4021s
	iters: 200, epoch: 8 | loss: 0.5160855
	speed: 0.0180s/iter; left time: 51.8552s
Epoch: 8 cost time: 4.218570947647095
Epoch: 8, Steps: 237 | Train Loss: 0.4791953 Vali Loss: 1.2492831 Test Loss: 0.4874963
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.4597048
	speed: 0.0316s/iter; left time: 86.7549s
	iters: 200, epoch: 9 | loss: 0.4538656
	speed: 0.0194s/iter; left time: 51.3311s
Epoch: 9 cost time: 4.4280686378479
Epoch: 9, Steps: 237 | Train Loss: 0.4782930 Vali Loss: 1.2437030 Test Loss: 0.4874397
Validation loss decreased (1.246162 --> 1.243703).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.4707511
	speed: 0.0303s/iter; left time: 76.1071s
	iters: 200, epoch: 10 | loss: 0.5207681
	speed: 0.0157s/iter; left time: 37.7102s
Epoch: 10 cost time: 3.804070472717285
Epoch: 10, Steps: 237 | Train Loss: 0.4777607 Vali Loss: 1.2458925 Test Loss: 0.4891904
EarlyStopping counter: 1 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.4837682
	speed: 0.0344s/iter; left time: 78.1759s
	iters: 200, epoch: 11 | loss: 0.4580696
	speed: 0.0189s/iter; left time: 41.0754s
Epoch: 11 cost time: 4.331177711486816
Epoch: 11, Steps: 237 | Train Loss: 0.4775035 Vali Loss: 1.2456762 Test Loss: 0.4865843
EarlyStopping counter: 2 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.5355304
	speed: 0.0319s/iter; left time: 64.9550s
	iters: 200, epoch: 12 | loss: 0.5135934
	speed: 0.0167s/iter; left time: 32.2012s
Epoch: 12 cost time: 3.8501453399658203
Epoch: 12, Steps: 237 | Train Loss: 0.4773451 Vali Loss: 1.2428496 Test Loss: 0.4869168
Validation loss decreased (1.243703 --> 1.242850).  Saving model ...
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.4000410
	speed: 0.0279s/iter; left time: 50.2255s
	iters: 200, epoch: 13 | loss: 0.4584900
	speed: 0.0165s/iter; left time: 28.0153s
Epoch: 13 cost time: 3.814056396484375
Epoch: 13, Steps: 237 | Train Loss: 0.4772254 Vali Loss: 1.2434796 Test Loss: 0.4869657
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.5276462
	speed: 0.0262s/iter; left time: 40.8331s
	iters: 200, epoch: 14 | loss: 0.4741972
	speed: 0.0145s/iter; left time: 21.2094s
Epoch: 14 cost time: 3.4450881481170654
Epoch: 14, Steps: 237 | Train Loss: 0.4772187 Vali Loss: 1.2427056 Test Loss: 0.4872893
Validation loss decreased (1.242850 --> 1.242706).  Saving model ...
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.4499022
	speed: 0.0274s/iter; left time: 36.2770s
	iters: 200, epoch: 15 | loss: 0.5363623
	speed: 0.0141s/iter; left time: 17.2280s
Epoch: 15 cost time: 3.41595196723938
Epoch: 15, Steps: 237 | Train Loss: 0.4772234 Vali Loss: 1.2423635 Test Loss: 0.4873426
Validation loss decreased (1.242706 --> 1.242363).  Saving model ...
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.4776503
	speed: 0.0267s/iter; left time: 29.0409s
	iters: 200, epoch: 16 | loss: 0.5322472
	speed: 0.0145s/iter; left time: 14.3299s
Epoch: 16 cost time: 3.411017894744873
Epoch: 16, Steps: 237 | Train Loss: 0.4771781 Vali Loss: 1.2435118 Test Loss: 0.4873608
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 17 | loss: 0.4732259
	speed: 0.0268s/iter; left time: 22.7585s
	iters: 200, epoch: 17 | loss: 0.4572074
	speed: 0.0142s/iter; left time: 10.6656s
Epoch: 17 cost time: 3.378591775894165
Epoch: 17, Steps: 237 | Train Loss: 0.4771786 Vali Loss: 1.2429941 Test Loss: 0.4873721
EarlyStopping counter: 2 out of 5
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 18 | loss: 0.4574265
	speed: 0.0256s/iter; left time: 15.6839s
	iters: 200, epoch: 18 | loss: 0.4969827
	speed: 0.0133s/iter; left time: 6.8097s
Epoch: 18 cost time: 3.1543941497802734
Epoch: 18, Steps: 237 | Train Loss: 0.4771802 Vali Loss: 1.2427790 Test Loss: 0.4873646
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 19 | loss: 0.5147826
	speed: 0.0248s/iter; left time: 9.3032s
	iters: 200, epoch: 19 | loss: 0.4549703
	speed: 0.0131s/iter; left time: 3.6034s
Epoch: 19 cost time: 3.1259403228759766
Epoch: 19, Steps: 237 | Train Loss: 0.4771832 Vali Loss: 1.2434580 Test Loss: 0.4873676
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.9073486328125e-08
	iters: 100, epoch: 20 | loss: 0.5704188
	speed: 0.0233s/iter; left time: 3.2115s
	iters: 200, epoch: 20 | loss: 0.4746120
	speed: 0.0120s/iter; left time: 0.4546s
Epoch: 20 cost time: 2.8684823513031006
Epoch: 20, Steps: 237 | Train Loss: 0.4771691 Vali Loss: 1.2426746 Test Loss: 0.4873678
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTh1_336_720_Linear_ETTh1_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed32598<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
mse:0.4863952696323395, mae:0.48551931977272034
