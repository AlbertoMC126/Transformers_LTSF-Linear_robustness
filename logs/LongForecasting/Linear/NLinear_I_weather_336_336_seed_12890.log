Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='NLinear', model_id='weather_336_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=336, root_path='./dataset/', save_pred_values=False, seed=12890, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : weather_336_336_NLinear_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed12890>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36216
val 4935
test 10204
	iters: 100, epoch: 1 | loss: 0.6890939
	speed: 0.0245s/iter; left time: 1107.9020s
	iters: 200, epoch: 1 | loss: 0.9446757
	speed: 0.0246s/iter; left time: 1106.7555s
	iters: 300, epoch: 1 | loss: 0.5607670
	speed: 0.0219s/iter; left time: 983.6816s
	iters: 400, epoch: 1 | loss: 0.6392194
	speed: 0.0239s/iter; left time: 1070.8271s
	iters: 500, epoch: 1 | loss: 0.4278844
	speed: 0.0241s/iter; left time: 1079.6969s
	iters: 600, epoch: 1 | loss: 0.5291924
	speed: 0.0224s/iter; left time: 998.5927s
	iters: 700, epoch: 1 | loss: 0.4971920
	speed: 0.0200s/iter; left time: 890.0417s
	iters: 800, epoch: 1 | loss: 0.8071227
	speed: 0.0238s/iter; left time: 1059.5908s
	iters: 900, epoch: 1 | loss: 0.4533849
	speed: 0.0227s/iter; left time: 1007.9095s
	iters: 1000, epoch: 1 | loss: 0.5171716
	speed: 0.0209s/iter; left time: 926.7411s
	iters: 1100, epoch: 1 | loss: 0.6916938
	speed: 0.0246s/iter; left time: 1085.1982s
	iters: 1200, epoch: 1 | loss: 0.7186698
	speed: 0.0218s/iter; left time: 959.1750s
	iters: 1300, epoch: 1 | loss: 0.6611781
	speed: 0.0236s/iter; left time: 1037.0502s
	iters: 1400, epoch: 1 | loss: 0.7699920
	speed: 0.0238s/iter; left time: 1043.9131s
	iters: 1500, epoch: 1 | loss: 0.8195159
	speed: 0.0229s/iter; left time: 1002.4671s
	iters: 1600, epoch: 1 | loss: 1.2003899
	speed: 0.0224s/iter; left time: 979.2644s
	iters: 1700, epoch: 1 | loss: 1.0792592
	speed: 0.0225s/iter; left time: 979.5335s
	iters: 1800, epoch: 1 | loss: 0.6420805
	speed: 0.0247s/iter; left time: 1074.3118s
	iters: 1900, epoch: 1 | loss: 0.4887262
	speed: 0.0244s/iter; left time: 1059.5607s
	iters: 2000, epoch: 1 | loss: 1.0267762
	speed: 0.0238s/iter; left time: 1028.5138s
	iters: 2100, epoch: 1 | loss: 0.9303835
	speed: 0.0239s/iter; left time: 1030.6064s
	iters: 2200, epoch: 1 | loss: 0.5481860
	speed: 0.0248s/iter; left time: 1070.0446s
Epoch: 1 cost time: 52.45943832397461
Epoch: 1, Steps: 2263 | Train Loss: 2.3880130 Vali Loss: 0.6463087 Test Loss: 0.2880678
Validation loss decreased (inf --> 0.646309).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.5787198
	speed: 0.0746s/iter; left time: 3199.1048s
	iters: 200, epoch: 2 | loss: 0.5847416
	speed: 0.0222s/iter; left time: 952.1703s
	iters: 300, epoch: 2 | loss: 0.6002876
	speed: 0.0231s/iter; left time: 987.8789s
	iters: 400, epoch: 2 | loss: 0.9817780
	speed: 0.0221s/iter; left time: 941.6730s
	iters: 500, epoch: 2 | loss: 0.9997142
	speed: 0.0234s/iter; left time: 992.4365s
	iters: 600, epoch: 2 | loss: 0.6534210
	speed: 0.0219s/iter; left time: 928.0274s
	iters: 700, epoch: 2 | loss: 1.0140393
	speed: 0.0225s/iter; left time: 951.3532s
	iters: 800, epoch: 2 | loss: 2.0164120
	speed: 0.0229s/iter; left time: 965.1545s
	iters: 900, epoch: 2 | loss: 1.0932057
	speed: 0.0236s/iter; left time: 993.1042s
	iters: 1000, epoch: 2 | loss: 1.0377896
	speed: 0.0225s/iter; left time: 943.5979s
	iters: 1100, epoch: 2 | loss: 0.6645194
	speed: 0.0233s/iter; left time: 976.7399s
	iters: 1200, epoch: 2 | loss: 0.8221045
	speed: 0.0245s/iter; left time: 1025.6980s
	iters: 1300, epoch: 2 | loss: 0.7496654
	speed: 0.0231s/iter; left time: 962.0709s
	iters: 1400, epoch: 2 | loss: 0.4356447
	speed: 0.0221s/iter; left time: 919.2888s
	iters: 1500, epoch: 2 | loss: 0.3842789
	speed: 0.0247s/iter; left time: 1024.2992s
	iters: 1600, epoch: 2 | loss: 1.0613861
	speed: 0.0228s/iter; left time: 945.8320s
	iters: 1700, epoch: 2 | loss: 0.5879738
	speed: 0.0240s/iter; left time: 989.5172s
	iters: 1800, epoch: 2 | loss: 0.8612264
	speed: 0.0205s/iter; left time: 842.9029s
	iters: 1900, epoch: 2 | loss: 3.2737913
	speed: 0.0213s/iter; left time: 873.6951s
	iters: 2000, epoch: 2 | loss: 0.6794943
	speed: 0.0212s/iter; left time: 867.5559s
	iters: 2100, epoch: 2 | loss: 0.8986933
	speed: 0.0221s/iter; left time: 904.3443s
	iters: 2200, epoch: 2 | loss: 0.6865990
	speed: 0.0233s/iter; left time: 948.6316s
Epoch: 2 cost time: 51.11004090309143
Epoch: 2, Steps: 2263 | Train Loss: 4.4133585 Vali Loss: 0.7363672 Test Loss: 0.3640686
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 3.0178785
	speed: 0.0735s/iter; left time: 2987.0465s
	iters: 200, epoch: 3 | loss: 0.6399996
	speed: 0.0226s/iter; left time: 915.4837s
	iters: 300, epoch: 3 | loss: 2.3643143
	speed: 0.0244s/iter; left time: 985.3919s
	iters: 400, epoch: 3 | loss: 0.6603954
	speed: 0.0229s/iter; left time: 923.5766s
	iters: 500, epoch: 3 | loss: 0.7190074
	speed: 0.0237s/iter; left time: 951.5943s
	iters: 600, epoch: 3 | loss: 0.5881191
	speed: 0.0237s/iter; left time: 950.8128s
	iters: 700, epoch: 3 | loss: 3.2954733
	speed: 0.0246s/iter; left time: 986.5348s
	iters: 800, epoch: 3 | loss: 2.7553558
	speed: 0.0221s/iter; left time: 881.1278s
	iters: 900, epoch: 3 | loss: 0.5861317
	speed: 0.0209s/iter; left time: 832.4081s
	iters: 1000, epoch: 3 | loss: 0.5911651
	speed: 0.0232s/iter; left time: 921.8534s
	iters: 1100, epoch: 3 | loss: 0.6991565
	speed: 0.0234s/iter; left time: 925.5421s
	iters: 1200, epoch: 3 | loss: 0.6205948
	speed: 0.0229s/iter; left time: 905.6784s
	iters: 1300, epoch: 3 | loss: 0.6003117
	speed: 0.0211s/iter; left time: 832.2282s
	iters: 1400, epoch: 3 | loss: 0.6075830
	speed: 0.0213s/iter; left time: 836.2061s
	iters: 1500, epoch: 3 | loss: 1.1423318
	speed: 0.0236s/iter; left time: 925.7513s
	iters: 1600, epoch: 3 | loss: 0.5579210
	speed: 0.0225s/iter; left time: 879.9136s
	iters: 1700, epoch: 3 | loss: 0.4578380
	speed: 0.0247s/iter; left time: 965.0703s
	iters: 1800, epoch: 3 | loss: 0.5118126
	speed: 0.0236s/iter; left time: 918.8622s
	iters: 1900, epoch: 3 | loss: 0.4076972
	speed: 0.0225s/iter; left time: 875.3368s
	iters: 2000, epoch: 3 | loss: 0.6704483
	speed: 0.0211s/iter; left time: 816.3678s
	iters: 2100, epoch: 3 | loss: 0.4929338
	speed: 0.0223s/iter; left time: 859.7646s
	iters: 2200, epoch: 3 | loss: 0.9775454
	speed: 0.0207s/iter; left time: 798.8752s
Epoch: 3 cost time: 50.9360249042511
Epoch: 3, Steps: 2263 | Train Loss: 95.4981282 Vali Loss: 0.6170453 Test Loss: 0.2871872
Validation loss decreased (0.646309 --> 0.617045).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.5214899
	speed: 0.0730s/iter; left time: 2801.3712s
	iters: 200, epoch: 4 | loss: 0.5542058
	speed: 0.0212s/iter; left time: 811.7835s
	iters: 300, epoch: 4 | loss: 0.5232593
	speed: 0.0208s/iter; left time: 792.4280s
	iters: 400, epoch: 4 | loss: 0.5917663
	speed: 0.0243s/iter; left time: 923.7250s
	iters: 500, epoch: 4 | loss: 0.5277581
	speed: 0.0220s/iter; left time: 834.6393s
	iters: 600, epoch: 4 | loss: 0.3985380
	speed: 0.0223s/iter; left time: 843.4745s
	iters: 700, epoch: 4 | loss: 0.4696227
	speed: 0.0220s/iter; left time: 829.1738s
	iters: 800, epoch: 4 | loss: 0.4681421
	speed: 0.0231s/iter; left time: 870.6468s
	iters: 900, epoch: 4 | loss: 0.3984988
	speed: 0.0219s/iter; left time: 824.1208s
	iters: 1000, epoch: 4 | loss: 0.5035518
	speed: 0.0229s/iter; left time: 857.2981s
	iters: 1100, epoch: 4 | loss: 0.4493755
	speed: 0.0231s/iter; left time: 863.2507s
	iters: 1200, epoch: 4 | loss: 0.4899627
	speed: 0.0245s/iter; left time: 914.0784s
	iters: 1300, epoch: 4 | loss: 0.7512172
	speed: 0.0230s/iter; left time: 855.6693s
	iters: 1400, epoch: 4 | loss: 0.4485724
	speed: 0.0199s/iter; left time: 737.4130s
	iters: 1500, epoch: 4 | loss: 0.3336762
	speed: 0.0221s/iter; left time: 816.2414s
	iters: 1600, epoch: 4 | loss: 0.5679933
	speed: 0.0242s/iter; left time: 893.8122s
	iters: 1700, epoch: 4 | loss: 0.3762698
	speed: 0.0213s/iter; left time: 784.5822s
	iters: 1800, epoch: 4 | loss: 0.9094445
	speed: 0.0226s/iter; left time: 830.1880s
	iters: 1900, epoch: 4 | loss: 0.4330441
	speed: 0.0205s/iter; left time: 750.5124s
	iters: 2000, epoch: 4 | loss: 0.4006480
	speed: 0.0223s/iter; left time: 812.4642s
	iters: 2100, epoch: 4 | loss: 0.6305017
	speed: 0.0226s/iter; left time: 821.1403s
	iters: 2200, epoch: 4 | loss: 0.4652064
	speed: 0.0218s/iter; left time: 792.0126s
Epoch: 4 cost time: 50.19495129585266
Epoch: 4, Steps: 2263 | Train Loss: 16.2045555 Vali Loss: 0.5910327 Test Loss: 0.2631951
Validation loss decreased (0.617045 --> 0.591033).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 1.1328763
	speed: 0.0788s/iter; left time: 2845.5083s
	iters: 200, epoch: 5 | loss: 0.4041494
	speed: 0.0188s/iter; left time: 678.5775s
	iters: 300, epoch: 5 | loss: 0.4827738
	speed: 0.0214s/iter; left time: 768.8447s
	iters: 400, epoch: 5 | loss: 0.3951983
	speed: 0.0226s/iter; left time: 810.4992s
	iters: 500, epoch: 5 | loss: 0.3514450
	speed: 0.0237s/iter; left time: 845.6828s
	iters: 600, epoch: 5 | loss: 0.3944839
	speed: 0.0223s/iter; left time: 795.5794s
	iters: 700, epoch: 5 | loss: 0.4459003
	speed: 0.0228s/iter; left time: 809.3174s
	iters: 800, epoch: 5 | loss: 0.4647540
	speed: 0.0242s/iter; left time: 857.8731s
	iters: 900, epoch: 5 | loss: 0.6965829
	speed: 0.0233s/iter; left time: 823.9046s
	iters: 1000, epoch: 5 | loss: 0.4699990
	speed: 0.0231s/iter; left time: 812.1458s
	iters: 1100, epoch: 5 | loss: 0.3708713
	speed: 0.0195s/iter; left time: 685.8130s
	iters: 1200, epoch: 5 | loss: 0.3451893
	speed: 0.0218s/iter; left time: 762.6432s
	iters: 1300, epoch: 5 | loss: 0.5576887
	speed: 0.0245s/iter; left time: 854.6829s
	iters: 1400, epoch: 5 | loss: 0.5409201
	speed: 0.0232s/iter; left time: 808.1282s
	iters: 1500, epoch: 5 | loss: 1.0846963
	speed: 0.0239s/iter; left time: 828.4172s
	iters: 1600, epoch: 5 | loss: 0.5020230
	speed: 0.0204s/iter; left time: 705.6192s
	iters: 1700, epoch: 5 | loss: 0.6036707
	speed: 0.0204s/iter; left time: 704.2553s
	iters: 1800, epoch: 5 | loss: 0.4493322
	speed: 0.0228s/iter; left time: 784.9762s
	iters: 1900, epoch: 5 | loss: 0.6499690
	speed: 0.0230s/iter; left time: 789.0833s
	iters: 2000, epoch: 5 | loss: 0.4557169
	speed: 0.0202s/iter; left time: 692.3737s
	iters: 2100, epoch: 5 | loss: 0.3617524
	speed: 0.0222s/iter; left time: 757.8156s
	iters: 2200, epoch: 5 | loss: 0.5005112
	speed: 0.0227s/iter; left time: 773.4856s
Epoch: 5 cost time: 49.942840337753296
Epoch: 5, Steps: 2263 | Train Loss: 5.3410471 Vali Loss: 0.5510999 Test Loss: 0.2455875
Validation loss decreased (0.591033 --> 0.551100).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.3852310
	speed: 0.0809s/iter; left time: 2739.1760s
	iters: 200, epoch: 6 | loss: 1.0536730
	speed: 0.0185s/iter; left time: 624.9890s
	iters: 300, epoch: 6 | loss: 0.3780911
	speed: 0.0193s/iter; left time: 650.6727s
	iters: 400, epoch: 6 | loss: 0.3559999
	speed: 0.0215s/iter; left time: 722.0545s
	iters: 500, epoch: 6 | loss: 0.5046588
	speed: 0.0232s/iter; left time: 774.7282s
	iters: 600, epoch: 6 | loss: 0.5442437
	speed: 0.0213s/iter; left time: 708.9469s
	iters: 700, epoch: 6 | loss: 1.0695574
	speed: 0.0247s/iter; left time: 820.1967s
	iters: 800, epoch: 6 | loss: 0.6431016
	speed: 0.0213s/iter; left time: 707.2001s
	iters: 900, epoch: 6 | loss: 0.3625637
	speed: 0.0211s/iter; left time: 696.2254s
	iters: 1000, epoch: 6 | loss: 0.4131854
	speed: 0.0234s/iter; left time: 769.5540s
	iters: 1100, epoch: 6 | loss: 0.3929981
	speed: 0.0223s/iter; left time: 732.4985s
	iters: 1200, epoch: 6 | loss: 0.3621234
	speed: 0.0233s/iter; left time: 763.0883s
	iters: 1300, epoch: 6 | loss: 0.4888498
	speed: 0.0243s/iter; left time: 794.9116s
	iters: 1400, epoch: 6 | loss: 0.5713494
	speed: 0.0225s/iter; left time: 731.6933s
	iters: 1500, epoch: 6 | loss: 0.5293096
	speed: 0.0188s/iter; left time: 610.9587s
	iters: 1600, epoch: 6 | loss: 0.3516390
	speed: 0.0202s/iter; left time: 652.1054s
	iters: 1700, epoch: 6 | loss: 0.3747327
	speed: 0.0230s/iter; left time: 741.9335s
	iters: 1800, epoch: 6 | loss: 0.6316362
	speed: 0.0236s/iter; left time: 759.2021s
	iters: 1900, epoch: 6 | loss: 0.3181481
	speed: 0.0241s/iter; left time: 772.5037s
	iters: 2000, epoch: 6 | loss: 0.3923662
	speed: 0.0230s/iter; left time: 734.3481s
	iters: 2100, epoch: 6 | loss: 0.9700103
	speed: 0.0243s/iter; left time: 772.5982s
	iters: 2200, epoch: 6 | loss: 0.5629871
	speed: 0.0225s/iter; left time: 715.1407s
Epoch: 6 cost time: 49.8711416721344
Epoch: 6, Steps: 2263 | Train Loss: 2.2416849 Vali Loss: 0.5484359 Test Loss: 0.2421348
Validation loss decreased (0.551100 --> 0.548436).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.9516283
	speed: 0.0873s/iter; left time: 2757.7665s
	iters: 200, epoch: 7 | loss: 0.4387505
	speed: 0.0176s/iter; left time: 553.1017s
	iters: 300, epoch: 7 | loss: 0.4086823
	speed: 0.0214s/iter; left time: 672.5362s
	iters: 400, epoch: 7 | loss: 0.4450093
	speed: 0.0211s/iter; left time: 660.9354s
	iters: 500, epoch: 7 | loss: 0.9645935
	speed: 0.0234s/iter; left time: 728.4358s
	iters: 600, epoch: 7 | loss: 0.5581947
	speed: 0.0231s/iter; left time: 719.4554s
	iters: 700, epoch: 7 | loss: 0.4924914
	speed: 0.0201s/iter; left time: 621.7293s
	iters: 800, epoch: 7 | loss: 0.8945818
	speed: 0.0228s/iter; left time: 705.4010s
	iters: 900, epoch: 7 | loss: 0.4715078
	speed: 0.0239s/iter; left time: 735.8908s
	iters: 1000, epoch: 7 | loss: 0.3658718
	speed: 0.0221s/iter; left time: 679.6248s
	iters: 1100, epoch: 7 | loss: 0.3897647
	speed: 0.0192s/iter; left time: 588.2058s
	iters: 1200, epoch: 7 | loss: 0.3871747
	speed: 0.0221s/iter; left time: 673.5260s
	iters: 1300, epoch: 7 | loss: 0.3749087
	speed: 0.0242s/iter; left time: 736.4515s
	iters: 1400, epoch: 7 | loss: 0.4467182
	speed: 0.0229s/iter; left time: 692.5353s
	iters: 1500, epoch: 7 | loss: 0.5864079
	speed: 0.0211s/iter; left time: 638.3261s
	iters: 1600, epoch: 7 | loss: 0.8930606
	speed: 0.0207s/iter; left time: 623.3067s
	iters: 1700, epoch: 7 | loss: 0.3404747
	speed: 0.0224s/iter; left time: 672.6697s
	iters: 1800, epoch: 7 | loss: 0.3493589
	speed: 0.0240s/iter; left time: 716.2068s
	iters: 1900, epoch: 7 | loss: 1.0122989
	speed: 0.0230s/iter; left time: 685.3562s
	iters: 2000, epoch: 7 | loss: 0.4073800
	speed: 0.0224s/iter; left time: 664.9774s
	iters: 2100, epoch: 7 | loss: 0.6226611
	speed: 0.0245s/iter; left time: 724.9304s
	iters: 2200, epoch: 7 | loss: 0.4440427
	speed: 0.0227s/iter; left time: 670.0971s
Epoch: 7 cost time: 49.765158891677856
Epoch: 7, Steps: 2263 | Train Loss: 1.0076608 Vali Loss: 0.5405192 Test Loss: 0.2404651
Validation loss decreased (0.548436 --> 0.540519).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.5627031
	speed: 0.0865s/iter; left time: 2537.0197s
	iters: 200, epoch: 8 | loss: 0.4574749
	speed: 0.0182s/iter; left time: 531.0152s
	iters: 300, epoch: 8 | loss: 0.5332319
	speed: 0.0197s/iter; left time: 572.8864s
	iters: 400, epoch: 8 | loss: 0.4308573
	speed: 0.0201s/iter; left time: 584.5061s
	iters: 500, epoch: 8 | loss: 0.5357377
	speed: 0.0219s/iter; left time: 634.4947s
	iters: 600, epoch: 8 | loss: 0.6978288
	speed: 0.0233s/iter; left time: 671.0286s
	iters: 700, epoch: 8 | loss: 0.9195712
	speed: 0.0227s/iter; left time: 652.2772s
	iters: 800, epoch: 8 | loss: 0.6843361
	speed: 0.0230s/iter; left time: 658.4852s
	iters: 900, epoch: 8 | loss: 0.5768249
	speed: 0.0245s/iter; left time: 697.5704s
	iters: 1000, epoch: 8 | loss: 0.9147317
	speed: 0.0245s/iter; left time: 696.7920s
	iters: 1100, epoch: 8 | loss: 0.9778403
	speed: 0.0225s/iter; left time: 637.9662s
	iters: 1200, epoch: 8 | loss: 0.5912762
	speed: 0.0204s/iter; left time: 575.3931s
	iters: 1300, epoch: 8 | loss: 0.4674896
	speed: 0.0212s/iter; left time: 595.8260s
	iters: 1400, epoch: 8 | loss: 0.5670013
	speed: 0.0222s/iter; left time: 621.6958s
	iters: 1500, epoch: 8 | loss: 0.3303953
	speed: 0.0224s/iter; left time: 624.3268s
	iters: 1600, epoch: 8 | loss: 0.4430568
	speed: 0.0228s/iter; left time: 634.4574s
	iters: 1700, epoch: 8 | loss: 0.5457704
	speed: 0.0235s/iter; left time: 652.2320s
	iters: 1800, epoch: 8 | loss: 0.7224699
	speed: 0.0229s/iter; left time: 631.6126s
	iters: 1900, epoch: 8 | loss: 0.5062726
	speed: 0.0197s/iter; left time: 541.8790s
	iters: 2000, epoch: 8 | loss: 0.3785463
	speed: 0.0232s/iter; left time: 635.8078s
	iters: 2100, epoch: 8 | loss: 0.5604313
	speed: 0.0239s/iter; left time: 654.2429s
	iters: 2200, epoch: 8 | loss: 0.5495601
	speed: 0.0229s/iter; left time: 624.3756s
Epoch: 8 cost time: 49.7573938369751
Epoch: 8, Steps: 2263 | Train Loss: 0.6857468 Vali Loss: 0.5343735 Test Loss: 0.2380808
Validation loss decreased (0.540519 --> 0.534374).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.3903862
	speed: 0.0875s/iter; left time: 2366.8550s
	iters: 200, epoch: 9 | loss: 0.9303856
	speed: 0.0175s/iter; left time: 470.7821s
	iters: 300, epoch: 9 | loss: 0.4345696
	speed: 0.0211s/iter; left time: 567.6427s
	iters: 400, epoch: 9 | loss: 0.4471494
	speed: 0.0211s/iter; left time: 565.2580s
	iters: 500, epoch: 9 | loss: 0.4499052
	speed: 0.0226s/iter; left time: 601.9105s
	iters: 600, epoch: 9 | loss: 0.4668419
	speed: 0.0204s/iter; left time: 542.2767s
	iters: 700, epoch: 9 | loss: 0.3845745
	speed: 0.0202s/iter; left time: 534.4380s
	iters: 800, epoch: 9 | loss: 0.4591580
	speed: 0.0223s/iter; left time: 587.6669s
	iters: 900, epoch: 9 | loss: 0.9211790
	speed: 0.0248s/iter; left time: 651.9291s
	iters: 1000, epoch: 9 | loss: 0.4006718
	speed: 0.0248s/iter; left time: 648.0008s
	iters: 1100, epoch: 9 | loss: 0.4463910
	speed: 0.0205s/iter; left time: 535.3129s
	iters: 1200, epoch: 9 | loss: 0.4513416
	speed: 0.0246s/iter; left time: 637.7698s
	iters: 1300, epoch: 9 | loss: 0.5552993
	speed: 0.0253s/iter; left time: 653.2079s
	iters: 1400, epoch: 9 | loss: 0.3582305
	speed: 0.0223s/iter; left time: 573.5254s
	iters: 1500, epoch: 9 | loss: 1.1024543
	speed: 0.0222s/iter; left time: 569.5018s
	iters: 1600, epoch: 9 | loss: 0.4715309
	speed: 0.0238s/iter; left time: 608.3404s
	iters: 1700, epoch: 9 | loss: 0.9651763
	speed: 0.0225s/iter; left time: 574.0061s
	iters: 1800, epoch: 9 | loss: 0.3927986
	speed: 0.0222s/iter; left time: 562.3701s
	iters: 1900, epoch: 9 | loss: 0.5327381
	speed: 0.0235s/iter; left time: 593.8170s
	iters: 2000, epoch: 9 | loss: 0.6392074
	speed: 0.0246s/iter; left time: 618.6421s
	iters: 2100, epoch: 9 | loss: 0.4083175
	speed: 0.0198s/iter; left time: 495.5325s
	iters: 2200, epoch: 9 | loss: 0.4178829
	speed: 0.0215s/iter; left time: 537.4927s
Epoch: 9 cost time: 50.15872812271118
Epoch: 9, Steps: 2263 | Train Loss: 0.6002717 Vali Loss: 0.5340748 Test Loss: 0.2384723
Validation loss decreased (0.534374 --> 0.534075).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.5736725
	speed: 0.0866s/iter; left time: 2146.4107s
	iters: 200, epoch: 10 | loss: 0.5117851
	speed: 0.0172s/iter; left time: 424.4014s
	iters: 300, epoch: 10 | loss: 0.3625460
	speed: 0.0190s/iter; left time: 466.1583s
	iters: 400, epoch: 10 | loss: 1.0415837
	speed: 0.0230s/iter; left time: 564.3007s
	iters: 500, epoch: 10 | loss: 0.4521056
	speed: 0.0228s/iter; left time: 555.9219s
	iters: 600, epoch: 10 | loss: 0.5946892
	speed: 0.0216s/iter; left time: 525.3598s
	iters: 700, epoch: 10 | loss: 0.9527191
	speed: 0.0226s/iter; left time: 547.6142s
	iters: 800, epoch: 10 | loss: 1.0914724
	speed: 0.0237s/iter; left time: 570.9704s
	iters: 900, epoch: 10 | loss: 0.5168705
	speed: 0.0226s/iter; left time: 541.1918s
	iters: 1000, epoch: 10 | loss: 0.3528289
	speed: 0.0228s/iter; left time: 545.7610s
	iters: 1100, epoch: 10 | loss: 0.4301254
	speed: 0.0242s/iter; left time: 575.7680s
	iters: 1200, epoch: 10 | loss: 0.4644901
	speed: 0.0239s/iter; left time: 566.9849s
	iters: 1300, epoch: 10 | loss: 0.4885014
	speed: 0.0232s/iter; left time: 546.7981s
	iters: 1400, epoch: 10 | loss: 0.6017382
	speed: 0.0221s/iter; left time: 520.0413s
	iters: 1500, epoch: 10 | loss: 0.3490252
	speed: 0.0230s/iter; left time: 538.1037s
	iters: 1600, epoch: 10 | loss: 0.9126917
	speed: 0.0192s/iter; left time: 446.4984s
	iters: 1700, epoch: 10 | loss: 0.4171913
	speed: 0.0230s/iter; left time: 532.7807s
	iters: 1800, epoch: 10 | loss: 1.0283681
	speed: 0.0222s/iter; left time: 513.7301s
	iters: 1900, epoch: 10 | loss: 0.5060087
	speed: 0.0210s/iter; left time: 483.5472s
	iters: 2000, epoch: 10 | loss: 0.4059683
	speed: 0.0226s/iter; left time: 517.0852s
	iters: 2100, epoch: 10 | loss: 0.4971054
	speed: 0.0236s/iter; left time: 537.5129s
	iters: 2200, epoch: 10 | loss: 0.7105436
	speed: 0.0229s/iter; left time: 519.8642s
Epoch: 10 cost time: 49.79442620277405
Epoch: 10, Steps: 2263 | Train Loss: 0.5774059 Vali Loss: 0.5355076 Test Loss: 0.2397579
EarlyStopping counter: 1 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.9972998
	speed: 0.0839s/iter; left time: 1890.3258s
	iters: 200, epoch: 11 | loss: 0.5008063
	speed: 0.0182s/iter; left time: 408.4000s
	iters: 300, epoch: 11 | loss: 0.6800168
	speed: 0.0187s/iter; left time: 416.9447s
	iters: 400, epoch: 11 | loss: 0.4549884
	speed: 0.0212s/iter; left time: 470.4277s
	iters: 500, epoch: 11 | loss: 0.3184477
	speed: 0.0207s/iter; left time: 458.7584s
	iters: 600, epoch: 11 | loss: 0.4507762
	speed: 0.0195s/iter; left time: 429.6194s
	iters: 700, epoch: 11 | loss: 0.4787241
	speed: 0.0238s/iter; left time: 522.8896s
	iters: 800, epoch: 11 | loss: 0.4921436
	speed: 0.0213s/iter; left time: 464.9944s
	iters: 900, epoch: 11 | loss: 0.4282864
	speed: 0.0228s/iter; left time: 495.6625s
	iters: 1000, epoch: 11 | loss: 0.4041522
	speed: 0.0229s/iter; left time: 494.8755s
	iters: 1100, epoch: 11 | loss: 0.4296761
	speed: 0.0193s/iter; left time: 416.2386s
	iters: 1200, epoch: 11 | loss: 0.4270069
	speed: 0.0234s/iter; left time: 502.0486s
	iters: 1300, epoch: 11 | loss: 0.4189530
	speed: 0.0216s/iter; left time: 460.3341s
	iters: 1400, epoch: 11 | loss: 0.4199803
	speed: 0.0240s/iter; left time: 508.5457s
	iters: 1500, epoch: 11 | loss: 0.9604911
	speed: 0.0230s/iter; left time: 485.0749s
	iters: 1600, epoch: 11 | loss: 0.5035327
	speed: 0.0211s/iter; left time: 444.1326s
	iters: 1700, epoch: 11 | loss: 0.3502616
	speed: 0.0246s/iter; left time: 513.8899s
	iters: 1800, epoch: 11 | loss: 0.4142792
	speed: 0.0222s/iter; left time: 461.7114s
	iters: 1900, epoch: 11 | loss: 0.4097911
	speed: 0.0242s/iter; left time: 502.1076s
	iters: 2000, epoch: 11 | loss: 1.1866951
	speed: 0.0223s/iter; left time: 460.2491s
	iters: 2100, epoch: 11 | loss: 0.4393515
	speed: 0.0218s/iter; left time: 447.3494s
	iters: 2200, epoch: 11 | loss: 0.3942037
	speed: 0.0236s/iter; left time: 482.0864s
Epoch: 11 cost time: 49.25152635574341
Epoch: 11, Steps: 2263 | Train Loss: 0.5641885 Vali Loss: 0.5348762 Test Loss: 0.2394127
EarlyStopping counter: 2 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.9735978
	speed: 0.0944s/iter; left time: 1913.1998s
	iters: 200, epoch: 12 | loss: 0.4092882
	speed: 0.0177s/iter; left time: 357.3215s
	iters: 300, epoch: 12 | loss: 0.5775567
	speed: 0.0190s/iter; left time: 381.7811s
	iters: 400, epoch: 12 | loss: 0.4892159
	speed: 0.0227s/iter; left time: 453.5605s
	iters: 500, epoch: 12 | loss: 0.3691460
	speed: 0.0226s/iter; left time: 449.7370s
	iters: 600, epoch: 12 | loss: 0.4232689
	speed: 0.0193s/iter; left time: 381.8507s
	iters: 700, epoch: 12 | loss: 0.4016850
	speed: 0.0231s/iter; left time: 453.7273s
	iters: 800, epoch: 12 | loss: 0.4451860
	speed: 0.0241s/iter; left time: 472.0041s
	iters: 900, epoch: 12 | loss: 0.3707873
	speed: 0.0242s/iter; left time: 470.2089s
	iters: 1000, epoch: 12 | loss: 0.5036476
	speed: 0.0231s/iter; left time: 446.8135s
	iters: 1100, epoch: 12 | loss: 0.3010069
	speed: 0.0228s/iter; left time: 439.5252s
	iters: 1200, epoch: 12 | loss: 0.3463247
	speed: 0.0235s/iter; left time: 450.4554s
	iters: 1300, epoch: 12 | loss: 0.5401013
	speed: 0.0226s/iter; left time: 430.0347s
	iters: 1400, epoch: 12 | loss: 0.4207583
	speed: 0.0230s/iter; left time: 435.3727s
	iters: 1500, epoch: 12 | loss: 0.4690470
	speed: 0.0234s/iter; left time: 441.8744s
	iters: 1600, epoch: 12 | loss: 0.4114257
	speed: 0.0216s/iter; left time: 404.6033s
	iters: 1700, epoch: 12 | loss: 0.9260572
	speed: 0.0232s/iter; left time: 432.8498s
	iters: 1800, epoch: 12 | loss: 0.4339265
	speed: 0.0222s/iter; left time: 412.3155s
	iters: 1900, epoch: 12 | loss: 0.4852837
	speed: 0.0208s/iter; left time: 384.8116s
	iters: 2000, epoch: 12 | loss: 0.3224480
	speed: 0.0202s/iter; left time: 370.6247s
	iters: 2100, epoch: 12 | loss: 0.4969002
	speed: 0.0232s/iter; left time: 424.3355s
	iters: 2200, epoch: 12 | loss: 0.5932050
	speed: 0.0234s/iter; left time: 424.7738s
Epoch: 12 cost time: 50.08844304084778
Epoch: 12, Steps: 2263 | Train Loss: 0.5600582 Vali Loss: 0.5352727 Test Loss: 0.2395628
EarlyStopping counter: 3 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.4814415
	speed: 0.0881s/iter; left time: 1586.6141s
	iters: 200, epoch: 13 | loss: 0.3658952
	speed: 0.0190s/iter; left time: 339.3835s
	iters: 300, epoch: 13 | loss: 0.5667270
	speed: 0.0177s/iter; left time: 314.8252s
	iters: 400, epoch: 13 | loss: 0.5947635
	speed: 0.0194s/iter; left time: 342.8474s
	iters: 500, epoch: 13 | loss: 0.4815265
	speed: 0.0224s/iter; left time: 393.7466s
	iters: 600, epoch: 13 | loss: 0.3978110
	speed: 0.0222s/iter; left time: 387.9139s
	iters: 700, epoch: 13 | loss: 0.5021834
	speed: 0.0234s/iter; left time: 407.0225s
	iters: 800, epoch: 13 | loss: 0.4708861
	speed: 0.0231s/iter; left time: 399.1790s
	iters: 900, epoch: 13 | loss: 1.0654783
	speed: 0.0240s/iter; left time: 413.3360s
	iters: 1000, epoch: 13 | loss: 0.5009505
	speed: 0.0190s/iter; left time: 325.5418s
	iters: 1100, epoch: 13 | loss: 0.4139485
	speed: 0.0200s/iter; left time: 340.0638s
	iters: 1200, epoch: 13 | loss: 0.4463855
	speed: 0.0211s/iter; left time: 356.1680s
	iters: 1300, epoch: 13 | loss: 0.4613780
	speed: 0.0241s/iter; left time: 404.7460s
	iters: 1400, epoch: 13 | loss: 0.4027967
	speed: 0.0253s/iter; left time: 423.3282s
	iters: 1500, epoch: 13 | loss: 0.4975852
	speed: 0.0215s/iter; left time: 356.6277s
	iters: 1600, epoch: 13 | loss: 0.3886157
	speed: 0.0242s/iter; left time: 399.7363s
	iters: 1700, epoch: 13 | loss: 0.4452983
	speed: 0.0235s/iter; left time: 385.7487s
	iters: 1800, epoch: 13 | loss: 0.4745142
	speed: 0.0226s/iter; left time: 369.0543s
	iters: 1900, epoch: 13 | loss: 0.4280456
	speed: 0.0253s/iter; left time: 410.3547s
	iters: 2000, epoch: 13 | loss: 0.3908618
	speed: 0.0250s/iter; left time: 402.5426s
	iters: 2100, epoch: 13 | loss: 0.4163636
	speed: 0.0235s/iter; left time: 376.4682s
	iters: 2200, epoch: 13 | loss: 0.4729141
	speed: 0.0241s/iter; left time: 383.0075s
Epoch: 13 cost time: 50.53672385215759
Epoch: 13, Steps: 2263 | Train Loss: 0.5576638 Vali Loss: 0.5354239 Test Loss: 0.2394726
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.3809779
	speed: 0.0813s/iter; left time: 1279.4115s
	iters: 200, epoch: 14 | loss: 0.5698176
	speed: 0.0194s/iter; left time: 302.8020s
	iters: 300, epoch: 14 | loss: 0.3962720
	speed: 0.0192s/iter; left time: 298.7848s
	iters: 400, epoch: 14 | loss: 0.3371094
	speed: 0.0204s/iter; left time: 314.5369s
	iters: 500, epoch: 14 | loss: 0.4494877
	speed: 0.0231s/iter; left time: 355.0997s
	iters: 600, epoch: 14 | loss: 0.3846029
	speed: 0.0222s/iter; left time: 338.3475s
	iters: 700, epoch: 14 | loss: 0.2887852
	speed: 0.0205s/iter; left time: 310.7381s
	iters: 800, epoch: 14 | loss: 0.4499533
	speed: 0.0231s/iter; left time: 347.9722s
	iters: 900, epoch: 14 | loss: 0.4495371
	speed: 0.0223s/iter; left time: 332.6334s
	iters: 1000, epoch: 14 | loss: 0.4432109
	speed: 0.0214s/iter; left time: 317.3464s
	iters: 1100, epoch: 14 | loss: 0.5008333
	speed: 0.0235s/iter; left time: 346.0734s
	iters: 1200, epoch: 14 | loss: 0.3658190
	speed: 0.0238s/iter; left time: 348.4657s
	iters: 1300, epoch: 14 | loss: 0.8391016
	speed: 0.0249s/iter; left time: 362.7637s
	iters: 1400, epoch: 14 | loss: 0.3600299
	speed: 0.0230s/iter; left time: 332.6831s
	iters: 1500, epoch: 14 | loss: 0.9132802
	speed: 0.0228s/iter; left time: 326.8842s
	iters: 1600, epoch: 14 | loss: 0.5577348
	speed: 0.0235s/iter; left time: 334.7619s
	iters: 1700, epoch: 14 | loss: 0.4029548
	speed: 0.0229s/iter; left time: 323.2869s
	iters: 1800, epoch: 14 | loss: 0.3323328
	speed: 0.0241s/iter; left time: 338.4597s
	iters: 1900, epoch: 14 | loss: 0.4420207
	speed: 0.0240s/iter; left time: 334.4253s
	iters: 2000, epoch: 14 | loss: 0.5095001
	speed: 0.0231s/iter; left time: 320.0650s
	iters: 2100, epoch: 14 | loss: 0.8733573
	speed: 0.0244s/iter; left time: 334.9318s
	iters: 2200, epoch: 14 | loss: 0.4359150
	speed: 0.0228s/iter; left time: 310.7080s
Epoch: 14 cost time: 51.11133527755737
Epoch: 14, Steps: 2263 | Train Loss: 0.5563541 Vali Loss: 0.5349617 Test Loss: 0.2394581
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : weather_336_336_NLinear_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed12890<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10204
mse:0.23852907121181488, mae:0.27701836824417114
