Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='Linear', model_id='weather_336_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=15349, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : weather_336_96_Linear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15349>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36456
val 5175
test 10444
	iters: 100, epoch: 1 | loss: 0.4279360
	speed: 0.0109s/iter; left time: 493.3573s
	iters: 200, epoch: 1 | loss: 2.2518890
	speed: 0.0100s/iter; left time: 452.8932s
	iters: 300, epoch: 1 | loss: 0.3275992
	speed: 0.0097s/iter; left time: 440.3610s
	iters: 400, epoch: 1 | loss: 0.3327939
	speed: 0.0097s/iter; left time: 437.1689s
	iters: 500, epoch: 1 | loss: 0.4322953
	speed: 0.0096s/iter; left time: 431.5567s
	iters: 600, epoch: 1 | loss: 0.3225946
	speed: 0.0094s/iter; left time: 420.9552s
	iters: 700, epoch: 1 | loss: 0.3174602
	speed: 0.0096s/iter; left time: 430.7761s
	iters: 800, epoch: 1 | loss: 0.3198703
	speed: 0.0103s/iter; left time: 460.0639s
	iters: 900, epoch: 1 | loss: 0.7126328
	speed: 0.0093s/iter; left time: 415.8787s
	iters: 1000, epoch: 1 | loss: 2.4083416
	speed: 0.0094s/iter; left time: 418.7737s
	iters: 1100, epoch: 1 | loss: 0.7524482
	speed: 0.0098s/iter; left time: 437.3575s
	iters: 1200, epoch: 1 | loss: 0.2891450
	speed: 0.0089s/iter; left time: 392.8941s
	iters: 1300, epoch: 1 | loss: 2.2716334
	speed: 0.0093s/iter; left time: 410.4404s
	iters: 1400, epoch: 1 | loss: 0.5492748
	speed: 0.0097s/iter; left time: 429.0475s
	iters: 1500, epoch: 1 | loss: 0.3454673
	speed: 0.0086s/iter; left time: 380.6212s
	iters: 1600, epoch: 1 | loss: 0.4311400
	speed: 0.0095s/iter; left time: 417.7284s
	iters: 1700, epoch: 1 | loss: 0.6306741
	speed: 0.0097s/iter; left time: 423.8947s
	iters: 1800, epoch: 1 | loss: 0.4356790
	speed: 0.0096s/iter; left time: 419.9635s
	iters: 1900, epoch: 1 | loss: 0.3414923
	speed: 0.0094s/iter; left time: 410.4628s
	iters: 2000, epoch: 1 | loss: 0.3138695
	speed: 0.0097s/iter; left time: 424.6678s
	iters: 2100, epoch: 1 | loss: 13.4552116
	speed: 0.0087s/iter; left time: 376.5508s
	iters: 2200, epoch: 1 | loss: 0.7738134
	speed: 0.0093s/iter; left time: 403.9862s
Epoch: 1 cost time: 21.726368188858032
Epoch: 1, Steps: 2278 | Train Loss: 1.2707364 Vali Loss: 0.5271792 Test Loss: 0.2165218
Validation loss decreased (inf --> 0.527179).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.3941582
	speed: 0.0355s/iter; left time: 1531.5309s
	iters: 200, epoch: 2 | loss: 0.3482352
	speed: 0.0090s/iter; left time: 387.6029s
	iters: 300, epoch: 2 | loss: 0.6576653
	speed: 0.0084s/iter; left time: 359.7730s
	iters: 400, epoch: 2 | loss: 0.3642980
	speed: 0.0090s/iter; left time: 387.0223s
	iters: 500, epoch: 2 | loss: 0.4423203
	speed: 0.0090s/iter; left time: 386.1698s
	iters: 600, epoch: 2 | loss: 3.5932772
	speed: 0.0093s/iter; left time: 396.7100s
	iters: 700, epoch: 2 | loss: 0.4289524
	speed: 0.0091s/iter; left time: 389.6081s
	iters: 800, epoch: 2 | loss: 1.2308633
	speed: 0.0094s/iter; left time: 397.5010s
	iters: 900, epoch: 2 | loss: 2.5966825
	speed: 0.0095s/iter; left time: 400.9847s
	iters: 1000, epoch: 2 | loss: 0.3554104
	speed: 0.0092s/iter; left time: 388.3567s
	iters: 1100, epoch: 2 | loss: 0.3376411
	speed: 0.0091s/iter; left time: 384.9880s
	iters: 1200, epoch: 2 | loss: 0.6343737
	speed: 0.0095s/iter; left time: 401.7809s
	iters: 1300, epoch: 2 | loss: 0.4907911
	speed: 0.0100s/iter; left time: 419.9278s
	iters: 1400, epoch: 2 | loss: 0.2910748
	speed: 0.0096s/iter; left time: 401.6717s
	iters: 1500, epoch: 2 | loss: 0.4039100
	speed: 0.0088s/iter; left time: 369.2342s
	iters: 1600, epoch: 2 | loss: 0.3576402
	speed: 0.0084s/iter; left time: 349.3059s
	iters: 1700, epoch: 2 | loss: 3.5406165
	speed: 0.0091s/iter; left time: 379.9398s
	iters: 1800, epoch: 2 | loss: 0.4535358
	speed: 0.0093s/iter; left time: 387.2822s
	iters: 1900, epoch: 2 | loss: 0.9810202
	speed: 0.0084s/iter; left time: 346.5933s
	iters: 2000, epoch: 2 | loss: 0.3168697
	speed: 0.0082s/iter; left time: 338.5916s
	iters: 2100, epoch: 2 | loss: 0.3751651
	speed: 0.0091s/iter; left time: 374.1408s
	iters: 2200, epoch: 2 | loss: 0.2180823
	speed: 0.0088s/iter; left time: 362.6091s
Epoch: 2 cost time: 20.576685428619385
Epoch: 2, Steps: 2278 | Train Loss: 0.9730806 Vali Loss: 0.5350484 Test Loss: 0.2128182
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.4385501
	speed: 0.0377s/iter; left time: 1543.2393s
	iters: 200, epoch: 3 | loss: 1.1000202
	speed: 0.0095s/iter; left time: 387.0136s
	iters: 300, epoch: 3 | loss: 1.1937064
	speed: 0.0084s/iter; left time: 342.2112s
	iters: 400, epoch: 3 | loss: 0.3161735
	speed: 0.0086s/iter; left time: 349.7137s
	iters: 500, epoch: 3 | loss: 0.3758834
	speed: 0.0097s/iter; left time: 394.1983s
	iters: 600, epoch: 3 | loss: 0.3809054
	speed: 0.0098s/iter; left time: 395.5883s
	iters: 700, epoch: 3 | loss: 0.2948376
	speed: 0.0088s/iter; left time: 353.1261s
	iters: 800, epoch: 3 | loss: 0.3973286
	speed: 0.0095s/iter; left time: 382.7398s
	iters: 900, epoch: 3 | loss: 0.4467876
	speed: 0.0099s/iter; left time: 398.6611s
	iters: 1000, epoch: 3 | loss: 0.3186538
	speed: 0.0108s/iter; left time: 431.6083s
	iters: 1100, epoch: 3 | loss: 0.7165790
	speed: 0.0100s/iter; left time: 400.2075s
	iters: 1200, epoch: 3 | loss: 5.8844676
	speed: 0.0087s/iter; left time: 345.9022s
	iters: 1300, epoch: 3 | loss: 0.4860016
	speed: 0.0087s/iter; left time: 346.8221s
	iters: 1400, epoch: 3 | loss: 0.2428789
	speed: 0.0086s/iter; left time: 339.3116s
	iters: 1500, epoch: 3 | loss: 0.2211266
	speed: 0.0088s/iter; left time: 345.6801s
	iters: 1600, epoch: 3 | loss: 4.6720791
	speed: 0.0096s/iter; left time: 378.2609s
	iters: 1700, epoch: 3 | loss: 0.6435115
	speed: 0.0094s/iter; left time: 368.5382s
	iters: 1800, epoch: 3 | loss: 0.3991737
	speed: 0.0098s/iter; left time: 385.4013s
	iters: 1900, epoch: 3 | loss: 0.3880590
	speed: 0.0098s/iter; left time: 382.8699s
	iters: 2000, epoch: 3 | loss: 0.4870648
	speed: 0.0090s/iter; left time: 352.8296s
	iters: 2100, epoch: 3 | loss: 0.3154212
	speed: 0.0097s/iter; left time: 377.8446s
	iters: 2200, epoch: 3 | loss: 0.4154005
	speed: 0.0088s/iter; left time: 340.2007s
Epoch: 3 cost time: 21.177356243133545
Epoch: 3, Steps: 2278 | Train Loss: 0.6620416 Vali Loss: 0.4320684 Test Loss: 0.1741953
Validation loss decreased (0.527179 --> 0.432068).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.2096783
	speed: 0.0358s/iter; left time: 1383.0076s
	iters: 200, epoch: 4 | loss: 0.1924740
	speed: 0.0101s/iter; left time: 389.7996s
	iters: 300, epoch: 4 | loss: 0.3469060
	speed: 0.0101s/iter; left time: 386.6744s
	iters: 400, epoch: 4 | loss: 0.2620074
	speed: 0.0091s/iter; left time: 349.3473s
	iters: 500, epoch: 4 | loss: 0.3637572
	speed: 0.0090s/iter; left time: 343.5380s
	iters: 600, epoch: 4 | loss: 0.3895094
	speed: 0.0088s/iter; left time: 335.7514s
	iters: 700, epoch: 4 | loss: 0.2620951
	speed: 0.0091s/iter; left time: 344.9920s
	iters: 800, epoch: 4 | loss: 0.7700809
	speed: 0.0093s/iter; left time: 352.9710s
	iters: 900, epoch: 4 | loss: 0.3419842
	speed: 0.0098s/iter; left time: 369.6583s
	iters: 1000, epoch: 4 | loss: 0.2717285
	speed: 0.0090s/iter; left time: 338.6949s
	iters: 1100, epoch: 4 | loss: 1.5664234
	speed: 0.0091s/iter; left time: 343.0428s
	iters: 1200, epoch: 4 | loss: 0.4514452
	speed: 0.0090s/iter; left time: 338.6824s
	iters: 1300, epoch: 4 | loss: 0.7059469
	speed: 0.0091s/iter; left time: 340.7702s
	iters: 1400, epoch: 4 | loss: 0.2956915
	speed: 0.0089s/iter; left time: 332.4690s
	iters: 1500, epoch: 4 | loss: 0.3246006
	speed: 0.0090s/iter; left time: 334.9388s
	iters: 1600, epoch: 4 | loss: 0.2746816
	speed: 0.0094s/iter; left time: 347.9164s
	iters: 1700, epoch: 4 | loss: 0.3959556
	speed: 0.0100s/iter; left time: 371.8015s
	iters: 1800, epoch: 4 | loss: 0.4053933
	speed: 0.0097s/iter; left time: 357.1826s
	iters: 1900, epoch: 4 | loss: 0.1774778
	speed: 0.0095s/iter; left time: 349.6775s
	iters: 2000, epoch: 4 | loss: 0.2414258
	speed: 0.0093s/iter; left time: 340.5377s
	iters: 2100, epoch: 4 | loss: 0.3172178
	speed: 0.0096s/iter; left time: 351.4349s
	iters: 2200, epoch: 4 | loss: 0.2648513
	speed: 0.0097s/iter; left time: 354.7888s
Epoch: 4 cost time: 21.377586841583252
Epoch: 4, Steps: 2278 | Train Loss: 0.5157067 Vali Loss: 0.3967371 Test Loss: 0.1619956
Validation loss decreased (0.432068 --> 0.396737).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.3056446
	speed: 0.0363s/iter; left time: 1321.2638s
	iters: 200, epoch: 5 | loss: 0.3526399
	speed: 0.0090s/iter; left time: 325.4011s
	iters: 300, epoch: 5 | loss: 0.2958942
	speed: 0.0089s/iter; left time: 321.9363s
	iters: 400, epoch: 5 | loss: 0.3388181
	speed: 0.0099s/iter; left time: 355.1754s
	iters: 500, epoch: 5 | loss: 0.3296648
	speed: 0.0091s/iter; left time: 327.0190s
	iters: 600, epoch: 5 | loss: 0.2502651
	speed: 0.0098s/iter; left time: 352.5479s
	iters: 700, epoch: 5 | loss: 0.2405543
	speed: 0.0095s/iter; left time: 339.4357s
	iters: 800, epoch: 5 | loss: 0.2209559
	speed: 0.0093s/iter; left time: 332.8696s
	iters: 900, epoch: 5 | loss: 0.2959416
	speed: 0.0099s/iter; left time: 351.2941s
	iters: 1000, epoch: 5 | loss: 0.3606152
	speed: 0.0102s/iter; left time: 363.1046s
	iters: 1100, epoch: 5 | loss: 0.2598900
	speed: 0.0094s/iter; left time: 332.8616s
	iters: 1200, epoch: 5 | loss: 0.2550172
	speed: 0.0096s/iter; left time: 338.8295s
	iters: 1300, epoch: 5 | loss: 0.4557152
	speed: 0.0097s/iter; left time: 342.4089s
	iters: 1400, epoch: 5 | loss: 2.3804166
	speed: 0.0088s/iter; left time: 306.7572s
	iters: 1500, epoch: 5 | loss: 0.3202680
	speed: 0.0094s/iter; left time: 329.6388s
	iters: 1600, epoch: 5 | loss: 0.3222487
	speed: 0.0097s/iter; left time: 336.6654s
	iters: 1700, epoch: 5 | loss: 0.4891549
	speed: 0.0103s/iter; left time: 357.7273s
	iters: 1800, epoch: 5 | loss: 0.2955825
	speed: 0.0096s/iter; left time: 331.5969s
	iters: 1900, epoch: 5 | loss: 0.2125939
	speed: 0.0088s/iter; left time: 305.3715s
	iters: 2000, epoch: 5 | loss: 2.5173528
	speed: 0.0095s/iter; left time: 326.0812s
	iters: 2100, epoch: 5 | loss: 0.6774445
	speed: 0.0089s/iter; left time: 304.7249s
	iters: 2200, epoch: 5 | loss: 0.7347230
	speed: 0.0088s/iter; left time: 302.6722s
Epoch: 5 cost time: 21.43118143081665
Epoch: 5, Steps: 2278 | Train Loss: 0.4736808 Vali Loss: 0.3796578 Test Loss: 0.1517067
Validation loss decreased (0.396737 --> 0.379658).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.3220865
	speed: 0.0374s/iter; left time: 1275.5441s
	iters: 200, epoch: 6 | loss: 0.2442467
	speed: 0.0093s/iter; left time: 316.8413s
	iters: 300, epoch: 6 | loss: 0.4173592
	speed: 0.0092s/iter; left time: 312.6423s
	iters: 400, epoch: 6 | loss: 0.4811069
	speed: 0.0095s/iter; left time: 319.8880s
	iters: 500, epoch: 6 | loss: 0.4225299
	speed: 0.0100s/iter; left time: 336.4542s
	iters: 600, epoch: 6 | loss: 1.4898238
	speed: 0.0096s/iter; left time: 321.8436s
	iters: 700, epoch: 6 | loss: 0.8415091
	speed: 0.0091s/iter; left time: 305.0084s
	iters: 800, epoch: 6 | loss: 0.3617083
	speed: 0.0092s/iter; left time: 306.5683s
	iters: 900, epoch: 6 | loss: 0.2357584
	speed: 0.0095s/iter; left time: 315.3358s
	iters: 1000, epoch: 6 | loss: 1.0483941
	speed: 0.0090s/iter; left time: 298.2841s
	iters: 1100, epoch: 6 | loss: 0.4546396
	speed: 0.0089s/iter; left time: 294.7263s
	iters: 1200, epoch: 6 | loss: 0.2264210
	speed: 0.0087s/iter; left time: 288.4158s
	iters: 1300, epoch: 6 | loss: 0.2483876
	speed: 0.0093s/iter; left time: 304.2875s
	iters: 1400, epoch: 6 | loss: 0.2351151
	speed: 0.0095s/iter; left time: 311.9828s
	iters: 1500, epoch: 6 | loss: 0.4453455
	speed: 0.0089s/iter; left time: 290.5056s
	iters: 1600, epoch: 6 | loss: 0.3017852
	speed: 0.0084s/iter; left time: 274.8168s
	iters: 1700, epoch: 6 | loss: 0.8004046
	speed: 0.0090s/iter; left time: 291.9258s
	iters: 1800, epoch: 6 | loss: 0.4277709
	speed: 0.0082s/iter; left time: 265.8242s
	iters: 1900, epoch: 6 | loss: 0.2178953
	speed: 0.0090s/iter; left time: 290.0397s
	iters: 2000, epoch: 6 | loss: 0.2093391
	speed: 0.0096s/iter; left time: 309.6761s
	iters: 2100, epoch: 6 | loss: 0.2421338
	speed: 0.0099s/iter; left time: 316.1124s
	iters: 2200, epoch: 6 | loss: 0.4601774
	speed: 0.0091s/iter; left time: 291.2709s
Epoch: 6 cost time: 20.914272785186768
Epoch: 6, Steps: 2278 | Train Loss: 0.4564281 Vali Loss: 0.3700179 Test Loss: 0.1459642
Validation loss decreased (0.379658 --> 0.370018).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.1957371
	speed: 0.0340s/iter; left time: 1080.2400s
	iters: 200, epoch: 7 | loss: 0.3057557
	speed: 0.0094s/iter; left time: 298.7214s
	iters: 300, epoch: 7 | loss: 0.2184774
	speed: 0.0085s/iter; left time: 268.2288s
	iters: 400, epoch: 7 | loss: 0.2048874
	speed: 0.0097s/iter; left time: 304.4124s
	iters: 500, epoch: 7 | loss: 0.5673409
	speed: 0.0082s/iter; left time: 257.4892s
	iters: 600, epoch: 7 | loss: 0.4092651
	speed: 0.0090s/iter; left time: 282.4573s
	iters: 700, epoch: 7 | loss: 0.2784589
	speed: 0.0096s/iter; left time: 299.8423s
	iters: 800, epoch: 7 | loss: 0.1948159
	speed: 0.0091s/iter; left time: 282.5106s
	iters: 900, epoch: 7 | loss: 0.2221231
	speed: 0.0092s/iter; left time: 284.7333s
	iters: 1000, epoch: 7 | loss: 0.4076617
	speed: 0.0094s/iter; left time: 288.9106s
	iters: 1100, epoch: 7 | loss: 0.2163365
	speed: 0.0088s/iter; left time: 269.4407s
	iters: 1200, epoch: 7 | loss: 0.3019123
	speed: 0.0095s/iter; left time: 290.4337s
	iters: 1300, epoch: 7 | loss: 0.3186008
	speed: 0.0090s/iter; left time: 274.8840s
	iters: 1400, epoch: 7 | loss: 0.2534709
	speed: 0.0096s/iter; left time: 292.6414s
	iters: 1500, epoch: 7 | loss: 0.2050276
	speed: 0.0102s/iter; left time: 309.2772s
	iters: 1600, epoch: 7 | loss: 0.3429143
	speed: 0.0080s/iter; left time: 243.2529s
	iters: 1700, epoch: 7 | loss: 0.2906085
	speed: 0.0097s/iter; left time: 293.2310s
	iters: 1800, epoch: 7 | loss: 0.4857996
	speed: 0.0090s/iter; left time: 270.3857s
	iters: 1900, epoch: 7 | loss: 0.2636382
	speed: 0.0094s/iter; left time: 282.5841s
	iters: 2000, epoch: 7 | loss: 0.4252286
	speed: 0.0088s/iter; left time: 261.9107s
	iters: 2100, epoch: 7 | loss: 0.3311870
	speed: 0.0088s/iter; left time: 263.2803s
	iters: 2200, epoch: 7 | loss: 0.4472898
	speed: 0.0097s/iter; left time: 286.9012s
Epoch: 7 cost time: 20.932618379592896
Epoch: 7, Steps: 2278 | Train Loss: 0.4483139 Vali Loss: 0.3679575 Test Loss: 0.1472707
Validation loss decreased (0.370018 --> 0.367957).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.3238174
	speed: 0.0362s/iter; left time: 1067.4801s
	iters: 200, epoch: 8 | loss: 2.3888068
	speed: 0.0095s/iter; left time: 279.2250s
	iters: 300, epoch: 8 | loss: 0.2075501
	speed: 0.0103s/iter; left time: 300.7674s
	iters: 400, epoch: 8 | loss: 0.2471742
	speed: 0.0089s/iter; left time: 260.5042s
	iters: 500, epoch: 8 | loss: 0.2939115
	speed: 0.0090s/iter; left time: 262.2027s
	iters: 600, epoch: 8 | loss: 0.2330844
	speed: 0.0085s/iter; left time: 246.6151s
	iters: 700, epoch: 8 | loss: 0.5668188
	speed: 0.0086s/iter; left time: 249.1435s
	iters: 800, epoch: 8 | loss: 0.3121456
	speed: 0.0081s/iter; left time: 233.4491s
	iters: 900, epoch: 8 | loss: 0.8044233
	speed: 0.0089s/iter; left time: 256.9020s
	iters: 1000, epoch: 8 | loss: 2.2543273
	speed: 0.0080s/iter; left time: 228.3375s
	iters: 1100, epoch: 8 | loss: 0.2344740
	speed: 0.0088s/iter; left time: 251.6512s
	iters: 1200, epoch: 8 | loss: 0.2177757
	speed: 0.0102s/iter; left time: 288.7538s
	iters: 1300, epoch: 8 | loss: 0.6128206
	speed: 0.0094s/iter; left time: 264.9513s
	iters: 1400, epoch: 8 | loss: 0.2828363
	speed: 0.0092s/iter; left time: 259.4986s
	iters: 1500, epoch: 8 | loss: 0.6027051
	speed: 0.0092s/iter; left time: 257.3072s
	iters: 1600, epoch: 8 | loss: 2.5269532
	speed: 0.0098s/iter; left time: 274.7604s
	iters: 1700, epoch: 8 | loss: 0.4998092
	speed: 0.0102s/iter; left time: 284.9379s
	iters: 1800, epoch: 8 | loss: 0.3196606
	speed: 0.0098s/iter; left time: 271.9541s
	iters: 1900, epoch: 8 | loss: 0.5231774
	speed: 0.0091s/iter; left time: 252.3783s
	iters: 2000, epoch: 8 | loss: 0.3266248
	speed: 0.0091s/iter; left time: 251.8895s
	iters: 2100, epoch: 8 | loss: 0.2383835
	speed: 0.0090s/iter; left time: 247.4060s
	iters: 2200, epoch: 8 | loss: 0.2456442
	speed: 0.0089s/iter; left time: 242.6533s
Epoch: 8 cost time: 20.903905153274536
Epoch: 8, Steps: 2278 | Train Loss: 0.4441814 Vali Loss: 0.3710226 Test Loss: 0.1492720
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.2805140
	speed: 0.0350s/iter; left time: 953.9109s
	iters: 200, epoch: 9 | loss: 0.3433756
	speed: 0.0086s/iter; left time: 233.2041s
	iters: 300, epoch: 9 | loss: 0.5888999
	speed: 0.0090s/iter; left time: 242.1467s
	iters: 400, epoch: 9 | loss: 0.1829520
	speed: 0.0089s/iter; left time: 238.5623s
	iters: 500, epoch: 9 | loss: 1.8297285
	speed: 0.0089s/iter; left time: 239.8157s
	iters: 600, epoch: 9 | loss: 0.1630419
	speed: 0.0085s/iter; left time: 228.3716s
	iters: 700, epoch: 9 | loss: 0.4011137
	speed: 0.0093s/iter; left time: 248.2115s
	iters: 800, epoch: 9 | loss: 0.2977030
	speed: 0.0098s/iter; left time: 259.4598s
	iters: 900, epoch: 9 | loss: 0.5313050
	speed: 0.0097s/iter; left time: 255.4264s
	iters: 1000, epoch: 9 | loss: 0.2915571
	speed: 0.0091s/iter; left time: 240.9039s
	iters: 1100, epoch: 9 | loss: 0.2819314
	speed: 0.0090s/iter; left time: 235.2715s
	iters: 1200, epoch: 9 | loss: 1.7646797
	speed: 0.0093s/iter; left time: 243.1160s
	iters: 1300, epoch: 9 | loss: 0.2451235
	speed: 0.0091s/iter; left time: 237.0814s
	iters: 1400, epoch: 9 | loss: 0.3891170
	speed: 0.0094s/iter; left time: 244.7058s
	iters: 1500, epoch: 9 | loss: 0.2875066
	speed: 0.0092s/iter; left time: 238.6425s
	iters: 1600, epoch: 9 | loss: 0.2846674
	speed: 0.0091s/iter; left time: 233.8281s
	iters: 1700, epoch: 9 | loss: 0.1651259
	speed: 0.0091s/iter; left time: 233.2891s
	iters: 1800, epoch: 9 | loss: 2.1525359
	speed: 0.0097s/iter; left time: 246.4820s
	iters: 1900, epoch: 9 | loss: 0.3774923
	speed: 0.0090s/iter; left time: 229.3742s
	iters: 2000, epoch: 9 | loss: 0.2299012
	speed: 0.0094s/iter; left time: 238.7331s
	iters: 2100, epoch: 9 | loss: 0.3501062
	speed: 0.0093s/iter; left time: 235.8824s
	iters: 2200, epoch: 9 | loss: 0.1701152
	speed: 0.0099s/iter; left time: 247.7491s
Epoch: 9 cost time: 20.960574865341187
Epoch: 9, Steps: 2278 | Train Loss: 0.4420363 Vali Loss: 0.3653299 Test Loss: 0.1458999
Validation loss decreased (0.367957 --> 0.365330).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 2.2066617
	speed: 0.0372s/iter; left time: 927.7040s
	iters: 200, epoch: 10 | loss: 0.5620032
	speed: 0.0095s/iter; left time: 235.8349s
	iters: 300, epoch: 10 | loss: 0.2725942
	speed: 0.0094s/iter; left time: 233.0308s
	iters: 400, epoch: 10 | loss: 0.2038286
	speed: 0.0090s/iter; left time: 221.6070s
	iters: 500, epoch: 10 | loss: 0.3442417
	speed: 0.0094s/iter; left time: 230.6379s
	iters: 600, epoch: 10 | loss: 0.2437219
	speed: 0.0094s/iter; left time: 228.7309s
	iters: 700, epoch: 10 | loss: 0.3188778
	speed: 0.0095s/iter; left time: 230.3647s
	iters: 800, epoch: 10 | loss: 0.4618035
	speed: 0.0095s/iter; left time: 231.4797s
	iters: 900, epoch: 10 | loss: 0.2046796
	speed: 0.0093s/iter; left time: 225.4239s
	iters: 1000, epoch: 10 | loss: 0.2384943
	speed: 0.0093s/iter; left time: 224.6242s
	iters: 1100, epoch: 10 | loss: 0.3060925
	speed: 0.0094s/iter; left time: 224.7876s
	iters: 1200, epoch: 10 | loss: 0.2510338
	speed: 0.0097s/iter; left time: 230.6327s
	iters: 1300, epoch: 10 | loss: 0.2698762
	speed: 0.0097s/iter; left time: 230.0382s
	iters: 1400, epoch: 10 | loss: 0.2999214
	speed: 0.0093s/iter; left time: 219.7855s
	iters: 1500, epoch: 10 | loss: 0.2802412
	speed: 0.0094s/iter; left time: 221.7101s
	iters: 1600, epoch: 10 | loss: 1.4001043
	speed: 0.0092s/iter; left time: 216.9291s
	iters: 1700, epoch: 10 | loss: 0.1989488
	speed: 0.0095s/iter; left time: 221.7531s
	iters: 1800, epoch: 10 | loss: 0.4627626
	speed: 0.0095s/iter; left time: 221.1545s
	iters: 1900, epoch: 10 | loss: 0.3185116
	speed: 0.0092s/iter; left time: 212.0613s
	iters: 2000, epoch: 10 | loss: 0.2209480
	speed: 0.0095s/iter; left time: 219.6957s
	iters: 2100, epoch: 10 | loss: 0.2678222
	speed: 0.0095s/iter; left time: 217.2294s
	iters: 2200, epoch: 10 | loss: 0.2794611
	speed: 0.0093s/iter; left time: 212.0592s
Epoch: 10 cost time: 21.413262367248535
Epoch: 10, Steps: 2278 | Train Loss: 0.4411542 Vali Loss: 0.3663763 Test Loss: 0.1454090
EarlyStopping counter: 1 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.4150843
	speed: 0.0366s/iter; left time: 830.3646s
	iters: 200, epoch: 11 | loss: 0.2526396
	speed: 0.0094s/iter; left time: 212.5427s
	iters: 300, epoch: 11 | loss: 0.1884021
	speed: 0.0093s/iter; left time: 209.1162s
	iters: 400, epoch: 11 | loss: 0.2374871
	speed: 0.0092s/iter; left time: 206.5129s
	iters: 500, epoch: 11 | loss: 0.2677587
	speed: 0.0093s/iter; left time: 206.2571s
	iters: 600, epoch: 11 | loss: 0.2808134
	speed: 0.0092s/iter; left time: 203.6766s
	iters: 700, epoch: 11 | loss: 0.2894157
	speed: 0.0092s/iter; left time: 203.1777s
	iters: 800, epoch: 11 | loss: 0.3788179
	speed: 0.0094s/iter; left time: 206.8860s
	iters: 900, epoch: 11 | loss: 0.2106955
	speed: 0.0095s/iter; left time: 207.7356s
	iters: 1000, epoch: 11 | loss: 2.0067916
	speed: 0.0097s/iter; left time: 211.3220s
	iters: 1100, epoch: 11 | loss: 0.1998535
	speed: 0.0094s/iter; left time: 204.8176s
	iters: 1200, epoch: 11 | loss: 0.2641718
	speed: 0.0095s/iter; left time: 204.8462s
	iters: 1300, epoch: 11 | loss: 0.1874586
	speed: 0.0096s/iter; left time: 207.0268s
	iters: 1400, epoch: 11 | loss: 0.2673652
	speed: 0.0093s/iter; left time: 198.5850s
	iters: 1500, epoch: 11 | loss: 0.2896660
	speed: 0.0096s/iter; left time: 203.3855s
	iters: 1600, epoch: 11 | loss: 0.2852834
	speed: 0.0096s/iter; left time: 203.2561s
	iters: 1700, epoch: 11 | loss: 0.5923197
	speed: 0.0095s/iter; left time: 199.2586s
	iters: 1800, epoch: 11 | loss: 0.3649237
	speed: 0.0095s/iter; left time: 199.2585s
	iters: 1900, epoch: 11 | loss: 0.5467934
	speed: 0.0094s/iter; left time: 196.3165s
	iters: 2000, epoch: 11 | loss: 0.3235981
	speed: 0.0092s/iter; left time: 190.2925s
	iters: 2100, epoch: 11 | loss: 0.4821937
	speed: 0.0094s/iter; left time: 194.1282s
	iters: 2200, epoch: 11 | loss: 0.5948254
	speed: 0.0096s/iter; left time: 197.0962s
Epoch: 11 cost time: 21.4141104221344
Epoch: 11, Steps: 2278 | Train Loss: 0.4406432 Vali Loss: 0.3663185 Test Loss: 0.1452556
EarlyStopping counter: 2 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.2366356
	speed: 0.0372s/iter; left time: 758.6804s
	iters: 200, epoch: 12 | loss: 2.2831609
	speed: 0.0094s/iter; left time: 191.7968s
	iters: 300, epoch: 12 | loss: 0.2287548
	speed: 0.0091s/iter; left time: 184.1846s
	iters: 400, epoch: 12 | loss: 0.2049367
	speed: 0.0096s/iter; left time: 192.8174s
	iters: 500, epoch: 12 | loss: 0.1894088
	speed: 0.0095s/iter; left time: 189.7327s
	iters: 600, epoch: 12 | loss: 0.2396286
	speed: 0.0093s/iter; left time: 184.5402s
	iters: 700, epoch: 12 | loss: 0.2605780
	speed: 0.0096s/iter; left time: 189.7420s
	iters: 800, epoch: 12 | loss: 0.7583261
	speed: 0.0092s/iter; left time: 181.1977s
	iters: 900, epoch: 12 | loss: 0.2377063
	speed: 0.0096s/iter; left time: 187.8349s
	iters: 1000, epoch: 12 | loss: 0.4573178
	speed: 0.0099s/iter; left time: 193.5035s
	iters: 1100, epoch: 12 | loss: 0.2962314
	speed: 0.0094s/iter; left time: 182.6166s
	iters: 1200, epoch: 12 | loss: 0.2287189
	speed: 0.0092s/iter; left time: 178.2100s
	iters: 1300, epoch: 12 | loss: 0.2990791
	speed: 0.0088s/iter; left time: 169.3772s
	iters: 1400, epoch: 12 | loss: 0.5921925
	speed: 0.0097s/iter; left time: 184.4797s
	iters: 1500, epoch: 12 | loss: 0.2859403
	speed: 0.0093s/iter; left time: 176.1012s
	iters: 1600, epoch: 12 | loss: 0.3007355
	speed: 0.0096s/iter; left time: 180.7103s
	iters: 1700, epoch: 12 | loss: 0.3437486
	speed: 0.0092s/iter; left time: 172.9255s
	iters: 1800, epoch: 12 | loss: 0.3136726
	speed: 0.0095s/iter; left time: 178.4318s
	iters: 1900, epoch: 12 | loss: 0.2307997
	speed: 0.0097s/iter; left time: 180.9894s
	iters: 2000, epoch: 12 | loss: 0.2335659
	speed: 0.0094s/iter; left time: 174.1265s
	iters: 2100, epoch: 12 | loss: 1.3884242
	speed: 0.0096s/iter; left time: 176.5375s
	iters: 2200, epoch: 12 | loss: 0.3800296
	speed: 0.0095s/iter; left time: 174.2845s
Epoch: 12 cost time: 21.540379762649536
Epoch: 12, Steps: 2278 | Train Loss: 0.4403434 Vali Loss: 0.3661581 Test Loss: 0.1454288
EarlyStopping counter: 3 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.2554286
	speed: 0.0369s/iter; left time: 669.3300s
	iters: 200, epoch: 13 | loss: 0.3084190
	speed: 0.0099s/iter; left time: 177.5926s
	iters: 300, epoch: 13 | loss: 0.5409785
	speed: 0.0093s/iter; left time: 167.0049s
	iters: 400, epoch: 13 | loss: 0.3541021
	speed: 0.0093s/iter; left time: 166.6101s
	iters: 500, epoch: 13 | loss: 0.2657912
	speed: 0.0094s/iter; left time: 166.3012s
	iters: 600, epoch: 13 | loss: 0.4601217
	speed: 0.0093s/iter; left time: 164.3824s
	iters: 700, epoch: 13 | loss: 0.3734411
	speed: 0.0090s/iter; left time: 158.0213s
	iters: 800, epoch: 13 | loss: 0.4324790
	speed: 0.0092s/iter; left time: 160.2416s
	iters: 900, epoch: 13 | loss: 0.5309737
	speed: 0.0096s/iter; left time: 165.7545s
	iters: 1000, epoch: 13 | loss: 0.2238964
	speed: 0.0091s/iter; left time: 157.0393s
	iters: 1100, epoch: 13 | loss: 0.2841718
	speed: 0.0092s/iter; left time: 158.1797s
	iters: 1200, epoch: 13 | loss: 0.3081194
	speed: 0.0095s/iter; left time: 162.2950s
	iters: 1300, epoch: 13 | loss: 0.2341215
	speed: 0.0094s/iter; left time: 158.8606s
	iters: 1400, epoch: 13 | loss: 0.3343397
	speed: 0.0092s/iter; left time: 154.9000s
	iters: 1500, epoch: 13 | loss: 0.2713107
	speed: 0.0097s/iter; left time: 161.8193s
	iters: 1600, epoch: 13 | loss: 0.4115508
	speed: 0.0093s/iter; left time: 155.1362s
	iters: 1700, epoch: 13 | loss: 0.2082694
	speed: 0.0093s/iter; left time: 154.3716s
	iters: 1800, epoch: 13 | loss: 0.3323758
	speed: 0.0094s/iter; left time: 154.1405s
	iters: 1900, epoch: 13 | loss: 0.2610432
	speed: 0.0096s/iter; left time: 156.8836s
	iters: 2000, epoch: 13 | loss: 0.4330401
	speed: 0.0093s/iter; left time: 150.2564s
	iters: 2100, epoch: 13 | loss: 0.2140009
	speed: 0.0095s/iter; left time: 152.6497s
	iters: 2200, epoch: 13 | loss: 0.3997124
	speed: 0.0095s/iter; left time: 152.0733s
Epoch: 13 cost time: 21.34930181503296
Epoch: 13, Steps: 2278 | Train Loss: 0.4402004 Vali Loss: 0.3662920 Test Loss: 0.1454124
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.3333045
	speed: 0.0360s/iter; left time: 570.9967s
	iters: 200, epoch: 14 | loss: 0.2043409
	speed: 0.0094s/iter; left time: 148.6907s
	iters: 300, epoch: 14 | loss: 0.4013477
	speed: 0.0094s/iter; left time: 147.2748s
	iters: 400, epoch: 14 | loss: 0.5499230
	speed: 0.0094s/iter; left time: 146.5838s
	iters: 500, epoch: 14 | loss: 0.2875822
	speed: 0.0094s/iter; left time: 144.8404s
	iters: 600, epoch: 14 | loss: 0.2173096
	speed: 0.0094s/iter; left time: 144.5800s
	iters: 700, epoch: 14 | loss: 0.5844104
	speed: 0.0094s/iter; left time: 144.0430s
	iters: 800, epoch: 14 | loss: 0.2881760
	speed: 0.0094s/iter; left time: 142.2980s
	iters: 900, epoch: 14 | loss: 0.3387742
	speed: 0.0094s/iter; left time: 141.5460s
	iters: 1000, epoch: 14 | loss: 0.2768888
	speed: 0.0092s/iter; left time: 136.8701s
	iters: 1100, epoch: 14 | loss: 0.2507050
	speed: 0.0095s/iter; left time: 140.4599s
	iters: 1200, epoch: 14 | loss: 0.3014038
	speed: 0.0095s/iter; left time: 140.0549s
	iters: 1300, epoch: 14 | loss: 0.1895124
	speed: 0.0094s/iter; left time: 137.4396s
	iters: 1400, epoch: 14 | loss: 0.2975280
	speed: 0.0094s/iter; left time: 137.2924s
	iters: 1500, epoch: 14 | loss: 0.3158264
	speed: 0.0094s/iter; left time: 136.0450s
	iters: 1600, epoch: 14 | loss: 0.2213819
	speed: 0.0099s/iter; left time: 141.9125s
	iters: 1700, epoch: 14 | loss: 0.2980027
	speed: 0.0093s/iter; left time: 131.8198s
	iters: 1800, epoch: 14 | loss: 0.3245697
	speed: 0.0096s/iter; left time: 135.7133s
	iters: 1900, epoch: 14 | loss: 0.2543603
	speed: 0.0093s/iter; left time: 131.1054s
	iters: 2000, epoch: 14 | loss: 0.2330006
	speed: 0.0095s/iter; left time: 132.1632s
	iters: 2100, epoch: 14 | loss: 0.2754311
	speed: 0.0093s/iter; left time: 129.2875s
	iters: 2200, epoch: 14 | loss: 0.2412741
	speed: 0.0092s/iter; left time: 126.5720s
Epoch: 14 cost time: 21.447148084640503
Epoch: 14, Steps: 2278 | Train Loss: 0.4401275 Vali Loss: 0.3663660 Test Loss: 0.1453848
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : weather_336_96_Linear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15349<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
mse:0.14594215154647827, mae:0.21379072964191437
