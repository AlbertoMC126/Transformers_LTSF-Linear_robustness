Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='Linear', model_id='ETTm2_336_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=336, root_path='./dataset/', save_pred_values=False, seed=15349, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTm2_336_336_Linear_ETTm2_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15349>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33889
val 11185
test 11185
	iters: 100, epoch: 1 | loss: 0.9654362
	speed: 0.0097s/iter; left time: 205.1257s
	iters: 200, epoch: 1 | loss: 0.3094553
	speed: 0.0097s/iter; left time: 202.9544s
	iters: 300, epoch: 1 | loss: 0.4327859
	speed: 0.0066s/iter; left time: 137.6062s
	iters: 400, epoch: 1 | loss: 0.4930243
	speed: 0.0070s/iter; left time: 145.0557s
	iters: 500, epoch: 1 | loss: 0.7628469
	speed: 0.0070s/iter; left time: 144.9556s
	iters: 600, epoch: 1 | loss: 0.3572828
	speed: 0.0077s/iter; left time: 157.9266s
	iters: 700, epoch: 1 | loss: 0.6949296
	speed: 0.0083s/iter; left time: 169.0304s
	iters: 800, epoch: 1 | loss: 0.4071536
	speed: 0.0087s/iter; left time: 177.7538s
	iters: 900, epoch: 1 | loss: 0.9090008
	speed: 0.0085s/iter; left time: 173.2531s
	iters: 1000, epoch: 1 | loss: 0.4753741
	speed: 0.0081s/iter; left time: 163.3176s
Epoch: 1 cost time: 8.587639808654785
Epoch: 1, Steps: 1059 | Train Loss: 0.5938657 Vali Loss: 0.6291908 Test Loss: 1.4025537
Validation loss decreased (inf --> 0.629191).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.5408707
	speed: 0.0332s/iter; left time: 664.3152s
	iters: 200, epoch: 2 | loss: 0.5821914
	speed: 0.0078s/iter; left time: 154.4476s
	iters: 300, epoch: 2 | loss: 0.4961590
	speed: 0.0074s/iter; left time: 146.3944s
	iters: 400, epoch: 2 | loss: 0.5830185
	speed: 0.0087s/iter; left time: 171.8482s
	iters: 500, epoch: 2 | loss: 0.5485540
	speed: 0.0082s/iter; left time: 161.6588s
	iters: 600, epoch: 2 | loss: 0.5248733
	speed: 0.0089s/iter; left time: 174.3790s
	iters: 700, epoch: 2 | loss: 0.3972778
	speed: 0.0091s/iter; left time: 177.3693s
	iters: 800, epoch: 2 | loss: 0.4240537
	speed: 0.0081s/iter; left time: 155.9672s
	iters: 900, epoch: 2 | loss: 1.0812557
	speed: 0.0074s/iter; left time: 141.9122s
	iters: 1000, epoch: 2 | loss: 0.4837967
	speed: 0.0076s/iter; left time: 144.9762s
Epoch: 2 cost time: 8.56649112701416
Epoch: 2, Steps: 1059 | Train Loss: 0.5942409 Vali Loss: 0.4433439 Test Loss: 0.7832402
Validation loss decreased (0.629191 --> 0.443344).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.3573227
	speed: 0.0312s/iter; left time: 591.0263s
	iters: 200, epoch: 3 | loss: 0.5248928
	speed: 0.0084s/iter; left time: 157.5181s
	iters: 300, epoch: 3 | loss: 0.2768034
	speed: 0.0084s/iter; left time: 157.6453s
	iters: 400, epoch: 3 | loss: 0.2096640
	speed: 0.0082s/iter; left time: 153.8383s
	iters: 500, epoch: 3 | loss: 0.3304035
	speed: 0.0083s/iter; left time: 153.5737s
	iters: 600, epoch: 3 | loss: 0.7099554
	speed: 0.0092s/iter; left time: 169.3668s
	iters: 700, epoch: 3 | loss: 0.3330305
	speed: 0.0085s/iter; left time: 155.7636s
	iters: 800, epoch: 3 | loss: 0.3915174
	speed: 0.0082s/iter; left time: 148.9983s
	iters: 900, epoch: 3 | loss: 0.5015030
	speed: 0.0088s/iter; left time: 159.5420s
	iters: 1000, epoch: 3 | loss: 0.4106670
	speed: 0.0097s/iter; left time: 174.6937s
Epoch: 3 cost time: 9.093415260314941
Epoch: 3, Steps: 1059 | Train Loss: 0.4304396 Vali Loss: 0.3525161 Test Loss: 0.6800743
Validation loss decreased (0.443344 --> 0.352516).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.2895581
	speed: 0.0360s/iter; left time: 645.4129s
	iters: 200, epoch: 4 | loss: 0.4008802
	speed: 0.0083s/iter; left time: 147.8206s
	iters: 300, epoch: 4 | loss: 0.2730722
	speed: 0.0086s/iter; left time: 152.2834s
	iters: 400, epoch: 4 | loss: 0.2933755
	speed: 0.0085s/iter; left time: 149.2926s
	iters: 500, epoch: 4 | loss: 0.3949095
	speed: 0.0074s/iter; left time: 129.4025s
	iters: 600, epoch: 4 | loss: 0.7717391
	speed: 0.0074s/iter; left time: 128.1150s
	iters: 700, epoch: 4 | loss: 0.4314626
	speed: 0.0075s/iter; left time: 128.9712s
	iters: 800, epoch: 4 | loss: 0.3923000
	speed: 0.0073s/iter; left time: 125.9759s
	iters: 900, epoch: 4 | loss: 0.1824137
	speed: 0.0088s/iter; left time: 150.2351s
	iters: 1000, epoch: 4 | loss: 0.2891162
	speed: 0.0077s/iter; left time: 130.4495s
Epoch: 4 cost time: 8.435474634170532
Epoch: 4, Steps: 1059 | Train Loss: 0.3950709 Vali Loss: 0.4791002 Test Loss: 1.1263286
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.4124357
	speed: 0.0322s/iter; left time: 541.8716s
	iters: 200, epoch: 5 | loss: 0.3070877
	speed: 0.0072s/iter; left time: 120.5259s
	iters: 300, epoch: 5 | loss: 0.1812395
	speed: 0.0075s/iter; left time: 124.5764s
	iters: 400, epoch: 5 | loss: 0.3880378
	speed: 0.0078s/iter; left time: 128.9279s
	iters: 500, epoch: 5 | loss: 0.3359238
	speed: 0.0092s/iter; left time: 150.8130s
	iters: 600, epoch: 5 | loss: 0.3043720
	speed: 0.0074s/iter; left time: 120.1766s
	iters: 700, epoch: 5 | loss: 0.3581033
	speed: 0.0069s/iter; left time: 111.6448s
	iters: 800, epoch: 5 | loss: 0.6341479
	speed: 0.0071s/iter; left time: 114.0288s
	iters: 900, epoch: 5 | loss: 0.2807347
	speed: 0.0080s/iter; left time: 127.9686s
	iters: 1000, epoch: 5 | loss: 0.3654552
	speed: 0.0071s/iter; left time: 113.2511s
Epoch: 5 cost time: 7.926447153091431
Epoch: 5, Steps: 1059 | Train Loss: 0.3733790 Vali Loss: 0.2350235 Test Loss: 0.3556300
Validation loss decreased (0.352516 --> 0.235023).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.5952844
	speed: 0.0324s/iter; left time: 510.8126s
	iters: 200, epoch: 6 | loss: 0.3448010
	speed: 0.0074s/iter; left time: 115.9696s
	iters: 300, epoch: 6 | loss: 0.6064363
	speed: 0.0088s/iter; left time: 137.3539s
	iters: 400, epoch: 6 | loss: 0.3404140
	speed: 0.0091s/iter; left time: 141.2795s
	iters: 500, epoch: 6 | loss: 0.6058453
	speed: 0.0086s/iter; left time: 131.6306s
	iters: 600, epoch: 6 | loss: 0.4869295
	speed: 0.0089s/iter; left time: 135.4497s
	iters: 700, epoch: 6 | loss: 0.4980098
	speed: 0.0094s/iter; left time: 143.1892s
	iters: 800, epoch: 6 | loss: 0.3545630
	speed: 0.0088s/iter; left time: 132.9462s
	iters: 900, epoch: 6 | loss: 0.2996436
	speed: 0.0091s/iter; left time: 137.0000s
	iters: 1000, epoch: 6 | loss: 0.2426526
	speed: 0.0087s/iter; left time: 129.2507s
Epoch: 6 cost time: 9.065807819366455
Epoch: 6, Steps: 1059 | Train Loss: 0.3619225 Vali Loss: 0.2706235 Test Loss: 0.4991760
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.3304503
	speed: 0.0344s/iter; left time: 506.2886s
	iters: 200, epoch: 7 | loss: 0.4258839
	speed: 0.0085s/iter; left time: 124.8897s
	iters: 300, epoch: 7 | loss: 0.4875945
	speed: 0.0072s/iter; left time: 105.2212s
	iters: 400, epoch: 7 | loss: 0.2160979
	speed: 0.0073s/iter; left time: 104.9122s
	iters: 500, epoch: 7 | loss: 0.2320059
	speed: 0.0082s/iter; left time: 117.3764s
	iters: 600, epoch: 7 | loss: 0.4003052
	speed: 0.0098s/iter; left time: 139.2981s
	iters: 700, epoch: 7 | loss: 0.3670952
	speed: 0.0089s/iter; left time: 125.5117s
	iters: 800, epoch: 7 | loss: 0.2249415
	speed: 0.0094s/iter; left time: 131.1940s
	iters: 900, epoch: 7 | loss: 0.2536813
	speed: 0.0084s/iter; left time: 117.6614s
	iters: 1000, epoch: 7 | loss: 0.5425960
	speed: 0.0087s/iter; left time: 120.4769s
Epoch: 7 cost time: 9.100712299346924
Epoch: 7, Steps: 1059 | Train Loss: 0.3556825 Vali Loss: 0.2698569 Test Loss: 0.4707154
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.3661823
	speed: 0.0334s/iter; left time: 456.6103s
	iters: 200, epoch: 8 | loss: 0.5708455
	speed: 0.0076s/iter; left time: 102.9021s
	iters: 300, epoch: 8 | loss: 0.4829473
	speed: 0.0085s/iter; left time: 114.0286s
	iters: 400, epoch: 8 | loss: 0.5127919
	speed: 0.0093s/iter; left time: 123.9578s
	iters: 500, epoch: 8 | loss: 0.2995241
	speed: 0.0100s/iter; left time: 132.7022s
	iters: 600, epoch: 8 | loss: 0.3040999
	speed: 0.0091s/iter; left time: 119.7310s
	iters: 700, epoch: 8 | loss: 0.4154125
	speed: 0.0088s/iter; left time: 115.5609s
	iters: 800, epoch: 8 | loss: 0.2960375
	speed: 0.0085s/iter; left time: 109.9821s
	iters: 900, epoch: 8 | loss: 0.2408112
	speed: 0.0088s/iter; left time: 113.2774s
	iters: 1000, epoch: 8 | loss: 0.4065067
	speed: 0.0095s/iter; left time: 121.4293s
Epoch: 8 cost time: 9.354649305343628
Epoch: 8, Steps: 1059 | Train Loss: 0.3517751 Vali Loss: 0.3150649 Test Loss: 0.6269419
EarlyStopping counter: 3 out of 5
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.1861354
	speed: 0.0366s/iter; left time: 461.5668s
	iters: 200, epoch: 9 | loss: 0.2943510
	speed: 0.0077s/iter; left time: 96.8549s
	iters: 300, epoch: 9 | loss: 0.5250127
	speed: 0.0086s/iter; left time: 107.0945s
	iters: 400, epoch: 9 | loss: 0.2023680
	speed: 0.0086s/iter; left time: 105.6446s
	iters: 500, epoch: 9 | loss: 0.3343559
	speed: 0.0086s/iter; left time: 104.4120s
	iters: 600, epoch: 9 | loss: 0.3161108
	speed: 0.0084s/iter; left time: 101.8174s
	iters: 700, epoch: 9 | loss: 0.3525390
	speed: 0.0091s/iter; left time: 109.4400s
	iters: 800, epoch: 9 | loss: 0.5942555
	speed: 0.0088s/iter; left time: 104.4054s
	iters: 900, epoch: 9 | loss: 0.2488125
	speed: 0.0087s/iter; left time: 102.4165s
	iters: 1000, epoch: 9 | loss: 0.5113519
	speed: 0.0077s/iter; left time: 89.5961s
Epoch: 9 cost time: 8.753382921218872
Epoch: 9, Steps: 1059 | Train Loss: 0.3502462 Vali Loss: 0.2715738 Test Loss: 0.4946053
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.7162384
	speed: 0.0309s/iter; left time: 357.3421s
	iters: 200, epoch: 10 | loss: 0.8025185
	speed: 0.0077s/iter; left time: 88.4146s
	iters: 300, epoch: 10 | loss: 0.4493903
	speed: 0.0068s/iter; left time: 77.2937s
	iters: 400, epoch: 10 | loss: 0.6590210
	speed: 0.0084s/iter; left time: 94.2395s
	iters: 500, epoch: 10 | loss: 0.5878137
	speed: 0.0075s/iter; left time: 84.0070s
	iters: 600, epoch: 10 | loss: 0.1908853
	speed: 0.0076s/iter; left time: 83.4567s
	iters: 700, epoch: 10 | loss: 0.2715733
	speed: 0.0079s/iter; left time: 86.0761s
	iters: 800, epoch: 10 | loss: 0.5155842
	speed: 0.0089s/iter; left time: 96.1209s
	iters: 900, epoch: 10 | loss: 0.3353797
	speed: 0.0082s/iter; left time: 87.6338s
	iters: 1000, epoch: 10 | loss: 0.4313073
	speed: 0.0080s/iter; left time: 85.3222s
Epoch: 10 cost time: 8.23750901222229
Epoch: 10, Steps: 1059 | Train Loss: 0.3494298 Vali Loss: 0.2714291 Test Loss: 0.4936370
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTm2_336_336_Linear_ETTm2_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15349<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
mse:0.35597485303878784, mae:0.38866469264030457
