Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='DLinear', model_id='weather_336_720', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=720, root_path='./dataset/', save_pred_values=False, seed=15349, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : weather_336_720_DLinear_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15349>>>>>>>>>>>>>>>>>>>>>>>>>>
train 35832
val 4551
test 9820
	iters: 100, epoch: 1 | loss: 1.2388293
	speed: 0.0961s/iter; left time: 4293.9757s
	iters: 200, epoch: 1 | loss: 1.5620760
	speed: 0.0959s/iter; left time: 4277.4922s
	iters: 300, epoch: 1 | loss: 0.9462095
	speed: 0.0911s/iter; left time: 4054.4070s
	iters: 400, epoch: 1 | loss: 0.6200676
	speed: 0.1021s/iter; left time: 4530.4601s
	iters: 500, epoch: 1 | loss: 0.4983832
	speed: 0.1015s/iter; left time: 4495.3318s
	iters: 600, epoch: 1 | loss: 2.1757667
	speed: 0.0991s/iter; left time: 4379.3595s
	iters: 700, epoch: 1 | loss: 0.6100116
	speed: 0.1007s/iter; left time: 4439.2853s
	iters: 800, epoch: 1 | loss: 0.6951379
	speed: 0.0973s/iter; left time: 4279.4128s
	iters: 900, epoch: 1 | loss: 0.7561622
	speed: 0.0937s/iter; left time: 4110.3412s
	iters: 1000, epoch: 1 | loss: 0.6014228
	speed: 0.0996s/iter; left time: 4360.1080s
	iters: 1100, epoch: 1 | loss: 1.2282481
	speed: 0.1026s/iter; left time: 4480.6363s
	iters: 1200, epoch: 1 | loss: 1.1287065
	speed: 0.0970s/iter; left time: 4227.5242s
	iters: 1300, epoch: 1 | loss: 0.8672955
	speed: 0.1003s/iter; left time: 4359.2540s
	iters: 1400, epoch: 1 | loss: 2.2203686
	speed: 0.0993s/iter; left time: 4306.4319s
	iters: 1500, epoch: 1 | loss: 0.6172336
	speed: 0.1009s/iter; left time: 4367.5679s
	iters: 1600, epoch: 1 | loss: 0.5190298
	speed: 0.1032s/iter; left time: 4454.1239s
	iters: 1700, epoch: 1 | loss: 0.6931772
	speed: 0.0918s/iter; left time: 3954.1323s
	iters: 1800, epoch: 1 | loss: 0.8973573
	speed: 0.0986s/iter; left time: 4237.4209s
	iters: 1900, epoch: 1 | loss: 0.7731740
	speed: 0.0958s/iter; left time: 4107.0330s
	iters: 2000, epoch: 1 | loss: 0.5729624
	speed: 0.0935s/iter; left time: 3999.8877s
	iters: 2100, epoch: 1 | loss: 0.7080200
	speed: 0.0970s/iter; left time: 4140.8791s
	iters: 2200, epoch: 1 | loss: 3.7745161
	speed: 0.0925s/iter; left time: 3939.8527s
Epoch: 1 cost time: 218.00052404403687
Epoch: 1, Steps: 2239 | Train Loss: 1.2097038 Vali Loss: 0.8102201 Test Loss: 0.3866907
Validation loss decreased (inf --> 0.810220).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.6654552
	speed: 0.2779s/iter; left time: 11795.0997s
	iters: 200, epoch: 2 | loss: 0.9383962
	speed: 0.0928s/iter; left time: 3927.7501s
	iters: 300, epoch: 2 | loss: 1.0681393
	speed: 0.0936s/iter; left time: 3955.5152s
	iters: 400, epoch: 2 | loss: 0.5175479
	speed: 0.1028s/iter; left time: 4330.8360s
	iters: 500, epoch: 2 | loss: 0.5857541
	speed: 0.0993s/iter; left time: 4175.0162s
	iters: 600, epoch: 2 | loss: 0.9473690
	speed: 0.0979s/iter; left time: 4106.8542s
	iters: 700, epoch: 2 | loss: 0.6732094
	speed: 0.0995s/iter; left time: 4165.3668s
	iters: 800, epoch: 2 | loss: 0.7276846
	speed: 0.0951s/iter; left time: 3970.4479s
	iters: 900, epoch: 2 | loss: 5.3366313
	speed: 0.0969s/iter; left time: 4033.7854s
	iters: 1000, epoch: 2 | loss: 1.1452569
	speed: 0.1044s/iter; left time: 4336.6050s
	iters: 1100, epoch: 2 | loss: 1.9077866
	speed: 0.0904s/iter; left time: 3747.3915s
	iters: 1200, epoch: 2 | loss: 1.1981144
	speed: 0.0959s/iter; left time: 3966.5378s
	iters: 1300, epoch: 2 | loss: 0.7748944
	speed: 0.0961s/iter; left time: 3961.6602s
	iters: 1400, epoch: 2 | loss: 0.5972373
	speed: 0.0942s/iter; left time: 3875.1452s
	iters: 1500, epoch: 2 | loss: 0.6044506
	speed: 0.0956s/iter; left time: 3924.9329s
	iters: 1600, epoch: 2 | loss: 2.5755603
	speed: 0.0960s/iter; left time: 3928.5496s
	iters: 1700, epoch: 2 | loss: 0.6256269
	speed: 0.0961s/iter; left time: 3923.3962s
	iters: 1800, epoch: 2 | loss: 0.7798709
	speed: 0.0935s/iter; left time: 3807.6952s
	iters: 1900, epoch: 2 | loss: 0.6117049
	speed: 0.0983s/iter; left time: 3995.3953s
	iters: 2000, epoch: 2 | loss: 0.8393070
	speed: 0.0958s/iter; left time: 3882.1726s
	iters: 2100, epoch: 2 | loss: 0.7823601
	speed: 0.0963s/iter; left time: 3894.1613s
	iters: 2200, epoch: 2 | loss: 1.1733016
	speed: 0.0910s/iter; left time: 3672.3842s
Epoch: 2 cost time: 214.24335741996765
Epoch: 2, Steps: 2239 | Train Loss: 1.2427052 Vali Loss: 0.8662060 Test Loss: 0.4444821
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 4.1026354
	speed: 0.2722s/iter; left time: 10941.3275s
	iters: 200, epoch: 3 | loss: 2.0092397
	speed: 0.0983s/iter; left time: 3943.9459s
	iters: 300, epoch: 3 | loss: 0.5422763
	speed: 0.0991s/iter; left time: 3963.4858s
	iters: 400, epoch: 3 | loss: 0.6120397
	speed: 0.0942s/iter; left time: 3757.3864s
	iters: 500, epoch: 3 | loss: 25.2331390
	speed: 0.0942s/iter; left time: 3750.2284s
	iters: 600, epoch: 3 | loss: 1.7789127
	speed: 0.0984s/iter; left time: 3904.8486s
	iters: 700, epoch: 3 | loss: 0.5424806
	speed: 0.1010s/iter; left time: 3998.6264s
	iters: 800, epoch: 3 | loss: 2.3767574
	speed: 0.0986s/iter; left time: 3894.9300s
	iters: 900, epoch: 3 | loss: 0.4854368
	speed: 0.1019s/iter; left time: 4016.0833s
	iters: 1000, epoch: 3 | loss: 0.6039774
	speed: 0.0947s/iter; left time: 3722.4027s
	iters: 1100, epoch: 3 | loss: 1.0062714
	speed: 0.1017s/iter; left time: 3988.2126s
	iters: 1200, epoch: 3 | loss: 0.5520293
	speed: 0.0951s/iter; left time: 3720.1178s
	iters: 1300, epoch: 3 | loss: 0.7688723
	speed: 0.0964s/iter; left time: 3761.3294s
	iters: 1400, epoch: 3 | loss: 0.7014660
	speed: 0.0951s/iter; left time: 3700.5448s
	iters: 1500, epoch: 3 | loss: 0.6025736
	speed: 0.0942s/iter; left time: 3654.0521s
	iters: 1600, epoch: 3 | loss: 0.6640388
	speed: 0.0974s/iter; left time: 3768.3729s
	iters: 1700, epoch: 3 | loss: 0.5789464
	speed: 0.0917s/iter; left time: 3538.3270s
	iters: 1800, epoch: 3 | loss: 2.0863876
	speed: 0.0990s/iter; left time: 3812.9158s
	iters: 1900, epoch: 3 | loss: 1.9995708
	speed: 0.0985s/iter; left time: 3782.1181s
	iters: 2000, epoch: 3 | loss: 1.6203599
	speed: 0.0986s/iter; left time: 3776.1779s
	iters: 2100, epoch: 3 | loss: 0.7071574
	speed: 0.0998s/iter; left time: 3811.5058s
	iters: 2200, epoch: 3 | loss: 0.5688150
	speed: 0.0841s/iter; left time: 3205.7281s
Epoch: 3 cost time: 215.09976053237915
Epoch: 3, Steps: 2239 | Train Loss: 0.8407413 Vali Loss: 0.6761881 Test Loss: 0.3556637
Validation loss decreased (0.810220 --> 0.676188).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.5744018
	speed: 0.2874s/iter; left time: 10911.9352s
	iters: 200, epoch: 4 | loss: 0.7766685
	speed: 0.0966s/iter; left time: 3657.1956s
	iters: 300, epoch: 4 | loss: 0.6621454
	speed: 0.0969s/iter; left time: 3659.8586s
	iters: 400, epoch: 4 | loss: 0.6465476
	speed: 0.0977s/iter; left time: 3680.3277s
	iters: 500, epoch: 4 | loss: 0.5457972
	speed: 0.0961s/iter; left time: 3611.2704s
	iters: 600, epoch: 4 | loss: 0.4466325
	speed: 0.1006s/iter; left time: 3767.0290s
	iters: 700, epoch: 4 | loss: 0.6210058
	speed: 0.0949s/iter; left time: 3545.7712s
	iters: 800, epoch: 4 | loss: 0.8978004
	speed: 0.0964s/iter; left time: 3591.6157s
	iters: 900, epoch: 4 | loss: 0.5727617
	speed: 0.0929s/iter; left time: 3450.9896s
	iters: 1000, epoch: 4 | loss: 0.6046019
	speed: 0.0987s/iter; left time: 3659.9192s
	iters: 1100, epoch: 4 | loss: 0.4690422
	speed: 0.0944s/iter; left time: 3488.7551s
	iters: 1200, epoch: 4 | loss: 0.4891911
	speed: 0.0947s/iter; left time: 3489.2650s
	iters: 1300, epoch: 4 | loss: 0.8220898
	speed: 0.0953s/iter; left time: 3505.1617s
	iters: 1400, epoch: 4 | loss: 1.0205977
	speed: 0.0965s/iter; left time: 3538.2039s
	iters: 1500, epoch: 4 | loss: 0.4823513
	speed: 0.0948s/iter; left time: 3465.8713s
	iters: 1600, epoch: 4 | loss: 0.4096618
	speed: 0.0985s/iter; left time: 3592.1114s
	iters: 1700, epoch: 4 | loss: 0.6932511
	speed: 0.1020s/iter; left time: 3709.3158s
	iters: 1800, epoch: 4 | loss: 0.4100704
	speed: 0.0935s/iter; left time: 3391.9517s
	iters: 1900, epoch: 4 | loss: 0.4267266
	speed: 0.0965s/iter; left time: 3490.4366s
	iters: 2000, epoch: 4 | loss: 0.6831585
	speed: 0.0996s/iter; left time: 3592.0822s
	iters: 2100, epoch: 4 | loss: 1.0216866
	speed: 0.0962s/iter; left time: 3460.9518s
	iters: 2200, epoch: 4 | loss: 0.4447458
	speed: 0.0806s/iter; left time: 2890.7861s
Epoch: 4 cost time: 213.8466396331787
Epoch: 4, Steps: 2239 | Train Loss: 0.6413664 Vali Loss: 0.6410328 Test Loss: 0.3331066
Validation loss decreased (0.676188 --> 0.641033).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.9816855
	speed: 0.2879s/iter; left time: 10283.8600s
	iters: 200, epoch: 5 | loss: 0.4824731
	speed: 0.0987s/iter; left time: 3517.4040s
	iters: 300, epoch: 5 | loss: 0.4692433
	speed: 0.0965s/iter; left time: 3429.3491s
	iters: 400, epoch: 5 | loss: 0.5121796
	speed: 0.0962s/iter; left time: 3406.3143s
	iters: 500, epoch: 5 | loss: 0.4648013
	speed: 0.0982s/iter; left time: 3470.0982s
	iters: 600, epoch: 5 | loss: 0.4763584
	speed: 0.1007s/iter; left time: 3546.9558s
	iters: 700, epoch: 5 | loss: 0.4761945
	speed: 0.0967s/iter; left time: 3397.2191s
	iters: 800, epoch: 5 | loss: 0.9570562
	speed: 0.0950s/iter; left time: 3326.6578s
	iters: 900, epoch: 5 | loss: 0.4887660
	speed: 0.0961s/iter; left time: 3355.1218s
	iters: 1000, epoch: 5 | loss: 0.5263999
	speed: 0.0971s/iter; left time: 3380.1361s
	iters: 1100, epoch: 5 | loss: 0.5992232
	speed: 0.0888s/iter; left time: 3084.7422s
	iters: 1200, epoch: 5 | loss: 0.5092065
	speed: 0.1015s/iter; left time: 3515.3946s
	iters: 1300, epoch: 5 | loss: 0.4231324
	speed: 0.0947s/iter; left time: 3269.1760s
	iters: 1400, epoch: 5 | loss: 0.3545512
	speed: 0.0965s/iter; left time: 3320.9276s
	iters: 1500, epoch: 5 | loss: 0.4375921
	speed: 0.1044s/iter; left time: 3582.1746s
	iters: 1600, epoch: 5 | loss: 0.6028643
	speed: 0.0981s/iter; left time: 3356.4553s
	iters: 1700, epoch: 5 | loss: 0.9074088
	speed: 0.0999s/iter; left time: 3410.7529s
	iters: 1800, epoch: 5 | loss: 0.7205945
	speed: 0.0937s/iter; left time: 3188.2356s
	iters: 1900, epoch: 5 | loss: 0.4271991
	speed: 0.0929s/iter; left time: 3150.9171s
	iters: 2000, epoch: 5 | loss: 0.4372892
	speed: 0.0960s/iter; left time: 3247.5088s
	iters: 2100, epoch: 5 | loss: 0.8229690
	speed: 0.0898s/iter; left time: 3029.7927s
	iters: 2200, epoch: 5 | loss: 0.5040651
	speed: 0.0819s/iter; left time: 2754.5345s
Epoch: 5 cost time: 213.25862002372742
Epoch: 5, Steps: 2239 | Train Loss: 0.5878444 Vali Loss: 0.6245604 Test Loss: 0.3330266
Validation loss decreased (0.641033 --> 0.624560).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.4308913
	speed: 0.2952s/iter; left time: 9884.1888s
	iters: 200, epoch: 6 | loss: 0.3991416
	speed: 0.0966s/iter; left time: 3223.9556s
	iters: 300, epoch: 6 | loss: 0.3900357
	speed: 0.0975s/iter; left time: 3243.8120s
	iters: 400, epoch: 6 | loss: 0.5459363
	speed: 0.0978s/iter; left time: 3246.4029s
	iters: 500, epoch: 6 | loss: 0.4989239
	speed: 0.0942s/iter; left time: 3117.3134s
	iters: 600, epoch: 6 | loss: 0.7727786
	speed: 0.0936s/iter; left time: 3086.1367s
	iters: 700, epoch: 6 | loss: 0.4242503
	speed: 0.1008s/iter; left time: 3316.0254s
	iters: 800, epoch: 6 | loss: 0.4050410
	speed: 0.0955s/iter; left time: 3130.7042s
	iters: 900, epoch: 6 | loss: 0.9008794
	speed: 0.0960s/iter; left time: 3137.8335s
	iters: 1000, epoch: 6 | loss: 0.9349498
	speed: 0.0991s/iter; left time: 3230.6437s
	iters: 1100, epoch: 6 | loss: 0.6029800
	speed: 0.0970s/iter; left time: 3152.3286s
	iters: 1200, epoch: 6 | loss: 0.5576457
	speed: 0.0971s/iter; left time: 3146.2338s
	iters: 1300, epoch: 6 | loss: 0.5512448
	speed: 0.0910s/iter; left time: 2939.2649s
	iters: 1400, epoch: 6 | loss: 0.7436692
	speed: 0.0931s/iter; left time: 2997.2102s
	iters: 1500, epoch: 6 | loss: 0.4712960
	speed: 0.0932s/iter; left time: 2989.9976s
	iters: 1600, epoch: 6 | loss: 0.5397328
	speed: 0.0996s/iter; left time: 3184.6243s
	iters: 1700, epoch: 6 | loss: 0.4225372
	speed: 0.0891s/iter; left time: 2841.9519s
	iters: 1800, epoch: 6 | loss: 0.4758715
	speed: 0.0912s/iter; left time: 2899.4172s
	iters: 1900, epoch: 6 | loss: 0.4186004
	speed: 0.0999s/iter; left time: 3165.7797s
	iters: 2000, epoch: 6 | loss: 0.4667007
	speed: 0.0947s/iter; left time: 2990.5135s
	iters: 2100, epoch: 6 | loss: 0.4263585
	speed: 0.0957s/iter; left time: 3014.2388s
	iters: 2200, epoch: 6 | loss: 0.7266947
	speed: 0.0792s/iter; left time: 2485.5800s
Epoch: 6 cost time: 210.98672366142273
Epoch: 6, Steps: 2239 | Train Loss: 0.5681430 Vali Loss: 0.6069630 Test Loss: 0.3218392
Validation loss decreased (0.624560 --> 0.606963).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.5016557
	speed: 0.2938s/iter; left time: 9179.5994s
	iters: 200, epoch: 7 | loss: 0.4874968
	speed: 0.0958s/iter; left time: 2984.0398s
	iters: 300, epoch: 7 | loss: 0.6278681
	speed: 0.0953s/iter; left time: 2959.9252s
	iters: 400, epoch: 7 | loss: 0.5575101
	speed: 0.0982s/iter; left time: 3038.6161s
	iters: 500, epoch: 7 | loss: 0.4475373
	speed: 0.0980s/iter; left time: 3021.8360s
	iters: 600, epoch: 7 | loss: 0.5653431
	speed: 0.0968s/iter; left time: 2975.9106s
	iters: 700, epoch: 7 | loss: 0.5096184
	speed: 0.1011s/iter; left time: 3099.1993s
	iters: 800, epoch: 7 | loss: 0.5181484
	speed: 0.1008s/iter; left time: 3079.5351s
	iters: 900, epoch: 7 | loss: 0.6061997
	speed: 0.1005s/iter; left time: 3059.9743s
	iters: 1000, epoch: 7 | loss: 0.5328981
	speed: 0.0995s/iter; left time: 3019.8225s
	iters: 1100, epoch: 7 | loss: 0.5153582
	speed: 0.1004s/iter; left time: 3035.9447s
	iters: 1200, epoch: 7 | loss: 0.6724824
	speed: 0.0908s/iter; left time: 2737.1701s
	iters: 1300, epoch: 7 | loss: 0.5467476
	speed: 0.0971s/iter; left time: 2918.9762s
	iters: 1400, epoch: 7 | loss: 0.6649863
	speed: 0.1017s/iter; left time: 3046.8106s
	iters: 1500, epoch: 7 | loss: 0.5674435
	speed: 0.1007s/iter; left time: 3004.8833s
	iters: 1600, epoch: 7 | loss: 0.5007409
	speed: 0.0940s/iter; left time: 2794.7427s
	iters: 1700, epoch: 7 | loss: 0.6110435
	speed: 0.0973s/iter; left time: 2884.7485s
	iters: 1800, epoch: 7 | loss: 0.4769800
	speed: 0.0951s/iter; left time: 2808.4551s
	iters: 1900, epoch: 7 | loss: 0.4379826
	speed: 0.0984s/iter; left time: 2896.2446s
	iters: 2000, epoch: 7 | loss: 0.6150727
	speed: 0.0960s/iter; left time: 2816.3246s
	iters: 2100, epoch: 7 | loss: 0.3985425
	speed: 0.0950s/iter; left time: 2779.6820s
	iters: 2200, epoch: 7 | loss: 0.4430413
	speed: 0.0711s/iter; left time: 2073.3895s
Epoch: 7 cost time: 214.016037940979
Epoch: 7, Steps: 2239 | Train Loss: 0.5594053 Vali Loss: 0.5917471 Test Loss: 0.3166673
Validation loss decreased (0.606963 --> 0.591747).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.6956004
	speed: 0.3083s/iter; left time: 8944.1474s
	iters: 200, epoch: 8 | loss: 0.4533171
	speed: 0.0988s/iter; left time: 2854.9028s
	iters: 300, epoch: 8 | loss: 0.4891034
	speed: 0.0959s/iter; left time: 2763.6700s
	iters: 400, epoch: 8 | loss: 0.4010728
	speed: 0.0954s/iter; left time: 2738.8928s
	iters: 500, epoch: 8 | loss: 0.3730313
	speed: 0.0967s/iter; left time: 2767.5608s
	iters: 600, epoch: 8 | loss: 0.4341397
	speed: 0.1006s/iter; left time: 2866.8914s
	iters: 700, epoch: 8 | loss: 0.4116323
	speed: 0.1001s/iter; left time: 2844.2962s
	iters: 800, epoch: 8 | loss: 0.5050669
	speed: 0.0945s/iter; left time: 2674.5639s
	iters: 900, epoch: 8 | loss: 0.4958199
	speed: 0.0989s/iter; left time: 2788.3848s
	iters: 1000, epoch: 8 | loss: 0.7130426
	speed: 0.0985s/iter; left time: 2769.1210s
	iters: 1100, epoch: 8 | loss: 0.8335904
	speed: 0.1009s/iter; left time: 2826.1412s
	iters: 1200, epoch: 8 | loss: 0.4820044
	speed: 0.0978s/iter; left time: 2728.5645s
	iters: 1300, epoch: 8 | loss: 0.3238248
	speed: 0.0950s/iter; left time: 2642.2812s
	iters: 1400, epoch: 8 | loss: 0.7731803
	speed: 0.0998s/iter; left time: 2765.5372s
	iters: 1500, epoch: 8 | loss: 0.4308932
	speed: 0.0977s/iter; left time: 2696.8266s
	iters: 1600, epoch: 8 | loss: 0.4968275
	speed: 0.0975s/iter; left time: 2682.0960s
	iters: 1700, epoch: 8 | loss: 0.5551426
	speed: 0.0974s/iter; left time: 2670.0378s
	iters: 1800, epoch: 8 | loss: 0.5373029
	speed: 0.1042s/iter; left time: 2846.6971s
	iters: 1900, epoch: 8 | loss: 0.3708577
	speed: 0.0973s/iter; left time: 2646.0601s
	iters: 2000, epoch: 8 | loss: 0.4619676
	speed: 0.0947s/iter; left time: 2565.8667s
	iters: 2100, epoch: 8 | loss: 0.4471031
	speed: 0.0784s/iter; left time: 2117.6565s
	iters: 2200, epoch: 8 | loss: 0.4488526
	speed: 0.0667s/iter; left time: 1796.0811s
Epoch: 8 cost time: 212.72191262245178
Epoch: 8, Steps: 2239 | Train Loss: 0.5551698 Vali Loss: 0.5919695 Test Loss: 0.3161537
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.9173177
	speed: 0.3137s/iter; left time: 8396.4099s
	iters: 200, epoch: 9 | loss: 0.7348170
	speed: 0.0934s/iter; left time: 2489.8299s
	iters: 300, epoch: 9 | loss: 0.5838178
	speed: 0.1009s/iter; left time: 2681.0078s
	iters: 400, epoch: 9 | loss: 0.4373294
	speed: 0.0974s/iter; left time: 2577.2636s
	iters: 500, epoch: 9 | loss: 0.4611483
	speed: 0.0935s/iter; left time: 2464.8793s
	iters: 600, epoch: 9 | loss: 0.6517553
	speed: 0.0944s/iter; left time: 2480.3221s
	iters: 700, epoch: 9 | loss: 0.4702821
	speed: 0.0891s/iter; left time: 2331.2659s
	iters: 800, epoch: 9 | loss: 0.6176692
	speed: 0.0944s/iter; left time: 2460.5913s
	iters: 900, epoch: 9 | loss: 0.5722547
	speed: 0.1023s/iter; left time: 2657.1744s
	iters: 1000, epoch: 9 | loss: 0.5580276
	speed: 0.0961s/iter; left time: 2486.3922s
	iters: 1100, epoch: 9 | loss: 0.6561912
	speed: 0.1001s/iter; left time: 2578.7388s
	iters: 1200, epoch: 9 | loss: 0.6622590
	speed: 0.0948s/iter; left time: 2433.1917s
	iters: 1300, epoch: 9 | loss: 0.4431759
	speed: 0.0949s/iter; left time: 2427.1902s
	iters: 1400, epoch: 9 | loss: 0.4169419
	speed: 0.0990s/iter; left time: 2520.9629s
	iters: 1500, epoch: 9 | loss: 0.8408683
	speed: 0.0972s/iter; left time: 2465.9227s
	iters: 1600, epoch: 9 | loss: 0.8711342
	speed: 0.1004s/iter; left time: 2537.1401s
	iters: 1700, epoch: 9 | loss: 0.7186142
	speed: 0.0964s/iter; left time: 2425.4933s
	iters: 1800, epoch: 9 | loss: 0.6852401
	speed: 0.0961s/iter; left time: 2409.5563s
	iters: 1900, epoch: 9 | loss: 0.4849727
	speed: 0.0947s/iter; left time: 2364.0888s
	iters: 2000, epoch: 9 | loss: 0.4590348
	speed: 0.0951s/iter; left time: 2364.5950s
	iters: 2100, epoch: 9 | loss: 0.5830317
	speed: 0.0751s/iter; left time: 1861.3689s
	iters: 2200, epoch: 9 | loss: 0.3722291
	speed: 0.0668s/iter; left time: 1647.6944s
Epoch: 9 cost time: 208.70012545585632
Epoch: 9, Steps: 2239 | Train Loss: 0.5531226 Vali Loss: 0.5924064 Test Loss: 0.3182189
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.4331136
	speed: 0.3284s/iter; left time: 8056.1359s
	iters: 200, epoch: 10 | loss: 0.4263716
	speed: 0.0977s/iter; left time: 2386.8821s
	iters: 300, epoch: 10 | loss: 0.4839320
	speed: 0.0932s/iter; left time: 2268.4224s
	iters: 400, epoch: 10 | loss: 0.6936432
	speed: 0.0984s/iter; left time: 2384.4342s
	iters: 500, epoch: 10 | loss: 0.9048307
	speed: 0.0993s/iter; left time: 2397.2097s
	iters: 600, epoch: 10 | loss: 0.6815200
	speed: 0.0981s/iter; left time: 2358.4810s
	iters: 700, epoch: 10 | loss: 0.5251017
	speed: 0.0943s/iter; left time: 2257.3565s
	iters: 800, epoch: 10 | loss: 0.4949723
	speed: 0.0994s/iter; left time: 2369.2778s
	iters: 900, epoch: 10 | loss: 0.4635945
	speed: 0.0929s/iter; left time: 2203.8548s
	iters: 1000, epoch: 10 | loss: 0.5943755
	speed: 0.0952s/iter; left time: 2248.8583s
	iters: 1100, epoch: 10 | loss: 0.3975291
	speed: 0.0949s/iter; left time: 2233.5533s
	iters: 1200, epoch: 10 | loss: 0.4550253
	speed: 0.1004s/iter; left time: 2353.5153s
	iters: 1300, epoch: 10 | loss: 0.4892820
	speed: 0.1015s/iter; left time: 2367.6353s
	iters: 1400, epoch: 10 | loss: 0.8788009
	speed: 0.0980s/iter; left time: 2276.1728s
	iters: 1500, epoch: 10 | loss: 0.8489695
	speed: 0.0950s/iter; left time: 2197.8943s
	iters: 1600, epoch: 10 | loss: 0.4567848
	speed: 0.1000s/iter; left time: 2303.2780s
	iters: 1700, epoch: 10 | loss: 0.7310181
	speed: 0.0990s/iter; left time: 2269.9450s
	iters: 1800, epoch: 10 | loss: 0.7055371
	speed: 0.0962s/iter; left time: 2196.8761s
	iters: 1900, epoch: 10 | loss: 0.5801662
	speed: 0.0956s/iter; left time: 2171.9235s
	iters: 2000, epoch: 10 | loss: 0.6538523
	speed: 0.0919s/iter; left time: 2080.1545s
	iters: 2100, epoch: 10 | loss: 0.4269048
	speed: 0.0717s/iter; left time: 1615.6906s
	iters: 2200, epoch: 10 | loss: 0.6688958
	speed: 0.0694s/iter; left time: 1555.8976s
Epoch: 10 cost time: 210.48058795928955
Epoch: 10, Steps: 2239 | Train Loss: 0.5520653 Vali Loss: 0.5912849 Test Loss: 0.3179976
Validation loss decreased (0.591747 --> 0.591285).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.7404152
	speed: 0.3404s/iter; left time: 7587.1013s
	iters: 200, epoch: 11 | loss: 0.3716233
	speed: 0.0935s/iter; left time: 2073.8085s
	iters: 300, epoch: 11 | loss: 0.6606582
	speed: 0.0958s/iter; left time: 2115.3703s
	iters: 400, epoch: 11 | loss: 0.6892709
	speed: 0.0968s/iter; left time: 2129.1020s
	iters: 500, epoch: 11 | loss: 0.6478148
	speed: 0.0994s/iter; left time: 2177.0173s
	iters: 600, epoch: 11 | loss: 0.5922028
	speed: 0.0988s/iter; left time: 2152.9233s
	iters: 700, epoch: 11 | loss: 0.4694379
	speed: 0.0948s/iter; left time: 2056.8673s
	iters: 800, epoch: 11 | loss: 0.7091269
	speed: 0.0956s/iter; left time: 2063.0366s
	iters: 900, epoch: 11 | loss: 0.5575011
	speed: 0.0912s/iter; left time: 1958.9848s
	iters: 1000, epoch: 11 | loss: 0.4989850
	speed: 0.1008s/iter; left time: 2155.2540s
	iters: 1100, epoch: 11 | loss: 0.3948835
	speed: 0.1029s/iter; left time: 2191.8569s
	iters: 1200, epoch: 11 | loss: 0.5084047
	speed: 0.0957s/iter; left time: 2028.8221s
	iters: 1300, epoch: 11 | loss: 0.4635813
	speed: 0.0968s/iter; left time: 2042.4632s
	iters: 1400, epoch: 11 | loss: 0.6999586
	speed: 0.1002s/iter; left time: 2103.1669s
	iters: 1500, epoch: 11 | loss: 0.4296959
	speed: 0.0974s/iter; left time: 2035.3045s
	iters: 1600, epoch: 11 | loss: 0.5617648
	speed: 0.0957s/iter; left time: 1988.9465s
	iters: 1700, epoch: 11 | loss: 0.4606421
	speed: 0.0985s/iter; left time: 2038.3444s
	iters: 1800, epoch: 11 | loss: 0.4624823
	speed: 0.1031s/iter; left time: 2123.0742s
	iters: 1900, epoch: 11 | loss: 0.5597228
	speed: 0.1007s/iter; left time: 2062.5244s
	iters: 2000, epoch: 11 | loss: 0.7085115
	speed: 0.0822s/iter; left time: 1675.5073s
	iters: 2100, epoch: 11 | loss: 0.6892267
	speed: 0.0708s/iter; left time: 1436.0187s
	iters: 2200, epoch: 11 | loss: 0.4574225
	speed: 0.0681s/iter; left time: 1374.6358s
Epoch: 11 cost time: 210.5746693611145
Epoch: 11, Steps: 2239 | Train Loss: 0.5515250 Vali Loss: 0.5914655 Test Loss: 0.3169542
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.5286726
	speed: 0.3343s/iter; left time: 6703.4078s
	iters: 200, epoch: 12 | loss: 0.6315099
	speed: 0.0983s/iter; left time: 1960.9873s
	iters: 300, epoch: 12 | loss: 0.4119298
	speed: 0.0960s/iter; left time: 1906.3896s
	iters: 400, epoch: 12 | loss: 0.3893484
	speed: 0.0915s/iter; left time: 1806.9091s
	iters: 500, epoch: 12 | loss: 0.5493829
	speed: 0.1015s/iter; left time: 1993.9038s
	iters: 600, epoch: 12 | loss: 0.4575334
	speed: 0.0973s/iter; left time: 1903.1031s
	iters: 700, epoch: 12 | loss: 0.5498127
	speed: 0.0959s/iter; left time: 1865.3506s
	iters: 800, epoch: 12 | loss: 0.5674623
	speed: 0.0962s/iter; left time: 1860.8776s
	iters: 900, epoch: 12 | loss: 0.4117000
	speed: 0.1007s/iter; left time: 1939.0168s
	iters: 1000, epoch: 12 | loss: 0.4092109
	speed: 0.0988s/iter; left time: 1892.4489s
	iters: 1100, epoch: 12 | loss: 0.3869394
	speed: 0.0962s/iter; left time: 1833.3769s
	iters: 1200, epoch: 12 | loss: 0.6090539
	speed: 0.0978s/iter; left time: 1854.3796s
	iters: 1300, epoch: 12 | loss: 0.4910599
	speed: 0.0978s/iter; left time: 1843.8411s
	iters: 1400, epoch: 12 | loss: 0.4618947
	speed: 0.0966s/iter; left time: 1812.0402s
	iters: 1500, epoch: 12 | loss: 0.8088974
	speed: 0.0960s/iter; left time: 1790.9976s
	iters: 1600, epoch: 12 | loss: 0.5146940
	speed: 0.0919s/iter; left time: 1704.6287s
	iters: 1700, epoch: 12 | loss: 0.4919343
	speed: 0.0993s/iter; left time: 1832.0933s
	iters: 1800, epoch: 12 | loss: 0.7362117
	speed: 0.0969s/iter; left time: 1778.3891s
	iters: 1900, epoch: 12 | loss: 0.4822436
	speed: 0.0941s/iter; left time: 1717.9107s
	iters: 2000, epoch: 12 | loss: 0.4368368
	speed: 0.0803s/iter; left time: 1458.2498s
	iters: 2100, epoch: 12 | loss: 0.7450969
	speed: 0.0722s/iter; left time: 1303.7654s
	iters: 2200, epoch: 12 | loss: 0.7305323
	speed: 0.0676s/iter; left time: 1212.8132s
Epoch: 12 cost time: 208.6981828212738
Epoch: 12, Steps: 2239 | Train Loss: 0.5512313 Vali Loss: 0.5927005 Test Loss: 0.3164455
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.4067360
	speed: 0.3385s/iter; left time: 6030.4897s
	iters: 200, epoch: 13 | loss: 0.7105063
	speed: 0.0958s/iter; left time: 1697.0882s
	iters: 300, epoch: 13 | loss: 0.6325487
	speed: 0.0953s/iter; left time: 1679.0844s
	iters: 400, epoch: 13 | loss: 0.4586057
	speed: 0.0936s/iter; left time: 1638.6678s
	iters: 500, epoch: 13 | loss: 0.4814248
	speed: 0.0920s/iter; left time: 1602.3868s
	iters: 600, epoch: 13 | loss: 0.5401567
	speed: 0.0944s/iter; left time: 1633.5125s
	iters: 700, epoch: 13 | loss: 0.5483750
	speed: 0.0946s/iter; left time: 1628.4325s
	iters: 800, epoch: 13 | loss: 0.7217441
	speed: 0.0959s/iter; left time: 1641.2104s
	iters: 900, epoch: 13 | loss: 0.4489916
	speed: 0.0934s/iter; left time: 1589.4920s
	iters: 1000, epoch: 13 | loss: 0.5233874
	speed: 0.0953s/iter; left time: 1612.2504s
	iters: 1100, epoch: 13 | loss: 0.4773186
	speed: 0.0953s/iter; left time: 1601.6588s
	iters: 1200, epoch: 13 | loss: 0.5775647
	speed: 0.0958s/iter; left time: 1600.6766s
	iters: 1300, epoch: 13 | loss: 0.6203417
	speed: 0.0963s/iter; left time: 1599.9493s
	iters: 1400, epoch: 13 | loss: 0.5196895
	speed: 0.0890s/iter; left time: 1470.3798s
	iters: 1500, epoch: 13 | loss: 0.6622376
	speed: 0.0877s/iter; left time: 1438.8824s
	iters: 1600, epoch: 13 | loss: 0.4485846
	speed: 0.0936s/iter; left time: 1527.3169s
	iters: 1700, epoch: 13 | loss: 0.5934919
	speed: 0.0866s/iter; left time: 1403.7706s
	iters: 1800, epoch: 13 | loss: 0.4093173
	speed: 0.0883s/iter; left time: 1422.4600s
	iters: 1900, epoch: 13 | loss: 0.4049276
	speed: 0.0785s/iter; left time: 1256.7615s
	iters: 2000, epoch: 13 | loss: 0.4354373
	speed: 0.0708s/iter; left time: 1126.5090s
	iters: 2100, epoch: 13 | loss: 0.4798107
	speed: 0.0673s/iter; left time: 1064.8234s
	iters: 2200, epoch: 13 | loss: 0.5908201
	speed: 0.0705s/iter; left time: 1108.1095s
Epoch: 13 cost time: 199.03868293762207
Epoch: 13, Steps: 2239 | Train Loss: 0.5510226 Vali Loss: 0.5916518 Test Loss: 0.3164039
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.5466416
	speed: 0.2977s/iter; left time: 4636.0542s
	iters: 200, epoch: 14 | loss: 0.5035667
	speed: 0.0812s/iter; left time: 1256.1187s
	iters: 300, epoch: 14 | loss: 0.5265687
	speed: 0.0780s/iter; left time: 1198.9998s
	iters: 400, epoch: 14 | loss: 0.6429852
	speed: 0.0772s/iter; left time: 1179.8773s
	iters: 500, epoch: 14 | loss: 0.4916029
	speed: 0.0777s/iter; left time: 1179.1186s
	iters: 600, epoch: 14 | loss: 0.5473572
	speed: 0.0796s/iter; left time: 1199.5359s
	iters: 700, epoch: 14 | loss: 0.4687356
	speed: 0.0755s/iter; left time: 1130.6480s
	iters: 800, epoch: 14 | loss: 0.7923273
	speed: 0.0762s/iter; left time: 1134.1059s
	iters: 900, epoch: 14 | loss: 0.7601086
	speed: 0.0765s/iter; left time: 1129.5479s
	iters: 1000, epoch: 14 | loss: 0.4692972
	speed: 0.0743s/iter; left time: 1090.1270s
	iters: 1100, epoch: 14 | loss: 0.8181926
	speed: 0.0795s/iter; left time: 1159.1663s
	iters: 1200, epoch: 14 | loss: 0.7335299
	speed: 0.0759s/iter; left time: 1099.1359s
	iters: 1300, epoch: 14 | loss: 0.3991513
	speed: 0.0808s/iter; left time: 1161.1044s
	iters: 1400, epoch: 14 | loss: 0.8569279
	speed: 0.0797s/iter; left time: 1137.1840s
	iters: 1500, epoch: 14 | loss: 0.7649686
	speed: 0.0768s/iter; left time: 1088.5645s
	iters: 1600, epoch: 14 | loss: 0.4763065
	speed: 0.0767s/iter; left time: 1079.7534s
	iters: 1700, epoch: 14 | loss: 0.3725677
	speed: 0.0762s/iter; left time: 1065.5096s
	iters: 1800, epoch: 14 | loss: 0.5396097
	speed: 0.0729s/iter; left time: 1011.8331s
	iters: 1900, epoch: 14 | loss: 0.3839173
	speed: 0.0683s/iter; left time: 940.1218s
	iters: 2000, epoch: 14 | loss: 0.4584441
	speed: 0.0624s/iter; left time: 853.3877s
	iters: 2100, epoch: 14 | loss: 0.5176444
	speed: 0.0617s/iter; left time: 838.0992s
	iters: 2200, epoch: 14 | loss: 0.4946498
	speed: 0.0640s/iter; left time: 862.0277s
Epoch: 14 cost time: 167.53419423103333
Epoch: 14, Steps: 2239 | Train Loss: 0.5509980 Vali Loss: 0.5924067 Test Loss: 0.3164930
EarlyStopping counter: 4 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.4292349
	speed: 0.2540s/iter; left time: 3387.4549s
	iters: 200, epoch: 15 | loss: 0.4409743
	speed: 0.0682s/iter; left time: 902.6017s
	iters: 300, epoch: 15 | loss: 0.6262907
	speed: 0.0672s/iter; left time: 882.4361s
	iters: 400, epoch: 15 | loss: 0.6546596
	speed: 0.0675s/iter; left time: 879.7971s
	iters: 500, epoch: 15 | loss: 0.4271660
	speed: 0.0678s/iter; left time: 876.5794s
	iters: 600, epoch: 15 | loss: 0.5645894
	speed: 0.0674s/iter; left time: 864.9959s
	iters: 700, epoch: 15 | loss: 0.4646274
	speed: 0.0676s/iter; left time: 860.8599s
	iters: 800, epoch: 15 | loss: 0.5087448
	speed: 0.0688s/iter; left time: 869.0150s
	iters: 900, epoch: 15 | loss: 0.3751850
	speed: 0.0681s/iter; left time: 854.1107s
	iters: 1000, epoch: 15 | loss: 0.7564893
	speed: 0.0660s/iter; left time: 820.5737s
	iters: 1100, epoch: 15 | loss: 0.3862198
	speed: 0.0673s/iter; left time: 830.0886s
	iters: 1200, epoch: 15 | loss: 0.4523391
	speed: 0.0687s/iter; left time: 840.8826s
	iters: 1300, epoch: 15 | loss: 0.8168033
	speed: 0.0663s/iter; left time: 804.4185s
	iters: 1400, epoch: 15 | loss: 0.4885117
	speed: 0.0693s/iter; left time: 834.0790s
	iters: 1500, epoch: 15 | loss: 0.4926650
	speed: 0.0678s/iter; left time: 809.4932s
	iters: 1600, epoch: 15 | loss: 0.5569847
	speed: 0.0672s/iter; left time: 795.6025s
	iters: 1700, epoch: 15 | loss: 0.5362708
	speed: 0.0652s/iter; left time: 765.0282s
	iters: 1800, epoch: 15 | loss: 0.4178267
	speed: 0.0643s/iter; left time: 748.6201s
	iters: 1900, epoch: 15 | loss: 0.4241639
	speed: 0.0637s/iter; left time: 734.3506s
	iters: 2000, epoch: 15 | loss: 0.5483706
	speed: 0.0624s/iter; left time: 713.1520s
	iters: 2100, epoch: 15 | loss: 0.4558626
	speed: 0.0642s/iter; left time: 727.1746s
	iters: 2200, epoch: 15 | loss: 0.4749306
	speed: 0.0627s/iter; left time: 704.0030s
Epoch: 15 cost time: 149.0392894744873
Epoch: 15, Steps: 2239 | Train Loss: 0.5509513 Vali Loss: 0.5921151 Test Loss: 0.3164962
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : weather_336_720_DLinear_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15349<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9820
mse:0.3179463744163513, mae:0.3594847321510315
