Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTh1', data_path='ETTh1.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='Linear', model_id='ETTh1_336_720', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=720, root_path='./dataset/', save_pred_values=False, seed=25565, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTh1_336_720_Linear_ETTh1_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed25565>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7585
val 2161
test 2161
	iters: 100, epoch: 1 | loss: 0.5197616
	speed: 0.0177s/iter; left time: 82.2230s
	iters: 200, epoch: 1 | loss: 0.5368652
	speed: 0.0191s/iter; left time: 86.5878s
Epoch: 1 cost time: 4.400119066238403
Epoch: 1, Steps: 237 | Train Loss: 0.6000033 Vali Loss: 1.4068404 Test Loss: 0.6085418
Validation loss decreased (inf --> 1.406840).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.5287309
	speed: 0.0350s/iter; left time: 154.3189s
	iters: 200, epoch: 2 | loss: 0.5923041
	speed: 0.0205s/iter; left time: 88.0482s
Epoch: 2 cost time: 4.570709705352783
Epoch: 2, Steps: 237 | Train Loss: 0.5719089 Vali Loss: 1.4886963 Test Loss: 0.5787249
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.4991904
	speed: 0.0317s/iter; left time: 132.2665s
	iters: 200, epoch: 3 | loss: 0.5603961
	speed: 0.0201s/iter; left time: 81.8098s
Epoch: 3 cost time: 4.491115093231201
Epoch: 3, Steps: 237 | Train Loss: 0.5225404 Vali Loss: 1.3462020 Test Loss: 0.5379560
Validation loss decreased (1.406840 --> 1.346202).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.5305978
	speed: 0.0325s/iter; left time: 127.7144s
	iters: 200, epoch: 4 | loss: 0.5991267
	speed: 0.0168s/iter; left time: 64.4312s
Epoch: 4 cost time: 4.085946559906006
Epoch: 4, Steps: 237 | Train Loss: 0.5002170 Vali Loss: 1.2838054 Test Loss: 0.5161638
Validation loss decreased (1.346202 --> 1.283805).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.5509713
	speed: 0.0313s/iter; left time: 115.5651s
	iters: 200, epoch: 5 | loss: 0.5413730
	speed: 0.0180s/iter; left time: 64.8527s
Epoch: 5 cost time: 4.068993806838989
Epoch: 5, Steps: 237 | Train Loss: 0.4895545 Vali Loss: 1.2724392 Test Loss: 0.4822180
Validation loss decreased (1.283805 --> 1.272439).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.5627838
	speed: 0.0318s/iter; left time: 109.8141s
	iters: 200, epoch: 6 | loss: 0.4513635
	speed: 0.0194s/iter; left time: 65.1900s
Epoch: 6 cost time: 4.511617183685303
Epoch: 6, Steps: 237 | Train Loss: 0.4838433 Vali Loss: 1.2435178 Test Loss: 0.4951971
Validation loss decreased (1.272439 --> 1.243518).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.4930196
	speed: 0.0344s/iter; left time: 110.7696s
	iters: 200, epoch: 7 | loss: 0.4604274
	speed: 0.0175s/iter; left time: 54.4753s
Epoch: 7 cost time: 4.246659755706787
Epoch: 7, Steps: 237 | Train Loss: 0.4810516 Vali Loss: 1.2427206 Test Loss: 0.4912525
Validation loss decreased (1.243518 --> 1.242721).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.4436364
	speed: 0.0332s/iter; left time: 98.8938s
	iters: 200, epoch: 8 | loss: 0.4857261
	speed: 0.0180s/iter; left time: 51.9098s
Epoch: 8 cost time: 4.237656831741333
Epoch: 8, Steps: 237 | Train Loss: 0.4792207 Vali Loss: 1.2496212 Test Loss: 0.4840372
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.4901266
	speed: 0.0326s/iter; left time: 89.5861s
	iters: 200, epoch: 9 | loss: 0.4480650
	speed: 0.0191s/iter; left time: 50.4239s
Epoch: 9 cost time: 4.2358667850494385
Epoch: 9, Steps: 237 | Train Loss: 0.4783090 Vali Loss: 1.2467202 Test Loss: 0.4869389
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.4588532
	speed: 0.0334s/iter; left time: 83.8685s
	iters: 200, epoch: 10 | loss: 0.4790553
	speed: 0.0175s/iter; left time: 42.2338s
Epoch: 10 cost time: 4.2312116622924805
Epoch: 10, Steps: 237 | Train Loss: 0.4777578 Vali Loss: 1.2463505 Test Loss: 0.4858182
EarlyStopping counter: 3 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.5010057
	speed: 0.0338s/iter; left time: 76.7247s
	iters: 200, epoch: 11 | loss: 0.4461165
	speed: 0.0191s/iter; left time: 41.3641s
Epoch: 11 cost time: 4.3712005615234375
Epoch: 11, Steps: 237 | Train Loss: 0.4775460 Vali Loss: 1.2426567 Test Loss: 0.4862703
Validation loss decreased (1.242721 --> 1.242657).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.4939609
	speed: 0.0336s/iter; left time: 68.2637s
	iters: 200, epoch: 12 | loss: 0.4603446
	speed: 0.0174s/iter; left time: 33.6823s
Epoch: 12 cost time: 4.188513278961182
Epoch: 12, Steps: 237 | Train Loss: 0.4773734 Vali Loss: 1.2435263 Test Loss: 0.4875993
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.5149304
	speed: 0.0316s/iter; left time: 56.7813s
	iters: 200, epoch: 13 | loss: 0.4857007
	speed: 0.0153s/iter; left time: 26.0375s
Epoch: 13 cost time: 3.827385902404785
Epoch: 13, Steps: 237 | Train Loss: 0.4773003 Vali Loss: 1.2427297 Test Loss: 0.4873480
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.4709447
	speed: 0.0289s/iter; left time: 45.1260s
	iters: 200, epoch: 14 | loss: 0.4454119
	speed: 0.0149s/iter; left time: 21.7790s
Epoch: 14 cost time: 3.5970253944396973
Epoch: 14, Steps: 237 | Train Loss: 0.4772581 Vali Loss: 1.2437140 Test Loss: 0.4873444
EarlyStopping counter: 3 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.4195001
	speed: 0.0265s/iter; left time: 35.0795s
	iters: 200, epoch: 15 | loss: 0.4681624
	speed: 0.0139s/iter; left time: 17.0275s
Epoch: 15 cost time: 3.4065942764282227
Epoch: 15, Steps: 237 | Train Loss: 0.4772365 Vali Loss: 1.2433537 Test Loss: 0.4873347
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.4535370
	speed: 0.0267s/iter; left time: 28.9600s
	iters: 200, epoch: 16 | loss: 0.4717368
	speed: 0.0143s/iter; left time: 14.0807s
Epoch: 16 cost time: 3.361002206802368
Epoch: 16, Steps: 237 | Train Loss: 0.4771952 Vali Loss: 1.2443753 Test Loss: 0.4873322
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTh1_336_720_Linear_ETTh1_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed25565<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
mse:0.48531967401504517, mae:0.48427462577819824
