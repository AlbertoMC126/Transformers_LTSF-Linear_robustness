Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='DLinear', model_id='traffic_336_192', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=192, root_path='./dataset/', save_pred_values=False, seed=3293, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_336_192_DLinear_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3293>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11753
val 1565
test 3317
	iters: 100, epoch: 1 | loss: 0.5914438
	speed: 0.4376s/iter; left time: 6380.4143s
	iters: 200, epoch: 1 | loss: 0.5341907
	speed: 0.4214s/iter; left time: 6102.2506s
	iters: 300, epoch: 1 | loss: 0.5986748
	speed: 0.4408s/iter; left time: 6339.1875s
	iters: 400, epoch: 1 | loss: 0.5984049
	speed: 0.4233s/iter; left time: 6045.6434s
	iters: 500, epoch: 1 | loss: 0.5754533
	speed: 0.4229s/iter; left time: 5996.7796s
	iters: 600, epoch: 1 | loss: 0.6274694
	speed: 0.4297s/iter; left time: 6050.5326s
	iters: 700, epoch: 1 | loss: 0.5793712
	speed: 0.4228s/iter; left time: 5910.5592s
Epoch: 1 cost time: 314.46349263191223
Epoch: 1, Steps: 734 | Train Loss: 0.5882612 Vali Loss: 0.7998476 Test Loss: 0.9213330
Validation loss decreased (inf --> 0.799848).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.5647313
	speed: 0.9245s/iter; left time: 12801.4858s
	iters: 200, epoch: 2 | loss: 0.6136066
	speed: 0.4206s/iter; left time: 5782.5963s
	iters: 300, epoch: 2 | loss: 0.5761348
	speed: 0.4435s/iter; left time: 6051.9070s
	iters: 400, epoch: 2 | loss: 0.6429082
	speed: 0.4221s/iter; left time: 5718.8332s
	iters: 500, epoch: 2 | loss: 0.5943273
	speed: 0.4226s/iter; left time: 5683.2230s
	iters: 600, epoch: 2 | loss: 0.5333300
	speed: 0.4301s/iter; left time: 5741.0150s
	iters: 700, epoch: 2 | loss: 0.5990630
	speed: 0.4220s/iter; left time: 5590.8133s
Epoch: 2 cost time: 313.35403299331665
Epoch: 2, Steps: 734 | Train Loss: 0.5813661 Vali Loss: 0.7928988 Test Loss: 0.9446568
Validation loss decreased (0.799848 --> 0.792899).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.3633040
	speed: 0.9296s/iter; left time: 12190.0714s
	iters: 200, epoch: 3 | loss: 0.3461239
	speed: 0.4213s/iter; left time: 5482.6621s
	iters: 300, epoch: 3 | loss: 0.3286792
	speed: 0.4294s/iter; left time: 5545.4275s
	iters: 400, epoch: 3 | loss: 0.3384183
	speed: 0.4262s/iter; left time: 5460.5112s
	iters: 500, epoch: 3 | loss: 0.3742174
	speed: 0.4211s/iter; left time: 5353.7096s
	iters: 600, epoch: 3 | loss: 0.3405392
	speed: 0.4225s/iter; left time: 5329.0874s
	iters: 700, epoch: 3 | loss: 0.3457243
	speed: 0.4221s/iter; left time: 5281.9028s
Epoch: 3 cost time: 312.1070284843445
Epoch: 3, Steps: 734 | Train Loss: 0.3599223 Vali Loss: 0.5054564 Test Loss: 0.6112822
Validation loss decreased (0.792899 --> 0.505456).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.2690205
	speed: 0.9385s/iter; left time: 11618.1260s
	iters: 200, epoch: 4 | loss: 0.2835292
	speed: 0.4219s/iter; left time: 5179.9993s
	iters: 300, epoch: 4 | loss: 0.3116326
	speed: 0.4189s/iter; left time: 5101.8948s
	iters: 400, epoch: 4 | loss: 0.2992301
	speed: 0.4370s/iter; left time: 5279.0130s
	iters: 500, epoch: 4 | loss: 0.2973045
	speed: 0.4223s/iter; left time: 5058.7065s
	iters: 600, epoch: 4 | loss: 0.3076277
	speed: 0.4253s/iter; left time: 5051.6009s
	iters: 700, epoch: 4 | loss: 0.2943674
	speed: 0.4310s/iter; left time: 5076.2158s
Epoch: 4 cost time: 314.57365465164185
Epoch: 4, Steps: 734 | Train Loss: 0.2946924 Vali Loss: 0.4235471 Test Loss: 0.5176653
Validation loss decreased (0.505456 --> 0.423547).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.2667677
	speed: 0.9223s/iter; left time: 10739.8831s
	iters: 200, epoch: 5 | loss: 0.2526515
	speed: 0.4227s/iter; left time: 4880.6161s
	iters: 300, epoch: 5 | loss: 0.2489811
	speed: 0.4211s/iter; left time: 4820.0593s
	iters: 400, epoch: 5 | loss: 0.2701018
	speed: 0.4381s/iter; left time: 4969.8048s
	iters: 500, epoch: 5 | loss: 0.2776617
	speed: 0.4204s/iter; left time: 4727.0731s
	iters: 600, epoch: 5 | loss: 0.2778411
	speed: 0.4212s/iter; left time: 4693.9572s
	iters: 700, epoch: 5 | loss: 0.2722196
	speed: 0.4333s/iter; left time: 4786.1202s
Epoch: 5 cost time: 313.4030330181122
Epoch: 5, Steps: 734 | Train Loss: 0.2677780 Vali Loss: 0.3894077 Test Loss: 0.4774919
Validation loss decreased (0.423547 --> 0.389408).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.2367301
	speed: 0.9207s/iter; left time: 10046.2773s
	iters: 200, epoch: 6 | loss: 0.2583437
	speed: 0.4266s/iter; left time: 4612.1871s
	iters: 300, epoch: 6 | loss: 0.2345161
	speed: 0.4191s/iter; left time: 4489.3736s
	iters: 400, epoch: 6 | loss: 0.2785029
	speed: 0.4295s/iter; left time: 4557.3825s
	iters: 500, epoch: 6 | loss: 0.2677367
	speed: 0.4334s/iter; left time: 4554.9536s
	iters: 600, epoch: 6 | loss: 0.2350217
	speed: 0.4230s/iter; left time: 4404.1190s
	iters: 700, epoch: 6 | loss: 0.2595109
	speed: 0.4263s/iter; left time: 4395.5674s
Epoch: 6 cost time: 312.84434628486633
Epoch: 6, Steps: 734 | Train Loss: 0.2541284 Vali Loss: 0.3727808 Test Loss: 0.4569596
Validation loss decreased (0.389408 --> 0.372781).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.2457144
	speed: 0.9172s/iter; left time: 9334.0137s
	iters: 200, epoch: 7 | loss: 0.2685554
	speed: 0.4314s/iter; left time: 4347.0084s
	iters: 300, epoch: 7 | loss: 0.2463041
	speed: 0.4188s/iter; left time: 4178.0072s
	iters: 400, epoch: 7 | loss: 0.2670468
	speed: 0.4236s/iter; left time: 4184.0209s
	iters: 500, epoch: 7 | loss: 0.2443672
	speed: 0.4391s/iter; left time: 4293.5143s
	iters: 600, epoch: 7 | loss: 0.2685782
	speed: 0.4229s/iter; left time: 4092.5279s
	iters: 700, epoch: 7 | loss: 0.2557085
	speed: 0.4251s/iter; left time: 4071.5282s
Epoch: 7 cost time: 313.0444846153259
Epoch: 7, Steps: 734 | Train Loss: 0.2465904 Vali Loss: 0.3621574 Test Loss: 0.4474179
Validation loss decreased (0.372781 --> 0.362157).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.2334162
	speed: 0.9183s/iter; left time: 8671.5296s
	iters: 200, epoch: 8 | loss: 0.2259070
	speed: 0.4316s/iter; left time: 4032.5007s
	iters: 300, epoch: 8 | loss: 0.2440448
	speed: 0.4203s/iter; left time: 3885.1082s
	iters: 400, epoch: 8 | loss: 0.2213537
	speed: 0.4184s/iter; left time: 3825.5251s
	iters: 500, epoch: 8 | loss: 0.2488572
	speed: 0.4451s/iter; left time: 4024.9048s
	iters: 600, epoch: 8 | loss: 0.2832480
	speed: 0.4215s/iter; left time: 3769.3394s
	iters: 700, epoch: 8 | loss: 0.2641700
	speed: 0.4211s/iter; left time: 3723.5739s
Epoch: 8 cost time: 312.4967908859253
Epoch: 8, Steps: 734 | Train Loss: 0.2425803 Vali Loss: 0.3590322 Test Loss: 0.4431143
Validation loss decreased (0.362157 --> 0.359032).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.2442871
	speed: 0.9245s/iter; left time: 8051.8389s
	iters: 200, epoch: 9 | loss: 0.2292135
	speed: 0.4218s/iter; left time: 3631.5960s
	iters: 300, epoch: 9 | loss: 0.2209982
	speed: 0.4222s/iter; left time: 3592.1787s
	iters: 400, epoch: 9 | loss: 0.2325990
	speed: 0.4192s/iter; left time: 3525.2659s
	iters: 500, epoch: 9 | loss: 0.2154900
	speed: 0.4370s/iter; left time: 3630.6204s
	iters: 600, epoch: 9 | loss: 0.2302200
	speed: 0.4250s/iter; left time: 3488.8121s
	iters: 700, epoch: 9 | loss: 0.2602661
	speed: 0.4224s/iter; left time: 3425.3635s
Epoch: 9 cost time: 311.5393395423889
Epoch: 9, Steps: 734 | Train Loss: 0.2402812 Vali Loss: 0.3570866 Test Loss: 0.4410006
Validation loss decreased (0.359032 --> 0.357087).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.2194757
	speed: 0.9307s/iter; left time: 7422.2191s
	iters: 200, epoch: 10 | loss: 0.2440498
	speed: 0.4267s/iter; left time: 3360.3316s
	iters: 300, epoch: 10 | loss: 0.2359923
	speed: 0.4287s/iter; left time: 3333.2608s
	iters: 400, epoch: 10 | loss: 0.2185399
	speed: 0.4199s/iter; left time: 3222.9395s
	iters: 500, epoch: 10 | loss: 0.2352838
	speed: 0.4319s/iter; left time: 3271.3245s
	iters: 600, epoch: 10 | loss: 0.2623955
	speed: 0.4322s/iter; left time: 3230.5795s
	iters: 700, epoch: 10 | loss: 0.2260174
	speed: 0.4260s/iter; left time: 3141.7033s
Epoch: 10 cost time: 313.6711483001709
Epoch: 10, Steps: 734 | Train Loss: 0.2390409 Vali Loss: 0.3562341 Test Loss: 0.4398538
Validation loss decreased (0.357087 --> 0.356234).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.2330659
	speed: 0.9227s/iter; left time: 6681.3797s
	iters: 200, epoch: 11 | loss: 0.2111931
	speed: 0.4246s/iter; left time: 3032.0019s
	iters: 300, epoch: 11 | loss: 0.2364324
	speed: 0.4310s/iter; left time: 3034.7905s
	iters: 400, epoch: 11 | loss: 0.2373998
	speed: 0.4193s/iter; left time: 2910.0959s
	iters: 500, epoch: 11 | loss: 0.2539408
	speed: 0.4192s/iter; left time: 2867.6684s
	iters: 600, epoch: 11 | loss: 0.2162795
	speed: 0.4199s/iter; left time: 2830.6368s
	iters: 700, epoch: 11 | loss: 0.2246280
	speed: 0.4205s/iter; left time: 2792.6472s
Epoch: 11 cost time: 310.3601338863373
Epoch: 11, Steps: 734 | Train Loss: 0.2383382 Vali Loss: 0.3560639 Test Loss: 0.4395774
Validation loss decreased (0.356234 --> 0.356064).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.2359644
	speed: 0.9246s/iter; left time: 6016.3519s
	iters: 200, epoch: 12 | loss: 0.2411117
	speed: 0.4229s/iter; left time: 2709.4478s
	iters: 300, epoch: 12 | loss: 0.2418924
	speed: 0.4211s/iter; left time: 2656.0968s
	iters: 400, epoch: 12 | loss: 0.2159223
	speed: 0.4181s/iter; left time: 2595.4448s
	iters: 500, epoch: 12 | loss: 0.2408594
	speed: 0.4172s/iter; left time: 2547.9644s
	iters: 600, epoch: 12 | loss: 0.2263992
	speed: 0.4190s/iter; left time: 2517.0279s
	iters: 700, epoch: 12 | loss: 0.2435822
	speed: 0.4193s/iter; left time: 2477.0440s
Epoch: 12 cost time: 308.5423414707184
Epoch: 12, Steps: 734 | Train Loss: 0.2379692 Vali Loss: 0.3553794 Test Loss: 0.4393283
Validation loss decreased (0.356064 --> 0.355379).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.2482835
	speed: 0.9284s/iter; left time: 5359.8780s
	iters: 200, epoch: 13 | loss: 0.2625255
	speed: 0.4223s/iter; left time: 2395.5267s
	iters: 300, epoch: 13 | loss: 0.2334598
	speed: 0.4233s/iter; left time: 2358.9201s
	iters: 400, epoch: 13 | loss: 0.2116481
	speed: 0.4250s/iter; left time: 2325.9330s
	iters: 500, epoch: 13 | loss: 0.2580095
	speed: 0.4194s/iter; left time: 2253.3451s
	iters: 600, epoch: 13 | loss: 0.2090175
	speed: 0.4361s/iter; left time: 2299.7976s
	iters: 700, epoch: 13 | loss: 0.2199336
	speed: 0.4178s/iter; left time: 2161.5284s
Epoch: 13 cost time: 311.7581396102905
Epoch: 13, Steps: 734 | Train Loss: 0.2377581 Vali Loss: 0.3555939 Test Loss: 0.4392745
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 14 | loss: 0.2440137
	speed: 0.8606s/iter; left time: 4336.4960s
	iters: 200, epoch: 14 | loss: 0.2461409
	speed: 0.4209s/iter; left time: 2078.5928s
	iters: 300, epoch: 14 | loss: 0.2136833
	speed: 0.4191s/iter; left time: 2027.8828s
	iters: 400, epoch: 14 | loss: 0.2269423
	speed: 0.4311s/iter; left time: 2042.9648s
	iters: 500, epoch: 14 | loss: 0.2260171
	speed: 0.4264s/iter; left time: 1978.0595s
	iters: 600, epoch: 14 | loss: 0.2639340
	speed: 0.4394s/iter; left time: 1994.5594s
	iters: 700, epoch: 14 | loss: 0.2502042
	speed: 0.4196s/iter; left time: 1862.7480s
Epoch: 14 cost time: 312.61277627944946
Epoch: 14, Steps: 734 | Train Loss: 0.2376846 Vali Loss: 0.3554832 Test Loss: 0.4392392
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 15 | loss: 0.2324978
	speed: 0.8570s/iter; left time: 3689.2998s
	iters: 200, epoch: 15 | loss: 0.1936071
	speed: 0.4240s/iter; left time: 1782.7824s
	iters: 300, epoch: 15 | loss: 0.2482383
	speed: 0.4199s/iter; left time: 1723.4946s
	iters: 400, epoch: 15 | loss: 0.2363909
	speed: 0.4274s/iter; left time: 1711.5910s
	iters: 500, epoch: 15 | loss: 0.2309482
	speed: 0.4249s/iter; left time: 1659.3388s
	iters: 600, epoch: 15 | loss: 0.2346317
	speed: 0.4174s/iter; left time: 1588.1760s
	iters: 700, epoch: 15 | loss: 0.2205229
	speed: 0.4116s/iter; left time: 1524.9470s
Epoch: 15 cost time: 309.32059049606323
Epoch: 15, Steps: 734 | Train Loss: 0.2376462 Vali Loss: 0.3557549 Test Loss: 0.4392309
EarlyStopping counter: 3 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 16 | loss: 0.2372313
	speed: 0.8416s/iter; left time: 3005.3949s
	iters: 200, epoch: 16 | loss: 0.2364986
	speed: 0.4198s/iter; left time: 1457.1929s
	iters: 300, epoch: 16 | loss: 0.2476326
	speed: 0.4141s/iter; left time: 1395.7834s
	iters: 400, epoch: 16 | loss: 0.2576048
	speed: 0.4226s/iter; left time: 1382.3742s
	iters: 500, epoch: 16 | loss: 0.2219074
	speed: 0.4325s/iter; left time: 1371.3405s
	iters: 600, epoch: 16 | loss: 0.2667821
	speed: 0.4187s/iter; left time: 1285.7265s
	iters: 700, epoch: 16 | loss: 0.2491211
	speed: 0.4167s/iter; left time: 1237.9153s
Epoch: 16 cost time: 308.26657462120056
Epoch: 16, Steps: 734 | Train Loss: 0.2375485 Vali Loss: 0.3555488 Test Loss: 0.4392258
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 17 | loss: 0.2237673
	speed: 0.8469s/iter; left time: 2402.6924s
	iters: 200, epoch: 17 | loss: 0.2377134
	speed: 0.4263s/iter; left time: 1166.8019s
	iters: 300, epoch: 17 | loss: 0.2633327
	speed: 0.4236s/iter; left time: 1117.0746s
	iters: 400, epoch: 17 | loss: 0.2463036
	speed: 0.4186s/iter; left time: 1061.9675s
	iters: 500, epoch: 17 | loss: 0.2481804
	speed: 0.4210s/iter; left time: 1025.9111s
	iters: 600, epoch: 17 | loss: 0.2404998
	speed: 0.4208s/iter; left time: 983.3446s
	iters: 700, epoch: 17 | loss: 0.2370453
	speed: 0.4190s/iter; left time: 937.2703s
Epoch: 17 cost time: 309.11303067207336
Epoch: 17, Steps: 734 | Train Loss: 0.2375674 Vali Loss: 0.3557648 Test Loss: 0.4392255
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : traffic_336_192_DLinear_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3293<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3317
mse:0.43902432918548584, mae:0.30442067980766296
