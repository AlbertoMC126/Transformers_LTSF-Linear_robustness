Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='NLinear', model_id='weather_336_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=336, root_path='./dataset/', save_pred_values=False, seed=3144, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : weather_336_336_NLinear_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3144>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36216
val 4935
test 10204
	iters: 100, epoch: 1 | loss: 0.6964273
	speed: 0.0236s/iter; left time: 1065.4519s
	iters: 200, epoch: 1 | loss: 0.6355076
	speed: 0.0245s/iter; left time: 1102.2458s
	iters: 300, epoch: 1 | loss: 0.6369873
	speed: 0.0224s/iter; left time: 1008.4132s
	iters: 400, epoch: 1 | loss: 1.1719655
	speed: 0.0228s/iter; left time: 1023.2718s
	iters: 500, epoch: 1 | loss: 0.8794383
	speed: 0.0214s/iter; left time: 957.4792s
	iters: 600, epoch: 1 | loss: 1.0567821
	speed: 0.0216s/iter; left time: 966.0125s
	iters: 700, epoch: 1 | loss: 0.6369289
	speed: 0.0239s/iter; left time: 1066.5015s
	iters: 800, epoch: 1 | loss: 0.9857338
	speed: 0.0224s/iter; left time: 994.6563s
	iters: 900, epoch: 1 | loss: 1.9523365
	speed: 0.0219s/iter; left time: 971.0824s
	iters: 1000, epoch: 1 | loss: 0.9258946
	speed: 0.0241s/iter; left time: 1068.4053s
	iters: 1100, epoch: 1 | loss: 0.5499769
	speed: 0.0228s/iter; left time: 1009.0628s
	iters: 1200, epoch: 1 | loss: 1.2341005
	speed: 0.0236s/iter; left time: 1037.7833s
	iters: 1300, epoch: 1 | loss: 1.0846163
	speed: 0.0240s/iter; left time: 1055.5123s
	iters: 1400, epoch: 1 | loss: 0.5016947
	speed: 0.0251s/iter; left time: 1099.1796s
	iters: 1500, epoch: 1 | loss: 0.5049676
	speed: 0.0238s/iter; left time: 1041.8563s
	iters: 1600, epoch: 1 | loss: 0.4685044
	speed: 0.0235s/iter; left time: 1028.1542s
	iters: 1700, epoch: 1 | loss: 0.4964473
	speed: 0.0235s/iter; left time: 1022.4705s
	iters: 1800, epoch: 1 | loss: 0.5680386
	speed: 0.0234s/iter; left time: 1017.3944s
	iters: 1900, epoch: 1 | loss: 0.6504391
	speed: 0.0224s/iter; left time: 970.8453s
	iters: 2000, epoch: 1 | loss: 0.6537758
	speed: 0.0225s/iter; left time: 972.7060s
	iters: 2100, epoch: 1 | loss: 0.5362655
	speed: 0.0236s/iter; left time: 1017.6635s
	iters: 2200, epoch: 1 | loss: 8.9065123
	speed: 0.0227s/iter; left time: 979.6160s
Epoch: 1 cost time: 52.21856904029846
Epoch: 1, Steps: 2263 | Train Loss: 3.0420445 Vali Loss: 6.1913595 Test Loss: 0.4321601
Validation loss decreased (inf --> 6.191360).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.5026229
	speed: 0.0780s/iter; left time: 3347.9594s
	iters: 200, epoch: 2 | loss: 0.6022816
	speed: 0.0237s/iter; left time: 1015.9537s
	iters: 300, epoch: 2 | loss: 1.0794820
	speed: 0.0224s/iter; left time: 957.8436s
	iters: 400, epoch: 2 | loss: 0.7085127
	speed: 0.0214s/iter; left time: 910.2819s
	iters: 500, epoch: 2 | loss: 7.3915968
	speed: 0.0215s/iter; left time: 914.2335s
	iters: 600, epoch: 2 | loss: 2.3498936
	speed: 0.0237s/iter; left time: 1005.1981s
	iters: 700, epoch: 2 | loss: 0.5859233
	speed: 0.0229s/iter; left time: 966.7421s
	iters: 800, epoch: 2 | loss: 0.5026895
	speed: 0.0220s/iter; left time: 929.5418s
	iters: 900, epoch: 2 | loss: 0.7140434
	speed: 0.0243s/iter; left time: 1022.7652s
	iters: 1000, epoch: 2 | loss: 0.4936682
	speed: 0.0254s/iter; left time: 1068.3273s
	iters: 1100, epoch: 2 | loss: 0.5716179
	speed: 0.0243s/iter; left time: 1018.0376s
	iters: 1200, epoch: 2 | loss: 0.5970076
	speed: 0.0249s/iter; left time: 1039.6767s
	iters: 1300, epoch: 2 | loss: 1.5567780
	speed: 0.0227s/iter; left time: 947.4432s
	iters: 1400, epoch: 2 | loss: 0.5663689
	speed: 0.0237s/iter; left time: 986.9456s
	iters: 1500, epoch: 2 | loss: 0.5307116
	speed: 0.0230s/iter; left time: 953.4777s
	iters: 1600, epoch: 2 | loss: 0.5127872
	speed: 0.0238s/iter; left time: 984.6804s
	iters: 1700, epoch: 2 | loss: 0.6618065
	speed: 0.0241s/iter; left time: 995.8966s
	iters: 1800, epoch: 2 | loss: 0.6522295
	speed: 0.0220s/iter; left time: 904.6750s
	iters: 1900, epoch: 2 | loss: 0.6520760
	speed: 0.0233s/iter; left time: 958.2641s
	iters: 2000, epoch: 2 | loss: 0.6426880
	speed: 0.0236s/iter; left time: 968.5420s
	iters: 2100, epoch: 2 | loss: 1.5102730
	speed: 0.0236s/iter; left time: 964.1023s
	iters: 2200, epoch: 2 | loss: 0.6841429
	speed: 0.0228s/iter; left time: 931.6632s
Epoch: 2 cost time: 52.41610097885132
Epoch: 2, Steps: 2263 | Train Loss: 29.4434466 Vali Loss: 1.0448648 Test Loss: 0.3389081
Validation loss decreased (6.191360 --> 1.044865).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.4879916
	speed: 0.0878s/iter; left time: 3566.7703s
	iters: 200, epoch: 3 | loss: 0.5817834
	speed: 0.0234s/iter; left time: 947.9613s
	iters: 300, epoch: 3 | loss: 1.0872087
	speed: 0.0239s/iter; left time: 966.7283s
	iters: 400, epoch: 3 | loss: 0.6463734
	speed: 0.0238s/iter; left time: 961.3594s
	iters: 500, epoch: 3 | loss: 0.4839560
	speed: 0.0238s/iter; left time: 956.6350s
	iters: 600, epoch: 3 | loss: 2.1989048
	speed: 0.0244s/iter; left time: 980.7103s
	iters: 700, epoch: 3 | loss: 0.4736335
	speed: 0.0240s/iter; left time: 960.9453s
	iters: 800, epoch: 3 | loss: 0.4898703
	speed: 0.0222s/iter; left time: 888.2203s
	iters: 900, epoch: 3 | loss: 0.6449964
	speed: 0.0225s/iter; left time: 897.3499s
	iters: 1000, epoch: 3 | loss: 1.0483559
	speed: 0.0238s/iter; left time: 943.7647s
	iters: 1100, epoch: 3 | loss: 2.0109291
	speed: 0.0226s/iter; left time: 895.3306s
	iters: 1200, epoch: 3 | loss: 2.5461655
	speed: 0.0225s/iter; left time: 888.3294s
	iters: 1300, epoch: 3 | loss: 0.4592444
	speed: 0.0212s/iter; left time: 836.6490s
	iters: 1400, epoch: 3 | loss: 1.0057639
	speed: 0.0223s/iter; left time: 879.0486s
	iters: 1500, epoch: 3 | loss: 1.0487208
	speed: 0.0209s/iter; left time: 820.6970s
	iters: 1600, epoch: 3 | loss: 0.6287146
	speed: 0.0229s/iter; left time: 897.4199s
	iters: 1700, epoch: 3 | loss: 1.6032443
	speed: 0.0249s/iter; left time: 972.8078s
	iters: 1800, epoch: 3 | loss: 0.5197076
	speed: 0.0230s/iter; left time: 896.6400s
	iters: 1900, epoch: 3 | loss: 0.4827778
	speed: 0.0235s/iter; left time: 912.9294s
	iters: 2000, epoch: 3 | loss: 0.5994805
	speed: 0.0237s/iter; left time: 919.2163s
	iters: 2100, epoch: 3 | loss: 0.6420817
	speed: 0.0233s/iter; left time: 900.6589s
	iters: 2200, epoch: 3 | loss: 0.4224467
	speed: 0.0192s/iter; left time: 740.4186s
Epoch: 3 cost time: 51.731921672821045
Epoch: 3, Steps: 2263 | Train Loss: 51.8050109 Vali Loss: 0.6109779 Test Loss: 0.2773473
Validation loss decreased (1.044865 --> 0.610978).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.4825578
	speed: 0.0831s/iter; left time: 3188.2734s
	iters: 200, epoch: 4 | loss: 0.4770039
	speed: 0.0242s/iter; left time: 924.3670s
	iters: 300, epoch: 4 | loss: 0.6140308
	speed: 0.0223s/iter; left time: 851.2499s
	iters: 400, epoch: 4 | loss: 0.3760670
	speed: 0.0236s/iter; left time: 899.7060s
	iters: 500, epoch: 4 | loss: 1.3301693
	speed: 0.0230s/iter; left time: 871.6360s
	iters: 600, epoch: 4 | loss: 1.1043142
	speed: 0.0221s/iter; left time: 837.6700s
	iters: 700, epoch: 4 | loss: 0.5215929
	speed: 0.0214s/iter; left time: 807.7317s
	iters: 800, epoch: 4 | loss: 0.3616672
	speed: 0.0209s/iter; left time: 789.1654s
	iters: 900, epoch: 4 | loss: 0.6855925
	speed: 0.0210s/iter; left time: 787.8124s
	iters: 1000, epoch: 4 | loss: 1.3619421
	speed: 0.0217s/iter; left time: 812.4135s
	iters: 1100, epoch: 4 | loss: 0.4358087
	speed: 0.0229s/iter; left time: 857.1004s
	iters: 1200, epoch: 4 | loss: 0.9910267
	speed: 0.0231s/iter; left time: 859.1610s
	iters: 1300, epoch: 4 | loss: 0.8383520
	speed: 0.0244s/iter; left time: 905.4065s
	iters: 1400, epoch: 4 | loss: 0.3435794
	speed: 0.0205s/iter; left time: 759.4859s
	iters: 1500, epoch: 4 | loss: 0.3400258
	speed: 0.0244s/iter; left time: 902.1369s
	iters: 1600, epoch: 4 | loss: 0.6090055
	speed: 0.0193s/iter; left time: 710.8306s
	iters: 1700, epoch: 4 | loss: 1.0158389
	speed: 0.0228s/iter; left time: 838.8221s
	iters: 1800, epoch: 4 | loss: 0.9534535
	speed: 0.0236s/iter; left time: 864.5940s
	iters: 1900, epoch: 4 | loss: 0.4772153
	speed: 0.0231s/iter; left time: 846.5003s
	iters: 2000, epoch: 4 | loss: 1.3287114
	speed: 0.0220s/iter; left time: 802.9442s
	iters: 2100, epoch: 4 | loss: 0.3764593
	speed: 0.0233s/iter; left time: 848.7233s
	iters: 2200, epoch: 4 | loss: 0.8475330
	speed: 0.0203s/iter; left time: 735.5684s
Epoch: 4 cost time: 50.52409648895264
Epoch: 4, Steps: 2263 | Train Loss: 5.6660445 Vali Loss: 0.6168620 Test Loss: 0.2686642
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.3997618
	speed: 0.0742s/iter; left time: 2679.8342s
	iters: 200, epoch: 5 | loss: 0.9520314
	speed: 0.0230s/iter; left time: 829.4303s
	iters: 300, epoch: 5 | loss: 0.3584345
	speed: 0.0232s/iter; left time: 832.8222s
	iters: 400, epoch: 5 | loss: 0.9029305
	speed: 0.0245s/iter; left time: 876.3241s
	iters: 500, epoch: 5 | loss: 0.3951778
	speed: 0.0210s/iter; left time: 751.0281s
	iters: 600, epoch: 5 | loss: 0.9196718
	speed: 0.0209s/iter; left time: 742.7136s
	iters: 700, epoch: 5 | loss: 1.0209719
	speed: 0.0222s/iter; left time: 789.0518s
	iters: 800, epoch: 5 | loss: 0.9460593
	speed: 0.0223s/iter; left time: 789.2446s
	iters: 900, epoch: 5 | loss: 0.3238015
	speed: 0.0224s/iter; left time: 791.6393s
	iters: 1000, epoch: 5 | loss: 0.5252585
	speed: 0.0243s/iter; left time: 854.0894s
	iters: 1100, epoch: 5 | loss: 0.3993689
	speed: 0.0224s/iter; left time: 786.4273s
	iters: 1200, epoch: 5 | loss: 0.8666276
	speed: 0.0198s/iter; left time: 691.6158s
	iters: 1300, epoch: 5 | loss: 0.4668633
	speed: 0.0209s/iter; left time: 729.1414s
	iters: 1400, epoch: 5 | loss: 0.4798274
	speed: 0.0221s/iter; left time: 769.7334s
	iters: 1500, epoch: 5 | loss: 0.4091724
	speed: 0.0227s/iter; left time: 788.1741s
	iters: 1600, epoch: 5 | loss: 0.4043031
	speed: 0.0234s/iter; left time: 810.5230s
	iters: 1700, epoch: 5 | loss: 0.4531638
	speed: 0.0240s/iter; left time: 826.9330s
	iters: 1800, epoch: 5 | loss: 0.9602138
	speed: 0.0222s/iter; left time: 764.2115s
	iters: 1900, epoch: 5 | loss: 0.6826795
	speed: 0.0247s/iter; left time: 845.9727s
	iters: 2000, epoch: 5 | loss: 0.3705096
	speed: 0.0216s/iter; left time: 739.3774s
	iters: 2100, epoch: 5 | loss: 0.3092019
	speed: 0.0211s/iter; left time: 719.0315s
	iters: 2200, epoch: 5 | loss: 1.1232058
	speed: 0.0218s/iter; left time: 741.6242s
Epoch: 5 cost time: 50.18432974815369
Epoch: 5, Steps: 2263 | Train Loss: 1.3607048 Vali Loss: 0.5437198 Test Loss: 0.2465864
Validation loss decreased (0.610978 --> 0.543720).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.9156897
	speed: 0.0741s/iter; left time: 2507.7384s
	iters: 200, epoch: 6 | loss: 0.4509756
	speed: 0.0220s/iter; left time: 743.9194s
	iters: 300, epoch: 6 | loss: 0.4021641
	speed: 0.0239s/iter; left time: 803.5763s
	iters: 400, epoch: 6 | loss: 0.4686011
	speed: 0.0231s/iter; left time: 773.5746s
	iters: 500, epoch: 6 | loss: 0.4270878
	speed: 0.0209s/iter; left time: 698.6924s
	iters: 600, epoch: 6 | loss: 0.7097190
	speed: 0.0237s/iter; left time: 788.7173s
	iters: 700, epoch: 6 | loss: 0.8876750
	speed: 0.0225s/iter; left time: 748.7795s
	iters: 800, epoch: 6 | loss: 0.3716035
	speed: 0.0228s/iter; left time: 754.9927s
	iters: 900, epoch: 6 | loss: 0.9511693
	speed: 0.0225s/iter; left time: 744.5650s
	iters: 1000, epoch: 6 | loss: 0.4928166
	speed: 0.0227s/iter; left time: 747.6510s
	iters: 1100, epoch: 6 | loss: 0.5243345
	speed: 0.0208s/iter; left time: 682.5360s
	iters: 1200, epoch: 6 | loss: 0.4267726
	speed: 0.0235s/iter; left time: 768.8661s
	iters: 1300, epoch: 6 | loss: 0.5408058
	speed: 0.0241s/iter; left time: 785.8460s
	iters: 1400, epoch: 6 | loss: 0.5360540
	speed: 0.0249s/iter; left time: 809.2463s
	iters: 1500, epoch: 6 | loss: 0.7336356
	speed: 0.0248s/iter; left time: 805.3273s
	iters: 1600, epoch: 6 | loss: 0.4834295
	speed: 0.0214s/iter; left time: 693.0569s
	iters: 1700, epoch: 6 | loss: 0.9959161
	speed: 0.0212s/iter; left time: 683.3703s
	iters: 1800, epoch: 6 | loss: 0.9618728
	speed: 0.0232s/iter; left time: 745.0796s
	iters: 1900, epoch: 6 | loss: 0.4174902
	speed: 0.0226s/iter; left time: 723.8502s
	iters: 2000, epoch: 6 | loss: 0.7987723
	speed: 0.0229s/iter; left time: 732.1291s
	iters: 2100, epoch: 6 | loss: 0.5641375
	speed: 0.0236s/iter; left time: 751.6932s
	iters: 2200, epoch: 6 | loss: 0.3476751
	speed: 0.0213s/iter; left time: 674.7465s
Epoch: 6 cost time: 51.06244611740112
Epoch: 6, Steps: 2263 | Train Loss: 0.8808075 Vali Loss: 0.5529209 Test Loss: 0.2470851
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.4493898
	speed: 0.0794s/iter; left time: 2506.9668s
	iters: 200, epoch: 7 | loss: 0.4769807
	speed: 0.0218s/iter; left time: 684.9938s
	iters: 300, epoch: 7 | loss: 0.7184427
	speed: 0.0229s/iter; left time: 717.1016s
	iters: 400, epoch: 7 | loss: 0.3707303
	speed: 0.0225s/iter; left time: 704.6920s
	iters: 500, epoch: 7 | loss: 0.5577376
	speed: 0.0233s/iter; left time: 725.5310s
	iters: 600, epoch: 7 | loss: 0.4605045
	speed: 0.0222s/iter; left time: 691.3156s
	iters: 700, epoch: 7 | loss: 0.4465723
	speed: 0.0227s/iter; left time: 702.8703s
	iters: 800, epoch: 7 | loss: 0.8841950
	speed: 0.0214s/iter; left time: 660.0998s
	iters: 900, epoch: 7 | loss: 0.4238271
	speed: 0.0229s/iter; left time: 703.7684s
	iters: 1000, epoch: 7 | loss: 0.8717961
	speed: 0.0232s/iter; left time: 711.2710s
	iters: 1100, epoch: 7 | loss: 0.9908069
	speed: 0.0212s/iter; left time: 648.0344s
	iters: 1200, epoch: 7 | loss: 0.3649225
	speed: 0.0218s/iter; left time: 666.0145s
	iters: 1300, epoch: 7 | loss: 0.6982038
	speed: 0.0240s/iter; left time: 728.9883s
	iters: 1400, epoch: 7 | loss: 0.4877889
	speed: 0.0249s/iter; left time: 755.2359s
	iters: 1500, epoch: 7 | loss: 0.3862609
	speed: 0.0249s/iter; left time: 750.8197s
	iters: 1600, epoch: 7 | loss: 0.5669963
	speed: 0.0239s/iter; left time: 718.9393s
	iters: 1700, epoch: 7 | loss: 0.4114945
	speed: 0.0225s/iter; left time: 675.0972s
	iters: 1800, epoch: 7 | loss: 0.5803161
	speed: 0.0238s/iter; left time: 709.8005s
	iters: 1900, epoch: 7 | loss: 0.3806010
	speed: 0.0249s/iter; left time: 740.6126s
	iters: 2000, epoch: 7 | loss: 0.3804521
	speed: 0.0226s/iter; left time: 670.9478s
	iters: 2100, epoch: 7 | loss: 0.4384453
	speed: 0.0234s/iter; left time: 693.6882s
	iters: 2200, epoch: 7 | loss: 0.5175952
	speed: 0.0226s/iter; left time: 667.6940s
Epoch: 7 cost time: 51.71064734458923
Epoch: 7, Steps: 2263 | Train Loss: 0.6761528 Vali Loss: 0.5406787 Test Loss: 0.2412728
Validation loss decreased (0.543720 --> 0.540679).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.4973584
	speed: 0.0775s/iter; left time: 2272.1656s
	iters: 200, epoch: 8 | loss: 0.4204833
	speed: 0.0217s/iter; left time: 632.9619s
	iters: 300, epoch: 8 | loss: 0.5851796
	speed: 0.0218s/iter; left time: 635.0839s
	iters: 400, epoch: 8 | loss: 0.8282148
	speed: 0.0234s/iter; left time: 678.1287s
	iters: 500, epoch: 8 | loss: 0.4104927
	speed: 0.0239s/iter; left time: 690.8280s
	iters: 600, epoch: 8 | loss: 0.4085064
	speed: 0.0234s/iter; left time: 674.6025s
	iters: 700, epoch: 8 | loss: 0.8305603
	speed: 0.0225s/iter; left time: 645.7375s
	iters: 800, epoch: 8 | loss: 1.5009270
	speed: 0.0233s/iter; left time: 666.9368s
	iters: 900, epoch: 8 | loss: 0.4468611
	speed: 0.0235s/iter; left time: 670.7057s
	iters: 1000, epoch: 8 | loss: 0.4468825
	speed: 0.0216s/iter; left time: 615.0255s
	iters: 1100, epoch: 8 | loss: 0.4276873
	speed: 0.0235s/iter; left time: 664.6733s
	iters: 1200, epoch: 8 | loss: 0.3635991
	speed: 0.0248s/iter; left time: 699.0081s
	iters: 1300, epoch: 8 | loss: 0.3364686
	speed: 0.0230s/iter; left time: 646.9736s
	iters: 1400, epoch: 8 | loss: 0.4331198
	speed: 0.0238s/iter; left time: 666.0213s
	iters: 1500, epoch: 8 | loss: 1.4497594
	speed: 0.0227s/iter; left time: 634.4909s
	iters: 1600, epoch: 8 | loss: 0.3983602
	speed: 0.0217s/iter; left time: 603.9192s
	iters: 1700, epoch: 8 | loss: 0.9243672
	speed: 0.0225s/iter; left time: 624.6018s
	iters: 1800, epoch: 8 | loss: 0.5017958
	speed: 0.0228s/iter; left time: 630.4365s
	iters: 1900, epoch: 8 | loss: 0.8973639
	speed: 0.0187s/iter; left time: 515.8820s
	iters: 2000, epoch: 8 | loss: 0.4648801
	speed: 0.0215s/iter; left time: 588.9086s
	iters: 2100, epoch: 8 | loss: 0.4381084
	speed: 0.0223s/iter; left time: 608.6996s
	iters: 2200, epoch: 8 | loss: 0.7091944
	speed: 0.0212s/iter; left time: 577.7464s
Epoch: 8 cost time: 50.89719581604004
Epoch: 8, Steps: 2263 | Train Loss: 0.6243428 Vali Loss: 0.5386537 Test Loss: 0.2393196
Validation loss decreased (0.540679 --> 0.538654).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.9341668
	speed: 0.0784s/iter; left time: 2122.1064s
	iters: 200, epoch: 9 | loss: 0.4088420
	speed: 0.0210s/iter; left time: 567.0736s
	iters: 300, epoch: 9 | loss: 0.4890459
	speed: 0.0225s/iter; left time: 603.4729s
	iters: 400, epoch: 9 | loss: 0.3990192
	speed: 0.0218s/iter; left time: 582.3235s
	iters: 500, epoch: 9 | loss: 0.4171931
	speed: 0.0219s/iter; left time: 584.3147s
	iters: 600, epoch: 9 | loss: 0.3363759
	speed: 0.0216s/iter; left time: 573.4128s
	iters: 700, epoch: 9 | loss: 0.4190764
	speed: 0.0200s/iter; left time: 529.4281s
	iters: 800, epoch: 9 | loss: 0.3634948
	speed: 0.0242s/iter; left time: 638.9019s
	iters: 900, epoch: 9 | loss: 1.4560480
	speed: 0.0233s/iter; left time: 611.4666s
	iters: 1000, epoch: 9 | loss: 0.6471943
	speed: 0.0217s/iter; left time: 568.6244s
	iters: 1100, epoch: 9 | loss: 0.8845652
	speed: 0.0203s/iter; left time: 529.4453s
	iters: 1200, epoch: 9 | loss: 0.5637870
	speed: 0.0249s/iter; left time: 645.4662s
	iters: 1300, epoch: 9 | loss: 0.4660473
	speed: 0.0227s/iter; left time: 587.4696s
	iters: 1400, epoch: 9 | loss: 0.5448277
	speed: 0.0225s/iter; left time: 580.5588s
	iters: 1500, epoch: 9 | loss: 0.4271946
	speed: 0.0225s/iter; left time: 577.7514s
	iters: 1600, epoch: 9 | loss: 0.5293733
	speed: 0.0244s/iter; left time: 624.3895s
	iters: 1700, epoch: 9 | loss: 0.4267029
	speed: 0.0235s/iter; left time: 598.9607s
	iters: 1800, epoch: 9 | loss: 0.5767214
	speed: 0.0246s/iter; left time: 624.5286s
	iters: 1900, epoch: 9 | loss: 0.4758838
	speed: 0.0232s/iter; left time: 584.9685s
	iters: 2000, epoch: 9 | loss: 1.1381322
	speed: 0.0216s/iter; left time: 543.2023s
	iters: 2100, epoch: 9 | loss: 0.4971583
	speed: 0.0204s/iter; left time: 510.3935s
	iters: 2200, epoch: 9 | loss: 0.8849329
	speed: 0.0222s/iter; left time: 553.2591s
Epoch: 9 cost time: 50.387412309646606
Epoch: 9, Steps: 2263 | Train Loss: 0.6001111 Vali Loss: 0.5351006 Test Loss: 0.2393553
Validation loss decreased (0.538654 --> 0.535101).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 1.1111323
	speed: 0.0789s/iter; left time: 1955.8970s
	iters: 200, epoch: 10 | loss: 0.6221564
	speed: 0.0213s/iter; left time: 524.8970s
	iters: 300, epoch: 10 | loss: 0.4551836
	speed: 0.0196s/iter; left time: 482.5129s
	iters: 400, epoch: 10 | loss: 0.4401745
	speed: 0.0227s/iter; left time: 556.7337s
	iters: 500, epoch: 10 | loss: 0.4372691
	speed: 0.0231s/iter; left time: 563.8884s
	iters: 600, epoch: 10 | loss: 0.4543517
	speed: 0.0242s/iter; left time: 588.2394s
	iters: 700, epoch: 10 | loss: 0.2972192
	speed: 0.0191s/iter; left time: 462.9233s
	iters: 800, epoch: 10 | loss: 0.8464610
	speed: 0.0230s/iter; left time: 553.7021s
	iters: 900, epoch: 10 | loss: 1.5149598
	speed: 0.0231s/iter; left time: 553.9760s
	iters: 1000, epoch: 10 | loss: 0.5172126
	speed: 0.0200s/iter; left time: 476.9099s
	iters: 1100, epoch: 10 | loss: 0.2800774
	speed: 0.0226s/iter; left time: 537.3968s
	iters: 1200, epoch: 10 | loss: 0.3690088
	speed: 0.0226s/iter; left time: 536.2168s
	iters: 1300, epoch: 10 | loss: 0.5807142
	speed: 0.0224s/iter; left time: 528.2827s
	iters: 1400, epoch: 10 | loss: 0.3980810
	speed: 0.0232s/iter; left time: 545.1390s
	iters: 1500, epoch: 10 | loss: 0.5830534
	speed: 0.0237s/iter; left time: 553.2784s
	iters: 1600, epoch: 10 | loss: 0.2814595
	speed: 0.0230s/iter; left time: 535.9964s
	iters: 1700, epoch: 10 | loss: 0.5139750
	speed: 0.0243s/iter; left time: 563.3381s
	iters: 1800, epoch: 10 | loss: 0.4401995
	speed: 0.0237s/iter; left time: 547.9306s
	iters: 1900, epoch: 10 | loss: 0.4134626
	speed: 0.0242s/iter; left time: 556.2508s
	iters: 2000, epoch: 10 | loss: 0.3965147
	speed: 0.0230s/iter; left time: 525.8792s
	iters: 2100, epoch: 10 | loss: 0.4407279
	speed: 0.0229s/iter; left time: 522.8475s
	iters: 2200, epoch: 10 | loss: 0.9792989
	speed: 0.0191s/iter; left time: 434.4369s
Epoch: 10 cost time: 50.59632730484009
Epoch: 10, Steps: 2263 | Train Loss: 0.5882771 Vali Loss: 0.5363835 Test Loss: 0.2399771
EarlyStopping counter: 1 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.4109038
	speed: 0.0784s/iter; left time: 1766.2884s
	iters: 200, epoch: 11 | loss: 0.3978649
	speed: 0.0200s/iter; left time: 447.8787s
	iters: 300, epoch: 11 | loss: 0.5907551
	speed: 0.0213s/iter; left time: 476.3570s
	iters: 400, epoch: 11 | loss: 1.1604128
	speed: 0.0217s/iter; left time: 482.4321s
	iters: 500, epoch: 11 | loss: 0.4429122
	speed: 0.0223s/iter; left time: 493.8274s
	iters: 600, epoch: 11 | loss: 0.4594797
	speed: 0.0223s/iter; left time: 491.2926s
	iters: 700, epoch: 11 | loss: 0.3728832
	speed: 0.0227s/iter; left time: 497.6180s
	iters: 800, epoch: 11 | loss: 0.4356939
	speed: 0.0249s/iter; left time: 543.6569s
	iters: 900, epoch: 11 | loss: 0.4836309
	speed: 0.0248s/iter; left time: 538.8863s
	iters: 1000, epoch: 11 | loss: 0.4949846
	speed: 0.0239s/iter; left time: 516.6762s
	iters: 1100, epoch: 11 | loss: 0.4446403
	speed: 0.0245s/iter; left time: 528.2539s
	iters: 1200, epoch: 11 | loss: 0.9641113
	speed: 0.0244s/iter; left time: 523.0474s
	iters: 1300, epoch: 11 | loss: 0.4298916
	speed: 0.0248s/iter; left time: 529.4438s
	iters: 1400, epoch: 11 | loss: 0.5099302
	speed: 0.0228s/iter; left time: 483.6775s
	iters: 1500, epoch: 11 | loss: 1.0619628
	speed: 0.0227s/iter; left time: 478.6586s
	iters: 1600, epoch: 11 | loss: 0.4552616
	speed: 0.0248s/iter; left time: 520.7864s
	iters: 1700, epoch: 11 | loss: 0.3652360
	speed: 0.0248s/iter; left time: 519.6892s
	iters: 1800, epoch: 11 | loss: 0.4565568
	speed: 0.0231s/iter; left time: 480.3075s
	iters: 1900, epoch: 11 | loss: 1.2825595
	speed: 0.0200s/iter; left time: 415.4082s
	iters: 2000, epoch: 11 | loss: 1.0663183
	speed: 0.0252s/iter; left time: 519.0764s
	iters: 2100, epoch: 11 | loss: 0.5192933
	speed: 0.0216s/iter; left time: 443.8458s
	iters: 2200, epoch: 11 | loss: 0.3317250
	speed: 0.0201s/iter; left time: 410.2034s
Epoch: 11 cost time: 51.44912791252136
Epoch: 11, Steps: 2263 | Train Loss: 0.5848624 Vali Loss: 0.5363336 Test Loss: 0.2396818
EarlyStopping counter: 2 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.3922593
	speed: 0.0860s/iter; left time: 1743.5469s
	iters: 200, epoch: 12 | loss: 0.4781715
	speed: 0.0218s/iter; left time: 439.5831s
	iters: 300, epoch: 12 | loss: 0.4508821
	speed: 0.0211s/iter; left time: 422.7670s
	iters: 400, epoch: 12 | loss: 0.8330697
	speed: 0.0224s/iter; left time: 447.2124s
	iters: 500, epoch: 12 | loss: 0.3281312
	speed: 0.0231s/iter; left time: 459.8295s
	iters: 600, epoch: 12 | loss: 0.8826582
	speed: 0.0235s/iter; left time: 464.3351s
	iters: 700, epoch: 12 | loss: 0.4014391
	speed: 0.0237s/iter; left time: 465.3217s
	iters: 800, epoch: 12 | loss: 0.5820626
	speed: 0.0216s/iter; left time: 422.3864s
	iters: 900, epoch: 12 | loss: 0.4037114
	speed: 0.0256s/iter; left time: 498.9735s
	iters: 1000, epoch: 12 | loss: 0.5725539
	speed: 0.0231s/iter; left time: 447.8410s
	iters: 1100, epoch: 12 | loss: 0.4613774
	speed: 0.0229s/iter; left time: 440.3471s
	iters: 1200, epoch: 12 | loss: 0.3790030
	speed: 0.0220s/iter; left time: 421.6655s
	iters: 1300, epoch: 12 | loss: 0.3402693
	speed: 0.0210s/iter; left time: 400.0101s
	iters: 1400, epoch: 12 | loss: 0.9074315
	speed: 0.0221s/iter; left time: 419.9547s
	iters: 1500, epoch: 12 | loss: 0.4718827
	speed: 0.0217s/iter; left time: 409.9937s
	iters: 1600, epoch: 12 | loss: 0.4575650
	speed: 0.0231s/iter; left time: 434.2817s
	iters: 1700, epoch: 12 | loss: 0.5098492
	speed: 0.0225s/iter; left time: 420.9197s
	iters: 1800, epoch: 12 | loss: 0.4185781
	speed: 0.0217s/iter; left time: 402.1524s
	iters: 1900, epoch: 12 | loss: 0.4799578
	speed: 0.0211s/iter; left time: 390.5620s
	iters: 2000, epoch: 12 | loss: 0.4853541
	speed: 0.0221s/iter; left time: 405.9967s
	iters: 2100, epoch: 12 | loss: 0.4230751
	speed: 0.0219s/iter; left time: 399.7784s
	iters: 2200, epoch: 12 | loss: 0.7510028
	speed: 0.0211s/iter; left time: 383.0880s
Epoch: 12 cost time: 50.32756972312927
Epoch: 12, Steps: 2263 | Train Loss: 0.5830691 Vali Loss: 0.5352028 Test Loss: 0.2395424
EarlyStopping counter: 3 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.4252156
	speed: 0.0663s/iter; left time: 1193.1223s
	iters: 200, epoch: 13 | loss: 0.3795584
	speed: 0.0209s/iter; left time: 375.0284s
	iters: 300, epoch: 13 | loss: 0.5229748
	speed: 0.0219s/iter; left time: 389.9372s
	iters: 400, epoch: 13 | loss: 0.4026743
	speed: 0.0228s/iter; left time: 403.2196s
	iters: 500, epoch: 13 | loss: 0.5191307
	speed: 0.0218s/iter; left time: 383.0030s
	iters: 600, epoch: 13 | loss: 0.6738343
	speed: 0.0237s/iter; left time: 414.6984s
	iters: 700, epoch: 13 | loss: 0.3702790
	speed: 0.0237s/iter; left time: 412.1706s
	iters: 800, epoch: 13 | loss: 0.3439398
	speed: 0.0226s/iter; left time: 390.7883s
	iters: 900, epoch: 13 | loss: 0.4166750
	speed: 0.0217s/iter; left time: 372.7879s
	iters: 1000, epoch: 13 | loss: 0.4808041
	speed: 0.0215s/iter; left time: 368.2992s
	iters: 1100, epoch: 13 | loss: 0.8986609
	speed: 0.0207s/iter; left time: 352.2755s
	iters: 1200, epoch: 13 | loss: 0.3652584
	speed: 0.0223s/iter; left time: 377.1194s
	iters: 1300, epoch: 13 | loss: 0.9997081
	speed: 0.0213s/iter; left time: 357.2143s
	iters: 1400, epoch: 13 | loss: 0.5183405
	speed: 0.0238s/iter; left time: 398.3986s
	iters: 1500, epoch: 13 | loss: 0.3365289
	speed: 0.0237s/iter; left time: 393.4366s
	iters: 1600, epoch: 13 | loss: 0.4564980
	speed: 0.0240s/iter; left time: 395.5449s
	iters: 1700, epoch: 13 | loss: 0.8915428
	speed: 0.0233s/iter; left time: 382.1088s
	iters: 1800, epoch: 13 | loss: 0.5070822
	speed: 0.0222s/iter; left time: 361.5619s
	iters: 1900, epoch: 13 | loss: 0.4467073
	speed: 0.0224s/iter; left time: 363.6711s
	iters: 2000, epoch: 13 | loss: 0.4526062
	speed: 0.0240s/iter; left time: 387.1491s
	iters: 2100, epoch: 13 | loss: 1.0897396
	speed: 0.0227s/iter; left time: 364.0060s
	iters: 2200, epoch: 13 | loss: 0.9085760
	speed: 0.0221s/iter; left time: 351.2559s
Epoch: 13 cost time: 50.34477424621582
Epoch: 13, Steps: 2263 | Train Loss: 0.5821353 Vali Loss: 0.5352989 Test Loss: 0.2395394
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 1.1202805
	speed: 0.0902s/iter; left time: 1420.3271s
	iters: 200, epoch: 14 | loss: 0.3478886
	speed: 0.0223s/iter; left time: 348.3065s
	iters: 300, epoch: 14 | loss: 1.0854028
	speed: 0.0226s/iter; left time: 351.2088s
	iters: 400, epoch: 14 | loss: 1.1140894
	speed: 0.0229s/iter; left time: 353.3653s
	iters: 500, epoch: 14 | loss: 0.3364559
	speed: 0.0207s/iter; left time: 318.2085s
	iters: 600, epoch: 14 | loss: 0.9578424
	speed: 0.0215s/iter; left time: 327.5348s
	iters: 700, epoch: 14 | loss: 0.4749624
	speed: 0.0250s/iter; left time: 377.8310s
	iters: 800, epoch: 14 | loss: 0.4478316
	speed: 0.0215s/iter; left time: 323.1046s
	iters: 900, epoch: 14 | loss: 0.3918441
	speed: 0.0214s/iter; left time: 320.0284s
	iters: 1000, epoch: 14 | loss: 0.4125369
	speed: 0.0211s/iter; left time: 312.7049s
	iters: 1100, epoch: 14 | loss: 0.4815769
	speed: 0.0240s/iter; left time: 354.1815s
	iters: 1200, epoch: 14 | loss: 0.5274928
	speed: 0.0237s/iter; left time: 347.2173s
	iters: 1300, epoch: 14 | loss: 0.4397103
	speed: 0.0232s/iter; left time: 338.0079s
	iters: 1400, epoch: 14 | loss: 0.5470079
	speed: 0.0234s/iter; left time: 338.5524s
	iters: 1500, epoch: 14 | loss: 0.4488713
	speed: 0.0200s/iter; left time: 286.8495s
	iters: 1600, epoch: 14 | loss: 0.5622593
	speed: 0.0211s/iter; left time: 300.5024s
	iters: 1700, epoch: 14 | loss: 0.4354081
	speed: 0.0247s/iter; left time: 349.4896s
	iters: 1800, epoch: 14 | loss: 0.9979596
	speed: 0.0237s/iter; left time: 333.3609s
	iters: 1900, epoch: 14 | loss: 0.4061684
	speed: 0.0248s/iter; left time: 346.1547s
	iters: 2000, epoch: 14 | loss: 0.4599313
	speed: 0.0230s/iter; left time: 317.7723s
	iters: 2100, epoch: 14 | loss: 1.0657744
	speed: 0.0208s/iter; left time: 285.6042s
	iters: 2200, epoch: 14 | loss: 0.6430761
	speed: 0.0224s/iter; left time: 304.9642s
Epoch: 14 cost time: 50.69526267051697
Epoch: 14, Steps: 2263 | Train Loss: 0.5817159 Vali Loss: 0.5356312 Test Loss: 0.2394819
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : weather_336_336_NLinear_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3144<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10204
mse:0.23941321671009064, mae:0.27766183018684387
