Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTh2', data_path='ETTh2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.05, loss='mse', lradj='type1', model='Linear', model_id='ETTh2_336_192', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=192, root_path='./dataset/', save_pred_values=False, seed=15227, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTh2_336_192_Linear_ETTh2_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15227>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8113
val 2689
test 2689
	iters: 100, epoch: 1 | loss: 3.1311314
	speed: 0.0041s/iter; left time: 40.7669s
	iters: 200, epoch: 1 | loss: 2.7014880
	speed: 0.0045s/iter; left time: 44.4580s
	iters: 300, epoch: 1 | loss: 6.6197801
	speed: 0.0048s/iter; left time: 47.5375s
	iters: 400, epoch: 1 | loss: 22.4292793
	speed: 0.0035s/iter; left time: 33.9309s
	iters: 500, epoch: 1 | loss: 2.3272052
	speed: 0.0040s/iter; left time: 38.9499s
Epoch: 1 cost time: 2.1166129112243652
Epoch: 1, Steps: 507 | Train Loss: 8.3576342 Vali Loss: 3.8043776 Test Loss: 14.3858099
Validation loss decreased (inf --> 3.804378).  Saving model ...
Updating learning rate to 0.05
	iters: 100, epoch: 2 | loss: 2.7326300
	speed: 0.0077s/iter; left time: 73.7224s
	iters: 200, epoch: 2 | loss: 3.3370485
	speed: 0.0049s/iter; left time: 45.8491s
	iters: 300, epoch: 2 | loss: 4.4780684
	speed: 0.0045s/iter; left time: 41.6493s
	iters: 400, epoch: 2 | loss: 7.4537077
	speed: 0.0038s/iter; left time: 35.4423s
	iters: 500, epoch: 2 | loss: 6.2641129
	speed: 0.0029s/iter; left time: 26.4887s
Epoch: 2 cost time: 2.047292470932007
Epoch: 2, Steps: 507 | Train Loss: 7.1192939 Vali Loss: 11.2004585 Test Loss: 19.9536095
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.025
	iters: 100, epoch: 3 | loss: 0.8601903
	speed: 0.0076s/iter; left time: 68.5319s
	iters: 200, epoch: 3 | loss: 0.7048569
	speed: 0.0041s/iter; left time: 36.1775s
	iters: 300, epoch: 3 | loss: 0.8271939
	speed: 0.0043s/iter; left time: 37.5149s
	iters: 400, epoch: 3 | loss: 1.0138667
	speed: 0.0044s/iter; left time: 38.0496s
	iters: 500, epoch: 3 | loss: 1.9447435
	speed: 0.0040s/iter; left time: 34.6166s
Epoch: 3 cost time: 2.0815210342407227
Epoch: 3, Steps: 507 | Train Loss: 1.0835221 Vali Loss: 0.8385450 Test Loss: 1.5115372
Validation loss decreased (3.804378 --> 0.838545).  Saving model ...
Updating learning rate to 0.0125
	iters: 100, epoch: 4 | loss: 0.4856880
	speed: 0.0084s/iter; left time: 71.4273s
	iters: 200, epoch: 4 | loss: 0.5257570
	speed: 0.0047s/iter; left time: 39.3919s
	iters: 300, epoch: 4 | loss: 0.4093425
	speed: 0.0048s/iter; left time: 39.7041s
	iters: 400, epoch: 4 | loss: 1.6033294
	speed: 0.0042s/iter; left time: 34.5240s
	iters: 500, epoch: 4 | loss: 0.6540092
	speed: 0.0039s/iter; left time: 31.2621s
Epoch: 4 cost time: 2.2044639587402344
Epoch: 4, Steps: 507 | Train Loss: 0.6471632 Vali Loss: 0.9400756 Test Loss: 1.6167310
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00625
	iters: 100, epoch: 5 | loss: 0.4082016
	speed: 0.0078s/iter; left time: 62.7041s
	iters: 200, epoch: 5 | loss: 0.4141338
	speed: 0.0040s/iter; left time: 31.4405s
	iters: 300, epoch: 5 | loss: 0.5733618
	speed: 0.0042s/iter; left time: 32.5855s
	iters: 400, epoch: 5 | loss: 0.4690539
	speed: 0.0046s/iter; left time: 35.8654s
	iters: 500, epoch: 5 | loss: 0.6816235
	speed: 0.0042s/iter; left time: 31.6838s
Epoch: 5 cost time: 2.100573778152466
Epoch: 5, Steps: 507 | Train Loss: 0.5339270 Vali Loss: 0.5182044 Test Loss: 1.1571742
Validation loss decreased (0.838545 --> 0.518204).  Saving model ...
Updating learning rate to 0.003125
	iters: 100, epoch: 6 | loss: 0.8061154
	speed: 0.0079s/iter; left time: 59.6358s
	iters: 200, epoch: 6 | loss: 0.3154390
	speed: 0.0042s/iter; left time: 30.7351s
	iters: 300, epoch: 6 | loss: 0.3809698
	speed: 0.0041s/iter; left time: 29.8086s
	iters: 400, epoch: 6 | loss: 0.3716330
	speed: 0.0047s/iter; left time: 33.6037s
	iters: 500, epoch: 6 | loss: 0.4238028
	speed: 0.0043s/iter; left time: 30.6269s
Epoch: 6 cost time: 2.142653703689575
Epoch: 6, Steps: 507 | Train Loss: 0.4913844 Vali Loss: 0.6065101 Test Loss: 1.3023127
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0015625
	iters: 100, epoch: 7 | loss: 0.5549323
	speed: 0.0089s/iter; left time: 62.2397s
	iters: 200, epoch: 7 | loss: 0.4847368
	speed: 0.0042s/iter; left time: 28.6485s
	iters: 300, epoch: 7 | loss: 0.2187380
	speed: 0.0045s/iter; left time: 30.9353s
	iters: 400, epoch: 7 | loss: 1.1003923
	speed: 0.0043s/iter; left time: 28.9572s
	iters: 500, epoch: 7 | loss: 0.4624313
	speed: 0.0044s/iter; left time: 28.9694s
Epoch: 7 cost time: 2.1805148124694824
Epoch: 7, Steps: 507 | Train Loss: 0.4711977 Vali Loss: 0.4865728 Test Loss: 1.0527560
Validation loss decreased (0.518204 --> 0.486573).  Saving model ...
Updating learning rate to 0.00078125
	iters: 100, epoch: 8 | loss: 0.2786977
	speed: 0.0087s/iter; left time: 56.5862s
	iters: 200, epoch: 8 | loss: 0.3581299
	speed: 0.0046s/iter; left time: 29.6590s
	iters: 300, epoch: 8 | loss: 0.3481502
	speed: 0.0045s/iter; left time: 28.3952s
	iters: 400, epoch: 8 | loss: 0.3771458
	speed: 0.0044s/iter; left time: 27.1728s
	iters: 500, epoch: 8 | loss: 0.8485015
	speed: 0.0042s/iter; left time: 25.3563s
Epoch: 8 cost time: 2.2419474124908447
Epoch: 8, Steps: 507 | Train Loss: 0.4587941 Vali Loss: 0.4308392 Test Loss: 0.6940287
Validation loss decreased (0.486573 --> 0.430839).  Saving model ...
Updating learning rate to 0.000390625
	iters: 100, epoch: 9 | loss: 0.2239364
	speed: 0.0091s/iter; left time: 54.3611s
	iters: 200, epoch: 9 | loss: 0.3889163
	speed: 0.0035s/iter; left time: 20.6563s
	iters: 300, epoch: 9 | loss: 0.5868395
	speed: 0.0037s/iter; left time: 21.1732s
	iters: 400, epoch: 9 | loss: 0.3740018
	speed: 0.0036s/iter; left time: 20.5927s
	iters: 500, epoch: 9 | loss: 0.6872686
	speed: 0.0038s/iter; left time: 21.3934s
Epoch: 9 cost time: 1.9265711307525635
Epoch: 9, Steps: 507 | Train Loss: 0.4521466 Vali Loss: 0.4083617 Test Loss: 0.7026219
Validation loss decreased (0.430839 --> 0.408362).  Saving model ...
Updating learning rate to 0.0001953125
	iters: 100, epoch: 10 | loss: 0.8227303
	speed: 0.0088s/iter; left time: 47.9986s
	iters: 200, epoch: 10 | loss: 0.2745300
	speed: 0.0042s/iter; left time: 22.5248s
	iters: 300, epoch: 10 | loss: 0.3500131
	speed: 0.0037s/iter; left time: 19.6984s
	iters: 400, epoch: 10 | loss: 0.2177272
	speed: 0.0042s/iter; left time: 21.7476s
	iters: 500, epoch: 10 | loss: 0.3884059
	speed: 0.0044s/iter; left time: 22.2555s
Epoch: 10 cost time: 2.0533175468444824
Epoch: 10, Steps: 507 | Train Loss: 0.4485637 Vali Loss: 0.3737935 Test Loss: 0.5408362
Validation loss decreased (0.408362 --> 0.373794).  Saving model ...
Updating learning rate to 9.765625e-05
	iters: 100, epoch: 11 | loss: 0.3972637
	speed: 0.0092s/iter; left time: 45.5312s
	iters: 200, epoch: 11 | loss: 0.3183736
	speed: 0.0043s/iter; left time: 20.8639s
	iters: 300, epoch: 11 | loss: 0.5797502
	speed: 0.0045s/iter; left time: 21.5173s
	iters: 400, epoch: 11 | loss: 0.2541559
	speed: 0.0042s/iter; left time: 19.7733s
	iters: 500, epoch: 11 | loss: 0.6077477
	speed: 0.0045s/iter; left time: 20.6638s
Epoch: 11 cost time: 2.247713327407837
Epoch: 11, Steps: 507 | Train Loss: 0.4460245 Vali Loss: 0.3935668 Test Loss: 0.5951679
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.8828125e-05
	iters: 100, epoch: 12 | loss: 0.2845804
	speed: 0.0084s/iter; left time: 37.5724s
	iters: 200, epoch: 12 | loss: 0.5499474
	speed: 0.0042s/iter; left time: 18.5469s
	iters: 300, epoch: 12 | loss: 0.2536529
	speed: 0.0044s/iter; left time: 18.5582s
	iters: 400, epoch: 12 | loss: 0.6990401
	speed: 0.0046s/iter; left time: 19.3210s
	iters: 500, epoch: 12 | loss: 0.9176205
	speed: 0.0045s/iter; left time: 18.1087s
Epoch: 12 cost time: 2.2101376056671143
Epoch: 12, Steps: 507 | Train Loss: 0.4443630 Vali Loss: 0.3957174 Test Loss: 0.6248084
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.44140625e-05
	iters: 100, epoch: 13 | loss: 0.2676086
	speed: 0.0086s/iter; left time: 33.8864s
	iters: 200, epoch: 13 | loss: 0.2442229
	speed: 0.0047s/iter; left time: 18.3207s
	iters: 300, epoch: 13 | loss: 0.7409180
	speed: 0.0046s/iter; left time: 17.2591s
	iters: 400, epoch: 13 | loss: 0.5413217
	speed: 0.0043s/iter; left time: 15.7616s
	iters: 500, epoch: 13 | loss: 0.3600065
	speed: 0.0041s/iter; left time: 14.7260s
Epoch: 13 cost time: 2.2287490367889404
Epoch: 13, Steps: 507 | Train Loss: 0.4435665 Vali Loss: 0.3886407 Test Loss: 0.5908871
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.220703125e-05
	iters: 100, epoch: 14 | loss: 0.8705922
	speed: 0.0087s/iter; left time: 30.1603s
	iters: 200, epoch: 14 | loss: 0.4394709
	speed: 0.0040s/iter; left time: 13.3776s
	iters: 300, epoch: 14 | loss: 0.4554205
	speed: 0.0041s/iter; left time: 13.4561s
	iters: 400, epoch: 14 | loss: 0.2860340
	speed: 0.0040s/iter; left time: 12.6811s
	iters: 500, epoch: 14 | loss: 0.3290366
	speed: 0.0038s/iter; left time: 11.6474s
Epoch: 14 cost time: 2.0878217220306396
Epoch: 14, Steps: 507 | Train Loss: 0.4429777 Vali Loss: 0.3875985 Test Loss: 0.5884746
EarlyStopping counter: 4 out of 5
Updating learning rate to 6.103515625e-06
	iters: 100, epoch: 15 | loss: 0.2551455
	speed: 0.0078s/iter; left time: 22.8133s
	iters: 200, epoch: 15 | loss: 0.2239565
	speed: 0.0038s/iter; left time: 10.6897s
	iters: 300, epoch: 15 | loss: 0.2762936
	speed: 0.0035s/iter; left time: 9.5457s
	iters: 400, epoch: 15 | loss: 0.3216393
	speed: 0.0035s/iter; left time: 9.2867s
	iters: 500, epoch: 15 | loss: 0.2632585
	speed: 0.0032s/iter; left time: 8.1122s
Epoch: 15 cost time: 1.7905263900756836
Epoch: 15, Steps: 507 | Train Loss: 0.4428456 Vali Loss: 0.3862649 Test Loss: 0.5860660
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTh2_336_192_Linear_ETTh2_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15227<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2689
mse:0.5419376492500305, mae:0.49255844950675964
