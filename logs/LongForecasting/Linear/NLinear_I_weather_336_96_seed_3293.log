Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='NLinear', model_id='weather_336_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=3293, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : weather_336_96_NLinear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3293>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36456
val 5175
test 10444
	iters: 100, epoch: 1 | loss: 55.5397568
	speed: 0.0094s/iter; left time: 425.5083s
	iters: 200, epoch: 1 | loss: 1.6161559
	speed: 0.0100s/iter; left time: 451.8449s
	iters: 300, epoch: 1 | loss: 0.5051351
	speed: 0.0103s/iter; left time: 467.6239s
	iters: 400, epoch: 1 | loss: 4.7706566
	speed: 0.0103s/iter; left time: 464.3718s
	iters: 500, epoch: 1 | loss: 2.8508434
	speed: 0.0072s/iter; left time: 325.3644s
	iters: 600, epoch: 1 | loss: 2.2630427
	speed: 0.0086s/iter; left time: 387.2099s
	iters: 700, epoch: 1 | loss: 0.5521842
	speed: 0.0093s/iter; left time: 418.6625s
	iters: 800, epoch: 1 | loss: 0.6374422
	speed: 0.0087s/iter; left time: 387.7378s
	iters: 900, epoch: 1 | loss: 0.9527188
	speed: 0.0102s/iter; left time: 456.9772s
	iters: 1000, epoch: 1 | loss: 8.4213963
	speed: 0.0088s/iter; left time: 392.2929s
	iters: 1100, epoch: 1 | loss: 0.3385118
	speed: 0.0086s/iter; left time: 382.9657s
	iters: 1200, epoch: 1 | loss: 1.3084046
	speed: 0.0101s/iter; left time: 446.8098s
	iters: 1300, epoch: 1 | loss: 0.4978590
	speed: 0.0096s/iter; left time: 424.8995s
	iters: 1400, epoch: 1 | loss: 0.4653563
	speed: 0.0097s/iter; left time: 427.4831s
	iters: 1500, epoch: 1 | loss: 0.4677746
	speed: 0.0104s/iter; left time: 456.0343s
	iters: 1600, epoch: 1 | loss: 0.3150283
	speed: 0.0113s/iter; left time: 497.7930s
	iters: 1700, epoch: 1 | loss: 0.3462694
	speed: 0.0102s/iter; left time: 446.6273s
	iters: 1800, epoch: 1 | loss: 0.8309385
	speed: 0.0095s/iter; left time: 417.0470s
	iters: 1900, epoch: 1 | loss: 2.8051167
	speed: 0.0099s/iter; left time: 433.5682s
	iters: 2000, epoch: 1 | loss: 0.3093755
	speed: 0.0097s/iter; left time: 420.4507s
	iters: 2100, epoch: 1 | loss: 0.6910211
	speed: 0.0088s/iter; left time: 383.4721s
	iters: 2200, epoch: 1 | loss: 1.0077024
	speed: 0.0093s/iter; left time: 402.8435s
Epoch: 1 cost time: 21.65389394760132
Epoch: 1, Steps: 2278 | Train Loss: 2.4620321 Vali Loss: 0.5200750 Test Loss: 0.2164052
Validation loss decreased (inf --> 0.520075).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.3853281
	speed: 0.0376s/iter; left time: 1625.3758s
	iters: 200, epoch: 2 | loss: 3.1570683
	speed: 0.0086s/iter; left time: 368.5231s
	iters: 300, epoch: 2 | loss: 1.7477280
	speed: 0.0095s/iter; left time: 406.7660s
	iters: 400, epoch: 2 | loss: 0.8081762
	speed: 0.0097s/iter; left time: 417.3158s
	iters: 500, epoch: 2 | loss: 0.5149621
	speed: 0.0106s/iter; left time: 452.3059s
	iters: 600, epoch: 2 | loss: 0.4382588
	speed: 0.0098s/iter; left time: 417.4476s
	iters: 700, epoch: 2 | loss: 2.9027643
	speed: 0.0096s/iter; left time: 410.1844s
	iters: 800, epoch: 2 | loss: 0.6889163
	speed: 0.0105s/iter; left time: 447.8501s
	iters: 900, epoch: 2 | loss: 0.4656271
	speed: 0.0085s/iter; left time: 360.3883s
	iters: 1000, epoch: 2 | loss: 0.7183093
	speed: 0.0093s/iter; left time: 395.0729s
	iters: 1100, epoch: 2 | loss: 0.3673218
	speed: 0.0104s/iter; left time: 438.7992s
	iters: 1200, epoch: 2 | loss: 0.5965973
	speed: 0.0098s/iter; left time: 414.2014s
	iters: 1300, epoch: 2 | loss: 1.6919981
	speed: 0.0089s/iter; left time: 371.5541s
	iters: 1400, epoch: 2 | loss: 0.5199767
	speed: 0.0082s/iter; left time: 341.4572s
	iters: 1500, epoch: 2 | loss: 0.6138420
	speed: 0.0108s/iter; left time: 450.9470s
	iters: 1600, epoch: 2 | loss: 0.3772756
	speed: 0.0113s/iter; left time: 472.4251s
	iters: 1700, epoch: 2 | loss: 3.8595419
	speed: 0.0103s/iter; left time: 429.6533s
	iters: 1800, epoch: 2 | loss: 1.6326165
	speed: 0.0079s/iter; left time: 325.7092s
	iters: 1900, epoch: 2 | loss: 0.3706871
	speed: 0.0071s/iter; left time: 295.4873s
	iters: 2000, epoch: 2 | loss: 0.4561551
	speed: 0.0089s/iter; left time: 367.9246s
	iters: 2100, epoch: 2 | loss: 0.7309294
	speed: 0.0091s/iter; left time: 375.6721s
	iters: 2200, epoch: 2 | loss: 0.4642442
	speed: 0.0093s/iter; left time: 381.2313s
Epoch: 2 cost time: 21.40280795097351
Epoch: 2, Steps: 2278 | Train Loss: 15.4766211 Vali Loss: 0.5239176 Test Loss: 0.2314816
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.3123559
	speed: 0.0433s/iter; left time: 1769.5952s
	iters: 200, epoch: 3 | loss: 0.8382872
	speed: 0.0106s/iter; left time: 431.4299s
	iters: 300, epoch: 3 | loss: 0.8806851
	speed: 0.0098s/iter; left time: 398.5608s
	iters: 400, epoch: 3 | loss: 2.7693667
	speed: 0.0084s/iter; left time: 339.5166s
	iters: 500, epoch: 3 | loss: 0.2158050
	speed: 0.0100s/iter; left time: 405.9842s
	iters: 600, epoch: 3 | loss: 0.3018929
	speed: 0.0104s/iter; left time: 419.5199s
	iters: 700, epoch: 3 | loss: 0.4723485
	speed: 0.0102s/iter; left time: 411.2252s
	iters: 800, epoch: 3 | loss: 0.3511056
	speed: 0.0095s/iter; left time: 382.8845s
	iters: 900, epoch: 3 | loss: 0.2897961
	speed: 0.0097s/iter; left time: 387.3201s
	iters: 1000, epoch: 3 | loss: 0.4496302
	speed: 0.0086s/iter; left time: 344.4572s
	iters: 1100, epoch: 3 | loss: 0.2527071
	speed: 0.0086s/iter; left time: 342.4855s
	iters: 1200, epoch: 3 | loss: 0.4425041
	speed: 0.0085s/iter; left time: 338.8578s
	iters: 1300, epoch: 3 | loss: 0.2470335
	speed: 0.0094s/iter; left time: 371.7473s
	iters: 1400, epoch: 3 | loss: 0.3294173
	speed: 0.0103s/iter; left time: 408.8613s
	iters: 1500, epoch: 3 | loss: 0.3485980
	speed: 0.0092s/iter; left time: 363.5528s
	iters: 1600, epoch: 3 | loss: 0.2899053
	speed: 0.0090s/iter; left time: 353.9126s
	iters: 1700, epoch: 3 | loss: 0.3147182
	speed: 0.0095s/iter; left time: 371.9207s
	iters: 1800, epoch: 3 | loss: 0.5664843
	speed: 0.0085s/iter; left time: 331.6008s
	iters: 1900, epoch: 3 | loss: 0.3676091
	speed: 0.0094s/iter; left time: 369.2686s
	iters: 2000, epoch: 3 | loss: 0.9072669
	speed: 0.0098s/iter; left time: 384.0114s
	iters: 2100, epoch: 3 | loss: 2.3002615
	speed: 0.0094s/iter; left time: 364.1789s
	iters: 2200, epoch: 3 | loss: 0.5649666
	speed: 0.0092s/iter; left time: 355.5573s
Epoch: 3 cost time: 21.54590344429016
Epoch: 3, Steps: 2278 | Train Loss: 63.3743496 Vali Loss: 0.4935139 Test Loss: 0.1782677
Validation loss decreased (0.520075 --> 0.493514).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.3884844
	speed: 0.0349s/iter; left time: 1347.3260s
	iters: 200, epoch: 4 | loss: 0.2586877
	speed: 0.0085s/iter; left time: 325.5747s
	iters: 300, epoch: 4 | loss: 0.4880728
	speed: 0.0106s/iter; left time: 405.9418s
	iters: 400, epoch: 4 | loss: 0.4197730
	speed: 0.0084s/iter; left time: 320.1805s
	iters: 500, epoch: 4 | loss: 0.4106306
	speed: 0.0097s/iter; left time: 368.9929s
	iters: 600, epoch: 4 | loss: 0.5222989
	speed: 0.0094s/iter; left time: 357.2922s
	iters: 700, epoch: 4 | loss: 0.2453838
	speed: 0.0085s/iter; left time: 323.7597s
	iters: 800, epoch: 4 | loss: 0.2680389
	speed: 0.0085s/iter; left time: 323.6167s
	iters: 900, epoch: 4 | loss: 0.4890196
	speed: 0.0087s/iter; left time: 330.3203s
	iters: 1000, epoch: 4 | loss: 0.3105473
	speed: 0.0084s/iter; left time: 318.1695s
	iters: 1100, epoch: 4 | loss: 0.4388871
	speed: 0.0083s/iter; left time: 310.8935s
	iters: 1200, epoch: 4 | loss: 0.7288870
	speed: 0.0086s/iter; left time: 321.9804s
	iters: 1300, epoch: 4 | loss: 0.3406200
	speed: 0.0091s/iter; left time: 339.3164s
	iters: 1400, epoch: 4 | loss: 0.3647417
	speed: 0.0086s/iter; left time: 319.9894s
	iters: 1500, epoch: 4 | loss: 0.3268270
	speed: 0.0086s/iter; left time: 318.3675s
	iters: 1600, epoch: 4 | loss: 0.3081421
	speed: 0.0092s/iter; left time: 342.0324s
	iters: 1700, epoch: 4 | loss: 0.4066476
	speed: 0.0104s/iter; left time: 383.7308s
	iters: 1800, epoch: 4 | loss: 0.2685315
	speed: 0.0081s/iter; left time: 298.4572s
	iters: 1900, epoch: 4 | loss: 2.3243434
	speed: 0.0087s/iter; left time: 319.3091s
	iters: 2000, epoch: 4 | loss: 0.3325505
	speed: 0.0101s/iter; left time: 370.2980s
	iters: 2100, epoch: 4 | loss: 0.4518891
	speed: 0.0101s/iter; left time: 371.1636s
	iters: 2200, epoch: 4 | loss: 7.7615781
	speed: 0.0101s/iter; left time: 370.4897s
Epoch: 4 cost time: 20.6598162651062
Epoch: 4, Steps: 2278 | Train Loss: 6.1646032 Vali Loss: 1.7798659 Test Loss: 0.1801227
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.5853589
	speed: 0.0392s/iter; left time: 1426.2639s
	iters: 200, epoch: 5 | loss: 0.1944646
	speed: 0.0096s/iter; left time: 348.7876s
	iters: 300, epoch: 5 | loss: 0.2282428
	speed: 0.0103s/iter; left time: 370.6214s
	iters: 400, epoch: 5 | loss: 0.4527039
	speed: 0.0081s/iter; left time: 293.3911s
	iters: 500, epoch: 5 | loss: 0.5564224
	speed: 0.0096s/iter; left time: 344.8454s
	iters: 600, epoch: 5 | loss: 0.3042152
	speed: 0.0085s/iter; left time: 305.8953s
	iters: 700, epoch: 5 | loss: 0.1980885
	speed: 0.0078s/iter; left time: 279.1487s
	iters: 800, epoch: 5 | loss: 0.5010801
	speed: 0.0085s/iter; left time: 302.0378s
	iters: 900, epoch: 5 | loss: 0.3789001
	speed: 0.0084s/iter; left time: 299.7546s
	iters: 1000, epoch: 5 | loss: 0.3900932
	speed: 0.0105s/iter; left time: 371.1925s
	iters: 1100, epoch: 5 | loss: 0.5737194
	speed: 0.0105s/iter; left time: 372.5841s
	iters: 1200, epoch: 5 | loss: 0.2273172
	speed: 0.0109s/iter; left time: 383.2419s
	iters: 1300, epoch: 5 | loss: 0.3713970
	speed: 0.0111s/iter; left time: 390.3271s
	iters: 1400, epoch: 5 | loss: 0.2449756
	speed: 0.0097s/iter; left time: 339.2620s
	iters: 1500, epoch: 5 | loss: 0.3449564
	speed: 0.0089s/iter; left time: 310.3621s
	iters: 1600, epoch: 5 | loss: 2.3193233
	speed: 0.0091s/iter; left time: 317.5694s
	iters: 1700, epoch: 5 | loss: 0.5765152
	speed: 0.0096s/iter; left time: 332.6395s
	iters: 1800, epoch: 5 | loss: 0.6161417
	speed: 0.0098s/iter; left time: 338.8817s
	iters: 1900, epoch: 5 | loss: 0.2627356
	speed: 0.0104s/iter; left time: 358.7473s
	iters: 2000, epoch: 5 | loss: 0.2611575
	speed: 0.0098s/iter; left time: 335.9397s
	iters: 2100, epoch: 5 | loss: 4.0680861
	speed: 0.0100s/iter; left time: 342.3762s
	iters: 2200, epoch: 5 | loss: 0.3745962
	speed: 0.0082s/iter; left time: 279.2127s
Epoch: 5 cost time: 21.47550106048584
Epoch: 5, Steps: 2278 | Train Loss: 0.9686370 Vali Loss: 0.3867624 Test Loss: 0.1472697
Validation loss decreased (0.493514 --> 0.386762).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.2262681
	speed: 0.0375s/iter; left time: 1276.8850s
	iters: 200, epoch: 6 | loss: 0.2314461
	speed: 0.0092s/iter; left time: 313.9441s
	iters: 300, epoch: 6 | loss: 0.3160153
	speed: 0.0088s/iter; left time: 297.8101s
	iters: 400, epoch: 6 | loss: 0.2600439
	speed: 0.0076s/iter; left time: 256.0515s
	iters: 500, epoch: 6 | loss: 0.2310906
	speed: 0.0098s/iter; left time: 328.2958s
	iters: 600, epoch: 6 | loss: 0.2275631
	speed: 0.0097s/iter; left time: 326.6785s
	iters: 700, epoch: 6 | loss: 0.5388442
	speed: 0.0100s/iter; left time: 334.7781s
	iters: 800, epoch: 6 | loss: 0.4769026
	speed: 0.0092s/iter; left time: 306.4892s
	iters: 900, epoch: 6 | loss: 0.5477951
	speed: 0.0093s/iter; left time: 308.7964s
	iters: 1000, epoch: 6 | loss: 0.2817890
	speed: 0.0091s/iter; left time: 303.2006s
	iters: 1100, epoch: 6 | loss: 0.2638077
	speed: 0.0093s/iter; left time: 306.8401s
	iters: 1200, epoch: 6 | loss: 0.6753353
	speed: 0.0086s/iter; left time: 282.6392s
	iters: 1300, epoch: 6 | loss: 0.3088619
	speed: 0.0087s/iter; left time: 286.4253s
	iters: 1400, epoch: 6 | loss: 0.3623416
	speed: 0.0093s/iter; left time: 305.2222s
	iters: 1500, epoch: 6 | loss: 0.8282837
	speed: 0.0107s/iter; left time: 349.6845s
	iters: 1600, epoch: 6 | loss: 0.4427005
	speed: 0.0108s/iter; left time: 352.1217s
	iters: 1700, epoch: 6 | loss: 2.2225354
	speed: 0.0109s/iter; left time: 353.3044s
	iters: 1800, epoch: 6 | loss: 0.8219779
	speed: 0.0098s/iter; left time: 316.9687s
	iters: 1900, epoch: 6 | loss: 0.2596987
	speed: 0.0093s/iter; left time: 299.5591s
	iters: 2000, epoch: 6 | loss: 0.3062875
	speed: 0.0106s/iter; left time: 340.1340s
	iters: 2100, epoch: 6 | loss: 0.1840175
	speed: 0.0082s/iter; left time: 264.0196s
	iters: 2200, epoch: 6 | loss: 0.4712311
	speed: 0.0097s/iter; left time: 310.2314s
Epoch: 6 cost time: 21.34937334060669
Epoch: 6, Steps: 2278 | Train Loss: 0.5400949 Vali Loss: 0.3900297 Test Loss: 0.1452256
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.2461426
	speed: 0.0350s/iter; left time: 1112.3915s
	iters: 200, epoch: 7 | loss: 0.2374935
	speed: 0.0102s/iter; left time: 322.6947s
	iters: 300, epoch: 7 | loss: 0.2821035
	speed: 0.0093s/iter; left time: 292.9702s
	iters: 400, epoch: 7 | loss: 0.2171422
	speed: 0.0094s/iter; left time: 297.3722s
	iters: 500, epoch: 7 | loss: 0.3345212
	speed: 0.0084s/iter; left time: 264.9575s
	iters: 600, epoch: 7 | loss: 0.7538346
	speed: 0.0082s/iter; left time: 255.1358s
	iters: 700, epoch: 7 | loss: 0.2589051
	speed: 0.0089s/iter; left time: 277.6995s
	iters: 800, epoch: 7 | loss: 0.2888130
	speed: 0.0086s/iter; left time: 266.2392s
	iters: 900, epoch: 7 | loss: 0.3339763
	speed: 0.0084s/iter; left time: 261.0403s
	iters: 1000, epoch: 7 | loss: 0.2119745
	speed: 0.0083s/iter; left time: 257.4077s
	iters: 1100, epoch: 7 | loss: 0.4864228
	speed: 0.0083s/iter; left time: 254.0592s
	iters: 1200, epoch: 7 | loss: 0.4137207
	speed: 0.0096s/iter; left time: 294.7557s
	iters: 1300, epoch: 7 | loss: 0.3908304
	speed: 0.0091s/iter; left time: 278.1473s
	iters: 1400, epoch: 7 | loss: 0.2455934
	speed: 0.0089s/iter; left time: 271.1571s
	iters: 1500, epoch: 7 | loss: 0.5023532
	speed: 0.0089s/iter; left time: 271.1932s
	iters: 1600, epoch: 7 | loss: 0.3420785
	speed: 0.0092s/iter; left time: 279.0791s
	iters: 1700, epoch: 7 | loss: 0.7012842
	speed: 0.0087s/iter; left time: 262.3869s
	iters: 1800, epoch: 7 | loss: 0.3387411
	speed: 0.0097s/iter; left time: 291.6700s
	iters: 1900, epoch: 7 | loss: 3.9303520
	speed: 0.0092s/iter; left time: 277.1627s
	iters: 2000, epoch: 7 | loss: 0.3371718
	speed: 0.0089s/iter; left time: 264.7713s
	iters: 2100, epoch: 7 | loss: 0.2344801
	speed: 0.0101s/iter; left time: 301.8358s
	iters: 2200, epoch: 7 | loss: 0.2347150
	speed: 0.0088s/iter; left time: 261.0829s
Epoch: 7 cost time: 20.569966077804565
Epoch: 7, Steps: 2278 | Train Loss: 0.4503615 Vali Loss: 0.3857585 Test Loss: 0.1452104
Validation loss decreased (0.386762 --> 0.385759).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.3253352
	speed: 0.0377s/iter; left time: 1112.9312s
	iters: 200, epoch: 8 | loss: 0.2690887
	speed: 0.0077s/iter; left time: 227.5068s
	iters: 300, epoch: 8 | loss: 0.3179400
	speed: 0.0092s/iter; left time: 269.7922s
	iters: 400, epoch: 8 | loss: 0.2910812
	speed: 0.0086s/iter; left time: 251.0283s
	iters: 500, epoch: 8 | loss: 0.3167824
	speed: 0.0085s/iter; left time: 248.1219s
	iters: 600, epoch: 8 | loss: 0.2496907
	speed: 0.0093s/iter; left time: 269.3176s
	iters: 700, epoch: 8 | loss: 0.3661452
	speed: 0.0087s/iter; left time: 252.4414s
	iters: 800, epoch: 8 | loss: 0.2425713
	speed: 0.0087s/iter; left time: 251.7990s
	iters: 900, epoch: 8 | loss: 0.4084688
	speed: 0.0087s/iter; left time: 248.4408s
	iters: 1000, epoch: 8 | loss: 0.2662486
	speed: 0.0092s/iter; left time: 263.0586s
	iters: 1100, epoch: 8 | loss: 0.2011891
	speed: 0.0096s/iter; left time: 273.4886s
	iters: 1200, epoch: 8 | loss: 0.7027977
	speed: 0.0093s/iter; left time: 264.0803s
	iters: 1300, epoch: 8 | loss: 0.3142923
	speed: 0.0089s/iter; left time: 251.7459s
	iters: 1400, epoch: 8 | loss: 0.2631797
	speed: 0.0089s/iter; left time: 249.7497s
	iters: 1500, epoch: 8 | loss: 0.2812530
	speed: 0.0092s/iter; left time: 257.9856s
	iters: 1600, epoch: 8 | loss: 0.4974761
	speed: 0.0099s/iter; left time: 276.4575s
	iters: 1700, epoch: 8 | loss: 0.3103198
	speed: 0.0089s/iter; left time: 248.7486s
	iters: 1800, epoch: 8 | loss: 0.2749378
	speed: 0.0085s/iter; left time: 235.8709s
	iters: 1900, epoch: 8 | loss: 0.2755348
	speed: 0.0106s/iter; left time: 293.3900s
	iters: 2000, epoch: 8 | loss: 0.2252857
	speed: 0.0108s/iter; left time: 297.9889s
	iters: 2100, epoch: 8 | loss: 0.2761222
	speed: 0.0111s/iter; left time: 305.7464s
	iters: 2200, epoch: 8 | loss: 0.3471709
	speed: 0.0109s/iter; left time: 298.2814s
Epoch: 8 cost time: 21.165196418762207
Epoch: 8, Steps: 2278 | Train Loss: 0.4450869 Vali Loss: 0.3766695 Test Loss: 0.1437279
Validation loss decreased (0.385759 --> 0.376669).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.2990056
	speed: 0.0440s/iter; left time: 1199.7039s
	iters: 200, epoch: 9 | loss: 0.2041557
	speed: 0.0093s/iter; left time: 251.6066s
	iters: 300, epoch: 9 | loss: 0.2665328
	speed: 0.0100s/iter; left time: 269.8301s
	iters: 400, epoch: 9 | loss: 0.1951792
	speed: 0.0096s/iter; left time: 258.4081s
	iters: 500, epoch: 9 | loss: 0.1763535
	speed: 0.0088s/iter; left time: 236.0263s
	iters: 600, epoch: 9 | loss: 0.3829719
	speed: 0.0084s/iter; left time: 225.4663s
	iters: 700, epoch: 9 | loss: 0.3054343
	speed: 0.0079s/iter; left time: 209.1818s
	iters: 800, epoch: 9 | loss: 0.2677125
	speed: 0.0083s/iter; left time: 219.1954s
	iters: 900, epoch: 9 | loss: 0.2707342
	speed: 0.0093s/iter; left time: 245.8948s
	iters: 1000, epoch: 9 | loss: 0.2108847
	speed: 0.0082s/iter; left time: 214.9723s
	iters: 1100, epoch: 9 | loss: 0.9540241
	speed: 0.0076s/iter; left time: 199.9952s
	iters: 1200, epoch: 9 | loss: 0.2747262
	speed: 0.0095s/iter; left time: 247.1125s
	iters: 1300, epoch: 9 | loss: 0.2760018
	speed: 0.0102s/iter; left time: 266.7226s
	iters: 1400, epoch: 9 | loss: 0.2617278
	speed: 0.0092s/iter; left time: 239.7320s
	iters: 1500, epoch: 9 | loss: 0.2264374
	speed: 0.0084s/iter; left time: 217.9044s
	iters: 1600, epoch: 9 | loss: 0.5826898
	speed: 0.0082s/iter; left time: 211.3814s
	iters: 1700, epoch: 9 | loss: 0.2127512
	speed: 0.0083s/iter; left time: 211.5054s
	iters: 1800, epoch: 9 | loss: 2.4737232
	speed: 0.0082s/iter; left time: 210.2184s
	iters: 1900, epoch: 9 | loss: 0.4779175
	speed: 0.0090s/iter; left time: 229.2483s
	iters: 2000, epoch: 9 | loss: 0.2701921
	speed: 0.0092s/iter; left time: 233.1986s
	iters: 2100, epoch: 9 | loss: 0.2997238
	speed: 0.0091s/iter; left time: 228.9482s
	iters: 2200, epoch: 9 | loss: 0.2261627
	speed: 0.0093s/iter; left time: 233.5632s
Epoch: 9 cost time: 20.345536947250366
Epoch: 9, Steps: 2278 | Train Loss: 0.4352081 Vali Loss: 0.3789358 Test Loss: 0.1432619
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.3280171
	speed: 0.0349s/iter; left time: 870.7672s
	iters: 200, epoch: 10 | loss: 0.1638829
	speed: 0.0084s/iter; left time: 209.3945s
	iters: 300, epoch: 10 | loss: 0.6729134
	speed: 0.0081s/iter; left time: 201.1034s
	iters: 400, epoch: 10 | loss: 0.7272838
	speed: 0.0091s/iter; left time: 224.4392s
	iters: 500, epoch: 10 | loss: 0.4958633
	speed: 0.0115s/iter; left time: 281.2728s
	iters: 600, epoch: 10 | loss: 0.2041391
	speed: 0.0113s/iter; left time: 276.5374s
	iters: 700, epoch: 10 | loss: 0.2695682
	speed: 0.0108s/iter; left time: 262.1922s
	iters: 800, epoch: 10 | loss: 0.1806891
	speed: 0.0102s/iter; left time: 247.4984s
	iters: 900, epoch: 10 | loss: 0.1658298
	speed: 0.0096s/iter; left time: 231.7398s
	iters: 1000, epoch: 10 | loss: 0.2033911
	speed: 0.0094s/iter; left time: 225.5209s
	iters: 1100, epoch: 10 | loss: 0.2211383
	speed: 0.0095s/iter; left time: 226.6643s
	iters: 1200, epoch: 10 | loss: 0.2657432
	speed: 0.0097s/iter; left time: 230.5450s
	iters: 1300, epoch: 10 | loss: 0.3156110
	speed: 0.0088s/iter; left time: 208.1782s
	iters: 1400, epoch: 10 | loss: 0.1535622
	speed: 0.0087s/iter; left time: 206.1380s
	iters: 1500, epoch: 10 | loss: 0.5988582
	speed: 0.0075s/iter; left time: 177.5785s
	iters: 1600, epoch: 10 | loss: 0.1535905
	speed: 0.0086s/iter; left time: 202.4509s
	iters: 1700, epoch: 10 | loss: 0.3173779
	speed: 0.0077s/iter; left time: 179.1660s
	iters: 1800, epoch: 10 | loss: 0.1931449
	speed: 0.0102s/iter; left time: 236.8095s
	iters: 1900, epoch: 10 | loss: 0.2844356
	speed: 0.0096s/iter; left time: 222.3873s
	iters: 2000, epoch: 10 | loss: 0.8745263
	speed: 0.0099s/iter; left time: 227.8335s
	iters: 2100, epoch: 10 | loss: 0.2950373
	speed: 0.0098s/iter; left time: 225.4182s
	iters: 2200, epoch: 10 | loss: 0.4210061
	speed: 0.0110s/iter; left time: 250.5996s
Epoch: 10 cost time: 21.51263403892517
Epoch: 10, Steps: 2278 | Train Loss: 0.4305040 Vali Loss: 0.3798630 Test Loss: 0.1440286
EarlyStopping counter: 2 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.2505144
	speed: 0.0331s/iter; left time: 751.3398s
	iters: 200, epoch: 11 | loss: 0.4156024
	speed: 0.0094s/iter; left time: 212.0431s
	iters: 300, epoch: 11 | loss: 0.2317232
	speed: 0.0093s/iter; left time: 209.1300s
	iters: 400, epoch: 11 | loss: 0.4790581
	speed: 0.0088s/iter; left time: 197.4598s
	iters: 500, epoch: 11 | loss: 0.4750505
	speed: 0.0093s/iter; left time: 206.1335s
	iters: 600, epoch: 11 | loss: 0.1694690
	speed: 0.0089s/iter; left time: 196.7810s
	iters: 700, epoch: 11 | loss: 0.2409516
	speed: 0.0089s/iter; left time: 197.4950s
	iters: 800, epoch: 11 | loss: 0.2281262
	speed: 0.0080s/iter; left time: 176.7811s
	iters: 900, epoch: 11 | loss: 0.2412326
	speed: 0.0084s/iter; left time: 184.7162s
	iters: 1000, epoch: 11 | loss: 0.4452111
	speed: 0.0087s/iter; left time: 190.1659s
	iters: 1100, epoch: 11 | loss: 0.3017724
	speed: 0.0101s/iter; left time: 219.7113s
	iters: 1200, epoch: 11 | loss: 2.1766529
	speed: 0.0102s/iter; left time: 219.6745s
	iters: 1300, epoch: 11 | loss: 0.3154544
	speed: 0.0094s/iter; left time: 201.9514s
	iters: 1400, epoch: 11 | loss: 0.2756136
	speed: 0.0088s/iter; left time: 187.2953s
	iters: 1500, epoch: 11 | loss: 0.3138488
	speed: 0.0093s/iter; left time: 198.1669s
	iters: 1600, epoch: 11 | loss: 0.2092734
	speed: 0.0096s/iter; left time: 203.2049s
	iters: 1700, epoch: 11 | loss: 0.4637945
	speed: 0.0100s/iter; left time: 210.5816s
	iters: 1800, epoch: 11 | loss: 0.4549630
	speed: 0.0100s/iter; left time: 208.9616s
	iters: 1900, epoch: 11 | loss: 0.2261912
	speed: 0.0086s/iter; left time: 179.1454s
	iters: 2000, epoch: 11 | loss: 0.2554193
	speed: 0.0073s/iter; left time: 151.7144s
	iters: 2100, epoch: 11 | loss: 0.4176901
	speed: 0.0088s/iter; left time: 181.4236s
	iters: 2200, epoch: 11 | loss: 0.1926340
	speed: 0.0087s/iter; left time: 178.7105s
Epoch: 11 cost time: 20.56713318824768
Epoch: 11, Steps: 2278 | Train Loss: 0.4293053 Vali Loss: 0.3799446 Test Loss: 0.1435906
EarlyStopping counter: 3 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.4819506
	speed: 0.0338s/iter; left time: 689.9467s
	iters: 200, epoch: 12 | loss: 0.2388808
	speed: 0.0080s/iter; left time: 162.6378s
	iters: 300, epoch: 12 | loss: 0.2900167
	speed: 0.0070s/iter; left time: 140.4160s
	iters: 400, epoch: 12 | loss: 0.2479159
	speed: 0.0083s/iter; left time: 166.9236s
	iters: 500, epoch: 12 | loss: 2.1078219
	speed: 0.0095s/iter; left time: 190.2743s
	iters: 600, epoch: 12 | loss: 0.3187279
	speed: 0.0096s/iter; left time: 190.4686s
	iters: 700, epoch: 12 | loss: 0.9453806
	speed: 0.0114s/iter; left time: 225.0010s
	iters: 800, epoch: 12 | loss: 0.3846494
	speed: 0.0101s/iter; left time: 199.8277s
	iters: 900, epoch: 12 | loss: 0.1638305
	speed: 0.0096s/iter; left time: 187.8784s
	iters: 1000, epoch: 12 | loss: 0.3164096
	speed: 0.0101s/iter; left time: 196.3971s
	iters: 1100, epoch: 12 | loss: 0.3648951
	speed: 0.0085s/iter; left time: 164.9628s
	iters: 1200, epoch: 12 | loss: 0.3146537
	speed: 0.0082s/iter; left time: 158.5249s
	iters: 1300, epoch: 12 | loss: 0.5184278
	speed: 0.0091s/iter; left time: 174.4159s
	iters: 1400, epoch: 12 | loss: 0.3138889
	speed: 0.0091s/iter; left time: 173.9256s
	iters: 1500, epoch: 12 | loss: 0.2962894
	speed: 0.0079s/iter; left time: 150.7486s
	iters: 1600, epoch: 12 | loss: 0.2151441
	speed: 0.0080s/iter; left time: 151.7915s
	iters: 1700, epoch: 12 | loss: 0.3021076
	speed: 0.0089s/iter; left time: 168.1394s
	iters: 1800, epoch: 12 | loss: 0.4564722
	speed: 0.0098s/iter; left time: 182.4158s
	iters: 1900, epoch: 12 | loss: 0.1877448
	speed: 0.0090s/iter; left time: 166.9015s
	iters: 2000, epoch: 12 | loss: 0.3188573
	speed: 0.0082s/iter; left time: 151.3663s
	iters: 2100, epoch: 12 | loss: 0.3457471
	speed: 0.0095s/iter; left time: 174.8782s
	iters: 2200, epoch: 12 | loss: 0.3205575
	speed: 0.0087s/iter; left time: 158.3578s
Epoch: 12 cost time: 20.35373330116272
Epoch: 12, Steps: 2278 | Train Loss: 0.4288357 Vali Loss: 0.3784094 Test Loss: 0.1436066
EarlyStopping counter: 4 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.3281593
	speed: 0.0411s/iter; left time: 744.8117s
	iters: 200, epoch: 13 | loss: 0.3886606
	speed: 0.0102s/iter; left time: 183.5457s
	iters: 300, epoch: 13 | loss: 0.3937083
	speed: 0.0105s/iter; left time: 188.7979s
	iters: 400, epoch: 13 | loss: 0.2636738
	speed: 0.0103s/iter; left time: 184.0042s
	iters: 500, epoch: 13 | loss: 0.2611913
	speed: 0.0100s/iter; left time: 176.9453s
	iters: 600, epoch: 13 | loss: 0.3054731
	speed: 0.0099s/iter; left time: 175.0490s
	iters: 700, epoch: 13 | loss: 0.3548301
	speed: 0.0097s/iter; left time: 169.3370s
	iters: 800, epoch: 13 | loss: 0.5888925
	speed: 0.0089s/iter; left time: 154.2442s
	iters: 900, epoch: 13 | loss: 0.3748558
	speed: 0.0099s/iter; left time: 172.2801s
	iters: 1000, epoch: 13 | loss: 0.2554131
	speed: 0.0094s/iter; left time: 161.9225s
	iters: 1100, epoch: 13 | loss: 2.1177120
	speed: 0.0099s/iter; left time: 168.8098s
	iters: 1200, epoch: 13 | loss: 0.4055023
	speed: 0.0111s/iter; left time: 188.5046s
	iters: 1300, epoch: 13 | loss: 0.2717326
	speed: 0.0106s/iter; left time: 179.6157s
	iters: 1400, epoch: 13 | loss: 0.2411615
	speed: 0.0092s/iter; left time: 155.3371s
	iters: 1500, epoch: 13 | loss: 0.2683056
	speed: 0.0085s/iter; left time: 141.7131s
	iters: 1600, epoch: 13 | loss: 0.3344924
	speed: 0.0096s/iter; left time: 159.9642s
	iters: 1700, epoch: 13 | loss: 0.3423657
	speed: 0.0093s/iter; left time: 152.8833s
	iters: 1800, epoch: 13 | loss: 0.2689846
	speed: 0.0093s/iter; left time: 153.4417s
	iters: 1900, epoch: 13 | loss: 0.9722635
	speed: 0.0086s/iter; left time: 139.7499s
	iters: 2000, epoch: 13 | loss: 0.6794097
	speed: 0.0093s/iter; left time: 151.1110s
	iters: 2100, epoch: 13 | loss: 0.5009944
	speed: 0.0080s/iter; left time: 129.5230s
	iters: 2200, epoch: 13 | loss: 1.5201538
	speed: 0.0074s/iter; left time: 117.9663s
Epoch: 13 cost time: 21.823742389678955
Epoch: 13, Steps: 2278 | Train Loss: 0.4286011 Vali Loss: 0.3784192 Test Loss: 0.1435920
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : weather_336_96_NLinear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3293<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
mse:0.14376923441886902, mae:0.19318968057632446
