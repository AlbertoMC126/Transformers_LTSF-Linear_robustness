Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='NLinear', model_id='weather_336_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=10458, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : weather_336_96_NLinear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed10458>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36456
val 5175
test 10444
	iters: 100, epoch: 1 | loss: 0.4173453
	speed: 0.0086s/iter; left time: 391.0372s
	iters: 200, epoch: 1 | loss: 4.4214311
	speed: 0.0100s/iter; left time: 455.4723s
	iters: 300, epoch: 1 | loss: 0.7745674
	speed: 0.0107s/iter; left time: 483.9198s
	iters: 400, epoch: 1 | loss: 0.3482639
	speed: 0.0085s/iter; left time: 382.1797s
	iters: 500, epoch: 1 | loss: 1.6102157
	speed: 0.0086s/iter; left time: 386.6460s
	iters: 600, epoch: 1 | loss: 3.1575501
	speed: 0.0096s/iter; left time: 433.5189s
	iters: 700, epoch: 1 | loss: 0.5634441
	speed: 0.0108s/iter; left time: 482.8142s
	iters: 800, epoch: 1 | loss: 0.5284907
	speed: 0.0091s/iter; left time: 409.2239s
	iters: 900, epoch: 1 | loss: 0.3474564
	speed: 0.0094s/iter; left time: 418.1368s
	iters: 1000, epoch: 1 | loss: 0.3844132
	speed: 0.0087s/iter; left time: 385.5940s
	iters: 1100, epoch: 1 | loss: 0.7497463
	speed: 0.0089s/iter; left time: 394.0821s
	iters: 1200, epoch: 1 | loss: 0.4588104
	speed: 0.0105s/iter; left time: 466.7356s
	iters: 1300, epoch: 1 | loss: 0.4101699
	speed: 0.0096s/iter; left time: 424.0497s
	iters: 1400, epoch: 1 | loss: 0.5133331
	speed: 0.0099s/iter; left time: 437.1984s
	iters: 1500, epoch: 1 | loss: 0.5633646
	speed: 0.0098s/iter; left time: 433.1229s
	iters: 1600, epoch: 1 | loss: 0.6584578
	speed: 0.0108s/iter; left time: 473.6143s
	iters: 1700, epoch: 1 | loss: 0.9820144
	speed: 0.0101s/iter; left time: 443.5568s
	iters: 1800, epoch: 1 | loss: 0.3096679
	speed: 0.0098s/iter; left time: 429.2991s
	iters: 1900, epoch: 1 | loss: 0.3438721
	speed: 0.0094s/iter; left time: 412.1760s
	iters: 2000, epoch: 1 | loss: 0.4957061
	speed: 0.0097s/iter; left time: 421.3214s
	iters: 2100, epoch: 1 | loss: 0.5646544
	speed: 0.0086s/iter; left time: 373.4759s
	iters: 2200, epoch: 1 | loss: 0.4725206
	speed: 0.0100s/iter; left time: 433.3294s
Epoch: 1 cost time: 21.78907084465027
Epoch: 1, Steps: 2278 | Train Loss: 2.6128154 Vali Loss: 0.5507037 Test Loss: 0.2092799
Validation loss decreased (inf --> 0.550704).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.5082360
	speed: 0.0402s/iter; left time: 1734.2277s
	iters: 200, epoch: 2 | loss: 0.6852334
	speed: 0.0098s/iter; left time: 422.7687s
	iters: 300, epoch: 2 | loss: 1.8331829
	speed: 0.0096s/iter; left time: 412.7018s
	iters: 400, epoch: 2 | loss: 0.4423033
	speed: 0.0090s/iter; left time: 386.8274s
	iters: 500, epoch: 2 | loss: 0.2615591
	speed: 0.0081s/iter; left time: 347.4871s
	iters: 600, epoch: 2 | loss: 1.7195247
	speed: 0.0096s/iter; left time: 409.7648s
	iters: 700, epoch: 2 | loss: 50.0097046
	speed: 0.0096s/iter; left time: 407.6295s
	iters: 800, epoch: 2 | loss: 0.5723915
	speed: 0.0096s/iter; left time: 406.6543s
	iters: 900, epoch: 2 | loss: 15.8288717
	speed: 0.0080s/iter; left time: 337.4879s
	iters: 1000, epoch: 2 | loss: 0.4740210
	speed: 0.0083s/iter; left time: 351.0995s
	iters: 1100, epoch: 2 | loss: 1.0567435
	speed: 0.0090s/iter; left time: 378.0377s
	iters: 1200, epoch: 2 | loss: 3.3592896
	speed: 0.0096s/iter; left time: 404.5389s
	iters: 1300, epoch: 2 | loss: 0.3533483
	speed: 0.0095s/iter; left time: 397.1657s
	iters: 1400, epoch: 2 | loss: 0.6623192
	speed: 0.0101s/iter; left time: 421.0341s
	iters: 1500, epoch: 2 | loss: 1.5681239
	speed: 0.0105s/iter; left time: 440.0836s
	iters: 1600, epoch: 2 | loss: 0.4835404
	speed: 0.0100s/iter; left time: 416.1525s
	iters: 1700, epoch: 2 | loss: 0.5111730
	speed: 0.0102s/iter; left time: 423.4152s
	iters: 1800, epoch: 2 | loss: 2.2525132
	speed: 0.0095s/iter; left time: 393.3284s
	iters: 1900, epoch: 2 | loss: 0.4027465
	speed: 0.0085s/iter; left time: 350.1130s
	iters: 2000, epoch: 2 | loss: 0.4169633
	speed: 0.0104s/iter; left time: 427.7836s
	iters: 2100, epoch: 2 | loss: 0.4033692
	speed: 0.0107s/iter; left time: 441.9579s
	iters: 2200, epoch: 2 | loss: 0.6945636
	speed: 0.0107s/iter; left time: 440.8940s
Epoch: 2 cost time: 21.74562692642212
Epoch: 2, Steps: 2278 | Train Loss: 23.0649406 Vali Loss: 0.6207218 Test Loss: 0.2145130
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.7601914
	speed: 0.0393s/iter; left time: 1606.4123s
	iters: 200, epoch: 3 | loss: 0.4254242
	speed: 0.0090s/iter; left time: 365.2241s
	iters: 300, epoch: 3 | loss: 0.2993872
	speed: 0.0099s/iter; left time: 401.0044s
	iters: 400, epoch: 3 | loss: 0.3551020
	speed: 0.0089s/iter; left time: 360.6308s
	iters: 500, epoch: 3 | loss: 0.2909009
	speed: 0.0097s/iter; left time: 391.8085s
	iters: 600, epoch: 3 | loss: 0.2918492
	speed: 0.0108s/iter; left time: 437.2978s
	iters: 700, epoch: 3 | loss: 0.5070308
	speed: 0.0084s/iter; left time: 338.2549s
	iters: 800, epoch: 3 | loss: 0.5392987
	speed: 0.0081s/iter; left time: 323.8018s
	iters: 900, epoch: 3 | loss: 0.3286806
	speed: 0.0089s/iter; left time: 356.0378s
	iters: 1000, epoch: 3 | loss: 1.7665703
	speed: 0.0087s/iter; left time: 349.2585s
	iters: 1100, epoch: 3 | loss: 0.3711285
	speed: 0.0092s/iter; left time: 368.4224s
	iters: 1200, epoch: 3 | loss: 0.4573819
	speed: 0.0092s/iter; left time: 365.9253s
	iters: 1300, epoch: 3 | loss: 0.3612423
	speed: 0.0089s/iter; left time: 352.5809s
	iters: 1400, epoch: 3 | loss: 0.4843122
	speed: 0.0100s/iter; left time: 395.3662s
	iters: 1500, epoch: 3 | loss: 0.4426010
	speed: 0.0113s/iter; left time: 445.8592s
	iters: 1600, epoch: 3 | loss: 0.6584595
	speed: 0.0109s/iter; left time: 431.1481s
	iters: 1700, epoch: 3 | loss: 0.9222813
	speed: 0.0098s/iter; left time: 386.4631s
	iters: 1800, epoch: 3 | loss: 0.2738699
	speed: 0.0105s/iter; left time: 412.0658s
	iters: 1900, epoch: 3 | loss: 0.7441810
	speed: 0.0108s/iter; left time: 420.5140s
	iters: 2000, epoch: 3 | loss: 0.2986542
	speed: 0.0111s/iter; left time: 433.0745s
	iters: 2100, epoch: 3 | loss: 0.3737321
	speed: 0.0096s/iter; left time: 373.5776s
	iters: 2200, epoch: 3 | loss: 0.2541454
	speed: 0.0091s/iter; left time: 353.6144s
Epoch: 3 cost time: 21.93398094177246
Epoch: 3, Steps: 2278 | Train Loss: 49.8431738 Vali Loss: 0.4444732 Test Loss: 0.1631295
Validation loss decreased (0.550704 --> 0.444473).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.1982625
	speed: 0.0409s/iter; left time: 1578.2493s
	iters: 200, epoch: 4 | loss: 0.5597252
	speed: 0.0098s/iter; left time: 378.2547s
	iters: 300, epoch: 4 | loss: 0.4576406
	speed: 0.0090s/iter; left time: 345.1763s
	iters: 400, epoch: 4 | loss: 0.2973836
	speed: 0.0084s/iter; left time: 321.6738s
	iters: 500, epoch: 4 | loss: 0.5066434
	speed: 0.0094s/iter; left time: 357.8023s
	iters: 600, epoch: 4 | loss: 0.4182334
	speed: 0.0103s/iter; left time: 393.6576s
	iters: 700, epoch: 4 | loss: 0.3635666
	speed: 0.0098s/iter; left time: 372.7335s
	iters: 800, epoch: 4 | loss: 0.2943180
	speed: 0.0103s/iter; left time: 392.3177s
	iters: 900, epoch: 4 | loss: 0.3195690
	speed: 0.0098s/iter; left time: 371.1779s
	iters: 1000, epoch: 4 | loss: 0.5401577
	speed: 0.0101s/iter; left time: 381.5569s
	iters: 1100, epoch: 4 | loss: 0.2381975
	speed: 0.0110s/iter; left time: 414.9014s
	iters: 1200, epoch: 4 | loss: 0.2529568
	speed: 0.0101s/iter; left time: 379.7889s
	iters: 1300, epoch: 4 | loss: 0.3329034
	speed: 0.0088s/iter; left time: 329.0756s
	iters: 1400, epoch: 4 | loss: 0.1984241
	speed: 0.0107s/iter; left time: 397.6651s
	iters: 1500, epoch: 4 | loss: 1.3118674
	speed: 0.0104s/iter; left time: 388.7367s
	iters: 1600, epoch: 4 | loss: 0.7066013
	speed: 0.0085s/iter; left time: 316.7135s
	iters: 1700, epoch: 4 | loss: 0.2291982
	speed: 0.0084s/iter; left time: 309.5627s
	iters: 1800, epoch: 4 | loss: 0.3475399
	speed: 0.0094s/iter; left time: 347.1869s
	iters: 1900, epoch: 4 | loss: 0.3950540
	speed: 0.0099s/iter; left time: 365.0714s
	iters: 2000, epoch: 4 | loss: 2.2622023
	speed: 0.0102s/iter; left time: 373.2835s
	iters: 2100, epoch: 4 | loss: 0.3420496
	speed: 0.0091s/iter; left time: 333.3446s
	iters: 2200, epoch: 4 | loss: 0.3500794
	speed: 0.0086s/iter; left time: 313.8657s
Epoch: 4 cost time: 21.97321319580078
Epoch: 4, Steps: 2278 | Train Loss: 3.2078354 Vali Loss: 0.4074400 Test Loss: 0.1540633
Validation loss decreased (0.444473 --> 0.407440).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.2838976
	speed: 0.0376s/iter; left time: 1367.0318s
	iters: 200, epoch: 5 | loss: 0.4195686
	speed: 0.0095s/iter; left time: 344.7581s
	iters: 300, epoch: 5 | loss: 2.3875473
	speed: 0.0104s/iter; left time: 377.5169s
	iters: 400, epoch: 5 | loss: 3.6506715
	speed: 0.0097s/iter; left time: 349.9853s
	iters: 500, epoch: 5 | loss: 0.8708284
	speed: 0.0101s/iter; left time: 364.6130s
	iters: 600, epoch: 5 | loss: 0.3371532
	speed: 0.0086s/iter; left time: 307.3032s
	iters: 700, epoch: 5 | loss: 0.2320698
	speed: 0.0089s/iter; left time: 316.4190s
	iters: 800, epoch: 5 | loss: 0.3247057
	speed: 0.0098s/iter; left time: 347.9422s
	iters: 900, epoch: 5 | loss: 0.4731278
	speed: 0.0073s/iter; left time: 259.1517s
	iters: 1000, epoch: 5 | loss: 0.3558080
	speed: 0.0090s/iter; left time: 317.7099s
	iters: 1100, epoch: 5 | loss: 0.3139707
	speed: 0.0086s/iter; left time: 305.2347s
	iters: 1200, epoch: 5 | loss: 0.2698579
	speed: 0.0098s/iter; left time: 346.4857s
	iters: 1300, epoch: 5 | loss: 0.3406056
	speed: 0.0101s/iter; left time: 356.0740s
	iters: 1400, epoch: 5 | loss: 0.3951266
	speed: 0.0098s/iter; left time: 344.2944s
	iters: 1500, epoch: 5 | loss: 0.4123959
	speed: 0.0103s/iter; left time: 361.0985s
	iters: 1600, epoch: 5 | loss: 0.3967433
	speed: 0.0096s/iter; left time: 333.1708s
	iters: 1700, epoch: 5 | loss: 0.3603557
	speed: 0.0101s/iter; left time: 349.3489s
	iters: 1800, epoch: 5 | loss: 0.2238049
	speed: 0.0095s/iter; left time: 328.3839s
	iters: 1900, epoch: 5 | loss: 0.3289066
	speed: 0.0104s/iter; left time: 360.4213s
	iters: 2000, epoch: 5 | loss: 0.2602139
	speed: 0.0091s/iter; left time: 313.2250s
	iters: 2100, epoch: 5 | loss: 0.4349233
	speed: 0.0091s/iter; left time: 311.2956s
	iters: 2200, epoch: 5 | loss: 0.3072889
	speed: 0.0102s/iter; left time: 349.7987s
Epoch: 5 cost time: 21.534730434417725
Epoch: 5, Steps: 2278 | Train Loss: 0.7604575 Vali Loss: 0.4030364 Test Loss: 0.1492805
Validation loss decreased (0.407440 --> 0.403036).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 2.6608381
	speed: 0.0392s/iter; left time: 1337.1864s
	iters: 200, epoch: 6 | loss: 0.2975345
	speed: 0.0092s/iter; left time: 311.1780s
	iters: 300, epoch: 6 | loss: 0.1741639
	speed: 0.0094s/iter; left time: 318.0818s
	iters: 400, epoch: 6 | loss: 0.2655645
	speed: 0.0105s/iter; left time: 354.6641s
	iters: 500, epoch: 6 | loss: 0.7009002
	speed: 0.0088s/iter; left time: 296.1117s
	iters: 600, epoch: 6 | loss: 0.2989418
	speed: 0.0101s/iter; left time: 338.4384s
	iters: 700, epoch: 6 | loss: 0.1565238
	speed: 0.0112s/iter; left time: 373.2206s
	iters: 800, epoch: 6 | loss: 0.3083394
	speed: 0.0109s/iter; left time: 363.4125s
	iters: 900, epoch: 6 | loss: 0.3740148
	speed: 0.0090s/iter; left time: 297.9119s
	iters: 1000, epoch: 6 | loss: 0.3951479
	speed: 0.0095s/iter; left time: 315.5616s
	iters: 1100, epoch: 6 | loss: 0.2229668
	speed: 0.0096s/iter; left time: 318.5915s
	iters: 1200, epoch: 6 | loss: 0.8515920
	speed: 0.0099s/iter; left time: 327.8126s
	iters: 1300, epoch: 6 | loss: 0.9523625
	speed: 0.0092s/iter; left time: 301.7138s
	iters: 1400, epoch: 6 | loss: 1.6158359
	speed: 0.0096s/iter; left time: 312.9822s
	iters: 1500, epoch: 6 | loss: 0.3305852
	speed: 0.0089s/iter; left time: 290.5026s
	iters: 1600, epoch: 6 | loss: 0.5227639
	speed: 0.0094s/iter; left time: 305.6004s
	iters: 1700, epoch: 6 | loss: 0.2850895
	speed: 0.0087s/iter; left time: 280.9620s
	iters: 1800, epoch: 6 | loss: 0.2617186
	speed: 0.0090s/iter; left time: 290.1196s
	iters: 1900, epoch: 6 | loss: 0.2202408
	speed: 0.0085s/iter; left time: 274.0950s
	iters: 2000, epoch: 6 | loss: 2.1501563
	speed: 0.0087s/iter; left time: 279.6418s
	iters: 2100, epoch: 6 | loss: 0.3712514
	speed: 0.0082s/iter; left time: 261.7116s
	iters: 2200, epoch: 6 | loss: 0.4740400
	speed: 0.0089s/iter; left time: 283.3146s
Epoch: 6 cost time: 21.203306674957275
Epoch: 6, Steps: 2278 | Train Loss: 0.5246550 Vali Loss: 0.3824609 Test Loss: 0.1462241
Validation loss decreased (0.403036 --> 0.382461).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.2907059
	speed: 0.0348s/iter; left time: 1106.0583s
	iters: 200, epoch: 7 | loss: 0.3973238
	speed: 0.0086s/iter; left time: 271.3713s
	iters: 300, epoch: 7 | loss: 0.4325401
	speed: 0.0101s/iter; left time: 319.1877s
	iters: 400, epoch: 7 | loss: 0.1890523
	speed: 0.0087s/iter; left time: 273.7381s
	iters: 500, epoch: 7 | loss: 0.2923107
	speed: 0.0093s/iter; left time: 291.4121s
	iters: 600, epoch: 7 | loss: 0.2457308
	speed: 0.0092s/iter; left time: 286.4287s
	iters: 700, epoch: 7 | loss: 0.3020687
	speed: 0.0089s/iter; left time: 277.3054s
	iters: 800, epoch: 7 | loss: 0.5548256
	speed: 0.0099s/iter; left time: 306.9753s
	iters: 900, epoch: 7 | loss: 0.3109506
	speed: 0.0089s/iter; left time: 275.6312s
	iters: 1000, epoch: 7 | loss: 0.2639753
	speed: 0.0086s/iter; left time: 264.2080s
	iters: 1100, epoch: 7 | loss: 0.3365138
	speed: 0.0090s/iter; left time: 276.8895s
	iters: 1200, epoch: 7 | loss: 0.3458815
	speed: 0.0092s/iter; left time: 281.5432s
	iters: 1300, epoch: 7 | loss: 0.6398621
	speed: 0.0072s/iter; left time: 221.2693s
	iters: 1400, epoch: 7 | loss: 0.4404906
	speed: 0.0100s/iter; left time: 305.2442s
	iters: 1500, epoch: 7 | loss: 0.3436113
	speed: 0.0089s/iter; left time: 269.9588s
	iters: 1600, epoch: 7 | loss: 0.2562414
	speed: 0.0094s/iter; left time: 286.0423s
	iters: 1700, epoch: 7 | loss: 0.5179223
	speed: 0.0087s/iter; left time: 262.7840s
	iters: 1800, epoch: 7 | loss: 0.3738740
	speed: 0.0080s/iter; left time: 241.1118s
	iters: 1900, epoch: 7 | loss: 2.2122042
	speed: 0.0087s/iter; left time: 261.2715s
	iters: 2000, epoch: 7 | loss: 0.1974204
	speed: 0.0099s/iter; left time: 294.4691s
	iters: 2100, epoch: 7 | loss: 2.1610186
	speed: 0.0101s/iter; left time: 300.4043s
	iters: 2200, epoch: 7 | loss: 0.4395606
	speed: 0.0100s/iter; left time: 297.2712s
Epoch: 7 cost time: 20.684417963027954
Epoch: 7, Steps: 2278 | Train Loss: 0.4789800 Vali Loss: 0.3841497 Test Loss: 0.1452453
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.5625149
	speed: 0.0420s/iter; left time: 1238.2953s
	iters: 200, epoch: 8 | loss: 0.4965002
	speed: 0.0089s/iter; left time: 261.8567s
	iters: 300, epoch: 8 | loss: 0.3189326
	speed: 0.0092s/iter; left time: 268.2373s
	iters: 400, epoch: 8 | loss: 0.3485263
	speed: 0.0096s/iter; left time: 279.6546s
	iters: 500, epoch: 8 | loss: 2.1144898
	speed: 0.0095s/iter; left time: 276.6048s
	iters: 600, epoch: 8 | loss: 0.6746518
	speed: 0.0088s/iter; left time: 254.5500s
	iters: 700, epoch: 8 | loss: 0.8903461
	speed: 0.0082s/iter; left time: 238.0280s
	iters: 800, epoch: 8 | loss: 0.8126608
	speed: 0.0089s/iter; left time: 257.1089s
	iters: 900, epoch: 8 | loss: 0.1691210
	speed: 0.0082s/iter; left time: 235.9887s
	iters: 1000, epoch: 8 | loss: 0.3352030
	speed: 0.0101s/iter; left time: 289.0853s
	iters: 1100, epoch: 8 | loss: 0.1804470
	speed: 0.0090s/iter; left time: 255.2568s
	iters: 1200, epoch: 8 | loss: 0.2517842
	speed: 0.0085s/iter; left time: 240.5103s
	iters: 1300, epoch: 8 | loss: 0.3402918
	speed: 0.0097s/iter; left time: 274.6576s
	iters: 1400, epoch: 8 | loss: 0.2595140
	speed: 0.0105s/iter; left time: 294.8731s
	iters: 1500, epoch: 8 | loss: 0.5291303
	speed: 0.0101s/iter; left time: 283.2018s
	iters: 1600, epoch: 8 | loss: 0.5920438
	speed: 0.0098s/iter; left time: 274.5831s
	iters: 1700, epoch: 8 | loss: 0.2192269
	speed: 0.0098s/iter; left time: 272.8002s
	iters: 1800, epoch: 8 | loss: 0.6306196
	speed: 0.0101s/iter; left time: 280.4309s
	iters: 1900, epoch: 8 | loss: 0.2212151
	speed: 0.0101s/iter; left time: 279.0966s
	iters: 2000, epoch: 8 | loss: 0.2760764
	speed: 0.0094s/iter; left time: 259.9200s
	iters: 2100, epoch: 8 | loss: 0.2552588
	speed: 0.0082s/iter; left time: 224.8086s
	iters: 2200, epoch: 8 | loss: 0.2910848
	speed: 0.0088s/iter; left time: 241.6025s
Epoch: 8 cost time: 21.255690574645996
Epoch: 8, Steps: 2278 | Train Loss: 0.4601603 Vali Loss: 0.3789808 Test Loss: 0.1435625
Validation loss decreased (0.382461 --> 0.378981).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.3029101
	speed: 0.0405s/iter; left time: 1103.8099s
	iters: 200, epoch: 9 | loss: 0.2758661
	speed: 0.0104s/iter; left time: 282.0682s
	iters: 300, epoch: 9 | loss: 0.5377766
	speed: 0.0098s/iter; left time: 264.2432s
	iters: 400, epoch: 9 | loss: 0.2466913
	speed: 0.0103s/iter; left time: 277.2633s
	iters: 500, epoch: 9 | loss: 0.3001447
	speed: 0.0080s/iter; left time: 213.4314s
	iters: 600, epoch: 9 | loss: 0.4311625
	speed: 0.0079s/iter; left time: 211.1764s
	iters: 700, epoch: 9 | loss: 2.1603584
	speed: 0.0085s/iter; left time: 225.9446s
	iters: 800, epoch: 9 | loss: 0.2457483
	speed: 0.0111s/iter; left time: 293.8353s
	iters: 900, epoch: 9 | loss: 1.0701226
	speed: 0.0088s/iter; left time: 232.7633s
	iters: 1000, epoch: 9 | loss: 0.1063822
	speed: 0.0086s/iter; left time: 227.6566s
	iters: 1100, epoch: 9 | loss: 0.2237786
	speed: 0.0097s/iter; left time: 254.5737s
	iters: 1200, epoch: 9 | loss: 0.2507261
	speed: 0.0104s/iter; left time: 271.9246s
	iters: 1300, epoch: 9 | loss: 0.2941021
	speed: 0.0114s/iter; left time: 295.8624s
	iters: 1400, epoch: 9 | loss: 0.2531880
	speed: 0.0094s/iter; left time: 242.5607s
	iters: 1500, epoch: 9 | loss: 0.4829223
	speed: 0.0082s/iter; left time: 212.7006s
	iters: 1600, epoch: 9 | loss: 0.3427947
	speed: 0.0081s/iter; left time: 208.3124s
	iters: 1700, epoch: 9 | loss: 0.6285036
	speed: 0.0108s/iter; left time: 276.9285s
	iters: 1800, epoch: 9 | loss: 0.2423486
	speed: 0.0104s/iter; left time: 264.8668s
	iters: 1900, epoch: 9 | loss: 0.1927706
	speed: 0.0099s/iter; left time: 251.5804s
	iters: 2000, epoch: 9 | loss: 0.3719569
	speed: 0.0099s/iter; left time: 251.6733s
	iters: 2100, epoch: 9 | loss: 0.5368403
	speed: 0.0104s/iter; left time: 262.8250s
	iters: 2200, epoch: 9 | loss: 0.2749125
	speed: 0.0105s/iter; left time: 264.5165s
Epoch: 9 cost time: 21.951344966888428
Epoch: 9, Steps: 2278 | Train Loss: 0.4428936 Vali Loss: 0.3793981 Test Loss: 0.1441092
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.2966384
	speed: 0.0392s/iter; left time: 979.6263s
	iters: 200, epoch: 10 | loss: 0.6123886
	speed: 0.0102s/iter; left time: 254.0040s
	iters: 300, epoch: 10 | loss: 0.2522140
	speed: 0.0107s/iter; left time: 265.2269s
	iters: 400, epoch: 10 | loss: 0.2331599
	speed: 0.0093s/iter; left time: 230.3707s
	iters: 500, epoch: 10 | loss: 0.4239577
	speed: 0.0097s/iter; left time: 237.3302s
	iters: 600, epoch: 10 | loss: 0.4035244
	speed: 0.0103s/iter; left time: 252.6735s
	iters: 700, epoch: 10 | loss: 0.3154645
	speed: 0.0104s/iter; left time: 253.8895s
	iters: 800, epoch: 10 | loss: 0.5506015
	speed: 0.0089s/iter; left time: 216.6830s
	iters: 900, epoch: 10 | loss: 0.2325655
	speed: 0.0106s/iter; left time: 254.9468s
	iters: 1000, epoch: 10 | loss: 0.2530949
	speed: 0.0092s/iter; left time: 221.7662s
	iters: 1100, epoch: 10 | loss: 0.2371711
	speed: 0.0087s/iter; left time: 208.4464s
	iters: 1200, epoch: 10 | loss: 0.1914323
	speed: 0.0102s/iter; left time: 243.4334s
	iters: 1300, epoch: 10 | loss: 0.4041912
	speed: 0.0102s/iter; left time: 242.1288s
	iters: 1400, epoch: 10 | loss: 0.2820528
	speed: 0.0094s/iter; left time: 221.6956s
	iters: 1500, epoch: 10 | loss: 0.6307390
	speed: 0.0093s/iter; left time: 219.1023s
	iters: 1600, epoch: 10 | loss: 0.2423296
	speed: 0.0098s/iter; left time: 229.6775s
	iters: 1700, epoch: 10 | loss: 0.2722988
	speed: 0.0101s/iter; left time: 235.2805s
	iters: 1800, epoch: 10 | loss: 0.7300740
	speed: 0.0094s/iter; left time: 218.1905s
	iters: 1900, epoch: 10 | loss: 0.5857166
	speed: 0.0106s/iter; left time: 246.4721s
	iters: 2000, epoch: 10 | loss: 0.1940058
	speed: 0.0097s/iter; left time: 223.2323s
	iters: 2100, epoch: 10 | loss: 0.4608068
	speed: 0.0091s/iter; left time: 208.3045s
	iters: 2200, epoch: 10 | loss: 0.5822920
	speed: 0.0095s/iter; left time: 217.8453s
Epoch: 10 cost time: 22.267163276672363
Epoch: 10, Steps: 2278 | Train Loss: 0.4410615 Vali Loss: 0.3779975 Test Loss: 0.1431746
Validation loss decreased (0.378981 --> 0.377998).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.1871920
	speed: 0.0360s/iter; left time: 816.7400s
	iters: 200, epoch: 11 | loss: 0.3076507
	speed: 0.0087s/iter; left time: 196.2851s
	iters: 300, epoch: 11 | loss: 0.3323357
	speed: 0.0085s/iter; left time: 191.8046s
	iters: 400, epoch: 11 | loss: 0.3333736
	speed: 0.0098s/iter; left time: 219.5756s
	iters: 500, epoch: 11 | loss: 0.3012860
	speed: 0.0083s/iter; left time: 185.2403s
	iters: 600, epoch: 11 | loss: 0.3407147
	speed: 0.0080s/iter; left time: 177.6698s
	iters: 700, epoch: 11 | loss: 0.5956525
	speed: 0.0092s/iter; left time: 202.9040s
	iters: 800, epoch: 11 | loss: 0.1714983
	speed: 0.0101s/iter; left time: 222.9154s
	iters: 900, epoch: 11 | loss: 0.2946118
	speed: 0.0083s/iter; left time: 180.9977s
	iters: 1000, epoch: 11 | loss: 0.5369632
	speed: 0.0083s/iter; left time: 181.0808s
	iters: 1100, epoch: 11 | loss: 1.0040194
	speed: 0.0086s/iter; left time: 186.2224s
	iters: 1200, epoch: 11 | loss: 0.2385775
	speed: 0.0094s/iter; left time: 203.7546s
	iters: 1300, epoch: 11 | loss: 0.1935190
	speed: 0.0098s/iter; left time: 210.5221s
	iters: 1400, epoch: 11 | loss: 0.4250823
	speed: 0.0108s/iter; left time: 231.9355s
	iters: 1500, epoch: 11 | loss: 0.2502148
	speed: 0.0107s/iter; left time: 227.1338s
	iters: 1600, epoch: 11 | loss: 0.2030644
	speed: 0.0098s/iter; left time: 207.2071s
	iters: 1700, epoch: 11 | loss: 0.2512663
	speed: 0.0105s/iter; left time: 221.1165s
	iters: 1800, epoch: 11 | loss: 0.3462298
	speed: 0.0100s/iter; left time: 209.4969s
	iters: 1900, epoch: 11 | loss: 0.2968633
	speed: 0.0106s/iter; left time: 221.1275s
	iters: 2000, epoch: 11 | loss: 0.4498913
	speed: 0.0114s/iter; left time: 236.3336s
	iters: 2100, epoch: 11 | loss: 0.5573360
	speed: 0.0108s/iter; left time: 224.0517s
	iters: 2200, epoch: 11 | loss: 0.2054108
	speed: 0.0107s/iter; left time: 220.8810s
Epoch: 11 cost time: 21.94558095932007
Epoch: 11, Steps: 2278 | Train Loss: 0.4399271 Vali Loss: 0.3780022 Test Loss: 0.1432363
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.4154737
	speed: 0.0392s/iter; left time: 798.9400s
	iters: 200, epoch: 12 | loss: 0.4564330
	speed: 0.0091s/iter; left time: 184.7916s
	iters: 300, epoch: 12 | loss: 0.4438288
	speed: 0.0108s/iter; left time: 218.4011s
	iters: 400, epoch: 12 | loss: 0.2849886
	speed: 0.0097s/iter; left time: 194.4453s
	iters: 500, epoch: 12 | loss: 0.4291236
	speed: 0.0101s/iter; left time: 202.3131s
	iters: 600, epoch: 12 | loss: 0.4079165
	speed: 0.0094s/iter; left time: 187.5506s
	iters: 700, epoch: 12 | loss: 0.5939178
	speed: 0.0107s/iter; left time: 211.3549s
	iters: 800, epoch: 12 | loss: 0.2461262
	speed: 0.0098s/iter; left time: 193.9210s
	iters: 900, epoch: 12 | loss: 0.3403558
	speed: 0.0107s/iter; left time: 209.4244s
	iters: 1000, epoch: 12 | loss: 0.5459815
	speed: 0.0112s/iter; left time: 218.0453s
	iters: 1100, epoch: 12 | loss: 0.2116441
	speed: 0.0097s/iter; left time: 188.4474s
	iters: 1200, epoch: 12 | loss: 0.1760775
	speed: 0.0095s/iter; left time: 182.8517s
	iters: 1300, epoch: 12 | loss: 0.4142508
	speed: 0.0096s/iter; left time: 184.9701s
	iters: 1400, epoch: 12 | loss: 0.2774294
	speed: 0.0096s/iter; left time: 183.4517s
	iters: 1500, epoch: 12 | loss: 0.2829130
	speed: 0.0105s/iter; left time: 200.3719s
	iters: 1600, epoch: 12 | loss: 0.2744420
	speed: 0.0101s/iter; left time: 191.3562s
	iters: 1700, epoch: 12 | loss: 0.2560208
	speed: 0.0106s/iter; left time: 198.4204s
	iters: 1800, epoch: 12 | loss: 0.2622091
	speed: 0.0101s/iter; left time: 188.3838s
	iters: 1900, epoch: 12 | loss: 0.4845861
	speed: 0.0096s/iter; left time: 178.0804s
	iters: 2000, epoch: 12 | loss: 0.3389957
	speed: 0.0092s/iter; left time: 170.4645s
	iters: 2100, epoch: 12 | loss: 0.2306155
	speed: 0.0097s/iter; left time: 178.5611s
	iters: 2200, epoch: 12 | loss: 0.2701752
	speed: 0.0087s/iter; left time: 159.4524s
Epoch: 12 cost time: 22.330010175704956
Epoch: 12, Steps: 2278 | Train Loss: 0.4393972 Vali Loss: 0.3794129 Test Loss: 0.1433891
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.4171671
	speed: 0.0382s/iter; left time: 693.2625s
	iters: 200, epoch: 13 | loss: 0.3697210
	speed: 0.0089s/iter; left time: 161.2793s
	iters: 300, epoch: 13 | loss: 0.1617381
	speed: 0.0087s/iter; left time: 155.8073s
	iters: 400, epoch: 13 | loss: 0.7484299
	speed: 0.0075s/iter; left time: 133.1632s
	iters: 500, epoch: 13 | loss: 0.2018854
	speed: 0.0073s/iter; left time: 130.1345s
	iters: 600, epoch: 13 | loss: 0.3612731
	speed: 0.0087s/iter; left time: 154.0871s
	iters: 700, epoch: 13 | loss: 0.1901800
	speed: 0.0100s/iter; left time: 176.0160s
	iters: 800, epoch: 13 | loss: 0.2431592
	speed: 0.0093s/iter; left time: 161.9009s
	iters: 900, epoch: 13 | loss: 0.2234912
	speed: 0.0100s/iter; left time: 173.1055s
	iters: 1000, epoch: 13 | loss: 0.1791042
	speed: 0.0110s/iter; left time: 189.6892s
	iters: 1100, epoch: 13 | loss: 0.3046232
	speed: 0.0105s/iter; left time: 179.8719s
	iters: 1200, epoch: 13 | loss: 0.3659772
	speed: 0.0100s/iter; left time: 170.1212s
	iters: 1300, epoch: 13 | loss: 0.3235123
	speed: 0.0092s/iter; left time: 155.7333s
	iters: 1400, epoch: 13 | loss: 0.2180466
	speed: 0.0090s/iter; left time: 152.1355s
	iters: 1500, epoch: 13 | loss: 0.3312699
	speed: 0.0102s/iter; left time: 170.6239s
	iters: 1600, epoch: 13 | loss: 0.1749182
	speed: 0.0093s/iter; left time: 155.2846s
	iters: 1700, epoch: 13 | loss: 0.3707501
	speed: 0.0100s/iter; left time: 164.4924s
	iters: 1800, epoch: 13 | loss: 0.1735227
	speed: 0.0098s/iter; left time: 160.8302s
	iters: 1900, epoch: 13 | loss: 0.1879148
	speed: 0.0108s/iter; left time: 176.3423s
	iters: 2000, epoch: 13 | loss: 0.2208132
	speed: 0.0104s/iter; left time: 168.1439s
	iters: 2100, epoch: 13 | loss: 0.3347277
	speed: 0.0096s/iter; left time: 154.8481s
	iters: 2200, epoch: 13 | loss: 0.2967825
	speed: 0.0096s/iter; left time: 153.8860s
Epoch: 13 cost time: 21.644538402557373
Epoch: 13, Steps: 2278 | Train Loss: 0.4389951 Vali Loss: 0.3780368 Test Loss: 0.1434626
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.2163762
	speed: 0.0397s/iter; left time: 629.9050s
	iters: 200, epoch: 14 | loss: 0.2752568
	speed: 0.0103s/iter; left time: 162.2628s
	iters: 300, epoch: 14 | loss: 0.3095929
	speed: 0.0110s/iter; left time: 171.8722s
	iters: 400, epoch: 14 | loss: 0.3375848
	speed: 0.0091s/iter; left time: 141.3681s
	iters: 500, epoch: 14 | loss: 0.2280092
	speed: 0.0104s/iter; left time: 160.0816s
	iters: 600, epoch: 14 | loss: 0.2929243
	speed: 0.0077s/iter; left time: 117.4517s
	iters: 700, epoch: 14 | loss: 0.3312380
	speed: 0.0107s/iter; left time: 162.5801s
	iters: 800, epoch: 14 | loss: 0.3787937
	speed: 0.0102s/iter; left time: 154.8464s
	iters: 900, epoch: 14 | loss: 0.2979041
	speed: 0.0104s/iter; left time: 156.9861s
	iters: 1000, epoch: 14 | loss: 0.2377582
	speed: 0.0094s/iter; left time: 141.1377s
	iters: 1100, epoch: 14 | loss: 0.3874876
	speed: 0.0087s/iter; left time: 128.6085s
	iters: 1200, epoch: 14 | loss: 0.3978675
	speed: 0.0085s/iter; left time: 124.6463s
	iters: 1300, epoch: 14 | loss: 0.2839352
	speed: 0.0097s/iter; left time: 142.2285s
	iters: 1400, epoch: 14 | loss: 1.1569798
	speed: 0.0100s/iter; left time: 145.3756s
	iters: 1500, epoch: 14 | loss: 0.2470029
	speed: 0.0108s/iter; left time: 156.1042s
	iters: 1600, epoch: 14 | loss: 0.3108048
	speed: 0.0086s/iter; left time: 122.9536s
	iters: 1700, epoch: 14 | loss: 0.6983336
	speed: 0.0097s/iter; left time: 138.0949s
	iters: 1800, epoch: 14 | loss: 0.2809635
	speed: 0.0106s/iter; left time: 150.5366s
	iters: 1900, epoch: 14 | loss: 0.1762421
	speed: 0.0110s/iter; left time: 153.8686s
	iters: 2000, epoch: 14 | loss: 0.2078374
	speed: 0.0098s/iter; left time: 136.1700s
	iters: 2100, epoch: 14 | loss: 0.2684083
	speed: 0.0083s/iter; left time: 115.4897s
	iters: 2200, epoch: 14 | loss: 0.2985517
	speed: 0.0084s/iter; left time: 116.0656s
Epoch: 14 cost time: 22.0582377910614
Epoch: 14, Steps: 2278 | Train Loss: 0.4388326 Vali Loss: 0.3783925 Test Loss: 0.1434589
EarlyStopping counter: 4 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.2849905
	speed: 0.0373s/iter; left time: 505.8499s
	iters: 200, epoch: 15 | loss: 0.3297702
	speed: 0.0089s/iter; left time: 119.9138s
	iters: 300, epoch: 15 | loss: 0.5449786
	speed: 0.0081s/iter; left time: 107.9196s
	iters: 400, epoch: 15 | loss: 0.3403850
	speed: 0.0083s/iter; left time: 109.7134s
	iters: 500, epoch: 15 | loss: 0.2421562
	speed: 0.0083s/iter; left time: 108.7855s
	iters: 600, epoch: 15 | loss: 0.3892134
	speed: 0.0088s/iter; left time: 114.5101s
	iters: 700, epoch: 15 | loss: 0.7090929
	speed: 0.0097s/iter; left time: 125.3265s
	iters: 800, epoch: 15 | loss: 0.2129728
	speed: 0.0092s/iter; left time: 117.8855s
	iters: 900, epoch: 15 | loss: 0.2991937
	speed: 0.0100s/iter; left time: 127.5970s
	iters: 1000, epoch: 15 | loss: 0.2516755
	speed: 0.0098s/iter; left time: 124.2966s
	iters: 1100, epoch: 15 | loss: 0.2165723
	speed: 0.0097s/iter; left time: 121.8280s
	iters: 1200, epoch: 15 | loss: 0.2449927
	speed: 0.0094s/iter; left time: 116.7467s
	iters: 1300, epoch: 15 | loss: 0.3407899
	speed: 0.0099s/iter; left time: 122.1163s
	iters: 1400, epoch: 15 | loss: 0.1992810
	speed: 0.0101s/iter; left time: 123.5790s
	iters: 1500, epoch: 15 | loss: 1.4624904
	speed: 0.0094s/iter; left time: 114.8017s
	iters: 1600, epoch: 15 | loss: 0.3907423
	speed: 0.0102s/iter; left time: 123.2584s
	iters: 1700, epoch: 15 | loss: 0.2304987
	speed: 0.0101s/iter; left time: 120.9188s
	iters: 1800, epoch: 15 | loss: 0.6496489
	speed: 0.0091s/iter; left time: 108.0528s
	iters: 1900, epoch: 15 | loss: 0.3648644
	speed: 0.0082s/iter; left time: 96.1829s
	iters: 2000, epoch: 15 | loss: 0.4712741
	speed: 0.0084s/iter; left time: 97.7640s
	iters: 2100, epoch: 15 | loss: 0.2344393
	speed: 0.0081s/iter; left time: 93.7291s
	iters: 2200, epoch: 15 | loss: 0.2757530
	speed: 0.0093s/iter; left time: 106.8003s
Epoch: 15 cost time: 20.95654320716858
Epoch: 15, Steps: 2278 | Train Loss: 0.4386439 Vali Loss: 0.3784365 Test Loss: 0.1434443
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : weather_336_96_NLinear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed10458<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
mse:0.14321571588516235, mae:0.19265972077846527
