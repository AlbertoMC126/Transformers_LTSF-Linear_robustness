Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='DLinear', model_id='ETTm2_96_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=28649, seq_len=96, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTm2_96_96_DLinear_ETTm2_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed28649>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34369
data_set:  <data_provider.data_loader.Dataset_ETT_minute object at 0x000001FE1121F4E0>
val 11425
data_set:  <data_provider.data_loader.Dataset_ETT_minute object at 0x000001FE5E807D68>
test 11425
data_set:  <data_provider.data_loader.Dataset_ETT_minute object at 0x000001FE1121F438>
Total number of trainable parameters: 130368
Total number of parameters: 130368
	iters: 100, epoch: 1 | loss: 0.2509470
	speed: 0.0053s/iter; left time: 113.7906s
	iters: 200, epoch: 1 | loss: 0.2247834
	speed: 0.0051s/iter; left time: 109.0050s
	iters: 300, epoch: 1 | loss: 0.1696777
	speed: 0.0052s/iter; left time: 109.3668s
	iters: 400, epoch: 1 | loss: 0.2710338
	speed: 0.0054s/iter; left time: 112.8967s
	iters: 500, epoch: 1 | loss: 0.1660496
	speed: 0.0047s/iter; left time: 97.7154s
	iters: 600, epoch: 1 | loss: 0.1761547
	speed: 0.0047s/iter; left time: 98.6702s
	iters: 700, epoch: 1 | loss: 0.1863717
	speed: 0.0055s/iter; left time: 114.5254s
	iters: 800, epoch: 1 | loss: 0.2366871
	speed: 0.0054s/iter; left time: 110.9914s
	iters: 900, epoch: 1 | loss: 0.2147972
	speed: 0.0054s/iter; left time: 111.5445s
	iters: 1000, epoch: 1 | loss: 0.1716947
	speed: 0.0045s/iter; left time: 93.1524s
Epoch: 1 cost time: 5.473837614059448
Epoch: 1, Steps: 1074 | Train Loss: 0.2821386 Vali Loss: 0.8775743 Test Loss: 2.3570080
Validation loss decreased (inf --> 0.877574).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.2043511
	speed: 0.0243s/iter; left time: 494.3615s
	iters: 200, epoch: 2 | loss: 0.2007514
	speed: 0.0048s/iter; left time: 97.2238s
	iters: 300, epoch: 2 | loss: 0.3945549
	speed: 0.0047s/iter; left time: 94.2979s
	iters: 400, epoch: 2 | loss: 0.2566750
	speed: 0.0048s/iter; left time: 95.2947s
	iters: 500, epoch: 2 | loss: 0.3103344
	speed: 0.0059s/iter; left time: 116.8149s
	iters: 600, epoch: 2 | loss: 0.2433392
	speed: 0.0049s/iter; left time: 97.3464s
	iters: 700, epoch: 2 | loss: 0.3378482
	speed: 0.0055s/iter; left time: 107.5943s
	iters: 800, epoch: 2 | loss: 0.1538522
	speed: 0.0046s/iter; left time: 89.9229s
	iters: 900, epoch: 2 | loss: 0.2651784
	speed: 0.0058s/iter; left time: 113.2445s
	iters: 1000, epoch: 2 | loss: 0.1780709
	speed: 0.0050s/iter; left time: 97.3649s
Epoch: 2 cost time: 5.53082799911499
Epoch: 2, Steps: 1074 | Train Loss: 0.2754465 Vali Loss: 0.2917594 Test Loss: 0.6262923
Validation loss decreased (0.877574 --> 0.291759).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.3513411
	speed: 0.0262s/iter; left time: 503.0484s
	iters: 200, epoch: 3 | loss: 0.1725327
	speed: 0.0054s/iter; left time: 103.1800s
	iters: 300, epoch: 3 | loss: 0.2663787
	speed: 0.0049s/iter; left time: 93.9930s
	iters: 400, epoch: 3 | loss: 0.2529561
	speed: 0.0067s/iter; left time: 126.9887s
	iters: 500, epoch: 3 | loss: 0.1442589
	speed: 0.0059s/iter; left time: 111.7528s
	iters: 600, epoch: 3 | loss: 0.4482040
	speed: 0.0064s/iter; left time: 120.6578s
	iters: 700, epoch: 3 | loss: 0.2493497
	speed: 0.0055s/iter; left time: 102.9853s
	iters: 800, epoch: 3 | loss: 0.2204991
	speed: 0.0059s/iter; left time: 109.6782s
	iters: 900, epoch: 3 | loss: 0.1642689
	speed: 0.0057s/iter; left time: 104.5552s
	iters: 1000, epoch: 3 | loss: 0.2323048
	speed: 0.0057s/iter; left time: 103.9635s
Epoch: 3 cost time: 6.193912029266357
Epoch: 3, Steps: 1074 | Train Loss: 0.2417761 Vali Loss: 0.1690195 Test Loss: 0.2827019
Validation loss decreased (0.291759 --> 0.169020).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.1752576
	speed: 0.0260s/iter; left time: 471.3814s
	iters: 200, epoch: 4 | loss: 0.3235370
	speed: 0.0053s/iter; left time: 96.2650s
	iters: 300, epoch: 4 | loss: 0.1746541
	speed: 0.0045s/iter; left time: 79.9477s
	iters: 400, epoch: 4 | loss: 0.2186384
	speed: 0.0055s/iter; left time: 97.4510s
	iters: 500, epoch: 4 | loss: 0.1673132
	speed: 0.0052s/iter; left time: 93.1775s
	iters: 600, epoch: 4 | loss: 0.1997065
	speed: 0.0057s/iter; left time: 100.0842s
	iters: 700, epoch: 4 | loss: 0.2074166
	speed: 0.0061s/iter; left time: 107.1187s
	iters: 800, epoch: 4 | loss: 0.1515145
	speed: 0.0054s/iter; left time: 94.2100s
	iters: 900, epoch: 4 | loss: 0.2222219
	speed: 0.0043s/iter; left time: 74.5544s
	iters: 1000, epoch: 4 | loss: 0.1324061
	speed: 0.0058s/iter; left time: 99.8750s
Epoch: 4 cost time: 5.652691602706909
Epoch: 4, Steps: 1074 | Train Loss: 0.2302691 Vali Loss: 0.1356330 Test Loss: 0.2087138
Validation loss decreased (0.169020 --> 0.135633).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.3732310
	speed: 0.0262s/iter; left time: 447.0792s
	iters: 200, epoch: 5 | loss: 0.3928410
	speed: 0.0058s/iter; left time: 98.5504s
	iters: 300, epoch: 5 | loss: 0.1084481
	speed: 0.0063s/iter; left time: 105.6191s
	iters: 400, epoch: 5 | loss: 0.4808046
	speed: 0.0059s/iter; left time: 98.9390s
	iters: 500, epoch: 5 | loss: 0.1920620
	speed: 0.0066s/iter; left time: 109.2972s
	iters: 600, epoch: 5 | loss: 0.2377929
	speed: 0.0063s/iter; left time: 104.0750s
	iters: 700, epoch: 5 | loss: 0.1524495
	speed: 0.0068s/iter; left time: 112.3465s
	iters: 800, epoch: 5 | loss: 0.2720622
	speed: 0.0055s/iter; left time: 89.9851s
	iters: 900, epoch: 5 | loss: 0.1720062
	speed: 0.0042s/iter; left time: 69.0946s
	iters: 1000, epoch: 5 | loss: 0.1220241
	speed: 0.0060s/iter; left time: 97.3665s
Epoch: 5 cost time: 6.2721779346466064
Epoch: 5, Steps: 1074 | Train Loss: 0.2235184 Vali Loss: 0.1520802 Test Loss: 0.2501965
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.1245754
	speed: 0.0241s/iter; left time: 385.2552s
	iters: 200, epoch: 6 | loss: 0.3808462
	speed: 0.0052s/iter; left time: 82.0578s
	iters: 300, epoch: 6 | loss: 0.1350365
	speed: 0.0050s/iter; left time: 78.7141s
	iters: 400, epoch: 6 | loss: 0.2276967
	speed: 0.0059s/iter; left time: 92.8295s
	iters: 500, epoch: 6 | loss: 0.2065234
	speed: 0.0049s/iter; left time: 75.8819s
	iters: 600, epoch: 6 | loss: 0.2233522
	speed: 0.0068s/iter; left time: 105.0254s
	iters: 700, epoch: 6 | loss: 0.4576711
	speed: 0.0071s/iter; left time: 109.4497s
	iters: 800, epoch: 6 | loss: 0.2100136
	speed: 0.0048s/iter; left time: 73.8598s
	iters: 900, epoch: 6 | loss: 0.2567297
	speed: 0.0052s/iter; left time: 78.5217s
	iters: 1000, epoch: 6 | loss: 0.2755909
	speed: 0.0050s/iter; left time: 75.3008s
Epoch: 6 cost time: 5.895402431488037
Epoch: 6, Steps: 1074 | Train Loss: 0.2203504 Vali Loss: 0.1515800 Test Loss: 0.2505952
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.1274870
	speed: 0.0247s/iter; left time: 369.0301s
	iters: 200, epoch: 7 | loss: 0.1531867
	speed: 0.0053s/iter; left time: 78.3716s
	iters: 300, epoch: 7 | loss: 0.2563086
	speed: 0.0050s/iter; left time: 74.2865s
	iters: 400, epoch: 7 | loss: 0.2812338
	speed: 0.0054s/iter; left time: 79.1327s
	iters: 500, epoch: 7 | loss: 0.2579995
	speed: 0.0053s/iter; left time: 77.1894s
	iters: 600, epoch: 7 | loss: 0.1740053
	speed: 0.0061s/iter; left time: 88.6618s
	iters: 700, epoch: 7 | loss: 0.1624275
	speed: 0.0059s/iter; left time: 83.8728s
	iters: 800, epoch: 7 | loss: 0.3124297
	speed: 0.0053s/iter; left time: 75.7245s
	iters: 900, epoch: 7 | loss: 0.1765921
	speed: 0.0054s/iter; left time: 76.0993s
	iters: 1000, epoch: 7 | loss: 0.4855415
	speed: 0.0054s/iter; left time: 75.1768s
Epoch: 7 cost time: 5.95962929725647
Epoch: 7, Steps: 1074 | Train Loss: 0.2185329 Vali Loss: 0.1765115 Test Loss: 0.3278347
EarlyStopping counter: 3 out of 5
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.3319881
	speed: 0.0229s/iter; left time: 317.4261s
	iters: 200, epoch: 8 | loss: 0.1693051
	speed: 0.0045s/iter; left time: 62.4201s
	iters: 300, epoch: 8 | loss: 0.5163977
	speed: 0.0052s/iter; left time: 71.0909s
	iters: 400, epoch: 8 | loss: 0.0997549
	speed: 0.0052s/iter; left time: 70.9748s
	iters: 500, epoch: 8 | loss: 0.2732592
	speed: 0.0055s/iter; left time: 74.3442s
	iters: 600, epoch: 8 | loss: 0.1077577
	speed: 0.0037s/iter; left time: 49.9676s
	iters: 700, epoch: 8 | loss: 0.1790978
	speed: 0.0046s/iter; left time: 61.1048s
	iters: 800, epoch: 8 | loss: 0.1100722
	speed: 0.0052s/iter; left time: 67.9826s
	iters: 900, epoch: 8 | loss: 0.1679987
	speed: 0.0046s/iter; left time: 60.2184s
	iters: 1000, epoch: 8 | loss: 0.2674232
	speed: 0.0042s/iter; left time: 54.1143s
Epoch: 8 cost time: 5.050373792648315
Epoch: 8, Steps: 1074 | Train Loss: 0.2173657 Vali Loss: 0.1565690 Test Loss: 0.2717007
EarlyStopping counter: 4 out of 5
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.2520226
	speed: 0.0223s/iter; left time: 284.6767s
	iters: 200, epoch: 9 | loss: 0.1833272
	speed: 0.0047s/iter; left time: 60.1214s
	iters: 300, epoch: 9 | loss: 0.2628646
	speed: 0.0046s/iter; left time: 57.4278s
	iters: 400, epoch: 9 | loss: 0.1403819
	speed: 0.0059s/iter; left time: 73.2013s
	iters: 500, epoch: 9 | loss: 0.3093079
	speed: 0.0057s/iter; left time: 70.5794s
	iters: 600, epoch: 9 | loss: 0.1959047
	speed: 0.0050s/iter; left time: 61.2020s
	iters: 700, epoch: 9 | loss: 0.1586328
	speed: 0.0052s/iter; left time: 63.1104s
	iters: 800, epoch: 9 | loss: 0.1891349
	speed: 0.0055s/iter; left time: 65.8910s
	iters: 900, epoch: 9 | loss: 0.2445292
	speed: 0.0060s/iter; left time: 71.8189s
	iters: 1000, epoch: 9 | loss: 0.3132994
	speed: 0.0061s/iter; left time: 72.9050s
Epoch: 9 cost time: 5.726538896560669
Epoch: 9, Steps: 1074 | Train Loss: 0.2169069 Vali Loss: 0.1542184 Test Loss: 0.2681393
EarlyStopping counter: 5 out of 5
Early stopping
Total training time: 65.4579 seconds
>>>>>>>testing : ETTm2_96_96_DLinear_ETTm2_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed28649<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
data_set:  <data_provider.data_loader.Dataset_ETT_minute object at 0x000001FE112137F0>
mse:0.2091180384159088, mae:0.2976931631565094
