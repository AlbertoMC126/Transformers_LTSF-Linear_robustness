Args in experiment:
Namespace(activation='gelu', batch_size=8, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='exchange_rate.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=8, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='mse', lradj='type1', model='Linear', model_id='Exchange_336_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=12890, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : Exchange_336_96_Linear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed12890>>>>>>>>>>>>>>>>>>>>>>>>>>
train 4880
val 665
test 1422
	iters: 100, epoch: 1 | loss: 0.2816823
	speed: 0.0032s/iter; left time: 38.6020s
	iters: 200, epoch: 1 | loss: 0.0911564
	speed: 0.0031s/iter; left time: 37.4655s
	iters: 300, epoch: 1 | loss: 0.1966102
	speed: 0.0030s/iter; left time: 35.6800s
	iters: 400, epoch: 1 | loss: 0.1328557
	speed: 0.0030s/iter; left time: 34.9314s
	iters: 500, epoch: 1 | loss: 0.1724209
	speed: 0.0027s/iter; left time: 31.4943s
	iters: 600, epoch: 1 | loss: 0.1822618
	speed: 0.0030s/iter; left time: 34.6870s
Epoch: 1 cost time: 1.8231544494628906
Epoch: 1, Steps: 610 | Train Loss: 0.1653650 Vali Loss: 0.2871589 Test Loss: 0.1425805
Validation loss decreased (inf --> 0.287159).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.0928679
	speed: 0.0050s/iter; left time: 57.4583s
	iters: 200, epoch: 2 | loss: 0.0656071
	speed: 0.0034s/iter; left time: 39.2101s
	iters: 300, epoch: 2 | loss: 0.2415129
	speed: 0.0028s/iter; left time: 31.6149s
	iters: 400, epoch: 2 | loss: 0.0636945
	speed: 0.0027s/iter; left time: 30.3274s
	iters: 500, epoch: 2 | loss: 0.2062741
	speed: 0.0028s/iter; left time: 31.2765s
	iters: 600, epoch: 2 | loss: 0.0975555
	speed: 0.0031s/iter; left time: 34.4223s
Epoch: 2 cost time: 1.865433692932129
Epoch: 2, Steps: 610 | Train Loss: 0.1289255 Vali Loss: 0.3076795 Test Loss: 0.1602900
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1888717
	speed: 0.0044s/iter; left time: 47.7676s
	iters: 200, epoch: 3 | loss: 0.0737408
	speed: 0.0028s/iter; left time: 30.1036s
	iters: 300, epoch: 3 | loss: 0.0965853
	speed: 0.0031s/iter; left time: 33.4315s
	iters: 400, epoch: 3 | loss: 0.0599771
	speed: 0.0032s/iter; left time: 33.7587s
	iters: 500, epoch: 3 | loss: 0.0613754
	speed: 0.0032s/iter; left time: 33.1201s
	iters: 600, epoch: 3 | loss: 0.1416614
	speed: 0.0032s/iter; left time: 33.0314s
Epoch: 3 cost time: 1.8474702835083008
Epoch: 3, Steps: 610 | Train Loss: 0.1204446 Vali Loss: 0.2166940 Test Loss: 0.0977946
Validation loss decreased (0.287159 --> 0.216694).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1382518
	speed: 0.0053s/iter; left time: 54.4414s
	iters: 200, epoch: 4 | loss: 0.1154153
	speed: 0.0033s/iter; left time: 33.8966s
	iters: 300, epoch: 4 | loss: 0.0657710
	speed: 0.0031s/iter; left time: 30.8169s
	iters: 400, epoch: 4 | loss: 0.0795982
	speed: 0.0030s/iter; left time: 29.9130s
	iters: 500, epoch: 4 | loss: 0.0786396
	speed: 0.0026s/iter; left time: 25.1866s
	iters: 600, epoch: 4 | loss: 0.1541144
	speed: 0.0030s/iter; left time: 28.9270s
Epoch: 4 cost time: 1.8465230464935303
Epoch: 4, Steps: 610 | Train Loss: 0.1164411 Vali Loss: 0.2023171 Test Loss: 0.0964659
Validation loss decreased (0.216694 --> 0.202317).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0576061
	speed: 0.0060s/iter; left time: 57.8694s
	iters: 200, epoch: 5 | loss: 0.0823512
	speed: 0.0030s/iter; left time: 28.9694s
	iters: 300, epoch: 5 | loss: 0.0564432
	speed: 0.0033s/iter; left time: 31.3157s
	iters: 400, epoch: 5 | loss: 0.0942061
	speed: 0.0034s/iter; left time: 31.9209s
	iters: 500, epoch: 5 | loss: 0.0984089
	speed: 0.0033s/iter; left time: 30.5789s
	iters: 600, epoch: 5 | loss: 0.0627043
	speed: 0.0026s/iter; left time: 24.0019s
Epoch: 5 cost time: 1.9511833190917969
Epoch: 5, Steps: 610 | Train Loss: 0.1147319 Vali Loss: 0.2098031 Test Loss: 0.0964403
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1205633
	speed: 0.0040s/iter; left time: 36.6564s
	iters: 200, epoch: 6 | loss: 0.1530581
	speed: 0.0028s/iter; left time: 25.1742s
	iters: 300, epoch: 6 | loss: 0.1001655
	speed: 0.0029s/iter; left time: 25.4910s
	iters: 400, epoch: 6 | loss: 0.0798167
	speed: 0.0031s/iter; left time: 26.8655s
	iters: 500, epoch: 6 | loss: 0.0765298
	speed: 0.0030s/iter; left time: 25.9763s
	iters: 600, epoch: 6 | loss: 0.1370515
	speed: 0.0028s/iter; left time: 23.8613s
Epoch: 6 cost time: 1.7485630512237549
Epoch: 6, Steps: 610 | Train Loss: 0.1139905 Vali Loss: 0.2015650 Test Loss: 0.0918478
Validation loss decreased (0.202317 --> 0.201565).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.0882072
	speed: 0.0057s/iter; left time: 47.7763s
	iters: 200, epoch: 7 | loss: 0.0858521
	speed: 0.0032s/iter; left time: 26.2986s
	iters: 300, epoch: 7 | loss: 0.0935491
	speed: 0.0033s/iter; left time: 26.8658s
	iters: 400, epoch: 7 | loss: 0.0703594
	speed: 0.0029s/iter; left time: 23.4501s
	iters: 500, epoch: 7 | loss: 0.1370561
	speed: 0.0028s/iter; left time: 22.8509s
	iters: 600, epoch: 7 | loss: 0.1005606
	speed: 0.0030s/iter; left time: 23.8142s
Epoch: 7 cost time: 1.8694143295288086
Epoch: 7, Steps: 610 | Train Loss: 0.1136019 Vali Loss: 0.2273280 Test Loss: 0.0987519
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.0842583
	speed: 0.0049s/iter; left time: 38.2153s
	iters: 200, epoch: 8 | loss: 0.1377353
	speed: 0.0029s/iter; left time: 22.0503s
	iters: 300, epoch: 8 | loss: 0.0784708
	speed: 0.0033s/iter; left time: 24.8770s
	iters: 400, epoch: 8 | loss: 0.0778454
	speed: 0.0032s/iter; left time: 24.1744s
	iters: 500, epoch: 8 | loss: 0.0755676
	speed: 0.0032s/iter; left time: 23.7916s
	iters: 600, epoch: 8 | loss: 0.1017554
	speed: 0.0032s/iter; left time: 23.7561s
Epoch: 8 cost time: 1.8874354362487793
Epoch: 8, Steps: 610 | Train Loss: 0.1133212 Vali Loss: 0.2127048 Test Loss: 0.0936688
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.1375453
	speed: 0.0050s/iter; left time: 36.4402s
	iters: 200, epoch: 9 | loss: 0.0969717
	speed: 0.0030s/iter; left time: 21.5224s
	iters: 300, epoch: 9 | loss: 0.0739545
	speed: 0.0030s/iter; left time: 21.3437s
	iters: 400, epoch: 9 | loss: 0.0696867
	speed: 0.0031s/iter; left time: 21.1111s
	iters: 500, epoch: 9 | loss: 0.0668061
	speed: 0.0029s/iter; left time: 19.4556s
	iters: 600, epoch: 9 | loss: 0.0733844
	speed: 0.0027s/iter; left time: 18.1467s
Epoch: 9 cost time: 1.794497013092041
Epoch: 9, Steps: 610 | Train Loss: 0.1131972 Vali Loss: 0.2073736 Test Loss: 0.0919850
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.1101454
	speed: 0.0044s/iter; left time: 29.2853s
	iters: 200, epoch: 10 | loss: 0.1196099
	speed: 0.0028s/iter; left time: 18.5039s
	iters: 300, epoch: 10 | loss: 0.0893338
	speed: 0.0032s/iter; left time: 20.3869s
	iters: 400, epoch: 10 | loss: 0.1863790
	speed: 0.0031s/iter; left time: 19.6903s
	iters: 500, epoch: 10 | loss: 0.1184350
	speed: 0.0031s/iter; left time: 19.2680s
	iters: 600, epoch: 10 | loss: 0.0781837
	speed: 0.0031s/iter; left time: 18.7608s
Epoch: 10 cost time: 1.8294484615325928
Epoch: 10, Steps: 610 | Train Loss: 0.1131324 Vali Loss: 0.2070000 Test Loss: 0.0914963
EarlyStopping counter: 4 out of 5
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 11 | loss: 0.1546228
	speed: 0.0052s/iter; left time: 31.1008s
	iters: 200, epoch: 11 | loss: 0.1039215
	speed: 0.0031s/iter; left time: 18.4792s
	iters: 300, epoch: 11 | loss: 0.0722120
	speed: 0.0031s/iter; left time: 18.0992s
	iters: 400, epoch: 11 | loss: 0.1614851
	speed: 0.0029s/iter; left time: 16.7641s
	iters: 500, epoch: 11 | loss: 0.0798468
	speed: 0.0029s/iter; left time: 16.4257s
	iters: 600, epoch: 11 | loss: 0.0586769
	speed: 0.0030s/iter; left time: 16.3379s
Epoch: 11 cost time: 1.8457036018371582
Epoch: 11, Steps: 610 | Train Loss: 0.1130939 Vali Loss: 0.2087451 Test Loss: 0.0916884
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : Exchange_336_96_Linear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed12890<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 1422
mse:0.09171169251203537, mae:0.22332975268363953
