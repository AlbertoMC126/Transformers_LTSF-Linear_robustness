Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='Linear', model_id='ETTm2_336_720', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=720, root_path='./dataset/', save_pred_values=False, seed=3144, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTm2_336_720_Linear_ETTm2_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3144>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33505
val 10801
test 10801
	iters: 100, epoch: 1 | loss: 0.6356489
	speed: 0.0198s/iter; left time: 412.5285s
	iters: 200, epoch: 1 | loss: 0.5681620
	speed: 0.0208s/iter; left time: 432.2290s
	iters: 300, epoch: 1 | loss: 0.7415041
	speed: 0.0190s/iter; left time: 391.7694s
	iters: 400, epoch: 1 | loss: 0.3506289
	speed: 0.0186s/iter; left time: 382.9098s
	iters: 500, epoch: 1 | loss: 1.4603326
	speed: 0.0189s/iter; left time: 386.2139s
	iters: 600, epoch: 1 | loss: 0.6255687
	speed: 0.0181s/iter; left time: 368.8213s
	iters: 700, epoch: 1 | loss: 0.7543717
	speed: 0.0193s/iter; left time: 390.6481s
	iters: 800, epoch: 1 | loss: 0.5086313
	speed: 0.0184s/iter; left time: 370.6942s
	iters: 900, epoch: 1 | loss: 0.6271009
	speed: 0.0182s/iter; left time: 365.1449s
	iters: 1000, epoch: 1 | loss: 0.8937254
	speed: 0.0157s/iter; left time: 312.6199s
Epoch: 1 cost time: 19.45065140724182
Epoch: 1, Steps: 1047 | Train Loss: 0.7221378 Vali Loss: 0.8978882 Test Loss: 2.2922778
Validation loss decreased (inf --> 0.897888).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.5705801
	speed: 0.0592s/iter; left time: 1172.3187s
	iters: 200, epoch: 2 | loss: 0.7638781
	speed: 0.0187s/iter; left time: 368.8452s
	iters: 300, epoch: 2 | loss: 1.5726714
	speed: 0.0194s/iter; left time: 379.3585s
	iters: 400, epoch: 2 | loss: 0.9184787
	speed: 0.0199s/iter; left time: 387.0503s
	iters: 500, epoch: 2 | loss: 0.8021148
	speed: 0.0186s/iter; left time: 359.8929s
	iters: 600, epoch: 2 | loss: 1.0125254
	speed: 0.0175s/iter; left time: 337.5220s
	iters: 700, epoch: 2 | loss: 0.7119170
	speed: 0.0200s/iter; left time: 382.9400s
	iters: 800, epoch: 2 | loss: 0.7345725
	speed: 0.0202s/iter; left time: 386.3256s
	iters: 900, epoch: 2 | loss: 0.9383844
	speed: 0.0210s/iter; left time: 399.2946s
	iters: 1000, epoch: 2 | loss: 0.6601006
	speed: 0.0193s/iter; left time: 364.6414s
Epoch: 2 cost time: 19.90720224380493
Epoch: 2, Steps: 1047 | Train Loss: 0.7147697 Vali Loss: 0.7888642 Test Loss: 2.1281648
Validation loss decreased (0.897888 --> 0.788864).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.4333401
	speed: 0.0635s/iter; left time: 1190.4204s
	iters: 200, epoch: 3 | loss: 0.3658544
	speed: 0.0188s/iter; left time: 349.7669s
	iters: 300, epoch: 3 | loss: 0.3896358
	speed: 0.0177s/iter; left time: 327.6763s
	iters: 400, epoch: 3 | loss: 0.4286544
	speed: 0.0193s/iter; left time: 356.4056s
	iters: 500, epoch: 3 | loss: 0.5797053
	speed: 0.0202s/iter; left time: 369.7314s
	iters: 600, epoch: 3 | loss: 0.3892526
	speed: 0.0192s/iter; left time: 349.5750s
	iters: 700, epoch: 3 | loss: 0.6168091
	speed: 0.0184s/iter; left time: 333.1767s
	iters: 800, epoch: 3 | loss: 0.6832681
	speed: 0.0177s/iter; left time: 320.2342s
	iters: 900, epoch: 3 | loss: 0.6682149
	speed: 0.0177s/iter; left time: 317.5738s
	iters: 1000, epoch: 3 | loss: 1.0603180
	speed: 0.0162s/iter; left time: 289.5196s
Epoch: 3 cost time: 19.011975049972534
Epoch: 3, Steps: 1047 | Train Loss: 0.5509873 Vali Loss: 0.5708320 Test Loss: 1.1629462
Validation loss decreased (0.788864 --> 0.570832).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.3961595
	speed: 0.0587s/iter; left time: 1038.3703s
	iters: 200, epoch: 4 | loss: 0.7032530
	speed: 0.0190s/iter; left time: 333.7173s
	iters: 300, epoch: 4 | loss: 0.5386896
	speed: 0.0184s/iter; left time: 321.4530s
	iters: 400, epoch: 4 | loss: 0.7005879
	speed: 0.0180s/iter; left time: 312.8114s
	iters: 500, epoch: 4 | loss: 0.7383029
	speed: 0.0189s/iter; left time: 326.7844s
	iters: 600, epoch: 4 | loss: 0.5014042
	speed: 0.0173s/iter; left time: 297.2422s
	iters: 700, epoch: 4 | loss: 0.3434168
	speed: 0.0177s/iter; left time: 301.8467s
	iters: 800, epoch: 4 | loss: 0.3602535
	speed: 0.0193s/iter; left time: 328.5292s
	iters: 900, epoch: 4 | loss: 0.4487080
	speed: 0.0154s/iter; left time: 259.5396s
	iters: 1000, epoch: 4 | loss: 0.4847696
	speed: 0.0175s/iter; left time: 293.8187s
Epoch: 4 cost time: 18.52195143699646
Epoch: 4, Steps: 1047 | Train Loss: 0.4994406 Vali Loss: 0.3911361 Test Loss: 0.7423815
Validation loss decreased (0.570832 --> 0.391136).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.4530048
	speed: 0.0586s/iter; left time: 976.0657s
	iters: 200, epoch: 5 | loss: 0.3264740
	speed: 0.0194s/iter; left time: 321.6436s
	iters: 300, epoch: 5 | loss: 0.5182275
	speed: 0.0203s/iter; left time: 333.1746s
	iters: 400, epoch: 5 | loss: 0.3427709
	speed: 0.0207s/iter; left time: 338.8764s
	iters: 500, epoch: 5 | loss: 0.3475545
	speed: 0.0202s/iter; left time: 328.0702s
	iters: 600, epoch: 5 | loss: 0.3124455
	speed: 0.0214s/iter; left time: 345.3455s
	iters: 700, epoch: 5 | loss: 0.5599096
	speed: 0.0212s/iter; left time: 340.2281s
	iters: 800, epoch: 5 | loss: 0.6258924
	speed: 0.0205s/iter; left time: 326.8679s
	iters: 900, epoch: 5 | loss: 0.4501618
	speed: 0.0191s/iter; left time: 302.6046s
	iters: 1000, epoch: 5 | loss: 0.5427254
	speed: 0.0175s/iter; left time: 275.6520s
Epoch: 5 cost time: 20.458125352859497
Epoch: 5, Steps: 1047 | Train Loss: 0.4770800 Vali Loss: 0.3424863 Test Loss: 0.5636734
Validation loss decreased (0.391136 --> 0.342486).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.6886740
	speed: 0.0616s/iter; left time: 961.8550s
	iters: 200, epoch: 6 | loss: 0.3504105
	speed: 0.0200s/iter; left time: 309.6355s
	iters: 300, epoch: 6 | loss: 0.6765924
	speed: 0.0193s/iter; left time: 297.6950s
	iters: 400, epoch: 6 | loss: 0.7127408
	speed: 0.0191s/iter; left time: 292.5009s
	iters: 500, epoch: 6 | loss: 0.4354064
	speed: 0.0199s/iter; left time: 301.9829s
	iters: 600, epoch: 6 | loss: 0.4866731
	speed: 0.0183s/iter; left time: 276.1440s
	iters: 700, epoch: 6 | loss: 0.5001304
	speed: 0.0182s/iter; left time: 272.6347s
	iters: 800, epoch: 6 | loss: 0.5138131
	speed: 0.0178s/iter; left time: 265.7231s
	iters: 900, epoch: 6 | loss: 0.3520893
	speed: 0.0182s/iter; left time: 269.4185s
	iters: 1000, epoch: 6 | loss: 0.4509688
	speed: 0.0174s/iter; left time: 255.7064s
Epoch: 6 cost time: 19.564383029937744
Epoch: 6, Steps: 1047 | Train Loss: 0.4643446 Vali Loss: 0.4944919 Test Loss: 1.1453487
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.3370445
	speed: 0.0664s/iter; left time: 966.1441s
	iters: 200, epoch: 7 | loss: 0.3929093
	speed: 0.0182s/iter; left time: 262.4911s
	iters: 300, epoch: 7 | loss: 0.4710757
	speed: 0.0185s/iter; left time: 265.9282s
	iters: 400, epoch: 7 | loss: 0.4125713
	speed: 0.0186s/iter; left time: 264.5247s
	iters: 500, epoch: 7 | loss: 0.4751340
	speed: 0.0205s/iter; left time: 290.2095s
	iters: 600, epoch: 7 | loss: 0.2797254
	speed: 0.0196s/iter; left time: 275.2622s
	iters: 700, epoch: 7 | loss: 0.4293463
	speed: 0.0199s/iter; left time: 277.5152s
	iters: 800, epoch: 7 | loss: 0.7828740
	speed: 0.0177s/iter; left time: 244.9655s
	iters: 900, epoch: 7 | loss: 0.4396075
	speed: 0.0170s/iter; left time: 233.5731s
	iters: 1000, epoch: 7 | loss: 0.3028875
	speed: 0.0155s/iter; left time: 211.8957s
Epoch: 7 cost time: 19.210045099258423
Epoch: 7, Steps: 1047 | Train Loss: 0.4572510 Vali Loss: 0.4862013 Test Loss: 1.0960582
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.6981482
	speed: 0.0661s/iter; left time: 892.9257s
	iters: 200, epoch: 8 | loss: 0.4576528
	speed: 0.0169s/iter; left time: 226.7391s
	iters: 300, epoch: 8 | loss: 0.5397985
	speed: 0.0188s/iter; left time: 250.8973s
	iters: 400, epoch: 8 | loss: 0.7434109
	speed: 0.0199s/iter; left time: 263.1245s
	iters: 500, epoch: 8 | loss: 0.3183093
	speed: 0.0190s/iter; left time: 248.5048s
	iters: 600, epoch: 8 | loss: 0.7779721
	speed: 0.0199s/iter; left time: 258.5596s
	iters: 700, epoch: 8 | loss: 0.4249399
	speed: 0.0165s/iter; left time: 212.9343s
	iters: 800, epoch: 8 | loss: 0.4949853
	speed: 0.0181s/iter; left time: 231.9833s
	iters: 900, epoch: 8 | loss: 0.3380928
	speed: 0.0173s/iter; left time: 219.3724s
	iters: 1000, epoch: 8 | loss: 0.4610833
	speed: 0.0166s/iter; left time: 209.5878s
Epoch: 8 cost time: 18.977810859680176
Epoch: 8, Steps: 1047 | Train Loss: 0.4535354 Vali Loss: 0.4497871 Test Loss: 0.9738532
EarlyStopping counter: 3 out of 5
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.5265830
	speed: 0.0680s/iter; left time: 847.7167s
	iters: 200, epoch: 9 | loss: 0.4260409
	speed: 0.0193s/iter; left time: 238.9917s
	iters: 300, epoch: 9 | loss: 0.2790385
	speed: 0.0187s/iter; left time: 229.0231s
	iters: 400, epoch: 9 | loss: 0.3829125
	speed: 0.0194s/iter; left time: 235.9208s
	iters: 500, epoch: 9 | loss: 0.4070814
	speed: 0.0186s/iter; left time: 224.7092s
	iters: 600, epoch: 9 | loss: 0.5270774
	speed: 0.0193s/iter; left time: 231.1803s
	iters: 700, epoch: 9 | loss: 0.4669803
	speed: 0.0180s/iter; left time: 213.4060s
	iters: 800, epoch: 9 | loss: 0.8911615
	speed: 0.0188s/iter; left time: 220.8716s
	iters: 900, epoch: 9 | loss: 0.8566284
	speed: 0.0187s/iter; left time: 218.2547s
	iters: 1000, epoch: 9 | loss: 0.3552228
	speed: 0.0157s/iter; left time: 181.1784s
Epoch: 9 cost time: 19.30698847770691
Epoch: 9, Steps: 1047 | Train Loss: 0.4513865 Vali Loss: 0.4110943 Test Loss: 0.8300951
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.3020537
	speed: 0.0606s/iter; left time: 692.2636s
	iters: 200, epoch: 10 | loss: 0.6134329
	speed: 0.0163s/iter; left time: 184.9267s
	iters: 300, epoch: 10 | loss: 0.5441328
	speed: 0.0172s/iter; left time: 193.2474s
	iters: 400, epoch: 10 | loss: 0.4300058
	speed: 0.0180s/iter; left time: 200.1167s
	iters: 500, epoch: 10 | loss: 0.6666608
	speed: 0.0180s/iter; left time: 198.7078s
	iters: 600, epoch: 10 | loss: 0.2841143
	speed: 0.0150s/iter; left time: 163.8984s
	iters: 700, epoch: 10 | loss: 0.4692436
	speed: 0.0153s/iter; left time: 165.1489s
	iters: 800, epoch: 10 | loss: 0.4178284
	speed: 0.0150s/iter; left time: 160.2457s
	iters: 900, epoch: 10 | loss: 0.3511806
	speed: 0.0164s/iter; left time: 174.4210s
	iters: 1000, epoch: 10 | loss: 0.4731498
	speed: 0.0138s/iter; left time: 144.7587s
Epoch: 10 cost time: 16.908634424209595
Epoch: 10, Steps: 1047 | Train Loss: 0.4503230 Vali Loss: 0.3958758 Test Loss: 0.7777798
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTm2_336_720_Linear_ETTm2_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3144<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10801
mse:0.5639685392379761, mae:0.49701136350631714
