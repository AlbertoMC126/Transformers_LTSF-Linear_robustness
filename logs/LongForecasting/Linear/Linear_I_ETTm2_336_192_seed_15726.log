Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='Linear', model_id='ETTm2_336_192', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=192, root_path='./dataset/', save_pred_values=False, seed=15726, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTm2_336_192_Linear_ETTm2_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15726>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34033
val 11329
test 11329
	iters: 100, epoch: 1 | loss: 0.5500962
	speed: 0.0060s/iter; left time: 125.9555s
	iters: 200, epoch: 1 | loss: 0.3033509
	speed: 0.0045s/iter; left time: 94.1486s
	iters: 300, epoch: 1 | loss: 0.8814492
	speed: 0.0042s/iter; left time: 88.7076s
	iters: 400, epoch: 1 | loss: 0.4166658
	speed: 0.0064s/iter; left time: 133.7288s
	iters: 500, epoch: 1 | loss: 0.3110857
	speed: 0.0056s/iter; left time: 116.0979s
	iters: 600, epoch: 1 | loss: 0.5968778
	speed: 0.0057s/iter; left time: 118.5944s
	iters: 700, epoch: 1 | loss: 0.2921079
	speed: 0.0056s/iter; left time: 115.2237s
	iters: 800, epoch: 1 | loss: 0.3275197
	speed: 0.0067s/iter; left time: 137.7517s
	iters: 900, epoch: 1 | loss: 0.4333328
	speed: 0.0058s/iter; left time: 118.0186s
	iters: 1000, epoch: 1 | loss: 0.3115657
	speed: 0.0043s/iter; left time: 86.3611s
Epoch: 1 cost time: 5.785230398178101
Epoch: 1, Steps: 1063 | Train Loss: 0.5044102 Vali Loss: 0.3090794 Test Loss: 0.5534027
Validation loss decreased (inf --> 0.309079).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.4141277
	speed: 0.0219s/iter; left time: 439.4634s
	iters: 200, epoch: 2 | loss: 0.4473029
	speed: 0.0046s/iter; left time: 91.9908s
	iters: 300, epoch: 2 | loss: 0.3663174
	speed: 0.0058s/iter; left time: 115.6745s
	iters: 400, epoch: 2 | loss: 0.2475570
	speed: 0.0051s/iter; left time: 100.3856s
	iters: 500, epoch: 2 | loss: 0.5737653
	speed: 0.0056s/iter; left time: 111.1480s
	iters: 600, epoch: 2 | loss: 0.3461625
	speed: 0.0062s/iter; left time: 121.1870s
	iters: 700, epoch: 2 | loss: 0.2591241
	speed: 0.0062s/iter; left time: 121.6671s
	iters: 800, epoch: 2 | loss: 0.4394262
	speed: 0.0062s/iter; left time: 119.5117s
	iters: 900, epoch: 2 | loss: 0.9460430
	speed: 0.0062s/iter; left time: 119.2624s
	iters: 1000, epoch: 2 | loss: 0.4190381
	speed: 0.0057s/iter; left time: 109.8901s
Epoch: 2 cost time: 6.005908489227295
Epoch: 2, Steps: 1063 | Train Loss: 0.5084300 Vali Loss: 1.0813528 Test Loss: 3.0476067
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.4385445
	speed: 0.0257s/iter; left time: 490.1447s
	iters: 200, epoch: 3 | loss: 0.1988239
	speed: 0.0057s/iter; left time: 108.4673s
	iters: 300, epoch: 3 | loss: 0.2282617
	speed: 0.0055s/iter; left time: 103.4628s
	iters: 400, epoch: 3 | loss: 0.6075314
	speed: 0.0055s/iter; left time: 102.2609s
	iters: 500, epoch: 3 | loss: 0.6332842
	speed: 0.0056s/iter; left time: 105.1437s
	iters: 600, epoch: 3 | loss: 0.1787557
	speed: 0.0058s/iter; left time: 107.1323s
	iters: 700, epoch: 3 | loss: 0.2053299
	speed: 0.0053s/iter; left time: 98.0839s
	iters: 800, epoch: 3 | loss: 0.1833101
	speed: 0.0056s/iter; left time: 103.2260s
	iters: 900, epoch: 3 | loss: 0.3198276
	speed: 0.0054s/iter; left time: 98.7287s
	iters: 1000, epoch: 3 | loss: 0.5033280
	speed: 0.0061s/iter; left time: 111.2174s
Epoch: 3 cost time: 5.971307754516602
Epoch: 3, Steps: 1063 | Train Loss: 0.3506878 Vali Loss: 0.2825555 Test Loss: 0.4800851
Validation loss decreased (0.309079 --> 0.282556).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.1197122
	speed: 0.0239s/iter; left time: 429.0866s
	iters: 200, epoch: 4 | loss: 0.3562804
	speed: 0.0066s/iter; left time: 117.1126s
	iters: 300, epoch: 4 | loss: 0.7684718
	speed: 0.0055s/iter; left time: 97.5406s
	iters: 400, epoch: 4 | loss: 0.2014413
	speed: 0.0063s/iter; left time: 110.4942s
	iters: 500, epoch: 4 | loss: 0.3977798
	speed: 0.0051s/iter; left time: 89.0918s
	iters: 600, epoch: 4 | loss: 0.2750093
	speed: 0.0063s/iter; left time: 109.5848s
	iters: 700, epoch: 4 | loss: 0.6914021
	speed: 0.0064s/iter; left time: 111.7433s
	iters: 800, epoch: 4 | loss: 0.1716934
	speed: 0.0055s/iter; left time: 95.1777s
	iters: 900, epoch: 4 | loss: 0.2707336
	speed: 0.0054s/iter; left time: 92.4350s
	iters: 1000, epoch: 4 | loss: 0.2962937
	speed: 0.0061s/iter; left time: 104.7930s
Epoch: 4 cost time: 6.277472734451294
Epoch: 4, Steps: 1063 | Train Loss: 0.3133669 Vali Loss: 0.2447249 Test Loss: 0.4708680
Validation loss decreased (0.282556 --> 0.244725).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.4953364
	speed: 0.0223s/iter; left time: 376.8231s
	iters: 200, epoch: 5 | loss: 0.2523260
	speed: 0.0055s/iter; left time: 93.1657s
	iters: 300, epoch: 5 | loss: 0.3877149
	speed: 0.0056s/iter; left time: 92.9634s
	iters: 400, epoch: 5 | loss: 0.3178111
	speed: 0.0060s/iter; left time: 99.3318s
	iters: 500, epoch: 5 | loss: 0.2097369
	speed: 0.0062s/iter; left time: 101.7455s
	iters: 600, epoch: 5 | loss: 0.3201076
	speed: 0.0056s/iter; left time: 91.5619s
	iters: 700, epoch: 5 | loss: 0.3143581
	speed: 0.0047s/iter; left time: 76.3777s
	iters: 800, epoch: 5 | loss: 0.7252688
	speed: 0.0048s/iter; left time: 77.3168s
	iters: 900, epoch: 5 | loss: 0.4511884
	speed: 0.0046s/iter; left time: 74.8000s
	iters: 1000, epoch: 5 | loss: 0.2201424
	speed: 0.0043s/iter; left time: 68.5344s
Epoch: 5 cost time: 5.603059530258179
Epoch: 5, Steps: 1063 | Train Loss: 0.2954185 Vali Loss: 0.1860571 Test Loss: 0.3030674
Validation loss decreased (0.244725 --> 0.186057).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.1906028
	speed: 0.0239s/iter; left time: 379.0585s
	iters: 200, epoch: 6 | loss: 0.1591495
	speed: 0.0067s/iter; left time: 105.4982s
	iters: 300, epoch: 6 | loss: 0.1501155
	speed: 0.0065s/iter; left time: 101.7087s
	iters: 400, epoch: 6 | loss: 0.2051492
	speed: 0.0067s/iter; left time: 104.1937s
	iters: 500, epoch: 6 | loss: 0.5038186
	speed: 0.0067s/iter; left time: 104.2530s
	iters: 600, epoch: 6 | loss: 0.6677993
	speed: 0.0061s/iter; left time: 94.2546s
	iters: 700, epoch: 6 | loss: 0.3927053
	speed: 0.0058s/iter; left time: 87.9695s
	iters: 800, epoch: 6 | loss: 0.2398276
	speed: 0.0067s/iter; left time: 101.3687s
	iters: 900, epoch: 6 | loss: 0.3246099
	speed: 0.0066s/iter; left time: 99.0583s
	iters: 1000, epoch: 6 | loss: 0.2100309
	speed: 0.0066s/iter; left time: 98.2039s
Epoch: 6 cost time: 6.865765810012817
Epoch: 6, Steps: 1063 | Train Loss: 0.2856400 Vali Loss: 0.1986949 Test Loss: 0.3449831
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.2996591
	speed: 0.0273s/iter; left time: 404.1584s
	iters: 200, epoch: 7 | loss: 0.2711511
	speed: 0.0067s/iter; left time: 98.1221s
	iters: 300, epoch: 7 | loss: 0.5780540
	speed: 0.0059s/iter; left time: 86.1948s
	iters: 400, epoch: 7 | loss: 0.1503544
	speed: 0.0051s/iter; left time: 73.3322s
	iters: 500, epoch: 7 | loss: 0.2563282
	speed: 0.0052s/iter; left time: 74.6267s
	iters: 600, epoch: 7 | loss: 0.3873149
	speed: 0.0055s/iter; left time: 77.9227s
	iters: 700, epoch: 7 | loss: 0.2474435
	speed: 0.0051s/iter; left time: 72.5162s
	iters: 800, epoch: 7 | loss: 0.2431169
	speed: 0.0046s/iter; left time: 65.2822s
	iters: 900, epoch: 7 | loss: 0.1136031
	speed: 0.0066s/iter; left time: 91.8975s
	iters: 1000, epoch: 7 | loss: 0.1943628
	speed: 0.0054s/iter; left time: 75.5282s
Epoch: 7 cost time: 5.909169435501099
Epoch: 7, Steps: 1063 | Train Loss: 0.2808711 Vali Loss: 0.1940904 Test Loss: 0.3321786
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.1839701
	speed: 0.0251s/iter; left time: 344.3444s
	iters: 200, epoch: 8 | loss: 0.2853184
	speed: 0.0047s/iter; left time: 64.4293s
	iters: 300, epoch: 8 | loss: 0.3578991
	speed: 0.0054s/iter; left time: 72.3602s
	iters: 400, epoch: 8 | loss: 0.1612456
	speed: 0.0047s/iter; left time: 63.3425s
	iters: 500, epoch: 8 | loss: 0.3119594
	speed: 0.0066s/iter; left time: 87.6514s
	iters: 600, epoch: 8 | loss: 0.2378549
	speed: 0.0055s/iter; left time: 73.3710s
	iters: 700, epoch: 8 | loss: 0.2474144
	speed: 0.0057s/iter; left time: 75.0904s
	iters: 800, epoch: 8 | loss: 0.2109186
	speed: 0.0058s/iter; left time: 75.5429s
	iters: 900, epoch: 8 | loss: 0.2715351
	speed: 0.0052s/iter; left time: 67.0620s
	iters: 1000, epoch: 8 | loss: 0.2162534
	speed: 0.0057s/iter; left time: 73.1021s
Epoch: 8 cost time: 5.9043309688568115
Epoch: 8, Steps: 1063 | Train Loss: 0.2774335 Vali Loss: 0.1872705 Test Loss: 0.3153251
EarlyStopping counter: 3 out of 5
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.3111618
	speed: 0.0238s/iter; left time: 301.2811s
	iters: 200, epoch: 9 | loss: 0.1912808
	speed: 0.0063s/iter; left time: 78.4997s
	iters: 300, epoch: 9 | loss: 0.2283543
	speed: 0.0059s/iter; left time: 74.0006s
	iters: 400, epoch: 9 | loss: 0.3064491
	speed: 0.0064s/iter; left time: 78.5078s
	iters: 500, epoch: 9 | loss: 0.2301280
	speed: 0.0064s/iter; left time: 78.1108s
	iters: 600, epoch: 9 | loss: 0.2200635
	speed: 0.0062s/iter; left time: 75.8596s
	iters: 700, epoch: 9 | loss: 0.4318348
	speed: 0.0059s/iter; left time: 71.5228s
	iters: 800, epoch: 9 | loss: 0.2088696
	speed: 0.0055s/iter; left time: 65.9989s
	iters: 900, epoch: 9 | loss: 0.3633907
	speed: 0.0053s/iter; left time: 62.9854s
	iters: 1000, epoch: 9 | loss: 0.1642850
	speed: 0.0053s/iter; left time: 61.9654s
Epoch: 9 cost time: 6.226822137832642
Epoch: 9, Steps: 1063 | Train Loss: 0.2758911 Vali Loss: 0.1960040 Test Loss: 0.3385663
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.2637147
	speed: 0.0233s/iter; left time: 270.5870s
	iters: 200, epoch: 10 | loss: 0.3053171
	speed: 0.0063s/iter; left time: 72.8527s
	iters: 300, epoch: 10 | loss: 0.1269834
	speed: 0.0061s/iter; left time: 69.0000s
	iters: 400, epoch: 10 | loss: 0.2174674
	speed: 0.0058s/iter; left time: 65.0601s
	iters: 500, epoch: 10 | loss: 0.2137281
	speed: 0.0063s/iter; left time: 70.2114s
	iters: 600, epoch: 10 | loss: 0.2538709
	speed: 0.0059s/iter; left time: 65.4820s
	iters: 700, epoch: 10 | loss: 0.2709675
	speed: 0.0064s/iter; left time: 69.9219s
	iters: 800, epoch: 10 | loss: 0.4691373
	speed: 0.0060s/iter; left time: 65.1791s
	iters: 900, epoch: 10 | loss: 0.4843496
	speed: 0.0060s/iter; left time: 65.0081s
	iters: 1000, epoch: 10 | loss: 0.3001319
	speed: 0.0051s/iter; left time: 54.9670s
Epoch: 10 cost time: 6.204530954360962
Epoch: 10, Steps: 1063 | Train Loss: 0.2750940 Vali Loss: 0.1977414 Test Loss: 0.3449774
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTm2_336_192_Linear_ETTm2_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15726<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
mse:0.3035629689693451, mae:0.3620891273021698
