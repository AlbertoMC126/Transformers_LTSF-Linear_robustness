Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTh2', data_path='ETTh2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.05, loss='mse', lradj='type1', model='Linear', model_id='ETTh2_336_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=32598, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTh2_336_96_Linear_ETTh2_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed32598>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 2.9847739
	speed: 0.0034s/iter; left time: 34.2427s
	iters: 200, epoch: 1 | loss: 3.8700643
	speed: 0.0034s/iter; left time: 34.1067s
	iters: 300, epoch: 1 | loss: 8.8550215
	speed: 0.0031s/iter; left time: 31.0090s
	iters: 400, epoch: 1 | loss: 8.0448809
	speed: 0.0033s/iter; left time: 32.8422s
	iters: 500, epoch: 1 | loss: 28.0883617
	speed: 0.0029s/iter; left time: 28.2092s
Epoch: 1 cost time: 1.6533539295196533
Epoch: 1, Steps: 513 | Train Loss: 8.4809983 Vali Loss: 7.5124373 Test Loss: 13.2940655
Validation loss decreased (inf --> 7.512437).  Saving model ...
Updating learning rate to 0.05
	iters: 100, epoch: 2 | loss: 6.8143716
	speed: 0.0068s/iter; left time: 65.2450s
	iters: 200, epoch: 2 | loss: 6.4538598
	speed: 0.0029s/iter; left time: 28.0709s
	iters: 300, epoch: 2 | loss: 3.9884996
	speed: 0.0031s/iter; left time: 29.3224s
	iters: 400, epoch: 2 | loss: 3.1401589
	speed: 0.0033s/iter; left time: 30.6614s
	iters: 500, epoch: 2 | loss: 6.7848444
	speed: 0.0031s/iter; left time: 28.7613s
Epoch: 2 cost time: 1.5753538608551025
Epoch: 2, Steps: 513 | Train Loss: 8.4849470 Vali Loss: 14.5235977 Test Loss: 33.4237785
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.025
	iters: 100, epoch: 3 | loss: 1.3704504
	speed: 0.0064s/iter; left time: 58.4821s
	iters: 200, epoch: 3 | loss: 0.5291764
	speed: 0.0031s/iter; left time: 28.4600s
	iters: 300, epoch: 3 | loss: 1.2694136
	speed: 0.0031s/iter; left time: 27.8099s
	iters: 400, epoch: 3 | loss: 1.0430442
	speed: 0.0039s/iter; left time: 34.0148s
	iters: 500, epoch: 3 | loss: 0.8358161
	speed: 0.0035s/iter; left time: 30.4967s
Epoch: 3 cost time: 1.7244372367858887
Epoch: 3, Steps: 513 | Train Loss: 0.9673668 Vali Loss: 1.1129013 Test Loss: 2.2518823
Validation loss decreased (7.512437 --> 1.112901).  Saving model ...
Updating learning rate to 0.0125
	iters: 100, epoch: 4 | loss: 0.4066099
	speed: 0.0060s/iter; left time: 52.0997s
	iters: 200, epoch: 4 | loss: 0.5478027
	speed: 0.0029s/iter; left time: 25.0547s
	iters: 300, epoch: 4 | loss: 0.4143082
	speed: 0.0031s/iter; left time: 25.9642s
	iters: 400, epoch: 4 | loss: 1.4436126
	speed: 0.0026s/iter; left time: 21.8871s
	iters: 500, epoch: 4 | loss: 0.3497909
	speed: 0.0029s/iter; left time: 24.0906s
Epoch: 4 cost time: 1.4902939796447754
Epoch: 4, Steps: 513 | Train Loss: 0.5101833 Vali Loss: 0.3868293 Test Loss: 0.7414765
Validation loss decreased (1.112901 --> 0.386829).  Saving model ...
Updating learning rate to 0.00625
	iters: 100, epoch: 5 | loss: 0.2791455
	speed: 0.0060s/iter; left time: 48.9922s
	iters: 200, epoch: 5 | loss: 0.4834173
	speed: 0.0033s/iter; left time: 26.6698s
	iters: 300, epoch: 5 | loss: 0.3108550
	speed: 0.0033s/iter; left time: 26.0999s
	iters: 400, epoch: 5 | loss: 0.2517007
	speed: 0.0031s/iter; left time: 24.3784s
	iters: 500, epoch: 5 | loss: 0.6325275
	speed: 0.0029s/iter; left time: 22.2790s
Epoch: 5 cost time: 1.5923550128936768
Epoch: 5, Steps: 513 | Train Loss: 0.4346077 Vali Loss: 0.3175044 Test Loss: 0.4789416
Validation loss decreased (0.386829 --> 0.317504).  Saving model ...
Updating learning rate to 0.003125
	iters: 100, epoch: 6 | loss: 0.2065024
	speed: 0.0069s/iter; left time: 52.0528s
	iters: 200, epoch: 6 | loss: 0.3961336
	speed: 0.0032s/iter; left time: 24.0621s
	iters: 300, epoch: 6 | loss: 0.3989447
	speed: 0.0029s/iter; left time: 21.6625s
	iters: 400, epoch: 6 | loss: 0.2158728
	speed: 0.0032s/iter; left time: 23.2140s
	iters: 500, epoch: 6 | loss: 0.3724841
	speed: 0.0029s/iter; left time: 20.7271s
Epoch: 6 cost time: 1.6033449172973633
Epoch: 6, Steps: 513 | Train Loss: 0.3992847 Vali Loss: 0.2801420 Test Loss: 0.4364749
Validation loss decreased (0.317504 --> 0.280142).  Saving model ...
Updating learning rate to 0.0015625
	iters: 100, epoch: 7 | loss: 0.3582458
	speed: 0.0055s/iter; left time: 38.6024s
	iters: 200, epoch: 7 | loss: 0.2930890
	speed: 0.0029s/iter; left time: 20.0556s
	iters: 300, epoch: 7 | loss: 0.3315901
	speed: 0.0035s/iter; left time: 23.8877s
	iters: 400, epoch: 7 | loss: 0.2598647
	speed: 0.0036s/iter; left time: 24.6899s
	iters: 500, epoch: 7 | loss: 0.1855198
	speed: 0.0032s/iter; left time: 21.2638s
Epoch: 7 cost time: 1.6284337043762207
Epoch: 7, Steps: 513 | Train Loss: 0.3810140 Vali Loss: 0.3650253 Test Loss: 0.6258235
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00078125
	iters: 100, epoch: 8 | loss: 0.2827888
	speed: 0.0069s/iter; left time: 45.2046s
	iters: 200, epoch: 8 | loss: 0.3184063
	speed: 0.0027s/iter; left time: 17.4860s
	iters: 300, epoch: 8 | loss: 0.1749389
	speed: 0.0025s/iter; left time: 15.9250s
	iters: 400, epoch: 8 | loss: 0.2198889
	speed: 0.0033s/iter; left time: 20.7536s
	iters: 500, epoch: 8 | loss: 0.1972207
	speed: 0.0030s/iter; left time: 18.4634s
Epoch: 8 cost time: 1.4845514297485352
Epoch: 8, Steps: 513 | Train Loss: 0.3704521 Vali Loss: 0.2700412 Test Loss: 0.3702402
Validation loss decreased (0.280142 --> 0.270041).  Saving model ...
Updating learning rate to 0.000390625
	iters: 100, epoch: 9 | loss: 0.6013856
	speed: 0.0063s/iter; left time: 38.2226s
	iters: 200, epoch: 9 | loss: 0.2424868
	speed: 0.0033s/iter; left time: 19.4352s
	iters: 300, epoch: 9 | loss: 0.2498874
	speed: 0.0033s/iter; left time: 19.1337s
	iters: 400, epoch: 9 | loss: 0.1413494
	speed: 0.0029s/iter; left time: 16.5536s
	iters: 500, epoch: 9 | loss: 0.3145322
	speed: 0.0029s/iter; left time: 16.2922s
Epoch: 9 cost time: 1.5754766464233398
Epoch: 9, Steps: 513 | Train Loss: 0.3638813 Vali Loss: 0.3148849 Test Loss: 0.5019671
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0001953125
	iters: 100, epoch: 10 | loss: 0.2491870
	speed: 0.0060s/iter; left time: 33.0320s
	iters: 200, epoch: 10 | loss: 0.4075713
	speed: 0.0030s/iter; left time: 16.1686s
	iters: 300, epoch: 10 | loss: 0.3750500
	speed: 0.0029s/iter; left time: 15.4018s
	iters: 400, epoch: 10 | loss: 0.1700361
	speed: 0.0033s/iter; left time: 17.3053s
	iters: 500, epoch: 10 | loss: 0.4625016
	speed: 0.0034s/iter; left time: 17.2838s
Epoch: 10 cost time: 1.5892069339752197
Epoch: 10, Steps: 513 | Train Loss: 0.3597583 Vali Loss: 0.2719708 Test Loss: 0.4056068
EarlyStopping counter: 2 out of 5
Updating learning rate to 9.765625e-05
	iters: 100, epoch: 11 | loss: 0.2641392
	speed: 0.0068s/iter; left time: 34.2764s
	iters: 200, epoch: 11 | loss: 0.5779246
	speed: 0.0036s/iter; left time: 17.6528s
	iters: 300, epoch: 11 | loss: 0.1837946
	speed: 0.0034s/iter; left time: 16.3920s
	iters: 400, epoch: 11 | loss: 0.4493978
	speed: 0.0029s/iter; left time: 13.9163s
	iters: 500, epoch: 11 | loss: 0.4432046
	speed: 0.0030s/iter; left time: 13.7090s
Epoch: 11 cost time: 1.653571605682373
Epoch: 11, Steps: 513 | Train Loss: 0.3577459 Vali Loss: 0.3059160 Test Loss: 0.5030124
EarlyStopping counter: 3 out of 5
Updating learning rate to 4.8828125e-05
	iters: 100, epoch: 12 | loss: 0.1527757
	speed: 0.0061s/iter; left time: 27.4774s
	iters: 200, epoch: 12 | loss: 0.4031422
	speed: 0.0028s/iter; left time: 12.4588s
	iters: 300, epoch: 12 | loss: 0.3291930
	speed: 0.0033s/iter; left time: 14.4221s
	iters: 400, epoch: 12 | loss: 0.1993626
	speed: 0.0035s/iter; left time: 14.6072s
	iters: 500, epoch: 12 | loss: 0.3486677
	speed: 0.0036s/iter; left time: 15.0307s
Epoch: 12 cost time: 1.6753079891204834
Epoch: 12, Steps: 513 | Train Loss: 0.3563327 Vali Loss: 0.2694182 Test Loss: 0.3856618
Validation loss decreased (0.270041 --> 0.269418).  Saving model ...
Updating learning rate to 2.44140625e-05
	iters: 100, epoch: 13 | loss: 0.1975223
	speed: 0.0081s/iter; left time: 32.3632s
	iters: 200, epoch: 13 | loss: 0.3524019
	speed: 0.0035s/iter; left time: 13.8627s
	iters: 300, epoch: 13 | loss: 0.2691015
	speed: 0.0033s/iter; left time: 12.4868s
	iters: 400, epoch: 13 | loss: 0.3153215
	speed: 0.0029s/iter; left time: 10.8927s
	iters: 500, epoch: 13 | loss: 0.5276989
	speed: 0.0030s/iter; left time: 10.9246s
Epoch: 13 cost time: 1.7012081146240234
Epoch: 13, Steps: 513 | Train Loss: 0.3556647 Vali Loss: 0.2860720 Test Loss: 0.4414645
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.220703125e-05
	iters: 100, epoch: 14 | loss: 0.2206927
	speed: 0.0065s/iter; left time: 22.7444s
	iters: 200, epoch: 14 | loss: 0.3613472
	speed: 0.0037s/iter; left time: 12.5843s
	iters: 300, epoch: 14 | loss: 0.2340649
	speed: 0.0035s/iter; left time: 11.4305s
	iters: 400, epoch: 14 | loss: 0.1897629
	speed: 0.0037s/iter; left time: 11.6827s
	iters: 500, epoch: 14 | loss: 0.3538564
	speed: 0.0030s/iter; left time: 9.3688s
Epoch: 14 cost time: 1.724219560623169
Epoch: 14, Steps: 513 | Train Loss: 0.3551312 Vali Loss: 0.2797524 Test Loss: 0.4188610
EarlyStopping counter: 2 out of 5
Updating learning rate to 6.103515625e-06
	iters: 100, epoch: 15 | loss: 0.5349736
	speed: 0.0061s/iter; left time: 18.0698s
	iters: 200, epoch: 15 | loss: 0.6304383
	speed: 0.0032s/iter; left time: 9.2416s
	iters: 300, epoch: 15 | loss: 0.7113144
	speed: 0.0029s/iter; left time: 7.9535s
	iters: 400, epoch: 15 | loss: 0.3218894
	speed: 0.0029s/iter; left time: 7.6369s
	iters: 500, epoch: 15 | loss: 0.2853958
	speed: 0.0032s/iter; left time: 8.3044s
Epoch: 15 cost time: 1.550658941268921
Epoch: 15, Steps: 513 | Train Loss: 0.3548997 Vali Loss: 0.2813121 Test Loss: 0.4230634
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.0517578125e-06
	iters: 100, epoch: 16 | loss: 0.1010143
	speed: 0.0067s/iter; left time: 16.4785s
	iters: 200, epoch: 16 | loss: 0.2475729
	speed: 0.0027s/iter; left time: 6.4828s
	iters: 300, epoch: 16 | loss: 0.3704269
	speed: 0.0027s/iter; left time: 6.2088s
	iters: 400, epoch: 16 | loss: 0.4994191
	speed: 0.0030s/iter; left time: 6.5073s
	iters: 500, epoch: 16 | loss: 0.2781117
	speed: 0.0033s/iter; left time: 6.9187s
Epoch: 16 cost time: 1.5194926261901855
Epoch: 16, Steps: 513 | Train Loss: 0.3547930 Vali Loss: 0.2815664 Test Loss: 0.4243595
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.52587890625e-06
	iters: 100, epoch: 17 | loss: 0.1854715
	speed: 0.0055s/iter; left time: 10.7667s
	iters: 200, epoch: 17 | loss: 0.5734104
	speed: 0.0026s/iter; left time: 4.7807s
	iters: 300, epoch: 17 | loss: 0.3294787
	speed: 0.0025s/iter; left time: 4.4351s
	iters: 400, epoch: 17 | loss: 0.2675517
	speed: 0.0025s/iter; left time: 4.1990s
	iters: 500, epoch: 17 | loss: 0.2297305
	speed: 0.0026s/iter; left time: 3.9940s
Epoch: 17 cost time: 1.3074951171875
Epoch: 17, Steps: 513 | Train Loss: 0.3546761 Vali Loss: 0.2815965 Test Loss: 0.4245492
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTh2_336_96_Linear_ETTh2_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed32598<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.38723617792129517, mae:0.410787433385849
