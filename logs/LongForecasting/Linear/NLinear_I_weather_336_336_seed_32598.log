Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='NLinear', model_id='weather_336_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=336, root_path='./dataset/', save_pred_values=False, seed=32598, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : weather_336_336_NLinear_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed32598>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36216
val 4935
test 10204
	iters: 100, epoch: 1 | loss: 0.4911475
	speed: 0.0238s/iter; left time: 1073.4101s
	iters: 200, epoch: 1 | loss: 0.4352616
	speed: 0.0226s/iter; left time: 1019.1073s
	iters: 300, epoch: 1 | loss: 0.5394726
	speed: 0.0220s/iter; left time: 988.5720s
	iters: 400, epoch: 1 | loss: 1.8176934
	speed: 0.0251s/iter; left time: 1127.6476s
	iters: 500, epoch: 1 | loss: 0.5309954
	speed: 0.0246s/iter; left time: 1100.4392s
	iters: 600, epoch: 1 | loss: 0.6437789
	speed: 0.0253s/iter; left time: 1130.3479s
	iters: 700, epoch: 1 | loss: 0.5445988
	speed: 0.0246s/iter; left time: 1096.5108s
	iters: 800, epoch: 1 | loss: 0.6320028
	speed: 0.0241s/iter; left time: 1072.3264s
	iters: 900, epoch: 1 | loss: 0.8056862
	speed: 0.0230s/iter; left time: 1020.0518s
	iters: 1000, epoch: 1 | loss: 3.8754308
	speed: 0.0236s/iter; left time: 1045.8260s
	iters: 1100, epoch: 1 | loss: 1.7361177
	speed: 0.0246s/iter; left time: 1086.8237s
	iters: 1200, epoch: 1 | loss: 1.1352321
	speed: 0.0241s/iter; left time: 1060.7201s
	iters: 1300, epoch: 1 | loss: 0.6071730
	speed: 0.0230s/iter; left time: 1010.1237s
	iters: 1400, epoch: 1 | loss: 3.2798121
	speed: 0.0231s/iter; left time: 1012.6340s
	iters: 1500, epoch: 1 | loss: 2.9151783
	speed: 0.0235s/iter; left time: 1026.2741s
	iters: 1600, epoch: 1 | loss: 0.5485764
	speed: 0.0226s/iter; left time: 987.5753s
	iters: 1700, epoch: 1 | loss: 0.5626792
	speed: 0.0237s/iter; left time: 1032.2456s
	iters: 1800, epoch: 1 | loss: 0.7294639
	speed: 0.0218s/iter; left time: 947.6778s
	iters: 1900, epoch: 1 | loss: 1.5775841
	speed: 0.0246s/iter; left time: 1066.5886s
	iters: 2000, epoch: 1 | loss: 0.6105040
	speed: 0.0211s/iter; left time: 910.7214s
	iters: 2100, epoch: 1 | loss: 1.0368330
	speed: 0.0211s/iter; left time: 909.3258s
	iters: 2200, epoch: 1 | loss: 0.7687389
	speed: 0.0233s/iter; left time: 1005.1379s
Epoch: 1 cost time: 52.79442834854126
Epoch: 1, Steps: 2263 | Train Loss: 4.1744910 Vali Loss: 26.2639408 Test Loss: 0.7640484
Validation loss decreased (inf --> 26.263941).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.8005231
	speed: 0.0827s/iter; left time: 3546.6349s
	iters: 200, epoch: 2 | loss: 0.5736547
	speed: 0.0240s/iter; left time: 1025.7533s
	iters: 300, epoch: 2 | loss: 1.2128646
	speed: 0.0234s/iter; left time: 998.4187s
	iters: 400, epoch: 2 | loss: 0.6069973
	speed: 0.0204s/iter; left time: 870.0042s
	iters: 500, epoch: 2 | loss: 2.6962647
	speed: 0.0230s/iter; left time: 976.1260s
	iters: 600, epoch: 2 | loss: 0.5236682
	speed: 0.0229s/iter; left time: 971.7021s
	iters: 700, epoch: 2 | loss: 5.7047586
	speed: 0.0234s/iter; left time: 988.0763s
	iters: 800, epoch: 2 | loss: 0.4786066
	speed: 0.0232s/iter; left time: 980.5901s
	iters: 900, epoch: 2 | loss: 0.7244072
	speed: 0.0216s/iter; left time: 907.2896s
	iters: 1000, epoch: 2 | loss: 0.6371669
	speed: 0.0220s/iter; left time: 922.4521s
	iters: 1100, epoch: 2 | loss: 1.2753371
	speed: 0.0232s/iter; left time: 970.0142s
	iters: 1200, epoch: 2 | loss: 1.0788759
	speed: 0.0200s/iter; left time: 834.2231s
	iters: 1300, epoch: 2 | loss: 13.9375944
	speed: 0.0218s/iter; left time: 910.3591s
	iters: 1400, epoch: 2 | loss: 0.5827031
	speed: 0.0254s/iter; left time: 1054.7247s
	iters: 1500, epoch: 2 | loss: 0.4661801
	speed: 0.0239s/iter; left time: 990.8230s
	iters: 1600, epoch: 2 | loss: 1.1896411
	speed: 0.0218s/iter; left time: 904.3677s
	iters: 1700, epoch: 2 | loss: 0.8273166
	speed: 0.0200s/iter; left time: 825.0718s
	iters: 1800, epoch: 2 | loss: 4.6607285
	speed: 0.0237s/iter; left time: 976.9238s
	iters: 1900, epoch: 2 | loss: 1.2247126
	speed: 0.0237s/iter; left time: 972.3464s
	iters: 2000, epoch: 2 | loss: 0.7168482
	speed: 0.0260s/iter; left time: 1066.9404s
	iters: 2100, epoch: 2 | loss: 1.1068909
	speed: 0.0250s/iter; left time: 1024.2138s
	iters: 2200, epoch: 2 | loss: 0.5713189
	speed: 0.0216s/iter; left time: 879.8500s
Epoch: 2 cost time: 51.55255675315857
Epoch: 2, Steps: 2263 | Train Loss: 41.7264329 Vali Loss: 0.8193773 Test Loss: 0.3240327
Validation loss decreased (26.263941 --> 0.819377).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.8787822
	speed: 0.0810s/iter; left time: 3292.3492s
	iters: 200, epoch: 3 | loss: 1.3377410
	speed: 0.0237s/iter; left time: 959.6232s
	iters: 300, epoch: 3 | loss: 0.5341826
	speed: 0.0234s/iter; left time: 944.2933s
	iters: 400, epoch: 3 | loss: 1.9865395
	speed: 0.0221s/iter; left time: 890.2344s
	iters: 500, epoch: 3 | loss: 3.0688975
	speed: 0.0231s/iter; left time: 927.6420s
	iters: 600, epoch: 3 | loss: 2.9346972
	speed: 0.0240s/iter; left time: 963.8807s
	iters: 700, epoch: 3 | loss: 1.0319293
	speed: 0.0227s/iter; left time: 909.3760s
	iters: 800, epoch: 3 | loss: 0.5408024
	speed: 0.0249s/iter; left time: 992.6453s
	iters: 900, epoch: 3 | loss: 0.5201611
	speed: 0.0209s/iter; left time: 831.3839s
	iters: 1000, epoch: 3 | loss: 0.4371060
	speed: 0.0233s/iter; left time: 925.8649s
	iters: 1100, epoch: 3 | loss: 0.5477651
	speed: 0.0211s/iter; left time: 838.2133s
	iters: 1200, epoch: 3 | loss: 0.5522699
	speed: 0.0236s/iter; left time: 933.0228s
	iters: 1300, epoch: 3 | loss: 0.4233277
	speed: 0.0245s/iter; left time: 967.4352s
	iters: 1400, epoch: 3 | loss: 0.5224046
	speed: 0.0235s/iter; left time: 924.1792s
	iters: 1500, epoch: 3 | loss: 1.6781787
	speed: 0.0240s/iter; left time: 941.4056s
	iters: 1600, epoch: 3 | loss: 2.6652598
	speed: 0.0227s/iter; left time: 889.6638s
	iters: 1700, epoch: 3 | loss: 0.5184199
	speed: 0.0239s/iter; left time: 932.1518s
	iters: 1800, epoch: 3 | loss: 0.6785125
	speed: 0.0205s/iter; left time: 796.6039s
	iters: 1900, epoch: 3 | loss: 0.5242140
	speed: 0.0189s/iter; left time: 735.3706s
	iters: 2000, epoch: 3 | loss: 0.4797451
	speed: 0.0224s/iter; left time: 867.6615s
	iters: 2100, epoch: 3 | loss: 1.0777643
	speed: 0.0231s/iter; left time: 892.6478s
	iters: 2200, epoch: 3 | loss: 1.2744524
	speed: 0.0221s/iter; left time: 850.6862s
Epoch: 3 cost time: 51.186822175979614
Epoch: 3, Steps: 2263 | Train Loss: 32.3487796 Vali Loss: 0.6096519 Test Loss: 0.2744284
Validation loss decreased (0.819377 --> 0.609652).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.5358952
	speed: 0.0788s/iter; left time: 3025.4625s
	iters: 200, epoch: 4 | loss: 0.4619940
	speed: 0.0196s/iter; left time: 749.6658s
	iters: 300, epoch: 4 | loss: 0.3803230
	speed: 0.0238s/iter; left time: 907.3305s
	iters: 400, epoch: 4 | loss: 1.4801983
	speed: 0.0233s/iter; left time: 888.2944s
	iters: 500, epoch: 4 | loss: 0.5222017
	speed: 0.0252s/iter; left time: 958.2236s
	iters: 600, epoch: 4 | loss: 0.4947780
	speed: 0.0228s/iter; left time: 863.4758s
	iters: 700, epoch: 4 | loss: 1.2479775
	speed: 0.0243s/iter; left time: 916.6985s
	iters: 800, epoch: 4 | loss: 0.7018443
	speed: 0.0229s/iter; left time: 863.3569s
	iters: 900, epoch: 4 | loss: 2.2097530
	speed: 0.0232s/iter; left time: 871.6085s
	iters: 1000, epoch: 4 | loss: 0.6033724
	speed: 0.0233s/iter; left time: 874.7500s
	iters: 1100, epoch: 4 | loss: 0.5590850
	speed: 0.0245s/iter; left time: 914.0787s
	iters: 1200, epoch: 4 | loss: 0.6729453
	speed: 0.0247s/iter; left time: 918.7939s
	iters: 1300, epoch: 4 | loss: 0.5811754
	speed: 0.0238s/iter; left time: 884.0313s
	iters: 1400, epoch: 4 | loss: 0.9334003
	speed: 0.0228s/iter; left time: 846.2649s
	iters: 1500, epoch: 4 | loss: 0.5594550
	speed: 0.0211s/iter; left time: 780.4151s
	iters: 1600, epoch: 4 | loss: 2.3952210
	speed: 0.0249s/iter; left time: 919.5902s
	iters: 1700, epoch: 4 | loss: 0.4112542
	speed: 0.0245s/iter; left time: 901.3534s
	iters: 1800, epoch: 4 | loss: 0.3857153
	speed: 0.0246s/iter; left time: 903.3638s
	iters: 1900, epoch: 4 | loss: 0.3590647
	speed: 0.0229s/iter; left time: 837.4588s
	iters: 2000, epoch: 4 | loss: 1.5236119
	speed: 0.0228s/iter; left time: 833.2177s
	iters: 2100, epoch: 4 | loss: 0.4680573
	speed: 0.0222s/iter; left time: 808.3497s
	iters: 2200, epoch: 4 | loss: 0.4768222
	speed: 0.0199s/iter; left time: 723.5458s
Epoch: 4 cost time: 52.211575984954834
Epoch: 4, Steps: 2263 | Train Loss: 1.7471155 Vali Loss: 0.5649882 Test Loss: 0.2493118
Validation loss decreased (0.609652 --> 0.564988).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.5943266
	speed: 0.0882s/iter; left time: 3184.9236s
	iters: 200, epoch: 5 | loss: 0.9788131
	speed: 0.0232s/iter; left time: 835.0355s
	iters: 300, epoch: 5 | loss: 0.3621401
	speed: 0.0243s/iter; left time: 872.4841s
	iters: 400, epoch: 5 | loss: 0.4595332
	speed: 0.0239s/iter; left time: 857.0462s
	iters: 500, epoch: 5 | loss: 0.4749104
	speed: 0.0211s/iter; left time: 754.0344s
	iters: 600, epoch: 5 | loss: 0.5330440
	speed: 0.0216s/iter; left time: 768.2661s
	iters: 700, epoch: 5 | loss: 0.3691162
	speed: 0.0224s/iter; left time: 794.7097s
	iters: 800, epoch: 5 | loss: 0.4187633
	speed: 0.0244s/iter; left time: 864.8914s
	iters: 900, epoch: 5 | loss: 0.3417816
	speed: 0.0246s/iter; left time: 868.3297s
	iters: 1000, epoch: 5 | loss: 0.5272787
	speed: 0.0229s/iter; left time: 808.0322s
	iters: 1100, epoch: 5 | loss: 0.4005796
	speed: 0.0222s/iter; left time: 780.6640s
	iters: 1200, epoch: 5 | loss: 0.4557540
	speed: 0.0205s/iter; left time: 717.5762s
	iters: 1300, epoch: 5 | loss: 0.4250772
	speed: 0.0247s/iter; left time: 862.3553s
	iters: 1400, epoch: 5 | loss: 0.4018297
	speed: 0.0232s/iter; left time: 808.8892s
	iters: 1500, epoch: 5 | loss: 0.3595402
	speed: 0.0232s/iter; left time: 805.2448s
	iters: 1600, epoch: 5 | loss: 0.7955999
	speed: 0.0263s/iter; left time: 909.6407s
	iters: 1700, epoch: 5 | loss: 0.4200420
	speed: 0.0251s/iter; left time: 865.5502s
	iters: 1800, epoch: 5 | loss: 0.3787067
	speed: 0.0236s/iter; left time: 810.6202s
	iters: 1900, epoch: 5 | loss: 0.5205821
	speed: 0.0228s/iter; left time: 783.6868s
	iters: 2000, epoch: 5 | loss: 0.5028880
	speed: 0.0234s/iter; left time: 801.5871s
	iters: 2100, epoch: 5 | loss: 0.4837238
	speed: 0.0212s/iter; left time: 723.6320s
	iters: 2200, epoch: 5 | loss: 0.5444002
	speed: 0.0191s/iter; left time: 649.3466s
Epoch: 5 cost time: 51.74090027809143
Epoch: 5, Steps: 2263 | Train Loss: 0.9011290 Vali Loss: 1.2470970 Test Loss: 0.2591829
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.4093863
	speed: 0.0787s/iter; left time: 2664.9183s
	iters: 200, epoch: 6 | loss: 0.3134364
	speed: 0.0232s/iter; left time: 782.3817s
	iters: 300, epoch: 6 | loss: 0.9131698
	speed: 0.0257s/iter; left time: 865.6568s
	iters: 400, epoch: 6 | loss: 0.5590857
	speed: 0.0241s/iter; left time: 808.0541s
	iters: 500, epoch: 6 | loss: 1.6138225
	speed: 0.0218s/iter; left time: 730.7309s
	iters: 600, epoch: 6 | loss: 0.3988460
	speed: 0.0222s/iter; left time: 741.6830s
	iters: 700, epoch: 6 | loss: 0.5230069
	speed: 0.0227s/iter; left time: 753.2749s
	iters: 800, epoch: 6 | loss: 0.6396539
	speed: 0.0234s/iter; left time: 777.1413s
	iters: 900, epoch: 6 | loss: 0.9538739
	speed: 0.0206s/iter; left time: 679.5632s
	iters: 1000, epoch: 6 | loss: 1.1563852
	speed: 0.0230s/iter; left time: 758.7349s
	iters: 1100, epoch: 6 | loss: 0.7419000
	speed: 0.0226s/iter; left time: 743.7692s
	iters: 1200, epoch: 6 | loss: 0.4432275
	speed: 0.0238s/iter; left time: 778.5184s
	iters: 1300, epoch: 6 | loss: 0.4324418
	speed: 0.0240s/iter; left time: 784.4348s
	iters: 1400, epoch: 6 | loss: 0.3885655
	speed: 0.0224s/iter; left time: 729.0131s
	iters: 1500, epoch: 6 | loss: 0.8672602
	speed: 0.0239s/iter; left time: 775.5923s
	iters: 1600, epoch: 6 | loss: 0.4850380
	speed: 0.0237s/iter; left time: 765.2086s
	iters: 1700, epoch: 6 | loss: 0.4945049
	speed: 0.0248s/iter; left time: 800.6826s
	iters: 1800, epoch: 6 | loss: 0.4082135
	speed: 0.0241s/iter; left time: 775.5854s
	iters: 1900, epoch: 6 | loss: 0.3974988
	speed: 0.0227s/iter; left time: 727.4956s
	iters: 2000, epoch: 6 | loss: 0.4193489
	speed: 0.0197s/iter; left time: 630.7851s
	iters: 2100, epoch: 6 | loss: 0.4335078
	speed: 0.0207s/iter; left time: 660.0488s
	iters: 2200, epoch: 6 | loss: 0.3589628
	speed: 0.0190s/iter; left time: 602.6731s
Epoch: 6 cost time: 51.34045124053955
Epoch: 6, Steps: 2263 | Train Loss: 0.7780052 Vali Loss: 0.5501392 Test Loss: 0.2444744
Validation loss decreased (0.564988 --> 0.550139).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.3931016
	speed: 0.0872s/iter; left time: 2755.4489s
	iters: 200, epoch: 7 | loss: 0.9668929
	speed: 0.0230s/iter; left time: 722.6421s
	iters: 300, epoch: 7 | loss: 0.9233995
	speed: 0.0232s/iter; left time: 727.1914s
	iters: 400, epoch: 7 | loss: 1.0727642
	speed: 0.0234s/iter; left time: 730.4917s
	iters: 500, epoch: 7 | loss: 0.5330147
	speed: 0.0236s/iter; left time: 735.4757s
	iters: 600, epoch: 7 | loss: 1.1528410
	speed: 0.0230s/iter; left time: 714.4155s
	iters: 700, epoch: 7 | loss: 0.5935752
	speed: 0.0229s/iter; left time: 709.8913s
	iters: 800, epoch: 7 | loss: 0.3784797
	speed: 0.0210s/iter; left time: 647.0494s
	iters: 900, epoch: 7 | loss: 0.3865695
	speed: 0.0188s/iter; left time: 577.7653s
	iters: 1000, epoch: 7 | loss: 0.4172162
	speed: 0.0216s/iter; left time: 661.7763s
	iters: 1100, epoch: 7 | loss: 1.1291808
	speed: 0.0248s/iter; left time: 757.0508s
	iters: 1200, epoch: 7 | loss: 0.3535177
	speed: 0.0216s/iter; left time: 658.6767s
	iters: 1300, epoch: 7 | loss: 0.5554503
	speed: 0.0222s/iter; left time: 674.5559s
	iters: 1400, epoch: 7 | loss: 0.3330403
	speed: 0.0219s/iter; left time: 663.4112s
	iters: 1500, epoch: 7 | loss: 0.4027386
	speed: 0.0241s/iter; left time: 727.8834s
	iters: 1600, epoch: 7 | loss: 0.4751602
	speed: 0.0246s/iter; left time: 741.2079s
	iters: 1700, epoch: 7 | loss: 0.4081369
	speed: 0.0240s/iter; left time: 720.9348s
	iters: 1800, epoch: 7 | loss: 0.3465903
	speed: 0.0245s/iter; left time: 731.8762s
	iters: 1900, epoch: 7 | loss: 0.3731024
	speed: 0.0223s/iter; left time: 663.5697s
	iters: 2000, epoch: 7 | loss: 0.5317850
	speed: 0.0236s/iter; left time: 700.7612s
	iters: 2100, epoch: 7 | loss: 0.3602065
	speed: 0.0200s/iter; left time: 592.6638s
	iters: 2200, epoch: 7 | loss: 0.4784114
	speed: 0.0179s/iter; left time: 528.1359s
Epoch: 7 cost time: 50.46021628379822
Epoch: 7, Steps: 2263 | Train Loss: 0.6166808 Vali Loss: 0.6538090 Test Loss: 0.2412313
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.4061869
	speed: 0.0887s/iter; left time: 2599.8605s
	iters: 200, epoch: 8 | loss: 0.9266724
	speed: 0.0219s/iter; left time: 640.6093s
	iters: 300, epoch: 8 | loss: 1.3795656
	speed: 0.0232s/iter; left time: 676.5169s
	iters: 400, epoch: 8 | loss: 0.4965973
	speed: 0.0242s/iter; left time: 703.0641s
	iters: 500, epoch: 8 | loss: 0.9532114
	speed: 0.0245s/iter; left time: 707.3574s
	iters: 600, epoch: 8 | loss: 1.0535982
	speed: 0.0237s/iter; left time: 683.2643s
	iters: 700, epoch: 8 | loss: 0.5723189
	speed: 0.0238s/iter; left time: 684.8632s
	iters: 800, epoch: 8 | loss: 0.6129808
	speed: 0.0210s/iter; left time: 601.0601s
	iters: 900, epoch: 8 | loss: 0.4871573
	speed: 0.0227s/iter; left time: 648.2544s
	iters: 1000, epoch: 8 | loss: 0.4333577
	speed: 0.0249s/iter; left time: 708.2352s
	iters: 1100, epoch: 8 | loss: 1.0891640
	speed: 0.0231s/iter; left time: 653.7391s
	iters: 1200, epoch: 8 | loss: 0.4462035
	speed: 0.0231s/iter; left time: 651.6828s
	iters: 1300, epoch: 8 | loss: 0.5359719
	speed: 0.0222s/iter; left time: 625.2677s
	iters: 1400, epoch: 8 | loss: 1.4409678
	speed: 0.0236s/iter; left time: 660.6520s
	iters: 1500, epoch: 8 | loss: 0.3422763
	speed: 0.0234s/iter; left time: 652.2792s
	iters: 1600, epoch: 8 | loss: 0.3577019
	speed: 0.0231s/iter; left time: 641.9556s
	iters: 1700, epoch: 8 | loss: 0.3680081
	speed: 0.0247s/iter; left time: 684.0123s
	iters: 1800, epoch: 8 | loss: 0.5133207
	speed: 0.0254s/iter; left time: 700.3328s
	iters: 1900, epoch: 8 | loss: 0.9637879
	speed: 0.0223s/iter; left time: 612.7150s
	iters: 2000, epoch: 8 | loss: 0.5661345
	speed: 0.0218s/iter; left time: 598.2875s
	iters: 2100, epoch: 8 | loss: 0.6041437
	speed: 0.0184s/iter; left time: 502.7248s
	iters: 2200, epoch: 8 | loss: 0.3799629
	speed: 0.0182s/iter; left time: 495.7899s
Epoch: 8 cost time: 51.41455936431885
Epoch: 8, Steps: 2263 | Train Loss: 0.6063540 Vali Loss: 0.5390667 Test Loss: 0.2413177
Validation loss decreased (0.550139 --> 0.539067).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.3902877
	speed: 0.0860s/iter; left time: 2326.6459s
	iters: 200, epoch: 9 | loss: 0.4944874
	speed: 0.0253s/iter; left time: 682.5597s
	iters: 300, epoch: 9 | loss: 0.4898615
	speed: 0.0228s/iter; left time: 612.7691s
	iters: 400, epoch: 9 | loss: 0.6023757
	speed: 0.0250s/iter; left time: 669.0198s
	iters: 500, epoch: 9 | loss: 0.3989871
	speed: 0.0229s/iter; left time: 610.9515s
	iters: 600, epoch: 9 | loss: 0.5747684
	speed: 0.0234s/iter; left time: 621.9396s
	iters: 700, epoch: 9 | loss: 0.4899072
	speed: 0.0233s/iter; left time: 615.3714s
	iters: 800, epoch: 9 | loss: 1.4175375
	speed: 0.0233s/iter; left time: 614.8936s
	iters: 900, epoch: 9 | loss: 0.3549120
	speed: 0.0233s/iter; left time: 612.2669s
	iters: 1000, epoch: 9 | loss: 0.5213302
	speed: 0.0242s/iter; left time: 632.4091s
	iters: 1100, epoch: 9 | loss: 0.3900230
	speed: 0.0251s/iter; left time: 654.0255s
	iters: 1200, epoch: 9 | loss: 0.4452142
	speed: 0.0221s/iter; left time: 573.2135s
	iters: 1300, epoch: 9 | loss: 0.3635382
	speed: 0.0232s/iter; left time: 600.3026s
	iters: 1400, epoch: 9 | loss: 0.3997174
	speed: 0.0207s/iter; left time: 533.9009s
	iters: 1500, epoch: 9 | loss: 0.3724866
	speed: 0.0234s/iter; left time: 600.6500s
	iters: 1600, epoch: 9 | loss: 0.9327934
	speed: 0.0229s/iter; left time: 585.4921s
	iters: 1700, epoch: 9 | loss: 0.4631561
	speed: 0.0238s/iter; left time: 604.6698s
	iters: 1800, epoch: 9 | loss: 0.5195900
	speed: 0.0233s/iter; left time: 589.5690s
	iters: 1900, epoch: 9 | loss: 0.4587260
	speed: 0.0233s/iter; left time: 587.7523s
	iters: 2000, epoch: 9 | loss: 1.0441717
	speed: 0.0204s/iter; left time: 513.8608s
	iters: 2100, epoch: 9 | loss: 0.5337537
	speed: 0.0174s/iter; left time: 436.2521s
	iters: 2200, epoch: 9 | loss: 0.4916088
	speed: 0.0188s/iter; left time: 470.2223s
Epoch: 9 cost time: 51.587841510772705
Epoch: 9, Steps: 2263 | Train Loss: 0.6049755 Vali Loss: 0.5346668 Test Loss: 0.2394042
Validation loss decreased (0.539067 --> 0.534667).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.3466007
	speed: 0.0899s/iter; left time: 2230.1792s
	iters: 200, epoch: 10 | loss: 0.4485361
	speed: 0.0229s/iter; left time: 566.5261s
	iters: 300, epoch: 10 | loss: 0.4442064
	speed: 0.0219s/iter; left time: 539.6134s
	iters: 400, epoch: 10 | loss: 0.3765724
	speed: 0.0229s/iter; left time: 561.9945s
	iters: 500, epoch: 10 | loss: 0.3165078
	speed: 0.0220s/iter; left time: 536.4255s
	iters: 600, epoch: 10 | loss: 0.3973648
	speed: 0.0205s/iter; left time: 497.4331s
	iters: 700, epoch: 10 | loss: 0.4625779
	speed: 0.0229s/iter; left time: 552.8794s
	iters: 800, epoch: 10 | loss: 0.7868065
	speed: 0.0239s/iter; left time: 575.1362s
	iters: 900, epoch: 10 | loss: 0.3933360
	speed: 0.0228s/iter; left time: 547.4794s
	iters: 1000, epoch: 10 | loss: 0.4192706
	speed: 0.0249s/iter; left time: 595.3443s
	iters: 1100, epoch: 10 | loss: 0.4656945
	speed: 0.0224s/iter; left time: 532.7642s
	iters: 1200, epoch: 10 | loss: 0.6078050
	speed: 0.0218s/iter; left time: 517.1595s
	iters: 1300, epoch: 10 | loss: 0.4352819
	speed: 0.0216s/iter; left time: 509.8293s
	iters: 1400, epoch: 10 | loss: 0.5206330
	speed: 0.0234s/iter; left time: 550.3356s
	iters: 1500, epoch: 10 | loss: 0.3515047
	speed: 0.0228s/iter; left time: 533.8841s
	iters: 1600, epoch: 10 | loss: 1.5338198
	speed: 0.0217s/iter; left time: 504.4859s
	iters: 1700, epoch: 10 | loss: 0.3006420
	speed: 0.0214s/iter; left time: 495.9067s
	iters: 1800, epoch: 10 | loss: 0.4644730
	speed: 0.0235s/iter; left time: 542.5935s
	iters: 1900, epoch: 10 | loss: 0.4445331
	speed: 0.0232s/iter; left time: 534.5638s
	iters: 2000, epoch: 10 | loss: 1.1587294
	speed: 0.0220s/iter; left time: 502.9018s
	iters: 2100, epoch: 10 | loss: 0.4108925
	speed: 0.0183s/iter; left time: 417.0533s
	iters: 2200, epoch: 10 | loss: 0.3948307
	speed: 0.0187s/iter; left time: 423.3633s
Epoch: 10 cost time: 50.173954010009766
Epoch: 10, Steps: 2263 | Train Loss: 0.5984756 Vali Loss: 0.5376114 Test Loss: 0.2398955
EarlyStopping counter: 1 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.3570273
	speed: 0.0857s/iter; left time: 1930.7108s
	iters: 200, epoch: 11 | loss: 0.8998886
	speed: 0.0226s/iter; left time: 507.4029s
	iters: 300, epoch: 11 | loss: 0.5286952
	speed: 0.0242s/iter; left time: 541.2938s
	iters: 400, epoch: 11 | loss: 0.4172375
	speed: 0.0227s/iter; left time: 504.3035s
	iters: 500, epoch: 11 | loss: 0.5742273
	speed: 0.0216s/iter; left time: 479.0347s
	iters: 600, epoch: 11 | loss: 0.3506519
	speed: 0.0245s/iter; left time: 540.3348s
	iters: 700, epoch: 11 | loss: 0.5016177
	speed: 0.0243s/iter; left time: 532.8805s
	iters: 800, epoch: 11 | loss: 0.3375634
	speed: 0.0244s/iter; left time: 531.7108s
	iters: 900, epoch: 11 | loss: 0.5453649
	speed: 0.0236s/iter; left time: 513.6239s
	iters: 1000, epoch: 11 | loss: 0.9126710
	speed: 0.0237s/iter; left time: 513.1380s
	iters: 1100, epoch: 11 | loss: 0.3839805
	speed: 0.0238s/iter; left time: 512.0581s
	iters: 1200, epoch: 11 | loss: 0.9494773
	speed: 0.0222s/iter; left time: 476.6145s
	iters: 1300, epoch: 11 | loss: 0.4118046
	speed: 0.0233s/iter; left time: 496.2849s
	iters: 1400, epoch: 11 | loss: 0.2924958
	speed: 0.0246s/iter; left time: 521.5674s
	iters: 1500, epoch: 11 | loss: 0.4571398
	speed: 0.0221s/iter; left time: 467.2891s
	iters: 1600, epoch: 11 | loss: 0.4897814
	speed: 0.0240s/iter; left time: 505.1730s
	iters: 1700, epoch: 11 | loss: 0.5581301
	speed: 0.0211s/iter; left time: 440.8731s
	iters: 1800, epoch: 11 | loss: 0.4099357
	speed: 0.0220s/iter; left time: 457.7976s
	iters: 1900, epoch: 11 | loss: 0.4474611
	speed: 0.0220s/iter; left time: 456.2316s
	iters: 2000, epoch: 11 | loss: 0.3447620
	speed: 0.0202s/iter; left time: 417.4619s
	iters: 2100, epoch: 11 | loss: 0.3323255
	speed: 0.0185s/iter; left time: 379.5666s
	iters: 2200, epoch: 11 | loss: 0.8988694
	speed: 0.0197s/iter; left time: 402.5813s
Epoch: 11 cost time: 51.00464487075806
Epoch: 11, Steps: 2263 | Train Loss: 0.5967909 Vali Loss: 0.5377970 Test Loss: 0.2404289
EarlyStopping counter: 2 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.4066235
	speed: 0.0802s/iter; left time: 1624.9586s
	iters: 200, epoch: 12 | loss: 0.3684845
	speed: 0.0249s/iter; left time: 502.8727s
	iters: 300, epoch: 12 | loss: 1.1027396
	speed: 0.0216s/iter; left time: 434.2568s
	iters: 400, epoch: 12 | loss: 0.3782646
	speed: 0.0243s/iter; left time: 484.5875s
	iters: 500, epoch: 12 | loss: 0.4376364
	speed: 0.0256s/iter; left time: 508.5454s
	iters: 600, epoch: 12 | loss: 0.4511083
	speed: 0.0216s/iter; left time: 426.4051s
	iters: 700, epoch: 12 | loss: 0.7564326
	speed: 0.0235s/iter; left time: 462.3776s
	iters: 800, epoch: 12 | loss: 0.4058962
	speed: 0.0213s/iter; left time: 415.8670s
	iters: 900, epoch: 12 | loss: 0.3375065
	speed: 0.0239s/iter; left time: 465.9349s
	iters: 1000, epoch: 12 | loss: 0.5081717
	speed: 0.0229s/iter; left time: 444.2640s
	iters: 1100, epoch: 12 | loss: 0.3366523
	speed: 0.0244s/iter; left time: 470.1432s
	iters: 1200, epoch: 12 | loss: 0.5623609
	speed: 0.0257s/iter; left time: 492.8515s
	iters: 1300, epoch: 12 | loss: 1.1632861
	speed: 0.0231s/iter; left time: 440.5979s
	iters: 1400, epoch: 12 | loss: 0.9421042
	speed: 0.0209s/iter; left time: 396.3920s
	iters: 1500, epoch: 12 | loss: 0.4811687
	speed: 0.0245s/iter; left time: 461.5429s
	iters: 1600, epoch: 12 | loss: 0.3795367
	speed: 0.0242s/iter; left time: 455.0677s
	iters: 1700, epoch: 12 | loss: 0.4784628
	speed: 0.0219s/iter; left time: 409.4246s
	iters: 1800, epoch: 12 | loss: 0.3621385
	speed: 0.0234s/iter; left time: 434.7928s
	iters: 1900, epoch: 12 | loss: 0.7309895
	speed: 0.0210s/iter; left time: 387.9586s
	iters: 2000, epoch: 12 | loss: 0.6131805
	speed: 0.0213s/iter; left time: 391.1545s
	iters: 2100, epoch: 12 | loss: 0.4292446
	speed: 0.0176s/iter; left time: 320.8726s
	iters: 2200, epoch: 12 | loss: 0.5037880
	speed: 0.0183s/iter; left time: 333.2823s
Epoch: 12 cost time: 51.16550302505493
Epoch: 12, Steps: 2263 | Train Loss: 0.5960838 Vali Loss: 0.5355587 Test Loss: 0.2393328
EarlyStopping counter: 3 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.3492945
	speed: 0.0879s/iter; left time: 1583.2163s
	iters: 200, epoch: 13 | loss: 0.3872137
	speed: 0.0247s/iter; left time: 441.9162s
	iters: 300, epoch: 13 | loss: 0.9174210
	speed: 0.0238s/iter; left time: 423.4244s
	iters: 400, epoch: 13 | loss: 0.4177713
	speed: 0.0215s/iter; left time: 380.6974s
	iters: 500, epoch: 13 | loss: 0.3294235
	speed: 0.0245s/iter; left time: 430.8313s
	iters: 600, epoch: 13 | loss: 0.4657665
	speed: 0.0216s/iter; left time: 378.2318s
	iters: 700, epoch: 13 | loss: 0.4715287
	speed: 0.0236s/iter; left time: 411.0925s
	iters: 800, epoch: 13 | loss: 0.4994982
	speed: 0.0228s/iter; left time: 393.8260s
	iters: 900, epoch: 13 | loss: 0.4305094
	speed: 0.0244s/iter; left time: 419.7606s
	iters: 1000, epoch: 13 | loss: 0.3190526
	speed: 0.0246s/iter; left time: 421.0000s
	iters: 1100, epoch: 13 | loss: 0.4907361
	speed: 0.0239s/iter; left time: 406.7204s
	iters: 1200, epoch: 13 | loss: 0.4565385
	speed: 0.0238s/iter; left time: 402.3632s
	iters: 1300, epoch: 13 | loss: 0.5032492
	speed: 0.0215s/iter; left time: 362.0602s
	iters: 1400, epoch: 13 | loss: 0.9610674
	speed: 0.0237s/iter; left time: 395.6294s
	iters: 1500, epoch: 13 | loss: 0.3971151
	speed: 0.0228s/iter; left time: 379.2278s
	iters: 1600, epoch: 13 | loss: 0.4695286
	speed: 0.0255s/iter; left time: 420.0588s
	iters: 1700, epoch: 13 | loss: 0.5846868
	speed: 0.0241s/iter; left time: 394.8507s
	iters: 1800, epoch: 13 | loss: 0.3109457
	speed: 0.0234s/iter; left time: 382.1087s
	iters: 1900, epoch: 13 | loss: 0.3294043
	speed: 0.0222s/iter; left time: 360.1581s
	iters: 2000, epoch: 13 | loss: 0.4667646
	speed: 0.0206s/iter; left time: 332.3800s
	iters: 2100, epoch: 13 | loss: 0.8740899
	speed: 0.0198s/iter; left time: 316.1721s
	iters: 2200, epoch: 13 | loss: 1.2372221
	speed: 0.0207s/iter; left time: 329.0537s
Epoch: 13 cost time: 51.835551023483276
Epoch: 13, Steps: 2263 | Train Loss: 0.5956964 Vali Loss: 0.5365032 Test Loss: 0.2394225
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.3828117
	speed: 0.0875s/iter; left time: 1377.5632s
	iters: 200, epoch: 14 | loss: 0.3364929
	speed: 0.0236s/iter; left time: 369.8048s
	iters: 300, epoch: 14 | loss: 0.3249178
	speed: 0.0231s/iter; left time: 359.6660s
	iters: 400, epoch: 14 | loss: 0.4934768
	speed: 0.0239s/iter; left time: 369.2113s
	iters: 500, epoch: 14 | loss: 0.4423157
	speed: 0.0218s/iter; left time: 333.9215s
	iters: 600, epoch: 14 | loss: 1.4626871
	speed: 0.0212s/iter; left time: 323.8274s
	iters: 700, epoch: 14 | loss: 0.4064921
	speed: 0.0246s/iter; left time: 372.5810s
	iters: 800, epoch: 14 | loss: 0.4128579
	speed: 0.0250s/iter; left time: 376.2315s
	iters: 900, epoch: 14 | loss: 0.4703122
	speed: 0.0226s/iter; left time: 337.7693s
	iters: 1000, epoch: 14 | loss: 0.4827468
	speed: 0.0244s/iter; left time: 361.7517s
	iters: 1100, epoch: 14 | loss: 0.2990600
	speed: 0.0241s/iter; left time: 355.1315s
	iters: 1200, epoch: 14 | loss: 0.5051904
	speed: 0.0234s/iter; left time: 343.3100s
	iters: 1300, epoch: 14 | loss: 0.4097744
	speed: 0.0217s/iter; left time: 315.3438s
	iters: 1400, epoch: 14 | loss: 0.6104702
	speed: 0.0237s/iter; left time: 341.7057s
	iters: 1500, epoch: 14 | loss: 0.3902829
	speed: 0.0241s/iter; left time: 345.4410s
	iters: 1600, epoch: 14 | loss: 0.3951644
	speed: 0.0215s/iter; left time: 306.1637s
	iters: 1700, epoch: 14 | loss: 0.3923653
	speed: 0.0229s/iter; left time: 324.2877s
	iters: 1800, epoch: 14 | loss: 0.4786324
	speed: 0.0226s/iter; left time: 317.1663s
	iters: 1900, epoch: 14 | loss: 1.1134719
	speed: 0.0207s/iter; left time: 288.2189s
	iters: 2000, epoch: 14 | loss: 0.5393006
	speed: 0.0189s/iter; left time: 261.6799s
	iters: 2100, epoch: 14 | loss: 0.4470766
	speed: 0.0183s/iter; left time: 250.8073s
	iters: 2200, epoch: 14 | loss: 0.4693371
	speed: 0.0198s/iter; left time: 269.5025s
Epoch: 14 cost time: 50.5602650642395
Epoch: 14, Steps: 2263 | Train Loss: 0.5952060 Vali Loss: 0.5361307 Test Loss: 0.2395366
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : weather_336_336_NLinear_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed32598<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10204
mse:0.2394612431526184, mae:0.27818769216537476
