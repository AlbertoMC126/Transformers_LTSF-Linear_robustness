Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTh2', data_path='ETTh2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='DLinear', model_id='ETTh2_336_720', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=720, root_path='./dataset/', save_pred_values=False, seed=28649, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTh2_336_720_DLinear_ETTh2_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed28649>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7585
val 2161
test 2161
Total number of trainable parameters: 3396960
Total number of parameters: 3396960
	iters: 100, epoch: 1 | loss: 0.5016339
	speed: 0.0736s/iter; left time: 341.7232s
	iters: 200, epoch: 1 | loss: 0.4986755
	speed: 0.0738s/iter; left time: 335.1952s
Epoch: 1 cost time: 17.44687581062317
Epoch: 1, Steps: 237 | Train Loss: 0.8017566 Vali Loss: 0.8994273 Test Loss: 1.1547543
Validation loss decreased (inf --> 0.899427).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.7266356
	speed: 0.1189s/iter; left time: 523.8146s
	iters: 200, epoch: 2 | loss: 0.7384108
	speed: 0.0735s/iter; left time: 316.5164s
Epoch: 2 cost time: 17.470138549804688
Epoch: 2, Steps: 237 | Train Loss: 0.7697797 Vali Loss: 0.7989445 Test Loss: 0.9371269
Validation loss decreased (0.899427 --> 0.798945).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.4863276
	speed: 0.1187s/iter; left time: 494.7341s
	iters: 200, epoch: 3 | loss: 0.6360740
	speed: 0.0729s/iter; left time: 296.4746s
Epoch: 3 cost time: 17.02369713783264
Epoch: 3, Steps: 237 | Train Loss: 0.6959088 Vali Loss: 0.8228472 Test Loss: 1.1821781
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.3517993
	speed: 0.1103s/iter; left time: 433.3460s
	iters: 200, epoch: 4 | loss: 0.8479791
	speed: 0.0740s/iter; left time: 283.4700s
Epoch: 4 cost time: 17.046337604522705
Epoch: 4, Steps: 237 | Train Loss: 0.6569523 Vali Loss: 0.7689466 Test Loss: 0.9948694
Validation loss decreased (0.798945 --> 0.768947).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.6706743
	speed: 0.1174s/iter; left time: 433.6927s
	iters: 200, epoch: 5 | loss: 0.7590899
	speed: 0.0725s/iter; left time: 260.3669s
Epoch: 5 cost time: 16.97910165786743
Epoch: 5, Steps: 237 | Train Loss: 0.6412079 Vali Loss: 0.7643597 Test Loss: 1.1046729
Validation loss decreased (0.768947 --> 0.764360).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.6519723
	speed: 0.1181s/iter; left time: 408.2822s
	iters: 200, epoch: 6 | loss: 0.7732487
	speed: 0.0759s/iter; left time: 254.6737s
Epoch: 6 cost time: 17.040406942367554
Epoch: 6, Steps: 237 | Train Loss: 0.6339608 Vali Loss: 0.7759545 Test Loss: 0.9948695
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.7365918
	speed: 0.1105s/iter; left time: 355.8130s
	iters: 200, epoch: 7 | loss: 0.5861891
	speed: 0.0743s/iter; left time: 231.7026s
Epoch: 7 cost time: 16.746208667755127
Epoch: 7, Steps: 237 | Train Loss: 0.6290684 Vali Loss: 0.7745310 Test Loss: 1.0347466
EarlyStopping counter: 2 out of 5
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.5822137
	speed: 0.1139s/iter; left time: 339.5360s
	iters: 200, epoch: 8 | loss: 0.7082708
	speed: 0.0738s/iter; left time: 212.7778s
Epoch: 8 cost time: 17.03526544570923
Epoch: 8, Steps: 237 | Train Loss: 0.6261821 Vali Loss: 0.7687957 Test Loss: 1.0468955
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.5347685
	speed: 0.1063s/iter; left time: 291.9071s
	iters: 200, epoch: 9 | loss: 0.4764944
	speed: 0.0627s/iter; left time: 165.7525s
Epoch: 9 cost time: 14.940922021865845
Epoch: 9, Steps: 237 | Train Loss: 0.6252190 Vali Loss: 0.7701170 Test Loss: 1.0774547
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.5679411
	speed: 0.0882s/iter; left time: 221.1323s
	iters: 200, epoch: 10 | loss: 0.8381441
	speed: 0.0461s/iter; left time: 111.0560s
Epoch: 10 cost time: 11.3184335231781
Epoch: 10, Steps: 237 | Train Loss: 0.6245298 Vali Loss: 0.7592934 Test Loss: 1.0346140
Validation loss decreased (0.764360 --> 0.759293).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.7656282
	speed: 0.0683s/iter; left time: 155.0605s
	iters: 200, epoch: 11 | loss: 0.9541858
	speed: 0.0334s/iter; left time: 72.5823s
Epoch: 11 cost time: 8.192270517349243
Epoch: 11, Steps: 237 | Train Loss: 0.6241776 Vali Loss: 0.7660696 Test Loss: 1.0461878
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.6049929
	speed: 0.0454s/iter; left time: 92.3156s
	iters: 200, epoch: 12 | loss: 0.5842971
	speed: 0.0235s/iter; left time: 45.4237s
Epoch: 12 cost time: 5.835266828536987
Epoch: 12, Steps: 237 | Train Loss: 0.6239461 Vali Loss: 0.7666160 Test Loss: 1.0452912
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.7080997
	speed: 0.0341s/iter; left time: 61.2867s
	iters: 200, epoch: 13 | loss: 0.5010703
	speed: 0.0164s/iter; left time: 27.8666s
Epoch: 13 cost time: 4.128012418746948
Epoch: 13, Steps: 237 | Train Loss: 0.6238143 Vali Loss: 0.7672579 Test Loss: 1.0448122
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.5363288
	speed: 0.0264s/iter; left time: 41.1423s
	iters: 200, epoch: 14 | loss: 0.5153350
	speed: 0.0158s/iter; left time: 23.0165s
Epoch: 14 cost time: 3.7502150535583496
Epoch: 14, Steps: 237 | Train Loss: 0.6237467 Vali Loss: 0.7649869 Test Loss: 1.0441724
EarlyStopping counter: 4 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.5633047
	speed: 0.0268s/iter; left time: 35.4281s
	iters: 200, epoch: 15 | loss: 0.5281152
	speed: 0.0161s/iter; left time: 19.7240s
Epoch: 15 cost time: 3.8587961196899414
Epoch: 15, Steps: 237 | Train Loss: 0.6237174 Vali Loss: 0.7649282 Test Loss: 1.0437169
EarlyStopping counter: 5 out of 5
Early stopping
Total training time: 209.2464 seconds
>>>>>>>testing : ETTh2_336_720_DLinear_ETTh2_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed28649<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
mse:1.0340466499328613, mae:0.7086888551712036
