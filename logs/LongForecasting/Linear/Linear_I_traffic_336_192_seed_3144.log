Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='Linear', model_id='traffic_336_192', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=192, root_path='./dataset/', save_pred_values=False, seed=3144, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_336_192_Linear_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3144>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11753
val 1565
test 3317
	iters: 100, epoch: 1 | loss: 0.4275208
	speed: 0.3205s/iter; left time: 4673.9182s
	iters: 200, epoch: 1 | loss: 0.4549967
	speed: 0.3062s/iter; left time: 4434.1906s
	iters: 300, epoch: 1 | loss: 0.5294547
	speed: 0.3053s/iter; left time: 4390.2266s
	iters: 400, epoch: 1 | loss: 0.4306480
	speed: 0.3052s/iter; left time: 4358.5464s
	iters: 500, epoch: 1 | loss: 0.4963556
	speed: 0.3039s/iter; left time: 4310.1885s
	iters: 600, epoch: 1 | loss: 0.4890031
	speed: 0.3038s/iter; left time: 4277.6313s
	iters: 700, epoch: 1 | loss: 0.4898297
	speed: 0.3034s/iter; left time: 4242.0727s
Epoch: 1 cost time: 225.31334924697876
Epoch: 1, Steps: 734 | Train Loss: 0.4821289 Vali Loss: 0.6340172 Test Loss: 0.7541116
Validation loss decreased (inf --> 0.634017).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.4563254
	speed: 0.6089s/iter; left time: 8430.9104s
	iters: 200, epoch: 2 | loss: 0.4547004
	speed: 0.3030s/iter; left time: 4165.6654s
	iters: 300, epoch: 2 | loss: 0.5142127
	speed: 0.3029s/iter; left time: 4133.0084s
	iters: 400, epoch: 2 | loss: 0.4551668
	speed: 0.3035s/iter; left time: 4111.5743s
	iters: 500, epoch: 2 | loss: 0.4584908
	speed: 0.3041s/iter; left time: 4089.7404s
	iters: 600, epoch: 2 | loss: 0.4638032
	speed: 0.3030s/iter; left time: 4043.5541s
	iters: 700, epoch: 2 | loss: 0.4829577
	speed: 0.3022s/iter; left time: 4003.4194s
Epoch: 2 cost time: 222.51397347450256
Epoch: 2, Steps: 734 | Train Loss: 0.4731180 Vali Loss: 0.6573473 Test Loss: 0.7790284
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.3155592
	speed: 0.6071s/iter; left time: 7960.9910s
	iters: 200, epoch: 3 | loss: 0.3459849
	speed: 0.3044s/iter; left time: 3961.4491s
	iters: 300, epoch: 3 | loss: 0.3368970
	speed: 0.3045s/iter; left time: 3932.1335s
	iters: 400, epoch: 3 | loss: 0.3187582
	speed: 0.3030s/iter; left time: 3882.7404s
	iters: 500, epoch: 3 | loss: 0.3354566
	speed: 0.3024s/iter; left time: 3844.4389s
	iters: 600, epoch: 3 | loss: 0.3326121
	speed: 0.3043s/iter; left time: 3838.3823s
	iters: 700, epoch: 3 | loss: 0.3227116
	speed: 0.3041s/iter; left time: 3805.4185s
Epoch: 3 cost time: 222.9839973449707
Epoch: 3, Steps: 734 | Train Loss: 0.3302286 Vali Loss: 0.4493427 Test Loss: 0.5508481
Validation loss decreased (0.634017 --> 0.449343).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.2743163
	speed: 0.6116s/iter; left time: 7571.5764s
	iters: 200, epoch: 4 | loss: 0.2854399
	speed: 0.3049s/iter; left time: 3743.4620s
	iters: 300, epoch: 4 | loss: 0.2737450
	speed: 0.3048s/iter; left time: 3712.5820s
	iters: 400, epoch: 4 | loss: 0.2728451
	speed: 0.3049s/iter; left time: 3682.8716s
	iters: 500, epoch: 4 | loss: 0.2790472
	speed: 0.3062s/iter; left time: 3667.8391s
	iters: 600, epoch: 4 | loss: 0.2883987
	speed: 0.3059s/iter; left time: 3633.9238s
	iters: 700, epoch: 4 | loss: 0.3018511
	speed: 0.3043s/iter; left time: 3583.7731s
Epoch: 4 cost time: 223.87355494499207
Epoch: 4, Steps: 734 | Train Loss: 0.2824210 Vali Loss: 0.4031612 Test Loss: 0.4937567
Validation loss decreased (0.449343 --> 0.403161).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.2547355
	speed: 0.6130s/iter; left time: 7138.9651s
	iters: 200, epoch: 5 | loss: 0.2801259
	speed: 0.3049s/iter; left time: 3519.9638s
	iters: 300, epoch: 5 | loss: 0.2664269
	speed: 0.3047s/iter; left time: 3487.7970s
	iters: 400, epoch: 5 | loss: 0.2792984
	speed: 0.3070s/iter; left time: 3482.9473s
	iters: 500, epoch: 5 | loss: 0.2687830
	speed: 0.3057s/iter; left time: 3437.9535s
	iters: 600, epoch: 5 | loss: 0.2696378
	speed: 0.3061s/iter; left time: 3411.5639s
	iters: 700, epoch: 5 | loss: 0.2464492
	speed: 0.3051s/iter; left time: 3370.0842s
Epoch: 5 cost time: 224.14543271064758
Epoch: 5, Steps: 734 | Train Loss: 0.2615146 Vali Loss: 0.3762666 Test Loss: 0.4636602
Validation loss decreased (0.403161 --> 0.376267).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.2275736
	speed: 0.6160s/iter; left time: 6721.6861s
	iters: 200, epoch: 6 | loss: 0.2588582
	speed: 0.3052s/iter; left time: 3299.9126s
	iters: 300, epoch: 6 | loss: 0.2465729
	speed: 0.3044s/iter; left time: 3260.1746s
	iters: 400, epoch: 6 | loss: 0.2811225
	speed: 0.3068s/iter; left time: 3255.2885s
	iters: 500, epoch: 6 | loss: 0.2624028
	speed: 0.3058s/iter; left time: 3214.1943s
	iters: 600, epoch: 6 | loss: 0.2570604
	speed: 0.3051s/iter; left time: 3176.8944s
	iters: 700, epoch: 6 | loss: 0.2824186
	speed: 0.3060s/iter; left time: 3155.3436s
Epoch: 6 cost time: 224.37226486206055
Epoch: 6, Steps: 734 | Train Loss: 0.2505834 Vali Loss: 0.3657367 Test Loss: 0.4511651
Validation loss decreased (0.376267 --> 0.365737).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.2239894
	speed: 0.6159s/iter; left time: 6267.6133s
	iters: 200, epoch: 7 | loss: 0.2694986
	speed: 0.3050s/iter; left time: 3073.0115s
	iters: 300, epoch: 7 | loss: 0.2623281
	speed: 0.3054s/iter; left time: 3047.3856s
	iters: 400, epoch: 7 | loss: 0.2239919
	speed: 0.3058s/iter; left time: 3020.2529s
	iters: 500, epoch: 7 | loss: 0.2534553
	speed: 0.3046s/iter; left time: 2977.7827s
	iters: 600, epoch: 7 | loss: 0.2454080
	speed: 0.3065s/iter; left time: 2966.1111s
	iters: 700, epoch: 7 | loss: 0.2411086
	speed: 0.3065s/iter; left time: 2935.2916s
Epoch: 7 cost time: 224.36044049263
Epoch: 7, Steps: 734 | Train Loss: 0.2446139 Vali Loss: 0.3600601 Test Loss: 0.4441111
Validation loss decreased (0.365737 --> 0.360060).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.2279047
	speed: 0.6158s/iter; left time: 5814.6468s
	iters: 200, epoch: 8 | loss: 0.2618786
	speed: 0.3056s/iter; left time: 2854.9646s
	iters: 300, epoch: 8 | loss: 0.2443116
	speed: 0.3040s/iter; left time: 2810.2519s
	iters: 400, epoch: 8 | loss: 0.2475324
	speed: 0.3050s/iter; left time: 2788.5335s
	iters: 500, epoch: 8 | loss: 0.2158255
	speed: 0.3047s/iter; left time: 2755.5877s
	iters: 600, epoch: 8 | loss: 0.2509918
	speed: 0.3043s/iter; left time: 2721.3167s
	iters: 700, epoch: 8 | loss: 0.2429229
	speed: 0.3041s/iter; left time: 2689.5297s
Epoch: 8 cost time: 223.7556436061859
Epoch: 8, Steps: 734 | Train Loss: 0.2413968 Vali Loss: 0.3575667 Test Loss: 0.4413354
Validation loss decreased (0.360060 --> 0.357567).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.2416028
	speed: 0.6134s/iter; left time: 5342.4603s
	iters: 200, epoch: 9 | loss: 0.2516967
	speed: 0.3081s/iter; left time: 2652.4454s
	iters: 300, epoch: 9 | loss: 0.2395852
	speed: 0.3068s/iter; left time: 2610.7316s
	iters: 400, epoch: 9 | loss: 0.2350816
	speed: 0.3063s/iter; left time: 2575.5443s
	iters: 500, epoch: 9 | loss: 0.2606172
	speed: 0.3065s/iter; left time: 2546.5986s
	iters: 600, epoch: 9 | loss: 0.2376854
	speed: 0.3063s/iter; left time: 2514.5394s
	iters: 700, epoch: 9 | loss: 0.2403626
	speed: 0.3058s/iter; left time: 2480.0470s
Epoch: 9 cost time: 224.87255096435547
Epoch: 9, Steps: 734 | Train Loss: 0.2395531 Vali Loss: 0.3565199 Test Loss: 0.4401228
Validation loss decreased (0.357567 --> 0.356520).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.2233749
	speed: 0.6128s/iter; left time: 4886.8342s
	iters: 200, epoch: 10 | loss: 0.2160046
	speed: 0.3058s/iter; left time: 2407.8356s
	iters: 300, epoch: 10 | loss: 0.2483913
	speed: 0.3066s/iter; left time: 2383.9676s
	iters: 400, epoch: 10 | loss: 0.2673487
	speed: 0.3059s/iter; left time: 2347.5264s
	iters: 500, epoch: 10 | loss: 0.2222030
	speed: 0.3066s/iter; left time: 2322.8120s
	iters: 600, epoch: 10 | loss: 0.2318816
	speed: 0.3067s/iter; left time: 2292.2365s
	iters: 700, epoch: 10 | loss: 0.2384131
	speed: 0.3066s/iter; left time: 2260.8687s
Epoch: 10 cost time: 224.6610085964203
Epoch: 10, Steps: 734 | Train Loss: 0.2385966 Vali Loss: 0.3554146 Test Loss: 0.4393598
Validation loss decreased (0.356520 --> 0.355415).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.2346453
	speed: 0.6163s/iter; left time: 4462.2761s
	iters: 200, epoch: 11 | loss: 0.2254260
	speed: 0.3056s/iter; left time: 2182.0128s
	iters: 300, epoch: 11 | loss: 0.2290298
	speed: 0.3053s/iter; left time: 2149.6613s
	iters: 400, epoch: 11 | loss: 0.2646651
	speed: 0.3052s/iter; left time: 2118.7055s
	iters: 500, epoch: 11 | loss: 0.2237148
	speed: 0.3055s/iter; left time: 2090.1936s
	iters: 600, epoch: 11 | loss: 0.2365744
	speed: 0.3064s/iter; left time: 2065.4190s
	iters: 700, epoch: 11 | loss: 0.2496607
	speed: 0.3080s/iter; left time: 2045.2569s
Epoch: 11 cost time: 224.66300797462463
Epoch: 11, Steps: 734 | Train Loss: 0.2380893 Vali Loss: 0.3554665 Test Loss: 0.4391578
EarlyStopping counter: 1 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.2340577
	speed: 0.6144s/iter; left time: 3998.0431s
	iters: 200, epoch: 12 | loss: 0.2355691
	speed: 0.3055s/iter; left time: 1957.4654s
	iters: 300, epoch: 12 | loss: 0.2303086
	speed: 0.3060s/iter; left time: 1929.8281s
	iters: 400, epoch: 12 | loss: 0.2458797
	speed: 0.3060s/iter; left time: 1899.5211s
	iters: 500, epoch: 12 | loss: 0.2273597
	speed: 0.3056s/iter; left time: 1866.4339s
	iters: 600, epoch: 12 | loss: 0.2327427
	speed: 0.3049s/iter; left time: 1831.5817s
	iters: 700, epoch: 12 | loss: 0.2447970
	speed: 0.3060s/iter; left time: 1807.2812s
Epoch: 12 cost time: 224.57769083976746
Epoch: 12, Steps: 734 | Train Loss: 0.2377925 Vali Loss: 0.3554288 Test Loss: 0.4390399
EarlyStopping counter: 2 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.2522956
	speed: 0.6171s/iter; left time: 3562.7417s
	iters: 200, epoch: 13 | loss: 0.2357235
	speed: 0.3065s/iter; left time: 1738.9349s
	iters: 300, epoch: 13 | loss: 0.2240838
	speed: 0.3055s/iter; left time: 1702.6794s
	iters: 400, epoch: 13 | loss: 0.2231732
	speed: 0.3070s/iter; left time: 1680.1400s
	iters: 500, epoch: 13 | loss: 0.2464168
	speed: 0.3059s/iter; left time: 1643.4022s
	iters: 600, epoch: 13 | loss: 0.2255835
	speed: 0.3057s/iter; left time: 1611.8397s
	iters: 700, epoch: 13 | loss: 0.2409112
	speed: 0.3057s/iter; left time: 1581.6149s
Epoch: 13 cost time: 224.89775323867798
Epoch: 13, Steps: 734 | Train Loss: 0.2376378 Vali Loss: 0.3554435 Test Loss: 0.4389479
EarlyStopping counter: 3 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 14 | loss: 0.2573838
	speed: 0.6140s/iter; left time: 3094.0727s
	iters: 200, epoch: 14 | loss: 0.2239930
	speed: 0.3076s/iter; left time: 1519.4471s
	iters: 300, epoch: 14 | loss: 0.2530755
	speed: 0.3070s/iter; left time: 1485.7067s
	iters: 400, epoch: 14 | loss: 0.2653950
	speed: 0.3076s/iter; left time: 1457.8706s
	iters: 500, epoch: 14 | loss: 0.2189617
	speed: 0.3061s/iter; left time: 1420.2191s
	iters: 600, epoch: 14 | loss: 0.2617757
	speed: 0.3052s/iter; left time: 1385.5038s
	iters: 700, epoch: 14 | loss: 0.2738225
	speed: 0.3052s/iter; left time: 1354.6340s
Epoch: 14 cost time: 224.95089840888977
Epoch: 14, Steps: 734 | Train Loss: 0.2375376 Vali Loss: 0.3555224 Test Loss: 0.4389428
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 15 | loss: 0.2425007
	speed: 0.6124s/iter; left time: 2636.3017s
	iters: 200, epoch: 15 | loss: 0.2207601
	speed: 0.3055s/iter; left time: 1284.5871s
	iters: 300, epoch: 15 | loss: 0.2538435
	speed: 0.3053s/iter; left time: 1253.3512s
	iters: 400, epoch: 15 | loss: 0.2387404
	speed: 0.3062s/iter; left time: 1226.5066s
	iters: 500, epoch: 15 | loss: 0.2447592
	speed: 0.3067s/iter; left time: 1197.6266s
	iters: 600, epoch: 15 | loss: 0.2457052
	speed: 0.3063s/iter; left time: 1165.3697s
	iters: 700, epoch: 15 | loss: 0.2592048
	speed: 0.3060s/iter; left time: 1133.7442s
Epoch: 15 cost time: 224.58749890327454
Epoch: 15, Steps: 734 | Train Loss: 0.2375051 Vali Loss: 0.3554985 Test Loss: 0.4389353
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : traffic_336_192_Linear_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3144<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3317
mse:0.43905410170555115, mae:0.3048126995563507
