Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTh2', data_path='ETTh2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.05, loss='mse', lradj='type1', model='Linear', model_id='ETTh2_336_192', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=192, root_path='./dataset/', save_pred_values=False, seed=3144, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTh2_336_192_Linear_ETTh2_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3144>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8113
val 2689
test 2689
	iters: 100, epoch: 1 | loss: 5.8361535
	speed: 0.0045s/iter; left time: 44.9839s
	iters: 200, epoch: 1 | loss: 12.0714474
	speed: 0.0046s/iter; left time: 45.3524s
	iters: 300, epoch: 1 | loss: 5.2987037
	speed: 0.0045s/iter; left time: 44.3885s
	iters: 400, epoch: 1 | loss: 5.9984918
	speed: 0.0043s/iter; left time: 42.0163s
	iters: 500, epoch: 1 | loss: 6.1934013
	speed: 0.0038s/iter; left time: 36.4428s
Epoch: 1 cost time: 2.1916086673736572
Epoch: 1, Steps: 507 | Train Loss: 6.9852495 Vali Loss: 7.9683909 Test Loss: 15.5343647
Validation loss decreased (inf --> 7.968391).  Saving model ...
Updating learning rate to 0.05
	iters: 100, epoch: 2 | loss: 8.6319923
	speed: 0.0085s/iter; left time: 81.1587s
	iters: 200, epoch: 2 | loss: 9.1049757
	speed: 0.0044s/iter; left time: 41.4154s
	iters: 300, epoch: 2 | loss: 5.2266169
	speed: 0.0043s/iter; left time: 40.1557s
	iters: 400, epoch: 2 | loss: 2.3274417
	speed: 0.0047s/iter; left time: 43.1068s
	iters: 500, epoch: 2 | loss: 8.9143238
	speed: 0.0038s/iter; left time: 35.0917s
Epoch: 2 cost time: 2.1832854747772217
Epoch: 2, Steps: 507 | Train Loss: 7.6210491 Vali Loss: 2.9641757 Test Loss: 9.1438360
Validation loss decreased (7.968391 --> 2.964176).  Saving model ...
Updating learning rate to 0.025
	iters: 100, epoch: 3 | loss: 0.6590270
	speed: 0.0078s/iter; left time: 70.6860s
	iters: 200, epoch: 3 | loss: 0.3494295
	speed: 0.0037s/iter; left time: 33.3166s
	iters: 300, epoch: 3 | loss: 0.6985295
	speed: 0.0036s/iter; left time: 32.2185s
	iters: 400, epoch: 3 | loss: 0.7257172
	speed: 0.0027s/iter; left time: 23.5629s
	iters: 500, epoch: 3 | loss: 0.7903833
	speed: 0.0036s/iter; left time: 31.4243s
Epoch: 3 cost time: 1.7545206546783447
Epoch: 3, Steps: 507 | Train Loss: 1.1445839 Vali Loss: 0.8431867 Test Loss: 2.5384374
Validation loss decreased (2.964176 --> 0.843187).  Saving model ...
Updating learning rate to 0.0125
	iters: 100, epoch: 4 | loss: 0.4946561
	speed: 0.0096s/iter; left time: 81.9069s
	iters: 200, epoch: 4 | loss: 0.6895100
	speed: 0.0045s/iter; left time: 38.2133s
	iters: 300, epoch: 4 | loss: 0.3927484
	speed: 0.0045s/iter; left time: 37.4579s
	iters: 400, epoch: 4 | loss: 0.5485774
	speed: 0.0041s/iter; left time: 33.9484s
	iters: 500, epoch: 4 | loss: 0.8660774
	speed: 0.0041s/iter; left time: 33.0102s
Epoch: 4 cost time: 2.2159299850463867
Epoch: 4, Steps: 507 | Train Loss: 0.6327426 Vali Loss: 0.6517016 Test Loss: 1.4453894
Validation loss decreased (0.843187 --> 0.651702).  Saving model ...
Updating learning rate to 0.00625
	iters: 100, epoch: 5 | loss: 0.5753744
	speed: 0.0076s/iter; left time: 60.8187s
	iters: 200, epoch: 5 | loss: 0.7204833
	speed: 0.0040s/iter; left time: 31.6780s
	iters: 300, epoch: 5 | loss: 0.6685033
	speed: 0.0039s/iter; left time: 30.7882s
	iters: 400, epoch: 5 | loss: 0.6344680
	speed: 0.0035s/iter; left time: 27.0727s
	iters: 500, epoch: 5 | loss: 0.5083107
	speed: 0.0038s/iter; left time: 28.9432s
Epoch: 5 cost time: 1.9165761470794678
Epoch: 5, Steps: 507 | Train Loss: 0.5333976 Vali Loss: 0.5080608 Test Loss: 1.0030485
Validation loss decreased (0.651702 --> 0.508061).  Saving model ...
Updating learning rate to 0.003125
	iters: 100, epoch: 6 | loss: 0.4313855
	speed: 0.0090s/iter; left time: 67.7422s
	iters: 200, epoch: 6 | loss: 0.2806545
	speed: 0.0029s/iter; left time: 21.4034s
	iters: 300, epoch: 6 | loss: 0.6489410
	speed: 0.0040s/iter; left time: 29.3702s
	iters: 400, epoch: 6 | loss: 0.4865417
	speed: 0.0045s/iter; left time: 32.2348s
	iters: 500, epoch: 6 | loss: 0.5091048
	speed: 0.0048s/iter; left time: 34.3220s
Epoch: 6 cost time: 2.098653793334961
Epoch: 6, Steps: 507 | Train Loss: 0.4959915 Vali Loss: 0.4520643 Test Loss: 0.7480357
Validation loss decreased (0.508061 --> 0.452064).  Saving model ...
Updating learning rate to 0.0015625
	iters: 100, epoch: 7 | loss: 0.3982624
	speed: 0.0093s/iter; left time: 65.1793s
	iters: 200, epoch: 7 | loss: 0.4320211
	speed: 0.0043s/iter; left time: 29.8214s
	iters: 300, epoch: 7 | loss: 0.7072123
	speed: 0.0040s/iter; left time: 27.2638s
	iters: 400, epoch: 7 | loss: 0.7107762
	speed: 0.0044s/iter; left time: 29.5603s
	iters: 500, epoch: 7 | loss: 0.3997434
	speed: 0.0037s/iter; left time: 24.6799s
Epoch: 7 cost time: 2.1045143604278564
Epoch: 7, Steps: 507 | Train Loss: 0.4722445 Vali Loss: 0.4528763 Test Loss: 0.7550028
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00078125
	iters: 100, epoch: 8 | loss: 0.5446740
	speed: 0.0079s/iter; left time: 51.1331s
	iters: 200, epoch: 8 | loss: 0.4114500
	speed: 0.0042s/iter; left time: 26.5905s
	iters: 300, epoch: 8 | loss: 0.3653958
	speed: 0.0039s/iter; left time: 24.2871s
	iters: 400, epoch: 8 | loss: 0.6979166
	speed: 0.0039s/iter; left time: 24.0432s
	iters: 500, epoch: 8 | loss: 0.2971970
	speed: 0.0043s/iter; left time: 26.2466s
Epoch: 8 cost time: 2.0717594623565674
Epoch: 8, Steps: 507 | Train Loss: 0.4614445 Vali Loss: 0.3910732 Test Loss: 0.5645559
Validation loss decreased (0.452064 --> 0.391073).  Saving model ...
Updating learning rate to 0.000390625
	iters: 100, epoch: 9 | loss: 0.4179184
	speed: 0.0080s/iter; left time: 47.5941s
	iters: 200, epoch: 9 | loss: 0.5402622
	speed: 0.0044s/iter; left time: 25.6756s
	iters: 300, epoch: 9 | loss: 0.7715408
	speed: 0.0042s/iter; left time: 24.5285s
	iters: 400, epoch: 9 | loss: 0.4004547
	speed: 0.0040s/iter; left time: 23.0241s
	iters: 500, epoch: 9 | loss: 0.5478927
	speed: 0.0041s/iter; left time: 23.0259s
Epoch: 9 cost time: 2.1025736331939697
Epoch: 9, Steps: 507 | Train Loss: 0.4539172 Vali Loss: 0.3873339 Test Loss: 0.5980858
Validation loss decreased (0.391073 --> 0.387334).  Saving model ...
Updating learning rate to 0.0001953125
	iters: 100, epoch: 10 | loss: 0.4021267
	speed: 0.0072s/iter; left time: 39.5626s
	iters: 200, epoch: 10 | loss: 0.8734689
	speed: 0.0043s/iter; left time: 22.9639s
	iters: 300, epoch: 10 | loss: 0.2971374
	speed: 0.0030s/iter; left time: 15.7723s
	iters: 400, epoch: 10 | loss: 0.2682712
	speed: 0.0027s/iter; left time: 13.9401s
	iters: 500, epoch: 10 | loss: 0.2111706
	speed: 0.0041s/iter; left time: 20.9721s
Epoch: 10 cost time: 1.829256296157837
Epoch: 10, Steps: 507 | Train Loss: 0.4493725 Vali Loss: 0.4122086 Test Loss: 0.6618897
EarlyStopping counter: 1 out of 5
Updating learning rate to 9.765625e-05
	iters: 100, epoch: 11 | loss: 0.2307189
	speed: 0.0091s/iter; left time: 45.2962s
	iters: 200, epoch: 11 | loss: 0.4848315
	speed: 0.0045s/iter; left time: 21.8221s
	iters: 300, epoch: 11 | loss: 0.2972798
	speed: 0.0045s/iter; left time: 21.5304s
	iters: 400, epoch: 11 | loss: 0.2974010
	speed: 0.0041s/iter; left time: 19.1537s
	iters: 500, epoch: 11 | loss: 0.5344698
	speed: 0.0047s/iter; left time: 21.6811s
Epoch: 11 cost time: 2.2518134117126465
Epoch: 11, Steps: 507 | Train Loss: 0.4469314 Vali Loss: 0.3846847 Test Loss: 0.5893974
Validation loss decreased (0.387334 --> 0.384685).  Saving model ...
Updating learning rate to 4.8828125e-05
	iters: 100, epoch: 12 | loss: 0.5643361
	speed: 0.0098s/iter; left time: 43.6767s
	iters: 200, epoch: 12 | loss: 0.4063035
	speed: 0.0046s/iter; left time: 19.9138s
	iters: 300, epoch: 12 | loss: 0.2661743
	speed: 0.0044s/iter; left time: 18.8136s
	iters: 400, epoch: 12 | loss: 0.2332550
	speed: 0.0046s/iter; left time: 18.9883s
	iters: 500, epoch: 12 | loss: 0.8396185
	speed: 0.0048s/iter; left time: 19.5478s
Epoch: 12 cost time: 2.3569681644439697
Epoch: 12, Steps: 507 | Train Loss: 0.4453924 Vali Loss: 0.3842445 Test Loss: 0.5646762
Validation loss decreased (0.384685 --> 0.384245).  Saving model ...
Updating learning rate to 2.44140625e-05
	iters: 100, epoch: 13 | loss: 0.4090984
	speed: 0.0083s/iter; left time: 32.9849s
	iters: 200, epoch: 13 | loss: 0.7509754
	speed: 0.0039s/iter; left time: 15.1721s
	iters: 300, epoch: 13 | loss: 0.5600665
	speed: 0.0042s/iter; left time: 15.7043s
	iters: 400, epoch: 13 | loss: 0.2772057
	speed: 0.0042s/iter; left time: 15.2149s
	iters: 500, epoch: 13 | loss: 0.9963177
	speed: 0.0041s/iter; left time: 14.6668s
Epoch: 13 cost time: 2.049752950668335
Epoch: 13, Steps: 507 | Train Loss: 0.4445006 Vali Loss: 0.3856818 Test Loss: 0.5765081
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.220703125e-05
	iters: 100, epoch: 14 | loss: 0.6223827
	speed: 0.0086s/iter; left time: 29.7807s
	iters: 200, epoch: 14 | loss: 0.2267361
	speed: 0.0046s/iter; left time: 15.2760s
	iters: 300, epoch: 14 | loss: 0.8928786
	speed: 0.0042s/iter; left time: 13.7583s
	iters: 400, epoch: 14 | loss: 0.4104140
	speed: 0.0038s/iter; left time: 11.9395s
	iters: 500, epoch: 14 | loss: 0.4861082
	speed: 0.0038s/iter; left time: 11.5290s
Epoch: 14 cost time: 2.0915777683258057
Epoch: 14, Steps: 507 | Train Loss: 0.4436518 Vali Loss: 0.3933015 Test Loss: 0.6072361
EarlyStopping counter: 2 out of 5
Updating learning rate to 6.103515625e-06
	iters: 100, epoch: 15 | loss: 0.3469577
	speed: 0.0080s/iter; left time: 23.4397s
	iters: 200, epoch: 15 | loss: 0.2140028
	speed: 0.0037s/iter; left time: 10.4671s
	iters: 300, epoch: 15 | loss: 0.2941101
	speed: 0.0037s/iter; left time: 10.2588s
	iters: 400, epoch: 15 | loss: 0.3564473
	speed: 0.0037s/iter; left time: 9.8585s
	iters: 500, epoch: 15 | loss: 0.2376505
	speed: 0.0035s/iter; left time: 8.8131s
Epoch: 15 cost time: 1.8645472526550293
Epoch: 15, Steps: 507 | Train Loss: 0.4437333 Vali Loss: 0.3900669 Test Loss: 0.5948524
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.0517578125e-06
	iters: 100, epoch: 16 | loss: 0.5800795
	speed: 0.0066s/iter; left time: 15.9755s
	iters: 200, epoch: 16 | loss: 1.0329467
	speed: 0.0032s/iter; left time: 7.5046s
	iters: 300, epoch: 16 | loss: 0.6187255
	speed: 0.0032s/iter; left time: 7.0448s
	iters: 400, epoch: 16 | loss: 0.2977808
	speed: 0.0032s/iter; left time: 6.7498s
	iters: 500, epoch: 16 | loss: 0.2186993
	speed: 0.0032s/iter; left time: 6.4170s
Epoch: 16 cost time: 1.606499433517456
Epoch: 16, Steps: 507 | Train Loss: 0.4434462 Vali Loss: 0.3891622 Test Loss: 0.5919109
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.52587890625e-06
	iters: 100, epoch: 17 | loss: 0.8278460
	speed: 0.0053s/iter; left time: 10.2429s
	iters: 200, epoch: 17 | loss: 0.5828010
	speed: 0.0023s/iter; left time: 4.1518s
	iters: 300, epoch: 17 | loss: 0.4656497
	speed: 0.0025s/iter; left time: 4.3279s
	iters: 400, epoch: 17 | loss: 0.1930055
	speed: 0.0029s/iter; left time: 4.6751s
	iters: 500, epoch: 17 | loss: 0.2404292
	speed: 0.0028s/iter; left time: 4.2353s
Epoch: 17 cost time: 1.285301923751831
Epoch: 17, Steps: 507 | Train Loss: 0.4434196 Vali Loss: 0.3889568 Test Loss: 0.5911096
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTh2_336_192_Linear_ETTh2_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3144<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2689
mse:0.565615177154541, mae:0.5000035166740417
