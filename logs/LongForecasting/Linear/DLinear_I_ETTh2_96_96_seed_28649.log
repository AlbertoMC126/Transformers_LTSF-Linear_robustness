Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTh2', data_path='ETTh2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.05, loss='mse', lradj='type1', model='DLinear', model_id='ETTh2_96_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=28649, seq_len=96, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTh2_96_96_DLinear_ETTh2_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed28649>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8449
data_set:  <data_provider.data_loader.Dataset_ETT_hour object at 0x0000019601AF0550>
val 2785
data_set:  <data_provider.data_loader.Dataset_ETT_hour object at 0x000001964E747DD8>
test 2785
data_set:  <data_provider.data_loader.Dataset_ETT_hour object at 0x0000019601AF0208>
Total number of trainable parameters: 130368
Total number of parameters: 130368
	iters: 100, epoch: 1 | loss: 1.1838114
	speed: 0.0037s/iter; left time: 38.5332s
	iters: 200, epoch: 1 | loss: 0.9637057
	speed: 0.0040s/iter; left time: 41.8815s
	iters: 300, epoch: 1 | loss: 0.5814055
	speed: 0.0042s/iter; left time: 42.8813s
	iters: 400, epoch: 1 | loss: 0.7920845
	speed: 0.0042s/iter; left time: 42.4138s
	iters: 500, epoch: 1 | loss: 1.4506787
	speed: 0.0042s/iter; left time: 42.1100s
Epoch: 1 cost time: 2.1354472637176514
Epoch: 1, Steps: 528 | Train Loss: 1.3953336 Vali Loss: 1.5618412 Test Loss: 3.6393499
Validation loss decreased (inf --> 1.561841).  Saving model ...
Updating learning rate to 0.05
	iters: 100, epoch: 2 | loss: 0.8001825
	speed: 0.0114s/iter; left time: 113.0216s
	iters: 200, epoch: 2 | loss: 0.9472286
	speed: 0.0042s/iter; left time: 41.2181s
	iters: 300, epoch: 2 | loss: 1.8758436
	speed: 0.0049s/iter; left time: 47.4908s
	iters: 400, epoch: 2 | loss: 1.2334024
	speed: 0.0041s/iter; left time: 39.8691s
	iters: 500, epoch: 2 | loss: 0.8807507
	speed: 0.0048s/iter; left time: 45.5460s
Epoch: 2 cost time: 2.336956739425659
Epoch: 2, Steps: 528 | Train Loss: 1.5655458 Vali Loss: 4.0067096 Test Loss: 10.2968664
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.025
	iters: 100, epoch: 3 | loss: 0.3104523
	speed: 0.0094s/iter; left time: 88.6568s
	iters: 200, epoch: 3 | loss: 0.5118120
	speed: 0.0042s/iter; left time: 39.4629s
	iters: 300, epoch: 3 | loss: 0.4457718
	speed: 0.0044s/iter; left time: 40.4967s
	iters: 400, epoch: 3 | loss: 0.5723535
	speed: 0.0050s/iter; left time: 45.3076s
	iters: 500, epoch: 3 | loss: 0.4261373
	speed: 0.0043s/iter; left time: 38.3658s
Epoch: 3 cost time: 2.3328561782836914
Epoch: 3, Steps: 528 | Train Loss: 0.6557782 Vali Loss: 0.6874813 Test Loss: 1.3303704
Validation loss decreased (1.561841 --> 0.687481).  Saving model ...
Updating learning rate to 0.0125
	iters: 100, epoch: 4 | loss: 0.5189935
	speed: 0.0114s/iter; left time: 101.2028s
	iters: 200, epoch: 4 | loss: 0.2730868
	speed: 0.0050s/iter; left time: 43.9299s
	iters: 300, epoch: 4 | loss: 0.3029052
	speed: 0.0041s/iter; left time: 35.3952s
	iters: 400, epoch: 4 | loss: 0.2550524
	speed: 0.0037s/iter; left time: 31.4476s
	iters: 500, epoch: 4 | loss: 0.4281617
	speed: 0.0046s/iter; left time: 39.3079s
Epoch: 4 cost time: 2.298922538757324
Epoch: 4, Steps: 528 | Train Loss: 0.4738327 Vali Loss: 0.3914267 Test Loss: 0.8344843
Validation loss decreased (0.687481 --> 0.391427).  Saving model ...
Updating learning rate to 0.00625
	iters: 100, epoch: 5 | loss: 0.1915486
	speed: 0.0128s/iter; left time: 107.2635s
	iters: 200, epoch: 5 | loss: 0.3546649
	speed: 0.0037s/iter; left time: 30.3941s
	iters: 300, epoch: 5 | loss: 0.2972354
	speed: 0.0043s/iter; left time: 35.1254s
	iters: 400, epoch: 5 | loss: 0.3173383
	speed: 0.0050s/iter; left time: 40.3983s
	iters: 500, epoch: 5 | loss: 0.3055941
	speed: 0.0044s/iter; left time: 34.5914s
Epoch: 5 cost time: 2.254777669906616
Epoch: 5, Steps: 528 | Train Loss: 0.4206583 Vali Loss: 0.4037489 Test Loss: 0.8690695
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.003125
	iters: 100, epoch: 6 | loss: 0.4703497
	speed: 0.0093s/iter; left time: 72.4745s
	iters: 200, epoch: 6 | loss: 1.3350286
	speed: 0.0044s/iter; left time: 34.2135s
	iters: 300, epoch: 6 | loss: 0.3540994
	speed: 0.0041s/iter; left time: 31.4713s
	iters: 400, epoch: 6 | loss: 0.3842003
	speed: 0.0040s/iter; left time: 30.3802s
	iters: 500, epoch: 6 | loss: 0.6327052
	speed: 0.0035s/iter; left time: 26.1729s
Epoch: 6 cost time: 2.224194288253784
Epoch: 6, Steps: 528 | Train Loss: 0.3976169 Vali Loss: 0.4154232 Test Loss: 0.9129245
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.0015625
	iters: 100, epoch: 7 | loss: 0.2283812
	speed: 0.0118s/iter; left time: 85.9275s
	iters: 200, epoch: 7 | loss: 0.1977181
	speed: 0.0044s/iter; left time: 31.9815s
	iters: 300, epoch: 7 | loss: 0.2902729
	speed: 0.0045s/iter; left time: 31.9581s
	iters: 400, epoch: 7 | loss: 0.2544896
	speed: 0.0044s/iter; left time: 30.4491s
	iters: 500, epoch: 7 | loss: 0.2618375
	speed: 0.0032s/iter; left time: 22.3663s
Epoch: 7 cost time: 2.3209927082061768
Epoch: 7, Steps: 528 | Train Loss: 0.3854135 Vali Loss: 0.2957244 Test Loss: 0.5477417
Validation loss decreased (0.391427 --> 0.295724).  Saving model ...
Updating learning rate to 0.00078125
	iters: 100, epoch: 8 | loss: 0.5747193
	speed: 0.0106s/iter; left time: 72.0383s
	iters: 200, epoch: 8 | loss: 0.2441750
	speed: 0.0046s/iter; left time: 30.7450s
	iters: 300, epoch: 8 | loss: 0.3232439
	speed: 0.0044s/iter; left time: 29.1072s
	iters: 400, epoch: 8 | loss: 0.4544749
	speed: 0.0043s/iter; left time: 28.0136s
	iters: 500, epoch: 8 | loss: 0.2596139
	speed: 0.0035s/iter; left time: 22.4181s
Epoch: 8 cost time: 2.2377145290374756
Epoch: 8, Steps: 528 | Train Loss: 0.3765479 Vali Loss: 0.2679841 Test Loss: 0.4567766
Validation loss decreased (0.295724 --> 0.267984).  Saving model ...
Updating learning rate to 0.000390625
	iters: 100, epoch: 9 | loss: 0.4382363
	speed: 0.0120s/iter; left time: 74.5625s
	iters: 200, epoch: 9 | loss: 0.3246908
	speed: 0.0035s/iter; left time: 21.5672s
	iters: 300, epoch: 9 | loss: 0.2456741
	speed: 0.0037s/iter; left time: 22.4478s
	iters: 400, epoch: 9 | loss: 0.3679464
	speed: 0.0042s/iter; left time: 25.0232s
	iters: 500, epoch: 9 | loss: 0.5303579
	speed: 0.0042s/iter; left time: 24.6201s
Epoch: 9 cost time: 2.0302515029907227
Epoch: 9, Steps: 528 | Train Loss: 0.3726222 Vali Loss: 0.2819947 Test Loss: 0.5059896
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0001953125
	iters: 100, epoch: 10 | loss: 0.4335259
	speed: 0.0105s/iter; left time: 60.0386s
	iters: 200, epoch: 10 | loss: 0.1867347
	speed: 0.0037s/iter; left time: 20.7459s
	iters: 300, epoch: 10 | loss: 0.1693520
	speed: 0.0038s/iter; left time: 20.9957s
	iters: 400, epoch: 10 | loss: 0.4019185
	speed: 0.0039s/iter; left time: 21.0637s
	iters: 500, epoch: 10 | loss: 0.2981330
	speed: 0.0045s/iter; left time: 23.9050s
Epoch: 10 cost time: 2.1653995513916016
Epoch: 10, Steps: 528 | Train Loss: 0.3698831 Vali Loss: 0.3031405 Test Loss: 0.5733289
EarlyStopping counter: 2 out of 5
Updating learning rate to 9.765625e-05
	iters: 100, epoch: 11 | loss: 0.1816219
	speed: 0.0095s/iter; left time: 49.4395s
	iters: 200, epoch: 11 | loss: 0.6154377
	speed: 0.0036s/iter; left time: 18.5424s
	iters: 300, epoch: 11 | loss: 0.4599689
	speed: 0.0033s/iter; left time: 16.1957s
	iters: 400, epoch: 11 | loss: 0.3076840
	speed: 0.0034s/iter; left time: 16.3755s
	iters: 500, epoch: 11 | loss: 0.4469575
	speed: 0.0037s/iter; left time: 17.9151s
Epoch: 11 cost time: 1.9371294975280762
Epoch: 11, Steps: 528 | Train Loss: 0.3686349 Vali Loss: 0.2738849 Test Loss: 0.4818649
EarlyStopping counter: 3 out of 5
Updating learning rate to 4.8828125e-05
	iters: 100, epoch: 12 | loss: 0.2807314
	speed: 0.0084s/iter; left time: 39.2244s
	iters: 200, epoch: 12 | loss: 0.7079397
	speed: 0.0038s/iter; left time: 17.2448s
	iters: 300, epoch: 12 | loss: 0.2875970
	speed: 0.0028s/iter; left time: 12.6837s
	iters: 400, epoch: 12 | loss: 0.2671456
	speed: 0.0032s/iter; left time: 13.8537s
	iters: 500, epoch: 12 | loss: 0.2181927
	speed: 0.0031s/iter; left time: 13.2067s
Epoch: 12 cost time: 1.6808714866638184
Epoch: 12, Steps: 528 | Train Loss: 0.3681442 Vali Loss: 0.3074067 Test Loss: 0.5913429
EarlyStopping counter: 4 out of 5
Updating learning rate to 2.44140625e-05
	iters: 100, epoch: 13 | loss: 0.1656068
	speed: 0.0064s/iter; left time: 26.5139s
	iters: 200, epoch: 13 | loss: 0.2422920
	speed: 0.0026s/iter; left time: 10.3479s
	iters: 300, epoch: 13 | loss: 0.4944054
	speed: 0.0028s/iter; left time: 11.0308s
	iters: 400, epoch: 13 | loss: 0.5849728
	speed: 0.0029s/iter; left time: 11.0127s
	iters: 500, epoch: 13 | loss: 0.5362812
	speed: 0.0027s/iter; left time: 10.1381s
Epoch: 13 cost time: 1.4459664821624756
Epoch: 13, Steps: 528 | Train Loss: 0.3676031 Vali Loss: 0.3074916 Test Loss: 0.5910378
EarlyStopping counter: 5 out of 5
Early stopping
Total training time: 33.7265 seconds
>>>>>>>testing : ETTh2_96_96_DLinear_ETTh2_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed28649<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
data_set:  <data_provider.data_loader.Dataset_ETT_hour object at 0x0000019601AE4860>
mse:0.4584600627422333, mae:0.44390958547592163
