Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='Linear', model_id='ETTm2_336_192', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=192, root_path='./dataset/', save_pred_values=False, seed=15349, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTm2_336_192_Linear_ETTm2_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15349>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34033
val 11329
test 11329
	iters: 100, epoch: 1 | loss: 0.6037256
	speed: 0.0058s/iter; left time: 123.6271s
	iters: 200, epoch: 1 | loss: 0.7137231
	speed: 0.0042s/iter; left time: 89.3052s
	iters: 300, epoch: 1 | loss: 0.3401980
	speed: 0.0050s/iter; left time: 103.7984s
	iters: 400, epoch: 1 | loss: 0.5270739
	speed: 0.0056s/iter; left time: 117.0410s
	iters: 500, epoch: 1 | loss: 0.3995661
	speed: 0.0068s/iter; left time: 141.2186s
	iters: 600, epoch: 1 | loss: 0.3152753
	speed: 0.0057s/iter; left time: 117.3545s
	iters: 700, epoch: 1 | loss: 0.2704242
	speed: 0.0056s/iter; left time: 114.8123s
	iters: 800, epoch: 1 | loss: 0.6133558
	speed: 0.0063s/iter; left time: 129.3632s
	iters: 900, epoch: 1 | loss: 0.5322743
	speed: 0.0062s/iter; left time: 127.1811s
	iters: 1000, epoch: 1 | loss: 0.4131006
	speed: 0.0054s/iter; left time: 110.0656s
Epoch: 1 cost time: 6.018224477767944
Epoch: 1, Steps: 1063 | Train Loss: 0.5147902 Vali Loss: 0.4965650 Test Loss: 1.1377922
Validation loss decreased (inf --> 0.496565).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.2316578
	speed: 0.0225s/iter; left time: 451.7240s
	iters: 200, epoch: 2 | loss: 0.3876270
	speed: 0.0062s/iter; left time: 123.2543s
	iters: 300, epoch: 2 | loss: 0.3982286
	speed: 0.0048s/iter; left time: 95.3224s
	iters: 400, epoch: 2 | loss: 0.4910875
	speed: 0.0053s/iter; left time: 104.5845s
	iters: 500, epoch: 2 | loss: 0.4122770
	speed: 0.0059s/iter; left time: 115.8240s
	iters: 600, epoch: 2 | loss: 0.4901967
	speed: 0.0056s/iter; left time: 109.4280s
	iters: 700, epoch: 2 | loss: 0.5715783
	speed: 0.0052s/iter; left time: 102.3645s
	iters: 800, epoch: 2 | loss: 0.5041285
	speed: 0.0060s/iter; left time: 116.6023s
	iters: 900, epoch: 2 | loss: 0.3215787
	speed: 0.0051s/iter; left time: 99.3845s
	iters: 1000, epoch: 2 | loss: 0.5523536
	speed: 0.0052s/iter; left time: 99.1402s
Epoch: 2 cost time: 5.859910011291504
Epoch: 2, Steps: 1063 | Train Loss: 0.4933177 Vali Loss: 0.7810928 Test Loss: 1.9559287
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.3518030
	speed: 0.0239s/iter; left time: 455.8192s
	iters: 200, epoch: 3 | loss: 0.5424716
	speed: 0.0046s/iter; left time: 87.1330s
	iters: 300, epoch: 3 | loss: 0.2599578
	speed: 0.0060s/iter; left time: 112.8214s
	iters: 400, epoch: 3 | loss: 0.4526071
	speed: 0.0063s/iter; left time: 118.2763s
	iters: 500, epoch: 3 | loss: 0.3860164
	speed: 0.0057s/iter; left time: 105.2977s
	iters: 600, epoch: 3 | loss: 0.3446683
	speed: 0.0055s/iter; left time: 101.2012s
	iters: 700, epoch: 3 | loss: 0.2626836
	speed: 0.0055s/iter; left time: 100.6649s
	iters: 800, epoch: 3 | loss: 0.2822028
	speed: 0.0053s/iter; left time: 96.8094s
	iters: 900, epoch: 3 | loss: 0.3489083
	speed: 0.0052s/iter; left time: 94.1579s
	iters: 1000, epoch: 3 | loss: 0.2439509
	speed: 0.0048s/iter; left time: 86.3265s
Epoch: 3 cost time: 5.691308975219727
Epoch: 3, Steps: 1063 | Train Loss: 0.3513125 Vali Loss: 0.2141778 Test Loss: 0.3635767
Validation loss decreased (0.496565 --> 0.214178).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.2071669
	speed: 0.0242s/iter; left time: 435.4334s
	iters: 200, epoch: 4 | loss: 0.2073520
	speed: 0.0052s/iter; left time: 93.6495s
	iters: 300, epoch: 4 | loss: 0.1688578
	speed: 0.0051s/iter; left time: 90.6883s
	iters: 400, epoch: 4 | loss: 0.3344603
	speed: 0.0052s/iter; left time: 91.1597s
	iters: 500, epoch: 4 | loss: 0.2545507
	speed: 0.0051s/iter; left time: 89.8373s
	iters: 600, epoch: 4 | loss: 0.2181643
	speed: 0.0056s/iter; left time: 98.1930s
	iters: 700, epoch: 4 | loss: 0.2281106
	speed: 0.0059s/iter; left time: 102.0096s
	iters: 800, epoch: 4 | loss: 0.1841319
	speed: 0.0065s/iter; left time: 112.9589s
	iters: 900, epoch: 4 | loss: 0.5622907
	speed: 0.0055s/iter; left time: 94.3239s
	iters: 1000, epoch: 4 | loss: 0.2830816
	speed: 0.0066s/iter; left time: 113.2368s
Epoch: 4 cost time: 6.1042680740356445
Epoch: 4, Steps: 1063 | Train Loss: 0.3117363 Vali Loss: 0.2358838 Test Loss: 0.4602267
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.2748008
	speed: 0.0282s/iter; left time: 477.4381s
	iters: 200, epoch: 5 | loss: 0.2224794
	speed: 0.0058s/iter; left time: 96.6604s
	iters: 300, epoch: 5 | loss: 0.1824901
	speed: 0.0061s/iter; left time: 101.4848s
	iters: 400, epoch: 5 | loss: 0.4078358
	speed: 0.0051s/iter; left time: 84.5501s
	iters: 500, epoch: 5 | loss: 0.5431111
	speed: 0.0043s/iter; left time: 71.5338s
	iters: 600, epoch: 5 | loss: 0.2057892
	speed: 0.0047s/iter; left time: 76.9583s
	iters: 700, epoch: 5 | loss: 0.4143998
	speed: 0.0054s/iter; left time: 88.1199s
	iters: 800, epoch: 5 | loss: 0.2028675
	speed: 0.0057s/iter; left time: 91.9050s
	iters: 900, epoch: 5 | loss: 0.3648401
	speed: 0.0063s/iter; left time: 100.9067s
	iters: 1000, epoch: 5 | loss: 0.2749220
	speed: 0.0055s/iter; left time: 87.5754s
Epoch: 5 cost time: 5.862056255340576
Epoch: 5, Steps: 1063 | Train Loss: 0.2949026 Vali Loss: 0.2272964 Test Loss: 0.4141087
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.5287725
	speed: 0.0261s/iter; left time: 413.9194s
	iters: 200, epoch: 6 | loss: 0.2776167
	speed: 0.0060s/iter; left time: 95.1383s
	iters: 300, epoch: 6 | loss: 0.3164742
	speed: 0.0062s/iter; left time: 96.5134s
	iters: 400, epoch: 6 | loss: 0.2777920
	speed: 0.0061s/iter; left time: 94.7104s
	iters: 500, epoch: 6 | loss: 0.3014886
	speed: 0.0060s/iter; left time: 93.4415s
	iters: 600, epoch: 6 | loss: 0.3472963
	speed: 0.0051s/iter; left time: 78.4476s
	iters: 700, epoch: 6 | loss: 0.4736502
	speed: 0.0052s/iter; left time: 79.8892s
	iters: 800, epoch: 6 | loss: 0.1615338
	speed: 0.0052s/iter; left time: 79.1042s
	iters: 900, epoch: 6 | loss: 0.2455113
	speed: 0.0047s/iter; left time: 70.8665s
	iters: 1000, epoch: 6 | loss: 0.2318095
	speed: 0.0051s/iter; left time: 76.1303s
Epoch: 6 cost time: 5.868556261062622
Epoch: 6, Steps: 1063 | Train Loss: 0.2858978 Vali Loss: 0.1948241 Test Loss: 0.3226422
Validation loss decreased (0.214178 --> 0.194824).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.3155391
	speed: 0.0215s/iter; left time: 318.0757s
	iters: 200, epoch: 7 | loss: 0.1964149
	speed: 0.0058s/iter; left time: 85.3617s
	iters: 300, epoch: 7 | loss: 0.2369276
	speed: 0.0056s/iter; left time: 81.9565s
	iters: 400, epoch: 7 | loss: 0.3730608
	speed: 0.0050s/iter; left time: 71.7303s
	iters: 500, epoch: 7 | loss: 0.2398889
	speed: 0.0055s/iter; left time: 79.2595s
	iters: 600, epoch: 7 | loss: 0.1521604
	speed: 0.0060s/iter; left time: 85.1742s
	iters: 700, epoch: 7 | loss: 0.2365772
	speed: 0.0061s/iter; left time: 85.8191s
	iters: 800, epoch: 7 | loss: 0.2700795
	speed: 0.0063s/iter; left time: 89.1920s
	iters: 900, epoch: 7 | loss: 0.3541323
	speed: 0.0055s/iter; left time: 77.2269s
	iters: 1000, epoch: 7 | loss: 0.6850594
	speed: 0.0054s/iter; left time: 74.6223s
Epoch: 7 cost time: 6.038502216339111
Epoch: 7, Steps: 1063 | Train Loss: 0.2813922 Vali Loss: 0.2555366 Test Loss: 0.5186127
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.2188255
	speed: 0.0235s/iter; left time: 322.4023s
	iters: 200, epoch: 8 | loss: 0.1689090
	speed: 0.0050s/iter; left time: 67.9641s
	iters: 300, epoch: 8 | loss: 0.2265804
	speed: 0.0053s/iter; left time: 71.5492s
	iters: 400, epoch: 8 | loss: 0.3002452
	speed: 0.0056s/iter; left time: 75.6954s
	iters: 500, epoch: 8 | loss: 0.3471931
	speed: 0.0053s/iter; left time: 71.1568s
	iters: 600, epoch: 8 | loss: 0.2118582
	speed: 0.0056s/iter; left time: 74.0320s
	iters: 700, epoch: 8 | loss: 0.3706422
	speed: 0.0054s/iter; left time: 70.3292s
	iters: 800, epoch: 8 | loss: 0.1748170
	speed: 0.0062s/iter; left time: 80.0730s
	iters: 900, epoch: 8 | loss: 0.2828562
	speed: 0.0056s/iter; left time: 72.6535s
	iters: 1000, epoch: 8 | loss: 0.2501415
	speed: 0.0067s/iter; left time: 85.9207s
Epoch: 8 cost time: 5.87840723991394
Epoch: 8, Steps: 1063 | Train Loss: 0.2775523 Vali Loss: 0.1885067 Test Loss: 0.3168167
Validation loss decreased (0.194824 --> 0.188507).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.1731589
	speed: 0.0227s/iter; left time: 287.1206s
	iters: 200, epoch: 9 | loss: 0.2063053
	speed: 0.0052s/iter; left time: 65.7897s
	iters: 300, epoch: 9 | loss: 0.2792136
	speed: 0.0051s/iter; left time: 63.1848s
	iters: 400, epoch: 9 | loss: 0.1334763
	speed: 0.0052s/iter; left time: 64.2472s
	iters: 500, epoch: 9 | loss: 0.2246452
	speed: 0.0053s/iter; left time: 64.9893s
	iters: 600, epoch: 9 | loss: 0.1889411
	speed: 0.0054s/iter; left time: 65.3292s
	iters: 700, epoch: 9 | loss: 0.1726434
	speed: 0.0053s/iter; left time: 63.5400s
	iters: 800, epoch: 9 | loss: 0.1527831
	speed: 0.0048s/iter; left time: 57.1876s
	iters: 900, epoch: 9 | loss: 0.2327340
	speed: 0.0061s/iter; left time: 72.3275s
	iters: 1000, epoch: 9 | loss: 0.1800632
	speed: 0.0061s/iter; left time: 71.9770s
Epoch: 9 cost time: 5.744479656219482
Epoch: 9, Steps: 1063 | Train Loss: 0.2760174 Vali Loss: 0.2201364 Test Loss: 0.4074116
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.1911800
	speed: 0.0227s/iter; left time: 263.3683s
	iters: 200, epoch: 10 | loss: 0.2709538
	speed: 0.0050s/iter; left time: 57.8408s
	iters: 300, epoch: 10 | loss: 0.2337754
	speed: 0.0064s/iter; left time: 72.7008s
	iters: 400, epoch: 10 | loss: 0.4344127
	speed: 0.0066s/iter; left time: 75.0150s
	iters: 500, epoch: 10 | loss: 0.2340929
	speed: 0.0068s/iter; left time: 76.2337s
	iters: 600, epoch: 10 | loss: 0.2479251
	speed: 0.0056s/iter; left time: 61.9477s
	iters: 700, epoch: 10 | loss: 0.1650444
	speed: 0.0057s/iter; left time: 62.6969s
	iters: 800, epoch: 10 | loss: 0.3306706
	speed: 0.0056s/iter; left time: 60.8974s
	iters: 900, epoch: 10 | loss: 0.1769079
	speed: 0.0054s/iter; left time: 58.5302s
	iters: 1000, epoch: 10 | loss: 0.2967008
	speed: 0.0052s/iter; left time: 55.7159s
Epoch: 10 cost time: 6.184100389480591
Epoch: 10, Steps: 1063 | Train Loss: 0.2751459 Vali Loss: 0.1944412 Test Loss: 0.3351148
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.2671426
	speed: 0.0229s/iter; left time: 241.0093s
	iters: 200, epoch: 11 | loss: 0.2269946
	speed: 0.0059s/iter; left time: 61.3684s
	iters: 300, epoch: 11 | loss: 0.2845889
	speed: 0.0056s/iter; left time: 57.6694s
	iters: 400, epoch: 11 | loss: 0.1952473
	speed: 0.0037s/iter; left time: 38.2685s
	iters: 500, epoch: 11 | loss: 0.1401490
	speed: 0.0055s/iter; left time: 55.2441s
	iters: 600, epoch: 11 | loss: 0.2000986
	speed: 0.0054s/iter; left time: 54.5756s
	iters: 700, epoch: 11 | loss: 0.1950855
	speed: 0.0058s/iter; left time: 57.9151s
	iters: 800, epoch: 11 | loss: 0.3869936
	speed: 0.0050s/iter; left time: 48.8601s
	iters: 900, epoch: 11 | loss: 0.1606009
	speed: 0.0058s/iter; left time: 56.4455s
	iters: 1000, epoch: 11 | loss: 0.1437578
	speed: 0.0055s/iter; left time: 53.2591s
Epoch: 11 cost time: 5.732734680175781
Epoch: 11, Steps: 1063 | Train Loss: 0.2745133 Vali Loss: 0.2057725 Test Loss: 0.3697018
EarlyStopping counter: 3 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.4448219
	speed: 0.0226s/iter; left time: 213.6849s
	iters: 200, epoch: 12 | loss: 0.2073253
	speed: 0.0054s/iter; left time: 50.9618s
	iters: 300, epoch: 12 | loss: 0.2093115
	speed: 0.0054s/iter; left time: 50.1640s
	iters: 400, epoch: 12 | loss: 0.2067404
	speed: 0.0053s/iter; left time: 48.6820s
	iters: 500, epoch: 12 | loss: 0.2366125
	speed: 0.0054s/iter; left time: 49.2539s
	iters: 600, epoch: 12 | loss: 0.1760634
	speed: 0.0058s/iter; left time: 52.1780s
	iters: 700, epoch: 12 | loss: 0.2111148
	speed: 0.0054s/iter; left time: 48.1827s
	iters: 800, epoch: 12 | loss: 0.2382816
	speed: 0.0049s/iter; left time: 42.9657s
	iters: 900, epoch: 12 | loss: 0.3859970
	speed: 0.0053s/iter; left time: 45.7706s
	iters: 1000, epoch: 12 | loss: 0.7225548
	speed: 0.0052s/iter; left time: 44.8963s
Epoch: 12 cost time: 5.673117637634277
Epoch: 12, Steps: 1063 | Train Loss: 0.2743993 Vali Loss: 0.1922794 Test Loss: 0.3273400
EarlyStopping counter: 4 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.3267545
	speed: 0.0200s/iter; left time: 167.8036s
	iters: 200, epoch: 13 | loss: 0.3476020
	speed: 0.0048s/iter; left time: 39.6311s
	iters: 300, epoch: 13 | loss: 0.1681789
	speed: 0.0049s/iter; left time: 40.5353s
	iters: 400, epoch: 13 | loss: 0.4895335
	speed: 0.0048s/iter; left time: 38.5288s
	iters: 500, epoch: 13 | loss: 0.1852949
	speed: 0.0045s/iter; left time: 36.3427s
	iters: 600, epoch: 13 | loss: 0.2497904
	speed: 0.0045s/iter; left time: 35.6950s
	iters: 700, epoch: 13 | loss: 0.2028481
	speed: 0.0045s/iter; left time: 35.0445s
	iters: 800, epoch: 13 | loss: 0.1990856
	speed: 0.0048s/iter; left time: 37.3159s
	iters: 900, epoch: 13 | loss: 0.2934406
	speed: 0.0045s/iter; left time: 34.4539s
	iters: 1000, epoch: 13 | loss: 0.2008944
	speed: 0.0045s/iter; left time: 33.4975s
Epoch: 13 cost time: 4.968834638595581
Epoch: 13, Steps: 1063 | Train Loss: 0.2742023 Vali Loss: 0.1968700 Test Loss: 0.3417853
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTm2_336_192_Linear_ETTm2_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15349<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
mse:0.317492812871933, mae:0.3646910488605499
