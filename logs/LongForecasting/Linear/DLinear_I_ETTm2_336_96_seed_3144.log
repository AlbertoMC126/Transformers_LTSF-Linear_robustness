Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='DLinear', model_id='ETTm2_336_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=3144, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTm2_336_96_DLinear_ETTm2_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3144>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34129
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.3516712
	speed: 0.0079s/iter; left time: 167.4704s
	iters: 200, epoch: 1 | loss: 0.2673496
	speed: 0.0078s/iter; left time: 165.6466s
	iters: 300, epoch: 1 | loss: 0.6838086
	speed: 0.0073s/iter; left time: 153.0752s
	iters: 400, epoch: 1 | loss: 0.9086068
	speed: 0.0086s/iter; left time: 179.7886s
	iters: 500, epoch: 1 | loss: 0.4117154
	speed: 0.0096s/iter; left time: 199.9337s
	iters: 600, epoch: 1 | loss: 0.4768507
	speed: 0.0086s/iter; left time: 177.7863s
	iters: 700, epoch: 1 | loss: 0.5867499
	speed: 0.0089s/iter; left time: 182.9670s
	iters: 800, epoch: 1 | loss: 0.4938712
	speed: 0.0093s/iter; left time: 190.2818s
	iters: 900, epoch: 1 | loss: 0.2184436
	speed: 0.0077s/iter; left time: 157.9250s
	iters: 1000, epoch: 1 | loss: 0.2618498
	speed: 0.0082s/iter; left time: 167.0878s
Epoch: 1 cost time: 8.855396747589111
Epoch: 1, Steps: 1066 | Train Loss: 0.4639992 Vali Loss: 0.3464119 Test Loss: 0.6182228
Validation loss decreased (inf --> 0.346412).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.2942789
	speed: 0.0360s/iter; left time: 725.3329s
	iters: 200, epoch: 2 | loss: 0.7880320
	speed: 0.0074s/iter; left time: 148.2515s
	iters: 300, epoch: 2 | loss: 0.6189214
	speed: 0.0071s/iter; left time: 141.3335s
	iters: 400, epoch: 2 | loss: 0.7015643
	speed: 0.0081s/iter; left time: 160.1086s
	iters: 500, epoch: 2 | loss: 0.4528729
	speed: 0.0088s/iter; left time: 173.5010s
	iters: 600, epoch: 2 | loss: 0.3165407
	speed: 0.0071s/iter; left time: 139.5505s
	iters: 700, epoch: 2 | loss: 0.5199262
	speed: 0.0076s/iter; left time: 149.4598s
	iters: 800, epoch: 2 | loss: 0.2626897
	speed: 0.0072s/iter; left time: 140.7201s
	iters: 900, epoch: 2 | loss: 0.5637126
	speed: 0.0088s/iter; left time: 170.3706s
	iters: 1000, epoch: 2 | loss: 0.6053900
	speed: 0.0084s/iter; left time: 162.0414s
Epoch: 2 cost time: 8.381778955459595
Epoch: 2, Steps: 1066 | Train Loss: 0.4408384 Vali Loss: 1.5619026 Test Loss: 4.3937154
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.2323139
	speed: 0.0345s/iter; left time: 659.4867s
	iters: 200, epoch: 3 | loss: 0.1922245
	speed: 0.0086s/iter; left time: 163.5536s
	iters: 300, epoch: 3 | loss: 0.2686636
	speed: 0.0090s/iter; left time: 169.6463s
	iters: 400, epoch: 3 | loss: 0.2781303
	speed: 0.0085s/iter; left time: 159.1964s
	iters: 500, epoch: 3 | loss: 0.1873543
	speed: 0.0091s/iter; left time: 169.1457s
	iters: 600, epoch: 3 | loss: 0.1988762
	speed: 0.0092s/iter; left time: 170.5002s
	iters: 700, epoch: 3 | loss: 0.1300112
	speed: 0.0087s/iter; left time: 161.4644s
	iters: 800, epoch: 3 | loss: 0.1790000
	speed: 0.0082s/iter; left time: 151.1854s
	iters: 900, epoch: 3 | loss: 0.2578922
	speed: 0.0089s/iter; left time: 162.6229s
	iters: 1000, epoch: 3 | loss: 0.2116397
	speed: 0.0081s/iter; left time: 147.1908s
Epoch: 3 cost time: 9.25011134147644
Epoch: 3, Steps: 1066 | Train Loss: 0.2756702 Vali Loss: 0.1899780 Test Loss: 0.3494829
Validation loss decreased (0.346412 --> 0.189978).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.2760157
	speed: 0.0399s/iter; left time: 719.2771s
	iters: 200, epoch: 4 | loss: 0.4533976
	speed: 0.0074s/iter; left time: 132.1539s
	iters: 300, epoch: 4 | loss: 0.1836037
	speed: 0.0075s/iter; left time: 133.1459s
	iters: 400, epoch: 4 | loss: 0.2720346
	speed: 0.0078s/iter; left time: 138.1369s
	iters: 500, epoch: 4 | loss: 0.2210564
	speed: 0.0079s/iter; left time: 139.7925s
	iters: 600, epoch: 4 | loss: 0.2136447
	speed: 0.0082s/iter; left time: 144.4298s
	iters: 700, epoch: 4 | loss: 0.2008394
	speed: 0.0083s/iter; left time: 143.7398s
	iters: 800, epoch: 4 | loss: 0.2163839
	speed: 0.0084s/iter; left time: 145.5192s
	iters: 900, epoch: 4 | loss: 0.1801501
	speed: 0.0082s/iter; left time: 141.7026s
	iters: 1000, epoch: 4 | loss: 0.3344371
	speed: 0.0083s/iter; left time: 141.6390s
Epoch: 4 cost time: 8.639651536941528
Epoch: 4, Steps: 1066 | Train Loss: 0.2379678 Vali Loss: 0.2042632 Test Loss: 0.3768205
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.1365387
	speed: 0.0344s/iter; left time: 582.7472s
	iters: 200, epoch: 5 | loss: 0.1393314
	speed: 0.0089s/iter; left time: 149.5470s
	iters: 300, epoch: 5 | loss: 0.1271125
	speed: 0.0095s/iter; left time: 159.0637s
	iters: 400, epoch: 5 | loss: 0.2068510
	speed: 0.0087s/iter; left time: 144.4637s
	iters: 500, epoch: 5 | loss: 0.2179818
	speed: 0.0087s/iter; left time: 144.5903s
	iters: 600, epoch: 5 | loss: 0.2320251
	speed: 0.0090s/iter; left time: 148.1361s
	iters: 700, epoch: 5 | loss: 0.2654275
	speed: 0.0073s/iter; left time: 118.6339s
	iters: 800, epoch: 5 | loss: 0.2088903
	speed: 0.0070s/iter; left time: 114.1309s
	iters: 900, epoch: 5 | loss: 0.1976503
	speed: 0.0084s/iter; left time: 135.2889s
	iters: 1000, epoch: 5 | loss: 0.2280149
	speed: 0.0083s/iter; left time: 133.4816s
Epoch: 5 cost time: 8.902157306671143
Epoch: 5, Steps: 1066 | Train Loss: 0.2199453 Vali Loss: 0.1464059 Test Loss: 0.2497990
Validation loss decreased (0.189978 --> 0.146406).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.2632302
	speed: 0.0321s/iter; left time: 510.0763s
	iters: 200, epoch: 6 | loss: 0.3278441
	speed: 0.0075s/iter; left time: 118.1483s
	iters: 300, epoch: 6 | loss: 0.1433159
	speed: 0.0079s/iter; left time: 123.5258s
	iters: 400, epoch: 6 | loss: 0.1399755
	speed: 0.0080s/iter; left time: 124.1506s
	iters: 500, epoch: 6 | loss: 0.2044795
	speed: 0.0077s/iter; left time: 119.4077s
	iters: 600, epoch: 6 | loss: 0.1802557
	speed: 0.0075s/iter; left time: 115.7653s
	iters: 700, epoch: 6 | loss: 0.2132841
	speed: 0.0076s/iter; left time: 115.8070s
	iters: 800, epoch: 6 | loss: 0.3184392
	speed: 0.0091s/iter; left time: 138.5770s
	iters: 900, epoch: 6 | loss: 0.1616895
	speed: 0.0077s/iter; left time: 115.8989s
	iters: 1000, epoch: 6 | loss: 0.1198311
	speed: 0.0080s/iter; left time: 119.3891s
Epoch: 6 cost time: 8.436407804489136
Epoch: 6, Steps: 1066 | Train Loss: 0.2104725 Vali Loss: 0.1389285 Test Loss: 0.2306743
Validation loss decreased (0.146406 --> 0.138929).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.1201461
	speed: 0.0392s/iter; left time: 580.7319s
	iters: 200, epoch: 7 | loss: 0.1728643
	speed: 0.0081s/iter; left time: 118.5733s
	iters: 300, epoch: 7 | loss: 0.2143852
	speed: 0.0077s/iter; left time: 112.3672s
	iters: 400, epoch: 7 | loss: 0.1816943
	speed: 0.0082s/iter; left time: 118.4197s
	iters: 500, epoch: 7 | loss: 0.1150965
	speed: 0.0083s/iter; left time: 120.0165s
	iters: 600, epoch: 7 | loss: 0.2626716
	speed: 0.0084s/iter; left time: 120.3793s
	iters: 700, epoch: 7 | loss: 0.1206012
	speed: 0.0087s/iter; left time: 124.0702s
	iters: 800, epoch: 7 | loss: 0.1729628
	speed: 0.0087s/iter; left time: 122.8974s
	iters: 900, epoch: 7 | loss: 0.1086910
	speed: 0.0084s/iter; left time: 118.2643s
	iters: 1000, epoch: 7 | loss: 0.1024949
	speed: 0.0083s/iter; left time: 116.1859s
Epoch: 7 cost time: 8.9163076877594
Epoch: 7, Steps: 1066 | Train Loss: 0.2050140 Vali Loss: 0.1551667 Test Loss: 0.2670428
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.1061199
	speed: 0.0349s/iter; left time: 480.0081s
	iters: 200, epoch: 8 | loss: 0.1140415
	speed: 0.0071s/iter; left time: 97.5659s
	iters: 300, epoch: 8 | loss: 0.2735536
	speed: 0.0078s/iter; left time: 105.5777s
	iters: 400, epoch: 8 | loss: 0.1322740
	speed: 0.0067s/iter; left time: 90.6538s
	iters: 500, epoch: 8 | loss: 0.1206053
	speed: 0.0082s/iter; left time: 109.3115s
	iters: 600, epoch: 8 | loss: 0.1177177
	speed: 0.0074s/iter; left time: 97.7448s
	iters: 700, epoch: 8 | loss: 0.1858292
	speed: 0.0076s/iter; left time: 99.9227s
	iters: 800, epoch: 8 | loss: 0.1914378
	speed: 0.0086s/iter; left time: 112.0278s
	iters: 900, epoch: 8 | loss: 0.1543172
	speed: 0.0076s/iter; left time: 98.2560s
	iters: 1000, epoch: 8 | loss: 0.2331743
	speed: 0.0085s/iter; left time: 109.4412s
Epoch: 8 cost time: 8.24685549736023
Epoch: 8, Steps: 1066 | Train Loss: 0.2021993 Vali Loss: 0.1269756 Test Loss: 0.1937449
Validation loss decreased (0.138929 --> 0.126976).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.1577384
	speed: 0.0348s/iter; left time: 441.8258s
	iters: 200, epoch: 9 | loss: 0.1657694
	speed: 0.0079s/iter; left time: 99.9950s
	iters: 300, epoch: 9 | loss: 0.1407634
	speed: 0.0078s/iter; left time: 97.2175s
	iters: 400, epoch: 9 | loss: 0.2405877
	speed: 0.0079s/iter; left time: 97.3038s
	iters: 500, epoch: 9 | loss: 0.2623870
	speed: 0.0082s/iter; left time: 100.8345s
	iters: 600, epoch: 9 | loss: 0.1141784
	speed: 0.0087s/iter; left time: 106.2265s
	iters: 700, epoch: 9 | loss: 0.3433192
	speed: 0.0094s/iter; left time: 113.9581s
	iters: 800, epoch: 9 | loss: 0.1826052
	speed: 0.0096s/iter; left time: 115.5226s
	iters: 900, epoch: 9 | loss: 0.1077447
	speed: 0.0093s/iter; left time: 110.3467s
	iters: 1000, epoch: 9 | loss: 0.1239519
	speed: 0.0096s/iter; left time: 113.7154s
Epoch: 9 cost time: 9.292970418930054
Epoch: 9, Steps: 1066 | Train Loss: 0.2005582 Vali Loss: 0.1265088 Test Loss: 0.1931107
Validation loss decreased (0.126976 --> 0.126509).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.3427491
	speed: 0.0389s/iter; left time: 451.8040s
	iters: 200, epoch: 10 | loss: 0.4336118
	speed: 0.0090s/iter; left time: 103.3015s
	iters: 300, epoch: 10 | loss: 0.2652159
	speed: 0.0080s/iter; left time: 91.3234s
	iters: 400, epoch: 10 | loss: 0.2012997
	speed: 0.0085s/iter; left time: 96.3193s
	iters: 500, epoch: 10 | loss: 0.1608563
	speed: 0.0069s/iter; left time: 77.7117s
	iters: 600, epoch: 10 | loss: 0.2116707
	speed: 0.0086s/iter; left time: 95.7863s
	iters: 700, epoch: 10 | loss: 0.1787972
	speed: 0.0090s/iter; left time: 98.9190s
	iters: 800, epoch: 10 | loss: 0.3951396
	speed: 0.0089s/iter; left time: 97.1667s
	iters: 900, epoch: 10 | loss: 0.1418438
	speed: 0.0085s/iter; left time: 92.1608s
	iters: 1000, epoch: 10 | loss: 0.2267372
	speed: 0.0081s/iter; left time: 87.1410s
Epoch: 10 cost time: 8.889859914779663
Epoch: 10, Steps: 1066 | Train Loss: 0.1995292 Vali Loss: 0.1348572 Test Loss: 0.2170567
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.0979239
	speed: 0.0326s/iter; left time: 344.6621s
	iters: 200, epoch: 11 | loss: 0.1290039
	speed: 0.0071s/iter; left time: 74.3993s
	iters: 300, epoch: 11 | loss: 0.1339770
	speed: 0.0086s/iter; left time: 88.9287s
	iters: 400, epoch: 11 | loss: 0.1391235
	speed: 0.0075s/iter; left time: 77.1533s
	iters: 500, epoch: 11 | loss: 0.1231842
	speed: 0.0072s/iter; left time: 72.8761s
	iters: 600, epoch: 11 | loss: 0.1107963
	speed: 0.0085s/iter; left time: 85.5231s
	iters: 700, epoch: 11 | loss: 0.2252675
	speed: 0.0081s/iter; left time: 80.7059s
	iters: 800, epoch: 11 | loss: 0.1735112
	speed: 0.0089s/iter; left time: 88.1934s
	iters: 900, epoch: 11 | loss: 0.4685187
	speed: 0.0062s/iter; left time: 60.3230s
	iters: 1000, epoch: 11 | loss: 0.2954243
	speed: 0.0070s/iter; left time: 67.9419s
Epoch: 11 cost time: 8.103944778442383
Epoch: 11, Steps: 1066 | Train Loss: 0.1991040 Vali Loss: 0.1268038 Test Loss: 0.1956149
EarlyStopping counter: 2 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.1650400
	speed: 0.0367s/iter; left time: 348.0038s
	iters: 200, epoch: 12 | loss: 0.2108837
	speed: 0.0080s/iter; left time: 75.3657s
	iters: 300, epoch: 12 | loss: 0.1241675
	speed: 0.0086s/iter; left time: 79.6428s
	iters: 400, epoch: 12 | loss: 0.2970026
	speed: 0.0074s/iter; left time: 68.3357s
	iters: 500, epoch: 12 | loss: 0.1254636
	speed: 0.0075s/iter; left time: 68.4045s
	iters: 600, epoch: 12 | loss: 0.1055437
	speed: 0.0069s/iter; left time: 61.9986s
	iters: 700, epoch: 12 | loss: 0.1876346
	speed: 0.0071s/iter; left time: 63.4085s
	iters: 800, epoch: 12 | loss: 0.1864234
	speed: 0.0083s/iter; left time: 72.6802s
	iters: 900, epoch: 12 | loss: 0.1629969
	speed: 0.0084s/iter; left time: 72.7144s
	iters: 1000, epoch: 12 | loss: 0.1962573
	speed: 0.0074s/iter; left time: 63.7955s
Epoch: 12 cost time: 8.388791799545288
Epoch: 12, Steps: 1066 | Train Loss: 0.1988700 Vali Loss: 0.1296775 Test Loss: 0.2043433
EarlyStopping counter: 3 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.2447462
	speed: 0.0375s/iter; left time: 316.4830s
	iters: 200, epoch: 13 | loss: 0.1644355
	speed: 0.0072s/iter; left time: 59.5672s
	iters: 300, epoch: 13 | loss: 0.2592174
	speed: 0.0076s/iter; left time: 62.5574s
	iters: 400, epoch: 13 | loss: 0.2603538
	speed: 0.0083s/iter; left time: 67.2531s
	iters: 500, epoch: 13 | loss: 0.1398228
	speed: 0.0084s/iter; left time: 67.2083s
	iters: 600, epoch: 13 | loss: 0.1687450
	speed: 0.0084s/iter; left time: 66.2864s
	iters: 700, epoch: 13 | loss: 0.2210739
	speed: 0.0092s/iter; left time: 72.0568s
	iters: 800, epoch: 13 | loss: 0.1588221
	speed: 0.0093s/iter; left time: 72.0643s
	iters: 900, epoch: 13 | loss: 0.1704383
	speed: 0.0093s/iter; left time: 70.8206s
	iters: 1000, epoch: 13 | loss: 0.1174372
	speed: 0.0093s/iter; left time: 69.8067s
Epoch: 13 cost time: 9.060367822647095
Epoch: 13, Steps: 1066 | Train Loss: 0.1987360 Vali Loss: 0.1286527 Test Loss: 0.2002964
EarlyStopping counter: 4 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 14 | loss: 0.4743573
	speed: 0.0391s/iter; left time: 287.7839s
	iters: 200, epoch: 14 | loss: 0.1169181
	speed: 0.0083s/iter; left time: 60.3081s
	iters: 300, epoch: 14 | loss: 0.3352450
	speed: 0.0092s/iter; left time: 65.7071s
	iters: 400, epoch: 14 | loss: 0.2598934
	speed: 0.0076s/iter; left time: 53.5232s
	iters: 500, epoch: 14 | loss: 0.1598729
	speed: 0.0079s/iter; left time: 54.7291s
	iters: 600, epoch: 14 | loss: 0.1283733
	speed: 0.0074s/iter; left time: 50.9473s
	iters: 700, epoch: 14 | loss: 0.1416006
	speed: 0.0074s/iter; left time: 50.3328s
	iters: 800, epoch: 14 | loss: 0.2805483
	speed: 0.0072s/iter; left time: 47.9931s
	iters: 900, epoch: 14 | loss: 0.1565001
	speed: 0.0080s/iter; left time: 52.6265s
	iters: 1000, epoch: 14 | loss: 0.2017485
	speed: 0.0079s/iter; left time: 50.7477s
Epoch: 14 cost time: 8.333777904510498
Epoch: 14, Steps: 1066 | Train Loss: 0.1985666 Vali Loss: 0.1300287 Test Loss: 0.2042037
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTm2_336_96_DLinear_ETTm2_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3144<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.1935054212808609, mae:0.28254497051239014
