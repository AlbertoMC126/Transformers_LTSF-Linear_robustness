Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='NLinear', model_id='traffic_336_720', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=720, root_path='./dataset/', save_pred_values=False, seed=10458, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_336_720_NLinear_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed10458>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11225
val 1037
test 2789
	iters: 100, epoch: 1 | loss: 0.7314682
	speed: 0.9076s/iter; left time: 12634.1263s
	iters: 200, epoch: 1 | loss: 1.1206510
	speed: 0.8608s/iter; left time: 11897.3423s
	iters: 300, epoch: 1 | loss: 1.1626806
	speed: 0.9066s/iter; left time: 12438.9088s
	iters: 400, epoch: 1 | loss: 0.8092662
	speed: 0.9366s/iter; left time: 12757.3376s
	iters: 500, epoch: 1 | loss: 1.0546817
	speed: 0.8824s/iter; left time: 11931.0907s
	iters: 600, epoch: 1 | loss: 1.0839626
	speed: 0.9252s/iter; left time: 12417.4107s
	iters: 700, epoch: 1 | loss: 1.0124034
	speed: 0.9147s/iter; left time: 12184.4120s
Epoch: 1 cost time: 634.8811221122742
Epoch: 1, Steps: 701 | Train Loss: 1.1055512 Vali Loss: 1.2936981 Test Loss: 1.4810700
Validation loss decreased (inf --> 1.293698).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.8125265
	speed: 1.4310s/iter; left time: 18917.3424s
	iters: 200, epoch: 2 | loss: 0.7363948
	speed: 0.8986s/iter; left time: 11789.8559s
	iters: 300, epoch: 2 | loss: 0.7749822
	speed: 0.9447s/iter; left time: 12299.6786s
	iters: 400, epoch: 2 | loss: 0.8780339
	speed: 0.9214s/iter; left time: 11905.1324s
	iters: 500, epoch: 2 | loss: 1.4720709
	speed: 0.9203s/iter; left time: 11798.0366s
	iters: 600, epoch: 2 | loss: 0.9298934
	speed: 0.9450s/iter; left time: 12020.0923s
	iters: 700, epoch: 2 | loss: 1.0108186
	speed: 0.9360s/iter; left time: 11812.0944s
Epoch: 2 cost time: 646.2924966812134
Epoch: 2, Steps: 701 | Train Loss: 1.0607124 Vali Loss: 1.9995694 Test Loss: 2.0549207
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.3818503
	speed: 1.4571s/iter; left time: 18241.3088s
	iters: 200, epoch: 3 | loss: 0.3458025
	speed: 0.8894s/iter; left time: 11045.1966s
	iters: 300, epoch: 3 | loss: 0.3694266
	speed: 0.9079s/iter; left time: 11184.3770s
	iters: 400, epoch: 3 | loss: 0.6432506
	speed: 0.9103s/iter; left time: 11122.7535s
	iters: 500, epoch: 3 | loss: 0.3940500
	speed: 0.9069s/iter; left time: 10991.2799s
	iters: 600, epoch: 3 | loss: 0.4357679
	speed: 0.5234s/iter; left time: 6290.3580s
	iters: 700, epoch: 3 | loss: 0.4174787
	speed: 0.3354s/iter; left time: 3997.6482s
Epoch: 3 cost time: 537.400759935379
Epoch: 3, Steps: 701 | Train Loss: 0.4086964 Vali Loss: 0.5783945 Test Loss: 0.6880116
Validation loss decreased (1.293698 --> 0.578395).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.2944819
	speed: 0.6279s/iter; left time: 7420.4257s
	iters: 200, epoch: 4 | loss: 0.3218017
	speed: 0.3367s/iter; left time: 3945.3958s
	iters: 300, epoch: 4 | loss: 0.3316640
	speed: 0.3360s/iter; left time: 3903.1251s
	iters: 400, epoch: 4 | loss: 0.3398192
	speed: 0.3357s/iter; left time: 3866.5200s
	iters: 500, epoch: 4 | loss: 0.3343502
	speed: 0.3340s/iter; left time: 3813.6104s
	iters: 600, epoch: 4 | loss: 0.3153019
	speed: 0.3337s/iter; left time: 3776.4604s
	iters: 700, epoch: 4 | loss: 0.3517299
	speed: 0.3333s/iter; left time: 3739.2743s
Epoch: 4 cost time: 235.10589289665222
Epoch: 4, Steps: 701 | Train Loss: 0.3194761 Vali Loss: 0.4731427 Test Loss: 0.5533654
Validation loss decreased (0.578395 --> 0.473143).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.2949030
	speed: 0.6263s/iter; left time: 6962.1139s
	iters: 200, epoch: 5 | loss: 0.3081763
	speed: 0.3380s/iter; left time: 3723.5830s
	iters: 300, epoch: 5 | loss: 0.2768615
	speed: 0.3355s/iter; left time: 3663.0974s
	iters: 400, epoch: 5 | loss: 0.2803549
	speed: 0.3339s/iter; left time: 3612.1864s
	iters: 500, epoch: 5 | loss: 0.3124325
	speed: 0.3349s/iter; left time: 3589.0565s
	iters: 600, epoch: 5 | loss: 0.2830208
	speed: 0.3312s/iter; left time: 3515.9264s
	iters: 700, epoch: 5 | loss: 0.2969728
	speed: 0.3318s/iter; left time: 3489.6126s
Epoch: 5 cost time: 234.64331102371216
Epoch: 5, Steps: 701 | Train Loss: 0.2969775 Vali Loss: 0.4350779 Test Loss: 0.5103441
Validation loss decreased (0.473143 --> 0.435078).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.2614269
	speed: 0.6209s/iter; left time: 6467.1578s
	iters: 200, epoch: 6 | loss: 0.2753770
	speed: 0.3338s/iter; left time: 3443.8140s
	iters: 300, epoch: 6 | loss: 0.2948743
	speed: 0.3316s/iter; left time: 3388.1009s
	iters: 400, epoch: 6 | loss: 0.3066100
	speed: 0.3306s/iter; left time: 3344.3074s
	iters: 500, epoch: 6 | loss: 0.2878564
	speed: 0.3328s/iter; left time: 3332.9942s
	iters: 600, epoch: 6 | loss: 0.2668876
	speed: 0.3310s/iter; left time: 3282.5218s
	iters: 700, epoch: 6 | loss: 0.3072912
	speed: 0.3322s/iter; left time: 3260.9220s
Epoch: 6 cost time: 232.81062173843384
Epoch: 6, Steps: 701 | Train Loss: 0.2860041 Vali Loss: 0.4213322 Test Loss: 0.4918351
Validation loss decreased (0.435078 --> 0.421332).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.2848024
	speed: 0.6257s/iter; left time: 6078.2672s
	iters: 200, epoch: 7 | loss: 0.2937532
	speed: 0.3349s/iter; left time: 3219.6363s
	iters: 300, epoch: 7 | loss: 0.2772109
	speed: 0.3333s/iter; left time: 3170.9731s
	iters: 400, epoch: 7 | loss: 0.2647237
	speed: 0.3334s/iter; left time: 3139.1123s
	iters: 500, epoch: 7 | loss: 0.2966417
	speed: 0.3311s/iter; left time: 3083.8988s
	iters: 600, epoch: 7 | loss: 0.2723121
	speed: 0.3315s/iter; left time: 3055.0216s
	iters: 700, epoch: 7 | loss: 0.2614474
	speed: 0.3317s/iter; left time: 3023.5606s
Epoch: 7 cost time: 233.5521764755249
Epoch: 7, Steps: 701 | Train Loss: 0.2802514 Vali Loss: 0.4141932 Test Loss: 0.4864348
Validation loss decreased (0.421332 --> 0.414193).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.2837802
	speed: 0.6225s/iter; left time: 5611.0690s
	iters: 200, epoch: 8 | loss: 0.2644784
	speed: 0.3338s/iter; left time: 2975.6095s
	iters: 300, epoch: 8 | loss: 0.2705646
	speed: 0.3328s/iter; left time: 2933.3320s
	iters: 400, epoch: 8 | loss: 0.2735355
	speed: 0.3333s/iter; left time: 2904.0423s
	iters: 500, epoch: 8 | loss: 0.2914866
	speed: 0.3332s/iter; left time: 2869.9646s
	iters: 600, epoch: 8 | loss: 0.2744747
	speed: 0.3306s/iter; left time: 2814.8705s
	iters: 700, epoch: 8 | loss: 0.3087610
	speed: 0.3324s/iter; left time: 2796.5299s
Epoch: 8 cost time: 233.25667548179626
Epoch: 8, Steps: 701 | Train Loss: 0.2769052 Vali Loss: 0.4117815 Test Loss: 0.4808326
Validation loss decreased (0.414193 --> 0.411781).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.2668806
	speed: 0.6187s/iter; left time: 5142.8747s
	iters: 200, epoch: 9 | loss: 0.3008071
	speed: 0.3329s/iter; left time: 2734.3553s
	iters: 300, epoch: 9 | loss: 0.2747968
	speed: 0.3321s/iter; left time: 2693.9739s
	iters: 400, epoch: 9 | loss: 0.2639884
	speed: 0.3308s/iter; left time: 2651.0559s
	iters: 500, epoch: 9 | loss: 0.2585869
	speed: 0.3324s/iter; left time: 2630.3618s
	iters: 600, epoch: 9 | loss: 0.2794734
	speed: 0.3318s/iter; left time: 2592.6457s
	iters: 700, epoch: 9 | loss: 0.2718079
	speed: 0.3318s/iter; left time: 2558.9620s
Epoch: 9 cost time: 232.7182581424713
Epoch: 9, Steps: 701 | Train Loss: 0.2749661 Vali Loss: 0.4102888 Test Loss: 0.4786970
Validation loss decreased (0.411781 --> 0.410289).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.2664199
	speed: 0.6214s/iter; left time: 4730.2134s
	iters: 200, epoch: 10 | loss: 0.2855123
	speed: 0.3330s/iter; left time: 2501.1466s
	iters: 300, epoch: 10 | loss: 0.2545380
	speed: 0.3319s/iter; left time: 2460.0658s
	iters: 400, epoch: 10 | loss: 0.2845819
	speed: 0.3317s/iter; left time: 2425.2465s
	iters: 500, epoch: 10 | loss: 0.2625579
	speed: 0.3324s/iter; left time: 2397.1701s
	iters: 600, epoch: 10 | loss: 0.2577132
	speed: 0.3329s/iter; left time: 2367.5162s
	iters: 700, epoch: 10 | loss: 0.2638179
	speed: 0.3334s/iter; left time: 2338.0634s
Epoch: 10 cost time: 233.0455150604248
Epoch: 10, Steps: 701 | Train Loss: 0.2738731 Vali Loss: 0.4090491 Test Loss: 0.4778002
Validation loss decreased (0.410289 --> 0.409049).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.2636904
	speed: 0.6283s/iter; left time: 4342.0019s
	iters: 200, epoch: 11 | loss: 0.2713656
	speed: 0.3335s/iter; left time: 2271.3730s
	iters: 300, epoch: 11 | loss: 0.2822896
	speed: 0.3313s/iter; left time: 2223.3744s
	iters: 400, epoch: 11 | loss: 0.2615912
	speed: 0.3313s/iter; left time: 2190.4313s
	iters: 500, epoch: 11 | loss: 0.2801145
	speed: 0.3323s/iter; left time: 2163.4611s
	iters: 600, epoch: 11 | loss: 0.2733281
	speed: 0.3316s/iter; left time: 2126.0821s
	iters: 700, epoch: 11 | loss: 0.2788530
	speed: 0.3321s/iter; left time: 2095.7313s
Epoch: 11 cost time: 233.13976526260376
Epoch: 11, Steps: 701 | Train Loss: 0.2732433 Vali Loss: 0.4089187 Test Loss: 0.4772788
Validation loss decreased (0.409049 --> 0.408919).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.2660258
	speed: 0.6244s/iter; left time: 3877.3250s
	iters: 200, epoch: 12 | loss: 0.2682297
	speed: 0.3331s/iter; left time: 2035.3733s
	iters: 300, epoch: 12 | loss: 0.2658978
	speed: 0.3300s/iter; left time: 1983.0758s
	iters: 400, epoch: 12 | loss: 0.2675428
	speed: 0.3300s/iter; left time: 1950.3643s
	iters: 500, epoch: 12 | loss: 0.2991770
	speed: 0.3301s/iter; left time: 1917.7274s
	iters: 600, epoch: 12 | loss: 0.2863889
	speed: 0.3334s/iter; left time: 1903.5478s
	iters: 700, epoch: 12 | loss: 0.2682367
	speed: 0.3309s/iter; left time: 1856.4043s
Epoch: 12 cost time: 232.45939016342163
Epoch: 12, Steps: 701 | Train Loss: 0.2728659 Vali Loss: 0.4089020 Test Loss: 0.4770357
Validation loss decreased (0.408919 --> 0.408902).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.2631300
	speed: 0.6218s/iter; left time: 3425.3939s
	iters: 200, epoch: 13 | loss: 0.2858316
	speed: 0.3341s/iter; left time: 1807.2072s
	iters: 300, epoch: 13 | loss: 0.2712667
	speed: 0.3319s/iter; left time: 1762.0984s
	iters: 400, epoch: 13 | loss: 0.2945558
	speed: 0.3326s/iter; left time: 1732.4829s
	iters: 500, epoch: 13 | loss: 0.2797369
	speed: 0.3308s/iter; left time: 1690.0950s
	iters: 600, epoch: 13 | loss: 0.2690060
	speed: 0.3311s/iter; left time: 1658.2621s
	iters: 700, epoch: 13 | loss: 0.2981760
	speed: 0.3322s/iter; left time: 1630.8068s
Epoch: 13 cost time: 232.9008550643921
Epoch: 13, Steps: 701 | Train Loss: 0.2726905 Vali Loss: 0.4087175 Test Loss: 0.4769707
Validation loss decreased (0.408902 --> 0.408717).  Saving model ...
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 14 | loss: 0.2866353
	speed: 0.6238s/iter; left time: 2999.0907s
	iters: 200, epoch: 14 | loss: 0.2651100
	speed: 0.3344s/iter; left time: 1574.1954s
	iters: 300, epoch: 14 | loss: 0.2593706
	speed: 0.3327s/iter; left time: 1533.2697s
	iters: 400, epoch: 14 | loss: 0.2850907
	speed: 0.3320s/iter; left time: 1496.8739s
	iters: 500, epoch: 14 | loss: 0.2769630
	speed: 0.3310s/iter; left time: 1458.9694s
	iters: 600, epoch: 14 | loss: 0.2859916
	speed: 0.3321s/iter; left time: 1430.5772s
	iters: 700, epoch: 14 | loss: 0.2691828
	speed: 0.3307s/iter; left time: 1391.4730s
Epoch: 14 cost time: 232.98662424087524
Epoch: 14, Steps: 701 | Train Loss: 0.2725796 Vali Loss: 0.4078041 Test Loss: 0.4769810
Validation loss decreased (0.408717 --> 0.407804).  Saving model ...
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 15 | loss: 0.2617319
	speed: 0.6277s/iter; left time: 2578.1115s
	iters: 200, epoch: 15 | loss: 0.2483061
	speed: 0.3334s/iter; left time: 1335.8203s
	iters: 300, epoch: 15 | loss: 0.2778631
	speed: 0.3301s/iter; left time: 1289.5497s
	iters: 400, epoch: 15 | loss: 0.2764407
	speed: 0.3307s/iter; left time: 1258.9499s
	iters: 500, epoch: 15 | loss: 0.2795584
	speed: 0.3304s/iter; left time: 1224.8620s
	iters: 600, epoch: 15 | loss: 0.2647895
	speed: 0.3334s/iter; left time: 1202.4173s
	iters: 700, epoch: 15 | loss: 0.2753664
	speed: 0.3296s/iter; left time: 1156.0618s
Epoch: 15 cost time: 232.75581884384155
Epoch: 15, Steps: 701 | Train Loss: 0.2725165 Vali Loss: 0.4081556 Test Loss: 0.4769574
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 16 | loss: 0.2709453
	speed: 0.6129s/iter; left time: 2087.6002s
	iters: 200, epoch: 16 | loss: 0.2770255
	speed: 0.3300s/iter; left time: 1090.9646s
	iters: 300, epoch: 16 | loss: 0.2900287
	speed: 0.3302s/iter; left time: 1058.4631s
	iters: 400, epoch: 16 | loss: 0.2915843
	speed: 0.3304s/iter; left time: 1026.1815s
	iters: 500, epoch: 16 | loss: 0.2579027
	speed: 0.3310s/iter; left time: 994.8909s
	iters: 600, epoch: 16 | loss: 0.2603825
	speed: 0.3303s/iter; left time: 959.7179s
	iters: 700, epoch: 16 | loss: 0.2718315
	speed: 0.3301s/iter; left time: 926.1881s
Epoch: 16 cost time: 231.53417706489563
Epoch: 16, Steps: 701 | Train Loss: 0.2724873 Vali Loss: 0.4081213 Test Loss: 0.4769490
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 17 | loss: 0.2840857
	speed: 0.6156s/iter; left time: 1665.0905s
	iters: 200, epoch: 17 | loss: 0.2735093
	speed: 0.3300s/iter; left time: 859.7505s
	iters: 300, epoch: 17 | loss: 0.2646503
	speed: 0.3302s/iter; left time: 827.2078s
	iters: 400, epoch: 17 | loss: 0.2662189
	speed: 0.3308s/iter; left time: 795.5068s
	iters: 500, epoch: 17 | loss: 0.2504244
	speed: 0.3301s/iter; left time: 760.8311s
	iters: 600, epoch: 17 | loss: 0.2619575
	speed: 0.3304s/iter; left time: 728.5097s
	iters: 700, epoch: 17 | loss: 0.2777259
	speed: 0.3307s/iter; left time: 696.0815s
Epoch: 17 cost time: 231.87936639785767
Epoch: 17, Steps: 701 | Train Loss: 0.2724955 Vali Loss: 0.4081417 Test Loss: 0.4769443
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 18 | loss: 0.2760248
	speed: 0.6127s/iter; left time: 1227.7669s
	iters: 200, epoch: 18 | loss: 0.2671653
	speed: 0.3298s/iter; left time: 627.8561s
	iters: 300, epoch: 18 | loss: 0.3011298
	speed: 0.3305s/iter; left time: 596.1919s
	iters: 400, epoch: 18 | loss: 0.2919387
	speed: 0.3337s/iter; left time: 568.6043s
	iters: 500, epoch: 18 | loss: 0.2765743
	speed: 0.3308s/iter; left time: 530.6665s
	iters: 600, epoch: 18 | loss: 0.2967869
	speed: 0.3308s/iter; left time: 497.4785s
	iters: 700, epoch: 18 | loss: 0.2844014
	speed: 0.3307s/iter; left time: 464.2425s
Epoch: 18 cost time: 231.96317958831787
Epoch: 18, Steps: 701 | Train Loss: 0.2724716 Vali Loss: 0.4082804 Test Loss: 0.4769415
EarlyStopping counter: 4 out of 5
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 19 | loss: 0.2663526
	speed: 0.6161s/iter; left time: 802.7239s
	iters: 200, epoch: 19 | loss: 0.2807049
	speed: 0.3317s/iter; left time: 399.0072s
	iters: 300, epoch: 19 | loss: 0.2610625
	speed: 0.3303s/iter; left time: 364.2835s
	iters: 400, epoch: 19 | loss: 0.2786637
	speed: 0.3295s/iter; left time: 330.4877s
	iters: 500, epoch: 19 | loss: 0.2915902
	speed: 0.3298s/iter; left time: 297.8511s
	iters: 600, epoch: 19 | loss: 0.2585837
	speed: 0.3296s/iter; left time: 264.6778s
	iters: 700, epoch: 19 | loss: 0.2756255
	speed: 0.3323s/iter; left time: 233.6297s
Epoch: 19 cost time: 232.11790680885315
Epoch: 19, Steps: 701 | Train Loss: 0.2724606 Vali Loss: 0.4081488 Test Loss: 0.4769410
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : traffic_336_720_NLinear_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed10458<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2789
mse:0.47680047154426575, mae:0.3217463493347168
