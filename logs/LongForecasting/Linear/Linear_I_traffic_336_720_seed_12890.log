Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='Linear', model_id='traffic_336_720', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=720, root_path='./dataset/', save_pred_values=False, seed=12890, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_336_720_Linear_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed12890>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11225
val 1037
test 2789
	iters: 100, epoch: 1 | loss: 0.4764720
	speed: 0.3411s/iter; left time: 4748.6309s
	iters: 200, epoch: 1 | loss: 0.5038730
	speed: 0.3255s/iter; left time: 4499.1468s
	iters: 300, epoch: 1 | loss: 0.5042586
	speed: 0.3255s/iter; left time: 4466.2780s
	iters: 400, epoch: 1 | loss: 0.5655410
	speed: 0.3256s/iter; left time: 4434.4153s
	iters: 500, epoch: 1 | loss: 0.5078652
	speed: 0.3254s/iter; left time: 4399.7581s
	iters: 600, epoch: 1 | loss: 0.5320981
	speed: 0.3258s/iter; left time: 4372.9030s
	iters: 700, epoch: 1 | loss: 0.5171575
	speed: 0.3256s/iter; left time: 4337.5363s
Epoch: 1 cost time: 229.99847221374512
Epoch: 1, Steps: 701 | Train Loss: 0.5150962 Vali Loss: 0.6969612 Test Loss: 0.8113776
Validation loss decreased (inf --> 0.696961).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.5125487
	speed: 0.6228s/iter; left time: 8233.0854s
	iters: 200, epoch: 2 | loss: 0.4780288
	speed: 0.3262s/iter; left time: 4280.2586s
	iters: 300, epoch: 2 | loss: 0.4897287
	speed: 0.3258s/iter; left time: 4241.6362s
	iters: 400, epoch: 2 | loss: 0.5011528
	speed: 0.3255s/iter; left time: 4206.0992s
	iters: 500, epoch: 2 | loss: 0.5008777
	speed: 0.3256s/iter; left time: 4174.5263s
	iters: 600, epoch: 2 | loss: 0.4905445
	speed: 0.3259s/iter; left time: 4145.1560s
	iters: 700, epoch: 2 | loss: 0.4942640
	speed: 0.3262s/iter; left time: 4116.6038s
Epoch: 2 cost time: 229.11824202537537
Epoch: 2, Steps: 701 | Train Loss: 0.5052954 Vali Loss: 0.7015257 Test Loss: 0.8187742
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.3624163
	speed: 0.6085s/iter; left time: 7617.4334s
	iters: 200, epoch: 3 | loss: 0.3658487
	speed: 0.3256s/iter; left time: 4043.4561s
	iters: 300, epoch: 3 | loss: 0.3446922
	speed: 0.3261s/iter; left time: 4017.3719s
	iters: 400, epoch: 3 | loss: 0.3718022
	speed: 0.3260s/iter; left time: 3983.2747s
	iters: 500, epoch: 3 | loss: 0.3485430
	speed: 0.3262s/iter; left time: 3953.1973s
	iters: 600, epoch: 3 | loss: 0.3993712
	speed: 0.3263s/iter; left time: 3921.2689s
	iters: 700, epoch: 3 | loss: 0.3503341
	speed: 0.3255s/iter; left time: 3879.1360s
Epoch: 3 cost time: 228.52909135818481
Epoch: 3, Steps: 701 | Train Loss: 0.3615371 Vali Loss: 0.5264682 Test Loss: 0.6091130
Validation loss decreased (0.696961 --> 0.526468).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.3312617
	speed: 0.6231s/iter; left time: 7363.2168s
	iters: 200, epoch: 4 | loss: 0.2982280
	speed: 0.3295s/iter; left time: 3861.3856s
	iters: 300, epoch: 4 | loss: 0.3100542
	speed: 0.3266s/iter; left time: 3794.7556s
	iters: 400, epoch: 4 | loss: 0.3261208
	speed: 0.3268s/iter; left time: 3763.6958s
	iters: 500, epoch: 4 | loss: 0.3101466
	speed: 0.3270s/iter; left time: 3734.0187s
	iters: 600, epoch: 4 | loss: 0.3225880
	speed: 0.3274s/iter; left time: 3705.1111s
	iters: 700, epoch: 4 | loss: 0.3145778
	speed: 0.3275s/iter; left time: 3674.2359s
Epoch: 4 cost time: 230.24512815475464
Epoch: 4, Steps: 701 | Train Loss: 0.3120676 Vali Loss: 0.4661908 Test Loss: 0.5366192
Validation loss decreased (0.526468 --> 0.466191).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.3071598
	speed: 0.6253s/iter; left time: 6951.9576s
	iters: 200, epoch: 5 | loss: 0.2606195
	speed: 0.3318s/iter; left time: 3655.0092s
	iters: 300, epoch: 5 | loss: 0.2994095
	speed: 0.3284s/iter; left time: 3584.8459s
	iters: 400, epoch: 5 | loss: 0.2722439
	speed: 0.3275s/iter; left time: 3543.0960s
	iters: 500, epoch: 5 | loss: 0.2883263
	speed: 0.3280s/iter; left time: 3515.2280s
	iters: 600, epoch: 5 | loss: 0.2695009
	speed: 0.3277s/iter; left time: 3479.0157s
	iters: 700, epoch: 5 | loss: 0.2770474
	speed: 0.3279s/iter; left time: 3448.6791s
Epoch: 5 cost time: 230.814195394516
Epoch: 5, Steps: 701 | Train Loss: 0.2902947 Vali Loss: 0.4414056 Test Loss: 0.5094270
Validation loss decreased (0.466191 --> 0.441406).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.2793741
	speed: 0.6258s/iter; left time: 6518.0546s
	iters: 200, epoch: 6 | loss: 0.2765541
	speed: 0.3316s/iter; left time: 3420.9912s
	iters: 300, epoch: 6 | loss: 0.2858389
	speed: 0.3283s/iter; left time: 3354.1890s
	iters: 400, epoch: 6 | loss: 0.2832819
	speed: 0.3280s/iter; left time: 3318.4461s
	iters: 500, epoch: 6 | loss: 0.2588589
	speed: 0.3286s/iter; left time: 3291.1757s
	iters: 600, epoch: 6 | loss: 0.2907860
	speed: 0.3281s/iter; left time: 3253.5004s
	iters: 700, epoch: 6 | loss: 0.2785238
	speed: 0.3279s/iter; left time: 3218.3127s
Epoch: 6 cost time: 231.0472593307495
Epoch: 6, Steps: 701 | Train Loss: 0.2789633 Vali Loss: 0.4303479 Test Loss: 0.4960961
Validation loss decreased (0.441406 --> 0.430348).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.2622365
	speed: 0.6188s/iter; left time: 6011.5508s
	iters: 200, epoch: 7 | loss: 0.2503101
	speed: 0.3307s/iter; left time: 3179.6448s
	iters: 300, epoch: 7 | loss: 0.2750493
	speed: 0.3283s/iter; left time: 3124.2410s
	iters: 400, epoch: 7 | loss: 0.2738323
	speed: 0.3291s/iter; left time: 3098.1233s
	iters: 500, epoch: 7 | loss: 0.2815208
	speed: 0.3278s/iter; left time: 3053.1580s
	iters: 600, epoch: 7 | loss: 0.2690069
	speed: 0.3277s/iter; left time: 3019.8726s
	iters: 700, epoch: 7 | loss: 0.2608576
	speed: 0.3282s/iter; left time: 2991.3962s
Epoch: 7 cost time: 230.47614336013794
Epoch: 7, Steps: 701 | Train Loss: 0.2727961 Vali Loss: 0.4251024 Test Loss: 0.4897056
Validation loss decreased (0.430348 --> 0.425102).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.2520139
	speed: 0.6239s/iter; left time: 5623.4177s
	iters: 200, epoch: 8 | loss: 0.2627183
	speed: 0.3323s/iter; left time: 2962.4451s
	iters: 300, epoch: 8 | loss: 0.2878488
	speed: 0.3291s/iter; left time: 2900.2715s
	iters: 400, epoch: 8 | loss: 0.2746413
	speed: 0.3270s/iter; left time: 2849.8332s
	iters: 500, epoch: 8 | loss: 0.2718586
	speed: 0.3260s/iter; left time: 2808.1500s
	iters: 600, epoch: 8 | loss: 0.2644571
	speed: 0.3259s/iter; left time: 2775.0665s
	iters: 700, epoch: 8 | loss: 0.2500260
	speed: 0.3266s/iter; left time: 2747.6656s
Epoch: 8 cost time: 230.43206810951233
Epoch: 8, Steps: 701 | Train Loss: 0.2693829 Vali Loss: 0.4226519 Test Loss: 0.4852695
Validation loss decreased (0.425102 --> 0.422652).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.2782908
	speed: 0.6162s/iter; left time: 5122.5782s
	iters: 200, epoch: 9 | loss: 0.2687390
	speed: 0.3296s/iter; left time: 2707.0215s
	iters: 300, epoch: 9 | loss: 0.2492729
	speed: 0.3266s/iter; left time: 2649.8907s
	iters: 400, epoch: 9 | loss: 0.2754826
	speed: 0.3262s/iter; left time: 2614.1765s
	iters: 500, epoch: 9 | loss: 0.2538748
	speed: 0.3263s/iter; left time: 2581.6551s
	iters: 600, epoch: 9 | loss: 0.2783287
	speed: 0.3261s/iter; left time: 2547.9630s
	iters: 700, epoch: 9 | loss: 0.2647635
	speed: 0.3262s/iter; left time: 2516.3516s
Epoch: 9 cost time: 229.2662570476532
Epoch: 9, Steps: 701 | Train Loss: 0.2674900 Vali Loss: 0.4207575 Test Loss: 0.4841210
Validation loss decreased (0.422652 --> 0.420758).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.2548869
	speed: 0.6208s/iter; left time: 4725.1516s
	iters: 200, epoch: 10 | loss: 0.2585051
	speed: 0.3292s/iter; left time: 2472.9559s
	iters: 300, epoch: 10 | loss: 0.2492972
	speed: 0.3262s/iter; left time: 2417.6067s
	iters: 400, epoch: 10 | loss: 0.2651475
	speed: 0.3257s/iter; left time: 2381.7208s
	iters: 500, epoch: 10 | loss: 0.2610409
	speed: 0.3256s/iter; left time: 2348.5653s
	iters: 600, epoch: 10 | loss: 0.2777387
	speed: 0.3264s/iter; left time: 2321.4449s
	iters: 700, epoch: 10 | loss: 0.2693996
	speed: 0.3257s/iter; left time: 2284.0187s
Epoch: 10 cost time: 229.44485759735107
Epoch: 10, Steps: 701 | Train Loss: 0.2665059 Vali Loss: 0.4204496 Test Loss: 0.4833920
Validation loss decreased (0.420758 --> 0.420450).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.2660082
	speed: 0.6246s/iter; left time: 4316.7158s
	iters: 200, epoch: 11 | loss: 0.2659796
	speed: 0.3335s/iter; left time: 2271.2780s
	iters: 300, epoch: 11 | loss: 0.2814706
	speed: 0.3296s/iter; left time: 2212.2250s
	iters: 400, epoch: 11 | loss: 0.2797900
	speed: 0.3280s/iter; left time: 2168.6796s
	iters: 500, epoch: 11 | loss: 0.2651196
	speed: 0.3263s/iter; left time: 2124.7225s
	iters: 600, epoch: 11 | loss: 0.2867273
	speed: 0.3264s/iter; left time: 2092.6099s
	iters: 700, epoch: 11 | loss: 0.2812461
	speed: 0.3261s/iter; left time: 2057.8350s
Epoch: 11 cost time: 230.69796752929688
Epoch: 11, Steps: 701 | Train Loss: 0.2659502 Vali Loss: 0.4199806 Test Loss: 0.4831598
Validation loss decreased (0.420450 --> 0.419981).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.2578958
	speed: 0.6176s/iter; left time: 3835.3895s
	iters: 200, epoch: 12 | loss: 0.2545553
	speed: 0.3304s/iter; left time: 2018.8059s
	iters: 300, epoch: 12 | loss: 0.2807659
	speed: 0.3280s/iter; left time: 1971.5711s
	iters: 400, epoch: 12 | loss: 0.2765311
	speed: 0.3274s/iter; left time: 1934.8207s
	iters: 500, epoch: 12 | loss: 0.2673137
	speed: 0.3277s/iter; left time: 1903.9693s
	iters: 600, epoch: 12 | loss: 0.2747965
	speed: 0.3267s/iter; left time: 1865.2510s
	iters: 700, epoch: 12 | loss: 0.2604321
	speed: 0.3262s/iter; left time: 1830.0274s
Epoch: 12 cost time: 229.87317562103271
Epoch: 12, Steps: 701 | Train Loss: 0.2656453 Vali Loss: 0.4195581 Test Loss: 0.4830887
Validation loss decreased (0.419981 --> 0.419558).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.2708546
	speed: 0.6187s/iter; left time: 3408.4953s
	iters: 200, epoch: 13 | loss: 0.2718227
	speed: 0.3302s/iter; left time: 1785.8773s
	iters: 300, epoch: 13 | loss: 0.2660774
	speed: 0.3275s/iter; left time: 1738.7831s
	iters: 400, epoch: 13 | loss: 0.2816265
	speed: 0.3272s/iter; left time: 1704.5158s
	iters: 500, epoch: 13 | loss: 0.2681714
	speed: 0.3272s/iter; left time: 1671.4236s
	iters: 600, epoch: 13 | loss: 0.2711675
	speed: 0.3281s/iter; left time: 1643.3706s
	iters: 700, epoch: 13 | loss: 0.2562404
	speed: 0.3276s/iter; left time: 1608.2488s
Epoch: 13 cost time: 230.0658118724823
Epoch: 13, Steps: 701 | Train Loss: 0.2654797 Vali Loss: 0.4198042 Test Loss: 0.4829634
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 14 | loss: 0.2739060
	speed: 0.6106s/iter; left time: 2935.5387s
	iters: 200, epoch: 14 | loss: 0.2710338
	speed: 0.3277s/iter; left time: 1542.8409s
	iters: 300, epoch: 14 | loss: 0.2609473
	speed: 0.3271s/iter; left time: 1507.1402s
	iters: 400, epoch: 14 | loss: 0.2612914
	speed: 0.3268s/iter; left time: 1473.1775s
	iters: 500, epoch: 14 | loss: 0.2678940
	speed: 0.3268s/iter; left time: 1440.6560s
	iters: 600, epoch: 14 | loss: 0.2783500
	speed: 0.3271s/iter; left time: 1409.1656s
	iters: 700, epoch: 14 | loss: 0.2665599
	speed: 0.3279s/iter; left time: 1379.6591s
Epoch: 14 cost time: 229.47702026367188
Epoch: 14, Steps: 701 | Train Loss: 0.2654011 Vali Loss: 0.4203748 Test Loss: 0.4829622
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 15 | loss: 0.2752929
	speed: 0.6107s/iter; left time: 2508.0781s
	iters: 200, epoch: 15 | loss: 0.2600200
	speed: 0.3284s/iter; left time: 1315.9962s
	iters: 300, epoch: 15 | loss: 0.2705529
	speed: 0.3285s/iter; left time: 1283.4010s
	iters: 400, epoch: 15 | loss: 0.2486909
	speed: 0.3277s/iter; left time: 1247.6615s
	iters: 500, epoch: 15 | loss: 0.2650875
	speed: 0.3278s/iter; left time: 1215.3072s
	iters: 600, epoch: 15 | loss: 0.2811538
	speed: 0.3281s/iter; left time: 1183.2858s
	iters: 700, epoch: 15 | loss: 0.2762049
	speed: 0.3283s/iter; left time: 1151.2551s
Epoch: 15 cost time: 230.0473439693451
Epoch: 15, Steps: 701 | Train Loss: 0.2653463 Vali Loss: 0.4205223 Test Loss: 0.4829587
EarlyStopping counter: 3 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 16 | loss: 0.2740387
	speed: 0.6137s/iter; left time: 2090.1054s
	iters: 200, epoch: 16 | loss: 0.2666071
	speed: 0.3284s/iter; left time: 1085.6718s
	iters: 300, epoch: 16 | loss: 0.2591198
	speed: 0.3278s/iter; left time: 1050.9969s
	iters: 400, epoch: 16 | loss: 0.2671037
	speed: 0.3279s/iter; left time: 1018.3797s
	iters: 500, epoch: 16 | loss: 0.2647434
	speed: 0.3262s/iter; left time: 980.6735s
	iters: 600, epoch: 16 | loss: 0.2571062
	speed: 0.3276s/iter; left time: 952.0406s
	iters: 700, epoch: 16 | loss: 0.2702731
	speed: 0.3269s/iter; left time: 917.1568s
Epoch: 16 cost time: 229.62900471687317
Epoch: 16, Steps: 701 | Train Loss: 0.2653225 Vali Loss: 0.4205244 Test Loss: 0.4829552
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 17 | loss: 0.2590505
	speed: 0.6121s/iter; left time: 1655.5975s
	iters: 200, epoch: 17 | loss: 0.2465880
	speed: 0.3278s/iter; left time: 853.8761s
	iters: 300, epoch: 17 | loss: 0.2736806
	speed: 0.3277s/iter; left time: 821.0137s
	iters: 400, epoch: 17 | loss: 0.2627415
	speed: 0.3272s/iter; left time: 786.9533s
	iters: 500, epoch: 17 | loss: 0.2544339
	speed: 0.3271s/iter; left time: 753.8724s
	iters: 600, epoch: 17 | loss: 0.2773984
	speed: 0.3270s/iter; left time: 720.9607s
	iters: 700, epoch: 17 | loss: 0.2565082
	speed: 0.3286s/iter; left time: 691.6566s
Epoch: 17 cost time: 229.70845198631287
Epoch: 17, Steps: 701 | Train Loss: 0.2653243 Vali Loss: 0.4198280 Test Loss: 0.4829534
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : traffic_336_720_Linear_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed12890<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2789
mse:0.48290809988975525, mae:0.33066660165786743
