Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTh2', data_path='ETTh2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='DLinear', model_id='ETTh2_336_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=336, root_path='./dataset/', save_pred_values=False, seed=3293, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTh2_336_336_DLinear_ETTh2_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3293>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7969
val 2545
test 2545
Total number of trainable parameters: 1585248
Total number of parameters: 1585248
	iters: 100, epoch: 1 | loss: 0.5948558
	speed: 0.0283s/iter; left time: 138.0671s
	iters: 200, epoch: 1 | loss: 0.7053886
	speed: 0.0275s/iter; left time: 131.5440s
Epoch: 1 cost time: 7.041964769363403
Epoch: 1, Steps: 249 | Train Loss: 0.6874122 Vali Loss: 0.5533150 Test Loss: 0.7880762
Validation loss decreased (inf --> 0.553315).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.6181352
	speed: 0.0544s/iter; left time: 252.0771s
	iters: 200, epoch: 2 | loss: 0.4598750
	speed: 0.0304s/iter; left time: 137.9311s
Epoch: 2 cost time: 7.42053484916687
Epoch: 2, Steps: 249 | Train Loss: 0.6585905 Vali Loss: 0.5739190 Test Loss: 0.7527257
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.5030158
	speed: 0.0527s/iter; left time: 231.1663s
	iters: 200, epoch: 3 | loss: 0.6436253
	speed: 0.0318s/iter; left time: 136.3516s
Epoch: 3 cost time: 7.41921067237854
Epoch: 3, Steps: 249 | Train Loss: 0.5867659 Vali Loss: 0.4663278 Test Loss: 0.6257364
Validation loss decreased (0.553315 --> 0.466328).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.6564277
	speed: 0.0561s/iter; left time: 232.1092s
	iters: 200, epoch: 4 | loss: 0.6206538
	speed: 0.0295s/iter; left time: 119.0048s
Epoch: 4 cost time: 7.273199081420898
Epoch: 4, Steps: 249 | Train Loss: 0.5469262 Vali Loss: 0.4996436 Test Loss: 0.6536797
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.7474748
	speed: 0.0524s/iter; left time: 203.5394s
	iters: 200, epoch: 5 | loss: 0.5586486
	speed: 0.0302s/iter; left time: 114.4293s
Epoch: 5 cost time: 7.296281576156616
Epoch: 5, Steps: 249 | Train Loss: 0.5300454 Vali Loss: 0.4637630 Test Loss: 0.6333494
Validation loss decreased (0.466328 --> 0.463763).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.5646622
	speed: 0.0572s/iter; left time: 207.9220s
	iters: 200, epoch: 6 | loss: 0.4627804
	speed: 0.0297s/iter; left time: 105.1705s
Epoch: 6 cost time: 7.315576791763306
Epoch: 6, Steps: 249 | Train Loss: 0.5207084 Vali Loss: 0.4985321 Test Loss: 0.7423482
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.5802655
	speed: 0.0544s/iter; left time: 184.3660s
	iters: 200, epoch: 7 | loss: 0.2845761
	speed: 0.0303s/iter; left time: 99.7339s
Epoch: 7 cost time: 7.364075422286987
Epoch: 7, Steps: 249 | Train Loss: 0.5165228 Vali Loss: 0.4869128 Test Loss: 0.7576128
EarlyStopping counter: 2 out of 5
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.5830477
	speed: 0.0512s/iter; left time: 160.6543s
	iters: 200, epoch: 8 | loss: 0.4439124
	speed: 0.0270s/iter; left time: 82.0283s
Epoch: 8 cost time: 6.640528917312622
Epoch: 8, Steps: 249 | Train Loss: 0.5139127 Vali Loss: 0.4816018 Test Loss: 0.6947889
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.6064768
	speed: 0.0479s/iter; left time: 138.5132s
	iters: 200, epoch: 9 | loss: 0.3461263
	speed: 0.0271s/iter; left time: 75.6834s
Epoch: 9 cost time: 6.568155765533447
Epoch: 9, Steps: 249 | Train Loss: 0.5128259 Vali Loss: 0.4890053 Test Loss: 0.7379049
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.4410089
	speed: 0.0472s/iter; left time: 124.6463s
	iters: 200, epoch: 10 | loss: 0.3185902
	speed: 0.0269s/iter; left time: 68.2324s
Epoch: 10 cost time: 6.509873390197754
Epoch: 10, Steps: 249 | Train Loss: 0.5119739 Vali Loss: 0.4834563 Test Loss: 0.7183239
EarlyStopping counter: 5 out of 5
Early stopping
Total training time: 81.5259 seconds
>>>>>>>testing : ETTh2_336_336_DLinear_ETTh2_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3293<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2545
mse:0.6302797794342041, mae:0.5372992157936096
