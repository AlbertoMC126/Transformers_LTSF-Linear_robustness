Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTh2', data_path='ETTh2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='NLinear', model_id='ETTh2_336_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=336, root_path='./dataset/', save_pred_values=False, seed=15349, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTh2_336_336_NLinear_ETTh2_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15349>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7969
val 2545
test 2545
Total number of trainable parameters: 792624
Total number of parameters: 792624
	iters: 100, epoch: 1 | loss: 0.6577175
	speed: 0.0160s/iter; left time: 77.9443s
	iters: 200, epoch: 1 | loss: 0.9111158
	speed: 0.0157s/iter; left time: 75.0425s
Epoch: 1 cost time: 3.9254419803619385
Epoch: 1, Steps: 249 | Train Loss: 0.7263925 Vali Loss: 0.4740609 Test Loss: 0.4192437
Validation loss decreased (inf --> 0.474061).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.6237877
	speed: 0.0352s/iter; left time: 162.8160s
	iters: 200, epoch: 2 | loss: 0.6418365
	speed: 0.0169s/iter; left time: 76.5099s
Epoch: 2 cost time: 4.171320199966431
Epoch: 2, Steps: 249 | Train Loss: 0.7108294 Vali Loss: 0.4550017 Test Loss: 0.4466319
Validation loss decreased (0.474061 --> 0.455002).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.7131477
	speed: 0.0336s/iter; left time: 147.3850s
	iters: 200, epoch: 3 | loss: 0.4369658
	speed: 0.0177s/iter; left time: 75.9456s
Epoch: 3 cost time: 4.308523654937744
Epoch: 3, Steps: 249 | Train Loss: 0.6147073 Vali Loss: 0.4128872 Test Loss: 0.3987671
Validation loss decreased (0.455002 --> 0.412887).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.5006325
	speed: 0.0340s/iter; left time: 140.7256s
	iters: 200, epoch: 4 | loss: 0.5173293
	speed: 0.0179s/iter; left time: 72.0350s
Epoch: 4 cost time: 4.233990430831909
Epoch: 4, Steps: 249 | Train Loss: 0.5851556 Vali Loss: 0.4184660 Test Loss: 0.3853706
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.4632328
	speed: 0.0320s/iter; left time: 124.2479s
	iters: 200, epoch: 5 | loss: 0.6173443
	speed: 0.0168s/iter; left time: 63.7232s
Epoch: 5 cost time: 4.136516809463501
Epoch: 5, Steps: 249 | Train Loss: 0.5719014 Vali Loss: 0.3964225 Test Loss: 0.3809315
Validation loss decreased (0.412887 --> 0.396423).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.7146991
	speed: 0.0332s/iter; left time: 120.7934s
	iters: 200, epoch: 6 | loss: 0.4498007
	speed: 0.0163s/iter; left time: 57.6266s
Epoch: 6 cost time: 4.001569509506226
Epoch: 6, Steps: 249 | Train Loss: 0.5667093 Vali Loss: 0.3984579 Test Loss: 0.3768184
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 1.1008012
	speed: 0.0310s/iter; left time: 104.9317s
	iters: 200, epoch: 7 | loss: 0.7576231
	speed: 0.0168s/iter; left time: 55.3089s
Epoch: 7 cost time: 4.0633769035339355
Epoch: 7, Steps: 249 | Train Loss: 0.5626854 Vali Loss: 0.4060872 Test Loss: 0.3732520
EarlyStopping counter: 2 out of 5
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.3466890
	speed: 0.0317s/iter; left time: 99.5686s
	iters: 200, epoch: 8 | loss: 0.5328735
	speed: 0.0171s/iter; left time: 52.0381s
Epoch: 8 cost time: 4.1812520027160645
Epoch: 8, Steps: 249 | Train Loss: 0.5608822 Vali Loss: 0.3970528 Test Loss: 0.3764971
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.2786770
	speed: 0.0326s/iter; left time: 94.0894s
	iters: 200, epoch: 9 | loss: 0.6187056
	speed: 0.0177s/iter; left time: 49.3559s
Epoch: 9 cost time: 4.369275808334351
Epoch: 9, Steps: 249 | Train Loss: 0.5600386 Vali Loss: 0.3975371 Test Loss: 0.3744520
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 1.0099936
	speed: 0.0314s/iter; left time: 82.9571s
	iters: 200, epoch: 10 | loss: 0.5959165
	speed: 0.0141s/iter; left time: 35.7414s
Epoch: 10 cost time: 3.6172683238983154
Epoch: 10, Steps: 249 | Train Loss: 0.5594314 Vali Loss: 0.3958631 Test Loss: 0.3742455
Validation loss decreased (0.396423 --> 0.395863).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.3330509
	speed: 0.0251s/iter; left time: 60.0069s
	iters: 200, epoch: 11 | loss: 0.5491390
	speed: 0.0125s/iter; left time: 28.5614s
Epoch: 11 cost time: 3.0413548946380615
Epoch: 11, Steps: 249 | Train Loss: 0.5585658 Vali Loss: 0.3946448 Test Loss: 0.3741508
Validation loss decreased (0.395863 --> 0.394645).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.6960771
	speed: 0.0223s/iter; left time: 47.8435s
	iters: 200, epoch: 12 | loss: 0.3562178
	speed: 0.0109s/iter; left time: 22.2587s
Epoch: 12 cost time: 2.6561570167541504
Epoch: 12, Steps: 249 | Train Loss: 0.5589913 Vali Loss: 0.3947873 Test Loss: 0.3739741
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.4567751
	speed: 0.0202s/iter; left time: 38.2455s
	iters: 200, epoch: 13 | loss: 0.5448781
	speed: 0.0103s/iter; left time: 18.4868s
Epoch: 13 cost time: 2.577556848526001
Epoch: 13, Steps: 249 | Train Loss: 0.5588657 Vali Loss: 0.3949209 Test Loss: 0.3739285
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.3843602
	speed: 0.0178s/iter; left time: 29.2279s
	iters: 200, epoch: 14 | loss: 0.3779593
	speed: 0.0079s/iter; left time: 12.2678s
Epoch: 14 cost time: 1.973461627960205
Epoch: 14, Steps: 249 | Train Loss: 0.5588045 Vali Loss: 0.3956425 Test Loss: 0.3739098
EarlyStopping counter: 3 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.3441424
	speed: 0.0128s/iter; left time: 17.8168s
	iters: 200, epoch: 15 | loss: 0.6219264
	speed: 0.0053s/iter; left time: 6.8011s
Epoch: 15 cost time: 1.4712185859680176
Epoch: 15, Steps: 249 | Train Loss: 0.5587587 Vali Loss: 0.3956293 Test Loss: 0.3739164
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.6988787
	speed: 0.0101s/iter; left time: 11.5444s
	iters: 200, epoch: 16 | loss: 0.6223008
	speed: 0.0046s/iter; left time: 4.8104s
Epoch: 16 cost time: 1.1796257495880127
Epoch: 16, Steps: 249 | Train Loss: 0.5586106 Vali Loss: 0.3957894 Test Loss: 0.3739210
EarlyStopping counter: 5 out of 5
Early stopping
Total training time: 64.1690 seconds
>>>>>>>testing : ETTh2_336_336_NLinear_ETTh2_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15349<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2545
mse:0.36966514587402344, mae:0.4122051000595093
