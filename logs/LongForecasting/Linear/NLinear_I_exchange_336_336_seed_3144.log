Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='exchange_rate.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=8, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='mse', lradj='type1', model='NLinear', model_id='Exchange_336_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=336, root_path='./dataset/', save_pred_values=False, seed=3144, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : Exchange_336_336_NLinear_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3144>>>>>>>>>>>>>>>>>>>>>>>>>>
train 4640
val 425
test 1182
	iters: 100, epoch: 1 | loss: 0.3608995
	speed: 0.0108s/iter; left time: 30.1184s
Epoch: 1 cost time: 1.5516467094421387
Epoch: 1, Steps: 145 | Train Loss: 0.4286985 Vali Loss: 0.4014735 Test Loss: 0.3263635
Validation loss decreased (inf --> 0.401473).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.4378938
	speed: 0.0156s/iter; left time: 41.3414s
Epoch: 2 cost time: 1.3271498680114746
Epoch: 2, Steps: 145 | Train Loss: 0.4174876 Vali Loss: 0.3939539 Test Loss: 0.3421023
Validation loss decreased (0.401473 --> 0.393954).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.4500970
	speed: 0.0151s/iter; left time: 37.8749s
Epoch: 3 cost time: 1.3296399116516113
Epoch: 3, Steps: 145 | Train Loss: 0.4130402 Vali Loss: 0.3937681 Test Loss: 0.3488078
Validation loss decreased (0.393954 --> 0.393768).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.4255681
	speed: 0.0156s/iter; left time: 36.8005s
Epoch: 4 cost time: 1.3501241207122803
Epoch: 4, Steps: 145 | Train Loss: 0.4095252 Vali Loss: 0.3836925 Test Loss: 0.3401427
Validation loss decreased (0.393768 --> 0.383693).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.3845513
	speed: 0.0141s/iter; left time: 31.2084s
Epoch: 5 cost time: 1.2793970108032227
Epoch: 5, Steps: 145 | Train Loss: 0.4092136 Vali Loss: 0.3841036 Test Loss: 0.3529987
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.3501449
	speed: 0.0161s/iter; left time: 33.5195s
Epoch: 6 cost time: 1.4294662475585938
Epoch: 6, Steps: 145 | Train Loss: 0.4086053 Vali Loss: 0.3840783 Test Loss: 0.3495383
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.4774342
	speed: 0.0147s/iter; left time: 28.4317s
Epoch: 7 cost time: 1.3705346584320068
Epoch: 7, Steps: 145 | Train Loss: 0.4082632 Vali Loss: 0.3862017 Test Loss: 0.3513973
EarlyStopping counter: 3 out of 5
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.4721870
	speed: 0.0169s/iter; left time: 30.1232s
Epoch: 8 cost time: 1.468480110168457
Epoch: 8, Steps: 145 | Train Loss: 0.4081573 Vali Loss: 0.3865808 Test Loss: 0.3513829
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.4081781
	speed: 0.0152s/iter; left time: 24.9190s
Epoch: 9 cost time: 1.2992007732391357
Epoch: 9, Steps: 145 | Train Loss: 0.4080589 Vali Loss: 0.3834305 Test Loss: 0.3510422
Validation loss decreased (0.383693 --> 0.383431).  Saving model ...
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.4323876
	speed: 0.0137s/iter; left time: 20.5188s
Epoch: 10 cost time: 1.2255735397338867
Epoch: 10, Steps: 145 | Train Loss: 0.4079972 Vali Loss: 0.3830779 Test Loss: 0.3510778
Validation loss decreased (0.383431 --> 0.383078).  Saving model ...
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 11 | loss: 0.4747993
	speed: 0.0153s/iter; left time: 20.7120s
Epoch: 11 cost time: 1.322303056716919
Epoch: 11, Steps: 145 | Train Loss: 0.4079846 Vali Loss: 0.3863876 Test Loss: 0.3510531
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 12 | loss: 0.4713748
	speed: 0.0152s/iter; left time: 18.3295s
Epoch: 12 cost time: 1.332421064376831
Epoch: 12, Steps: 145 | Train Loss: 0.4079698 Vali Loss: 0.3853129 Test Loss: 0.3510068
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.44140625e-07
	iters: 100, epoch: 13 | loss: 0.4079970
	speed: 0.0153s/iter; left time: 16.2488s
Epoch: 13 cost time: 1.3991570472717285
Epoch: 13, Steps: 145 | Train Loss: 0.4079633 Vali Loss: 0.3831104 Test Loss: 0.3509892
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.220703125e-07
	iters: 100, epoch: 14 | loss: 0.4330498
	speed: 0.0148s/iter; left time: 13.5487s
Epoch: 14 cost time: 1.2832212448120117
Epoch: 14, Steps: 145 | Train Loss: 0.4079602 Vali Loss: 0.3822103 Test Loss: 0.3509935
Validation loss decreased (0.383078 --> 0.382210).  Saving model ...
Updating learning rate to 6.103515625e-08
	iters: 100, epoch: 15 | loss: 0.4242581
	speed: 0.0146s/iter; left time: 11.2803s
Epoch: 15 cost time: 1.2753324508666992
Epoch: 15, Steps: 145 | Train Loss: 0.4079590 Vali Loss: 0.3850266 Test Loss: 0.3509902
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.0517578125e-08
	iters: 100, epoch: 16 | loss: 0.4537464
	speed: 0.0136s/iter; left time: 8.4979s
Epoch: 16 cost time: 1.1861658096313477
Epoch: 16, Steps: 145 | Train Loss: 0.4079583 Vali Loss: 0.3850915 Test Loss: 0.3509908
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.52587890625e-08
	iters: 100, epoch: 17 | loss: 0.3712360
	speed: 0.0133s/iter; left time: 6.3741s
Epoch: 17 cost time: 1.1482369899749756
Epoch: 17, Steps: 145 | Train Loss: 0.4079580 Vali Loss: 0.3840369 Test Loss: 0.3509906
EarlyStopping counter: 3 out of 5
Updating learning rate to 7.62939453125e-09
	iters: 100, epoch: 18 | loss: 0.3974138
	speed: 0.0127s/iter; left time: 4.2722s
Epoch: 18 cost time: 1.1613051891326904
Epoch: 18, Steps: 145 | Train Loss: 0.4079578 Vali Loss: 0.3849137 Test Loss: 0.3509903
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.814697265625e-09
	iters: 100, epoch: 19 | loss: 0.4384882
	speed: 0.0129s/iter; left time: 2.4612s
Epoch: 19 cost time: 1.151230812072754
Epoch: 19, Steps: 145 | Train Loss: 0.4079577 Vali Loss: 0.3846517 Test Loss: 0.3509902
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : Exchange_336_336_NLinear_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3144<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 1182
mse:0.35118368268013, mae:0.42579418420791626
