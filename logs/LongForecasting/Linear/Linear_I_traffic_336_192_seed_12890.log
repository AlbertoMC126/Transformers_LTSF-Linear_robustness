Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='Linear', model_id='traffic_336_192', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=192, root_path='./dataset/', save_pred_values=False, seed=12890, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_336_192_Linear_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed12890>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11753
val 1565
test 3317
	iters: 100, epoch: 1 | loss: 0.4294818
	speed: 0.3206s/iter; left time: 4674.0716s
	iters: 200, epoch: 1 | loss: 0.4436727
	speed: 0.3050s/iter; left time: 4416.1347s
	iters: 300, epoch: 1 | loss: 0.4611092
	speed: 0.3044s/iter; left time: 4378.1241s
	iters: 400, epoch: 1 | loss: 0.4522496
	speed: 0.3046s/iter; left time: 4350.1440s
	iters: 500, epoch: 1 | loss: 0.4913009
	speed: 0.3051s/iter; left time: 4326.7447s
	iters: 600, epoch: 1 | loss: 0.4871416
	speed: 0.3046s/iter; left time: 4289.0517s
	iters: 700, epoch: 1 | loss: 0.4994245
	speed: 0.3046s/iter; left time: 4258.0374s
Epoch: 1 cost time: 225.4749698638916
Epoch: 1, Steps: 734 | Train Loss: 0.4811234 Vali Loss: 0.6344615 Test Loss: 0.7503017
Validation loss decreased (inf --> 0.634462).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.4619583
	speed: 0.6139s/iter; left time: 8501.1891s
	iters: 200, epoch: 2 | loss: 0.5213236
	speed: 0.3042s/iter; left time: 4181.8890s
	iters: 300, epoch: 2 | loss: 0.4499955
	speed: 0.3044s/iter; left time: 4154.6285s
	iters: 400, epoch: 2 | loss: 0.5060409
	speed: 0.3044s/iter; left time: 4123.7072s
	iters: 500, epoch: 2 | loss: 0.4543492
	speed: 0.3048s/iter; left time: 4098.9262s
	iters: 600, epoch: 2 | loss: 0.5060412
	speed: 0.3054s/iter; left time: 4076.5985s
	iters: 700, epoch: 2 | loss: 0.5104488
	speed: 0.3061s/iter; left time: 4054.8535s
Epoch: 2 cost time: 223.8169436454773
Epoch: 2, Steps: 734 | Train Loss: 0.4746089 Vali Loss: 0.6567361 Test Loss: 0.7822730
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.3292607
	speed: 0.6136s/iter; left time: 8045.7093s
	iters: 200, epoch: 3 | loss: 0.3514958
	speed: 0.3067s/iter; left time: 3991.5569s
	iters: 300, epoch: 3 | loss: 0.3343380
	speed: 0.3050s/iter; left time: 3938.6152s
	iters: 400, epoch: 3 | loss: 0.3364975
	speed: 0.3043s/iter; left time: 3898.9000s
	iters: 500, epoch: 3 | loss: 0.3776850
	speed: 0.3055s/iter; left time: 3883.8041s
	iters: 600, epoch: 3 | loss: 0.3001350
	speed: 0.3057s/iter; left time: 3856.2761s
	iters: 700, epoch: 3 | loss: 0.3268038
	speed: 0.3074s/iter; left time: 3847.0565s
Epoch: 3 cost time: 224.50733923912048
Epoch: 3, Steps: 734 | Train Loss: 0.3296175 Vali Loss: 0.4603370 Test Loss: 0.5587139
Validation loss decreased (0.634462 --> 0.460337).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.2869036
	speed: 0.6184s/iter; left time: 7655.5369s
	iters: 200, epoch: 4 | loss: 0.2787559
	speed: 0.3056s/iter; left time: 3752.1800s
	iters: 300, epoch: 4 | loss: 0.2800654
	speed: 0.3055s/iter; left time: 3721.2096s
	iters: 400, epoch: 4 | loss: 0.2802475
	speed: 0.3053s/iter; left time: 3688.0446s
	iters: 500, epoch: 4 | loss: 0.2680524
	speed: 0.3057s/iter; left time: 3662.3619s
	iters: 600, epoch: 4 | loss: 0.2709418
	speed: 0.3051s/iter; left time: 3624.3423s
	iters: 700, epoch: 4 | loss: 0.2824515
	speed: 0.3059s/iter; left time: 3603.1478s
Epoch: 4 cost time: 224.49431443214417
Epoch: 4, Steps: 734 | Train Loss: 0.2825092 Vali Loss: 0.4008649 Test Loss: 0.4920774
Validation loss decreased (0.460337 --> 0.400865).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.2897059
	speed: 0.6159s/iter; left time: 7172.2025s
	iters: 200, epoch: 5 | loss: 0.2671730
	speed: 0.3057s/iter; left time: 3529.3323s
	iters: 300, epoch: 5 | loss: 0.2644438
	speed: 0.3060s/iter; left time: 3502.4057s
	iters: 400, epoch: 5 | loss: 0.2880364
	speed: 0.3058s/iter; left time: 3469.6787s
	iters: 500, epoch: 5 | loss: 0.2762451
	speed: 0.3044s/iter; left time: 3423.0404s
	iters: 600, epoch: 5 | loss: 0.2553571
	speed: 0.3045s/iter; left time: 3393.9012s
	iters: 700, epoch: 5 | loss: 0.2565590
	speed: 0.3044s/iter; left time: 3361.6335s
Epoch: 5 cost time: 223.9552402496338
Epoch: 5, Steps: 734 | Train Loss: 0.2615175 Vali Loss: 0.3770877 Test Loss: 0.4643930
Validation loss decreased (0.400865 --> 0.377088).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.2279957
	speed: 0.6155s/iter; left time: 6715.7564s
	iters: 200, epoch: 6 | loss: 0.2504825
	speed: 0.3041s/iter; left time: 3287.3636s
	iters: 300, epoch: 6 | loss: 0.2958975
	speed: 0.3053s/iter; left time: 3269.6010s
	iters: 400, epoch: 6 | loss: 0.2537074
	speed: 0.3049s/iter; left time: 3235.4792s
	iters: 500, epoch: 6 | loss: 0.2556840
	speed: 0.3045s/iter; left time: 3201.0032s
	iters: 600, epoch: 6 | loss: 0.2554057
	speed: 0.3044s/iter; left time: 3168.9049s
	iters: 700, epoch: 6 | loss: 0.2439148
	speed: 0.3047s/iter; left time: 3141.5431s
Epoch: 6 cost time: 223.6565911769867
Epoch: 6, Steps: 734 | Train Loss: 0.2505531 Vali Loss: 0.3654572 Test Loss: 0.4508999
Validation loss decreased (0.377088 --> 0.365457).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.2254855
	speed: 0.6178s/iter; left time: 6286.9497s
	iters: 200, epoch: 7 | loss: 0.2500398
	speed: 0.3067s/iter; left time: 3090.9261s
	iters: 300, epoch: 7 | loss: 0.2618753
	speed: 0.3064s/iter; left time: 3056.7124s
	iters: 400, epoch: 7 | loss: 0.2178928
	speed: 0.3066s/iter; left time: 3028.3279s
	iters: 500, epoch: 7 | loss: 0.2259835
	speed: 0.3072s/iter; left time: 3003.9695s
	iters: 600, epoch: 7 | loss: 0.2203581
	speed: 0.3060s/iter; left time: 2961.5534s
	iters: 700, epoch: 7 | loss: 0.2561417
	speed: 0.3057s/iter; left time: 2927.8572s
Epoch: 7 cost time: 224.9253249168396
Epoch: 7, Steps: 734 | Train Loss: 0.2446698 Vali Loss: 0.3599397 Test Loss: 0.4447152
Validation loss decreased (0.365457 --> 0.359940).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.2396723
	speed: 0.6150s/iter; left time: 5807.0608s
	iters: 200, epoch: 8 | loss: 0.2535881
	speed: 0.3047s/iter; left time: 2846.7029s
	iters: 300, epoch: 8 | loss: 0.2317430
	speed: 0.3057s/iter; left time: 2825.3807s
	iters: 400, epoch: 8 | loss: 0.2593435
	speed: 0.3062s/iter; left time: 2799.7692s
	iters: 500, epoch: 8 | loss: 0.2748654
	speed: 0.3052s/iter; left time: 2759.8024s
	iters: 600, epoch: 8 | loss: 0.2517987
	speed: 0.3056s/iter; left time: 2733.1635s
	iters: 700, epoch: 8 | loss: 0.2738352
	speed: 0.3057s/iter; left time: 2702.9275s
Epoch: 8 cost time: 224.2413649559021
Epoch: 8, Steps: 734 | Train Loss: 0.2414102 Vali Loss: 0.3579750 Test Loss: 0.4420608
Validation loss decreased (0.359940 --> 0.357975).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.2254601
	speed: 0.6162s/iter; left time: 5366.7580s
	iters: 200, epoch: 9 | loss: 0.2272406
	speed: 0.3044s/iter; left time: 2620.8894s
	iters: 300, epoch: 9 | loss: 0.2587639
	speed: 0.3058s/iter; left time: 2602.1542s
	iters: 400, epoch: 9 | loss: 0.2462874
	speed: 0.3056s/iter; left time: 2569.7715s
	iters: 500, epoch: 9 | loss: 0.2571798
	speed: 0.3066s/iter; left time: 2547.6277s
	iters: 600, epoch: 9 | loss: 0.2312790
	speed: 0.3063s/iter; left time: 2514.1481s
	iters: 700, epoch: 9 | loss: 0.2457324
	speed: 0.3051s/iter; left time: 2474.3984s
Epoch: 9 cost time: 224.47026824951172
Epoch: 9, Steps: 734 | Train Loss: 0.2395908 Vali Loss: 0.3561032 Test Loss: 0.4400595
Validation loss decreased (0.357975 --> 0.356103).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.2312545
	speed: 0.6188s/iter; left time: 4935.2533s
	iters: 200, epoch: 10 | loss: 0.2380344
	speed: 0.3059s/iter; left time: 2409.1075s
	iters: 300, epoch: 10 | loss: 0.2330438
	speed: 0.3050s/iter; left time: 2371.6987s
	iters: 400, epoch: 10 | loss: 0.2222280
	speed: 0.3071s/iter; left time: 2357.2365s
	iters: 500, epoch: 10 | loss: 0.2623459
	speed: 0.3059s/iter; left time: 2317.3260s
	iters: 600, epoch: 10 | loss: 0.2135732
	speed: 0.3053s/iter; left time: 2282.2282s
	iters: 700, epoch: 10 | loss: 0.2360964
	speed: 0.3049s/iter; left time: 2248.9721s
Epoch: 10 cost time: 224.54525661468506
Epoch: 10, Steps: 734 | Train Loss: 0.2385960 Vali Loss: 0.3561220 Test Loss: 0.4393440
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.2411715
	speed: 0.6124s/iter; left time: 4434.7071s
	iters: 200, epoch: 11 | loss: 0.2255109
	speed: 0.3070s/iter; left time: 2192.4604s
	iters: 300, epoch: 11 | loss: 0.2371746
	speed: 0.3063s/iter; left time: 2156.4161s
	iters: 400, epoch: 11 | loss: 0.2562008
	speed: 0.3066s/iter; left time: 2128.1844s
	iters: 500, epoch: 11 | loss: 0.2333974
	speed: 0.3073s/iter; left time: 2102.4144s
	iters: 600, epoch: 11 | loss: 0.2250286
	speed: 0.3066s/iter; left time: 2066.5503s
	iters: 700, epoch: 11 | loss: 0.2201962
	speed: 0.3074s/iter; left time: 2041.6507s
Epoch: 11 cost time: 225.1431646347046
Epoch: 11, Steps: 734 | Train Loss: 0.2380663 Vali Loss: 0.3554056 Test Loss: 0.4391246
Validation loss decreased (0.356103 --> 0.355406).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.2306573
	speed: 0.6184s/iter; left time: 4024.0017s
	iters: 200, epoch: 12 | loss: 0.2221469
	speed: 0.3065s/iter; left time: 1963.7543s
	iters: 300, epoch: 12 | loss: 0.2299303
	speed: 0.3059s/iter; left time: 1929.5479s
	iters: 400, epoch: 12 | loss: 0.2074836
	speed: 0.3069s/iter; left time: 1905.1051s
	iters: 500, epoch: 12 | loss: 0.2251312
	speed: 0.3064s/iter; left time: 1870.9106s
	iters: 600, epoch: 12 | loss: 0.2529871
	speed: 0.3058s/iter; left time: 1836.7947s
	iters: 700, epoch: 12 | loss: 0.2353456
	speed: 0.3060s/iter; left time: 1807.6336s
Epoch: 12 cost time: 224.77161645889282
Epoch: 12, Steps: 734 | Train Loss: 0.2377926 Vali Loss: 0.3552075 Test Loss: 0.4390379
Validation loss decreased (0.355406 --> 0.355207).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.2230369
	speed: 0.6164s/iter; left time: 3558.7197s
	iters: 200, epoch: 13 | loss: 0.2411538
	speed: 0.3053s/iter; left time: 1732.1319s
	iters: 300, epoch: 13 | loss: 0.2562867
	speed: 0.3059s/iter; left time: 1704.5428s
	iters: 400, epoch: 13 | loss: 0.2515194
	speed: 0.3057s/iter; left time: 1672.9209s
	iters: 500, epoch: 13 | loss: 0.2677929
	speed: 0.3050s/iter; left time: 1638.9637s
	iters: 600, epoch: 13 | loss: 0.2851022
	speed: 0.3060s/iter; left time: 1613.3785s
	iters: 700, epoch: 13 | loss: 0.2336375
	speed: 0.3055s/iter; left time: 1580.5204s
Epoch: 13 cost time: 224.46004009246826
Epoch: 13, Steps: 734 | Train Loss: 0.2376309 Vali Loss: 0.3551486 Test Loss: 0.4389407
Validation loss decreased (0.355207 --> 0.355149).  Saving model ...
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 14 | loss: 0.2114614
	speed: 0.6155s/iter; left time: 3101.4949s
	iters: 200, epoch: 14 | loss: 0.2362064
	speed: 0.3059s/iter; left time: 1510.9426s
	iters: 300, epoch: 14 | loss: 0.2498078
	speed: 0.3054s/iter; left time: 1478.0089s
	iters: 400, epoch: 14 | loss: 0.2357183
	speed: 0.3054s/iter; left time: 1447.2349s
	iters: 500, epoch: 14 | loss: 0.2517016
	speed: 0.3059s/iter; left time: 1418.9063s
	iters: 600, epoch: 14 | loss: 0.2359894
	speed: 0.3055s/iter; left time: 1386.7992s
	iters: 700, epoch: 14 | loss: 0.2539816
	speed: 0.3084s/iter; left time: 1369.1252s
Epoch: 14 cost time: 224.75250482559204
Epoch: 14, Steps: 734 | Train Loss: 0.2375349 Vali Loss: 0.3554460 Test Loss: 0.4389254
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 15 | loss: 0.2405223
	speed: 0.6176s/iter; left time: 2658.6445s
	iters: 200, epoch: 15 | loss: 0.2218607
	speed: 0.3078s/iter; left time: 1294.2000s
	iters: 300, epoch: 15 | loss: 0.2457865
	speed: 0.3063s/iter; left time: 1257.4449s
	iters: 400, epoch: 15 | loss: 0.2189423
	speed: 0.3067s/iter; left time: 1228.2769s
	iters: 500, epoch: 15 | loss: 0.2466189
	speed: 0.3062s/iter; left time: 1195.6452s
	iters: 600, epoch: 15 | loss: 0.2338645
	speed: 0.3056s/iter; left time: 1162.9453s
	iters: 700, epoch: 15 | loss: 0.2494524
	speed: 0.3053s/iter; left time: 1131.0469s
Epoch: 15 cost time: 225.0487575531006
Epoch: 15, Steps: 734 | Train Loss: 0.2375291 Vali Loss: 0.3552026 Test Loss: 0.4389272
EarlyStopping counter: 2 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 16 | loss: 0.2412705
	speed: 0.6144s/iter; left time: 2193.9338s
	iters: 200, epoch: 16 | loss: 0.2275787
	speed: 0.3070s/iter; left time: 1065.4281s
	iters: 300, epoch: 16 | loss: 0.2346821
	speed: 0.3065s/iter; left time: 1033.1196s
	iters: 400, epoch: 16 | loss: 0.2530995
	speed: 0.3059s/iter; left time: 1000.4641s
	iters: 500, epoch: 16 | loss: 0.2294866
	speed: 0.3060s/iter; left time: 970.4237s
	iters: 600, epoch: 16 | loss: 0.2357395
	speed: 0.3061s/iter; left time: 940.0827s
	iters: 700, epoch: 16 | loss: 0.2375324
	speed: 0.3064s/iter; left time: 910.3935s
Epoch: 16 cost time: 224.8782320022583
Epoch: 16, Steps: 734 | Train Loss: 0.2374746 Vali Loss: 0.3553806 Test Loss: 0.4389260
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 17 | loss: 0.2592016
	speed: 0.6155s/iter; left time: 1746.2108s
	iters: 200, epoch: 17 | loss: 0.2480886
	speed: 0.3066s/iter; left time: 839.0450s
	iters: 300, epoch: 17 | loss: 0.2273374
	speed: 0.3060s/iter; left time: 807.0448s
	iters: 400, epoch: 17 | loss: 0.2507860
	speed: 0.3065s/iter; left time: 777.5880s
	iters: 500, epoch: 17 | loss: 0.2298285
	speed: 0.3061s/iter; left time: 745.8488s
	iters: 600, epoch: 17 | loss: 0.2208827
	speed: 0.3067s/iter; left time: 716.7971s
	iters: 700, epoch: 17 | loss: 0.2256600
	speed: 0.3068s/iter; left time: 686.2644s
Epoch: 17 cost time: 224.95753049850464
Epoch: 17, Steps: 734 | Train Loss: 0.2374758 Vali Loss: 0.3550194 Test Loss: 0.4389253
Validation loss decreased (0.355149 --> 0.355019).  Saving model ...
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 18 | loss: 0.2351737
	speed: 0.6163s/iter; left time: 1296.0036s
	iters: 200, epoch: 18 | loss: 0.2626839
	speed: 0.3065s/iter; left time: 614.0041s
	iters: 300, epoch: 18 | loss: 0.2435261
	speed: 0.3070s/iter; left time: 584.1546s
	iters: 400, epoch: 18 | loss: 0.2308250
	speed: 0.3086s/iter; left time: 556.3351s
	iters: 500, epoch: 18 | loss: 0.2209541
	speed: 0.3067s/iter; left time: 522.2357s
	iters: 600, epoch: 18 | loss: 0.2483803
	speed: 0.3062s/iter; left time: 490.8159s
	iters: 700, epoch: 18 | loss: 0.2394870
	speed: 0.3056s/iter; left time: 459.3359s
Epoch: 18 cost time: 225.11238145828247
Epoch: 18, Steps: 734 | Train Loss: 0.2374595 Vali Loss: 0.3552816 Test Loss: 0.4389250
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 19 | loss: 0.2180029
	speed: 0.6148s/iter; left time: 841.7155s
	iters: 200, epoch: 19 | loss: 0.2194120
	speed: 0.3068s/iter; left time: 389.3258s
	iters: 300, epoch: 19 | loss: 0.2365056
	speed: 0.3065s/iter; left time: 358.3191s
	iters: 400, epoch: 19 | loss: 0.2329390
	speed: 0.3056s/iter; left time: 326.6885s
	iters: 500, epoch: 19 | loss: 0.2401842
	speed: 0.3052s/iter; left time: 295.7145s
	iters: 600, epoch: 19 | loss: 0.2182311
	speed: 0.3055s/iter; left time: 265.4489s
	iters: 700, epoch: 19 | loss: 0.2498509
	speed: 0.3068s/iter; left time: 235.9590s
Epoch: 19 cost time: 224.67921900749207
Epoch: 19, Steps: 734 | Train Loss: 0.2374736 Vali Loss: 0.3550911 Test Loss: 0.4389246
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 20 | loss: 0.2258336
	speed: 0.6145s/iter; left time: 390.1844s
	iters: 200, epoch: 20 | loss: 0.2382103
	speed: 0.3050s/iter; left time: 163.1661s
	iters: 300, epoch: 20 | loss: 0.2064890
	speed: 0.3046s/iter; left time: 132.4795s
	iters: 400, epoch: 20 | loss: 0.2630002
	speed: 0.3051s/iter; left time: 102.2163s
	iters: 500, epoch: 20 | loss: 0.2272099
	speed: 0.3048s/iter; left time: 71.6192s
	iters: 600, epoch: 20 | loss: 0.2320921
	speed: 0.3061s/iter; left time: 41.3257s
	iters: 700, epoch: 20 | loss: 0.2064159
	speed: 0.3051s/iter; left time: 10.6782s
Epoch: 20 cost time: 223.99644327163696
Epoch: 20, Steps: 734 | Train Loss: 0.2374868 Vali Loss: 0.3550897 Test Loss: 0.4389247
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.9073486328125e-08
>>>>>>>testing : traffic_336_192_Linear_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed12890<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3317
mse:0.4386131167411804, mae:0.3040023744106293
