Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='NLinear', model_id='Electricity_336_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=336, root_path='./dataset/', save_pred_values=False, seed=15349, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : Electricity_336_336_NLinear_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15349>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17741
val 2297
test 4925
	iters: 100, epoch: 1 | loss: 0.3082299
	speed: 0.0991s/iter; left time: 2186.6196s
	iters: 200, epoch: 1 | loss: 0.2574878
	speed: 0.0861s/iter; left time: 1891.5423s
	iters: 300, epoch: 1 | loss: 0.2567968
	speed: 0.0859s/iter; left time: 1876.7700s
	iters: 400, epoch: 1 | loss: 0.2555611
	speed: 0.0852s/iter; left time: 1854.1492s
	iters: 500, epoch: 1 | loss: 0.2340136
	speed: 0.0851s/iter; left time: 1843.3272s
	iters: 600, epoch: 1 | loss: 0.2604439
	speed: 0.0857s/iter; left time: 1846.7411s
	iters: 700, epoch: 1 | loss: 0.3088639
	speed: 0.0855s/iter; left time: 1834.6742s
	iters: 800, epoch: 1 | loss: 0.2477291
	speed: 0.0853s/iter; left time: 1822.1802s
	iters: 900, epoch: 1 | loss: 0.3355779
	speed: 0.0848s/iter; left time: 1803.1255s
	iters: 1000, epoch: 1 | loss: 0.2388206
	speed: 0.0863s/iter; left time: 1826.1451s
	iters: 1100, epoch: 1 | loss: 0.2606112
	speed: 0.0858s/iter; left time: 1806.0568s
Epoch: 1 cost time: 96.21590209007263
Epoch: 1, Steps: 1108 | Train Loss: 0.2780744 Vali Loss: 0.2242250 Test Loss: 0.2591091
Validation loss decreased (inf --> 0.224225).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.2443537
	speed: 0.2514s/iter; left time: 5266.7175s
	iters: 200, epoch: 2 | loss: 0.2410257
	speed: 0.0897s/iter; left time: 1870.1614s
	iters: 300, epoch: 2 | loss: 0.2678476
	speed: 0.0874s/iter; left time: 1814.4191s
	iters: 400, epoch: 2 | loss: 0.2760357
	speed: 0.0856s/iter; left time: 1768.3451s
	iters: 500, epoch: 2 | loss: 0.2355891
	speed: 0.0851s/iter; left time: 1748.8908s
	iters: 600, epoch: 2 | loss: 0.2515499
	speed: 0.0843s/iter; left time: 1724.2992s
	iters: 700, epoch: 2 | loss: 0.2638991
	speed: 0.0845s/iter; left time: 1720.2514s
	iters: 800, epoch: 2 | loss: 0.2294880
	speed: 0.0846s/iter; left time: 1713.0162s
	iters: 900, epoch: 2 | loss: 0.2728290
	speed: 0.0855s/iter; left time: 1723.2859s
	iters: 1000, epoch: 2 | loss: 0.2238030
	speed: 0.0848s/iter; left time: 1700.9760s
	iters: 1100, epoch: 2 | loss: 0.2408417
	speed: 0.0849s/iter; left time: 1694.9382s
Epoch: 2 cost time: 95.59737992286682
Epoch: 2, Steps: 1108 | Train Loss: 0.2680764 Vali Loss: 0.2289174 Test Loss: 0.2588108
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.2055069
	speed: 0.2265s/iter; left time: 4495.3398s
	iters: 200, epoch: 3 | loss: 0.1755451
	speed: 0.0874s/iter; left time: 1726.3326s
	iters: 300, epoch: 3 | loss: 0.1840998
	speed: 0.0892s/iter; left time: 1753.0135s
	iters: 400, epoch: 3 | loss: 0.1939331
	speed: 0.0861s/iter; left time: 1682.2728s
	iters: 500, epoch: 3 | loss: 0.1891250
	speed: 0.0851s/iter; left time: 1654.7518s
	iters: 600, epoch: 3 | loss: 0.2330135
	speed: 0.0854s/iter; left time: 1652.8678s
	iters: 700, epoch: 3 | loss: 0.1886368
	speed: 0.0862s/iter; left time: 1659.1515s
	iters: 800, epoch: 3 | loss: 0.2386627
	speed: 0.0863s/iter; left time: 1651.2650s
	iters: 900, epoch: 3 | loss: 0.2462873
	speed: 0.0854s/iter; left time: 1626.0291s
	iters: 1000, epoch: 3 | loss: 0.2182149
	speed: 0.0858s/iter; left time: 1626.0053s
	iters: 1100, epoch: 3 | loss: 0.2226494
	speed: 0.0861s/iter; left time: 1623.2991s
Epoch: 3 cost time: 95.59354996681213
Epoch: 3, Steps: 1108 | Train Loss: 0.2068252 Vali Loss: 0.1782803 Test Loss: 0.2033353
Validation loss decreased (0.224225 --> 0.178280).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.1660399
	speed: 0.2452s/iter; left time: 4594.5369s
	iters: 200, epoch: 4 | loss: 0.1717512
	speed: 0.0877s/iter; left time: 1634.7780s
	iters: 300, epoch: 4 | loss: 0.1499913
	speed: 0.0889s/iter; left time: 1648.2791s
	iters: 400, epoch: 4 | loss: 0.2144547
	speed: 0.0879s/iter; left time: 1620.4072s
	iters: 500, epoch: 4 | loss: 0.1861416
	speed: 0.0874s/iter; left time: 1602.2128s
	iters: 600, epoch: 4 | loss: 0.1754539
	speed: 0.0869s/iter; left time: 1585.4139s
	iters: 700, epoch: 4 | loss: 0.1848265
	speed: 0.0853s/iter; left time: 1547.7960s
	iters: 800, epoch: 4 | loss: 0.1676215
	speed: 0.0853s/iter; left time: 1538.7838s
	iters: 900, epoch: 4 | loss: 0.1920575
	speed: 0.0865s/iter; left time: 1550.8787s
	iters: 1000, epoch: 4 | loss: 0.1927176
	speed: 0.0847s/iter; left time: 1511.6680s
	iters: 1100, epoch: 4 | loss: 0.1717213
	speed: 0.0848s/iter; left time: 1503.4956s
Epoch: 4 cost time: 96.02958822250366
Epoch: 4, Steps: 1108 | Train Loss: 0.1868501 Vali Loss: 0.1634950 Test Loss: 0.1876500
Validation loss decreased (0.178280 --> 0.163495).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.2179196
	speed: 0.2420s/iter; left time: 4266.3596s
	iters: 200, epoch: 5 | loss: 0.1463952
	speed: 0.0851s/iter; left time: 1492.0527s
	iters: 300, epoch: 5 | loss: 0.1897313
	speed: 0.0872s/iter; left time: 1520.4382s
	iters: 400, epoch: 5 | loss: 0.1761546
	speed: 0.0895s/iter; left time: 1551.6343s
	iters: 500, epoch: 5 | loss: 0.2032999
	speed: 0.0912s/iter; left time: 1570.8806s
	iters: 600, epoch: 5 | loss: 0.1734254
	speed: 0.0891s/iter; left time: 1526.7180s
	iters: 700, epoch: 5 | loss: 0.1588963
	speed: 0.0846s/iter; left time: 1440.4662s
	iters: 800, epoch: 5 | loss: 0.1578192
	speed: 0.0852s/iter; left time: 1441.8144s
	iters: 900, epoch: 5 | loss: 0.1875779
	speed: 0.0846s/iter; left time: 1422.9709s
	iters: 1000, epoch: 5 | loss: 0.1858763
	speed: 0.0841s/iter; left time: 1406.5626s
	iters: 1100, epoch: 5 | loss: 0.1796275
	speed: 0.0837s/iter; left time: 1392.3884s
Epoch: 5 cost time: 95.70824193954468
Epoch: 5, Steps: 1108 | Train Loss: 0.1774184 Vali Loss: 0.1563042 Test Loss: 0.1814477
Validation loss decreased (0.163495 --> 0.156304).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.1490527
	speed: 0.2404s/iter; left time: 3971.1240s
	iters: 200, epoch: 6 | loss: 0.2101906
	speed: 0.0837s/iter; left time: 1374.9173s
	iters: 300, epoch: 6 | loss: 0.1691582
	speed: 0.0835s/iter; left time: 1362.0925s
	iters: 400, epoch: 6 | loss: 0.1980655
	speed: 0.0842s/iter; left time: 1365.3567s
	iters: 500, epoch: 6 | loss: 0.1914079
	speed: 0.0854s/iter; left time: 1375.9800s
	iters: 600, epoch: 6 | loss: 0.1526761
	speed: 0.0861s/iter; left time: 1379.4944s
	iters: 700, epoch: 6 | loss: 0.1680389
	speed: 0.0873s/iter; left time: 1390.1175s
	iters: 800, epoch: 6 | loss: 0.1407901
	speed: 0.0848s/iter; left time: 1341.1218s
	iters: 900, epoch: 6 | loss: 0.2092743
	speed: 0.0851s/iter; left time: 1337.6059s
	iters: 1000, epoch: 6 | loss: 0.1559745
	speed: 0.0851s/iter; left time: 1329.1008s
	iters: 1100, epoch: 6 | loss: 0.2018226
	speed: 0.0857s/iter; left time: 1330.1337s
Epoch: 6 cost time: 94.29868865013123
Epoch: 6, Steps: 1108 | Train Loss: 0.1720356 Vali Loss: 0.1495698 Test Loss: 0.1736797
Validation loss decreased (0.156304 --> 0.149570).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.1888808
	speed: 0.2429s/iter; left time: 3743.6828s
	iters: 200, epoch: 7 | loss: 0.1558848
	speed: 0.0874s/iter; left time: 1338.9390s
	iters: 300, epoch: 7 | loss: 0.1583255
	speed: 0.0864s/iter; left time: 1314.2981s
	iters: 400, epoch: 7 | loss: 0.1766970
	speed: 0.0865s/iter; left time: 1307.1208s
	iters: 500, epoch: 7 | loss: 0.1608866
	speed: 0.0867s/iter; left time: 1301.6401s
	iters: 600, epoch: 7 | loss: 0.1659827
	speed: 0.0887s/iter; left time: 1322.2551s
	iters: 700, epoch: 7 | loss: 0.1595371
	speed: 0.0873s/iter; left time: 1293.7128s
	iters: 800, epoch: 7 | loss: 0.1513845
	speed: 0.0873s/iter; left time: 1285.0200s
	iters: 900, epoch: 7 | loss: 0.1522490
	speed: 0.0864s/iter; left time: 1262.4822s
	iters: 1000, epoch: 7 | loss: 0.2049775
	speed: 0.0855s/iter; left time: 1241.2469s
	iters: 1100, epoch: 7 | loss: 0.1861387
	speed: 0.0853s/iter; left time: 1228.8140s
Epoch: 7 cost time: 96.14585423469543
Epoch: 7, Steps: 1108 | Train Loss: 0.1690594 Vali Loss: 0.1467464 Test Loss: 0.1704461
Validation loss decreased (0.149570 --> 0.146746).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.1468920
	speed: 0.2442s/iter; left time: 3492.6716s
	iters: 200, epoch: 8 | loss: 0.1845321
	speed: 0.0870s/iter; left time: 1235.1614s
	iters: 300, epoch: 8 | loss: 0.2281478
	speed: 0.0864s/iter; left time: 1219.3701s
	iters: 400, epoch: 8 | loss: 0.1638391
	speed: 0.0863s/iter; left time: 1208.2327s
	iters: 500, epoch: 8 | loss: 0.1600569
	speed: 0.0853s/iter; left time: 1186.1975s
	iters: 600, epoch: 8 | loss: 0.1820000
	speed: 0.0858s/iter; left time: 1183.9802s
	iters: 700, epoch: 8 | loss: 0.1682686
	speed: 0.0879s/iter; left time: 1204.0544s
	iters: 800, epoch: 8 | loss: 0.1444605
	speed: 0.0884s/iter; left time: 1203.2070s
	iters: 900, epoch: 8 | loss: 0.1459896
	speed: 0.0899s/iter; left time: 1214.3688s
	iters: 1000, epoch: 8 | loss: 0.1566136
	speed: 0.0857s/iter; left time: 1149.3697s
	iters: 1100, epoch: 8 | loss: 0.1690975
	speed: 0.0854s/iter; left time: 1135.9244s
Epoch: 8 cost time: 96.24921917915344
Epoch: 8, Steps: 1108 | Train Loss: 0.1674378 Vali Loss: 0.1461617 Test Loss: 0.1693121
Validation loss decreased (0.146746 --> 0.146162).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.1864296
	speed: 0.2430s/iter; left time: 3206.9927s
	iters: 200, epoch: 9 | loss: 0.1538399
	speed: 0.0850s/iter; left time: 1113.6180s
	iters: 300, epoch: 9 | loss: 0.1642803
	speed: 0.0851s/iter; left time: 1105.4959s
	iters: 400, epoch: 9 | loss: 0.1539552
	speed: 0.0848s/iter; left time: 1093.9078s
	iters: 500, epoch: 9 | loss: 0.1823266
	speed: 0.0855s/iter; left time: 1093.7562s
	iters: 600, epoch: 9 | loss: 0.1546043
	speed: 0.0855s/iter; left time: 1085.7757s
	iters: 700, epoch: 9 | loss: 0.2000597
	speed: 0.0851s/iter; left time: 1072.6038s
	iters: 800, epoch: 9 | loss: 0.1583268
	speed: 0.0866s/iter; left time: 1082.1439s
	iters: 900, epoch: 9 | loss: 0.1314880
	speed: 0.0871s/iter; left time: 1079.3714s
	iters: 1000, epoch: 9 | loss: 0.1794630
	speed: 0.0877s/iter; left time: 1078.4013s
	iters: 1100, epoch: 9 | loss: 0.1951844
	speed: 0.0865s/iter; left time: 1054.7564s
Epoch: 9 cost time: 95.2711250782013
Epoch: 9, Steps: 1108 | Train Loss: 0.1665562 Vali Loss: 0.1454270 Test Loss: 0.1685924
Validation loss decreased (0.146162 --> 0.145427).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.1888845
	speed: 0.2425s/iter; left time: 2932.1396s
	iters: 200, epoch: 10 | loss: 0.1439236
	speed: 0.0858s/iter; left time: 1029.0570s
	iters: 300, epoch: 10 | loss: 0.1378777
	speed: 0.0863s/iter; left time: 1026.0172s
	iters: 400, epoch: 10 | loss: 0.1724221
	speed: 0.0870s/iter; left time: 1025.4741s
	iters: 500, epoch: 10 | loss: 0.1515051
	speed: 0.0880s/iter; left time: 1028.2646s
	iters: 600, epoch: 10 | loss: 0.1532129
	speed: 0.0871s/iter; left time: 1008.9178s
	iters: 700, epoch: 10 | loss: 0.1581097
	speed: 0.0876s/iter; left time: 1006.0121s
	iters: 800, epoch: 10 | loss: 0.1623759
	speed: 0.0863s/iter; left time: 982.7915s
	iters: 900, epoch: 10 | loss: 0.1491683
	speed: 0.0874s/iter; left time: 986.8015s
	iters: 1000, epoch: 10 | loss: 0.1845310
	speed: 0.0891s/iter; left time: 996.8457s
	iters: 1100, epoch: 10 | loss: 0.1517978
	speed: 0.0862s/iter; left time: 956.2060s
Epoch: 10 cost time: 96.46095275878906
Epoch: 10, Steps: 1108 | Train Loss: 0.1660752 Vali Loss: 0.1451160 Test Loss: 0.1680669
Validation loss decreased (0.145427 --> 0.145116).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.1537312
	speed: 0.2447s/iter; left time: 2687.1172s
	iters: 200, epoch: 11 | loss: 0.1854177
	speed: 0.0858s/iter; left time: 933.0717s
	iters: 300, epoch: 11 | loss: 0.1532686
	speed: 0.0853s/iter; left time: 919.9322s
	iters: 400, epoch: 11 | loss: 0.1530020
	speed: 0.0859s/iter; left time: 917.4623s
	iters: 500, epoch: 11 | loss: 0.1592578
	speed: 0.0850s/iter; left time: 899.2201s
	iters: 600, epoch: 11 | loss: 0.1756006
	speed: 0.0852s/iter; left time: 892.6253s
	iters: 700, epoch: 11 | loss: 0.1425177
	speed: 0.0860s/iter; left time: 892.7379s
	iters: 800, epoch: 11 | loss: 0.1538114
	speed: 0.0849s/iter; left time: 872.4610s
	iters: 900, epoch: 11 | loss: 0.1494228
	speed: 0.0856s/iter; left time: 871.2855s
	iters: 1000, epoch: 11 | loss: 0.1825894
	speed: 0.0887s/iter; left time: 894.0291s
	iters: 1100, epoch: 11 | loss: 0.1381237
	speed: 0.0896s/iter; left time: 894.7548s
Epoch: 11 cost time: 95.64109539985657
Epoch: 11, Steps: 1108 | Train Loss: 0.1658444 Vali Loss: 0.1449160 Test Loss: 0.1679890
Validation loss decreased (0.145116 --> 0.144916).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.1506531
	speed: 0.2459s/iter; left time: 2427.3885s
	iters: 200, epoch: 12 | loss: 0.1528209
	speed: 0.0849s/iter; left time: 829.6517s
	iters: 300, epoch: 12 | loss: 0.1768458
	speed: 0.0849s/iter; left time: 821.2408s
	iters: 400, epoch: 12 | loss: 0.1775523
	speed: 0.0851s/iter; left time: 815.0674s
	iters: 500, epoch: 12 | loss: 0.1410415
	speed: 0.0850s/iter; left time: 804.8529s
	iters: 600, epoch: 12 | loss: 0.1468864
	speed: 0.0850s/iter; left time: 796.8847s
	iters: 700, epoch: 12 | loss: 0.1382168
	speed: 0.0847s/iter; left time: 785.7965s
	iters: 800, epoch: 12 | loss: 0.1423795
	speed: 0.0852s/iter; left time: 781.9256s
	iters: 900, epoch: 12 | loss: 0.1739291
	speed: 0.0852s/iter; left time: 772.8013s
	iters: 1000, epoch: 12 | loss: 0.1493270
	speed: 0.0853s/iter; left time: 765.7477s
	iters: 1100, epoch: 12 | loss: 0.1599939
	speed: 0.0853s/iter; left time: 756.9915s
Epoch: 12 cost time: 94.41653561592102
Epoch: 12, Steps: 1108 | Train Loss: 0.1657205 Vali Loss: 0.1448618 Test Loss: 0.1678806
Validation loss decreased (0.144916 --> 0.144862).  Saving model ...
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.1553255
	speed: 0.2490s/iter; left time: 2182.3871s
	iters: 200, epoch: 13 | loss: 0.1518415
	speed: 0.0863s/iter; left time: 747.9149s
	iters: 300, epoch: 13 | loss: 0.1566927
	speed: 0.0854s/iter; left time: 731.7959s
	iters: 400, epoch: 13 | loss: 0.1457046
	speed: 0.0850s/iter; left time: 719.8943s
	iters: 500, epoch: 13 | loss: 0.1692432
	speed: 0.0857s/iter; left time: 717.1723s
	iters: 600, epoch: 13 | loss: 0.1933798
	speed: 0.0859s/iter; left time: 710.2368s
	iters: 700, epoch: 13 | loss: 0.1578752
	speed: 0.0870s/iter; left time: 710.2712s
	iters: 800, epoch: 13 | loss: 0.1430200
	speed: 0.0862s/iter; left time: 695.5029s
	iters: 900, epoch: 13 | loss: 0.1629107
	speed: 0.0865s/iter; left time: 689.2062s
	iters: 1000, epoch: 13 | loss: 0.1759276
	speed: 0.0864s/iter; left time: 679.7751s
	iters: 1100, epoch: 13 | loss: 0.1642556
	speed: 0.0851s/iter; left time: 660.6894s
Epoch: 13 cost time: 95.398508310318
Epoch: 13, Steps: 1108 | Train Loss: 0.1656524 Vali Loss: 0.1448583 Test Loss: 0.1678413
Validation loss decreased (0.144862 --> 0.144858).  Saving model ...
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.1451421
	speed: 0.2486s/iter; left time: 1903.3353s
	iters: 200, epoch: 14 | loss: 0.1618734
	speed: 0.0872s/iter; left time: 659.1893s
	iters: 300, epoch: 14 | loss: 0.1532527
	speed: 0.0859s/iter; left time: 640.3746s
	iters: 400, epoch: 14 | loss: 0.1596127
	speed: 0.0860s/iter; left time: 632.6678s
	iters: 500, epoch: 14 | loss: 0.1622690
	speed: 0.0865s/iter; left time: 627.7729s
	iters: 600, epoch: 14 | loss: 0.1788591
	speed: 0.0865s/iter; left time: 618.8638s
	iters: 700, epoch: 14 | loss: 0.1665119
	speed: 0.0853s/iter; left time: 601.6764s
	iters: 800, epoch: 14 | loss: 0.1705278
	speed: 0.0855s/iter; left time: 594.6705s
	iters: 900, epoch: 14 | loss: 0.1487836
	speed: 0.0856s/iter; left time: 586.6987s
	iters: 1000, epoch: 14 | loss: 0.1623001
	speed: 0.0871s/iter; left time: 588.4461s
	iters: 1100, epoch: 14 | loss: 0.1606282
	speed: 0.0859s/iter; left time: 571.9389s
Epoch: 14 cost time: 95.7069263458252
Epoch: 14, Steps: 1108 | Train Loss: 0.1656047 Vali Loss: 0.1448545 Test Loss: 0.1678326
Validation loss decreased (0.144858 --> 0.144854).  Saving model ...
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.1889224
	speed: 0.2491s/iter; left time: 1631.0365s
	iters: 200, epoch: 15 | loss: 0.1553552
	speed: 0.0907s/iter; left time: 584.9214s
	iters: 300, epoch: 15 | loss: 0.1598999
	speed: 0.0898s/iter; left time: 570.2685s
	iters: 400, epoch: 15 | loss: 0.1836672
	speed: 0.0858s/iter; left time: 536.4586s
	iters: 500, epoch: 15 | loss: 0.2137570
	speed: 0.0847s/iter; left time: 520.5228s
	iters: 600, epoch: 15 | loss: 0.1979526
	speed: 0.0846s/iter; left time: 511.8209s
	iters: 700, epoch: 15 | loss: 0.1475928
	speed: 0.0850s/iter; left time: 505.5485s
	iters: 800, epoch: 15 | loss: 0.1539443
	speed: 0.0847s/iter; left time: 495.4297s
	iters: 900, epoch: 15 | loss: 0.1496979
	speed: 0.0849s/iter; left time: 488.2397s
	iters: 1000, epoch: 15 | loss: 0.1368685
	speed: 0.0848s/iter; left time: 478.9258s
	iters: 1100, epoch: 15 | loss: 0.1859053
	speed: 0.0848s/iter; left time: 470.5894s
Epoch: 15 cost time: 95.86990690231323
Epoch: 15, Steps: 1108 | Train Loss: 0.1655899 Vali Loss: 0.1448387 Test Loss: 0.1678345
Validation loss decreased (0.144854 --> 0.144839).  Saving model ...
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.1752407
	speed: 0.2418s/iter; left time: 1315.8280s
	iters: 200, epoch: 16 | loss: 0.1743021
	speed: 0.0868s/iter; left time: 463.5268s
	iters: 300, epoch: 16 | loss: 0.1788960
	speed: 0.0862s/iter; left time: 451.8927s
	iters: 400, epoch: 16 | loss: 0.1661747
	speed: 0.0860s/iter; left time: 442.2045s
	iters: 500, epoch: 16 | loss: 0.1927111
	speed: 0.0852s/iter; left time: 429.3023s
	iters: 600, epoch: 16 | loss: 0.1441884
	speed: 0.0851s/iter; left time: 420.6705s
	iters: 700, epoch: 16 | loss: 0.1630288
	speed: 0.0849s/iter; left time: 410.9486s
	iters: 800, epoch: 16 | loss: 0.1661408
	speed: 0.0855s/iter; left time: 405.2135s
	iters: 900, epoch: 16 | loss: 0.1556341
	speed: 0.0851s/iter; left time: 395.0287s
	iters: 1000, epoch: 16 | loss: 0.1492717
	speed: 0.0872s/iter; left time: 396.0941s
	iters: 1100, epoch: 16 | loss: 0.1603945
	speed: 0.0863s/iter; left time: 383.1097s
Epoch: 16 cost time: 95.0933084487915
Epoch: 16, Steps: 1108 | Train Loss: 0.1655375 Vali Loss: 0.1447581 Test Loss: 0.1678321
Validation loss decreased (0.144839 --> 0.144758).  Saving model ...
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 17 | loss: 0.1477961
	speed: 0.2426s/iter; left time: 1051.2188s
	iters: 200, epoch: 17 | loss: 0.1712473
	speed: 0.0873s/iter; left time: 369.4017s
	iters: 300, epoch: 17 | loss: 0.1467994
	speed: 0.0885s/iter; left time: 365.5919s
	iters: 400, epoch: 17 | loss: 0.1516534
	speed: 0.0862s/iter; left time: 347.5598s
	iters: 500, epoch: 17 | loss: 0.1942779
	speed: 0.0864s/iter; left time: 339.8401s
	iters: 600, epoch: 17 | loss: 0.1691544
	speed: 0.0848s/iter; left time: 325.0160s
	iters: 700, epoch: 17 | loss: 0.2061434
	speed: 0.0850s/iter; left time: 317.4668s
	iters: 800, epoch: 17 | loss: 0.1468486
	speed: 0.0858s/iter; left time: 311.5956s
	iters: 900, epoch: 17 | loss: 0.1408096
	speed: 0.0861s/iter; left time: 304.0609s
	iters: 1000, epoch: 17 | loss: 0.2375129
	speed: 0.0854s/iter; left time: 293.0646s
	iters: 1100, epoch: 17 | loss: 0.1638473
	speed: 0.0856s/iter; left time: 285.1497s
Epoch: 17 cost time: 95.29820251464844
Epoch: 17, Steps: 1108 | Train Loss: 0.1655579 Vali Loss: 0.1448430 Test Loss: 0.1678321
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 18 | loss: 0.1614128
	speed: 0.2260s/iter; left time: 728.8940s
	iters: 200, epoch: 18 | loss: 0.1951665
	speed: 0.0868s/iter; left time: 271.1974s
	iters: 300, epoch: 18 | loss: 0.1804669
	speed: 0.0872s/iter; left time: 263.6501s
	iters: 400, epoch: 18 | loss: 0.1541340
	speed: 0.0884s/iter; left time: 258.5949s
	iters: 500, epoch: 18 | loss: 0.1426447
	speed: 0.0923s/iter; left time: 260.7367s
	iters: 600, epoch: 18 | loss: 0.1495854
	speed: 0.0899s/iter; left time: 245.0991s
	iters: 700, epoch: 18 | loss: 0.1683320
	speed: 0.0865s/iter; left time: 227.1145s
	iters: 800, epoch: 18 | loss: 0.1725738
	speed: 0.0842s/iter; left time: 212.5141s
	iters: 900, epoch: 18 | loss: 0.1614850
	speed: 0.0845s/iter; left time: 204.8334s
	iters: 1000, epoch: 18 | loss: 0.1387885
	speed: 0.0852s/iter; left time: 197.9766s
	iters: 1100, epoch: 18 | loss: 0.1569019
	speed: 0.0848s/iter; left time: 188.5837s
Epoch: 18 cost time: 96.23086643218994
Epoch: 18, Steps: 1108 | Train Loss: 0.1655653 Vali Loss: 0.1447739 Test Loss: 0.1678322
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 19 | loss: 0.1551648
	speed: 0.2250s/iter; left time: 476.4095s
	iters: 200, epoch: 19 | loss: 0.1625990
	speed: 0.0855s/iter; left time: 172.5365s
	iters: 300, epoch: 19 | loss: 0.1420775
	speed: 0.0848s/iter; left time: 162.5916s
	iters: 400, epoch: 19 | loss: 0.1650995
	speed: 0.0859s/iter; left time: 156.0348s
	iters: 500, epoch: 19 | loss: 0.1711994
	speed: 0.0859s/iter; left time: 147.4866s
	iters: 600, epoch: 19 | loss: 0.1706146
	speed: 0.0861s/iter; left time: 139.1479s
	iters: 700, epoch: 19 | loss: 0.1967194
	speed: 0.0851s/iter; left time: 129.0746s
	iters: 800, epoch: 19 | loss: 0.2151308
	speed: 0.0851s/iter; left time: 120.5981s
	iters: 900, epoch: 19 | loss: 0.1697071
	speed: 0.0860s/iter; left time: 113.3027s
	iters: 1000, epoch: 19 | loss: 0.1844469
	speed: 0.0865s/iter; left time: 105.2141s
	iters: 1100, epoch: 19 | loss: 0.1806104
	speed: 0.0860s/iter; left time: 96.0114s
Epoch: 19 cost time: 94.92520093917847
Epoch: 19, Steps: 1108 | Train Loss: 0.1655817 Vali Loss: 0.1447923 Test Loss: 0.1678321
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.9073486328125e-08
	iters: 100, epoch: 20 | loss: 0.1382595
	speed: 0.2298s/iter; left time: 231.8333s
	iters: 200, epoch: 20 | loss: 0.1561128
	speed: 0.0870s/iter; left time: 79.0563s
	iters: 300, epoch: 20 | loss: 0.1612915
	speed: 0.0879s/iter; left time: 71.1193s
	iters: 400, epoch: 20 | loss: 0.1646621
	speed: 0.0883s/iter; left time: 62.5895s
	iters: 500, epoch: 20 | loss: 0.1613099
	speed: 0.0871s/iter; left time: 53.0503s
	iters: 600, epoch: 20 | loss: 0.1462376
	speed: 0.0881s/iter; left time: 44.8361s
	iters: 700, epoch: 20 | loss: 0.1559464
	speed: 0.0886s/iter; left time: 36.2298s
	iters: 800, epoch: 20 | loss: 0.1535397
	speed: 0.0873s/iter; left time: 26.9846s
	iters: 900, epoch: 20 | loss: 0.1436142
	speed: 0.0872s/iter; left time: 18.2311s
	iters: 1000, epoch: 20 | loss: 0.1632133
	speed: 0.0851s/iter; left time: 9.2735s
	iters: 1100, epoch: 20 | loss: 0.2285275
	speed: 0.0849s/iter; left time: 0.7642s
Epoch: 20 cost time: 96.52377367019653
Epoch: 20, Steps: 1108 | Train Loss: 0.1655618 Vali Loss: 0.1447893 Test Loss: 0.1678320
EarlyStopping counter: 4 out of 5
Updating learning rate to 9.5367431640625e-09
>>>>>>>testing : Electricity_336_336_NLinear_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15349<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4925
mse:0.1677199751138687, mae:0.2601846754550934
