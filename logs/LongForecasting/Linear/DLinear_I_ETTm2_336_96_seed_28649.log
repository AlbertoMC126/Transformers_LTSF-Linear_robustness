Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='DLinear', model_id='ETTm2_336_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=28649, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTm2_336_96_DLinear_ETTm2_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed28649>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34129
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.2552995
	speed: 0.0090s/iter; left time: 191.0250s
	iters: 200, epoch: 1 | loss: 0.3175918
	speed: 0.0076s/iter; left time: 160.1552s
	iters: 300, epoch: 1 | loss: 0.3690480
	speed: 0.0086s/iter; left time: 181.2552s
	iters: 400, epoch: 1 | loss: 0.4958303
	speed: 0.0091s/iter; left time: 190.6564s
	iters: 500, epoch: 1 | loss: 0.3372916
	speed: 0.0073s/iter; left time: 151.6287s
	iters: 600, epoch: 1 | loss: 0.3753512
	speed: 0.0084s/iter; left time: 174.6780s
	iters: 700, epoch: 1 | loss: 0.5004668
	speed: 0.0082s/iter; left time: 168.3263s
	iters: 800, epoch: 1 | loss: 0.3879527
	speed: 0.0075s/iter; left time: 153.7547s
	iters: 900, epoch: 1 | loss: 0.3198077
	speed: 0.0077s/iter; left time: 157.5165s
	iters: 1000, epoch: 1 | loss: 0.7396023
	speed: 0.0063s/iter; left time: 127.8279s
Epoch: 1 cost time: 8.596395254135132
Epoch: 1, Steps: 1066 | Train Loss: 0.4451831 Vali Loss: 0.4114022 Test Loss: 0.7720896
Validation loss decreased (inf --> 0.411402).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.3002035
	speed: 0.0358s/iter; left time: 722.1427s
	iters: 200, epoch: 2 | loss: 0.4234293
	speed: 0.0076s/iter; left time: 153.0698s
	iters: 300, epoch: 2 | loss: 0.3445334
	speed: 0.0079s/iter; left time: 157.4861s
	iters: 400, epoch: 2 | loss: 0.9858150
	speed: 0.0080s/iter; left time: 158.0570s
	iters: 500, epoch: 2 | loss: 0.3828377
	speed: 0.0087s/iter; left time: 171.9568s
	iters: 600, epoch: 2 | loss: 0.3411178
	speed: 0.0082s/iter; left time: 161.2111s
	iters: 700, epoch: 2 | loss: 0.4770091
	speed: 0.0078s/iter; left time: 151.6107s
	iters: 800, epoch: 2 | loss: 0.4130509
	speed: 0.0071s/iter; left time: 137.9970s
	iters: 900, epoch: 2 | loss: 0.5840555
	speed: 0.0077s/iter; left time: 149.8187s
	iters: 1000, epoch: 2 | loss: 0.2063750
	speed: 0.0078s/iter; left time: 150.9940s
Epoch: 2 cost time: 8.475062608718872
Epoch: 2, Steps: 1066 | Train Loss: 0.4368947 Vali Loss: 0.4058051 Test Loss: 0.7511104
Validation loss decreased (0.411402 --> 0.405805).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.5942988
	speed: 0.0376s/iter; left time: 717.8140s
	iters: 200, epoch: 3 | loss: 0.1987658
	speed: 0.0085s/iter; left time: 160.7056s
	iters: 300, epoch: 3 | loss: 0.1503589
	speed: 0.0084s/iter; left time: 158.8793s
	iters: 400, epoch: 3 | loss: 0.2955073
	speed: 0.0085s/iter; left time: 159.8944s
	iters: 500, epoch: 3 | loss: 0.1667380
	speed: 0.0096s/iter; left time: 180.0385s
	iters: 600, epoch: 3 | loss: 0.2707945
	speed: 0.0094s/iter; left time: 174.9617s
	iters: 700, epoch: 3 | loss: 0.3065325
	speed: 0.0092s/iter; left time: 170.5240s
	iters: 800, epoch: 3 | loss: 0.4062976
	speed: 0.0084s/iter; left time: 154.3114s
	iters: 900, epoch: 3 | loss: 0.2533146
	speed: 0.0081s/iter; left time: 147.8087s
	iters: 1000, epoch: 3 | loss: 0.2181774
	speed: 0.0080s/iter; left time: 144.8265s
Epoch: 3 cost time: 9.235142707824707
Epoch: 3, Steps: 1066 | Train Loss: 0.2759023 Vali Loss: 0.3289083 Test Loss: 0.6136993
Validation loss decreased (0.405805 --> 0.328908).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.3027679
	speed: 0.0367s/iter; left time: 660.8769s
	iters: 200, epoch: 4 | loss: 0.1467314
	speed: 0.0081s/iter; left time: 145.0031s
	iters: 300, epoch: 4 | loss: 0.1684435
	speed: 0.0084s/iter; left time: 150.3163s
	iters: 400, epoch: 4 | loss: 0.5562472
	speed: 0.0082s/iter; left time: 144.8640s
	iters: 500, epoch: 4 | loss: 0.1954293
	speed: 0.0086s/iter; left time: 152.1363s
	iters: 600, epoch: 4 | loss: 0.3653230
	speed: 0.0058s/iter; left time: 101.2830s
	iters: 700, epoch: 4 | loss: 0.2365025
	speed: 0.0066s/iter; left time: 115.3803s
	iters: 800, epoch: 4 | loss: 0.1891757
	speed: 0.0085s/iter; left time: 146.3854s
	iters: 900, epoch: 4 | loss: 0.1724949
	speed: 0.0095s/iter; left time: 163.3939s
	iters: 1000, epoch: 4 | loss: 0.1966030
	speed: 0.0094s/iter; left time: 160.9979s
Epoch: 4 cost time: 8.657344579696655
Epoch: 4, Steps: 1066 | Train Loss: 0.2393208 Vali Loss: 0.2559089 Test Loss: 0.5372675
Validation loss decreased (0.328908 --> 0.255909).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.1800540
	speed: 0.0372s/iter; left time: 630.0572s
	iters: 200, epoch: 5 | loss: 0.2505911
	speed: 0.0083s/iter; left time: 140.2752s
	iters: 300, epoch: 5 | loss: 0.2029506
	speed: 0.0084s/iter; left time: 140.2964s
	iters: 400, epoch: 5 | loss: 0.1963649
	speed: 0.0081s/iter; left time: 135.1285s
	iters: 500, epoch: 5 | loss: 0.1294876
	speed: 0.0079s/iter; left time: 130.5240s
	iters: 600, epoch: 5 | loss: 0.3152202
	speed: 0.0079s/iter; left time: 129.6895s
	iters: 700, epoch: 5 | loss: 0.1842021
	speed: 0.0079s/iter; left time: 128.7441s
	iters: 800, epoch: 5 | loss: 0.1936609
	speed: 0.0079s/iter; left time: 127.6698s
	iters: 900, epoch: 5 | loss: 0.2031693
	speed: 0.0083s/iter; left time: 134.1493s
	iters: 1000, epoch: 5 | loss: 0.1246629
	speed: 0.0058s/iter; left time: 93.7812s
Epoch: 5 cost time: 8.244104862213135
Epoch: 5, Steps: 1066 | Train Loss: 0.2196759 Vali Loss: 0.1686972 Test Loss: 0.3208301
Validation loss decreased (0.255909 --> 0.168697).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.2122373
	speed: 0.0352s/iter; left time: 559.3766s
	iters: 200, epoch: 6 | loss: 0.1077467
	speed: 0.0077s/iter; left time: 121.3158s
	iters: 300, epoch: 6 | loss: 0.1031720
	speed: 0.0085s/iter; left time: 132.5975s
	iters: 400, epoch: 6 | loss: 0.1564882
	speed: 0.0086s/iter; left time: 134.2673s
	iters: 500, epoch: 6 | loss: 0.1455031
	speed: 0.0078s/iter; left time: 121.1580s
	iters: 600, epoch: 6 | loss: 0.2001908
	speed: 0.0090s/iter; left time: 138.6974s
	iters: 700, epoch: 6 | loss: 0.1165279
	speed: 0.0077s/iter; left time: 117.6423s
	iters: 800, epoch: 6 | loss: 0.1339291
	speed: 0.0079s/iter; left time: 120.0440s
	iters: 900, epoch: 6 | loss: 0.1562134
	speed: 0.0091s/iter; left time: 137.2317s
	iters: 1000, epoch: 6 | loss: 0.2176732
	speed: 0.0083s/iter; left time: 123.9820s
Epoch: 6 cost time: 8.741408348083496
Epoch: 6, Steps: 1066 | Train Loss: 0.2100354 Vali Loss: 0.1489609 Test Loss: 0.2626864
Validation loss decreased (0.168697 --> 0.148961).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.1852632
	speed: 0.0368s/iter; left time: 546.0415s
	iters: 200, epoch: 7 | loss: 0.2693304
	speed: 0.0081s/iter; left time: 118.5733s
	iters: 300, epoch: 7 | loss: 0.1246465
	speed: 0.0085s/iter; left time: 124.0670s
	iters: 400, epoch: 7 | loss: 0.1207929
	speed: 0.0090s/iter; left time: 131.3469s
	iters: 500, epoch: 7 | loss: 0.1712814
	speed: 0.0085s/iter; left time: 122.6133s
	iters: 600, epoch: 7 | loss: 0.2168124
	speed: 0.0076s/iter; left time: 108.6327s
	iters: 700, epoch: 7 | loss: 0.2693390
	speed: 0.0078s/iter; left time: 111.4099s
	iters: 800, epoch: 7 | loss: 0.1714534
	speed: 0.0086s/iter; left time: 121.2025s
	iters: 900, epoch: 7 | loss: 0.1316476
	speed: 0.0079s/iter; left time: 111.2435s
	iters: 1000, epoch: 7 | loss: 0.1504314
	speed: 0.0085s/iter; left time: 118.3705s
Epoch: 7 cost time: 8.85330843925476
Epoch: 7, Steps: 1066 | Train Loss: 0.2049289 Vali Loss: 0.1244046 Test Loss: 0.1796564
Validation loss decreased (0.148961 --> 0.124405).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.3264556
	speed: 0.0338s/iter; left time: 465.3293s
	iters: 200, epoch: 8 | loss: 0.2268959
	speed: 0.0091s/iter; left time: 124.6182s
	iters: 300, epoch: 8 | loss: 0.2280993
	speed: 0.0085s/iter; left time: 114.7459s
	iters: 400, epoch: 8 | loss: 0.3020857
	speed: 0.0083s/iter; left time: 111.5669s
	iters: 500, epoch: 8 | loss: 0.2348222
	speed: 0.0080s/iter; left time: 106.7733s
	iters: 600, epoch: 8 | loss: 0.2679667
	speed: 0.0082s/iter; left time: 108.6240s
	iters: 700, epoch: 8 | loss: 0.1750011
	speed: 0.0084s/iter; left time: 110.0484s
	iters: 800, epoch: 8 | loss: 0.1685311
	speed: 0.0082s/iter; left time: 107.2231s
	iters: 900, epoch: 8 | loss: 0.0846597
	speed: 0.0078s/iter; left time: 100.9503s
	iters: 1000, epoch: 8 | loss: 0.2125167
	speed: 0.0072s/iter; left time: 92.5961s
Epoch: 8 cost time: 8.644857168197632
Epoch: 8, Steps: 1066 | Train Loss: 0.2021016 Vali Loss: 0.1415507 Test Loss: 0.2356354
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.1107604
	speed: 0.0318s/iter; left time: 403.3405s
	iters: 200, epoch: 9 | loss: 0.2082759
	speed: 0.0075s/iter; left time: 93.9756s
	iters: 300, epoch: 9 | loss: 0.1582877
	speed: 0.0080s/iter; left time: 100.3339s
	iters: 400, epoch: 9 | loss: 0.1118369
	speed: 0.0087s/iter; left time: 107.7207s
	iters: 500, epoch: 9 | loss: 0.1370218
	speed: 0.0089s/iter; left time: 108.9481s
	iters: 600, epoch: 9 | loss: 0.1067701
	speed: 0.0079s/iter; left time: 96.0808s
	iters: 700, epoch: 9 | loss: 0.1236879
	speed: 0.0080s/iter; left time: 96.7758s
	iters: 800, epoch: 9 | loss: 0.2955359
	speed: 0.0085s/iter; left time: 101.9757s
	iters: 900, epoch: 9 | loss: 0.1343429
	speed: 0.0067s/iter; left time: 79.3358s
	iters: 1000, epoch: 9 | loss: 0.1740207
	speed: 0.0077s/iter; left time: 91.1842s
Epoch: 9 cost time: 8.483736276626587
Epoch: 9, Steps: 1066 | Train Loss: 0.2002234 Vali Loss: 0.1329034 Test Loss: 0.2137960
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.1711787
	speed: 0.0353s/iter; left time: 410.0413s
	iters: 200, epoch: 10 | loss: 0.1638484
	speed: 0.0077s/iter; left time: 88.6706s
	iters: 300, epoch: 10 | loss: 0.1146406
	speed: 0.0073s/iter; left time: 82.9842s
	iters: 400, epoch: 10 | loss: 0.1536603
	speed: 0.0093s/iter; left time: 104.9046s
	iters: 500, epoch: 10 | loss: 0.1596788
	speed: 0.0084s/iter; left time: 94.7558s
	iters: 600, epoch: 10 | loss: 0.1495750
	speed: 0.0085s/iter; left time: 94.6186s
	iters: 700, epoch: 10 | loss: 0.1508463
	speed: 0.0085s/iter; left time: 93.1818s
	iters: 800, epoch: 10 | loss: 0.1162882
	speed: 0.0090s/iter; left time: 98.2408s
	iters: 900, epoch: 10 | loss: 0.2468087
	speed: 0.0089s/iter; left time: 96.4897s
	iters: 1000, epoch: 10 | loss: 0.5024284
	speed: 0.0075s/iter; left time: 80.3720s
Epoch: 10 cost time: 8.829217672348022
Epoch: 10, Steps: 1066 | Train Loss: 0.1995399 Vali Loss: 0.1372028 Test Loss: 0.2264407
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.1156719
	speed: 0.0341s/iter; left time: 360.3024s
	iters: 200, epoch: 11 | loss: 0.3536225
	speed: 0.0077s/iter; left time: 80.4717s
	iters: 300, epoch: 11 | loss: 0.1537010
	speed: 0.0082s/iter; left time: 85.1893s
	iters: 400, epoch: 11 | loss: 0.2985194
	speed: 0.0084s/iter; left time: 85.7862s
	iters: 500, epoch: 11 | loss: 0.1558289
	speed: 0.0083s/iter; left time: 83.8906s
	iters: 600, epoch: 11 | loss: 0.2068821
	speed: 0.0078s/iter; left time: 78.8544s
	iters: 700, epoch: 11 | loss: 0.3307661
	speed: 0.0086s/iter; left time: 85.7691s
	iters: 800, epoch: 11 | loss: 0.2613947
	speed: 0.0084s/iter; left time: 82.9525s
	iters: 900, epoch: 11 | loss: 0.2436278
	speed: 0.0062s/iter; left time: 60.8155s
	iters: 1000, epoch: 11 | loss: 0.2254885
	speed: 0.0080s/iter; left time: 77.6088s
Epoch: 11 cost time: 8.55187177658081
Epoch: 11, Steps: 1066 | Train Loss: 0.1990848 Vali Loss: 0.1338791 Test Loss: 0.2156400
EarlyStopping counter: 4 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.2132589
	speed: 0.0365s/iter; left time: 346.3535s
	iters: 200, epoch: 12 | loss: 0.2110294
	speed: 0.0085s/iter; left time: 79.6358s
	iters: 300, epoch: 12 | loss: 0.1349768
	speed: 0.0091s/iter; left time: 84.2303s
	iters: 400, epoch: 12 | loss: 0.2020596
	speed: 0.0091s/iter; left time: 83.2915s
	iters: 500, epoch: 12 | loss: 0.1652248
	speed: 0.0093s/iter; left time: 84.6956s
	iters: 600, epoch: 12 | loss: 0.2122683
	speed: 0.0096s/iter; left time: 85.9978s
	iters: 700, epoch: 12 | loss: 0.2170177
	speed: 0.0099s/iter; left time: 87.8925s
	iters: 800, epoch: 12 | loss: 0.3093404
	speed: 0.0083s/iter; left time: 73.3840s
	iters: 900, epoch: 12 | loss: 0.1565952
	speed: 0.0068s/iter; left time: 59.2370s
	iters: 1000, epoch: 12 | loss: 0.1887554
	speed: 0.0070s/iter; left time: 60.0998s
Epoch: 12 cost time: 9.131026268005371
Epoch: 12, Steps: 1066 | Train Loss: 0.1987994 Vali Loss: 0.1324968 Test Loss: 0.2118713
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTm2_336_96_DLinear_ETTm2_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed28649<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.17999663949012756, mae:0.27240025997161865
