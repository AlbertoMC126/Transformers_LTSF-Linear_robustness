Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='Linear', model_id='traffic_336_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=3293, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_336_96_Linear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3293>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11849
val 1661
test 3413
	iters: 100, epoch: 1 | loss: 0.4360971
	speed: 0.3179s/iter; left time: 4673.9032s
	iters: 200, epoch: 1 | loss: 0.4391042
	speed: 0.3046s/iter; left time: 4447.9289s
	iters: 300, epoch: 1 | loss: 0.4834827
	speed: 0.3058s/iter; left time: 4435.0135s
	iters: 400, epoch: 1 | loss: 0.4891817
	speed: 0.3049s/iter; left time: 4390.8033s
	iters: 500, epoch: 1 | loss: 0.4470665
	speed: 0.3057s/iter; left time: 4371.3004s
	iters: 600, epoch: 1 | loss: 0.4428623
	speed: 0.3071s/iter; left time: 4360.5773s
	iters: 700, epoch: 1 | loss: 0.4310892
	speed: 0.3056s/iter; left time: 4309.6480s
Epoch: 1 cost time: 227.61420845985413
Epoch: 1, Steps: 740 | Train Loss: 0.4743859 Vali Loss: 0.6288696 Test Loss: 0.7483255
Validation loss decreased (inf --> 0.628870).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.4458433
	speed: 0.6184s/iter; left time: 8633.1331s
	iters: 200, epoch: 2 | loss: 0.4837240
	speed: 0.3046s/iter; left time: 4222.2791s
	iters: 300, epoch: 2 | loss: 0.4116483
	speed: 0.3044s/iter; left time: 4188.6269s
	iters: 400, epoch: 2 | loss: 0.4549468
	speed: 0.3057s/iter; left time: 4176.2071s
	iters: 500, epoch: 2 | loss: 0.4258890
	speed: 0.3047s/iter; left time: 4132.7106s
	iters: 600, epoch: 2 | loss: 0.5382884
	speed: 0.3051s/iter; left time: 4106.9628s
	iters: 700, epoch: 2 | loss: 0.4946426
	speed: 0.3038s/iter; left time: 4059.3327s
Epoch: 2 cost time: 225.51366257667542
Epoch: 2, Steps: 740 | Train Loss: 0.4632624 Vali Loss: 0.6178350 Test Loss: 0.7255888
Validation loss decreased (0.628870 --> 0.617835).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.3104833
	speed: 0.6173s/iter; left time: 8160.8587s
	iters: 200, epoch: 3 | loss: 0.2898273
	speed: 0.3038s/iter; left time: 3986.7283s
	iters: 300, epoch: 3 | loss: 0.3355705
	speed: 0.3044s/iter; left time: 3963.4811s
	iters: 400, epoch: 3 | loss: 0.2895411
	speed: 0.3049s/iter; left time: 3939.2115s
	iters: 500, epoch: 3 | loss: 0.2887677
	speed: 0.3040s/iter; left time: 3896.9492s
	iters: 600, epoch: 3 | loss: 0.3223239
	speed: 0.3040s/iter; left time: 3867.1831s
	iters: 700, epoch: 3 | loss: 0.3231206
	speed: 0.3047s/iter; left time: 3845.2797s
Epoch: 3 cost time: 225.140319108963
Epoch: 3, Steps: 740 | Train Loss: 0.3236670 Vali Loss: 0.4528726 Test Loss: 0.5437048
Validation loss decreased (0.617835 --> 0.452873).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.2793931
	speed: 0.6183s/iter; left time: 7716.4881s
	iters: 200, epoch: 4 | loss: 0.2674105
	speed: 0.3047s/iter; left time: 3772.2817s
	iters: 300, epoch: 4 | loss: 0.2880789
	speed: 0.3053s/iter; left time: 3749.2644s
	iters: 400, epoch: 4 | loss: 0.2819042
	speed: 0.3043s/iter; left time: 3707.1305s
	iters: 500, epoch: 4 | loss: 0.2891901
	speed: 0.3051s/iter; left time: 3685.5314s
	iters: 600, epoch: 4 | loss: 0.2813410
	speed: 0.3043s/iter; left time: 3645.6847s
	iters: 700, epoch: 4 | loss: 0.2684315
	speed: 0.3044s/iter; left time: 3616.6374s
Epoch: 4 cost time: 225.48733043670654
Epoch: 4, Steps: 740 | Train Loss: 0.2754828 Vali Loss: 0.3964915 Test Loss: 0.4793785
Validation loss decreased (0.452873 --> 0.396491).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.2631990
	speed: 0.6136s/iter; left time: 7203.7604s
	iters: 200, epoch: 5 | loss: 0.2344775
	speed: 0.3032s/iter; left time: 3529.5328s
	iters: 300, epoch: 5 | loss: 0.2325882
	speed: 0.3040s/iter; left time: 3508.8255s
	iters: 400, epoch: 5 | loss: 0.2376156
	speed: 0.3051s/iter; left time: 3490.3633s
	iters: 500, epoch: 5 | loss: 0.2917988
	speed: 0.3047s/iter; left time: 3455.9394s
	iters: 600, epoch: 5 | loss: 0.2780656
	speed: 0.3044s/iter; left time: 3421.5156s
	iters: 700, epoch: 5 | loss: 0.2427684
	speed: 0.3047s/iter; left time: 3394.2556s
Epoch: 5 cost time: 225.2614769935608
Epoch: 5, Steps: 740 | Train Loss: 0.2546064 Vali Loss: 0.3697088 Test Loss: 0.4503644
Validation loss decreased (0.396491 --> 0.369709).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.2076019
	speed: 0.6186s/iter; left time: 6805.2200s
	iters: 200, epoch: 6 | loss: 0.2649293
	speed: 0.3042s/iter; left time: 3316.4860s
	iters: 300, epoch: 6 | loss: 0.2601540
	speed: 0.3049s/iter; left time: 3292.7426s
	iters: 400, epoch: 6 | loss: 0.2146975
	speed: 0.3053s/iter; left time: 3266.6205s
	iters: 500, epoch: 6 | loss: 0.2703455
	speed: 0.3043s/iter; left time: 3226.3070s
	iters: 600, epoch: 6 | loss: 0.2206101
	speed: 0.3049s/iter; left time: 3201.8786s
	iters: 700, epoch: 6 | loss: 0.2374471
	speed: 0.3047s/iter; left time: 3169.6775s
Epoch: 6 cost time: 225.48267459869385
Epoch: 6, Steps: 740 | Train Loss: 0.2438340 Vali Loss: 0.3594655 Test Loss: 0.4385127
Validation loss decreased (0.369709 --> 0.359466).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.2453472
	speed: 0.6202s/iter; left time: 6363.4944s
	iters: 200, epoch: 7 | loss: 0.2219686
	speed: 0.3054s/iter; left time: 3102.9427s
	iters: 300, epoch: 7 | loss: 0.2251205
	speed: 0.3053s/iter; left time: 3071.9736s
	iters: 400, epoch: 7 | loss: 0.2246590
	speed: 0.3038s/iter; left time: 3026.0083s
	iters: 500, epoch: 7 | loss: 0.2356990
	speed: 0.3049s/iter; left time: 3006.8695s
	iters: 600, epoch: 7 | loss: 0.2216943
	speed: 0.3045s/iter; left time: 2972.1605s
	iters: 700, epoch: 7 | loss: 0.2579342
	speed: 0.3055s/iter; left time: 2951.8140s
Epoch: 7 cost time: 225.81898188591003
Epoch: 7, Steps: 740 | Train Loss: 0.2379545 Vali Loss: 0.3526073 Test Loss: 0.4310561
Validation loss decreased (0.359466 --> 0.352607).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.2002891
	speed: 0.6182s/iter; left time: 5885.4197s
	iters: 200, epoch: 8 | loss: 0.2181901
	speed: 0.3040s/iter; left time: 2863.8157s
	iters: 300, epoch: 8 | loss: 0.2482124
	speed: 0.3044s/iter; left time: 2837.6497s
	iters: 400, epoch: 8 | loss: 0.2084373
	speed: 0.3048s/iter; left time: 2810.5000s
	iters: 500, epoch: 8 | loss: 0.2531009
	speed: 0.3035s/iter; left time: 2767.9914s
	iters: 600, epoch: 8 | loss: 0.2164636
	speed: 0.3040s/iter; left time: 2742.7887s
	iters: 700, epoch: 8 | loss: 0.2876624
	speed: 0.3036s/iter; left time: 2708.1599s
Epoch: 8 cost time: 225.05480122566223
Epoch: 8, Steps: 740 | Train Loss: 0.2347359 Vali Loss: 0.3502748 Test Loss: 0.4280448
Validation loss decreased (0.352607 --> 0.350275).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.2174274
	speed: 0.6177s/iter; left time: 5424.4073s
	iters: 200, epoch: 9 | loss: 0.2389298
	speed: 0.3053s/iter; left time: 2649.9616s
	iters: 300, epoch: 9 | loss: 0.2222778
	speed: 0.3056s/iter; left time: 2622.1936s
	iters: 400, epoch: 9 | loss: 0.2094862
	speed: 0.3052s/iter; left time: 2588.3594s
	iters: 500, epoch: 9 | loss: 0.2467643
	speed: 0.3048s/iter; left time: 2554.1131s
	iters: 600, epoch: 9 | loss: 0.2076790
	speed: 0.3048s/iter; left time: 2523.6838s
	iters: 700, epoch: 9 | loss: 0.2176595
	speed: 0.3054s/iter; left time: 2498.7734s
Epoch: 9 cost time: 225.9104402065277
Epoch: 9, Steps: 740 | Train Loss: 0.2329592 Vali Loss: 0.3491139 Test Loss: 0.4268750
Validation loss decreased (0.350275 --> 0.349114).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.2350890
	speed: 0.6187s/iter; left time: 4974.6251s
	iters: 200, epoch: 10 | loss: 0.2458626
	speed: 0.3057s/iter; left time: 2427.2309s
	iters: 300, epoch: 10 | loss: 0.2114480
	speed: 0.3052s/iter; left time: 2393.0555s
	iters: 400, epoch: 10 | loss: 0.2247294
	speed: 0.3063s/iter; left time: 2370.8448s
	iters: 500, epoch: 10 | loss: 0.2635468
	speed: 0.3052s/iter; left time: 2331.7313s
	iters: 600, epoch: 10 | loss: 0.2057977
	speed: 0.3061s/iter; left time: 2308.3697s
	iters: 700, epoch: 10 | loss: 0.2490978
	speed: 0.3050s/iter; left time: 2269.4663s
Epoch: 10 cost time: 226.07793617248535
Epoch: 10, Steps: 740 | Train Loss: 0.2319953 Vali Loss: 0.3483089 Test Loss: 0.4259564
Validation loss decreased (0.349114 --> 0.348309).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.2129290
	speed: 0.6189s/iter; left time: 4518.8469s
	iters: 200, epoch: 11 | loss: 0.2735230
	speed: 0.3049s/iter; left time: 2195.5238s
	iters: 300, epoch: 11 | loss: 0.2425271
	speed: 0.3056s/iter; left time: 2169.9002s
	iters: 400, epoch: 11 | loss: 0.2322204
	speed: 0.3062s/iter; left time: 2143.5060s
	iters: 500, epoch: 11 | loss: 0.2251931
	speed: 0.3051s/iter; left time: 2105.5009s
	iters: 600, epoch: 11 | loss: 0.2045678
	speed: 0.3090s/iter; left time: 2101.5876s
	iters: 700, epoch: 11 | loss: 0.2308781
	speed: 0.3081s/iter; left time: 2064.7714s
Epoch: 11 cost time: 226.74201321601868
Epoch: 11, Steps: 740 | Train Loss: 0.2314113 Vali Loss: 0.3477918 Test Loss: 0.4257258
Validation loss decreased (0.348309 --> 0.347792).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.2702268
	speed: 0.6176s/iter; left time: 4052.1469s
	iters: 200, epoch: 12 | loss: 0.1979488
	speed: 0.3041s/iter; left time: 1965.0236s
	iters: 300, epoch: 12 | loss: 0.2653353
	speed: 0.3039s/iter; left time: 1932.9096s
	iters: 400, epoch: 12 | loss: 0.2814451
	speed: 0.3052s/iter; left time: 1910.6115s
	iters: 500, epoch: 12 | loss: 0.2494456
	speed: 0.3067s/iter; left time: 1889.5085s
	iters: 600, epoch: 12 | loss: 0.1859748
	speed: 0.3075s/iter; left time: 1864.0251s
	iters: 700, epoch: 12 | loss: 0.2592635
	speed: 0.3066s/iter; left time: 1827.6180s
Epoch: 12 cost time: 226.1662712097168
Epoch: 12, Steps: 740 | Train Loss: 0.2311575 Vali Loss: 0.3478867 Test Loss: 0.4255945
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.2385979
	speed: 0.6183s/iter; left time: 3598.8528s
	iters: 200, epoch: 13 | loss: 0.2542720
	speed: 0.3063s/iter; left time: 1752.5979s
	iters: 300, epoch: 13 | loss: 0.2233469
	speed: 0.3050s/iter; left time: 1714.6578s
	iters: 400, epoch: 13 | loss: 0.1938584
	speed: 0.3056s/iter; left time: 1687.4811s
	iters: 500, epoch: 13 | loss: 0.2245172
	speed: 0.3071s/iter; left time: 1664.6105s
	iters: 600, epoch: 13 | loss: 0.2272176
	speed: 0.3052s/iter; left time: 1624.0073s
	iters: 700, epoch: 13 | loss: 0.2637194
	speed: 0.3066s/iter; left time: 1600.7923s
Epoch: 13 cost time: 226.38849329948425
Epoch: 13, Steps: 740 | Train Loss: 0.2309550 Vali Loss: 0.3477142 Test Loss: 0.4255362
Validation loss decreased (0.347792 --> 0.347714).  Saving model ...
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 14 | loss: 0.2059073
	speed: 0.6202s/iter; left time: 3151.2581s
	iters: 200, epoch: 14 | loss: 0.2313862
	speed: 0.3063s/iter; left time: 1525.4544s
	iters: 300, epoch: 14 | loss: 0.2430482
	speed: 0.3051s/iter; left time: 1489.3909s
	iters: 400, epoch: 14 | loss: 0.2055662
	speed: 0.3056s/iter; left time: 1460.8936s
	iters: 500, epoch: 14 | loss: 0.2258156
	speed: 0.3050s/iter; left time: 1427.7394s
	iters: 600, epoch: 14 | loss: 0.2538174
	speed: 0.3052s/iter; left time: 1397.9386s
	iters: 700, epoch: 14 | loss: 0.1913072
	speed: 0.3063s/iter; left time: 1372.3172s
Epoch: 14 cost time: 226.1476218700409
Epoch: 14, Steps: 740 | Train Loss: 0.2309277 Vali Loss: 0.3475785 Test Loss: 0.4255093
Validation loss decreased (0.347714 --> 0.347578).  Saving model ...
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 15 | loss: 0.2087632
	speed: 0.6191s/iter; left time: 2687.4334s
	iters: 200, epoch: 15 | loss: 0.2184433
	speed: 0.3056s/iter; left time: 1296.2088s
	iters: 300, epoch: 15 | loss: 0.2673853
	speed: 0.3066s/iter; left time: 1269.5678s
	iters: 400, epoch: 15 | loss: 0.2165615
	speed: 0.3066s/iter; left time: 1239.0488s
	iters: 500, epoch: 15 | loss: 0.3037153
	speed: 0.3067s/iter; left time: 1208.6973s
	iters: 600, epoch: 15 | loss: 0.1983284
	speed: 0.3063s/iter; left time: 1176.6666s
	iters: 700, epoch: 15 | loss: 0.2082697
	speed: 0.3048s/iter; left time: 1140.1535s
Epoch: 15 cost time: 226.4883394241333
Epoch: 15, Steps: 740 | Train Loss: 0.2308663 Vali Loss: 0.3477735 Test Loss: 0.4255106
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 16 | loss: 0.2338807
	speed: 0.6188s/iter; left time: 2228.2361s
	iters: 200, epoch: 16 | loss: 0.2302773
	speed: 0.3064s/iter; left time: 1072.6525s
	iters: 300, epoch: 16 | loss: 0.2397186
	speed: 0.3078s/iter; left time: 1046.8093s
	iters: 400, epoch: 16 | loss: 0.1979293
	speed: 0.3057s/iter; left time: 1009.1420s
	iters: 500, epoch: 16 | loss: 0.2337559
	speed: 0.3051s/iter; left time: 976.5651s
	iters: 600, epoch: 16 | loss: 0.2078534
	speed: 0.3051s/iter; left time: 946.1216s
	iters: 700, epoch: 16 | loss: 0.2322797
	speed: 0.3066s/iter; left time: 919.9934s
Epoch: 16 cost time: 226.64110827445984
Epoch: 16, Steps: 740 | Train Loss: 0.2308483 Vali Loss: 0.3478433 Test Loss: 0.4255099
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 17 | loss: 0.2138896
	speed: 0.6170s/iter; left time: 1765.2320s
	iters: 200, epoch: 17 | loss: 0.2418811
	speed: 0.3058s/iter; left time: 844.1882s
	iters: 300, epoch: 17 | loss: 0.2964259
	speed: 0.3050s/iter; left time: 811.6355s
	iters: 400, epoch: 17 | loss: 0.2022839
	speed: 0.3065s/iter; left time: 785.0192s
	iters: 500, epoch: 17 | loss: 0.2517397
	speed: 0.3062s/iter; left time: 753.5932s
	iters: 600, epoch: 17 | loss: 0.2120110
	speed: 0.3055s/iter; left time: 721.3932s
	iters: 700, epoch: 17 | loss: 0.2363309
	speed: 0.3050s/iter; left time: 689.5791s
Epoch: 17 cost time: 226.1678385734558
Epoch: 17, Steps: 740 | Train Loss: 0.2308481 Vali Loss: 0.3481094 Test Loss: 0.4255108
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 18 | loss: 0.2700942
	speed: 0.6163s/iter; left time: 1307.1264s
	iters: 200, epoch: 18 | loss: 0.2292434
	speed: 0.3057s/iter; left time: 617.8611s
	iters: 300, epoch: 18 | loss: 0.2296255
	speed: 0.3052s/iter; left time: 586.3662s
	iters: 400, epoch: 18 | loss: 0.2339804
	speed: 0.3073s/iter; left time: 559.6309s
	iters: 500, epoch: 18 | loss: 0.2759298
	speed: 0.3055s/iter; left time: 525.7869s
	iters: 600, epoch: 18 | loss: 0.2240874
	speed: 0.3050s/iter; left time: 494.4474s
	iters: 700, epoch: 18 | loss: 0.2321213
	speed: 0.3062s/iter; left time: 465.8002s
Epoch: 18 cost time: 226.2173354625702
Epoch: 18, Steps: 740 | Train Loss: 0.2308436 Vali Loss: 0.3476885 Test Loss: 0.4255106
EarlyStopping counter: 4 out of 5
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 19 | loss: 0.2855636
	speed: 0.6205s/iter; left time: 856.9698s
	iters: 200, epoch: 19 | loss: 0.2346189
	speed: 0.3068s/iter; left time: 393.0081s
	iters: 300, epoch: 19 | loss: 0.2730247
	speed: 0.3061s/iter; left time: 361.4708s
	iters: 400, epoch: 19 | loss: 0.2287064
	speed: 0.3046s/iter; left time: 329.3097s
	iters: 500, epoch: 19 | loss: 0.2202852
	speed: 0.3063s/iter; left time: 300.5083s
	iters: 600, epoch: 19 | loss: 0.2215279
	speed: 0.3066s/iter; left time: 270.1008s
	iters: 700, epoch: 19 | loss: 0.2152804
	speed: 0.3059s/iter; left time: 238.8865s
Epoch: 19 cost time: 226.5767481327057
Epoch: 19, Steps: 740 | Train Loss: 0.2308246 Vali Loss: 0.3477919 Test Loss: 0.4255108
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : traffic_336_96_Linear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3293<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3413
mse:0.4257640838623047, mae:0.29806140065193176
