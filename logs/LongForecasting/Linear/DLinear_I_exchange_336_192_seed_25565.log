Args in experiment:
Namespace(activation='gelu', batch_size=8, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='exchange_rate.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=8, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='mse', lradj='type1', model='DLinear', model_id='Exchange_336_192', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=192, root_path='./dataset/', save_pred_values=False, seed=25565, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : Exchange_336_192_DLinear_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed25565>>>>>>>>>>>>>>>>>>>>>>>>>>
train 4784
val 569
test 1326
	iters: 100, epoch: 1 | loss: 0.2775039
	speed: 0.0081s/iter; left time: 96.5484s
	iters: 200, epoch: 1 | loss: 0.1698701
	speed: 0.0090s/iter; left time: 106.3519s
	iters: 300, epoch: 1 | loss: 0.4132825
	speed: 0.0089s/iter; left time: 103.7869s
	iters: 400, epoch: 1 | loss: 0.1426615
	speed: 0.0081s/iter; left time: 94.0170s
	iters: 500, epoch: 1 | loss: 0.2502107
	speed: 0.0085s/iter; left time: 97.8517s
Epoch: 1 cost time: 5.0836169719696045
Epoch: 1, Steps: 598 | Train Loss: 0.2652217 Vali Loss: 0.4860178 Test Loss: 0.1829891
Validation loss decreased (inf --> 0.486018).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2023273
	speed: 0.0214s/iter; left time: 241.3805s
	iters: 200, epoch: 2 | loss: 0.2853125
	speed: 0.0087s/iter; left time: 96.8165s
	iters: 300, epoch: 2 | loss: 0.3072677
	speed: 0.0088s/iter; left time: 97.1484s
	iters: 400, epoch: 2 | loss: 0.5641530
	speed: 0.0081s/iter; left time: 88.7172s
	iters: 500, epoch: 2 | loss: 0.1874584
	speed: 0.0084s/iter; left time: 91.3589s
Epoch: 2 cost time: 5.087920904159546
Epoch: 2, Steps: 598 | Train Loss: 0.2301600 Vali Loss: 0.5647687 Test Loss: 0.2339356
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1943206
	speed: 0.0205s/iter; left time: 218.1770s
	iters: 200, epoch: 3 | loss: 0.2757454
	speed: 0.0088s/iter; left time: 93.3015s
	iters: 300, epoch: 3 | loss: 0.2491518
	speed: 0.0090s/iter; left time: 94.0929s
	iters: 400, epoch: 3 | loss: 0.2444218
	speed: 0.0091s/iter; left time: 93.9311s
	iters: 500, epoch: 3 | loss: 0.2294231
	speed: 0.0088s/iter; left time: 90.6531s
Epoch: 3 cost time: 5.312680721282959
Epoch: 3, Steps: 598 | Train Loss: 0.2180707 Vali Loss: 0.4952475 Test Loss: 0.1892679
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.2822924
	speed: 0.0219s/iter; left time: 220.1892s
	iters: 200, epoch: 4 | loss: 0.2538080
	speed: 0.0072s/iter; left time: 71.9025s
	iters: 300, epoch: 4 | loss: 0.1351798
	speed: 0.0074s/iter; left time: 72.9358s
	iters: 400, epoch: 4 | loss: 0.2011478
	speed: 0.0066s/iter; left time: 64.7548s
	iters: 500, epoch: 4 | loss: 0.3441093
	speed: 0.0070s/iter; left time: 67.2082s
Epoch: 4 cost time: 4.316250562667847
Epoch: 4, Steps: 598 | Train Loss: 0.2133018 Vali Loss: 0.4416513 Test Loss: 0.1822457
Validation loss decreased (0.486018 --> 0.441651).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.4062622
	speed: 0.0191s/iter; left time: 180.9877s
	iters: 200, epoch: 5 | loss: 0.1301979
	speed: 0.0072s/iter; left time: 67.7665s
	iters: 300, epoch: 5 | loss: 0.1634493
	speed: 0.0090s/iter; left time: 83.3500s
	iters: 400, epoch: 5 | loss: 0.1921943
	speed: 0.0086s/iter; left time: 78.8711s
	iters: 500, epoch: 5 | loss: 0.2151442
	speed: 0.0076s/iter; left time: 68.4982s
Epoch: 5 cost time: 4.657258987426758
Epoch: 5, Steps: 598 | Train Loss: 0.2105310 Vali Loss: 0.4347922 Test Loss: 0.1762525
Validation loss decreased (0.441651 --> 0.434792).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1693822
	speed: 0.0192s/iter; left time: 170.0085s
	iters: 200, epoch: 6 | loss: 0.1940452
	speed: 0.0079s/iter; left time: 69.2280s
	iters: 300, epoch: 6 | loss: 0.1716360
	speed: 0.0072s/iter; left time: 62.3585s
	iters: 400, epoch: 6 | loss: 0.1393079
	speed: 0.0077s/iter; left time: 66.2675s
	iters: 500, epoch: 6 | loss: 0.1443105
	speed: 0.0079s/iter; left time: 66.6778s
Epoch: 6 cost time: 4.596352577209473
Epoch: 6, Steps: 598 | Train Loss: 0.2095825 Vali Loss: 0.4863540 Test Loss: 0.1933637
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.2660924
	speed: 0.0178s/iter; left time: 147.3058s
	iters: 200, epoch: 7 | loss: 0.2019367
	speed: 0.0082s/iter; left time: 67.3517s
	iters: 300, epoch: 7 | loss: 0.1730300
	speed: 0.0080s/iter; left time: 64.5108s
	iters: 400, epoch: 7 | loss: 0.1746332
	speed: 0.0080s/iter; left time: 63.5594s
	iters: 500, epoch: 7 | loss: 0.1429896
	speed: 0.0078s/iter; left time: 61.5332s
Epoch: 7 cost time: 4.749463081359863
Epoch: 7, Steps: 598 | Train Loss: 0.2091501 Vali Loss: 0.4567001 Test Loss: 0.1785859
EarlyStopping counter: 2 out of 5
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.3263548
	speed: 0.0208s/iter; left time: 159.7552s
	iters: 200, epoch: 8 | loss: 0.1664420
	speed: 0.0077s/iter; left time: 57.9726s
	iters: 300, epoch: 8 | loss: 0.1291431
	speed: 0.0083s/iter; left time: 62.3633s
	iters: 400, epoch: 8 | loss: 0.2136786
	speed: 0.0081s/iter; left time: 60.0876s
	iters: 500, epoch: 8 | loss: 0.2304555
	speed: 0.0085s/iter; left time: 61.7677s
Epoch: 8 cost time: 4.886908769607544
Epoch: 8, Steps: 598 | Train Loss: 0.2087009 Vali Loss: 0.4625801 Test Loss: 0.1821766
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.2225472
	speed: 0.0202s/iter; left time: 142.9235s
	iters: 200, epoch: 9 | loss: 0.1306512
	speed: 0.0077s/iter; left time: 53.6018s
	iters: 300, epoch: 9 | loss: 0.2055802
	speed: 0.0078s/iter; left time: 53.3188s
	iters: 400, epoch: 9 | loss: 0.1703759
	speed: 0.0077s/iter; left time: 52.3396s
	iters: 500, epoch: 9 | loss: 0.1441117
	speed: 0.0076s/iter; left time: 50.9589s
Epoch: 9 cost time: 4.615142345428467
Epoch: 9, Steps: 598 | Train Loss: 0.2085041 Vali Loss: 0.4604737 Test Loss: 0.1807528
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.1630770
	speed: 0.0175s/iter; left time: 113.2452s
	iters: 200, epoch: 10 | loss: 0.1230746
	speed: 0.0053s/iter; left time: 33.8331s
	iters: 300, epoch: 10 | loss: 0.3067925
	speed: 0.0050s/iter; left time: 31.1438s
	iters: 400, epoch: 10 | loss: 0.1922864
	speed: 0.0053s/iter; left time: 32.6360s
	iters: 500, epoch: 10 | loss: 0.2123088
	speed: 0.0056s/iter; left time: 33.9208s
Epoch: 10 cost time: 3.2726192474365234
Epoch: 10, Steps: 598 | Train Loss: 0.2084152 Vali Loss: 0.4552749 Test Loss: 0.1803274
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : Exchange_336_192_DLinear_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed25565<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 1326
mse:0.17611892521381378, mae:0.3197307884693146
