Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='Linear', model_id='ETTm2_336_720', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=720, root_path='./dataset/', save_pred_values=False, seed=25565, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTm2_336_720_Linear_ETTm2_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed25565>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33505
val 10801
test 10801
	iters: 100, epoch: 1 | loss: 0.5057793
	speed: 0.0189s/iter; left time: 394.8101s
	iters: 200, epoch: 1 | loss: 1.0684319
	speed: 0.0171s/iter; left time: 355.2624s
	iters: 300, epoch: 1 | loss: 0.3380380
	speed: 0.0202s/iter; left time: 416.7640s
	iters: 400, epoch: 1 | loss: 1.2066048
	speed: 0.0191s/iter; left time: 391.5282s
	iters: 500, epoch: 1 | loss: 0.7915425
	speed: 0.0176s/iter; left time: 359.7264s
	iters: 600, epoch: 1 | loss: 0.4158745
	speed: 0.0187s/iter; left time: 380.0271s
	iters: 700, epoch: 1 | loss: 0.5407405
	speed: 0.0176s/iter; left time: 356.0133s
	iters: 800, epoch: 1 | loss: 0.4253104
	speed: 0.0180s/iter; left time: 363.3480s
	iters: 900, epoch: 1 | loss: 0.6723823
	speed: 0.0169s/iter; left time: 339.0183s
	iters: 1000, epoch: 1 | loss: 0.7169526
	speed: 0.0192s/iter; left time: 382.0674s
Epoch: 1 cost time: 19.184269905090332
Epoch: 1, Steps: 1047 | Train Loss: 0.7076869 Vali Loss: 0.5249231 Test Loss: 1.1653806
Validation loss decreased (inf --> 0.524923).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.5075088
	speed: 0.0584s/iter; left time: 1155.8608s
	iters: 200, epoch: 2 | loss: 0.9117764
	speed: 0.0205s/iter; left time: 403.3318s
	iters: 300, epoch: 2 | loss: 1.2094585
	speed: 0.0189s/iter; left time: 370.6556s
	iters: 400, epoch: 2 | loss: 0.5402197
	speed: 0.0202s/iter; left time: 393.3926s
	iters: 500, epoch: 2 | loss: 0.6558108
	speed: 0.0200s/iter; left time: 388.8110s
	iters: 600, epoch: 2 | loss: 0.5073960
	speed: 0.0175s/iter; left time: 338.1192s
	iters: 700, epoch: 2 | loss: 0.8450855
	speed: 0.0198s/iter; left time: 380.8175s
	iters: 800, epoch: 2 | loss: 0.7288848
	speed: 0.0193s/iter; left time: 367.6158s
	iters: 900, epoch: 2 | loss: 0.7963594
	speed: 0.0214s/iter; left time: 406.8918s
	iters: 1000, epoch: 2 | loss: 0.9034107
	speed: 0.0186s/iter; left time: 350.6636s
Epoch: 2 cost time: 20.10609006881714
Epoch: 2, Steps: 1047 | Train Loss: 0.7196068 Vali Loss: 0.6649960 Test Loss: 1.6200348
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.4206429
	speed: 0.0570s/iter; left time: 1068.3175s
	iters: 200, epoch: 3 | loss: 0.6176404
	speed: 0.0181s/iter; left time: 338.1403s
	iters: 300, epoch: 3 | loss: 0.3762282
	speed: 0.0182s/iter; left time: 338.1191s
	iters: 400, epoch: 3 | loss: 0.5211455
	speed: 0.0187s/iter; left time: 344.4060s
	iters: 500, epoch: 3 | loss: 0.4314472
	speed: 0.0180s/iter; left time: 330.8128s
	iters: 600, epoch: 3 | loss: 0.5799767
	speed: 0.0158s/iter; left time: 288.5793s
	iters: 700, epoch: 3 | loss: 0.4769976
	speed: 0.0183s/iter; left time: 331.9625s
	iters: 800, epoch: 3 | loss: 0.5509313
	speed: 0.0195s/iter; left time: 351.2842s
	iters: 900, epoch: 3 | loss: 0.9141914
	speed: 0.0180s/iter; left time: 322.7666s
	iters: 1000, epoch: 3 | loss: 0.8010514
	speed: 0.0185s/iter; left time: 330.0541s
Epoch: 3 cost time: 18.749233722686768
Epoch: 3, Steps: 1047 | Train Loss: 0.5506402 Vali Loss: 0.7418466 Test Loss: 1.8789395
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.5512921
	speed: 0.0582s/iter; left time: 1030.1836s
	iters: 200, epoch: 4 | loss: 0.5832090
	speed: 0.0179s/iter; left time: 315.6786s
	iters: 300, epoch: 4 | loss: 0.4649471
	speed: 0.0196s/iter; left time: 343.2034s
	iters: 400, epoch: 4 | loss: 0.3296722
	speed: 0.0219s/iter; left time: 380.6109s
	iters: 500, epoch: 4 | loss: 0.5097730
	speed: 0.0201s/iter; left time: 348.5280s
	iters: 600, epoch: 4 | loss: 0.7748549
	speed: 0.0176s/iter; left time: 302.7035s
	iters: 700, epoch: 4 | loss: 0.5196055
	speed: 0.0195s/iter; left time: 332.6674s
	iters: 800, epoch: 4 | loss: 0.4406143
	speed: 0.0174s/iter; left time: 296.5910s
	iters: 900, epoch: 4 | loss: 0.6164981
	speed: 0.0190s/iter; left time: 320.4458s
	iters: 1000, epoch: 4 | loss: 0.9656998
	speed: 0.0196s/iter; left time: 328.7594s
Epoch: 4 cost time: 19.509946823120117
Epoch: 4, Steps: 1047 | Train Loss: 0.5003853 Vali Loss: 0.3722335 Test Loss: 0.6410549
Validation loss decreased (0.524923 --> 0.372234).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.4506552
	speed: 0.0602s/iter; left time: 1001.7135s
	iters: 200, epoch: 5 | loss: 0.7920477
	speed: 0.0160s/iter; left time: 265.5274s
	iters: 300, epoch: 5 | loss: 0.3716448
	speed: 0.0171s/iter; left time: 281.3224s
	iters: 400, epoch: 5 | loss: 0.5299132
	speed: 0.0196s/iter; left time: 321.0061s
	iters: 500, epoch: 5 | loss: 0.5547699
	speed: 0.0208s/iter; left time: 337.9792s
	iters: 600, epoch: 5 | loss: 0.6887242
	speed: 0.0156s/iter; left time: 252.6075s
	iters: 700, epoch: 5 | loss: 0.5362841
	speed: 0.0189s/iter; left time: 304.1941s
	iters: 800, epoch: 5 | loss: 0.3890592
	speed: 0.0176s/iter; left time: 281.0197s
	iters: 900, epoch: 5 | loss: 0.3801429
	speed: 0.0186s/iter; left time: 295.4091s
	iters: 1000, epoch: 5 | loss: 0.3304573
	speed: 0.0198s/iter; left time: 311.4136s
Epoch: 5 cost time: 18.842564821243286
Epoch: 5, Steps: 1047 | Train Loss: 0.4772979 Vali Loss: 0.5116481 Test Loss: 1.1960649
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.3837529
	speed: 0.0587s/iter; left time: 916.3082s
	iters: 200, epoch: 6 | loss: 0.2695381
	speed: 0.0192s/iter; left time: 298.1314s
	iters: 300, epoch: 6 | loss: 0.4533224
	speed: 0.0197s/iter; left time: 303.7892s
	iters: 400, epoch: 6 | loss: 0.5846428
	speed: 0.0201s/iter; left time: 308.3098s
	iters: 500, epoch: 6 | loss: 0.3835508
	speed: 0.0214s/iter; left time: 324.8034s
	iters: 600, epoch: 6 | loss: 0.4561417
	speed: 0.0214s/iter; left time: 322.8189s
	iters: 700, epoch: 6 | loss: 0.6155909
	speed: 0.0214s/iter; left time: 321.7797s
	iters: 800, epoch: 6 | loss: 0.4458583
	speed: 0.0207s/iter; left time: 308.4216s
	iters: 900, epoch: 6 | loss: 0.3751627
	speed: 0.0204s/iter; left time: 301.8587s
	iters: 1000, epoch: 6 | loss: 0.3573020
	speed: 0.0180s/iter; left time: 264.6063s
Epoch: 6 cost time: 20.547295093536377
Epoch: 6, Steps: 1047 | Train Loss: 0.4650744 Vali Loss: 0.4348697 Test Loss: 0.9225560
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.3527389
	speed: 0.0607s/iter; left time: 883.5732s
	iters: 200, epoch: 7 | loss: 0.5715346
	speed: 0.0188s/iter; left time: 271.3808s
	iters: 300, epoch: 7 | loss: 0.3527516
	speed: 0.0183s/iter; left time: 263.1319s
	iters: 400, epoch: 7 | loss: 0.5395017
	speed: 0.0196s/iter; left time: 279.8849s
	iters: 500, epoch: 7 | loss: 0.2506336
	speed: 0.0197s/iter; left time: 278.8134s
	iters: 600, epoch: 7 | loss: 0.5135428
	speed: 0.0215s/iter; left time: 302.2477s
	iters: 700, epoch: 7 | loss: 0.6021233
	speed: 0.0206s/iter; left time: 287.2745s
	iters: 800, epoch: 7 | loss: 0.4300465
	speed: 0.0214s/iter; left time: 296.4404s
	iters: 900, epoch: 7 | loss: 0.5609608
	speed: 0.0184s/iter; left time: 253.7537s
	iters: 1000, epoch: 7 | loss: 0.5633796
	speed: 0.0169s/iter; left time: 230.7935s
Epoch: 7 cost time: 20.00733733177185
Epoch: 7, Steps: 1047 | Train Loss: 0.4574416 Vali Loss: 0.4619142 Test Loss: 0.9391277
EarlyStopping counter: 3 out of 5
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.2566027
	speed: 0.0622s/iter; left time: 839.7779s
	iters: 200, epoch: 8 | loss: 0.3983762
	speed: 0.0188s/iter; left time: 251.9983s
	iters: 300, epoch: 8 | loss: 0.6281419
	speed: 0.0200s/iter; left time: 266.4732s
	iters: 400, epoch: 8 | loss: 0.6308591
	speed: 0.0192s/iter; left time: 253.3468s
	iters: 500, epoch: 8 | loss: 0.5389227
	speed: 0.0210s/iter; left time: 275.5157s
	iters: 600, epoch: 8 | loss: 0.4895934
	speed: 0.0204s/iter; left time: 265.4490s
	iters: 700, epoch: 8 | loss: 0.3226458
	speed: 0.0192s/iter; left time: 247.2868s
	iters: 800, epoch: 8 | loss: 1.0166653
	speed: 0.0183s/iter; left time: 234.8101s
	iters: 900, epoch: 8 | loss: 0.3294722
	speed: 0.0173s/iter; left time: 219.5264s
	iters: 1000, epoch: 8 | loss: 0.2818682
	speed: 0.0161s/iter; left time: 203.1210s
Epoch: 8 cost time: 19.564194917678833
Epoch: 8, Steps: 1047 | Train Loss: 0.4534432 Vali Loss: 0.3903025 Test Loss: 0.7746390
EarlyStopping counter: 4 out of 5
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.7599588
	speed: 0.0687s/iter; left time: 856.5691s
	iters: 200, epoch: 9 | loss: 0.3759265
	speed: 0.0215s/iter; left time: 265.3254s
	iters: 300, epoch: 9 | loss: 0.3332607
	speed: 0.0183s/iter; left time: 224.2418s
	iters: 400, epoch: 9 | loss: 0.5857905
	speed: 0.0199s/iter; left time: 242.1236s
	iters: 500, epoch: 9 | loss: 0.5226511
	speed: 0.0168s/iter; left time: 203.1886s
	iters: 600, epoch: 9 | loss: 0.5574336
	speed: 0.0176s/iter; left time: 210.6492s
	iters: 700, epoch: 9 | loss: 0.8274071
	speed: 0.0192s/iter; left time: 227.9916s
	iters: 800, epoch: 9 | loss: 0.5407664
	speed: 0.0174s/iter; left time: 204.5280s
	iters: 900, epoch: 9 | loss: 0.4407382
	speed: 0.0174s/iter; left time: 203.5520s
	iters: 1000, epoch: 9 | loss: 0.4194900
	speed: 0.0166s/iter; left time: 191.8845s
Epoch: 9 cost time: 19.28601884841919
Epoch: 9, Steps: 1047 | Train Loss: 0.4516075 Vali Loss: 0.4003328 Test Loss: 0.8079852
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTm2_336_720_Linear_ETTm2_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed25565<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10801
mse:0.6413466930389404, mae:0.5359647870063782
