Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTh1', data_path='ETTh1.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='NLinear', model_id='ETTh1_336_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=15349, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTh1_336_96_NLinear_ETTh1_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15349>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.4170817
	speed: 0.0044s/iter; left time: 21.9128s
	iters: 200, epoch: 1 | loss: 0.4527513
	speed: 0.0041s/iter; left time: 19.9794s
Epoch: 1 cost time: 1.0594232082366943
Epoch: 1, Steps: 256 | Train Loss: 0.4326923 Vali Loss: 0.7727721 Test Loss: 0.4496904
Validation loss decreased (inf --> 0.772772).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.4259125
	speed: 0.0089s/iter; left time: 42.2203s
	iters: 200, epoch: 2 | loss: 0.3766907
	speed: 0.0042s/iter; left time: 19.8262s
Epoch: 2 cost time: 1.0711805820465088
Epoch: 2, Steps: 256 | Train Loss: 0.3935041 Vali Loss: 0.8426551 Test Loss: 0.4574089
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.3279444
	speed: 0.0100s/iter; left time: 45.0102s
	iters: 200, epoch: 3 | loss: 0.3085858
	speed: 0.0050s/iter; left time: 22.1918s
Epoch: 3 cost time: 1.2393977642059326
Epoch: 3, Steps: 256 | Train Loss: 0.3506439 Vali Loss: 0.7944160 Test Loss: 0.4141083
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.3043405
	speed: 0.0118s/iter; left time: 50.1582s
	iters: 200, epoch: 4 | loss: 0.3023536
	speed: 0.0048s/iter; left time: 19.9889s
Epoch: 4 cost time: 1.2503111362457275
Epoch: 4, Steps: 256 | Train Loss: 0.3314371 Vali Loss: 0.7588300 Test Loss: 0.3916460
Validation loss decreased (0.772772 --> 0.758830).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.2632015
	speed: 0.0084s/iter; left time: 33.4948s
	iters: 200, epoch: 5 | loss: 0.2887900
	speed: 0.0041s/iter; left time: 16.0260s
Epoch: 5 cost time: 1.057288408279419
Epoch: 5, Steps: 256 | Train Loss: 0.3235935 Vali Loss: 0.7127681 Test Loss: 0.3875652
Validation loss decreased (0.758830 --> 0.712768).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.2899784
	speed: 0.0110s/iter; left time: 41.3107s
	iters: 200, epoch: 6 | loss: 0.2731782
	speed: 0.0049s/iter; left time: 17.9137s
Epoch: 6 cost time: 1.2224116325378418
Epoch: 6, Steps: 256 | Train Loss: 0.3189757 Vali Loss: 0.7309260 Test Loss: 0.3851918
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.3204808
	speed: 0.0113s/iter; left time: 39.2478s
	iters: 200, epoch: 7 | loss: 0.3938826
	speed: 0.0047s/iter; left time: 15.8432s
Epoch: 7 cost time: 1.2060418128967285
Epoch: 7, Steps: 256 | Train Loss: 0.3163732 Vali Loss: 0.7073348 Test Loss: 0.3813571
Validation loss decreased (0.712768 --> 0.707335).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.3164695
	speed: 0.0110s/iter; left time: 35.4298s
	iters: 200, epoch: 8 | loss: 0.3211040
	speed: 0.0049s/iter; left time: 15.2795s
Epoch: 8 cost time: 1.239375114440918
Epoch: 8, Steps: 256 | Train Loss: 0.3150989 Vali Loss: 0.7008253 Test Loss: 0.3807359
Validation loss decreased (0.707335 --> 0.700825).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.2839639
	speed: 0.0101s/iter; left time: 29.9783s
	iters: 200, epoch: 9 | loss: 0.2893793
	speed: 0.0048s/iter; left time: 13.8743s
Epoch: 9 cost time: 1.1402714252471924
Epoch: 9, Steps: 256 | Train Loss: 0.3143444 Vali Loss: 0.7042226 Test Loss: 0.3799072
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.3005635
	speed: 0.0108s/iter; left time: 29.2149s
	iters: 200, epoch: 10 | loss: 0.2793210
	speed: 0.0051s/iter; left time: 13.3584s
Epoch: 10 cost time: 1.2514464855194092
Epoch: 10, Steps: 256 | Train Loss: 0.3138060 Vali Loss: 0.6996914 Test Loss: 0.3799230
Validation loss decreased (0.700825 --> 0.699691).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.3212957
	speed: 0.0108s/iter; left time: 26.6370s
	iters: 200, epoch: 11 | loss: 0.2868958
	speed: 0.0045s/iter; left time: 10.6245s
Epoch: 11 cost time: 1.0993661880493164
Epoch: 11, Steps: 256 | Train Loss: 0.3136348 Vali Loss: 0.7005812 Test Loss: 0.3796921
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.2772339
	speed: 0.0100s/iter; left time: 21.9426s
	iters: 200, epoch: 12 | loss: 0.2832762
	speed: 0.0040s/iter; left time: 8.4031s
Epoch: 12 cost time: 1.1151528358459473
Epoch: 12, Steps: 256 | Train Loss: 0.3135051 Vali Loss: 0.6998091 Test Loss: 0.3796649
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.2752989
	speed: 0.0106s/iter; left time: 20.7056s
	iters: 200, epoch: 13 | loss: 0.2787403
	speed: 0.0047s/iter; left time: 8.6533s
Epoch: 13 cost time: 1.1683170795440674
Epoch: 13, Steps: 256 | Train Loss: 0.3135442 Vali Loss: 0.7002522 Test Loss: 0.3796676
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.2848622
	speed: 0.0109s/iter; left time: 18.4924s
	iters: 200, epoch: 14 | loss: 0.3878969
	speed: 0.0051s/iter; left time: 8.0791s
Epoch: 14 cost time: 1.2671635150909424
Epoch: 14, Steps: 256 | Train Loss: 0.3132914 Vali Loss: 0.7000955 Test Loss: 0.3796704
EarlyStopping counter: 4 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.3055578
	speed: 0.0097s/iter; left time: 13.8845s
	iters: 200, epoch: 15 | loss: 0.3226061
	speed: 0.0045s/iter; left time: 6.0305s
Epoch: 15 cost time: 1.063256025314331
Epoch: 15, Steps: 256 | Train Loss: 0.3134944 Vali Loss: 0.7000901 Test Loss: 0.3796784
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTh1_336_96_NLinear_ETTh1_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15349<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.37815091013908386, mae:0.3981032371520996
