Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='DLinear', model_id='traffic_336_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=10458, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_336_96_DLinear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed10458>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11849
val 1661
test 3413
	iters: 100, epoch: 1 | loss: 0.4782323
	speed: 0.4573s/iter; left time: 6722.1655s
	iters: 200, epoch: 1 | loss: 0.5439385
	speed: 0.4484s/iter; left time: 6546.5597s
	iters: 300, epoch: 1 | loss: 0.5887470
	speed: 0.4471s/iter; left time: 6483.1312s
	iters: 400, epoch: 1 | loss: 0.6097320
	speed: 0.4407s/iter; left time: 6346.4419s
	iters: 500, epoch: 1 | loss: 0.6277735
	speed: 0.4386s/iter; left time: 6272.9939s
	iters: 600, epoch: 1 | loss: 0.5411937
	speed: 0.4229s/iter; left time: 6004.9763s
	iters: 700, epoch: 1 | loss: 0.5615561
	speed: 0.4148s/iter; left time: 5849.5762s
Epoch: 1 cost time: 323.6549289226532
Epoch: 1, Steps: 740 | Train Loss: 0.5830261 Vali Loss: 0.8212945 Test Loss: 0.9627419
Validation loss decreased (inf --> 0.821295).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.5765077
	speed: 0.8846s/iter; left time: 12350.5785s
	iters: 200, epoch: 2 | loss: 0.5518733
	speed: 0.4044s/iter; left time: 5605.3973s
	iters: 300, epoch: 2 | loss: 0.5969998
	speed: 0.4048s/iter; left time: 5569.9293s
	iters: 400, epoch: 2 | loss: 0.5831075
	speed: 0.4073s/iter; left time: 5564.4107s
	iters: 500, epoch: 2 | loss: 0.5729355
	speed: 0.4148s/iter; left time: 5625.5810s
	iters: 600, epoch: 2 | loss: 0.6256471
	speed: 0.4116s/iter; left time: 5540.8717s
	iters: 700, epoch: 2 | loss: 0.6189777
	speed: 0.4089s/iter; left time: 5463.4908s
Epoch: 2 cost time: 302.5269923210144
Epoch: 2, Steps: 740 | Train Loss: 0.5750761 Vali Loss: 0.7898310 Test Loss: 0.9172947
Validation loss decreased (0.821295 --> 0.789831).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.3796177
	speed: 0.8882s/iter; left time: 11742.4461s
	iters: 200, epoch: 3 | loss: 0.3420134
	speed: 0.4049s/iter; left time: 5313.2629s
	iters: 300, epoch: 3 | loss: 0.3592830
	speed: 0.4150s/iter; left time: 5403.4876s
	iters: 400, epoch: 3 | loss: 0.3634924
	speed: 0.4053s/iter; left time: 5236.7196s
	iters: 500, epoch: 3 | loss: 0.3684966
	speed: 0.4128s/iter; left time: 5292.8894s
	iters: 600, epoch: 3 | loss: 0.3656430
	speed: 0.4158s/iter; left time: 5289.4604s
	iters: 700, epoch: 3 | loss: 0.3604581
	speed: 0.4083s/iter; left time: 5152.8506s
Epoch: 3 cost time: 303.1887800693512
Epoch: 3, Steps: 740 | Train Loss: 0.3516892 Vali Loss: 0.4956721 Test Loss: 0.5952600
Validation loss decreased (0.789831 --> 0.495672).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.2720645
	speed: 0.8975s/iter; left time: 11201.3522s
	iters: 200, epoch: 4 | loss: 0.2878729
	speed: 0.4071s/iter; left time: 5040.4065s
	iters: 300, epoch: 4 | loss: 0.2799964
	speed: 0.4067s/iter; left time: 4995.2148s
	iters: 400, epoch: 4 | loss: 0.2574020
	speed: 0.4071s/iter; left time: 4958.5137s
	iters: 500, epoch: 4 | loss: 0.2809057
	speed: 0.4086s/iter; left time: 4935.9248s
	iters: 600, epoch: 4 | loss: 0.2815244
	speed: 0.4097s/iter; left time: 4908.9870s
	iters: 700, epoch: 4 | loss: 0.2865031
	speed: 0.4096s/iter; left time: 4866.1266s
Epoch: 4 cost time: 302.81598591804504
Epoch: 4, Steps: 740 | Train Loss: 0.2875429 Vali Loss: 0.4131673 Test Loss: 0.4997406
Validation loss decreased (0.495672 --> 0.413167).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.2524770
	speed: 0.8893s/iter; left time: 10440.9713s
	iters: 200, epoch: 5 | loss: 0.2430328
	speed: 0.4075s/iter; left time: 4743.9363s
	iters: 300, epoch: 5 | loss: 0.2975522
	speed: 0.4034s/iter; left time: 4656.0971s
	iters: 400, epoch: 5 | loss: 0.3020573
	speed: 0.4030s/iter; left time: 4610.7710s
	iters: 500, epoch: 5 | loss: 0.2620333
	speed: 0.4039s/iter; left time: 4580.9745s
	iters: 600, epoch: 5 | loss: 0.2711454
	speed: 0.4081s/iter; left time: 4587.2626s
	iters: 700, epoch: 5 | loss: 0.2678206
	speed: 0.4122s/iter; left time: 4592.2467s
Epoch: 5 cost time: 301.43038630485535
Epoch: 5, Steps: 740 | Train Loss: 0.2609328 Vali Loss: 0.3807785 Test Loss: 0.4624709
Validation loss decreased (0.413167 --> 0.380778).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.2363874
	speed: 0.8856s/iter; left time: 9742.1669s
	iters: 200, epoch: 6 | loss: 0.2377148
	speed: 0.4064s/iter; left time: 4429.9086s
	iters: 300, epoch: 6 | loss: 0.2412202
	speed: 0.4037s/iter; left time: 4360.1306s
	iters: 400, epoch: 6 | loss: 0.2859674
	speed: 0.4024s/iter; left time: 4305.8933s
	iters: 500, epoch: 6 | loss: 0.2620614
	speed: 0.4060s/iter; left time: 4304.2861s
	iters: 600, epoch: 6 | loss: 0.2571904
	speed: 0.4063s/iter; left time: 4266.7609s
	iters: 700, epoch: 6 | loss: 0.2209844
	speed: 0.4109s/iter; left time: 4273.6730s
Epoch: 6 cost time: 300.63874650001526
Epoch: 6, Steps: 740 | Train Loss: 0.2473356 Vali Loss: 0.3644877 Test Loss: 0.4450620
Validation loss decreased (0.380778 --> 0.364488).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.2053545
	speed: 0.8921s/iter; left time: 9154.1220s
	iters: 200, epoch: 7 | loss: 0.2217407
	speed: 0.4046s/iter; left time: 4111.3696s
	iters: 300, epoch: 7 | loss: 0.2263423
	speed: 0.4045s/iter; left time: 4069.4256s
	iters: 400, epoch: 7 | loss: 0.2313998
	speed: 0.4034s/iter; left time: 4018.4021s
	iters: 500, epoch: 7 | loss: 0.2575013
	speed: 0.4015s/iter; left time: 3959.6498s
	iters: 600, epoch: 7 | loss: 0.2341800
	speed: 0.4030s/iter; left time: 3933.5999s
	iters: 700, epoch: 7 | loss: 0.2119012
	speed: 0.4058s/iter; left time: 3920.0483s
Epoch: 7 cost time: 299.62832283973694
Epoch: 7, Steps: 740 | Train Loss: 0.2399160 Vali Loss: 0.3553891 Test Loss: 0.4346401
Validation loss decreased (0.364488 --> 0.355389).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.2237455
	speed: 0.8911s/iter; left time: 8484.6063s
	iters: 200, epoch: 8 | loss: 0.2405855
	speed: 0.4052s/iter; left time: 3817.7940s
	iters: 300, epoch: 8 | loss: 0.2372920
	speed: 0.4047s/iter; left time: 3771.9663s
	iters: 400, epoch: 8 | loss: 0.2223171
	speed: 0.4040s/iter; left time: 3724.9225s
	iters: 500, epoch: 8 | loss: 0.2422194
	speed: 0.4042s/iter; left time: 3686.5853s
	iters: 600, epoch: 8 | loss: 0.2450644
	speed: 0.4043s/iter; left time: 3647.3599s
	iters: 700, epoch: 8 | loss: 0.2435539
	speed: 0.4045s/iter; left time: 3608.1569s
Epoch: 8 cost time: 299.78038001060486
Epoch: 8, Steps: 740 | Train Loss: 0.2358319 Vali Loss: 0.3520188 Test Loss: 0.4302479
Validation loss decreased (0.355389 --> 0.352019).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.2352119
	speed: 0.8918s/iter; left time: 7830.6737s
	iters: 200, epoch: 9 | loss: 0.2619086
	speed: 0.4082s/iter; left time: 3543.4489s
	iters: 300, epoch: 9 | loss: 0.2492680
	speed: 0.4063s/iter; left time: 3486.8695s
	iters: 400, epoch: 9 | loss: 0.2269998
	speed: 0.4252s/iter; left time: 3606.0085s
	iters: 500, epoch: 9 | loss: 0.2423431
	speed: 0.4047s/iter; left time: 3391.8773s
	iters: 600, epoch: 9 | loss: 0.2409989
	speed: 0.4027s/iter; left time: 3334.5544s
	iters: 700, epoch: 9 | loss: 0.2230076
	speed: 0.4017s/iter; left time: 3286.4422s
Epoch: 9 cost time: 302.4744918346405
Epoch: 9, Steps: 740 | Train Loss: 0.2335862 Vali Loss: 0.3500667 Test Loss: 0.4277267
Validation loss decreased (0.352019 --> 0.350067).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.2250119
	speed: 0.8931s/iter; left time: 7181.6115s
	iters: 200, epoch: 10 | loss: 0.2138288
	speed: 0.4126s/iter; left time: 3276.7698s
	iters: 300, epoch: 10 | loss: 0.2308030
	speed: 0.4068s/iter; left time: 3189.6535s
	iters: 400, epoch: 10 | loss: 0.2447196
	speed: 0.4097s/iter; left time: 3171.7848s
	iters: 500, epoch: 10 | loss: 0.2152910
	speed: 0.4179s/iter; left time: 3192.8269s
	iters: 600, epoch: 10 | loss: 0.2057001
	speed: 0.4046s/iter; left time: 3051.3118s
	iters: 700, epoch: 10 | loss: 0.2220624
	speed: 0.4053s/iter; left time: 3015.6164s
Epoch: 10 cost time: 303.23875665664673
Epoch: 10, Steps: 740 | Train Loss: 0.2323783 Vali Loss: 0.3489137 Test Loss: 0.4268254
Validation loss decreased (0.350067 --> 0.348914).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.2265852
	speed: 0.8863s/iter; left time: 6470.6121s
	iters: 200, epoch: 11 | loss: 0.2405732
	speed: 0.4162s/iter; left time: 2996.9036s
	iters: 300, epoch: 11 | loss: 0.2399360
	speed: 0.4091s/iter; left time: 2904.8815s
	iters: 400, epoch: 11 | loss: 0.2250517
	speed: 0.4046s/iter; left time: 2832.5337s
	iters: 500, epoch: 11 | loss: 0.1943517
	speed: 0.4075s/iter; left time: 2812.4200s
	iters: 600, epoch: 11 | loss: 0.2605041
	speed: 0.4076s/iter; left time: 2771.8766s
	iters: 700, epoch: 11 | loss: 0.2416482
	speed: 0.4039s/iter; left time: 2706.5589s
Epoch: 11 cost time: 301.7994878292084
Epoch: 11, Steps: 740 | Train Loss: 0.2316949 Vali Loss: 0.3485527 Test Loss: 0.4261634
Validation loss decreased (0.348914 --> 0.348553).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.2361339
	speed: 0.8835s/iter; left time: 5796.3877s
	iters: 200, epoch: 12 | loss: 0.1948898
	speed: 0.4103s/iter; left time: 2651.1062s
	iters: 300, epoch: 12 | loss: 0.2012336
	speed: 0.4096s/iter; left time: 2605.4493s
	iters: 400, epoch: 12 | loss: 0.2179631
	speed: 0.4056s/iter; left time: 2539.4336s
	iters: 500, epoch: 12 | loss: 0.2565234
	speed: 0.4041s/iter; left time: 2489.7829s
	iters: 600, epoch: 12 | loss: 0.2303665
	speed: 0.4068s/iter; left time: 2465.4488s
	iters: 700, epoch: 12 | loss: 0.2475516
	speed: 0.4027s/iter; left time: 2400.6318s
Epoch: 12 cost time: 300.6737017631531
Epoch: 12, Steps: 740 | Train Loss: 0.2313338 Vali Loss: 0.3481440 Test Loss: 0.4260228
Validation loss decreased (0.348553 --> 0.348144).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.2453210
	speed: 0.8912s/iter; left time: 5187.8241s
	iters: 200, epoch: 13 | loss: 0.2486831
	speed: 0.4048s/iter; left time: 2315.6040s
	iters: 300, epoch: 13 | loss: 0.2337984
	speed: 0.4069s/iter; left time: 2287.3097s
	iters: 400, epoch: 13 | loss: 0.2445118
	speed: 0.4080s/iter; left time: 2252.6186s
	iters: 500, epoch: 13 | loss: 0.2438894
	speed: 0.4045s/iter; left time: 2192.7719s
	iters: 600, epoch: 13 | loss: 0.2138169
	speed: 0.4039s/iter; left time: 2149.0583s
	iters: 700, epoch: 13 | loss: 0.2115638
	speed: 0.4126s/iter; left time: 2154.3623s
Epoch: 13 cost time: 301.65406250953674
Epoch: 13, Steps: 740 | Train Loss: 0.2311330 Vali Loss: 0.3480968 Test Loss: 0.4259414
Validation loss decreased (0.348144 --> 0.348097).  Saving model ...
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 14 | loss: 0.2478282
	speed: 0.8798s/iter; left time: 4470.0772s
	iters: 200, epoch: 14 | loss: 0.1956936
	speed: 0.4095s/iter; left time: 2039.5296s
	iters: 300, epoch: 14 | loss: 0.2398341
	speed: 0.4055s/iter; left time: 1979.2090s
	iters: 400, epoch: 14 | loss: 0.2099523
	speed: 0.4069s/iter; left time: 1945.2701s
	iters: 500, epoch: 14 | loss: 0.2151586
	speed: 0.4066s/iter; left time: 1903.1654s
	iters: 600, epoch: 14 | loss: 0.2384798
	speed: 0.4048s/iter; left time: 1854.3499s
	iters: 700, epoch: 14 | loss: 0.2526696
	speed: 0.4044s/iter; left time: 1812.0912s
Epoch: 14 cost time: 301.0792725086212
Epoch: 14, Steps: 740 | Train Loss: 0.2310212 Vali Loss: 0.3478900 Test Loss: 0.4259128
Validation loss decreased (0.348097 --> 0.347890).  Saving model ...
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 15 | loss: 0.2259705
	speed: 0.8848s/iter; left time: 3840.8632s
	iters: 200, epoch: 15 | loss: 0.2246364
	speed: 0.4074s/iter; left time: 1727.9505s
	iters: 300, epoch: 15 | loss: 0.2319622
	speed: 0.4073s/iter; left time: 1686.8113s
	iters: 400, epoch: 15 | loss: 0.2338360
	speed: 0.4061s/iter; left time: 1641.0704s
	iters: 500, epoch: 15 | loss: 0.2148095
	speed: 0.4056s/iter; left time: 1598.2796s
	iters: 600, epoch: 15 | loss: 0.2161267
	speed: 0.4064s/iter; left time: 1560.9128s
	iters: 700, epoch: 15 | loss: 0.2260594
	speed: 0.4055s/iter; left time: 1517.0177s
Epoch: 15 cost time: 300.49332761764526
Epoch: 15, Steps: 740 | Train Loss: 0.2309730 Vali Loss: 0.3483336 Test Loss: 0.4258900
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 16 | loss: 0.2322877
	speed: 0.8322s/iter; left time: 2996.8633s
	iters: 200, epoch: 16 | loss: 0.2095437
	speed: 0.4023s/iter; left time: 1408.4004s
	iters: 300, epoch: 16 | loss: 0.2169130
	speed: 0.4114s/iter; left time: 1399.0635s
	iters: 400, epoch: 16 | loss: 0.2437253
	speed: 0.4049s/iter; left time: 1336.6097s
	iters: 500, epoch: 16 | loss: 0.2782026
	speed: 0.4068s/iter; left time: 1302.2365s
	iters: 600, epoch: 16 | loss: 0.2056309
	speed: 0.4096s/iter; left time: 1270.2212s
	iters: 700, epoch: 16 | loss: 0.2044352
	speed: 0.4064s/iter; left time: 1219.5525s
Epoch: 16 cost time: 300.84701108932495
Epoch: 16, Steps: 740 | Train Loss: 0.2309242 Vali Loss: 0.3481804 Test Loss: 0.4258858
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 17 | loss: 0.2152769
	speed: 0.8356s/iter; left time: 2390.5659s
	iters: 200, epoch: 17 | loss: 0.2259459
	speed: 0.4021s/iter; left time: 1110.3096s
	iters: 300, epoch: 17 | loss: 0.1956187
	speed: 0.4020s/iter; left time: 1069.7974s
	iters: 400, epoch: 17 | loss: 0.2063366
	speed: 0.4097s/iter; left time: 1049.2089s
	iters: 500, epoch: 17 | loss: 0.2031196
	speed: 0.4056s/iter; left time: 998.1489s
	iters: 600, epoch: 17 | loss: 0.2286761
	speed: 0.4065s/iter; left time: 959.6913s
	iters: 700, epoch: 17 | loss: 0.2672790
	speed: 0.4070s/iter; left time: 920.1928s
Epoch: 17 cost time: 300.64228224754333
Epoch: 17, Steps: 740 | Train Loss: 0.2309472 Vali Loss: 0.3478411 Test Loss: 0.4258830
Validation loss decreased (0.347890 --> 0.347841).  Saving model ...
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 18 | loss: 0.2229317
	speed: 0.8848s/iter; left time: 1876.5887s
	iters: 200, epoch: 18 | loss: 0.2356739
	speed: 0.4124s/iter; left time: 833.5437s
	iters: 300, epoch: 18 | loss: 0.2039344
	speed: 0.4021s/iter; left time: 772.4811s
	iters: 400, epoch: 18 | loss: 0.2579586
	speed: 0.4026s/iter; left time: 733.0923s
	iters: 500, epoch: 18 | loss: 0.1956305
	speed: 0.4078s/iter; left time: 701.8665s
	iters: 600, epoch: 18 | loss: 0.2432533
	speed: 0.4060s/iter; left time: 658.1117s
	iters: 700, epoch: 18 | loss: 0.2286662
	speed: 0.4090s/iter; left time: 622.1098s
Epoch: 18 cost time: 300.949960231781
Epoch: 18, Steps: 740 | Train Loss: 0.2309401 Vali Loss: 0.3480598 Test Loss: 0.4258826
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 19 | loss: 0.2239286
	speed: 0.8333s/iter; left time: 1150.7429s
	iters: 200, epoch: 19 | loss: 0.2159198
	speed: 0.4093s/iter; left time: 524.3670s
	iters: 300, epoch: 19 | loss: 0.2309759
	speed: 0.4050s/iter; left time: 478.3611s
	iters: 400, epoch: 19 | loss: 0.2631981
	speed: 0.4048s/iter; left time: 437.6141s
	iters: 500, epoch: 19 | loss: 0.2444735
	speed: 0.4077s/iter; left time: 399.9148s
	iters: 600, epoch: 19 | loss: 0.2483334
	speed: 0.4056s/iter; left time: 357.3497s
	iters: 700, epoch: 19 | loss: 0.2679729
	speed: 0.4059s/iter; left time: 317.0320s
Epoch: 19 cost time: 300.8077793121338
Epoch: 19, Steps: 740 | Train Loss: 0.2309389 Vali Loss: 0.3479125 Test Loss: 0.4258824
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 20 | loss: 0.2205029
	speed: 0.8326s/iter; left time: 533.6678s
	iters: 200, epoch: 20 | loss: 0.2364148
	speed: 0.4048s/iter; left time: 218.9857s
	iters: 300, epoch: 20 | loss: 0.2554468
	speed: 0.4061s/iter; left time: 179.0974s
	iters: 400, epoch: 20 | loss: 0.2152324
	speed: 0.4045s/iter; left time: 137.9234s
	iters: 500, epoch: 20 | loss: 0.2406339
	speed: 0.4040s/iter; left time: 97.3548s
	iters: 600, epoch: 20 | loss: 0.2192276
	speed: 0.4095s/iter; left time: 57.7413s
	iters: 700, epoch: 20 | loss: 0.2412667
	speed: 0.4059s/iter; left time: 16.6426s
Epoch: 20 cost time: 300.18461537361145
Epoch: 20, Steps: 740 | Train Loss: 0.2309225 Vali Loss: 0.3483391 Test Loss: 0.4258821
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.9073486328125e-08
>>>>>>>testing : traffic_336_96_DLinear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed10458<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3413
mse:0.4261402487754822, mae:0.29838743805885315
