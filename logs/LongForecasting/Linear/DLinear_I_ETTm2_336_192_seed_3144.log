Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='DLinear', model_id='ETTm2_336_192', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=192, root_path='./dataset/', save_pred_values=False, seed=3144, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTm2_336_192_DLinear_ETTm2_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3144>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34033
val 11329
test 11329
	iters: 100, epoch: 1 | loss: 0.3066927
	speed: 0.0092s/iter; left time: 194.8697s
	iters: 200, epoch: 1 | loss: 1.0046602
	speed: 0.0091s/iter; left time: 190.6126s
	iters: 300, epoch: 1 | loss: 0.2410421
	speed: 0.0091s/iter; left time: 189.7521s
	iters: 400, epoch: 1 | loss: 0.5113288
	speed: 0.0100s/iter; left time: 208.4727s
	iters: 500, epoch: 1 | loss: 0.4995675
	speed: 0.0111s/iter; left time: 231.4668s
	iters: 600, epoch: 1 | loss: 0.4469241
	speed: 0.0105s/iter; left time: 216.1695s
	iters: 700, epoch: 1 | loss: 0.3420299
	speed: 0.0105s/iter; left time: 215.5511s
	iters: 800, epoch: 1 | loss: 0.5767646
	speed: 0.0120s/iter; left time: 245.8204s
	iters: 900, epoch: 1 | loss: 0.5475990
	speed: 0.0117s/iter; left time: 237.4913s
	iters: 1000, epoch: 1 | loss: 0.5965661
	speed: 0.0107s/iter; left time: 216.0140s
Epoch: 1 cost time: 11.034043312072754
Epoch: 1, Steps: 1063 | Train Loss: 0.5687439 Vali Loss: 0.3489703 Test Loss: 0.5667273
Validation loss decreased (inf --> 0.348970).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.4270223
	speed: 0.0461s/iter; left time: 926.2749s
	iters: 200, epoch: 2 | loss: 0.4346262
	speed: 0.0103s/iter; left time: 205.8000s
	iters: 300, epoch: 2 | loss: 0.3262709
	speed: 0.0098s/iter; left time: 194.8797s
	iters: 400, epoch: 2 | loss: 0.4906881
	speed: 0.0103s/iter; left time: 203.3611s
	iters: 500, epoch: 2 | loss: 0.3216018
	speed: 0.0096s/iter; left time: 189.9371s
	iters: 600, epoch: 2 | loss: 0.5491109
	speed: 0.0102s/iter; left time: 199.1465s
	iters: 700, epoch: 2 | loss: 0.3271149
	speed: 0.0104s/iter; left time: 203.3923s
	iters: 800, epoch: 2 | loss: 0.5744396
	speed: 0.0103s/iter; left time: 200.3974s
	iters: 900, epoch: 2 | loss: 0.5693557
	speed: 0.0109s/iter; left time: 210.6296s
	iters: 1000, epoch: 2 | loss: 0.4793808
	speed: 0.0103s/iter; left time: 197.7902s
Epoch: 2 cost time: 10.94915223121643
Epoch: 2, Steps: 1063 | Train Loss: 0.5498631 Vali Loss: 0.5260081 Test Loss: 1.1706933
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.4691578
	speed: 0.0460s/iter; left time: 876.3547s
	iters: 200, epoch: 3 | loss: 0.2642049
	speed: 0.0109s/iter; left time: 206.0896s
	iters: 300, epoch: 3 | loss: 0.2796870
	speed: 0.0109s/iter; left time: 205.3254s
	iters: 400, epoch: 3 | loss: 0.4796220
	speed: 0.0116s/iter; left time: 216.6467s
	iters: 500, epoch: 3 | loss: 0.4455200
	speed: 0.0112s/iter; left time: 209.4662s
	iters: 600, epoch: 3 | loss: 0.2483704
	speed: 0.0102s/iter; left time: 188.2370s
	iters: 700, epoch: 3 | loss: 0.2207662
	speed: 0.0110s/iter; left time: 203.6541s
	iters: 800, epoch: 3 | loss: 0.2963703
	speed: 0.0107s/iter; left time: 196.1904s
	iters: 900, epoch: 3 | loss: 0.5023617
	speed: 0.0107s/iter; left time: 194.3975s
	iters: 1000, epoch: 3 | loss: 0.2609426
	speed: 0.0105s/iter; left time: 190.0803s
Epoch: 3 cost time: 11.446907997131348
Epoch: 3, Steps: 1063 | Train Loss: 0.3712648 Vali Loss: 0.2621928 Test Loss: 0.4558422
Validation loss decreased (0.348970 --> 0.262193).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.3060942
	speed: 0.0429s/iter; left time: 770.9474s
	iters: 200, epoch: 4 | loss: 0.3708523
	speed: 0.0106s/iter; left time: 188.7583s
	iters: 300, epoch: 4 | loss: 0.4440525
	speed: 0.0110s/iter; left time: 194.6638s
	iters: 400, epoch: 4 | loss: 0.3585998
	speed: 0.0121s/iter; left time: 213.5745s
	iters: 500, epoch: 4 | loss: 0.3835978
	speed: 0.0107s/iter; left time: 187.2403s
	iters: 600, epoch: 4 | loss: 0.5738780
	speed: 0.0094s/iter; left time: 164.6148s
	iters: 700, epoch: 4 | loss: 0.2728027
	speed: 0.0112s/iter; left time: 194.3921s
	iters: 800, epoch: 4 | loss: 0.2952888
	speed: 0.0112s/iter; left time: 193.6440s
	iters: 900, epoch: 4 | loss: 0.3613646
	speed: 0.0094s/iter; left time: 161.7741s
	iters: 1000, epoch: 4 | loss: 0.3535687
	speed: 0.0096s/iter; left time: 163.3883s
Epoch: 4 cost time: 11.290534973144531
Epoch: 4, Steps: 1063 | Train Loss: 0.3215627 Vali Loss: 0.2360118 Test Loss: 0.4333053
Validation loss decreased (0.262193 --> 0.236012).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.2882729
	speed: 0.0482s/iter; left time: 815.2268s
	iters: 200, epoch: 5 | loss: 0.2990741
	speed: 0.0108s/iter; left time: 180.9108s
	iters: 300, epoch: 5 | loss: 0.4089891
	speed: 0.0113s/iter; left time: 189.3860s
	iters: 400, epoch: 5 | loss: 0.3124448
	speed: 0.0121s/iter; left time: 200.8477s
	iters: 500, epoch: 5 | loss: 0.2047259
	speed: 0.0120s/iter; left time: 198.4074s
	iters: 600, epoch: 5 | loss: 0.1941591
	speed: 0.0107s/iter; left time: 175.4709s
	iters: 700, epoch: 5 | loss: 0.2414505
	speed: 0.0106s/iter; left time: 173.5684s
	iters: 800, epoch: 5 | loss: 0.3381425
	speed: 0.0107s/iter; left time: 174.1475s
	iters: 900, epoch: 5 | loss: 0.3778410
	speed: 0.0112s/iter; left time: 181.1211s
	iters: 1000, epoch: 5 | loss: 0.5137005
	speed: 0.0110s/iter; left time: 175.6285s
Epoch: 5 cost time: 11.679431915283203
Epoch: 5, Steps: 1063 | Train Loss: 0.2993483 Vali Loss: 0.2360468 Test Loss: 0.4478317
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.1759844
	speed: 0.0430s/iter; left time: 681.0887s
	iters: 200, epoch: 6 | loss: 0.2102861
	speed: 0.0098s/iter; left time: 154.4787s
	iters: 300, epoch: 6 | loss: 0.2454373
	speed: 0.0110s/iter; left time: 172.4529s
	iters: 400, epoch: 6 | loss: 0.1746677
	speed: 0.0114s/iter; left time: 176.4537s
	iters: 500, epoch: 6 | loss: 0.3415174
	speed: 0.0106s/iter; left time: 163.4642s
	iters: 600, epoch: 6 | loss: 0.3041937
	speed: 0.0104s/iter; left time: 159.3401s
	iters: 700, epoch: 6 | loss: 0.2361623
	speed: 0.0108s/iter; left time: 164.8243s
	iters: 800, epoch: 6 | loss: 0.3923368
	speed: 0.0115s/iter; left time: 174.2136s
	iters: 900, epoch: 6 | loss: 0.2121557
	speed: 0.0110s/iter; left time: 165.4090s
	iters: 1000, epoch: 6 | loss: 0.2223275
	speed: 0.0103s/iter; left time: 153.8265s
Epoch: 6 cost time: 11.336124420166016
Epoch: 6, Steps: 1063 | Train Loss: 0.2877797 Vali Loss: 0.1804985 Test Loss: 0.2809961
Validation loss decreased (0.236012 --> 0.180499).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.2616902
	speed: 0.0450s/iter; left time: 665.3670s
	iters: 200, epoch: 7 | loss: 0.1810793
	speed: 0.0101s/iter; left time: 148.7815s
	iters: 300, epoch: 7 | loss: 0.3318370
	speed: 0.0094s/iter; left time: 136.9549s
	iters: 400, epoch: 7 | loss: 0.2327997
	speed: 0.0081s/iter; left time: 116.7647s
	iters: 500, epoch: 7 | loss: 0.3125008
	speed: 0.0100s/iter; left time: 144.4440s
	iters: 600, epoch: 7 | loss: 0.1600413
	speed: 0.0101s/iter; left time: 143.8378s
	iters: 700, epoch: 7 | loss: 0.4048698
	speed: 0.0114s/iter; left time: 161.9886s
	iters: 800, epoch: 7 | loss: 0.1767561
	speed: 0.0098s/iter; left time: 137.9016s
	iters: 900, epoch: 7 | loss: 0.2250246
	speed: 0.0120s/iter; left time: 167.8136s
	iters: 1000, epoch: 7 | loss: 0.2897983
	speed: 0.0107s/iter; left time: 148.1684s
Epoch: 7 cost time: 10.807255029678345
Epoch: 7, Steps: 1063 | Train Loss: 0.2815887 Vali Loss: 0.2279623 Test Loss: 0.4289251
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.1574640
	speed: 0.0433s/iter; left time: 594.4052s
	iters: 200, epoch: 8 | loss: 0.2907526
	speed: 0.0101s/iter; left time: 138.0177s
	iters: 300, epoch: 8 | loss: 0.2599172
	speed: 0.0109s/iter; left time: 146.8822s
	iters: 400, epoch: 8 | loss: 0.4504142
	speed: 0.0096s/iter; left time: 128.2042s
	iters: 500, epoch: 8 | loss: 0.2231895
	speed: 0.0099s/iter; left time: 132.2858s
	iters: 600, epoch: 8 | loss: 0.3165674
	speed: 0.0106s/iter; left time: 140.5797s
	iters: 700, epoch: 8 | loss: 0.3454345
	speed: 0.0110s/iter; left time: 144.7218s
	iters: 800, epoch: 8 | loss: 0.2256939
	speed: 0.0120s/iter; left time: 155.9957s
	iters: 900, epoch: 8 | loss: 0.2048400
	speed: 0.0115s/iter; left time: 149.1229s
	iters: 1000, epoch: 8 | loss: 0.1455864
	speed: 0.0111s/iter; left time: 141.6650s
Epoch: 8 cost time: 11.276428461074829
Epoch: 8, Steps: 1063 | Train Loss: 0.2778390 Vali Loss: 0.1793571 Test Loss: 0.2885007
Validation loss decreased (0.180499 --> 0.179357).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.3783959
	speed: 0.0428s/iter; left time: 542.2275s
	iters: 200, epoch: 9 | loss: 0.2882547
	speed: 0.0097s/iter; left time: 121.8354s
	iters: 300, epoch: 9 | loss: 0.4243308
	speed: 0.0097s/iter; left time: 120.4648s
	iters: 400, epoch: 9 | loss: 0.3629745
	speed: 0.0111s/iter; left time: 137.2088s
	iters: 500, epoch: 9 | loss: 0.1236635
	speed: 0.0103s/iter; left time: 126.6483s
	iters: 600, epoch: 9 | loss: 0.5273634
	speed: 0.0104s/iter; left time: 125.9554s
	iters: 700, epoch: 9 | loss: 0.2961223
	speed: 0.0113s/iter; left time: 136.6092s
	iters: 800, epoch: 9 | loss: 0.2383028
	speed: 0.0116s/iter; left time: 139.2130s
	iters: 900, epoch: 9 | loss: 0.2524910
	speed: 0.0107s/iter; left time: 126.6577s
	iters: 1000, epoch: 9 | loss: 0.1984554
	speed: 0.0102s/iter; left time: 119.9454s
Epoch: 9 cost time: 11.206993579864502
Epoch: 9, Steps: 1063 | Train Loss: 0.2758201 Vali Loss: 0.1986719 Test Loss: 0.3544391
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.2173201
	speed: 0.0462s/iter; left time: 535.6556s
	iters: 200, epoch: 10 | loss: 0.2068201
	speed: 0.0098s/iter; left time: 112.8935s
	iters: 300, epoch: 10 | loss: 0.1748817
	speed: 0.0095s/iter; left time: 108.7241s
	iters: 400, epoch: 10 | loss: 0.1566380
	speed: 0.0101s/iter; left time: 114.0770s
	iters: 500, epoch: 10 | loss: 0.3428448
	speed: 0.0104s/iter; left time: 115.8703s
	iters: 600, epoch: 10 | loss: 0.1963863
	speed: 0.0113s/iter; left time: 125.1667s
	iters: 700, epoch: 10 | loss: 0.3287930
	speed: 0.0121s/iter; left time: 133.0614s
	iters: 800, epoch: 10 | loss: 0.1453222
	speed: 0.0114s/iter; left time: 124.1935s
	iters: 900, epoch: 10 | loss: 0.1836381
	speed: 0.0100s/iter; left time: 108.2932s
	iters: 1000, epoch: 10 | loss: 0.1673172
	speed: 0.0096s/iter; left time: 102.2543s
Epoch: 10 cost time: 11.092112064361572
Epoch: 10, Steps: 1063 | Train Loss: 0.2747047 Vali Loss: 0.1902389 Test Loss: 0.3236730
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.2490748
	speed: 0.0442s/iter; left time: 465.0354s
	iters: 200, epoch: 11 | loss: 0.2780516
	speed: 0.0097s/iter; left time: 101.1038s
	iters: 300, epoch: 11 | loss: 0.2367123
	speed: 0.0104s/iter; left time: 107.0507s
	iters: 400, epoch: 11 | loss: 0.3247358
	speed: 0.0103s/iter; left time: 105.0221s
	iters: 500, epoch: 11 | loss: 0.1666415
	speed: 0.0086s/iter; left time: 87.1089s
	iters: 600, epoch: 11 | loss: 0.1538926
	speed: 0.0103s/iter; left time: 103.5464s
	iters: 700, epoch: 11 | loss: 0.2207659
	speed: 0.0109s/iter; left time: 108.0025s
	iters: 800, epoch: 11 | loss: 0.3593094
	speed: 0.0094s/iter; left time: 92.1004s
	iters: 900, epoch: 11 | loss: 0.2131149
	speed: 0.0113s/iter; left time: 109.6989s
	iters: 1000, epoch: 11 | loss: 0.1976053
	speed: 0.0111s/iter; left time: 107.2119s
Epoch: 11 cost time: 10.867773056030273
Epoch: 11, Steps: 1063 | Train Loss: 0.2742298 Vali Loss: 0.1948632 Test Loss: 0.3361167
EarlyStopping counter: 3 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.7326599
	speed: 0.0476s/iter; left time: 450.6251s
	iters: 200, epoch: 12 | loss: 0.2036344
	speed: 0.0104s/iter; left time: 97.3574s
	iters: 300, epoch: 12 | loss: 0.2663204
	speed: 0.0100s/iter; left time: 92.9831s
	iters: 400, epoch: 12 | loss: 0.2580617
	speed: 0.0104s/iter; left time: 95.5905s
	iters: 500, epoch: 12 | loss: 0.3377047
	speed: 0.0104s/iter; left time: 94.3090s
	iters: 600, epoch: 12 | loss: 0.3160425
	speed: 0.0114s/iter; left time: 102.4134s
	iters: 700, epoch: 12 | loss: 0.3408306
	speed: 0.0091s/iter; left time: 80.5250s
	iters: 800, epoch: 12 | loss: 0.2080300
	speed: 0.0109s/iter; left time: 95.1627s
	iters: 900, epoch: 12 | loss: 0.1967854
	speed: 0.0120s/iter; left time: 104.1460s
	iters: 1000, epoch: 12 | loss: 0.1667681
	speed: 0.0101s/iter; left time: 86.8348s
Epoch: 12 cost time: 11.17370343208313
Epoch: 12, Steps: 1063 | Train Loss: 0.2739200 Vali Loss: 0.1981510 Test Loss: 0.3460418
EarlyStopping counter: 4 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.2071747
	speed: 0.0447s/iter; left time: 375.4428s
	iters: 200, epoch: 13 | loss: 0.1924353
	speed: 0.0109s/iter; left time: 90.6976s
	iters: 300, epoch: 13 | loss: 0.1543103
	speed: 0.0110s/iter; left time: 90.2970s
	iters: 400, epoch: 13 | loss: 0.2989245
	speed: 0.0103s/iter; left time: 83.4032s
	iters: 500, epoch: 13 | loss: 0.2803351
	speed: 0.0111s/iter; left time: 88.7169s
	iters: 600, epoch: 13 | loss: 0.1395011
	speed: 0.0111s/iter; left time: 88.0087s
	iters: 700, epoch: 13 | loss: 0.2408478
	speed: 0.0111s/iter; left time: 86.3344s
	iters: 800, epoch: 13 | loss: 0.2949150
	speed: 0.0100s/iter; left time: 77.3950s
	iters: 900, epoch: 13 | loss: 0.3016337
	speed: 0.0106s/iter; left time: 80.6952s
	iters: 1000, epoch: 13 | loss: 0.4448490
	speed: 0.0107s/iter; left time: 80.4710s
Epoch: 13 cost time: 11.399581909179688
Epoch: 13, Steps: 1063 | Train Loss: 0.2737234 Vali Loss: 0.1971487 Test Loss: 0.3436332
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTm2_336_192_DLinear_ETTm2_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3144<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
mse:0.28912678360939026, mae:0.34124040603637695
