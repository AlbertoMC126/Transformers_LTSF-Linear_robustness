Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='Linear', model_id='ETTm2_336_720', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=720, root_path='./dataset/', save_pred_values=False, seed=32598, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTm2_336_720_Linear_ETTm2_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed32598>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33505
val 10801
test 10801
	iters: 100, epoch: 1 | loss: 0.6330097
	speed: 0.0193s/iter; left time: 402.7311s
	iters: 200, epoch: 1 | loss: 1.3003807
	speed: 0.0191s/iter; left time: 395.9295s
	iters: 300, epoch: 1 | loss: 0.4624362
	speed: 0.0191s/iter; left time: 394.8687s
	iters: 400, epoch: 1 | loss: 0.5114714
	speed: 0.0197s/iter; left time: 404.6727s
	iters: 500, epoch: 1 | loss: 0.6928511
	speed: 0.0190s/iter; left time: 387.4516s
	iters: 600, epoch: 1 | loss: 0.5914433
	speed: 0.0192s/iter; left time: 390.7918s
	iters: 700, epoch: 1 | loss: 0.3816062
	speed: 0.0182s/iter; left time: 368.2475s
	iters: 800, epoch: 1 | loss: 0.7944680
	speed: 0.0204s/iter; left time: 409.9005s
	iters: 900, epoch: 1 | loss: 0.8373396
	speed: 0.0182s/iter; left time: 364.3446s
	iters: 1000, epoch: 1 | loss: 0.5098017
	speed: 0.0178s/iter; left time: 355.9015s
Epoch: 1 cost time: 19.746647119522095
Epoch: 1, Steps: 1047 | Train Loss: 0.7164258 Vali Loss: 1.8875359 Test Loss: 6.6596928
Validation loss decreased (inf --> 1.887536).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.5029819
	speed: 0.0627s/iter; left time: 1241.1930s
	iters: 200, epoch: 2 | loss: 0.5332903
	speed: 0.0193s/iter; left time: 380.2813s
	iters: 300, epoch: 2 | loss: 0.7517827
	speed: 0.0179s/iter; left time: 349.7579s
	iters: 400, epoch: 2 | loss: 0.6459724
	speed: 0.0179s/iter; left time: 348.8462s
	iters: 500, epoch: 2 | loss: 0.5362659
	speed: 0.0190s/iter; left time: 369.3252s
	iters: 600, epoch: 2 | loss: 0.7054381
	speed: 0.0198s/iter; left time: 382.8006s
	iters: 700, epoch: 2 | loss: 0.6238549
	speed: 0.0177s/iter; left time: 339.8813s
	iters: 800, epoch: 2 | loss: 0.5561548
	speed: 0.0167s/iter; left time: 318.9246s
	iters: 900, epoch: 2 | loss: 0.6696819
	speed: 0.0187s/iter; left time: 355.4171s
	iters: 1000, epoch: 2 | loss: 0.5160428
	speed: 0.0187s/iter; left time: 352.5544s
Epoch: 2 cost time: 19.244197845458984
Epoch: 2, Steps: 1047 | Train Loss: 0.7302172 Vali Loss: 0.4765071 Test Loss: 0.9458423
Validation loss decreased (1.887536 --> 0.476507).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.4793236
	speed: 0.0588s/iter; left time: 1102.8103s
	iters: 200, epoch: 3 | loss: 1.0728084
	speed: 0.0184s/iter; left time: 342.8868s
	iters: 300, epoch: 3 | loss: 0.2554231
	speed: 0.0181s/iter; left time: 336.3652s
	iters: 400, epoch: 3 | loss: 0.5222827
	speed: 0.0177s/iter; left time: 325.5915s
	iters: 500, epoch: 3 | loss: 0.4204993
	speed: 0.0162s/iter; left time: 297.9720s
	iters: 600, epoch: 3 | loss: 0.6190740
	speed: 0.0168s/iter; left time: 307.1963s
	iters: 700, epoch: 3 | loss: 0.4955338
	speed: 0.0168s/iter; left time: 305.4621s
	iters: 800, epoch: 3 | loss: 0.5847904
	speed: 0.0197s/iter; left time: 356.1554s
	iters: 900, epoch: 3 | loss: 0.6126140
	speed: 0.0203s/iter; left time: 364.5827s
	iters: 1000, epoch: 3 | loss: 0.4896645
	speed: 0.0191s/iter; left time: 341.1215s
Epoch: 3 cost time: 18.83385133743286
Epoch: 3, Steps: 1047 | Train Loss: 0.5502315 Vali Loss: 0.4981965 Test Loss: 1.0352422
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.3149968
	speed: 0.0578s/iter; left time: 1023.6365s
	iters: 200, epoch: 4 | loss: 0.3607519
	speed: 0.0176s/iter; left time: 309.7934s
	iters: 300, epoch: 4 | loss: 0.7342287
	speed: 0.0177s/iter; left time: 309.3288s
	iters: 400, epoch: 4 | loss: 0.6604400
	speed: 0.0198s/iter; left time: 344.3179s
	iters: 500, epoch: 4 | loss: 0.5737488
	speed: 0.0207s/iter; left time: 357.4434s
	iters: 600, epoch: 4 | loss: 0.5993756
	speed: 0.0161s/iter; left time: 277.4273s
	iters: 700, epoch: 4 | loss: 0.6933209
	speed: 0.0157s/iter; left time: 268.0248s
	iters: 800, epoch: 4 | loss: 0.4889309
	speed: 0.0167s/iter; left time: 283.6495s
	iters: 900, epoch: 4 | loss: 0.6741614
	speed: 0.0168s/iter; left time: 284.0097s
	iters: 1000, epoch: 4 | loss: 0.4809834
	speed: 0.0184s/iter; left time: 308.5394s
Epoch: 4 cost time: 18.41775918006897
Epoch: 4, Steps: 1047 | Train Loss: 0.5025826 Vali Loss: 0.5754755 Test Loss: 1.4262040
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.4747218
	speed: 0.0616s/iter; left time: 1025.2815s
	iters: 200, epoch: 5 | loss: 0.4045105
	speed: 0.0177s/iter; left time: 292.6607s
	iters: 300, epoch: 5 | loss: 0.4435009
	speed: 0.0187s/iter; left time: 306.9376s
	iters: 400, epoch: 5 | loss: 0.8465226
	speed: 0.0167s/iter; left time: 272.4635s
	iters: 500, epoch: 5 | loss: 0.2568913
	speed: 0.0176s/iter; left time: 285.6080s
	iters: 600, epoch: 5 | loss: 0.6926221
	speed: 0.0180s/iter; left time: 291.0003s
	iters: 700, epoch: 5 | loss: 0.6951275
	speed: 0.0175s/iter; left time: 281.5403s
	iters: 800, epoch: 5 | loss: 0.3656962
	speed: 0.0176s/iter; left time: 280.0511s
	iters: 900, epoch: 5 | loss: 0.3820828
	speed: 0.0140s/iter; left time: 222.2160s
	iters: 1000, epoch: 5 | loss: 0.7587888
	speed: 0.0183s/iter; left time: 288.2011s
Epoch: 5 cost time: 18.050638437271118
Epoch: 5, Steps: 1047 | Train Loss: 0.4765799 Vali Loss: 0.6571912 Test Loss: 1.7227321
EarlyStopping counter: 3 out of 5
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.6026328
	speed: 0.0636s/iter; left time: 992.0727s
	iters: 200, epoch: 6 | loss: 0.6791856
	speed: 0.0168s/iter; left time: 260.5551s
	iters: 300, epoch: 6 | loss: 0.4737515
	speed: 0.0185s/iter; left time: 284.3115s
	iters: 400, epoch: 6 | loss: 0.6156172
	speed: 0.0180s/iter; left time: 276.1005s
	iters: 500, epoch: 6 | loss: 0.3285316
	speed: 0.0202s/iter; left time: 307.2107s
	iters: 600, epoch: 6 | loss: 0.3859435
	speed: 0.0183s/iter; left time: 276.1455s
	iters: 700, epoch: 6 | loss: 0.2660770
	speed: 0.0185s/iter; left time: 277.4500s
	iters: 800, epoch: 6 | loss: 0.6567603
	speed: 0.0185s/iter; left time: 275.9158s
	iters: 900, epoch: 6 | loss: 0.4972717
	speed: 0.0167s/iter; left time: 247.9366s
	iters: 1000, epoch: 6 | loss: 0.2766022
	speed: 0.0185s/iter; left time: 272.7853s
Epoch: 6 cost time: 18.77683401107788
Epoch: 6, Steps: 1047 | Train Loss: 0.4643598 Vali Loss: 0.4007707 Test Loss: 0.7571223
Validation loss decreased (0.476507 --> 0.400771).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.4339568
	speed: 0.0662s/iter; left time: 964.2082s
	iters: 200, epoch: 7 | loss: 0.2569076
	speed: 0.0161s/iter; left time: 232.1608s
	iters: 300, epoch: 7 | loss: 0.2966089
	speed: 0.0183s/iter; left time: 263.4435s
	iters: 400, epoch: 7 | loss: 0.4227548
	speed: 0.0187s/iter; left time: 267.1882s
	iters: 500, epoch: 7 | loss: 0.6108343
	speed: 0.0179s/iter; left time: 253.4410s
	iters: 600, epoch: 7 | loss: 0.5038375
	speed: 0.0200s/iter; left time: 280.5021s
	iters: 700, epoch: 7 | loss: 0.6013639
	speed: 0.0185s/iter; left time: 258.6077s
	iters: 800, epoch: 7 | loss: 0.4241241
	speed: 0.0181s/iter; left time: 250.6989s
	iters: 900, epoch: 7 | loss: 0.4929315
	speed: 0.0190s/iter; left time: 261.7060s
	iters: 1000, epoch: 7 | loss: 0.5198852
	speed: 0.0190s/iter; left time: 259.6058s
Epoch: 7 cost time: 18.86225652694702
Epoch: 7, Steps: 1047 | Train Loss: 0.4573222 Vali Loss: 0.4365010 Test Loss: 0.9136983
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.3625076
	speed: 0.0625s/iter; left time: 844.0455s
	iters: 200, epoch: 8 | loss: 0.6109030
	speed: 0.0155s/iter; left time: 208.3023s
	iters: 300, epoch: 8 | loss: 0.4704863
	speed: 0.0190s/iter; left time: 252.3898s
	iters: 400, epoch: 8 | loss: 0.3861481
	speed: 0.0195s/iter; left time: 258.1796s
	iters: 500, epoch: 8 | loss: 0.2897612
	speed: 0.0205s/iter; left time: 268.2379s
	iters: 600, epoch: 8 | loss: 0.6478891
	speed: 0.0214s/iter; left time: 278.5287s
	iters: 700, epoch: 8 | loss: 0.3247353
	speed: 0.0193s/iter; left time: 248.5885s
	iters: 800, epoch: 8 | loss: 0.8555536
	speed: 0.0193s/iter; left time: 247.0199s
	iters: 900, epoch: 8 | loss: 0.3164865
	speed: 0.0212s/iter; left time: 269.3891s
	iters: 1000, epoch: 8 | loss: 0.3860177
	speed: 0.0209s/iter; left time: 263.9363s
Epoch: 8 cost time: 20.16681742668152
Epoch: 8, Steps: 1047 | Train Loss: 0.4536417 Vali Loss: 0.4860686 Test Loss: 1.1045644
EarlyStopping counter: 2 out of 5
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.4142109
	speed: 0.0620s/iter; left time: 772.2429s
	iters: 200, epoch: 9 | loss: 0.3846987
	speed: 0.0156s/iter; left time: 192.6586s
	iters: 300, epoch: 9 | loss: 0.3799863
	speed: 0.0193s/iter; left time: 236.6962s
	iters: 400, epoch: 9 | loss: 0.3062557
	speed: 0.0184s/iter; left time: 223.5682s
	iters: 500, epoch: 9 | loss: 0.4653385
	speed: 0.0181s/iter; left time: 218.4125s
	iters: 600, epoch: 9 | loss: 0.4277019
	speed: 0.0195s/iter; left time: 233.8356s
	iters: 700, epoch: 9 | loss: 0.5226870
	speed: 0.0180s/iter; left time: 213.3910s
	iters: 800, epoch: 9 | loss: 0.6535004
	speed: 0.0195s/iter; left time: 229.8285s
	iters: 900, epoch: 9 | loss: 0.6800635
	speed: 0.0197s/iter; left time: 229.9433s
	iters: 1000, epoch: 9 | loss: 0.3524129
	speed: 0.0177s/iter; left time: 204.7505s
Epoch: 9 cost time: 19.01981210708618
Epoch: 9, Steps: 1047 | Train Loss: 0.4514360 Vali Loss: 0.3991622 Test Loss: 0.7982283
Validation loss decreased (0.400771 --> 0.399162).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.5947563
	speed: 0.0574s/iter; left time: 655.8051s
	iters: 200, epoch: 10 | loss: 0.5293361
	speed: 0.0146s/iter; left time: 165.0505s
	iters: 300, epoch: 10 | loss: 0.6008049
	speed: 0.0184s/iter; left time: 206.5876s
	iters: 400, epoch: 10 | loss: 0.5286161
	speed: 0.0175s/iter; left time: 194.3366s
	iters: 500, epoch: 10 | loss: 0.2249465
	speed: 0.0155s/iter; left time: 171.1825s
	iters: 600, epoch: 10 | loss: 0.3281427
	speed: 0.0171s/iter; left time: 186.4314s
	iters: 700, epoch: 10 | loss: 0.4457682
	speed: 0.0158s/iter; left time: 170.5816s
	iters: 800, epoch: 10 | loss: 0.4486146
	speed: 0.0154s/iter; left time: 164.7841s
	iters: 900, epoch: 10 | loss: 0.3355381
	speed: 0.0165s/iter; left time: 174.7062s
	iters: 1000, epoch: 10 | loss: 0.4167524
	speed: 0.0167s/iter; left time: 175.8729s
Epoch: 10 cost time: 16.997313737869263
Epoch: 10, Steps: 1047 | Train Loss: 0.4503095 Vali Loss: 0.4269686 Test Loss: 0.8975773
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.5093936
	speed: 0.0617s/iter; left time: 640.4018s
	iters: 200, epoch: 11 | loss: 0.5122780
	speed: 0.0148s/iter; left time: 151.9350s
	iters: 300, epoch: 11 | loss: 0.5547091
	speed: 0.0153s/iter; left time: 155.1365s
	iters: 400, epoch: 11 | loss: 0.6084021
	speed: 0.0150s/iter; left time: 151.0743s
	iters: 500, epoch: 11 | loss: 0.3125395
	speed: 0.0158s/iter; left time: 157.1053s
	iters: 600, epoch: 11 | loss: 0.3896280
	speed: 0.0145s/iter; left time: 142.8407s
	iters: 700, epoch: 11 | loss: 0.3753962
	speed: 0.0154s/iter; left time: 150.4421s
	iters: 800, epoch: 11 | loss: 0.6481257
	speed: 0.0151s/iter; left time: 145.7695s
	iters: 900, epoch: 11 | loss: 0.3658802
	speed: 0.0153s/iter; left time: 146.7050s
	iters: 1000, epoch: 11 | loss: 0.2952467
	speed: 0.0144s/iter; left time: 136.8092s
Epoch: 11 cost time: 15.738385438919067
Epoch: 11, Steps: 1047 | Train Loss: 0.4497101 Vali Loss: 0.4161028 Test Loss: 0.8520263
EarlyStopping counter: 2 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.7629802
	speed: 0.0548s/iter; left time: 511.1539s
	iters: 200, epoch: 12 | loss: 0.4799416
	speed: 0.0129s/iter; left time: 119.3355s
	iters: 300, epoch: 12 | loss: 0.5042697
	speed: 0.0142s/iter; left time: 129.3814s
	iters: 400, epoch: 12 | loss: 0.6422666
	speed: 0.0145s/iter; left time: 130.5050s
	iters: 500, epoch: 12 | loss: 0.3384300
	speed: 0.0146s/iter; left time: 129.9539s
	iters: 600, epoch: 12 | loss: 0.5516700
	speed: 0.0126s/iter; left time: 111.2035s
	iters: 700, epoch: 12 | loss: 0.4681739
	speed: 0.0116s/iter; left time: 100.8544s
	iters: 800, epoch: 12 | loss: 0.4866067
	speed: 0.0121s/iter; left time: 104.7419s
	iters: 900, epoch: 12 | loss: 0.3079079
	speed: 0.0118s/iter; left time: 100.6369s
	iters: 1000, epoch: 12 | loss: 0.4353901
	speed: 0.0129s/iter; left time: 108.4613s
Epoch: 12 cost time: 13.638683080673218
Epoch: 12, Steps: 1047 | Train Loss: 0.4493697 Vali Loss: 0.4054934 Test Loss: 0.8172604
EarlyStopping counter: 3 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.3634787
	speed: 0.0499s/iter; left time: 413.1219s
	iters: 200, epoch: 13 | loss: 0.5679886
	speed: 0.0123s/iter; left time: 100.7781s
	iters: 300, epoch: 13 | loss: 0.4186235
	speed: 0.0132s/iter; left time: 106.4993s
	iters: 400, epoch: 13 | loss: 0.3840010
	speed: 0.0133s/iter; left time: 106.2956s
	iters: 500, epoch: 13 | loss: 0.4313236
	speed: 0.0132s/iter; left time: 103.7047s
	iters: 600, epoch: 13 | loss: 0.3243352
	speed: 0.0132s/iter; left time: 102.6882s
	iters: 700, epoch: 13 | loss: 0.7953458
	speed: 0.0133s/iter; left time: 101.9191s
	iters: 800, epoch: 13 | loss: 0.4386125
	speed: 0.0124s/iter; left time: 94.3267s
	iters: 900, epoch: 13 | loss: 0.4348620
	speed: 0.0114s/iter; left time: 85.4731s
	iters: 1000, epoch: 13 | loss: 0.2945471
	speed: 0.0116s/iter; left time: 85.4571s
Epoch: 13 cost time: 13.171126127243042
Epoch: 13, Steps: 1047 | Train Loss: 0.4491817 Vali Loss: 0.4097608 Test Loss: 0.8302217
EarlyStopping counter: 4 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 14 | loss: 0.3702186
	speed: 0.0484s/iter; left time: 349.7890s
	iters: 200, epoch: 14 | loss: 0.4981566
	speed: 0.0122s/iter; left time: 86.8879s
	iters: 300, epoch: 14 | loss: 0.3808759
	speed: 0.0122s/iter; left time: 85.5612s
	iters: 400, epoch: 14 | loss: 0.5417487
	speed: 0.0132s/iter; left time: 91.2484s
	iters: 500, epoch: 14 | loss: 0.8157161
	speed: 0.0133s/iter; left time: 91.0255s
	iters: 600, epoch: 14 | loss: 0.5493106
	speed: 0.0130s/iter; left time: 87.3113s
	iters: 700, epoch: 14 | loss: 0.4127602
	speed: 0.0131s/iter; left time: 86.8027s
	iters: 800, epoch: 14 | loss: 0.6399179
	speed: 0.0131s/iter; left time: 85.2795s
	iters: 900, epoch: 14 | loss: 0.3548879
	speed: 0.0128s/iter; left time: 82.3244s
	iters: 1000, epoch: 14 | loss: 0.3157308
	speed: 0.0123s/iter; left time: 77.8891s
Epoch: 14 cost time: 13.370511054992676
Epoch: 14, Steps: 1047 | Train Loss: 0.4490917 Vali Loss: 0.4119192 Test Loss: 0.8369411
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTm2_336_720_Linear_ETTm2_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed32598<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10801
mse:0.7989201545715332, mae:0.5811040997505188
