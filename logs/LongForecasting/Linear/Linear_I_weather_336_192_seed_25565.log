Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='Linear', model_id='weather_336_192', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=192, root_path='./dataset/', save_pred_values=False, seed=25565, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : weather_336_192_Linear_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed25565>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36360
val 5079
test 10348
	iters: 100, epoch: 1 | loss: 0.9848354
	speed: 0.0147s/iter; left time: 668.2708s
	iters: 200, epoch: 1 | loss: 1.7415701
	speed: 0.0146s/iter; left time: 659.7045s
	iters: 300, epoch: 1 | loss: 0.3695021
	speed: 0.0144s/iter; left time: 649.6226s
	iters: 400, epoch: 1 | loss: 0.5134118
	speed: 0.0147s/iter; left time: 661.2753s
	iters: 500, epoch: 1 | loss: 0.3482202
	speed: 0.0143s/iter; left time: 642.9835s
	iters: 600, epoch: 1 | loss: 0.6416155
	speed: 0.0146s/iter; left time: 654.1150s
	iters: 700, epoch: 1 | loss: 0.4264161
	speed: 0.0145s/iter; left time: 648.3714s
	iters: 800, epoch: 1 | loss: 0.5875078
	speed: 0.0146s/iter; left time: 653.1516s
	iters: 900, epoch: 1 | loss: 0.4126954
	speed: 0.0145s/iter; left time: 644.4101s
	iters: 1000, epoch: 1 | loss: 0.5651287
	speed: 0.0143s/iter; left time: 634.1209s
	iters: 1100, epoch: 1 | loss: 0.5440967
	speed: 0.0145s/iter; left time: 642.3218s
	iters: 1200, epoch: 1 | loss: 0.6598337
	speed: 0.0151s/iter; left time: 666.5809s
	iters: 1300, epoch: 1 | loss: 0.3345552
	speed: 0.0143s/iter; left time: 629.0411s
	iters: 1400, epoch: 1 | loss: 0.3879842
	speed: 0.0144s/iter; left time: 635.9735s
	iters: 1500, epoch: 1 | loss: 0.4445328
	speed: 0.0148s/iter; left time: 650.6128s
	iters: 1600, epoch: 1 | loss: 0.4822119
	speed: 0.0144s/iter; left time: 631.4672s
	iters: 1700, epoch: 1 | loss: 0.4695775
	speed: 0.0144s/iter; left time: 628.6554s
	iters: 1800, epoch: 1 | loss: 0.4619182
	speed: 0.0147s/iter; left time: 642.8920s
	iters: 1900, epoch: 1 | loss: 0.4633916
	speed: 0.0146s/iter; left time: 635.7579s
	iters: 2000, epoch: 1 | loss: 0.4708893
	speed: 0.0149s/iter; left time: 646.3428s
	iters: 2100, epoch: 1 | loss: 1.4953015
	speed: 0.0146s/iter; left time: 631.3534s
	iters: 2200, epoch: 1 | loss: 0.3264978
	speed: 0.0143s/iter; left time: 620.0006s
Epoch: 1 cost time: 33.03214979171753
Epoch: 1, Steps: 2272 | Train Loss: 1.5972573 Vali Loss: 0.6276602 Test Loss: 0.2885657
Validation loss decreased (inf --> 0.627660).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 1.3389906
	speed: 0.0529s/iter; left time: 2276.8906s
	iters: 200, epoch: 2 | loss: 0.5116743
	speed: 0.0146s/iter; left time: 626.4586s
	iters: 300, epoch: 2 | loss: 0.4117225
	speed: 0.0146s/iter; left time: 627.6665s
	iters: 400, epoch: 2 | loss: 0.4603623
	speed: 0.0143s/iter; left time: 612.9595s
	iters: 500, epoch: 2 | loss: 0.6482345
	speed: 0.0148s/iter; left time: 633.5552s
	iters: 600, epoch: 2 | loss: 1.8404900
	speed: 0.0141s/iter; left time: 601.7134s
	iters: 700, epoch: 2 | loss: 7.6628513
	speed: 0.0145s/iter; left time: 616.3318s
	iters: 800, epoch: 2 | loss: 1.4969294
	speed: 0.0146s/iter; left time: 619.4290s
	iters: 900, epoch: 2 | loss: 0.6316108
	speed: 0.0148s/iter; left time: 624.2180s
	iters: 1000, epoch: 2 | loss: 0.6521921
	speed: 0.0141s/iter; left time: 594.9063s
	iters: 1100, epoch: 2 | loss: 0.6284258
	speed: 0.0144s/iter; left time: 604.7619s
	iters: 1200, epoch: 2 | loss: 0.4534147
	speed: 0.0142s/iter; left time: 594.8141s
	iters: 1300, epoch: 2 | loss: 0.3819127
	speed: 0.0146s/iter; left time: 612.8622s
	iters: 1400, epoch: 2 | loss: 0.3771341
	speed: 0.0146s/iter; left time: 610.5561s
	iters: 1500, epoch: 2 | loss: 0.5074577
	speed: 0.0145s/iter; left time: 604.6227s
	iters: 1600, epoch: 2 | loss: 0.4607569
	speed: 0.0145s/iter; left time: 603.4521s
	iters: 1700, epoch: 2 | loss: 0.3172958
	speed: 0.0144s/iter; left time: 599.1201s
	iters: 1800, epoch: 2 | loss: 0.3862377
	speed: 0.0144s/iter; left time: 594.9182s
	iters: 1900, epoch: 2 | loss: 0.3253124
	speed: 0.0147s/iter; left time: 605.0449s
	iters: 2000, epoch: 2 | loss: 2.0981460
	speed: 0.0144s/iter; left time: 591.7123s
	iters: 2100, epoch: 2 | loss: 3.6827154
	speed: 0.0144s/iter; left time: 592.6716s
	iters: 2200, epoch: 2 | loss: 0.4169378
	speed: 0.0147s/iter; left time: 602.8691s
Epoch: 2 cost time: 32.89781951904297
Epoch: 2, Steps: 2272 | Train Loss: 1.2194225 Vali Loss: 0.6407852 Test Loss: 0.3156975
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.8984429
	speed: 0.0536s/iter; left time: 2185.3473s
	iters: 200, epoch: 3 | loss: 0.4634923
	speed: 0.0151s/iter; left time: 613.0225s
	iters: 300, epoch: 3 | loss: 1.2071797
	speed: 0.0145s/iter; left time: 588.5130s
	iters: 400, epoch: 3 | loss: 0.4202947
	speed: 0.0146s/iter; left time: 593.1752s
	iters: 500, epoch: 3 | loss: 0.4297729
	speed: 0.0144s/iter; left time: 581.6219s
	iters: 600, epoch: 3 | loss: 0.4524669
	speed: 0.0146s/iter; left time: 586.7699s
	iters: 700, epoch: 3 | loss: 0.3858187
	speed: 0.0148s/iter; left time: 593.0349s
	iters: 800, epoch: 3 | loss: 0.5003946
	speed: 0.0146s/iter; left time: 583.6447s
	iters: 900, epoch: 3 | loss: 0.4704625
	speed: 0.0146s/iter; left time: 585.0121s
	iters: 1000, epoch: 3 | loss: 0.3140441
	speed: 0.0146s/iter; left time: 584.2383s
	iters: 1100, epoch: 3 | loss: 0.3063327
	speed: 0.0148s/iter; left time: 587.0137s
	iters: 1200, epoch: 3 | loss: 1.3232952
	speed: 0.0142s/iter; left time: 565.2293s
	iters: 1300, epoch: 3 | loss: 0.4011925
	speed: 0.0148s/iter; left time: 584.3028s
	iters: 1400, epoch: 3 | loss: 0.5031472
	speed: 0.0146s/iter; left time: 576.9233s
	iters: 1500, epoch: 3 | loss: 0.4032121
	speed: 0.0143s/iter; left time: 564.5996s
	iters: 1600, epoch: 3 | loss: 0.5600336
	speed: 0.0148s/iter; left time: 580.5475s
	iters: 1700, epoch: 3 | loss: 1.0453581
	speed: 0.0141s/iter; left time: 553.1568s
	iters: 1800, epoch: 3 | loss: 0.4429675
	speed: 0.0146s/iter; left time: 570.0455s
	iters: 1900, epoch: 3 | loss: 0.7456686
	speed: 0.0145s/iter; left time: 565.9383s
	iters: 2000, epoch: 3 | loss: 0.4041847
	speed: 0.0143s/iter; left time: 554.7724s
	iters: 2100, epoch: 3 | loss: 2.6121528
	speed: 0.0147s/iter; left time: 571.0041s
	iters: 2200, epoch: 3 | loss: 0.3686414
	speed: 0.0142s/iter; left time: 547.6840s
Epoch: 3 cost time: 33.00602579116821
Epoch: 3, Steps: 2272 | Train Loss: 0.8327609 Vali Loss: 0.4849089 Test Loss: 0.2206354
Validation loss decreased (0.627660 --> 0.484909).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.5117114
	speed: 0.0540s/iter; left time: 2079.9872s
	iters: 200, epoch: 4 | loss: 0.4609241
	speed: 0.0147s/iter; left time: 563.5820s
	iters: 300, epoch: 4 | loss: 0.3295946
	speed: 0.0143s/iter; left time: 548.4598s
	iters: 400, epoch: 4 | loss: 0.3306182
	speed: 0.0149s/iter; left time: 571.0165s
	iters: 500, epoch: 4 | loss: 0.3583768
	speed: 0.0150s/iter; left time: 572.3305s
	iters: 600, epoch: 4 | loss: 0.2342536
	speed: 0.0141s/iter; left time: 535.7412s
	iters: 700, epoch: 4 | loss: 0.3224983
	speed: 0.0148s/iter; left time: 560.0157s
	iters: 800, epoch: 4 | loss: 0.2225619
	speed: 0.0145s/iter; left time: 548.0184s
	iters: 900, epoch: 4 | loss: 0.3730583
	speed: 0.0147s/iter; left time: 555.3406s
	iters: 1000, epoch: 4 | loss: 0.4542085
	speed: 0.0147s/iter; left time: 554.1265s
	iters: 1100, epoch: 4 | loss: 0.3274314
	speed: 0.0146s/iter; left time: 549.1167s
	iters: 1200, epoch: 4 | loss: 0.3477876
	speed: 0.0148s/iter; left time: 553.4567s
	iters: 1300, epoch: 4 | loss: 0.5029958
	speed: 0.0146s/iter; left time: 545.2352s
	iters: 1400, epoch: 4 | loss: 0.2550159
	speed: 0.0149s/iter; left time: 553.1635s
	iters: 1500, epoch: 4 | loss: 0.3274110
	speed: 0.0141s/iter; left time: 524.7987s
	iters: 1600, epoch: 4 | loss: 0.3285181
	speed: 0.0145s/iter; left time: 537.8451s
	iters: 1700, epoch: 4 | loss: 1.3108082
	speed: 0.0147s/iter; left time: 544.5395s
	iters: 1800, epoch: 4 | loss: 0.4513558
	speed: 0.0146s/iter; left time: 537.7119s
	iters: 1900, epoch: 4 | loss: 8.3390665
	speed: 0.0145s/iter; left time: 532.0703s
	iters: 2000, epoch: 4 | loss: 0.7274534
	speed: 0.0151s/iter; left time: 551.8278s
	iters: 2100, epoch: 4 | loss: 0.2885814
	speed: 0.0142s/iter; left time: 517.9785s
	iters: 2200, epoch: 4 | loss: 0.4522566
	speed: 0.0146s/iter; left time: 531.4048s
Epoch: 4 cost time: 33.14902424812317
Epoch: 4, Steps: 2272 | Train Loss: 0.6572199 Vali Loss: 0.4634669 Test Loss: 0.2152690
Validation loss decreased (0.484909 --> 0.463467).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.2208146
	speed: 0.0532s/iter; left time: 1927.7716s
	iters: 200, epoch: 5 | loss: 0.8846952
	speed: 0.0150s/iter; left time: 541.3785s
	iters: 300, epoch: 5 | loss: 0.3186397
	speed: 0.0144s/iter; left time: 519.8780s
	iters: 400, epoch: 5 | loss: 0.2663915
	speed: 0.0145s/iter; left time: 520.5274s
	iters: 500, epoch: 5 | loss: 0.3959921
	speed: 0.0147s/iter; left time: 525.7885s
	iters: 600, epoch: 5 | loss: 0.2729244
	speed: 0.0146s/iter; left time: 523.6073s
	iters: 700, epoch: 5 | loss: 1.0080131
	speed: 0.0146s/iter; left time: 519.3441s
	iters: 800, epoch: 5 | loss: 0.2879812
	speed: 0.0145s/iter; left time: 513.9365s
	iters: 900, epoch: 5 | loss: 1.3122935
	speed: 0.0149s/iter; left time: 526.9274s
	iters: 1000, epoch: 5 | loss: 0.4471036
	speed: 0.0147s/iter; left time: 520.6497s
	iters: 1100, epoch: 5 | loss: 0.2809564
	speed: 0.0144s/iter; left time: 507.4917s
	iters: 1200, epoch: 5 | loss: 0.3381518
	speed: 0.0145s/iter; left time: 510.8924s
	iters: 1300, epoch: 5 | loss: 0.4294386
	speed: 0.0142s/iter; left time: 498.4081s
	iters: 1400, epoch: 5 | loss: 1.2545245
	speed: 0.0144s/iter; left time: 502.2930s
	iters: 1500, epoch: 5 | loss: 1.2755734
	speed: 0.0146s/iter; left time: 508.7791s
	iters: 1600, epoch: 5 | loss: 1.5750040
	speed: 0.0146s/iter; left time: 506.6053s
	iters: 1700, epoch: 5 | loss: 0.3775107
	speed: 0.0145s/iter; left time: 503.5610s
	iters: 1800, epoch: 5 | loss: 0.5345533
	speed: 0.0144s/iter; left time: 497.4254s
	iters: 1900, epoch: 5 | loss: 0.3745065
	speed: 0.0144s/iter; left time: 497.5743s
	iters: 2000, epoch: 5 | loss: 0.3656949
	speed: 0.0145s/iter; left time: 499.6355s
	iters: 2100, epoch: 5 | loss: 0.3699654
	speed: 0.0143s/iter; left time: 488.4731s
	iters: 2200, epoch: 5 | loss: 0.4348801
	speed: 0.0146s/iter; left time: 497.0459s
Epoch: 5 cost time: 32.89559507369995
Epoch: 5, Steps: 2272 | Train Loss: 0.5999453 Vali Loss: 0.4381164 Test Loss: 0.1983399
Validation loss decreased (0.463467 --> 0.438116).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.1767775
	speed: 0.0525s/iter; left time: 1784.2989s
	iters: 200, epoch: 6 | loss: 0.3429606
	speed: 0.0142s/iter; left time: 481.0021s
	iters: 300, epoch: 6 | loss: 0.4131453
	speed: 0.0149s/iter; left time: 504.9558s
	iters: 400, epoch: 6 | loss: 0.3068897
	speed: 0.0148s/iter; left time: 499.0918s
	iters: 500, epoch: 6 | loss: 0.8802399
	speed: 0.0145s/iter; left time: 487.6842s
	iters: 600, epoch: 6 | loss: 1.5181643
	speed: 0.0147s/iter; left time: 492.0706s
	iters: 700, epoch: 6 | loss: 1.2128086
	speed: 0.0140s/iter; left time: 466.8559s
	iters: 800, epoch: 6 | loss: 0.4997700
	speed: 0.0147s/iter; left time: 488.9482s
	iters: 900, epoch: 6 | loss: 0.3195979
	speed: 0.0142s/iter; left time: 470.5885s
	iters: 1000, epoch: 6 | loss: 0.2484649
	speed: 0.0147s/iter; left time: 487.8464s
	iters: 1100, epoch: 6 | loss: 0.2882155
	speed: 0.0143s/iter; left time: 471.6647s
	iters: 1200, epoch: 6 | loss: 0.5127594
	speed: 0.0144s/iter; left time: 472.5779s
	iters: 1300, epoch: 6 | loss: 0.3523622
	speed: 0.0142s/iter; left time: 464.3823s
	iters: 1400, epoch: 6 | loss: 0.3950554
	speed: 0.0143s/iter; left time: 468.2716s
	iters: 1500, epoch: 6 | loss: 0.3601229
	speed: 0.0144s/iter; left time: 468.9019s
	iters: 1600, epoch: 6 | loss: 0.3036973
	speed: 0.0146s/iter; left time: 474.1402s
	iters: 1700, epoch: 6 | loss: 0.3629669
	speed: 0.0143s/iter; left time: 463.7489s
	iters: 1800, epoch: 6 | loss: 0.4008994
	speed: 0.0147s/iter; left time: 474.4311s
	iters: 1900, epoch: 6 | loss: 0.4837247
	speed: 0.0149s/iter; left time: 479.2519s
	iters: 2000, epoch: 6 | loss: 5.7781291
	speed: 0.0149s/iter; left time: 478.2349s
	iters: 2100, epoch: 6 | loss: 0.3826915
	speed: 0.0145s/iter; left time: 464.4642s
	iters: 2200, epoch: 6 | loss: 0.4428881
	speed: 0.0146s/iter; left time: 464.8846s
Epoch: 6 cost time: 32.84523320198059
Epoch: 6, Steps: 2272 | Train Loss: 0.5753992 Vali Loss: 0.4264078 Test Loss: 0.1914524
Validation loss decreased (0.438116 --> 0.426408).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.3941480
	speed: 0.0532s/iter; left time: 1688.0136s
	iters: 200, epoch: 7 | loss: 0.2686341
	speed: 0.0150s/iter; left time: 474.0793s
	iters: 300, epoch: 7 | loss: 0.2892247
	speed: 0.0147s/iter; left time: 464.4344s
	iters: 400, epoch: 7 | loss: 0.4375302
	speed: 0.0146s/iter; left time: 459.0861s
	iters: 500, epoch: 7 | loss: 0.3131272
	speed: 0.0142s/iter; left time: 445.8797s
	iters: 600, epoch: 7 | loss: 0.5524940
	speed: 0.0145s/iter; left time: 453.8239s
	iters: 700, epoch: 7 | loss: 0.3887577
	speed: 0.0148s/iter; left time: 459.4423s
	iters: 800, epoch: 7 | loss: 1.3295317
	speed: 0.0145s/iter; left time: 450.3521s
	iters: 900, epoch: 7 | loss: 0.5190054
	speed: 0.0146s/iter; left time: 451.7954s
	iters: 1000, epoch: 7 | loss: 0.4529358
	speed: 0.0147s/iter; left time: 452.8524s
	iters: 1100, epoch: 7 | loss: 0.7040161
	speed: 0.0151s/iter; left time: 463.0329s
	iters: 1200, epoch: 7 | loss: 0.4272339
	speed: 0.0145s/iter; left time: 444.9951s
	iters: 1300, epoch: 7 | loss: 0.2773828
	speed: 0.0146s/iter; left time: 444.4626s
	iters: 1400, epoch: 7 | loss: 0.3310249
	speed: 0.0146s/iter; left time: 442.7209s
	iters: 1500, epoch: 7 | loss: 0.3125913
	speed: 0.0144s/iter; left time: 437.4809s
	iters: 1600, epoch: 7 | loss: 0.3676478
	speed: 0.0141s/iter; left time: 426.5954s
	iters: 1700, epoch: 7 | loss: 0.3926243
	speed: 0.0144s/iter; left time: 432.7064s
	iters: 1800, epoch: 7 | loss: 1.2374142
	speed: 0.0146s/iter; left time: 436.7128s
	iters: 1900, epoch: 7 | loss: 0.5364954
	speed: 0.0145s/iter; left time: 432.8434s
	iters: 2000, epoch: 7 | loss: 0.2939333
	speed: 0.0143s/iter; left time: 427.1086s
	iters: 2100, epoch: 7 | loss: 0.3006102
	speed: 0.0142s/iter; left time: 420.4305s
	iters: 2200, epoch: 7 | loss: 0.2484098
	speed: 0.0146s/iter; left time: 432.0474s
Epoch: 7 cost time: 32.95768356323242
Epoch: 7, Steps: 2272 | Train Loss: 0.5636404 Vali Loss: 0.4269653 Test Loss: 0.1874657
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.3212736
	speed: 0.0527s/iter; left time: 1550.7237s
	iters: 200, epoch: 8 | loss: 5.6850333
	speed: 0.0142s/iter; left time: 415.3959s
	iters: 300, epoch: 8 | loss: 0.4541571
	speed: 0.0141s/iter; left time: 413.0417s
	iters: 400, epoch: 8 | loss: 0.3917448
	speed: 0.0145s/iter; left time: 421.3492s
	iters: 500, epoch: 8 | loss: 0.2818004
	speed: 0.0145s/iter; left time: 421.6690s
	iters: 600, epoch: 8 | loss: 0.6170616
	speed: 0.0148s/iter; left time: 428.4436s
	iters: 700, epoch: 8 | loss: 0.3579473
	speed: 0.0143s/iter; left time: 411.8147s
	iters: 800, epoch: 8 | loss: 0.4303330
	speed: 0.0145s/iter; left time: 416.9223s
	iters: 900, epoch: 8 | loss: 0.3927363
	speed: 0.0146s/iter; left time: 419.0320s
	iters: 1000, epoch: 8 | loss: 0.5870440
	speed: 0.0146s/iter; left time: 416.4745s
	iters: 1100, epoch: 8 | loss: 0.7048576
	speed: 0.0148s/iter; left time: 419.4791s
	iters: 1200, epoch: 8 | loss: 0.2814336
	speed: 0.0144s/iter; left time: 408.0179s
	iters: 1300, epoch: 8 | loss: 0.2967280
	speed: 0.0143s/iter; left time: 402.7014s
	iters: 1400, epoch: 8 | loss: 1.7711898
	speed: 0.0144s/iter; left time: 404.5223s
	iters: 1500, epoch: 8 | loss: 0.6015422
	speed: 0.0145s/iter; left time: 405.4798s
	iters: 1600, epoch: 8 | loss: 0.3569775
	speed: 0.0144s/iter; left time: 403.6790s
	iters: 1700, epoch: 8 | loss: 0.3785900
	speed: 0.0147s/iter; left time: 409.8083s
	iters: 1800, epoch: 8 | loss: 0.4487992
	speed: 0.0143s/iter; left time: 397.8164s
	iters: 1900, epoch: 8 | loss: 0.3760353
	speed: 0.0144s/iter; left time: 398.6352s
	iters: 2000, epoch: 8 | loss: 0.3260911
	speed: 0.0146s/iter; left time: 401.1598s
	iters: 2100, epoch: 8 | loss: 0.5786517
	speed: 0.0141s/iter; left time: 388.2331s
	iters: 2200, epoch: 8 | loss: 0.2621231
	speed: 0.0145s/iter; left time: 396.0346s
Epoch: 8 cost time: 32.77995419502258
Epoch: 8, Steps: 2272 | Train Loss: 0.5578685 Vali Loss: 0.4242208 Test Loss: 0.1888945
Validation loss decreased (0.426408 --> 0.424221).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.3651997
	speed: 0.0524s/iter; left time: 1424.7765s
	iters: 200, epoch: 9 | loss: 0.2525444
	speed: 0.0144s/iter; left time: 390.6450s
	iters: 300, epoch: 9 | loss: 0.2470466
	speed: 0.0149s/iter; left time: 402.8635s
	iters: 400, epoch: 9 | loss: 0.5726845
	speed: 0.0142s/iter; left time: 380.6017s
	iters: 500, epoch: 9 | loss: 0.4765514
	speed: 0.0144s/iter; left time: 385.6686s
	iters: 600, epoch: 9 | loss: 0.2542160
	speed: 0.0149s/iter; left time: 396.7718s
	iters: 700, epoch: 9 | loss: 0.5069724
	speed: 0.0143s/iter; left time: 380.4692s
	iters: 800, epoch: 9 | loss: 0.2918556
	speed: 0.0143s/iter; left time: 377.6991s
	iters: 900, epoch: 9 | loss: 0.2915605
	speed: 0.0149s/iter; left time: 393.4221s
	iters: 1000, epoch: 9 | loss: 0.4663454
	speed: 0.0145s/iter; left time: 381.3505s
	iters: 1100, epoch: 9 | loss: 0.3859847
	speed: 0.0148s/iter; left time: 387.6950s
	iters: 1200, epoch: 9 | loss: 0.3935461
	speed: 0.0140s/iter; left time: 364.4824s
	iters: 1300, epoch: 9 | loss: 0.4000010
	speed: 0.0147s/iter; left time: 381.5094s
	iters: 1400, epoch: 9 | loss: 0.3867798
	speed: 0.0144s/iter; left time: 373.1639s
	iters: 1500, epoch: 9 | loss: 1.2085279
	speed: 0.0145s/iter; left time: 374.1821s
	iters: 1600, epoch: 9 | loss: 0.2809276
	speed: 0.0147s/iter; left time: 376.6268s
	iters: 1700, epoch: 9 | loss: 0.4754151
	speed: 0.0139s/iter; left time: 356.5515s
	iters: 1800, epoch: 9 | loss: 0.3428690
	speed: 0.0153s/iter; left time: 389.3372s
	iters: 1900, epoch: 9 | loss: 0.2789506
	speed: 0.0142s/iter; left time: 360.4717s
	iters: 2000, epoch: 9 | loss: 0.3163994
	speed: 0.0144s/iter; left time: 363.5129s
	iters: 2100, epoch: 9 | loss: 0.7004631
	speed: 0.0146s/iter; left time: 368.3628s
	iters: 2200, epoch: 9 | loss: 0.2744671
	speed: 0.0143s/iter; left time: 357.3714s
Epoch: 9 cost time: 32.80541729927063
Epoch: 9, Steps: 2272 | Train Loss: 0.5550047 Vali Loss: 0.4244967 Test Loss: 0.1883306
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.7320979
	speed: 0.0521s/iter; left time: 1297.4229s
	iters: 200, epoch: 10 | loss: 1.3188206
	speed: 0.0144s/iter; left time: 356.7838s
	iters: 300, epoch: 10 | loss: 0.6541369
	speed: 0.0146s/iter; left time: 361.1772s
	iters: 400, epoch: 10 | loss: 0.2903777
	speed: 0.0149s/iter; left time: 365.6621s
	iters: 500, epoch: 10 | loss: 1.0427912
	speed: 0.0147s/iter; left time: 360.4378s
	iters: 600, epoch: 10 | loss: 0.4174280
	speed: 0.0146s/iter; left time: 356.7095s
	iters: 700, epoch: 10 | loss: 0.5238450
	speed: 0.0145s/iter; left time: 352.0424s
	iters: 800, epoch: 10 | loss: 0.2953057
	speed: 0.0150s/iter; left time: 362.2976s
	iters: 900, epoch: 10 | loss: 0.3124748
	speed: 0.0148s/iter; left time: 356.7600s
	iters: 1000, epoch: 10 | loss: 0.4293099
	speed: 0.0145s/iter; left time: 347.5789s
	iters: 1100, epoch: 10 | loss: 0.3401583
	speed: 0.0146s/iter; left time: 348.8952s
	iters: 1200, epoch: 10 | loss: 0.3161862
	speed: 0.0143s/iter; left time: 341.2577s
	iters: 1300, epoch: 10 | loss: 0.4675636
	speed: 0.0146s/iter; left time: 345.6097s
	iters: 1400, epoch: 10 | loss: 0.3975623
	speed: 0.0146s/iter; left time: 345.5675s
	iters: 1500, epoch: 10 | loss: 1.4686620
	speed: 0.0144s/iter; left time: 337.1645s
	iters: 1600, epoch: 10 | loss: 0.4498518
	speed: 0.0144s/iter; left time: 336.5704s
	iters: 1700, epoch: 10 | loss: 0.3731695
	speed: 0.0149s/iter; left time: 346.5787s
	iters: 1800, epoch: 10 | loss: 0.3692847
	speed: 0.0141s/iter; left time: 326.8477s
	iters: 1900, epoch: 10 | loss: 0.2676806
	speed: 0.0142s/iter; left time: 327.5960s
	iters: 2000, epoch: 10 | loss: 0.2626094
	speed: 0.0143s/iter; left time: 328.6162s
	iters: 2100, epoch: 10 | loss: 0.3421901
	speed: 0.0145s/iter; left time: 331.8898s
	iters: 2200, epoch: 10 | loss: 0.3148869
	speed: 0.0141s/iter; left time: 322.3373s
Epoch: 10 cost time: 32.86480379104614
Epoch: 10, Steps: 2272 | Train Loss: 0.5535329 Vali Loss: 0.4231952 Test Loss: 0.1882532
Validation loss decreased (0.424221 --> 0.423195).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.3396570
	speed: 0.0529s/iter; left time: 1195.9446s
	iters: 200, epoch: 11 | loss: 0.3170674
	speed: 0.0145s/iter; left time: 327.1609s
	iters: 300, epoch: 11 | loss: 0.2651276
	speed: 0.0144s/iter; left time: 323.3547s
	iters: 400, epoch: 11 | loss: 0.2626719
	speed: 0.0144s/iter; left time: 321.5822s
	iters: 500, epoch: 11 | loss: 0.4004678
	speed: 0.0141s/iter; left time: 312.3627s
	iters: 600, epoch: 11 | loss: 0.2577409
	speed: 0.0143s/iter; left time: 316.1891s
	iters: 700, epoch: 11 | loss: 0.3043306
	speed: 0.0146s/iter; left time: 321.7611s
	iters: 800, epoch: 11 | loss: 0.3118968
	speed: 0.0146s/iter; left time: 319.6321s
	iters: 900, epoch: 11 | loss: 0.4626060
	speed: 0.0146s/iter; left time: 318.7526s
	iters: 1000, epoch: 11 | loss: 0.3478357
	speed: 0.0141s/iter; left time: 306.9584s
	iters: 1100, epoch: 11 | loss: 0.2940721
	speed: 0.0146s/iter; left time: 315.3978s
	iters: 1200, epoch: 11 | loss: 0.3370330
	speed: 0.0144s/iter; left time: 310.0343s
	iters: 1300, epoch: 11 | loss: 0.3080218
	speed: 0.0149s/iter; left time: 319.1754s
	iters: 1400, epoch: 11 | loss: 0.3013799
	speed: 0.0145s/iter; left time: 309.3439s
	iters: 1500, epoch: 11 | loss: 0.3567837
	speed: 0.0145s/iter; left time: 308.2676s
	iters: 1600, epoch: 11 | loss: 0.4028551
	speed: 0.0143s/iter; left time: 302.7582s
	iters: 1700, epoch: 11 | loss: 0.2516407
	speed: 0.0146s/iter; left time: 306.4365s
	iters: 1800, epoch: 11 | loss: 0.4095513
	speed: 0.0147s/iter; left time: 308.4271s
	iters: 1900, epoch: 11 | loss: 1.2782362
	speed: 0.0146s/iter; left time: 304.2299s
	iters: 2000, epoch: 11 | loss: 0.3100751
	speed: 0.0147s/iter; left time: 303.8682s
	iters: 2100, epoch: 11 | loss: 0.3532708
	speed: 0.0144s/iter; left time: 297.7315s
	iters: 2200, epoch: 11 | loss: 0.3092228
	speed: 0.0141s/iter; left time: 289.6527s
Epoch: 11 cost time: 32.74562048912048
Epoch: 11, Steps: 2272 | Train Loss: 0.5527935 Vali Loss: 0.4246765 Test Loss: 0.1881853
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.4364896
	speed: 0.0518s/iter; left time: 1053.9648s
	iters: 200, epoch: 12 | loss: 0.2918135
	speed: 0.0142s/iter; left time: 286.7294s
	iters: 300, epoch: 12 | loss: 1.3553712
	speed: 0.0140s/iter; left time: 283.0899s
	iters: 400, epoch: 12 | loss: 0.2957354
	speed: 0.0146s/iter; left time: 292.4494s
	iters: 500, epoch: 12 | loss: 0.2531783
	speed: 0.0149s/iter; left time: 297.7635s
	iters: 600, epoch: 12 | loss: 3.3704095
	speed: 0.0147s/iter; left time: 291.2317s
	iters: 700, epoch: 12 | loss: 0.3554271
	speed: 0.0147s/iter; left time: 291.1778s
	iters: 800, epoch: 12 | loss: 0.2551124
	speed: 0.0143s/iter; left time: 281.8987s
	iters: 900, epoch: 12 | loss: 1.2471646
	speed: 0.0142s/iter; left time: 278.2206s
	iters: 1000, epoch: 12 | loss: 0.4590916
	speed: 0.0145s/iter; left time: 281.6914s
	iters: 1100, epoch: 12 | loss: 0.3428176
	speed: 0.0144s/iter; left time: 278.7879s
	iters: 1200, epoch: 12 | loss: 0.4651209
	speed: 0.0143s/iter; left time: 274.7557s
	iters: 1300, epoch: 12 | loss: 0.2232595
	speed: 0.0144s/iter; left time: 276.5660s
	iters: 1400, epoch: 12 | loss: 0.3534693
	speed: 0.0146s/iter; left time: 279.0196s
	iters: 1500, epoch: 12 | loss: 0.4652244
	speed: 0.0145s/iter; left time: 274.1313s
	iters: 1600, epoch: 12 | loss: 0.4017981
	speed: 0.0144s/iter; left time: 270.5261s
	iters: 1700, epoch: 12 | loss: 0.3384151
	speed: 0.0145s/iter; left time: 272.5738s
	iters: 1800, epoch: 12 | loss: 0.3279486
	speed: 0.0143s/iter; left time: 266.4671s
	iters: 1900, epoch: 12 | loss: 0.3207881
	speed: 0.0143s/iter; left time: 265.0628s
	iters: 2000, epoch: 12 | loss: 0.3423705
	speed: 0.0145s/iter; left time: 267.4572s
	iters: 2100, epoch: 12 | loss: 0.4811133
	speed: 0.0145s/iter; left time: 266.1828s
	iters: 2200, epoch: 12 | loss: 1.2485474
	speed: 0.0140s/iter; left time: 254.7914s
Epoch: 12 cost time: 32.61937856674194
Epoch: 12, Steps: 2272 | Train Loss: 0.5524356 Vali Loss: 0.4242756 Test Loss: 0.1890141
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.2654230
	speed: 0.0525s/iter; left time: 949.7946s
	iters: 200, epoch: 13 | loss: 0.3921293
	speed: 0.0140s/iter; left time: 251.1690s
	iters: 300, epoch: 13 | loss: 0.3269440
	speed: 0.0141s/iter; left time: 252.0070s
	iters: 400, epoch: 13 | loss: 0.2992471
	speed: 0.0144s/iter; left time: 255.3087s
	iters: 500, epoch: 13 | loss: 0.3383451
	speed: 0.0146s/iter; left time: 257.9382s
	iters: 600, epoch: 13 | loss: 0.3378010
	speed: 0.0148s/iter; left time: 259.4247s
	iters: 700, epoch: 13 | loss: 0.3884050
	speed: 0.0145s/iter; left time: 253.3289s
	iters: 800, epoch: 13 | loss: 0.2217678
	speed: 0.0149s/iter; left time: 259.2545s
	iters: 900, epoch: 13 | loss: 3.1367939
	speed: 0.0147s/iter; left time: 253.7817s
	iters: 1000, epoch: 13 | loss: 0.2869475
	speed: 0.0148s/iter; left time: 254.3471s
	iters: 1100, epoch: 13 | loss: 0.4342991
	speed: 0.0146s/iter; left time: 248.5453s
	iters: 1200, epoch: 13 | loss: 0.4301141
	speed: 0.0142s/iter; left time: 241.1648s
	iters: 1300, epoch: 13 | loss: 0.2586265
	speed: 0.0147s/iter; left time: 247.9496s
	iters: 1400, epoch: 13 | loss: 0.6938938
	speed: 0.0147s/iter; left time: 245.8037s
	iters: 1500, epoch: 13 | loss: 0.3303528
	speed: 0.0145s/iter; left time: 241.5831s
	iters: 1600, epoch: 13 | loss: 0.3891214
	speed: 0.0144s/iter; left time: 238.7489s
	iters: 1700, epoch: 13 | loss: 13.2285051
	speed: 0.0140s/iter; left time: 230.9934s
	iters: 1800, epoch: 13 | loss: 0.6358848
	speed: 0.0146s/iter; left time: 238.5662s
	iters: 1900, epoch: 13 | loss: 0.4683949
	speed: 0.0142s/iter; left time: 231.8259s
	iters: 2000, epoch: 13 | loss: 0.5498402
	speed: 0.0145s/iter; left time: 234.9133s
	iters: 2100, epoch: 13 | loss: 0.4137738
	speed: 0.0148s/iter; left time: 237.6198s
	iters: 2200, epoch: 13 | loss: 0.2394134
	speed: 0.0142s/iter; left time: 227.2939s
Epoch: 13 cost time: 32.71799373626709
Epoch: 13, Steps: 2272 | Train Loss: 0.5522471 Vali Loss: 0.4240855 Test Loss: 0.1888510
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.3352874
	speed: 0.0511s/iter; left time: 808.0199s
	iters: 200, epoch: 14 | loss: 0.3623141
	speed: 0.0129s/iter; left time: 203.1944s
	iters: 300, epoch: 14 | loss: 0.6633915
	speed: 0.0131s/iter; left time: 203.6999s
	iters: 400, epoch: 14 | loss: 0.6135380
	speed: 0.0130s/iter; left time: 202.2640s
	iters: 500, epoch: 14 | loss: 0.4040202
	speed: 0.0145s/iter; left time: 223.5800s
	iters: 600, epoch: 14 | loss: 0.4580205
	speed: 0.0143s/iter; left time: 218.4795s
	iters: 700, epoch: 14 | loss: 0.4980923
	speed: 0.0131s/iter; left time: 199.5803s
	iters: 800, epoch: 14 | loss: 0.3281093
	speed: 0.0131s/iter; left time: 198.2182s
	iters: 900, epoch: 14 | loss: 0.3045031
	speed: 0.0120s/iter; left time: 180.0623s
	iters: 1000, epoch: 14 | loss: 0.2373433
	speed: 0.0115s/iter; left time: 171.1880s
	iters: 1100, epoch: 14 | loss: 0.4324818
	speed: 0.0123s/iter; left time: 181.6976s
	iters: 1200, epoch: 14 | loss: 0.4943675
	speed: 0.0131s/iter; left time: 192.5695s
	iters: 1300, epoch: 14 | loss: 0.3166327
	speed: 0.0131s/iter; left time: 191.6542s
	iters: 1400, epoch: 14 | loss: 0.2222548
	speed: 0.0129s/iter; left time: 186.7184s
	iters: 1500, epoch: 14 | loss: 0.3819955
	speed: 0.0121s/iter; left time: 174.9572s
	iters: 1600, epoch: 14 | loss: 1.3816890
	speed: 0.0118s/iter; left time: 168.9030s
	iters: 1700, epoch: 14 | loss: 0.5365515
	speed: 0.0110s/iter; left time: 155.5564s
	iters: 1800, epoch: 14 | loss: 0.3022764
	speed: 0.0121s/iter; left time: 170.8191s
	iters: 1900, epoch: 14 | loss: 1.0650386
	speed: 0.0132s/iter; left time: 185.4334s
	iters: 2000, epoch: 14 | loss: 0.3737345
	speed: 0.0106s/iter; left time: 148.0542s
	iters: 2100, epoch: 14 | loss: 0.2116562
	speed: 0.0128s/iter; left time: 177.3294s
	iters: 2200, epoch: 14 | loss: 0.3287670
	speed: 0.0135s/iter; left time: 184.4233s
Epoch: 14 cost time: 28.81311535835266
Epoch: 14, Steps: 2272 | Train Loss: 0.5521130 Vali Loss: 0.4240678 Test Loss: 0.1887047
EarlyStopping counter: 4 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.2684207
	speed: 0.0477s/iter; left time: 645.9902s
	iters: 200, epoch: 15 | loss: 0.3433412
	speed: 0.0117s/iter; left time: 156.9338s
	iters: 300, epoch: 15 | loss: 0.4297205
	speed: 0.0117s/iter; left time: 155.7334s
	iters: 400, epoch: 15 | loss: 0.4025003
	speed: 0.0121s/iter; left time: 160.7250s
	iters: 500, epoch: 15 | loss: 0.4059201
	speed: 0.0128s/iter; left time: 168.0711s
	iters: 600, epoch: 15 | loss: 0.2771828
	speed: 0.0132s/iter; left time: 171.8500s
	iters: 700, epoch: 15 | loss: 0.3851473
	speed: 0.0127s/iter; left time: 164.4738s
	iters: 800, epoch: 15 | loss: 0.4192074
	speed: 0.0127s/iter; left time: 163.3981s
	iters: 900, epoch: 15 | loss: 0.3065935
	speed: 0.0128s/iter; left time: 162.4623s
	iters: 1000, epoch: 15 | loss: 0.3985124
	speed: 0.0128s/iter; left time: 162.1770s
	iters: 1100, epoch: 15 | loss: 0.2373772
	speed: 0.0119s/iter; left time: 148.6688s
	iters: 1200, epoch: 15 | loss: 1.3401910
	speed: 0.0129s/iter; left time: 160.0816s
	iters: 1300, epoch: 15 | loss: 0.6369880
	speed: 0.0110s/iter; left time: 135.9978s
	iters: 1400, epoch: 15 | loss: 0.4216750
	speed: 0.0112s/iter; left time: 136.7067s
	iters: 1500, epoch: 15 | loss: 0.2822223
	speed: 0.0124s/iter; left time: 150.9349s
	iters: 1600, epoch: 15 | loss: 0.3864733
	speed: 0.0130s/iter; left time: 156.4551s
	iters: 1700, epoch: 15 | loss: 0.2679721
	speed: 0.0121s/iter; left time: 144.6445s
	iters: 1800, epoch: 15 | loss: 0.4170456
	speed: 0.0133s/iter; left time: 156.9470s
	iters: 1900, epoch: 15 | loss: 0.4370162
	speed: 0.0109s/iter; left time: 128.3264s
	iters: 2000, epoch: 15 | loss: 1.3323382
	speed: 0.0130s/iter; left time: 151.4384s
	iters: 2100, epoch: 15 | loss: 0.3436293
	speed: 0.0114s/iter; left time: 131.3272s
	iters: 2200, epoch: 15 | loss: 0.5161417
	speed: 0.0110s/iter; left time: 125.5020s
Epoch: 15 cost time: 27.719958305358887
Epoch: 15, Steps: 2272 | Train Loss: 0.5520658 Vali Loss: 0.4238157 Test Loss: 0.1886570
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : weather_336_192_Linear_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed25565<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10348
mse:0.18830054998397827, mae:0.25750142335891724
