Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='Linear', model_id='weather_336_720', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=720, root_path='./dataset/', save_pred_values=False, seed=25565, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : weather_336_720_Linear_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed25565>>>>>>>>>>>>>>>>>>>>>>>>>>
train 35832
val 4551
test 9820
	iters: 100, epoch: 1 | loss: 0.4620295
	speed: 0.0463s/iter; left time: 2066.8989s
	iters: 200, epoch: 1 | loss: 0.6320539
	speed: 0.0546s/iter; left time: 2433.8229s
	iters: 300, epoch: 1 | loss: 0.6596804
	speed: 0.0507s/iter; left time: 2257.3424s
	iters: 400, epoch: 1 | loss: 2.1204708
	speed: 0.0533s/iter; left time: 2364.3221s
	iters: 500, epoch: 1 | loss: 0.5785738
	speed: 0.0534s/iter; left time: 2363.5911s
	iters: 600, epoch: 1 | loss: 0.5603260
	speed: 0.0530s/iter; left time: 2339.8064s
	iters: 700, epoch: 1 | loss: 0.5774651
	speed: 0.0548s/iter; left time: 2416.2250s
	iters: 800, epoch: 1 | loss: 0.6517074
	speed: 0.0484s/iter; left time: 2130.6454s
	iters: 900, epoch: 1 | loss: 0.5861316
	speed: 0.0455s/iter; left time: 1997.1413s
	iters: 1000, epoch: 1 | loss: 0.6333389
	speed: 0.0512s/iter; left time: 2242.8787s
	iters: 1100, epoch: 1 | loss: 0.5642322
	speed: 0.0491s/iter; left time: 2145.0431s
	iters: 1200, epoch: 1 | loss: 0.5587584
	speed: 0.0470s/iter; left time: 2049.9025s
	iters: 1300, epoch: 1 | loss: 8.1607685
	speed: 0.0478s/iter; left time: 2080.2170s
	iters: 1400, epoch: 1 | loss: 1.2151649
	speed: 0.0518s/iter; left time: 2245.2983s
	iters: 1500, epoch: 1 | loss: 0.5956879
	speed: 0.0487s/iter; left time: 2109.7553s
	iters: 1600, epoch: 1 | loss: 0.9630017
	speed: 0.0467s/iter; left time: 2015.7625s
	iters: 1700, epoch: 1 | loss: 0.8448973
	speed: 0.0488s/iter; left time: 2100.3185s
	iters: 1800, epoch: 1 | loss: 4.8018212
	speed: 0.0472s/iter; left time: 2028.9050s
	iters: 1900, epoch: 1 | loss: 0.5663061
	speed: 0.0492s/iter; left time: 2108.6523s
	iters: 2000, epoch: 1 | loss: 0.8492039
	speed: 0.0520s/iter; left time: 2224.7130s
	iters: 2100, epoch: 1 | loss: 8.7075624
	speed: 0.0459s/iter; left time: 1961.0061s
	iters: 2200, epoch: 1 | loss: 0.5971392
	speed: 0.0517s/iter; left time: 2200.4583s
Epoch: 1 cost time: 111.49406957626343
Epoch: 1, Steps: 2239 | Train Loss: 1.3600485 Vali Loss: 0.7282846 Test Loss: 0.4105245
Validation loss decreased (inf --> 0.728285).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 1.6687474
	speed: 0.1474s/iter; left time: 6254.3461s
	iters: 200, epoch: 2 | loss: 1.9553651
	speed: 0.0508s/iter; left time: 2150.5028s
	iters: 300, epoch: 2 | loss: 0.6076253
	speed: 0.0520s/iter; left time: 2197.2228s
	iters: 400, epoch: 2 | loss: 0.6039177
	speed: 0.0475s/iter; left time: 2000.0087s
	iters: 500, epoch: 2 | loss: 13.3843307
	speed: 0.0488s/iter; left time: 2050.0828s
	iters: 600, epoch: 2 | loss: 0.5452405
	speed: 0.0497s/iter; left time: 2084.9415s
	iters: 700, epoch: 2 | loss: 0.6919193
	speed: 0.0527s/iter; left time: 2207.0566s
	iters: 800, epoch: 2 | loss: 0.6247169
	speed: 0.0565s/iter; left time: 2358.7729s
	iters: 900, epoch: 2 | loss: 1.7768627
	speed: 0.0513s/iter; left time: 2134.4266s
	iters: 1000, epoch: 2 | loss: 0.7893552
	speed: 0.0485s/iter; left time: 2013.5164s
	iters: 1100, epoch: 2 | loss: 1.2615293
	speed: 0.0501s/iter; left time: 2077.8470s
	iters: 1200, epoch: 2 | loss: 0.5581675
	speed: 0.0540s/iter; left time: 2230.5793s
	iters: 1300, epoch: 2 | loss: 2.0821900
	speed: 0.0567s/iter; left time: 2339.7852s
	iters: 1400, epoch: 2 | loss: 1.0928311
	speed: 0.0473s/iter; left time: 1947.9321s
	iters: 1500, epoch: 2 | loss: 1.2104353
	speed: 0.0487s/iter; left time: 1998.5856s
	iters: 1600, epoch: 2 | loss: 0.5566397
	speed: 0.0454s/iter; left time: 1859.7179s
	iters: 1700, epoch: 2 | loss: 0.6264825
	speed: 0.0490s/iter; left time: 2002.9504s
	iters: 1800, epoch: 2 | loss: 1.9961668
	speed: 0.0465s/iter; left time: 1895.1038s
	iters: 1900, epoch: 2 | loss: 2.4916229
	speed: 0.0479s/iter; left time: 1947.6188s
	iters: 2000, epoch: 2 | loss: 2.5880024
	speed: 0.0499s/iter; left time: 2021.2465s
	iters: 2100, epoch: 2 | loss: 0.8113244
	speed: 0.0477s/iter; left time: 1930.5507s
	iters: 2200, epoch: 2 | loss: 0.7684833
	speed: 0.0493s/iter; left time: 1990.6351s
Epoch: 2 cost time: 111.61968922615051
Epoch: 2, Steps: 2239 | Train Loss: 1.0893863 Vali Loss: 0.7412930 Test Loss: 0.3861245
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.5369167
	speed: 0.1477s/iter; left time: 5938.7405s
	iters: 200, epoch: 3 | loss: 0.5986316
	speed: 0.0539s/iter; left time: 2161.0576s
	iters: 300, epoch: 3 | loss: 0.4747793
	speed: 0.0470s/iter; left time: 1879.8853s
	iters: 400, epoch: 3 | loss: 1.1734726
	speed: 0.0493s/iter; left time: 1968.5071s
	iters: 500, epoch: 3 | loss: 0.6311806
	speed: 0.0485s/iter; left time: 1929.2925s
	iters: 600, epoch: 3 | loss: 0.7057878
	speed: 0.0458s/iter; left time: 1818.7309s
	iters: 700, epoch: 3 | loss: 0.6378648
	speed: 0.0568s/iter; left time: 2251.0426s
	iters: 800, epoch: 3 | loss: 0.4961990
	speed: 0.0471s/iter; left time: 1861.9073s
	iters: 900, epoch: 3 | loss: 1.2628940
	speed: 0.0463s/iter; left time: 1823.0997s
	iters: 1000, epoch: 3 | loss: 0.7047065
	speed: 0.0483s/iter; left time: 1896.4156s
	iters: 1100, epoch: 3 | loss: 0.4715138
	speed: 0.0473s/iter; left time: 1854.1896s
	iters: 1200, epoch: 3 | loss: 0.5160792
	speed: 0.0497s/iter; left time: 1944.6578s
	iters: 1300, epoch: 3 | loss: 1.2165890
	speed: 0.0440s/iter; left time: 1715.5266s
	iters: 1400, epoch: 3 | loss: 0.9360257
	speed: 0.0484s/iter; left time: 1881.7829s
	iters: 1500, epoch: 3 | loss: 3.0883327
	speed: 0.0504s/iter; left time: 1955.4503s
	iters: 1600, epoch: 3 | loss: 0.4905117
	speed: 0.0543s/iter; left time: 2103.3751s
	iters: 1700, epoch: 3 | loss: 1.3936893
	speed: 0.0441s/iter; left time: 1702.7176s
	iters: 1800, epoch: 3 | loss: 0.5269285
	speed: 0.0510s/iter; left time: 1965.3325s
	iters: 1900, epoch: 3 | loss: 0.6382426
	speed: 0.0506s/iter; left time: 1944.4526s
	iters: 2000, epoch: 3 | loss: 0.6507949
	speed: 0.0510s/iter; left time: 1955.3440s
	iters: 2100, epoch: 3 | loss: 0.7593436
	speed: 0.0537s/iter; left time: 2051.1870s
	iters: 2200, epoch: 3 | loss: 0.5267483
	speed: 0.0496s/iter; left time: 1890.7380s
Epoch: 3 cost time: 110.34111833572388
Epoch: 3, Steps: 2239 | Train Loss: 0.7880911 Vali Loss: 0.6680093 Test Loss: 0.3568928
Validation loss decreased (0.728285 --> 0.668009).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.8036822
	speed: 0.1408s/iter; left time: 5347.0123s
	iters: 200, epoch: 4 | loss: 0.5175409
	speed: 0.0482s/iter; left time: 1824.5204s
	iters: 300, epoch: 4 | loss: 0.4990848
	speed: 0.0500s/iter; left time: 1888.9493s
	iters: 400, epoch: 4 | loss: 0.6034276
	speed: 0.0501s/iter; left time: 1885.2868s
	iters: 500, epoch: 4 | loss: 0.4199319
	speed: 0.0518s/iter; left time: 1945.8476s
	iters: 600, epoch: 4 | loss: 0.7971815
	speed: 0.0532s/iter; left time: 1994.5814s
	iters: 700, epoch: 4 | loss: 0.7957661
	speed: 0.0523s/iter; left time: 1954.5386s
	iters: 800, epoch: 4 | loss: 0.6767372
	speed: 0.0489s/iter; left time: 1821.2427s
	iters: 900, epoch: 4 | loss: 1.1530098
	speed: 0.0493s/iter; left time: 1833.1547s
	iters: 1000, epoch: 4 | loss: 0.4985723
	speed: 0.0486s/iter; left time: 1800.4040s
	iters: 1100, epoch: 4 | loss: 0.4085351
	speed: 0.0483s/iter; left time: 1784.5810s
	iters: 1200, epoch: 4 | loss: 0.4144250
	speed: 0.0501s/iter; left time: 1848.6410s
	iters: 1300, epoch: 4 | loss: 0.8368047
	speed: 0.0497s/iter; left time: 1828.4622s
	iters: 1400, epoch: 4 | loss: 0.7667304
	speed: 0.0514s/iter; left time: 1885.5059s
	iters: 1500, epoch: 4 | loss: 0.4283417
	speed: 0.0487s/iter; left time: 1779.3691s
	iters: 1600, epoch: 4 | loss: 0.5839475
	speed: 0.0470s/iter; left time: 1712.8425s
	iters: 1700, epoch: 4 | loss: 1.1209522
	speed: 0.0479s/iter; left time: 1742.0724s
	iters: 1800, epoch: 4 | loss: 0.5093142
	speed: 0.0531s/iter; left time: 1926.9919s
	iters: 1900, epoch: 4 | loss: 0.5627783
	speed: 0.0507s/iter; left time: 1834.2946s
	iters: 2000, epoch: 4 | loss: 0.5787414
	speed: 0.0485s/iter; left time: 1748.4042s
	iters: 2100, epoch: 4 | loss: 0.5117327
	speed: 0.0447s/iter; left time: 1608.5297s
	iters: 2200, epoch: 4 | loss: 0.5082740
	speed: 0.0457s/iter; left time: 1640.4720s
Epoch: 4 cost time: 110.35130643844604
Epoch: 4, Steps: 2239 | Train Loss: 0.6491909 Vali Loss: 0.6227978 Test Loss: 0.3450827
Validation loss decreased (0.668009 --> 0.622798).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.6044918
	speed: 0.1469s/iter; left time: 5249.4111s
	iters: 200, epoch: 5 | loss: 1.0000345
	speed: 0.0439s/iter; left time: 1562.5239s
	iters: 300, epoch: 5 | loss: 0.4917548
	speed: 0.0476s/iter; left time: 1690.5535s
	iters: 400, epoch: 5 | loss: 0.4231514
	speed: 0.0495s/iter; left time: 1755.0117s
	iters: 500, epoch: 5 | loss: 0.4779147
	speed: 0.0514s/iter; left time: 1815.8345s
	iters: 600, epoch: 5 | loss: 0.5274529
	speed: 0.0484s/iter; left time: 1704.5210s
	iters: 700, epoch: 5 | loss: 0.7496679
	speed: 0.0456s/iter; left time: 1600.0323s
	iters: 800, epoch: 5 | loss: 0.7288775
	speed: 0.0410s/iter; left time: 1436.0590s
	iters: 900, epoch: 5 | loss: 0.4976955
	speed: 0.0514s/iter; left time: 1794.9817s
	iters: 1000, epoch: 5 | loss: 0.4969046
	speed: 0.0496s/iter; left time: 1726.6598s
	iters: 1100, epoch: 5 | loss: 0.4936447
	speed: 0.0497s/iter; left time: 1724.2916s
	iters: 1200, epoch: 5 | loss: 0.6140454
	speed: 0.0503s/iter; left time: 1743.0268s
	iters: 1300, epoch: 5 | loss: 0.5163965
	speed: 0.0523s/iter; left time: 1807.2967s
	iters: 1400, epoch: 5 | loss: 0.6695322
	speed: 0.0523s/iter; left time: 1801.6513s
	iters: 1500, epoch: 5 | loss: 0.6638905
	speed: 0.0517s/iter; left time: 1772.9560s
	iters: 1600, epoch: 5 | loss: 0.7693301
	speed: 0.0530s/iter; left time: 1814.1747s
	iters: 1700, epoch: 5 | loss: 0.4517013
	speed: 0.0541s/iter; left time: 1845.2955s
	iters: 1800, epoch: 5 | loss: 0.7767816
	speed: 0.0510s/iter; left time: 1735.1350s
	iters: 1900, epoch: 5 | loss: 0.3639140
	speed: 0.0502s/iter; left time: 1702.1425s
	iters: 2000, epoch: 5 | loss: 0.9192189
	speed: 0.0480s/iter; left time: 1623.8080s
	iters: 2100, epoch: 5 | loss: 0.4787291
	speed: 0.0504s/iter; left time: 1699.6341s
	iters: 2200, epoch: 5 | loss: 0.5387905
	speed: 0.0508s/iter; left time: 1708.9311s
Epoch: 5 cost time: 110.41502809524536
Epoch: 5, Steps: 2239 | Train Loss: 0.6104834 Vali Loss: 0.6090701 Test Loss: 0.3290245
Validation loss decreased (0.622798 --> 0.609070).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.5477393
	speed: 0.1472s/iter; left time: 4930.0995s
	iters: 200, epoch: 6 | loss: 0.5005617
	speed: 0.0461s/iter; left time: 1539.3217s
	iters: 300, epoch: 6 | loss: 0.4483986
	speed: 0.0518s/iter; left time: 1722.6498s
	iters: 400, epoch: 6 | loss: 0.4789431
	speed: 0.0535s/iter; left time: 1774.0451s
	iters: 500, epoch: 6 | loss: 0.4516581
	speed: 0.0501s/iter; left time: 1658.5766s
	iters: 600, epoch: 6 | loss: 0.5966433
	speed: 0.0523s/iter; left time: 1724.7713s
	iters: 700, epoch: 6 | loss: 0.4611648
	speed: 0.0514s/iter; left time: 1689.3027s
	iters: 800, epoch: 6 | loss: 0.4557280
	speed: 0.0524s/iter; left time: 1717.4117s
	iters: 900, epoch: 6 | loss: 0.5696086
	speed: 0.0499s/iter; left time: 1632.0545s
	iters: 1000, epoch: 6 | loss: 0.7592317
	speed: 0.0501s/iter; left time: 1633.4339s
	iters: 1100, epoch: 6 | loss: 0.5185944
	speed: 0.0533s/iter; left time: 1731.4296s
	iters: 1200, epoch: 6 | loss: 0.4594114
	speed: 0.0488s/iter; left time: 1579.7265s
	iters: 1300, epoch: 6 | loss: 0.6127056
	speed: 0.0503s/iter; left time: 1623.0495s
	iters: 1400, epoch: 6 | loss: 0.5891519
	speed: 0.0509s/iter; left time: 1637.1603s
	iters: 1500, epoch: 6 | loss: 0.6693600
	speed: 0.0493s/iter; left time: 1583.1268s
	iters: 1600, epoch: 6 | loss: 0.7520700
	speed: 0.0527s/iter; left time: 1685.4275s
	iters: 1700, epoch: 6 | loss: 0.4830947
	speed: 0.0514s/iter; left time: 1637.4062s
	iters: 1800, epoch: 6 | loss: 0.4389202
	speed: 0.0516s/iter; left time: 1641.2319s
	iters: 1900, epoch: 6 | loss: 0.5521256
	speed: 0.0506s/iter; left time: 1602.6254s
	iters: 2000, epoch: 6 | loss: 0.5433787
	speed: 0.0507s/iter; left time: 1601.5020s
	iters: 2100, epoch: 6 | loss: 0.5273034
	speed: 0.0469s/iter; left time: 1477.7102s
	iters: 2200, epoch: 6 | loss: 0.4686839
	speed: 0.0488s/iter; left time: 1533.1649s
Epoch: 6 cost time: 112.11499333381653
Epoch: 6, Steps: 2239 | Train Loss: 0.5945042 Vali Loss: 0.5970845 Test Loss: 0.3220728
Validation loss decreased (0.609070 --> 0.597084).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.4237975
	speed: 0.1474s/iter; left time: 4606.3633s
	iters: 200, epoch: 7 | loss: 0.4848875
	speed: 0.0476s/iter; left time: 1484.0467s
	iters: 300, epoch: 7 | loss: 0.8283674
	speed: 0.0492s/iter; left time: 1526.7615s
	iters: 400, epoch: 7 | loss: 0.4206462
	speed: 0.0481s/iter; left time: 1488.9923s
	iters: 500, epoch: 7 | loss: 0.4604072
	speed: 0.0506s/iter; left time: 1561.1247s
	iters: 600, epoch: 7 | loss: 0.4930589
	speed: 0.0498s/iter; left time: 1531.8501s
	iters: 700, epoch: 7 | loss: 0.7475256
	speed: 0.0484s/iter; left time: 1483.8686s
	iters: 800, epoch: 7 | loss: 0.6303237
	speed: 0.0478s/iter; left time: 1459.6514s
	iters: 900, epoch: 7 | loss: 0.4976287
	speed: 0.0496s/iter; left time: 1511.6189s
	iters: 1000, epoch: 7 | loss: 0.5554223
	speed: 0.0532s/iter; left time: 1615.6099s
	iters: 1100, epoch: 7 | loss: 0.4712420
	speed: 0.0503s/iter; left time: 1521.1667s
	iters: 1200, epoch: 7 | loss: 0.4229508
	speed: 0.0512s/iter; left time: 1542.3577s
	iters: 1300, epoch: 7 | loss: 1.1089522
	speed: 0.0556s/iter; left time: 1670.4789s
	iters: 1400, epoch: 7 | loss: 0.5580621
	speed: 0.0544s/iter; left time: 1628.0240s
	iters: 1500, epoch: 7 | loss: 1.4132290
	speed: 0.0500s/iter; left time: 1492.6844s
	iters: 1600, epoch: 7 | loss: 0.4656248
	speed: 0.0486s/iter; left time: 1446.5479s
	iters: 1700, epoch: 7 | loss: 0.5068728
	speed: 0.0509s/iter; left time: 1509.9044s
	iters: 1800, epoch: 7 | loss: 0.4670959
	speed: 0.0510s/iter; left time: 1505.4272s
	iters: 1900, epoch: 7 | loss: 0.4483082
	speed: 0.0517s/iter; left time: 1521.7504s
	iters: 2000, epoch: 7 | loss: 0.3732613
	speed: 0.0482s/iter; left time: 1413.1489s
	iters: 2100, epoch: 7 | loss: 0.4823655
	speed: 0.0481s/iter; left time: 1408.1162s
	iters: 2200, epoch: 7 | loss: 0.4820542
	speed: 0.0494s/iter; left time: 1440.1449s
Epoch: 7 cost time: 111.31335926055908
Epoch: 7, Steps: 2239 | Train Loss: 0.5868184 Vali Loss: 0.5978310 Test Loss: 0.3168691
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.6096318
	speed: 0.1521s/iter; left time: 4410.9021s
	iters: 200, epoch: 8 | loss: 0.7664652
	speed: 0.0453s/iter; left time: 1308.5279s
	iters: 300, epoch: 8 | loss: 0.4481773
	speed: 0.0512s/iter; left time: 1475.3661s
	iters: 400, epoch: 8 | loss: 0.9334380
	speed: 0.0515s/iter; left time: 1479.8656s
	iters: 500, epoch: 8 | loss: 0.4253345
	speed: 0.0509s/iter; left time: 1456.2174s
	iters: 600, epoch: 8 | loss: 0.3832532
	speed: 0.0496s/iter; left time: 1414.6863s
	iters: 700, epoch: 8 | loss: 0.6707695
	speed: 0.0501s/iter; left time: 1423.4952s
	iters: 800, epoch: 8 | loss: 0.5088509
	speed: 0.0497s/iter; left time: 1407.1330s
	iters: 900, epoch: 8 | loss: 0.5241751
	speed: 0.0486s/iter; left time: 1370.7146s
	iters: 1000, epoch: 8 | loss: 0.7097403
	speed: 0.0500s/iter; left time: 1406.4929s
	iters: 1100, epoch: 8 | loss: 0.7639644
	speed: 0.0499s/iter; left time: 1397.4329s
	iters: 1200, epoch: 8 | loss: 0.5988964
	speed: 0.0510s/iter; left time: 1423.6471s
	iters: 1300, epoch: 8 | loss: 0.6998049
	speed: 0.0486s/iter; left time: 1351.4548s
	iters: 1400, epoch: 8 | loss: 0.4834293
	speed: 0.0495s/iter; left time: 1371.7343s
	iters: 1500, epoch: 8 | loss: 0.5867330
	speed: 0.0501s/iter; left time: 1384.4131s
	iters: 1600, epoch: 8 | loss: 0.4516709
	speed: 0.0493s/iter; left time: 1355.5039s
	iters: 1700, epoch: 8 | loss: 0.4061243
	speed: 0.0490s/iter; left time: 1342.9991s
	iters: 1800, epoch: 8 | loss: 0.3750015
	speed: 0.0527s/iter; left time: 1439.1760s
	iters: 1900, epoch: 8 | loss: 0.4870656
	speed: 0.0505s/iter; left time: 1375.0122s
	iters: 2000, epoch: 8 | loss: 0.6442658
	speed: 0.0441s/iter; left time: 1196.4560s
	iters: 2100, epoch: 8 | loss: 0.6214758
	speed: 0.0504s/iter; left time: 1361.1545s
	iters: 2200, epoch: 8 | loss: 0.5241704
	speed: 0.0455s/iter; left time: 1225.3034s
Epoch: 8 cost time: 109.72620558738708
Epoch: 8, Steps: 2239 | Train Loss: 0.5830778 Vali Loss: 0.5928798 Test Loss: 0.3162353
Validation loss decreased (0.597084 --> 0.592880).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.3733219
	speed: 0.1422s/iter; left time: 3806.8112s
	iters: 200, epoch: 9 | loss: 0.7340347
	speed: 0.0450s/iter; left time: 1199.6736s
	iters: 300, epoch: 9 | loss: 0.7722756
	speed: 0.0472s/iter; left time: 1254.8062s
	iters: 400, epoch: 9 | loss: 0.7319794
	speed: 0.0511s/iter; left time: 1351.3647s
	iters: 500, epoch: 9 | loss: 0.7619114
	speed: 0.0511s/iter; left time: 1346.9167s
	iters: 600, epoch: 9 | loss: 0.4340276
	speed: 0.0512s/iter; left time: 1345.9113s
	iters: 700, epoch: 9 | loss: 0.9938173
	speed: 0.0507s/iter; left time: 1327.7282s
	iters: 800, epoch: 9 | loss: 1.0078839
	speed: 0.0479s/iter; left time: 1247.9215s
	iters: 900, epoch: 9 | loss: 1.0025979
	speed: 0.0511s/iter; left time: 1326.3792s
	iters: 1000, epoch: 9 | loss: 0.4654075
	speed: 0.0479s/iter; left time: 1238.5471s
	iters: 1100, epoch: 9 | loss: 0.6793848
	speed: 0.0460s/iter; left time: 1185.7764s
	iters: 1200, epoch: 9 | loss: 0.4275519
	speed: 0.0483s/iter; left time: 1240.6445s
	iters: 1300, epoch: 9 | loss: 0.3998047
	speed: 0.0489s/iter; left time: 1251.3221s
	iters: 1400, epoch: 9 | loss: 0.4036973
	speed: 0.0503s/iter; left time: 1281.2701s
	iters: 1500, epoch: 9 | loss: 0.4799522
	speed: 0.0491s/iter; left time: 1245.1931s
	iters: 1600, epoch: 9 | loss: 0.6686754
	speed: 0.0507s/iter; left time: 1281.3015s
	iters: 1700, epoch: 9 | loss: 0.6995785
	speed: 0.0511s/iter; left time: 1285.9189s
	iters: 1800, epoch: 9 | loss: 0.6646992
	speed: 0.0472s/iter; left time: 1184.2554s
	iters: 1900, epoch: 9 | loss: 0.4671380
	speed: 0.0519s/iter; left time: 1294.9861s
	iters: 2000, epoch: 9 | loss: 0.4195434
	speed: 0.0496s/iter; left time: 1232.9715s
	iters: 2100, epoch: 9 | loss: 0.7049760
	speed: 0.0487s/iter; left time: 1206.4496s
	iters: 2200, epoch: 9 | loss: 0.5407820
	speed: 0.0470s/iter; left time: 1160.6324s
Epoch: 9 cost time: 109.154780626297
Epoch: 9, Steps: 2239 | Train Loss: 0.5811900 Vali Loss: 0.5929050 Test Loss: 0.3185222
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.8065575
	speed: 0.1482s/iter; left time: 3636.0877s
	iters: 200, epoch: 10 | loss: 0.4723114
	speed: 0.0422s/iter; left time: 1030.9445s
	iters: 300, epoch: 10 | loss: 0.5079632
	speed: 0.0486s/iter; left time: 1182.7164s
	iters: 400, epoch: 10 | loss: 0.4330506
	speed: 0.0493s/iter; left time: 1195.4794s
	iters: 500, epoch: 10 | loss: 0.3806614
	speed: 0.0499s/iter; left time: 1204.9016s
	iters: 600, epoch: 10 | loss: 0.5446258
	speed: 0.0458s/iter; left time: 1100.3076s
	iters: 700, epoch: 10 | loss: 0.7794532
	speed: 0.0484s/iter; left time: 1157.3916s
	iters: 800, epoch: 10 | loss: 0.4836199
	speed: 0.0451s/iter; left time: 1073.8329s
	iters: 900, epoch: 10 | loss: 5.4738359
	speed: 0.0497s/iter; left time: 1178.5177s
	iters: 1000, epoch: 10 | loss: 0.5355887
	speed: 0.0527s/iter; left time: 1244.4910s
	iters: 1100, epoch: 10 | loss: 0.5149551
	speed: 0.0580s/iter; left time: 1363.9632s
	iters: 1200, epoch: 10 | loss: 0.8052993
	speed: 0.0545s/iter; left time: 1277.9300s
	iters: 1300, epoch: 10 | loss: 0.4832870
	speed: 0.0501s/iter; left time: 1168.6002s
	iters: 1400, epoch: 10 | loss: 0.4891145
	speed: 0.0465s/iter; left time: 1081.0524s
	iters: 1500, epoch: 10 | loss: 0.4557263
	speed: 0.0478s/iter; left time: 1104.5815s
	iters: 1600, epoch: 10 | loss: 0.4633164
	speed: 0.0515s/iter; left time: 1186.0229s
	iters: 1700, epoch: 10 | loss: 0.7090245
	speed: 0.0474s/iter; left time: 1086.1104s
	iters: 1800, epoch: 10 | loss: 0.3816979
	speed: 0.0479s/iter; left time: 1093.0703s
	iters: 1900, epoch: 10 | loss: 0.7304896
	speed: 0.0485s/iter; left time: 1102.5947s
	iters: 2000, epoch: 10 | loss: 3.1760798
	speed: 0.0455s/iter; left time: 1028.9491s
	iters: 2100, epoch: 10 | loss: 2.0911071
	speed: 0.0464s/iter; left time: 1045.8057s
	iters: 2200, epoch: 10 | loss: 0.4170999
	speed: 0.0515s/iter; left time: 1156.1564s
Epoch: 10 cost time: 108.5922999382019
Epoch: 10, Steps: 2239 | Train Loss: 0.5801797 Vali Loss: 0.5933738 Test Loss: 0.3163876
EarlyStopping counter: 2 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.4451056
	speed: 0.1596s/iter; left time: 3558.6863s
	iters: 200, epoch: 11 | loss: 0.5572538
	speed: 0.0440s/iter; left time: 975.6171s
	iters: 300, epoch: 11 | loss: 0.7413865
	speed: 0.0451s/iter; left time: 995.5076s
	iters: 400, epoch: 11 | loss: 0.4551662
	speed: 0.0473s/iter; left time: 1041.1965s
	iters: 500, epoch: 11 | loss: 0.4689752
	speed: 0.0502s/iter; left time: 1099.3615s
	iters: 600, epoch: 11 | loss: 0.8775589
	speed: 0.0490s/iter; left time: 1067.7711s
	iters: 700, epoch: 11 | loss: 0.4596489
	speed: 0.0454s/iter; left time: 984.5860s
	iters: 800, epoch: 11 | loss: 0.6844869
	speed: 0.0558s/iter; left time: 1205.6133s
	iters: 900, epoch: 11 | loss: 0.3570515
	speed: 0.0525s/iter; left time: 1128.9527s
	iters: 1000, epoch: 11 | loss: 0.6784874
	speed: 0.0519s/iter; left time: 1110.7652s
	iters: 1100, epoch: 11 | loss: 0.3894631
	speed: 0.0521s/iter; left time: 1109.7240s
	iters: 1200, epoch: 11 | loss: 0.6487387
	speed: 0.0503s/iter; left time: 1066.4058s
	iters: 1300, epoch: 11 | loss: 0.5913759
	speed: 0.0521s/iter; left time: 1097.8294s
	iters: 1400, epoch: 11 | loss: 0.4016222
	speed: 0.0532s/iter; left time: 1115.7932s
	iters: 1500, epoch: 11 | loss: 0.5739092
	speed: 0.0502s/iter; left time: 1049.2721s
	iters: 1600, epoch: 11 | loss: 0.4618905
	speed: 0.0491s/iter; left time: 1020.0101s
	iters: 1700, epoch: 11 | loss: 0.4004831
	speed: 0.0477s/iter; left time: 987.0992s
	iters: 1800, epoch: 11 | loss: 0.4014559
	speed: 0.0519s/iter; left time: 1068.1476s
	iters: 1900, epoch: 11 | loss: 0.6414558
	speed: 0.0509s/iter; left time: 1042.9830s
	iters: 2000, epoch: 11 | loss: 1.0548332
	speed: 0.0507s/iter; left time: 1034.8354s
	iters: 2100, epoch: 11 | loss: 0.3944815
	speed: 0.0499s/iter; left time: 1012.6534s
	iters: 2200, epoch: 11 | loss: 0.5179011
	speed: 0.0458s/iter; left time: 925.0747s
Epoch: 11 cost time: 110.58955478668213
Epoch: 11, Steps: 2239 | Train Loss: 0.5795341 Vali Loss: 0.5919265 Test Loss: 0.3176197
Validation loss decreased (0.592880 --> 0.591927).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.4677047
	speed: 0.1494s/iter; left time: 2996.2502s
	iters: 200, epoch: 12 | loss: 0.9097885
	speed: 0.0411s/iter; left time: 820.0101s
	iters: 300, epoch: 12 | loss: 0.7349725
	speed: 0.0451s/iter; left time: 896.0882s
	iters: 400, epoch: 12 | loss: 0.4921699
	speed: 0.0504s/iter; left time: 996.4571s
	iters: 500, epoch: 12 | loss: 0.7484954
	speed: 0.0450s/iter; left time: 884.1019s
	iters: 600, epoch: 12 | loss: 0.3858462
	speed: 0.0426s/iter; left time: 833.0540s
	iters: 700, epoch: 12 | loss: 2.1033382
	speed: 0.0423s/iter; left time: 821.9508s
	iters: 800, epoch: 12 | loss: 0.5565797
	speed: 0.0465s/iter; left time: 899.3130s
	iters: 900, epoch: 12 | loss: 0.3945521
	speed: 0.0485s/iter; left time: 933.9589s
	iters: 1000, epoch: 12 | loss: 0.6831523
	speed: 0.0393s/iter; left time: 752.3038s
	iters: 1100, epoch: 12 | loss: 0.6139228
	speed: 0.0407s/iter; left time: 776.0956s
	iters: 1200, epoch: 12 | loss: 0.6242795
	speed: 0.0387s/iter; left time: 733.7514s
	iters: 1300, epoch: 12 | loss: 0.5051192
	speed: 0.0411s/iter; left time: 775.4704s
	iters: 1400, epoch: 12 | loss: 0.6953891
	speed: 0.0449s/iter; left time: 841.0815s
	iters: 1500, epoch: 12 | loss: 0.4148438
	speed: 0.0425s/iter; left time: 792.7345s
	iters: 1600, epoch: 12 | loss: 0.4630024
	speed: 0.0402s/iter; left time: 745.0129s
	iters: 1700, epoch: 12 | loss: 0.4851218
	speed: 0.0398s/iter; left time: 734.3537s
	iters: 1800, epoch: 12 | loss: 0.6493589
	speed: 0.0404s/iter; left time: 740.9027s
	iters: 1900, epoch: 12 | loss: 0.4617021
	speed: 0.0424s/iter; left time: 773.1062s
	iters: 2000, epoch: 12 | loss: 0.4362468
	speed: 0.0432s/iter; left time: 783.3901s
	iters: 2100, epoch: 12 | loss: 0.5251539
	speed: 0.0434s/iter; left time: 783.3840s
	iters: 2200, epoch: 12 | loss: 0.5936134
	speed: 0.0417s/iter; left time: 748.3267s
Epoch: 12 cost time: 95.58798599243164
Epoch: 12, Steps: 2239 | Train Loss: 0.5793868 Vali Loss: 0.5929695 Test Loss: 0.3167619
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.4979813
	speed: 0.1446s/iter; left time: 2575.4567s
	iters: 200, epoch: 13 | loss: 0.5464749
	speed: 0.0379s/iter; left time: 671.5800s
	iters: 300, epoch: 13 | loss: 0.7321799
	speed: 0.0379s/iter; left time: 667.5784s
	iters: 400, epoch: 13 | loss: 0.4644233
	speed: 0.0402s/iter; left time: 704.2205s
	iters: 500, epoch: 13 | loss: 0.4468303
	speed: 0.0421s/iter; left time: 733.6047s
	iters: 600, epoch: 13 | loss: 0.5352723
	speed: 0.0449s/iter; left time: 777.9288s
	iters: 700, epoch: 13 | loss: 0.5164323
	speed: 0.0426s/iter; left time: 733.0481s
	iters: 800, epoch: 13 | loss: 0.6679884
	speed: 0.0422s/iter; left time: 722.6101s
	iters: 900, epoch: 13 | loss: 0.4278136
	speed: 0.0424s/iter; left time: 721.6930s
	iters: 1000, epoch: 13 | loss: 0.3891830
	speed: 0.0427s/iter; left time: 721.8394s
	iters: 1100, epoch: 13 | loss: 0.4631166
	speed: 0.0412s/iter; left time: 693.4252s
	iters: 1200, epoch: 13 | loss: 0.8244485
	speed: 0.0414s/iter; left time: 691.5852s
	iters: 1300, epoch: 13 | loss: 0.5112702
	speed: 0.0424s/iter; left time: 704.7006s
	iters: 1400, epoch: 13 | loss: 0.5464752
	speed: 0.0428s/iter; left time: 707.4422s
	iters: 1500, epoch: 13 | loss: 0.4527184
	speed: 0.0406s/iter; left time: 666.8037s
	iters: 1600, epoch: 13 | loss: 0.5270124
	speed: 0.0428s/iter; left time: 698.5540s
	iters: 1700, epoch: 13 | loss: 0.4869979
	speed: 0.0431s/iter; left time: 698.8886s
	iters: 1800, epoch: 13 | loss: 0.3401766
	speed: 0.0430s/iter; left time: 692.4571s
	iters: 1900, epoch: 13 | loss: 0.3980511
	speed: 0.0433s/iter; left time: 693.8869s
	iters: 2000, epoch: 13 | loss: 0.5751784
	speed: 0.0451s/iter; left time: 717.9621s
	iters: 2100, epoch: 13 | loss: 0.6671350
	speed: 0.0432s/iter; left time: 683.3470s
	iters: 2200, epoch: 13 | loss: 0.4524676
	speed: 0.0389s/iter; left time: 611.9035s
Epoch: 13 cost time: 93.54413938522339
Epoch: 13, Steps: 2239 | Train Loss: 0.5792549 Vali Loss: 0.5925479 Test Loss: 0.3174083
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.4620598
	speed: 0.1262s/iter; left time: 1966.1379s
	iters: 200, epoch: 14 | loss: 0.4197235
	speed: 0.0332s/iter; left time: 513.4182s
	iters: 300, epoch: 14 | loss: 0.6644954
	speed: 0.0374s/iter; left time: 574.5065s
	iters: 400, epoch: 14 | loss: 0.7054983
	speed: 0.0404s/iter; left time: 617.4389s
	iters: 500, epoch: 14 | loss: 0.4560601
	speed: 0.0398s/iter; left time: 603.5550s
	iters: 600, epoch: 14 | loss: 1.4693022
	speed: 0.0345s/iter; left time: 519.9666s
	iters: 700, epoch: 14 | loss: 0.4455654
	speed: 0.0343s/iter; left time: 514.1331s
	iters: 800, epoch: 14 | loss: 0.4688698
	speed: 0.0357s/iter; left time: 531.3341s
	iters: 900, epoch: 14 | loss: 0.8060689
	speed: 0.0357s/iter; left time: 528.0951s
	iters: 1000, epoch: 14 | loss: 0.4664659
	speed: 0.0354s/iter; left time: 519.4376s
	iters: 1100, epoch: 14 | loss: 0.6334779
	speed: 0.0359s/iter; left time: 523.6393s
	iters: 1200, epoch: 14 | loss: 0.4823267
	speed: 0.0351s/iter; left time: 508.6129s
	iters: 1300, epoch: 14 | loss: 0.5145323
	speed: 0.0349s/iter; left time: 502.3408s
	iters: 1400, epoch: 14 | loss: 0.5096730
	speed: 0.0348s/iter; left time: 497.1788s
	iters: 1500, epoch: 14 | loss: 0.4600432
	speed: 0.0347s/iter; left time: 492.5287s
	iters: 1600, epoch: 14 | loss: 0.4500464
	speed: 0.0343s/iter; left time: 482.8644s
	iters: 1700, epoch: 14 | loss: 0.9325214
	speed: 0.0344s/iter; left time: 480.7157s
	iters: 1800, epoch: 14 | loss: 0.4977661
	speed: 0.0354s/iter; left time: 491.5200s
	iters: 1900, epoch: 14 | loss: 0.5676843
	speed: 0.0367s/iter; left time: 505.3639s
	iters: 2000, epoch: 14 | loss: 0.6744987
	speed: 0.0368s/iter; left time: 502.6419s
	iters: 2100, epoch: 14 | loss: 0.5442497
	speed: 0.0364s/iter; left time: 494.4640s
	iters: 2200, epoch: 14 | loss: 0.6243148
	speed: 0.0337s/iter; left time: 454.0489s
Epoch: 14 cost time: 79.77672219276428
Epoch: 14, Steps: 2239 | Train Loss: 0.5791497 Vali Loss: 0.5922883 Test Loss: 0.3174013
EarlyStopping counter: 3 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.5991507
	speed: 0.1144s/iter; left time: 1525.4287s
	iters: 200, epoch: 15 | loss: 0.4629709
	speed: 0.0320s/iter; left time: 424.0362s
	iters: 300, epoch: 15 | loss: 0.4643528
	speed: 0.0326s/iter; left time: 428.2797s
	iters: 400, epoch: 15 | loss: 0.4560429
	speed: 0.0350s/iter; left time: 455.7064s
	iters: 500, epoch: 15 | loss: 0.7385443
	speed: 0.0346s/iter; left time: 447.3760s
	iters: 600, epoch: 15 | loss: 0.3726158
	speed: 0.0332s/iter; left time: 425.9658s
	iters: 700, epoch: 15 | loss: 0.7338275
	speed: 0.0328s/iter; left time: 417.6817s
	iters: 800, epoch: 15 | loss: 0.6470277
	speed: 0.0350s/iter; left time: 442.3218s
	iters: 900, epoch: 15 | loss: 0.3579840
	speed: 0.0323s/iter; left time: 405.3510s
	iters: 1000, epoch: 15 | loss: 0.7755782
	speed: 0.0334s/iter; left time: 414.9194s
	iters: 1100, epoch: 15 | loss: 0.5433966
	speed: 0.0332s/iter; left time: 409.6100s
	iters: 1200, epoch: 15 | loss: 0.4654325
	speed: 0.0324s/iter; left time: 395.9311s
	iters: 1300, epoch: 15 | loss: 0.4249650
	speed: 0.0333s/iter; left time: 403.8822s
	iters: 1400, epoch: 15 | loss: 0.4162214
	speed: 0.0341s/iter; left time: 409.8670s
	iters: 1500, epoch: 15 | loss: 0.5901141
	speed: 0.0330s/iter; left time: 393.9125s
	iters: 1600, epoch: 15 | loss: 0.5369694
	speed: 0.0315s/iter; left time: 373.1488s
	iters: 1700, epoch: 15 | loss: 0.7584679
	speed: 0.0322s/iter; left time: 377.6247s
	iters: 1800, epoch: 15 | loss: 0.4801616
	speed: 0.0344s/iter; left time: 400.2217s
	iters: 1900, epoch: 15 | loss: 0.3870789
	speed: 0.0355s/iter; left time: 409.1992s
	iters: 2000, epoch: 15 | loss: 0.4286622
	speed: 0.0348s/iter; left time: 398.0560s
	iters: 2100, epoch: 15 | loss: 0.3484725
	speed: 0.0347s/iter; left time: 392.9608s
	iters: 2200, epoch: 15 | loss: 0.8359745
	speed: 0.0336s/iter; left time: 377.6543s
Epoch: 15 cost time: 74.7141363620758
Epoch: 15, Steps: 2239 | Train Loss: 0.5791802 Vali Loss: 0.5926946 Test Loss: 0.3172590
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.5980374
	speed: 0.1200s/iter; left time: 1331.0055s
	iters: 200, epoch: 16 | loss: 0.5089302
	speed: 0.0308s/iter; left time: 338.9920s
	iters: 300, epoch: 16 | loss: 0.4618661
	speed: 0.0296s/iter; left time: 322.2849s
	iters: 400, epoch: 16 | loss: 0.5232388
	speed: 0.0324s/iter; left time: 349.5466s
	iters: 500, epoch: 16 | loss: 0.4979364
	speed: 0.0344s/iter; left time: 368.2379s
	iters: 600, epoch: 16 | loss: 0.9774812
	speed: 0.0335s/iter; left time: 354.6396s
	iters: 700, epoch: 16 | loss: 0.4908865
	speed: 0.0335s/iter; left time: 351.7295s
	iters: 800, epoch: 16 | loss: 0.5298471
	speed: 0.0329s/iter; left time: 341.8660s
	iters: 900, epoch: 16 | loss: 0.5475730
	speed: 0.0336s/iter; left time: 345.7056s
	iters: 1000, epoch: 16 | loss: 0.5783380
	speed: 0.0350s/iter; left time: 357.1514s
	iters: 1100, epoch: 16 | loss: 0.6507312
	speed: 0.0340s/iter; left time: 343.2122s
	iters: 1200, epoch: 16 | loss: 0.6082401
	speed: 0.0346s/iter; left time: 345.4531s
	iters: 1300, epoch: 16 | loss: 0.7826433
	speed: 0.0335s/iter; left time: 331.8618s
	iters: 1400, epoch: 16 | loss: 0.8599685
	speed: 0.0332s/iter; left time: 324.9354s
	iters: 1500, epoch: 16 | loss: 0.4206800
	speed: 0.0333s/iter; left time: 322.9568s
	iters: 1600, epoch: 16 | loss: 0.8717196
	speed: 0.0336s/iter; left time: 322.7625s
	iters: 1700, epoch: 16 | loss: 0.4493850
	speed: 0.0321s/iter; left time: 305.0888s
	iters: 1800, epoch: 16 | loss: 0.4219047
	speed: 0.0333s/iter; left time: 312.7043s
	iters: 1900, epoch: 16 | loss: 0.3663445
	speed: 0.0331s/iter; left time: 307.3437s
	iters: 2000, epoch: 16 | loss: 0.4294251
	speed: 0.0347s/iter; left time: 319.2624s
	iters: 2100, epoch: 16 | loss: 0.4769746
	speed: 0.0336s/iter; left time: 305.2998s
	iters: 2200, epoch: 16 | loss: 0.4837100
	speed: 0.0330s/iter; left time: 296.8390s
Epoch: 16 cost time: 74.28063249588013
Epoch: 16, Steps: 2239 | Train Loss: 0.5791496 Vali Loss: 0.5924839 Test Loss: 0.3172523
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : weather_336_720_Linear_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed25565<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9820
mse:0.3175603747367859, mae:0.360175758600235
