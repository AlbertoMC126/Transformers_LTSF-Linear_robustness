Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTh2', data_path='ETTh2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.05, loss='mse', lradj='type1', model='DLinear', model_id='ETTh2_96_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=3293, seq_len=96, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTh2_96_96_DLinear_ETTh2_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3293>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8449
data_set:  <data_provider.data_loader.Dataset_ETT_hour object at 0x0000021538F80550>
val 2785
data_set:  <data_provider.data_loader.Dataset_ETT_hour object at 0x0000021506587DD8>
test 2785
data_set:  <data_provider.data_loader.Dataset_ETT_hour object at 0x0000021538F80208>
Total number of trainable parameters: 130368
Total number of parameters: 130368
	iters: 100, epoch: 1 | loss: 0.9609531
	speed: 0.0058s/iter; left time: 60.1654s
	iters: 200, epoch: 1 | loss: 0.9499159
	speed: 0.0050s/iter; left time: 51.8118s
	iters: 300, epoch: 1 | loss: 0.7060476
	speed: 0.0040s/iter; left time: 41.2730s
	iters: 400, epoch: 1 | loss: 2.1293299
	speed: 0.0044s/iter; left time: 44.4771s
	iters: 500, epoch: 1 | loss: 1.2419562
	speed: 0.0039s/iter; left time: 39.2496s
Epoch: 1 cost time: 2.41983699798584
Epoch: 1, Steps: 528 | Train Loss: 1.5051299 Vali Loss: 1.4236374 Test Loss: 3.9215713
Validation loss decreased (inf --> 1.423637).  Saving model ...
Updating learning rate to 0.05
	iters: 100, epoch: 2 | loss: 1.2002465
	speed: 0.0113s/iter; left time: 112.2990s
	iters: 200, epoch: 2 | loss: 1.8646867
	speed: 0.0045s/iter; left time: 43.9283s
	iters: 300, epoch: 2 | loss: 1.1834191
	speed: 0.0050s/iter; left time: 48.2354s
	iters: 400, epoch: 2 | loss: 3.1080537
	speed: 0.0039s/iter; left time: 37.1348s
	iters: 500, epoch: 2 | loss: 1.2248914
	speed: 0.0043s/iter; left time: 41.4214s
Epoch: 2 cost time: 2.370720863342285
Epoch: 2, Steps: 528 | Train Loss: 1.4465030 Vali Loss: 2.5417948 Test Loss: 5.3355169
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.025
	iters: 100, epoch: 3 | loss: 0.3762848
	speed: 0.0106s/iter; left time: 100.1621s
	iters: 200, epoch: 3 | loss: 0.4307837
	speed: 0.0045s/iter; left time: 41.4453s
	iters: 300, epoch: 3 | loss: 0.3602229
	speed: 0.0044s/iter; left time: 40.1272s
	iters: 400, epoch: 3 | loss: 0.6430951
	speed: 0.0045s/iter; left time: 40.7710s
	iters: 500, epoch: 3 | loss: 0.3731048
	speed: 0.0038s/iter; left time: 33.9366s
Epoch: 3 cost time: 2.2468531131744385
Epoch: 3, Steps: 528 | Train Loss: 0.6453146 Vali Loss: 0.4436955 Test Loss: 0.8602858
Validation loss decreased (1.423637 --> 0.443695).  Saving model ...
Updating learning rate to 0.0125
	iters: 100, epoch: 4 | loss: 0.3805573
	speed: 0.0105s/iter; left time: 93.1854s
	iters: 200, epoch: 4 | loss: 0.4436417
	speed: 0.0046s/iter; left time: 40.2447s
	iters: 300, epoch: 4 | loss: 0.3154600
	speed: 0.0047s/iter; left time: 41.1130s
	iters: 400, epoch: 4 | loss: 0.3886401
	speed: 0.0034s/iter; left time: 28.7962s
	iters: 500, epoch: 4 | loss: 0.3599857
	speed: 0.0042s/iter; left time: 35.5166s
Epoch: 4 cost time: 2.160860061645508
Epoch: 4, Steps: 528 | Train Loss: 0.4700821 Vali Loss: 0.4554325 Test Loss: 0.9970894
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00625
	iters: 100, epoch: 5 | loss: 0.2446347
	speed: 0.0117s/iter; left time: 97.6798s
	iters: 200, epoch: 5 | loss: 0.3920214
	speed: 0.0042s/iter; left time: 34.3856s
	iters: 300, epoch: 5 | loss: 0.1870561
	speed: 0.0051s/iter; left time: 41.9576s
	iters: 400, epoch: 5 | loss: 0.3557951
	speed: 0.0036s/iter; left time: 28.6983s
	iters: 500, epoch: 5 | loss: 0.2313910
	speed: 0.0036s/iter; left time: 28.5217s
Epoch: 5 cost time: 2.2797348499298096
Epoch: 5, Steps: 528 | Train Loss: 0.4224637 Vali Loss: 0.2659019 Test Loss: 0.3739887
Validation loss decreased (0.443695 --> 0.265902).  Saving model ...
Updating learning rate to 0.003125
	iters: 100, epoch: 6 | loss: 0.2437429
	speed: 0.0101s/iter; left time: 79.0838s
	iters: 200, epoch: 6 | loss: 0.7520235
	speed: 0.0044s/iter; left time: 34.3471s
	iters: 300, epoch: 6 | loss: 0.7450798
	speed: 0.0040s/iter; left time: 30.4922s
	iters: 400, epoch: 6 | loss: 0.8631561
	speed: 0.0047s/iter; left time: 35.2270s
	iters: 500, epoch: 6 | loss: 0.7228807
	speed: 0.0045s/iter; left time: 33.2784s
Epoch: 6 cost time: 2.230804204940796
Epoch: 6, Steps: 528 | Train Loss: 0.3968492 Vali Loss: 0.3145614 Test Loss: 0.5629309
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0015625
	iters: 100, epoch: 7 | loss: 0.2219859
	speed: 0.0112s/iter; left time: 81.6526s
	iters: 200, epoch: 7 | loss: 0.3090547
	speed: 0.0040s/iter; left time: 28.7155s
	iters: 300, epoch: 7 | loss: 0.6790933
	speed: 0.0038s/iter; left time: 26.6688s
	iters: 400, epoch: 7 | loss: 0.1565501
	speed: 0.0054s/iter; left time: 37.6158s
	iters: 500, epoch: 7 | loss: 0.2824159
	speed: 0.0055s/iter; left time: 37.8675s
Epoch: 7 cost time: 2.482591152191162
Epoch: 7, Steps: 528 | Train Loss: 0.3845928 Vali Loss: 0.3223182 Test Loss: 0.6544146
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.00078125
	iters: 100, epoch: 8 | loss: 0.2929839
	speed: 0.0106s/iter; left time: 71.9033s
	iters: 200, epoch: 8 | loss: 0.4667513
	speed: 0.0040s/iter; left time: 26.9526s
	iters: 300, epoch: 8 | loss: 0.6124156
	speed: 0.0051s/iter; left time: 33.3107s
	iters: 400, epoch: 8 | loss: 0.8098511
	speed: 0.0052s/iter; left time: 33.4327s
	iters: 500, epoch: 8 | loss: 0.2657875
	speed: 0.0040s/iter; left time: 25.5194s
Epoch: 8 cost time: 2.4182746410369873
Epoch: 8, Steps: 528 | Train Loss: 0.3771210 Vali Loss: 0.3216574 Test Loss: 0.6313415
EarlyStopping counter: 3 out of 5
Updating learning rate to 0.000390625
	iters: 100, epoch: 9 | loss: 0.1023544
	speed: 0.0090s/iter; left time: 56.3687s
	iters: 200, epoch: 9 | loss: 0.7367705
	speed: 0.0045s/iter; left time: 27.7889s
	iters: 300, epoch: 9 | loss: 0.2703154
	speed: 0.0044s/iter; left time: 26.3667s
	iters: 400, epoch: 9 | loss: 0.5723578
	speed: 0.0050s/iter; left time: 29.4121s
	iters: 500, epoch: 9 | loss: 0.2803496
	speed: 0.0040s/iter; left time: 23.4899s
Epoch: 9 cost time: 2.279540777206421
Epoch: 9, Steps: 528 | Train Loss: 0.3733216 Vali Loss: 0.2920251 Test Loss: 0.5441467
EarlyStopping counter: 4 out of 5
Updating learning rate to 0.0001953125
	iters: 100, epoch: 10 | loss: 0.1797649
	speed: 0.0120s/iter; left time: 68.7645s
	iters: 200, epoch: 10 | loss: 0.2912706
	speed: 0.0050s/iter; left time: 28.0411s
	iters: 300, epoch: 10 | loss: 0.2277202
	speed: 0.0039s/iter; left time: 21.2779s
	iters: 400, epoch: 10 | loss: 0.7086957
	speed: 0.0041s/iter; left time: 22.1505s
	iters: 500, epoch: 10 | loss: 0.2901655
	speed: 0.0038s/iter; left time: 20.3973s
Epoch: 10 cost time: 2.375027894973755
Epoch: 10, Steps: 528 | Train Loss: 0.3699832 Vali Loss: 0.2793592 Test Loss: 0.4993353
EarlyStopping counter: 5 out of 5
Early stopping
Total training time: 28.3603 seconds
>>>>>>>testing : ETTh2_96_96_DLinear_ETTh2_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3293<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
data_set:  <data_provider.data_loader.Dataset_ETT_hour object at 0x0000021538F73860>
mse:0.37514570355415344, mae:0.4128762185573578
