Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='Linear', model_id='Electricity_336_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=336, root_path='./dataset/', save_pred_values=False, seed=28649, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : Electricity_336_336_Linear_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed28649>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17741
val 2297
test 4925
	iters: 100, epoch: 1 | loss: 0.2407696
	speed: 0.0999s/iter; left time: 2204.8460s
	iters: 200, epoch: 1 | loss: 0.2450736
	speed: 0.0860s/iter; left time: 1888.3196s
	iters: 300, epoch: 1 | loss: 0.2591211
	speed: 0.0864s/iter; left time: 1888.7499s
	iters: 400, epoch: 1 | loss: 0.2470643
	speed: 0.0886s/iter; left time: 1927.0891s
	iters: 500, epoch: 1 | loss: 0.2305610
	speed: 0.0861s/iter; left time: 1865.8404s
	iters: 600, epoch: 1 | loss: 0.2953721
	speed: 0.0861s/iter; left time: 1855.7476s
	iters: 700, epoch: 1 | loss: 0.2508966
	speed: 0.0854s/iter; left time: 1833.3861s
	iters: 800, epoch: 1 | loss: 0.2639757
	speed: 0.0852s/iter; left time: 1820.1821s
	iters: 900, epoch: 1 | loss: 0.2329289
	speed: 0.0851s/iter; left time: 1809.1998s
	iters: 1000, epoch: 1 | loss: 0.2410934
	speed: 0.0862s/iter; left time: 1823.6252s
	iters: 1100, epoch: 1 | loss: 0.2512865
	speed: 0.0856s/iter; left time: 1802.3592s
Epoch: 1 cost time: 96.80575132369995
Epoch: 1, Steps: 1108 | Train Loss: 0.2511495 Vali Loss: 0.2074991 Test Loss: 0.2374482
Validation loss decreased (inf --> 0.207499).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.2522969
	speed: 0.2419s/iter; left time: 5069.0822s
	iters: 200, epoch: 2 | loss: 0.2504874
	speed: 0.0855s/iter; left time: 1782.1226s
	iters: 300, epoch: 2 | loss: 0.2410730
	speed: 0.0893s/iter; left time: 1854.0474s
	iters: 400, epoch: 2 | loss: 0.2134771
	speed: 0.0866s/iter; left time: 1789.0479s
	iters: 500, epoch: 2 | loss: 0.2385283
	speed: 0.0882s/iter; left time: 1812.6175s
	iters: 600, epoch: 2 | loss: 0.2323604
	speed: 0.0858s/iter; left time: 1754.6252s
	iters: 700, epoch: 2 | loss: 0.2495727
	speed: 0.0845s/iter; left time: 1718.8602s
	iters: 800, epoch: 2 | loss: 0.2718764
	speed: 0.0853s/iter; left time: 1726.6895s
	iters: 900, epoch: 2 | loss: 0.2386591
	speed: 0.0856s/iter; left time: 1725.4496s
	iters: 1000, epoch: 2 | loss: 0.2300626
	speed: 0.0843s/iter; left time: 1689.5104s
	iters: 1100, epoch: 2 | loss: 0.2924176
	speed: 0.0835s/iter; left time: 1665.8678s
Epoch: 2 cost time: 95.18929386138916
Epoch: 2, Steps: 1108 | Train Loss: 0.2442049 Vali Loss: 0.2151844 Test Loss: 0.2421599
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.1732846
	speed: 0.2229s/iter; left time: 4423.0385s
	iters: 200, epoch: 3 | loss: 0.2333214
	speed: 0.0855s/iter; left time: 1687.4596s
	iters: 300, epoch: 3 | loss: 0.1789186
	speed: 0.0851s/iter; left time: 1672.2820s
	iters: 400, epoch: 3 | loss: 0.1881968
	speed: 0.0857s/iter; left time: 1674.0682s
	iters: 500, epoch: 3 | loss: 0.1873292
	speed: 0.0872s/iter; left time: 1696.4434s
	iters: 600, epoch: 3 | loss: 0.1831091
	speed: 0.0859s/iter; left time: 1661.6462s
	iters: 700, epoch: 3 | loss: 0.2027909
	speed: 0.0863s/iter; left time: 1660.2901s
	iters: 800, epoch: 3 | loss: 0.1802921
	speed: 0.0843s/iter; left time: 1614.8789s
	iters: 900, epoch: 3 | loss: 0.1916970
	speed: 0.0844s/iter; left time: 1608.0056s
	iters: 1000, epoch: 3 | loss: 0.1849761
	speed: 0.0858s/iter; left time: 1625.9846s
	iters: 1100, epoch: 3 | loss: 0.1928641
	speed: 0.0859s/iter; left time: 1618.3854s
Epoch: 3 cost time: 94.75362539291382
Epoch: 3, Steps: 1108 | Train Loss: 0.1964447 Vali Loss: 0.1723136 Test Loss: 0.1989359
Validation loss decreased (0.207499 --> 0.172314).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.1643109
	speed: 0.2433s/iter; left time: 4558.7569s
	iters: 200, epoch: 4 | loss: 0.1863522
	speed: 0.0864s/iter; left time: 1609.9136s
	iters: 300, epoch: 4 | loss: 0.1464714
	speed: 0.0864s/iter; left time: 1601.6849s
	iters: 400, epoch: 4 | loss: 0.1739861
	speed: 0.0862s/iter; left time: 1589.4804s
	iters: 500, epoch: 4 | loss: 0.1624093
	speed: 0.0845s/iter; left time: 1549.5461s
	iters: 600, epoch: 4 | loss: 0.1804444
	speed: 0.0868s/iter; left time: 1583.5174s
	iters: 700, epoch: 4 | loss: 0.1633097
	speed: 0.0879s/iter; left time: 1594.9562s
	iters: 800, epoch: 4 | loss: 0.1840818
	speed: 0.0880s/iter; left time: 1587.6195s
	iters: 900, epoch: 4 | loss: 0.2423516
	speed: 0.0861s/iter; left time: 1544.1335s
	iters: 1000, epoch: 4 | loss: 0.1830152
	speed: 0.0864s/iter; left time: 1541.1153s
	iters: 1100, epoch: 4 | loss: 0.1654831
	speed: 0.0852s/iter; left time: 1511.6880s
Epoch: 4 cost time: 95.8445258140564
Epoch: 4, Steps: 1108 | Train Loss: 0.1787155 Vali Loss: 0.1554975 Test Loss: 0.1813708
Validation loss decreased (0.172314 --> 0.155497).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.1575865
	speed: 0.2425s/iter; left time: 4275.4108s
	iters: 200, epoch: 5 | loss: 0.1862060
	speed: 0.0866s/iter; left time: 1517.7129s
	iters: 300, epoch: 5 | loss: 0.1669607
	speed: 0.0855s/iter; left time: 1490.6883s
	iters: 400, epoch: 5 | loss: 0.1440432
	speed: 0.0856s/iter; left time: 1482.5979s
	iters: 500, epoch: 5 | loss: 0.1825033
	speed: 0.0847s/iter; left time: 1458.8199s
	iters: 600, epoch: 5 | loss: 0.1594175
	speed: 0.0861s/iter; left time: 1474.5878s
	iters: 700, epoch: 5 | loss: 0.1428003
	speed: 0.0869s/iter; left time: 1480.1954s
	iters: 800, epoch: 5 | loss: 0.1716640
	speed: 0.0894s/iter; left time: 1513.5169s
	iters: 900, epoch: 5 | loss: 0.1447147
	speed: 0.0875s/iter; left time: 1472.0001s
	iters: 1000, epoch: 5 | loss: 0.1554733
	speed: 0.0834s/iter; left time: 1395.7357s
	iters: 1100, epoch: 5 | loss: 0.1442591
	speed: 0.0845s/iter; left time: 1405.4971s
Epoch: 5 cost time: 95.38760590553284
Epoch: 5, Steps: 1108 | Train Loss: 0.1698528 Vali Loss: 0.1510440 Test Loss: 0.1752663
Validation loss decreased (0.155497 --> 0.151044).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.1645607
	speed: 0.2400s/iter; left time: 3965.0040s
	iters: 200, epoch: 6 | loss: 0.1491969
	speed: 0.0855s/iter; left time: 1403.4943s
	iters: 300, epoch: 6 | loss: 0.1774925
	speed: 0.0841s/iter; left time: 1372.0776s
	iters: 400, epoch: 6 | loss: 0.1671604
	speed: 0.0840s/iter; left time: 1362.7497s
	iters: 500, epoch: 6 | loss: 0.1302421
	speed: 0.0858s/iter; left time: 1383.5309s
	iters: 600, epoch: 6 | loss: 0.1896552
	speed: 0.0854s/iter; left time: 1367.7725s
	iters: 700, epoch: 6 | loss: 0.1529040
	speed: 0.0859s/iter; left time: 1368.0957s
	iters: 800, epoch: 6 | loss: 0.1435733
	speed: 0.0850s/iter; left time: 1345.1437s
	iters: 900, epoch: 6 | loss: 0.1326393
	speed: 0.0874s/iter; left time: 1373.6009s
	iters: 1000, epoch: 6 | loss: 0.1934129
	speed: 0.0886s/iter; left time: 1384.5148s
	iters: 1100, epoch: 6 | loss: 0.1479974
	speed: 0.0873s/iter; left time: 1354.8365s
Epoch: 6 cost time: 95.18038725852966
Epoch: 6, Steps: 1108 | Train Loss: 0.1650853 Vali Loss: 0.1441575 Test Loss: 0.1691557
Validation loss decreased (0.151044 --> 0.144158).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.1518375
	speed: 0.2425s/iter; left time: 3737.9778s
	iters: 200, epoch: 7 | loss: 0.1960790
	speed: 0.0855s/iter; left time: 1310.0018s
	iters: 300, epoch: 7 | loss: 0.1342958
	speed: 0.0856s/iter; left time: 1302.7025s
	iters: 400, epoch: 7 | loss: 0.1417833
	speed: 0.0858s/iter; left time: 1296.2477s
	iters: 500, epoch: 7 | loss: 0.2124819
	speed: 0.0852s/iter; left time: 1279.3584s
	iters: 600, epoch: 7 | loss: 0.1529904
	speed: 0.0859s/iter; left time: 1281.4247s
	iters: 700, epoch: 7 | loss: 0.1762613
	speed: 0.0857s/iter; left time: 1269.1406s
	iters: 800, epoch: 7 | loss: 0.1525766
	speed: 0.0857s/iter; left time: 1260.2394s
	iters: 900, epoch: 7 | loss: 0.1971796
	speed: 0.0887s/iter; left time: 1295.9922s
	iters: 1000, epoch: 7 | loss: 0.1362035
	speed: 0.0871s/iter; left time: 1263.3911s
	iters: 1100, epoch: 7 | loss: 0.1758681
	speed: 0.0885s/iter; left time: 1275.5310s
Epoch: 7 cost time: 95.66632962226868
Epoch: 7, Steps: 1108 | Train Loss: 0.1625267 Vali Loss: 0.1430878 Test Loss: 0.1673937
Validation loss decreased (0.144158 --> 0.143088).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.1964611
	speed: 0.2437s/iter; left time: 3486.3194s
	iters: 200, epoch: 8 | loss: 0.1802551
	speed: 0.0853s/iter; left time: 1211.0855s
	iters: 300, epoch: 8 | loss: 0.1591206
	speed: 0.0845s/iter; left time: 1191.7700s
	iters: 400, epoch: 8 | loss: 0.1446975
	speed: 0.0850s/iter; left time: 1190.4719s
	iters: 500, epoch: 8 | loss: 0.1519070
	speed: 0.0858s/iter; left time: 1193.2858s
	iters: 600, epoch: 8 | loss: 0.1695004
	speed: 0.0861s/iter; left time: 1189.2874s
	iters: 700, epoch: 8 | loss: 0.1595510
	speed: 0.0851s/iter; left time: 1166.8573s
	iters: 800, epoch: 8 | loss: 0.1471656
	speed: 0.0848s/iter; left time: 1154.2198s
	iters: 900, epoch: 8 | loss: 0.1418414
	speed: 0.0858s/iter; left time: 1158.7074s
	iters: 1000, epoch: 8 | loss: 0.1588212
	speed: 0.0881s/iter; left time: 1181.6479s
	iters: 1100, epoch: 8 | loss: 0.1840625
	speed: 0.0894s/iter; left time: 1189.2339s
Epoch: 8 cost time: 95.42696905136108
Epoch: 8, Steps: 1108 | Train Loss: 0.1611388 Vali Loss: 0.1418189 Test Loss: 0.1660337
Validation loss decreased (0.143088 --> 0.141819).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.2052624
	speed: 0.2444s/iter; left time: 3225.6271s
	iters: 200, epoch: 9 | loss: 0.1496416
	speed: 0.0838s/iter; left time: 1097.0293s
	iters: 300, epoch: 9 | loss: 0.1383362
	speed: 0.0846s/iter; left time: 1100.1501s
	iters: 400, epoch: 9 | loss: 0.1645215
	speed: 0.0845s/iter; left time: 1090.0504s
	iters: 500, epoch: 9 | loss: 0.1670528
	speed: 0.0848s/iter; left time: 1084.8651s
	iters: 600, epoch: 9 | loss: 0.2011267
	speed: 0.0840s/iter; left time: 1066.6774s
	iters: 700, epoch: 9 | loss: 0.1633960
	speed: 0.0844s/iter; left time: 1063.5512s
	iters: 800, epoch: 9 | loss: 0.1423564
	speed: 0.0841s/iter; left time: 1050.6153s
	iters: 900, epoch: 9 | loss: 0.1935786
	speed: 0.0838s/iter; left time: 1038.9972s
	iters: 1000, epoch: 9 | loss: 0.1658613
	speed: 0.0846s/iter; left time: 1040.6535s
	iters: 1100, epoch: 9 | loss: 0.1666186
	speed: 0.0875s/iter; left time: 1067.4556s
Epoch: 9 cost time: 93.77452874183655
Epoch: 9, Steps: 1108 | Train Loss: 0.1603557 Vali Loss: 0.1411229 Test Loss: 0.1655469
Validation loss decreased (0.141819 --> 0.141123).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.1607492
	speed: 0.2467s/iter; left time: 2982.7229s
	iters: 200, epoch: 10 | loss: 0.1647446
	speed: 0.0861s/iter; left time: 1031.8699s
	iters: 300, epoch: 10 | loss: 0.1446523
	speed: 0.0851s/iter; left time: 1011.6873s
	iters: 400, epoch: 10 | loss: 0.1802145
	speed: 0.0845s/iter; left time: 995.6361s
	iters: 500, epoch: 10 | loss: 0.1592151
	speed: 0.0849s/iter; left time: 992.8508s
	iters: 600, epoch: 10 | loss: 0.1577279
	speed: 0.0863s/iter; left time: 1000.2263s
	iters: 700, epoch: 10 | loss: 0.1460790
	speed: 0.0854s/iter; left time: 980.9051s
	iters: 800, epoch: 10 | loss: 0.1509764
	speed: 0.0854s/iter; left time: 973.0126s
	iters: 900, epoch: 10 | loss: 0.1674834
	speed: 0.0861s/iter; left time: 971.7382s
	iters: 1000, epoch: 10 | loss: 0.1471867
	speed: 0.0863s/iter; left time: 965.4145s
	iters: 1100, epoch: 10 | loss: 0.1435780
	speed: 0.0862s/iter; left time: 956.4152s
Epoch: 10 cost time: 95.07516765594482
Epoch: 10, Steps: 1108 | Train Loss: 0.1599771 Vali Loss: 0.1408906 Test Loss: 0.1654187
Validation loss decreased (0.141123 --> 0.140891).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.1419414
	speed: 0.2446s/iter; left time: 2685.6344s
	iters: 200, epoch: 11 | loss: 0.1401702
	speed: 0.0881s/iter; left time: 958.7589s
	iters: 300, epoch: 11 | loss: 0.1797997
	speed: 0.0854s/iter; left time: 921.1743s
	iters: 400, epoch: 11 | loss: 0.1502533
	speed: 0.0858s/iter; left time: 915.9608s
	iters: 500, epoch: 11 | loss: 0.1533454
	speed: 0.0864s/iter; left time: 914.6643s
	iters: 600, epoch: 11 | loss: 0.2142864
	speed: 0.0852s/iter; left time: 893.1277s
	iters: 700, epoch: 11 | loss: 0.1457697
	speed: 0.0852s/iter; left time: 884.8494s
	iters: 800, epoch: 11 | loss: 0.1290267
	speed: 0.0859s/iter; left time: 883.2097s
	iters: 900, epoch: 11 | loss: 0.1770345
	speed: 0.0864s/iter; left time: 879.2238s
	iters: 1000, epoch: 11 | loss: 0.1959964
	speed: 0.0845s/iter; left time: 852.2800s
	iters: 1100, epoch: 11 | loss: 0.1566036
	speed: 0.0850s/iter; left time: 847.9896s
Epoch: 11 cost time: 95.11839365959167
Epoch: 11, Steps: 1108 | Train Loss: 0.1597540 Vali Loss: 0.1408169 Test Loss: 0.1652022
Validation loss decreased (0.140891 --> 0.140817).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.1581274
	speed: 0.2455s/iter; left time: 2423.5417s
	iters: 200, epoch: 12 | loss: 0.1864461
	speed: 0.0878s/iter; left time: 858.0957s
	iters: 300, epoch: 12 | loss: 0.1475108
	speed: 0.0873s/iter; left time: 844.7920s
	iters: 400, epoch: 12 | loss: 0.1745596
	speed: 0.0850s/iter; left time: 813.7836s
	iters: 500, epoch: 12 | loss: 0.1374539
	speed: 0.0850s/iter; left time: 804.8072s
	iters: 600, epoch: 12 | loss: 0.1553231
	speed: 0.0854s/iter; left time: 800.0162s
	iters: 700, epoch: 12 | loss: 0.1462652
	speed: 0.0848s/iter; left time: 786.2601s
	iters: 800, epoch: 12 | loss: 0.1446729
	speed: 0.0846s/iter; left time: 775.7306s
	iters: 900, epoch: 12 | loss: 0.1594490
	speed: 0.0844s/iter; left time: 765.7194s
	iters: 1000, epoch: 12 | loss: 0.1921334
	speed: 0.0845s/iter; left time: 758.0228s
	iters: 1100, epoch: 12 | loss: 0.2095784
	speed: 0.0842s/iter; left time: 746.9849s
Epoch: 12 cost time: 94.88277554512024
Epoch: 12, Steps: 1108 | Train Loss: 0.1596769 Vali Loss: 0.1407357 Test Loss: 0.1651615
Validation loss decreased (0.140817 --> 0.140736).  Saving model ...
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.1403100
	speed: 0.2626s/iter; left time: 2301.7290s
	iters: 200, epoch: 13 | loss: 0.1669214
	speed: 0.0869s/iter; left time: 752.8287s
	iters: 300, epoch: 13 | loss: 0.1491544
	speed: 0.0858s/iter; left time: 735.0026s
	iters: 400, epoch: 13 | loss: 0.1584413
	speed: 0.0881s/iter; left time: 745.8340s
	iters: 500, epoch: 13 | loss: 0.1740678
	speed: 0.0857s/iter; left time: 716.7351s
	iters: 600, epoch: 13 | loss: 0.1819559
	speed: 0.0850s/iter; left time: 702.1278s
	iters: 700, epoch: 13 | loss: 0.1436193
	speed: 0.0854s/iter; left time: 697.3567s
	iters: 800, epoch: 13 | loss: 0.1317939
	speed: 0.0850s/iter; left time: 685.8688s
	iters: 900, epoch: 13 | loss: 0.1513190
	speed: 0.0863s/iter; left time: 687.7406s
	iters: 1000, epoch: 13 | loss: 0.1406656
	speed: 0.0859s/iter; left time: 675.8255s
	iters: 1100, epoch: 13 | loss: 0.1641771
	speed: 0.0862s/iter; left time: 669.5344s
Epoch: 13 cost time: 95.49325203895569
Epoch: 13, Steps: 1108 | Train Loss: 0.1595832 Vali Loss: 0.1407812 Test Loss: 0.1651183
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.1322586
	speed: 0.2361s/iter; left time: 1808.1681s
	iters: 200, epoch: 14 | loss: 0.1448333
	speed: 0.0920s/iter; left time: 694.9902s
	iters: 300, epoch: 14 | loss: 0.1625962
	speed: 0.0857s/iter; left time: 639.0989s
	iters: 400, epoch: 14 | loss: 0.1592764
	speed: 0.0893s/iter; left time: 656.8730s
	iters: 500, epoch: 14 | loss: 0.1823941
	speed: 0.0887s/iter; left time: 643.9651s
	iters: 600, epoch: 14 | loss: 0.1288568
	speed: 0.0865s/iter; left time: 618.7768s
	iters: 700, epoch: 14 | loss: 0.1351440
	speed: 0.0862s/iter; left time: 608.6113s
	iters: 800, epoch: 14 | loss: 0.1535893
	speed: 0.0858s/iter; left time: 596.9952s
	iters: 900, epoch: 14 | loss: 0.1502880
	speed: 0.0859s/iter; left time: 588.7211s
	iters: 1000, epoch: 14 | loss: 0.1380357
	speed: 0.0859s/iter; left time: 580.5608s
	iters: 1100, epoch: 14 | loss: 0.1578625
	speed: 0.0856s/iter; left time: 569.5600s
Epoch: 14 cost time: 97.19971942901611
Epoch: 14, Steps: 1108 | Train Loss: 0.1595749 Vali Loss: 0.1407620 Test Loss: 0.1651299
EarlyStopping counter: 2 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.1810604
	speed: 0.2253s/iter; left time: 1475.5860s
	iters: 200, epoch: 15 | loss: 0.1568484
	speed: 0.0865s/iter; left time: 557.7945s
	iters: 300, epoch: 15 | loss: 0.1340096
	speed: 0.0851s/iter; left time: 540.3636s
	iters: 400, epoch: 15 | loss: 0.1946439
	speed: 0.0892s/iter; left time: 557.3716s
	iters: 500, epoch: 15 | loss: 0.1448278
	speed: 0.0919s/iter; left time: 564.9412s
	iters: 600, epoch: 15 | loss: 0.1488373
	speed: 0.0877s/iter; left time: 530.5628s
	iters: 700, epoch: 15 | loss: 0.1526736
	speed: 0.0862s/iter; left time: 512.7482s
	iters: 800, epoch: 15 | loss: 0.1466864
	speed: 0.0845s/iter; left time: 494.1344s
	iters: 900, epoch: 15 | loss: 0.1424561
	speed: 0.0848s/iter; left time: 487.6088s
	iters: 1000, epoch: 15 | loss: 0.1441947
	speed: 0.0851s/iter; left time: 480.6367s
	iters: 1100, epoch: 15 | loss: 0.1665607
	speed: 0.0851s/iter; left time: 472.0446s
Epoch: 15 cost time: 95.7341058254242
Epoch: 15, Steps: 1108 | Train Loss: 0.1595580 Vali Loss: 0.1407145 Test Loss: 0.1651180
Validation loss decreased (0.140736 --> 0.140715).  Saving model ...
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.1613009
	speed: 0.2405s/iter; left time: 1308.5514s
	iters: 200, epoch: 16 | loss: 0.1645645
	speed: 0.0839s/iter; left time: 447.9608s
	iters: 300, epoch: 16 | loss: 0.1619942
	speed: 0.0846s/iter; left time: 443.6217s
	iters: 400, epoch: 16 | loss: 0.1598285
	speed: 0.0851s/iter; left time: 437.4219s
	iters: 500, epoch: 16 | loss: 0.1815939
	speed: 0.0861s/iter; left time: 433.8166s
	iters: 600, epoch: 16 | loss: 0.1743923
	speed: 0.0844s/iter; left time: 417.0228s
	iters: 700, epoch: 16 | loss: 0.1584703
	speed: 0.0869s/iter; left time: 420.8877s
	iters: 800, epoch: 16 | loss: 0.1718333
	speed: 0.0854s/iter; left time: 405.0132s
	iters: 900, epoch: 16 | loss: 0.1557497
	speed: 0.0857s/iter; left time: 397.7883s
	iters: 1000, epoch: 16 | loss: 0.1379995
	speed: 0.0848s/iter; left time: 385.0921s
	iters: 1100, epoch: 16 | loss: 0.1583223
	speed: 0.0844s/iter; left time: 374.9735s
Epoch: 16 cost time: 94.37894558906555
Epoch: 16, Steps: 1108 | Train Loss: 0.1595324 Vali Loss: 0.1406878 Test Loss: 0.1651171
Validation loss decreased (0.140715 --> 0.140688).  Saving model ...
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 17 | loss: 0.1820931
	speed: 0.2404s/iter; left time: 1041.4466s
	iters: 200, epoch: 17 | loss: 0.1766106
	speed: 0.0855s/iter; left time: 361.8680s
	iters: 300, epoch: 17 | loss: 0.1354728
	speed: 0.0869s/iter; left time: 359.2892s
	iters: 400, epoch: 17 | loss: 0.1856804
	speed: 0.0864s/iter; left time: 348.6177s
	iters: 500, epoch: 17 | loss: 0.1671193
	speed: 0.0860s/iter; left time: 338.3307s
	iters: 600, epoch: 17 | loss: 0.1425484
	speed: 0.0867s/iter; left time: 332.4330s
	iters: 700, epoch: 17 | loss: 0.1496721
	speed: 0.0861s/iter; left time: 321.3801s
	iters: 800, epoch: 17 | loss: 0.1493517
	speed: 0.0872s/iter; left time: 316.6860s
	iters: 900, epoch: 17 | loss: 0.1659364
	speed: 0.0873s/iter; left time: 308.2960s
	iters: 1000, epoch: 17 | loss: 0.1684301
	speed: 0.0848s/iter; left time: 291.2738s
	iters: 1100, epoch: 17 | loss: 0.1529499
	speed: 0.0864s/iter; left time: 288.0156s
Epoch: 17 cost time: 95.60714817047119
Epoch: 17, Steps: 1108 | Train Loss: 0.1595230 Vali Loss: 0.1406774 Test Loss: 0.1651165
Validation loss decreased (0.140688 --> 0.140677).  Saving model ...
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 18 | loss: 0.1484807
	speed: 0.2421s/iter; left time: 780.9094s
	iters: 200, epoch: 18 | loss: 0.1710492
	speed: 0.0858s/iter; left time: 268.1349s
	iters: 300, epoch: 18 | loss: 0.1390803
	speed: 0.0850s/iter; left time: 257.0173s
	iters: 400, epoch: 18 | loss: 0.1555636
	speed: 0.0857s/iter; left time: 250.5846s
	iters: 500, epoch: 18 | loss: 0.1403348
	speed: 0.0854s/iter; left time: 241.2775s
	iters: 600, epoch: 18 | loss: 0.1750582
	speed: 0.0852s/iter; left time: 232.1556s
	iters: 700, epoch: 18 | loss: 0.1468015
	speed: 0.0868s/iter; left time: 227.9802s
	iters: 800, epoch: 18 | loss: 0.1534683
	speed: 0.0879s/iter; left time: 221.8509s
	iters: 900, epoch: 18 | loss: 0.1738160
	speed: 0.0849s/iter; left time: 205.9159s
	iters: 1000, epoch: 18 | loss: 0.1466262
	speed: 0.0845s/iter; left time: 196.5730s
	iters: 1100, epoch: 18 | loss: 0.1600723
	speed: 0.0843s/iter; left time: 187.6410s
Epoch: 18 cost time: 94.91220688819885
Epoch: 18, Steps: 1108 | Train Loss: 0.1595443 Vali Loss: 0.1407737 Test Loss: 0.1651163
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 19 | loss: 0.1665280
	speed: 0.2243s/iter; left time: 474.8861s
	iters: 200, epoch: 19 | loss: 0.1269927
	speed: 0.0853s/iter; left time: 172.0377s
	iters: 300, epoch: 19 | loss: 0.1313961
	speed: 0.0842s/iter; left time: 161.4166s
	iters: 400, epoch: 19 | loss: 0.1408097
	speed: 0.0843s/iter; left time: 153.1207s
	iters: 500, epoch: 19 | loss: 0.1441124
	speed: 0.0854s/iter; left time: 146.6079s
	iters: 600, epoch: 19 | loss: 0.1518370
	speed: 0.0854s/iter; left time: 138.1632s
	iters: 700, epoch: 19 | loss: 0.1530551
	speed: 0.0855s/iter; left time: 129.6619s
	iters: 800, epoch: 19 | loss: 0.1477225
	speed: 0.0854s/iter; left time: 120.9851s
	iters: 900, epoch: 19 | loss: 0.1629333
	speed: 0.0850s/iter; left time: 111.9480s
	iters: 1000, epoch: 19 | loss: 0.1622862
	speed: 0.0899s/iter; left time: 109.3832s
	iters: 1100, epoch: 19 | loss: 0.1944529
	speed: 0.0860s/iter; left time: 96.0575s
Epoch: 19 cost time: 94.81687378883362
Epoch: 19, Steps: 1108 | Train Loss: 0.1595119 Vali Loss: 0.1407030 Test Loss: 0.1651161
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.9073486328125e-08
	iters: 100, epoch: 20 | loss: 0.1486312
	speed: 0.2256s/iter; left time: 227.6061s
	iters: 200, epoch: 20 | loss: 0.1615902
	speed: 0.0851s/iter; left time: 77.3913s
	iters: 300, epoch: 20 | loss: 0.1428663
	speed: 0.0852s/iter; left time: 68.9089s
	iters: 400, epoch: 20 | loss: 0.1726778
	speed: 0.0863s/iter; left time: 61.1878s
	iters: 500, epoch: 20 | loss: 0.1237173
	speed: 0.0862s/iter; left time: 52.5251s
	iters: 600, epoch: 20 | loss: 0.1835235
	speed: 0.0855s/iter; left time: 43.5317s
	iters: 700, epoch: 20 | loss: 0.1387216
	speed: 0.0850s/iter; left time: 34.7726s
	iters: 800, epoch: 20 | loss: 0.1545331
	speed: 0.0849s/iter; left time: 26.2426s
	iters: 900, epoch: 20 | loss: 0.1288308
	speed: 0.0853s/iter; left time: 17.8294s
	iters: 1000, epoch: 20 | loss: 0.1771211
	speed: 0.0872s/iter; left time: 9.5016s
	iters: 1100, epoch: 20 | loss: 0.1608198
	speed: 0.0879s/iter; left time: 0.7907s
Epoch: 20 cost time: 95.11052799224854
Epoch: 20, Steps: 1108 | Train Loss: 0.1595306 Vali Loss: 0.1407443 Test Loss: 0.1651161
EarlyStopping counter: 3 out of 5
Updating learning rate to 9.5367431640625e-09
>>>>>>>testing : Electricity_336_336_Linear_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed28649<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4925
mse:0.16499754786491394, mae:0.2633243203163147
