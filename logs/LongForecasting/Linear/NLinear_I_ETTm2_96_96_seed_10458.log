Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='NLinear', model_id='ETTm2_96_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=10458, seq_len=96, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTm2_96_96_NLinear_ETTm2_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed10458>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34369
data_set:  <data_provider.data_loader.Dataset_ETT_minute object at 0x00000119B3C30D68>
val 11425
data_set:  <data_provider.data_loader.Dataset_ETT_minute object at 0x0000011981107DD8>
test 11425
data_set:  <data_provider.data_loader.Dataset_ETT_minute object at 0x00000119B3C30128>
Total number of trainable parameters: 65184
Total number of parameters: 65184
	iters: 100, epoch: 1 | loss: 0.3178874
	speed: 0.0039s/iter; left time: 83.5184s
	iters: 200, epoch: 1 | loss: 0.5917724
	speed: 0.0033s/iter; left time: 69.7939s
	iters: 300, epoch: 1 | loss: 0.2880547
	speed: 0.0036s/iter; left time: 76.0970s
	iters: 400, epoch: 1 | loss: 0.3932179
	speed: 0.0030s/iter; left time: 62.5707s
	iters: 500, epoch: 1 | loss: 0.2182403
	speed: 0.0036s/iter; left time: 76.1084s
	iters: 600, epoch: 1 | loss: 0.1518784
	speed: 0.0038s/iter; left time: 79.4951s
	iters: 700, epoch: 1 | loss: 0.1763283
	speed: 0.0033s/iter; left time: 69.1902s
	iters: 800, epoch: 1 | loss: 0.3918455
	speed: 0.0039s/iter; left time: 81.4530s
	iters: 900, epoch: 1 | loss: 0.2929640
	speed: 0.0037s/iter; left time: 76.8915s
	iters: 1000, epoch: 1 | loss: 0.3689807
	speed: 0.0034s/iter; left time: 70.3908s
Epoch: 1 cost time: 3.827437162399292
Epoch: 1, Steps: 1074 | Train Loss: 0.2746163 Vali Loss: 0.1418070 Test Loss: 0.1946551
Validation loss decreased (inf --> 0.141807).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.1501017
	speed: 0.0163s/iter; left time: 330.0024s
	iters: 200, epoch: 2 | loss: 0.2087408
	speed: 0.0038s/iter; left time: 75.8200s
	iters: 300, epoch: 2 | loss: 0.1852616
	speed: 0.0036s/iter; left time: 72.7237s
	iters: 400, epoch: 2 | loss: 0.3534358
	speed: 0.0038s/iter; left time: 75.9646s
	iters: 500, epoch: 2 | loss: 0.1896874
	speed: 0.0027s/iter; left time: 53.5991s
	iters: 600, epoch: 2 | loss: 0.5658198
	speed: 0.0033s/iter; left time: 65.9817s
	iters: 700, epoch: 2 | loss: 0.1318464
	speed: 0.0038s/iter; left time: 74.6692s
	iters: 800, epoch: 2 | loss: 0.1558914
	speed: 0.0033s/iter; left time: 65.1268s
	iters: 900, epoch: 2 | loss: 0.2934208
	speed: 0.0028s/iter; left time: 55.5746s
	iters: 1000, epoch: 2 | loss: 0.1968600
	speed: 0.0029s/iter; left time: 55.3280s
Epoch: 2 cost time: 3.609537124633789
Epoch: 2, Steps: 1074 | Train Loss: 0.2716565 Vali Loss: 0.1331932 Test Loss: 0.1877241
Validation loss decreased (0.141807 --> 0.133193).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.1816298
	speed: 0.0198s/iter; left time: 381.6584s
	iters: 200, epoch: 3 | loss: 0.3777066
	speed: 0.0028s/iter; left time: 53.8200s
	iters: 300, epoch: 3 | loss: 0.1295262
	speed: 0.0028s/iter; left time: 53.5383s
	iters: 400, epoch: 3 | loss: 0.1564662
	speed: 0.0039s/iter; left time: 74.4223s
	iters: 500, epoch: 3 | loss: 0.2121923
	speed: 0.0032s/iter; left time: 59.6360s
	iters: 600, epoch: 3 | loss: 0.1578699
	speed: 0.0030s/iter; left time: 56.2892s
	iters: 700, epoch: 3 | loss: 0.1553824
	speed: 0.0043s/iter; left time: 79.5683s
	iters: 800, epoch: 3 | loss: 0.2527851
	speed: 0.0033s/iter; left time: 60.8764s
	iters: 900, epoch: 3 | loss: 0.1473179
	speed: 0.0039s/iter; left time: 72.0307s
	iters: 1000, epoch: 3 | loss: 0.1845548
	speed: 0.0041s/iter; left time: 74.4392s
Epoch: 3 cost time: 3.7186107635498047
Epoch: 3, Steps: 1074 | Train Loss: 0.2449813 Vali Loss: 0.1293948 Test Loss: 0.1896293
Validation loss decreased (0.133193 --> 0.129395).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.2996980
	speed: 0.0187s/iter; left time: 340.0659s
	iters: 200, epoch: 4 | loss: 0.1859758
	speed: 0.0033s/iter; left time: 59.6686s
	iters: 300, epoch: 4 | loss: 0.1477304
	speed: 0.0036s/iter; left time: 64.5842s
	iters: 400, epoch: 4 | loss: 0.3098848
	speed: 0.0042s/iter; left time: 75.3333s
	iters: 500, epoch: 4 | loss: 0.3516811
	speed: 0.0043s/iter; left time: 75.5606s
	iters: 600, epoch: 4 | loss: 0.1311974
	speed: 0.0040s/iter; left time: 69.9835s
	iters: 700, epoch: 4 | loss: 0.3780812
	speed: 0.0035s/iter; left time: 61.1776s
	iters: 800, epoch: 4 | loss: 0.3825328
	speed: 0.0036s/iter; left time: 62.9629s
	iters: 900, epoch: 4 | loss: 0.6872290
	speed: 0.0038s/iter; left time: 65.5595s
	iters: 1000, epoch: 4 | loss: 0.4010208
	speed: 0.0035s/iter; left time: 60.1823s
Epoch: 4 cost time: 4.105106830596924
Epoch: 4, Steps: 1074 | Train Loss: 0.2378723 Vali Loss: 0.1286545 Test Loss: 0.1812896
Validation loss decreased (0.129395 --> 0.128655).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.2762149
	speed: 0.0187s/iter; left time: 319.1127s
	iters: 200, epoch: 5 | loss: 0.1105131
	speed: 0.0038s/iter; left time: 64.1319s
	iters: 300, epoch: 5 | loss: 0.1692711
	speed: 0.0044s/iter; left time: 74.8698s
	iters: 400, epoch: 5 | loss: 0.2046612
	speed: 0.0033s/iter; left time: 56.1975s
	iters: 500, epoch: 5 | loss: 0.1980321
	speed: 0.0038s/iter; left time: 62.6004s
	iters: 600, epoch: 5 | loss: 0.1404865
	speed: 0.0044s/iter; left time: 72.5264s
	iters: 700, epoch: 5 | loss: 0.1379481
	speed: 0.0036s/iter; left time: 59.2614s
	iters: 800, epoch: 5 | loss: 0.1522739
	speed: 0.0030s/iter; left time: 48.7033s
	iters: 900, epoch: 5 | loss: 0.5448753
	speed: 0.0036s/iter; left time: 58.5105s
	iters: 1000, epoch: 5 | loss: 0.1668837
	speed: 0.0033s/iter; left time: 53.0802s
Epoch: 5 cost time: 3.9643752574920654
Epoch: 5, Steps: 1074 | Train Loss: 0.2334767 Vali Loss: 0.1240502 Test Loss: 0.1778485
Validation loss decreased (0.128655 --> 0.124050).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.2085678
	speed: 0.0188s/iter; left time: 301.5616s
	iters: 200, epoch: 6 | loss: 0.1060544
	speed: 0.0038s/iter; left time: 60.5253s
	iters: 300, epoch: 6 | loss: 0.1670941
	speed: 0.0044s/iter; left time: 69.4541s
	iters: 400, epoch: 6 | loss: 0.1419105
	speed: 0.0034s/iter; left time: 53.9921s
	iters: 500, epoch: 6 | loss: 0.2675281
	speed: 0.0034s/iter; left time: 53.6473s
	iters: 600, epoch: 6 | loss: 0.2534847
	speed: 0.0038s/iter; left time: 58.9473s
	iters: 700, epoch: 6 | loss: 0.1646198
	speed: 0.0030s/iter; left time: 46.3754s
	iters: 800, epoch: 6 | loss: 0.3673540
	speed: 0.0033s/iter; left time: 51.2893s
	iters: 900, epoch: 6 | loss: 0.1756824
	speed: 0.0036s/iter; left time: 54.6785s
	iters: 1000, epoch: 6 | loss: 0.3298058
	speed: 0.0042s/iter; left time: 63.6904s
Epoch: 6 cost time: 3.8779959678649902
Epoch: 6, Steps: 1074 | Train Loss: 0.2317442 Vali Loss: 0.1250922 Test Loss: 0.1772922
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.2066699
	speed: 0.0155s/iter; left time: 231.0630s
	iters: 200, epoch: 7 | loss: 0.1387678
	speed: 0.0028s/iter; left time: 41.7368s
	iters: 300, epoch: 7 | loss: 0.1451434
	speed: 0.0039s/iter; left time: 57.5936s
	iters: 400, epoch: 7 | loss: 0.3466050
	speed: 0.0034s/iter; left time: 50.3316s
	iters: 500, epoch: 7 | loss: 0.1168808
	speed: 0.0036s/iter; left time: 52.2173s
	iters: 600, epoch: 7 | loss: 0.1510360
	speed: 0.0038s/iter; left time: 54.1565s
	iters: 700, epoch: 7 | loss: 0.2075167
	speed: 0.0043s/iter; left time: 60.9607s
	iters: 800, epoch: 7 | loss: 0.1418801
	speed: 0.0035s/iter; left time: 49.5761s
	iters: 900, epoch: 7 | loss: 0.1458828
	speed: 0.0035s/iter; left time: 49.2624s
	iters: 1000, epoch: 7 | loss: 0.1460349
	speed: 0.0032s/iter; left time: 45.4882s
Epoch: 7 cost time: 3.733663558959961
Epoch: 7, Steps: 1074 | Train Loss: 0.2306370 Vali Loss: 0.1256928 Test Loss: 0.1778364
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.1058415
	speed: 0.0165s/iter; left time: 228.4046s
	iters: 200, epoch: 8 | loss: 0.1390318
	speed: 0.0033s/iter; left time: 45.1530s
	iters: 300, epoch: 8 | loss: 0.1283080
	speed: 0.0036s/iter; left time: 49.0817s
	iters: 400, epoch: 8 | loss: 0.3201123
	speed: 0.0042s/iter; left time: 57.2407s
	iters: 500, epoch: 8 | loss: 0.1861090
	speed: 0.0033s/iter; left time: 44.4289s
	iters: 600, epoch: 8 | loss: 0.5917775
	speed: 0.0039s/iter; left time: 51.9492s
	iters: 700, epoch: 8 | loss: 0.2315198
	speed: 0.0045s/iter; left time: 59.8209s
	iters: 800, epoch: 8 | loss: 0.1510019
	speed: 0.0030s/iter; left time: 39.5327s
	iters: 900, epoch: 8 | loss: 0.1657246
	speed: 0.0027s/iter; left time: 35.0611s
	iters: 1000, epoch: 8 | loss: 0.1779647
	speed: 0.0032s/iter; left time: 41.1050s
Epoch: 8 cost time: 3.812211751937866
Epoch: 8, Steps: 1074 | Train Loss: 0.2299687 Vali Loss: 0.1258581 Test Loss: 0.1776277
EarlyStopping counter: 3 out of 5
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.2684593
	speed: 0.0163s/iter; left time: 208.7010s
	iters: 200, epoch: 9 | loss: 0.3489331
	speed: 0.0044s/iter; left time: 55.6247s
	iters: 300, epoch: 9 | loss: 0.1817864
	speed: 0.0030s/iter; left time: 37.9161s
	iters: 400, epoch: 9 | loss: 0.2231900
	speed: 0.0033s/iter; left time: 41.5879s
	iters: 500, epoch: 9 | loss: 0.1570274
	speed: 0.0033s/iter; left time: 41.3272s
	iters: 600, epoch: 9 | loss: 0.2518542
	speed: 0.0045s/iter; left time: 55.7058s
	iters: 700, epoch: 9 | loss: 0.2226644
	speed: 0.0034s/iter; left time: 41.8742s
	iters: 800, epoch: 9 | loss: 0.1785694
	speed: 0.0042s/iter; left time: 51.0439s
	iters: 900, epoch: 9 | loss: 0.1685744
	speed: 0.0042s/iter; left time: 50.5393s
	iters: 1000, epoch: 9 | loss: 0.2087560
	speed: 0.0047s/iter; left time: 55.7757s
Epoch: 9 cost time: 4.172185897827148
Epoch: 9, Steps: 1074 | Train Loss: 0.2296779 Vali Loss: 0.1251325 Test Loss: 0.1769249
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.2506306
	speed: 0.0172s/iter; left time: 201.1019s
	iters: 200, epoch: 10 | loss: 0.1350895
	speed: 0.0036s/iter; left time: 41.9894s
	iters: 300, epoch: 10 | loss: 0.1936955
	speed: 0.0045s/iter; left time: 51.2531s
	iters: 400, epoch: 10 | loss: 0.2056090
	speed: 0.0034s/iter; left time: 38.3498s
	iters: 500, epoch: 10 | loss: 0.1197819
	speed: 0.0034s/iter; left time: 38.8906s
	iters: 600, epoch: 10 | loss: 0.2693904
	speed: 0.0039s/iter; left time: 43.8095s
	iters: 700, epoch: 10 | loss: 0.1510164
	speed: 0.0034s/iter; left time: 38.3031s
	iters: 800, epoch: 10 | loss: 0.4142209
	speed: 0.0035s/iter; left time: 38.3334s
	iters: 900, epoch: 10 | loss: 0.2060236
	speed: 0.0035s/iter; left time: 38.6680s
	iters: 1000, epoch: 10 | loss: 0.1922153
	speed: 0.0044s/iter; left time: 47.3345s
Epoch: 10 cost time: 3.9372146129608154
Epoch: 10, Steps: 1074 | Train Loss: 0.2295391 Vali Loss: 0.1249542 Test Loss: 0.1769899
EarlyStopping counter: 5 out of 5
Early stopping
Total training time: 50.1559 seconds
>>>>>>>testing : ETTm2_96_96_NLinear_ETTm2_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed10458<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
data_set:  <data_provider.data_loader.Dataset_ETT_minute object at 0x00000119F6551080>
mse:0.17808137834072113, mae:0.25705835223197937
