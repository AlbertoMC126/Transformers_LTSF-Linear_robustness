Args in experiment:
Namespace(activation='gelu', batch_size=8, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='exchange_rate.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=8, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='mse', lradj='type1', model='NLinear', model_id='Exchange_336_192', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=192, root_path='./dataset/', save_pred_values=False, seed=12890, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : Exchange_336_192_NLinear_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed12890>>>>>>>>>>>>>>>>>>>>>>>>>>
train 4784
val 569
test 1326
	iters: 100, epoch: 1 | loss: 0.3190492
	speed: 0.0043s/iter; left time: 50.7885s
	iters: 200, epoch: 1 | loss: 0.5321057
	speed: 0.0046s/iter; left time: 54.1009s
	iters: 300, epoch: 1 | loss: 0.3486061
	speed: 0.0038s/iter; left time: 44.3017s
	iters: 400, epoch: 1 | loss: 0.1944116
	speed: 0.0041s/iter; left time: 47.8802s
	iters: 500, epoch: 1 | loss: 0.1670941
	speed: 0.0041s/iter; left time: 46.6460s
Epoch: 1 cost time: 2.5007550716400146
Epoch: 1, Steps: 598 | Train Loss: 0.2456281 Vali Loss: 0.2482384 Test Loss: 0.1939289
Validation loss decreased (inf --> 0.248238).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1298224
	speed: 0.0106s/iter; left time: 119.5557s
	iters: 200, epoch: 2 | loss: 0.2177028
	speed: 0.0042s/iter; left time: 46.6903s
	iters: 300, epoch: 2 | loss: 0.1657134
	speed: 0.0037s/iter; left time: 41.3822s
	iters: 400, epoch: 2 | loss: 0.2456600
	speed: 0.0042s/iter; left time: 45.6373s
	iters: 500, epoch: 2 | loss: 0.1296690
	speed: 0.0046s/iter; left time: 49.7526s
Epoch: 2 cost time: 2.540653944015503
Epoch: 2, Steps: 598 | Train Loss: 0.2409431 Vali Loss: 0.2557552 Test Loss: 0.1961414
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1671900
	speed: 0.0090s/iter; left time: 96.4499s
	iters: 200, epoch: 3 | loss: 0.1702580
	speed: 0.0034s/iter; left time: 35.6041s
	iters: 300, epoch: 3 | loss: 0.2604452
	speed: 0.0037s/iter; left time: 38.6378s
	iters: 400, epoch: 3 | loss: 0.2881190
	speed: 0.0039s/iter; left time: 40.7180s
	iters: 500, epoch: 3 | loss: 0.3250864
	speed: 0.0040s/iter; left time: 41.5731s
Epoch: 3 cost time: 2.2092912197113037
Epoch: 3, Steps: 598 | Train Loss: 0.2353551 Vali Loss: 0.2503316 Test Loss: 0.1929459
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.3357406
	speed: 0.0100s/iter; left time: 100.2964s
	iters: 200, epoch: 4 | loss: 0.1926086
	speed: 0.0037s/iter; left time: 37.0166s
	iters: 300, epoch: 4 | loss: 0.2723391
	speed: 0.0036s/iter; left time: 35.0371s
	iters: 400, epoch: 4 | loss: 0.1839177
	speed: 0.0039s/iter; left time: 37.6850s
	iters: 500, epoch: 4 | loss: 0.1754680
	speed: 0.0040s/iter; left time: 38.7840s
Epoch: 4 cost time: 2.2555739879608154
Epoch: 4, Steps: 598 | Train Loss: 0.2319581 Vali Loss: 0.2457429 Test Loss: 0.1970269
Validation loss decreased (0.248238 --> 0.245743).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1579376
	speed: 0.0105s/iter; left time: 99.0863s
	iters: 200, epoch: 5 | loss: 0.2746620
	speed: 0.0044s/iter; left time: 40.9425s
	iters: 300, epoch: 5 | loss: 0.4045118
	speed: 0.0046s/iter; left time: 42.3887s
	iters: 400, epoch: 5 | loss: 0.1866685
	speed: 0.0044s/iter; left time: 40.7104s
	iters: 500, epoch: 5 | loss: 0.1590392
	speed: 0.0044s/iter; left time: 40.0162s
Epoch: 5 cost time: 2.613616704940796
Epoch: 5, Steps: 598 | Train Loss: 0.2308970 Vali Loss: 0.2463829 Test Loss: 0.1962351
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.2614696
	speed: 0.0109s/iter; left time: 97.0712s
	iters: 200, epoch: 6 | loss: 0.1547240
	speed: 0.0043s/iter; left time: 37.6824s
	iters: 300, epoch: 6 | loss: 0.1343905
	speed: 0.0044s/iter; left time: 37.9994s
	iters: 400, epoch: 6 | loss: 0.2225802
	speed: 0.0045s/iter; left time: 38.5747s
	iters: 500, epoch: 6 | loss: 0.1491055
	speed: 0.0035s/iter; left time: 29.8179s
Epoch: 6 cost time: 2.481376886367798
Epoch: 6, Steps: 598 | Train Loss: 0.2302217 Vali Loss: 0.2462096 Test Loss: 0.1961270
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.4254148
	speed: 0.0101s/iter; left time: 83.2477s
	iters: 200, epoch: 7 | loss: 0.1830397
	speed: 0.0036s/iter; left time: 29.4457s
	iters: 300, epoch: 7 | loss: 0.1439546
	speed: 0.0039s/iter; left time: 31.1619s
	iters: 400, epoch: 7 | loss: 0.1748740
	speed: 0.0042s/iter; left time: 33.7474s
	iters: 500, epoch: 7 | loss: 0.1915852
	speed: 0.0037s/iter; left time: 28.9726s
Epoch: 7 cost time: 2.3236067295074463
Epoch: 7, Steps: 598 | Train Loss: 0.2298402 Vali Loss: 0.2444961 Test Loss: 0.1954681
Validation loss decreased (0.245743 --> 0.244496).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.1478188
	speed: 0.0106s/iter; left time: 81.3752s
	iters: 200, epoch: 8 | loss: 0.2764310
	speed: 0.0045s/iter; left time: 33.8780s
	iters: 300, epoch: 8 | loss: 0.1444935
	speed: 0.0044s/iter; left time: 33.2636s
	iters: 400, epoch: 8 | loss: 0.2050090
	speed: 0.0046s/iter; left time: 34.0772s
	iters: 500, epoch: 8 | loss: 0.3757589
	speed: 0.0044s/iter; left time: 31.8188s
Epoch: 8 cost time: 2.6267285346984863
Epoch: 8, Steps: 598 | Train Loss: 0.2296228 Vali Loss: 0.2448638 Test Loss: 0.1967259
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.3704669
	speed: 0.0099s/iter; left time: 69.9360s
	iters: 200, epoch: 9 | loss: 0.2571073
	speed: 0.0039s/iter; left time: 27.0009s
	iters: 300, epoch: 9 | loss: 0.1224806
	speed: 0.0040s/iter; left time: 27.3215s
	iters: 400, epoch: 9 | loss: 0.1852332
	speed: 0.0044s/iter; left time: 29.8122s
	iters: 500, epoch: 9 | loss: 0.1439079
	speed: 0.0047s/iter; left time: 31.1973s
Epoch: 9 cost time: 2.5296409130096436
Epoch: 9, Steps: 598 | Train Loss: 0.2295133 Vali Loss: 0.2452519 Test Loss: 0.1961338
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.3397227
	speed: 0.0109s/iter; left time: 70.8411s
	iters: 200, epoch: 10 | loss: 0.2933810
	speed: 0.0043s/iter; left time: 27.1746s
	iters: 300, epoch: 10 | loss: 0.2883454
	speed: 0.0042s/iter; left time: 26.4345s
	iters: 400, epoch: 10 | loss: 0.1925253
	speed: 0.0042s/iter; left time: 25.6624s
	iters: 500, epoch: 10 | loss: 0.1386900
	speed: 0.0041s/iter; left time: 25.1670s
Epoch: 10 cost time: 2.528825044631958
Epoch: 10, Steps: 598 | Train Loss: 0.2294355 Vali Loss: 0.2450898 Test Loss: 0.1959107
EarlyStopping counter: 3 out of 5
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 11 | loss: 0.1903239
	speed: 0.0112s/iter; left time: 65.6971s
	iters: 200, epoch: 11 | loss: 0.5795498
	speed: 0.0047s/iter; left time: 27.3021s
	iters: 300, epoch: 11 | loss: 0.1899773
	speed: 0.0048s/iter; left time: 27.0984s
	iters: 400, epoch: 11 | loss: 0.2442818
	speed: 0.0046s/iter; left time: 25.9118s
	iters: 500, epoch: 11 | loss: 0.1596123
	speed: 0.0030s/iter; left time: 16.3334s
Epoch: 11 cost time: 2.454557180404663
Epoch: 11, Steps: 598 | Train Loss: 0.2294023 Vali Loss: 0.2451908 Test Loss: 0.1959373
EarlyStopping counter: 4 out of 5
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 12 | loss: 0.1587157
	speed: 0.0081s/iter; left time: 42.8083s
	iters: 200, epoch: 12 | loss: 0.1780035
	speed: 0.0045s/iter; left time: 23.4790s
	iters: 300, epoch: 12 | loss: 0.1498487
	speed: 0.0041s/iter; left time: 21.0548s
	iters: 400, epoch: 12 | loss: 0.0870486
	speed: 0.0040s/iter; left time: 19.7817s
	iters: 500, epoch: 12 | loss: 0.2992815
	speed: 0.0043s/iter; left time: 20.7636s
Epoch: 12 cost time: 2.474491596221924
Epoch: 12, Steps: 598 | Train Loss: 0.2293795 Vali Loss: 0.2448610 Test Loss: 0.1959138
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : Exchange_336_192_NLinear_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed12890<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 1326
mse:0.19542710483074188, mae:0.310038685798645
