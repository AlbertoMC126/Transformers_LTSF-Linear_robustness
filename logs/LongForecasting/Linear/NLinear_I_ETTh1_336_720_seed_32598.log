Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTh1', data_path='ETTh1.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='NLinear', model_id='ETTh1_336_720', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=720, root_path='./dataset/', save_pred_values=False, seed=32598, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTh1_336_720_NLinear_ETTh1_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed32598>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7585
val 2161
test 2161
	iters: 100, epoch: 1 | loss: 0.7021630
	speed: 0.0194s/iter; left time: 90.1811s
	iters: 200, epoch: 1 | loss: 0.6341287
	speed: 0.0192s/iter; left time: 87.1486s
Epoch: 1 cost time: 4.484509706497192
Epoch: 1, Steps: 237 | Train Loss: 0.6799695 Vali Loss: 1.6816711 Test Loss: 0.5292587
Validation loss decreased (inf --> 1.681671).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.6922010
	speed: 0.0305s/iter; left time: 134.1831s
	iters: 200, epoch: 2 | loss: 0.7302781
	speed: 0.0185s/iter; left time: 79.4110s
Epoch: 2 cost time: 4.2839272022247314
Epoch: 2, Steps: 237 | Train Loss: 0.6423855 Vali Loss: 1.8219577 Test Loss: 0.5555949
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.5728040
	speed: 0.0334s/iter; left time: 139.1108s
	iters: 200, epoch: 3 | loss: 0.5704032
	speed: 0.0180s/iter; left time: 73.0482s
Epoch: 3 cost time: 4.321085453033447
Epoch: 3, Steps: 237 | Train Loss: 0.5890961 Vali Loss: 1.5798194 Test Loss: 0.4945081
Validation loss decreased (1.681671 --> 1.579819).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.6833831
	speed: 0.0341s/iter; left time: 134.1499s
	iters: 200, epoch: 4 | loss: 0.5391697
	speed: 0.0193s/iter; left time: 74.0614s
Epoch: 4 cost time: 4.3687424659729
Epoch: 4, Steps: 237 | Train Loss: 0.5653857 Vali Loss: 1.5705268 Test Loss: 0.4715696
Validation loss decreased (1.579819 --> 1.570527).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.5550542
	speed: 0.0315s/iter; left time: 116.4602s
	iters: 200, epoch: 5 | loss: 0.4964595
	speed: 0.0211s/iter; left time: 75.9152s
Epoch: 5 cost time: 4.567361831665039
Epoch: 5, Steps: 237 | Train Loss: 0.5536044 Vali Loss: 1.5416116 Test Loss: 0.4618369
Validation loss decreased (1.570527 --> 1.541612).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.5344742
	speed: 0.0368s/iter; left time: 127.1658s
	iters: 200, epoch: 6 | loss: 0.5639418
	speed: 0.0183s/iter; left time: 61.5696s
Epoch: 6 cost time: 4.48092794418335
Epoch: 6, Steps: 237 | Train Loss: 0.5476441 Vali Loss: 1.5370629 Test Loss: 0.4598331
Validation loss decreased (1.541612 --> 1.537063).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.5549572
	speed: 0.0315s/iter; left time: 101.5568s
	iters: 200, epoch: 7 | loss: 0.4657430
	speed: 0.0199s/iter; left time: 62.1970s
Epoch: 7 cost time: 4.510460376739502
Epoch: 7, Steps: 237 | Train Loss: 0.5444519 Vali Loss: 1.5185312 Test Loss: 0.4556436
Validation loss decreased (1.537063 --> 1.518531).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.5451701
	speed: 0.0330s/iter; left time: 98.3824s
	iters: 200, epoch: 8 | loss: 0.5812073
	speed: 0.0185s/iter; left time: 53.3523s
Epoch: 8 cost time: 4.409114360809326
Epoch: 8, Steps: 237 | Train Loss: 0.5426113 Vali Loss: 1.5185423 Test Loss: 0.4540569
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.5576900
	speed: 0.0292s/iter; left time: 80.1092s
	iters: 200, epoch: 9 | loss: 0.5206308
	speed: 0.0167s/iter; left time: 44.2874s
Epoch: 9 cost time: 3.930093288421631
Epoch: 9, Steps: 237 | Train Loss: 0.5417267 Vali Loss: 1.5192486 Test Loss: 0.4533823
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.5072473
	speed: 0.0342s/iter; left time: 85.6665s
	iters: 200, epoch: 10 | loss: 0.6177788
	speed: 0.0175s/iter; left time: 42.0327s
Epoch: 10 cost time: 4.308586359024048
Epoch: 10, Steps: 237 | Train Loss: 0.5411938 Vali Loss: 1.5172971 Test Loss: 0.4535829
Validation loss decreased (1.518531 --> 1.517297).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.5509188
	speed: 0.0349s/iter; left time: 79.1612s
	iters: 200, epoch: 11 | loss: 0.5391558
	speed: 0.0194s/iter; left time: 42.0892s
Epoch: 11 cost time: 4.43221640586853
Epoch: 11, Steps: 237 | Train Loss: 0.5409193 Vali Loss: 1.5170871 Test Loss: 0.4534968
Validation loss decreased (1.517297 --> 1.517087).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.5991436
	speed: 0.0315s/iter; left time: 64.0943s
	iters: 200, epoch: 12 | loss: 0.5836815
	speed: 0.0188s/iter; left time: 36.4127s
Epoch: 12 cost time: 4.17887806892395
Epoch: 12, Steps: 237 | Train Loss: 0.5406901 Vali Loss: 1.5154736 Test Loss: 0.4534613
Validation loss decreased (1.517087 --> 1.515474).  Saving model ...
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.4561565
	speed: 0.0323s/iter; left time: 57.9651s
	iters: 200, epoch: 13 | loss: 0.5105972
	speed: 0.0172s/iter; left time: 29.2522s
Epoch: 13 cost time: 4.041134834289551
Epoch: 13, Steps: 237 | Train Loss: 0.5405857 Vali Loss: 1.5166148 Test Loss: 0.4534352
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.5857348
	speed: 0.0326s/iter; left time: 50.8459s
	iters: 200, epoch: 14 | loss: 0.5344257
	speed: 0.0155s/iter; left time: 22.6682s
Epoch: 14 cost time: 3.7765514850616455
Epoch: 14, Steps: 237 | Train Loss: 0.5405855 Vali Loss: 1.5149492 Test Loss: 0.4534153
Validation loss decreased (1.515474 --> 1.514949).  Saving model ...
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.5138838
	speed: 0.0274s/iter; left time: 36.2534s
	iters: 200, epoch: 15 | loss: 0.5719280
	speed: 0.0147s/iter; left time: 18.0003s
Epoch: 15 cost time: 3.4597232341766357
Epoch: 15, Steps: 237 | Train Loss: 0.5405955 Vali Loss: 1.5150833 Test Loss: 0.4534052
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.5576301
	speed: 0.0262s/iter; left time: 28.4273s
	iters: 200, epoch: 16 | loss: 0.6064283
	speed: 0.0137s/iter; left time: 13.5533s
Epoch: 16 cost time: 3.3139593601226807
Epoch: 16, Steps: 237 | Train Loss: 0.5405088 Vali Loss: 1.5158949 Test Loss: 0.4534063
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 17 | loss: 0.5290937
	speed: 0.0253s/iter; left time: 21.4877s
	iters: 200, epoch: 17 | loss: 0.5370863
	speed: 0.0134s/iter; left time: 10.0350s
Epoch: 17 cost time: 3.2182705402374268
Epoch: 17, Steps: 237 | Train Loss: 0.5405595 Vali Loss: 1.5156807 Test Loss: 0.4534021
EarlyStopping counter: 3 out of 5
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 18 | loss: 0.4838389
	speed: 0.0236s/iter; left time: 14.4348s
	iters: 200, epoch: 18 | loss: 0.5454618
	speed: 0.0126s/iter; left time: 6.4577s
Epoch: 18 cost time: 2.992913246154785
Epoch: 18, Steps: 237 | Train Loss: 0.5405452 Vali Loss: 1.5143853 Test Loss: 0.4534029
Validation loss decreased (1.514949 --> 1.514385).  Saving model ...
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 19 | loss: 0.5776137
	speed: 0.0236s/iter; left time: 8.8589s
	iters: 200, epoch: 19 | loss: 0.5459565
	speed: 0.0126s/iter; left time: 3.4768s
Epoch: 19 cost time: 2.9843482971191406
Epoch: 19, Steps: 237 | Train Loss: 0.5405610 Vali Loss: 1.5158825 Test Loss: 0.4534018
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.9073486328125e-08
	iters: 100, epoch: 20 | loss: 0.6085724
	speed: 0.0198s/iter; left time: 2.7292s
	iters: 200, epoch: 20 | loss: 0.5226235
	speed: 0.0083s/iter; left time: 0.3163s
Epoch: 20 cost time: 2.246891975402832
Epoch: 20, Steps: 237 | Train Loss: 0.5405379 Vali Loss: 1.5155441 Test Loss: 0.4534018
EarlyStopping counter: 2 out of 5
Updating learning rate to 9.5367431640625e-09
>>>>>>>testing : ETTh1_336_720_NLinear_ETTh1_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed32598<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
mse:0.4523006081581116, mae:0.45963481068611145
