Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='Linear', model_id='ETTm2_336_192', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=192, root_path='./dataset/', save_pred_values=False, seed=12890, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTm2_336_192_Linear_ETTm2_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed12890>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34033
val 11329
test 11329
	iters: 100, epoch: 1 | loss: 0.2885946
	speed: 0.0063s/iter; left time: 133.5732s
	iters: 200, epoch: 1 | loss: 0.5251963
	speed: 0.0057s/iter; left time: 119.4219s
	iters: 300, epoch: 1 | loss: 0.4213632
	speed: 0.0056s/iter; left time: 117.4230s
	iters: 400, epoch: 1 | loss: 0.3172840
	speed: 0.0067s/iter; left time: 140.6580s
	iters: 500, epoch: 1 | loss: 0.3302113
	speed: 0.0067s/iter; left time: 139.5145s
	iters: 600, epoch: 1 | loss: 0.3438944
	speed: 0.0059s/iter; left time: 122.8083s
	iters: 700, epoch: 1 | loss: 0.6132767
	speed: 0.0057s/iter; left time: 116.7864s
	iters: 800, epoch: 1 | loss: 0.4170020
	speed: 0.0057s/iter; left time: 115.8708s
	iters: 900, epoch: 1 | loss: 0.6449426
	speed: 0.0063s/iter; left time: 128.6430s
	iters: 1000, epoch: 1 | loss: 0.7223851
	speed: 0.0063s/iter; left time: 128.4551s
Epoch: 1 cost time: 6.478494167327881
Epoch: 1, Steps: 1063 | Train Loss: 0.4874386 Vali Loss: 0.4111873 Test Loss: 0.9037759
Validation loss decreased (inf --> 0.411187).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.4842724
	speed: 0.0227s/iter; left time: 455.5424s
	iters: 200, epoch: 2 | loss: 0.6699479
	speed: 0.0053s/iter; left time: 105.8667s
	iters: 300, epoch: 2 | loss: 0.7967593
	speed: 0.0051s/iter; left time: 102.2757s
	iters: 400, epoch: 2 | loss: 0.7857933
	speed: 0.0056s/iter; left time: 110.9203s
	iters: 500, epoch: 2 | loss: 0.7998711
	speed: 0.0056s/iter; left time: 109.9860s
	iters: 600, epoch: 2 | loss: 0.4492069
	speed: 0.0049s/iter; left time: 95.2467s
	iters: 700, epoch: 2 | loss: 0.2357537
	speed: 0.0047s/iter; left time: 91.6949s
	iters: 800, epoch: 2 | loss: 0.4515102
	speed: 0.0060s/iter; left time: 115.5784s
	iters: 900, epoch: 2 | loss: 0.7308161
	speed: 0.0057s/iter; left time: 109.4980s
	iters: 1000, epoch: 2 | loss: 0.4394192
	speed: 0.0062s/iter; left time: 119.6135s
Epoch: 2 cost time: 5.729781627655029
Epoch: 2, Steps: 1063 | Train Loss: 0.5054977 Vali Loss: 0.3426790 Test Loss: 0.5392724
Validation loss decreased (0.411187 --> 0.342679).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.2825021
	speed: 0.0255s/iter; left time: 485.3455s
	iters: 200, epoch: 3 | loss: 0.6457807
	speed: 0.0060s/iter; left time: 114.0478s
	iters: 300, epoch: 3 | loss: 0.2562238
	speed: 0.0061s/iter; left time: 115.8020s
	iters: 400, epoch: 3 | loss: 0.2483689
	speed: 0.0052s/iter; left time: 97.6523s
	iters: 500, epoch: 3 | loss: 0.3911386
	speed: 0.0057s/iter; left time: 106.9653s
	iters: 600, epoch: 3 | loss: 0.1965911
	speed: 0.0062s/iter; left time: 115.4827s
	iters: 700, epoch: 3 | loss: 0.2383157
	speed: 0.0059s/iter; left time: 109.5043s
	iters: 800, epoch: 3 | loss: 0.2281958
	speed: 0.0060s/iter; left time: 109.7206s
	iters: 900, epoch: 3 | loss: 0.6022167
	speed: 0.0055s/iter; left time: 100.8897s
	iters: 1000, epoch: 3 | loss: 0.5518076
	speed: 0.0054s/iter; left time: 98.2918s
Epoch: 3 cost time: 6.138348340988159
Epoch: 3, Steps: 1063 | Train Loss: 0.3516361 Vali Loss: 0.2762090 Test Loss: 0.5503431
Validation loss decreased (0.342679 --> 0.276209).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.2898461
	speed: 0.0224s/iter; left time: 401.7693s
	iters: 200, epoch: 4 | loss: 0.2407756
	speed: 0.0055s/iter; left time: 97.9896s
	iters: 300, epoch: 4 | loss: 0.3826831
	speed: 0.0062s/iter; left time: 110.9142s
	iters: 400, epoch: 4 | loss: 0.2041520
	speed: 0.0064s/iter; left time: 112.5627s
	iters: 500, epoch: 4 | loss: 0.2705579
	speed: 0.0051s/iter; left time: 90.1890s
	iters: 600, epoch: 4 | loss: 0.1785148
	speed: 0.0049s/iter; left time: 86.1371s
	iters: 700, epoch: 4 | loss: 0.2060590
	speed: 0.0047s/iter; left time: 81.5244s
	iters: 800, epoch: 4 | loss: 0.5126248
	speed: 0.0041s/iter; left time: 70.8156s
	iters: 900, epoch: 4 | loss: 0.3893922
	speed: 0.0044s/iter; left time: 75.5568s
	iters: 1000, epoch: 4 | loss: 0.2457245
	speed: 0.0056s/iter; left time: 95.2822s
Epoch: 4 cost time: 5.556000709533691
Epoch: 4, Steps: 1063 | Train Loss: 0.3121227 Vali Loss: 0.2839359 Test Loss: 0.5535312
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.1778599
	speed: 0.0224s/iter; left time: 379.5282s
	iters: 200, epoch: 5 | loss: 0.5851258
	speed: 0.0055s/iter; left time: 92.8295s
	iters: 300, epoch: 5 | loss: 0.8672444
	speed: 0.0062s/iter; left time: 102.9277s
	iters: 400, epoch: 5 | loss: 0.2910100
	speed: 0.0055s/iter; left time: 91.7426s
	iters: 500, epoch: 5 | loss: 0.2568413
	speed: 0.0055s/iter; left time: 91.1897s
	iters: 600, epoch: 5 | loss: 0.1891244
	speed: 0.0056s/iter; left time: 91.2340s
	iters: 700, epoch: 5 | loss: 0.2044222
	speed: 0.0057s/iter; left time: 92.8495s
	iters: 800, epoch: 5 | loss: 0.3281557
	speed: 0.0066s/iter; left time: 107.4658s
	iters: 900, epoch: 5 | loss: 0.3602247
	speed: 0.0067s/iter; left time: 108.4777s
	iters: 1000, epoch: 5 | loss: 0.4239170
	speed: 0.0067s/iter; left time: 106.5067s
Epoch: 5 cost time: 6.416292428970337
Epoch: 5, Steps: 1063 | Train Loss: 0.2950436 Vali Loss: 0.2162589 Test Loss: 0.3847741
Validation loss decreased (0.276209 --> 0.216259).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.2070786
	speed: 0.0235s/iter; left time: 371.8873s
	iters: 200, epoch: 6 | loss: 0.2176992
	speed: 0.0060s/iter; left time: 94.1938s
	iters: 300, epoch: 6 | loss: 0.2668749
	speed: 0.0051s/iter; left time: 79.4590s
	iters: 400, epoch: 6 | loss: 0.3679141
	speed: 0.0050s/iter; left time: 77.1433s
	iters: 500, epoch: 6 | loss: 0.2620092
	speed: 0.0049s/iter; left time: 74.9132s
	iters: 600, epoch: 6 | loss: 0.2109931
	speed: 0.0063s/iter; left time: 96.3959s
	iters: 700, epoch: 6 | loss: 0.4945681
	speed: 0.0062s/iter; left time: 94.5252s
	iters: 800, epoch: 6 | loss: 0.2585956
	speed: 0.0062s/iter; left time: 93.3411s
	iters: 900, epoch: 6 | loss: 0.1360296
	speed: 0.0060s/iter; left time: 90.7833s
	iters: 1000, epoch: 6 | loss: 0.4325504
	speed: 0.0058s/iter; left time: 87.1437s
Epoch: 6 cost time: 5.9952075481414795
Epoch: 6, Steps: 1063 | Train Loss: 0.2857918 Vali Loss: 0.1931015 Test Loss: 0.3209409
Validation loss decreased (0.216259 --> 0.193102).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.2360942
	speed: 0.0221s/iter; left time: 327.3868s
	iters: 200, epoch: 7 | loss: 0.2155832
	speed: 0.0046s/iter; left time: 67.7358s
	iters: 300, epoch: 7 | loss: 0.3894741
	speed: 0.0044s/iter; left time: 63.5818s
	iters: 400, epoch: 7 | loss: 0.1843781
	speed: 0.0051s/iter; left time: 73.1786s
	iters: 500, epoch: 7 | loss: 0.2185174
	speed: 0.0053s/iter; left time: 76.5268s
	iters: 600, epoch: 7 | loss: 0.2384903
	speed: 0.0058s/iter; left time: 83.3177s
	iters: 700, epoch: 7 | loss: 0.3090365
	speed: 0.0059s/iter; left time: 83.5495s
	iters: 800, epoch: 7 | loss: 0.2049911
	speed: 0.0057s/iter; left time: 80.7422s
	iters: 900, epoch: 7 | loss: 0.1977664
	speed: 0.0053s/iter; left time: 73.5912s
	iters: 1000, epoch: 7 | loss: 0.1833421
	speed: 0.0058s/iter; left time: 79.9038s
Epoch: 7 cost time: 5.644503593444824
Epoch: 7, Steps: 1063 | Train Loss: 0.2801975 Vali Loss: 0.2154520 Test Loss: 0.3907880
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.5273880
	speed: 0.0248s/iter; left time: 340.2325s
	iters: 200, epoch: 8 | loss: 0.4379393
	speed: 0.0048s/iter; left time: 64.9675s
	iters: 300, epoch: 8 | loss: 0.4577630
	speed: 0.0049s/iter; left time: 66.8173s
	iters: 400, epoch: 8 | loss: 0.2935856
	speed: 0.0050s/iter; left time: 67.1068s
	iters: 500, epoch: 8 | loss: 0.2818756
	speed: 0.0047s/iter; left time: 63.1647s
	iters: 600, epoch: 8 | loss: 0.2593044
	speed: 0.0052s/iter; left time: 68.4796s
	iters: 700, epoch: 8 | loss: 0.2042043
	speed: 0.0053s/iter; left time: 69.6730s
	iters: 800, epoch: 8 | loss: 0.5078029
	speed: 0.0060s/iter; left time: 77.8598s
	iters: 900, epoch: 8 | loss: 0.2223097
	speed: 0.0055s/iter; left time: 71.6202s
	iters: 1000, epoch: 8 | loss: 0.1868171
	speed: 0.0063s/iter; left time: 81.2784s
Epoch: 8 cost time: 5.682404279708862
Epoch: 8, Steps: 1063 | Train Loss: 0.2773653 Vali Loss: 0.1839032 Test Loss: 0.3017159
Validation loss decreased (0.193102 --> 0.183903).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.1419002
	speed: 0.0248s/iter; left time: 313.7268s
	iters: 200, epoch: 9 | loss: 0.3152066
	speed: 0.0058s/iter; left time: 72.8498s
	iters: 300, epoch: 9 | loss: 0.4195022
	speed: 0.0053s/iter; left time: 66.1466s
	iters: 400, epoch: 9 | loss: 0.2689501
	speed: 0.0053s/iter; left time: 65.1397s
	iters: 500, epoch: 9 | loss: 0.4620792
	speed: 0.0049s/iter; left time: 60.5492s
	iters: 600, epoch: 9 | loss: 0.4809406
	speed: 0.0054s/iter; left time: 65.3291s
	iters: 700, epoch: 9 | loss: 0.2926403
	speed: 0.0048s/iter; left time: 57.6325s
	iters: 800, epoch: 9 | loss: 0.3495967
	speed: 0.0048s/iter; left time: 56.8294s
	iters: 900, epoch: 9 | loss: 0.2181686
	speed: 0.0047s/iter; left time: 56.3202s
	iters: 1000, epoch: 9 | loss: 0.2856118
	speed: 0.0049s/iter; left time: 57.0457s
Epoch: 9 cost time: 5.510531902313232
Epoch: 9, Steps: 1063 | Train Loss: 0.2758985 Vali Loss: 0.1982301 Test Loss: 0.3438537
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.1788177
	speed: 0.0235s/iter; left time: 272.2954s
	iters: 200, epoch: 10 | loss: 0.1940231
	speed: 0.0059s/iter; left time: 67.4700s
	iters: 300, epoch: 10 | loss: 0.2469282
	speed: 0.0054s/iter; left time: 62.0162s
	iters: 400, epoch: 10 | loss: 0.4485706
	speed: 0.0055s/iter; left time: 62.4784s
	iters: 500, epoch: 10 | loss: 0.2004717
	speed: 0.0047s/iter; left time: 52.9291s
	iters: 600, epoch: 10 | loss: 0.4181760
	speed: 0.0059s/iter; left time: 65.9192s
	iters: 700, epoch: 10 | loss: 0.1928385
	speed: 0.0063s/iter; left time: 68.8658s
	iters: 800, epoch: 10 | loss: 0.3054737
	speed: 0.0055s/iter; left time: 59.9477s
	iters: 900, epoch: 10 | loss: 0.1967112
	speed: 0.0056s/iter; left time: 60.2305s
	iters: 1000, epoch: 10 | loss: 0.4055225
	speed: 0.0050s/iter; left time: 53.6035s
Epoch: 10 cost time: 5.884798288345337
Epoch: 10, Steps: 1063 | Train Loss: 0.2751363 Vali Loss: 0.1910253 Test Loss: 0.3235939
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.1868875
	speed: 0.0260s/iter; left time: 274.1623s
	iters: 200, epoch: 11 | loss: 0.3308750
	speed: 0.0058s/iter; left time: 60.6576s
	iters: 300, epoch: 11 | loss: 0.1934239
	speed: 0.0064s/iter; left time: 65.7274s
	iters: 400, epoch: 11 | loss: 0.2169997
	speed: 0.0053s/iter; left time: 54.4334s
	iters: 500, epoch: 11 | loss: 0.2405574
	speed: 0.0056s/iter; left time: 57.1691s
	iters: 600, epoch: 11 | loss: 0.1668325
	speed: 0.0050s/iter; left time: 50.5633s
	iters: 700, epoch: 11 | loss: 0.5335889
	speed: 0.0053s/iter; left time: 52.9495s
	iters: 800, epoch: 11 | loss: 0.2100160
	speed: 0.0061s/iter; left time: 59.7725s
	iters: 900, epoch: 11 | loss: 0.3289499
	speed: 0.0057s/iter; left time: 55.8615s
	iters: 1000, epoch: 11 | loss: 0.2169641
	speed: 0.0064s/iter; left time: 61.7868s
Epoch: 11 cost time: 6.121790885925293
Epoch: 11, Steps: 1063 | Train Loss: 0.2746506 Vali Loss: 0.1925898 Test Loss: 0.3300686
EarlyStopping counter: 3 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.1869454
	speed: 0.0221s/iter; left time: 208.9943s
	iters: 200, epoch: 12 | loss: 0.3712483
	speed: 0.0049s/iter; left time: 45.9939s
	iters: 300, epoch: 12 | loss: 0.1845402
	speed: 0.0050s/iter; left time: 45.9033s
	iters: 400, epoch: 12 | loss: 0.1663246
	speed: 0.0048s/iter; left time: 44.0064s
	iters: 500, epoch: 12 | loss: 0.2293304
	speed: 0.0050s/iter; left time: 45.3547s
	iters: 600, epoch: 12 | loss: 0.1882288
	speed: 0.0063s/iter; left time: 56.9309s
	iters: 700, epoch: 12 | loss: 0.2039941
	speed: 0.0060s/iter; left time: 52.9715s
	iters: 800, epoch: 12 | loss: 0.2162607
	speed: 0.0058s/iter; left time: 51.2257s
	iters: 900, epoch: 12 | loss: 0.2628453
	speed: 0.0057s/iter; left time: 49.2199s
	iters: 1000, epoch: 12 | loss: 0.1397161
	speed: 0.0053s/iter; left time: 45.6038s
Epoch: 12 cost time: 5.759066104888916
Epoch: 12, Steps: 1063 | Train Loss: 0.2743403 Vali Loss: 0.1962686 Test Loss: 0.3398862
EarlyStopping counter: 4 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.1478020
	speed: 0.0222s/iter; left time: 186.7937s
	iters: 200, epoch: 13 | loss: 0.1901327
	speed: 0.0051s/iter; left time: 42.6073s
	iters: 300, epoch: 13 | loss: 0.2696514
	speed: 0.0057s/iter; left time: 46.7989s
	iters: 400, epoch: 13 | loss: 0.1995040
	speed: 0.0050s/iter; left time: 40.6483s
	iters: 500, epoch: 13 | loss: 0.2247156
	speed: 0.0045s/iter; left time: 36.3449s
	iters: 600, epoch: 13 | loss: 0.2600611
	speed: 0.0045s/iter; left time: 35.4936s
	iters: 700, epoch: 13 | loss: 0.3976121
	speed: 0.0045s/iter; left time: 35.3805s
	iters: 800, epoch: 13 | loss: 0.1998244
	speed: 0.0046s/iter; left time: 35.2152s
	iters: 900, epoch: 13 | loss: 0.1991256
	speed: 0.0047s/iter; left time: 35.8449s
	iters: 1000, epoch: 13 | loss: 0.1523557
	speed: 0.0044s/iter; left time: 33.3220s
Epoch: 13 cost time: 5.132238149642944
Epoch: 13, Steps: 1063 | Train Loss: 0.2741875 Vali Loss: 0.1938025 Test Loss: 0.3333320
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTm2_336_192_Linear_ETTm2_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed12890<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
mse:0.3023737668991089, mae:0.3571849763393402
