Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='Linear', model_id='ETTm2_336_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=25565, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTm2_336_96_Linear_ETTm2_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed25565>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34129
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.3169743
	speed: 0.0045s/iter; left time: 94.4451s
	iters: 200, epoch: 1 | loss: 0.5597854
	speed: 0.0045s/iter; left time: 94.8332s
	iters: 300, epoch: 1 | loss: 0.3970395
	speed: 0.0050s/iter; left time: 104.5007s
	iters: 400, epoch: 1 | loss: 0.2262592
	speed: 0.0050s/iter; left time: 104.8142s
	iters: 500, epoch: 1 | loss: 1.2011372
	speed: 0.0050s/iter; left time: 103.3177s
	iters: 600, epoch: 1 | loss: 0.5123219
	speed: 0.0050s/iter; left time: 103.6051s
	iters: 700, epoch: 1 | loss: 0.4198008
	speed: 0.0046s/iter; left time: 94.7174s
	iters: 800, epoch: 1 | loss: 0.5686602
	speed: 0.0042s/iter; left time: 86.1883s
	iters: 900, epoch: 1 | loss: 0.3753338
	speed: 0.0041s/iter; left time: 84.3895s
	iters: 1000, epoch: 1 | loss: 0.2609991
	speed: 0.0042s/iter; left time: 86.1730s
Epoch: 1 cost time: 4.8820319175720215
Epoch: 1, Steps: 1066 | Train Loss: 0.4130594 Vali Loss: 0.4015526 Test Loss: 0.8747465
Validation loss decreased (inf --> 0.401553).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.3089753
	speed: 0.0188s/iter; left time: 378.6138s
	iters: 200, epoch: 2 | loss: 0.1395047
	speed: 0.0044s/iter; left time: 87.8792s
	iters: 300, epoch: 2 | loss: 0.2448181
	speed: 0.0043s/iter; left time: 86.0122s
	iters: 400, epoch: 2 | loss: 0.4765269
	speed: 0.0035s/iter; left time: 70.0882s
	iters: 500, epoch: 2 | loss: 0.3537954
	speed: 0.0037s/iter; left time: 72.1573s
	iters: 600, epoch: 2 | loss: 0.4568538
	speed: 0.0042s/iter; left time: 83.3372s
	iters: 700, epoch: 2 | loss: 0.4289242
	speed: 0.0037s/iter; left time: 72.7533s
	iters: 800, epoch: 2 | loss: 0.2713042
	speed: 0.0037s/iter; left time: 72.2122s
	iters: 900, epoch: 2 | loss: 0.4088514
	speed: 0.0045s/iter; left time: 88.0652s
	iters: 1000, epoch: 2 | loss: 0.2991529
	speed: 0.0043s/iter; left time: 83.2407s
Epoch: 2 cost time: 4.357973575592041
Epoch: 2, Steps: 1066 | Train Loss: 0.3778634 Vali Loss: 0.2966027 Test Loss: 0.5771540
Validation loss decreased (0.401553 --> 0.296603).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.3469611
	speed: 0.0162s/iter; left time: 310.0769s
	iters: 200, epoch: 3 | loss: 0.2047430
	speed: 0.0043s/iter; left time: 80.7377s
	iters: 300, epoch: 3 | loss: 0.2780435
	speed: 0.0044s/iter; left time: 82.7404s
	iters: 400, epoch: 3 | loss: 0.2416986
	speed: 0.0045s/iter; left time: 83.8357s
	iters: 500, epoch: 3 | loss: 0.1194704
	speed: 0.0045s/iter; left time: 83.3529s
	iters: 600, epoch: 3 | loss: 0.3107235
	speed: 0.0043s/iter; left time: 79.0392s
	iters: 700, epoch: 3 | loss: 0.1915111
	speed: 0.0045s/iter; left time: 83.3940s
	iters: 800, epoch: 3 | loss: 0.1192573
	speed: 0.0044s/iter; left time: 81.8310s
	iters: 900, epoch: 3 | loss: 0.1768472
	speed: 0.0036s/iter; left time: 65.6896s
	iters: 1000, epoch: 3 | loss: 0.2103213
	speed: 0.0043s/iter; left time: 78.5854s
Epoch: 3 cost time: 4.602114200592041
Epoch: 3, Steps: 1066 | Train Loss: 0.2675556 Vali Loss: 0.4173587 Test Loss: 1.0920407
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.1767995
	speed: 0.0194s/iter; left time: 349.8957s
	iters: 200, epoch: 4 | loss: 0.1345073
	speed: 0.0046s/iter; left time: 83.0350s
	iters: 300, epoch: 4 | loss: 0.1405628
	speed: 0.0039s/iter; left time: 68.8059s
	iters: 400, epoch: 4 | loss: 0.1980134
	speed: 0.0037s/iter; left time: 65.5751s
	iters: 500, epoch: 4 | loss: 0.2633320
	speed: 0.0037s/iter; left time: 65.4392s
	iters: 600, epoch: 4 | loss: 0.2125203
	speed: 0.0036s/iter; left time: 63.2659s
	iters: 700, epoch: 4 | loss: 0.1710188
	speed: 0.0037s/iter; left time: 63.5940s
	iters: 800, epoch: 4 | loss: 0.4809409
	speed: 0.0036s/iter; left time: 62.2181s
	iters: 900, epoch: 4 | loss: 0.4942976
	speed: 0.0036s/iter; left time: 62.5196s
	iters: 1000, epoch: 4 | loss: 0.1672002
	speed: 0.0038s/iter; left time: 64.9371s
Epoch: 4 cost time: 4.123116731643677
Epoch: 4, Steps: 1066 | Train Loss: 0.2287064 Vali Loss: 0.1657760 Test Loss: 0.2697126
Validation loss decreased (0.296603 --> 0.165776).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.2557862
	speed: 0.0168s/iter; left time: 284.8902s
	iters: 200, epoch: 5 | loss: 0.1492264
	speed: 0.0040s/iter; left time: 67.8177s
	iters: 300, epoch: 5 | loss: 0.1015472
	speed: 0.0043s/iter; left time: 72.0555s
	iters: 400, epoch: 5 | loss: 0.2089190
	speed: 0.0047s/iter; left time: 78.3361s
	iters: 500, epoch: 5 | loss: 0.2598730
	speed: 0.0029s/iter; left time: 48.8430s
	iters: 600, epoch: 5 | loss: 0.2470891
	speed: 0.0042s/iter; left time: 68.7902s
	iters: 700, epoch: 5 | loss: 0.2528375
	speed: 0.0046s/iter; left time: 74.7871s
	iters: 800, epoch: 5 | loss: 0.2240490
	speed: 0.0041s/iter; left time: 67.1417s
	iters: 900, epoch: 5 | loss: 0.3577380
	speed: 0.0036s/iter; left time: 57.5189s
	iters: 1000, epoch: 5 | loss: 0.2378346
	speed: 0.0035s/iter; left time: 55.7682s
Epoch: 5 cost time: 4.212191581726074
Epoch: 5, Steps: 1066 | Train Loss: 0.2163369 Vali Loss: 0.1588349 Test Loss: 0.2622220
Validation loss decreased (0.165776 --> 0.158835).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.1782334
	speed: 0.0194s/iter; left time: 308.7033s
	iters: 200, epoch: 6 | loss: 0.1938435
	speed: 0.0046s/iter; left time: 72.0072s
	iters: 300, epoch: 6 | loss: 0.1933057
	speed: 0.0043s/iter; left time: 67.5124s
	iters: 400, epoch: 6 | loss: 0.0869303
	speed: 0.0037s/iter; left time: 58.4661s
	iters: 500, epoch: 6 | loss: 0.2448472
	speed: 0.0045s/iter; left time: 70.3292s
	iters: 600, epoch: 6 | loss: 0.1881725
	speed: 0.0043s/iter; left time: 66.2088s
	iters: 700, epoch: 6 | loss: 0.1754599
	speed: 0.0041s/iter; left time: 62.8548s
	iters: 800, epoch: 6 | loss: 0.2730622
	speed: 0.0045s/iter; left time: 68.2499s
	iters: 900, epoch: 6 | loss: 0.2397528
	speed: 0.0044s/iter; left time: 66.5375s
	iters: 1000, epoch: 6 | loss: 0.1219421
	speed: 0.0041s/iter; left time: 60.8878s
Epoch: 6 cost time: 4.575082302093506
Epoch: 6, Steps: 1066 | Train Loss: 0.2081899 Vali Loss: 0.1333292 Test Loss: 0.2128823
Validation loss decreased (0.158835 --> 0.133329).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.2337554
	speed: 0.0197s/iter; left time: 291.6847s
	iters: 200, epoch: 7 | loss: 0.3034845
	speed: 0.0038s/iter; left time: 56.1022s
	iters: 300, epoch: 7 | loss: 0.1811857
	speed: 0.0042s/iter; left time: 60.7026s
	iters: 400, epoch: 7 | loss: 0.3177635
	speed: 0.0042s/iter; left time: 61.4836s
	iters: 500, epoch: 7 | loss: 0.1903993
	speed: 0.0045s/iter; left time: 65.2714s
	iters: 600, epoch: 7 | loss: 0.1391180
	speed: 0.0042s/iter; left time: 59.9157s
	iters: 700, epoch: 7 | loss: 0.1762804
	speed: 0.0044s/iter; left time: 63.0067s
	iters: 800, epoch: 7 | loss: 0.3358848
	speed: 0.0044s/iter; left time: 61.4759s
	iters: 900, epoch: 7 | loss: 0.1738206
	speed: 0.0049s/iter; left time: 68.4507s
	iters: 1000, epoch: 7 | loss: 0.1655018
	speed: 0.0049s/iter; left time: 67.7049s
Epoch: 7 cost time: 4.631819486618042
Epoch: 7, Steps: 1066 | Train Loss: 0.2041446 Vali Loss: 0.1318560 Test Loss: 0.2036771
Validation loss decreased (0.133329 --> 0.131856).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.2634169
	speed: 0.0179s/iter; left time: 245.6477s
	iters: 200, epoch: 8 | loss: 0.2821909
	speed: 0.0040s/iter; left time: 54.8136s
	iters: 300, epoch: 8 | loss: 0.1876913
	speed: 0.0036s/iter; left time: 48.1345s
	iters: 400, epoch: 8 | loss: 0.1477010
	speed: 0.0034s/iter; left time: 45.6260s
	iters: 500, epoch: 8 | loss: 0.2118525
	speed: 0.0040s/iter; left time: 53.3276s
	iters: 600, epoch: 8 | loss: 0.2267572
	speed: 0.0042s/iter; left time: 55.0290s
	iters: 700, epoch: 8 | loss: 0.2276243
	speed: 0.0044s/iter; left time: 57.9256s
	iters: 800, epoch: 8 | loss: 0.1617118
	speed: 0.0034s/iter; left time: 43.8783s
	iters: 900, epoch: 8 | loss: 0.0772073
	speed: 0.0036s/iter; left time: 46.2708s
	iters: 1000, epoch: 8 | loss: 0.1716295
	speed: 0.0036s/iter; left time: 46.7172s
Epoch: 8 cost time: 4.065077543258667
Epoch: 8, Steps: 1066 | Train Loss: 0.2017349 Vali Loss: 0.1539480 Test Loss: 0.2741489
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.1084674
	speed: 0.0160s/iter; left time: 203.5014s
	iters: 200, epoch: 9 | loss: 0.2505930
	speed: 0.0044s/iter; left time: 55.5626s
	iters: 300, epoch: 9 | loss: 0.1449861
	speed: 0.0042s/iter; left time: 53.0767s
	iters: 400, epoch: 9 | loss: 0.1804355
	speed: 0.0042s/iter; left time: 52.5757s
	iters: 500, epoch: 9 | loss: 0.2241055
	speed: 0.0041s/iter; left time: 50.4013s
	iters: 600, epoch: 9 | loss: 0.1237212
	speed: 0.0037s/iter; left time: 44.9821s
	iters: 700, epoch: 9 | loss: 0.1076156
	speed: 0.0038s/iter; left time: 46.0990s
	iters: 800, epoch: 9 | loss: 0.2264815
	speed: 0.0036s/iter; left time: 42.8147s
	iters: 900, epoch: 9 | loss: 0.2427566
	speed: 0.0042s/iter; left time: 50.2116s
	iters: 1000, epoch: 9 | loss: 0.1077527
	speed: 0.0047s/iter; left time: 55.1982s
Epoch: 9 cost time: 4.441678285598755
Epoch: 9, Steps: 1066 | Train Loss: 0.2004166 Vali Loss: 0.1406575 Test Loss: 0.2342117
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.1829452
	speed: 0.0192s/iter; left time: 223.6424s
	iters: 200, epoch: 10 | loss: 0.2195297
	speed: 0.0049s/iter; left time: 56.1436s
	iters: 300, epoch: 10 | loss: 0.2973630
	speed: 0.0042s/iter; left time: 48.1339s
	iters: 400, epoch: 10 | loss: 0.1236278
	speed: 0.0044s/iter; left time: 49.8290s
	iters: 500, epoch: 10 | loss: 0.2328711
	speed: 0.0041s/iter; left time: 46.2851s
	iters: 600, epoch: 10 | loss: 0.1719459
	speed: 0.0045s/iter; left time: 49.9667s
	iters: 700, epoch: 10 | loss: 0.1423543
	speed: 0.0047s/iter; left time: 51.8633s
	iters: 800, epoch: 10 | loss: 0.1297795
	speed: 0.0038s/iter; left time: 41.3041s
	iters: 900, epoch: 10 | loss: 0.3428578
	speed: 0.0036s/iter; left time: 38.9834s
	iters: 1000, epoch: 10 | loss: 0.2146306
	speed: 0.0039s/iter; left time: 41.8547s
Epoch: 10 cost time: 4.547097682952881
Epoch: 10, Steps: 1066 | Train Loss: 0.1996971 Vali Loss: 0.1237009 Test Loss: 0.1845988
Validation loss decreased (0.131856 --> 0.123701).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.1400020
	speed: 0.0166s/iter; left time: 175.5500s
	iters: 200, epoch: 11 | loss: 0.1771947
	speed: 0.0041s/iter; left time: 42.4171s
	iters: 300, epoch: 11 | loss: 0.2122958
	speed: 0.0044s/iter; left time: 46.0271s
	iters: 400, epoch: 11 | loss: 0.1875052
	speed: 0.0043s/iter; left time: 44.0390s
	iters: 500, epoch: 11 | loss: 0.2912243
	speed: 0.0043s/iter; left time: 43.8954s
	iters: 600, epoch: 11 | loss: 0.2898915
	speed: 0.0042s/iter; left time: 42.1947s
	iters: 700, epoch: 11 | loss: 0.1789757
	speed: 0.0035s/iter; left time: 34.8636s
	iters: 800, epoch: 11 | loss: 0.2093118
	speed: 0.0038s/iter; left time: 36.9788s
	iters: 900, epoch: 11 | loss: 0.4019468
	speed: 0.0042s/iter; left time: 41.4267s
	iters: 1000, epoch: 11 | loss: 0.1138781
	speed: 0.0042s/iter; left time: 40.1897s
Epoch: 11 cost time: 4.339701414108276
Epoch: 11, Steps: 1066 | Train Loss: 0.1994156 Vali Loss: 0.1409614 Test Loss: 0.2357664
EarlyStopping counter: 1 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.1149663
	speed: 0.0166s/iter; left time: 157.3849s
	iters: 200, epoch: 12 | loss: 0.1337885
	speed: 0.0042s/iter; left time: 39.7294s
	iters: 300, epoch: 12 | loss: 0.1531490
	speed: 0.0043s/iter; left time: 39.5758s
	iters: 400, epoch: 12 | loss: 0.2900918
	speed: 0.0042s/iter; left time: 38.7110s
	iters: 500, epoch: 12 | loss: 0.2105887
	speed: 0.0047s/iter; left time: 42.3166s
	iters: 600, epoch: 12 | loss: 0.1427796
	speed: 0.0048s/iter; left time: 43.5389s
	iters: 700, epoch: 12 | loss: 0.2137360
	speed: 0.0041s/iter; left time: 36.3806s
	iters: 800, epoch: 12 | loss: 0.1144300
	speed: 0.0038s/iter; left time: 33.4397s
	iters: 900, epoch: 12 | loss: 0.2056752
	speed: 0.0045s/iter; left time: 39.3056s
	iters: 1000, epoch: 12 | loss: 0.2920025
	speed: 0.0039s/iter; left time: 33.7102s
Epoch: 12 cost time: 4.487735271453857
Epoch: 12, Steps: 1066 | Train Loss: 0.1991128 Vali Loss: 0.1284306 Test Loss: 0.1986463
EarlyStopping counter: 2 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.1257400
	speed: 0.0158s/iter; left time: 133.1990s
	iters: 200, epoch: 13 | loss: 0.2772625
	speed: 0.0037s/iter; left time: 30.7490s
	iters: 300, epoch: 13 | loss: 0.2845362
	speed: 0.0043s/iter; left time: 35.3890s
	iters: 400, epoch: 13 | loss: 0.1730782
	speed: 0.0036s/iter; left time: 29.5080s
	iters: 500, epoch: 13 | loss: 0.4437814
	speed: 0.0037s/iter; left time: 29.5719s
	iters: 600, epoch: 13 | loss: 0.1385716
	speed: 0.0036s/iter; left time: 28.4651s
	iters: 700, epoch: 13 | loss: 0.1211159
	speed: 0.0037s/iter; left time: 28.9696s
	iters: 800, epoch: 13 | loss: 0.1435058
	speed: 0.0038s/iter; left time: 29.0765s
	iters: 900, epoch: 13 | loss: 0.2426036
	speed: 0.0037s/iter; left time: 28.0748s
	iters: 1000, epoch: 13 | loss: 0.1283084
	speed: 0.0037s/iter; left time: 27.8740s
Epoch: 13 cost time: 4.022991180419922
Epoch: 13, Steps: 1066 | Train Loss: 0.1990148 Vali Loss: 0.1308365 Test Loss: 0.2063144
EarlyStopping counter: 3 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 14 | loss: 0.2815779
	speed: 0.0176s/iter; left time: 129.5972s
	iters: 200, epoch: 14 | loss: 0.1917323
	speed: 0.0041s/iter; left time: 29.7233s
	iters: 300, epoch: 14 | loss: 0.1356269
	speed: 0.0040s/iter; left time: 28.8701s
	iters: 400, epoch: 14 | loss: 0.1666588
	speed: 0.0042s/iter; left time: 29.7584s
	iters: 500, epoch: 14 | loss: 0.1526723
	speed: 0.0046s/iter; left time: 31.7513s
	iters: 600, epoch: 14 | loss: 0.1433604
	speed: 0.0047s/iter; left time: 31.9383s
	iters: 700, epoch: 14 | loss: 0.1264075
	speed: 0.0038s/iter; left time: 25.6335s
	iters: 800, epoch: 14 | loss: 0.2197178
	speed: 0.0037s/iter; left time: 24.5198s
	iters: 900, epoch: 14 | loss: 0.1047201
	speed: 0.0038s/iter; left time: 25.2282s
	iters: 1000, epoch: 14 | loss: 0.1709783
	speed: 0.0040s/iter; left time: 25.7255s
Epoch: 14 cost time: 4.36431622505188
Epoch: 14, Steps: 1066 | Train Loss: 0.1990402 Vali Loss: 0.1310659 Test Loss: 0.2073256
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 15 | loss: 0.2156963
	speed: 0.0182s/iter; left time: 114.7544s
	iters: 200, epoch: 15 | loss: 0.1550240
	speed: 0.0049s/iter; left time: 30.1174s
	iters: 300, epoch: 15 | loss: 0.1536224
	speed: 0.0047s/iter; left time: 28.6090s
	iters: 400, epoch: 15 | loss: 0.3458137
	speed: 0.0045s/iter; left time: 26.8066s
	iters: 500, epoch: 15 | loss: 0.3186306
	speed: 0.0041s/iter; left time: 24.2044s
	iters: 600, epoch: 15 | loss: 0.1372213
	speed: 0.0039s/iter; left time: 22.6678s
	iters: 700, epoch: 15 | loss: 0.2367440
	speed: 0.0038s/iter; left time: 21.6486s
	iters: 800, epoch: 15 | loss: 0.1585066
	speed: 0.0034s/iter; left time: 19.2132s
	iters: 900, epoch: 15 | loss: 0.3226154
	speed: 0.0036s/iter; left time: 20.0640s
	iters: 1000, epoch: 15 | loss: 0.1448383
	speed: 0.0036s/iter; left time: 19.6564s
Epoch: 15 cost time: 4.328397035598755
Epoch: 15, Steps: 1066 | Train Loss: 0.1989847 Vali Loss: 0.1316049 Test Loss: 0.2087220
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTm2_336_96_Linear_ETTm2_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed25565<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.18498222529888153, mae:0.27661412954330444
