Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='NLinear', model_id='traffic_336_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=336, root_path='./dataset/', save_pred_values=False, seed=28649, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_336_336_NLinear_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed28649>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11609
val 1421
test 3173
	iters: 100, epoch: 1 | loss: 0.6258171
	speed: 0.3254s/iter; left time: 4686.5080s
	iters: 200, epoch: 1 | loss: 0.8270210
	speed: 0.3120s/iter; left time: 4461.8743s
	iters: 300, epoch: 1 | loss: 0.7338783
	speed: 0.3114s/iter; left time: 4422.2356s
	iters: 400, epoch: 1 | loss: 0.6619742
	speed: 0.3098s/iter; left time: 4368.8862s
	iters: 500, epoch: 1 | loss: 0.9126608
	speed: 0.3089s/iter; left time: 4325.5434s
	iters: 600, epoch: 1 | loss: 0.9124106
	speed: 0.3094s/iter; left time: 4301.3318s
	iters: 700, epoch: 1 | loss: 1.2831162
	speed: 0.3077s/iter; left time: 4246.9105s
Epoch: 1 cost time: 226.4074947834015
Epoch: 1, Steps: 725 | Train Loss: 1.0485340 Vali Loss: 1.2316388 Test Loss: 1.3547924
Validation loss decreased (inf --> 1.231639).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 1.0574728
	speed: 0.6080s/iter; left time: 8314.9835s
	iters: 200, epoch: 2 | loss: 1.1862351
	speed: 0.3101s/iter; left time: 4210.5747s
	iters: 300, epoch: 2 | loss: 1.1366239
	speed: 0.3092s/iter; left time: 4166.7200s
	iters: 400, epoch: 2 | loss: 0.7188139
	speed: 0.3088s/iter; left time: 4130.0774s
	iters: 500, epoch: 2 | loss: 1.0366888
	speed: 0.3086s/iter; left time: 4097.3757s
	iters: 600, epoch: 2 | loss: 0.7469708
	speed: 0.3080s/iter; left time: 4058.4553s
	iters: 700, epoch: 2 | loss: 1.1889553
	speed: 0.3080s/iter; left time: 4027.6654s
Epoch: 2 cost time: 223.87449860572815
Epoch: 2, Steps: 725 | Train Loss: 1.1529866 Vali Loss: 1.5594386 Test Loss: 1.5909520
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.4537939
	speed: 0.6064s/iter; left time: 7853.3761s
	iters: 200, epoch: 3 | loss: 0.3293515
	speed: 0.3085s/iter; left time: 3964.9236s
	iters: 300, epoch: 3 | loss: 0.3126768
	speed: 0.3079s/iter; left time: 3926.0085s
	iters: 400, epoch: 3 | loss: 0.3962239
	speed: 0.3090s/iter; left time: 3909.2545s
	iters: 500, epoch: 3 | loss: 0.3752736
	speed: 0.3119s/iter; left time: 3914.8350s
	iters: 600, epoch: 3 | loss: 0.3560871
	speed: 0.3103s/iter; left time: 3863.7746s
	iters: 700, epoch: 3 | loss: 0.3719038
	speed: 0.3099s/iter; left time: 3827.6026s
Epoch: 3 cost time: 224.41269826889038
Epoch: 3, Steps: 725 | Train Loss: 0.3775720 Vali Loss: 0.4946625 Test Loss: 0.6095173
Validation loss decreased (1.231639 --> 0.494662).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.3125343
	speed: 0.6132s/iter; left time: 7496.6531s
	iters: 200, epoch: 4 | loss: 0.2802768
	speed: 0.3092s/iter; left time: 3749.8958s
	iters: 300, epoch: 4 | loss: 0.2963009
	speed: 0.3092s/iter; left time: 3718.2993s
	iters: 400, epoch: 4 | loss: 0.3010457
	speed: 0.3091s/iter; left time: 3685.7433s
	iters: 500, epoch: 4 | loss: 0.3191841
	speed: 0.3094s/iter; left time: 3659.1614s
	iters: 600, epoch: 4 | loss: 0.2531200
	speed: 0.3094s/iter; left time: 3628.2020s
	iters: 700, epoch: 4 | loss: 0.3192651
	speed: 0.3104s/iter; left time: 3608.5860s
Epoch: 4 cost time: 224.66960620880127
Epoch: 4, Steps: 725 | Train Loss: 0.2986026 Vali Loss: 0.4132673 Test Loss: 0.5172929
Validation loss decreased (0.494662 --> 0.413267).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.2623354
	speed: 0.6174s/iter; left time: 7100.4393s
	iters: 200, epoch: 5 | loss: 0.2768810
	speed: 0.3106s/iter; left time: 3541.3726s
	iters: 300, epoch: 5 | loss: 0.2793152
	speed: 0.3103s/iter; left time: 3506.6015s
	iters: 400, epoch: 5 | loss: 0.2590881
	speed: 0.3090s/iter; left time: 3461.4502s
	iters: 500, epoch: 5 | loss: 0.2705517
	speed: 0.3098s/iter; left time: 3439.4135s
	iters: 600, epoch: 5 | loss: 0.2672543
	speed: 0.3086s/iter; left time: 3394.6057s
	iters: 700, epoch: 5 | loss: 0.2842008
	speed: 0.3086s/iter; left time: 3364.0324s
Epoch: 5 cost time: 224.80313515663147
Epoch: 5, Steps: 725 | Train Loss: 0.2768665 Vali Loss: 0.3876419 Test Loss: 0.4788550
Validation loss decreased (0.413267 --> 0.387642).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.2513001
	speed: 0.6110s/iter; left time: 6584.1775s
	iters: 200, epoch: 6 | loss: 0.2544044
	speed: 0.3099s/iter; left time: 3308.6281s
	iters: 300, epoch: 6 | loss: 0.2686457
	speed: 0.3099s/iter; left time: 3277.3179s
	iters: 400, epoch: 6 | loss: 0.2406116
	speed: 0.3099s/iter; left time: 3246.5860s
	iters: 500, epoch: 6 | loss: 0.2672283
	speed: 0.3088s/iter; left time: 3204.0250s
	iters: 600, epoch: 6 | loss: 0.2544318
	speed: 0.3086s/iter; left time: 3170.9588s
	iters: 700, epoch: 6 | loss: 0.2804908
	speed: 0.3087s/iter; left time: 3141.1979s
Epoch: 6 cost time: 224.40703511238098
Epoch: 6, Steps: 725 | Train Loss: 0.2664809 Vali Loss: 0.3758793 Test Loss: 0.4654915
Validation loss decreased (0.387642 --> 0.375879).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.2626580
	speed: 0.6125s/iter; left time: 6155.7543s
	iters: 200, epoch: 7 | loss: 0.2783149
	speed: 0.3107s/iter; left time: 3092.1242s
	iters: 300, epoch: 7 | loss: 0.2860768
	speed: 0.3118s/iter; left time: 3071.1113s
	iters: 400, epoch: 7 | loss: 0.2656737
	speed: 0.3128s/iter; left time: 3049.7598s
	iters: 500, epoch: 7 | loss: 0.2577132
	speed: 0.3112s/iter; left time: 3003.6711s
	iters: 600, epoch: 7 | loss: 0.3007384
	speed: 0.3103s/iter; left time: 2963.2077s
	iters: 700, epoch: 7 | loss: 0.2328466
	speed: 0.3118s/iter; left time: 2946.4063s
Epoch: 7 cost time: 225.86396193504333
Epoch: 7, Steps: 725 | Train Loss: 0.2608819 Vali Loss: 0.3691441 Test Loss: 0.4578894
Validation loss decreased (0.375879 --> 0.369144).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.2451255
	speed: 0.6129s/iter; left time: 5716.0258s
	iters: 200, epoch: 8 | loss: 0.2626472
	speed: 0.3104s/iter; left time: 2863.4854s
	iters: 300, epoch: 8 | loss: 0.2624684
	speed: 0.3089s/iter; left time: 2818.8099s
	iters: 400, epoch: 8 | loss: 0.2493080
	speed: 0.3095s/iter; left time: 2793.5818s
	iters: 500, epoch: 8 | loss: 0.2603780
	speed: 0.3100s/iter; left time: 2767.4319s
	iters: 600, epoch: 8 | loss: 0.2631566
	speed: 0.3097s/iter; left time: 2733.6230s
	iters: 700, epoch: 8 | loss: 0.2480482
	speed: 0.3101s/iter; left time: 2705.9490s
Epoch: 8 cost time: 224.71872448921204
Epoch: 8, Steps: 725 | Train Loss: 0.2576237 Vali Loss: 0.3664026 Test Loss: 0.4539000
Validation loss decreased (0.369144 --> 0.366403).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.2580778
	speed: 0.6120s/iter; left time: 5263.5650s
	iters: 200, epoch: 9 | loss: 0.2612783
	speed: 0.3093s/iter; left time: 2629.6419s
	iters: 300, epoch: 9 | loss: 0.2591551
	speed: 0.3087s/iter; left time: 2593.2769s
	iters: 400, epoch: 9 | loss: 0.2817712
	speed: 0.3088s/iter; left time: 2563.0928s
	iters: 500, epoch: 9 | loss: 0.2399759
	speed: 0.3076s/iter; left time: 2522.5537s
	iters: 600, epoch: 9 | loss: 0.2602881
	speed: 0.3088s/iter; left time: 2501.6319s
	iters: 700, epoch: 9 | loss: 0.2695643
	speed: 0.3083s/iter; left time: 2466.5620s
Epoch: 9 cost time: 224.06614923477173
Epoch: 9, Steps: 725 | Train Loss: 0.2556673 Vali Loss: 0.3643064 Test Loss: 0.4514065
Validation loss decreased (0.366403 --> 0.364306).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.2489304
	speed: 0.6133s/iter; left time: 4830.3109s
	iters: 200, epoch: 10 | loss: 0.2660441
	speed: 0.3102s/iter; left time: 2411.8433s
	iters: 300, epoch: 10 | loss: 0.2448333
	speed: 0.3086s/iter; left time: 2368.4446s
	iters: 400, epoch: 10 | loss: 0.2847582
	speed: 0.3107s/iter; left time: 2353.7946s
	iters: 500, epoch: 10 | loss: 0.2372998
	speed: 0.3094s/iter; left time: 2312.7535s
	iters: 600, epoch: 10 | loss: 0.2437553
	speed: 0.3093s/iter; left time: 2281.5777s
	iters: 700, epoch: 10 | loss: 0.2372342
	speed: 0.3094s/iter; left time: 2251.1176s
Epoch: 10 cost time: 224.7018609046936
Epoch: 10, Steps: 725 | Train Loss: 0.2545200 Vali Loss: 0.3631829 Test Loss: 0.4505073
Validation loss decreased (0.364306 --> 0.363183).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.2767642
	speed: 0.6135s/iter; left time: 4386.7973s
	iters: 200, epoch: 11 | loss: 0.2595294
	speed: 0.3102s/iter; left time: 2187.5368s
	iters: 300, epoch: 11 | loss: 0.2571644
	speed: 0.3094s/iter; left time: 2150.9268s
	iters: 400, epoch: 11 | loss: 0.2524872
	speed: 0.3095s/iter; left time: 2120.6772s
	iters: 500, epoch: 11 | loss: 0.2453395
	speed: 0.3088s/iter; left time: 2084.7423s
	iters: 600, epoch: 11 | loss: 0.2347792
	speed: 0.3096s/iter; left time: 2058.8334s
	iters: 700, epoch: 11 | loss: 0.2344804
	speed: 0.3088s/iter; left time: 2022.8765s
Epoch: 11 cost time: 224.72992134094238
Epoch: 11, Steps: 725 | Train Loss: 0.2539229 Vali Loss: 0.3630526 Test Loss: 0.4500172
Validation loss decreased (0.363183 --> 0.363053).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.2595425
	speed: 0.6152s/iter; left time: 3953.5361s
	iters: 200, epoch: 12 | loss: 0.2604842
	speed: 0.3119s/iter; left time: 1972.9640s
	iters: 300, epoch: 12 | loss: 0.2312234
	speed: 0.3105s/iter; left time: 1933.0588s
	iters: 400, epoch: 12 | loss: 0.2615853
	speed: 0.3097s/iter; left time: 1897.1393s
	iters: 500, epoch: 12 | loss: 0.2363214
	speed: 0.3088s/iter; left time: 1860.9117s
	iters: 600, epoch: 12 | loss: 0.2482323
	speed: 0.3095s/iter; left time: 1834.2836s
	iters: 700, epoch: 12 | loss: 0.2459857
	speed: 0.3117s/iter; left time: 1815.7259s
Epoch: 12 cost time: 225.1946840286255
Epoch: 12, Steps: 725 | Train Loss: 0.2535935 Vali Loss: 0.3629793 Test Loss: 0.4497748
Validation loss decreased (0.363053 --> 0.362979).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.2567943
	speed: 0.6156s/iter; left time: 3509.7403s
	iters: 200, epoch: 13 | loss: 0.2578196
	speed: 0.3107s/iter; left time: 1740.2449s
	iters: 300, epoch: 13 | loss: 0.2414622
	speed: 0.3103s/iter; left time: 1706.7431s
	iters: 400, epoch: 13 | loss: 0.2531287
	speed: 0.3093s/iter; left time: 1670.6824s
	iters: 500, epoch: 13 | loss: 0.2625247
	speed: 0.3097s/iter; left time: 1641.5967s
	iters: 600, epoch: 13 | loss: 0.2449738
	speed: 0.3091s/iter; left time: 1607.8518s
	iters: 700, epoch: 13 | loss: 0.2772368
	speed: 0.3097s/iter; left time: 1579.7766s
Epoch: 13 cost time: 224.994854927063
Epoch: 13, Steps: 725 | Train Loss: 0.2533918 Vali Loss: 0.3624847 Test Loss: 0.4496030
Validation loss decreased (0.362979 --> 0.362485).  Saving model ...
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 14 | loss: 0.2665718
	speed: 0.6130s/iter; left time: 3050.4556s
	iters: 200, epoch: 14 | loss: 0.2350875
	speed: 0.3100s/iter; left time: 1511.5645s
	iters: 300, epoch: 14 | loss: 0.2749967
	speed: 0.3096s/iter; left time: 1478.5515s
	iters: 400, epoch: 14 | loss: 0.2495515
	speed: 0.3101s/iter; left time: 1449.9179s
	iters: 500, epoch: 14 | loss: 0.2672489
	speed: 0.3095s/iter; left time: 1416.4476s
	iters: 600, epoch: 14 | loss: 0.2772873
	speed: 0.3098s/iter; left time: 1386.4584s
	iters: 700, epoch: 14 | loss: 0.2383927
	speed: 0.3099s/iter; left time: 1356.2474s
Epoch: 14 cost time: 224.80750560760498
Epoch: 14, Steps: 725 | Train Loss: 0.2532883 Vali Loss: 0.3627827 Test Loss: 0.4495971
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 15 | loss: 0.2815036
	speed: 0.6077s/iter; left time: 2583.2282s
	iters: 200, epoch: 15 | loss: 0.2996036
	speed: 0.3081s/iter; left time: 1278.9005s
	iters: 300, epoch: 15 | loss: 0.2420821
	speed: 0.3100s/iter; left time: 1255.6379s
	iters: 400, epoch: 15 | loss: 0.2322964
	speed: 0.3096s/iter; left time: 1223.2424s
	iters: 500, epoch: 15 | loss: 0.2299156
	speed: 0.3094s/iter; left time: 1191.5748s
	iters: 600, epoch: 15 | loss: 0.2740982
	speed: 0.3098s/iter; left time: 1161.8779s
	iters: 700, epoch: 15 | loss: 0.2511367
	speed: 0.3118s/iter; left time: 1138.3005s
Epoch: 15 cost time: 224.62563490867615
Epoch: 15, Steps: 725 | Train Loss: 0.2532263 Vali Loss: 0.3629574 Test Loss: 0.4495753
EarlyStopping counter: 2 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 16 | loss: 0.2401243
	speed: 0.6095s/iter; left time: 2149.2130s
	iters: 200, epoch: 16 | loss: 0.2446861
	speed: 0.3132s/iter; left time: 1072.8723s
	iters: 300, epoch: 16 | loss: 0.2627518
	speed: 0.3118s/iter; left time: 1037.1245s
	iters: 400, epoch: 16 | loss: 0.2607707
	speed: 0.3110s/iter; left time: 1003.1825s
	iters: 500, epoch: 16 | loss: 0.2488394
	speed: 0.3104s/iter; left time: 970.1794s
	iters: 600, epoch: 16 | loss: 0.2618333
	speed: 0.3101s/iter; left time: 938.4356s
	iters: 700, epoch: 16 | loss: 0.2490825
	speed: 0.3113s/iter; left time: 910.9429s
Epoch: 16 cost time: 225.7290689945221
Epoch: 16, Steps: 725 | Train Loss: 0.2532103 Vali Loss: 0.3626802 Test Loss: 0.4495728
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 17 | loss: 0.2679023
	speed: 0.6100s/iter; left time: 1708.6453s
	iters: 200, epoch: 17 | loss: 0.2427638
	speed: 0.3122s/iter; left time: 843.2663s
	iters: 300, epoch: 17 | loss: 0.2761397
	speed: 0.3120s/iter; left time: 811.4879s
	iters: 400, epoch: 17 | loss: 0.2442008
	speed: 0.3134s/iter; left time: 783.8713s
	iters: 500, epoch: 17 | loss: 0.2686448
	speed: 0.3108s/iter; left time: 746.2497s
	iters: 600, epoch: 17 | loss: 0.2326561
	speed: 0.3102s/iter; left time: 713.7910s
	iters: 700, epoch: 17 | loss: 0.2453078
	speed: 0.3104s/iter; left time: 683.2365s
Epoch: 17 cost time: 225.7399971485138
Epoch: 17, Steps: 725 | Train Loss: 0.2531564 Vali Loss: 0.3627465 Test Loss: 0.4495737
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 18 | loss: 0.2512089
	speed: 0.6065s/iter; left time: 1259.0072s
	iters: 200, epoch: 18 | loss: 0.2732154
	speed: 0.3093s/iter; left time: 611.1589s
	iters: 300, epoch: 18 | loss: 0.2648201
	speed: 0.3106s/iter; left time: 582.6636s
	iters: 400, epoch: 18 | loss: 0.2495116
	speed: 0.3109s/iter; left time: 552.1263s
	iters: 500, epoch: 18 | loss: 0.2576408
	speed: 0.3106s/iter; left time: 520.6280s
	iters: 600, epoch: 18 | loss: 0.2482186
	speed: 0.3105s/iter; left time: 489.2992s
	iters: 700, epoch: 18 | loss: 0.2457442
	speed: 0.3089s/iter; left time: 455.9617s
Epoch: 18 cost time: 224.79501748085022
Epoch: 18, Steps: 725 | Train Loss: 0.2531896 Vali Loss: 0.3625670 Test Loss: 0.4495732
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : traffic_336_336_NLinear_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed28649<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3173
mse:0.4484609365463257, mae:0.3053392171859741
