Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTh1', data_path='ETTh1.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='Linear', model_id='ETTh1_336_720', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=720, root_path='./dataset/', save_pred_values=False, seed=3293, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTh1_336_720_Linear_ETTh1_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3293>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7585
val 2161
test 2161
	iters: 100, epoch: 1 | loss: 0.6318431
	speed: 0.0203s/iter; left time: 94.1052s
	iters: 200, epoch: 1 | loss: 0.5200639
	speed: 0.0209s/iter; left time: 95.1086s
Epoch: 1 cost time: 4.761128664016724
Epoch: 1, Steps: 237 | Train Loss: 0.6033707 Vali Loss: 1.3877203 Test Loss: 0.5790445
Validation loss decreased (inf --> 1.387720).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.5352104
	speed: 0.0344s/iter; left time: 151.6029s
	iters: 200, epoch: 2 | loss: 0.5195971
	speed: 0.0183s/iter; left time: 78.9241s
Epoch: 2 cost time: 4.357720136642456
Epoch: 2, Steps: 237 | Train Loss: 0.5683897 Vali Loss: 1.4565490 Test Loss: 0.5580018
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.5074226
	speed: 0.0327s/iter; left time: 136.3494s
	iters: 200, epoch: 3 | loss: 0.5176028
	speed: 0.0164s/iter; left time: 66.6000s
Epoch: 3 cost time: 4.091118097305298
Epoch: 3, Steps: 237 | Train Loss: 0.5221887 Vali Loss: 1.3138211 Test Loss: 0.5058336
Validation loss decreased (1.387720 --> 1.313821).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.5606416
	speed: 0.0343s/iter; left time: 134.9848s
	iters: 200, epoch: 4 | loss: 0.5255000
	speed: 0.0197s/iter; left time: 75.2699s
Epoch: 4 cost time: 4.506252288818359
Epoch: 4, Steps: 237 | Train Loss: 0.5006905 Vali Loss: 1.2889386 Test Loss: 0.4964226
Validation loss decreased (1.313821 --> 1.288939).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.4935533
	speed: 0.0363s/iter; left time: 134.1172s
	iters: 200, epoch: 5 | loss: 0.4402878
	speed: 0.0179s/iter; left time: 64.3845s
Epoch: 5 cost time: 4.3407227993011475
Epoch: 5, Steps: 237 | Train Loss: 0.4902059 Vali Loss: 1.2670532 Test Loss: 0.4827422
Validation loss decreased (1.288939 --> 1.267053).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.4319394
	speed: 0.0325s/iter; left time: 112.2999s
	iters: 200, epoch: 6 | loss: 0.4774820
	speed: 0.0174s/iter; left time: 58.4433s
Epoch: 6 cost time: 4.244462966918945
Epoch: 6, Steps: 237 | Train Loss: 0.4837466 Vali Loss: 1.2581700 Test Loss: 0.4919970
Validation loss decreased (1.267053 --> 1.258170).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.4804465
	speed: 0.0320s/iter; left time: 102.9174s
	iters: 200, epoch: 7 | loss: 0.5056381
	speed: 0.0181s/iter; left time: 56.5932s
Epoch: 7 cost time: 4.23432731628418
Epoch: 7, Steps: 237 | Train Loss: 0.4809465 Vali Loss: 1.2571145 Test Loss: 0.4858680
Validation loss decreased (1.258170 --> 1.257115).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.4782075
	speed: 0.0361s/iter; left time: 107.6683s
	iters: 200, epoch: 8 | loss: 0.4355348
	speed: 0.0168s/iter; left time: 48.5336s
Epoch: 8 cost time: 4.1634111404418945
Epoch: 8, Steps: 237 | Train Loss: 0.4793676 Vali Loss: 1.2442588 Test Loss: 0.4909262
Validation loss decreased (1.257115 --> 1.244259).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.3969493
	speed: 0.0330s/iter; left time: 90.5336s
	iters: 200, epoch: 9 | loss: 0.4919968
	speed: 0.0170s/iter; left time: 45.0688s
Epoch: 9 cost time: 4.3319926261901855
Epoch: 9, Steps: 237 | Train Loss: 0.4783792 Vali Loss: 1.2452675 Test Loss: 0.4866604
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.4411284
	speed: 0.0315s/iter; left time: 78.9439s
	iters: 200, epoch: 10 | loss: 0.4528924
	speed: 0.0173s/iter; left time: 41.7102s
Epoch: 10 cost time: 4.033211946487427
Epoch: 10, Steps: 237 | Train Loss: 0.4778868 Vali Loss: 1.2471246 Test Loss: 0.4859327
EarlyStopping counter: 2 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.4892071
	speed: 0.0294s/iter; left time: 66.7493s
	iters: 200, epoch: 11 | loss: 0.5036419
	speed: 0.0187s/iter; left time: 40.5049s
Epoch: 11 cost time: 4.224203824996948
Epoch: 11, Steps: 237 | Train Loss: 0.4775906 Vali Loss: 1.2431706 Test Loss: 0.4868331
Validation loss decreased (1.244259 --> 1.243171).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.4635754
	speed: 0.0356s/iter; left time: 72.4860s
	iters: 200, epoch: 12 | loss: 0.5560542
	speed: 0.0151s/iter; left time: 29.1757s
Epoch: 12 cost time: 4.076545476913452
Epoch: 12, Steps: 237 | Train Loss: 0.4774076 Vali Loss: 1.2422997 Test Loss: 0.4869092
Validation loss decreased (1.243171 --> 1.242300).  Saving model ...
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.4811242
	speed: 0.0320s/iter; left time: 57.5723s
	iters: 200, epoch: 13 | loss: 0.4912117
	speed: 0.0149s/iter; left time: 25.3253s
Epoch: 13 cost time: 3.8183631896972656
Epoch: 13, Steps: 237 | Train Loss: 0.4773676 Vali Loss: 1.2435099 Test Loss: 0.4875639
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.4422029
	speed: 0.0293s/iter; left time: 45.7183s
	iters: 200, epoch: 14 | loss: 0.4922595
	speed: 0.0155s/iter; left time: 22.6403s
Epoch: 14 cost time: 3.6168911457061768
Epoch: 14, Steps: 237 | Train Loss: 0.4772981 Vali Loss: 1.2426549 Test Loss: 0.4873036
EarlyStopping counter: 2 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.4812657
	speed: 0.0266s/iter; left time: 35.2119s
	iters: 200, epoch: 15 | loss: 0.5020502
	speed: 0.0145s/iter; left time: 17.7491s
Epoch: 15 cost time: 3.5545923709869385
Epoch: 15, Steps: 237 | Train Loss: 0.4772777 Vali Loss: 1.2436796 Test Loss: 0.4872328
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.4727885
	speed: 0.0275s/iter; left time: 29.8288s
	iters: 200, epoch: 16 | loss: 0.5313792
	speed: 0.0135s/iter; left time: 13.2721s
Epoch: 16 cost time: 3.329663038253784
Epoch: 16, Steps: 237 | Train Loss: 0.4772851 Vali Loss: 1.2432530 Test Loss: 0.4872344
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 17 | loss: 0.4667986
	speed: 0.0258s/iter; left time: 21.9430s
	iters: 200, epoch: 17 | loss: 0.5418347
	speed: 0.0132s/iter; left time: 9.9196s
Epoch: 17 cost time: 3.2342851161956787
Epoch: 17, Steps: 237 | Train Loss: 0.4772834 Vali Loss: 1.2415311 Test Loss: 0.4872291
Validation loss decreased (1.242300 --> 1.241531).  Saving model ...
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 18 | loss: 0.4876547
	speed: 0.0258s/iter; left time: 15.7960s
	iters: 200, epoch: 18 | loss: 0.4892511
	speed: 0.0130s/iter; left time: 6.6497s
Epoch: 18 cost time: 3.1443867683410645
Epoch: 18, Steps: 237 | Train Loss: 0.4772121 Vali Loss: 1.2435534 Test Loss: 0.4872260
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 19 | loss: 0.5392495
	speed: 0.0241s/iter; left time: 9.0436s
	iters: 200, epoch: 19 | loss: 0.3925960
	speed: 0.0113s/iter; left time: 3.1062s
Epoch: 19 cost time: 2.899031162261963
Epoch: 19, Steps: 237 | Train Loss: 0.4772601 Vali Loss: 1.2431741 Test Loss: 0.4872255
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.9073486328125e-08
	iters: 100, epoch: 20 | loss: 0.4831167
	speed: 0.0228s/iter; left time: 3.1446s
	iters: 200, epoch: 20 | loss: 0.5439270
	speed: 0.0115s/iter; left time: 0.4367s
Epoch: 20 cost time: 2.798583984375
Epoch: 20, Steps: 237 | Train Loss: 0.4772588 Vali Loss: 1.2430795 Test Loss: 0.4872247
EarlyStopping counter: 3 out of 5
Updating learning rate to 9.5367431640625e-09
>>>>>>>testing : ETTh1_336_720_Linear_ETTh1_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3293<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
mse:0.4862849712371826, mae:0.48545145988464355
