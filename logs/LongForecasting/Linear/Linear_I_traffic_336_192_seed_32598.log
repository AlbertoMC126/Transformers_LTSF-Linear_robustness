Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='Linear', model_id='traffic_336_192', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=192, root_path='./dataset/', save_pred_values=False, seed=32598, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_336_192_Linear_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed32598>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11753
val 1565
test 3317
	iters: 100, epoch: 1 | loss: 0.4445889
	speed: 0.3143s/iter; left time: 4583.5304s
	iters: 200, epoch: 1 | loss: 0.4712290
	speed: 0.2995s/iter; left time: 4336.3873s
	iters: 300, epoch: 1 | loss: 0.4470555
	speed: 0.2998s/iter; left time: 4310.8081s
	iters: 400, epoch: 1 | loss: 0.4435716
	speed: 0.2996s/iter; left time: 4278.7027s
	iters: 500, epoch: 1 | loss: 0.4923284
	speed: 0.3013s/iter; left time: 4272.0783s
	iters: 600, epoch: 1 | loss: 0.4556060
	speed: 0.3005s/iter; left time: 4231.0357s
	iters: 700, epoch: 1 | loss: 0.4680980
	speed: 0.2999s/iter; left time: 4192.2559s
Epoch: 1 cost time: 221.93158626556396
Epoch: 1, Steps: 734 | Train Loss: 0.4813149 Vali Loss: 0.6417482 Test Loss: 0.7638174
Validation loss decreased (inf --> 0.641748).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.4671708
	speed: 0.6033s/iter; left time: 8354.2747s
	iters: 200, epoch: 2 | loss: 0.5166411
	speed: 0.2997s/iter; left time: 4119.6630s
	iters: 300, epoch: 2 | loss: 0.4760827
	speed: 0.2999s/iter; left time: 4092.2007s
	iters: 400, epoch: 2 | loss: 0.4517902
	speed: 0.2994s/iter; left time: 4055.4138s
	iters: 500, epoch: 2 | loss: 0.5022107
	speed: 0.3009s/iter; left time: 4046.2590s
	iters: 600, epoch: 2 | loss: 0.4933418
	speed: 0.2995s/iter; left time: 3997.5396s
	iters: 700, epoch: 2 | loss: 0.4211322
	speed: 0.3002s/iter; left time: 3976.3213s
Epoch: 2 cost time: 219.99309706687927
Epoch: 2, Steps: 734 | Train Loss: 0.4728553 Vali Loss: 0.6298920 Test Loss: 0.7479401
Validation loss decreased (0.641748 --> 0.629892).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.3220857
	speed: 0.6028s/iter; left time: 7903.9479s
	iters: 200, epoch: 3 | loss: 0.3454311
	speed: 0.2997s/iter; left time: 3899.6964s
	iters: 300, epoch: 3 | loss: 0.3190018
	speed: 0.3008s/iter; left time: 3884.2222s
	iters: 400, epoch: 3 | loss: 0.3374029
	speed: 0.2999s/iter; left time: 3842.9849s
	iters: 500, epoch: 3 | loss: 0.3230637
	speed: 0.2994s/iter; left time: 3806.2192s
	iters: 600, epoch: 3 | loss: 0.3360962
	speed: 0.2998s/iter; left time: 3781.0844s
	iters: 700, epoch: 3 | loss: 0.3384936
	speed: 0.3002s/iter; left time: 3756.2982s
Epoch: 3 cost time: 220.14127039909363
Epoch: 3, Steps: 734 | Train Loss: 0.3297096 Vali Loss: 0.4589629 Test Loss: 0.5589954
Validation loss decreased (0.629892 --> 0.458963).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.2807843
	speed: 0.6070s/iter; left time: 7513.5607s
	iters: 200, epoch: 4 | loss: 0.2713034
	speed: 0.2990s/iter; left time: 3671.3792s
	iters: 300, epoch: 4 | loss: 0.2606458
	speed: 0.3002s/iter; left time: 3655.6552s
	iters: 400, epoch: 4 | loss: 0.3013576
	speed: 0.3001s/iter; left time: 3624.9627s
	iters: 500, epoch: 4 | loss: 0.2721661
	speed: 0.2998s/iter; left time: 3591.0672s
	iters: 600, epoch: 4 | loss: 0.3035817
	speed: 0.2998s/iter; left time: 3561.4119s
	iters: 700, epoch: 4 | loss: 0.2982478
	speed: 0.2999s/iter; left time: 3532.3835s
Epoch: 4 cost time: 220.1106345653534
Epoch: 4, Steps: 734 | Train Loss: 0.2825888 Vali Loss: 0.4005094 Test Loss: 0.4914423
Validation loss decreased (0.458963 --> 0.400509).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.2590445
	speed: 0.6047s/iter; left time: 7041.2567s
	iters: 200, epoch: 5 | loss: 0.2423106
	speed: 0.3001s/iter; left time: 3464.1193s
	iters: 300, epoch: 5 | loss: 0.2724911
	speed: 0.3012s/iter; left time: 3447.0058s
	iters: 400, epoch: 5 | loss: 0.2471542
	speed: 0.2995s/iter; left time: 3397.8475s
	iters: 500, epoch: 5 | loss: 0.2761502
	speed: 0.2998s/iter; left time: 3371.4778s
	iters: 600, epoch: 5 | loss: 0.2561705
	speed: 0.2998s/iter; left time: 3341.6266s
	iters: 700, epoch: 5 | loss: 0.2818788
	speed: 0.2995s/iter; left time: 3307.7197s
Epoch: 5 cost time: 220.12750554084778
Epoch: 5, Steps: 734 | Train Loss: 0.2614417 Vali Loss: 0.3772419 Test Loss: 0.4643606
Validation loss decreased (0.400509 --> 0.377242).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.2680525
	speed: 0.6060s/iter; left time: 6611.5894s
	iters: 200, epoch: 6 | loss: 0.2637973
	speed: 0.2997s/iter; left time: 3240.0444s
	iters: 300, epoch: 6 | loss: 0.2218850
	speed: 0.3004s/iter; left time: 3217.2820s
	iters: 400, epoch: 6 | loss: 0.2426847
	speed: 0.2993s/iter; left time: 3175.6906s
	iters: 500, epoch: 6 | loss: 0.2548858
	speed: 0.3020s/iter; left time: 3174.5418s
	iters: 600, epoch: 6 | loss: 0.2341860
	speed: 0.3021s/iter; left time: 3145.2653s
	iters: 700, epoch: 6 | loss: 0.2233705
	speed: 0.3014s/iter; left time: 3108.2357s
Epoch: 6 cost time: 220.766047000885
Epoch: 6, Steps: 734 | Train Loss: 0.2505373 Vali Loss: 0.3664402 Test Loss: 0.4519856
Validation loss decreased (0.377242 --> 0.366440).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.2368135
	speed: 0.6072s/iter; left time: 6179.5860s
	iters: 200, epoch: 7 | loss: 0.2199080
	speed: 0.3003s/iter; left time: 3026.5484s
	iters: 300, epoch: 7 | loss: 0.2416403
	speed: 0.2990s/iter; left time: 2983.0665s
	iters: 400, epoch: 7 | loss: 0.2191125
	speed: 0.3000s/iter; left time: 2963.2110s
	iters: 500, epoch: 7 | loss: 0.2463888
	speed: 0.3001s/iter; left time: 2934.2389s
	iters: 600, epoch: 7 | loss: 0.2446923
	speed: 0.3051s/iter; left time: 2952.2681s
	iters: 700, epoch: 7 | loss: 0.2351457
	speed: 0.3101s/iter; left time: 2969.6156s
Epoch: 7 cost time: 222.09159421920776
Epoch: 7, Steps: 734 | Train Loss: 0.2446365 Vali Loss: 0.3605241 Test Loss: 0.4451577
Validation loss decreased (0.366440 --> 0.360524).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.2349815
	speed: 0.6159s/iter; left time: 5815.8391s
	iters: 200, epoch: 8 | loss: 0.2170472
	speed: 0.3015s/iter; left time: 2817.1716s
	iters: 300, epoch: 8 | loss: 0.2759086
	speed: 0.3001s/iter; left time: 2773.5798s
	iters: 400, epoch: 8 | loss: 0.2308075
	speed: 0.2996s/iter; left time: 2739.4412s
	iters: 500, epoch: 8 | loss: 0.2333138
	speed: 0.2994s/iter; left time: 2707.3799s
	iters: 600, epoch: 8 | loss: 0.2426416
	speed: 0.3003s/iter; left time: 2685.6985s
	iters: 700, epoch: 8 | loss: 0.2215230
	speed: 0.3069s/iter; left time: 2713.6587s
Epoch: 8 cost time: 221.27555632591248
Epoch: 8, Steps: 734 | Train Loss: 0.2414070 Vali Loss: 0.3578902 Test Loss: 0.4417242
Validation loss decreased (0.360524 --> 0.357890).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.2580910
	speed: 0.6135s/iter; left time: 5342.6156s
	iters: 200, epoch: 9 | loss: 0.2025484
	speed: 0.3007s/iter; left time: 2589.0206s
	iters: 300, epoch: 9 | loss: 0.2583984
	speed: 0.3001s/iter; left time: 2553.2892s
	iters: 400, epoch: 9 | loss: 0.2183682
	speed: 0.3061s/iter; left time: 2574.3382s
	iters: 500, epoch: 9 | loss: 0.2383989
	speed: 0.3004s/iter; left time: 2495.8385s
	iters: 600, epoch: 9 | loss: 0.2364223
	speed: 0.2995s/iter; left time: 2458.7936s
	iters: 700, epoch: 9 | loss: 0.2398610
	speed: 0.3050s/iter; left time: 2473.5692s
Epoch: 9 cost time: 221.68370938301086
Epoch: 9, Steps: 734 | Train Loss: 0.2395646 Vali Loss: 0.3567073 Test Loss: 0.4401138
Validation loss decreased (0.357890 --> 0.356707).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.2155814
	speed: 0.6082s/iter; left time: 4849.9994s
	iters: 200, epoch: 10 | loss: 0.2089356
	speed: 0.3017s/iter; left time: 2375.9186s
	iters: 300, epoch: 10 | loss: 0.2395602
	speed: 0.3021s/iter; left time: 2349.2090s
	iters: 400, epoch: 10 | loss: 0.2285407
	speed: 0.3214s/iter; left time: 2466.5686s
	iters: 500, epoch: 10 | loss: 0.2528287
	speed: 0.3024s/iter; left time: 2290.6589s
	iters: 600, epoch: 10 | loss: 0.2486930
	speed: 0.3045s/iter; left time: 2275.9326s
	iters: 700, epoch: 10 | loss: 0.2276472
	speed: 0.3101s/iter; left time: 2287.2463s
Epoch: 10 cost time: 224.73330903053284
Epoch: 10, Steps: 734 | Train Loss: 0.2385972 Vali Loss: 0.3560781 Test Loss: 0.4395193
Validation loss decreased (0.356707 --> 0.356078).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.2248228
	speed: 0.6219s/iter; left time: 4503.3645s
	iters: 200, epoch: 11 | loss: 0.2373100
	speed: 0.3020s/iter; left time: 2156.6785s
	iters: 300, epoch: 11 | loss: 0.2532172
	speed: 0.3060s/iter; left time: 2154.5214s
	iters: 400, epoch: 11 | loss: 0.2668777
	speed: 0.3018s/iter; left time: 2094.9738s
	iters: 500, epoch: 11 | loss: 0.2419665
	speed: 0.3042s/iter; left time: 2081.1892s
	iters: 600, epoch: 11 | loss: 0.2312610
	speed: 0.3046s/iter; left time: 2053.4635s
	iters: 700, epoch: 11 | loss: 0.2215501
	speed: 0.3011s/iter; left time: 1999.5537s
Epoch: 11 cost time: 222.6208643913269
Epoch: 11, Steps: 734 | Train Loss: 0.2380734 Vali Loss: 0.3556473 Test Loss: 0.4391767
Validation loss decreased (0.356078 --> 0.355647).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.2275737
	speed: 0.6118s/iter; left time: 3980.8539s
	iters: 200, epoch: 12 | loss: 0.2242688
	speed: 0.3020s/iter; left time: 1935.1065s
	iters: 300, epoch: 12 | loss: 0.2535264
	speed: 0.3012s/iter; left time: 1899.5655s
	iters: 400, epoch: 12 | loss: 0.2453999
	speed: 0.3002s/iter; left time: 1863.6335s
	iters: 500, epoch: 12 | loss: 0.2353460
	speed: 0.2997s/iter; left time: 1830.3903s
	iters: 600, epoch: 12 | loss: 0.2078531
	speed: 0.2999s/iter; left time: 1801.7593s
	iters: 700, epoch: 12 | loss: 0.2196151
	speed: 0.3000s/iter; left time: 1771.9171s
Epoch: 12 cost time: 220.85784435272217
Epoch: 12, Steps: 734 | Train Loss: 0.2377895 Vali Loss: 0.3555837 Test Loss: 0.4390341
Validation loss decreased (0.355647 --> 0.355584).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.2441824
	speed: 0.6101s/iter; left time: 3522.3380s
	iters: 200, epoch: 13 | loss: 0.2400214
	speed: 0.3008s/iter; left time: 1706.2774s
	iters: 300, epoch: 13 | loss: 0.2674961
	speed: 0.3012s/iter; left time: 1678.8610s
	iters: 400, epoch: 13 | loss: 0.2352955
	speed: 0.3017s/iter; left time: 1651.4088s
	iters: 500, epoch: 13 | loss: 0.2241342
	speed: 0.3026s/iter; left time: 1626.0768s
	iters: 600, epoch: 13 | loss: 0.2162934
	speed: 0.3008s/iter; left time: 1585.8768s
	iters: 700, epoch: 13 | loss: 0.2453835
	speed: 0.3017s/iter; left time: 1560.4479s
Epoch: 13 cost time: 221.41924667358398
Epoch: 13, Steps: 734 | Train Loss: 0.2376577 Vali Loss: 0.3552566 Test Loss: 0.4389523
Validation loss decreased (0.355584 --> 0.355257).  Saving model ...
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 14 | loss: 0.2182334
	speed: 0.6086s/iter; left time: 3066.5340s
	iters: 200, epoch: 14 | loss: 0.2214814
	speed: 0.3012s/iter; left time: 1487.4973s
	iters: 300, epoch: 14 | loss: 0.2569496
	speed: 0.2991s/iter; left time: 1447.5392s
	iters: 400, epoch: 14 | loss: 0.2576800
	speed: 0.2999s/iter; left time: 1421.0889s
	iters: 500, epoch: 14 | loss: 0.2599022
	speed: 0.3000s/iter; left time: 1391.8345s
	iters: 600, epoch: 14 | loss: 0.2291166
	speed: 0.3003s/iter; left time: 1362.9258s
	iters: 700, epoch: 14 | loss: 0.2156287
	speed: 0.2998s/iter; left time: 1330.6249s
Epoch: 14 cost time: 220.36088728904724
Epoch: 14, Steps: 734 | Train Loss: 0.2375336 Vali Loss: 0.3553430 Test Loss: 0.4389381
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 15 | loss: 0.2448664
	speed: 0.6057s/iter; left time: 2607.5162s
	iters: 200, epoch: 15 | loss: 0.2420972
	speed: 0.3008s/iter; left time: 1264.9513s
	iters: 300, epoch: 15 | loss: 0.2691036
	speed: 0.3009s/iter; left time: 1235.3012s
	iters: 400, epoch: 15 | loss: 0.2254758
	speed: 0.3017s/iter; left time: 1208.1257s
	iters: 500, epoch: 15 | loss: 0.2551561
	speed: 0.2998s/iter; left time: 1170.7752s
	iters: 600, epoch: 15 | loss: 0.2583145
	speed: 0.3013s/iter; left time: 1146.5914s
	iters: 700, epoch: 15 | loss: 0.2372770
	speed: 0.3022s/iter; left time: 1119.7133s
Epoch: 15 cost time: 220.95034670829773
Epoch: 15, Steps: 734 | Train Loss: 0.2374760 Vali Loss: 0.3555343 Test Loss: 0.4389276
EarlyStopping counter: 2 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 16 | loss: 0.2511130
	speed: 0.6047s/iter; left time: 2159.2340s
	iters: 200, epoch: 16 | loss: 0.2454863
	speed: 0.3001s/iter; left time: 1041.6512s
	iters: 300, epoch: 16 | loss: 0.2497433
	speed: 0.3027s/iter; left time: 1020.4192s
	iters: 400, epoch: 16 | loss: 0.2564081
	speed: 0.3009s/iter; left time: 984.3568s
	iters: 500, epoch: 16 | loss: 0.2252457
	speed: 0.3000s/iter; left time: 951.3220s
	iters: 600, epoch: 16 | loss: 0.2113576
	speed: 0.2994s/iter; left time: 919.4546s
	iters: 700, epoch: 16 | loss: 0.2547671
	speed: 0.3022s/iter; left time: 897.8076s
Epoch: 16 cost time: 220.82149028778076
Epoch: 16, Steps: 734 | Train Loss: 0.2375037 Vali Loss: 0.3555524 Test Loss: 0.4389267
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 17 | loss: 0.2526684
	speed: 0.6082s/iter; left time: 1725.4246s
	iters: 200, epoch: 17 | loss: 0.2352867
	speed: 0.3030s/iter; left time: 829.3205s
	iters: 300, epoch: 17 | loss: 0.2712587
	speed: 0.3005s/iter; left time: 792.4335s
	iters: 400, epoch: 17 | loss: 0.2330534
	speed: 0.3000s/iter; left time: 761.0212s
	iters: 500, epoch: 17 | loss: 0.2418783
	speed: 0.3006s/iter; left time: 732.4442s
	iters: 600, epoch: 17 | loss: 0.2422658
	speed: 0.2996s/iter; left time: 700.2578s
	iters: 700, epoch: 17 | loss: 0.2622172
	speed: 0.2996s/iter; left time: 670.1544s
Epoch: 17 cost time: 220.771803855896
Epoch: 17, Steps: 734 | Train Loss: 0.2374734 Vali Loss: 0.3555997 Test Loss: 0.4389264
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 18 | loss: 0.2445543
	speed: 0.6061s/iter; left time: 1274.6079s
	iters: 200, epoch: 18 | loss: 0.2417522
	speed: 0.3006s/iter; left time: 602.1334s
	iters: 300, epoch: 18 | loss: 0.2616997
	speed: 0.2991s/iter; left time: 569.2341s
	iters: 400, epoch: 18 | loss: 0.2487118
	speed: 0.3016s/iter; left time: 543.7026s
	iters: 500, epoch: 18 | loss: 0.2496694
	speed: 0.3002s/iter; left time: 511.3144s
	iters: 600, epoch: 18 | loss: 0.2420967
	speed: 0.3008s/iter; left time: 482.1310s
	iters: 700, epoch: 18 | loss: 0.2363485
	speed: 0.3002s/iter; left time: 451.2312s
Epoch: 18 cost time: 220.840327501297
Epoch: 18, Steps: 734 | Train Loss: 0.2374759 Vali Loss: 0.3554633 Test Loss: 0.4389260
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : traffic_336_192_Linear_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed32598<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3317
mse:0.43864351511001587, mae:0.30406132340431213
