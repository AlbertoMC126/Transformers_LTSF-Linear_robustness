Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTh2', data_path='ETTh2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.05, loss='mse', lradj='type1', model='DLinear', model_id='ETTh2_96_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=15349, seq_len=96, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTh2_96_96_DLinear_ETTh2_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15349>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8449
data_set:  <data_provider.data_loader.Dataset_ETT_hour object at 0x00000218A7220550>
val 2785
data_set:  <data_provider.data_loader.Dataset_ETT_hour object at 0x00000218F47F6DD8>
test 2785
data_set:  <data_provider.data_loader.Dataset_ETT_hour object at 0x00000218A7220208>
Total number of trainable parameters: 130368
Total number of parameters: 130368
	iters: 100, epoch: 1 | loss: 0.5462658
	speed: 0.0040s/iter; left time: 41.6715s
	iters: 200, epoch: 1 | loss: 0.4441842
	speed: 0.0045s/iter; left time: 46.9092s
	iters: 300, epoch: 1 | loss: 1.7082609
	speed: 0.0048s/iter; left time: 49.1379s
	iters: 400, epoch: 1 | loss: 0.9924150
	speed: 0.0041s/iter; left time: 41.1584s
	iters: 500, epoch: 1 | loss: 0.5694844
	speed: 0.0042s/iter; left time: 41.8738s
Epoch: 1 cost time: 2.268616199493408
Epoch: 1, Steps: 528 | Train Loss: 1.3673394 Vali Loss: 0.7870718 Test Loss: 1.3935623
Validation loss decreased (inf --> 0.787072).  Saving model ...
Updating learning rate to 0.05
	iters: 100, epoch: 2 | loss: 1.0632682
	speed: 0.0114s/iter; left time: 113.1326s
	iters: 200, epoch: 2 | loss: 2.5841420
	speed: 0.0042s/iter; left time: 41.4100s
	iters: 300, epoch: 2 | loss: 0.7969821
	speed: 0.0049s/iter; left time: 48.1338s
	iters: 400, epoch: 2 | loss: 1.9953977
	speed: 0.0055s/iter; left time: 52.5031s
	iters: 500, epoch: 2 | loss: 1.0518279
	speed: 0.0049s/iter; left time: 46.7724s
Epoch: 2 cost time: 2.4883642196655273
Epoch: 2, Steps: 528 | Train Loss: 1.4747454 Vali Loss: 2.6613693 Test Loss: 3.7753007
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.025
	iters: 100, epoch: 3 | loss: 0.5546651
	speed: 0.0110s/iter; left time: 103.1532s
	iters: 200, epoch: 3 | loss: 0.9564235
	speed: 0.0053s/iter; left time: 49.5331s
	iters: 300, epoch: 3 | loss: 0.6274942
	speed: 0.0040s/iter; left time: 36.5188s
	iters: 400, epoch: 3 | loss: 0.6657972
	speed: 0.0044s/iter; left time: 40.5009s
	iters: 500, epoch: 3 | loss: 1.2617368
	speed: 0.0041s/iter; left time: 37.1217s
Epoch: 3 cost time: 2.381431818008423
Epoch: 3, Steps: 528 | Train Loss: 0.6405850 Vali Loss: 0.4033788 Test Loss: 0.7726337
Validation loss decreased (0.787072 --> 0.403379).  Saving model ...
Updating learning rate to 0.0125
	iters: 100, epoch: 4 | loss: 0.3644167
	speed: 0.0136s/iter; left time: 121.1480s
	iters: 200, epoch: 4 | loss: 0.3203407
	speed: 0.0052s/iter; left time: 45.4193s
	iters: 300, epoch: 4 | loss: 1.1830504
	speed: 0.0046s/iter; left time: 40.0674s
	iters: 400, epoch: 4 | loss: 0.4013713
	speed: 0.0048s/iter; left time: 40.7600s
	iters: 500, epoch: 4 | loss: 0.5570106
	speed: 0.0049s/iter; left time: 41.3913s
Epoch: 4 cost time: 2.680447578430176
Epoch: 4, Steps: 528 | Train Loss: 0.4751721 Vali Loss: 0.5896299 Test Loss: 1.4702854
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00625
	iters: 100, epoch: 5 | loss: 0.1952036
	speed: 0.0103s/iter; left time: 86.2822s
	iters: 200, epoch: 5 | loss: 0.4169635
	speed: 0.0042s/iter; left time: 34.3558s
	iters: 300, epoch: 5 | loss: 0.6991338
	speed: 0.0040s/iter; left time: 32.2068s
	iters: 400, epoch: 5 | loss: 0.3449001
	speed: 0.0041s/iter; left time: 33.0485s
	iters: 500, epoch: 5 | loss: 0.2701715
	speed: 0.0048s/iter; left time: 37.7631s
Epoch: 5 cost time: 2.1760621070861816
Epoch: 5, Steps: 528 | Train Loss: 0.4217715 Vali Loss: 0.2838850 Test Loss: 0.5013624
Validation loss decreased (0.403379 --> 0.283885).  Saving model ...
Updating learning rate to 0.003125
	iters: 100, epoch: 6 | loss: 0.2411629
	speed: 0.0112s/iter; left time: 87.7691s
	iters: 200, epoch: 6 | loss: 0.2505197
	speed: 0.0039s/iter; left time: 30.2847s
	iters: 300, epoch: 6 | loss: 0.2871838
	speed: 0.0034s/iter; left time: 26.1305s
	iters: 400, epoch: 6 | loss: 0.3843284
	speed: 0.0040s/iter; left time: 30.3740s
	iters: 500, epoch: 6 | loss: 1.0748256
	speed: 0.0045s/iter; left time: 33.2187s
Epoch: 6 cost time: 2.230120897293091
Epoch: 6, Steps: 528 | Train Loss: 0.3991305 Vali Loss: 0.3731316 Test Loss: 0.8043759
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0015625
	iters: 100, epoch: 7 | loss: 0.1333441
	speed: 0.0111s/iter; left time: 81.2472s
	iters: 200, epoch: 7 | loss: 0.1548393
	speed: 0.0040s/iter; left time: 28.8634s
	iters: 300, epoch: 7 | loss: 0.3211066
	speed: 0.0037s/iter; left time: 25.9083s
	iters: 400, epoch: 7 | loss: 0.4132549
	speed: 0.0040s/iter; left time: 28.2354s
	iters: 500, epoch: 7 | loss: 0.5794880
	speed: 0.0038s/iter; left time: 26.2982s
Epoch: 7 cost time: 2.139214515686035
Epoch: 7, Steps: 528 | Train Loss: 0.3854953 Vali Loss: 0.2738893 Test Loss: 0.4703962
Validation loss decreased (0.283885 --> 0.273889).  Saving model ...
Updating learning rate to 0.00078125
	iters: 100, epoch: 8 | loss: 0.1855202
	speed: 0.0097s/iter; left time: 65.4007s
	iters: 200, epoch: 8 | loss: 0.2657265
	speed: 0.0032s/iter; left time: 21.3875s
	iters: 300, epoch: 8 | loss: 0.1986272
	speed: 0.0045s/iter; left time: 29.4187s
	iters: 400, epoch: 8 | loss: 0.2331743
	speed: 0.0051s/iter; left time: 32.6503s
	iters: 500, epoch: 8 | loss: 0.1347294
	speed: 0.0042s/iter; left time: 27.0321s
Epoch: 8 cost time: 2.2343225479125977
Epoch: 8, Steps: 528 | Train Loss: 0.3768595 Vali Loss: 0.3018113 Test Loss: 0.5808119
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.000390625
	iters: 100, epoch: 9 | loss: 0.9470277
	speed: 0.0083s/iter; left time: 51.5367s
	iters: 200, epoch: 9 | loss: 0.4177165
	speed: 0.0051s/iter; left time: 31.5480s
	iters: 300, epoch: 9 | loss: 0.2532902
	speed: 0.0053s/iter; left time: 32.2384s
	iters: 400, epoch: 9 | loss: 0.2941944
	speed: 0.0058s/iter; left time: 34.7281s
	iters: 500, epoch: 9 | loss: 0.4347200
	speed: 0.0052s/iter; left time: 30.2083s
Epoch: 9 cost time: 2.7525370121002197
Epoch: 9, Steps: 528 | Train Loss: 0.3725862 Vali Loss: 0.2832127 Test Loss: 0.5119237
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.0001953125
	iters: 100, epoch: 10 | loss: 0.2443439
	speed: 0.0107s/iter; left time: 60.9247s
	iters: 200, epoch: 10 | loss: 0.1834200
	speed: 0.0049s/iter; left time: 27.5819s
	iters: 300, epoch: 10 | loss: 0.5551337
	speed: 0.0043s/iter; left time: 23.7465s
	iters: 400, epoch: 10 | loss: 0.2747130
	speed: 0.0040s/iter; left time: 21.3758s
	iters: 500, epoch: 10 | loss: 0.6676899
	speed: 0.0043s/iter; left time: 22.6467s
Epoch: 10 cost time: 2.282764196395874
Epoch: 10, Steps: 528 | Train Loss: 0.3701495 Vali Loss: 0.3395193 Test Loss: 0.6998809
EarlyStopping counter: 3 out of 5
Updating learning rate to 9.765625e-05
	iters: 100, epoch: 11 | loss: 0.2502935
	speed: 0.0105s/iter; left time: 54.5473s
	iters: 200, epoch: 11 | loss: 0.2749684
	speed: 0.0035s/iter; left time: 17.9017s
	iters: 300, epoch: 11 | loss: 0.3673857
	speed: 0.0040s/iter; left time: 19.7989s
	iters: 400, epoch: 11 | loss: 0.2105598
	speed: 0.0038s/iter; left time: 18.4156s
	iters: 500, epoch: 11 | loss: 0.2881760
	speed: 0.0029s/iter; left time: 14.0598s
Epoch: 11 cost time: 2.0049352645874023
Epoch: 11, Steps: 528 | Train Loss: 0.3688583 Vali Loss: 0.2996725 Test Loss: 0.5645261
EarlyStopping counter: 4 out of 5
Updating learning rate to 4.8828125e-05
	iters: 100, epoch: 12 | loss: 0.3237391
	speed: 0.0066s/iter; left time: 30.6434s
	iters: 200, epoch: 12 | loss: 0.1761860
	speed: 0.0029s/iter; left time: 13.3992s
	iters: 300, epoch: 12 | loss: 0.1698423
	speed: 0.0026s/iter; left time: 11.7775s
	iters: 400, epoch: 12 | loss: 0.2712785
	speed: 0.0026s/iter; left time: 11.3126s
	iters: 500, epoch: 12 | loss: 0.7921072
	speed: 0.0027s/iter; left time: 11.3409s
Epoch: 12 cost time: 1.4267747402191162
Epoch: 12, Steps: 528 | Train Loss: 0.3681709 Vali Loss: 0.3004735 Test Loss: 0.5676211
EarlyStopping counter: 5 out of 5
Early stopping
Total training time: 32.5178 seconds
>>>>>>>testing : ETTh2_96_96_DLinear_ETTh2_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15349<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
data_set:  <data_provider.data_loader.Dataset_ETT_hour object at 0x00000218A7213860>
mse:0.47225627303123474, mae:0.44438642263412476
