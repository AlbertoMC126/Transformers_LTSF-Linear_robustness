Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='DLinear', model_id='ETTm2_336_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=336, root_path='./dataset/', save_pred_values=False, seed=15726, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTm2_336_336_DLinear_ETTm2_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15726>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33889
val 11185
test 11185
	iters: 100, epoch: 1 | loss: 0.7124547
	speed: 0.0158s/iter; left time: 332.2978s
	iters: 200, epoch: 1 | loss: 0.5841516
	speed: 0.0173s/iter; left time: 361.9290s
	iters: 300, epoch: 1 | loss: 0.7235765
	speed: 0.0163s/iter; left time: 340.6871s
	iters: 400, epoch: 1 | loss: 0.4267313
	speed: 0.0178s/iter; left time: 370.1262s
	iters: 500, epoch: 1 | loss: 0.3391147
	speed: 0.0171s/iter; left time: 353.9091s
	iters: 600, epoch: 1 | loss: 0.5411274
	speed: 0.0181s/iter; left time: 371.7896s
	iters: 700, epoch: 1 | loss: 0.3556150
	speed: 0.0177s/iter; left time: 361.6364s
	iters: 800, epoch: 1 | loss: 0.6879004
	speed: 0.0170s/iter; left time: 346.4167s
	iters: 900, epoch: 1 | loss: 0.4217159
	speed: 0.0167s/iter; left time: 338.2021s
	iters: 1000, epoch: 1 | loss: 0.5211216
	speed: 0.0166s/iter; left time: 334.4940s
Epoch: 1 cost time: 18.01432466506958
Epoch: 1, Steps: 1059 | Train Loss: 0.6547422 Vali Loss: 0.3521747 Test Loss: 0.6150854
Validation loss decreased (inf --> 0.352175).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.3616183
	speed: 0.0629s/iter; left time: 1260.0313s
	iters: 200, epoch: 2 | loss: 0.4953185
	speed: 0.0168s/iter; left time: 334.7744s
	iters: 300, epoch: 2 | loss: 0.5805280
	speed: 0.0162s/iter; left time: 320.3838s
	iters: 400, epoch: 2 | loss: 0.4753219
	speed: 0.0165s/iter; left time: 326.0984s
	iters: 500, epoch: 2 | loss: 0.8150097
	speed: 0.0162s/iter; left time: 318.7602s
	iters: 600, epoch: 2 | loss: 0.4655840
	speed: 0.0166s/iter; left time: 323.1732s
	iters: 700, epoch: 2 | loss: 0.5167366
	speed: 0.0167s/iter; left time: 323.8840s
	iters: 800, epoch: 2 | loss: 0.3754475
	speed: 0.0173s/iter; left time: 335.1705s
	iters: 900, epoch: 2 | loss: 0.5586864
	speed: 0.0171s/iter; left time: 327.7774s
	iters: 1000, epoch: 2 | loss: 1.0087669
	speed: 0.0167s/iter; left time: 319.2507s
Epoch: 2 cost time: 17.45956778526306
Epoch: 2, Steps: 1059 | Train Loss: 0.6453926 Vali Loss: 0.5932611 Test Loss: 1.2763671
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.6111910
	speed: 0.0620s/iter; left time: 1174.7780s
	iters: 200, epoch: 3 | loss: 0.6254082
	speed: 0.0178s/iter; left time: 336.4099s
	iters: 300, epoch: 3 | loss: 0.4495157
	speed: 0.0171s/iter; left time: 320.3856s
	iters: 400, epoch: 3 | loss: 0.4722891
	speed: 0.0178s/iter; left time: 331.7742s
	iters: 500, epoch: 3 | loss: 0.4194716
	speed: 0.0180s/iter; left time: 334.9991s
	iters: 600, epoch: 3 | loss: 0.3217726
	speed: 0.0157s/iter; left time: 289.6048s
	iters: 700, epoch: 3 | loss: 0.3698593
	speed: 0.0156s/iter; left time: 287.0586s
	iters: 800, epoch: 3 | loss: 0.3530035
	speed: 0.0182s/iter; left time: 332.8658s
	iters: 900, epoch: 3 | loss: 0.5559435
	speed: 0.0171s/iter; left time: 309.7869s
	iters: 1000, epoch: 3 | loss: 0.5209469
	speed: 0.0172s/iter; left time: 310.6020s
Epoch: 3 cost time: 17.978161573410034
Epoch: 3, Steps: 1059 | Train Loss: 0.4683179 Vali Loss: 0.5841771 Test Loss: 1.5451641
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.3565714
	speed: 0.0652s/iter; left time: 1167.7117s
	iters: 200, epoch: 4 | loss: 0.4528414
	speed: 0.0173s/iter; left time: 307.4140s
	iters: 300, epoch: 4 | loss: 0.3565719
	speed: 0.0171s/iter; left time: 302.5139s
	iters: 400, epoch: 4 | loss: 0.4518281
	speed: 0.0174s/iter; left time: 305.4763s
	iters: 500, epoch: 4 | loss: 0.2558804
	speed: 0.0166s/iter; left time: 290.1452s
	iters: 600, epoch: 4 | loss: 0.6045361
	speed: 0.0176s/iter; left time: 305.6176s
	iters: 700, epoch: 4 | loss: 0.3068892
	speed: 0.0178s/iter; left time: 308.7278s
	iters: 800, epoch: 4 | loss: 0.3372265
	speed: 0.0179s/iter; left time: 307.4779s
	iters: 900, epoch: 4 | loss: 0.3279259
	speed: 0.0168s/iter; left time: 287.9912s
	iters: 1000, epoch: 4 | loss: 0.2645771
	speed: 0.0175s/iter; left time: 296.7847s
Epoch: 4 cost time: 18.17340612411499
Epoch: 4, Steps: 1059 | Train Loss: 0.4033515 Vali Loss: 0.3019427 Test Loss: 0.5561548
Validation loss decreased (0.352175 --> 0.301943).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.2046795
	speed: 0.0623s/iter; left time: 1049.3815s
	iters: 200, epoch: 5 | loss: 0.4838682
	speed: 0.0180s/iter; left time: 302.0012s
	iters: 300, epoch: 5 | loss: 0.3044381
	speed: 0.0181s/iter; left time: 300.5732s
	iters: 400, epoch: 5 | loss: 0.4955663
	speed: 0.0175s/iter; left time: 290.1478s
	iters: 500, epoch: 5 | loss: 0.3140862
	speed: 0.0168s/iter; left time: 276.3918s
	iters: 600, epoch: 5 | loss: 0.3924581
	speed: 0.0177s/iter; left time: 289.2777s
	iters: 700, epoch: 5 | loss: 0.4962716
	speed: 0.0180s/iter; left time: 291.8466s
	iters: 800, epoch: 5 | loss: 0.3002829
	speed: 0.0180s/iter; left time: 290.4026s
	iters: 900, epoch: 5 | loss: 0.4992769
	speed: 0.0174s/iter; left time: 279.8140s
	iters: 1000, epoch: 5 | loss: 0.3503141
	speed: 0.0164s/iter; left time: 261.0426s
Epoch: 5 cost time: 18.461549282073975
Epoch: 5, Steps: 1059 | Train Loss: 0.3780999 Vali Loss: 0.4331775 Test Loss: 0.9935499
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.1812942
	speed: 0.0651s/iter; left time: 1027.4643s
	iters: 200, epoch: 6 | loss: 0.4602244
	speed: 0.0187s/iter; left time: 292.8542s
	iters: 300, epoch: 6 | loss: 0.2835349
	speed: 0.0167s/iter; left time: 259.7947s
	iters: 400, epoch: 6 | loss: 0.2986479
	speed: 0.0170s/iter; left time: 263.5104s
	iters: 500, epoch: 6 | loss: 0.5027179
	speed: 0.0152s/iter; left time: 233.1283s
	iters: 600, epoch: 6 | loss: 0.3140104
	speed: 0.0166s/iter; left time: 253.2242s
	iters: 700, epoch: 6 | loss: 0.3179249
	speed: 0.0172s/iter; left time: 261.8443s
	iters: 800, epoch: 6 | loss: 0.4317429
	speed: 0.0169s/iter; left time: 254.8958s
	iters: 900, epoch: 6 | loss: 0.3656307
	speed: 0.0177s/iter; left time: 264.9016s
	iters: 1000, epoch: 6 | loss: 0.4640728
	speed: 0.0167s/iter; left time: 249.1070s
Epoch: 6 cost time: 17.87759280204773
Epoch: 6, Steps: 1059 | Train Loss: 0.3632908 Vali Loss: 0.3328062 Test Loss: 0.6931903
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.3370058
	speed: 0.0547s/iter; left time: 805.0263s
	iters: 200, epoch: 7 | loss: 0.2884087
	speed: 0.0171s/iter; left time: 249.5148s
	iters: 300, epoch: 7 | loss: 0.2128426
	speed: 0.0159s/iter; left time: 231.1821s
	iters: 400, epoch: 7 | loss: 0.5157644
	speed: 0.0166s/iter; left time: 239.3021s
	iters: 500, epoch: 7 | loss: 0.3314252
	speed: 0.0159s/iter; left time: 227.9082s
	iters: 600, epoch: 7 | loss: 0.3122885
	speed: 0.0168s/iter; left time: 238.9135s
	iters: 700, epoch: 7 | loss: 0.2846080
	speed: 0.0147s/iter; left time: 208.0451s
	iters: 800, epoch: 7 | loss: 0.2264967
	speed: 0.0166s/iter; left time: 233.4974s
	iters: 900, epoch: 7 | loss: 0.2120441
	speed: 0.0175s/iter; left time: 244.0746s
	iters: 1000, epoch: 7 | loss: 0.3041663
	speed: 0.0167s/iter; left time: 230.8946s
Epoch: 7 cost time: 17.216193914413452
Epoch: 7, Steps: 1059 | Train Loss: 0.3571291 Vali Loss: 0.2762593 Test Loss: 0.4905787
Validation loss decreased (0.301943 --> 0.276259).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.2546169
	speed: 0.0619s/iter; left time: 845.6773s
	iters: 200, epoch: 8 | loss: 0.5451579
	speed: 0.0158s/iter; left time: 214.4681s
	iters: 300, epoch: 8 | loss: 0.1730087
	speed: 0.0156s/iter; left time: 209.4606s
	iters: 400, epoch: 8 | loss: 0.2516918
	speed: 0.0169s/iter; left time: 225.4470s
	iters: 500, epoch: 8 | loss: 0.3711392
	speed: 0.0178s/iter; left time: 235.6045s
	iters: 600, epoch: 8 | loss: 0.2077659
	speed: 0.0176s/iter; left time: 231.2584s
	iters: 700, epoch: 8 | loss: 0.2977260
	speed: 0.0185s/iter; left time: 241.5901s
	iters: 800, epoch: 8 | loss: 0.6076235
	speed: 0.0164s/iter; left time: 212.1428s
	iters: 900, epoch: 8 | loss: 0.2136527
	speed: 0.0161s/iter; left time: 207.0719s
	iters: 1000, epoch: 8 | loss: 0.2780301
	speed: 0.0170s/iter; left time: 216.4772s
Epoch: 8 cost time: 17.692296028137207
Epoch: 8, Steps: 1059 | Train Loss: 0.3527936 Vali Loss: 0.2576045 Test Loss: 0.4510938
Validation loss decreased (0.276259 --> 0.257604).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.2749805
	speed: 0.0632s/iter; left time: 796.3366s
	iters: 200, epoch: 9 | loss: 0.6991877
	speed: 0.0162s/iter; left time: 202.8403s
	iters: 300, epoch: 9 | loss: 0.4120472
	speed: 0.0161s/iter; left time: 199.2010s
	iters: 400, epoch: 9 | loss: 0.2577917
	speed: 0.0176s/iter; left time: 216.8041s
	iters: 500, epoch: 9 | loss: 0.3126132
	speed: 0.0175s/iter; left time: 213.1307s
	iters: 600, epoch: 9 | loss: 0.3284086
	speed: 0.0160s/iter; left time: 193.5782s
	iters: 700, epoch: 9 | loss: 0.4946519
	speed: 0.0175s/iter; left time: 209.8533s
	iters: 800, epoch: 9 | loss: 0.5092314
	speed: 0.0163s/iter; left time: 194.0477s
	iters: 900, epoch: 9 | loss: 0.3662156
	speed: 0.0163s/iter; left time: 192.3098s
	iters: 1000, epoch: 9 | loss: 0.4965008
	speed: 0.0162s/iter; left time: 189.5899s
Epoch: 9 cost time: 17.33081889152527
Epoch: 9, Steps: 1059 | Train Loss: 0.3503304 Vali Loss: 0.2510979 Test Loss: 0.4289914
Validation loss decreased (0.257604 --> 0.251098).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.2351221
	speed: 0.0585s/iter; left time: 675.3949s
	iters: 200, epoch: 10 | loss: 0.2250114
	speed: 0.0162s/iter; left time: 185.3209s
	iters: 300, epoch: 10 | loss: 0.2146189
	speed: 0.0162s/iter; left time: 183.8081s
	iters: 400, epoch: 10 | loss: 0.4448555
	speed: 0.0180s/iter; left time: 202.4103s
	iters: 500, epoch: 10 | loss: 0.3232919
	speed: 0.0163s/iter; left time: 181.6959s
	iters: 600, epoch: 10 | loss: 0.2102129
	speed: 0.0170s/iter; left time: 187.6828s
	iters: 700, epoch: 10 | loss: 0.4227306
	speed: 0.0160s/iter; left time: 175.2496s
	iters: 800, epoch: 10 | loss: 0.4221010
	speed: 0.0169s/iter; left time: 183.4243s
	iters: 900, epoch: 10 | loss: 0.4195094
	speed: 0.0172s/iter; left time: 184.5672s
	iters: 1000, epoch: 10 | loss: 0.2705487
	speed: 0.0173s/iter; left time: 184.4679s
Epoch: 10 cost time: 17.557628631591797
Epoch: 10, Steps: 1059 | Train Loss: 0.3491409 Vali Loss: 0.2807655 Test Loss: 0.5184370
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.5300302
	speed: 0.0640s/iter; left time: 671.5941s
	iters: 200, epoch: 11 | loss: 0.4128570
	speed: 0.0149s/iter; left time: 154.5272s
	iters: 300, epoch: 11 | loss: 0.2857455
	speed: 0.0150s/iter; left time: 154.4200s
	iters: 400, epoch: 11 | loss: 0.2666327
	speed: 0.0160s/iter; left time: 162.8648s
	iters: 500, epoch: 11 | loss: 0.2469331
	speed: 0.0167s/iter; left time: 168.4254s
	iters: 600, epoch: 11 | loss: 0.4168812
	speed: 0.0164s/iter; left time: 163.8913s
	iters: 700, epoch: 11 | loss: 0.3619952
	speed: 0.0164s/iter; left time: 161.7212s
	iters: 800, epoch: 11 | loss: 0.3211965
	speed: 0.0165s/iter; left time: 161.6847s
	iters: 900, epoch: 11 | loss: 0.3253558
	speed: 0.0165s/iter; left time: 160.1453s
	iters: 1000, epoch: 11 | loss: 0.2178478
	speed: 0.0165s/iter; left time: 157.7929s
Epoch: 11 cost time: 16.81900978088379
Epoch: 11, Steps: 1059 | Train Loss: 0.3483685 Vali Loss: 0.2831663 Test Loss: 0.5284359
EarlyStopping counter: 2 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.2286832
	speed: 0.0590s/iter; left time: 556.8649s
	iters: 200, epoch: 12 | loss: 0.2267212
	speed: 0.0140s/iter; left time: 130.5007s
	iters: 300, epoch: 12 | loss: 0.3703895
	speed: 0.0151s/iter; left time: 139.6742s
	iters: 400, epoch: 12 | loss: 0.2834030
	speed: 0.0155s/iter; left time: 141.7629s
	iters: 500, epoch: 12 | loss: 0.3283215
	speed: 0.0147s/iter; left time: 133.1406s
	iters: 600, epoch: 12 | loss: 0.4716462
	speed: 0.0159s/iter; left time: 141.6270s
	iters: 700, epoch: 12 | loss: 0.2473931
	speed: 0.0150s/iter; left time: 132.6774s
	iters: 800, epoch: 12 | loss: 0.2409946
	speed: 0.0151s/iter; left time: 131.5539s
	iters: 900, epoch: 12 | loss: 0.3628608
	speed: 0.0150s/iter; left time: 129.4318s
	iters: 1000, epoch: 12 | loss: 0.3162054
	speed: 0.0150s/iter; left time: 128.0538s
Epoch: 12 cost time: 15.831519603729248
Epoch: 12, Steps: 1059 | Train Loss: 0.3480751 Vali Loss: 0.2832335 Test Loss: 0.5311044
EarlyStopping counter: 3 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.1841988
	speed: 0.0649s/iter; left time: 543.7214s
	iters: 200, epoch: 13 | loss: 0.2297535
	speed: 0.0148s/iter; left time: 122.2113s
	iters: 300, epoch: 13 | loss: 0.3343369
	speed: 0.0142s/iter; left time: 116.4576s
	iters: 400, epoch: 13 | loss: 0.2988376
	speed: 0.0134s/iter; left time: 108.1246s
	iters: 500, epoch: 13 | loss: 0.3271382
	speed: 0.0148s/iter; left time: 117.8179s
	iters: 600, epoch: 13 | loss: 0.4004572
	speed: 0.0147s/iter; left time: 115.7530s
	iters: 700, epoch: 13 | loss: 0.4347081
	speed: 0.0144s/iter; left time: 112.0779s
	iters: 800, epoch: 13 | loss: 0.3078215
	speed: 0.0140s/iter; left time: 107.0598s
	iters: 900, epoch: 13 | loss: 0.2492288
	speed: 0.0140s/iter; left time: 105.6943s
	iters: 1000, epoch: 13 | loss: 0.2182129
	speed: 0.0142s/iter; left time: 106.1460s
Epoch: 13 cost time: 15.10817551612854
Epoch: 13, Steps: 1059 | Train Loss: 0.3478571 Vali Loss: 0.2775237 Test Loss: 0.5111613
EarlyStopping counter: 4 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 14 | loss: 0.3633965
	speed: 0.0538s/iter; left time: 393.6764s
	iters: 200, epoch: 14 | loss: 0.3476309
	speed: 0.0132s/iter; left time: 95.3970s
	iters: 300, epoch: 14 | loss: 0.1806827
	speed: 0.0133s/iter; left time: 94.9280s
	iters: 400, epoch: 14 | loss: 0.3060281
	speed: 0.0134s/iter; left time: 94.1458s
	iters: 500, epoch: 14 | loss: 0.4604395
	speed: 0.0135s/iter; left time: 93.1274s
	iters: 600, epoch: 14 | loss: 0.3787992
	speed: 0.0133s/iter; left time: 90.4381s
	iters: 700, epoch: 14 | loss: 0.2642071
	speed: 0.0138s/iter; left time: 92.6731s
	iters: 800, epoch: 14 | loss: 0.2276980
	speed: 0.0135s/iter; left time: 89.5410s
	iters: 900, epoch: 14 | loss: 0.2323298
	speed: 0.0134s/iter; left time: 87.1753s
	iters: 1000, epoch: 14 | loss: 0.3026501
	speed: 0.0133s/iter; left time: 85.3411s
Epoch: 14 cost time: 14.159510850906372
Epoch: 14, Steps: 1059 | Train Loss: 0.3477656 Vali Loss: 0.2810718 Test Loss: 0.5237111
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTm2_336_336_DLinear_ETTm2_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15726<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
mse:0.4294147491455078, mae:0.4275873303413391
