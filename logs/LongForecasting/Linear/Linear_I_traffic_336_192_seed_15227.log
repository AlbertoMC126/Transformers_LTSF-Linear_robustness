Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='Linear', model_id='traffic_336_192', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=192, root_path='./dataset/', save_pred_values=False, seed=15227, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_336_192_Linear_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15227>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11753
val 1565
test 3317
	iters: 100, epoch: 1 | loss: 0.4259965
	speed: 0.3159s/iter; left time: 4606.8337s
	iters: 200, epoch: 1 | loss: 0.4755946
	speed: 0.3048s/iter; left time: 4414.3244s
	iters: 300, epoch: 1 | loss: 0.4820787
	speed: 0.3039s/iter; left time: 4370.2448s
	iters: 400, epoch: 1 | loss: 0.4902421
	speed: 0.3034s/iter; left time: 4332.4928s
	iters: 500, epoch: 1 | loss: 0.4459346
	speed: 0.3030s/iter; left time: 4296.6081s
	iters: 600, epoch: 1 | loss: 0.4580071
	speed: 0.3028s/iter; left time: 4263.6523s
	iters: 700, epoch: 1 | loss: 0.4313753
	speed: 0.3028s/iter; left time: 4233.8875s
Epoch: 1 cost time: 224.0934202671051
Epoch: 1, Steps: 734 | Train Loss: 0.4809258 Vali Loss: 0.6263950 Test Loss: 0.7503067
Validation loss decreased (inf --> 0.626395).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.4425749
	speed: 0.6079s/iter; left time: 8417.5411s
	iters: 200, epoch: 2 | loss: 0.4879357
	speed: 0.3033s/iter; left time: 4169.7240s
	iters: 300, epoch: 2 | loss: 0.4751721
	speed: 0.3049s/iter; left time: 4160.7872s
	iters: 400, epoch: 2 | loss: 0.4874069
	speed: 0.3047s/iter; left time: 4128.0871s
	iters: 500, epoch: 2 | loss: 0.4695538
	speed: 0.3040s/iter; left time: 4087.8495s
	iters: 600, epoch: 2 | loss: 0.4498337
	speed: 0.3039s/iter; left time: 4055.7813s
	iters: 700, epoch: 2 | loss: 0.4572063
	speed: 0.3035s/iter; left time: 4020.4150s
Epoch: 2 cost time: 223.2382891178131
Epoch: 2, Steps: 734 | Train Loss: 0.4728431 Vali Loss: 0.6352689 Test Loss: 0.7595249
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.3248701
	speed: 0.6078s/iter; left time: 7970.3380s
	iters: 200, epoch: 3 | loss: 0.3214165
	speed: 0.3045s/iter; left time: 3962.1583s
	iters: 300, epoch: 3 | loss: 0.2986624
	speed: 0.3049s/iter; left time: 3937.4378s
	iters: 400, epoch: 3 | loss: 0.3402766
	speed: 0.3049s/iter; left time: 3907.2761s
	iters: 500, epoch: 3 | loss: 0.3556962
	speed: 0.3049s/iter; left time: 3876.0745s
	iters: 600, epoch: 3 | loss: 0.3522402
	speed: 0.3048s/iter; left time: 3844.7577s
	iters: 700, epoch: 3 | loss: 0.3074314
	speed: 0.3043s/iter; left time: 3808.0814s
Epoch: 3 cost time: 223.43022561073303
Epoch: 3, Steps: 734 | Train Loss: 0.3303236 Vali Loss: 0.4605695 Test Loss: 0.5600280
Validation loss decreased (0.626395 --> 0.460569).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.2858285
	speed: 0.6099s/iter; left time: 7550.2836s
	iters: 200, epoch: 4 | loss: 0.2844339
	speed: 0.3037s/iter; left time: 3729.2246s
	iters: 300, epoch: 4 | loss: 0.2777131
	speed: 0.3038s/iter; left time: 3700.4625s
	iters: 400, epoch: 4 | loss: 0.2842820
	speed: 0.3030s/iter; left time: 3659.6284s
	iters: 500, epoch: 4 | loss: 0.2922191
	speed: 0.3045s/iter; left time: 3647.4975s
	iters: 600, epoch: 4 | loss: 0.2896282
	speed: 0.3045s/iter; left time: 3617.0734s
	iters: 700, epoch: 4 | loss: 0.2844822
	speed: 0.3036s/iter; left time: 3575.6149s
Epoch: 4 cost time: 222.985009431839
Epoch: 4, Steps: 734 | Train Loss: 0.2826565 Vali Loss: 0.3990412 Test Loss: 0.4912912
Validation loss decreased (0.460569 --> 0.399041).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.2852192
	speed: 0.6134s/iter; left time: 7142.7090s
	iters: 200, epoch: 5 | loss: 0.2553178
	speed: 0.3030s/iter; left time: 3498.5961s
	iters: 300, epoch: 5 | loss: 0.2662546
	speed: 0.3038s/iter; left time: 3477.0758s
	iters: 400, epoch: 5 | loss: 0.2568708
	speed: 0.3054s/iter; left time: 3464.8996s
	iters: 500, epoch: 5 | loss: 0.2936535
	speed: 0.3051s/iter; left time: 3430.7889s
	iters: 600, epoch: 5 | loss: 0.2597622
	speed: 0.3053s/iter; left time: 3402.6248s
	iters: 700, epoch: 5 | loss: 0.2542693
	speed: 0.3059s/iter; left time: 3379.1274s
Epoch: 5 cost time: 223.60810494422913
Epoch: 5, Steps: 734 | Train Loss: 0.2613724 Vali Loss: 0.3786653 Test Loss: 0.4649554
Validation loss decreased (0.399041 --> 0.378665).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.2535270
	speed: 0.6121s/iter; left time: 6679.0036s
	iters: 200, epoch: 6 | loss: 0.2492240
	speed: 0.3033s/iter; left time: 3279.3688s
	iters: 300, epoch: 6 | loss: 0.2204771
	speed: 0.3032s/iter; left time: 3247.3307s
	iters: 400, epoch: 6 | loss: 0.2675950
	speed: 0.3024s/iter; left time: 3208.7244s
	iters: 500, epoch: 6 | loss: 0.2341577
	speed: 0.3020s/iter; left time: 3174.0530s
	iters: 600, epoch: 6 | loss: 0.2434014
	speed: 0.3032s/iter; left time: 3156.8789s
	iters: 700, epoch: 6 | loss: 0.2358098
	speed: 0.3040s/iter; left time: 3134.3611s
Epoch: 6 cost time: 222.60238814353943
Epoch: 6, Steps: 734 | Train Loss: 0.2506437 Vali Loss: 0.3655193 Test Loss: 0.4514551
Validation loss decreased (0.378665 --> 0.365519).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.2455312
	speed: 0.6125s/iter; left time: 6233.3138s
	iters: 200, epoch: 7 | loss: 0.2462641
	speed: 0.3037s/iter; left time: 3059.8895s
	iters: 300, epoch: 7 | loss: 0.2580099
	speed: 0.3049s/iter; left time: 3041.9673s
	iters: 400, epoch: 7 | loss: 0.2690505
	speed: 0.3059s/iter; left time: 3021.3756s
	iters: 500, epoch: 7 | loss: 0.2370121
	speed: 0.3052s/iter; left time: 2983.5015s
	iters: 600, epoch: 7 | loss: 0.2456136
	speed: 0.3041s/iter; left time: 2942.9810s
	iters: 700, epoch: 7 | loss: 0.2176941
	speed: 0.3046s/iter; left time: 2917.6116s
Epoch: 7 cost time: 223.58400082588196
Epoch: 7, Steps: 734 | Train Loss: 0.2446638 Vali Loss: 0.3601188 Test Loss: 0.4444170
Validation loss decreased (0.365519 --> 0.360119).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.2289117
	speed: 0.6117s/iter; left time: 5775.9275s
	iters: 200, epoch: 8 | loss: 0.2418947
	speed: 0.3032s/iter; left time: 2833.1079s
	iters: 300, epoch: 8 | loss: 0.2477227
	speed: 0.3045s/iter; left time: 2814.0731s
	iters: 400, epoch: 8 | loss: 0.2277090
	speed: 0.3032s/iter; left time: 2771.8168s
	iters: 500, epoch: 8 | loss: 0.2497504
	speed: 0.3024s/iter; left time: 2734.9210s
	iters: 600, epoch: 8 | loss: 0.2485977
	speed: 0.3038s/iter; left time: 2717.0440s
	iters: 700, epoch: 8 | loss: 0.2309149
	speed: 0.3028s/iter; left time: 2677.6777s
Epoch: 8 cost time: 222.82022380828857
Epoch: 8, Steps: 734 | Train Loss: 0.2414053 Vali Loss: 0.3577299 Test Loss: 0.4418171
Validation loss decreased (0.360119 --> 0.357730).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.2463553
	speed: 0.6139s/iter; left time: 5346.4518s
	iters: 200, epoch: 9 | loss: 0.2490305
	speed: 0.3040s/iter; left time: 2617.2662s
	iters: 300, epoch: 9 | loss: 0.2488657
	speed: 0.3021s/iter; left time: 2570.3082s
	iters: 400, epoch: 9 | loss: 0.2443218
	speed: 0.3037s/iter; left time: 2553.5633s
	iters: 500, epoch: 9 | loss: 0.2356603
	speed: 0.3035s/iter; left time: 2521.9690s
	iters: 600, epoch: 9 | loss: 0.2427025
	speed: 0.3045s/iter; left time: 2499.8372s
	iters: 700, epoch: 9 | loss: 0.2563338
	speed: 0.3046s/iter; left time: 2470.1495s
Epoch: 9 cost time: 223.1200475692749
Epoch: 9, Steps: 734 | Train Loss: 0.2395696 Vali Loss: 0.3565880 Test Loss: 0.4400254
Validation loss decreased (0.357730 --> 0.356588).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.2195837
	speed: 0.6123s/iter; left time: 4882.8706s
	iters: 200, epoch: 10 | loss: 0.2278582
	speed: 0.3045s/iter; left time: 2397.9193s
	iters: 300, epoch: 10 | loss: 0.2325636
	speed: 0.3030s/iter; left time: 2355.8518s
	iters: 400, epoch: 10 | loss: 0.2365928
	speed: 0.3043s/iter; left time: 2335.7445s
	iters: 500, epoch: 10 | loss: 0.2138439
	speed: 0.3044s/iter; left time: 2305.8436s
	iters: 600, epoch: 10 | loss: 0.2247240
	speed: 0.3050s/iter; left time: 2280.2133s
	iters: 700, epoch: 10 | loss: 0.2685225
	speed: 0.3054s/iter; left time: 2252.5460s
Epoch: 10 cost time: 223.55819821357727
Epoch: 10, Steps: 734 | Train Loss: 0.2385389 Vali Loss: 0.3559572 Test Loss: 0.4393409
Validation loss decreased (0.356588 --> 0.355957).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.2503544
	speed: 0.6157s/iter; left time: 4458.2288s
	iters: 200, epoch: 11 | loss: 0.2567406
	speed: 0.3064s/iter; left time: 2188.2832s
	iters: 300, epoch: 11 | loss: 0.2268623
	speed: 0.3055s/iter; left time: 2151.0090s
	iters: 400, epoch: 11 | loss: 0.2646260
	speed: 0.3044s/iter; left time: 2112.9221s
	iters: 500, epoch: 11 | loss: 0.2320219
	speed: 0.3047s/iter; left time: 2084.3982s
	iters: 600, epoch: 11 | loss: 0.2370425
	speed: 0.3049s/iter; left time: 2055.1638s
	iters: 700, epoch: 11 | loss: 0.2588926
	speed: 0.3040s/iter; left time: 2018.9301s
Epoch: 11 cost time: 223.977224111557
Epoch: 11, Steps: 734 | Train Loss: 0.2380504 Vali Loss: 0.3556032 Test Loss: 0.4391481
Validation loss decreased (0.355957 --> 0.355603).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.2080336
	speed: 0.6126s/iter; left time: 3986.3454s
	iters: 200, epoch: 12 | loss: 0.2476127
	speed: 0.3050s/iter; left time: 1953.8742s
	iters: 300, epoch: 12 | loss: 0.2458446
	speed: 0.3046s/iter; left time: 1921.0174s
	iters: 400, epoch: 12 | loss: 0.2499545
	speed: 0.3054s/iter; left time: 1895.8616s
	iters: 500, epoch: 12 | loss: 0.2213838
	speed: 0.3038s/iter; left time: 1855.4730s
	iters: 600, epoch: 12 | loss: 0.2273274
	speed: 0.3040s/iter; left time: 1825.8726s
	iters: 700, epoch: 12 | loss: 0.2287425
	speed: 0.3042s/iter; left time: 1796.9410s
Epoch: 12 cost time: 223.55585384368896
Epoch: 12, Steps: 734 | Train Loss: 0.2377822 Vali Loss: 0.3552586 Test Loss: 0.4389829
Validation loss decreased (0.355603 --> 0.355259).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.2321408
	speed: 0.6123s/iter; left time: 3534.9699s
	iters: 200, epoch: 13 | loss: 0.2490926
	speed: 0.3050s/iter; left time: 1730.1952s
	iters: 300, epoch: 13 | loss: 0.2289927
	speed: 0.3061s/iter; left time: 1705.7700s
	iters: 400, epoch: 13 | loss: 0.2349216
	speed: 0.3050s/iter; left time: 1669.2715s
	iters: 500, epoch: 13 | loss: 0.2613925
	speed: 0.3057s/iter; left time: 1642.5878s
	iters: 600, epoch: 13 | loss: 0.2341366
	speed: 0.3058s/iter; left time: 1612.3668s
	iters: 700, epoch: 13 | loss: 0.2608550
	speed: 0.3047s/iter; left time: 1575.9549s
Epoch: 13 cost time: 224.0034532546997
Epoch: 13, Steps: 734 | Train Loss: 0.2376356 Vali Loss: 0.3552563 Test Loss: 0.4389429
Validation loss decreased (0.355259 --> 0.355256).  Saving model ...
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 14 | loss: 0.2307068
	speed: 0.6161s/iter; left time: 3104.3456s
	iters: 200, epoch: 14 | loss: 0.2507708
	speed: 0.3058s/iter; left time: 1510.1892s
	iters: 300, epoch: 14 | loss: 0.2233868
	speed: 0.3075s/iter; left time: 1487.9723s
	iters: 400, epoch: 14 | loss: 0.2200256
	speed: 0.3074s/iter; left time: 1456.7329s
	iters: 500, epoch: 14 | loss: 0.2163636
	speed: 0.3081s/iter; left time: 1429.0690s
	iters: 600, epoch: 14 | loss: 0.2200244
	speed: 0.3066s/iter; left time: 1391.5740s
	iters: 700, epoch: 14 | loss: 0.2672010
	speed: 0.3050s/iter; left time: 1354.1155s
Epoch: 14 cost time: 225.10173630714417
Epoch: 14, Steps: 734 | Train Loss: 0.2375822 Vali Loss: 0.3554669 Test Loss: 0.4389154
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 15 | loss: 0.2319210
	speed: 0.6109s/iter; left time: 2629.7646s
	iters: 200, epoch: 15 | loss: 0.2669270
	speed: 0.3043s/iter; left time: 1279.4063s
	iters: 300, epoch: 15 | loss: 0.2612422
	speed: 0.3041s/iter; left time: 1248.1903s
	iters: 400, epoch: 15 | loss: 0.2464779
	speed: 0.3040s/iter; left time: 1217.3307s
	iters: 500, epoch: 15 | loss: 0.2660140
	speed: 0.3042s/iter; left time: 1188.0055s
	iters: 600, epoch: 15 | loss: 0.2480270
	speed: 0.3040s/iter; left time: 1156.8907s
	iters: 700, epoch: 15 | loss: 0.2581169
	speed: 0.3054s/iter; left time: 1131.6850s
Epoch: 15 cost time: 223.44992470741272
Epoch: 15, Steps: 734 | Train Loss: 0.2374387 Vali Loss: 0.3551815 Test Loss: 0.4389144
Validation loss decreased (0.355256 --> 0.355181).  Saving model ...
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 16 | loss: 0.2267402
	speed: 0.6152s/iter; left time: 2197.0421s
	iters: 200, epoch: 16 | loss: 0.2257863
	speed: 0.3061s/iter; left time: 1062.5115s
	iters: 300, epoch: 16 | loss: 0.2245626
	speed: 0.3052s/iter; left time: 1028.9475s
	iters: 400, epoch: 16 | loss: 0.2346534
	speed: 0.3050s/iter; left time: 997.5784s
	iters: 500, epoch: 16 | loss: 0.2133422
	speed: 0.3053s/iter; left time: 968.1927s
	iters: 600, epoch: 16 | loss: 0.2308652
	speed: 0.3045s/iter; left time: 935.2490s
	iters: 700, epoch: 16 | loss: 0.2263013
	speed: 0.3058s/iter; left time: 908.4444s
Epoch: 16 cost time: 224.1297857761383
Epoch: 16, Steps: 734 | Train Loss: 0.2374996 Vali Loss: 0.3551134 Test Loss: 0.4389128
Validation loss decreased (0.355181 --> 0.355113).  Saving model ...
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 17 | loss: 0.2277257
	speed: 0.6134s/iter; left time: 1740.2151s
	iters: 200, epoch: 17 | loss: 0.2578709
	speed: 0.3048s/iter; left time: 834.2318s
	iters: 300, epoch: 17 | loss: 0.2397147
	speed: 0.3041s/iter; left time: 801.8288s
	iters: 400, epoch: 17 | loss: 0.2580235
	speed: 0.3039s/iter; left time: 771.0216s
	iters: 500, epoch: 17 | loss: 0.2449797
	speed: 0.3037s/iter; left time: 740.0750s
	iters: 600, epoch: 17 | loss: 0.2353939
	speed: 0.3029s/iter; left time: 707.7638s
	iters: 700, epoch: 17 | loss: 0.2583201
	speed: 0.3028s/iter; left time: 677.2944s
Epoch: 17 cost time: 222.94530582427979
Epoch: 17, Steps: 734 | Train Loss: 0.2374747 Vali Loss: 0.3550901 Test Loss: 0.4389127
Validation loss decreased (0.355113 --> 0.355090).  Saving model ...
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 18 | loss: 0.2510099
	speed: 0.6111s/iter; left time: 1285.2307s
	iters: 200, epoch: 18 | loss: 0.2278496
	speed: 0.3045s/iter; left time: 609.8748s
	iters: 300, epoch: 18 | loss: 0.2200509
	speed: 0.3060s/iter; left time: 582.3067s
	iters: 400, epoch: 18 | loss: 0.2215717
	speed: 0.3047s/iter; left time: 549.4581s
	iters: 500, epoch: 18 | loss: 0.2359003
	speed: 0.3034s/iter; left time: 516.7389s
	iters: 600, epoch: 18 | loss: 0.2174687
	speed: 0.3037s/iter; left time: 486.7775s
	iters: 700, epoch: 18 | loss: 0.2325948
	speed: 0.3027s/iter; left time: 454.9325s
Epoch: 18 cost time: 223.19891786575317
Epoch: 18, Steps: 734 | Train Loss: 0.2374416 Vali Loss: 0.3553247 Test Loss: 0.4389125
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 19 | loss: 0.2289880
	speed: 0.6106s/iter; left time: 835.9337s
	iters: 200, epoch: 19 | loss: 0.2419930
	speed: 0.3034s/iter; left time: 385.0397s
	iters: 300, epoch: 19 | loss: 0.2661107
	speed: 0.3036s/iter; left time: 354.8856s
	iters: 400, epoch: 19 | loss: 0.2186341
	speed: 0.3041s/iter; left time: 325.0935s
	iters: 500, epoch: 19 | loss: 0.2312538
	speed: 0.3041s/iter; left time: 294.7001s
	iters: 600, epoch: 19 | loss: 0.2175189
	speed: 0.3047s/iter; left time: 264.7713s
	iters: 700, epoch: 19 | loss: 0.2274681
	speed: 0.3040s/iter; left time: 233.7602s
Epoch: 19 cost time: 223.17902946472168
Epoch: 19, Steps: 734 | Train Loss: 0.2374539 Vali Loss: 0.3549566 Test Loss: 0.4389122
Validation loss decreased (0.355090 --> 0.354957).  Saving model ...
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 20 | loss: 0.2569597
	speed: 0.6106s/iter; left time: 387.7026s
	iters: 200, epoch: 20 | loss: 0.2605380
	speed: 0.3046s/iter; left time: 162.9721s
	iters: 300, epoch: 20 | loss: 0.2396752
	speed: 0.3046s/iter; left time: 132.4995s
	iters: 400, epoch: 20 | loss: 0.2345871
	speed: 0.3046s/iter; left time: 102.0386s
	iters: 500, epoch: 20 | loss: 0.2449897
	speed: 0.3041s/iter; left time: 71.4636s
	iters: 600, epoch: 20 | loss: 0.2430342
	speed: 0.3043s/iter; left time: 41.0807s
	iters: 700, epoch: 20 | loss: 0.2129459
	speed: 0.3041s/iter; left time: 10.6424s
Epoch: 20 cost time: 223.41628289222717
Epoch: 20, Steps: 734 | Train Loss: 0.2374590 Vali Loss: 0.3554355 Test Loss: 0.4389122
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.9073486328125e-08
>>>>>>>testing : traffic_336_192_Linear_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15227<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3317
mse:0.4386042058467865, mae:0.30401045083999634
