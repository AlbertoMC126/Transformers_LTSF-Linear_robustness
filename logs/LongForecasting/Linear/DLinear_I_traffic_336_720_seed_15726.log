Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='DLinear', model_id='traffic_336_720', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=720, root_path='./dataset/', save_pred_values=False, seed=15726, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_336_720_DLinear_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15726>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11225
val 1037
test 2789
	iters: 100, epoch: 1 | loss: 0.5853086
	speed: 0.6049s/iter; left time: 8421.3624s
	iters: 200, epoch: 1 | loss: 0.5704886
	speed: 0.5760s/iter; left time: 7960.4067s
	iters: 300, epoch: 1 | loss: 0.5860347
	speed: 0.5855s/iter; left time: 8034.2430s
	iters: 400, epoch: 1 | loss: 0.6068263
	speed: 0.5709s/iter; left time: 7775.6151s
	iters: 500, epoch: 1 | loss: 0.5885323
	speed: 0.5824s/iter; left time: 7874.7172s
	iters: 600, epoch: 1 | loss: 0.6094622
	speed: 0.5723s/iter; left time: 7680.8243s
	iters: 700, epoch: 1 | loss: 0.5964691
	speed: 0.5791s/iter; left time: 7714.6098s
Epoch: 1 cost time: 408.10194516181946
Epoch: 1, Steps: 701 | Train Loss: 0.6189961 Vali Loss: 0.8325278 Test Loss: 0.9710827
Validation loss decreased (inf --> 0.832528).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.5898560
	speed: 1.0939s/iter; left time: 14461.1869s
	iters: 200, epoch: 2 | loss: 0.5778374
	speed: 0.5719s/iter; left time: 7502.8124s
	iters: 300, epoch: 2 | loss: 0.6109800
	speed: 0.5794s/iter; left time: 7544.1055s
	iters: 400, epoch: 2 | loss: 0.5818537
	speed: 0.5789s/iter; left time: 7479.0344s
	iters: 500, epoch: 2 | loss: 0.6473077
	speed: 0.5822s/iter; left time: 7463.7729s
	iters: 600, epoch: 2 | loss: 0.6173164
	speed: 0.5737s/iter; left time: 7296.9961s
	iters: 700, epoch: 2 | loss: 0.5912083
	speed: 0.5786s/iter; left time: 7301.4316s
Epoch: 2 cost time: 405.17594504356384
Epoch: 2, Steps: 701 | Train Loss: 0.6143283 Vali Loss: 0.8744101 Test Loss: 1.0087398
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.3691427
	speed: 1.0111s/iter; left time: 12657.4812s
	iters: 200, epoch: 3 | loss: 0.3841814
	speed: 0.5840s/iter; left time: 7252.3697s
	iters: 300, epoch: 3 | loss: 0.3910011
	speed: 0.5737s/iter; left time: 7067.3744s
	iters: 400, epoch: 3 | loss: 0.3943657
	speed: 0.5787s/iter; left time: 7070.5254s
	iters: 500, epoch: 3 | loss: 0.3802944
	speed: 0.5743s/iter; left time: 6959.9083s
	iters: 600, epoch: 3 | loss: 0.3801943
	speed: 0.5896s/iter; left time: 7086.7057s
	iters: 700, epoch: 3 | loss: 0.3926747
	speed: 0.5755s/iter; left time: 6859.7057s
Epoch: 3 cost time: 406.13321232795715
Epoch: 3, Steps: 701 | Train Loss: 0.3904823 Vali Loss: 0.5664544 Test Loss: 0.6550772
Validation loss decreased (0.832528 --> 0.566454).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.3052948
	speed: 1.1040s/iter; left time: 13047.5573s
	iters: 200, epoch: 4 | loss: 0.3121852
	speed: 0.5826s/iter; left time: 6827.4631s
	iters: 300, epoch: 4 | loss: 0.3287364
	speed: 0.5731s/iter; left time: 6658.2108s
	iters: 400, epoch: 4 | loss: 0.3148182
	speed: 0.5758s/iter; left time: 6631.5472s
	iters: 500, epoch: 4 | loss: 0.3472707
	speed: 0.5754s/iter; left time: 6569.8827s
	iters: 600, epoch: 4 | loss: 0.3483619
	speed: 0.5872s/iter; left time: 6645.4047s
	iters: 700, epoch: 4 | loss: 0.3376029
	speed: 0.5745s/iter; left time: 6444.8229s
Epoch: 4 cost time: 404.8670747280121
Epoch: 4, Steps: 701 | Train Loss: 0.3245463 Vali Loss: 0.4879825 Test Loss: 0.5680915
Validation loss decreased (0.566454 --> 0.487983).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.2853473
	speed: 1.0987s/iter; left time: 12214.4330s
	iters: 200, epoch: 5 | loss: 0.3076001
	speed: 0.5758s/iter; left time: 6344.0951s
	iters: 300, epoch: 5 | loss: 0.3081218
	speed: 0.5802s/iter; left time: 6333.6582s
	iters: 400, epoch: 5 | loss: 0.2739489
	speed: 0.5835s/iter; left time: 6311.2769s
	iters: 500, epoch: 5 | loss: 0.2919310
	speed: 0.5804s/iter; left time: 6220.4025s
	iters: 600, epoch: 5 | loss: 0.2927234
	speed: 0.5759s/iter; left time: 6114.5391s
	iters: 700, epoch: 5 | loss: 0.3070168
	speed: 0.5814s/iter; left time: 6114.6435s
Epoch: 5 cost time: 405.79576301574707
Epoch: 5, Steps: 701 | Train Loss: 0.2966745 Vali Loss: 0.4519352 Test Loss: 0.5208083
Validation loss decreased (0.487983 --> 0.451935).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.2896582
	speed: 1.1106s/iter; left time: 11568.3422s
	iters: 200, epoch: 6 | loss: 0.2668820
	speed: 0.5822s/iter; left time: 6005.7887s
	iters: 300, epoch: 6 | loss: 0.3189471
	speed: 0.5879s/iter; left time: 6006.0227s
	iters: 400, epoch: 6 | loss: 0.2985710
	speed: 0.5728s/iter; left time: 5794.6151s
	iters: 500, epoch: 6 | loss: 0.2899376
	speed: 0.5850s/iter; left time: 5859.4127s
	iters: 600, epoch: 6 | loss: 0.2718993
	speed: 0.5697s/iter; left time: 5648.8774s
	iters: 700, epoch: 6 | loss: 0.2747803
	speed: 0.5804s/iter; left time: 5697.1137s
Epoch: 6 cost time: 406.9769003391266
Epoch: 6, Steps: 701 | Train Loss: 0.2823975 Vali Loss: 0.4357523 Test Loss: 0.5029225
Validation loss decreased (0.451935 --> 0.435752).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.2670185
	speed: 1.1101s/iter; left time: 10784.3187s
	iters: 200, epoch: 7 | loss: 0.2561105
	speed: 0.5791s/iter; left time: 5567.6308s
	iters: 300, epoch: 7 | loss: 0.2614338
	speed: 0.5799s/iter; left time: 5517.9403s
	iters: 400, epoch: 7 | loss: 0.2848101
	speed: 0.5671s/iter; left time: 5339.5559s
	iters: 500, epoch: 7 | loss: 0.2832452
	speed: 0.5740s/iter; left time: 5346.6852s
	iters: 600, epoch: 7 | loss: 0.2679844
	speed: 0.5689s/iter; left time: 5242.3451s
	iters: 700, epoch: 7 | loss: 0.2880310
	speed: 0.5716s/iter; left time: 5209.9001s
Epoch: 7 cost time: 403.0801246166229
Epoch: 7, Steps: 701 | Train Loss: 0.2747203 Vali Loss: 0.4273626 Test Loss: 0.4910085
Validation loss decreased (0.435752 --> 0.427363).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.2876991
	speed: 1.0865s/iter; left time: 9793.3278s
	iters: 200, epoch: 8 | loss: 0.2760266
	speed: 0.5761s/iter; left time: 5135.5188s
	iters: 300, epoch: 8 | loss: 0.2798919
	speed: 0.6079s/iter; left time: 5357.7159s
	iters: 400, epoch: 8 | loss: 0.2572889
	speed: 0.5982s/iter; left time: 5212.3558s
	iters: 500, epoch: 8 | loss: 0.2590357
	speed: 0.5896s/iter; left time: 5078.9246s
	iters: 600, epoch: 8 | loss: 0.3005892
	speed: 0.5859s/iter; left time: 4988.1014s
	iters: 700, epoch: 8 | loss: 0.2536349
	speed: 0.5865s/iter; left time: 4935.1300s
Epoch: 8 cost time: 412.16671109199524
Epoch: 8, Steps: 701 | Train Loss: 0.2705167 Vali Loss: 0.4239054 Test Loss: 0.4864630
Validation loss decreased (0.427363 --> 0.423905).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.2904029
	speed: 1.1179s/iter; left time: 9293.5045s
	iters: 200, epoch: 9 | loss: 0.2603238
	speed: 0.5873s/iter; left time: 4823.8212s
	iters: 300, epoch: 9 | loss: 0.2733122
	speed: 0.5816s/iter; left time: 4718.6768s
	iters: 400, epoch: 9 | loss: 0.2744847
	speed: 0.5854s/iter; left time: 4691.1727s
	iters: 500, epoch: 9 | loss: 0.2609583
	speed: 0.5969s/iter; left time: 4723.5648s
	iters: 600, epoch: 9 | loss: 0.2579852
	speed: 0.5815s/iter; left time: 4543.4403s
	iters: 700, epoch: 9 | loss: 0.2620813
	speed: 0.5821s/iter; left time: 4489.7486s
Epoch: 9 cost time: 410.4164979457855
Epoch: 9, Steps: 701 | Train Loss: 0.2682093 Vali Loss: 0.4219209 Test Loss: 0.4854136
Validation loss decreased (0.423905 --> 0.421921).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.2515240
	speed: 1.1210s/iter; left time: 8533.2924s
	iters: 200, epoch: 10 | loss: 0.2456652
	speed: 0.5845s/iter; left time: 4390.8111s
	iters: 300, epoch: 10 | loss: 0.2731905
	speed: 0.5744s/iter; left time: 4257.7828s
	iters: 400, epoch: 10 | loss: 0.2704778
	speed: 0.5814s/iter; left time: 4251.0150s
	iters: 500, epoch: 10 | loss: 0.2795054
	speed: 0.5689s/iter; left time: 4103.0189s
	iters: 600, epoch: 10 | loss: 0.2684505
	speed: 0.5761s/iter; left time: 4097.5197s
	iters: 700, epoch: 10 | loss: 0.2971185
	speed: 0.5736s/iter; left time: 4022.2448s
Epoch: 10 cost time: 404.9992780685425
Epoch: 10, Steps: 701 | Train Loss: 0.2669323 Vali Loss: 0.4212505 Test Loss: 0.4843358
Validation loss decreased (0.421921 --> 0.421250).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.2700921
	speed: 1.0913s/iter; left time: 7541.7434s
	iters: 200, epoch: 11 | loss: 0.2613820
	speed: 0.5763s/iter; left time: 3924.8737s
	iters: 300, epoch: 11 | loss: 0.2823987
	speed: 0.5759s/iter; left time: 3864.5928s
	iters: 400, epoch: 11 | loss: 0.2832179
	speed: 0.5774s/iter; left time: 3817.1505s
	iters: 500, epoch: 11 | loss: 0.2637839
	speed: 0.5770s/iter; left time: 3757.0178s
	iters: 600, epoch: 11 | loss: 0.2590000
	speed: 0.5742s/iter; left time: 3681.0072s
	iters: 700, epoch: 11 | loss: 0.2658333
	speed: 0.5764s/iter; left time: 3637.5306s
Epoch: 11 cost time: 403.7053599357605
Epoch: 11, Steps: 701 | Train Loss: 0.2662232 Vali Loss: 0.4202052 Test Loss: 0.4834631
Validation loss decreased (0.421250 --> 0.420205).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.2640182
	speed: 1.0775s/iter; left time: 6691.2874s
	iters: 200, epoch: 12 | loss: 0.2835678
	speed: 0.5697s/iter; left time: 3480.7837s
	iters: 300, epoch: 12 | loss: 0.2412718
	speed: 0.5803s/iter; left time: 3487.7169s
	iters: 400, epoch: 12 | loss: 0.2733834
	speed: 0.5694s/iter; left time: 3365.4255s
	iters: 500, epoch: 12 | loss: 0.2510368
	speed: 0.5748s/iter; left time: 3339.6118s
	iters: 600, epoch: 12 | loss: 0.2568145
	speed: 0.5624s/iter; left time: 3211.0892s
	iters: 700, epoch: 12 | loss: 0.2678909
	speed: 0.5854s/iter; left time: 3284.2639s
Epoch: 12 cost time: 402.4075264930725
Epoch: 12, Steps: 701 | Train Loss: 0.2658522 Vali Loss: 0.4202868 Test Loss: 0.4833627
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.2650048
	speed: 0.9808s/iter; left time: 5403.1437s
	iters: 200, epoch: 13 | loss: 0.2600616
	speed: 0.5762s/iter; left time: 3116.8026s
	iters: 300, epoch: 13 | loss: 0.2690338
	speed: 0.5706s/iter; left time: 3029.3455s
	iters: 400, epoch: 13 | loss: 0.2600660
	speed: 0.5730s/iter; left time: 2984.7936s
	iters: 500, epoch: 13 | loss: 0.2734168
	speed: 0.5657s/iter; left time: 2890.3478s
	iters: 600, epoch: 13 | loss: 0.2638856
	speed: 0.5717s/iter; left time: 2863.8241s
	iters: 700, epoch: 13 | loss: 0.2463463
	speed: 0.5646s/iter; left time: 2771.5012s
Epoch: 13 cost time: 399.81931805610657
Epoch: 13, Steps: 701 | Train Loss: 0.2656280 Vali Loss: 0.4200462 Test Loss: 0.4833058
Validation loss decreased (0.420205 --> 0.420046).  Saving model ...
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 14 | loss: 0.2502117
	speed: 1.0835s/iter; left time: 5209.2572s
	iters: 200, epoch: 14 | loss: 0.2624951
	speed: 0.5743s/iter; left time: 2703.7021s
	iters: 300, epoch: 14 | loss: 0.2464552
	speed: 0.5681s/iter; left time: 2617.7165s
	iters: 400, epoch: 14 | loss: 0.2489206
	speed: 0.5736s/iter; left time: 2585.7908s
	iters: 500, epoch: 14 | loss: 0.2718647
	speed: 0.5662s/iter; left time: 2495.8773s
	iters: 600, epoch: 14 | loss: 0.2758175
	speed: 0.5780s/iter; left time: 2490.2251s
	iters: 700, epoch: 14 | loss: 0.2695770
	speed: 0.5635s/iter; left time: 2371.4144s
Epoch: 14 cost time: 399.7039442062378
Epoch: 14, Steps: 701 | Train Loss: 0.2655370 Vali Loss: 0.4201693 Test Loss: 0.4832412
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 15 | loss: 0.2652595
	speed: 0.9876s/iter; left time: 4056.1478s
	iters: 200, epoch: 15 | loss: 0.2865806
	speed: 0.5632s/iter; left time: 2256.8072s
	iters: 300, epoch: 15 | loss: 0.2556139
	speed: 0.5680s/iter; left time: 2219.1583s
	iters: 400, epoch: 15 | loss: 0.2675663
	speed: 0.5605s/iter; left time: 2133.8622s
	iters: 500, epoch: 15 | loss: 0.2603668
	speed: 0.5812s/iter; left time: 2154.3709s
	iters: 600, epoch: 15 | loss: 0.2699909
	speed: 0.5646s/iter; left time: 2036.3978s
	iters: 700, epoch: 15 | loss: 0.2595558
	speed: 0.5762s/iter; left time: 2020.8265s
Epoch: 15 cost time: 399.07060289382935
Epoch: 15, Steps: 701 | Train Loss: 0.2654439 Vali Loss: 0.4205052 Test Loss: 0.4832382
EarlyStopping counter: 2 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 16 | loss: 0.2532386
	speed: 0.9927s/iter; left time: 3381.0063s
	iters: 200, epoch: 16 | loss: 0.2492455
	speed: 0.5624s/iter; left time: 1859.1943s
	iters: 300, epoch: 16 | loss: 0.2540110
	speed: 0.6027s/iter; left time: 1932.2553s
	iters: 400, epoch: 16 | loss: 0.2732006
	speed: 0.5678s/iter; left time: 1763.7011s
	iters: 500, epoch: 16 | loss: 0.2804141
	speed: 0.5701s/iter; left time: 1713.6699s
	iters: 600, epoch: 16 | loss: 0.2656018
	speed: 0.5690s/iter; left time: 1653.5931s
	iters: 700, epoch: 16 | loss: 0.2527128
	speed: 0.5658s/iter; left time: 1587.5919s
Epoch: 16 cost time: 401.72613167762756
Epoch: 16, Steps: 701 | Train Loss: 0.2654448 Vali Loss: 0.4207061 Test Loss: 0.4832398
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 17 | loss: 0.2737379
	speed: 0.9853s/iter; left time: 2665.2278s
	iters: 200, epoch: 17 | loss: 0.2474400
	speed: 0.5777s/iter; left time: 1504.8040s
	iters: 300, epoch: 17 | loss: 0.2386785
	speed: 0.5653s/iter; left time: 1416.1925s
	iters: 400, epoch: 17 | loss: 0.2736933
	speed: 0.5719s/iter; left time: 1375.4055s
	iters: 500, epoch: 17 | loss: 0.2546712
	speed: 0.5645s/iter; left time: 1301.2786s
	iters: 600, epoch: 17 | loss: 0.2637698
	speed: 0.5815s/iter; left time: 1282.2712s
	iters: 700, epoch: 17 | loss: 0.2494663
	speed: 0.5647s/iter; left time: 1188.6303s
Epoch: 17 cost time: 399.66352462768555
Epoch: 17, Steps: 701 | Train Loss: 0.2654291 Vali Loss: 0.4203829 Test Loss: 0.4832390
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 18 | loss: 0.2960120
	speed: 1.0036s/iter; left time: 2011.2242s
	iters: 200, epoch: 18 | loss: 0.2614407
	speed: 0.5696s/iter; left time: 1084.4877s
	iters: 300, epoch: 18 | loss: 0.2534525
	speed: 0.5748s/iter; left time: 1036.9046s
	iters: 400, epoch: 18 | loss: 0.2365745
	speed: 0.5654s/iter; left time: 963.5129s
	iters: 500, epoch: 18 | loss: 0.2637691
	speed: 0.5716s/iter; left time: 916.9107s
	iters: 600, epoch: 18 | loss: 0.2750515
	speed: 0.5632s/iter; left time: 847.0186s
	iters: 700, epoch: 18 | loss: 0.2722654
	speed: 0.5838s/iter; left time: 819.6908s
Epoch: 18 cost time: 401.1599485874176
Epoch: 18, Steps: 701 | Train Loss: 0.2654092 Vali Loss: 0.4207767 Test Loss: 0.4832383
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : traffic_336_720_DLinear_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15726<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2789
mse:0.4831199049949646, mae:0.33079540729522705
