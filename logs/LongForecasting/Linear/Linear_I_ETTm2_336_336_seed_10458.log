Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='Linear', model_id='ETTm2_336_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=336, root_path='./dataset/', save_pred_values=False, seed=10458, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTm2_336_336_Linear_ETTm2_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed10458>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33889
val 11185
test 11185
	iters: 100, epoch: 1 | loss: 0.4966951
	speed: 0.0088s/iter; left time: 185.6893s
	iters: 200, epoch: 1 | loss: 0.7499512
	speed: 0.0076s/iter; left time: 158.6603s
	iters: 300, epoch: 1 | loss: 0.5628651
	speed: 0.0073s/iter; left time: 152.4995s
	iters: 400, epoch: 1 | loss: 0.4743147
	speed: 0.0088s/iter; left time: 183.1626s
	iters: 500, epoch: 1 | loss: 0.9425179
	speed: 0.0083s/iter; left time: 171.1380s
	iters: 600, epoch: 1 | loss: 0.6713209
	speed: 0.0072s/iter; left time: 149.0801s
	iters: 700, epoch: 1 | loss: 0.3434533
	speed: 0.0062s/iter; left time: 127.6579s
	iters: 800, epoch: 1 | loss: 0.5181175
	speed: 0.0055s/iter; left time: 111.3131s
	iters: 900, epoch: 1 | loss: 0.4719065
	speed: 0.0079s/iter; left time: 160.8279s
	iters: 1000, epoch: 1 | loss: 0.5903643
	speed: 0.0077s/iter; left time: 154.8418s
Epoch: 1 cost time: 8.027626752853394
Epoch: 1, Steps: 1059 | Train Loss: 0.6002075 Vali Loss: 0.4646095 Test Loss: 0.8520004
Validation loss decreased (inf --> 0.464610).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.9026639
	speed: 0.0345s/iter; left time: 690.2285s
	iters: 200, epoch: 2 | loss: 0.6828367
	speed: 0.0081s/iter; left time: 160.5398s
	iters: 300, epoch: 2 | loss: 0.5174842
	speed: 0.0074s/iter; left time: 146.5466s
	iters: 400, epoch: 2 | loss: 0.6153084
	speed: 0.0080s/iter; left time: 157.6775s
	iters: 500, epoch: 2 | loss: 1.0390449
	speed: 0.0090s/iter; left time: 177.4239s
	iters: 600, epoch: 2 | loss: 0.4261835
	speed: 0.0072s/iter; left time: 140.9487s
	iters: 700, epoch: 2 | loss: 0.3909203
	speed: 0.0081s/iter; left time: 156.5891s
	iters: 800, epoch: 2 | loss: 1.4264734
	speed: 0.0082s/iter; left time: 158.6802s
	iters: 900, epoch: 2 | loss: 0.4015017
	speed: 0.0080s/iter; left time: 154.1971s
	iters: 1000, epoch: 2 | loss: 0.3734261
	speed: 0.0087s/iter; left time: 167.1522s
Epoch: 2 cost time: 8.5232515335083
Epoch: 2, Steps: 1059 | Train Loss: 0.5939604 Vali Loss: 0.4098186 Test Loss: 0.9482460
Validation loss decreased (0.464610 --> 0.409819).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.4711966
	speed: 0.0340s/iter; left time: 643.9227s
	iters: 200, epoch: 3 | loss: 0.5497554
	speed: 0.0084s/iter; left time: 158.1524s
	iters: 300, epoch: 3 | loss: 0.3978016
	speed: 0.0083s/iter; left time: 156.3582s
	iters: 400, epoch: 3 | loss: 0.3461218
	speed: 0.0093s/iter; left time: 173.2216s
	iters: 500, epoch: 3 | loss: 0.2585309
	speed: 0.0097s/iter; left time: 179.1913s
	iters: 600, epoch: 3 | loss: 0.6951497
	speed: 0.0095s/iter; left time: 174.5363s
	iters: 700, epoch: 3 | loss: 0.4567996
	speed: 0.0086s/iter; left time: 158.3329s
	iters: 800, epoch: 3 | loss: 0.3750951
	speed: 0.0086s/iter; left time: 156.6707s
	iters: 900, epoch: 3 | loss: 0.4455650
	speed: 0.0083s/iter; left time: 150.6424s
	iters: 1000, epoch: 3 | loss: 0.6216025
	speed: 0.0080s/iter; left time: 144.7076s
Epoch: 3 cost time: 9.099235773086548
Epoch: 3, Steps: 1059 | Train Loss: 0.4328050 Vali Loss: 0.3544958 Test Loss: 0.6795343
Validation loss decreased (0.409819 --> 0.354496).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.2680998
	speed: 0.0324s/iter; left time: 580.7372s
	iters: 200, epoch: 4 | loss: 0.1919028
	speed: 0.0075s/iter; left time: 132.8609s
	iters: 300, epoch: 4 | loss: 0.2838617
	speed: 0.0077s/iter; left time: 136.0139s
	iters: 400, epoch: 4 | loss: 0.4846957
	speed: 0.0075s/iter; left time: 131.8830s
	iters: 500, epoch: 4 | loss: 0.4528503
	speed: 0.0078s/iter; left time: 135.8325s
	iters: 600, epoch: 4 | loss: 0.7898837
	speed: 0.0093s/iter; left time: 161.0432s
	iters: 700, epoch: 4 | loss: 0.4325925
	speed: 0.0083s/iter; left time: 143.8173s
	iters: 800, epoch: 4 | loss: 0.3536655
	speed: 0.0091s/iter; left time: 157.3003s
	iters: 900, epoch: 4 | loss: 0.3280155
	speed: 0.0093s/iter; left time: 159.6847s
	iters: 1000, epoch: 4 | loss: 0.2903383
	speed: 0.0079s/iter; left time: 134.5311s
Epoch: 4 cost time: 8.798235893249512
Epoch: 4, Steps: 1059 | Train Loss: 0.3945249 Vali Loss: 0.5933642 Test Loss: 1.5008786
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.5085091
	speed: 0.0331s/iter; left time: 558.2144s
	iters: 200, epoch: 5 | loss: 0.5297056
	speed: 0.0071s/iter; left time: 119.6857s
	iters: 300, epoch: 5 | loss: 0.2270869
	speed: 0.0070s/iter; left time: 116.5152s
	iters: 400, epoch: 5 | loss: 0.3080272
	speed: 0.0081s/iter; left time: 134.0699s
	iters: 500, epoch: 5 | loss: 0.2308677
	speed: 0.0089s/iter; left time: 146.4183s
	iters: 600, epoch: 5 | loss: 0.3173525
	speed: 0.0088s/iter; left time: 143.5625s
	iters: 700, epoch: 5 | loss: 0.5329716
	speed: 0.0083s/iter; left time: 135.3611s
	iters: 800, epoch: 5 | loss: 0.4424832
	speed: 0.0083s/iter; left time: 134.0499s
	iters: 900, epoch: 5 | loss: 0.3324718
	speed: 0.0088s/iter; left time: 141.6491s
	iters: 1000, epoch: 5 | loss: 0.3015897
	speed: 0.0085s/iter; left time: 136.3130s
Epoch: 5 cost time: 8.6497220993042
Epoch: 5, Steps: 1059 | Train Loss: 0.3719865 Vali Loss: 0.4817536 Test Loss: 1.2265826
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.3162256
	speed: 0.0342s/iter; left time: 539.7676s
	iters: 200, epoch: 6 | loss: 0.4091907
	speed: 0.0081s/iter; left time: 126.3131s
	iters: 300, epoch: 6 | loss: 0.3084669
	speed: 0.0082s/iter; left time: 127.4938s
	iters: 400, epoch: 6 | loss: 0.4157814
	speed: 0.0088s/iter; left time: 136.6422s
	iters: 500, epoch: 6 | loss: 0.2812446
	speed: 0.0075s/iter; left time: 115.4680s
	iters: 600, epoch: 6 | loss: 0.3259838
	speed: 0.0083s/iter; left time: 127.3471s
	iters: 700, epoch: 6 | loss: 0.2374804
	speed: 0.0074s/iter; left time: 112.5529s
	iters: 800, epoch: 6 | loss: 0.3493696
	speed: 0.0073s/iter; left time: 109.9758s
	iters: 900, epoch: 6 | loss: 0.2257663
	speed: 0.0081s/iter; left time: 120.6659s
	iters: 1000, epoch: 6 | loss: 0.2851045
	speed: 0.0075s/iter; left time: 111.3875s
Epoch: 6 cost time: 8.316445112228394
Epoch: 6, Steps: 1059 | Train Loss: 0.3630841 Vali Loss: 0.3973177 Test Loss: 0.9116320
EarlyStopping counter: 3 out of 5
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.3188204
	speed: 0.0343s/iter; left time: 504.4864s
	iters: 200, epoch: 7 | loss: 0.5418549
	speed: 0.0077s/iter; left time: 112.2234s
	iters: 300, epoch: 7 | loss: 0.2518211
	speed: 0.0090s/iter; left time: 130.0375s
	iters: 400, epoch: 7 | loss: 0.3468611
	speed: 0.0087s/iter; left time: 125.9758s
	iters: 500, epoch: 7 | loss: 0.3906364
	speed: 0.0085s/iter; left time: 121.9622s
	iters: 600, epoch: 7 | loss: 0.3491395
	speed: 0.0076s/iter; left time: 108.4244s
	iters: 700, epoch: 7 | loss: 0.5204492
	speed: 0.0088s/iter; left time: 124.6010s
	iters: 800, epoch: 7 | loss: 0.3612773
	speed: 0.0086s/iter; left time: 120.4142s
	iters: 900, epoch: 7 | loss: 0.2344065
	speed: 0.0085s/iter; left time: 117.8418s
	iters: 1000, epoch: 7 | loss: 0.2227920
	speed: 0.0080s/iter; left time: 110.5118s
Epoch: 7 cost time: 8.87752914428711
Epoch: 7, Steps: 1059 | Train Loss: 0.3559615 Vali Loss: 0.2551920 Test Loss: 0.4412690
Validation loss decreased (0.354496 --> 0.255192).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.2767536
	speed: 0.0264s/iter; left time: 361.0650s
	iters: 200, epoch: 8 | loss: 0.2022113
	speed: 0.0073s/iter; left time: 99.7098s
	iters: 300, epoch: 8 | loss: 0.2950012
	speed: 0.0092s/iter; left time: 124.1374s
	iters: 400, epoch: 8 | loss: 0.2112080
	speed: 0.0083s/iter; left time: 110.3641s
	iters: 500, epoch: 8 | loss: 0.3455121
	speed: 0.0076s/iter; left time: 100.2245s
	iters: 600, epoch: 8 | loss: 0.3339522
	speed: 0.0080s/iter; left time: 104.9671s
	iters: 700, epoch: 8 | loss: 0.2396137
	speed: 0.0088s/iter; left time: 114.4655s
	iters: 800, epoch: 8 | loss: 0.2568305
	speed: 0.0089s/iter; left time: 115.9670s
	iters: 900, epoch: 8 | loss: 0.2990165
	speed: 0.0080s/iter; left time: 102.5975s
	iters: 1000, epoch: 8 | loss: 0.4467965
	speed: 0.0091s/iter; left time: 115.9464s
Epoch: 8 cost time: 8.672898292541504
Epoch: 8, Steps: 1059 | Train Loss: 0.3523066 Vali Loss: 0.2780926 Test Loss: 0.5157648
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.2372053
	speed: 0.0342s/iter; left time: 430.8329s
	iters: 200, epoch: 9 | loss: 0.2933690
	speed: 0.0080s/iter; left time: 100.2998s
	iters: 300, epoch: 9 | loss: 0.2989772
	speed: 0.0089s/iter; left time: 109.9700s
	iters: 400, epoch: 9 | loss: 0.3068446
	speed: 0.0092s/iter; left time: 113.6538s
	iters: 500, epoch: 9 | loss: 0.4509019
	speed: 0.0092s/iter; left time: 111.7176s
	iters: 600, epoch: 9 | loss: 0.2881308
	speed: 0.0087s/iter; left time: 105.1384s
	iters: 700, epoch: 9 | loss: 0.3007806
	speed: 0.0090s/iter; left time: 108.2258s
	iters: 800, epoch: 9 | loss: 0.4481206
	speed: 0.0082s/iter; left time: 97.6648s
	iters: 900, epoch: 9 | loss: 0.2377100
	speed: 0.0073s/iter; left time: 85.8592s
	iters: 1000, epoch: 9 | loss: 0.2250502
	speed: 0.0093s/iter; left time: 108.7407s
Epoch: 9 cost time: 9.146259069442749
Epoch: 9, Steps: 1059 | Train Loss: 0.3503922 Vali Loss: 0.2613924 Test Loss: 0.4611810
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.1943763
	speed: 0.0363s/iter; left time: 419.8340s
	iters: 200, epoch: 10 | loss: 0.1987850
	speed: 0.0077s/iter; left time: 88.0975s
	iters: 300, epoch: 10 | loss: 0.4602726
	speed: 0.0089s/iter; left time: 100.6950s
	iters: 400, epoch: 10 | loss: 0.2341735
	speed: 0.0091s/iter; left time: 102.1500s
	iters: 500, epoch: 10 | loss: 0.2438014
	speed: 0.0089s/iter; left time: 99.7576s
	iters: 600, epoch: 10 | loss: 0.3789768
	speed: 0.0083s/iter; left time: 91.2090s
	iters: 700, epoch: 10 | loss: 0.3764967
	speed: 0.0083s/iter; left time: 90.5861s
	iters: 800, epoch: 10 | loss: 0.4220356
	speed: 0.0083s/iter; left time: 90.4982s
	iters: 900, epoch: 10 | loss: 0.8295385
	speed: 0.0086s/iter; left time: 92.0304s
	iters: 1000, epoch: 10 | loss: 0.2501376
	speed: 0.0074s/iter; left time: 78.5970s
Epoch: 10 cost time: 8.828789234161377
Epoch: 10, Steps: 1059 | Train Loss: 0.3494334 Vali Loss: 0.2875153 Test Loss: 0.5408465
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.3562231
	speed: 0.0315s/iter; left time: 330.7335s
	iters: 200, epoch: 11 | loss: 0.2383790
	speed: 0.0081s/iter; left time: 83.7635s
	iters: 300, epoch: 11 | loss: 0.4183129
	speed: 0.0072s/iter; left time: 73.5833s
	iters: 400, epoch: 11 | loss: 0.2195154
	speed: 0.0083s/iter; left time: 84.5045s
	iters: 500, epoch: 11 | loss: 0.4310244
	speed: 0.0084s/iter; left time: 84.5790s
	iters: 600, epoch: 11 | loss: 0.3264679
	speed: 0.0083s/iter; left time: 82.9550s
	iters: 700, epoch: 11 | loss: 0.2382496
	speed: 0.0079s/iter; left time: 78.4404s
	iters: 800, epoch: 11 | loss: 0.6658752
	speed: 0.0081s/iter; left time: 79.0673s
	iters: 900, epoch: 11 | loss: 0.2620724
	speed: 0.0083s/iter; left time: 80.3764s
	iters: 1000, epoch: 11 | loss: 0.2324841
	speed: 0.0074s/iter; left time: 71.2007s
Epoch: 11 cost time: 8.457339525222778
Epoch: 11, Steps: 1059 | Train Loss: 0.3487299 Vali Loss: 0.2844110 Test Loss: 0.5310488
EarlyStopping counter: 4 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.2005310
	speed: 0.0297s/iter; left time: 279.8033s
	iters: 200, epoch: 12 | loss: 0.1946453
	speed: 0.0069s/iter; left time: 64.0071s
	iters: 300, epoch: 12 | loss: 0.2921445
	speed: 0.0071s/iter; left time: 65.1021s
	iters: 400, epoch: 12 | loss: 0.5873182
	speed: 0.0071s/iter; left time: 64.5815s
	iters: 500, epoch: 12 | loss: 0.2809235
	speed: 0.0070s/iter; left time: 62.9500s
	iters: 600, epoch: 12 | loss: 0.3765629
	speed: 0.0069s/iter; left time: 61.3628s
	iters: 700, epoch: 12 | loss: 0.2364073
	speed: 0.0071s/iter; left time: 62.5357s
	iters: 800, epoch: 12 | loss: 0.5870144
	speed: 0.0077s/iter; left time: 67.3276s
	iters: 900, epoch: 12 | loss: 0.2589479
	speed: 0.0078s/iter; left time: 67.6026s
	iters: 1000, epoch: 12 | loss: 0.3942137
	speed: 0.0077s/iter; left time: 65.5286s
Epoch: 12 cost time: 7.653223752975464
Epoch: 12, Steps: 1059 | Train Loss: 0.3484305 Vali Loss: 0.2904044 Test Loss: 0.5545830
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTm2_336_336_Linear_ETTm2_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed10458<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
mse:0.4416862428188324, mae:0.43041402101516724
