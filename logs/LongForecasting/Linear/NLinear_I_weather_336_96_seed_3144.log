Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='NLinear', model_id='weather_336_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=3144, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : weather_336_96_NLinear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3144>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36456
val 5175
test 10444
	iters: 100, epoch: 1 | loss: 0.6072546
	speed: 0.0095s/iter; left time: 431.9516s
	iters: 200, epoch: 1 | loss: 0.2830765
	speed: 0.0086s/iter; left time: 391.0596s
	iters: 300, epoch: 1 | loss: 0.7038401
	speed: 0.0068s/iter; left time: 308.7598s
	iters: 400, epoch: 1 | loss: 1.7152323
	speed: 0.0093s/iter; left time: 421.9202s
	iters: 500, epoch: 1 | loss: 0.5885122
	speed: 0.0093s/iter; left time: 419.1553s
	iters: 600, epoch: 1 | loss: 1.7556089
	speed: 0.0093s/iter; left time: 418.6174s
	iters: 700, epoch: 1 | loss: 0.9352502
	speed: 0.0102s/iter; left time: 459.1166s
	iters: 800, epoch: 1 | loss: 0.5073448
	speed: 0.0076s/iter; left time: 339.3052s
	iters: 900, epoch: 1 | loss: 0.3908825
	speed: 0.0077s/iter; left time: 343.9030s
	iters: 1000, epoch: 1 | loss: 3.0125704
	speed: 0.0083s/iter; left time: 371.3026s
	iters: 1100, epoch: 1 | loss: 0.4628254
	speed: 0.0097s/iter; left time: 433.1912s
	iters: 1200, epoch: 1 | loss: 0.3410005
	speed: 0.0099s/iter; left time: 437.5569s
	iters: 1300, epoch: 1 | loss: 1.0577217
	speed: 0.0106s/iter; left time: 468.7318s
	iters: 1400, epoch: 1 | loss: 4.1697550
	speed: 0.0095s/iter; left time: 419.5284s
	iters: 1500, epoch: 1 | loss: 0.4602994
	speed: 0.0095s/iter; left time: 418.2227s
	iters: 1600, epoch: 1 | loss: 0.3189937
	speed: 0.0090s/iter; left time: 395.2134s
	iters: 1700, epoch: 1 | loss: 0.6969153
	speed: 0.0089s/iter; left time: 391.8324s
	iters: 1800, epoch: 1 | loss: 0.3880913
	speed: 0.0084s/iter; left time: 365.9636s
	iters: 1900, epoch: 1 | loss: 0.4935603
	speed: 0.0090s/iter; left time: 392.5169s
	iters: 2000, epoch: 1 | loss: 0.4207624
	speed: 0.0091s/iter; left time: 396.7648s
	iters: 2100, epoch: 1 | loss: 0.6542943
	speed: 0.0090s/iter; left time: 389.9356s
	iters: 2200, epoch: 1 | loss: 0.7478207
	speed: 0.0097s/iter; left time: 421.1352s
Epoch: 1 cost time: 20.672792673110962
Epoch: 1, Steps: 2278 | Train Loss: 2.7114070 Vali Loss: 0.8038366 Test Loss: 0.3465028
Validation loss decreased (inf --> 0.803837).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.3315911
	speed: 0.0424s/iter; left time: 1829.3510s
	iters: 200, epoch: 2 | loss: 0.5579650
	speed: 0.0094s/iter; left time: 406.4357s
	iters: 300, epoch: 2 | loss: 0.3375259
	speed: 0.0097s/iter; left time: 417.4887s
	iters: 400, epoch: 2 | loss: 0.9155115
	speed: 0.0088s/iter; left time: 378.6412s
	iters: 500, epoch: 2 | loss: 0.6137246
	speed: 0.0098s/iter; left time: 417.2377s
	iters: 600, epoch: 2 | loss: 0.4726267
	speed: 0.0094s/iter; left time: 399.1757s
	iters: 700, epoch: 2 | loss: 0.3398016
	speed: 0.0101s/iter; left time: 429.6695s
	iters: 800, epoch: 2 | loss: 0.3462415
	speed: 0.0095s/iter; left time: 405.3992s
	iters: 900, epoch: 2 | loss: 0.3267167
	speed: 0.0090s/iter; left time: 380.2660s
	iters: 1000, epoch: 2 | loss: 0.9910502
	speed: 0.0096s/iter; left time: 406.8827s
	iters: 1100, epoch: 2 | loss: 2.3914099
	speed: 0.0089s/iter; left time: 374.3133s
	iters: 1200, epoch: 2 | loss: 21.2586498
	speed: 0.0083s/iter; left time: 349.8044s
	iters: 1300, epoch: 2 | loss: 1.8645312
	speed: 0.0084s/iter; left time: 354.4399s
	iters: 1400, epoch: 2 | loss: 0.3106181
	speed: 0.0077s/iter; left time: 323.2627s
	iters: 1500, epoch: 2 | loss: 0.3688338
	speed: 0.0076s/iter; left time: 318.0492s
	iters: 1600, epoch: 2 | loss: 0.6830328
	speed: 0.0075s/iter; left time: 312.7325s
	iters: 1700, epoch: 2 | loss: 0.7502263
	speed: 0.0085s/iter; left time: 353.9818s
	iters: 1800, epoch: 2 | loss: 0.3771532
	speed: 0.0082s/iter; left time: 341.9729s
	iters: 1900, epoch: 2 | loss: 0.4995431
	speed: 0.0099s/iter; left time: 407.7220s
	iters: 2000, epoch: 2 | loss: 2.2027342
	speed: 0.0100s/iter; left time: 414.5496s
	iters: 2100, epoch: 2 | loss: 0.5729780
	speed: 0.0094s/iter; left time: 386.8512s
	iters: 2200, epoch: 2 | loss: 0.5466243
	speed: 0.0088s/iter; left time: 359.8499s
Epoch: 2 cost time: 20.449691772460938
Epoch: 2, Steps: 2278 | Train Loss: 22.9799711 Vali Loss: 0.6593007 Test Loss: 0.2936435
Validation loss decreased (0.803837 --> 0.659301).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.2857522
	speed: 0.0389s/iter; left time: 1591.5510s
	iters: 200, epoch: 3 | loss: 0.3487746
	speed: 0.0105s/iter; left time: 426.8712s
	iters: 300, epoch: 3 | loss: 0.7302807
	speed: 0.0082s/iter; left time: 334.7035s
	iters: 400, epoch: 3 | loss: 0.5828798
	speed: 0.0090s/iter; left time: 365.5748s
	iters: 500, epoch: 3 | loss: 0.4838508
	speed: 0.0094s/iter; left time: 382.4980s
	iters: 600, epoch: 3 | loss: 0.3863083
	speed: 0.0099s/iter; left time: 401.2087s
	iters: 700, epoch: 3 | loss: 0.3954463
	speed: 0.0096s/iter; left time: 385.0392s
	iters: 800, epoch: 3 | loss: 0.3815024
	speed: 0.0103s/iter; left time: 413.0205s
	iters: 900, epoch: 3 | loss: 0.4318504
	speed: 0.0096s/iter; left time: 386.3057s
	iters: 1000, epoch: 3 | loss: 0.3709123
	speed: 0.0107s/iter; left time: 427.4045s
	iters: 1100, epoch: 3 | loss: 1.4565942
	speed: 0.0085s/iter; left time: 340.2955s
	iters: 1200, epoch: 3 | loss: 0.3610325
	speed: 0.0078s/iter; left time: 310.9585s
	iters: 1300, epoch: 3 | loss: 1.1048155
	speed: 0.0093s/iter; left time: 368.4941s
	iters: 1400, epoch: 3 | loss: 0.2737746
	speed: 0.0100s/iter; left time: 395.7713s
	iters: 1500, epoch: 3 | loss: 0.4290176
	speed: 0.0093s/iter; left time: 367.0836s
	iters: 1600, epoch: 3 | loss: 0.3269688
	speed: 0.0090s/iter; left time: 353.8825s
	iters: 1700, epoch: 3 | loss: 0.3832297
	speed: 0.0098s/iter; left time: 383.7761s
	iters: 1800, epoch: 3 | loss: 7.4538794
	speed: 0.0086s/iter; left time: 338.3686s
	iters: 1900, epoch: 3 | loss: 0.4136469
	speed: 0.0091s/iter; left time: 354.0102s
	iters: 2000, epoch: 3 | loss: 0.4879001
	speed: 0.0098s/iter; left time: 383.8300s
	iters: 2100, epoch: 3 | loss: 5.5072131
	speed: 0.0096s/iter; left time: 373.1936s
	iters: 2200, epoch: 3 | loss: 0.6962191
	speed: 0.0087s/iter; left time: 336.9612s
Epoch: 3 cost time: 21.556024312973022
Epoch: 3, Steps: 2278 | Train Loss: 62.5983084 Vali Loss: 0.4719205 Test Loss: 0.1838761
Validation loss decreased (0.659301 --> 0.471920).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.2911634
	speed: 0.0405s/iter; left time: 1564.0603s
	iters: 200, epoch: 4 | loss: 0.4560786
	speed: 0.0088s/iter; left time: 340.6837s
	iters: 300, epoch: 4 | loss: 0.2869499
	speed: 0.0094s/iter; left time: 362.0138s
	iters: 400, epoch: 4 | loss: 1.8205540
	speed: 0.0080s/iter; left time: 308.2163s
	iters: 500, epoch: 4 | loss: 0.5449610
	speed: 0.0083s/iter; left time: 315.5251s
	iters: 600, epoch: 4 | loss: 0.3970136
	speed: 0.0104s/iter; left time: 394.8436s
	iters: 700, epoch: 4 | loss: 0.4911098
	speed: 0.0096s/iter; left time: 365.5699s
	iters: 800, epoch: 4 | loss: 1.7821726
	speed: 0.0089s/iter; left time: 339.0009s
	iters: 900, epoch: 4 | loss: 0.2347918
	speed: 0.0087s/iter; left time: 330.3797s
	iters: 1000, epoch: 4 | loss: 0.4179252
	speed: 0.0098s/iter; left time: 369.0691s
	iters: 1100, epoch: 4 | loss: 0.3033707
	speed: 0.0093s/iter; left time: 348.8916s
	iters: 1200, epoch: 4 | loss: 0.2063254
	speed: 0.0097s/iter; left time: 364.5178s
	iters: 1300, epoch: 4 | loss: 0.6568461
	speed: 0.0106s/iter; left time: 397.1937s
	iters: 1400, epoch: 4 | loss: 0.3222390
	speed: 0.0107s/iter; left time: 400.3721s
	iters: 1500, epoch: 4 | loss: 0.5966851
	speed: 0.0095s/iter; left time: 353.3804s
	iters: 1600, epoch: 4 | loss: 0.3288971
	speed: 0.0100s/iter; left time: 371.3476s
	iters: 1700, epoch: 4 | loss: 1.1282088
	speed: 0.0098s/iter; left time: 364.4384s
	iters: 1800, epoch: 4 | loss: 0.2392267
	speed: 0.0096s/iter; left time: 353.5216s
	iters: 1900, epoch: 4 | loss: 0.6404836
	speed: 0.0098s/iter; left time: 360.9238s
	iters: 2000, epoch: 4 | loss: 0.3577717
	speed: 0.0093s/iter; left time: 340.9128s
	iters: 2100, epoch: 4 | loss: 0.3592589
	speed: 0.0088s/iter; left time: 321.3082s
	iters: 2200, epoch: 4 | loss: 0.3668739
	speed: 0.0090s/iter; left time: 327.0242s
Epoch: 4 cost time: 21.465367078781128
Epoch: 4, Steps: 2278 | Train Loss: 8.5865700 Vali Loss: 0.4177207 Test Loss: 0.1538866
Validation loss decreased (0.471920 --> 0.417721).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.2854911
	speed: 0.0376s/iter; left time: 1368.1905s
	iters: 200, epoch: 5 | loss: 0.2724749
	speed: 0.0096s/iter; left time: 346.2221s
	iters: 300, epoch: 5 | loss: 0.4498835
	speed: 0.0085s/iter; left time: 308.3623s
	iters: 400, epoch: 5 | loss: 0.2738852
	speed: 0.0087s/iter; left time: 314.4088s
	iters: 500, epoch: 5 | loss: 0.2773874
	speed: 0.0090s/iter; left time: 323.5853s
	iters: 600, epoch: 5 | loss: 2.1445532
	speed: 0.0098s/iter; left time: 350.6983s
	iters: 700, epoch: 5 | loss: 0.2402426
	speed: 0.0094s/iter; left time: 337.5739s
	iters: 800, epoch: 5 | loss: 0.3770477
	speed: 0.0106s/iter; left time: 377.4726s
	iters: 900, epoch: 5 | loss: 0.3065447
	speed: 0.0096s/iter; left time: 340.2940s
	iters: 1000, epoch: 5 | loss: 0.3082757
	speed: 0.0090s/iter; left time: 319.7914s
	iters: 1100, epoch: 5 | loss: 0.8974905
	speed: 0.0103s/iter; left time: 362.4000s
	iters: 1200, epoch: 5 | loss: 0.3261944
	speed: 0.0092s/iter; left time: 323.9466s
	iters: 1300, epoch: 5 | loss: 0.2551056
	speed: 0.0085s/iter; left time: 297.7970s
	iters: 1400, epoch: 5 | loss: 0.3714522
	speed: 0.0093s/iter; left time: 325.0771s
	iters: 1500, epoch: 5 | loss: 0.2601309
	speed: 0.0086s/iter; left time: 301.3089s
	iters: 1600, epoch: 5 | loss: 0.1887139
	speed: 0.0098s/iter; left time: 341.8234s
	iters: 1700, epoch: 5 | loss: 0.4661471
	speed: 0.0090s/iter; left time: 313.1832s
	iters: 1800, epoch: 5 | loss: 0.3483928
	speed: 0.0106s/iter; left time: 367.3701s
	iters: 1900, epoch: 5 | loss: 0.2779557
	speed: 0.0107s/iter; left time: 370.3809s
	iters: 2000, epoch: 5 | loss: 1.0026575
	speed: 0.0111s/iter; left time: 382.8558s
	iters: 2100, epoch: 5 | loss: 2.1509817
	speed: 0.0109s/iter; left time: 375.1532s
	iters: 2200, epoch: 5 | loss: 0.4789756
	speed: 0.0084s/iter; left time: 286.2383s
Epoch: 5 cost time: 21.840460777282715
Epoch: 5, Steps: 2278 | Train Loss: 1.9452472 Vali Loss: 0.3958110 Test Loss: 0.1484827
Validation loss decreased (0.417721 --> 0.395811).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.2221527
	speed: 0.0386s/iter; left time: 1314.1057s
	iters: 200, epoch: 6 | loss: 0.2790587
	speed: 0.0095s/iter; left time: 321.6467s
	iters: 300, epoch: 6 | loss: 0.2928619
	speed: 0.0085s/iter; left time: 288.0138s
	iters: 400, epoch: 6 | loss: 0.4177071
	speed: 0.0095s/iter; left time: 319.2191s
	iters: 500, epoch: 6 | loss: 2.0502007
	speed: 0.0087s/iter; left time: 293.2839s
	iters: 600, epoch: 6 | loss: 0.2066843
	speed: 0.0093s/iter; left time: 311.5699s
	iters: 700, epoch: 6 | loss: 0.2135274
	speed: 0.0095s/iter; left time: 318.7072s
	iters: 800, epoch: 6 | loss: 0.4275819
	speed: 0.0087s/iter; left time: 290.7474s
	iters: 900, epoch: 6 | loss: 0.4284546
	speed: 0.0097s/iter; left time: 322.5361s
	iters: 1000, epoch: 6 | loss: 0.3062939
	speed: 0.0109s/iter; left time: 359.9317s
	iters: 1100, epoch: 6 | loss: 0.2932121
	speed: 0.0093s/iter; left time: 308.9005s
	iters: 1200, epoch: 6 | loss: 0.2190731
	speed: 0.0093s/iter; left time: 306.6339s
	iters: 1300, epoch: 6 | loss: 0.4089093
	speed: 0.0085s/iter; left time: 278.8802s
	iters: 1400, epoch: 6 | loss: 0.3391361
	speed: 0.0089s/iter; left time: 290.4557s
	iters: 1500, epoch: 6 | loss: 0.5244773
	speed: 0.0093s/iter; left time: 302.2264s
	iters: 1600, epoch: 6 | loss: 0.2846114
	speed: 0.0093s/iter; left time: 303.9915s
	iters: 1700, epoch: 6 | loss: 0.2184772
	speed: 0.0097s/iter; left time: 316.2989s
	iters: 1800, epoch: 6 | loss: 0.3762429
	speed: 0.0100s/iter; left time: 322.7566s
	iters: 1900, epoch: 6 | loss: 0.2609968
	speed: 0.0091s/iter; left time: 295.0140s
	iters: 2000, epoch: 6 | loss: 0.2754769
	speed: 0.0091s/iter; left time: 293.4833s
	iters: 2100, epoch: 6 | loss: 0.2305560
	speed: 0.0099s/iter; left time: 316.3059s
	iters: 2200, epoch: 6 | loss: 0.3233341
	speed: 0.0103s/iter; left time: 330.3354s
Epoch: 6 cost time: 21.39418363571167
Epoch: 6, Steps: 2278 | Train Loss: 0.8510652 Vali Loss: 0.5083394 Test Loss: 0.1494043
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.3537681
	speed: 0.0445s/iter; left time: 1413.9012s
	iters: 200, epoch: 7 | loss: 0.2300913
	speed: 0.0097s/iter; left time: 308.1161s
	iters: 300, epoch: 7 | loss: 0.4810857
	speed: 0.0106s/iter; left time: 333.7250s
	iters: 400, epoch: 7 | loss: 0.3053486
	speed: 0.0111s/iter; left time: 349.0215s
	iters: 500, epoch: 7 | loss: 0.6018022
	speed: 0.0105s/iter; left time: 328.1544s
	iters: 600, epoch: 7 | loss: 0.2763004
	speed: 0.0105s/iter; left time: 327.3880s
	iters: 700, epoch: 7 | loss: 0.4714597
	speed: 0.0103s/iter; left time: 319.8314s
	iters: 800, epoch: 7 | loss: 0.4249960
	speed: 0.0108s/iter; left time: 335.2615s
	iters: 900, epoch: 7 | loss: 0.1957025
	speed: 0.0104s/iter; left time: 323.0341s
	iters: 1000, epoch: 7 | loss: 0.3345254
	speed: 0.0094s/iter; left time: 289.5537s
	iters: 1100, epoch: 7 | loss: 2.2330120
	speed: 0.0091s/iter; left time: 278.7655s
	iters: 1200, epoch: 7 | loss: 0.2024345
	speed: 0.0091s/iter; left time: 278.1390s
	iters: 1300, epoch: 7 | loss: 0.4823151
	speed: 0.0105s/iter; left time: 322.5378s
	iters: 1400, epoch: 7 | loss: 0.3095996
	speed: 0.0098s/iter; left time: 297.6928s
	iters: 1500, epoch: 7 | loss: 0.3151891
	speed: 0.0096s/iter; left time: 292.0866s
	iters: 1600, epoch: 7 | loss: 0.2472000
	speed: 0.0089s/iter; left time: 268.1620s
	iters: 1700, epoch: 7 | loss: 0.7255485
	speed: 0.0088s/iter; left time: 266.0835s
	iters: 1800, epoch: 7 | loss: 0.2619615
	speed: 0.0088s/iter; left time: 264.6150s
	iters: 1900, epoch: 7 | loss: 0.9747760
	speed: 0.0098s/iter; left time: 293.9520s
	iters: 2000, epoch: 7 | loss: 0.2039364
	speed: 0.0098s/iter; left time: 293.3293s
	iters: 2100, epoch: 7 | loss: 0.2650445
	speed: 0.0083s/iter; left time: 246.1130s
	iters: 2200, epoch: 7 | loss: 0.2055347
	speed: 0.0091s/iter; left time: 269.7024s
Epoch: 7 cost time: 22.362415552139282
Epoch: 7, Steps: 2278 | Train Loss: 0.5773299 Vali Loss: 0.3825731 Test Loss: 0.1462468
Validation loss decreased (0.395811 --> 0.382573).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.2907942
	speed: 0.0391s/iter; left time: 1152.6742s
	iters: 200, epoch: 8 | loss: 1.6159033
	speed: 0.0096s/iter; left time: 281.5732s
	iters: 300, epoch: 8 | loss: 0.2487605
	speed: 0.0097s/iter; left time: 283.5386s
	iters: 400, epoch: 8 | loss: 0.2372486
	speed: 0.0091s/iter; left time: 267.0301s
	iters: 500, epoch: 8 | loss: 0.2526686
	speed: 0.0097s/iter; left time: 281.9013s
	iters: 600, epoch: 8 | loss: 0.1759841
	speed: 0.0099s/iter; left time: 287.8399s
	iters: 700, epoch: 8 | loss: 0.2997667
	speed: 0.0089s/iter; left time: 257.7205s
	iters: 800, epoch: 8 | loss: 0.2529651
	speed: 0.0090s/iter; left time: 259.1043s
	iters: 900, epoch: 8 | loss: 0.2695930
	speed: 0.0091s/iter; left time: 261.9599s
	iters: 1000, epoch: 8 | loss: 0.3808040
	speed: 0.0092s/iter; left time: 263.4954s
	iters: 1100, epoch: 8 | loss: 0.3794070
	speed: 0.0093s/iter; left time: 265.2638s
	iters: 1200, epoch: 8 | loss: 0.2223963
	speed: 0.0091s/iter; left time: 257.2027s
	iters: 1300, epoch: 8 | loss: 0.2528180
	speed: 0.0092s/iter; left time: 261.1834s
	iters: 1400, epoch: 8 | loss: 0.2657826
	speed: 0.0098s/iter; left time: 277.0738s
	iters: 1500, epoch: 8 | loss: 0.3817384
	speed: 0.0097s/iter; left time: 273.5843s
	iters: 1600, epoch: 8 | loss: 0.2960070
	speed: 0.0087s/iter; left time: 243.8149s
	iters: 1700, epoch: 8 | loss: 0.2382235
	speed: 0.0088s/iter; left time: 246.5722s
	iters: 1800, epoch: 8 | loss: 0.3802455
	speed: 0.0097s/iter; left time: 269.8292s
	iters: 1900, epoch: 8 | loss: 0.2470560
	speed: 0.0106s/iter; left time: 294.1115s
	iters: 2000, epoch: 8 | loss: 0.9189720
	speed: 0.0113s/iter; left time: 312.6085s
	iters: 2100, epoch: 8 | loss: 0.4378633
	speed: 0.0096s/iter; left time: 263.1058s
	iters: 2200, epoch: 8 | loss: 0.4192274
	speed: 0.0094s/iter; left time: 257.7119s
Epoch: 8 cost time: 21.61407494544983
Epoch: 8, Steps: 2278 | Train Loss: 0.5000706 Vali Loss: 0.3795715 Test Loss: 0.1438506
Validation loss decreased (0.382573 --> 0.379571).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.3070694
	speed: 0.0382s/iter; left time: 1041.7037s
	iters: 200, epoch: 9 | loss: 0.6143624
	speed: 0.0086s/iter; left time: 233.4596s
	iters: 300, epoch: 9 | loss: 0.2640980
	speed: 0.0107s/iter; left time: 288.5994s
	iters: 400, epoch: 9 | loss: 0.2787885
	speed: 0.0110s/iter; left time: 295.3203s
	iters: 500, epoch: 9 | loss: 0.2648326
	speed: 0.0103s/iter; left time: 276.2337s
	iters: 600, epoch: 9 | loss: 0.3358549
	speed: 0.0094s/iter; left time: 251.3597s
	iters: 700, epoch: 9 | loss: 0.4793476
	speed: 0.0084s/iter; left time: 222.7378s
	iters: 800, epoch: 9 | loss: 0.8457209
	speed: 0.0088s/iter; left time: 234.6681s
	iters: 900, epoch: 9 | loss: 0.3634177
	speed: 0.0083s/iter; left time: 220.2194s
	iters: 1000, epoch: 9 | loss: 0.1817682
	speed: 0.0116s/iter; left time: 306.2473s
	iters: 1100, epoch: 9 | loss: 0.2335739
	speed: 0.0113s/iter; left time: 296.8271s
	iters: 1200, epoch: 9 | loss: 0.1583052
	speed: 0.0102s/iter; left time: 265.9138s
	iters: 1300, epoch: 9 | loss: 0.6817706
	speed: 0.0103s/iter; left time: 266.9608s
	iters: 1400, epoch: 9 | loss: 0.2018668
	speed: 0.0116s/iter; left time: 299.6219s
	iters: 1500, epoch: 9 | loss: 0.5104883
	speed: 0.0105s/iter; left time: 271.6088s
	iters: 1600, epoch: 9 | loss: 0.2256902
	speed: 0.0098s/iter; left time: 251.5500s
	iters: 1700, epoch: 9 | loss: 0.2260581
	speed: 0.0102s/iter; left time: 261.2907s
	iters: 1800, epoch: 9 | loss: 0.3856038
	speed: 0.0106s/iter; left time: 271.5073s
	iters: 1900, epoch: 9 | loss: 2.2498603
	speed: 0.0095s/iter; left time: 240.3875s
	iters: 2000, epoch: 9 | loss: 0.3029683
	speed: 0.0097s/iter; left time: 246.0990s
	iters: 2100, epoch: 9 | loss: 0.3051027
	speed: 0.0079s/iter; left time: 198.2059s
	iters: 2200, epoch: 9 | loss: 0.2638582
	speed: 0.0110s/iter; left time: 277.0932s
Epoch: 9 cost time: 22.73334836959839
Epoch: 9, Steps: 2278 | Train Loss: 0.4694294 Vali Loss: 0.3799240 Test Loss: 0.1433368
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.3465636
	speed: 0.0451s/iter; left time: 1125.2438s
	iters: 200, epoch: 10 | loss: 0.5888732
	speed: 0.0107s/iter; left time: 266.3312s
	iters: 300, epoch: 10 | loss: 0.2308111
	speed: 0.0112s/iter; left time: 278.1014s
	iters: 400, epoch: 10 | loss: 0.2295142
	speed: 0.0076s/iter; left time: 186.9713s
	iters: 500, epoch: 10 | loss: 2.5098841
	speed: 0.0076s/iter; left time: 185.7567s
	iters: 600, epoch: 10 | loss: 0.2062038
	speed: 0.0087s/iter; left time: 211.5822s
	iters: 700, epoch: 10 | loss: 0.7489405
	speed: 0.0102s/iter; left time: 249.5045s
	iters: 800, epoch: 10 | loss: 0.2021692
	speed: 0.0097s/iter; left time: 235.1202s
	iters: 900, epoch: 10 | loss: 1.6457369
	speed: 0.0110s/iter; left time: 266.5443s
	iters: 1000, epoch: 10 | loss: 0.2803644
	speed: 0.0107s/iter; left time: 257.1316s
	iters: 1100, epoch: 10 | loss: 0.2485331
	speed: 0.0106s/iter; left time: 253.0101s
	iters: 1200, epoch: 10 | loss: 0.2582985
	speed: 0.0105s/iter; left time: 251.2686s
	iters: 1300, epoch: 10 | loss: 0.2749920
	speed: 0.0083s/iter; left time: 197.5000s
	iters: 1400, epoch: 10 | loss: 0.1461820
	speed: 0.0092s/iter; left time: 218.1465s
	iters: 1500, epoch: 10 | loss: 0.3411187
	speed: 0.0103s/iter; left time: 241.9104s
	iters: 1600, epoch: 10 | loss: 1.0807753
	speed: 0.0099s/iter; left time: 231.8327s
	iters: 1700, epoch: 10 | loss: 0.2551382
	speed: 0.0088s/iter; left time: 205.8483s
	iters: 1800, epoch: 10 | loss: 1.3127013
	speed: 0.0093s/iter; left time: 217.0272s
	iters: 1900, epoch: 10 | loss: 0.7377807
	speed: 0.0082s/iter; left time: 190.1960s
	iters: 2000, epoch: 10 | loss: 0.3167548
	speed: 0.0098s/iter; left time: 225.9991s
	iters: 2100, epoch: 10 | loss: 0.2065678
	speed: 0.0095s/iter; left time: 218.8070s
	iters: 2200, epoch: 10 | loss: 0.3765645
	speed: 0.0093s/iter; left time: 212.6463s
Epoch: 10 cost time: 21.695157766342163
Epoch: 10, Steps: 2278 | Train Loss: 0.4585858 Vali Loss: 0.3769708 Test Loss: 0.1435387
Validation loss decreased (0.379571 --> 0.376971).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.4759132
	speed: 0.0365s/iter; left time: 828.0809s
	iters: 200, epoch: 11 | loss: 0.1989399
	speed: 0.0084s/iter; left time: 188.6072s
	iters: 300, epoch: 11 | loss: 0.2063235
	speed: 0.0095s/iter; left time: 213.3863s
	iters: 400, epoch: 11 | loss: 0.5263261
	speed: 0.0084s/iter; left time: 186.8999s
	iters: 500, epoch: 11 | loss: 0.3982581
	speed: 0.0104s/iter; left time: 230.6934s
	iters: 600, epoch: 11 | loss: 0.5330045
	speed: 0.0094s/iter; left time: 207.8150s
	iters: 700, epoch: 11 | loss: 0.5740648
	speed: 0.0087s/iter; left time: 191.7288s
	iters: 800, epoch: 11 | loss: 2.4243920
	speed: 0.0106s/iter; left time: 233.4437s
	iters: 900, epoch: 11 | loss: 0.3990784
	speed: 0.0085s/iter; left time: 186.4259s
	iters: 1000, epoch: 11 | loss: 0.3055666
	speed: 0.0095s/iter; left time: 207.4360s
	iters: 1100, epoch: 11 | loss: 0.1991210
	speed: 0.0093s/iter; left time: 202.6999s
	iters: 1200, epoch: 11 | loss: 0.6356488
	speed: 0.0099s/iter; left time: 214.5056s
	iters: 1300, epoch: 11 | loss: 0.7007164
	speed: 0.0094s/iter; left time: 201.9078s
	iters: 1400, epoch: 11 | loss: 0.1689521
	speed: 0.0109s/iter; left time: 232.4247s
	iters: 1500, epoch: 11 | loss: 0.2714327
	speed: 0.0104s/iter; left time: 220.7488s
	iters: 1600, epoch: 11 | loss: 0.4181806
	speed: 0.0099s/iter; left time: 209.7120s
	iters: 1700, epoch: 11 | loss: 0.2179393
	speed: 0.0107s/iter; left time: 224.7369s
	iters: 1800, epoch: 11 | loss: 0.6517659
	speed: 0.0110s/iter; left time: 231.5684s
	iters: 1900, epoch: 11 | loss: 0.2897412
	speed: 0.0104s/iter; left time: 218.0082s
	iters: 2000, epoch: 11 | loss: 0.3181123
	speed: 0.0113s/iter; left time: 233.8626s
	iters: 2100, epoch: 11 | loss: 0.2702283
	speed: 0.0105s/iter; left time: 216.5775s
	iters: 2200, epoch: 11 | loss: 0.2492294
	speed: 0.0110s/iter; left time: 226.0181s
Epoch: 11 cost time: 22.570780277252197
Epoch: 11, Steps: 2278 | Train Loss: 0.4545440 Vali Loss: 0.3766873 Test Loss: 0.1437249
Validation loss decreased (0.376971 --> 0.376687).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 1.5437145
	speed: 0.0454s/iter; left time: 925.4030s
	iters: 200, epoch: 12 | loss: 0.2339942
	speed: 0.0110s/iter; left time: 223.5747s
	iters: 300, epoch: 12 | loss: 0.2573946
	speed: 0.0108s/iter; left time: 217.2867s
	iters: 400, epoch: 12 | loss: 0.1803145
	speed: 0.0106s/iter; left time: 212.3809s
	iters: 500, epoch: 12 | loss: 2.2540891
	speed: 0.0110s/iter; left time: 219.6908s
	iters: 600, epoch: 12 | loss: 0.2219061
	speed: 0.0108s/iter; left time: 215.1947s
	iters: 700, epoch: 12 | loss: 0.2304398
	speed: 0.0103s/iter; left time: 203.0374s
	iters: 800, epoch: 12 | loss: 2.3576751
	speed: 0.0104s/iter; left time: 205.1512s
	iters: 900, epoch: 12 | loss: 0.2912379
	speed: 0.0102s/iter; left time: 200.7474s
	iters: 1000, epoch: 12 | loss: 0.3386886
	speed: 0.0101s/iter; left time: 196.2528s
	iters: 1100, epoch: 12 | loss: 0.3432737
	speed: 0.0101s/iter; left time: 195.6215s
	iters: 1200, epoch: 12 | loss: 0.2804648
	speed: 0.0094s/iter; left time: 182.2905s
	iters: 1300, epoch: 12 | loss: 0.1907963
	speed: 0.0098s/iter; left time: 187.8866s
	iters: 1400, epoch: 12 | loss: 0.5718942
	speed: 0.0103s/iter; left time: 196.4370s
	iters: 1500, epoch: 12 | loss: 0.2793015
	speed: 0.0105s/iter; left time: 200.3329s
	iters: 1600, epoch: 12 | loss: 0.3617934
	speed: 0.0086s/iter; left time: 161.6733s
	iters: 1700, epoch: 12 | loss: 0.2033280
	speed: 0.0092s/iter; left time: 172.8501s
	iters: 1800, epoch: 12 | loss: 0.2459594
	speed: 0.0106s/iter; left time: 198.4795s
	iters: 1900, epoch: 12 | loss: 0.5843430
	speed: 0.0089s/iter; left time: 165.2585s
	iters: 2000, epoch: 12 | loss: 0.5003734
	speed: 0.0095s/iter; left time: 175.0927s
	iters: 2100, epoch: 12 | loss: 0.2600185
	speed: 0.0079s/iter; left time: 145.5477s
	iters: 2200, epoch: 12 | loss: 0.2186985
	speed: 0.0089s/iter; left time: 162.7616s
Epoch: 12 cost time: 22.74284791946411
Epoch: 12, Steps: 2278 | Train Loss: 0.4527996 Vali Loss: 0.3787068 Test Loss: 0.1433863
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.2467218
	speed: 0.0420s/iter; left time: 760.9572s
	iters: 200, epoch: 13 | loss: 0.2945593
	speed: 0.0100s/iter; left time: 181.0212s
	iters: 300, epoch: 13 | loss: 0.2422603
	speed: 0.0090s/iter; left time: 161.5379s
	iters: 400, epoch: 13 | loss: 0.5227543
	speed: 0.0105s/iter; left time: 187.0295s
	iters: 500, epoch: 13 | loss: 0.2472678
	speed: 0.0106s/iter; left time: 188.1275s
	iters: 600, epoch: 13 | loss: 0.3863319
	speed: 0.0088s/iter; left time: 155.1234s
	iters: 700, epoch: 13 | loss: 0.2811259
	speed: 0.0095s/iter; left time: 167.2177s
	iters: 800, epoch: 13 | loss: 0.3291117
	speed: 0.0090s/iter; left time: 156.8672s
	iters: 900, epoch: 13 | loss: 0.2746904
	speed: 0.0097s/iter; left time: 167.9394s
	iters: 1000, epoch: 13 | loss: 0.2327734
	speed: 0.0099s/iter; left time: 170.9136s
	iters: 1100, epoch: 13 | loss: 0.2655229
	speed: 0.0095s/iter; left time: 162.8823s
	iters: 1200, epoch: 13 | loss: 0.3146999
	speed: 0.0088s/iter; left time: 149.6879s
	iters: 1300, epoch: 13 | loss: 0.2212482
	speed: 0.0088s/iter; left time: 148.9690s
	iters: 1400, epoch: 13 | loss: 0.2750334
	speed: 0.0083s/iter; left time: 139.6546s
	iters: 1500, epoch: 13 | loss: 2.7790670
	speed: 0.0081s/iter; left time: 134.7057s
	iters: 1600, epoch: 13 | loss: 0.5722662
	speed: 0.0101s/iter; left time: 167.9526s
	iters: 1700, epoch: 13 | loss: 0.2126393
	speed: 0.0092s/iter; left time: 152.6814s
	iters: 1800, epoch: 13 | loss: 0.2507320
	speed: 0.0092s/iter; left time: 151.1474s
	iters: 1900, epoch: 13 | loss: 0.5517544
	speed: 0.0100s/iter; left time: 163.4660s
	iters: 2000, epoch: 13 | loss: 0.2107445
	speed: 0.0074s/iter; left time: 120.1084s
	iters: 2100, epoch: 13 | loss: 0.6243418
	speed: 0.0080s/iter; left time: 129.5303s
	iters: 2200, epoch: 13 | loss: 0.2960738
	speed: 0.0091s/iter; left time: 146.3256s
Epoch: 13 cost time: 21.071565628051758
Epoch: 13, Steps: 2278 | Train Loss: 0.4520330 Vali Loss: 0.3780376 Test Loss: 0.1433370
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.4351268
	speed: 0.0386s/iter; left time: 611.8914s
	iters: 200, epoch: 14 | loss: 0.4637749
	speed: 0.0108s/iter; left time: 169.5060s
	iters: 300, epoch: 14 | loss: 0.4154507
	speed: 0.0111s/iter; left time: 173.2586s
	iters: 400, epoch: 14 | loss: 0.5456194
	speed: 0.0113s/iter; left time: 174.9546s
	iters: 500, epoch: 14 | loss: 0.5047305
	speed: 0.0104s/iter; left time: 159.9239s
	iters: 600, epoch: 14 | loss: 0.3185762
	speed: 0.0099s/iter; left time: 152.1364s
	iters: 700, epoch: 14 | loss: 0.7010806
	speed: 0.0097s/iter; left time: 148.5501s
	iters: 800, epoch: 14 | loss: 0.2075324
	speed: 0.0085s/iter; left time: 128.4926s
	iters: 900, epoch: 14 | loss: 0.2891212
	speed: 0.0089s/iter; left time: 133.9570s
	iters: 1000, epoch: 14 | loss: 0.2651534
	speed: 0.0086s/iter; left time: 128.4281s
	iters: 1100, epoch: 14 | loss: 2.4956424
	speed: 0.0095s/iter; left time: 141.3780s
	iters: 1200, epoch: 14 | loss: 0.2511196
	speed: 0.0102s/iter; left time: 150.1742s
	iters: 1300, epoch: 14 | loss: 0.2701564
	speed: 0.0099s/iter; left time: 145.3410s
	iters: 1400, epoch: 14 | loss: 0.2870402
	speed: 0.0107s/iter; left time: 155.4047s
	iters: 1500, epoch: 14 | loss: 0.8296102
	speed: 0.0096s/iter; left time: 139.1584s
	iters: 1600, epoch: 14 | loss: 0.3513825
	speed: 0.0097s/iter; left time: 139.6404s
	iters: 1700, epoch: 14 | loss: 0.2684671
	speed: 0.0097s/iter; left time: 138.3459s
	iters: 1800, epoch: 14 | loss: 2.5555003
	speed: 0.0088s/iter; left time: 123.9146s
	iters: 1900, epoch: 14 | loss: 0.1704269
	speed: 0.0094s/iter; left time: 132.6481s
	iters: 2000, epoch: 14 | loss: 0.8825801
	speed: 0.0096s/iter; left time: 134.4945s
	iters: 2100, epoch: 14 | loss: 0.3456582
	speed: 0.0098s/iter; left time: 135.3262s
	iters: 2200, epoch: 14 | loss: 0.3990965
	speed: 0.0100s/iter; left time: 137.5056s
Epoch: 14 cost time: 22.417311429977417
Epoch: 14, Steps: 2278 | Train Loss: 0.4515850 Vali Loss: 0.3784163 Test Loss: 0.1433463
EarlyStopping counter: 3 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.3078537
	speed: 0.0383s/iter; left time: 519.5592s
	iters: 200, epoch: 15 | loss: 2.2979891
	speed: 0.0093s/iter; left time: 125.6764s
	iters: 300, epoch: 15 | loss: 0.2686065
	speed: 0.0104s/iter; left time: 139.0419s
	iters: 400, epoch: 15 | loss: 0.2025010
	speed: 0.0101s/iter; left time: 134.0487s
	iters: 500, epoch: 15 | loss: 0.4812569
	speed: 0.0104s/iter; left time: 136.6091s
	iters: 600, epoch: 15 | loss: 0.3074855
	speed: 0.0098s/iter; left time: 127.9508s
	iters: 700, epoch: 15 | loss: 0.3889855
	speed: 0.0094s/iter; left time: 122.4631s
	iters: 800, epoch: 15 | loss: 0.2533394
	speed: 0.0094s/iter; left time: 120.9821s
	iters: 900, epoch: 15 | loss: 0.2092918
	speed: 0.0096s/iter; left time: 122.2342s
	iters: 1000, epoch: 15 | loss: 0.4983614
	speed: 0.0095s/iter; left time: 119.8862s
	iters: 1100, epoch: 15 | loss: 0.1752062
	speed: 0.0093s/iter; left time: 117.0522s
	iters: 1200, epoch: 15 | loss: 0.2670110
	speed: 0.0099s/iter; left time: 123.3491s
	iters: 1300, epoch: 15 | loss: 2.2484572
	speed: 0.0102s/iter; left time: 126.2127s
	iters: 1400, epoch: 15 | loss: 0.1866139
	speed: 0.0085s/iter; left time: 104.3209s
	iters: 1500, epoch: 15 | loss: 0.5557871
	speed: 0.0097s/iter; left time: 118.1934s
	iters: 1600, epoch: 15 | loss: 0.3142445
	speed: 0.0095s/iter; left time: 115.1839s
	iters: 1700, epoch: 15 | loss: 0.6254555
	speed: 0.0097s/iter; left time: 115.8906s
	iters: 1800, epoch: 15 | loss: 0.6745655
	speed: 0.0081s/iter; left time: 96.2350s
	iters: 1900, epoch: 15 | loss: 0.3258259
	speed: 0.0083s/iter; left time: 97.3500s
	iters: 2000, epoch: 15 | loss: 0.5625516
	speed: 0.0088s/iter; left time: 103.0615s
	iters: 2100, epoch: 15 | loss: 0.7419490
	speed: 0.0091s/iter; left time: 104.7287s
	iters: 2200, epoch: 15 | loss: 0.1990611
	speed: 0.0095s/iter; left time: 108.4235s
Epoch: 15 cost time: 21.42909002304077
Epoch: 15, Steps: 2278 | Train Loss: 0.4514075 Vali Loss: 0.3779646 Test Loss: 0.1433616
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.1413248
	speed: 0.0420s/iter; left time: 474.7645s
	iters: 200, epoch: 16 | loss: 0.3125048
	speed: 0.0103s/iter; left time: 115.7376s
	iters: 300, epoch: 16 | loss: 0.7432989
	speed: 0.0082s/iter; left time: 90.8619s
	iters: 400, epoch: 16 | loss: 0.2854510
	speed: 0.0083s/iter; left time: 91.4451s
	iters: 500, epoch: 16 | loss: 0.5681947
	speed: 0.0092s/iter; left time: 100.4523s
	iters: 600, epoch: 16 | loss: 0.5843737
	speed: 0.0090s/iter; left time: 96.8311s
	iters: 700, epoch: 16 | loss: 0.5834695
	speed: 0.0083s/iter; left time: 88.5455s
	iters: 800, epoch: 16 | loss: 0.2350620
	speed: 0.0082s/iter; left time: 86.7403s
	iters: 900, epoch: 16 | loss: 0.5788685
	speed: 0.0082s/iter; left time: 86.2632s
	iters: 1000, epoch: 16 | loss: 0.2756220
	speed: 0.0083s/iter; left time: 86.0637s
	iters: 1100, epoch: 16 | loss: 0.1640940
	speed: 0.0082s/iter; left time: 84.8188s
	iters: 1200, epoch: 16 | loss: 0.2555319
	speed: 0.0082s/iter; left time: 83.0921s
	iters: 1300, epoch: 16 | loss: 0.5577239
	speed: 0.0082s/iter; left time: 82.6453s
	iters: 1400, epoch: 16 | loss: 0.6092385
	speed: 0.0082s/iter; left time: 82.3516s
	iters: 1500, epoch: 16 | loss: 0.2864022
	speed: 0.0082s/iter; left time: 81.2260s
	iters: 1600, epoch: 16 | loss: 0.2496978
	speed: 0.0082s/iter; left time: 80.3161s
	iters: 1700, epoch: 16 | loss: 0.2388428
	speed: 0.0085s/iter; left time: 82.0957s
	iters: 1800, epoch: 16 | loss: 0.1945010
	speed: 0.0094s/iter; left time: 89.7949s
	iters: 1900, epoch: 16 | loss: 0.1766271
	speed: 0.0091s/iter; left time: 86.4861s
	iters: 2000, epoch: 16 | loss: 0.5825543
	speed: 0.0083s/iter; left time: 77.7658s
	iters: 2100, epoch: 16 | loss: 0.2507036
	speed: 0.0083s/iter; left time: 77.4216s
	iters: 2200, epoch: 16 | loss: 0.1612651
	speed: 0.0091s/iter; left time: 83.2938s
Epoch: 16 cost time: 19.684754133224487
Epoch: 16, Steps: 2278 | Train Loss: 0.4512866 Vali Loss: 0.3777946 Test Loss: 0.1433891
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : weather_336_96_NLinear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3144<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
mse:0.1437658667564392, mae:0.19314424693584442
