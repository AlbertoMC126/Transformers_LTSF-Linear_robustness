Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='Linear', model_id='weather_336_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=336, root_path='./dataset/', save_pred_values=False, seed=10458, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : weather_336_336_Linear_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed10458>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36216
val 4935
test 10204
	iters: 100, epoch: 1 | loss: 0.4132799
	speed: 0.0238s/iter; left time: 1076.9156s
	iters: 200, epoch: 1 | loss: 1.0155196
	speed: 0.0248s/iter; left time: 1118.7796s
	iters: 300, epoch: 1 | loss: 0.4470327
	speed: 0.0247s/iter; left time: 1110.1859s
	iters: 400, epoch: 1 | loss: 0.5155800
	speed: 0.0243s/iter; left time: 1089.7221s
	iters: 500, epoch: 1 | loss: 0.4220668
	speed: 0.0245s/iter; left time: 1098.8406s
	iters: 600, epoch: 1 | loss: 0.5510548
	speed: 0.0249s/iter; left time: 1113.7537s
	iters: 700, epoch: 1 | loss: 0.3849953
	speed: 0.0245s/iter; left time: 1093.9563s
	iters: 800, epoch: 1 | loss: 0.6411281
	speed: 0.0246s/iter; left time: 1093.3644s
	iters: 900, epoch: 1 | loss: 0.9273397
	speed: 0.0252s/iter; left time: 1115.6945s
	iters: 1000, epoch: 1 | loss: 0.4337153
	speed: 0.0247s/iter; left time: 1092.0968s
	iters: 1100, epoch: 1 | loss: 1.5758457
	speed: 0.0244s/iter; left time: 1078.9657s
	iters: 1200, epoch: 1 | loss: 0.7898183
	speed: 0.0247s/iter; left time: 1087.9999s
	iters: 1300, epoch: 1 | loss: 0.4695555
	speed: 0.0249s/iter; left time: 1093.3324s
	iters: 1400, epoch: 1 | loss: 0.4814424
	speed: 0.0245s/iter; left time: 1073.5644s
	iters: 1500, epoch: 1 | loss: 0.5678079
	speed: 0.0247s/iter; left time: 1082.0622s
	iters: 1600, epoch: 1 | loss: 0.5021030
	speed: 0.0246s/iter; left time: 1074.9507s
	iters: 1700, epoch: 1 | loss: 0.7218102
	speed: 0.0243s/iter; left time: 1056.8007s
	iters: 1800, epoch: 1 | loss: 0.8848382
	speed: 0.0250s/iter; left time: 1087.4570s
	iters: 1900, epoch: 1 | loss: 0.5320669
	speed: 0.0242s/iter; left time: 1050.2920s
	iters: 2000, epoch: 1 | loss: 0.6079965
	speed: 0.0247s/iter; left time: 1069.8606s
	iters: 2100, epoch: 1 | loss: 50.0581322
	speed: 0.0241s/iter; left time: 1039.8671s
	iters: 2200, epoch: 1 | loss: 19.5801144
	speed: 0.0240s/iter; left time: 1034.5995s
Epoch: 1 cost time: 55.58419466018677
Epoch: 1, Steps: 2263 | Train Loss: 1.4366702 Vali Loss: 0.6746211 Test Loss: 0.3339119
Validation loss decreased (inf --> 0.674621).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.6697501
	speed: 0.0780s/iter; left time: 3346.0958s
	iters: 200, epoch: 2 | loss: 0.5950177
	speed: 0.0247s/iter; left time: 1058.0528s
	iters: 300, epoch: 2 | loss: 0.6648741
	speed: 0.0248s/iter; left time: 1058.2484s
	iters: 400, epoch: 2 | loss: 0.4966609
	speed: 0.0246s/iter; left time: 1049.7611s
	iters: 500, epoch: 2 | loss: 0.4645516
	speed: 0.0243s/iter; left time: 1032.6460s
	iters: 600, epoch: 2 | loss: 0.5232559
	speed: 0.0246s/iter; left time: 1044.1488s
	iters: 700, epoch: 2 | loss: 0.7047451
	speed: 0.0247s/iter; left time: 1046.0519s
	iters: 800, epoch: 2 | loss: 0.6415284
	speed: 0.0247s/iter; left time: 1043.8687s
	iters: 900, epoch: 2 | loss: 0.5719946
	speed: 0.0242s/iter; left time: 1019.9517s
	iters: 1000, epoch: 2 | loss: 0.5114391
	speed: 0.0243s/iter; left time: 1021.0778s
	iters: 1100, epoch: 2 | loss: 0.8948737
	speed: 0.0243s/iter; left time: 1016.3496s
	iters: 1200, epoch: 2 | loss: 1.0133055
	speed: 0.0242s/iter; left time: 1009.4680s
	iters: 1300, epoch: 2 | loss: 0.5734801
	speed: 0.0242s/iter; left time: 1008.4780s
	iters: 1400, epoch: 2 | loss: 0.9586642
	speed: 0.0244s/iter; left time: 1016.8498s
	iters: 1500, epoch: 2 | loss: 0.4360982
	speed: 0.0241s/iter; left time: 999.8476s
	iters: 1600, epoch: 2 | loss: 1.0310538
	speed: 0.0247s/iter; left time: 1021.2635s
	iters: 1700, epoch: 2 | loss: 1.0624268
	speed: 0.0247s/iter; left time: 1019.3642s
	iters: 1800, epoch: 2 | loss: 1.0808233
	speed: 0.0247s/iter; left time: 1016.4150s
	iters: 1900, epoch: 2 | loss: 2.2125831
	speed: 0.0249s/iter; left time: 1022.5939s
	iters: 2000, epoch: 2 | loss: 1.1903306
	speed: 0.0251s/iter; left time: 1028.5824s
	iters: 2100, epoch: 2 | loss: 0.5078477
	speed: 0.0245s/iter; left time: 1003.1034s
	iters: 2200, epoch: 2 | loss: 0.8589323
	speed: 0.0244s/iter; left time: 994.2741s
Epoch: 2 cost time: 55.336000204086304
Epoch: 2, Steps: 2263 | Train Loss: 1.1683084 Vali Loss: 0.6596985 Test Loss: 0.3387862
Validation loss decreased (0.674621 --> 0.659698).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.9396757
	speed: 0.0789s/iter; left time: 3204.5195s
	iters: 200, epoch: 3 | loss: 0.9762619
	speed: 0.0247s/iter; left time: 1000.9173s
	iters: 300, epoch: 3 | loss: 0.4628547
	speed: 0.0241s/iter; left time: 976.2198s
	iters: 400, epoch: 3 | loss: 0.3770142
	speed: 0.0243s/iter; left time: 978.4117s
	iters: 500, epoch: 3 | loss: 0.6019613
	speed: 0.0246s/iter; left time: 990.7989s
	iters: 600, epoch: 3 | loss: 0.4629043
	speed: 0.0243s/iter; left time: 976.2012s
	iters: 700, epoch: 3 | loss: 0.5141936
	speed: 0.0242s/iter; left time: 969.8363s
	iters: 800, epoch: 3 | loss: 0.4825339
	speed: 0.0244s/iter; left time: 972.6583s
	iters: 900, epoch: 3 | loss: 0.5462424
	speed: 0.0244s/iter; left time: 971.3932s
	iters: 1000, epoch: 3 | loss: 0.4402956
	speed: 0.0243s/iter; left time: 965.4320s
	iters: 1100, epoch: 3 | loss: 0.4919325
	speed: 0.0243s/iter; left time: 961.3751s
	iters: 1200, epoch: 3 | loss: 0.4155028
	speed: 0.0241s/iter; left time: 953.3767s
	iters: 1300, epoch: 3 | loss: 0.5307143
	speed: 0.0240s/iter; left time: 947.7433s
	iters: 1400, epoch: 3 | loss: 2.2272625
	speed: 0.0240s/iter; left time: 944.3279s
	iters: 1500, epoch: 3 | loss: 0.5663915
	speed: 0.0242s/iter; left time: 948.9505s
	iters: 1600, epoch: 3 | loss: 0.4885171
	speed: 0.0242s/iter; left time: 946.2063s
	iters: 1700, epoch: 3 | loss: 0.4213848
	speed: 0.0241s/iter; left time: 940.4686s
	iters: 1800, epoch: 3 | loss: 1.7488461
	speed: 0.0242s/iter; left time: 940.8113s
	iters: 1900, epoch: 3 | loss: 0.3612056
	speed: 0.0242s/iter; left time: 941.2060s
	iters: 2000, epoch: 3 | loss: 2.3229952
	speed: 0.0249s/iter; left time: 966.1593s
	iters: 2100, epoch: 3 | loss: 0.6169261
	speed: 0.0241s/iter; left time: 932.8205s
	iters: 2200, epoch: 3 | loss: 0.4123288
	speed: 0.0238s/iter; left time: 915.8798s
Epoch: 3 cost time: 54.74401307106018
Epoch: 3, Steps: 2263 | Train Loss: 0.8269216 Vali Loss: 0.5646713 Test Loss: 0.2730388
Validation loss decreased (0.659698 --> 0.564671).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.6915907
	speed: 0.0793s/iter; left time: 3044.2264s
	iters: 200, epoch: 4 | loss: 0.5221254
	speed: 0.0245s/iter; left time: 937.2136s
	iters: 300, epoch: 4 | loss: 0.4158524
	speed: 0.0244s/iter; left time: 932.8316s
	iters: 400, epoch: 4 | loss: 0.4092790
	speed: 0.0244s/iter; left time: 927.2580s
	iters: 500, epoch: 4 | loss: 0.3997338
	speed: 0.0245s/iter; left time: 930.0720s
	iters: 600, epoch: 4 | loss: 0.4776018
	speed: 0.0244s/iter; left time: 924.7531s
	iters: 700, epoch: 4 | loss: 0.3641017
	speed: 0.0247s/iter; left time: 933.8518s
	iters: 800, epoch: 4 | loss: 0.3467017
	speed: 0.0250s/iter; left time: 940.5267s
	iters: 900, epoch: 4 | loss: 0.4548748
	speed: 0.0247s/iter; left time: 926.6076s
	iters: 1000, epoch: 4 | loss: 0.8041710
	speed: 0.0248s/iter; left time: 929.2299s
	iters: 1100, epoch: 4 | loss: 0.3550937
	speed: 0.0248s/iter; left time: 926.6692s
	iters: 1200, epoch: 4 | loss: 0.5139609
	speed: 0.0248s/iter; left time: 923.9805s
	iters: 1300, epoch: 4 | loss: 0.3401567
	speed: 0.0248s/iter; left time: 922.8312s
	iters: 1400, epoch: 4 | loss: 0.5854126
	speed: 0.0241s/iter; left time: 893.9156s
	iters: 1500, epoch: 4 | loss: 0.5844491
	speed: 0.0246s/iter; left time: 908.4212s
	iters: 1600, epoch: 4 | loss: 0.5116255
	speed: 0.0244s/iter; left time: 901.0453s
	iters: 1700, epoch: 4 | loss: 0.4620705
	speed: 0.0251s/iter; left time: 923.4088s
	iters: 1800, epoch: 4 | loss: 0.4093581
	speed: 0.0245s/iter; left time: 898.1332s
	iters: 1900, epoch: 4 | loss: 0.4506574
	speed: 0.0244s/iter; left time: 891.3921s
	iters: 2000, epoch: 4 | loss: 0.7064339
	speed: 0.0244s/iter; left time: 889.1726s
	iters: 2100, epoch: 4 | loss: 1.1173522
	speed: 0.0242s/iter; left time: 881.7212s
	iters: 2200, epoch: 4 | loss: 0.7606587
	speed: 0.0245s/iter; left time: 889.0482s
Epoch: 4 cost time: 55.33411169052124
Epoch: 4, Steps: 2263 | Train Loss: 0.6676722 Vali Loss: 0.5092974 Test Loss: 0.2604242
Validation loss decreased (0.564671 --> 0.509297).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.5569879
	speed: 0.0783s/iter; left time: 2825.6380s
	iters: 200, epoch: 5 | loss: 0.4748724
	speed: 0.0245s/iter; left time: 881.0021s
	iters: 300, epoch: 5 | loss: 0.3874173
	speed: 0.0252s/iter; left time: 905.6915s
	iters: 400, epoch: 5 | loss: 0.5163643
	speed: 0.0248s/iter; left time: 889.3187s
	iters: 500, epoch: 5 | loss: 0.4419454
	speed: 0.0247s/iter; left time: 881.0612s
	iters: 600, epoch: 5 | loss: 0.4118513
	speed: 0.0247s/iter; left time: 879.5885s
	iters: 700, epoch: 5 | loss: 0.4333227
	speed: 0.0248s/iter; left time: 880.6103s
	iters: 800, epoch: 5 | loss: 0.5650403
	speed: 0.0238s/iter; left time: 842.6418s
	iters: 900, epoch: 5 | loss: 1.1679379
	speed: 0.0248s/iter; left time: 877.1823s
	iters: 1000, epoch: 5 | loss: 0.3921479
	speed: 0.0245s/iter; left time: 863.8594s
	iters: 1100, epoch: 5 | loss: 0.9803629
	speed: 0.0246s/iter; left time: 865.2789s
	iters: 1200, epoch: 5 | loss: 0.3993577
	speed: 0.0247s/iter; left time: 864.3064s
	iters: 1300, epoch: 5 | loss: 0.4395638
	speed: 0.0244s/iter; left time: 850.6370s
	iters: 1400, epoch: 5 | loss: 0.3643191
	speed: 0.0244s/iter; left time: 847.6346s
	iters: 1500, epoch: 5 | loss: 0.6349114
	speed: 0.0249s/iter; left time: 863.1269s
	iters: 1600, epoch: 5 | loss: 1.0203580
	speed: 0.0246s/iter; left time: 852.8459s
	iters: 1700, epoch: 5 | loss: 0.3522567
	speed: 0.0243s/iter; left time: 839.8061s
	iters: 1800, epoch: 5 | loss: 0.3869168
	speed: 0.0246s/iter; left time: 846.4690s
	iters: 1900, epoch: 5 | loss: 0.4596710
	speed: 0.0249s/iter; left time: 852.7675s
	iters: 2000, epoch: 5 | loss: 0.6123847
	speed: 0.0246s/iter; left time: 839.9263s
	iters: 2100, epoch: 5 | loss: 0.4890406
	speed: 0.0244s/iter; left time: 832.4447s
	iters: 2200, epoch: 5 | loss: 0.3371601
	speed: 0.0243s/iter; left time: 827.6309s
Epoch: 5 cost time: 55.420974016189575
Epoch: 5, Steps: 2263 | Train Loss: 0.6185353 Vali Loss: 0.5085791 Test Loss: 0.2541368
Validation loss decreased (0.509297 --> 0.508579).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.5850340
	speed: 0.0790s/iter; left time: 2673.3524s
	iters: 200, epoch: 6 | loss: 0.4023285
	speed: 0.0243s/iter; left time: 821.4617s
	iters: 300, epoch: 6 | loss: 0.3677771
	speed: 0.0244s/iter; left time: 819.5361s
	iters: 400, epoch: 6 | loss: 0.4531099
	speed: 0.0245s/iter; left time: 821.6007s
	iters: 500, epoch: 6 | loss: 0.5309892
	speed: 0.0239s/iter; left time: 798.8937s
	iters: 600, epoch: 6 | loss: 0.9790128
	speed: 0.0245s/iter; left time: 816.3754s
	iters: 700, epoch: 6 | loss: 0.5085121
	speed: 0.0242s/iter; left time: 806.1278s
	iters: 800, epoch: 6 | loss: 0.6858268
	speed: 0.0246s/iter; left time: 814.8792s
	iters: 900, epoch: 6 | loss: 0.5044266
	speed: 0.0246s/iter; left time: 811.6796s
	iters: 1000, epoch: 6 | loss: 1.0158523
	speed: 0.0253s/iter; left time: 832.3033s
	iters: 1100, epoch: 6 | loss: 0.3174826
	speed: 0.0241s/iter; left time: 793.0750s
	iters: 1200, epoch: 6 | loss: 5.4749508
	speed: 0.0242s/iter; left time: 790.9511s
	iters: 1300, epoch: 6 | loss: 0.4290524
	speed: 0.0244s/iter; left time: 796.1877s
	iters: 1400, epoch: 6 | loss: 0.4778365
	speed: 0.0247s/iter; left time: 803.8938s
	iters: 1500, epoch: 6 | loss: 0.6689236
	speed: 0.0242s/iter; left time: 785.8851s
	iters: 1600, epoch: 6 | loss: 0.4615982
	speed: 0.0243s/iter; left time: 786.5158s
	iters: 1700, epoch: 6 | loss: 0.4347010
	speed: 0.0247s/iter; left time: 796.4960s
	iters: 1800, epoch: 6 | loss: 0.3361928
	speed: 0.0242s/iter; left time: 777.3185s
	iters: 1900, epoch: 6 | loss: 0.3293468
	speed: 0.0252s/iter; left time: 806.6336s
	iters: 2000, epoch: 6 | loss: 0.9391481
	speed: 0.0244s/iter; left time: 779.2641s
	iters: 2100, epoch: 6 | loss: 0.4654448
	speed: 0.0243s/iter; left time: 773.7508s
	iters: 2200, epoch: 6 | loss: 0.3549707
	speed: 0.0242s/iter; left time: 769.3318s
Epoch: 6 cost time: 55.06607365608215
Epoch: 6, Steps: 2263 | Train Loss: 0.5983728 Vali Loss: 0.4999544 Test Loss: 0.2447141
Validation loss decreased (0.508579 --> 0.499954).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 1.4394629
	speed: 0.0774s/iter; left time: 2443.8939s
	iters: 200, epoch: 7 | loss: 0.3620104
	speed: 0.0246s/iter; left time: 774.8606s
	iters: 300, epoch: 7 | loss: 0.5434965
	speed: 0.0242s/iter; left time: 759.3904s
	iters: 400, epoch: 7 | loss: 0.3960995
	speed: 0.0242s/iter; left time: 758.4507s
	iters: 500, epoch: 7 | loss: 0.5025089
	speed: 0.0244s/iter; left time: 759.5903s
	iters: 600, epoch: 7 | loss: 0.8657664
	speed: 0.0244s/iter; left time: 758.0351s
	iters: 700, epoch: 7 | loss: 0.3499239
	speed: 0.0242s/iter; left time: 750.5696s
	iters: 800, epoch: 7 | loss: 0.5611803
	speed: 0.0243s/iter; left time: 751.5640s
	iters: 900, epoch: 7 | loss: 0.3679728
	speed: 0.0244s/iter; left time: 751.5660s
	iters: 1000, epoch: 7 | loss: 0.3185870
	speed: 0.0241s/iter; left time: 740.9105s
	iters: 1100, epoch: 7 | loss: 0.3191625
	speed: 0.0245s/iter; left time: 749.8436s
	iters: 1200, epoch: 7 | loss: 0.8984700
	speed: 0.0248s/iter; left time: 755.5438s
	iters: 1300, epoch: 7 | loss: 0.6447597
	speed: 0.0242s/iter; left time: 736.7840s
	iters: 1400, epoch: 7 | loss: 0.9435678
	speed: 0.0246s/iter; left time: 745.6344s
	iters: 1500, epoch: 7 | loss: 0.3784232
	speed: 0.0242s/iter; left time: 731.2429s
	iters: 1600, epoch: 7 | loss: 0.9417438
	speed: 0.0245s/iter; left time: 738.1300s
	iters: 1700, epoch: 7 | loss: 0.5830507
	speed: 0.0244s/iter; left time: 731.2856s
	iters: 1800, epoch: 7 | loss: 0.8712758
	speed: 0.0244s/iter; left time: 729.5374s
	iters: 1900, epoch: 7 | loss: 0.2895646
	speed: 0.0242s/iter; left time: 719.4488s
	iters: 2000, epoch: 7 | loss: 0.4107391
	speed: 0.0240s/iter; left time: 713.0416s
	iters: 2100, epoch: 7 | loss: 0.3575162
	speed: 0.0238s/iter; left time: 703.0236s
	iters: 2200, epoch: 7 | loss: 0.5314704
	speed: 0.0244s/iter; left time: 720.3949s
Epoch: 7 cost time: 54.77943420410156
Epoch: 7, Steps: 2263 | Train Loss: 0.5886270 Vali Loss: 0.4993048 Test Loss: 0.2428587
Validation loss decreased (0.499954 --> 0.499305).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.6143115
	speed: 0.0795s/iter; left time: 2331.0813s
	iters: 200, epoch: 8 | loss: 0.3959503
	speed: 0.0242s/iter; left time: 708.4002s
	iters: 300, epoch: 8 | loss: 0.5090397
	speed: 0.0248s/iter; left time: 721.7351s
	iters: 400, epoch: 8 | loss: 0.3881170
	speed: 0.0242s/iter; left time: 701.7190s
	iters: 500, epoch: 8 | loss: 0.3419029
	speed: 0.0245s/iter; left time: 707.6825s
	iters: 600, epoch: 8 | loss: 0.6410320
	speed: 0.0241s/iter; left time: 694.2189s
	iters: 700, epoch: 8 | loss: 0.3567362
	speed: 0.0245s/iter; left time: 703.6490s
	iters: 800, epoch: 8 | loss: 1.0082276
	speed: 0.0246s/iter; left time: 703.4769s
	iters: 900, epoch: 8 | loss: 0.3643584
	speed: 0.0248s/iter; left time: 708.6751s
	iters: 1000, epoch: 8 | loss: 0.4476351
	speed: 0.0253s/iter; left time: 717.6614s
	iters: 1100, epoch: 8 | loss: 0.3515489
	speed: 0.0251s/iter; left time: 711.5338s
	iters: 1200, epoch: 8 | loss: 0.3685528
	speed: 0.0244s/iter; left time: 689.9743s
	iters: 1300, epoch: 8 | loss: 0.4789631
	speed: 0.0239s/iter; left time: 673.4023s
	iters: 1400, epoch: 8 | loss: 0.5717778
	speed: 0.0249s/iter; left time: 697.4817s
	iters: 1500, epoch: 8 | loss: 0.4471876
	speed: 0.0247s/iter; left time: 689.0486s
	iters: 1600, epoch: 8 | loss: 0.3831594
	speed: 0.0243s/iter; left time: 676.2594s
	iters: 1700, epoch: 8 | loss: 0.4075648
	speed: 0.0246s/iter; left time: 682.5624s
	iters: 1800, epoch: 8 | loss: 0.5488471
	speed: 0.0244s/iter; left time: 674.9212s
	iters: 1900, epoch: 8 | loss: 0.4603989
	speed: 0.0244s/iter; left time: 672.3611s
	iters: 2000, epoch: 8 | loss: 0.3555626
	speed: 0.0247s/iter; left time: 675.9992s
	iters: 2100, epoch: 8 | loss: 0.3460849
	speed: 0.0244s/iter; left time: 666.3283s
	iters: 2200, epoch: 8 | loss: 0.4260796
	speed: 0.0247s/iter; left time: 671.1497s
Epoch: 8 cost time: 55.25123834609985
Epoch: 8, Steps: 2263 | Train Loss: 0.5836917 Vali Loss: 0.4930686 Test Loss: 0.2417559
Validation loss decreased (0.499305 --> 0.493069).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.5112994
	speed: 0.0784s/iter; left time: 2122.3627s
	iters: 200, epoch: 9 | loss: 0.4691225
	speed: 0.0241s/iter; left time: 650.4461s
	iters: 300, epoch: 9 | loss: 0.6034347
	speed: 0.0253s/iter; left time: 680.4474s
	iters: 400, epoch: 9 | loss: 0.5511121
	speed: 0.0254s/iter; left time: 680.1121s
	iters: 500, epoch: 9 | loss: 0.2950224
	speed: 0.0253s/iter; left time: 674.4493s
	iters: 600, epoch: 9 | loss: 0.3420312
	speed: 0.0250s/iter; left time: 662.7046s
	iters: 700, epoch: 9 | loss: 0.4318593
	speed: 0.0255s/iter; left time: 673.8297s
	iters: 800, epoch: 9 | loss: 0.5069314
	speed: 0.0263s/iter; left time: 694.3426s
	iters: 900, epoch: 9 | loss: 0.4021451
	speed: 0.0249s/iter; left time: 654.6421s
	iters: 1000, epoch: 9 | loss: 3.1108921
	speed: 0.0236s/iter; left time: 617.3456s
	iters: 1100, epoch: 9 | loss: 0.4133205
	speed: 0.0232s/iter; left time: 605.6614s
	iters: 1200, epoch: 9 | loss: 0.4710160
	speed: 0.0233s/iter; left time: 603.9759s
	iters: 1300, epoch: 9 | loss: 0.3821583
	speed: 0.0227s/iter; left time: 586.9401s
	iters: 1400, epoch: 9 | loss: 0.3309840
	speed: 0.0225s/iter; left time: 578.2886s
	iters: 1500, epoch: 9 | loss: 0.3360785
	speed: 0.0228s/iter; left time: 584.6152s
	iters: 1600, epoch: 9 | loss: 0.8504910
	speed: 0.0244s/iter; left time: 624.3068s
	iters: 1700, epoch: 9 | loss: 0.4535876
	speed: 0.0247s/iter; left time: 627.8326s
	iters: 1800, epoch: 9 | loss: 0.3666601
	speed: 0.0228s/iter; left time: 577.9802s
	iters: 1900, epoch: 9 | loss: 0.3363944
	speed: 0.0232s/iter; left time: 585.1687s
	iters: 2000, epoch: 9 | loss: 0.3897215
	speed: 0.0233s/iter; left time: 586.6463s
	iters: 2100, epoch: 9 | loss: 0.4731966
	speed: 0.0226s/iter; left time: 566.9447s
	iters: 2200, epoch: 9 | loss: 0.5320696
	speed: 0.0224s/iter; left time: 558.4671s
Epoch: 9 cost time: 53.9084210395813
Epoch: 9, Steps: 2263 | Train Loss: 0.5812033 Vali Loss: 0.4934897 Test Loss: 0.2414577
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.4449400
	speed: 0.0735s/iter; left time: 1822.5978s
	iters: 200, epoch: 10 | loss: 0.3800939
	speed: 0.0219s/iter; left time: 540.4718s
	iters: 300, epoch: 10 | loss: 0.8849874
	speed: 0.0236s/iter; left time: 581.3725s
	iters: 400, epoch: 10 | loss: 0.5263251
	speed: 0.0243s/iter; left time: 595.3810s
	iters: 500, epoch: 10 | loss: 0.3097186
	speed: 0.0243s/iter; left time: 591.8879s
	iters: 600, epoch: 10 | loss: 0.3874164
	speed: 0.0259s/iter; left time: 629.2506s
	iters: 700, epoch: 10 | loss: 0.5831396
	speed: 0.0245s/iter; left time: 593.8106s
	iters: 800, epoch: 10 | loss: 0.4419882
	speed: 0.0228s/iter; left time: 548.4176s
	iters: 900, epoch: 10 | loss: 0.3243158
	speed: 0.0223s/iter; left time: 534.3948s
	iters: 1000, epoch: 10 | loss: 1.1407584
	speed: 0.0256s/iter; left time: 610.5127s
	iters: 1100, epoch: 10 | loss: 0.4260643
	speed: 0.0225s/iter; left time: 535.0068s
	iters: 1200, epoch: 10 | loss: 0.6520221
	speed: 0.0224s/iter; left time: 530.0005s
	iters: 1300, epoch: 10 | loss: 0.4991802
	speed: 0.0243s/iter; left time: 572.5016s
	iters: 1400, epoch: 10 | loss: 0.4033288
	speed: 0.0231s/iter; left time: 542.4017s
	iters: 1500, epoch: 10 | loss: 0.4427624
	speed: 0.0236s/iter; left time: 551.9841s
	iters: 1600, epoch: 10 | loss: 0.3773763
	speed: 0.0233s/iter; left time: 542.9690s
	iters: 1700, epoch: 10 | loss: 0.3792134
	speed: 0.0245s/iter; left time: 568.7018s
	iters: 1800, epoch: 10 | loss: 0.4173276
	speed: 0.0224s/iter; left time: 517.0190s
	iters: 1900, epoch: 10 | loss: 0.5641668
	speed: 0.0219s/iter; left time: 502.9418s
	iters: 2000, epoch: 10 | loss: 0.4409436
	speed: 0.0210s/iter; left time: 480.0229s
	iters: 2100, epoch: 10 | loss: 0.4810579
	speed: 0.0211s/iter; left time: 479.9074s
	iters: 2200, epoch: 10 | loss: 0.3298351
	speed: 0.0216s/iter; left time: 490.4242s
Epoch: 10 cost time: 51.98366117477417
Epoch: 10, Steps: 2263 | Train Loss: 0.5800005 Vali Loss: 0.4942048 Test Loss: 0.2412182
EarlyStopping counter: 2 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.3649546
	speed: 0.0694s/iter; left time: 1563.0974s
	iters: 200, epoch: 11 | loss: 0.3664530
	speed: 0.0196s/iter; left time: 440.3709s
	iters: 300, epoch: 11 | loss: 0.3873180
	speed: 0.0206s/iter; left time: 460.4029s
	iters: 400, epoch: 11 | loss: 0.4179665
	speed: 0.0225s/iter; left time: 500.4472s
	iters: 500, epoch: 11 | loss: 0.3852176
	speed: 0.0255s/iter; left time: 563.9102s
	iters: 600, epoch: 11 | loss: 0.4768262
	speed: 0.0240s/iter; left time: 529.4012s
	iters: 700, epoch: 11 | loss: 0.4231122
	speed: 0.0217s/iter; left time: 476.0289s
	iters: 800, epoch: 11 | loss: 0.4697405
	speed: 0.0223s/iter; left time: 485.7931s
	iters: 900, epoch: 11 | loss: 0.4768764
	speed: 0.0227s/iter; left time: 493.1206s
	iters: 1000, epoch: 11 | loss: 0.3073146
	speed: 0.0236s/iter; left time: 510.9607s
	iters: 1100, epoch: 11 | loss: 0.8333819
	speed: 0.0234s/iter; left time: 504.5388s
	iters: 1200, epoch: 11 | loss: 1.0949714
	speed: 0.0237s/iter; left time: 508.2700s
	iters: 1300, epoch: 11 | loss: 0.3011077
	speed: 0.0231s/iter; left time: 493.1427s
	iters: 1400, epoch: 11 | loss: 0.3517826
	speed: 0.0215s/iter; left time: 455.5759s
	iters: 1500, epoch: 11 | loss: 0.4042100
	speed: 0.0224s/iter; left time: 472.9548s
	iters: 1600, epoch: 11 | loss: 0.8662437
	speed: 0.0236s/iter; left time: 495.2931s
	iters: 1700, epoch: 11 | loss: 0.3971396
	speed: 0.0220s/iter; left time: 460.7595s
	iters: 1800, epoch: 11 | loss: 0.3399724
	speed: 0.0247s/iter; left time: 514.6351s
	iters: 1900, epoch: 11 | loss: 0.4368864
	speed: 0.0240s/iter; left time: 497.5030s
	iters: 2000, epoch: 11 | loss: 0.9345552
	speed: 0.0237s/iter; left time: 487.9701s
	iters: 2100, epoch: 11 | loss: 0.9798700
	speed: 0.0209s/iter; left time: 428.0926s
	iters: 2200, epoch: 11 | loss: 0.4823889
	speed: 0.0216s/iter; left time: 441.3942s
Epoch: 11 cost time: 50.821364402770996
Epoch: 11, Steps: 2263 | Train Loss: 0.5793584 Vali Loss: 0.4944802 Test Loss: 0.2413114
EarlyStopping counter: 3 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 1.0552132
	speed: 0.0683s/iter; left time: 1383.7362s
	iters: 200, epoch: 12 | loss: 15.8199301
	speed: 0.0191s/iter; left time: 384.5988s
	iters: 300, epoch: 12 | loss: 0.4530863
	speed: 0.0208s/iter; left time: 418.2384s
	iters: 400, epoch: 12 | loss: 0.3953677
	speed: 0.0233s/iter; left time: 464.6604s
	iters: 500, epoch: 12 | loss: 0.4052962
	speed: 0.0213s/iter; left time: 423.5623s
	iters: 600, epoch: 12 | loss: 0.4783722
	speed: 0.0209s/iter; left time: 413.7437s
	iters: 700, epoch: 12 | loss: 0.9990541
	speed: 0.0215s/iter; left time: 422.6080s
	iters: 800, epoch: 12 | loss: 0.4131703
	speed: 0.0246s/iter; left time: 480.4630s
	iters: 900, epoch: 12 | loss: 0.4838749
	speed: 0.0230s/iter; left time: 447.4098s
	iters: 1000, epoch: 12 | loss: 0.4431030
	speed: 0.0213s/iter; left time: 412.4835s
	iters: 1100, epoch: 12 | loss: 0.4119242
	speed: 0.0215s/iter; left time: 415.1661s
	iters: 1200, epoch: 12 | loss: 0.4877746
	speed: 0.0196s/iter; left time: 375.2506s
	iters: 1300, epoch: 12 | loss: 0.4371326
	speed: 0.0202s/iter; left time: 386.0579s
	iters: 1400, epoch: 12 | loss: 0.9665589
	speed: 0.0229s/iter; left time: 434.6138s
	iters: 1500, epoch: 12 | loss: 0.4502670
	speed: 0.0200s/iter; left time: 378.1918s
	iters: 1600, epoch: 12 | loss: 0.3038710
	speed: 0.0206s/iter; left time: 385.7472s
	iters: 1700, epoch: 12 | loss: 0.8763857
	speed: 0.0213s/iter; left time: 398.0383s
	iters: 1800, epoch: 12 | loss: 0.4215914
	speed: 0.0214s/iter; left time: 397.8744s
	iters: 1900, epoch: 12 | loss: 0.4816264
	speed: 0.0232s/iter; left time: 429.1600s
	iters: 2000, epoch: 12 | loss: 0.5204961
	speed: 0.0226s/iter; left time: 414.6736s
	iters: 2100, epoch: 12 | loss: 0.4801238
	speed: 0.0224s/iter; left time: 409.1701s
	iters: 2200, epoch: 12 | loss: 0.4052081
	speed: 0.0190s/iter; left time: 344.4817s
Epoch: 12 cost time: 48.35870814323425
Epoch: 12, Steps: 2263 | Train Loss: 0.5789744 Vali Loss: 0.4934332 Test Loss: 0.2415155
EarlyStopping counter: 4 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 1.6741297
	speed: 0.0752s/iter; left time: 1353.8423s
	iters: 200, epoch: 13 | loss: 0.9431177
	speed: 0.0200s/iter; left time: 357.8429s
	iters: 300, epoch: 13 | loss: 0.3500009
	speed: 0.0219s/iter; left time: 389.4090s
	iters: 400, epoch: 13 | loss: 0.4606067
	speed: 0.0220s/iter; left time: 388.7780s
	iters: 500, epoch: 13 | loss: 1.0031074
	speed: 0.0233s/iter; left time: 410.9784s
	iters: 600, epoch: 13 | loss: 0.4785917
	speed: 0.0219s/iter; left time: 383.9981s
	iters: 700, epoch: 13 | loss: 0.3920312
	speed: 0.0222s/iter; left time: 386.5072s
	iters: 800, epoch: 13 | loss: 0.4717017
	speed: 0.0213s/iter; left time: 368.0144s
	iters: 900, epoch: 13 | loss: 0.3039912
	speed: 0.0201s/iter; left time: 346.2597s
	iters: 1000, epoch: 13 | loss: 0.4593094
	speed: 0.0199s/iter; left time: 341.0007s
	iters: 1100, epoch: 13 | loss: 0.5437234
	speed: 0.0195s/iter; left time: 332.3621s
	iters: 1200, epoch: 13 | loss: 0.3471267
	speed: 0.0190s/iter; left time: 320.9676s
	iters: 1300, epoch: 13 | loss: 0.4709077
	speed: 0.0192s/iter; left time: 322.1590s
	iters: 1400, epoch: 13 | loss: 0.4021957
	speed: 0.0216s/iter; left time: 360.2478s
	iters: 1500, epoch: 13 | loss: 0.4627044
	speed: 0.0215s/iter; left time: 356.4360s
	iters: 1600, epoch: 13 | loss: 0.5173499
	speed: 0.0195s/iter; left time: 322.5485s
	iters: 1700, epoch: 13 | loss: 0.4212077
	speed: 0.0196s/iter; left time: 321.0171s
	iters: 1800, epoch: 13 | loss: 0.4589083
	speed: 0.0203s/iter; left time: 330.2517s
	iters: 1900, epoch: 13 | loss: 0.5257025
	speed: 0.0200s/iter; left time: 324.2176s
	iters: 2000, epoch: 13 | loss: 0.3377456
	speed: 0.0201s/iter; left time: 323.1676s
	iters: 2100, epoch: 13 | loss: 0.4067153
	speed: 0.0201s/iter; left time: 321.7733s
	iters: 2200, epoch: 13 | loss: 0.4772708
	speed: 0.0198s/iter; left time: 314.8668s
Epoch: 13 cost time: 46.08519458770752
Epoch: 13, Steps: 2263 | Train Loss: 0.5788302 Vali Loss: 0.4947927 Test Loss: 0.2416791
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : weather_336_336_Linear_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed10458<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10204
mse:0.24182312190532684, mae:0.3028339445590973
