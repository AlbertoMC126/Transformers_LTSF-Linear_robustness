Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='NLinear', model_id='traffic_336_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=336, root_path='./dataset/', save_pred_values=False, seed=25565, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_336_336_NLinear_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed25565>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11609
val 1421
test 3173
	iters: 100, epoch: 1 | loss: 0.9619941
	speed: 0.3221s/iter; left time: 4638.5403s
	iters: 200, epoch: 1 | loss: 1.0111767
	speed: 0.3076s/iter; left time: 4399.6552s
	iters: 300, epoch: 1 | loss: 0.9350665
	speed: 0.3077s/iter; left time: 4369.2743s
	iters: 400, epoch: 1 | loss: 1.9808882
	speed: 0.3062s/iter; left time: 4317.3606s
	iters: 500, epoch: 1 | loss: 0.9237717
	speed: 0.3070s/iter; left time: 4298.6433s
	iters: 600, epoch: 1 | loss: 1.0230186
	speed: 0.3076s/iter; left time: 4276.1153s
	iters: 700, epoch: 1 | loss: 2.1624949
	speed: 0.3068s/iter; left time: 4233.5368s
Epoch: 1 cost time: 224.35290479660034
Epoch: 1, Steps: 725 | Train Loss: 1.0633123 Vali Loss: 1.2106843 Test Loss: 1.3753650
Validation loss decreased (inf --> 1.210684).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.8311980
	speed: 0.6064s/iter; left time: 8293.6571s
	iters: 200, epoch: 2 | loss: 0.8970257
	speed: 0.3066s/iter; left time: 4162.4779s
	iters: 300, epoch: 2 | loss: 0.9118922
	speed: 0.3100s/iter; left time: 4177.4993s
	iters: 400, epoch: 2 | loss: 0.8045696
	speed: 0.3075s/iter; left time: 4113.3098s
	iters: 500, epoch: 2 | loss: 0.8439597
	speed: 0.3056s/iter; left time: 4057.3038s
	iters: 600, epoch: 2 | loss: 0.7734447
	speed: 0.3054s/iter; left time: 4023.7529s
	iters: 700, epoch: 2 | loss: 1.1062981
	speed: 0.3050s/iter; left time: 3988.3797s
Epoch: 2 cost time: 222.4880108833313
Epoch: 2, Steps: 725 | Train Loss: 1.0619287 Vali Loss: 1.6527920 Test Loss: 2.0636826
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.3447065
	speed: 0.6021s/iter; left time: 7798.3801s
	iters: 200, epoch: 3 | loss: 0.3983303
	speed: 0.3055s/iter; left time: 3926.4533s
	iters: 300, epoch: 3 | loss: 0.3674765
	speed: 0.3066s/iter; left time: 3909.8261s
	iters: 400, epoch: 3 | loss: 0.3842457
	speed: 0.3065s/iter; left time: 3877.0946s
	iters: 500, epoch: 3 | loss: 0.3580055
	speed: 0.3072s/iter; left time: 3856.0359s
	iters: 600, epoch: 3 | loss: 0.3669624
	speed: 0.3102s/iter; left time: 3861.8064s
	iters: 700, epoch: 3 | loss: 0.4086392
	speed: 0.3078s/iter; left time: 3801.8301s
Epoch: 3 cost time: 222.77815341949463
Epoch: 3, Steps: 725 | Train Loss: 0.3795620 Vali Loss: 0.5145121 Test Loss: 0.6303214
Validation loss decreased (1.210684 --> 0.514512).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.2821061
	speed: 0.6076s/iter; left time: 7428.2658s
	iters: 200, epoch: 4 | loss: 0.2748347
	speed: 0.3083s/iter; left time: 3738.7630s
	iters: 300, epoch: 4 | loss: 0.3154427
	speed: 0.3088s/iter; left time: 3713.6519s
	iters: 400, epoch: 4 | loss: 0.3044625
	speed: 0.3099s/iter; left time: 3695.8617s
	iters: 500, epoch: 4 | loss: 0.3106744
	speed: 0.3082s/iter; left time: 3644.5751s
	iters: 600, epoch: 4 | loss: 0.2925730
	speed: 0.3068s/iter; left time: 3597.6130s
	iters: 700, epoch: 4 | loss: 0.3103906
	speed: 0.3050s/iter; left time: 3545.9116s
Epoch: 4 cost time: 223.26394939422607
Epoch: 4, Steps: 725 | Train Loss: 0.2995456 Vali Loss: 0.4345037 Test Loss: 0.5339105
Validation loss decreased (0.514512 --> 0.434504).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.2582519
	speed: 0.6075s/iter; left time: 6986.9885s
	iters: 200, epoch: 5 | loss: 0.2558516
	speed: 0.3107s/iter; left time: 3541.7992s
	iters: 300, epoch: 5 | loss: 0.2587044
	speed: 0.3075s/iter; left time: 3475.1313s
	iters: 400, epoch: 5 | loss: 0.2873241
	speed: 0.3075s/iter; left time: 3444.4303s
	iters: 500, epoch: 5 | loss: 0.2868510
	speed: 0.3081s/iter; left time: 3419.8110s
	iters: 600, epoch: 5 | loss: 0.2863257
	speed: 0.3075s/iter; left time: 3382.4750s
	iters: 700, epoch: 5 | loss: 0.2987539
	speed: 0.3066s/iter; left time: 3342.4111s
Epoch: 5 cost time: 223.34079384803772
Epoch: 5, Steps: 725 | Train Loss: 0.2766500 Vali Loss: 0.3886335 Test Loss: 0.4817714
Validation loss decreased (0.434504 --> 0.388634).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.2583334
	speed: 0.6061s/iter; left time: 6530.8297s
	iters: 200, epoch: 6 | loss: 0.2606488
	speed: 0.3066s/iter; left time: 3273.2539s
	iters: 300, epoch: 6 | loss: 0.3159180
	speed: 0.3078s/iter; left time: 3255.6590s
	iters: 400, epoch: 6 | loss: 0.2636107
	speed: 0.3101s/iter; left time: 3249.0779s
	iters: 500, epoch: 6 | loss: 0.2552679
	speed: 0.3097s/iter; left time: 3213.6720s
	iters: 600, epoch: 6 | loss: 0.2586678
	speed: 0.3093s/iter; left time: 3178.0080s
	iters: 700, epoch: 6 | loss: 0.3034738
	speed: 0.3073s/iter; left time: 3127.5117s
Epoch: 6 cost time: 223.51875352859497
Epoch: 6, Steps: 725 | Train Loss: 0.2664509 Vali Loss: 0.3756873 Test Loss: 0.4662321
Validation loss decreased (0.388634 --> 0.375687).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.2870241
	speed: 0.6064s/iter; left time: 6094.9371s
	iters: 200, epoch: 7 | loss: 0.2638599
	speed: 0.3071s/iter; left time: 3055.4563s
	iters: 300, epoch: 7 | loss: 0.2636411
	speed: 0.3070s/iter; left time: 3024.2459s
	iters: 400, epoch: 7 | loss: 0.2456346
	speed: 0.3080s/iter; left time: 3002.8806s
	iters: 500, epoch: 7 | loss: 0.2507442
	speed: 0.3079s/iter; left time: 2971.4884s
	iters: 600, epoch: 7 | loss: 0.2571652
	speed: 0.3078s/iter; left time: 2939.5488s
	iters: 700, epoch: 7 | loss: 0.2667855
	speed: 0.3076s/iter; left time: 2907.5242s
Epoch: 7 cost time: 223.26113748550415
Epoch: 7, Steps: 725 | Train Loss: 0.2608110 Vali Loss: 0.3695020 Test Loss: 0.4587340
Validation loss decreased (0.375687 --> 0.369502).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.2875771
	speed: 0.6112s/iter; left time: 5699.9983s
	iters: 200, epoch: 8 | loss: 0.2592525
	speed: 0.3069s/iter; left time: 2831.5992s
	iters: 300, epoch: 8 | loss: 0.2638753
	speed: 0.3071s/iter; left time: 2802.5135s
	iters: 400, epoch: 8 | loss: 0.2584608
	speed: 0.3073s/iter; left time: 2773.9126s
	iters: 500, epoch: 8 | loss: 0.2350335
	speed: 0.3091s/iter; left time: 2759.0943s
	iters: 600, epoch: 8 | loss: 0.2556655
	speed: 0.3084s/iter; left time: 2721.5495s
	iters: 700, epoch: 8 | loss: 0.2384164
	speed: 0.3073s/iter; left time: 2681.1300s
Epoch: 8 cost time: 223.25957107543945
Epoch: 8, Steps: 725 | Train Loss: 0.2574362 Vali Loss: 0.3660725 Test Loss: 0.4534218
Validation loss decreased (0.369502 --> 0.366072).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.2514058
	speed: 0.6095s/iter; left time: 5242.3132s
	iters: 200, epoch: 9 | loss: 0.2620665
	speed: 0.3078s/iter; left time: 2616.2762s
	iters: 300, epoch: 9 | loss: 0.2623524
	speed: 0.3117s/iter; left time: 2618.8571s
	iters: 400, epoch: 9 | loss: 0.2520748
	speed: 0.3074s/iter; left time: 2551.9049s
	iters: 500, epoch: 9 | loss: 0.2666952
	speed: 0.3081s/iter; left time: 2527.0344s
	iters: 600, epoch: 9 | loss: 0.2692887
	speed: 0.3089s/iter; left time: 2502.4268s
	iters: 700, epoch: 9 | loss: 0.2410077
	speed: 0.3086s/iter; left time: 2469.1029s
Epoch: 9 cost time: 224.0214192867279
Epoch: 9, Steps: 725 | Train Loss: 0.2555324 Vali Loss: 0.3644277 Test Loss: 0.4523187
Validation loss decreased (0.366072 --> 0.364428).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.2667759
	speed: 0.6107s/iter; left time: 4809.7075s
	iters: 200, epoch: 10 | loss: 0.2540862
	speed: 0.3070s/iter; left time: 2387.2392s
	iters: 300, epoch: 10 | loss: 0.2417766
	speed: 0.3083s/iter; left time: 2366.6297s
	iters: 400, epoch: 10 | loss: 0.2351256
	speed: 0.3078s/iter; left time: 2332.0231s
	iters: 500, epoch: 10 | loss: 0.2432071
	speed: 0.3071s/iter; left time: 2295.5274s
	iters: 600, epoch: 10 | loss: 0.2681723
	speed: 0.3104s/iter; left time: 2289.2458s
	iters: 700, epoch: 10 | loss: 0.2544837
	speed: 0.3081s/iter; left time: 2241.8761s
Epoch: 10 cost time: 223.60656666755676
Epoch: 10, Steps: 725 | Train Loss: 0.2544224 Vali Loss: 0.3633324 Test Loss: 0.4508971
Validation loss decreased (0.364428 --> 0.363332).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.2477969
	speed: 0.6115s/iter; left time: 4372.6828s
	iters: 200, epoch: 11 | loss: 0.2366206
	speed: 0.3068s/iter; left time: 2163.3447s
	iters: 300, epoch: 11 | loss: 0.2813935
	speed: 0.3084s/iter; left time: 2143.7029s
	iters: 400, epoch: 11 | loss: 0.2604267
	speed: 0.3078s/iter; left time: 2108.4147s
	iters: 500, epoch: 11 | loss: 0.2575621
	speed: 0.3069s/iter; left time: 2071.8301s
	iters: 600, epoch: 11 | loss: 0.2690687
	speed: 0.3080s/iter; left time: 2048.6373s
	iters: 700, epoch: 11 | loss: 0.2365198
	speed: 0.3085s/iter; left time: 2020.7544s
Epoch: 11 cost time: 223.4126913547516
Epoch: 11, Steps: 725 | Train Loss: 0.2537796 Vali Loss: 0.3626533 Test Loss: 0.4502005
Validation loss decreased (0.363332 --> 0.362653).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.2611743
	speed: 0.6113s/iter; left time: 3927.9495s
	iters: 200, epoch: 12 | loss: 0.2490093
	speed: 0.3139s/iter; left time: 1985.8455s
	iters: 300, epoch: 12 | loss: 0.2360719
	speed: 0.3090s/iter; left time: 1923.8921s
	iters: 400, epoch: 12 | loss: 0.2594471
	speed: 0.3098s/iter; left time: 1898.0012s
	iters: 500, epoch: 12 | loss: 0.2447639
	speed: 0.3103s/iter; left time: 1869.6628s
	iters: 600, epoch: 12 | loss: 0.2350619
	speed: 0.3091s/iter; left time: 1831.6114s
	iters: 700, epoch: 12 | loss: 0.2870989
	speed: 0.3087s/iter; left time: 1798.7324s
Epoch: 12 cost time: 224.9353940486908
Epoch: 12, Steps: 725 | Train Loss: 0.2534617 Vali Loss: 0.3625334 Test Loss: 0.4499383
Validation loss decreased (0.362653 --> 0.362533).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.2514841
	speed: 0.6110s/iter; left time: 3483.0863s
	iters: 200, epoch: 13 | loss: 0.2906103
	speed: 0.3084s/iter; left time: 1727.5211s
	iters: 300, epoch: 13 | loss: 0.2772633
	speed: 0.3084s/iter; left time: 1696.5682s
	iters: 400, epoch: 13 | loss: 0.2734309
	speed: 0.3075s/iter; left time: 1660.9302s
	iters: 500, epoch: 13 | loss: 0.2307565
	speed: 0.3120s/iter; left time: 1653.9226s
	iters: 600, epoch: 13 | loss: 0.2418654
	speed: 0.3092s/iter; left time: 1607.9583s
	iters: 700, epoch: 13 | loss: 0.2514469
	speed: 0.3088s/iter; left time: 1575.4115s
Epoch: 13 cost time: 224.2963125705719
Epoch: 13, Steps: 725 | Train Loss: 0.2533060 Vali Loss: 0.3625451 Test Loss: 0.4497231
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 14 | loss: 0.2599208
	speed: 0.6084s/iter; left time: 3027.6294s
	iters: 200, epoch: 14 | loss: 0.2330796
	speed: 0.3092s/iter; left time: 1507.4323s
	iters: 300, epoch: 14 | loss: 0.2531751
	speed: 0.3094s/iter; left time: 1477.9264s
	iters: 400, epoch: 14 | loss: 0.2693315
	speed: 0.3076s/iter; left time: 1438.1532s
	iters: 500, epoch: 14 | loss: 0.2758100
	speed: 0.3085s/iter; left time: 1411.9157s
	iters: 600, epoch: 14 | loss: 0.2870951
	speed: 0.3101s/iter; left time: 1387.8383s
	iters: 700, epoch: 14 | loss: 0.2426564
	speed: 0.3090s/iter; left time: 1352.0294s
Epoch: 14 cost time: 224.20728850364685
Epoch: 14, Steps: 725 | Train Loss: 0.2531724 Vali Loss: 0.3624001 Test Loss: 0.4496321
Validation loss decreased (0.362533 --> 0.362400).  Saving model ...
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 15 | loss: 0.2509042
	speed: 0.6182s/iter; left time: 2628.0805s
	iters: 200, epoch: 15 | loss: 0.2417064
	speed: 0.3093s/iter; left time: 1284.0509s
	iters: 300, epoch: 15 | loss: 0.2469173
	speed: 0.3079s/iter; left time: 1247.3036s
	iters: 400, epoch: 15 | loss: 0.2509769
	speed: 0.3088s/iter; left time: 1220.1088s
	iters: 500, epoch: 15 | loss: 0.2498341
	speed: 0.3080s/iter; left time: 1185.9296s
	iters: 600, epoch: 15 | loss: 0.2491478
	speed: 0.3078s/iter; left time: 1154.5219s
	iters: 700, epoch: 15 | loss: 0.2580476
	speed: 0.3088s/iter; left time: 1127.2495s
Epoch: 15 cost time: 224.11953687667847
Epoch: 15, Steps: 725 | Train Loss: 0.2531218 Vali Loss: 0.3624136 Test Loss: 0.4496412
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 16 | loss: 0.2274226
	speed: 0.6090s/iter; left time: 2147.1987s
	iters: 200, epoch: 16 | loss: 0.2517400
	speed: 0.3108s/iter; left time: 1064.7540s
	iters: 300, epoch: 16 | loss: 0.2394716
	speed: 0.3117s/iter; left time: 1036.7231s
	iters: 400, epoch: 16 | loss: 0.2573658
	speed: 0.3114s/iter; left time: 1004.5894s
	iters: 500, epoch: 16 | loss: 0.2519106
	speed: 0.3084s/iter; left time: 963.9142s
	iters: 600, epoch: 16 | loss: 0.2473903
	speed: 0.3092s/iter; left time: 935.7128s
	iters: 700, epoch: 16 | loss: 0.2799105
	speed: 0.3084s/iter; left time: 902.5156s
Epoch: 16 cost time: 224.82511568069458
Epoch: 16, Steps: 725 | Train Loss: 0.2531003 Vali Loss: 0.3625472 Test Loss: 0.4496259
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 17 | loss: 0.2671579
	speed: 0.6056s/iter; left time: 1696.3876s
	iters: 200, epoch: 17 | loss: 0.2656948
	speed: 0.3089s/iter; left time: 834.4076s
	iters: 300, epoch: 17 | loss: 0.2656592
	speed: 0.3081s/iter; left time: 801.4934s
	iters: 400, epoch: 17 | loss: 0.2723251
	speed: 0.3093s/iter; left time: 773.6777s
	iters: 500, epoch: 17 | loss: 0.2659100
	speed: 0.3090s/iter; left time: 742.0217s
	iters: 600, epoch: 17 | loss: 0.2467826
	speed: 0.3102s/iter; left time: 713.7986s
	iters: 700, epoch: 17 | loss: 0.2540901
	speed: 0.3091s/iter; left time: 680.3158s
Epoch: 17 cost time: 224.07740378379822
Epoch: 17, Steps: 725 | Train Loss: 0.2530632 Vali Loss: 0.3625498 Test Loss: 0.4496207
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 18 | loss: 0.2613850
	speed: 0.6054s/iter; left time: 1256.7484s
	iters: 200, epoch: 18 | loss: 0.2434065
	speed: 0.3088s/iter; left time: 610.2718s
	iters: 300, epoch: 18 | loss: 0.2474606
	speed: 0.3105s/iter; left time: 582.5511s
	iters: 400, epoch: 18 | loss: 0.2622126
	speed: 0.3098s/iter; left time: 550.1996s
	iters: 500, epoch: 18 | loss: 0.2623810
	speed: 0.3106s/iter; left time: 520.4838s
	iters: 600, epoch: 18 | loss: 0.2516662
	speed: 0.3092s/iter; left time: 487.2558s
	iters: 700, epoch: 18 | loss: 0.2530806
	speed: 0.3086s/iter; left time: 455.4948s
Epoch: 18 cost time: 224.27851676940918
Epoch: 18, Steps: 725 | Train Loss: 0.2530666 Vali Loss: 0.3621342 Test Loss: 0.4496200
Validation loss decreased (0.362400 --> 0.362134).  Saving model ...
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 19 | loss: 0.2533094
	speed: 0.6110s/iter; left time: 825.4027s
	iters: 200, epoch: 19 | loss: 0.3065942
	speed: 0.3090s/iter; left time: 386.5439s
	iters: 300, epoch: 19 | loss: 0.2442240
	speed: 0.3082s/iter; left time: 354.7275s
	iters: 400, epoch: 19 | loss: 0.2510417
	speed: 0.3089s/iter; left time: 324.6537s
	iters: 500, epoch: 19 | loss: 0.2489134
	speed: 0.3099s/iter; left time: 294.7538s
	iters: 600, epoch: 19 | loss: 0.2362570
	speed: 0.3091s/iter; left time: 263.0212s
	iters: 700, epoch: 19 | loss: 0.2581415
	speed: 0.3092s/iter; left time: 232.2213s
Epoch: 19 cost time: 224.25478267669678
Epoch: 19, Steps: 725 | Train Loss: 0.2530427 Vali Loss: 0.3627242 Test Loss: 0.4496189
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 20 | loss: 0.2481285
	speed: 0.6072s/iter; left time: 380.1151s
	iters: 200, epoch: 20 | loss: 0.2653463
	speed: 0.3090s/iter; left time: 162.5160s
	iters: 300, epoch: 20 | loss: 0.2583537
	speed: 0.3090s/iter; left time: 131.6384s
	iters: 400, epoch: 20 | loss: 0.2298590
	speed: 0.3081s/iter; left time: 100.4494s
	iters: 500, epoch: 20 | loss: 0.2596669
	speed: 0.3085s/iter; left time: 69.7239s
	iters: 600, epoch: 20 | loss: 0.2641400
	speed: 0.3088s/iter; left time: 38.9107s
	iters: 700, epoch: 20 | loss: 0.2359190
	speed: 0.3088s/iter; left time: 8.0282s
Epoch: 20 cost time: 223.86044645309448
Epoch: 20, Steps: 725 | Train Loss: 0.2530252 Vali Loss: 0.3622821 Test Loss: 0.4496188
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.9073486328125e-08
>>>>>>>testing : traffic_336_336_NLinear_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed25565<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3173
mse:0.44847699999809265, mae:0.3052041530609131
