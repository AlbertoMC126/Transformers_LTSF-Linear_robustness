Args in experiment:
Namespace(activation='gelu', batch_size=8, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='exchange_rate.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=8, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='mse', lradj='type1', model='DLinear', model_id='Exchange_336_192', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=192, root_path='./dataset/', save_pred_values=False, seed=32598, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : Exchange_336_192_DLinear_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed32598>>>>>>>>>>>>>>>>>>>>>>>>>>
train 4784
val 569
test 1326
	iters: 100, epoch: 1 | loss: 0.2104903
	speed: 0.0086s/iter; left time: 102.0044s
	iters: 200, epoch: 1 | loss: 0.1914606
	speed: 0.0083s/iter; left time: 97.8841s
	iters: 300, epoch: 1 | loss: 0.1510849
	speed: 0.0084s/iter; left time: 98.0932s
	iters: 400, epoch: 1 | loss: 0.1348536
	speed: 0.0085s/iter; left time: 98.6214s
	iters: 500, epoch: 1 | loss: 0.2926773
	speed: 0.0082s/iter; left time: 93.9549s
Epoch: 1 cost time: 5.036622047424316
Epoch: 1, Steps: 598 | Train Loss: 0.2673942 Vali Loss: 0.5512056 Test Loss: 0.2173122
Validation loss decreased (inf --> 0.551206).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2447028
	speed: 0.0215s/iter; left time: 241.9437s
	iters: 200, epoch: 2 | loss: 0.4815367
	speed: 0.0078s/iter; left time: 87.4396s
	iters: 300, epoch: 2 | loss: 0.2121407
	speed: 0.0073s/iter; left time: 81.2026s
	iters: 400, epoch: 2 | loss: 0.1411459
	speed: 0.0085s/iter; left time: 93.3101s
	iters: 500, epoch: 2 | loss: 0.1655611
	speed: 0.0078s/iter; left time: 84.9758s
Epoch: 2 cost time: 4.7766194343566895
Epoch: 2, Steps: 598 | Train Loss: 0.2322689 Vali Loss: 0.4878515 Test Loss: 0.1959840
Validation loss decreased (0.551206 --> 0.487851).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.2055355
	speed: 0.0200s/iter; left time: 213.3779s
	iters: 200, epoch: 3 | loss: 0.2679245
	speed: 0.0086s/iter; left time: 91.2943s
	iters: 300, epoch: 3 | loss: 0.1440364
	speed: 0.0087s/iter; left time: 90.5503s
	iters: 400, epoch: 3 | loss: 0.2736495
	speed: 0.0082s/iter; left time: 85.4135s
	iters: 500, epoch: 3 | loss: 0.1717432
	speed: 0.0082s/iter; left time: 84.3698s
Epoch: 3 cost time: 5.00685977935791
Epoch: 3, Steps: 598 | Train Loss: 0.2183315 Vali Loss: 0.4533312 Test Loss: 0.1952718
Validation loss decreased (0.487851 --> 0.453331).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.3116387
	speed: 0.0209s/iter; left time: 209.9289s
	iters: 200, epoch: 4 | loss: 0.4050569
	speed: 0.0076s/iter; left time: 75.7651s
	iters: 300, epoch: 4 | loss: 0.1473809
	speed: 0.0072s/iter; left time: 71.2801s
	iters: 400, epoch: 4 | loss: 0.1609154
	speed: 0.0079s/iter; left time: 76.7864s
	iters: 500, epoch: 4 | loss: 0.2109194
	speed: 0.0075s/iter; left time: 72.9261s
Epoch: 4 cost time: 4.5998289585113525
Epoch: 4, Steps: 598 | Train Loss: 0.2135591 Vali Loss: 0.4669423 Test Loss: 0.2003033
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.3512929
	speed: 0.0201s/iter; left time: 190.0640s
	iters: 200, epoch: 5 | loss: 0.3349058
	speed: 0.0087s/iter; left time: 81.6038s
	iters: 300, epoch: 5 | loss: 0.1684881
	speed: 0.0091s/iter; left time: 84.1909s
	iters: 400, epoch: 5 | loss: 0.3222152
	speed: 0.0090s/iter; left time: 82.9271s
	iters: 500, epoch: 5 | loss: 0.1235018
	speed: 0.0088s/iter; left time: 80.1061s
Epoch: 5 cost time: 5.2392590045928955
Epoch: 5, Steps: 598 | Train Loss: 0.2108572 Vali Loss: 0.4239883 Test Loss: 0.1792019
Validation loss decreased (0.453331 --> 0.423988).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1783399
	speed: 0.0216s/iter; left time: 191.5655s
	iters: 200, epoch: 6 | loss: 0.1186895
	speed: 0.0089s/iter; left time: 78.2526s
	iters: 300, epoch: 6 | loss: 0.2472155
	speed: 0.0078s/iter; left time: 67.4110s
	iters: 400, epoch: 6 | loss: 0.1811814
	speed: 0.0072s/iter; left time: 61.6365s
	iters: 500, epoch: 6 | loss: 0.1248933
	speed: 0.0074s/iter; left time: 62.6855s
Epoch: 6 cost time: 4.793353319168091
Epoch: 6, Steps: 598 | Train Loss: 0.2098040 Vali Loss: 0.4481438 Test Loss: 0.1775727
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1326872
	speed: 0.0206s/iter; left time: 170.7908s
	iters: 200, epoch: 7 | loss: 0.2221469
	speed: 0.0086s/iter; left time: 70.3042s
	iters: 300, epoch: 7 | loss: 0.2114874
	speed: 0.0086s/iter; left time: 69.3692s
	iters: 400, epoch: 7 | loss: 0.1986924
	speed: 0.0083s/iter; left time: 66.4359s
	iters: 500, epoch: 7 | loss: 0.1924897
	speed: 0.0075s/iter; left time: 58.7785s
Epoch: 7 cost time: 4.8272318840026855
Epoch: 7, Steps: 598 | Train Loss: 0.2091592 Vali Loss: 0.4486845 Test Loss: 0.1802429
EarlyStopping counter: 2 out of 5
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.2328237
	speed: 0.0184s/iter; left time: 140.9549s
	iters: 200, epoch: 8 | loss: 0.1874912
	speed: 0.0078s/iter; left time: 59.3880s
	iters: 300, epoch: 8 | loss: 0.1709900
	speed: 0.0081s/iter; left time: 60.2337s
	iters: 400, epoch: 8 | loss: 0.1918081
	speed: 0.0080s/iter; left time: 58.9436s
	iters: 500, epoch: 8 | loss: 0.1900405
	speed: 0.0080s/iter; left time: 57.9353s
Epoch: 8 cost time: 4.667714595794678
Epoch: 8, Steps: 598 | Train Loss: 0.2087355 Vali Loss: 0.4579934 Test Loss: 0.1821757
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.1801464
	speed: 0.0183s/iter; left time: 129.1872s
	iters: 200, epoch: 9 | loss: 0.2315313
	speed: 0.0079s/iter; left time: 55.2606s
	iters: 300, epoch: 9 | loss: 0.4535055
	speed: 0.0080s/iter; left time: 55.1758s
	iters: 400, epoch: 9 | loss: 0.1704076
	speed: 0.0077s/iter; left time: 52.4072s
	iters: 500, epoch: 9 | loss: 0.1422981
	speed: 0.0076s/iter; left time: 50.9619s
Epoch: 9 cost time: 4.616140604019165
Epoch: 9, Steps: 598 | Train Loss: 0.2085913 Vali Loss: 0.4505588 Test Loss: 0.1804538
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.3611436
	speed: 0.0176s/iter; left time: 114.0197s
	iters: 200, epoch: 10 | loss: 0.2691933
	speed: 0.0067s/iter; left time: 42.8913s
	iters: 300, epoch: 10 | loss: 0.1504262
	speed: 0.0066s/iter; left time: 41.6409s
	iters: 400, epoch: 10 | loss: 0.1675198
	speed: 0.0067s/iter; left time: 41.4611s
	iters: 500, epoch: 10 | loss: 0.1524641
	speed: 0.0065s/iter; left time: 39.7109s
Epoch: 10 cost time: 3.9547910690307617
Epoch: 10, Steps: 598 | Train Loss: 0.2084796 Vali Loss: 0.4544407 Test Loss: 0.1810950
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : Exchange_336_192_DLinear_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed32598<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 1326
mse:0.1790684312582016, mae:0.316427618265152
