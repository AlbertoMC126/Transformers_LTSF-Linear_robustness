Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='DLinear', model_id='ETTm2_336_720', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=720, root_path='./dataset/', save_pred_values=False, seed=25565, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTm2_336_720_DLinear_ETTm2_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed25565>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33505
val 10801
test 10801
	iters: 100, epoch: 1 | loss: 0.4706286
	speed: 0.0351s/iter; left time: 731.2243s
	iters: 200, epoch: 1 | loss: 0.6143924
	speed: 0.0377s/iter; left time: 782.0772s
	iters: 300, epoch: 1 | loss: 0.7500077
	speed: 0.0349s/iter; left time: 721.1664s
	iters: 400, epoch: 1 | loss: 1.1208633
	speed: 0.0362s/iter; left time: 742.7491s
	iters: 500, epoch: 1 | loss: 0.8040808
	speed: 0.0354s/iter; left time: 724.2494s
	iters: 600, epoch: 1 | loss: 0.9119066
	speed: 0.0370s/iter; left time: 752.0757s
	iters: 700, epoch: 1 | loss: 0.5157666
	speed: 0.0374s/iter; left time: 756.7522s
	iters: 800, epoch: 1 | loss: 0.4207554
	speed: 0.0370s/iter; left time: 745.7835s
	iters: 900, epoch: 1 | loss: 2.5398979
	speed: 0.0363s/iter; left time: 727.8194s
	iters: 1000, epoch: 1 | loss: 1.3675265
	speed: 0.0323s/iter; left time: 644.7087s
Epoch: 1 cost time: 37.451743364334106
Epoch: 1, Steps: 1047 | Train Loss: 0.8483852 Vali Loss: 0.8338133 Test Loss: 1.6653039
Validation loss decreased (inf --> 0.833813).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.4881070
	speed: 0.1091s/iter; left time: 2159.7771s
	iters: 200, epoch: 2 | loss: 0.8025601
	speed: 0.0352s/iter; left time: 693.2263s
	iters: 300, epoch: 2 | loss: 0.8833337
	speed: 0.0374s/iter; left time: 731.9733s
	iters: 400, epoch: 2 | loss: 0.7976988
	speed: 0.0364s/iter; left time: 708.7120s
	iters: 500, epoch: 2 | loss: 0.7820281
	speed: 0.0362s/iter; left time: 701.6136s
	iters: 600, epoch: 2 | loss: 1.0573589
	speed: 0.0382s/iter; left time: 737.3460s
	iters: 700, epoch: 2 | loss: 0.7728255
	speed: 0.0382s/iter; left time: 733.1838s
	iters: 800, epoch: 2 | loss: 0.7080117
	speed: 0.0394s/iter; left time: 751.5439s
	iters: 900, epoch: 2 | loss: 0.8089315
	speed: 0.0348s/iter; left time: 660.2938s
	iters: 1000, epoch: 2 | loss: 0.4784482
	speed: 0.0377s/iter; left time: 713.1191s
Epoch: 2 cost time: 38.154797077178955
Epoch: 2, Steps: 1047 | Train Loss: 0.7492631 Vali Loss: 1.1408701 Test Loss: 3.3498225
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.6136081
	speed: 0.1134s/iter; left time: 2126.5975s
	iters: 200, epoch: 3 | loss: 0.5574264
	speed: 0.0371s/iter; left time: 692.5707s
	iters: 300, epoch: 3 | loss: 0.4811810
	speed: 0.0362s/iter; left time: 672.0417s
	iters: 400, epoch: 3 | loss: 0.6410730
	speed: 0.0364s/iter; left time: 671.6538s
	iters: 500, epoch: 3 | loss: 0.6329877
	speed: 0.0369s/iter; left time: 676.2277s
	iters: 600, epoch: 3 | loss: 0.7562287
	speed: 0.0342s/iter; left time: 624.3863s
	iters: 700, epoch: 3 | loss: 0.4304242
	speed: 0.0357s/iter; left time: 648.1115s
	iters: 800, epoch: 3 | loss: 0.4956735
	speed: 0.0350s/iter; left time: 632.5337s
	iters: 900, epoch: 3 | loss: 0.6955946
	speed: 0.0366s/iter; left time: 657.6438s
	iters: 1000, epoch: 3 | loss: 0.4825954
	speed: 0.0383s/iter; left time: 683.8317s
Epoch: 3 cost time: 37.51052284240723
Epoch: 3, Steps: 1047 | Train Loss: 0.5646189 Vali Loss: 0.4909809 Test Loss: 0.9964268
Validation loss decreased (0.833813 --> 0.490981).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.3930922
	speed: 0.1122s/iter; left time: 1985.3727s
	iters: 200, epoch: 4 | loss: 0.7107338
	speed: 0.0378s/iter; left time: 665.0568s
	iters: 300, epoch: 4 | loss: 0.6495577
	speed: 0.0384s/iter; left time: 671.7195s
	iters: 400, epoch: 4 | loss: 0.3175237
	speed: 0.0367s/iter; left time: 639.3782s
	iters: 500, epoch: 4 | loss: 0.4254178
	speed: 0.0383s/iter; left time: 662.3757s
	iters: 600, epoch: 4 | loss: 0.4371080
	speed: 0.0389s/iter; left time: 669.2196s
	iters: 700, epoch: 4 | loss: 0.5581982
	speed: 0.0362s/iter; left time: 618.6706s
	iters: 800, epoch: 4 | loss: 0.4320497
	speed: 0.0366s/iter; left time: 622.1118s
	iters: 900, epoch: 4 | loss: 0.5029006
	speed: 0.0384s/iter; left time: 649.3322s
	iters: 1000, epoch: 4 | loss: 0.5386760
	speed: 0.0366s/iter; left time: 614.7448s
Epoch: 4 cost time: 38.63857841491699
Epoch: 4, Steps: 1047 | Train Loss: 0.5095250 Vali Loss: 0.5366834 Test Loss: 1.1398402
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.5808107
	speed: 0.1119s/iter; left time: 1864.0748s
	iters: 200, epoch: 5 | loss: 0.4222339
	speed: 0.0365s/iter; left time: 604.7102s
	iters: 300, epoch: 5 | loss: 0.3815733
	speed: 0.0378s/iter; left time: 621.5774s
	iters: 400, epoch: 5 | loss: 0.3266214
	speed: 0.0376s/iter; left time: 614.5896s
	iters: 500, epoch: 5 | loss: 0.4719241
	speed: 0.0365s/iter; left time: 592.5032s
	iters: 600, epoch: 5 | loss: 0.2533874
	speed: 0.0361s/iter; left time: 582.8934s
	iters: 700, epoch: 5 | loss: 0.5658575
	speed: 0.0378s/iter; left time: 607.4244s
	iters: 800, epoch: 5 | loss: 0.8945233
	speed: 0.0355s/iter; left time: 565.8457s
	iters: 900, epoch: 5 | loss: 0.2570998
	speed: 0.0372s/iter; left time: 589.1174s
	iters: 1000, epoch: 5 | loss: 0.4385140
	speed: 0.0364s/iter; left time: 573.8182s
Epoch: 5 cost time: 37.9500412940979
Epoch: 5, Steps: 1047 | Train Loss: 0.4840564 Vali Loss: 0.4439315 Test Loss: 0.8527157
Validation loss decreased (0.490981 --> 0.443932).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.4462269
	speed: 0.1108s/iter; left time: 1728.6977s
	iters: 200, epoch: 6 | loss: 0.5206320
	speed: 0.0349s/iter; left time: 540.7116s
	iters: 300, epoch: 6 | loss: 0.3963933
	speed: 0.0352s/iter; left time: 542.7948s
	iters: 400, epoch: 6 | loss: 0.5617656
	speed: 0.0379s/iter; left time: 580.5366s
	iters: 500, epoch: 6 | loss: 0.4148996
	speed: 0.0370s/iter; left time: 561.9389s
	iters: 600, epoch: 6 | loss: 0.4799588
	speed: 0.0387s/iter; left time: 584.1714s
	iters: 700, epoch: 6 | loss: 0.5781897
	speed: 0.0377s/iter; left time: 565.5143s
	iters: 800, epoch: 6 | loss: 0.4172545
	speed: 0.0357s/iter; left time: 532.4442s
	iters: 900, epoch: 6 | loss: 0.6399845
	speed: 0.0376s/iter; left time: 556.8530s
	iters: 1000, epoch: 6 | loss: 0.4472941
	speed: 0.0372s/iter; left time: 546.7319s
Epoch: 6 cost time: 38.0089750289917
Epoch: 6, Steps: 1047 | Train Loss: 0.4678907 Vali Loss: 0.4448338 Test Loss: 0.9598634
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.5211540
	speed: 0.1149s/iter; left time: 1673.0272s
	iters: 200, epoch: 7 | loss: 0.7469238
	speed: 0.0375s/iter; left time: 542.4876s
	iters: 300, epoch: 7 | loss: 0.3577795
	speed: 0.0398s/iter; left time: 570.9453s
	iters: 400, epoch: 7 | loss: 0.3849670
	speed: 0.0372s/iter; left time: 529.8252s
	iters: 500, epoch: 7 | loss: 0.3421519
	speed: 0.0369s/iter; left time: 522.9285s
	iters: 600, epoch: 7 | loss: 0.5911851
	speed: 0.0365s/iter; left time: 512.7015s
	iters: 700, epoch: 7 | loss: 0.3667457
	speed: 0.0363s/iter; left time: 507.3342s
	iters: 800, epoch: 7 | loss: 0.4522000
	speed: 0.0379s/iter; left time: 525.8933s
	iters: 900, epoch: 7 | loss: 0.3144332
	speed: 0.0395s/iter; left time: 544.1017s
	iters: 1000, epoch: 7 | loss: 0.7774044
	speed: 0.0382s/iter; left time: 521.8458s
Epoch: 7 cost time: 38.83162331581116
Epoch: 7, Steps: 1047 | Train Loss: 0.4591317 Vali Loss: 0.3865688 Test Loss: 0.7251492
Validation loss decreased (0.443932 --> 0.386569).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.2710601
	speed: 0.1165s/iter; left time: 1573.9290s
	iters: 200, epoch: 8 | loss: 0.2644188
	speed: 0.0358s/iter; left time: 479.8374s
	iters: 300, epoch: 8 | loss: 0.3475227
	speed: 0.0352s/iter; left time: 467.9892s
	iters: 400, epoch: 8 | loss: 0.6447290
	speed: 0.0361s/iter; left time: 477.3988s
	iters: 500, epoch: 8 | loss: 0.3789655
	speed: 0.0372s/iter; left time: 488.3793s
	iters: 600, epoch: 8 | loss: 0.3367191
	speed: 0.0357s/iter; left time: 463.9444s
	iters: 700, epoch: 8 | loss: 0.4221149
	speed: 0.0383s/iter; left time: 495.0585s
	iters: 800, epoch: 8 | loss: 0.5075139
	speed: 0.0382s/iter; left time: 488.7794s
	iters: 900, epoch: 8 | loss: 0.6507112
	speed: 0.0370s/iter; left time: 470.4627s
	iters: 1000, epoch: 8 | loss: 0.4627681
	speed: 0.0354s/iter; left time: 446.1525s
Epoch: 8 cost time: 38.059858083724976
Epoch: 8, Steps: 1047 | Train Loss: 0.4542525 Vali Loss: 0.3924846 Test Loss: 0.7748314
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.3542765
	speed: 0.1124s/iter; left time: 1400.4926s
	iters: 200, epoch: 9 | loss: 0.5379840
	speed: 0.0372s/iter; left time: 460.3170s
	iters: 300, epoch: 9 | loss: 0.3113642
	speed: 0.0340s/iter; left time: 417.2426s
	iters: 400, epoch: 9 | loss: 0.4422727
	speed: 0.0351s/iter; left time: 427.5206s
	iters: 500, epoch: 9 | loss: 0.3773857
	speed: 0.0365s/iter; left time: 440.8170s
	iters: 600, epoch: 9 | loss: 0.4304275
	speed: 0.0386s/iter; left time: 462.2779s
	iters: 700, epoch: 9 | loss: 0.3419236
	speed: 0.0381s/iter; left time: 452.2354s
	iters: 800, epoch: 9 | loss: 0.4747067
	speed: 0.0390s/iter; left time: 459.1627s
	iters: 900, epoch: 9 | loss: 0.5532082
	speed: 0.0390s/iter; left time: 454.6214s
	iters: 1000, epoch: 9 | loss: 0.3179546
	speed: 0.0350s/iter; left time: 404.6845s
Epoch: 9 cost time: 38.16783595085144
Epoch: 9, Steps: 1047 | Train Loss: 0.4512971 Vali Loss: 0.3774146 Test Loss: 0.7210680
Validation loss decreased (0.386569 --> 0.377415).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.4511809
	speed: 0.1107s/iter; left time: 1263.9621s
	iters: 200, epoch: 10 | loss: 0.4644560
	speed: 0.0336s/iter; left time: 380.6453s
	iters: 300, epoch: 10 | loss: 0.2907173
	speed: 0.0366s/iter; left time: 410.4765s
	iters: 400, epoch: 10 | loss: 0.5632860
	speed: 0.0366s/iter; left time: 406.9394s
	iters: 500, epoch: 10 | loss: 0.2558248
	speed: 0.0358s/iter; left time: 394.1595s
	iters: 600, epoch: 10 | loss: 0.5995050
	speed: 0.0336s/iter; left time: 366.7670s
	iters: 700, epoch: 10 | loss: 0.4387364
	speed: 0.0321s/iter; left time: 346.7424s
	iters: 800, epoch: 10 | loss: 0.3005138
	speed: 0.0341s/iter; left time: 364.9853s
	iters: 900, epoch: 10 | loss: 0.2561208
	speed: 0.0307s/iter; left time: 326.3163s
	iters: 1000, epoch: 10 | loss: 0.3467635
	speed: 0.0326s/iter; left time: 342.6713s
Epoch: 10 cost time: 35.213924169540405
Epoch: 10, Steps: 1047 | Train Loss: 0.4499905 Vali Loss: 0.4216543 Test Loss: 0.8790950
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.6791539
	speed: 0.1092s/iter; left time: 1132.2217s
	iters: 200, epoch: 11 | loss: 0.4282201
	speed: 0.0343s/iter; left time: 352.0074s
	iters: 300, epoch: 11 | loss: 0.6730540
	speed: 0.0349s/iter; left time: 355.2640s
	iters: 400, epoch: 11 | loss: 0.3291448
	speed: 0.0353s/iter; left time: 355.6174s
	iters: 500, epoch: 11 | loss: 0.4205031
	speed: 0.0359s/iter; left time: 358.3621s
	iters: 600, epoch: 11 | loss: 0.4393133
	speed: 0.0316s/iter; left time: 312.3011s
	iters: 700, epoch: 11 | loss: 0.6926223
	speed: 0.0344s/iter; left time: 336.4455s
	iters: 800, epoch: 11 | loss: 0.3446497
	speed: 0.0349s/iter; left time: 337.8980s
	iters: 900, epoch: 11 | loss: 0.3167046
	speed: 0.0363s/iter; left time: 347.0949s
	iters: 1000, epoch: 11 | loss: 0.6192734
	speed: 0.0352s/iter; left time: 333.8178s
Epoch: 11 cost time: 35.83315563201904
Epoch: 11, Steps: 1047 | Train Loss: 0.4493674 Vali Loss: 0.4011795 Test Loss: 0.7916244
EarlyStopping counter: 2 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.3333042
	speed: 0.1141s/iter; left time: 1063.4821s
	iters: 200, epoch: 12 | loss: 0.3502325
	speed: 0.0321s/iter; left time: 296.4491s
	iters: 300, epoch: 12 | loss: 0.5936785
	speed: 0.0360s/iter; left time: 328.7015s
	iters: 400, epoch: 12 | loss: 0.3742702
	speed: 0.0316s/iter; left time: 284.8840s
	iters: 500, epoch: 12 | loss: 0.5201244
	speed: 0.0303s/iter; left time: 270.6694s
	iters: 600, epoch: 12 | loss: 0.6086900
	speed: 0.0302s/iter; left time: 266.6376s
	iters: 700, epoch: 12 | loss: 0.4658792
	speed: 0.0306s/iter; left time: 267.3749s
	iters: 800, epoch: 12 | loss: 0.3775368
	speed: 0.0314s/iter; left time: 270.6986s
	iters: 900, epoch: 12 | loss: 0.3789895
	speed: 0.0309s/iter; left time: 263.1139s
	iters: 1000, epoch: 12 | loss: 0.2377168
	speed: 0.0306s/iter; left time: 258.1884s
Epoch: 12 cost time: 32.78553247451782
Epoch: 12, Steps: 1047 | Train Loss: 0.4489144 Vali Loss: 0.4043805 Test Loss: 0.8126965
EarlyStopping counter: 3 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.3405670
	speed: 0.1099s/iter; left time: 909.2307s
	iters: 200, epoch: 13 | loss: 0.6193683
	speed: 0.0291s/iter; left time: 237.9934s
	iters: 300, epoch: 13 | loss: 0.3710679
	speed: 0.0287s/iter; left time: 231.5390s
	iters: 400, epoch: 13 | loss: 0.5976849
	speed: 0.0276s/iter; left time: 219.8150s
	iters: 500, epoch: 13 | loss: 0.7302411
	speed: 0.0273s/iter; left time: 214.7020s
	iters: 600, epoch: 13 | loss: 0.3832971
	speed: 0.0272s/iter; left time: 211.3486s
	iters: 700, epoch: 13 | loss: 0.2028940
	speed: 0.0271s/iter; left time: 208.2786s
	iters: 800, epoch: 13 | loss: 0.6096894
	speed: 0.0275s/iter; left time: 208.5326s
	iters: 900, epoch: 13 | loss: 0.4656936
	speed: 0.0271s/iter; left time: 202.4534s
	iters: 1000, epoch: 13 | loss: 0.6059915
	speed: 0.0271s/iter; left time: 200.0426s
Epoch: 13 cost time: 28.87272357940674
Epoch: 13, Steps: 1047 | Train Loss: 0.4487063 Vali Loss: 0.4024154 Test Loss: 0.8053480
EarlyStopping counter: 4 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 14 | loss: 0.3562885
	speed: 0.0983s/iter; left time: 710.6636s
	iters: 200, epoch: 14 | loss: 0.4458772
	speed: 0.0275s/iter; left time: 196.2468s
	iters: 300, epoch: 14 | loss: 0.3690458
	speed: 0.0272s/iter; left time: 191.2971s
	iters: 400, epoch: 14 | loss: 0.2868100
	speed: 0.0280s/iter; left time: 194.1374s
	iters: 500, epoch: 14 | loss: 0.4089498
	speed: 0.0282s/iter; left time: 192.3302s
	iters: 600, epoch: 14 | loss: 0.2011801
	speed: 0.0284s/iter; left time: 191.0080s
	iters: 700, epoch: 14 | loss: 0.4700515
	speed: 0.0277s/iter; left time: 183.4072s
	iters: 800, epoch: 14 | loss: 0.6026297
	speed: 0.0277s/iter; left time: 180.8098s
	iters: 900, epoch: 14 | loss: 0.4557035
	speed: 0.0277s/iter; left time: 178.2115s
	iters: 1000, epoch: 14 | loss: 0.5209125
	speed: 0.0270s/iter; left time: 170.6737s
Epoch: 14 cost time: 28.866358280181885
Epoch: 14, Steps: 1047 | Train Loss: 0.4486071 Vali Loss: 0.4061392 Test Loss: 0.8167539
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTm2_336_720_DLinear_ETTm2_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed25565<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10801
mse:0.7216508984565735, mae:0.5474268794059753
