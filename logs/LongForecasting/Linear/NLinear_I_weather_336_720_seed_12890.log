Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='NLinear', model_id='weather_336_720', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=720, root_path='./dataset/', save_pred_values=False, seed=12890, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : weather_336_720_NLinear_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed12890>>>>>>>>>>>>>>>>>>>>>>>>>>
train 35832
val 4551
test 9820
	iters: 100, epoch: 1 | loss: 1.2379371
	speed: 0.0525s/iter; left time: 2347.1802s
	iters: 200, epoch: 1 | loss: 0.5256246
	speed: 0.0526s/iter; left time: 2342.8568s
	iters: 300, epoch: 1 | loss: 0.7549415
	speed: 0.0504s/iter; left time: 2244.0605s
	iters: 400, epoch: 1 | loss: 1.6160315
	speed: 0.0597s/iter; left time: 2651.6901s
	iters: 500, epoch: 1 | loss: 0.9865478
	speed: 0.0492s/iter; left time: 2178.1855s
	iters: 600, epoch: 1 | loss: 0.6142709
	speed: 0.0504s/iter; left time: 2227.7203s
	iters: 700, epoch: 1 | loss: 0.6537825
	speed: 0.0564s/iter; left time: 2484.8431s
	iters: 800, epoch: 1 | loss: 1.5385832
	speed: 0.0554s/iter; left time: 2437.3895s
	iters: 900, epoch: 1 | loss: 7.6554027
	speed: 0.0539s/iter; left time: 2364.1715s
	iters: 1000, epoch: 1 | loss: 0.5859151
	speed: 0.0515s/iter; left time: 2255.1282s
	iters: 1100, epoch: 1 | loss: 0.6192276
	speed: 0.0452s/iter; left time: 1973.6592s
	iters: 1200, epoch: 1 | loss: 0.6310424
	speed: 0.0521s/iter; left time: 2269.9255s
	iters: 1300, epoch: 1 | loss: 3.3716993
	speed: 0.0565s/iter; left time: 2458.5202s
	iters: 1400, epoch: 1 | loss: 1.0339167
	speed: 0.0502s/iter; left time: 2175.9402s
	iters: 1500, epoch: 1 | loss: 1.2045345
	speed: 0.0543s/iter; left time: 2350.2218s
	iters: 1600, epoch: 1 | loss: 0.9519759
	speed: 0.0510s/iter; left time: 2203.8303s
	iters: 1700, epoch: 1 | loss: 3.4803882
	speed: 0.0524s/iter; left time: 2258.9757s
	iters: 1800, epoch: 1 | loss: 1.0149488
	speed: 0.0510s/iter; left time: 2192.2579s
	iters: 1900, epoch: 1 | loss: 0.9023668
	speed: 0.0510s/iter; left time: 2188.3446s
	iters: 2000, epoch: 1 | loss: 8.1503239
	speed: 0.0469s/iter; left time: 2005.0670s
	iters: 2100, epoch: 1 | loss: 1.1906586
	speed: 0.0477s/iter; left time: 2035.1244s
	iters: 2200, epoch: 1 | loss: 0.6582642
	speed: 0.0447s/iter; left time: 1904.8454s
Epoch: 1 cost time: 115.06851196289062
Epoch: 1, Steps: 2239 | Train Loss: 3.0171246 Vali Loss: 0.8525246 Test Loss: 0.4296244
Validation loss decreased (inf --> 0.852525).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 4.9761224
	speed: 0.1464s/iter; left time: 6212.6670s
	iters: 200, epoch: 2 | loss: 0.7245868
	speed: 0.0483s/iter; left time: 2045.6362s
	iters: 300, epoch: 2 | loss: 4.0641685
	speed: 0.0536s/iter; left time: 2263.0970s
	iters: 400, epoch: 2 | loss: 0.7973864
	speed: 0.0505s/iter; left time: 2129.6264s
	iters: 500, epoch: 2 | loss: 0.6714538
	speed: 0.0486s/iter; left time: 2042.4667s
	iters: 600, epoch: 2 | loss: 0.7990359
	speed: 0.0492s/iter; left time: 2065.4778s
	iters: 700, epoch: 2 | loss: 0.7733228
	speed: 0.0498s/iter; left time: 2082.8408s
	iters: 800, epoch: 2 | loss: 0.6129657
	speed: 0.0516s/iter; left time: 2153.7566s
	iters: 900, epoch: 2 | loss: 0.9155312
	speed: 0.0467s/iter; left time: 1946.2561s
	iters: 1000, epoch: 2 | loss: 0.7134652
	speed: 0.0502s/iter; left time: 2083.4046s
	iters: 1100, epoch: 2 | loss: 0.6291621
	speed: 0.0528s/iter; left time: 2188.1675s
	iters: 1200, epoch: 2 | loss: 0.7015038
	speed: 0.0474s/iter; left time: 1958.6255s
	iters: 1300, epoch: 2 | loss: 0.7621018
	speed: 0.0516s/iter; left time: 2128.8782s
	iters: 1400, epoch: 2 | loss: 0.5885613
	speed: 0.0508s/iter; left time: 2088.0421s
	iters: 1500, epoch: 2 | loss: 0.5726466
	speed: 0.0533s/iter; left time: 2189.0544s
	iters: 1600, epoch: 2 | loss: 1.1531833
	speed: 0.0531s/iter; left time: 2172.1059s
	iters: 1700, epoch: 2 | loss: 0.7130259
	speed: 0.0554s/iter; left time: 2262.4473s
	iters: 1800, epoch: 2 | loss: 0.6371703
	speed: 0.0523s/iter; left time: 2130.5661s
	iters: 1900, epoch: 2 | loss: 0.7373752
	speed: 0.0552s/iter; left time: 2241.9153s
	iters: 2000, epoch: 2 | loss: 0.5388887
	speed: 0.0573s/iter; left time: 2321.0541s
	iters: 2100, epoch: 2 | loss: 0.7365373
	speed: 0.0492s/iter; left time: 1989.1261s
	iters: 2200, epoch: 2 | loss: 1.3313743
	speed: 0.0511s/iter; left time: 2060.8249s
Epoch: 2 cost time: 114.0247814655304
Epoch: 2, Steps: 2239 | Train Loss: 63.3603348 Vali Loss: 1.0821769 Test Loss: 0.3802614
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.6757503
	speed: 0.1495s/iter; left time: 6012.3542s
	iters: 200, epoch: 3 | loss: 0.5730729
	speed: 0.0461s/iter; left time: 1848.7543s
	iters: 300, epoch: 3 | loss: 0.5236213
	speed: 0.0526s/iter; left time: 2103.4537s
	iters: 400, epoch: 3 | loss: 0.7873739
	speed: 0.0529s/iter; left time: 2111.9589s
	iters: 500, epoch: 3 | loss: 0.6950794
	speed: 0.0529s/iter; left time: 2107.1231s
	iters: 600, epoch: 3 | loss: 0.6101505
	speed: 0.0476s/iter; left time: 1889.8583s
	iters: 700, epoch: 3 | loss: 0.5878839
	speed: 0.0533s/iter; left time: 2109.2823s
	iters: 800, epoch: 3 | loss: 2.1816852
	speed: 0.0556s/iter; left time: 2198.0206s
	iters: 900, epoch: 3 | loss: 0.8456527
	speed: 0.0517s/iter; left time: 2037.7693s
	iters: 1000, epoch: 3 | loss: 0.6340188
	speed: 0.0516s/iter; left time: 2026.2243s
	iters: 1100, epoch: 3 | loss: 0.9053300
	speed: 0.0487s/iter; left time: 1908.9334s
	iters: 1200, epoch: 3 | loss: 1.0920922
	speed: 0.0507s/iter; left time: 1983.0462s
	iters: 1300, epoch: 3 | loss: 0.8924521
	speed: 0.0521s/iter; left time: 2030.1536s
	iters: 1400, epoch: 3 | loss: 0.4081963
	speed: 0.0519s/iter; left time: 2019.2911s
	iters: 1500, epoch: 3 | loss: 0.5229622
	speed: 0.0491s/iter; left time: 1905.8759s
	iters: 1600, epoch: 3 | loss: 3.9709949
	speed: 0.0548s/iter; left time: 2120.3475s
	iters: 1700, epoch: 3 | loss: 0.6404604
	speed: 0.0505s/iter; left time: 1949.5964s
	iters: 1800, epoch: 3 | loss: 0.6357136
	speed: 0.0487s/iter; left time: 1876.8469s
	iters: 1900, epoch: 3 | loss: 0.5218579
	speed: 0.0530s/iter; left time: 2036.8103s
	iters: 2000, epoch: 3 | loss: 1.0431763
	speed: 0.0491s/iter; left time: 1880.0024s
	iters: 2100, epoch: 3 | loss: 2.1999862
	speed: 0.0495s/iter; left time: 1889.1789s
	iters: 2200, epoch: 3 | loss: 0.7483294
	speed: 0.0508s/iter; left time: 1934.1238s
Epoch: 3 cost time: 113.73914122581482
Epoch: 3, Steps: 2239 | Train Loss: 19.9363021 Vali Loss: 1.7288578 Test Loss: 0.3772072
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.4643536
	speed: 0.1557s/iter; left time: 5911.6445s
	iters: 200, epoch: 4 | loss: 0.6115579
	speed: 0.0544s/iter; left time: 2058.9438s
	iters: 300, epoch: 4 | loss: 0.9561303
	speed: 0.0528s/iter; left time: 1993.6534s
	iters: 400, epoch: 4 | loss: 0.5125608
	speed: 0.0466s/iter; left time: 1754.9163s
	iters: 500, epoch: 4 | loss: 1.0208192
	speed: 0.0540s/iter; left time: 2029.7220s
	iters: 600, epoch: 4 | loss: 0.7876196
	speed: 0.0477s/iter; left time: 1787.9181s
	iters: 700, epoch: 4 | loss: 0.4808523
	speed: 0.0548s/iter; left time: 2047.5566s
	iters: 800, epoch: 4 | loss: 0.4983732
	speed: 0.0522s/iter; left time: 1945.8615s
	iters: 900, epoch: 4 | loss: 0.8774548
	speed: 0.0537s/iter; left time: 1995.1968s
	iters: 1000, epoch: 4 | loss: 0.7993669
	speed: 0.0538s/iter; left time: 1992.7503s
	iters: 1100, epoch: 4 | loss: 0.5211675
	speed: 0.0538s/iter; left time: 1989.4407s
	iters: 1200, epoch: 4 | loss: 1.0447607
	speed: 0.0505s/iter; left time: 1861.8877s
	iters: 1300, epoch: 4 | loss: 2.3704033
	speed: 0.0489s/iter; left time: 1797.3164s
	iters: 1400, epoch: 4 | loss: 0.5512881
	speed: 0.0503s/iter; left time: 1844.9673s
	iters: 1500, epoch: 4 | loss: 0.7907455
	speed: 0.0575s/iter; left time: 2104.1651s
	iters: 1600, epoch: 4 | loss: 0.4974924
	speed: 0.0570s/iter; left time: 2078.7783s
	iters: 1700, epoch: 4 | loss: 0.5794202
	speed: 0.0501s/iter; left time: 1823.3476s
	iters: 1800, epoch: 4 | loss: 0.5256782
	speed: 0.0488s/iter; left time: 1768.6283s
	iters: 1900, epoch: 4 | loss: 0.4799730
	speed: 0.0497s/iter; left time: 1797.7573s
	iters: 2000, epoch: 4 | loss: 0.5277277
	speed: 0.0518s/iter; left time: 1866.8244s
	iters: 2100, epoch: 4 | loss: 0.7838617
	speed: 0.0529s/iter; left time: 1901.3841s
	iters: 2200, epoch: 4 | loss: 1.0435104
	speed: 0.0447s/iter; left time: 1603.0752s
Epoch: 4 cost time: 115.09405994415283
Epoch: 4, Steps: 2239 | Train Loss: 1.8882547 Vali Loss: 0.6832877 Test Loss: 0.3368642
Validation loss decreased (0.852525 --> 0.683288).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.5250916
	speed: 0.1566s/iter; left time: 5594.1129s
	iters: 200, epoch: 5 | loss: 0.5063400
	speed: 0.0513s/iter; left time: 1827.0581s
	iters: 300, epoch: 5 | loss: 0.7593541
	speed: 0.0523s/iter; left time: 1856.3882s
	iters: 400, epoch: 5 | loss: 0.9106662
	speed: 0.0523s/iter; left time: 1853.8741s
	iters: 500, epoch: 5 | loss: 0.7691093
	speed: 0.0527s/iter; left time: 1860.5858s
	iters: 600, epoch: 5 | loss: 0.5447180
	speed: 0.0515s/iter; left time: 1814.0689s
	iters: 700, epoch: 5 | loss: 0.5721691
	speed: 0.0506s/iter; left time: 1778.3400s
	iters: 800, epoch: 5 | loss: 0.4569040
	speed: 0.0513s/iter; left time: 1795.5144s
	iters: 900, epoch: 5 | loss: 0.5410645
	speed: 0.0482s/iter; left time: 1684.2982s
	iters: 1000, epoch: 5 | loss: 0.5341660
	speed: 0.0476s/iter; left time: 1659.0614s
	iters: 1100, epoch: 5 | loss: 0.4987788
	speed: 0.0549s/iter; left time: 1907.9634s
	iters: 1200, epoch: 5 | loss: 0.5205057
	speed: 0.0538s/iter; left time: 1861.5219s
	iters: 1300, epoch: 5 | loss: 1.3534981
	speed: 0.0526s/iter; left time: 1816.6338s
	iters: 1400, epoch: 5 | loss: 0.5518644
	speed: 0.0535s/iter; left time: 1843.2660s
	iters: 1500, epoch: 5 | loss: 0.5564609
	speed: 0.0505s/iter; left time: 1732.0510s
	iters: 1600, epoch: 5 | loss: 0.6682649
	speed: 0.0507s/iter; left time: 1735.8128s
	iters: 1700, epoch: 5 | loss: 1.1125067
	speed: 0.0504s/iter; left time: 1719.3356s
	iters: 1800, epoch: 5 | loss: 1.4661787
	speed: 0.0558s/iter; left time: 1897.7705s
	iters: 1900, epoch: 5 | loss: 0.7269238
	speed: 0.0541s/iter; left time: 1836.8044s
	iters: 2000, epoch: 5 | loss: 0.4745035
	speed: 0.0504s/iter; left time: 1703.9389s
	iters: 2100, epoch: 5 | loss: 0.5714775
	speed: 0.0508s/iter; left time: 1712.5469s
	iters: 2200, epoch: 5 | loss: 0.9795125
	speed: 0.0415s/iter; left time: 1396.5440s
Epoch: 5 cost time: 114.00048279762268
Epoch: 5, Steps: 2239 | Train Loss: 0.9538226 Vali Loss: 0.6624420 Test Loss: 0.3238761
Validation loss decreased (0.683288 --> 0.662442).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 1.4083313
	speed: 0.1538s/iter; left time: 5151.4849s
	iters: 200, epoch: 6 | loss: 0.5465804
	speed: 0.0477s/iter; left time: 1592.6184s
	iters: 300, epoch: 6 | loss: 0.8739520
	speed: 0.0448s/iter; left time: 1490.0175s
	iters: 400, epoch: 6 | loss: 0.5371085
	speed: 0.0471s/iter; left time: 1562.4297s
	iters: 500, epoch: 6 | loss: 1.8302603
	speed: 0.0493s/iter; left time: 1632.0361s
	iters: 600, epoch: 6 | loss: 0.5109569
	speed: 0.0488s/iter; left time: 1609.1504s
	iters: 700, epoch: 6 | loss: 0.4518229
	speed: 0.0515s/iter; left time: 1693.0128s
	iters: 800, epoch: 6 | loss: 0.6655537
	speed: 0.0494s/iter; left time: 1621.1927s
	iters: 900, epoch: 6 | loss: 0.4498533
	speed: 0.0505s/iter; left time: 1650.9368s
	iters: 1000, epoch: 6 | loss: 0.7704064
	speed: 0.0499s/iter; left time: 1626.6183s
	iters: 1100, epoch: 6 | loss: 0.9557997
	speed: 0.0493s/iter; left time: 1601.5920s
	iters: 1200, epoch: 6 | loss: 0.4394173
	speed: 0.0535s/iter; left time: 1731.2479s
	iters: 1300, epoch: 6 | loss: 0.4707923
	speed: 0.0543s/iter; left time: 1752.3302s
	iters: 1400, epoch: 6 | loss: 0.5443650
	speed: 0.0504s/iter; left time: 1622.8722s
	iters: 1500, epoch: 6 | loss: 0.5681460
	speed: 0.0534s/iter; left time: 1711.9471s
	iters: 1600, epoch: 6 | loss: 0.4124368
	speed: 0.0494s/iter; left time: 1580.4708s
	iters: 1700, epoch: 6 | loss: 0.7351431
	speed: 0.0511s/iter; left time: 1628.5635s
	iters: 1800, epoch: 6 | loss: 0.6187751
	speed: 0.0502s/iter; left time: 1596.3294s
	iters: 1900, epoch: 6 | loss: 1.0649524
	speed: 0.0535s/iter; left time: 1696.2041s
	iters: 2000, epoch: 6 | loss: 0.4786170
	speed: 0.0458s/iter; left time: 1446.0725s
	iters: 2100, epoch: 6 | loss: 0.5891553
	speed: 0.0510s/iter; left time: 1604.4871s
	iters: 2200, epoch: 6 | loss: 0.6696717
	speed: 0.0473s/iter; left time: 1483.5147s
Epoch: 6 cost time: 111.22599387168884
Epoch: 6, Steps: 2239 | Train Loss: 0.8104693 Vali Loss: 0.6553693 Test Loss: 0.3219879
Validation loss decreased (0.662442 --> 0.655369).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.4692793
	speed: 0.1485s/iter; left time: 4639.5186s
	iters: 200, epoch: 7 | loss: 0.6740062
	speed: 0.0517s/iter; left time: 1610.5004s
	iters: 300, epoch: 7 | loss: 0.6610370
	speed: 0.0547s/iter; left time: 1696.8195s
	iters: 400, epoch: 7 | loss: 0.4660510
	speed: 0.0529s/iter; left time: 1635.9156s
	iters: 500, epoch: 7 | loss: 0.4707853
	speed: 0.0544s/iter; left time: 1679.3892s
	iters: 600, epoch: 7 | loss: 0.9541789
	speed: 0.0516s/iter; left time: 1586.5072s
	iters: 700, epoch: 7 | loss: 0.4133427
	speed: 0.0521s/iter; left time: 1597.8462s
	iters: 800, epoch: 7 | loss: 0.4791122
	speed: 0.0508s/iter; left time: 1552.2229s
	iters: 900, epoch: 7 | loss: 0.7905141
	speed: 0.0518s/iter; left time: 1576.6601s
	iters: 1000, epoch: 7 | loss: 0.6336561
	speed: 0.0531s/iter; left time: 1612.1274s
	iters: 1100, epoch: 7 | loss: 0.6697817
	speed: 0.0522s/iter; left time: 1580.0656s
	iters: 1200, epoch: 7 | loss: 0.6799955
	speed: 0.0527s/iter; left time: 1588.1655s
	iters: 1300, epoch: 7 | loss: 0.4372639
	speed: 0.0521s/iter; left time: 1564.6860s
	iters: 1400, epoch: 7 | loss: 0.4766216
	speed: 0.0534s/iter; left time: 1598.6688s
	iters: 1500, epoch: 7 | loss: 0.8307813
	speed: 0.0584s/iter; left time: 1744.1120s
	iters: 1600, epoch: 7 | loss: 0.5719262
	speed: 0.0543s/iter; left time: 1613.9152s
	iters: 1700, epoch: 7 | loss: 0.6111928
	speed: 0.0530s/iter; left time: 1572.3290s
	iters: 1800, epoch: 7 | loss: 0.7723193
	speed: 0.0503s/iter; left time: 1487.4472s
	iters: 1900, epoch: 7 | loss: 0.8297059
	speed: 0.0497s/iter; left time: 1464.8866s
	iters: 2000, epoch: 7 | loss: 0.6984308
	speed: 0.0523s/iter; left time: 1535.0419s
	iters: 2100, epoch: 7 | loss: 208.2287598
	speed: 0.0476s/iter; left time: 1393.0589s
	iters: 2200, epoch: 7 | loss: 0.9303912
	speed: 0.0425s/iter; left time: 1237.9814s
Epoch: 7 cost time: 115.33173060417175
Epoch: 7, Steps: 2239 | Train Loss: 0.7984888 Vali Loss: 0.6501430 Test Loss: 0.3194526
Validation loss decreased (0.655369 --> 0.650143).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.4647887
	speed: 0.1628s/iter; left time: 4721.3339s
	iters: 200, epoch: 8 | loss: 0.4082534
	speed: 0.0490s/iter; left time: 1416.8176s
	iters: 300, epoch: 8 | loss: 0.4699186
	speed: 0.0505s/iter; left time: 1455.5039s
	iters: 400, epoch: 8 | loss: 0.5151895
	speed: 0.0511s/iter; left time: 1467.0313s
	iters: 500, epoch: 8 | loss: 2.0709538
	speed: 0.0528s/iter; left time: 1510.5945s
	iters: 600, epoch: 8 | loss: 0.7684534
	speed: 0.0536s/iter; left time: 1526.7260s
	iters: 700, epoch: 8 | loss: 0.6390107
	speed: 0.0474s/iter; left time: 1346.2771s
	iters: 800, epoch: 8 | loss: 0.7440232
	speed: 0.0507s/iter; left time: 1436.2136s
	iters: 900, epoch: 8 | loss: 0.7399593
	speed: 0.0501s/iter; left time: 1413.7990s
	iters: 1000, epoch: 8 | loss: 0.4019926
	speed: 0.0526s/iter; left time: 1478.6571s
	iters: 1100, epoch: 8 | loss: 1.0117453
	speed: 0.0517s/iter; left time: 1449.1807s
	iters: 1200, epoch: 8 | loss: 0.4830096
	speed: 0.0542s/iter; left time: 1512.1485s
	iters: 1300, epoch: 8 | loss: 0.7093534
	speed: 0.0546s/iter; left time: 1518.4558s
	iters: 1400, epoch: 8 | loss: 0.4595134
	speed: 0.0479s/iter; left time: 1327.0500s
	iters: 1500, epoch: 8 | loss: 0.6132740
	speed: 0.0493s/iter; left time: 1359.8638s
	iters: 1600, epoch: 8 | loss: 0.5050662
	speed: 0.0533s/iter; left time: 1466.6184s
	iters: 1700, epoch: 8 | loss: 1.4745283
	speed: 0.0502s/iter; left time: 1376.1225s
	iters: 1800, epoch: 8 | loss: 0.4807406
	speed: 0.0531s/iter; left time: 1450.2299s
	iters: 1900, epoch: 8 | loss: 0.5462084
	speed: 0.0506s/iter; left time: 1376.1670s
	iters: 2000, epoch: 8 | loss: 1.2335172
	speed: 0.0516s/iter; left time: 1397.5744s
	iters: 2100, epoch: 8 | loss: 0.8438448
	speed: 0.0464s/iter; left time: 1252.9453s
	iters: 2200, epoch: 8 | loss: 0.9983304
	speed: 0.0413s/iter; left time: 1112.4381s
Epoch: 8 cost time: 112.95962429046631
Epoch: 8, Steps: 2239 | Train Loss: 0.7070812 Vali Loss: 0.6483308 Test Loss: 0.3200087
Validation loss decreased (0.650143 --> 0.648331).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.5562991
	speed: 0.1685s/iter; left time: 4511.6131s
	iters: 200, epoch: 9 | loss: 0.5137157
	speed: 0.0481s/iter; left time: 1282.6660s
	iters: 300, epoch: 9 | loss: 0.5602512
	speed: 0.0454s/iter; left time: 1206.5427s
	iters: 400, epoch: 9 | loss: 0.5007278
	speed: 0.0541s/iter; left time: 1431.6082s
	iters: 500, epoch: 9 | loss: 0.5466365
	speed: 0.0508s/iter; left time: 1339.5755s
	iters: 600, epoch: 9 | loss: 0.6097016
	speed: 0.0485s/iter; left time: 1274.6013s
	iters: 700, epoch: 9 | loss: 0.8578478
	speed: 0.0530s/iter; left time: 1386.5816s
	iters: 800, epoch: 9 | loss: 1.0072159
	speed: 0.0507s/iter; left time: 1321.8022s
	iters: 900, epoch: 9 | loss: 0.4888135
	speed: 0.0516s/iter; left time: 1340.9652s
	iters: 1000, epoch: 9 | loss: 0.9381653
	speed: 0.0492s/iter; left time: 1272.5060s
	iters: 1100, epoch: 9 | loss: 0.7323393
	speed: 0.0500s/iter; left time: 1289.1642s
	iters: 1200, epoch: 9 | loss: 0.4302630
	speed: 0.0506s/iter; left time: 1298.5387s
	iters: 1300, epoch: 9 | loss: 0.4811399
	speed: 0.0493s/iter; left time: 1260.9205s
	iters: 1400, epoch: 9 | loss: 0.4625426
	speed: 0.0528s/iter; left time: 1345.1994s
	iters: 1500, epoch: 9 | loss: 0.7344715
	speed: 0.0528s/iter; left time: 1340.6716s
	iters: 1600, epoch: 9 | loss: 0.7453425
	speed: 0.0524s/iter; left time: 1325.3137s
	iters: 1700, epoch: 9 | loss: 0.4764855
	speed: 0.0500s/iter; left time: 1257.4281s
	iters: 1800, epoch: 9 | loss: 0.4657414
	speed: 0.0539s/iter; left time: 1350.3795s
	iters: 1900, epoch: 9 | loss: 0.4711323
	speed: 0.0540s/iter; left time: 1347.1568s
	iters: 2000, epoch: 9 | loss: 0.7564715
	speed: 0.0508s/iter; left time: 1264.2171s
	iters: 2100, epoch: 9 | loss: 0.5317422
	speed: 0.0462s/iter; left time: 1145.4552s
	iters: 2200, epoch: 9 | loss: 0.5194994
	speed: 0.0401s/iter; left time: 989.1031s
Epoch: 9 cost time: 112.45762467384338
Epoch: 9, Steps: 2239 | Train Loss: 0.6969790 Vali Loss: 0.6468081 Test Loss: 0.3186703
Validation loss decreased (0.648331 --> 0.646808).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.7766153
	speed: 0.1742s/iter; left time: 4273.5994s
	iters: 200, epoch: 10 | loss: 0.4452702
	speed: 0.0521s/iter; left time: 1271.7449s
	iters: 300, epoch: 10 | loss: 0.5729247
	speed: 0.0495s/iter; left time: 1205.0494s
	iters: 400, epoch: 10 | loss: 0.5476618
	speed: 0.0498s/iter; left time: 1205.7795s
	iters: 500, epoch: 10 | loss: 0.5960389
	speed: 0.0446s/iter; left time: 1075.6942s
	iters: 600, epoch: 10 | loss: 0.4957374
	speed: 0.0467s/iter; left time: 1121.1949s
	iters: 700, epoch: 10 | loss: 0.4308105
	speed: 0.0543s/iter; left time: 1299.6657s
	iters: 800, epoch: 10 | loss: 0.5547729
	speed: 0.0504s/iter; left time: 1201.8130s
	iters: 900, epoch: 10 | loss: 0.4907925
	speed: 0.0502s/iter; left time: 1190.9606s
	iters: 1000, epoch: 10 | loss: 0.5226790
	speed: 0.0531s/iter; left time: 1254.3634s
	iters: 1100, epoch: 10 | loss: 0.6213626
	speed: 0.0499s/iter; left time: 1173.2401s
	iters: 1200, epoch: 10 | loss: 0.4794910
	speed: 0.0509s/iter; left time: 1191.9438s
	iters: 1300, epoch: 10 | loss: 0.4911645
	speed: 0.0522s/iter; left time: 1216.8093s
	iters: 1400, epoch: 10 | loss: 0.8948644
	speed: 0.0501s/iter; left time: 1164.0235s
	iters: 1500, epoch: 10 | loss: 0.7059706
	speed: 0.0482s/iter; left time: 1114.9963s
	iters: 1600, epoch: 10 | loss: 0.4799144
	speed: 0.0514s/iter; left time: 1184.7874s
	iters: 1700, epoch: 10 | loss: 0.4683926
	speed: 0.0446s/iter; left time: 1023.1026s
	iters: 1800, epoch: 10 | loss: 0.5371658
	speed: 0.0487s/iter; left time: 1111.2805s
	iters: 1900, epoch: 10 | loss: 0.5178596
	speed: 0.0501s/iter; left time: 1138.9526s
	iters: 2000, epoch: 10 | loss: 0.6385728
	speed: 0.0551s/iter; left time: 1246.5845s
	iters: 2100, epoch: 10 | loss: 0.5405750
	speed: 0.0471s/iter; left time: 1060.7362s
	iters: 2200, epoch: 10 | loss: 0.7463196
	speed: 0.0433s/iter; left time: 970.7089s
Epoch: 10 cost time: 110.79689908027649
Epoch: 10, Steps: 2239 | Train Loss: 0.6946476 Vali Loss: 0.6462231 Test Loss: 0.3181582
Validation loss decreased (0.646808 --> 0.646223).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.6213624
	speed: 0.1690s/iter; left time: 3767.9145s
	iters: 200, epoch: 11 | loss: 0.8561088
	speed: 0.0524s/iter; left time: 1161.7917s
	iters: 300, epoch: 11 | loss: 0.4242340
	speed: 0.0517s/iter; left time: 1141.4168s
	iters: 400, epoch: 11 | loss: 0.4981601
	speed: 0.0514s/iter; left time: 1129.7812s
	iters: 500, epoch: 11 | loss: 0.4540101
	speed: 0.0529s/iter; left time: 1159.0057s
	iters: 600, epoch: 11 | loss: 0.5487534
	speed: 0.0518s/iter; left time: 1128.0151s
	iters: 700, epoch: 11 | loss: 0.6376427
	speed: 0.0508s/iter; left time: 1102.0101s
	iters: 800, epoch: 11 | loss: 0.4570832
	speed: 0.0505s/iter; left time: 1090.1537s
	iters: 900, epoch: 11 | loss: 0.4932542
	speed: 0.0512s/iter; left time: 1100.8591s
	iters: 1000, epoch: 11 | loss: 0.4290608
	speed: 0.0480s/iter; left time: 1027.0021s
	iters: 1100, epoch: 11 | loss: 0.7599479
	speed: 0.0475s/iter; left time: 1010.6076s
	iters: 1200, epoch: 11 | loss: 0.7254640
	speed: 0.0514s/iter; left time: 1089.7017s
	iters: 1300, epoch: 11 | loss: 0.4393023
	speed: 0.0537s/iter; left time: 1131.5927s
	iters: 1400, epoch: 11 | loss: 0.5953543
	speed: 0.0529s/iter; left time: 1110.5550s
	iters: 1500, epoch: 11 | loss: 0.8040755
	speed: 0.0524s/iter; left time: 1093.7851s
	iters: 1600, epoch: 11 | loss: 0.4705408
	speed: 0.0554s/iter; left time: 1151.1577s
	iters: 1700, epoch: 11 | loss: 0.4935513
	speed: 0.0529s/iter; left time: 1095.0461s
	iters: 1800, epoch: 11 | loss: 0.4966191
	speed: 0.0478s/iter; left time: 984.7204s
	iters: 1900, epoch: 11 | loss: 0.7760692
	speed: 0.0535s/iter; left time: 1096.8234s
	iters: 2000, epoch: 11 | loss: 0.4933469
	speed: 0.0515s/iter; left time: 1051.1055s
	iters: 2100, epoch: 11 | loss: 0.5444809
	speed: 0.0464s/iter; left time: 940.6992s
	iters: 2200, epoch: 11 | loss: 0.5320754
	speed: 0.0370s/iter; left time: 746.5000s
Epoch: 11 cost time: 112.47257542610168
Epoch: 11, Steps: 2239 | Train Loss: 0.6932395 Vali Loss: 0.6465058 Test Loss: 0.3183925
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.5303388
	speed: 0.1814s/iter; left time: 3637.0552s
	iters: 200, epoch: 12 | loss: 0.6990769
	speed: 0.0500s/iter; left time: 997.4598s
	iters: 300, epoch: 12 | loss: 1.0088080
	speed: 0.0504s/iter; left time: 1000.2221s
	iters: 400, epoch: 12 | loss: 0.4936260
	speed: 0.0514s/iter; left time: 1015.7477s
	iters: 500, epoch: 12 | loss: 0.4933728
	speed: 0.0498s/iter; left time: 978.6989s
	iters: 600, epoch: 12 | loss: 0.4954063
	speed: 0.0486s/iter; left time: 950.7340s
	iters: 700, epoch: 12 | loss: 0.4978644
	speed: 0.0531s/iter; left time: 1033.5575s
	iters: 800, epoch: 12 | loss: 0.7245876
	speed: 0.0503s/iter; left time: 973.2799s
	iters: 900, epoch: 12 | loss: 0.5640287
	speed: 0.0537s/iter; left time: 1034.2959s
	iters: 1000, epoch: 12 | loss: 1.9888161
	speed: 0.0573s/iter; left time: 1098.2986s
	iters: 1100, epoch: 12 | loss: 0.5240949
	speed: 0.0520s/iter; left time: 990.7394s
	iters: 1200, epoch: 12 | loss: 0.3974648
	speed: 0.0514s/iter; left time: 973.8953s
	iters: 1300, epoch: 12 | loss: 0.6922114
	speed: 0.0517s/iter; left time: 974.0668s
	iters: 1400, epoch: 12 | loss: 0.4695932
	speed: 0.0520s/iter; left time: 975.3139s
	iters: 1500, epoch: 12 | loss: 0.8361800
	speed: 0.0524s/iter; left time: 977.6008s
	iters: 1600, epoch: 12 | loss: 0.5674973
	speed: 0.0525s/iter; left time: 973.9158s
	iters: 1700, epoch: 12 | loss: 0.5331683
	speed: 0.0535s/iter; left time: 986.8955s
	iters: 1800, epoch: 12 | loss: 0.5342442
	speed: 0.0491s/iter; left time: 900.7162s
	iters: 1900, epoch: 12 | loss: 0.4340783
	speed: 0.0453s/iter; left time: 827.5094s
	iters: 2000, epoch: 12 | loss: 0.3707508
	speed: 0.0429s/iter; left time: 778.9801s
	iters: 2100, epoch: 12 | loss: 0.4741735
	speed: 0.0422s/iter; left time: 761.8281s
	iters: 2200, epoch: 12 | loss: 1.0054605
	speed: 0.0390s/iter; left time: 700.0787s
Epoch: 12 cost time: 111.3411796092987
Epoch: 12, Steps: 2239 | Train Loss: 0.6924496 Vali Loss: 0.6457736 Test Loss: 0.3187959
Validation loss decreased (0.646223 --> 0.645774).  Saving model ...
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.5079553
	speed: 0.1918s/iter; left time: 3417.1690s
	iters: 200, epoch: 13 | loss: 0.4989214
	speed: 0.0511s/iter; left time: 906.0096s
	iters: 300, epoch: 13 | loss: 0.4281585
	speed: 0.0522s/iter; left time: 919.4078s
	iters: 400, epoch: 13 | loss: 0.4245543
	speed: 0.0497s/iter; left time: 869.7759s
	iters: 500, epoch: 13 | loss: 0.8375701
	speed: 0.0503s/iter; left time: 876.3624s
	iters: 600, epoch: 13 | loss: 0.7711065
	speed: 0.0511s/iter; left time: 885.1413s
	iters: 700, epoch: 13 | loss: 0.6457632
	speed: 0.0492s/iter; left time: 846.2464s
	iters: 800, epoch: 13 | loss: 0.4755814
	speed: 0.0483s/iter; left time: 827.3349s
	iters: 900, epoch: 13 | loss: 0.5031403
	speed: 0.0516s/iter; left time: 877.5607s
	iters: 1000, epoch: 13 | loss: 1.0873699
	speed: 0.0514s/iter; left time: 869.0943s
	iters: 1100, epoch: 13 | loss: 0.4188356
	speed: 0.0491s/iter; left time: 825.0442s
	iters: 1200, epoch: 13 | loss: 0.9285561
	speed: 0.0477s/iter; left time: 797.2299s
	iters: 1300, epoch: 13 | loss: 0.6426147
	speed: 0.0510s/iter; left time: 847.3403s
	iters: 1400, epoch: 13 | loss: 0.4341953
	speed: 0.0540s/iter; left time: 892.4095s
	iters: 1500, epoch: 13 | loss: 0.7770772
	speed: 0.0523s/iter; left time: 858.3691s
	iters: 1600, epoch: 13 | loss: 0.9588915
	speed: 0.0549s/iter; left time: 895.7066s
	iters: 1700, epoch: 13 | loss: 1.1410129
	speed: 0.0547s/iter; left time: 887.0105s
	iters: 1800, epoch: 13 | loss: 0.5359490
	speed: 0.0504s/iter; left time: 812.5570s
	iters: 1900, epoch: 13 | loss: 0.6125534
	speed: 0.0500s/iter; left time: 801.0518s
	iters: 2000, epoch: 13 | loss: 0.5435882
	speed: 0.0437s/iter; left time: 695.8332s
	iters: 2100, epoch: 13 | loss: 0.9550149
	speed: 0.0415s/iter; left time: 656.9817s
	iters: 2200, epoch: 13 | loss: 0.6373868
	speed: 0.0383s/iter; left time: 601.1192s
Epoch: 13 cost time: 111.05871987342834
Epoch: 13, Steps: 2239 | Train Loss: 0.6920633 Vali Loss: 0.6459473 Test Loss: 0.3183585
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.5230370
	speed: 0.1844s/iter; left time: 2871.5869s
	iters: 200, epoch: 14 | loss: 0.5717892
	speed: 0.0513s/iter; left time: 793.6602s
	iters: 300, epoch: 14 | loss: 0.9226537
	speed: 0.0501s/iter; left time: 769.7653s
	iters: 400, epoch: 14 | loss: 0.7533062
	speed: 0.0518s/iter; left time: 791.5072s
	iters: 500, epoch: 14 | loss: 0.4651318
	speed: 0.0537s/iter; left time: 814.5789s
	iters: 600, epoch: 14 | loss: 0.4760209
	speed: 0.0506s/iter; left time: 762.0402s
	iters: 700, epoch: 14 | loss: 0.7795130
	speed: 0.0495s/iter; left time: 740.8973s
	iters: 800, epoch: 14 | loss: 0.7905347
	speed: 0.0522s/iter; left time: 776.6428s
	iters: 900, epoch: 14 | loss: 0.4398278
	speed: 0.0517s/iter; left time: 763.6459s
	iters: 1000, epoch: 14 | loss: 0.5401108
	speed: 0.0493s/iter; left time: 724.1576s
	iters: 1100, epoch: 14 | loss: 0.5261216
	speed: 0.0509s/iter; left time: 742.3240s
	iters: 1200, epoch: 14 | loss: 0.5023467
	speed: 0.0514s/iter; left time: 743.3543s
	iters: 1300, epoch: 14 | loss: 1.1464919
	speed: 0.0515s/iter; left time: 740.5850s
	iters: 1400, epoch: 14 | loss: 0.7542555
	speed: 0.0496s/iter; left time: 708.0492s
	iters: 1500, epoch: 14 | loss: 1.7817754
	speed: 0.0485s/iter; left time: 687.2197s
	iters: 1600, epoch: 14 | loss: 0.4023853
	speed: 0.0495s/iter; left time: 697.0764s
	iters: 1700, epoch: 14 | loss: 0.4817149
	speed: 0.0465s/iter; left time: 649.3234s
	iters: 1800, epoch: 14 | loss: 0.4699633
	speed: 0.0505s/iter; left time: 701.1503s
	iters: 1900, epoch: 14 | loss: 0.7351479
	speed: 0.0497s/iter; left time: 684.1787s
	iters: 2000, epoch: 14 | loss: 0.4867507
	speed: 0.0426s/iter; left time: 582.7398s
	iters: 2100, epoch: 14 | loss: 0.6009654
	speed: 0.0426s/iter; left time: 578.8656s
	iters: 2200, epoch: 14 | loss: 0.7106156
	speed: 0.0381s/iter; left time: 513.3706s
Epoch: 14 cost time: 109.41711664199829
Epoch: 14, Steps: 2239 | Train Loss: 0.6918557 Vali Loss: 0.6459887 Test Loss: 0.3183862
EarlyStopping counter: 2 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.5851583
	speed: 0.1817s/iter; left time: 2423.4163s
	iters: 200, epoch: 15 | loss: 0.7330894
	speed: 0.0522s/iter; left time: 690.5090s
	iters: 300, epoch: 15 | loss: 0.4893759
	speed: 0.0530s/iter; left time: 696.0556s
	iters: 400, epoch: 15 | loss: 0.7439073
	speed: 0.0555s/iter; left time: 722.8948s
	iters: 500, epoch: 15 | loss: 0.4058877
	speed: 0.0568s/iter; left time: 734.1461s
	iters: 600, epoch: 15 | loss: 0.6004212
	speed: 0.0487s/iter; left time: 625.0624s
	iters: 700, epoch: 15 | loss: 0.4657016
	speed: 0.0503s/iter; left time: 640.0225s
	iters: 800, epoch: 15 | loss: 0.6721144
	speed: 0.0506s/iter; left time: 639.1214s
	iters: 900, epoch: 15 | loss: 0.4589698
	speed: 0.0507s/iter; left time: 636.1306s
	iters: 1000, epoch: 15 | loss: 0.4724350
	speed: 0.0554s/iter; left time: 689.4131s
	iters: 1100, epoch: 15 | loss: 0.4660016
	speed: 0.0527s/iter; left time: 649.9697s
	iters: 1200, epoch: 15 | loss: 0.5856143
	speed: 0.0525s/iter; left time: 642.7168s
	iters: 1300, epoch: 15 | loss: 0.9951741
	speed: 0.0527s/iter; left time: 639.8974s
	iters: 1400, epoch: 15 | loss: 0.9356364
	speed: 0.0532s/iter; left time: 640.2562s
	iters: 1500, epoch: 15 | loss: 0.5364035
	speed: 0.0509s/iter; left time: 607.6451s
	iters: 1600, epoch: 15 | loss: 0.5136089
	speed: 0.0490s/iter; left time: 580.1121s
	iters: 1700, epoch: 15 | loss: 0.4672518
	speed: 0.0522s/iter; left time: 612.7886s
	iters: 1800, epoch: 15 | loss: 0.5263652
	speed: 0.0486s/iter; left time: 565.6801s
	iters: 1900, epoch: 15 | loss: 0.5230434
	speed: 0.0476s/iter; left time: 548.6594s
	iters: 2000, epoch: 15 | loss: 0.8315339
	speed: 0.0443s/iter; left time: 506.3522s
	iters: 2100, epoch: 15 | loss: 0.6040270
	speed: 0.0372s/iter; left time: 421.8057s
	iters: 2200, epoch: 15 | loss: 0.5173486
	speed: 0.0382s/iter; left time: 429.2987s
Epoch: 15 cost time: 112.05985999107361
Epoch: 15, Steps: 2239 | Train Loss: 0.6917302 Vali Loss: 0.6459424 Test Loss: 0.3184555
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.4436867
	speed: 0.1814s/iter; left time: 2013.1684s
	iters: 200, epoch: 16 | loss: 0.4654573
	speed: 0.0449s/iter; left time: 493.5253s
	iters: 300, epoch: 16 | loss: 0.5394489
	speed: 0.0480s/iter; left time: 522.9254s
	iters: 400, epoch: 16 | loss: 0.7943479
	speed: 0.0415s/iter; left time: 447.7652s
	iters: 500, epoch: 16 | loss: 0.7448219
	speed: 0.0445s/iter; left time: 475.4949s
	iters: 600, epoch: 16 | loss: 0.5857573
	speed: 0.0465s/iter; left time: 492.9721s
	iters: 700, epoch: 16 | loss: 0.5255295
	speed: 0.0450s/iter; left time: 472.4994s
	iters: 800, epoch: 16 | loss: 0.4047381
	speed: 0.0471s/iter; left time: 489.8612s
	iters: 900, epoch: 16 | loss: 0.5658131
	speed: 0.0482s/iter; left time: 495.8445s
	iters: 1000, epoch: 16 | loss: 0.4710824
	speed: 0.0463s/iter; left time: 472.3746s
	iters: 1100, epoch: 16 | loss: 0.4532489
	speed: 0.0485s/iter; left time: 489.5322s
	iters: 1200, epoch: 16 | loss: 0.7341409
	speed: 0.0458s/iter; left time: 457.9721s
	iters: 1300, epoch: 16 | loss: 1.0956923
	speed: 0.0460s/iter; left time: 455.0957s
	iters: 1400, epoch: 16 | loss: 0.6707208
	speed: 0.0452s/iter; left time: 442.6953s
	iters: 1500, epoch: 16 | loss: 0.7101976
	speed: 0.0475s/iter; left time: 460.9083s
	iters: 1600, epoch: 16 | loss: 0.5104192
	speed: 0.0467s/iter; left time: 448.4560s
	iters: 1700, epoch: 16 | loss: 0.4926469
	speed: 0.0511s/iter; left time: 485.6050s
	iters: 1800, epoch: 16 | loss: 0.5571076
	speed: 0.0455s/iter; left time: 427.9618s
	iters: 1900, epoch: 16 | loss: 1.1763357
	speed: 0.0452s/iter; left time: 419.7674s
	iters: 2000, epoch: 16 | loss: 0.4729078
	speed: 0.0426s/iter; left time: 392.1183s
	iters: 2100, epoch: 16 | loss: 0.5456742
	speed: 0.0378s/iter; left time: 343.6666s
	iters: 2200, epoch: 16 | loss: 0.5274331
	speed: 0.0374s/iter; left time: 336.2232s
Epoch: 16 cost time: 101.28097867965698
Epoch: 16, Steps: 2239 | Train Loss: 0.6916466 Vali Loss: 0.6460084 Test Loss: 0.3184556
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 17 | loss: 1.9181312
	speed: 0.1655s/iter; left time: 1465.9779s
	iters: 200, epoch: 17 | loss: 0.3797089
	speed: 0.0411s/iter; left time: 359.8407s
	iters: 300, epoch: 17 | loss: 1.5083070
	speed: 0.0468s/iter; left time: 405.2360s
	iters: 400, epoch: 17 | loss: 0.7784237
	speed: 0.0470s/iter; left time: 402.1507s
	iters: 500, epoch: 17 | loss: 0.9209908
	speed: 0.0419s/iter; left time: 353.9560s
	iters: 600, epoch: 17 | loss: 1.2095528
	speed: 0.0425s/iter; left time: 354.9138s
	iters: 700, epoch: 17 | loss: 0.4412142
	speed: 0.0433s/iter; left time: 357.8431s
	iters: 800, epoch: 17 | loss: 0.4392828
	speed: 0.0420s/iter; left time: 342.8067s
	iters: 900, epoch: 17 | loss: 0.5181080
	speed: 0.0457s/iter; left time: 367.8596s
	iters: 1000, epoch: 17 | loss: 0.5321423
	speed: 0.0475s/iter; left time: 377.7169s
	iters: 1100, epoch: 17 | loss: 0.6999625
	speed: 0.0439s/iter; left time: 345.3130s
	iters: 1200, epoch: 17 | loss: 0.4693193
	speed: 0.0474s/iter; left time: 367.9085s
	iters: 1300, epoch: 17 | loss: 0.4315835
	speed: 0.0452s/iter; left time: 345.9900s
	iters: 1400, epoch: 17 | loss: 0.4871717
	speed: 0.0429s/iter; left time: 324.0450s
	iters: 1500, epoch: 17 | loss: 0.5640960
	speed: 0.0400s/iter; left time: 298.5218s
	iters: 1600, epoch: 17 | loss: 0.5098238
	speed: 0.0408s/iter; left time: 300.1423s
	iters: 1700, epoch: 17 | loss: 0.6271473
	speed: 0.0450s/iter; left time: 326.4486s
	iters: 1800, epoch: 17 | loss: 0.4573859
	speed: 0.0433s/iter; left time: 309.7991s
	iters: 1900, epoch: 17 | loss: 1.0616196
	speed: 0.0410s/iter; left time: 289.3619s
	iters: 2000, epoch: 17 | loss: 0.5446494
	speed: 0.0354s/iter; left time: 245.9433s
	iters: 2100, epoch: 17 | loss: 0.5241410
	speed: 0.0388s/iter; left time: 266.2097s
	iters: 2200, epoch: 17 | loss: 0.6790885
	speed: 0.0394s/iter; left time: 266.4414s
Epoch: 17 cost time: 95.82112264633179
Epoch: 17, Steps: 2239 | Train Loss: 0.6916220 Vali Loss: 0.6454462 Test Loss: 0.3184516
Validation loss decreased (0.645774 --> 0.645446).  Saving model ...
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 18 | loss: 0.5270157
	speed: 0.1485s/iter; left time: 983.0025s
	iters: 200, epoch: 18 | loss: 0.4527855
	speed: 0.0412s/iter; left time: 268.3733s
	iters: 300, epoch: 18 | loss: 0.7009703
	speed: 0.0368s/iter; left time: 236.4641s
	iters: 400, epoch: 18 | loss: 0.4491709
	speed: 0.0419s/iter; left time: 264.5123s
	iters: 500, epoch: 18 | loss: 0.5000126
	speed: 0.0445s/iter; left time: 276.8897s
	iters: 600, epoch: 18 | loss: 0.7256896
	speed: 0.0433s/iter; left time: 264.9521s
	iters: 700, epoch: 18 | loss: 0.7098048
	speed: 0.0386s/iter; left time: 232.0777s
	iters: 800, epoch: 18 | loss: 1.1074709
	speed: 0.0420s/iter; left time: 248.7953s
	iters: 900, epoch: 18 | loss: 0.6889789
	speed: 0.0423s/iter; left time: 246.0031s
	iters: 1000, epoch: 18 | loss: 0.8118821
	speed: 0.0456s/iter; left time: 260.5046s
	iters: 1100, epoch: 18 | loss: 0.8023900
	speed: 0.0445s/iter; left time: 250.0139s
	iters: 1200, epoch: 18 | loss: 0.5705830
	speed: 0.0430s/iter; left time: 237.3696s
	iters: 1300, epoch: 18 | loss: 0.5050851
	speed: 0.0444s/iter; left time: 240.6973s
	iters: 1400, epoch: 18 | loss: 0.3726505
	speed: 0.0412s/iter; left time: 219.2893s
	iters: 1500, epoch: 18 | loss: 1.6296120
	speed: 0.0470s/iter; left time: 245.4928s
	iters: 1600, epoch: 18 | loss: 0.4621128
	speed: 0.0429s/iter; left time: 219.4352s
	iters: 1700, epoch: 18 | loss: 0.4982362
	speed: 0.0429s/iter; left time: 215.3704s
	iters: 1800, epoch: 18 | loss: 0.4788549
	speed: 0.0445s/iter; left time: 218.9189s
	iters: 1900, epoch: 18 | loss: 1.3433237
	speed: 0.0410s/iter; left time: 197.3513s
	iters: 2000, epoch: 18 | loss: 0.7564276
	speed: 0.0398s/iter; left time: 187.7788s
	iters: 2100, epoch: 18 | loss: 0.5535156
	speed: 0.0360s/iter; left time: 166.4756s
	iters: 2200, epoch: 18 | loss: 0.5304453
	speed: 0.0359s/iter; left time: 162.4050s
Epoch: 18 cost time: 93.33061480522156
Epoch: 18, Steps: 2239 | Train Loss: 0.6916508 Vali Loss: 0.6457513 Test Loss: 0.3184496
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 19 | loss: 0.6667749
	speed: 0.1362s/iter; left time: 596.3430s
	iters: 200, epoch: 19 | loss: 0.6521174
	speed: 0.0406s/iter; left time: 173.7527s
	iters: 300, epoch: 19 | loss: 0.5129766
	speed: 0.0370s/iter; left time: 154.6851s
	iters: 400, epoch: 19 | loss: 0.5263416
	speed: 0.0347s/iter; left time: 141.5771s
	iters: 500, epoch: 19 | loss: 0.4958201
	speed: 0.0348s/iter; left time: 138.5529s
	iters: 600, epoch: 19 | loss: 0.5381426
	speed: 0.0337s/iter; left time: 130.7184s
	iters: 700, epoch: 19 | loss: 0.5737599
	speed: 0.0338s/iter; left time: 127.5414s
	iters: 800, epoch: 19 | loss: 0.5062562
	speed: 0.0327s/iter; left time: 120.3073s
	iters: 900, epoch: 19 | loss: 0.7862836
	speed: 0.0336s/iter; left time: 120.4157s
	iters: 1000, epoch: 19 | loss: 0.4460203
	speed: 0.0345s/iter; left time: 119.9984s
	iters: 1100, epoch: 19 | loss: 0.8060866
	speed: 0.0356s/iter; left time: 120.3328s
	iters: 1200, epoch: 19 | loss: 0.3990058
	speed: 0.0342s/iter; left time: 111.9962s
	iters: 1300, epoch: 19 | loss: 1.0282564
	speed: 0.0343s/iter; left time: 109.0364s
	iters: 1400, epoch: 19 | loss: 0.4898252
	speed: 0.0331s/iter; left time: 101.7678s
	iters: 1500, epoch: 19 | loss: 0.8386809
	speed: 0.0319s/iter; left time: 95.0178s
	iters: 1600, epoch: 19 | loss: 0.8080759
	speed: 0.0323s/iter; left time: 92.9453s
	iters: 1700, epoch: 19 | loss: 0.4250425
	speed: 0.0332s/iter; left time: 92.2782s
	iters: 1800, epoch: 19 | loss: 0.5413187
	speed: 0.0332s/iter; left time: 88.8635s
	iters: 1900, epoch: 19 | loss: 0.9817716
	speed: 0.0320s/iter; left time: 82.4415s
	iters: 2000, epoch: 19 | loss: 0.4987949
	speed: 0.0304s/iter; left time: 75.4522s
	iters: 2100, epoch: 19 | loss: 0.4949765
	speed: 0.0306s/iter; left time: 72.8355s
	iters: 2200, epoch: 19 | loss: 1.0622100
	speed: 0.0323s/iter; left time: 73.6301s
Epoch: 19 cost time: 76.31153535842896
Epoch: 19, Steps: 2239 | Train Loss: 0.6915622 Vali Loss: 0.6458061 Test Loss: 0.3184495
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.9073486328125e-08
	iters: 100, epoch: 20 | loss: 0.5081142
	speed: 0.1231s/iter; left time: 263.5109s
	iters: 200, epoch: 20 | loss: 0.4350406
	speed: 0.0336s/iter; left time: 68.4586s
	iters: 300, epoch: 20 | loss: 0.4371215
	speed: 0.0324s/iter; left time: 62.8754s
	iters: 400, epoch: 20 | loss: 0.8517849
	speed: 0.0314s/iter; left time: 57.7902s
	iters: 500, epoch: 20 | loss: 0.8263589
	speed: 0.0315s/iter; left time: 54.8776s
	iters: 600, epoch: 20 | loss: 0.5378568
	speed: 0.0308s/iter; left time: 50.4708s
	iters: 700, epoch: 20 | loss: 0.7796613
	speed: 0.0314s/iter; left time: 48.4062s
	iters: 800, epoch: 20 | loss: 0.4717590
	speed: 0.0314s/iter; left time: 45.2135s
	iters: 900, epoch: 20 | loss: 0.6198732
	speed: 0.0309s/iter; left time: 41.4236s
	iters: 1000, epoch: 20 | loss: 0.4606767
	speed: 0.0312s/iter; left time: 38.7162s
	iters: 1100, epoch: 20 | loss: 0.7200514
	speed: 0.0315s/iter; left time: 35.8993s
	iters: 1200, epoch: 20 | loss: 0.6949096
	speed: 0.0316s/iter; left time: 32.8189s
	iters: 1300, epoch: 20 | loss: 0.5284253
	speed: 0.0315s/iter; left time: 29.5636s
	iters: 1400, epoch: 20 | loss: 0.4724546
	speed: 0.0310s/iter; left time: 26.0738s
	iters: 1500, epoch: 20 | loss: 0.7393983
	speed: 0.0309s/iter; left time: 22.8382s
	iters: 1600, epoch: 20 | loss: 0.7583520
	speed: 0.0311s/iter; left time: 19.9126s
	iters: 1700, epoch: 20 | loss: 0.5308080
	speed: 0.0319s/iter; left time: 17.2195s
	iters: 1800, epoch: 20 | loss: 0.5918510
	speed: 0.0318s/iter; left time: 13.9716s
	iters: 1900, epoch: 20 | loss: 0.5309865
	speed: 0.0307s/iter; left time: 10.4393s
	iters: 2000, epoch: 20 | loss: 0.4930324
	speed: 0.0302s/iter; left time: 7.2525s
	iters: 2100, epoch: 20 | loss: 0.7498583
	speed: 0.0289s/iter; left time: 4.0401s
	iters: 2200, epoch: 20 | loss: 0.5544266
	speed: 0.0284s/iter; left time: 1.1348s
Epoch: 20 cost time: 69.8946840763092
Epoch: 20, Steps: 2239 | Train Loss: 0.6916115 Vali Loss: 0.6461538 Test Loss: 0.3184495
EarlyStopping counter: 3 out of 5
Updating learning rate to 9.5367431640625e-09
>>>>>>>testing : weather_336_720_NLinear_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed12890<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9820
mse:0.3184216022491455, mae:0.33363714814186096
