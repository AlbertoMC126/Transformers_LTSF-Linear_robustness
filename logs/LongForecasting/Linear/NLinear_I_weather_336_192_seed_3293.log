Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='NLinear', model_id='weather_336_192', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=192, root_path='./dataset/', save_pred_values=False, seed=3293, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : weather_336_192_NLinear_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3293>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36360
val 5079
test 10348
	iters: 100, epoch: 1 | loss: 1.1523818
	speed: 0.0124s/iter; left time: 561.9647s
	iters: 200, epoch: 1 | loss: 0.6997613
	speed: 0.0129s/iter; left time: 582.8202s
	iters: 300, epoch: 1 | loss: 0.9175524
	speed: 0.0136s/iter; left time: 615.9292s
	iters: 400, epoch: 1 | loss: 33.4611626
	speed: 0.0140s/iter; left time: 628.8602s
	iters: 500, epoch: 1 | loss: 0.5915949
	speed: 0.0143s/iter; left time: 642.8846s
	iters: 600, epoch: 1 | loss: 1.9729918
	speed: 0.0148s/iter; left time: 662.9318s
	iters: 700, epoch: 1 | loss: 0.5913308
	speed: 0.0146s/iter; left time: 653.2762s
	iters: 800, epoch: 1 | loss: 2.3714294
	speed: 0.0148s/iter; left time: 662.2438s
	iters: 900, epoch: 1 | loss: 0.5341240
	speed: 0.0126s/iter; left time: 560.8465s
	iters: 1000, epoch: 1 | loss: 0.4951453
	speed: 0.0119s/iter; left time: 527.5989s
	iters: 1100, epoch: 1 | loss: 0.5228865
	speed: 0.0118s/iter; left time: 522.8073s
	iters: 1200, epoch: 1 | loss: 3.0935149
	speed: 0.0132s/iter; left time: 582.8066s
	iters: 1300, epoch: 1 | loss: 0.5080171
	speed: 0.0114s/iter; left time: 504.6039s
	iters: 1400, epoch: 1 | loss: 0.7848554
	speed: 0.0122s/iter; left time: 539.1233s
	iters: 1500, epoch: 1 | loss: 0.7999464
	speed: 0.0141s/iter; left time: 618.0090s
	iters: 1600, epoch: 1 | loss: 1.5298074
	speed: 0.0136s/iter; left time: 595.4170s
	iters: 1700, epoch: 1 | loss: 0.9418218
	speed: 0.0138s/iter; left time: 601.4978s
	iters: 1800, epoch: 1 | loss: 0.5211643
	speed: 0.0141s/iter; left time: 614.7619s
	iters: 1900, epoch: 1 | loss: 0.4794080
	speed: 0.0147s/iter; left time: 639.2575s
	iters: 2000, epoch: 1 | loss: 0.4269291
	speed: 0.0133s/iter; left time: 576.6335s
	iters: 2100, epoch: 1 | loss: 0.5353838
	speed: 0.0109s/iter; left time: 470.9338s
	iters: 2200, epoch: 1 | loss: 0.6647155
	speed: 0.0125s/iter; left time: 541.0216s
Epoch: 1 cost time: 30.187861919403076
Epoch: 1, Steps: 2272 | Train Loss: 2.6668259 Vali Loss: 3.9351318 Test Loss: 0.3590039
Validation loss decreased (inf --> 3.935132).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.7492338
	speed: 0.0535s/iter; left time: 2304.7098s
	iters: 200, epoch: 2 | loss: 1.2107856
	speed: 0.0129s/iter; left time: 553.0399s
	iters: 300, epoch: 2 | loss: 0.8971242
	speed: 0.0136s/iter; left time: 581.1377s
	iters: 400, epoch: 2 | loss: 0.5842346
	speed: 0.0149s/iter; left time: 638.5667s
	iters: 500, epoch: 2 | loss: 0.5801973
	speed: 0.0133s/iter; left time: 568.6716s
	iters: 600, epoch: 2 | loss: 1.6433816
	speed: 0.0148s/iter; left time: 628.8594s
	iters: 700, epoch: 2 | loss: 1.3822852
	speed: 0.0130s/iter; left time: 552.2088s
	iters: 800, epoch: 2 | loss: 1.9451768
	speed: 0.0142s/iter; left time: 599.7636s
	iters: 900, epoch: 2 | loss: 0.4373144
	speed: 0.0133s/iter; left time: 562.7225s
	iters: 1000, epoch: 2 | loss: 0.5759088
	speed: 0.0133s/iter; left time: 562.4089s
	iters: 1100, epoch: 2 | loss: 0.5453238
	speed: 0.0136s/iter; left time: 570.1776s
	iters: 1200, epoch: 2 | loss: 0.5771154
	speed: 0.0143s/iter; left time: 600.6950s
	iters: 1300, epoch: 2 | loss: 2.9450104
	speed: 0.0136s/iter; left time: 570.0188s
	iters: 1400, epoch: 2 | loss: 0.5567661
	speed: 0.0143s/iter; left time: 596.1448s
	iters: 1500, epoch: 2 | loss: 1.0278727
	speed: 0.0148s/iter; left time: 616.0277s
	iters: 1600, epoch: 2 | loss: 0.6423615
	speed: 0.0153s/iter; left time: 637.6877s
	iters: 1700, epoch: 2 | loss: 0.5267703
	speed: 0.0146s/iter; left time: 606.8728s
	iters: 1800, epoch: 2 | loss: 0.7632240
	speed: 0.0149s/iter; left time: 615.1988s
	iters: 1900, epoch: 2 | loss: 0.5094851
	speed: 0.0136s/iter; left time: 562.1463s
	iters: 2000, epoch: 2 | loss: 1.4839132
	speed: 0.0145s/iter; left time: 595.4936s
	iters: 2100, epoch: 2 | loss: 2.1946056
	speed: 0.0134s/iter; left time: 548.7666s
	iters: 2200, epoch: 2 | loss: 0.4695812
	speed: 0.0151s/iter; left time: 618.7856s
Epoch: 2 cost time: 31.776540994644165
Epoch: 2, Steps: 2272 | Train Loss: 27.0345856 Vali Loss: 0.6097183 Test Loss: 0.2855600
Validation loss decreased (3.935132 --> 0.609718).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 1.4790351
	speed: 0.0577s/iter; left time: 2355.3462s
	iters: 200, epoch: 3 | loss: 1.7447484
	speed: 0.0150s/iter; left time: 610.3545s
	iters: 300, epoch: 3 | loss: 0.5466896
	speed: 0.0152s/iter; left time: 615.1527s
	iters: 400, epoch: 3 | loss: 0.5948952
	speed: 0.0139s/iter; left time: 564.2764s
	iters: 500, epoch: 3 | loss: 0.7129384
	speed: 0.0154s/iter; left time: 621.9829s
	iters: 600, epoch: 3 | loss: 1.4209036
	speed: 0.0139s/iter; left time: 558.6804s
	iters: 700, epoch: 3 | loss: 0.4991751
	speed: 0.0134s/iter; left time: 537.5366s
	iters: 800, epoch: 3 | loss: 0.5374479
	speed: 0.0139s/iter; left time: 555.9786s
	iters: 900, epoch: 3 | loss: 0.4150684
	speed: 0.0135s/iter; left time: 538.5310s
	iters: 1000, epoch: 3 | loss: 0.5316561
	speed: 0.0107s/iter; left time: 425.0158s
	iters: 1100, epoch: 3 | loss: 0.3949933
	speed: 0.0125s/iter; left time: 496.7240s
	iters: 1200, epoch: 3 | loss: 0.3484349
	speed: 0.0151s/iter; left time: 599.2253s
	iters: 1300, epoch: 3 | loss: 0.3552183
	speed: 0.0150s/iter; left time: 593.2122s
	iters: 1400, epoch: 3 | loss: 0.4350277
	speed: 0.0135s/iter; left time: 532.6143s
	iters: 1500, epoch: 3 | loss: 0.4930737
	speed: 0.0143s/iter; left time: 563.8350s
	iters: 1600, epoch: 3 | loss: 0.5189586
	speed: 0.0141s/iter; left time: 555.6836s
	iters: 1700, epoch: 3 | loss: 0.4042367
	speed: 0.0133s/iter; left time: 521.5585s
	iters: 1800, epoch: 3 | loss: 0.4667450
	speed: 0.0131s/iter; left time: 511.8420s
	iters: 1900, epoch: 3 | loss: 0.3551621
	speed: 0.0131s/iter; left time: 512.4758s
	iters: 2000, epoch: 3 | loss: 3.9272003
	speed: 0.0141s/iter; left time: 550.2144s
	iters: 2100, epoch: 3 | loss: 0.4938606
	speed: 0.0121s/iter; left time: 469.1318s
	iters: 2200, epoch: 3 | loss: 0.4134843
	speed: 0.0138s/iter; left time: 533.2941s
Epoch: 3 cost time: 31.066051721572876
Epoch: 3, Steps: 2272 | Train Loss: 39.3961209 Vali Loss: 0.5511417 Test Loss: 0.2318474
Validation loss decreased (0.609718 --> 0.551142).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.3335078
	speed: 0.0563s/iter; left time: 2170.7160s
	iters: 200, epoch: 4 | loss: 1.3595939
	speed: 0.0141s/iter; left time: 539.9273s
	iters: 300, epoch: 4 | loss: 0.4464637
	speed: 0.0137s/iter; left time: 523.4484s
	iters: 400, epoch: 4 | loss: 1.1161112
	speed: 0.0152s/iter; left time: 579.9451s
	iters: 500, epoch: 4 | loss: 0.3911571
	speed: 0.0148s/iter; left time: 562.6229s
	iters: 600, epoch: 4 | loss: 0.3284550
	speed: 0.0138s/iter; left time: 524.9398s
	iters: 700, epoch: 4 | loss: 0.6734567
	speed: 0.0142s/iter; left time: 539.4392s
	iters: 800, epoch: 4 | loss: 0.7306316
	speed: 0.0127s/iter; left time: 478.5992s
	iters: 900, epoch: 4 | loss: 0.3345084
	speed: 0.0148s/iter; left time: 559.8951s
	iters: 1000, epoch: 4 | loss: 0.6531354
	speed: 0.0139s/iter; left time: 521.2570s
	iters: 1100, epoch: 4 | loss: 0.3507809
	speed: 0.0138s/iter; left time: 517.5808s
	iters: 1200, epoch: 4 | loss: 0.4255263
	speed: 0.0136s/iter; left time: 509.4549s
	iters: 1300, epoch: 4 | loss: 0.5282088
	speed: 0.0137s/iter; left time: 510.0029s
	iters: 1400, epoch: 4 | loss: 0.3980549
	speed: 0.0142s/iter; left time: 528.6419s
	iters: 1500, epoch: 4 | loss: 1.4204346
	speed: 0.0138s/iter; left time: 513.6728s
	iters: 1600, epoch: 4 | loss: 0.3789466
	speed: 0.0152s/iter; left time: 564.3452s
	iters: 1700, epoch: 4 | loss: 0.6473315
	speed: 0.0145s/iter; left time: 536.7002s
	iters: 1800, epoch: 4 | loss: 0.5795766
	speed: 0.0142s/iter; left time: 523.7655s
	iters: 1900, epoch: 4 | loss: 0.3606015
	speed: 0.0142s/iter; left time: 520.4263s
	iters: 2000, epoch: 4 | loss: 0.6767619
	speed: 0.0132s/iter; left time: 481.8151s
	iters: 2100, epoch: 4 | loss: 0.2268204
	speed: 0.0135s/iter; left time: 492.0874s
	iters: 2200, epoch: 4 | loss: 0.2799281
	speed: 0.0117s/iter; left time: 427.3071s
Epoch: 4 cost time: 31.61401677131653
Epoch: 4, Steps: 2272 | Train Loss: 2.2137987 Vali Loss: 0.6230280 Test Loss: 0.2042049
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 1.1528652
	speed: 0.0508s/iter; left time: 1840.3253s
	iters: 200, epoch: 5 | loss: 1.3749479
	speed: 0.0149s/iter; left time: 537.0455s
	iters: 300, epoch: 5 | loss: 1.5160563
	speed: 0.0130s/iter; left time: 468.7554s
	iters: 400, epoch: 5 | loss: 0.3916881
	speed: 0.0152s/iter; left time: 547.0074s
	iters: 500, epoch: 5 | loss: 0.3847831
	speed: 0.0146s/iter; left time: 522.4462s
	iters: 600, epoch: 5 | loss: 0.3808852
	speed: 0.0144s/iter; left time: 514.2657s
	iters: 700, epoch: 5 | loss: 1.2332293
	speed: 0.0139s/iter; left time: 494.5357s
	iters: 800, epoch: 5 | loss: 0.4670414
	speed: 0.0135s/iter; left time: 478.6022s
	iters: 900, epoch: 5 | loss: 0.3924471
	speed: 0.0117s/iter; left time: 414.1570s
	iters: 1000, epoch: 5 | loss: 0.3351005
	speed: 0.0141s/iter; left time: 498.9971s
	iters: 1100, epoch: 5 | loss: 0.6385178
	speed: 0.0153s/iter; left time: 540.4641s
	iters: 1200, epoch: 5 | loss: 0.6795154
	speed: 0.0123s/iter; left time: 433.2432s
	iters: 1300, epoch: 5 | loss: 0.2214977
	speed: 0.0137s/iter; left time: 478.4868s
	iters: 1400, epoch: 5 | loss: 0.5413004
	speed: 0.0154s/iter; left time: 539.4563s
	iters: 1500, epoch: 5 | loss: 0.5958884
	speed: 0.0107s/iter; left time: 374.3682s
	iters: 1600, epoch: 5 | loss: 0.3040241
	speed: 0.0130s/iter; left time: 450.4547s
	iters: 1700, epoch: 5 | loss: 0.3566621
	speed: 0.0118s/iter; left time: 408.6062s
	iters: 1800, epoch: 5 | loss: 0.7039968
	speed: 0.0104s/iter; left time: 359.4413s
	iters: 1900, epoch: 5 | loss: 0.7556657
	speed: 0.0133s/iter; left time: 456.9187s
	iters: 2000, epoch: 5 | loss: 0.5704489
	speed: 0.0145s/iter; left time: 498.5666s
	iters: 2100, epoch: 5 | loss: 1.4357096
	speed: 0.0153s/iter; left time: 525.4732s
	iters: 2200, epoch: 5 | loss: 0.3522600
	speed: 0.0143s/iter; left time: 489.5884s
Epoch: 5 cost time: 30.861809253692627
Epoch: 5, Steps: 2272 | Train Loss: 0.8452356 Vali Loss: 0.4569220 Test Loss: 0.1911716
Validation loss decreased (0.551142 --> 0.456922).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.7581530
	speed: 0.0593s/iter; left time: 2013.5228s
	iters: 200, epoch: 6 | loss: 0.7753254
	speed: 0.0122s/iter; left time: 412.1621s
	iters: 300, epoch: 6 | loss: 0.3224574
	speed: 0.0147s/iter; left time: 497.0064s
	iters: 400, epoch: 6 | loss: 0.4872555
	speed: 0.0139s/iter; left time: 466.6495s
	iters: 500, epoch: 6 | loss: 0.3678586
	speed: 0.0133s/iter; left time: 446.7007s
	iters: 600, epoch: 6 | loss: 1.5450379
	speed: 0.0117s/iter; left time: 393.1666s
	iters: 700, epoch: 6 | loss: 0.4061199
	speed: 0.0139s/iter; left time: 464.8325s
	iters: 800, epoch: 6 | loss: 0.3784770
	speed: 0.0122s/iter; left time: 405.6761s
	iters: 900, epoch: 6 | loss: 0.2645930
	speed: 0.0133s/iter; left time: 441.3959s
	iters: 1000, epoch: 6 | loss: 0.3437846
	speed: 0.0132s/iter; left time: 436.4663s
	iters: 1100, epoch: 6 | loss: 1.3031803
	speed: 0.0139s/iter; left time: 459.1542s
	iters: 1200, epoch: 6 | loss: 0.5359998
	speed: 0.0126s/iter; left time: 414.6844s
	iters: 1300, epoch: 6 | loss: 0.4421319
	speed: 0.0135s/iter; left time: 443.6912s
	iters: 1400, epoch: 6 | loss: 0.4172757
	speed: 0.0134s/iter; left time: 438.7606s
	iters: 1500, epoch: 6 | loss: 0.2555046
	speed: 0.0138s/iter; left time: 448.0544s
	iters: 1600, epoch: 6 | loss: 0.3724108
	speed: 0.0134s/iter; left time: 436.4030s
	iters: 1700, epoch: 6 | loss: 0.2924196
	speed: 0.0140s/iter; left time: 452.4110s
	iters: 1800, epoch: 6 | loss: 0.2322687
	speed: 0.0139s/iter; left time: 448.4768s
	iters: 1900, epoch: 6 | loss: 0.2801224
	speed: 0.0119s/iter; left time: 382.7867s
	iters: 2000, epoch: 6 | loss: 0.3167648
	speed: 0.0138s/iter; left time: 443.4295s
	iters: 2100, epoch: 6 | loss: 0.3475470
	speed: 0.0133s/iter; left time: 426.3644s
	iters: 2200, epoch: 6 | loss: 0.2906204
	speed: 0.0143s/iter; left time: 457.2754s
Epoch: 6 cost time: 30.473394632339478
Epoch: 6, Steps: 2272 | Train Loss: 0.5614487 Vali Loss: 0.4570224 Test Loss: 0.1912127
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.4166949
	speed: 0.0590s/iter; left time: 1871.9535s
	iters: 200, epoch: 7 | loss: 0.3029380
	speed: 0.0151s/iter; left time: 477.0177s
	iters: 300, epoch: 7 | loss: 1.2700670
	speed: 0.0144s/iter; left time: 452.9581s
	iters: 400, epoch: 7 | loss: 0.5002404
	speed: 0.0134s/iter; left time: 420.3519s
	iters: 500, epoch: 7 | loss: 0.3573047
	speed: 0.0148s/iter; left time: 463.1390s
	iters: 600, epoch: 7 | loss: 0.4033227
	speed: 0.0149s/iter; left time: 466.1211s
	iters: 700, epoch: 7 | loss: 0.5569235
	speed: 0.0135s/iter; left time: 420.6613s
	iters: 800, epoch: 7 | loss: 0.3302643
	speed: 0.0128s/iter; left time: 396.0917s
	iters: 900, epoch: 7 | loss: 0.6653517
	speed: 0.0129s/iter; left time: 400.0168s
	iters: 1000, epoch: 7 | loss: 0.3347293
	speed: 0.0121s/iter; left time: 371.5748s
	iters: 1100, epoch: 7 | loss: 0.3007331
	speed: 0.0145s/iter; left time: 446.4440s
	iters: 1200, epoch: 7 | loss: 0.3264334
	speed: 0.0138s/iter; left time: 420.9937s
	iters: 1300, epoch: 7 | loss: 0.3471383
	speed: 0.0122s/iter; left time: 372.2822s
	iters: 1400, epoch: 7 | loss: 0.6260130
	speed: 0.0137s/iter; left time: 415.7082s
	iters: 1500, epoch: 7 | loss: 0.7267500
	speed: 0.0137s/iter; left time: 415.3105s
	iters: 1600, epoch: 7 | loss: 0.4923738
	speed: 0.0134s/iter; left time: 405.1865s
	iters: 1700, epoch: 7 | loss: 0.5216520
	speed: 0.0134s/iter; left time: 404.1743s
	iters: 1800, epoch: 7 | loss: 0.5042293
	speed: 0.0147s/iter; left time: 441.1326s
	iters: 1900, epoch: 7 | loss: 0.4992459
	speed: 0.0122s/iter; left time: 364.6326s
	iters: 2000, epoch: 7 | loss: 0.2806357
	speed: 0.0143s/iter; left time: 426.3969s
	iters: 2100, epoch: 7 | loss: 1.4378814
	speed: 0.0158s/iter; left time: 469.0217s
	iters: 2200, epoch: 7 | loss: 0.7567445
	speed: 0.0134s/iter; left time: 397.7599s
Epoch: 7 cost time: 31.1069073677063
Epoch: 7, Steps: 2272 | Train Loss: 0.5603533 Vali Loss: 0.4859180 Test Loss: 0.1872555
EarlyStopping counter: 2 out of 5
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.4571530
	speed: 0.0537s/iter; left time: 1579.9233s
	iters: 200, epoch: 8 | loss: 0.5665235
	speed: 0.0152s/iter; left time: 446.2611s
	iters: 300, epoch: 8 | loss: 0.3265600
	speed: 0.0123s/iter; left time: 360.6489s
	iters: 400, epoch: 8 | loss: 1.2531654
	speed: 0.0143s/iter; left time: 417.7161s
	iters: 500, epoch: 8 | loss: 0.7553390
	speed: 0.0132s/iter; left time: 382.1803s
	iters: 600, epoch: 8 | loss: 0.3348867
	speed: 0.0129s/iter; left time: 374.3162s
	iters: 700, epoch: 8 | loss: 0.5192744
	speed: 0.0122s/iter; left time: 352.4087s
	iters: 800, epoch: 8 | loss: 0.4897158
	speed: 0.0132s/iter; left time: 377.9773s
	iters: 900, epoch: 8 | loss: 0.2407859
	speed: 0.0131s/iter; left time: 373.8511s
	iters: 1000, epoch: 8 | loss: 0.2705307
	speed: 0.0129s/iter; left time: 367.3135s
	iters: 1100, epoch: 8 | loss: 0.5857515
	speed: 0.0146s/iter; left time: 416.4239s
	iters: 1200, epoch: 8 | loss: 0.4377896
	speed: 0.0157s/iter; left time: 443.8911s
	iters: 1300, epoch: 8 | loss: 1.3830245
	speed: 0.0152s/iter; left time: 429.2305s
	iters: 1400, epoch: 8 | loss: 0.7130254
	speed: 0.0131s/iter; left time: 367.8610s
	iters: 1500, epoch: 8 | loss: 0.5428609
	speed: 0.0143s/iter; left time: 401.6555s
	iters: 1600, epoch: 8 | loss: 0.4114197
	speed: 0.0157s/iter; left time: 437.6218s
	iters: 1700, epoch: 8 | loss: 0.3227733
	speed: 0.0153s/iter; left time: 425.6777s
	iters: 1800, epoch: 8 | loss: 0.3684150
	speed: 0.0149s/iter; left time: 413.6465s
	iters: 1900, epoch: 8 | loss: 1.2755244
	speed: 0.0137s/iter; left time: 377.8486s
	iters: 2000, epoch: 8 | loss: 0.3537273
	speed: 0.0136s/iter; left time: 375.7562s
	iters: 2100, epoch: 8 | loss: 0.4251633
	speed: 0.0138s/iter; left time: 378.0768s
	iters: 2200, epoch: 8 | loss: 0.3928805
	speed: 0.0132s/iter; left time: 361.4200s
Epoch: 8 cost time: 31.559226751327515
Epoch: 8, Steps: 2272 | Train Loss: 0.5152033 Vali Loss: 0.4491480 Test Loss: 0.1862890
Validation loss decreased (0.456922 --> 0.449148).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.3387298
	speed: 0.0541s/iter; left time: 1468.4178s
	iters: 200, epoch: 9 | loss: 1.3193140
	speed: 0.0147s/iter; left time: 397.2749s
	iters: 300, epoch: 9 | loss: 0.6638051
	speed: 0.0143s/iter; left time: 386.1891s
	iters: 400, epoch: 9 | loss: 0.5881134
	speed: 0.0136s/iter; left time: 366.3036s
	iters: 500, epoch: 9 | loss: 0.2489166
	speed: 0.0124s/iter; left time: 333.0855s
	iters: 600, epoch: 9 | loss: 0.2364765
	speed: 0.0148s/iter; left time: 394.7446s
	iters: 700, epoch: 9 | loss: 1.0989377
	speed: 0.0134s/iter; left time: 356.0455s
	iters: 800, epoch: 9 | loss: 0.4110127
	speed: 0.0149s/iter; left time: 393.5833s
	iters: 900, epoch: 9 | loss: 0.3578872
	speed: 0.0136s/iter; left time: 357.5988s
	iters: 1000, epoch: 9 | loss: 0.4375601
	speed: 0.0128s/iter; left time: 334.9369s
	iters: 1100, epoch: 9 | loss: 0.3857931
	speed: 0.0130s/iter; left time: 338.9179s
	iters: 1200, epoch: 9 | loss: 1.3530250
	speed: 0.0121s/iter; left time: 316.5891s
	iters: 1300, epoch: 9 | loss: 0.4153096
	speed: 0.0112s/iter; left time: 290.3401s
	iters: 1400, epoch: 9 | loss: 0.6561391
	speed: 0.0118s/iter; left time: 304.7258s
	iters: 1500, epoch: 9 | loss: 0.3730229
	speed: 0.0119s/iter; left time: 305.9379s
	iters: 1600, epoch: 9 | loss: 0.3346575
	speed: 0.0118s/iter; left time: 303.5537s
	iters: 1700, epoch: 9 | loss: 1.0599868
	speed: 0.0104s/iter; left time: 266.4364s
	iters: 1800, epoch: 9 | loss: 0.2902167
	speed: 0.0124s/iter; left time: 316.9400s
	iters: 1900, epoch: 9 | loss: 0.5897019
	speed: 0.0133s/iter; left time: 336.3689s
	iters: 2000, epoch: 9 | loss: 0.2730497
	speed: 0.0119s/iter; left time: 300.7309s
	iters: 2100, epoch: 9 | loss: 0.5602140
	speed: 0.0127s/iter; left time: 319.6795s
	iters: 2200, epoch: 9 | loss: 0.5134322
	speed: 0.0135s/iter; left time: 338.7229s
Epoch: 9 cost time: 29.37172842025757
Epoch: 9, Steps: 2272 | Train Loss: 0.5043183 Vali Loss: 0.4493644 Test Loss: 0.1868006
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.4852836
	speed: 0.0460s/iter; left time: 1145.2707s
	iters: 200, epoch: 10 | loss: 0.3721101
	speed: 0.0123s/iter; left time: 304.5178s
	iters: 300, epoch: 10 | loss: 0.3991043
	speed: 0.0130s/iter; left time: 322.2118s
	iters: 400, epoch: 10 | loss: 0.3278640
	speed: 0.0145s/iter; left time: 355.4400s
	iters: 500, epoch: 10 | loss: 1.2380781
	speed: 0.0153s/iter; left time: 374.5939s
	iters: 600, epoch: 10 | loss: 0.8948267
	speed: 0.0116s/iter; left time: 282.7670s
	iters: 700, epoch: 10 | loss: 0.4870429
	speed: 0.0121s/iter; left time: 293.2816s
	iters: 800, epoch: 10 | loss: 0.4228947
	speed: 0.0142s/iter; left time: 343.6596s
	iters: 900, epoch: 10 | loss: 0.3534632
	speed: 0.0137s/iter; left time: 330.3617s
	iters: 1000, epoch: 10 | loss: 0.3659121
	speed: 0.0136s/iter; left time: 325.8350s
	iters: 1100, epoch: 10 | loss: 1.2381335
	speed: 0.0136s/iter; left time: 324.5772s
	iters: 1200, epoch: 10 | loss: 0.4024827
	speed: 0.0142s/iter; left time: 337.8893s
	iters: 1300, epoch: 10 | loss: 0.3802222
	speed: 0.0129s/iter; left time: 304.4878s
	iters: 1400, epoch: 10 | loss: 0.1918145
	speed: 0.0131s/iter; left time: 309.4413s
	iters: 1500, epoch: 10 | loss: 0.3862670
	speed: 0.0119s/iter; left time: 280.3011s
	iters: 1600, epoch: 10 | loss: 0.8827056
	speed: 0.0147s/iter; left time: 343.6641s
	iters: 1700, epoch: 10 | loss: 0.6720804
	speed: 0.0137s/iter; left time: 318.2614s
	iters: 1800, epoch: 10 | loss: 0.4762639
	speed: 0.0141s/iter; left time: 326.8381s
	iters: 1900, epoch: 10 | loss: 0.2618353
	speed: 0.0135s/iter; left time: 311.1268s
	iters: 2000, epoch: 10 | loss: 0.3170150
	speed: 0.0137s/iter; left time: 314.1993s
	iters: 2100, epoch: 10 | loss: 0.3761107
	speed: 0.0128s/iter; left time: 291.9474s
	iters: 2200, epoch: 10 | loss: 0.5686884
	speed: 0.0133s/iter; left time: 303.8833s
Epoch: 10 cost time: 30.280735731124878
Epoch: 10, Steps: 2272 | Train Loss: 0.5028278 Vali Loss: 0.4488343 Test Loss: 0.1866666
Validation loss decreased (0.449148 --> 0.448834).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.3082434
	speed: 0.0460s/iter; left time: 1041.4343s
	iters: 200, epoch: 11 | loss: 0.4678832
	speed: 0.0106s/iter; left time: 238.7595s
	iters: 300, epoch: 11 | loss: 0.3532661
	speed: 0.0119s/iter; left time: 267.3018s
	iters: 400, epoch: 11 | loss: 0.2579381
	speed: 0.0143s/iter; left time: 320.1717s
	iters: 500, epoch: 11 | loss: 0.2943980
	speed: 0.0138s/iter; left time: 306.6970s
	iters: 600, epoch: 11 | loss: 0.4246790
	speed: 0.0150s/iter; left time: 331.0789s
	iters: 700, epoch: 11 | loss: 0.5344138
	speed: 0.0143s/iter; left time: 315.3978s
	iters: 800, epoch: 11 | loss: 0.2801867
	speed: 0.0147s/iter; left time: 322.5209s
	iters: 900, epoch: 11 | loss: 0.4150443
	speed: 0.0151s/iter; left time: 330.1607s
	iters: 1000, epoch: 11 | loss: 0.2864695
	speed: 0.0120s/iter; left time: 259.8163s
	iters: 1100, epoch: 11 | loss: 1.4438258
	speed: 0.0135s/iter; left time: 291.5772s
	iters: 1200, epoch: 11 | loss: 0.2705125
	speed: 0.0139s/iter; left time: 298.9773s
	iters: 1300, epoch: 11 | loss: 0.4180162
	speed: 0.0153s/iter; left time: 328.7650s
	iters: 1400, epoch: 11 | loss: 0.2863347
	speed: 0.0133s/iter; left time: 282.7895s
	iters: 1500, epoch: 11 | loss: 0.4403536
	speed: 0.0135s/iter; left time: 285.5464s
	iters: 1600, epoch: 11 | loss: 0.4358141
	speed: 0.0162s/iter; left time: 342.4909s
	iters: 1700, epoch: 11 | loss: 0.5009140
	speed: 0.0154s/iter; left time: 324.4085s
	iters: 1800, epoch: 11 | loss: 1.3336356
	speed: 0.0151s/iter; left time: 316.6865s
	iters: 1900, epoch: 11 | loss: 0.4305395
	speed: 0.0133s/iter; left time: 277.3747s
	iters: 2000, epoch: 11 | loss: 0.4712155
	speed: 0.0136s/iter; left time: 281.0775s
	iters: 2100, epoch: 11 | loss: 0.4978330
	speed: 0.0156s/iter; left time: 322.3468s
	iters: 2200, epoch: 11 | loss: 0.1655158
	speed: 0.0152s/iter; left time: 311.7699s
Epoch: 11 cost time: 31.59985065460205
Epoch: 11, Steps: 2272 | Train Loss: 0.5006419 Vali Loss: 0.4473078 Test Loss: 0.1868026
Validation loss decreased (0.448834 --> 0.447308).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.5886629
	speed: 0.0502s/iter; left time: 1020.8778s
	iters: 200, epoch: 12 | loss: 0.3678229
	speed: 0.0115s/iter; left time: 232.3263s
	iters: 300, epoch: 12 | loss: 0.5580143
	speed: 0.0117s/iter; left time: 236.4065s
	iters: 400, epoch: 12 | loss: 1.2733201
	speed: 0.0119s/iter; left time: 239.0289s
	iters: 500, epoch: 12 | loss: 0.2989952
	speed: 0.0145s/iter; left time: 289.4508s
	iters: 600, epoch: 12 | loss: 0.4065125
	speed: 0.0142s/iter; left time: 281.4934s
	iters: 700, epoch: 12 | loss: 0.3463373
	speed: 0.0129s/iter; left time: 253.8190s
	iters: 800, epoch: 12 | loss: 0.9054133
	speed: 0.0131s/iter; left time: 257.9065s
	iters: 900, epoch: 12 | loss: 0.7006282
	speed: 0.0118s/iter; left time: 230.9294s
	iters: 1000, epoch: 12 | loss: 0.4068783
	speed: 0.0146s/iter; left time: 283.7810s
	iters: 1100, epoch: 12 | loss: 0.3499731
	speed: 0.0134s/iter; left time: 259.6985s
	iters: 1200, epoch: 12 | loss: 0.3566463
	speed: 0.0147s/iter; left time: 282.0479s
	iters: 1300, epoch: 12 | loss: 1.4151628
	speed: 0.0153s/iter; left time: 292.4850s
	iters: 1400, epoch: 12 | loss: 0.2574531
	speed: 0.0144s/iter; left time: 274.8946s
	iters: 1500, epoch: 12 | loss: 0.3406938
	speed: 0.0135s/iter; left time: 256.0177s
	iters: 1600, epoch: 12 | loss: 0.3607438
	speed: 0.0150s/iter; left time: 282.0382s
	iters: 1700, epoch: 12 | loss: 0.3350769
	speed: 0.0160s/iter; left time: 299.6674s
	iters: 1800, epoch: 12 | loss: 0.3914647
	speed: 0.0144s/iter; left time: 269.1955s
	iters: 1900, epoch: 12 | loss: 0.6040827
	speed: 0.0135s/iter; left time: 249.5407s
	iters: 2000, epoch: 12 | loss: 0.4002753
	speed: 0.0143s/iter; left time: 263.0016s
	iters: 2100, epoch: 12 | loss: 0.5169530
	speed: 0.0137s/iter; left time: 251.8770s
	iters: 2200, epoch: 12 | loss: 0.5121169
	speed: 0.0135s/iter; left time: 245.4626s
Epoch: 12 cost time: 31.01250123977661
Epoch: 12, Steps: 2272 | Train Loss: 0.5001558 Vali Loss: 0.4475713 Test Loss: 0.1863628
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.3560869
	speed: 0.0575s/iter; left time: 1039.6448s
	iters: 200, epoch: 13 | loss: 0.5143415
	speed: 0.0121s/iter; left time: 217.2751s
	iters: 300, epoch: 13 | loss: 1.3461097
	speed: 0.0138s/iter; left time: 246.8375s
	iters: 400, epoch: 13 | loss: 0.3151931
	speed: 0.0140s/iter; left time: 248.6413s
	iters: 500, epoch: 13 | loss: 0.4861253
	speed: 0.0142s/iter; left time: 251.6150s
	iters: 600, epoch: 13 | loss: 0.3512137
	speed: 0.0138s/iter; left time: 242.7822s
	iters: 700, epoch: 13 | loss: 0.2829456
	speed: 0.0145s/iter; left time: 253.4497s
	iters: 800, epoch: 13 | loss: 0.3584033
	speed: 0.0156s/iter; left time: 270.4053s
	iters: 900, epoch: 13 | loss: 0.3899421
	speed: 0.0148s/iter; left time: 256.0912s
	iters: 1000, epoch: 13 | loss: 0.2346143
	speed: 0.0161s/iter; left time: 275.7829s
	iters: 1100, epoch: 13 | loss: 0.2213669
	speed: 0.0137s/iter; left time: 234.3260s
	iters: 1200, epoch: 13 | loss: 0.2309302
	speed: 0.0098s/iter; left time: 166.7477s
	iters: 1300, epoch: 13 | loss: 0.5979015
	speed: 0.0134s/iter; left time: 225.7343s
	iters: 1400, epoch: 13 | loss: 0.2674531
	speed: 0.0155s/iter; left time: 260.0960s
	iters: 1500, epoch: 13 | loss: 0.3595968
	speed: 0.0114s/iter; left time: 190.8227s
	iters: 1600, epoch: 13 | loss: 0.3330205
	speed: 0.0148s/iter; left time: 245.4146s
	iters: 1700, epoch: 13 | loss: 0.5706297
	speed: 0.0142s/iter; left time: 234.6790s
	iters: 1800, epoch: 13 | loss: 0.3361522
	speed: 0.0144s/iter; left time: 235.2527s
	iters: 1900, epoch: 13 | loss: 0.5521172
	speed: 0.0133s/iter; left time: 217.1609s
	iters: 2000, epoch: 13 | loss: 0.3655962
	speed: 0.0134s/iter; left time: 216.4813s
	iters: 2100, epoch: 13 | loss: 1.1407722
	speed: 0.0133s/iter; left time: 213.0803s
	iters: 2200, epoch: 13 | loss: 0.5783399
	speed: 0.0130s/iter; left time: 208.3617s
Epoch: 13 cost time: 31.15440845489502
Epoch: 13, Steps: 2272 | Train Loss: 0.4998558 Vali Loss: 0.4477756 Test Loss: 0.1864736
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.4505440
	speed: 0.0519s/iter; left time: 820.2287s
	iters: 200, epoch: 14 | loss: 0.5360574
	speed: 0.0142s/iter; left time: 223.4214s
	iters: 300, epoch: 14 | loss: 0.3557311
	speed: 0.0150s/iter; left time: 234.4421s
	iters: 400, epoch: 14 | loss: 0.5510663
	speed: 0.0152s/iter; left time: 234.9919s
	iters: 500, epoch: 14 | loss: 1.1379023
	speed: 0.0130s/iter; left time: 199.8301s
	iters: 600, epoch: 14 | loss: 1.2462071
	speed: 0.0131s/iter; left time: 200.5248s
	iters: 700, epoch: 14 | loss: 0.4384725
	speed: 0.0113s/iter; left time: 172.1440s
	iters: 800, epoch: 14 | loss: 0.5507089
	speed: 0.0139s/iter; left time: 209.7244s
	iters: 900, epoch: 14 | loss: 0.2888482
	speed: 0.0130s/iter; left time: 195.3994s
	iters: 1000, epoch: 14 | loss: 0.4686657
	speed: 0.0154s/iter; left time: 229.9417s
	iters: 1100, epoch: 14 | loss: 0.3361624
	speed: 0.0137s/iter; left time: 202.4381s
	iters: 1200, epoch: 14 | loss: 0.3200198
	speed: 0.0147s/iter; left time: 216.5933s
	iters: 1300, epoch: 14 | loss: 0.3645919
	speed: 0.0144s/iter; left time: 210.4805s
	iters: 1400, epoch: 14 | loss: 0.2972458
	speed: 0.0157s/iter; left time: 228.2115s
	iters: 1500, epoch: 14 | loss: 0.3608256
	speed: 0.0139s/iter; left time: 199.6794s
	iters: 1600, epoch: 14 | loss: 0.3187586
	speed: 0.0158s/iter; left time: 225.3207s
	iters: 1700, epoch: 14 | loss: 0.5452929
	speed: 0.0153s/iter; left time: 217.6884s
	iters: 1800, epoch: 14 | loss: 0.6747271
	speed: 0.0148s/iter; left time: 208.3519s
	iters: 1900, epoch: 14 | loss: 0.3548583
	speed: 0.0128s/iter; left time: 178.9148s
	iters: 2000, epoch: 14 | loss: 0.3048481
	speed: 0.0133s/iter; left time: 184.6853s
	iters: 2100, epoch: 14 | loss: 0.3870917
	speed: 0.0134s/iter; left time: 184.3176s
	iters: 2200, epoch: 14 | loss: 0.3323143
	speed: 0.0122s/iter; left time: 167.4049s
Epoch: 14 cost time: 31.6753830909729
Epoch: 14, Steps: 2272 | Train Loss: 0.4996722 Vali Loss: 0.4476911 Test Loss: 0.1864779
EarlyStopping counter: 3 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.3408275
	speed: 0.0511s/iter; left time: 691.9552s
	iters: 200, epoch: 15 | loss: 0.3486996
	speed: 0.0131s/iter; left time: 175.4706s
	iters: 300, epoch: 15 | loss: 0.9787000
	speed: 0.0130s/iter; left time: 173.4906s
	iters: 400, epoch: 15 | loss: 0.4838377
	speed: 0.0136s/iter; left time: 179.5223s
	iters: 500, epoch: 15 | loss: 0.2933544
	speed: 0.0110s/iter; left time: 144.7606s
	iters: 600, epoch: 15 | loss: 0.6202353
	speed: 0.0137s/iter; left time: 178.1662s
	iters: 700, epoch: 15 | loss: 0.2488283
	speed: 0.0131s/iter; left time: 169.1136s
	iters: 800, epoch: 15 | loss: 0.3415003
	speed: 0.0141s/iter; left time: 181.2426s
	iters: 900, epoch: 15 | loss: 0.4048515
	speed: 0.0150s/iter; left time: 190.4241s
	iters: 1000, epoch: 15 | loss: 0.5728211
	speed: 0.0141s/iter; left time: 178.5209s
	iters: 1100, epoch: 15 | loss: 0.4967312
	speed: 0.0136s/iter; left time: 170.2176s
	iters: 1200, epoch: 15 | loss: 0.2803361
	speed: 0.0113s/iter; left time: 140.7922s
	iters: 1300, epoch: 15 | loss: 0.3869040
	speed: 0.0133s/iter; left time: 164.5079s
	iters: 1400, epoch: 15 | loss: 0.4112434
	speed: 0.0147s/iter; left time: 179.7092s
	iters: 1500, epoch: 15 | loss: 0.3770168
	speed: 0.0141s/iter; left time: 170.5106s
	iters: 1600, epoch: 15 | loss: 0.4073901
	speed: 0.0139s/iter; left time: 166.7390s
	iters: 1700, epoch: 15 | loss: 0.2411551
	speed: 0.0139s/iter; left time: 166.2611s
	iters: 1800, epoch: 15 | loss: 0.3263942
	speed: 0.0138s/iter; left time: 162.7958s
	iters: 1900, epoch: 15 | loss: 0.8447862
	speed: 0.0122s/iter; left time: 143.1086s
	iters: 2000, epoch: 15 | loss: 0.3124003
	speed: 0.0132s/iter; left time: 153.9343s
	iters: 2100, epoch: 15 | loss: 0.3218340
	speed: 0.0124s/iter; left time: 142.9350s
	iters: 2200, epoch: 15 | loss: 1.6967613
	speed: 0.0136s/iter; left time: 155.0812s
Epoch: 15 cost time: 30.346975564956665
Epoch: 15, Steps: 2272 | Train Loss: 0.4996284 Vali Loss: 0.4477814 Test Loss: 0.1865053
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.3048911
	speed: 0.0568s/iter; left time: 640.1777s
	iters: 200, epoch: 16 | loss: 0.3355481
	speed: 0.0133s/iter; left time: 148.0214s
	iters: 300, epoch: 16 | loss: 0.3675973
	speed: 0.0133s/iter; left time: 147.4793s
	iters: 400, epoch: 16 | loss: 0.5481414
	speed: 0.0133s/iter; left time: 146.0264s
	iters: 500, epoch: 16 | loss: 0.4613172
	speed: 0.0145s/iter; left time: 157.6522s
	iters: 600, epoch: 16 | loss: 0.3655974
	speed: 0.0147s/iter; left time: 158.0889s
	iters: 700, epoch: 16 | loss: 0.3678716
	speed: 0.0142s/iter; left time: 150.9357s
	iters: 800, epoch: 16 | loss: 0.4123681
	speed: 0.0143s/iter; left time: 150.5605s
	iters: 900, epoch: 16 | loss: 0.7991325
	speed: 0.0135s/iter; left time: 141.6135s
	iters: 1000, epoch: 16 | loss: 0.3478331
	speed: 0.0128s/iter; left time: 132.2332s
	iters: 1100, epoch: 16 | loss: 0.3710152
	speed: 0.0147s/iter; left time: 150.6773s
	iters: 1200, epoch: 16 | loss: 0.4055266
	speed: 0.0134s/iter; left time: 135.7292s
	iters: 1300, epoch: 16 | loss: 1.2405385
	speed: 0.0150s/iter; left time: 151.1415s
	iters: 1400, epoch: 16 | loss: 0.4377676
	speed: 0.0132s/iter; left time: 131.8480s
	iters: 1500, epoch: 16 | loss: 0.4376299
	speed: 0.0128s/iter; left time: 126.5436s
	iters: 1600, epoch: 16 | loss: 0.3929600
	speed: 0.0126s/iter; left time: 123.3193s
	iters: 1700, epoch: 16 | loss: 0.2971278
	speed: 0.0141s/iter; left time: 135.9179s
	iters: 1800, epoch: 16 | loss: 0.5696241
	speed: 0.0113s/iter; left time: 108.3769s
	iters: 1900, epoch: 16 | loss: 0.4616444
	speed: 0.0117s/iter; left time: 110.2808s
	iters: 2000, epoch: 16 | loss: 0.4793855
	speed: 0.0118s/iter; left time: 110.0446s
	iters: 2100, epoch: 16 | loss: 0.3825201
	speed: 0.0109s/iter; left time: 100.8741s
	iters: 2200, epoch: 16 | loss: 0.2631272
	speed: 0.0132s/iter; left time: 120.9527s
Epoch: 16 cost time: 30.164310932159424
Epoch: 16, Steps: 2272 | Train Loss: 0.4995002 Vali Loss: 0.4476719 Test Loss: 0.1865144
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : weather_336_192_NLinear_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3293<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10348
mse:0.186850905418396, mae:0.23592224717140198
