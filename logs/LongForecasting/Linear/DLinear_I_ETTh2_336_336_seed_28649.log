Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTh2', data_path='ETTh2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='DLinear', model_id='ETTh2_336_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=336, root_path='./dataset/', save_pred_values=False, seed=28649, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTh2_336_336_DLinear_ETTh2_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed28649>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7969
val 2545
test 2545
Total number of trainable parameters: 1585248
Total number of parameters: 1585248
	iters: 100, epoch: 1 | loss: 0.4562359
	speed: 0.0283s/iter; left time: 138.1754s
	iters: 200, epoch: 1 | loss: 0.5089158
	speed: 0.0279s/iter; left time: 133.2083s
Epoch: 1 cost time: 7.0578413009643555
Epoch: 1, Steps: 249 | Train Loss: 0.6959273 Vali Loss: 0.6713508 Test Loss: 1.1267954
Validation loss decreased (inf --> 0.671351).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.6344977
	speed: 0.0554s/iter; left time: 256.4831s
	iters: 200, epoch: 2 | loss: 0.5660169
	speed: 0.0308s/iter; left time: 139.7807s
Epoch: 2 cost time: 7.495745658874512
Epoch: 2, Steps: 249 | Train Loss: 0.6649012 Vali Loss: 0.6064266 Test Loss: 0.9709957
Validation loss decreased (0.671351 --> 0.606427).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.5092506
	speed: 0.0558s/iter; left time: 244.4743s
	iters: 200, epoch: 3 | loss: 0.3921522
	speed: 0.0316s/iter; left time: 135.1783s
Epoch: 3 cost time: 7.537873983383179
Epoch: 3, Steps: 249 | Train Loss: 0.5834106 Vali Loss: 0.5429308 Test Loss: 0.9500856
Validation loss decreased (0.606427 --> 0.542931).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.7139230
	speed: 0.0547s/iter; left time: 225.9877s
	iters: 200, epoch: 4 | loss: 0.4277343
	speed: 0.0295s/iter; left time: 119.1408s
Epoch: 4 cost time: 7.22666335105896
Epoch: 4, Steps: 249 | Train Loss: 0.5461976 Vali Loss: 0.5571335 Test Loss: 0.9995634
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.5606502
	speed: 0.0520s/iter; left time: 201.8540s
	iters: 200, epoch: 5 | loss: 0.7866928
	speed: 0.0296s/iter; left time: 111.8917s
Epoch: 5 cost time: 7.298394680023193
Epoch: 5, Steps: 249 | Train Loss: 0.5303303 Vali Loss: 0.5184023 Test Loss: 0.7570078
Validation loss decreased (0.542931 --> 0.518402).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.5502009
	speed: 0.0560s/iter; left time: 203.6407s
	iters: 200, epoch: 6 | loss: 0.4320599
	speed: 0.0298s/iter; left time: 105.3788s
Epoch: 6 cost time: 7.31920599937439
Epoch: 6, Steps: 249 | Train Loss: 0.5212286 Vali Loss: 0.4790474 Test Loss: 0.6707919
Validation loss decreased (0.518402 --> 0.479047).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.3151802
	speed: 0.0579s/iter; left time: 195.9623s
	iters: 200, epoch: 7 | loss: 0.2828361
	speed: 0.0302s/iter; left time: 99.3309s
Epoch: 7 cost time: 7.257189512252808
Epoch: 7, Steps: 249 | Train Loss: 0.5165072 Vali Loss: 0.4845634 Test Loss: 0.6926702
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.7323089
	speed: 0.0500s/iter; left time: 156.9594s
	iters: 200, epoch: 8 | loss: 0.5081476
	speed: 0.0268s/iter; left time: 81.2672s
Epoch: 8 cost time: 6.561734437942505
Epoch: 8, Steps: 249 | Train Loss: 0.5141221 Vali Loss: 0.4795247 Test Loss: 0.6955950
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.6162172
	speed: 0.0480s/iter; left time: 138.7913s
	iters: 200, epoch: 9 | loss: 0.4448288
	speed: 0.0270s/iter; left time: 75.3094s
Epoch: 9 cost time: 6.5956902503967285
Epoch: 9, Steps: 249 | Train Loss: 0.5126688 Vali Loss: 0.4881132 Test Loss: 0.7288623
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.4233744
	speed: 0.0478s/iter; left time: 126.1826s
	iters: 200, epoch: 10 | loss: 0.4423500
	speed: 0.0265s/iter; left time: 67.2746s
Epoch: 10 cost time: 6.505711317062378
Epoch: 10, Steps: 249 | Train Loss: 0.5119825 Vali Loss: 0.4872636 Test Loss: 0.7300712
EarlyStopping counter: 4 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.8443261
	speed: 0.0419s/iter; left time: 100.2969s
	iters: 200, epoch: 11 | loss: 0.7533225
	speed: 0.0163s/iter; left time: 37.3684s
Epoch: 11 cost time: 4.485171318054199
Epoch: 11, Steps: 249 | Train Loss: 0.5115741 Vali Loss: 0.4827711 Test Loss: 0.7091628
EarlyStopping counter: 5 out of 5
Early stopping
Total training time: 86.6546 seconds
>>>>>>>testing : ETTh2_336_336_DLinear_ETTh2_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed28649<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2545
mse:0.6688424944877625, mae:0.5410904884338379
