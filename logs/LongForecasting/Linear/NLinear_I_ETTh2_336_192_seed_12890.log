Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTh2', data_path='ETTh2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='NLinear', model_id='ETTh2_336_192', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=192, root_path='./dataset/', save_pred_values=False, seed=12890, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTh2_336_192_NLinear_ETTh2_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed12890>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8113
val 2689
test 2689
Total number of trainable parameters: 452928
Total number of parameters: 452928
	iters: 100, epoch: 1 | loss: 0.5216003
	speed: 0.0110s/iter; left time: 54.7622s
	iters: 200, epoch: 1 | loss: 0.7906928
	speed: 0.0104s/iter; left time: 50.4857s
Epoch: 1 cost time: 2.6625185012817383
Epoch: 1, Steps: 253 | Train Loss: 0.6334045 Vali Loss: 0.4353195 Test Loss: 0.4261209
Validation loss decreased (inf --> 0.435319).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.5143437
	speed: 0.0221s/iter; left time: 103.9969s
	iters: 200, epoch: 2 | loss: 0.5731225
	speed: 0.0100s/iter; left time: 45.8529s
Epoch: 2 cost time: 2.520846128463745
Epoch: 2, Steps: 253 | Train Loss: 0.6006445 Vali Loss: 0.3648218 Test Loss: 0.3767403
Validation loss decreased (0.435319 --> 0.364822).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.4872122
	speed: 0.0204s/iter; left time: 91.0081s
	iters: 200, epoch: 3 | loss: 0.6054460
	speed: 0.0099s/iter; left time: 43.3261s
Epoch: 3 cost time: 2.4922401905059814
Epoch: 3, Steps: 253 | Train Loss: 0.5231976 Vali Loss: 0.3007343 Test Loss: 0.3720432
Validation loss decreased (0.364822 --> 0.300734).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.3218512
	speed: 0.0208s/iter; left time: 87.4826s
	iters: 200, epoch: 4 | loss: 0.3918082
	speed: 0.0099s/iter; left time: 40.7476s
Epoch: 4 cost time: 2.4903297424316406
Epoch: 4, Steps: 253 | Train Loss: 0.4871136 Vali Loss: 0.3126601 Test Loss: 0.3656175
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.5522122
	speed: 0.0203s/iter; left time: 80.2469s
	iters: 200, epoch: 5 | loss: 0.3554152
	speed: 0.0095s/iter; left time: 36.7221s
Epoch: 5 cost time: 2.4897706508636475
Epoch: 5, Steps: 253 | Train Loss: 0.4757139 Vali Loss: 0.3329571 Test Loss: 0.3614264
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.3735869
	speed: 0.0190s/iter; left time: 70.1813s
	iters: 200, epoch: 6 | loss: 0.5570365
	speed: 0.0095s/iter; left time: 34.2450s
Epoch: 6 cost time: 2.4305689334869385
Epoch: 6, Steps: 253 | Train Loss: 0.4693336 Vali Loss: 0.3059396 Test Loss: 0.3491900
EarlyStopping counter: 3 out of 5
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.4555447
	speed: 0.0197s/iter; left time: 67.8843s
	iters: 200, epoch: 7 | loss: 0.6538430
	speed: 0.0094s/iter; left time: 31.5004s
Epoch: 7 cost time: 2.427151679992676
Epoch: 7, Steps: 253 | Train Loss: 0.4650784 Vali Loss: 0.2999329 Test Loss: 0.3474098
Validation loss decreased (0.300734 --> 0.299933).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.7533434
	speed: 0.0215s/iter; left time: 68.6721s
	iters: 200, epoch: 8 | loss: 0.4202833
	speed: 0.0097s/iter; left time: 30.0286s
Epoch: 8 cost time: 2.45992374420166
Epoch: 8, Steps: 253 | Train Loss: 0.4636208 Vali Loss: 0.3066922 Test Loss: 0.3450410
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.8470544
	speed: 0.0198s/iter; left time: 58.1963s
	iters: 200, epoch: 9 | loss: 0.3322871
	speed: 0.0100s/iter; left time: 28.2334s
Epoch: 9 cost time: 2.4643478393554688
Epoch: 9, Steps: 253 | Train Loss: 0.4630714 Vali Loss: 0.3046249 Test Loss: 0.3455839
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.5274686
	speed: 0.0187s/iter; left time: 50.3032s
	iters: 200, epoch: 10 | loss: 0.4110724
	speed: 0.0091s/iter; left time: 23.6168s
Epoch: 10 cost time: 2.2453200817108154
Epoch: 10, Steps: 253 | Train Loss: 0.4617238 Vali Loss: 0.3037230 Test Loss: 0.3454164
EarlyStopping counter: 3 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.4316923
	speed: 0.0154s/iter; left time: 37.4569s
	iters: 200, epoch: 11 | loss: 0.3561934
	speed: 0.0071s/iter; left time: 16.5653s
Epoch: 11 cost time: 1.7334873676300049
Epoch: 11, Steps: 253 | Train Loss: 0.4620644 Vali Loss: 0.3034812 Test Loss: 0.3454451
EarlyStopping counter: 4 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.5865235
	speed: 0.0120s/iter; left time: 26.0498s
	iters: 200, epoch: 12 | loss: 0.5737187
	speed: 0.0054s/iter; left time: 11.3053s
Epoch: 12 cost time: 1.4103000164031982
Epoch: 12, Steps: 253 | Train Loss: 0.4621596 Vali Loss: 0.3037878 Test Loss: 0.3453239
EarlyStopping counter: 5 out of 5
Early stopping
Total training time: 33.7320 seconds
>>>>>>>testing : ETTh2_336_192_NLinear_ETTh2_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed12890<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2689
mse:0.3436116576194763, mae:0.38601458072662354
