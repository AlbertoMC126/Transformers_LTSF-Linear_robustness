Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.005, loss='mse', lradj='type1', model='NLinear', model_id='weather_96_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=15227, seq_len=96, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_96_96_NLinear_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15227>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36696
val 5175
test 10444
Total number of trainable parameters: 195552
Total number of parameters: 195552
	iters: 100, epoch: 1 | loss: 0.6884232
	speed: 0.0810s/iter; left time: 3707.7293s
	iters: 200, epoch: 1 | loss: 0.3378391
	speed: 0.0318s/iter; left time: 1453.4320s
	iters: 300, epoch: 1 | loss: 0.2955257
	speed: 0.0319s/iter; left time: 1451.4795s
	iters: 400, epoch: 1 | loss: 0.2813297
	speed: 0.0317s/iter; left time: 1443.0944s
	iters: 500, epoch: 1 | loss: 0.3347059
	speed: 0.0316s/iter; left time: 1433.4481s
	iters: 600, epoch: 1 | loss: 0.3739062
	speed: 0.0317s/iter; left time: 1435.0933s
	iters: 700, epoch: 1 | loss: 1.5639178
	speed: 0.0317s/iter; left time: 1432.2961s
	iters: 800, epoch: 1 | loss: 0.3475521
	speed: 0.0315s/iter; left time: 1420.5948s
	iters: 900, epoch: 1 | loss: 0.4958408
	speed: 0.0314s/iter; left time: 1411.6301s
	iters: 1000, epoch: 1 | loss: 0.3812086
	speed: 0.0317s/iter; left time: 1422.4665s
	iters: 1100, epoch: 1 | loss: 0.4109424
	speed: 0.0317s/iter; left time: 1418.2086s
	iters: 1200, epoch: 1 | loss: 0.2432278
	speed: 0.0317s/iter; left time: 1417.0428s
	iters: 1300, epoch: 1 | loss: 0.4646552
	speed: 0.0318s/iter; left time: 1416.5732s
	iters: 1400, epoch: 1 | loss: 0.5645570
	speed: 0.0315s/iter; left time: 1399.6473s
	iters: 1500, epoch: 1 | loss: 0.3890727
	speed: 0.0315s/iter; left time: 1398.1106s
	iters: 1600, epoch: 1 | loss: 0.8954775
	speed: 0.0315s/iter; left time: 1392.2063s
	iters: 1700, epoch: 1 | loss: 0.7535147
	speed: 0.0316s/iter; left time: 1395.5440s
	iters: 1800, epoch: 1 | loss: 0.3056976
	speed: 0.0317s/iter; left time: 1397.5011s
	iters: 1900, epoch: 1 | loss: 0.3740442
	speed: 0.0316s/iter; left time: 1387.4606s
	iters: 2000, epoch: 1 | loss: 0.6528362
	speed: 0.0314s/iter; left time: 1375.7479s
	iters: 2100, epoch: 1 | loss: 0.3849458
	speed: 0.0316s/iter; left time: 1383.6397s
	iters: 2200, epoch: 1 | loss: 0.3018799
	speed: 0.0314s/iter; left time: 1369.0846s
Epoch: 1 cost time: 77.44091939926147
Epoch: 1, Steps: 2293 | Train Loss: 0.7884754 Vali Loss: 0.4687499 Test Loss: 0.1893677
Validation loss decreased (inf --> 0.468750).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 4.1858745
	speed: 0.1092s/iter; left time: 4745.9582s
	iters: 200, epoch: 2 | loss: 0.7903665
	speed: 0.0318s/iter; left time: 1377.7179s
	iters: 300, epoch: 2 | loss: 0.3991653
	speed: 0.0315s/iter; left time: 1362.7659s
	iters: 400, epoch: 2 | loss: 0.5049204
	speed: 0.0316s/iter; left time: 1364.2488s
	iters: 500, epoch: 2 | loss: 0.6278005
	speed: 0.0315s/iter; left time: 1358.3913s
	iters: 600, epoch: 2 | loss: 0.3371293
	speed: 0.0316s/iter; left time: 1357.0971s
	iters: 700, epoch: 2 | loss: 0.8736153
	speed: 0.0315s/iter; left time: 1348.7350s
	iters: 800, epoch: 2 | loss: 2.5287457
	speed: 0.0316s/iter; left time: 1352.7358s
	iters: 900, epoch: 2 | loss: 0.4255731
	speed: 0.0316s/iter; left time: 1346.2595s
	iters: 1000, epoch: 2 | loss: 0.3860223
	speed: 0.0314s/iter; left time: 1338.1945s
	iters: 1100, epoch: 2 | loss: 0.2720389
	speed: 0.0317s/iter; left time: 1346.7542s
	iters: 1200, epoch: 2 | loss: 0.3639351
	speed: 0.0314s/iter; left time: 1330.4990s
	iters: 1300, epoch: 2 | loss: 0.2632878
	speed: 0.0317s/iter; left time: 1338.3004s
	iters: 1400, epoch: 2 | loss: 0.4105895
	speed: 0.0317s/iter; left time: 1338.8077s
	iters: 1500, epoch: 2 | loss: 1.7334521
	speed: 0.0317s/iter; left time: 1331.8210s
	iters: 1600, epoch: 2 | loss: 0.4801637
	speed: 0.0315s/iter; left time: 1319.9333s
	iters: 1700, epoch: 2 | loss: 0.2474197
	speed: 0.0317s/iter; left time: 1325.6496s
	iters: 1800, epoch: 2 | loss: 0.2910538
	speed: 0.0318s/iter; left time: 1327.2800s
	iters: 1900, epoch: 2 | loss: 0.6711460
	speed: 0.0315s/iter; left time: 1314.5128s
	iters: 2000, epoch: 2 | loss: 0.4828886
	speed: 0.0317s/iter; left time: 1316.4139s
	iters: 2100, epoch: 2 | loss: 0.4291458
	speed: 0.0317s/iter; left time: 1314.9944s
	iters: 2200, epoch: 2 | loss: 2.1999059
	speed: 0.0316s/iter; left time: 1307.8881s
Epoch: 2 cost time: 72.37686610221863
Epoch: 2, Steps: 2293 | Train Loss: 4.2389025 Vali Loss: 0.4878715 Test Loss: 0.1854743
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.2878432
	speed: 0.1095s/iter; left time: 4507.3275s
	iters: 200, epoch: 3 | loss: 0.5766357
	speed: 0.0318s/iter; left time: 1306.6636s
	iters: 300, epoch: 3 | loss: 0.3482334
	speed: 0.0316s/iter; left time: 1293.1836s
	iters: 400, epoch: 3 | loss: 0.2515611
	speed: 0.0316s/iter; left time: 1291.8608s
	iters: 500, epoch: 3 | loss: 1.8026671
	speed: 0.0316s/iter; left time: 1288.0796s
	iters: 600, epoch: 3 | loss: 0.4049791
	speed: 0.0317s/iter; left time: 1289.8042s
	iters: 700, epoch: 3 | loss: 0.2676718
	speed: 0.0317s/iter; left time: 1286.6758s
	iters: 800, epoch: 3 | loss: 0.5157239
	speed: 0.0316s/iter; left time: 1279.2243s
	iters: 900, epoch: 3 | loss: 0.2513570
	speed: 0.0316s/iter; left time: 1276.5702s
	iters: 1000, epoch: 3 | loss: 0.5051273
	speed: 0.0314s/iter; left time: 1263.9046s
	iters: 1100, epoch: 3 | loss: 0.3435413
	speed: 0.0318s/iter; left time: 1276.7905s
	iters: 1200, epoch: 3 | loss: 0.4262717
	speed: 0.0316s/iter; left time: 1264.8122s
	iters: 1300, epoch: 3 | loss: 0.2745452
	speed: 0.0316s/iter; left time: 1264.5636s
	iters: 1400, epoch: 3 | loss: 0.2591135
	speed: 0.0313s/iter; left time: 1248.8207s
	iters: 1500, epoch: 3 | loss: 0.2802935
	speed: 0.0314s/iter; left time: 1246.9558s
	iters: 1600, epoch: 3 | loss: 0.3888554
	speed: 0.0313s/iter; left time: 1243.4535s
	iters: 1700, epoch: 3 | loss: 0.3077179
	speed: 0.0314s/iter; left time: 1241.3811s
	iters: 1800, epoch: 3 | loss: 0.4246822
	speed: 0.0314s/iter; left time: 1239.5510s
	iters: 1900, epoch: 3 | loss: 0.3007738
	speed: 0.0316s/iter; left time: 1243.1489s
	iters: 2000, epoch: 3 | loss: 0.3981591
	speed: 0.0316s/iter; left time: 1239.9463s
	iters: 2100, epoch: 3 | loss: 0.4438896
	speed: 0.0312s/iter; left time: 1224.0342s
	iters: 2200, epoch: 3 | loss: 1.2808098
	speed: 0.0313s/iter; left time: 1223.0171s
Epoch: 3 cost time: 72.25821185112
Epoch: 3, Steps: 2293 | Train Loss: 2.3328776 Vali Loss: 0.4356144 Test Loss: 0.1723733
Validation loss decreased (0.468750 --> 0.435614).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.2689140
	speed: 0.1103s/iter; left time: 4289.0964s
	iters: 200, epoch: 4 | loss: 0.6008437
	speed: 0.0317s/iter; left time: 1231.0369s
	iters: 300, epoch: 4 | loss: 0.2668267
	speed: 0.0318s/iter; left time: 1229.0371s
	iters: 400, epoch: 4 | loss: 0.2891075
	speed: 0.0316s/iter; left time: 1217.4175s
	iters: 500, epoch: 4 | loss: 0.3042192
	speed: 0.0315s/iter; left time: 1211.8651s
	iters: 600, epoch: 4 | loss: 0.2280461
	speed: 0.0314s/iter; left time: 1204.4246s
	iters: 700, epoch: 4 | loss: 0.1953886
	speed: 0.0314s/iter; left time: 1201.8466s
	iters: 800, epoch: 4 | loss: 0.3577982
	speed: 0.0314s/iter; left time: 1198.6739s
	iters: 900, epoch: 4 | loss: 0.5979754
	speed: 0.0315s/iter; left time: 1199.2188s
	iters: 1000, epoch: 4 | loss: 0.3154661
	speed: 0.0316s/iter; left time: 1199.6527s
	iters: 1100, epoch: 4 | loss: 0.4554789
	speed: 0.0315s/iter; left time: 1191.9420s
	iters: 1200, epoch: 4 | loss: 0.2058556
	speed: 0.0316s/iter; left time: 1194.9603s
	iters: 1300, epoch: 4 | loss: 0.3023244
	speed: 0.0317s/iter; left time: 1193.0992s
	iters: 1400, epoch: 4 | loss: 0.2428298
	speed: 0.0314s/iter; left time: 1178.7781s
	iters: 1500, epoch: 4 | loss: 0.7375561
	speed: 0.0316s/iter; left time: 1185.8303s
	iters: 1600, epoch: 4 | loss: 0.3283259
	speed: 0.0315s/iter; left time: 1179.0247s
	iters: 1700, epoch: 4 | loss: 1.4399558
	speed: 0.0315s/iter; left time: 1175.8164s
	iters: 1800, epoch: 4 | loss: 0.8561036
	speed: 0.0316s/iter; left time: 1174.6754s
	iters: 1900, epoch: 4 | loss: 0.2812373
	speed: 0.0318s/iter; left time: 1177.4741s
	iters: 2000, epoch: 4 | loss: 0.3080925
	speed: 0.0314s/iter; left time: 1161.2116s
	iters: 2100, epoch: 4 | loss: 3.8660116
	speed: 0.0316s/iter; left time: 1164.5417s
	iters: 2200, epoch: 4 | loss: 0.4528512
	speed: 0.0316s/iter; left time: 1162.9592s
Epoch: 4 cost time: 72.25648021697998
Epoch: 4, Steps: 2293 | Train Loss: 0.6103305 Vali Loss: 0.4308220 Test Loss: 0.1673966
Validation loss decreased (0.435614 --> 0.430822).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.3112960
	speed: 0.1098s/iter; left time: 4016.4992s
	iters: 200, epoch: 5 | loss: 0.2863389
	speed: 0.0316s/iter; left time: 1152.3992s
	iters: 300, epoch: 5 | loss: 0.2825496
	speed: 0.0317s/iter; left time: 1152.4678s
	iters: 400, epoch: 5 | loss: 0.3731332
	speed: 0.0317s/iter; left time: 1149.5133s
	iters: 500, epoch: 5 | loss: 0.2754714
	speed: 0.0313s/iter; left time: 1134.4047s
	iters: 600, epoch: 5 | loss: 0.2839839
	speed: 0.0316s/iter; left time: 1139.9221s
	iters: 700, epoch: 5 | loss: 0.6086457
	speed: 0.0316s/iter; left time: 1135.8495s
	iters: 800, epoch: 5 | loss: 0.3342288
	speed: 0.0316s/iter; left time: 1135.3026s
	iters: 900, epoch: 5 | loss: 0.6663885
	speed: 0.0316s/iter; left time: 1131.6439s
	iters: 1000, epoch: 5 | loss: 0.2238809
	speed: 0.0317s/iter; left time: 1132.4251s
	iters: 1100, epoch: 5 | loss: 0.2777659
	speed: 0.0315s/iter; left time: 1121.9431s
	iters: 1200, epoch: 5 | loss: 0.2554904
	speed: 0.0317s/iter; left time: 1123.2831s
	iters: 1300, epoch: 5 | loss: 0.5221960
	speed: 0.0317s/iter; left time: 1122.0338s
	iters: 1400, epoch: 5 | loss: 0.4024841
	speed: 0.0317s/iter; left time: 1116.9881s
	iters: 1500, epoch: 5 | loss: 0.4698840
	speed: 0.0315s/iter; left time: 1109.2253s
	iters: 1600, epoch: 5 | loss: 0.6470939
	speed: 0.0317s/iter; left time: 1113.8342s
	iters: 1700, epoch: 5 | loss: 0.2650767
	speed: 0.0317s/iter; left time: 1107.4276s
	iters: 1800, epoch: 5 | loss: 0.4199392
	speed: 0.0316s/iter; left time: 1102.4722s
	iters: 1900, epoch: 5 | loss: 0.2731262
	speed: 0.0317s/iter; left time: 1102.5645s
	iters: 2000, epoch: 5 | loss: 0.6621032
	speed: 0.0315s/iter; left time: 1094.1614s
	iters: 2100, epoch: 5 | loss: 0.3107881
	speed: 0.0318s/iter; left time: 1098.4600s
	iters: 2200, epoch: 5 | loss: 0.2725600
	speed: 0.0318s/iter; left time: 1097.1881s
Epoch: 5 cost time: 72.45986914634705
Epoch: 5, Steps: 2293 | Train Loss: 0.5343146 Vali Loss: 0.4228448 Test Loss: 0.1651011
Validation loss decreased (0.430822 --> 0.422845).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.4206562
	speed: 0.1107s/iter; left time: 3795.5591s
	iters: 200, epoch: 6 | loss: 0.3528061
	speed: 0.0316s/iter; left time: 1081.8258s
	iters: 300, epoch: 6 | loss: 0.2966578
	speed: 0.0313s/iter; left time: 1068.6198s
	iters: 400, epoch: 6 | loss: 0.4516071
	speed: 0.0315s/iter; left time: 1069.4249s
	iters: 500, epoch: 6 | loss: 0.3822613
	speed: 0.0318s/iter; left time: 1076.2699s
	iters: 600, epoch: 6 | loss: 0.3251255
	speed: 0.0314s/iter; left time: 1062.5109s
	iters: 700, epoch: 6 | loss: 0.2145683
	speed: 0.0316s/iter; left time: 1063.8330s
	iters: 800, epoch: 6 | loss: 0.2187743
	speed: 0.0314s/iter; left time: 1054.4586s
	iters: 900, epoch: 6 | loss: 2.1772065
	speed: 0.0317s/iter; left time: 1060.2996s
	iters: 1000, epoch: 6 | loss: 0.3429416
	speed: 0.0315s/iter; left time: 1051.9074s
	iters: 1100, epoch: 6 | loss: 0.5821292
	speed: 0.0314s/iter; left time: 1044.6302s
	iters: 1200, epoch: 6 | loss: 0.2848978
	speed: 0.0314s/iter; left time: 1042.0055s
	iters: 1300, epoch: 6 | loss: 0.2769946
	speed: 0.0316s/iter; left time: 1045.6875s
	iters: 1400, epoch: 6 | loss: 0.2723807
	speed: 0.0315s/iter; left time: 1040.6437s
	iters: 1500, epoch: 6 | loss: 0.2030703
	speed: 0.0314s/iter; left time: 1033.5996s
	iters: 1600, epoch: 6 | loss: 0.2560680
	speed: 0.0314s/iter; left time: 1029.5540s
	iters: 1700, epoch: 6 | loss: 3.5035813
	speed: 0.0314s/iter; left time: 1027.4742s
	iters: 1800, epoch: 6 | loss: 0.3499373
	speed: 0.0316s/iter; left time: 1030.0623s
	iters: 1900, epoch: 6 | loss: 0.3732660
	speed: 0.0315s/iter; left time: 1024.5298s
	iters: 2000, epoch: 6 | loss: 0.3385405
	speed: 0.0316s/iter; left time: 1022.2406s
	iters: 2100, epoch: 6 | loss: 0.6331428
	speed: 0.0316s/iter; left time: 1021.6752s
	iters: 2200, epoch: 6 | loss: 0.4242949
	speed: 0.0314s/iter; left time: 1011.8575s
Epoch: 6 cost time: 72.20687127113342
Epoch: 6, Steps: 2293 | Train Loss: 0.4680413 Vali Loss: 0.4219999 Test Loss: 0.1652166
Validation loss decreased (0.422845 --> 0.422000).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.1892024
	speed: 0.1105s/iter; left time: 3537.2031s
	iters: 200, epoch: 7 | loss: 0.4165743
	speed: 0.0319s/iter; left time: 1017.0540s
	iters: 300, epoch: 7 | loss: 0.2825654
	speed: 0.0316s/iter; left time: 1006.1980s
	iters: 400, epoch: 7 | loss: 0.3494846
	speed: 0.0316s/iter; left time: 1003.0971s
	iters: 500, epoch: 7 | loss: 0.5244654
	speed: 0.0315s/iter; left time: 996.2635s
	iters: 600, epoch: 7 | loss: 0.2391570
	speed: 0.0316s/iter; left time: 995.8500s
	iters: 700, epoch: 7 | loss: 0.3425584
	speed: 0.0316s/iter; left time: 993.6619s
	iters: 800, epoch: 7 | loss: 0.3392505
	speed: 0.0315s/iter; left time: 985.6566s
	iters: 900, epoch: 7 | loss: 0.2669389
	speed: 0.0316s/iter; left time: 985.7423s
	iters: 1000, epoch: 7 | loss: 0.5044054
	speed: 0.0315s/iter; left time: 980.1031s
	iters: 1100, epoch: 7 | loss: 0.3456135
	speed: 0.0314s/iter; left time: 975.0200s
	iters: 1200, epoch: 7 | loss: 0.3012567
	speed: 0.0315s/iter; left time: 972.5804s
	iters: 1300, epoch: 7 | loss: 0.8338787
	speed: 0.0314s/iter; left time: 968.2666s
	iters: 1400, epoch: 7 | loss: 0.8819658
	speed: 0.0316s/iter; left time: 970.5573s
	iters: 1500, epoch: 7 | loss: 0.2894338
	speed: 0.0317s/iter; left time: 969.0216s
	iters: 1600, epoch: 7 | loss: 0.4386347
	speed: 0.0317s/iter; left time: 966.3436s
	iters: 1700, epoch: 7 | loss: 0.2570091
	speed: 0.0316s/iter; left time: 960.2213s
	iters: 1800, epoch: 7 | loss: 0.3320772
	speed: 0.0316s/iter; left time: 956.1170s
	iters: 1900, epoch: 7 | loss: 0.2573838
	speed: 0.0317s/iter; left time: 957.9701s
	iters: 2000, epoch: 7 | loss: 0.4815301
	speed: 0.0316s/iter; left time: 951.1200s
	iters: 2100, epoch: 7 | loss: 0.5285398
	speed: 0.0315s/iter; left time: 944.3724s
	iters: 2200, epoch: 7 | loss: 0.2473957
	speed: 0.0316s/iter; left time: 944.1383s
Epoch: 7 cost time: 72.31190633773804
Epoch: 7, Steps: 2293 | Train Loss: 0.4642145 Vali Loss: 0.4176110 Test Loss: 0.1646983
Validation loss decreased (0.422000 --> 0.417611).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.2591672
	speed: 0.1116s/iter; left time: 3315.5658s
	iters: 200, epoch: 8 | loss: 0.3933711
	speed: 0.0318s/iter; left time: 942.3261s
	iters: 300, epoch: 8 | loss: 2.2229135
	speed: 0.0318s/iter; left time: 937.7577s
	iters: 400, epoch: 8 | loss: 0.3426405
	speed: 0.0317s/iter; left time: 931.3142s
	iters: 500, epoch: 8 | loss: 0.2321611
	speed: 0.0318s/iter; left time: 931.0837s
	iters: 600, epoch: 8 | loss: 0.4500818
	speed: 0.0318s/iter; left time: 928.7876s
	iters: 700, epoch: 8 | loss: 0.3457160
	speed: 0.0315s/iter; left time: 916.9022s
	iters: 800, epoch: 8 | loss: 0.4307419
	speed: 0.0314s/iter; left time: 912.1280s
	iters: 900, epoch: 8 | loss: 0.3853004
	speed: 0.0316s/iter; left time: 912.5414s
	iters: 1000, epoch: 8 | loss: 0.3346416
	speed: 0.0317s/iter; left time: 913.3964s
	iters: 1100, epoch: 8 | loss: 0.3358457
	speed: 0.0314s/iter; left time: 902.6229s
	iters: 1200, epoch: 8 | loss: 0.4021493
	speed: 0.0317s/iter; left time: 905.5561s
	iters: 1300, epoch: 8 | loss: 0.3646614
	speed: 0.0317s/iter; left time: 903.0154s
	iters: 1400, epoch: 8 | loss: 0.3148155
	speed: 0.0316s/iter; left time: 897.9995s
	iters: 1500, epoch: 8 | loss: 0.3301813
	speed: 0.0314s/iter; left time: 888.6501s
	iters: 1600, epoch: 8 | loss: 0.3289098
	speed: 0.0317s/iter; left time: 895.0527s
	iters: 1700, epoch: 8 | loss: 0.3637629
	speed: 0.0315s/iter; left time: 886.3938s
	iters: 1800, epoch: 8 | loss: 0.4337116
	speed: 0.0317s/iter; left time: 886.8731s
	iters: 1900, epoch: 8 | loss: 0.4071752
	speed: 0.0316s/iter; left time: 881.4335s
	iters: 2000, epoch: 8 | loss: 0.6640783
	speed: 0.0315s/iter; left time: 875.1737s
	iters: 2100, epoch: 8 | loss: 0.3668402
	speed: 0.0315s/iter; left time: 873.9835s
	iters: 2200, epoch: 8 | loss: 0.2837077
	speed: 0.0313s/iter; left time: 864.7453s
Epoch: 8 cost time: 72.37013459205627
Epoch: 8, Steps: 2293 | Train Loss: 0.4631342 Vali Loss: 0.4205788 Test Loss: 0.1646146
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.3631687
	speed: 0.1099s/iter; left time: 3014.0534s
	iters: 200, epoch: 9 | loss: 0.3062468
	speed: 0.0316s/iter; left time: 862.7667s
	iters: 300, epoch: 9 | loss: 0.2029859
	speed: 0.0314s/iter; left time: 853.4104s
	iters: 400, epoch: 9 | loss: 0.2165340
	speed: 0.0317s/iter; left time: 860.3646s
	iters: 500, epoch: 9 | loss: 0.3353098
	speed: 0.0316s/iter; left time: 854.4612s
	iters: 600, epoch: 9 | loss: 0.2219403
	speed: 0.0315s/iter; left time: 848.5424s
	iters: 700, epoch: 9 | loss: 0.2798576
	speed: 0.0316s/iter; left time: 848.7486s
	iters: 800, epoch: 9 | loss: 0.4993061
	speed: 0.0314s/iter; left time: 838.4777s
	iters: 900, epoch: 9 | loss: 0.4601257
	speed: 0.0318s/iter; left time: 846.2186s
	iters: 1000, epoch: 9 | loss: 0.2849667
	speed: 0.0317s/iter; left time: 840.1170s
	iters: 1100, epoch: 9 | loss: 0.2978234
	speed: 0.0315s/iter; left time: 831.5935s
	iters: 1200, epoch: 9 | loss: 1.0843570
	speed: 0.0315s/iter; left time: 828.4390s
	iters: 1300, epoch: 9 | loss: 0.7879841
	speed: 0.0314s/iter; left time: 824.1730s
	iters: 1400, epoch: 9 | loss: 0.2650270
	speed: 0.0315s/iter; left time: 821.7747s
	iters: 1500, epoch: 9 | loss: 0.1972494
	speed: 0.0316s/iter; left time: 821.2224s
	iters: 1600, epoch: 9 | loss: 0.4709768
	speed: 0.0312s/iter; left time: 807.8631s
	iters: 1700, epoch: 9 | loss: 0.7474804
	speed: 0.0316s/iter; left time: 814.5813s
	iters: 1800, epoch: 9 | loss: 0.3256295
	speed: 0.0314s/iter; left time: 808.7369s
	iters: 1900, epoch: 9 | loss: 0.2272519
	speed: 0.0316s/iter; left time: 810.5289s
	iters: 2000, epoch: 9 | loss: 1.1975534
	speed: 0.0314s/iter; left time: 800.7168s
	iters: 2100, epoch: 9 | loss: 0.2567911
	speed: 0.0317s/iter; left time: 805.1976s
	iters: 2200, epoch: 9 | loss: 1.6134002
	speed: 0.0317s/iter; left time: 802.6645s
Epoch: 9 cost time: 72.23542094230652
Epoch: 9, Steps: 2293 | Train Loss: 0.4600203 Vali Loss: 0.4206040 Test Loss: 0.1644522
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.3289765
	speed: 0.1101s/iter; left time: 2765.4496s
	iters: 200, epoch: 10 | loss: 0.2742203
	speed: 0.0318s/iter; left time: 796.8824s
	iters: 300, epoch: 10 | loss: 0.3472721
	speed: 0.0315s/iter; left time: 785.8092s
	iters: 400, epoch: 10 | loss: 0.3005777
	speed: 0.0316s/iter; left time: 784.8859s
	iters: 500, epoch: 10 | loss: 0.3192061
	speed: 0.0316s/iter; left time: 782.3818s
	iters: 600, epoch: 10 | loss: 0.2753057
	speed: 0.0316s/iter; left time: 777.1826s
	iters: 700, epoch: 10 | loss: 0.3491198
	speed: 0.0318s/iter; left time: 779.4143s
	iters: 800, epoch: 10 | loss: 0.2677034
	speed: 0.0319s/iter; left time: 778.0083s
	iters: 900, epoch: 10 | loss: 0.2734713
	speed: 0.0318s/iter; left time: 772.4795s
	iters: 1000, epoch: 10 | loss: 0.4053969
	speed: 0.0316s/iter; left time: 764.9366s
	iters: 1100, epoch: 10 | loss: 0.4337057
	speed: 0.0316s/iter; left time: 763.2381s
	iters: 1200, epoch: 10 | loss: 0.2563392
	speed: 0.0316s/iter; left time: 758.1527s
	iters: 1300, epoch: 10 | loss: 2.3578107
	speed: 0.0314s/iter; left time: 751.7486s
	iters: 1400, epoch: 10 | loss: 0.4133095
	speed: 0.0317s/iter; left time: 755.2619s
	iters: 1500, epoch: 10 | loss: 0.3035533
	speed: 0.0316s/iter; left time: 748.5077s
	iters: 1600, epoch: 10 | loss: 0.3269652
	speed: 0.0315s/iter; left time: 744.6341s
	iters: 1700, epoch: 10 | loss: 0.3162488
	speed: 0.0317s/iter; left time: 745.6818s
	iters: 1800, epoch: 10 | loss: 0.3314979
	speed: 0.0317s/iter; left time: 742.3670s
	iters: 1900, epoch: 10 | loss: 0.2932796
	speed: 0.0316s/iter; left time: 738.1083s
	iters: 2000, epoch: 10 | loss: 0.2735682
	speed: 0.0316s/iter; left time: 734.9439s
	iters: 2100, epoch: 10 | loss: 0.4070925
	speed: 0.0318s/iter; left time: 734.7418s
	iters: 2200, epoch: 10 | loss: 0.3271884
	speed: 0.0317s/iter; left time: 728.8743s
Epoch: 10 cost time: 72.43722009658813
Epoch: 10, Steps: 2293 | Train Loss: 0.4591422 Vali Loss: 0.4207169 Test Loss: 0.1645103
EarlyStopping counter: 3 out of 5
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.3663533
	speed: 0.1090s/iter; left time: 2489.1445s
	iters: 200, epoch: 11 | loss: 0.2398235
	speed: 0.0316s/iter; left time: 718.0614s
	iters: 300, epoch: 11 | loss: 0.3879030
	speed: 0.0317s/iter; left time: 716.5197s
	iters: 400, epoch: 11 | loss: 0.3298889
	speed: 0.0316s/iter; left time: 712.6940s
	iters: 500, epoch: 11 | loss: 0.4880159
	speed: 0.0314s/iter; left time: 704.3938s
	iters: 600, epoch: 11 | loss: 0.4029079
	speed: 0.0317s/iter; left time: 707.1838s
	iters: 700, epoch: 11 | loss: 0.2849485
	speed: 0.0315s/iter; left time: 700.2016s
	iters: 800, epoch: 11 | loss: 0.6601108
	speed: 0.0316s/iter; left time: 699.9068s
	iters: 900, epoch: 11 | loss: 1.4766273
	speed: 0.0316s/iter; left time: 696.4824s
	iters: 1000, epoch: 11 | loss: 0.5064056
	speed: 0.0314s/iter; left time: 687.9169s
	iters: 1100, epoch: 11 | loss: 0.3540511
	speed: 0.0314s/iter; left time: 685.6992s
	iters: 1200, epoch: 11 | loss: 0.3349002
	speed: 0.0317s/iter; left time: 689.4427s
	iters: 1300, epoch: 11 | loss: 0.3040336
	speed: 0.0317s/iter; left time: 684.8408s
	iters: 1400, epoch: 11 | loss: 1.9872429
	speed: 0.0317s/iter; left time: 683.0179s
	iters: 1500, epoch: 11 | loss: 0.4381918
	speed: 0.0317s/iter; left time: 679.6291s
	iters: 1600, epoch: 11 | loss: 0.1958995
	speed: 0.0316s/iter; left time: 673.6426s
	iters: 1700, epoch: 11 | loss: 0.3462517
	speed: 0.0317s/iter; left time: 672.7852s
	iters: 1800, epoch: 11 | loss: 0.2850602
	speed: 0.0317s/iter; left time: 670.5614s
	iters: 1900, epoch: 11 | loss: 0.3104002
	speed: 0.0314s/iter; left time: 661.4213s
	iters: 2000, epoch: 11 | loss: 0.5040193
	speed: 0.0318s/iter; left time: 666.6329s
	iters: 2100, epoch: 11 | loss: 0.4412955
	speed: 0.0316s/iter; left time: 657.3167s
	iters: 2200, epoch: 11 | loss: 0.2757272
	speed: 0.0316s/iter; left time: 655.2903s
Epoch: 11 cost time: 72.29814791679382
Epoch: 11, Steps: 2293 | Train Loss: 0.4583305 Vali Loss: 0.4198005 Test Loss: 0.1645060
EarlyStopping counter: 4 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.6443771
	speed: 0.1037s/iter; left time: 2130.0160s
	iters: 200, epoch: 12 | loss: 0.3384551
	speed: 0.0282s/iter; left time: 576.0145s
	iters: 300, epoch: 12 | loss: 0.2642319
	speed: 0.0259s/iter; left time: 526.7295s
	iters: 400, epoch: 12 | loss: 0.2675286
	speed: 0.0256s/iter; left time: 518.8381s
	iters: 500, epoch: 12 | loss: 0.3117167
	speed: 0.0254s/iter; left time: 512.0586s
	iters: 600, epoch: 12 | loss: 0.7179693
	speed: 0.0254s/iter; left time: 508.1853s
	iters: 700, epoch: 12 | loss: 1.2481166
	speed: 0.0251s/iter; left time: 500.6242s
	iters: 800, epoch: 12 | loss: 0.4054720
	speed: 0.0254s/iter; left time: 503.2963s
	iters: 900, epoch: 12 | loss: 0.5231899
	speed: 0.0253s/iter; left time: 499.9477s
	iters: 1000, epoch: 12 | loss: 0.2304979
	speed: 0.0251s/iter; left time: 492.9843s
	iters: 1100, epoch: 12 | loss: 0.2758615
	speed: 0.0252s/iter; left time: 493.2394s
	iters: 1200, epoch: 12 | loss: 0.3052377
	speed: 0.0252s/iter; left time: 490.4133s
	iters: 1300, epoch: 12 | loss: 0.3352309
	speed: 0.0251s/iter; left time: 485.7481s
	iters: 1400, epoch: 12 | loss: 0.3377056
	speed: 0.0252s/iter; left time: 484.4425s
	iters: 1500, epoch: 12 | loss: 0.3053783
	speed: 0.0252s/iter; left time: 481.3350s
	iters: 1600, epoch: 12 | loss: 0.2990242
	speed: 0.0251s/iter; left time: 477.7574s
	iters: 1700, epoch: 12 | loss: 0.2677123
	speed: 0.0251s/iter; left time: 475.9589s
	iters: 1800, epoch: 12 | loss: 0.3093464
	speed: 0.0252s/iter; left time: 475.6428s
	iters: 1900, epoch: 12 | loss: 0.3985703
	speed: 0.0253s/iter; left time: 474.5378s
	iters: 2000, epoch: 12 | loss: 0.3269675
	speed: 0.0252s/iter; left time: 469.8261s
	iters: 2100, epoch: 12 | loss: 0.2559902
	speed: 0.0250s/iter; left time: 462.9733s
	iters: 2200, epoch: 12 | loss: 0.6053689
	speed: 0.0250s/iter; left time: 461.4816s
Epoch: 12 cost time: 58.34442186355591
Epoch: 12, Steps: 2293 | Train Loss: 0.4575954 Vali Loss: 0.4204111 Test Loss: 0.1644668
EarlyStopping counter: 5 out of 5
Early stopping
Total training time: 917.6546 seconds
>>>>>>>testing : weather_96_96_NLinear_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15227<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
mse:0.16474579274654388, mae:0.20874853432178497
