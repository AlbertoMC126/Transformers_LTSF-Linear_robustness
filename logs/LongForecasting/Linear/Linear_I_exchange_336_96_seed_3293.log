Args in experiment:
Namespace(activation='gelu', batch_size=8, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='exchange_rate.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=8, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='mse', lradj='type1', model='Linear', model_id='Exchange_336_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=3293, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : Exchange_336_96_Linear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3293>>>>>>>>>>>>>>>>>>>>>>>>>>
train 4880
val 665
test 1422
	iters: 100, epoch: 1 | loss: 0.1045983
	speed: 0.0034s/iter; left time: 41.5065s
	iters: 200, epoch: 1 | loss: 0.2777891
	speed: 0.0030s/iter; left time: 35.9052s
	iters: 300, epoch: 1 | loss: 0.1100593
	speed: 0.0028s/iter; left time: 33.7760s
	iters: 400, epoch: 1 | loss: 0.0929319
	speed: 0.0031s/iter; left time: 37.0555s
	iters: 500, epoch: 1 | loss: 0.1143322
	speed: 0.0028s/iter; left time: 32.4307s
	iters: 600, epoch: 1 | loss: 0.1240508
	speed: 0.0029s/iter; left time: 33.7586s
Epoch: 1 cost time: 1.8411564826965332
Epoch: 1, Steps: 610 | Train Loss: 0.1669687 Vali Loss: 0.3062086 Test Loss: 0.1421568
Validation loss decreased (inf --> 0.306209).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1468759
	speed: 0.0048s/iter; left time: 55.1601s
	iters: 200, epoch: 2 | loss: 0.1221816
	speed: 0.0032s/iter; left time: 36.2485s
	iters: 300, epoch: 2 | loss: 0.1087661
	speed: 0.0033s/iter; left time: 36.8087s
	iters: 400, epoch: 2 | loss: 0.1093839
	speed: 0.0034s/iter; left time: 37.9374s
	iters: 500, epoch: 2 | loss: 0.1634859
	speed: 0.0031s/iter; left time: 34.6244s
	iters: 600, epoch: 2 | loss: 0.0993290
	speed: 0.0032s/iter; left time: 35.6109s
Epoch: 2 cost time: 1.9314346313476562
Epoch: 2, Steps: 610 | Train Loss: 0.1282563 Vali Loss: 0.2564379 Test Loss: 0.1153852
Validation loss decreased (0.306209 --> 0.256438).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.0735983
	speed: 0.0043s/iter; left time: 47.0059s
	iters: 200, epoch: 3 | loss: 0.0836702
	speed: 0.0028s/iter; left time: 30.1037s
	iters: 300, epoch: 3 | loss: 0.1654686
	speed: 0.0023s/iter; left time: 24.4597s
	iters: 400, epoch: 3 | loss: 0.0761543
	speed: 0.0026s/iter; left time: 27.7272s
	iters: 500, epoch: 3 | loss: 0.1309907
	speed: 0.0023s/iter; left time: 24.4207s
	iters: 600, epoch: 3 | loss: 0.1410096
	speed: 0.0025s/iter; left time: 26.3876s
Epoch: 3 cost time: 1.5294697284698486
Epoch: 3, Steps: 610 | Train Loss: 0.1202111 Vali Loss: 0.1963855 Test Loss: 0.1186179
Validation loss decreased (0.256438 --> 0.196386).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1243197
	speed: 0.0048s/iter; left time: 49.3008s
	iters: 200, epoch: 4 | loss: 0.0611733
	speed: 0.0028s/iter; left time: 28.6874s
	iters: 300, epoch: 4 | loss: 0.1672793
	speed: 0.0028s/iter; left time: 28.3265s
	iters: 400, epoch: 4 | loss: 0.3304867
	speed: 0.0035s/iter; left time: 34.8981s
	iters: 500, epoch: 4 | loss: 0.0794640
	speed: 0.0035s/iter; left time: 34.6472s
	iters: 600, epoch: 4 | loss: 0.0833889
	speed: 0.0032s/iter; left time: 30.7987s
Epoch: 4 cost time: 1.9065210819244385
Epoch: 4, Steps: 610 | Train Loss: 0.1165727 Vali Loss: 0.2139509 Test Loss: 0.0988056
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0925391
	speed: 0.0045s/iter; left time: 43.6679s
	iters: 200, epoch: 5 | loss: 0.1214356
	speed: 0.0028s/iter; left time: 26.3882s
	iters: 300, epoch: 5 | loss: 0.0994295
	speed: 0.0029s/iter; left time: 27.2471s
	iters: 400, epoch: 5 | loss: 0.1066424
	speed: 0.0024s/iter; left time: 22.7472s
	iters: 500, epoch: 5 | loss: 0.0754656
	speed: 0.0023s/iter; left time: 21.5781s
	iters: 600, epoch: 5 | loss: 0.0829761
	speed: 0.0026s/iter; left time: 23.7270s
Epoch: 5 cost time: 1.6019926071166992
Epoch: 5, Steps: 610 | Train Loss: 0.1148766 Vali Loss: 0.2093475 Test Loss: 0.0938374
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0761241
	speed: 0.0049s/iter; left time: 44.3671s
	iters: 200, epoch: 6 | loss: 0.1312648
	speed: 0.0034s/iter; left time: 30.5228s
	iters: 300, epoch: 6 | loss: 0.0825008
	speed: 0.0035s/iter; left time: 30.8231s
	iters: 400, epoch: 6 | loss: 0.0791011
	speed: 0.0031s/iter; left time: 26.9530s
	iters: 500, epoch: 6 | loss: 0.1379683
	speed: 0.0024s/iter; left time: 20.9354s
	iters: 600, epoch: 6 | loss: 0.1738923
	speed: 0.0024s/iter; left time: 20.8644s
Epoch: 6 cost time: 1.8282442092895508
Epoch: 6, Steps: 610 | Train Loss: 0.1140581 Vali Loss: 0.2163500 Test Loss: 0.0967101
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1410580
	speed: 0.0042s/iter; left time: 35.5635s
	iters: 200, epoch: 7 | loss: 0.1700700
	speed: 0.0034s/iter; left time: 28.3595s
	iters: 300, epoch: 7 | loss: 0.0832851
	speed: 0.0031s/iter; left time: 25.6296s
	iters: 400, epoch: 7 | loss: 0.1801556
	speed: 0.0028s/iter; left time: 22.6556s
	iters: 500, epoch: 7 | loss: 0.1546924
	speed: 0.0032s/iter; left time: 25.3293s
	iters: 600, epoch: 7 | loss: 0.0802152
	speed: 0.0030s/iter; left time: 23.4300s
Epoch: 7 cost time: 1.8303935527801514
Epoch: 7, Steps: 610 | Train Loss: 0.1136848 Vali Loss: 0.2250966 Test Loss: 0.0947139
EarlyStopping counter: 4 out of 5
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.1582632
	speed: 0.0046s/iter; left time: 36.1845s
	iters: 200, epoch: 8 | loss: 0.1175802
	speed: 0.0030s/iter; left time: 22.8838s
	iters: 300, epoch: 8 | loss: 0.0746578
	speed: 0.0032s/iter; left time: 24.7244s
	iters: 400, epoch: 8 | loss: 0.0948405
	speed: 0.0033s/iter; left time: 24.7183s
	iters: 500, epoch: 8 | loss: 0.0529232
	speed: 0.0032s/iter; left time: 24.0761s
	iters: 600, epoch: 8 | loss: 0.0912122
	speed: 0.0031s/iter; left time: 22.5062s
Epoch: 8 cost time: 1.894106149673462
Epoch: 8, Steps: 610 | Train Loss: 0.1133489 Vali Loss: 0.2173525 Test Loss: 0.0929863
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : Exchange_336_96_Linear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3293<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 1422
mse:0.11851125210523605, mae:0.2544047236442566
