Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='NLinear', model_id='ETTm2_96_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=3293, seq_len=96, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTm2_96_96_NLinear_ETTm2_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3293>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34369
data_set:  <data_provider.data_loader.Dataset_ETT_minute object at 0x000001712F5BFD68>
val 11425
data_set:  <data_provider.data_loader.Dataset_ETT_minute object at 0x000001717CBA7DD8>
test 11425
data_set:  <data_provider.data_loader.Dataset_ETT_minute object at 0x000001712F5BF128>
Total number of trainable parameters: 65184
Total number of parameters: 65184
	iters: 100, epoch: 1 | loss: 0.2037148
	speed: 0.0044s/iter; left time: 93.4952s
	iters: 200, epoch: 1 | loss: 0.1576401
	speed: 0.0038s/iter; left time: 79.8556s
	iters: 300, epoch: 1 | loss: 0.1931358
	speed: 0.0036s/iter; left time: 76.0976s
	iters: 400, epoch: 1 | loss: 0.2030705
	speed: 0.0030s/iter; left time: 62.5686s
	iters: 500, epoch: 1 | loss: 0.1940329
	speed: 0.0041s/iter; left time: 85.2613s
	iters: 600, epoch: 1 | loss: 0.2030967
	speed: 0.0034s/iter; left time: 71.7511s
	iters: 700, epoch: 1 | loss: 0.1712361
	speed: 0.0033s/iter; left time: 67.9387s
	iters: 800, epoch: 1 | loss: 0.1812183
	speed: 0.0041s/iter; left time: 84.6858s
	iters: 900, epoch: 1 | loss: 0.2756839
	speed: 0.0035s/iter; left time: 71.7174s
	iters: 1000, epoch: 1 | loss: 0.1649379
	speed: 0.0042s/iter; left time: 85.0230s
Epoch: 1 cost time: 3.952911853790283
Epoch: 1, Steps: 1074 | Train Loss: 0.2693816 Vali Loss: 0.1587204 Test Loss: 0.2231849
Validation loss decreased (inf --> 0.158720).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.1720937
	speed: 0.0180s/iter; left time: 364.8664s
	iters: 200, epoch: 2 | loss: 0.3034418
	speed: 0.0033s/iter; left time: 66.5542s
	iters: 300, epoch: 2 | loss: 0.1476380
	speed: 0.0040s/iter; left time: 81.4056s
	iters: 400, epoch: 2 | loss: 0.2082551
	speed: 0.0039s/iter; left time: 77.2966s
	iters: 500, epoch: 2 | loss: 0.5105348
	speed: 0.0033s/iter; left time: 66.1893s
	iters: 600, epoch: 2 | loss: 0.1678406
	speed: 0.0035s/iter; left time: 68.9035s
	iters: 700, epoch: 2 | loss: 0.1780621
	speed: 0.0031s/iter; left time: 60.8002s
	iters: 800, epoch: 2 | loss: 0.1477697
	speed: 0.0036s/iter; left time: 69.9046s
	iters: 900, epoch: 2 | loss: 0.7144039
	speed: 0.0038s/iter; left time: 73.6995s
	iters: 1000, epoch: 2 | loss: 0.1938200
	speed: 0.0044s/iter; left time: 85.1528s
Epoch: 2 cost time: 3.895181894302368
Epoch: 2, Steps: 1074 | Train Loss: 0.2719319 Vali Loss: 0.1433884 Test Loss: 0.2008599
Validation loss decreased (0.158720 --> 0.143388).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.2074134
	speed: 0.0181s/iter; left time: 348.3620s
	iters: 200, epoch: 3 | loss: 0.2096079
	speed: 0.0039s/iter; left time: 75.1235s
	iters: 300, epoch: 3 | loss: 0.1981371
	speed: 0.0032s/iter; left time: 59.9568s
	iters: 400, epoch: 3 | loss: 0.2255116
	speed: 0.0038s/iter; left time: 71.9205s
	iters: 500, epoch: 3 | loss: 0.2172162
	speed: 0.0032s/iter; left time: 59.6094s
	iters: 600, epoch: 3 | loss: 0.2855774
	speed: 0.0039s/iter; left time: 73.5890s
	iters: 700, epoch: 3 | loss: 0.2013177
	speed: 0.0036s/iter; left time: 66.9352s
	iters: 800, epoch: 3 | loss: 0.2994202
	speed: 0.0030s/iter; left time: 55.0690s
	iters: 900, epoch: 3 | loss: 0.1764550
	speed: 0.0039s/iter; left time: 71.9532s
	iters: 1000, epoch: 3 | loss: 0.2384109
	speed: 0.0042s/iter; left time: 77.3797s
Epoch: 3 cost time: 3.7967755794525146
Epoch: 3, Steps: 1074 | Train Loss: 0.2450689 Vali Loss: 0.1296291 Test Loss: 0.1835936
Validation loss decreased (0.143388 --> 0.129629).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.1958304
	speed: 0.0180s/iter; left time: 326.3041s
	iters: 200, epoch: 4 | loss: 0.1269457
	speed: 0.0031s/iter; left time: 56.4068s
	iters: 300, epoch: 4 | loss: 0.1445232
	speed: 0.0034s/iter; left time: 61.7815s
	iters: 400, epoch: 4 | loss: 0.1178469
	speed: 0.0036s/iter; left time: 64.1217s
	iters: 500, epoch: 4 | loss: 0.3355889
	speed: 0.0030s/iter; left time: 53.9921s
	iters: 600, epoch: 4 | loss: 0.2444486
	speed: 0.0041s/iter; left time: 73.2273s
	iters: 700, epoch: 4 | loss: 0.1533700
	speed: 0.0036s/iter; left time: 63.1508s
	iters: 800, epoch: 4 | loss: 0.1439165
	speed: 0.0046s/iter; left time: 79.5204s
	iters: 900, epoch: 4 | loss: 0.5224456
	speed: 0.0032s/iter; left time: 55.0351s
	iters: 1000, epoch: 4 | loss: 0.1093429
	speed: 0.0032s/iter; left time: 54.6352s
Epoch: 4 cost time: 3.859424114227295
Epoch: 4, Steps: 1074 | Train Loss: 0.2375247 Vali Loss: 0.1339604 Test Loss: 0.1854073
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.3795916
	speed: 0.0190s/iter; left time: 324.1302s
	iters: 200, epoch: 5 | loss: 0.1366450
	speed: 0.0034s/iter; left time: 58.0424s
	iters: 300, epoch: 5 | loss: 0.1855972
	speed: 0.0042s/iter; left time: 70.6384s
	iters: 400, epoch: 5 | loss: 0.1180387
	speed: 0.0030s/iter; left time: 50.4211s
	iters: 500, epoch: 5 | loss: 0.2183215
	speed: 0.0041s/iter; left time: 67.7971s
	iters: 600, epoch: 5 | loss: 0.3512841
	speed: 0.0041s/iter; left time: 67.3346s
	iters: 700, epoch: 5 | loss: 0.1757233
	speed: 0.0034s/iter; left time: 56.7209s
	iters: 800, epoch: 5 | loss: 0.1064385
	speed: 0.0036s/iter; left time: 58.8609s
	iters: 900, epoch: 5 | loss: 0.2699170
	speed: 0.0033s/iter; left time: 53.4059s
	iters: 1000, epoch: 5 | loss: 0.2162006
	speed: 0.0038s/iter; left time: 61.4627s
Epoch: 5 cost time: 4.0437843799591064
Epoch: 5, Steps: 1074 | Train Loss: 0.2336062 Vali Loss: 0.1254217 Test Loss: 0.1775774
Validation loss decreased (0.129629 --> 0.125422).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.1813452
	speed: 0.0196s/iter; left time: 314.4621s
	iters: 200, epoch: 6 | loss: 0.1291369
	speed: 0.0034s/iter; left time: 54.6889s
	iters: 300, epoch: 6 | loss: 0.3093603
	speed: 0.0045s/iter; left time: 71.6604s
	iters: 400, epoch: 6 | loss: 0.1843868
	speed: 0.0031s/iter; left time: 49.0972s
	iters: 500, epoch: 6 | loss: 0.3266350
	speed: 0.0043s/iter; left time: 66.6915s
	iters: 600, epoch: 6 | loss: 0.5153064
	speed: 0.0031s/iter; left time: 47.6257s
	iters: 700, epoch: 6 | loss: 0.1555480
	speed: 0.0033s/iter; left time: 50.2937s
	iters: 800, epoch: 6 | loss: 0.1622193
	speed: 0.0047s/iter; left time: 72.0453s
	iters: 900, epoch: 6 | loss: 0.1373587
	speed: 0.0032s/iter; left time: 48.0720s
	iters: 1000, epoch: 6 | loss: 0.1120169
	speed: 0.0035s/iter; left time: 52.6745s
Epoch: 6 cost time: 3.887563705444336
Epoch: 6, Steps: 1074 | Train Loss: 0.2317138 Vali Loss: 0.1231299 Test Loss: 0.1766497
Validation loss decreased (0.125422 --> 0.123130).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.2184918
	speed: 0.0157s/iter; left time: 234.5028s
	iters: 200, epoch: 7 | loss: 0.1761689
	speed: 0.0045s/iter; left time: 67.2831s
	iters: 300, epoch: 7 | loss: 0.1833458
	speed: 0.0033s/iter; left time: 48.3302s
	iters: 400, epoch: 7 | loss: 0.2397048
	speed: 0.0033s/iter; left time: 48.0214s
	iters: 500, epoch: 7 | loss: 0.2120899
	speed: 0.0037s/iter; left time: 54.4570s
	iters: 600, epoch: 7 | loss: 0.1616180
	speed: 0.0035s/iter; left time: 50.2278s
	iters: 700, epoch: 7 | loss: 0.2646199
	speed: 0.0029s/iter; left time: 41.9960s
	iters: 800, epoch: 7 | loss: 0.3996071
	speed: 0.0036s/iter; left time: 50.7514s
	iters: 900, epoch: 7 | loss: 0.5091094
	speed: 0.0032s/iter; left time: 45.8122s
	iters: 1000, epoch: 7 | loss: 0.1363870
	speed: 0.0035s/iter; left time: 49.3503s
Epoch: 7 cost time: 3.7237915992736816
Epoch: 7, Steps: 1074 | Train Loss: 0.2306652 Vali Loss: 0.1244358 Test Loss: 0.1767172
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.4105605
	speed: 0.0161s/iter; left time: 222.9966s
	iters: 200, epoch: 8 | loss: 0.1182553
	speed: 0.0036s/iter; left time: 49.4247s
	iters: 300, epoch: 8 | loss: 0.1337022
	speed: 0.0033s/iter; left time: 44.8451s
	iters: 400, epoch: 8 | loss: 0.1848014
	speed: 0.0044s/iter; left time: 59.6027s
	iters: 500, epoch: 8 | loss: 0.1488422
	speed: 0.0037s/iter; left time: 49.1552s
	iters: 600, epoch: 8 | loss: 0.2217350
	speed: 0.0037s/iter; left time: 49.1360s
	iters: 700, epoch: 8 | loss: 0.1443815
	speed: 0.0031s/iter; left time: 41.4426s
	iters: 800, epoch: 8 | loss: 0.3900513
	speed: 0.0024s/iter; left time: 31.1451s
	iters: 900, epoch: 8 | loss: 0.1753974
	speed: 0.0046s/iter; left time: 60.0572s
	iters: 1000, epoch: 8 | loss: 0.1325582
	speed: 0.0033s/iter; left time: 43.4003s
Epoch: 8 cost time: 3.8211331367492676
Epoch: 8, Steps: 1074 | Train Loss: 0.2299022 Vali Loss: 0.1241302 Test Loss: 0.1767022
EarlyStopping counter: 2 out of 5
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.1124088
	speed: 0.0178s/iter; left time: 227.9936s
	iters: 200, epoch: 9 | loss: 0.1601129
	speed: 0.0029s/iter; left time: 36.2362s
	iters: 300, epoch: 9 | loss: 0.1529486
	speed: 0.0036s/iter; left time: 45.8537s
	iters: 400, epoch: 9 | loss: 0.3010308
	speed: 0.0035s/iter; left time: 43.5196s
	iters: 500, epoch: 9 | loss: 0.1271454
	speed: 0.0038s/iter; left time: 47.5127s
	iters: 600, epoch: 9 | loss: 0.4039487
	speed: 0.0029s/iter; left time: 35.4297s
	iters: 700, epoch: 9 | loss: 0.2411328
	speed: 0.0045s/iter; left time: 55.2696s
	iters: 800, epoch: 9 | loss: 0.5152175
	speed: 0.0044s/iter; left time: 52.8966s
	iters: 900, epoch: 9 | loss: 0.2961464
	speed: 0.0036s/iter; left time: 43.0843s
	iters: 1000, epoch: 9 | loss: 0.1669439
	speed: 0.0039s/iter; left time: 46.4294s
Epoch: 9 cost time: 3.9401791095733643
Epoch: 9, Steps: 1074 | Train Loss: 0.2297340 Vali Loss: 0.1250944 Test Loss: 0.1770088
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.1906925
	speed: 0.0181s/iter; left time: 212.3351s
	iters: 200, epoch: 10 | loss: 0.1757714
	speed: 0.0037s/iter; left time: 43.5334s
	iters: 300, epoch: 10 | loss: 0.1143103
	speed: 0.0042s/iter; left time: 48.5807s
	iters: 400, epoch: 10 | loss: 0.2451533
	speed: 0.0048s/iter; left time: 55.3133s
	iters: 500, epoch: 10 | loss: 0.2127877
	speed: 0.0045s/iter; left time: 51.2366s
	iters: 600, epoch: 10 | loss: 0.3215816
	speed: 0.0047s/iter; left time: 53.2094s
	iters: 700, epoch: 10 | loss: 0.1186426
	speed: 0.0039s/iter; left time: 42.8014s
	iters: 800, epoch: 10 | loss: 0.1662279
	speed: 0.0044s/iter; left time: 48.1905s
	iters: 900, epoch: 10 | loss: 0.3519394
	speed: 0.0034s/iter; left time: 37.5063s
	iters: 1000, epoch: 10 | loss: 0.2582829
	speed: 0.0047s/iter; left time: 51.3293s
Epoch: 10 cost time: 4.612060785293579
Epoch: 10, Steps: 1074 | Train Loss: 0.2295155 Vali Loss: 0.1250960 Test Loss: 0.1769572
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.1104810
	speed: 0.0182s/iter; left time: 193.9094s
	iters: 200, epoch: 11 | loss: 0.4722556
	speed: 0.0028s/iter; left time: 29.6866s
	iters: 300, epoch: 11 | loss: 0.2629233
	speed: 0.0036s/iter; left time: 37.5127s
	iters: 400, epoch: 11 | loss: 0.2608667
	speed: 0.0037s/iter; left time: 38.7559s
	iters: 500, epoch: 11 | loss: 0.2334597
	speed: 0.0029s/iter; left time: 29.6881s
	iters: 600, epoch: 11 | loss: 0.1909286
	speed: 0.0025s/iter; left time: 25.6796s
	iters: 700, epoch: 11 | loss: 0.1418686
	speed: 0.0030s/iter; left time: 30.1822s
	iters: 800, epoch: 11 | loss: 0.1423601
	speed: 0.0027s/iter; left time: 26.4183s
	iters: 900, epoch: 11 | loss: 0.1840058
	speed: 0.0031s/iter; left time: 30.7547s
	iters: 1000, epoch: 11 | loss: 0.1365999
	speed: 0.0041s/iter; left time: 40.0102s
Epoch: 11 cost time: 3.492187023162842
Epoch: 11, Steps: 1074 | Train Loss: 0.2294023 Vali Loss: 0.1247580 Test Loss: 0.1767423
EarlyStopping counter: 5 out of 5
Early stopping
Total training time: 55.4377 seconds
>>>>>>>testing : ETTm2_96_96_NLinear_ETTm2_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3293<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
data_set:  <data_provider.data_loader.Dataset_ETT_minute object at 0x0000017172011080>
mse:0.17688561975955963, mae:0.2567204236984253
