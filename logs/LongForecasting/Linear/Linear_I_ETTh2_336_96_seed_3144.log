Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTh2', data_path='ETTh2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.05, loss='mse', lradj='type1', model='Linear', model_id='ETTh2_336_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=3144, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTh2_336_96_Linear_ETTh2_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3144>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.9656722
	speed: 0.0026s/iter; left time: 26.4188s
	iters: 200, epoch: 1 | loss: 4.7083893
	speed: 0.0025s/iter; left time: 25.4545s
	iters: 300, epoch: 1 | loss: 1.4746034
	speed: 0.0033s/iter; left time: 33.2001s
	iters: 400, epoch: 1 | loss: 5.3745823
	speed: 0.0034s/iter; left time: 33.6261s
	iters: 500, epoch: 1 | loss: 7.4917035
	speed: 0.0036s/iter; left time: 34.6563s
Epoch: 1 cost time: 1.589355230331421
Epoch: 1, Steps: 513 | Train Loss: 7.7068727 Vali Loss: 3.0685923 Test Loss: 7.4085646
Validation loss decreased (inf --> 3.068592).  Saving model ...
Updating learning rate to 0.05
	iters: 100, epoch: 2 | loss: 5.4865508
	speed: 0.0073s/iter; left time: 70.4550s
	iters: 200, epoch: 2 | loss: 5.7790995
	speed: 0.0028s/iter; left time: 26.5432s
	iters: 300, epoch: 2 | loss: 4.2677908
	speed: 0.0022s/iter; left time: 21.1969s
	iters: 400, epoch: 2 | loss: 5.9357972
	speed: 0.0027s/iter; left time: 25.1462s
	iters: 500, epoch: 2 | loss: 10.3379517
	speed: 0.0032s/iter; left time: 29.5009s
Epoch: 2 cost time: 1.454352855682373
Epoch: 2, Steps: 513 | Train Loss: 5.4510174 Vali Loss: 8.6140518 Test Loss: 30.1911774
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.025
	iters: 100, epoch: 3 | loss: 0.7546950
	speed: 0.0057s/iter; left time: 51.7170s
	iters: 200, epoch: 3 | loss: 1.6643466
	speed: 0.0032s/iter; left time: 29.0980s
	iters: 300, epoch: 3 | loss: 0.8105792
	speed: 0.0033s/iter; left time: 29.4853s
	iters: 400, epoch: 3 | loss: 0.4103146
	speed: 0.0033s/iter; left time: 28.9122s
	iters: 500, epoch: 3 | loss: 0.5932453
	speed: 0.0032s/iter; left time: 27.6900s
Epoch: 3 cost time: 1.6225779056549072
Epoch: 3, Steps: 513 | Train Loss: 1.2203026 Vali Loss: 8.0395718 Test Loss: 8.8325987
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.0125
	iters: 100, epoch: 4 | loss: 0.5066475
	speed: 0.0076s/iter; left time: 65.3888s
	iters: 200, epoch: 4 | loss: 0.4083950
	speed: 0.0037s/iter; left time: 31.6165s
	iters: 300, epoch: 4 | loss: 0.3263832
	speed: 0.0037s/iter; left time: 31.4984s
	iters: 400, epoch: 4 | loss: 1.6474544
	speed: 0.0035s/iter; left time: 29.1512s
	iters: 500, epoch: 4 | loss: 0.2783897
	speed: 0.0039s/iter; left time: 31.6549s
Epoch: 4 cost time: 1.8925573825836182
Epoch: 4, Steps: 513 | Train Loss: 0.5626435 Vali Loss: 0.4640602 Test Loss: 0.8946183
Validation loss decreased (3.068592 --> 0.464060).  Saving model ...
Updating learning rate to 0.00625
	iters: 100, epoch: 5 | loss: 0.5377923
	speed: 0.0071s/iter; left time: 57.8308s
	iters: 200, epoch: 5 | loss: 0.4242380
	speed: 0.0025s/iter; left time: 20.2628s
	iters: 300, epoch: 5 | loss: 0.6554314
	speed: 0.0031s/iter; left time: 24.2017s
	iters: 400, epoch: 5 | loss: 0.2833859
	speed: 0.0035s/iter; left time: 27.2677s
	iters: 500, epoch: 5 | loss: 0.4103967
	speed: 0.0036s/iter; left time: 27.9065s
Epoch: 5 cost time: 1.5941975116729736
Epoch: 5, Steps: 513 | Train Loss: 0.4351823 Vali Loss: 0.2993308 Test Loss: 0.5058275
Validation loss decreased (0.464060 --> 0.299331).  Saving model ...
Updating learning rate to 0.003125
	iters: 100, epoch: 6 | loss: 0.3090795
	speed: 0.0066s/iter; left time: 50.3818s
	iters: 200, epoch: 6 | loss: 0.3077553
	speed: 0.0032s/iter; left time: 23.8294s
	iters: 300, epoch: 6 | loss: 0.4017297
	speed: 0.0032s/iter; left time: 23.9631s
	iters: 400, epoch: 6 | loss: 0.2429316
	speed: 0.0031s/iter; left time: 22.2680s
	iters: 500, epoch: 6 | loss: 0.7644914
	speed: 0.0037s/iter; left time: 26.2655s
Epoch: 6 cost time: 1.6601057052612305
Epoch: 6, Steps: 513 | Train Loss: 0.3991376 Vali Loss: 0.2863597 Test Loss: 0.3990825
Validation loss decreased (0.299331 --> 0.286360).  Saving model ...
Updating learning rate to 0.0015625
	iters: 100, epoch: 7 | loss: 0.3716590
	speed: 0.0071s/iter; left time: 50.0207s
	iters: 200, epoch: 7 | loss: 0.4691990
	speed: 0.0031s/iter; left time: 21.7907s
	iters: 300, epoch: 7 | loss: 0.2176717
	speed: 0.0030s/iter; left time: 20.3714s
	iters: 400, epoch: 7 | loss: 0.2120289
	speed: 0.0028s/iter; left time: 19.2778s
	iters: 500, epoch: 7 | loss: 0.2826433
	speed: 0.0031s/iter; left time: 20.4499s
Epoch: 7 cost time: 1.5852272510528564
Epoch: 7, Steps: 513 | Train Loss: 0.3792416 Vali Loss: 0.2550875 Test Loss: 0.3515394
Validation loss decreased (0.286360 --> 0.255087).  Saving model ...
Updating learning rate to 0.00078125
	iters: 100, epoch: 8 | loss: 0.2641051
	speed: 0.0074s/iter; left time: 48.3099s
	iters: 200, epoch: 8 | loss: 0.2575046
	speed: 0.0035s/iter; left time: 22.5154s
	iters: 300, epoch: 8 | loss: 0.3592062
	speed: 0.0033s/iter; left time: 20.9575s
	iters: 400, epoch: 8 | loss: 0.1569689
	speed: 0.0030s/iter; left time: 18.8281s
	iters: 500, epoch: 8 | loss: 0.6860129
	speed: 0.0028s/iter; left time: 17.3995s
Epoch: 8 cost time: 1.632551670074463
Epoch: 8, Steps: 513 | Train Loss: 0.3696971 Vali Loss: 0.2810766 Test Loss: 0.4303583
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.000390625
	iters: 100, epoch: 9 | loss: 0.7598518
	speed: 0.0049s/iter; left time: 29.3922s
	iters: 200, epoch: 9 | loss: 0.3282621
	speed: 0.0030s/iter; left time: 17.8243s
	iters: 300, epoch: 9 | loss: 0.4961557
	speed: 0.0034s/iter; left time: 20.2066s
	iters: 400, epoch: 9 | loss: 0.4518821
	speed: 0.0034s/iter; left time: 19.6207s
	iters: 500, epoch: 9 | loss: 0.4242693
	speed: 0.0032s/iter; left time: 17.9893s
Epoch: 9 cost time: 1.58329176902771
Epoch: 9, Steps: 513 | Train Loss: 0.3620062 Vali Loss: 0.2928632 Test Loss: 0.4932074
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.0001953125
	iters: 100, epoch: 10 | loss: 0.1832511
	speed: 0.0056s/iter; left time: 31.1044s
	iters: 200, epoch: 10 | loss: 0.3035609
	speed: 0.0027s/iter; left time: 14.8165s
	iters: 300, epoch: 10 | loss: 0.1903902
	speed: 0.0034s/iter; left time: 18.1696s
	iters: 400, epoch: 10 | loss: 0.5142810
	speed: 0.0033s/iter; left time: 17.2003s
	iters: 500, epoch: 10 | loss: 0.1911422
	speed: 0.0037s/iter; left time: 18.8895s
Epoch: 10 cost time: 1.6164240837097168
Epoch: 10, Steps: 513 | Train Loss: 0.3585243 Vali Loss: 0.2800649 Test Loss: 0.4276468
EarlyStopping counter: 3 out of 5
Updating learning rate to 9.765625e-05
	iters: 100, epoch: 11 | loss: 0.3885381
	speed: 0.0065s/iter; left time: 32.5547s
	iters: 200, epoch: 11 | loss: 0.5206698
	speed: 0.0036s/iter; left time: 17.5203s
	iters: 300, epoch: 11 | loss: 0.2773697
	speed: 0.0030s/iter; left time: 14.3070s
	iters: 400, epoch: 11 | loss: 0.5752062
	speed: 0.0034s/iter; left time: 15.8502s
	iters: 500, epoch: 11 | loss: 0.3559767
	speed: 0.0034s/iter; left time: 15.5220s
Epoch: 11 cost time: 1.635664701461792
Epoch: 11, Steps: 513 | Train Loss: 0.3565498 Vali Loss: 0.2763311 Test Loss: 0.4115316
EarlyStopping counter: 4 out of 5
Updating learning rate to 4.8828125e-05
	iters: 100, epoch: 12 | loss: 0.2325482
	speed: 0.0068s/iter; left time: 30.7223s
	iters: 200, epoch: 12 | loss: 0.7170093
	speed: 0.0034s/iter; left time: 15.0349s
	iters: 300, epoch: 12 | loss: 0.2763369
	speed: 0.0036s/iter; left time: 15.5447s
	iters: 400, epoch: 12 | loss: 0.3625379
	speed: 0.0036s/iter; left time: 15.3114s
	iters: 500, epoch: 12 | loss: 0.3834634
	speed: 0.0033s/iter; left time: 13.4686s
Epoch: 12 cost time: 1.797372579574585
Epoch: 12, Steps: 513 | Train Loss: 0.3552155 Vali Loss: 0.2858112 Test Loss: 0.4428428
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTh2_336_96_Linear_ETTh2_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed3144<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.3523024022579193, mae:0.39750686287879944
