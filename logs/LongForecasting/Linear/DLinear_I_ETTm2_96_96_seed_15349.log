Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='DLinear', model_id='ETTm2_96_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=15349, seq_len=96, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : ETTm2_96_96_DLinear_ETTm2_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15349>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34369
data_set:  <data_provider.data_loader.Dataset_ETT_minute object at 0x00000288025B0550>
val 11425
data_set:  <data_provider.data_loader.Dataset_ETT_minute object at 0x000002884FAF6DD8>
test 11425
data_set:  <data_provider.data_loader.Dataset_ETT_minute object at 0x00000288025B0208>
Total number of trainable parameters: 130368
Total number of parameters: 130368
	iters: 100, epoch: 1 | loss: 0.3090545
	speed: 0.0049s/iter; left time: 105.2060s
	iters: 200, epoch: 1 | loss: 0.3347439
	speed: 0.0057s/iter; left time: 121.2243s
	iters: 300, epoch: 1 | loss: 0.1716390
	speed: 0.0055s/iter; left time: 116.3106s
	iters: 400, epoch: 1 | loss: 0.1354138
	speed: 0.0057s/iter; left time: 120.5408s
	iters: 500, epoch: 1 | loss: 0.2316660
	speed: 0.0045s/iter; left time: 95.0197s
	iters: 600, epoch: 1 | loss: 0.2680007
	speed: 0.0061s/iter; left time: 126.9092s
	iters: 700, epoch: 1 | loss: 0.5227656
	speed: 0.0057s/iter; left time: 117.9108s
	iters: 800, epoch: 1 | loss: 0.2383973
	speed: 0.0046s/iter; left time: 95.6617s
	iters: 900, epoch: 1 | loss: 0.2373288
	speed: 0.0048s/iter; left time: 99.1818s
	iters: 1000, epoch: 1 | loss: 0.1566246
	speed: 0.0058s/iter; left time: 119.1080s
Epoch: 1 cost time: 5.7531898021698
Epoch: 1, Steps: 1074 | Train Loss: 0.2768186 Vali Loss: 0.1968258 Test Loss: 0.3589960
Validation loss decreased (inf --> 0.196826).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.2474600
	speed: 0.0263s/iter; left time: 533.5156s
	iters: 200, epoch: 2 | loss: 0.2737733
	speed: 0.0049s/iter; left time: 98.7173s
	iters: 300, epoch: 2 | loss: 0.1918793
	speed: 0.0046s/iter; left time: 91.5430s
	iters: 400, epoch: 2 | loss: 0.3744788
	speed: 0.0053s/iter; left time: 106.3274s
	iters: 500, epoch: 2 | loss: 0.2564890
	speed: 0.0062s/iter; left time: 122.4321s
	iters: 600, epoch: 2 | loss: 0.1859983
	speed: 0.0057s/iter; left time: 113.1664s
	iters: 700, epoch: 2 | loss: 0.2158801
	speed: 0.0043s/iter; left time: 84.5922s
	iters: 800, epoch: 2 | loss: 0.3194827
	speed: 0.0055s/iter; left time: 106.8776s
	iters: 900, epoch: 2 | loss: 0.3209211
	speed: 0.0057s/iter; left time: 110.3127s
	iters: 1000, epoch: 2 | loss: 0.2350630
	speed: 0.0058s/iter; left time: 113.1314s
Epoch: 2 cost time: 5.564833879470825
Epoch: 2, Steps: 1074 | Train Loss: 0.2790656 Vali Loss: 0.1946977 Test Loss: 0.3188944
Validation loss decreased (0.196826 --> 0.194698).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.1591433
	speed: 0.0250s/iter; left time: 480.1980s
	iters: 200, epoch: 3 | loss: 0.1778422
	speed: 0.0040s/iter; left time: 76.5882s
	iters: 300, epoch: 3 | loss: 0.2737983
	speed: 0.0047s/iter; left time: 90.2807s
	iters: 400, epoch: 3 | loss: 0.2202645
	speed: 0.0057s/iter; left time: 107.3802s
	iters: 500, epoch: 3 | loss: 0.3020648
	speed: 0.0054s/iter; left time: 102.0623s
	iters: 600, epoch: 3 | loss: 0.2486218
	speed: 0.0058s/iter; left time: 109.4366s
	iters: 700, epoch: 3 | loss: 0.2646351
	speed: 0.0056s/iter; left time: 103.5849s
	iters: 800, epoch: 3 | loss: 0.1840053
	speed: 0.0057s/iter; left time: 106.0673s
	iters: 900, epoch: 3 | loss: 0.2623613
	speed: 0.0048s/iter; left time: 88.4049s
	iters: 1000, epoch: 3 | loss: 0.3303661
	speed: 0.0052s/iter; left time: 94.8630s
Epoch: 3 cost time: 5.7343950271606445
Epoch: 3, Steps: 1074 | Train Loss: 0.2436770 Vali Loss: 0.1456439 Test Loss: 0.2159857
Validation loss decreased (0.194698 --> 0.145644).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.2091764
	speed: 0.0264s/iter; left time: 479.6734s
	iters: 200, epoch: 4 | loss: 0.1233882
	speed: 0.0060s/iter; left time: 108.1307s
	iters: 300, epoch: 4 | loss: 0.1396347
	speed: 0.0064s/iter; left time: 115.5258s
	iters: 400, epoch: 4 | loss: 0.2761775
	speed: 0.0070s/iter; left time: 124.8061s
	iters: 500, epoch: 4 | loss: 0.2188839
	speed: 0.0052s/iter; left time: 91.5717s
	iters: 600, epoch: 4 | loss: 0.1800604
	speed: 0.0045s/iter; left time: 79.0727s
	iters: 700, epoch: 4 | loss: 0.2413379
	speed: 0.0043s/iter; left time: 75.3255s
	iters: 800, epoch: 4 | loss: 0.1886056
	speed: 0.0058s/iter; left time: 101.0170s
	iters: 900, epoch: 4 | loss: 0.1773200
	speed: 0.0055s/iter; left time: 94.8676s
	iters: 1000, epoch: 4 | loss: 0.3888920
	speed: 0.0049s/iter; left time: 84.6461s
Epoch: 4 cost time: 5.752983093261719
Epoch: 4, Steps: 1074 | Train Loss: 0.2304460 Vali Loss: 0.2029133 Test Loss: 0.4075898
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.1317188
	speed: 0.0238s/iter; left time: 406.8407s
	iters: 200, epoch: 5 | loss: 0.1068454
	speed: 0.0051s/iter; left time: 86.4226s
	iters: 300, epoch: 5 | loss: 0.2009250
	speed: 0.0049s/iter; left time: 83.2462s
	iters: 400, epoch: 5 | loss: 0.1417534
	speed: 0.0055s/iter; left time: 92.6779s
	iters: 500, epoch: 5 | loss: 0.4012256
	speed: 0.0052s/iter; left time: 87.3080s
	iters: 600, epoch: 5 | loss: 0.2203778
	speed: 0.0051s/iter; left time: 85.2069s
	iters: 700, epoch: 5 | loss: 0.4631005
	speed: 0.0050s/iter; left time: 81.8417s
	iters: 800, epoch: 5 | loss: 0.1747913
	speed: 0.0063s/iter; left time: 103.3051s
	iters: 900, epoch: 5 | loss: 0.2299865
	speed: 0.0054s/iter; left time: 87.8648s
	iters: 1000, epoch: 5 | loss: 0.1217521
	speed: 0.0058s/iter; left time: 94.5474s
Epoch: 5 cost time: 5.7443623542785645
Epoch: 5, Steps: 1074 | Train Loss: 0.2240454 Vali Loss: 0.1317790 Test Loss: 0.1955300
Validation loss decreased (0.145644 --> 0.131779).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.1498415
	speed: 0.0239s/iter; left time: 383.1535s
	iters: 200, epoch: 6 | loss: 0.2008723
	speed: 0.0045s/iter; left time: 71.0331s
	iters: 300, epoch: 6 | loss: 0.1611637
	speed: 0.0050s/iter; left time: 79.7225s
	iters: 400, epoch: 6 | loss: 0.1126604
	speed: 0.0052s/iter; left time: 82.1663s
	iters: 500, epoch: 6 | loss: 0.2057969
	speed: 0.0056s/iter; left time: 87.0449s
	iters: 600, epoch: 6 | loss: 0.2216093
	speed: 0.0053s/iter; left time: 81.5817s
	iters: 700, epoch: 6 | loss: 0.1193326
	speed: 0.0052s/iter; left time: 80.2765s
	iters: 800, epoch: 6 | loss: 0.3072468
	speed: 0.0055s/iter; left time: 84.9364s
	iters: 900, epoch: 6 | loss: 0.4937598
	speed: 0.0066s/iter; left time: 100.2236s
	iters: 1000, epoch: 6 | loss: 0.2355246
	speed: 0.0056s/iter; left time: 84.5949s
Epoch: 6 cost time: 5.7610578536987305
Epoch: 6, Steps: 1074 | Train Loss: 0.2205966 Vali Loss: 0.1639835 Test Loss: 0.2918866
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.1370355
	speed: 0.0256s/iter; left time: 381.8069s
	iters: 200, epoch: 7 | loss: 0.1946858
	speed: 0.0060s/iter; left time: 89.6622s
	iters: 300, epoch: 7 | loss: 0.1789283
	speed: 0.0055s/iter; left time: 80.6963s
	iters: 400, epoch: 7 | loss: 0.2149808
	speed: 0.0054s/iter; left time: 78.3756s
	iters: 500, epoch: 7 | loss: 0.4719791
	speed: 0.0052s/iter; left time: 75.7989s
	iters: 600, epoch: 7 | loss: 0.1359469
	speed: 0.0047s/iter; left time: 68.0133s
	iters: 700, epoch: 7 | loss: 0.1970108
	speed: 0.0059s/iter; left time: 84.6092s
	iters: 800, epoch: 7 | loss: 0.1665761
	speed: 0.0053s/iter; left time: 74.7555s
	iters: 900, epoch: 7 | loss: 0.2224508
	speed: 0.0053s/iter; left time: 75.0548s
	iters: 1000, epoch: 7 | loss: 0.2229528
	speed: 0.0039s/iter; left time: 54.7939s
Epoch: 7 cost time: 5.616595029830933
Epoch: 7, Steps: 1074 | Train Loss: 0.2183955 Vali Loss: 0.1545334 Test Loss: 0.2643478
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.2023580
	speed: 0.0248s/iter; left time: 344.4385s
	iters: 200, epoch: 8 | loss: 0.2558079
	speed: 0.0051s/iter; left time: 70.7921s
	iters: 300, epoch: 8 | loss: 0.1344517
	speed: 0.0050s/iter; left time: 68.5934s
	iters: 400, epoch: 8 | loss: 0.2634549
	speed: 0.0062s/iter; left time: 84.0408s
	iters: 500, epoch: 8 | loss: 0.3155746
	speed: 0.0056s/iter; left time: 75.4990s
	iters: 600, epoch: 8 | loss: 0.2354430
	speed: 0.0049s/iter; left time: 65.3905s
	iters: 700, epoch: 8 | loss: 0.1877863
	speed: 0.0054s/iter; left time: 72.2666s
	iters: 800, epoch: 8 | loss: 0.3146774
	speed: 0.0044s/iter; left time: 58.0678s
	iters: 900, epoch: 8 | loss: 0.2915745
	speed: 0.0059s/iter; left time: 76.7875s
	iters: 1000, epoch: 8 | loss: 0.2138574
	speed: 0.0051s/iter; left time: 65.6513s
Epoch: 8 cost time: 5.681145191192627
Epoch: 8, Steps: 1074 | Train Loss: 0.2174473 Vali Loss: 0.1416221 Test Loss: 0.2301647
EarlyStopping counter: 3 out of 5
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.5805011
	speed: 0.0224s/iter; left time: 287.0667s
	iters: 200, epoch: 9 | loss: 0.2157339
	speed: 0.0062s/iter; left time: 78.0877s
	iters: 300, epoch: 9 | loss: 0.1543055
	speed: 0.0049s/iter; left time: 61.5109s
	iters: 400, epoch: 9 | loss: 0.1664432
	speed: 0.0055s/iter; left time: 68.9787s
	iters: 500, epoch: 9 | loss: 0.5735900
	speed: 0.0061s/iter; left time: 75.8520s
	iters: 600, epoch: 9 | loss: 0.2069588
	speed: 0.0052s/iter; left time: 64.3097s
	iters: 700, epoch: 9 | loss: 0.1470087
	speed: 0.0067s/iter; left time: 81.3624s
	iters: 800, epoch: 9 | loss: 0.1880247
	speed: 0.0056s/iter; left time: 67.6928s
	iters: 900, epoch: 9 | loss: 0.1335908
	speed: 0.0044s/iter; left time: 53.1121s
	iters: 1000, epoch: 9 | loss: 0.1620545
	speed: 0.0042s/iter; left time: 50.2092s
Epoch: 9 cost time: 5.8020806312561035
Epoch: 9, Steps: 1074 | Train Loss: 0.2169453 Vali Loss: 0.1485560 Test Loss: 0.2483110
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.1633158
	speed: 0.0233s/iter; left time: 272.7927s
	iters: 200, epoch: 10 | loss: 0.1868699
	speed: 0.0060s/iter; left time: 69.2822s
	iters: 300, epoch: 10 | loss: 0.4050490
	speed: 0.0052s/iter; left time: 59.5915s
	iters: 400, epoch: 10 | loss: 0.1371029
	speed: 0.0059s/iter; left time: 67.9151s
	iters: 500, epoch: 10 | loss: 0.1552730
	speed: 0.0055s/iter; left time: 61.7235s
	iters: 600, epoch: 10 | loss: 0.2256282
	speed: 0.0048s/iter; left time: 54.0901s
	iters: 700, epoch: 10 | loss: 0.1354659
	speed: 0.0054s/iter; left time: 60.4836s
	iters: 800, epoch: 10 | loss: 0.2247020
	speed: 0.0055s/iter; left time: 60.5633s
	iters: 900, epoch: 10 | loss: 0.2103442
	speed: 0.0050s/iter; left time: 54.3651s
	iters: 1000, epoch: 10 | loss: 0.1909402
	speed: 0.0047s/iter; left time: 51.1713s
Epoch: 10 cost time: 5.640462160110474
Epoch: 10, Steps: 1074 | Train Loss: 0.2166257 Vali Loss: 0.1540477 Test Loss: 0.2657325
EarlyStopping counter: 5 out of 5
Early stopping
Total training time: 72.3662 seconds
>>>>>>>testing : ETTm2_96_96_DLinear_ETTm2_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15349<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
data_set:  <data_provider.data_loader.Dataset_ETT_minute object at 0x00000288025A3860>
mse:0.19590449333190918, mae:0.28213778138160706
