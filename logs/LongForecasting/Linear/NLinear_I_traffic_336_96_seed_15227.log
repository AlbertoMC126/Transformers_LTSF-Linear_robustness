Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='NLinear', model_id='traffic_336_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=96, root_path='./dataset/', save_pred_values=False, seed=15227, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_336_96_NLinear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15227>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11849
val 1661
test 3413
	iters: 100, epoch: 1 | loss: 0.7969388
	speed: 0.3146s/iter; left time: 4624.4516s
	iters: 200, epoch: 1 | loss: 0.7015046
	speed: 0.2998s/iter; left time: 4377.7540s
	iters: 300, epoch: 1 | loss: 1.1446517
	speed: 0.2999s/iter; left time: 4349.3837s
	iters: 400, epoch: 1 | loss: 1.3565935
	speed: 0.3000s/iter; left time: 4320.6172s
	iters: 500, epoch: 1 | loss: 0.7170753
	speed: 0.3011s/iter; left time: 4305.3810s
	iters: 600, epoch: 1 | loss: 1.7299423
	speed: 0.3009s/iter; left time: 4272.4412s
	iters: 700, epoch: 1 | loss: 0.7085681
	speed: 0.2999s/iter; left time: 4229.0899s
Epoch: 1 cost time: 223.8531665802002
Epoch: 1, Steps: 740 | Train Loss: 1.1239854 Vali Loss: 1.2562253 Test Loss: 1.5779701
Validation loss decreased (inf --> 1.256225).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.9391649
	speed: 0.6100s/iter; left time: 8515.9873s
	iters: 200, epoch: 2 | loss: 0.6456221
	speed: 0.2997s/iter; left time: 4154.4695s
	iters: 300, epoch: 2 | loss: 0.8974403
	speed: 0.2999s/iter; left time: 4127.2359s
	iters: 400, epoch: 2 | loss: 0.9872595
	speed: 0.2999s/iter; left time: 4097.5208s
	iters: 500, epoch: 2 | loss: 0.6269022
	speed: 0.2998s/iter; left time: 4065.5122s
	iters: 600, epoch: 2 | loss: 1.0840102
	speed: 0.3002s/iter; left time: 4041.3450s
	iters: 700, epoch: 2 | loss: 0.9608104
	speed: 0.2995s/iter; left time: 4001.7795s
Epoch: 2 cost time: 222.0008704662323
Epoch: 2, Steps: 740 | Train Loss: 0.9735906 Vali Loss: 2.0075655 Test Loss: 2.1480432
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.3219248
	speed: 0.6089s/iter; left time: 8050.0542s
	iters: 200, epoch: 3 | loss: 0.3246839
	speed: 0.3001s/iter; left time: 3937.4871s
	iters: 300, epoch: 3 | loss: 0.2914805
	speed: 0.3000s/iter; left time: 3906.5322s
	iters: 400, epoch: 3 | loss: 0.3412197
	speed: 0.2995s/iter; left time: 3870.0584s
	iters: 500, epoch: 3 | loss: 0.3334385
	speed: 0.3002s/iter; left time: 3848.5400s
	iters: 600, epoch: 3 | loss: 0.3446102
	speed: 0.3000s/iter; left time: 3815.9060s
	iters: 700, epoch: 3 | loss: 0.2976483
	speed: 0.2996s/iter; left time: 3780.9967s
Epoch: 3 cost time: 221.98104000091553
Epoch: 3, Steps: 740 | Train Loss: 0.3589252 Vali Loss: 0.4836204 Test Loss: 0.5797496
Validation loss decreased (1.256225 --> 0.483620).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.2667856
	speed: 0.6100s/iter; left time: 7613.2561s
	iters: 200, epoch: 4 | loss: 0.2540876
	speed: 0.3000s/iter; left time: 3714.5459s
	iters: 300, epoch: 4 | loss: 0.2887730
	speed: 0.3001s/iter; left time: 3685.7479s
	iters: 400, epoch: 4 | loss: 0.2786976
	speed: 0.3006s/iter; left time: 3661.8963s
	iters: 500, epoch: 4 | loss: 0.2636078
	speed: 0.3001s/iter; left time: 3626.0269s
	iters: 600, epoch: 4 | loss: 0.3059978
	speed: 0.2996s/iter; left time: 3589.0653s
	iters: 700, epoch: 4 | loss: 0.3399581
	speed: 0.3005s/iter; left time: 3570.0462s
Epoch: 4 cost time: 222.0193154811859
Epoch: 4, Steps: 740 | Train Loss: 0.2793871 Vali Loss: 0.4269937 Test Loss: 0.5144723
Validation loss decreased (0.483620 --> 0.426994).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.2344578
	speed: 0.6094s/iter; left time: 7155.0890s
	iters: 200, epoch: 5 | loss: 0.2481942
	speed: 0.3000s/iter; left time: 3491.9668s
	iters: 300, epoch: 5 | loss: 0.2391343
	speed: 0.3005s/iter; left time: 3468.6384s
	iters: 400, epoch: 5 | loss: 0.2607398
	speed: 0.3002s/iter; left time: 3434.7640s
	iters: 500, epoch: 5 | loss: 0.2368080
	speed: 0.2999s/iter; left time: 3401.3134s
	iters: 600, epoch: 5 | loss: 0.2533422
	speed: 0.3001s/iter; left time: 3373.8049s
	iters: 700, epoch: 5 | loss: 0.2568544
	speed: 0.2996s/iter; left time: 3337.8430s
Epoch: 5 cost time: 222.1581587791443
Epoch: 5, Steps: 740 | Train Loss: 0.2569813 Vali Loss: 0.3712968 Test Loss: 0.4510581
Validation loss decreased (0.426994 --> 0.371297).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.2345421
	speed: 0.6100s/iter; left time: 6711.0408s
	iters: 200, epoch: 6 | loss: 0.2335147
	speed: 0.3001s/iter; left time: 3271.9140s
	iters: 300, epoch: 6 | loss: 0.2528613
	speed: 0.2996s/iter; left time: 3236.0040s
	iters: 400, epoch: 6 | loss: 0.2464010
	speed: 0.3000s/iter; left time: 3209.8218s
	iters: 500, epoch: 6 | loss: 0.2899057
	speed: 0.2998s/iter; left time: 3178.2043s
	iters: 600, epoch: 6 | loss: 0.2569565
	speed: 0.2998s/iter; left time: 3148.6036s
	iters: 700, epoch: 6 | loss: 0.2450864
	speed: 0.3001s/iter; left time: 3121.4031s
Epoch: 6 cost time: 221.92696404457092
Epoch: 6, Steps: 740 | Train Loss: 0.2468542 Vali Loss: 0.3599309 Test Loss: 0.4385301
Validation loss decreased (0.371297 --> 0.359931).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.2368543
	speed: 0.6104s/iter; left time: 6263.7780s
	iters: 200, epoch: 7 | loss: 0.2402695
	speed: 0.3015s/iter; left time: 3063.3025s
	iters: 300, epoch: 7 | loss: 0.2623285
	speed: 0.2997s/iter; left time: 3015.0210s
	iters: 400, epoch: 7 | loss: 0.2341745
	speed: 0.3003s/iter; left time: 2990.7913s
	iters: 500, epoch: 7 | loss: 0.2148053
	speed: 0.3008s/iter; left time: 2965.9491s
	iters: 600, epoch: 7 | loss: 0.2769736
	speed: 0.2997s/iter; left time: 2925.1158s
	iters: 700, epoch: 7 | loss: 0.2337626
	speed: 0.2999s/iter; left time: 2897.2308s
Epoch: 7 cost time: 222.20827507972717
Epoch: 7, Steps: 740 | Train Loss: 0.2414316 Vali Loss: 0.3537750 Test Loss: 0.4311882
Validation loss decreased (0.359931 --> 0.353775).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.2846270
	speed: 0.6098s/iter; left time: 5806.3586s
	iters: 200, epoch: 8 | loss: 0.2492456
	speed: 0.3000s/iter; left time: 2825.8457s
	iters: 300, epoch: 8 | loss: 0.2035731
	speed: 0.2998s/iter; left time: 2794.3562s
	iters: 400, epoch: 8 | loss: 0.2289407
	speed: 0.3001s/iter; left time: 2767.6669s
	iters: 500, epoch: 8 | loss: 0.2275987
	speed: 0.2995s/iter; left time: 2731.7320s
	iters: 600, epoch: 8 | loss: 0.2069730
	speed: 0.3002s/iter; left time: 2707.6956s
	iters: 700, epoch: 8 | loss: 0.2329445
	speed: 0.3000s/iter; left time: 2676.4348s
Epoch: 8 cost time: 222.0309019088745
Epoch: 8, Steps: 740 | Train Loss: 0.2381194 Vali Loss: 0.3501959 Test Loss: 0.4265136
Validation loss decreased (0.353775 --> 0.350196).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.2424369
	speed: 0.6098s/iter; left time: 5354.3279s
	iters: 200, epoch: 9 | loss: 0.2213345
	speed: 0.2999s/iter; left time: 2603.4024s
	iters: 300, epoch: 9 | loss: 0.2772775
	speed: 0.3000s/iter; left time: 2574.5309s
	iters: 400, epoch: 9 | loss: 0.2757479
	speed: 0.3012s/iter; left time: 2554.3475s
	iters: 500, epoch: 9 | loss: 0.2706358
	speed: 0.3011s/iter; left time: 2523.7899s
	iters: 600, epoch: 9 | loss: 0.2223682
	speed: 0.3004s/iter; left time: 2487.8588s
	iters: 700, epoch: 9 | loss: 0.2215120
	speed: 0.2999s/iter; left time: 2453.4075s
Epoch: 9 cost time: 222.22582030296326
Epoch: 9, Steps: 740 | Train Loss: 0.2362371 Vali Loss: 0.3482501 Test Loss: 0.4247024
Validation loss decreased (0.350196 --> 0.348250).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.2155879
	speed: 0.6111s/iter; left time: 4914.0316s
	iters: 200, epoch: 10 | loss: 0.2449566
	speed: 0.3006s/iter; left time: 2387.2694s
	iters: 300, epoch: 10 | loss: 0.2366328
	speed: 0.3000s/iter; left time: 2352.6226s
	iters: 400, epoch: 10 | loss: 0.2305270
	speed: 0.3009s/iter; left time: 2329.6078s
	iters: 500, epoch: 10 | loss: 0.2160659
	speed: 0.3007s/iter; left time: 2297.3260s
	iters: 600, epoch: 10 | loss: 0.2291268
	speed: 0.3011s/iter; left time: 2270.4677s
	iters: 700, epoch: 10 | loss: 0.2686341
	speed: 0.3015s/iter; left time: 2243.7736s
Epoch: 10 cost time: 222.7188537120819
Epoch: 10, Steps: 740 | Train Loss: 0.2351809 Vali Loss: 0.3473144 Test Loss: 0.4238821
Validation loss decreased (0.348250 --> 0.347314).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.2271041
	speed: 0.6104s/iter; left time: 4456.4643s
	iters: 200, epoch: 11 | loss: 0.1996783
	speed: 0.2996s/iter; left time: 2157.3501s
	iters: 300, epoch: 11 | loss: 0.1986805
	speed: 0.2998s/iter; left time: 2129.1800s
	iters: 400, epoch: 11 | loss: 0.2538744
	speed: 0.2999s/iter; left time: 2099.5489s
	iters: 500, epoch: 11 | loss: 0.2279978
	speed: 0.3002s/iter; left time: 2071.6481s
	iters: 600, epoch: 11 | loss: 0.2456107
	speed: 0.2998s/iter; left time: 2038.7616s
	iters: 700, epoch: 11 | loss: 0.2275498
	speed: 0.3001s/iter; left time: 2010.8286s
Epoch: 11 cost time: 222.02520608901978
Epoch: 11, Steps: 740 | Train Loss: 0.2345594 Vali Loss: 0.3465497 Test Loss: 0.4229627
Validation loss decreased (0.347314 --> 0.346550).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.2671102
	speed: 0.6098s/iter; left time: 4000.9543s
	iters: 200, epoch: 12 | loss: 0.2364621
	speed: 0.3003s/iter; left time: 1940.3652s
	iters: 300, epoch: 12 | loss: 0.2196712
	speed: 0.3004s/iter; left time: 1911.0700s
	iters: 400, epoch: 12 | loss: 0.2144113
	speed: 0.2999s/iter; left time: 1877.7263s
	iters: 500, epoch: 12 | loss: 0.2576450
	speed: 0.2997s/iter; left time: 1846.5322s
	iters: 600, epoch: 12 | loss: 0.2494998
	speed: 0.2999s/iter; left time: 1817.5837s
	iters: 700, epoch: 12 | loss: 0.2328991
	speed: 0.3013s/iter; left time: 1796.1718s
Epoch: 12 cost time: 222.26543855667114
Epoch: 12, Steps: 740 | Train Loss: 0.2342248 Vali Loss: 0.3468298 Test Loss: 0.4227570
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.2141382
	speed: 0.6095s/iter; left time: 3548.1681s
	iters: 200, epoch: 13 | loss: 0.2401398
	speed: 0.3008s/iter; left time: 1720.8927s
	iters: 300, epoch: 13 | loss: 0.2666550
	speed: 0.3011s/iter; left time: 1692.5829s
	iters: 400, epoch: 13 | loss: 0.3116400
	speed: 0.2999s/iter; left time: 1655.7778s
	iters: 500, epoch: 13 | loss: 0.2522730
	speed: 0.2999s/iter; left time: 1625.5475s
	iters: 600, epoch: 13 | loss: 0.2721227
	speed: 0.3009s/iter; left time: 1600.8374s
	iters: 700, epoch: 13 | loss: 0.2481120
	speed: 0.3009s/iter; left time: 1571.0658s
Epoch: 13 cost time: 222.5697522163391
Epoch: 13, Steps: 740 | Train Loss: 0.2340734 Vali Loss: 0.3462290 Test Loss: 0.4226777
Validation loss decreased (0.346550 --> 0.346229).  Saving model ...
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 14 | loss: 0.2452399
	speed: 0.6099s/iter; left time: 3098.9416s
	iters: 200, epoch: 14 | loss: 0.2167797
	speed: 0.3000s/iter; left time: 1494.2855s
	iters: 300, epoch: 14 | loss: 0.2371894
	speed: 0.2998s/iter; left time: 1463.3406s
	iters: 400, epoch: 14 | loss: 0.2381014
	speed: 0.3006s/iter; left time: 1436.9471s
	iters: 500, epoch: 14 | loss: 0.2209584
	speed: 0.3005s/iter; left time: 1406.7734s
	iters: 600, epoch: 14 | loss: 0.2609811
	speed: 0.2997s/iter; left time: 1372.8710s
	iters: 700, epoch: 14 | loss: 0.2492546
	speed: 0.3008s/iter; left time: 1348.0583s
Epoch: 14 cost time: 222.12707138061523
Epoch: 14, Steps: 740 | Train Loss: 0.2339281 Vali Loss: 0.3463518 Test Loss: 0.4226280
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 15 | loss: 0.2232291
	speed: 0.6084s/iter; left time: 2641.1245s
	iters: 200, epoch: 15 | loss: 0.2360679
	speed: 0.3015s/iter; left time: 1278.6276s
	iters: 300, epoch: 15 | loss: 0.2441846
	speed: 0.3008s/iter; left time: 1245.6768s
	iters: 400, epoch: 15 | loss: 0.2297291
	speed: 0.3002s/iter; left time: 1213.0113s
	iters: 500, epoch: 15 | loss: 0.2226249
	speed: 0.2998s/iter; left time: 1181.6903s
	iters: 600, epoch: 15 | loss: 0.2087347
	speed: 0.3002s/iter; left time: 1152.9227s
	iters: 700, epoch: 15 | loss: 0.2211094
	speed: 0.3021s/iter; left time: 1130.1047s
Epoch: 15 cost time: 222.56476354599
Epoch: 15, Steps: 740 | Train Loss: 0.2339142 Vali Loss: 0.3463411 Test Loss: 0.4226072
EarlyStopping counter: 2 out of 5
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 16 | loss: 0.2197003
	speed: 0.6073s/iter; left time: 2186.8733s
	iters: 200, epoch: 16 | loss: 0.2820653
	speed: 0.3000s/iter; left time: 1050.2659s
	iters: 300, epoch: 16 | loss: 0.2411981
	speed: 0.3000s/iter; left time: 1020.1781s
	iters: 400, epoch: 16 | loss: 0.2320756
	speed: 0.2999s/iter; left time: 989.9889s
	iters: 500, epoch: 16 | loss: 0.2246718
	speed: 0.3018s/iter; left time: 966.0715s
	iters: 600, epoch: 16 | loss: 0.2086054
	speed: 0.3009s/iter; left time: 933.0781s
	iters: 700, epoch: 16 | loss: 0.2368993
	speed: 0.3007s/iter; left time: 902.2733s
Epoch: 16 cost time: 222.33772492408752
Epoch: 16, Steps: 740 | Train Loss: 0.2338521 Vali Loss: 0.3465509 Test Loss: 0.4225956
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 17 | loss: 0.2617910
	speed: 0.6067s/iter; left time: 1735.8384s
	iters: 200, epoch: 17 | loss: 0.2664180
	speed: 0.3002s/iter; left time: 828.9769s
	iters: 300, epoch: 17 | loss: 0.2149277
	speed: 0.3013s/iter; left time: 801.7620s
	iters: 400, epoch: 17 | loss: 0.2178762
	speed: 0.3010s/iter; left time: 770.7338s
	iters: 500, epoch: 17 | loss: 0.2034195
	speed: 0.3003s/iter; left time: 739.1381s
	iters: 600, epoch: 17 | loss: 0.1963063
	speed: 0.3000s/iter; left time: 708.2901s
	iters: 700, epoch: 17 | loss: 0.2338361
	speed: 0.3013s/iter; left time: 681.3498s
Epoch: 17 cost time: 222.4520709514618
Epoch: 17, Steps: 740 | Train Loss: 0.2338123 Vali Loss: 0.3465801 Test Loss: 0.4225931
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 18 | loss: 0.2950160
	speed: 0.6096s/iter; left time: 1293.0149s
	iters: 200, epoch: 18 | loss: 0.2269699
	speed: 0.3009s/iter; left time: 608.0243s
	iters: 300, epoch: 18 | loss: 0.2322077
	speed: 0.3008s/iter; left time: 577.8462s
	iters: 400, epoch: 18 | loss: 0.2204740
	speed: 0.3020s/iter; left time: 550.0275s
	iters: 500, epoch: 18 | loss: 0.2386007
	speed: 0.3006s/iter; left time: 517.3538s
	iters: 600, epoch: 18 | loss: 0.2352173
	speed: 0.3014s/iter; left time: 488.6461s
	iters: 700, epoch: 18 | loss: 0.2205728
	speed: 0.3012s/iter; left time: 458.1351s
Epoch: 18 cost time: 222.78832149505615
Epoch: 18, Steps: 740 | Train Loss: 0.2338562 Vali Loss: 0.3466097 Test Loss: 0.4225920
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : traffic_336_96_NLinear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed15227<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3413
mse:0.42295944690704346, mae:0.2941911220550537
