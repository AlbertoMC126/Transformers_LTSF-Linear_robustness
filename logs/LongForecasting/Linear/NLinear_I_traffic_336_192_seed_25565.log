Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='NLinear', model_id='traffic_336_192', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=192, root_path='./dataset/', save_pred_values=False, seed=25565, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_336_192_NLinear_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed25565>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11753
val 1565
test 3317
	iters: 100, epoch: 1 | loss: 0.6185943
	speed: 0.3163s/iter; left time: 4611.3363s
	iters: 200, epoch: 1 | loss: 0.8280768
	speed: 0.3023s/iter; left time: 4378.2294s
	iters: 300, epoch: 1 | loss: 0.9276807
	speed: 0.3018s/iter; left time: 4339.6976s
	iters: 400, epoch: 1 | loss: 0.9045173
	speed: 0.3009s/iter; left time: 4296.5805s
	iters: 500, epoch: 1 | loss: 2.7400398
	speed: 0.3014s/iter; left time: 4274.8106s
	iters: 600, epoch: 1 | loss: 0.9207991
	speed: 0.3027s/iter; left time: 4262.1719s
	iters: 700, epoch: 1 | loss: 0.6902778
	speed: 0.3023s/iter; left time: 4226.4248s
Epoch: 1 cost time: 223.2694947719574
Epoch: 1, Steps: 734 | Train Loss: 1.1677011 Vali Loss: 1.0142978 Test Loss: 1.1662408
Validation loss decreased (inf --> 1.014298).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.6227344
	speed: 0.6081s/iter; left time: 8420.3298s
	iters: 200, epoch: 2 | loss: 0.7677572
	speed: 0.3014s/iter; left time: 4143.1887s
	iters: 300, epoch: 2 | loss: 2.0755038
	speed: 0.3013s/iter; left time: 4111.8156s
	iters: 400, epoch: 2 | loss: 0.7220039
	speed: 0.3020s/iter; left time: 4090.8748s
	iters: 500, epoch: 2 | loss: 1.3259550
	speed: 0.3010s/iter; left time: 4047.8573s
	iters: 600, epoch: 2 | loss: 0.8526908
	speed: 0.3017s/iter; left time: 4026.6635s
	iters: 700, epoch: 2 | loss: 0.7202644
	speed: 0.3005s/iter; left time: 3980.8246s
Epoch: 2 cost time: 221.12022256851196
Epoch: 2, Steps: 734 | Train Loss: 0.9449478 Vali Loss: 1.3076684 Test Loss: 1.7247617
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.3155127
	speed: 0.6053s/iter; left time: 7936.9925s
	iters: 200, epoch: 3 | loss: 0.3216466
	speed: 0.3027s/iter; left time: 3939.0608s
	iters: 300, epoch: 3 | loss: 0.3601090
	speed: 0.3018s/iter; left time: 3896.5234s
	iters: 400, epoch: 3 | loss: 0.3282240
	speed: 0.3024s/iter; left time: 3875.1987s
	iters: 500, epoch: 3 | loss: 0.3764853
	speed: 0.3020s/iter; left time: 3839.3523s
	iters: 600, epoch: 3 | loss: 0.3593383
	speed: 0.3016s/iter; left time: 3804.1229s
	iters: 700, epoch: 3 | loss: 0.3789540
	speed: 0.3021s/iter; left time: 3780.5748s
Epoch: 3 cost time: 221.53810262680054
Epoch: 3, Steps: 734 | Train Loss: 0.3660646 Vali Loss: 0.4965831 Test Loss: 0.6120961
Validation loss decreased (1.014298 --> 0.496583).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.3148595
	speed: 0.6078s/iter; left time: 7524.1608s
	iters: 200, epoch: 4 | loss: 0.3236192
	speed: 0.3010s/iter; left time: 3695.3670s
	iters: 300, epoch: 4 | loss: 0.2977016
	speed: 0.3007s/iter; left time: 3661.6439s
	iters: 400, epoch: 4 | loss: 0.2971256
	speed: 0.3023s/iter; left time: 3652.0056s
	iters: 500, epoch: 4 | loss: 0.2967285
	speed: 0.3019s/iter; left time: 3616.6085s
	iters: 600, epoch: 4 | loss: 0.2802275
	speed: 0.3027s/iter; left time: 3595.8124s
	iters: 700, epoch: 4 | loss: 0.3000823
	speed: 0.3009s/iter; left time: 3544.8524s
Epoch: 4 cost time: 221.4232702255249
Epoch: 4, Steps: 734 | Train Loss: 0.2855331 Vali Loss: 0.4099974 Test Loss: 0.5073982
Validation loss decreased (0.496583 --> 0.409997).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.2449805
	speed: 0.6066s/iter; left time: 7063.5213s
	iters: 200, epoch: 5 | loss: 0.2673560
	speed: 0.3012s/iter; left time: 3477.6750s
	iters: 300, epoch: 5 | loss: 0.2257089
	speed: 0.3015s/iter; left time: 3450.9979s
	iters: 400, epoch: 5 | loss: 0.2726890
	speed: 0.3017s/iter; left time: 3423.1204s
	iters: 500, epoch: 5 | loss: 0.2612111
	speed: 0.3018s/iter; left time: 3393.7633s
	iters: 600, epoch: 5 | loss: 0.2753585
	speed: 0.3017s/iter; left time: 3362.1766s
	iters: 700, epoch: 5 | loss: 0.2832963
	speed: 0.3023s/iter; left time: 3338.8573s
Epoch: 5 cost time: 221.36332535743713
Epoch: 5, Steps: 734 | Train Loss: 0.2649011 Vali Loss: 0.3828538 Test Loss: 0.4782261
Validation loss decreased (0.409997 --> 0.382854).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.2733672
	speed: 0.6109s/iter; left time: 6665.5914s
	iters: 200, epoch: 6 | loss: 0.2383581
	speed: 0.3016s/iter; left time: 3260.2295s
	iters: 300, epoch: 6 | loss: 0.2513146
	speed: 0.3023s/iter; left time: 3237.7372s
	iters: 400, epoch: 6 | loss: 0.2640319
	speed: 0.3003s/iter; left time: 3186.2242s
	iters: 500, epoch: 6 | loss: 0.2489398
	speed: 0.3019s/iter; left time: 3172.9841s
	iters: 600, epoch: 6 | loss: 0.2229432
	speed: 0.3019s/iter; left time: 3143.1986s
	iters: 700, epoch: 6 | loss: 0.2629463
	speed: 0.3019s/iter; left time: 3112.6384s
Epoch: 6 cost time: 221.56194067001343
Epoch: 6, Steps: 734 | Train Loss: 0.2545145 Vali Loss: 0.3631851 Test Loss: 0.4516997
Validation loss decreased (0.382854 --> 0.363185).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.2758504
	speed: 0.6090s/iter; left time: 6198.1827s
	iters: 200, epoch: 7 | loss: 0.2460060
	speed: 0.3025s/iter; left time: 3048.1272s
	iters: 300, epoch: 7 | loss: 0.2336597
	speed: 0.3030s/iter; left time: 3022.6325s
	iters: 400, epoch: 7 | loss: 0.2645448
	speed: 0.3022s/iter; left time: 2985.1714s
	iters: 500, epoch: 7 | loss: 0.2427836
	speed: 0.3010s/iter; left time: 2942.4375s
	iters: 600, epoch: 7 | loss: 0.2465844
	speed: 0.3017s/iter; left time: 2919.9718s
	iters: 700, epoch: 7 | loss: 0.2249975
	speed: 0.3007s/iter; left time: 2879.4532s
Epoch: 7 cost time: 221.55600118637085
Epoch: 7, Steps: 734 | Train Loss: 0.2488996 Vali Loss: 0.3566813 Test Loss: 0.4445800
Validation loss decreased (0.363185 --> 0.356681).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.2370782
	speed: 0.6081s/iter; left time: 5742.1272s
	iters: 200, epoch: 8 | loss: 0.2414987
	speed: 0.3017s/iter; left time: 2819.0628s
	iters: 300, epoch: 8 | loss: 0.2422838
	speed: 0.3023s/iter; left time: 2793.9858s
	iters: 400, epoch: 8 | loss: 0.2598678
	speed: 0.3025s/iter; left time: 2766.2009s
	iters: 500, epoch: 8 | loss: 0.2367083
	speed: 0.3023s/iter; left time: 2733.8793s
	iters: 600, epoch: 8 | loss: 0.2518085
	speed: 0.3019s/iter; left time: 2699.8306s
	iters: 700, epoch: 8 | loss: 0.2845649
	speed: 0.3009s/iter; left time: 2660.5308s
Epoch: 8 cost time: 221.5592975616455
Epoch: 8, Steps: 734 | Train Loss: 0.2456526 Vali Loss: 0.3528339 Test Loss: 0.4402855
Validation loss decreased (0.356681 --> 0.352834).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.2141598
	speed: 0.6068s/iter; left time: 5284.5219s
	iters: 200, epoch: 9 | loss: 0.2399958
	speed: 0.3012s/iter; left time: 2592.8628s
	iters: 300, epoch: 9 | loss: 0.2422910
	speed: 0.3013s/iter; left time: 2564.1301s
	iters: 400, epoch: 9 | loss: 0.2254033
	speed: 0.3024s/iter; left time: 2542.8639s
	iters: 500, epoch: 9 | loss: 0.2336016
	speed: 0.3030s/iter; left time: 2517.5738s
	iters: 600, epoch: 9 | loss: 0.2491215
	speed: 0.3033s/iter; left time: 2489.8538s
	iters: 700, epoch: 9 | loss: 0.2447722
	speed: 0.3025s/iter; left time: 2452.7278s
Epoch: 9 cost time: 221.71394062042236
Epoch: 9, Steps: 734 | Train Loss: 0.2437942 Vali Loss: 0.3509884 Test Loss: 0.4380776
Validation loss decreased (0.352834 --> 0.350988).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.2254745
	speed: 0.6084s/iter; left time: 4852.2342s
	iters: 200, epoch: 10 | loss: 0.2241803
	speed: 0.3017s/iter; left time: 2375.8642s
	iters: 300, epoch: 10 | loss: 0.2443366
	speed: 0.3021s/iter; left time: 2348.7862s
	iters: 400, epoch: 10 | loss: 0.2305902
	speed: 0.3025s/iter; left time: 2321.7426s
	iters: 500, epoch: 10 | loss: 0.2472645
	speed: 0.3029s/iter; left time: 2294.7242s
	iters: 600, epoch: 10 | loss: 0.2557256
	speed: 0.3035s/iter; left time: 2268.8568s
	iters: 700, epoch: 10 | loss: 0.2435175
	speed: 0.3031s/iter; left time: 2235.6136s
Epoch: 10 cost time: 222.05061721801758
Epoch: 10, Steps: 734 | Train Loss: 0.2427128 Vali Loss: 0.3503654 Test Loss: 0.4370355
Validation loss decreased (0.350988 --> 0.350365).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.2158261
	speed: 0.6086s/iter; left time: 4407.1357s
	iters: 200, epoch: 11 | loss: 0.2341630
	speed: 0.3016s/iter; left time: 2154.0781s
	iters: 300, epoch: 11 | loss: 0.2637746
	speed: 0.3003s/iter; left time: 2114.7355s
	iters: 400, epoch: 11 | loss: 0.2143186
	speed: 0.3009s/iter; left time: 2088.7545s
	iters: 500, epoch: 11 | loss: 0.2580731
	speed: 0.3024s/iter; left time: 2068.5762s
	iters: 600, epoch: 11 | loss: 0.2268026
	speed: 0.3022s/iter; left time: 2036.9823s
	iters: 700, epoch: 11 | loss: 0.2358697
	speed: 0.3018s/iter; left time: 2004.3467s
Epoch: 11 cost time: 221.3445725440979
Epoch: 11, Steps: 734 | Train Loss: 0.2420674 Vali Loss: 0.3500763 Test Loss: 0.4365883
Validation loss decreased (0.350365 --> 0.350076).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.2725951
	speed: 0.6084s/iter; left time: 3958.9358s
	iters: 200, epoch: 12 | loss: 0.2551013
	speed: 0.3019s/iter; left time: 1934.1190s
	iters: 300, epoch: 12 | loss: 0.2402738
	speed: 0.3004s/iter; left time: 1894.5367s
	iters: 400, epoch: 12 | loss: 0.2418742
	speed: 0.3000s/iter; left time: 1862.1284s
	iters: 500, epoch: 12 | loss: 0.2589363
	speed: 0.3001s/iter; left time: 1832.8398s
	iters: 600, epoch: 12 | loss: 0.2421824
	speed: 0.3018s/iter; left time: 1813.0236s
	iters: 700, epoch: 12 | loss: 0.2349061
	speed: 0.3016s/iter; left time: 1781.3054s
Epoch: 12 cost time: 221.06202602386475
Epoch: 12, Steps: 734 | Train Loss: 0.2417526 Vali Loss: 0.3495956 Test Loss: 0.4363425
Validation loss decreased (0.350076 --> 0.349596).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.2148440
	speed: 0.6093s/iter; left time: 3517.5748s
	iters: 200, epoch: 13 | loss: 0.2377724
	speed: 0.3032s/iter; left time: 1720.1109s
	iters: 300, epoch: 13 | loss: 0.2472723
	speed: 0.3019s/iter; left time: 1682.6973s
	iters: 400, epoch: 13 | loss: 0.2599473
	speed: 0.3022s/iter; left time: 1654.1584s
	iters: 500, epoch: 13 | loss: 0.2497051
	speed: 0.3021s/iter; left time: 1623.0418s
	iters: 600, epoch: 13 | loss: 0.2585581
	speed: 0.3006s/iter; left time: 1584.9032s
	iters: 700, epoch: 13 | loss: 0.2207474
	speed: 0.3028s/iter; left time: 1566.4307s
Epoch: 13 cost time: 221.8731291294098
Epoch: 13, Steps: 734 | Train Loss: 0.2415769 Vali Loss: 0.3494986 Test Loss: 0.4361699
Validation loss decreased (0.349596 --> 0.349499).  Saving model ...
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 14 | loss: 0.2560871
	speed: 0.6087s/iter; left time: 3067.2381s
	iters: 200, epoch: 14 | loss: 0.2453857
	speed: 0.3027s/iter; left time: 1494.8620s
	iters: 300, epoch: 14 | loss: 0.2448755
	speed: 0.3019s/iter; left time: 1461.1002s
	iters: 400, epoch: 14 | loss: 0.2363988
	speed: 0.3017s/iter; left time: 1429.6824s
	iters: 500, epoch: 14 | loss: 0.2299646
	speed: 0.3023s/iter; left time: 1402.4795s
	iters: 600, epoch: 14 | loss: 0.2342686
	speed: 0.3024s/iter; left time: 1372.4460s
	iters: 700, epoch: 14 | loss: 0.2111130
	speed: 0.3028s/iter; left time: 1344.0775s
Epoch: 14 cost time: 221.96706461906433
Epoch: 14, Steps: 734 | Train Loss: 0.2414670 Vali Loss: 0.3497045 Test Loss: 0.4361008
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 15 | loss: 0.2263536
	speed: 0.6085s/iter; left time: 2619.7879s
	iters: 200, epoch: 15 | loss: 0.2275801
	speed: 0.3022s/iter; left time: 1270.8375s
	iters: 300, epoch: 15 | loss: 0.2427564
	speed: 0.3036s/iter; left time: 1246.2773s
	iters: 400, epoch: 15 | loss: 0.2218184
	speed: 0.3005s/iter; left time: 1203.4934s
	iters: 500, epoch: 15 | loss: 0.2393003
	speed: 0.3007s/iter; left time: 1174.3831s
	iters: 600, epoch: 15 | loss: 0.2214380
	speed: 0.3015s/iter; left time: 1147.2891s
	iters: 700, epoch: 15 | loss: 0.2408300
	speed: 0.3016s/iter; left time: 1117.5067s
Epoch: 15 cost time: 221.64472842216492
Epoch: 15, Steps: 734 | Train Loss: 0.2413532 Vali Loss: 0.3494478 Test Loss: 0.4361263
Validation loss decreased (0.349499 --> 0.349448).  Saving model ...
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 16 | loss: 0.2436093
	speed: 0.6100s/iter; left time: 2178.4796s
	iters: 200, epoch: 16 | loss: 0.2456616
	speed: 0.3030s/iter; left time: 1051.6522s
	iters: 300, epoch: 16 | loss: 0.2512199
	speed: 0.3014s/iter; left time: 1015.8748s
	iters: 400, epoch: 16 | loss: 0.2461424
	speed: 0.3002s/iter; left time: 981.9765s
	iters: 500, epoch: 16 | loss: 0.2643139
	speed: 0.3017s/iter; left time: 956.6619s
	iters: 600, epoch: 16 | loss: 0.2268396
	speed: 0.3009s/iter; left time: 924.0277s
	iters: 700, epoch: 16 | loss: 0.2370174
	speed: 0.3013s/iter; left time: 895.0492s
Epoch: 16 cost time: 221.38724398612976
Epoch: 16, Steps: 734 | Train Loss: 0.2413805 Vali Loss: 0.3493226 Test Loss: 0.4361150
Validation loss decreased (0.349448 --> 0.349323).  Saving model ...
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 17 | loss: 0.2330818
	speed: 0.6108s/iter; left time: 1732.7338s
	iters: 200, epoch: 17 | loss: 0.2497007
	speed: 0.3034s/iter; left time: 830.3061s
	iters: 300, epoch: 17 | loss: 0.2577079
	speed: 0.3035s/iter; left time: 800.3518s
	iters: 400, epoch: 17 | loss: 0.2393140
	speed: 0.3029s/iter; left time: 768.4022s
	iters: 500, epoch: 17 | loss: 0.2428825
	speed: 0.3014s/iter; left time: 734.4591s
	iters: 600, epoch: 17 | loss: 0.2553619
	speed: 0.3002s/iter; left time: 701.5304s
	iters: 700, epoch: 17 | loss: 0.2531949
	speed: 0.3017s/iter; left time: 674.9517s
Epoch: 17 cost time: 221.82388353347778
Epoch: 17, Steps: 734 | Train Loss: 0.2413553 Vali Loss: 0.3492887 Test Loss: 0.4361151
Validation loss decreased (0.349323 --> 0.349289).  Saving model ...
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 18 | loss: 0.2601218
	speed: 0.6073s/iter; left time: 1277.2546s
	iters: 200, epoch: 18 | loss: 0.2440787
	speed: 0.3026s/iter; left time: 606.0824s
	iters: 300, epoch: 18 | loss: 0.2327013
	speed: 0.3023s/iter; left time: 575.3213s
	iters: 400, epoch: 18 | loss: 0.2241121
	speed: 0.3028s/iter; left time: 546.0161s
	iters: 500, epoch: 18 | loss: 0.2375094
	speed: 0.3024s/iter; left time: 514.9039s
	iters: 600, epoch: 18 | loss: 0.2621091
	speed: 0.3010s/iter; left time: 482.5647s
	iters: 700, epoch: 18 | loss: 0.2416359
	speed: 0.3015s/iter; left time: 453.0831s
Epoch: 18 cost time: 221.64569664001465
Epoch: 18, Steps: 734 | Train Loss: 0.2413628 Vali Loss: 0.3492542 Test Loss: 0.4361136
Validation loss decreased (0.349289 --> 0.349254).  Saving model ...
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 19 | loss: 0.2828788
	speed: 0.6069s/iter; left time: 830.8472s
	iters: 200, epoch: 19 | loss: 0.2409289
	speed: 0.3011s/iter; left time: 382.1078s
	iters: 300, epoch: 19 | loss: 0.2529037
	speed: 0.3025s/iter; left time: 353.5800s
	iters: 400, epoch: 19 | loss: 0.2530140
	speed: 0.3028s/iter; left time: 323.6755s
	iters: 500, epoch: 19 | loss: 0.2412460
	speed: 0.3026s/iter; left time: 293.1970s
	iters: 600, epoch: 19 | loss: 0.2475020
	speed: 0.3027s/iter; left time: 263.0800s
	iters: 700, epoch: 19 | loss: 0.2544792
	speed: 0.3019s/iter; left time: 232.1721s
Epoch: 19 cost time: 221.73715925216675
Epoch: 19, Steps: 734 | Train Loss: 0.2413569 Vali Loss: 0.3491565 Test Loss: 0.4361128
Validation loss decreased (0.349254 --> 0.349156).  Saving model ...
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 20 | loss: 0.2819694
	speed: 0.6081s/iter; left time: 386.1729s
	iters: 200, epoch: 20 | loss: 0.2592592
	speed: 0.3013s/iter; left time: 161.1904s
	iters: 300, epoch: 20 | loss: 0.2275952
	speed: 0.3016s/iter; left time: 131.2145s
	iters: 400, epoch: 20 | loss: 0.2746197
	speed: 0.3016s/iter; left time: 101.0275s
	iters: 500, epoch: 20 | loss: 0.2529333
	speed: 0.3021s/iter; left time: 71.0043s
	iters: 600, epoch: 20 | loss: 0.2427149
	speed: 0.3026s/iter; left time: 40.8530s
	iters: 700, epoch: 20 | loss: 0.2260527
	speed: 0.3033s/iter; left time: 10.6170s
Epoch: 20 cost time: 221.70974946022034
Epoch: 20, Steps: 734 | Train Loss: 0.2413411 Vali Loss: 0.3494791 Test Loss: 0.4361127
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.9073486328125e-08
>>>>>>>testing : traffic_336_192_NLinear_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed25565<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3317
mse:0.4357639253139496, mae:0.29878777265548706
