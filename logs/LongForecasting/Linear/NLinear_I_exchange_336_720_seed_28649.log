Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='exchange_rate.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=8, factor=1, features='M', freq='h', gpu=0, individual=True, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='mse', lradj='type1', model='NLinear', model_id='Exchange_336_720', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=5, pred_len=720, root_path='./dataset/', save_pred_values=False, seed=28649, seq_len=336, target='OT', test_flop=False, train_epochs=20, train_only=False, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : Exchange_336_720_NLinear_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed28649>>>>>>>>>>>>>>>>>>>>>>>>>>
train 4256
val 41
test 798
	iters: 100, epoch: 1 | loss: 0.5971919
	speed: 0.0203s/iter; left time: 51.9837s
Epoch: 1 cost time: 2.787379503250122
Epoch: 1, Steps: 133 | Train Loss: 0.7872146 Vali Loss: 1.2640885 Test Loss: 0.9209674
Validation loss decreased (inf --> 1.264089).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.7443629
	speed: 0.0319s/iter; left time: 77.4576s
Epoch: 2 cost time: 3.0024726390838623
Epoch: 2, Steps: 133 | Train Loss: 0.7672885 Vali Loss: 1.2530224 Test Loss: 0.9767581
Validation loss decreased (1.264089 --> 1.253022).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.7245897
	speed: 0.0293s/iter; left time: 67.1610s
Epoch: 3 cost time: 2.6734583377838135
Epoch: 3, Steps: 133 | Train Loss: 0.7609747 Vali Loss: 1.2180674 Test Loss: 0.9616168
Validation loss decreased (1.253022 --> 1.218067).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.8664782
	speed: 0.0316s/iter; left time: 68.3460s
Epoch: 4 cost time: 3.0109305381774902
Epoch: 4, Steps: 133 | Train Loss: 0.7575155 Vali Loss: 1.2404107 Test Loss: 0.9708127
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.6655213
	speed: 0.0337s/iter; left time: 68.2834s
Epoch: 5 cost time: 3.0730674266815186
Epoch: 5, Steps: 133 | Train Loss: 0.7554872 Vali Loss: 1.2011425 Test Loss: 0.9721155
Validation loss decreased (1.218067 --> 1.201143).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.7745653
	speed: 0.0321s/iter; left time: 60.8921s
Epoch: 6 cost time: 2.9839601516723633
Epoch: 6, Steps: 133 | Train Loss: 0.7548248 Vali Loss: 1.2316444 Test Loss: 0.9834033
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.8809836
	speed: 0.0282s/iter; left time: 49.6727s
Epoch: 7 cost time: 2.689291477203369
Epoch: 7, Steps: 133 | Train Loss: 0.7543353 Vali Loss: 1.2521135 Test Loss: 0.9833703
EarlyStopping counter: 2 out of 5
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.8095789
	speed: 0.0305s/iter; left time: 49.6612s
Epoch: 8 cost time: 2.7354836463928223
Epoch: 8, Steps: 133 | Train Loss: 0.7541167 Vali Loss: 1.1991432 Test Loss: 0.9839537
Validation loss decreased (1.201143 --> 1.199143).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.8747399
	speed: 0.0257s/iter; left time: 38.5050s
Epoch: 9 cost time: 2.316863775253296
Epoch: 9, Steps: 133 | Train Loss: 0.7539948 Vali Loss: 1.2449061 Test Loss: 0.9839807
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.9070453
	speed: 0.0264s/iter; left time: 36.0258s
Epoch: 10 cost time: 2.585846185684204
Epoch: 10, Steps: 133 | Train Loss: 0.7539183 Vali Loss: 1.2021279 Test Loss: 0.9845345
EarlyStopping counter: 2 out of 5
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 11 | loss: 0.5992631
	speed: 0.0280s/iter; left time: 34.4209s
Epoch: 11 cost time: 2.5678133964538574
Epoch: 11, Steps: 133 | Train Loss: 0.7538885 Vali Loss: 1.2247610 Test Loss: 0.9844536
EarlyStopping counter: 3 out of 5
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 12 | loss: 0.8017676
	speed: 0.0253s/iter; left time: 27.7901s
Epoch: 12 cost time: 2.308495283126831
Epoch: 12, Steps: 133 | Train Loss: 0.7538758 Vali Loss: 1.2171152 Test Loss: 0.9846127
EarlyStopping counter: 4 out of 5
Updating learning rate to 2.44140625e-07
	iters: 100, epoch: 13 | loss: 0.7839504
	speed: 0.0244s/iter; left time: 23.5488s
Epoch: 13 cost time: 2.2347052097320557
Epoch: 13, Steps: 133 | Train Loss: 0.7538673 Vali Loss: 1.2089684 Test Loss: 0.9846011
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : Exchange_336_720_NLinear_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0_seed28649<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 798
mse:0.9853473901748657, mae:0.7268342971801758
