Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=862, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=862, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Transformer', model_id='traffic_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=336, root_path='./dataset/', seed=10458, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_336_Transformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed10458>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11849
val 1421
test 3173
	iters: 100, epoch: 1 | loss: 0.5114152
	speed: 0.0935s/iter; left time: 336.7909s
	iters: 200, epoch: 1 | loss: 0.3665828
	speed: 0.0624s/iter; left time: 218.6113s
	iters: 300, epoch: 1 | loss: 0.3105736
	speed: 0.0624s/iter; left time: 212.3286s
Epoch: 1 cost time: 26.23373532295227
Epoch: 1, Steps: 370 | Train Loss: 0.4655208 Vali Loss: 0.5233386 Test Loss: 0.6769737
Validation loss decreased (inf --> 0.523339).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2685538
	speed: 0.2445s/iter; left time: 790.0862s
	iters: 200, epoch: 2 | loss: 0.2759188
	speed: 0.0636s/iter; left time: 199.2521s
	iters: 300, epoch: 2 | loss: 0.2540445
	speed: 0.0641s/iter; left time: 194.4116s
Epoch: 2 cost time: 23.673646450042725
Epoch: 2, Steps: 370 | Train Loss: 0.2643061 Vali Loss: 0.5163305 Test Loss: 0.6893573
Validation loss decreased (0.523339 --> 0.516331).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2379488
	speed: 0.2424s/iter; left time: 693.4513s
	iters: 200, epoch: 3 | loss: 0.2399258
	speed: 0.0626s/iter; left time: 172.7757s
	iters: 300, epoch: 3 | loss: 0.2371732
	speed: 0.0625s/iter; left time: 166.4221s
Epoch: 3 cost time: 23.23133420944214
Epoch: 3, Steps: 370 | Train Loss: 0.2363088 Vali Loss: 0.4996102 Test Loss: 0.6720669
Validation loss decreased (0.516331 --> 0.499610).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2291963
	speed: 0.2431s/iter; left time: 605.4420s
	iters: 200, epoch: 4 | loss: 0.2323863
	speed: 0.0629s/iter; left time: 150.4639s
	iters: 300, epoch: 4 | loss: 0.2297037
	speed: 0.0626s/iter; left time: 143.3687s
Epoch: 4 cost time: 23.27998638153076
Epoch: 4, Steps: 370 | Train Loss: 0.2266560 Vali Loss: 0.4943426 Test Loss: 0.6684644
Validation loss decreased (0.499610 --> 0.494343).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2290636
	speed: 0.2429s/iter; left time: 515.2462s
	iters: 200, epoch: 5 | loss: 0.2166514
	speed: 0.0639s/iter; left time: 129.1036s
	iters: 300, epoch: 5 | loss: 0.2226379
	speed: 0.0637s/iter; left time: 122.3150s
Epoch: 5 cost time: 23.655280828475952
Epoch: 5, Steps: 370 | Train Loss: 0.2219488 Vali Loss: 0.4934037 Test Loss: 0.6652642
Validation loss decreased (0.494343 --> 0.493404).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2232555
	speed: 0.2430s/iter; left time: 425.5256s
	iters: 200, epoch: 6 | loss: 0.2112239
	speed: 0.0627s/iter; left time: 103.5433s
	iters: 300, epoch: 6 | loss: 0.2186097
	speed: 0.0625s/iter; left time: 97.0053s
Epoch: 6 cost time: 23.232446670532227
Epoch: 6, Steps: 370 | Train Loss: 0.2196094 Vali Loss: 0.4921236 Test Loss: 0.6666161
Validation loss decreased (0.493404 --> 0.492124).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2234119
	speed: 0.2427s/iter; left time: 335.1447s
	iters: 200, epoch: 7 | loss: 0.2070072
	speed: 0.0628s/iter; left time: 80.4817s
	iters: 300, epoch: 7 | loss: 0.2158961
	speed: 0.0625s/iter; left time: 73.8688s
Epoch: 7 cost time: 23.23349404335022
Epoch: 7, Steps: 370 | Train Loss: 0.2183431 Vali Loss: 0.4918897 Test Loss: 0.6668077
Validation loss decreased (0.492124 --> 0.491890).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2298074
	speed: 0.2406s/iter; left time: 243.2903s
	iters: 200, epoch: 8 | loss: 0.2200245
	speed: 0.0630s/iter; left time: 57.3663s
	iters: 300, epoch: 8 | loss: 0.2209692
	speed: 0.0641s/iter; left time: 51.9806s
Epoch: 8 cost time: 23.451972484588623
Epoch: 8, Steps: 370 | Train Loss: 0.2176004 Vali Loss: 0.4924698 Test Loss: 0.6660083
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2145159
	speed: 0.2399s/iter; left time: 153.7783s
	iters: 200, epoch: 9 | loss: 0.2152521
	speed: 0.0625s/iter; left time: 33.8330s
	iters: 300, epoch: 9 | loss: 0.2240710
	speed: 0.0623s/iter; left time: 27.4932s
Epoch: 9 cost time: 23.26524066925049
Epoch: 9, Steps: 370 | Train Loss: 0.2173038 Vali Loss: 0.4919589 Test Loss: 0.6658274
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2174210
	speed: 0.2377s/iter; left time: 64.4039s
	iters: 200, epoch: 10 | loss: 0.2173221
	speed: 0.0623s/iter; left time: 10.6591s
	iters: 300, epoch: 10 | loss: 0.2187366
	speed: 0.0624s/iter; left time: 4.4315s
Epoch: 10 cost time: 23.20012664794922
Epoch: 10, Steps: 370 | Train Loss: 0.2170907 Vali Loss: 0.4926085 Test Loss: 0.6665224
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : traffic_336_Transformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed10458<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3173
mse:0.6654483079910278, mae:0.360466867685318
