Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=862, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=862, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Transformer', model_id='traffic_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=96, root_path='./dataset/', seed=12890, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_96_Transformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed12890>>>>>>>>>>>>>>>>>>>>>>>>>>
train 12089
val 1661
test 3413
	iters: 100, epoch: 1 | loss: 0.5271193
	speed: 0.0684s/iter; left time: 251.0730s
	iters: 200, epoch: 1 | loss: 0.3933542
	speed: 0.0363s/iter; left time: 129.5875s
	iters: 300, epoch: 1 | loss: 0.3334162
	speed: 0.0364s/iter; left time: 126.4014s
Epoch: 1 cost time: 16.952005624771118
Epoch: 1, Steps: 377 | Train Loss: 0.4661469 Vali Loss: 0.5498062 Test Loss: 0.7023084
Validation loss decreased (inf --> 0.549806).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2694524
	speed: 0.1294s/iter; left time: 426.1900s
	iters: 200, epoch: 2 | loss: 0.2418161
	speed: 0.0357s/iter; left time: 114.0534s
	iters: 300, epoch: 2 | loss: 0.2580311
	speed: 0.0359s/iter; left time: 110.9773s
Epoch: 2 cost time: 13.607105731964111
Epoch: 2, Steps: 377 | Train Loss: 0.2614294 Vali Loss: 0.5003617 Test Loss: 0.6680261
Validation loss decreased (0.549806 --> 0.500362).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2314209
	speed: 0.1288s/iter; left time: 375.6042s
	iters: 200, epoch: 3 | loss: 0.2275370
	speed: 0.0358s/iter; left time: 100.7980s
	iters: 300, epoch: 3 | loss: 0.2155541
	speed: 0.0374s/iter; left time: 101.6488s
Epoch: 3 cost time: 13.933228492736816
Epoch: 3, Steps: 377 | Train Loss: 0.2312534 Vali Loss: 0.4973105 Test Loss: 0.6637582
Validation loss decreased (0.500362 --> 0.497310).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2157248
	speed: 0.1317s/iter; left time: 334.4532s
	iters: 200, epoch: 4 | loss: 0.2236781
	speed: 0.0387s/iter; left time: 94.3363s
	iters: 300, epoch: 4 | loss: 0.2212478
	speed: 0.0384s/iter; left time: 89.8340s
Epoch: 4 cost time: 14.569324970245361
Epoch: 4, Steps: 377 | Train Loss: 0.2216139 Vali Loss: 0.4908318 Test Loss: 0.6593081
Validation loss decreased (0.497310 --> 0.490832).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2274847
	speed: 0.1306s/iter; left time: 282.4100s
	iters: 200, epoch: 5 | loss: 0.2085702
	speed: 0.0363s/iter; left time: 74.7854s
	iters: 300, epoch: 5 | loss: 0.2260477
	speed: 0.0361s/iter; left time: 70.8763s
Epoch: 5 cost time: 13.688937187194824
Epoch: 5, Steps: 377 | Train Loss: 0.2172304 Vali Loss: 0.4917354 Test Loss: 0.6611117
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2182214
	speed: 0.1257s/iter; left time: 224.5498s
	iters: 200, epoch: 6 | loss: 0.2087251
	speed: 0.0361s/iter; left time: 60.7931s
	iters: 300, epoch: 6 | loss: 0.2232373
	speed: 0.0362s/iter; left time: 57.3631s
Epoch: 6 cost time: 13.655256509780884
Epoch: 6, Steps: 377 | Train Loss: 0.2148662 Vali Loss: 0.4903965 Test Loss: 0.6594653
Validation loss decreased (0.490832 --> 0.490397).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2037658
	speed: 0.1281s/iter; left time: 180.4906s
	iters: 200, epoch: 7 | loss: 0.2181452
	speed: 0.0359s/iter; left time: 46.9888s
	iters: 300, epoch: 7 | loss: 0.2189994
	speed: 0.0359s/iter; left time: 43.4605s
Epoch: 7 cost time: 13.646091222763062
Epoch: 7, Steps: 377 | Train Loss: 0.2137387 Vali Loss: 0.4909941 Test Loss: 0.6602746
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2010702
	speed: 0.1255s/iter; left time: 129.5203s
	iters: 200, epoch: 8 | loss: 0.2235285
	speed: 0.0356s/iter; left time: 33.2181s
	iters: 300, epoch: 8 | loss: 0.2294197
	speed: 0.0357s/iter; left time: 29.7337s
Epoch: 8 cost time: 13.520296573638916
Epoch: 8, Steps: 377 | Train Loss: 0.2130668 Vali Loss: 0.4936626 Test Loss: 0.6621193
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2032725
	speed: 0.1245s/iter; left time: 81.5742s
	iters: 200, epoch: 9 | loss: 0.1982952
	speed: 0.0358s/iter; left time: 19.8535s
	iters: 300, epoch: 9 | loss: 0.1998052
	speed: 0.0381s/iter; left time: 17.3207s
Epoch: 9 cost time: 13.913427829742432
Epoch: 9, Steps: 377 | Train Loss: 0.2126223 Vali Loss: 0.4914876 Test Loss: 0.6615334
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : traffic_96_Transformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed12890<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3413
mse:0.6596241593360901, mae:0.3621373176574707
