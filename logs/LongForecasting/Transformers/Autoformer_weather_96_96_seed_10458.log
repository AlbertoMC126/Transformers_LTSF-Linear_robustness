Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=21, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=21, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Autoformer', model_id='weather_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=96, root_path='./dataset/', seed=10458, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_96_Autoformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed10458>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36696
val 5175
test 10444
	iters: 100, epoch: 1 | loss: 0.3889786
	speed: 0.0830s/iter; left time: 943.4417s
	iters: 200, epoch: 1 | loss: 0.3806390
	speed: 0.0475s/iter; left time: 534.7959s
	iters: 300, epoch: 1 | loss: 0.3420319
	speed: 0.0479s/iter; left time: 534.2515s
	iters: 400, epoch: 1 | loss: 0.3829525
	speed: 0.0478s/iter; left time: 529.0541s
	iters: 500, epoch: 1 | loss: 0.2912575
	speed: 0.0478s/iter; left time: 523.7265s
	iters: 600, epoch: 1 | loss: 0.2773780
	speed: 0.0477s/iter; left time: 518.0845s
	iters: 700, epoch: 1 | loss: 0.5647024
	speed: 0.0479s/iter; left time: 515.0675s
	iters: 800, epoch: 1 | loss: 0.3010512
	speed: 0.0481s/iter; left time: 512.5338s
	iters: 900, epoch: 1 | loss: 0.5347074
	speed: 0.0484s/iter; left time: 511.2175s
	iters: 1000, epoch: 1 | loss: 0.3732401
	speed: 0.0485s/iter; left time: 507.0145s
	iters: 1100, epoch: 1 | loss: 0.6449666
	speed: 0.0485s/iter; left time: 502.8563s
Epoch: 1 cost time: 58.554482221603394
Epoch: 1, Steps: 1146 | Train Loss: 0.4970661 Vali Loss: 0.4985617 Test Loss: 0.2455259
Validation loss decreased (inf --> 0.498562).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3236189
	speed: 0.2105s/iter; left time: 2149.8615s
	iters: 200, epoch: 2 | loss: 0.3674051
	speed: 0.0479s/iter; left time: 484.4759s
	iters: 300, epoch: 2 | loss: 0.4714230
	speed: 0.0480s/iter; left time: 480.5675s
	iters: 400, epoch: 2 | loss: 0.2657531
	speed: 0.0482s/iter; left time: 478.1707s
	iters: 500, epoch: 2 | loss: 0.3569567
	speed: 0.0480s/iter; left time: 470.7098s
	iters: 600, epoch: 2 | loss: 0.2923778
	speed: 0.0478s/iter; left time: 464.7545s
	iters: 700, epoch: 2 | loss: 0.3074464
	speed: 0.0479s/iter; left time: 460.6545s
	iters: 800, epoch: 2 | loss: 0.2750856
	speed: 0.0479s/iter; left time: 455.4889s
	iters: 900, epoch: 2 | loss: 0.2840986
	speed: 0.0477s/iter; left time: 449.5485s
	iters: 1000, epoch: 2 | loss: 0.2871391
	speed: 0.0480s/iter; left time: 446.9049s
	iters: 1100, epoch: 2 | loss: 1.2584460
	speed: 0.0479s/iter; left time: 441.6580s
Epoch: 2 cost time: 54.94844627380371
Epoch: 2, Steps: 1146 | Train Loss: 0.4319475 Vali Loss: 0.4960932 Test Loss: 0.2370885
Validation loss decreased (0.498562 --> 0.496093).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3933143
	speed: 0.2099s/iter; left time: 1904.0035s
	iters: 200, epoch: 3 | loss: 0.2360154
	speed: 0.0479s/iter; left time: 429.4429s
	iters: 300, epoch: 3 | loss: 0.3697193
	speed: 0.0478s/iter; left time: 423.6457s
	iters: 400, epoch: 3 | loss: 0.4394039
	speed: 0.0478s/iter; left time: 419.3154s
	iters: 500, epoch: 3 | loss: 0.3120754
	speed: 0.0478s/iter; left time: 414.1971s
	iters: 600, epoch: 3 | loss: 0.3113717
	speed: 0.0477s/iter; left time: 409.1640s
	iters: 700, epoch: 3 | loss: 0.4098477
	speed: 0.0479s/iter; left time: 405.2806s
	iters: 800, epoch: 3 | loss: 0.4380455
	speed: 0.0479s/iter; left time: 400.6125s
	iters: 900, epoch: 3 | loss: 0.4287255
	speed: 0.0479s/iter; left time: 396.1618s
	iters: 1000, epoch: 3 | loss: 0.3145753
	speed: 0.0478s/iter; left time: 390.8598s
	iters: 1100, epoch: 3 | loss: 0.3030156
	speed: 0.0479s/iter; left time: 386.7655s
Epoch: 3 cost time: 54.838538646698
Epoch: 3, Steps: 1146 | Train Loss: 0.3847875 Vali Loss: 0.5029767 Test Loss: 0.2769263
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2818220
	speed: 0.2076s/iter; left time: 1644.4475s
	iters: 200, epoch: 4 | loss: 0.2469415
	speed: 0.0480s/iter; left time: 375.1957s
	iters: 300, epoch: 4 | loss: 0.3041224
	speed: 0.0479s/iter; left time: 370.0663s
	iters: 400, epoch: 4 | loss: 0.2519593
	speed: 0.0478s/iter; left time: 364.6865s
	iters: 500, epoch: 4 | loss: 0.2641218
	speed: 0.0479s/iter; left time: 360.2165s
	iters: 600, epoch: 4 | loss: 0.3267952
	speed: 0.0480s/iter; left time: 355.9402s
	iters: 700, epoch: 4 | loss: 0.2865216
	speed: 0.0479s/iter; left time: 350.8729s
	iters: 800, epoch: 4 | loss: 0.2759098
	speed: 0.0477s/iter; left time: 344.4407s
	iters: 900, epoch: 4 | loss: 0.2822446
	speed: 0.0478s/iter; left time: 340.6459s
	iters: 1000, epoch: 4 | loss: 0.2026625
	speed: 0.0477s/iter; left time: 335.1938s
	iters: 1100, epoch: 4 | loss: 0.2588685
	speed: 0.0477s/iter; left time: 330.3966s
Epoch: 4 cost time: 54.81568193435669
Epoch: 4, Steps: 1146 | Train Loss: 0.3558947 Vali Loss: 0.5012723 Test Loss: 0.2669517
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3147598
	speed: 0.2062s/iter; left time: 1397.4775s
	iters: 200, epoch: 5 | loss: 0.2706530
	speed: 0.0478s/iter; left time: 319.1948s
	iters: 300, epoch: 5 | loss: 0.2416256
	speed: 0.0478s/iter; left time: 314.5409s
	iters: 400, epoch: 5 | loss: 1.6337293
	speed: 0.0479s/iter; left time: 310.4990s
	iters: 500, epoch: 5 | loss: 0.2395802
	speed: 0.0477s/iter; left time: 304.3565s
	iters: 600, epoch: 5 | loss: 0.2286146
	speed: 0.0477s/iter; left time: 299.4648s
	iters: 700, epoch: 5 | loss: 0.3758737
	speed: 0.0477s/iter; left time: 294.4087s
	iters: 800, epoch: 5 | loss: 0.2649755
	speed: 0.0477s/iter; left time: 289.8065s
	iters: 900, epoch: 5 | loss: 0.3097991
	speed: 0.0477s/iter; left time: 285.1356s
	iters: 1000, epoch: 5 | loss: 0.2601210
	speed: 0.0479s/iter; left time: 281.4122s
	iters: 1100, epoch: 5 | loss: 0.3702428
	speed: 0.0477s/iter; left time: 275.8034s
Epoch: 5 cost time: 54.7349591255188
Epoch: 5, Steps: 1146 | Train Loss: 0.3414757 Vali Loss: 0.5040776 Test Loss: 0.2644974
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : weather_96_Autoformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed10458<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
mse:0.2374500334262848, mae:0.3118373155593872
