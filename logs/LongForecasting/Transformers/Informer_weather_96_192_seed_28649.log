Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=21, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=21, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Informer', model_id='weather_192', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=192, root_path='./dataset/', seed=28649, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_192_Informer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed28649>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36600
val 5079
test 10348
	iters: 100, epoch: 1 | loss: 0.3563049
	speed: 0.0644s/iter; left time: 729.9695s
	iters: 200, epoch: 1 | loss: 0.5112486
	speed: 0.0338s/iter; left time: 379.5133s
	iters: 300, epoch: 1 | loss: 0.4045415
	speed: 0.0338s/iter; left time: 376.7372s
	iters: 400, epoch: 1 | loss: 0.2860820
	speed: 0.0337s/iter; left time: 371.7621s
	iters: 500, epoch: 1 | loss: 0.7898017
	speed: 0.0333s/iter; left time: 364.5287s
	iters: 600, epoch: 1 | loss: 0.3720524
	speed: 0.0334s/iter; left time: 362.2868s
	iters: 700, epoch: 1 | loss: 0.3089858
	speed: 0.0334s/iter; left time: 357.9109s
	iters: 800, epoch: 1 | loss: 0.3696885
	speed: 0.0336s/iter; left time: 356.7050s
	iters: 900, epoch: 1 | loss: 0.2508910
	speed: 0.0336s/iter; left time: 353.6939s
	iters: 1000, epoch: 1 | loss: 0.3818311
	speed: 0.0336s/iter; left time: 349.9850s
	iters: 1100, epoch: 1 | loss: 0.8359150
	speed: 0.0335s/iter; left time: 346.2868s
Epoch: 1 cost time: 41.46824097633362
Epoch: 1, Steps: 1143 | Train Loss: 0.4404559 Vali Loss: 0.6147282 Test Loss: 0.7168230
Validation loss decreased (inf --> 0.614728).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2962674
	speed: 0.1129s/iter; left time: 1150.3335s
	iters: 200, epoch: 2 | loss: 0.3385034
	speed: 0.0336s/iter; left time: 339.3426s
	iters: 300, epoch: 2 | loss: 0.2900293
	speed: 0.0335s/iter; left time: 334.7148s
	iters: 400, epoch: 2 | loss: 0.2041978
	speed: 0.0334s/iter; left time: 330.7094s
	iters: 500, epoch: 2 | loss: 0.3446649
	speed: 0.0335s/iter; left time: 327.6793s
	iters: 600, epoch: 2 | loss: 0.6876866
	speed: 0.0335s/iter; left time: 324.3119s
	iters: 700, epoch: 2 | loss: 0.2744116
	speed: 0.0335s/iter; left time: 321.0223s
	iters: 800, epoch: 2 | loss: 1.1781982
	speed: 0.0336s/iter; left time: 318.8729s
	iters: 900, epoch: 2 | loss: 0.2380664
	speed: 0.0334s/iter; left time: 313.3580s
	iters: 1000, epoch: 2 | loss: 0.2498920
	speed: 0.0334s/iter; left time: 310.0022s
	iters: 1100, epoch: 2 | loss: 0.5409781
	speed: 0.0334s/iter; left time: 306.9207s
Epoch: 2 cost time: 38.32244348526001
Epoch: 2, Steps: 1143 | Train Loss: 0.3456601 Vali Loss: 0.5637768 Test Loss: 0.5128368
Validation loss decreased (0.614728 --> 0.563777).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1692111
	speed: 0.1129s/iter; left time: 1020.7553s
	iters: 200, epoch: 3 | loss: 0.4017521
	speed: 0.0350s/iter; left time: 313.0358s
	iters: 300, epoch: 3 | loss: 0.2030976
	speed: 0.0350s/iter; left time: 310.0152s
	iters: 400, epoch: 3 | loss: 0.2875230
	speed: 0.0353s/iter; left time: 308.5615s
	iters: 500, epoch: 3 | loss: 0.1718326
	speed: 0.0353s/iter; left time: 305.4491s
	iters: 600, epoch: 3 | loss: 0.3166923
	speed: 0.0354s/iter; left time: 302.5213s
	iters: 700, epoch: 3 | loss: 0.2450956
	speed: 0.0351s/iter; left time: 296.2450s
	iters: 800, epoch: 3 | loss: 0.2995419
	speed: 0.0340s/iter; left time: 283.9462s
	iters: 900, epoch: 3 | loss: 0.2891861
	speed: 0.0339s/iter; left time: 279.4021s
	iters: 1000, epoch: 3 | loss: 0.2337400
	speed: 0.0335s/iter; left time: 272.8503s
	iters: 1100, epoch: 3 | loss: 0.2526532
	speed: 0.0337s/iter; left time: 271.4768s
Epoch: 3 cost time: 39.58148550987244
Epoch: 3, Steps: 1143 | Train Loss: 0.2791791 Vali Loss: 0.5496207 Test Loss: 0.4676320
Validation loss decreased (0.563777 --> 0.549621).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1874594
	speed: 0.1111s/iter; left time: 878.2582s
	iters: 200, epoch: 4 | loss: 0.2866400
	speed: 0.0340s/iter; left time: 264.9200s
	iters: 300, epoch: 4 | loss: 0.2046515
	speed: 0.0338s/iter; left time: 260.5216s
	iters: 400, epoch: 4 | loss: 0.1943435
	speed: 0.0339s/iter; left time: 257.4137s
	iters: 500, epoch: 4 | loss: 0.2398680
	speed: 0.0336s/iter; left time: 251.9211s
	iters: 600, epoch: 4 | loss: 0.5583549
	speed: 0.0336s/iter; left time: 249.0519s
	iters: 700, epoch: 4 | loss: 0.2306381
	speed: 0.0337s/iter; left time: 245.9903s
	iters: 800, epoch: 4 | loss: 0.1673733
	speed: 0.0342s/iter; left time: 246.0369s
	iters: 900, epoch: 4 | loss: 0.1886979
	speed: 0.0339s/iter; left time: 240.6645s
	iters: 1000, epoch: 4 | loss: 0.1305974
	speed: 0.0342s/iter; left time: 239.3012s
	iters: 1100, epoch: 4 | loss: 0.4389361
	speed: 0.0337s/iter; left time: 232.8438s
Epoch: 4 cost time: 38.670435667037964
Epoch: 4, Steps: 1143 | Train Loss: 0.2516614 Vali Loss: 0.5594178 Test Loss: 0.4841321
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1860095
	speed: 0.1084s/iter; left time: 732.7348s
	iters: 200, epoch: 5 | loss: 0.1435031
	speed: 0.0339s/iter; left time: 225.4389s
	iters: 300, epoch: 5 | loss: 0.1854435
	speed: 0.0337s/iter; left time: 220.7538s
	iters: 400, epoch: 5 | loss: 0.1901655
	speed: 0.0337s/iter; left time: 217.5253s
	iters: 500, epoch: 5 | loss: 0.5065373
	speed: 0.0337s/iter; left time: 214.4768s
	iters: 600, epoch: 5 | loss: 0.2423279
	speed: 0.0339s/iter; left time: 212.0745s
	iters: 700, epoch: 5 | loss: 0.2976331
	speed: 0.0338s/iter; left time: 208.2911s
	iters: 800, epoch: 5 | loss: 0.2539107
	speed: 0.0346s/iter; left time: 209.5578s
	iters: 900, epoch: 5 | loss: 0.2501528
	speed: 0.0348s/iter; left time: 207.2176s
	iters: 1000, epoch: 5 | loss: 0.1825338
	speed: 0.0348s/iter; left time: 204.1838s
	iters: 1100, epoch: 5 | loss: 0.1967953
	speed: 0.0348s/iter; left time: 200.6109s
Epoch: 5 cost time: 39.05463671684265
Epoch: 5, Steps: 1143 | Train Loss: 0.2391837 Vali Loss: 0.5549824 Test Loss: 0.4819881
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1302710
	speed: 0.1103s/iter; left time: 619.6234s
	iters: 200, epoch: 6 | loss: 0.1782711
	speed: 0.0346s/iter; left time: 190.7245s
	iters: 300, epoch: 6 | loss: 0.1438929
	speed: 0.0343s/iter; left time: 185.9623s
	iters: 400, epoch: 6 | loss: 0.1429064
	speed: 0.0339s/iter; left time: 179.9842s
	iters: 500, epoch: 6 | loss: 0.1720995
	speed: 0.0340s/iter; left time: 177.4541s
	iters: 600, epoch: 6 | loss: 0.2008470
	speed: 0.0338s/iter; left time: 172.8349s
	iters: 700, epoch: 6 | loss: 0.1421152
	speed: 0.0338s/iter; left time: 169.3289s
	iters: 800, epoch: 6 | loss: 0.1266992
	speed: 0.0336s/iter; left time: 165.2661s
	iters: 900, epoch: 6 | loss: 0.1667331
	speed: 0.0336s/iter; left time: 162.0002s
	iters: 1000, epoch: 6 | loss: 0.2535977
	speed: 0.0337s/iter; left time: 158.9904s
	iters: 1100, epoch: 6 | loss: 0.2683012
	speed: 0.0341s/iter; left time: 157.1824s
Epoch: 6 cost time: 38.858978509902954
Epoch: 6, Steps: 1143 | Train Loss: 0.2333537 Vali Loss: 0.5617672 Test Loss: 0.4873722
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : weather_192_Informer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed28649<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10348
mse:0.4678879380226135, mae:0.47402483224868774
