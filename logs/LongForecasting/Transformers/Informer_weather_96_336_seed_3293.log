Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=21, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=21, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Informer', model_id='weather_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=336, root_path='./dataset/', seed=3293, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_336_Informer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed3293>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36456
val 4935
test 10204
	iters: 100, epoch: 1 | loss: 0.5158467
	speed: 0.0733s/iter; left time: 827.4906s
	iters: 200, epoch: 1 | loss: 0.7563747
	speed: 0.0419s/iter; left time: 469.3023s
	iters: 300, epoch: 1 | loss: 0.3828750
	speed: 0.0422s/iter; left time: 467.8007s
	iters: 400, epoch: 1 | loss: 0.4283418
	speed: 0.0424s/iter; left time: 466.3212s
	iters: 500, epoch: 1 | loss: 0.8844069
	speed: 0.0425s/iter; left time: 462.6317s
	iters: 600, epoch: 1 | loss: 0.9411604
	speed: 0.0424s/iter; left time: 457.8436s
	iters: 700, epoch: 1 | loss: 0.3701088
	speed: 0.0427s/iter; left time: 456.6478s
	iters: 800, epoch: 1 | loss: 0.4233623
	speed: 0.0427s/iter; left time: 452.3995s
	iters: 900, epoch: 1 | loss: 0.3387836
	speed: 0.0423s/iter; left time: 443.9992s
	iters: 1000, epoch: 1 | loss: 0.3998569
	speed: 0.0423s/iter; left time: 439.0750s
	iters: 1100, epoch: 1 | loss: 0.2434201
	speed: 0.0423s/iter; left time: 435.2984s
Epoch: 1 cost time: 51.37758779525757
Epoch: 1, Steps: 1139 | Train Loss: 0.4750647 Vali Loss: 0.6936267 Test Loss: 0.6063296
Validation loss decreased (inf --> 0.693627).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3194152
	speed: 0.1384s/iter; left time: 1404.9686s
	iters: 200, epoch: 2 | loss: 0.6124616
	speed: 0.0426s/iter; left time: 427.7282s
	iters: 300, epoch: 2 | loss: 0.2316853
	speed: 0.0424s/iter; left time: 422.2320s
	iters: 400, epoch: 2 | loss: 0.7702621
	speed: 0.0424s/iter; left time: 417.7184s
	iters: 500, epoch: 2 | loss: 0.2776026
	speed: 0.0423s/iter; left time: 412.6502s
	iters: 600, epoch: 2 | loss: 0.2498564
	speed: 0.0423s/iter; left time: 408.3996s
	iters: 700, epoch: 2 | loss: 0.2495580
	speed: 0.0433s/iter; left time: 413.3692s
	iters: 800, epoch: 2 | loss: 0.3657110
	speed: 0.0436s/iter; left time: 411.7670s
	iters: 900, epoch: 2 | loss: 0.2318197
	speed: 0.0437s/iter; left time: 408.5844s
	iters: 1000, epoch: 2 | loss: 0.4354225
	speed: 0.0433s/iter; left time: 400.7911s
	iters: 1100, epoch: 2 | loss: 0.3244674
	speed: 0.0433s/iter; left time: 396.6090s
Epoch: 2 cost time: 48.84051442146301
Epoch: 2, Steps: 1139 | Train Loss: 0.3642283 Vali Loss: 0.6525065 Test Loss: 0.5400888
Validation loss decreased (0.693627 --> 0.652506).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2667573
	speed: 0.1412s/iter; left time: 1272.2141s
	iters: 200, epoch: 3 | loss: 0.3001863
	speed: 0.0424s/iter; left time: 377.9008s
	iters: 300, epoch: 3 | loss: 0.6728617
	speed: 0.0426s/iter; left time: 375.7692s
	iters: 400, epoch: 3 | loss: 0.1796820
	speed: 0.0426s/iter; left time: 371.4660s
	iters: 500, epoch: 3 | loss: 0.2356434
	speed: 0.0423s/iter; left time: 364.5626s
	iters: 600, epoch: 3 | loss: 0.2516999
	speed: 0.0423s/iter; left time: 360.3968s
	iters: 700, epoch: 3 | loss: 0.1944430
	speed: 0.0423s/iter; left time: 355.8024s
	iters: 800, epoch: 3 | loss: 0.2401244
	speed: 0.0425s/iter; left time: 353.0647s
	iters: 900, epoch: 3 | loss: 0.4678946
	speed: 0.0425s/iter; left time: 349.2703s
	iters: 1000, epoch: 3 | loss: 0.3825880
	speed: 0.0424s/iter; left time: 343.7225s
	iters: 1100, epoch: 3 | loss: 0.2530421
	speed: 0.0423s/iter; left time: 339.2723s
Epoch: 3 cost time: 48.31352639198303
Epoch: 3, Steps: 1139 | Train Loss: 0.2918767 Vali Loss: 0.6943265 Test Loss: 0.6130014
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2721974
	speed: 0.1358s/iter; left time: 1069.0065s
	iters: 200, epoch: 4 | loss: 0.3901812
	speed: 0.0422s/iter; left time: 328.3659s
	iters: 300, epoch: 4 | loss: 0.1918435
	speed: 0.0421s/iter; left time: 323.2084s
	iters: 400, epoch: 4 | loss: 0.3727198
	speed: 0.0421s/iter; left time: 319.0194s
	iters: 500, epoch: 4 | loss: 0.1972378
	speed: 0.0421s/iter; left time: 314.8850s
	iters: 600, epoch: 4 | loss: 0.2578324
	speed: 0.0421s/iter; left time: 310.3679s
	iters: 700, epoch: 4 | loss: 0.2295325
	speed: 0.0421s/iter; left time: 306.5225s
	iters: 800, epoch: 4 | loss: 0.3822253
	speed: 0.0421s/iter; left time: 302.0940s
	iters: 900, epoch: 4 | loss: 0.3391985
	speed: 0.0435s/iter; left time: 308.0392s
	iters: 1000, epoch: 4 | loss: 0.2018479
	speed: 0.0435s/iter; left time: 303.5462s
	iters: 1100, epoch: 4 | loss: 0.1666915
	speed: 0.0437s/iter; left time: 300.3047s
Epoch: 4 cost time: 48.53525352478027
Epoch: 4, Steps: 1139 | Train Loss: 0.2629149 Vali Loss: 0.6792463 Test Loss: 0.5964187
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2055898
	speed: 0.1385s/iter; left time: 932.4770s
	iters: 200, epoch: 5 | loss: 0.1448716
	speed: 0.0432s/iter; left time: 286.5557s
	iters: 300, epoch: 5 | loss: 0.1862729
	speed: 0.0423s/iter; left time: 276.4905s
	iters: 400, epoch: 5 | loss: 0.1548209
	speed: 0.0424s/iter; left time: 273.1079s
	iters: 500, epoch: 5 | loss: 0.3635152
	speed: 0.0425s/iter; left time: 269.4009s
	iters: 600, epoch: 5 | loss: 0.1466406
	speed: 0.0422s/iter; left time: 263.1617s
	iters: 700, epoch: 5 | loss: 0.1664205
	speed: 0.0422s/iter; left time: 259.1983s
	iters: 800, epoch: 5 | loss: 0.1805176
	speed: 0.0422s/iter; left time: 254.8987s
	iters: 900, epoch: 5 | loss: 0.1665757
	speed: 0.0426s/iter; left time: 252.9371s
	iters: 1000, epoch: 5 | loss: 0.2368537
	speed: 0.0425s/iter; left time: 247.9530s
	iters: 1100, epoch: 5 | loss: 0.1572244
	speed: 0.0422s/iter; left time: 242.0700s
Epoch: 5 cost time: 48.418538331985474
Epoch: 5, Steps: 1139 | Train Loss: 0.2499300 Vali Loss: 0.6796124 Test Loss: 0.6100060
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : weather_336_Informer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed3293<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10204
mse:0.5401310324668884, mae:0.5123531818389893
