Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Autoformer', model_id='ETTm2_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=96, root_path='./dataset/', seed=10458, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm2_96_Autoformer_ETTm2_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed10458>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34369
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.3157596
	speed: 0.0841s/iter; left time: 895.2262s
	iters: 200, epoch: 1 | loss: 0.1191764
	speed: 0.0480s/iter; left time: 505.6667s
	iters: 300, epoch: 1 | loss: 0.2100079
	speed: 0.0479s/iter; left time: 500.1937s
	iters: 400, epoch: 1 | loss: 0.2525225
	speed: 0.0474s/iter; left time: 490.5167s
	iters: 500, epoch: 1 | loss: 0.1413188
	speed: 0.0475s/iter; left time: 486.8534s
	iters: 600, epoch: 1 | loss: 0.2245714
	speed: 0.0475s/iter; left time: 481.7722s
	iters: 700, epoch: 1 | loss: 0.4094944
	speed: 0.0479s/iter; left time: 480.7897s
	iters: 800, epoch: 1 | loss: 0.1299376
	speed: 0.0476s/iter; left time: 473.2294s
	iters: 900, epoch: 1 | loss: 0.2446631
	speed: 0.0472s/iter; left time: 464.3099s
	iters: 1000, epoch: 1 | loss: 0.2920973
	speed: 0.0471s/iter; left time: 459.0650s
Epoch: 1 cost time: 54.755372047424316
Epoch: 1, Steps: 1074 | Train Loss: 0.2728547 Vali Loss: 0.2751693 Test Loss: 0.5033232
Validation loss decreased (inf --> 0.275169).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2059191
	speed: 0.2831s/iter; left time: 2708.0950s
	iters: 200, epoch: 2 | loss: 0.3495622
	speed: 0.0470s/iter; left time: 444.8059s
	iters: 300, epoch: 2 | loss: 0.1592535
	speed: 0.0470s/iter; left time: 439.8813s
	iters: 400, epoch: 2 | loss: 0.1437934
	speed: 0.0470s/iter; left time: 435.1475s
	iters: 500, epoch: 2 | loss: 0.1460542
	speed: 0.0471s/iter; left time: 431.6500s
	iters: 600, epoch: 2 | loss: 0.2261410
	speed: 0.0470s/iter; left time: 425.8146s
	iters: 700, epoch: 2 | loss: 0.2070355
	speed: 0.0471s/iter; left time: 422.2151s
	iters: 800, epoch: 2 | loss: 0.1986379
	speed: 0.0471s/iter; left time: 417.7482s
	iters: 900, epoch: 2 | loss: 0.1299384
	speed: 0.0470s/iter; left time: 412.4132s
	iters: 1000, epoch: 2 | loss: 0.3020583
	speed: 0.0471s/iter; left time: 407.8011s
Epoch: 2 cost time: 50.52386021614075
Epoch: 2, Steps: 1074 | Train Loss: 0.2377177 Vali Loss: 0.1945369 Test Loss: 0.3486409
Validation loss decreased (0.275169 --> 0.194537).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1182821
	speed: 0.2827s/iter; left time: 2400.9509s
	iters: 200, epoch: 3 | loss: 0.1750896
	speed: 0.0478s/iter; left time: 401.2810s
	iters: 300, epoch: 3 | loss: 0.1671140
	speed: 0.0475s/iter; left time: 393.9254s
	iters: 400, epoch: 3 | loss: 0.4751267
	speed: 0.0471s/iter; left time: 385.5553s
	iters: 500, epoch: 3 | loss: 0.3442484
	speed: 0.0470s/iter; left time: 380.6372s
	iters: 600, epoch: 3 | loss: 0.1835304
	speed: 0.0471s/iter; left time: 376.7263s
	iters: 700, epoch: 3 | loss: 0.1861919
	speed: 0.0470s/iter; left time: 370.6242s
	iters: 800, epoch: 3 | loss: 0.1423801
	speed: 0.0470s/iter; left time: 366.6040s
	iters: 900, epoch: 3 | loss: 0.1099966
	speed: 0.0471s/iter; left time: 362.1782s
	iters: 1000, epoch: 3 | loss: 0.3117532
	speed: 0.0471s/iter; left time: 357.3002s
Epoch: 3 cost time: 50.708579301834106
Epoch: 3, Steps: 1074 | Train Loss: 0.2085046 Vali Loss: 0.2094401 Test Loss: 0.4459139
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1585986
	speed: 0.2803s/iter; left time: 2079.2421s
	iters: 200, epoch: 4 | loss: 0.2116018
	speed: 0.0470s/iter; left time: 343.8571s
	iters: 300, epoch: 4 | loss: 0.1931228
	speed: 0.0469s/iter; left time: 338.9230s
	iters: 400, epoch: 4 | loss: 0.2147091
	speed: 0.0470s/iter; left time: 334.5208s
	iters: 500, epoch: 4 | loss: 0.1547852
	speed: 0.0470s/iter; left time: 330.1815s
	iters: 600, epoch: 4 | loss: 0.2058135
	speed: 0.0470s/iter; left time: 325.3611s
	iters: 700, epoch: 4 | loss: 0.3210779
	speed: 0.0471s/iter; left time: 320.9457s
	iters: 800, epoch: 4 | loss: 0.2049301
	speed: 0.0477s/iter; left time: 320.3923s
	iters: 900, epoch: 4 | loss: 0.2307911
	speed: 0.0479s/iter; left time: 317.3044s
	iters: 1000, epoch: 4 | loss: 0.3553431
	speed: 0.0480s/iter; left time: 312.8677s
Epoch: 4 cost time: 50.82287311553955
Epoch: 4, Steps: 1074 | Train Loss: 0.1939584 Vali Loss: 0.2489758 Test Loss: 0.4431442
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1861076
	speed: 0.2809s/iter; left time: 1782.2214s
	iters: 200, epoch: 5 | loss: 0.2001955
	speed: 0.0470s/iter; left time: 293.2459s
	iters: 300, epoch: 5 | loss: 0.1281300
	speed: 0.0470s/iter; left time: 288.9206s
	iters: 400, epoch: 5 | loss: 0.2421412
	speed: 0.0470s/iter; left time: 284.3518s
	iters: 500, epoch: 5 | loss: 0.1737971
	speed: 0.0470s/iter; left time: 279.4951s
	iters: 600, epoch: 5 | loss: 0.2181955
	speed: 0.0471s/iter; left time: 275.1009s
	iters: 700, epoch: 5 | loss: 0.1682253
	speed: 0.0470s/iter; left time: 270.2490s
	iters: 800, epoch: 5 | loss: 0.2738425
	speed: 0.0476s/iter; left time: 268.5215s
	iters: 900, epoch: 5 | loss: 0.2504670
	speed: 0.0472s/iter; left time: 261.9330s
	iters: 1000, epoch: 5 | loss: 0.1855528
	speed: 0.0474s/iter; left time: 258.2749s
Epoch: 5 cost time: 50.641130447387695
Epoch: 5, Steps: 1074 | Train Loss: 0.1856581 Vali Loss: 0.2636394 Test Loss: 0.3954902
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : ETTm2_96_Autoformer_ETTm2_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed10458<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.3449186682701111, mae:0.3640713691711426
