Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=21, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=21, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Autoformer', model_id='weather_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=96, root_path='./dataset/', seed=3144, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_96_Autoformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed3144>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36696
val 5175
test 10444
	iters: 100, epoch: 1 | loss: 0.6568695
	speed: 0.0818s/iter; left time: 929.2760s
	iters: 200, epoch: 1 | loss: 0.3973667
	speed: 0.0473s/iter; left time: 532.2772s
	iters: 300, epoch: 1 | loss: 0.5050251
	speed: 0.0473s/iter; left time: 528.1715s
	iters: 400, epoch: 1 | loss: 0.4976420
	speed: 0.0474s/iter; left time: 523.8912s
	iters: 500, epoch: 1 | loss: 0.3848015
	speed: 0.0474s/iter; left time: 519.1515s
	iters: 600, epoch: 1 | loss: 0.3129424
	speed: 0.0477s/iter; left time: 517.7952s
	iters: 700, epoch: 1 | loss: 0.3450580
	speed: 0.0475s/iter; left time: 511.1675s
	iters: 800, epoch: 1 | loss: 0.5176911
	speed: 0.0473s/iter; left time: 504.5036s
	iters: 900, epoch: 1 | loss: 0.3531213
	speed: 0.0475s/iter; left time: 502.0231s
	iters: 1000, epoch: 1 | loss: 0.3035949
	speed: 0.0474s/iter; left time: 496.0361s
	iters: 1100, epoch: 1 | loss: 0.3266314
	speed: 0.0474s/iter; left time: 490.6881s
Epoch: 1 cost time: 57.79412794113159
Epoch: 1, Steps: 1146 | Train Loss: 0.5084503 Vali Loss: 0.5247682 Test Loss: 0.2963861
Validation loss decreased (inf --> 0.524768).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2679160
	speed: 0.2114s/iter; left time: 2159.2786s
	iters: 200, epoch: 2 | loss: 0.3329036
	speed: 0.0473s/iter; left time: 478.1626s
	iters: 300, epoch: 2 | loss: 0.3089755
	speed: 0.0473s/iter; left time: 474.1194s
	iters: 400, epoch: 2 | loss: 0.2894162
	speed: 0.0474s/iter; left time: 469.5299s
	iters: 500, epoch: 2 | loss: 0.5852869
	speed: 0.0472s/iter; left time: 463.5907s
	iters: 600, epoch: 2 | loss: 0.2760128
	speed: 0.0473s/iter; left time: 459.1784s
	iters: 700, epoch: 2 | loss: 0.3094613
	speed: 0.0473s/iter; left time: 454.9099s
	iters: 800, epoch: 2 | loss: 0.2844453
	speed: 0.0474s/iter; left time: 451.3293s
	iters: 900, epoch: 2 | loss: 1.2993741
	speed: 0.0473s/iter; left time: 444.9035s
	iters: 1000, epoch: 2 | loss: 0.2318654
	speed: 0.0473s/iter; left time: 440.6154s
	iters: 1100, epoch: 2 | loss: 0.3489058
	speed: 0.0472s/iter; left time: 435.2288s
Epoch: 2 cost time: 54.19284677505493
Epoch: 2, Steps: 1146 | Train Loss: 0.4367814 Vali Loss: 0.5147452 Test Loss: 0.2758126
Validation loss decreased (0.524768 --> 0.514745).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3346362
	speed: 0.2122s/iter; left time: 1923.9897s
	iters: 200, epoch: 3 | loss: 0.2925458
	speed: 0.0474s/iter; left time: 425.3577s
	iters: 300, epoch: 3 | loss: 1.0913109
	speed: 0.0473s/iter; left time: 419.2284s
	iters: 400, epoch: 3 | loss: 0.3262429
	speed: 0.0475s/iter; left time: 416.2026s
	iters: 500, epoch: 3 | loss: 0.3108026
	speed: 0.0475s/iter; left time: 411.7080s
	iters: 600, epoch: 3 | loss: 0.3412005
	speed: 0.0474s/iter; left time: 405.9321s
	iters: 700, epoch: 3 | loss: 0.2829015
	speed: 0.0475s/iter; left time: 402.3763s
	iters: 800, epoch: 3 | loss: 0.3276697
	speed: 0.0475s/iter; left time: 397.1113s
	iters: 900, epoch: 3 | loss: 0.3996586
	speed: 0.0473s/iter; left time: 390.8350s
	iters: 1000, epoch: 3 | loss: 0.3918550
	speed: 0.0473s/iter; left time: 386.1591s
	iters: 1100, epoch: 3 | loss: 0.2547562
	speed: 0.0475s/iter; left time: 383.1366s
Epoch: 3 cost time: 54.3221492767334
Epoch: 3, Steps: 1146 | Train Loss: 0.4035108 Vali Loss: 0.5147938 Test Loss: 0.2999495
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3119090
	speed: 0.2106s/iter; left time: 1668.9238s
	iters: 200, epoch: 4 | loss: 1.1732987
	speed: 0.0476s/iter; left time: 372.6181s
	iters: 300, epoch: 4 | loss: 0.2895434
	speed: 0.0478s/iter; left time: 369.4711s
	iters: 400, epoch: 4 | loss: 0.9303136
	speed: 0.0479s/iter; left time: 365.0125s
	iters: 500, epoch: 4 | loss: 0.2904789
	speed: 0.0479s/iter; left time: 360.6529s
	iters: 600, epoch: 4 | loss: 0.2823281
	speed: 0.0481s/iter; left time: 357.1903s
	iters: 700, epoch: 4 | loss: 0.2456294
	speed: 0.0476s/iter; left time: 348.6157s
	iters: 800, epoch: 4 | loss: 0.2989315
	speed: 0.0479s/iter; left time: 346.1284s
	iters: 900, epoch: 4 | loss: 0.2897842
	speed: 0.0479s/iter; left time: 341.2570s
	iters: 1000, epoch: 4 | loss: 0.9812051
	speed: 0.0476s/iter; left time: 334.0618s
	iters: 1100, epoch: 4 | loss: 0.4398856
	speed: 0.0477s/iter; left time: 330.0645s
Epoch: 4 cost time: 54.75905656814575
Epoch: 4, Steps: 1146 | Train Loss: 0.3705786 Vali Loss: 0.5170582 Test Loss: 0.3013361
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2628837
	speed: 0.2110s/iter; left time: 1429.7902s
	iters: 200, epoch: 5 | loss: 0.2751364
	speed: 0.0476s/iter; left time: 317.8433s
	iters: 300, epoch: 5 | loss: 0.4551723
	speed: 0.0477s/iter; left time: 313.7307s
	iters: 400, epoch: 5 | loss: 0.2514211
	speed: 0.0477s/iter; left time: 308.9126s
	iters: 500, epoch: 5 | loss: 0.3801627
	speed: 0.0474s/iter; left time: 302.0159s
	iters: 600, epoch: 5 | loss: 0.2247414
	speed: 0.0475s/iter; left time: 298.0846s
	iters: 700, epoch: 5 | loss: 0.3020014
	speed: 0.0476s/iter; left time: 294.0939s
	iters: 800, epoch: 5 | loss: 0.3423416
	speed: 0.0475s/iter; left time: 288.4245s
	iters: 900, epoch: 5 | loss: 0.2511409
	speed: 0.0473s/iter; left time: 282.5263s
	iters: 1000, epoch: 5 | loss: 0.2751244
	speed: 0.0473s/iter; left time: 277.9521s
	iters: 1100, epoch: 5 | loss: 0.2675032
	speed: 0.0476s/iter; left time: 275.1708s
Epoch: 5 cost time: 54.44789791107178
Epoch: 5, Steps: 1146 | Train Loss: 0.3579955 Vali Loss: 0.5263271 Test Loss: 0.3174207
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : weather_96_Autoformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed3144<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
mse:0.27613648772239685, mae:0.3494962155818939
