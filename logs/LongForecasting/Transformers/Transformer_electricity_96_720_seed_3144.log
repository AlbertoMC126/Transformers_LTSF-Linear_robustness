Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=321, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', dec_in=321, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Transformer', model_id='electricity_720', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=720, root_path='./dataset/', seed=3144, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : electricity_720_Transformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed3144>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17597
val 1913
test 4541
	iters: 100, epoch: 1 | loss: 0.3290305
	speed: 0.1341s/iter; left time: 722.7106s
	iters: 200, epoch: 1 | loss: 0.2668839
	speed: 0.1026s/iter; left time: 542.6507s
	iters: 300, epoch: 1 | loss: 0.2510075
	speed: 0.1030s/iter; left time: 534.7317s
	iters: 400, epoch: 1 | loss: 0.2502002
	speed: 0.1028s/iter; left time: 523.3920s
	iters: 500, epoch: 1 | loss: 0.2303620
	speed: 0.1032s/iter; left time: 515.0238s
Epoch: 1 cost time: 59.611122846603394
Epoch: 1, Steps: 549 | Train Loss: 0.3115454 Vali Loss: 0.2776253 Test Loss: 0.3477489
Validation loss decreased (inf --> 0.277625).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2215183
	speed: 0.3262s/iter; left time: 1579.2565s
	iters: 200, epoch: 2 | loss: 0.2154081
	speed: 0.1029s/iter; left time: 487.8973s
	iters: 300, epoch: 2 | loss: 0.2071968
	speed: 0.1027s/iter; left time: 476.9126s
	iters: 400, epoch: 2 | loss: 0.2030240
	speed: 0.1030s/iter; left time: 468.0101s
	iters: 500, epoch: 2 | loss: 0.1978949
	speed: 0.1034s/iter; left time: 459.3690s
Epoch: 2 cost time: 56.61223888397217
Epoch: 2, Steps: 549 | Train Loss: 0.2091289 Vali Loss: 0.2686340 Test Loss: 0.3234674
Validation loss decreased (0.277625 --> 0.268634).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1878369
	speed: 0.3243s/iter; left time: 1392.2048s
	iters: 200, epoch: 3 | loss: 0.1872449
	speed: 0.1034s/iter; left time: 433.4497s
	iters: 300, epoch: 3 | loss: 0.1708338
	speed: 0.1032s/iter; left time: 422.3888s
	iters: 400, epoch: 3 | loss: 0.1775283
	speed: 0.1040s/iter; left time: 415.3316s
	iters: 500, epoch: 3 | loss: 0.1600397
	speed: 0.1040s/iter; left time: 404.9262s
Epoch: 3 cost time: 56.854652404785156
Epoch: 3, Steps: 549 | Train Loss: 0.1787276 Vali Loss: 0.2419806 Test Loss: 0.3130308
Validation loss decreased (0.268634 --> 0.241981).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1482562
	speed: 0.3249s/iter; left time: 1216.4994s
	iters: 200, epoch: 4 | loss: 0.1503819
	speed: 0.1033s/iter; left time: 376.5308s
	iters: 300, epoch: 4 | loss: 0.1429566
	speed: 0.1032s/iter; left time: 365.6271s
	iters: 400, epoch: 4 | loss: 0.1462094
	speed: 0.1035s/iter; left time: 356.4726s
	iters: 500, epoch: 4 | loss: 0.1392007
	speed: 0.1033s/iter; left time: 345.3980s
Epoch: 4 cost time: 56.7187020778656
Epoch: 4, Steps: 549 | Train Loss: 0.1484380 Vali Loss: 0.2335010 Test Loss: 0.3129461
Validation loss decreased (0.241981 --> 0.233501).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1329107
	speed: 0.3264s/iter; left time: 1042.8114s
	iters: 200, epoch: 5 | loss: 0.1385105
	speed: 0.1040s/iter; left time: 321.8066s
	iters: 300, epoch: 5 | loss: 0.1329677
	speed: 0.1038s/iter; left time: 311.0055s
	iters: 400, epoch: 5 | loss: 0.1391629
	speed: 0.1029s/iter; left time: 298.0066s
	iters: 500, epoch: 5 | loss: 0.1384049
	speed: 0.1034s/iter; left time: 288.9586s
Epoch: 5 cost time: 56.82276391983032
Epoch: 5, Steps: 549 | Train Loss: 0.1394840 Vali Loss: 0.2347878 Test Loss: 0.3098374
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1351188
	speed: 0.3220s/iter; left time: 852.0237s
	iters: 200, epoch: 6 | loss: 0.1377903
	speed: 0.1032s/iter; left time: 262.6668s
	iters: 300, epoch: 6 | loss: 0.1376996
	speed: 0.1033s/iter; left time: 252.6432s
	iters: 400, epoch: 6 | loss: 0.1354137
	speed: 0.1031s/iter; left time: 241.9486s
	iters: 500, epoch: 6 | loss: 0.1330996
	speed: 0.1034s/iter; left time: 232.2769s
Epoch: 6 cost time: 56.65425395965576
Epoch: 6, Steps: 549 | Train Loss: 0.1355659 Vali Loss: 0.2344031 Test Loss: 0.3124238
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1372983
	speed: 0.3242s/iter; left time: 679.8197s
	iters: 200, epoch: 7 | loss: 0.1348611
	speed: 0.1032s/iter; left time: 206.1170s
	iters: 300, epoch: 7 | loss: 0.1311563
	speed: 0.1030s/iter; left time: 195.4373s
	iters: 400, epoch: 7 | loss: 0.1270598
	speed: 0.1030s/iter; left time: 185.0339s
	iters: 500, epoch: 7 | loss: 0.1367996
	speed: 0.1031s/iter; left time: 174.9539s
Epoch: 7 cost time: 56.56617617607117
Epoch: 7, Steps: 549 | Train Loss: 0.1336536 Vali Loss: 0.2342757 Test Loss: 0.3139394
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : electricity_720_Transformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed3144<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4541
mse:0.31287723779678345, mae:0.3965361714363098
