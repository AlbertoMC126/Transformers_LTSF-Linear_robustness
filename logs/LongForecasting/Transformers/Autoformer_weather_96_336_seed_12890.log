Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=21, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=21, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Autoformer', model_id='weather_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=336, root_path='./dataset/', seed=12890, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_336_Autoformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed12890>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36456
val 4935
test 10204
	iters: 100, epoch: 1 | loss: 0.5966995
	speed: 0.1177s/iter; left time: 1329.3481s
	iters: 200, epoch: 1 | loss: 0.8360882
	speed: 0.0833s/iter; left time: 931.8711s
	iters: 300, epoch: 1 | loss: 0.7779432
	speed: 0.0833s/iter; left time: 923.7319s
	iters: 400, epoch: 1 | loss: 0.9179526
	speed: 0.0833s/iter; left time: 915.9821s
	iters: 500, epoch: 1 | loss: 0.5425014
	speed: 0.0833s/iter; left time: 907.5870s
	iters: 600, epoch: 1 | loss: 0.8657883
	speed: 0.0832s/iter; left time: 897.4031s
	iters: 700, epoch: 1 | loss: 0.6151317
	speed: 0.0832s/iter; left time: 889.9380s
	iters: 800, epoch: 1 | loss: 0.5057953
	speed: 0.0833s/iter; left time: 881.7694s
	iters: 900, epoch: 1 | loss: 0.5520300
	speed: 0.0831s/iter; left time: 871.8520s
	iters: 1000, epoch: 1 | loss: 1.0852401
	speed: 0.0832s/iter; left time: 864.3439s
	iters: 1100, epoch: 1 | loss: 0.6214456
	speed: 0.0831s/iter; left time: 855.0378s
Epoch: 1 cost time: 98.28944802284241
Epoch: 1, Steps: 1139 | Train Loss: 0.6958030 Vali Loss: 0.7392466 Test Loss: 0.3655783
Validation loss decreased (inf --> 0.739247).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5918425
	speed: 0.3902s/iter; left time: 3961.5643s
	iters: 200, epoch: 2 | loss: 0.5443794
	speed: 0.0832s/iter; left time: 836.4425s
	iters: 300, epoch: 2 | loss: 0.7495452
	speed: 0.0835s/iter; left time: 831.0978s
	iters: 400, epoch: 2 | loss: 0.5900072
	speed: 0.0833s/iter; left time: 820.1815s
	iters: 500, epoch: 2 | loss: 0.5877728
	speed: 0.0831s/iter; left time: 810.4544s
	iters: 600, epoch: 2 | loss: 0.8398319
	speed: 0.0831s/iter; left time: 802.0186s
	iters: 700, epoch: 2 | loss: 0.4741076
	speed: 0.0831s/iter; left time: 793.4436s
	iters: 800, epoch: 2 | loss: 0.5583378
	speed: 0.0831s/iter; left time: 785.3419s
	iters: 900, epoch: 2 | loss: 0.5260397
	speed: 0.0830s/iter; left time: 776.2706s
	iters: 1000, epoch: 2 | loss: 0.6063510
	speed: 0.0830s/iter; left time: 768.0334s
	iters: 1100, epoch: 2 | loss: 0.4715166
	speed: 0.0831s/iter; left time: 760.8736s
Epoch: 2 cost time: 94.71366691589355
Epoch: 2, Steps: 1139 | Train Loss: 0.6530304 Vali Loss: 0.7186884 Test Loss: 0.3500092
Validation loss decreased (0.739247 --> 0.718688).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4334951
	speed: 0.3902s/iter; left time: 3516.7060s
	iters: 200, epoch: 3 | loss: 0.5186872
	speed: 0.0833s/iter; left time: 742.4225s
	iters: 300, epoch: 3 | loss: 0.7954987
	speed: 0.0834s/iter; left time: 735.0141s
	iters: 400, epoch: 3 | loss: 0.4991070
	speed: 0.0832s/iter; left time: 724.8058s
	iters: 500, epoch: 3 | loss: 0.5627528
	speed: 0.0832s/iter; left time: 716.5198s
	iters: 600, epoch: 3 | loss: 0.5321363
	speed: 0.0832s/iter; left time: 708.3123s
	iters: 700, epoch: 3 | loss: 0.9183416
	speed: 0.0833s/iter; left time: 700.3849s
	iters: 800, epoch: 3 | loss: 0.6287773
	speed: 0.0834s/iter; left time: 693.1385s
	iters: 900, epoch: 3 | loss: 0.5107408
	speed: 0.0834s/iter; left time: 684.7160s
	iters: 1000, epoch: 3 | loss: 0.7810066
	speed: 0.0833s/iter; left time: 675.4549s
	iters: 1100, epoch: 3 | loss: 0.6252487
	speed: 0.0834s/iter; left time: 667.8851s
Epoch: 3 cost time: 94.86339020729065
Epoch: 3, Steps: 1139 | Train Loss: 0.6367298 Vali Loss: 0.7117379 Test Loss: 0.3554420
Validation loss decreased (0.718688 --> 0.711738).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4707710
	speed: 0.3900s/iter; left time: 3070.7067s
	iters: 200, epoch: 4 | loss: 0.4764588
	speed: 0.0834s/iter; left time: 648.4657s
	iters: 300, epoch: 4 | loss: 0.5487216
	speed: 0.0834s/iter; left time: 640.3104s
	iters: 400, epoch: 4 | loss: 0.8038821
	speed: 0.0831s/iter; left time: 629.6501s
	iters: 500, epoch: 4 | loss: 0.8356412
	speed: 0.0832s/iter; left time: 622.2016s
	iters: 600, epoch: 4 | loss: 0.8173342
	speed: 0.0831s/iter; left time: 612.8350s
	iters: 700, epoch: 4 | loss: 0.7876406
	speed: 0.0831s/iter; left time: 604.4618s
	iters: 800, epoch: 4 | loss: 0.5173061
	speed: 0.0830s/iter; left time: 595.5674s
	iters: 900, epoch: 4 | loss: 0.5966063
	speed: 0.0830s/iter; left time: 587.4655s
	iters: 1000, epoch: 4 | loss: 0.5142418
	speed: 0.0830s/iter; left time: 579.0082s
	iters: 1100, epoch: 4 | loss: 0.5637357
	speed: 0.0832s/iter; left time: 571.7916s
Epoch: 4 cost time: 94.74407839775085
Epoch: 4, Steps: 1139 | Train Loss: 0.6270177 Vali Loss: 0.7151944 Test Loss: 0.3496947
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.7689875
	speed: 0.3870s/iter; left time: 2606.1483s
	iters: 200, epoch: 5 | loss: 0.5289207
	speed: 0.0834s/iter; left time: 553.6776s
	iters: 300, epoch: 5 | loss: 0.5168699
	speed: 0.0832s/iter; left time: 543.5357s
	iters: 400, epoch: 5 | loss: 0.6111313
	speed: 0.0829s/iter; left time: 533.7387s
	iters: 500, epoch: 5 | loss: 0.5910251
	speed: 0.0829s/iter; left time: 525.0069s
	iters: 600, epoch: 5 | loss: 0.6232477
	speed: 0.0830s/iter; left time: 517.2128s
	iters: 700, epoch: 5 | loss: 0.4893437
	speed: 0.0830s/iter; left time: 509.1323s
	iters: 800, epoch: 5 | loss: 0.5567701
	speed: 0.0830s/iter; left time: 500.6877s
	iters: 900, epoch: 5 | loss: 0.6405321
	speed: 0.0830s/iter; left time: 492.3311s
	iters: 1000, epoch: 5 | loss: 0.5872886
	speed: 0.0830s/iter; left time: 484.1484s
	iters: 1100, epoch: 5 | loss: 0.4508949
	speed: 0.0830s/iter; left time: 476.0578s
Epoch: 5 cost time: 94.5884735584259
Epoch: 5, Steps: 1139 | Train Loss: 0.6200067 Vali Loss: 0.7128140 Test Loss: 0.3523864
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.7099630
	speed: 0.3876s/iter; left time: 2168.7882s
	iters: 200, epoch: 6 | loss: 0.9684461
	speed: 0.0832s/iter; left time: 457.5222s
	iters: 300, epoch: 6 | loss: 0.4878202
	speed: 0.0831s/iter; left time: 448.4120s
	iters: 400, epoch: 6 | loss: 0.5379820
	speed: 0.0831s/iter; left time: 440.0919s
	iters: 500, epoch: 6 | loss: 0.5022865
	speed: 0.0831s/iter; left time: 431.7356s
	iters: 600, epoch: 6 | loss: 0.5162981
	speed: 0.0831s/iter; left time: 423.5580s
	iters: 700, epoch: 6 | loss: 0.7465799
	speed: 0.0832s/iter; left time: 415.8764s
	iters: 800, epoch: 6 | loss: 0.7735071
	speed: 0.0832s/iter; left time: 407.5547s
	iters: 900, epoch: 6 | loss: 0.4795368
	speed: 0.0833s/iter; left time: 399.3519s
	iters: 1000, epoch: 6 | loss: 0.4645000
	speed: 0.0833s/iter; left time: 391.2812s
	iters: 1100, epoch: 6 | loss: 0.9525047
	speed: 0.0835s/iter; left time: 383.9006s
Epoch: 6 cost time: 94.80315899848938
Epoch: 6, Steps: 1139 | Train Loss: 0.6167362 Vali Loss: 0.7106893 Test Loss: 0.3520738
Validation loss decreased (0.711738 --> 0.710689).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.5723793
	speed: 0.3907s/iter; left time: 1741.3826s
	iters: 200, epoch: 7 | loss: 0.8407293
	speed: 0.0835s/iter; left time: 363.6209s
	iters: 300, epoch: 7 | loss: 0.5260569
	speed: 0.0832s/iter; left time: 353.9950s
	iters: 400, epoch: 7 | loss: 0.4192158
	speed: 0.0833s/iter; left time: 346.1832s
	iters: 500, epoch: 7 | loss: 0.5684263
	speed: 0.0833s/iter; left time: 337.7464s
	iters: 600, epoch: 7 | loss: 0.4894782
	speed: 0.0833s/iter; left time: 329.6734s
	iters: 700, epoch: 7 | loss: 0.5342629
	speed: 0.0831s/iter; left time: 320.4176s
	iters: 800, epoch: 7 | loss: 0.5096769
	speed: 0.0831s/iter; left time: 312.1960s
	iters: 900, epoch: 7 | loss: 0.7571214
	speed: 0.0830s/iter; left time: 303.5709s
	iters: 1000, epoch: 7 | loss: 0.4475183
	speed: 0.0831s/iter; left time: 295.5994s
	iters: 1100, epoch: 7 | loss: 0.5712911
	speed: 0.0833s/iter; left time: 287.8684s
Epoch: 7 cost time: 94.78781652450562
Epoch: 7, Steps: 1139 | Train Loss: 0.6154019 Vali Loss: 0.7094836 Test Loss: 0.3492237
Validation loss decreased (0.710689 --> 0.709484).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.4973930
	speed: 0.3906s/iter; left time: 1295.9443s
	iters: 200, epoch: 8 | loss: 0.8779508
	speed: 0.0832s/iter; left time: 267.7383s
	iters: 300, epoch: 8 | loss: 0.6077495
	speed: 0.0830s/iter; left time: 258.7164s
	iters: 400, epoch: 8 | loss: 0.5799925
	speed: 0.0829s/iter; left time: 250.2539s
	iters: 500, epoch: 8 | loss: 0.4710241
	speed: 0.0830s/iter; left time: 242.0507s
	iters: 600, epoch: 8 | loss: 0.4636043
	speed: 0.0829s/iter; left time: 233.7259s
	iters: 700, epoch: 8 | loss: 0.7210169
	speed: 0.0830s/iter; left time: 225.5793s
	iters: 800, epoch: 8 | loss: 0.4976520
	speed: 0.0830s/iter; left time: 217.3846s
	iters: 900, epoch: 8 | loss: 1.0415531
	speed: 0.0829s/iter; left time: 208.7858s
	iters: 1000, epoch: 8 | loss: 0.7339997
	speed: 0.0830s/iter; left time: 200.7229s
	iters: 1100, epoch: 8 | loss: 0.4928872
	speed: 0.0830s/iter; left time: 192.5039s
Epoch: 8 cost time: 94.55927443504333
Epoch: 8, Steps: 1139 | Train Loss: 0.6147612 Vali Loss: 0.7089496 Test Loss: 0.3503116
Validation loss decreased (0.709484 --> 0.708950).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.5581412
	speed: 0.3898s/iter; left time: 849.4065s
	iters: 200, epoch: 9 | loss: 0.5393074
	speed: 0.0832s/iter; left time: 172.9446s
	iters: 300, epoch: 9 | loss: 0.4693620
	speed: 0.0831s/iter; left time: 164.3701s
	iters: 400, epoch: 9 | loss: 0.8017397
	speed: 0.0830s/iter; left time: 156.0096s
	iters: 500, epoch: 9 | loss: 0.5639467
	speed: 0.0830s/iter; left time: 147.7057s
	iters: 600, epoch: 9 | loss: 0.7475020
	speed: 0.0832s/iter; left time: 139.7302s
	iters: 700, epoch: 9 | loss: 0.6645187
	speed: 0.0834s/iter; left time: 131.7070s
	iters: 800, epoch: 9 | loss: 0.5138476
	speed: 0.0833s/iter; left time: 123.2051s
	iters: 900, epoch: 9 | loss: 0.6923429
	speed: 0.0833s/iter; left time: 114.9104s
	iters: 1000, epoch: 9 | loss: 0.5442645
	speed: 0.0835s/iter; left time: 106.8014s
	iters: 1100, epoch: 9 | loss: 0.5494393
	speed: 0.0835s/iter; left time: 98.4812s
Epoch: 9 cost time: 94.84026408195496
Epoch: 9, Steps: 1139 | Train Loss: 0.6141051 Vali Loss: 0.7083848 Test Loss: 0.3514063
Validation loss decreased (0.708950 --> 0.708385).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.8225039
	speed: 0.3915s/iter; left time: 407.1509s
	iters: 200, epoch: 10 | loss: 0.7793986
	speed: 0.0833s/iter; left time: 78.2564s
	iters: 300, epoch: 10 | loss: 0.5782955
	speed: 0.0832s/iter; left time: 69.8902s
	iters: 400, epoch: 10 | loss: 0.4702847
	speed: 0.0833s/iter; left time: 61.6141s
	iters: 500, epoch: 10 | loss: 0.6946306
	speed: 0.0834s/iter; left time: 53.3631s
	iters: 600, epoch: 10 | loss: 0.4878623
	speed: 0.0833s/iter; left time: 44.9835s
	iters: 700, epoch: 10 | loss: 0.7831545
	speed: 0.0831s/iter; left time: 36.5828s
	iters: 800, epoch: 10 | loss: 0.5294647
	speed: 0.0831s/iter; left time: 28.2566s
	iters: 900, epoch: 10 | loss: 0.5284179
	speed: 0.0832s/iter; left time: 19.9673s
	iters: 1000, epoch: 10 | loss: 0.5132836
	speed: 0.0832s/iter; left time: 11.6452s
	iters: 1100, epoch: 10 | loss: 0.6418817
	speed: 0.0831s/iter; left time: 3.3253s
Epoch: 10 cost time: 94.78370571136475
Epoch: 10, Steps: 1139 | Train Loss: 0.6140853 Vali Loss: 0.7091095 Test Loss: 0.3510156
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : weather_336_Autoformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed12890<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10204
mse:0.35143011808395386, mae:0.38777515292167664
