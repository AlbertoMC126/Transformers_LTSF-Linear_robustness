Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Autoformer', model_id='ETTm2_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=336, root_path='./dataset/', seed=3293, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm2_336_Autoformer_ETTm2_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed3293>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34129
val 11185
test 11185
	iters: 100, epoch: 1 | loss: 0.4635213
	speed: 0.1166s/iter; left time: 1231.4698s
	iters: 200, epoch: 1 | loss: 0.5726687
	speed: 0.0826s/iter; left time: 863.5880s
	iters: 300, epoch: 1 | loss: 0.2012968
	speed: 0.0826s/iter; left time: 855.5971s
	iters: 400, epoch: 1 | loss: 0.7547584
	speed: 0.0826s/iter; left time: 847.0838s
	iters: 500, epoch: 1 | loss: 0.3347733
	speed: 0.0825s/iter; left time: 838.7232s
	iters: 600, epoch: 1 | loss: 0.3972291
	speed: 0.0826s/iter; left time: 830.6165s
	iters: 700, epoch: 1 | loss: 0.6054352
	speed: 0.0826s/iter; left time: 822.8290s
	iters: 800, epoch: 1 | loss: 1.0256451
	speed: 0.0829s/iter; left time: 817.0264s
	iters: 900, epoch: 1 | loss: 0.6364494
	speed: 0.0831s/iter; left time: 811.5930s
	iters: 1000, epoch: 1 | loss: 0.6851661
	speed: 0.0830s/iter; left time: 802.2925s
Epoch: 1 cost time: 91.65002250671387
Epoch: 1, Steps: 1066 | Train Loss: 0.4556783 Vali Loss: 0.2835795 Test Loss: 0.3717532
Validation loss decreased (inf --> 0.283580).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2341692
	speed: 0.5164s/iter; left time: 4903.6271s
	iters: 200, epoch: 2 | loss: 0.2452244
	speed: 0.0829s/iter; left time: 779.1624s
	iters: 300, epoch: 2 | loss: 0.2188794
	speed: 0.0825s/iter; left time: 766.4702s
	iters: 400, epoch: 2 | loss: 0.5119902
	speed: 0.0824s/iter; left time: 757.8052s
	iters: 500, epoch: 2 | loss: 0.7499936
	speed: 0.0825s/iter; left time: 750.1803s
	iters: 600, epoch: 2 | loss: 0.9307145
	speed: 0.0825s/iter; left time: 742.1156s
	iters: 700, epoch: 2 | loss: 0.1952412
	speed: 0.0828s/iter; left time: 736.3609s
	iters: 800, epoch: 2 | loss: 0.2991825
	speed: 0.0830s/iter; left time: 729.7496s
	iters: 900, epoch: 2 | loss: 0.3091628
	speed: 0.0830s/iter; left time: 721.9172s
	iters: 1000, epoch: 2 | loss: 0.6470315
	speed: 0.0832s/iter; left time: 714.7835s
Epoch: 2 cost time: 88.18046379089355
Epoch: 2, Steps: 1066 | Train Loss: 0.4291102 Vali Loss: 0.2652131 Test Loss: 0.3770780
Validation loss decreased (0.283580 --> 0.265213).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4917619
	speed: 0.5177s/iter; left time: 4363.4478s
	iters: 200, epoch: 3 | loss: 0.2097763
	speed: 0.0827s/iter; left time: 688.6935s
	iters: 300, epoch: 3 | loss: 0.5609638
	speed: 0.0826s/iter; left time: 679.6335s
	iters: 400, epoch: 3 | loss: 0.4586465
	speed: 0.0827s/iter; left time: 672.3158s
	iters: 500, epoch: 3 | loss: 0.4996037
	speed: 0.0826s/iter; left time: 663.2948s
	iters: 600, epoch: 3 | loss: 0.2886446
	speed: 0.0829s/iter; left time: 657.0488s
	iters: 700, epoch: 3 | loss: 0.2434763
	speed: 0.0830s/iter; left time: 649.5104s
	iters: 800, epoch: 3 | loss: 0.3135760
	speed: 0.0830s/iter; left time: 641.5785s
	iters: 900, epoch: 3 | loss: 0.4493236
	speed: 0.0830s/iter; left time: 633.1303s
	iters: 1000, epoch: 3 | loss: 0.3035362
	speed: 0.0828s/iter; left time: 623.4363s
Epoch: 3 cost time: 88.24347972869873
Epoch: 3, Steps: 1066 | Train Loss: 0.3920057 Vali Loss: 0.2778563 Test Loss: 0.3707663
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2851059
	speed: 0.5141s/iter; left time: 3785.0324s
	iters: 200, epoch: 4 | loss: 0.1935008
	speed: 0.0824s/iter; left time: 598.5173s
	iters: 300, epoch: 4 | loss: 0.1634245
	speed: 0.0824s/iter; left time: 590.4906s
	iters: 400, epoch: 4 | loss: 0.1824204
	speed: 0.0824s/iter; left time: 582.0440s
	iters: 500, epoch: 4 | loss: 0.3610700
	speed: 0.0826s/iter; left time: 574.8619s
	iters: 600, epoch: 4 | loss: 0.2042631
	speed: 0.0830s/iter; left time: 569.7638s
	iters: 700, epoch: 4 | loss: 0.2518634
	speed: 0.0830s/iter; left time: 561.2877s
	iters: 800, epoch: 4 | loss: 0.2211945
	speed: 0.0830s/iter; left time: 552.9783s
	iters: 900, epoch: 4 | loss: 0.2947501
	speed: 0.0829s/iter; left time: 543.7928s
	iters: 1000, epoch: 4 | loss: 0.2848813
	speed: 0.0825s/iter; left time: 532.9030s
Epoch: 4 cost time: 88.09992909431458
Epoch: 4, Steps: 1066 | Train Loss: 0.3650414 Vali Loss: 0.3207011 Test Loss: 0.3672154
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2413830
	speed: 0.5136s/iter; left time: 3234.3071s
	iters: 200, epoch: 5 | loss: 0.3116032
	speed: 0.0825s/iter; left time: 511.1573s
	iters: 300, epoch: 5 | loss: 0.6120387
	speed: 0.0824s/iter; left time: 502.1062s
	iters: 400, epoch: 5 | loss: 0.3693986
	speed: 0.0825s/iter; left time: 494.6651s
	iters: 500, epoch: 5 | loss: 0.2564574
	speed: 0.0828s/iter; left time: 488.0786s
	iters: 600, epoch: 5 | loss: 0.2614759
	speed: 0.0830s/iter; left time: 481.1886s
	iters: 700, epoch: 5 | loss: 0.6054213
	speed: 0.0828s/iter; left time: 471.7988s
	iters: 800, epoch: 5 | loss: 0.4330025
	speed: 0.0828s/iter; left time: 463.5869s
	iters: 900, epoch: 5 | loss: 0.4738954
	speed: 0.0826s/iter; left time: 453.9111s
	iters: 1000, epoch: 5 | loss: 0.2229089
	speed: 0.0825s/iter; left time: 445.1101s
Epoch: 5 cost time: 88.05326795578003
Epoch: 5, Steps: 1066 | Train Loss: 0.3500260 Vali Loss: 0.3402114 Test Loss: 0.3810696
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : ETTm2_336_Autoformer_ETTm2_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed3293<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
mse:0.3774152100086212, mae:0.3971276879310608
