Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=21, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=21, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Informer', model_id='weather_192', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=192, root_path='./dataset/', seed=15227, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_192_Informer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed15227>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36600
val 5079
test 10348
	iters: 100, epoch: 1 | loss: 0.4220606
	speed: 0.0638s/iter; left time: 722.3590s
	iters: 200, epoch: 1 | loss: 0.8359465
	speed: 0.0337s/iter; left time: 378.7919s
	iters: 300, epoch: 1 | loss: 0.3942393
	speed: 0.0337s/iter; left time: 375.2827s
	iters: 400, epoch: 1 | loss: 0.2813423
	speed: 0.0337s/iter; left time: 372.0309s
	iters: 500, epoch: 1 | loss: 0.3238907
	speed: 0.0337s/iter; left time: 368.4106s
	iters: 600, epoch: 1 | loss: 0.2468130
	speed: 0.0335s/iter; left time: 363.3618s
	iters: 700, epoch: 1 | loss: 0.3750916
	speed: 0.0336s/iter; left time: 360.8476s
	iters: 800, epoch: 1 | loss: 0.2668567
	speed: 0.0339s/iter; left time: 360.3622s
	iters: 900, epoch: 1 | loss: 0.2677248
	speed: 0.0348s/iter; left time: 366.8222s
	iters: 1000, epoch: 1 | loss: 0.7675302
	speed: 0.0347s/iter; left time: 361.8894s
	iters: 1100, epoch: 1 | loss: 0.7085392
	speed: 0.0347s/iter; left time: 358.7143s
Epoch: 1 cost time: 41.88413667678833
Epoch: 1, Steps: 1143 | Train Loss: 0.4428256 Vali Loss: 0.6612371 Test Loss: 0.7424717
Validation loss decreased (inf --> 0.661237).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3779617
	speed: 0.1125s/iter; left time: 1146.3002s
	iters: 200, epoch: 2 | loss: 0.3196343
	speed: 0.0351s/iter; left time: 354.0802s
	iters: 300, epoch: 2 | loss: 0.4170573
	speed: 0.0348s/iter; left time: 347.3323s
	iters: 400, epoch: 2 | loss: 0.2185236
	speed: 0.0342s/iter; left time: 338.5229s
	iters: 500, epoch: 2 | loss: 0.1952383
	speed: 0.0339s/iter; left time: 332.0192s
	iters: 600, epoch: 2 | loss: 0.2547004
	speed: 0.0340s/iter; left time: 329.4012s
	iters: 700, epoch: 2 | loss: 0.1974869
	speed: 0.0339s/iter; left time: 325.4916s
	iters: 800, epoch: 2 | loss: 0.2230598
	speed: 0.0339s/iter; left time: 322.0060s
	iters: 900, epoch: 2 | loss: 0.2083793
	speed: 0.0336s/iter; left time: 315.0658s
	iters: 1000, epoch: 2 | loss: 1.0209814
	speed: 0.0336s/iter; left time: 312.4402s
	iters: 1100, epoch: 2 | loss: 0.3530688
	speed: 0.0337s/iter; left time: 309.5714s
Epoch: 2 cost time: 39.02572202682495
Epoch: 2, Steps: 1143 | Train Loss: 0.3461315 Vali Loss: 0.5675641 Test Loss: 0.4757245
Validation loss decreased (0.661237 --> 0.567564).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2500496
	speed: 0.1102s/iter; left time: 996.9197s
	iters: 200, epoch: 3 | loss: 0.3025341
	speed: 0.0337s/iter; left time: 301.5045s
	iters: 300, epoch: 3 | loss: 0.7472605
	speed: 0.0339s/iter; left time: 299.5873s
	iters: 400, epoch: 3 | loss: 0.1868578
	speed: 0.0339s/iter; left time: 296.4907s
	iters: 500, epoch: 3 | loss: 0.2005445
	speed: 0.0341s/iter; left time: 295.1942s
	iters: 600, epoch: 3 | loss: 0.5376038
	speed: 0.0339s/iter; left time: 289.8759s
	iters: 700, epoch: 3 | loss: 0.1987725
	speed: 0.0338s/iter; left time: 285.4842s
	iters: 800, epoch: 3 | loss: 0.2177621
	speed: 0.0338s/iter; left time: 282.2076s
	iters: 900, epoch: 3 | loss: 0.1901820
	speed: 0.0335s/iter; left time: 276.5636s
	iters: 1000, epoch: 3 | loss: 0.4791488
	speed: 0.0335s/iter; left time: 272.9256s
	iters: 1100, epoch: 3 | loss: 0.8999235
	speed: 0.0335s/iter; left time: 269.7351s
Epoch: 3 cost time: 38.596291303634644
Epoch: 3, Steps: 1143 | Train Loss: 0.2783090 Vali Loss: 0.5673687 Test Loss: 0.4729919
Validation loss decreased (0.567564 --> 0.567369).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2346621
	speed: 0.1105s/iter; left time: 872.9742s
	iters: 200, epoch: 4 | loss: 0.1887810
	speed: 0.0336s/iter; left time: 261.8705s
	iters: 300, epoch: 4 | loss: 0.2064782
	speed: 0.0335s/iter; left time: 257.6725s
	iters: 400, epoch: 4 | loss: 0.2531295
	speed: 0.0344s/iter; left time: 261.7836s
	iters: 500, epoch: 4 | loss: 0.1733353
	speed: 0.0349s/iter; left time: 262.0717s
	iters: 600, epoch: 4 | loss: 0.1830856
	speed: 0.0350s/iter; left time: 259.3277s
	iters: 700, epoch: 4 | loss: 0.2185509
	speed: 0.0350s/iter; left time: 255.8708s
	iters: 800, epoch: 4 | loss: 0.2169136
	speed: 0.0349s/iter; left time: 251.5933s
	iters: 900, epoch: 4 | loss: 0.2066615
	speed: 0.0347s/iter; left time: 246.2008s
	iters: 1000, epoch: 4 | loss: 0.2807504
	speed: 0.0347s/iter; left time: 242.9301s
	iters: 1100, epoch: 4 | loss: 0.2103571
	speed: 0.0348s/iter; left time: 239.9970s
Epoch: 4 cost time: 39.393656730651855
Epoch: 4, Steps: 1143 | Train Loss: 0.2511182 Vali Loss: 0.5570304 Test Loss: 0.4495817
Validation loss decreased (0.567369 --> 0.557030).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1320913
	speed: 0.1114s/iter; left time: 753.0731s
	iters: 200, epoch: 5 | loss: 0.1347595
	speed: 0.0336s/iter; left time: 223.4803s
	iters: 300, epoch: 5 | loss: 0.1417306
	speed: 0.0336s/iter; left time: 220.3750s
	iters: 400, epoch: 5 | loss: 0.3081042
	speed: 0.0336s/iter; left time: 217.2846s
	iters: 500, epoch: 5 | loss: 0.2916710
	speed: 0.0338s/iter; left time: 215.2391s
	iters: 600, epoch: 5 | loss: 0.1571871
	speed: 0.0339s/iter; left time: 212.0034s
	iters: 700, epoch: 5 | loss: 0.1753141
	speed: 0.0339s/iter; left time: 208.7118s
	iters: 800, epoch: 5 | loss: 0.1755853
	speed: 0.0337s/iter; left time: 204.2065s
	iters: 900, epoch: 5 | loss: 0.1858969
	speed: 0.0335s/iter; left time: 199.7343s
	iters: 1000, epoch: 5 | loss: 0.1464349
	speed: 0.0336s/iter; left time: 196.9398s
	iters: 1100, epoch: 5 | loss: 0.1930023
	speed: 0.0337s/iter; left time: 193.8450s
Epoch: 5 cost time: 38.551153898239136
Epoch: 5, Steps: 1143 | Train Loss: 0.2388291 Vali Loss: 0.5501738 Test Loss: 0.4536808
Validation loss decreased (0.557030 --> 0.550174).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2134352
	speed: 0.1142s/iter; left time: 641.6121s
	iters: 200, epoch: 6 | loss: 0.2763087
	speed: 0.0335s/iter; left time: 184.8491s
	iters: 300, epoch: 6 | loss: 0.1859153
	speed: 0.0337s/iter; left time: 182.5086s
	iters: 400, epoch: 6 | loss: 0.1520987
	speed: 0.0335s/iter; left time: 178.2984s
	iters: 500, epoch: 6 | loss: 0.4294427
	speed: 0.0334s/iter; left time: 174.4064s
	iters: 600, epoch: 6 | loss: 0.1491803
	speed: 0.0334s/iter; left time: 170.7572s
	iters: 700, epoch: 6 | loss: 0.1232794
	speed: 0.0334s/iter; left time: 167.5702s
	iters: 800, epoch: 6 | loss: 0.2198020
	speed: 0.0334s/iter; left time: 164.3259s
	iters: 900, epoch: 6 | loss: 0.1712688
	speed: 0.0333s/iter; left time: 160.5825s
	iters: 1000, epoch: 6 | loss: 0.1945686
	speed: 0.0334s/iter; left time: 157.3961s
	iters: 1100, epoch: 6 | loss: 0.5225970
	speed: 0.0334s/iter; left time: 154.0605s
Epoch: 6 cost time: 38.23137807846069
Epoch: 6, Steps: 1143 | Train Loss: 0.2332877 Vali Loss: 0.5491854 Test Loss: 0.4523109
Validation loss decreased (0.550174 --> 0.549185).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1312743
	speed: 0.1139s/iter; left time: 509.5502s
	iters: 200, epoch: 7 | loss: 0.1541259
	speed: 0.0352s/iter; left time: 153.9411s
	iters: 300, epoch: 7 | loss: 0.1896898
	speed: 0.0354s/iter; left time: 151.3302s
	iters: 400, epoch: 7 | loss: 0.2069640
	speed: 0.0354s/iter; left time: 147.6981s
	iters: 500, epoch: 7 | loss: 0.4475433
	speed: 0.0352s/iter; left time: 143.5031s
	iters: 600, epoch: 7 | loss: 0.2845293
	speed: 0.0353s/iter; left time: 140.0993s
	iters: 700, epoch: 7 | loss: 0.2099641
	speed: 0.0355s/iter; left time: 137.4376s
	iters: 800, epoch: 7 | loss: 0.1707202
	speed: 0.0342s/iter; left time: 128.8620s
	iters: 900, epoch: 7 | loss: 0.1266303
	speed: 0.0336s/iter; left time: 123.4505s
	iters: 1000, epoch: 7 | loss: 0.1337977
	speed: 0.0337s/iter; left time: 120.2628s
	iters: 1100, epoch: 7 | loss: 0.1718045
	speed: 0.0337s/iter; left time: 117.0964s
Epoch: 7 cost time: 39.72838091850281
Epoch: 7, Steps: 1143 | Train Loss: 0.2303055 Vali Loss: 0.5476956 Test Loss: 0.4492833
Validation loss decreased (0.549185 --> 0.547696).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1440802
	speed: 0.1113s/iter; left time: 370.7040s
	iters: 200, epoch: 8 | loss: 0.1732336
	speed: 0.0337s/iter; left time: 108.9293s
	iters: 300, epoch: 8 | loss: 0.1747601
	speed: 0.0337s/iter; left time: 105.4041s
	iters: 400, epoch: 8 | loss: 0.1877166
	speed: 0.0336s/iter; left time: 101.8787s
	iters: 500, epoch: 8 | loss: 0.1594715
	speed: 0.0339s/iter; left time: 99.4513s
	iters: 600, epoch: 8 | loss: 0.1975421
	speed: 0.0339s/iter; left time: 95.8425s
	iters: 700, epoch: 8 | loss: 0.4961646
	speed: 0.0341s/iter; left time: 93.0028s
	iters: 800, epoch: 8 | loss: 0.5105218
	speed: 0.0336s/iter; left time: 88.4489s
	iters: 900, epoch: 8 | loss: 0.2155854
	speed: 0.0337s/iter; left time: 85.2454s
	iters: 1000, epoch: 8 | loss: 0.8563664
	speed: 0.0338s/iter; left time: 82.0787s
	iters: 1100, epoch: 8 | loss: 0.2059610
	speed: 0.0339s/iter; left time: 78.8835s
Epoch: 8 cost time: 38.63830924034119
Epoch: 8, Steps: 1143 | Train Loss: 0.2289368 Vali Loss: 0.5497587 Test Loss: 0.4535764
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1821229
	speed: 0.1084s/iter; left time: 237.1416s
	iters: 200, epoch: 9 | loss: 0.1778435
	speed: 0.0338s/iter; left time: 70.5723s
	iters: 300, epoch: 9 | loss: 0.1808693
	speed: 0.0338s/iter; left time: 67.1752s
	iters: 400, epoch: 9 | loss: 0.1443308
	speed: 0.0338s/iter; left time: 63.8292s
	iters: 500, epoch: 9 | loss: 0.2014986
	speed: 0.0339s/iter; left time: 60.5384s
	iters: 600, epoch: 9 | loss: 0.1083937
	speed: 0.0337s/iter; left time: 56.8477s
	iters: 700, epoch: 9 | loss: 0.1172192
	speed: 0.0337s/iter; left time: 53.5411s
	iters: 800, epoch: 9 | loss: 0.1194306
	speed: 0.0343s/iter; left time: 51.0422s
	iters: 900, epoch: 9 | loss: 0.1454516
	speed: 0.0344s/iter; left time: 47.7752s
	iters: 1000, epoch: 9 | loss: 0.4889131
	speed: 0.0348s/iter; left time: 44.7657s
	iters: 1100, epoch: 9 | loss: 0.1659434
	speed: 0.0349s/iter; left time: 41.4367s
Epoch: 9 cost time: 39.00604724884033
Epoch: 9, Steps: 1143 | Train Loss: 0.2280756 Vali Loss: 0.5512848 Test Loss: 0.4648167
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1674614
	speed: 0.1106s/iter; left time: 115.5100s
	iters: 200, epoch: 10 | loss: 0.1684794
	speed: 0.0350s/iter; left time: 33.0529s
	iters: 300, epoch: 10 | loss: 0.1380493
	speed: 0.0346s/iter; left time: 29.2124s
	iters: 400, epoch: 10 | loss: 0.2825476
	speed: 0.0336s/iter; left time: 24.9931s
	iters: 500, epoch: 10 | loss: 0.2523345
	speed: 0.0336s/iter; left time: 21.6303s
	iters: 600, epoch: 10 | loss: 0.1480420
	speed: 0.0336s/iter; left time: 18.2969s
	iters: 700, epoch: 10 | loss: 0.4657637
	speed: 0.0341s/iter; left time: 15.1233s
	iters: 800, epoch: 10 | loss: 0.1379714
	speed: 0.0339s/iter; left time: 11.6618s
	iters: 900, epoch: 10 | loss: 0.1459074
	speed: 0.0338s/iter; left time: 8.2562s
	iters: 1000, epoch: 10 | loss: 0.5281360
	speed: 0.0336s/iter; left time: 4.8412s
	iters: 1100, epoch: 10 | loss: 0.4573252
	speed: 0.0336s/iter; left time: 1.4784s
Epoch: 10 cost time: 38.86509847640991
Epoch: 10, Steps: 1143 | Train Loss: 0.2277314 Vali Loss: 0.5524118 Test Loss: 0.4591902
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : weather_192_Informer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed15227<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10348
mse:0.4494800567626953, mae:0.4553474187850952
