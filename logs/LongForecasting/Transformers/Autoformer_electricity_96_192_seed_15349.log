Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=321, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', dec_in=321, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Autoformer', model_id='electricity_192', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=192, root_path='./dataset/', seed=15349, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : electricity_192_Autoformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed15349>>>>>>>>>>>>>>>>>>>>>>>>>>
train 18125
val 2441
test 5069
	iters: 100, epoch: 1 | loss: 0.2965674
	speed: 0.1033s/iter; left time: 574.4182s
	iters: 200, epoch: 1 | loss: 0.2762960
	speed: 0.0698s/iter; left time: 381.3877s
	iters: 300, epoch: 1 | loss: 0.2529666
	speed: 0.0714s/iter; left time: 383.0147s
	iters: 400, epoch: 1 | loss: 0.2520733
	speed: 0.0721s/iter; left time: 379.0771s
	iters: 500, epoch: 1 | loss: 0.2078318
	speed: 0.0719s/iter; left time: 370.8465s
Epoch: 1 cost time: 43.64920997619629
Epoch: 1, Steps: 566 | Train Loss: 0.2844533 Vali Loss: 0.1968196 Test Loss: 0.2327111
Validation loss decreased (inf --> 0.196820).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2069313
	speed: 0.2564s/iter; left time: 1280.8128s
	iters: 200, epoch: 2 | loss: 0.1966740
	speed: 0.0698s/iter; left time: 341.8622s
	iters: 300, epoch: 2 | loss: 0.2210422
	speed: 0.0701s/iter; left time: 336.2918s
	iters: 400, epoch: 2 | loss: 0.1604730
	speed: 0.0703s/iter; left time: 329.9328s
	iters: 500, epoch: 2 | loss: 0.1782960
	speed: 0.0701s/iter; left time: 321.9076s
Epoch: 2 cost time: 39.618616580963135
Epoch: 2, Steps: 566 | Train Loss: 0.1892289 Vali Loss: 0.1811882 Test Loss: 0.2177926
Validation loss decreased (0.196820 --> 0.181188).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1565559
	speed: 0.2553s/iter; left time: 1130.5776s
	iters: 200, epoch: 3 | loss: 0.1829063
	speed: 0.0697s/iter; left time: 301.5717s
	iters: 300, epoch: 3 | loss: 0.1636017
	speed: 0.0695s/iter; left time: 293.9366s
	iters: 400, epoch: 3 | loss: 0.1613564
	speed: 0.0711s/iter; left time: 293.4826s
	iters: 500, epoch: 3 | loss: 0.1614210
	speed: 0.0726s/iter; left time: 292.3782s
Epoch: 3 cost time: 40.09513306617737
Epoch: 3, Steps: 566 | Train Loss: 0.1651322 Vali Loss: 0.1756643 Test Loss: 0.2130915
Validation loss decreased (0.181188 --> 0.175664).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1545829
	speed: 0.2612s/iter; left time: 1008.9163s
	iters: 200, epoch: 4 | loss: 0.1487056
	speed: 0.0705s/iter; left time: 265.4235s
	iters: 300, epoch: 4 | loss: 0.1611687
	speed: 0.0702s/iter; left time: 257.0377s
	iters: 400, epoch: 4 | loss: 0.1496381
	speed: 0.0703s/iter; left time: 250.3641s
	iters: 500, epoch: 4 | loss: 0.1443087
	speed: 0.0700s/iter; left time: 242.3623s
Epoch: 4 cost time: 39.713343381881714
Epoch: 4, Steps: 566 | Train Loss: 0.1563552 Vali Loss: 0.1796055 Test Loss: 0.2128623
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1483659
	speed: 0.2540s/iter; left time: 837.3538s
	iters: 200, epoch: 5 | loss: 0.1470404
	speed: 0.0696s/iter; left time: 222.5612s
	iters: 300, epoch: 5 | loss: 0.1594863
	speed: 0.0700s/iter; left time: 216.8980s
	iters: 400, epoch: 5 | loss: 0.1538591
	speed: 0.0696s/iter; left time: 208.7248s
	iters: 500, epoch: 5 | loss: 0.1548904
	speed: 0.0697s/iter; left time: 201.9414s
Epoch: 5 cost time: 39.66656017303467
Epoch: 5, Steps: 566 | Train Loss: 0.1518983 Vali Loss: 0.1805132 Test Loss: 0.2138501
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1548197
	speed: 0.2570s/iter; left time: 701.8365s
	iters: 200, epoch: 6 | loss: 0.1477121
	speed: 0.0713s/iter; left time: 187.5230s
	iters: 300, epoch: 6 | loss: 0.1531916
	speed: 0.0702s/iter; left time: 177.6324s
	iters: 400, epoch: 6 | loss: 0.1440389
	speed: 0.0700s/iter; left time: 170.1129s
	iters: 500, epoch: 6 | loss: 0.1567497
	speed: 0.0700s/iter; left time: 163.1657s
Epoch: 6 cost time: 39.78570866584778
Epoch: 6, Steps: 566 | Train Loss: 0.1496453 Vali Loss: 0.1831668 Test Loss: 0.2166480
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : electricity_192_Autoformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed15349<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5069
mse:0.21197012066841125, mae:0.3218584656715393
