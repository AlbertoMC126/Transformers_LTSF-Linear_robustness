Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=21, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=21, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Informer', model_id='weather_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=96, root_path='./dataset/', seed=15349, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_96_Informer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed15349>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36696
val 5175
test 10444
	iters: 100, epoch: 1 | loss: 0.4129685
	speed: 0.0601s/iter; left time: 683.1888s
	iters: 200, epoch: 1 | loss: 0.2909977
	speed: 0.0287s/iter; left time: 323.3354s
	iters: 300, epoch: 1 | loss: 0.3215364
	speed: 0.0285s/iter; left time: 318.2317s
	iters: 400, epoch: 1 | loss: 0.3431772
	speed: 0.0287s/iter; left time: 317.0723s
	iters: 500, epoch: 1 | loss: 0.3406470
	speed: 0.0286s/iter; left time: 313.4998s
	iters: 600, epoch: 1 | loss: 0.2604295
	speed: 0.0289s/iter; left time: 313.3802s
	iters: 700, epoch: 1 | loss: 0.2338769
	speed: 0.0290s/iter; left time: 311.9749s
	iters: 800, epoch: 1 | loss: 0.4156401
	speed: 0.0287s/iter; left time: 305.9298s
	iters: 900, epoch: 1 | loss: 0.2485951
	speed: 0.0276s/iter; left time: 291.7223s
	iters: 1000, epoch: 1 | loss: 0.2082699
	speed: 0.0280s/iter; left time: 293.3027s
	iters: 1100, epoch: 1 | loss: 0.1817754
	speed: 0.0278s/iter; left time: 288.3844s
Epoch: 1 cost time: 35.76692485809326
Epoch: 1, Steps: 1146 | Train Loss: 0.4021783 Vali Loss: 0.4757268 Test Loss: 0.3744809
Validation loss decreased (inf --> 0.475727).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 1.2001776
	speed: 0.0884s/iter; left time: 903.1405s
	iters: 200, epoch: 2 | loss: 0.8868938
	speed: 0.0275s/iter; left time: 278.5626s
	iters: 300, epoch: 2 | loss: 0.3132804
	speed: 0.0280s/iter; left time: 280.4958s
	iters: 400, epoch: 2 | loss: 0.2876564
	speed: 0.0280s/iter; left time: 277.9603s
	iters: 500, epoch: 2 | loss: 0.1830219
	speed: 0.0281s/iter; left time: 275.7817s
	iters: 600, epoch: 2 | loss: 0.2260013
	speed: 0.0279s/iter; left time: 270.8414s
	iters: 700, epoch: 2 | loss: 0.4088106
	speed: 0.0276s/iter; left time: 265.6389s
	iters: 800, epoch: 2 | loss: 0.1831903
	speed: 0.0275s/iter; left time: 262.0588s
	iters: 900, epoch: 2 | loss: 0.3124966
	speed: 0.0275s/iter; left time: 259.2517s
	iters: 1000, epoch: 2 | loss: 0.2221940
	speed: 0.0275s/iter; left time: 255.9601s
	iters: 1100, epoch: 2 | loss: 0.2502557
	speed: 0.0275s/iter; left time: 253.2962s
Epoch: 2 cost time: 31.741990566253662
Epoch: 2, Steps: 1146 | Train Loss: 0.3255205 Vali Loss: 0.4729567 Test Loss: 0.3184747
Validation loss decreased (0.475727 --> 0.472957).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1695327
	speed: 0.0885s/iter; left time: 802.3908s
	iters: 200, epoch: 3 | loss: 0.1808448
	speed: 0.0276s/iter; left time: 247.3592s
	iters: 300, epoch: 3 | loss: 0.1779013
	speed: 0.0275s/iter; left time: 243.5213s
	iters: 400, epoch: 3 | loss: 0.2768962
	speed: 0.0275s/iter; left time: 240.9562s
	iters: 500, epoch: 3 | loss: 0.1794849
	speed: 0.0273s/iter; left time: 237.0029s
	iters: 600, epoch: 3 | loss: 0.1889765
	speed: 0.0273s/iter; left time: 234.3544s
	iters: 700, epoch: 3 | loss: 0.2030372
	speed: 0.0274s/iter; left time: 231.6272s
	iters: 800, epoch: 3 | loss: 0.1651208
	speed: 0.0274s/iter; left time: 229.3999s
	iters: 900, epoch: 3 | loss: 0.3088017
	speed: 0.0274s/iter; left time: 226.4623s
	iters: 1000, epoch: 3 | loss: 0.1681034
	speed: 0.0274s/iter; left time: 223.6599s
	iters: 1100, epoch: 3 | loss: 0.3273084
	speed: 0.0274s/iter; left time: 220.7574s
Epoch: 3 cost time: 31.430278539657593
Epoch: 3, Steps: 1146 | Train Loss: 0.2677058 Vali Loss: 0.5188569 Test Loss: 0.3953693
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3265674
	speed: 0.0858s/iter; left time: 679.5936s
	iters: 200, epoch: 4 | loss: 0.1091482
	speed: 0.0292s/iter; left time: 228.1938s
	iters: 300, epoch: 4 | loss: 0.1338923
	speed: 0.0296s/iter; left time: 228.4484s
	iters: 400, epoch: 4 | loss: 0.1589154
	speed: 0.0294s/iter; left time: 224.1305s
	iters: 500, epoch: 4 | loss: 0.1406418
	speed: 0.0296s/iter; left time: 222.4030s
	iters: 600, epoch: 4 | loss: 0.2613271
	speed: 0.0293s/iter; left time: 217.4416s
	iters: 700, epoch: 4 | loss: 0.1733323
	speed: 0.0295s/iter; left time: 215.6795s
	iters: 800, epoch: 4 | loss: 0.1989460
	speed: 0.0294s/iter; left time: 212.4546s
	iters: 900, epoch: 4 | loss: 0.1295080
	speed: 0.0294s/iter; left time: 209.3590s
	iters: 1000, epoch: 4 | loss: 0.1198713
	speed: 0.0294s/iter; left time: 206.4898s
	iters: 1100, epoch: 4 | loss: 0.3069596
	speed: 0.0295s/iter; left time: 203.8953s
Epoch: 4 cost time: 33.4633424282074
Epoch: 4, Steps: 1146 | Train Loss: 0.2406702 Vali Loss: 0.5076762 Test Loss: 0.3970157
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1206675
	speed: 0.0866s/iter; left time: 587.0684s
	iters: 200, epoch: 5 | loss: 0.2044765
	speed: 0.0276s/iter; left time: 184.1820s
	iters: 300, epoch: 5 | loss: 0.1581298
	speed: 0.0280s/iter; left time: 184.1358s
	iters: 400, epoch: 5 | loss: 0.1600260
	speed: 0.0277s/iter; left time: 179.2932s
	iters: 500, epoch: 5 | loss: 0.1041100
	speed: 0.0277s/iter; left time: 176.9388s
	iters: 600, epoch: 5 | loss: 0.2449559
	speed: 0.0277s/iter; left time: 173.6070s
	iters: 700, epoch: 5 | loss: 0.2512256
	speed: 0.0276s/iter; left time: 170.7288s
	iters: 800, epoch: 5 | loss: 0.1725630
	speed: 0.0276s/iter; left time: 167.7228s
	iters: 900, epoch: 5 | loss: 0.8291000
	speed: 0.0281s/iter; left time: 168.0517s
	iters: 1000, epoch: 5 | loss: 0.1575433
	speed: 0.0276s/iter; left time: 162.2514s
	iters: 1100, epoch: 5 | loss: 0.1442341
	speed: 0.0275s/iter; left time: 158.9257s
Epoch: 5 cost time: 31.756678581237793
Epoch: 5, Steps: 1146 | Train Loss: 0.2273738 Vali Loss: 0.5129246 Test Loss: 0.4118526
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : weather_96_Informer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed15349<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
mse:0.31851726770401, mae:0.3847624659538269
