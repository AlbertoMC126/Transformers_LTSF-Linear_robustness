Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=862, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=862, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Autoformer', model_id='traffic_192', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=192, root_path='./dataset/', seed=25565, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_192_Autoformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed25565>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11993
val 1565
test 3317
	iters: 100, epoch: 1 | loss: 0.4452072
	speed: 0.1243s/iter; left time: 452.4330s
	iters: 200, epoch: 1 | loss: 0.3852505
	speed: 0.0875s/iter; left time: 309.8042s
	iters: 300, epoch: 1 | loss: 0.3263216
	speed: 0.0874s/iter; left time: 300.7480s
Epoch: 1 cost time: 36.36169242858887
Epoch: 1, Steps: 374 | Train Loss: 0.4224854 Vali Loss: 0.5225188 Test Loss: 0.6644650
Validation loss decreased (inf --> 0.522519).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2991713
	speed: 0.2886s/iter; left time: 942.7998s
	iters: 200, epoch: 2 | loss: 0.3070934
	speed: 0.0914s/iter; left time: 289.3229s
	iters: 300, epoch: 2 | loss: 0.2764080
	speed: 0.0917s/iter; left time: 281.2344s
Epoch: 2 cost time: 33.862740993499756
Epoch: 2, Steps: 374 | Train Loss: 0.2846895 Vali Loss: 0.5093371 Test Loss: 0.6789589
Validation loss decreased (0.522519 --> 0.509337).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2463710
	speed: 0.2930s/iter; left time: 847.6137s
	iters: 200, epoch: 3 | loss: 0.2486071
	speed: 0.0878s/iter; left time: 245.1679s
	iters: 300, epoch: 3 | loss: 0.2524117
	speed: 0.0885s/iter; left time: 238.2814s
Epoch: 3 cost time: 32.937814235687256
Epoch: 3, Steps: 374 | Train Loss: 0.2535676 Vali Loss: 0.5016041 Test Loss: 0.6487245
Validation loss decreased (0.509337 --> 0.501604).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2548000
	speed: 0.2896s/iter; left time: 729.5166s
	iters: 200, epoch: 4 | loss: 0.2486753
	speed: 0.0870s/iter; left time: 210.3562s
	iters: 300, epoch: 4 | loss: 0.2367541
	speed: 0.0872s/iter; left time: 202.1973s
Epoch: 4 cost time: 32.66214942932129
Epoch: 4, Steps: 374 | Train Loss: 0.2445541 Vali Loss: 0.4996393 Test Loss: 0.6446495
Validation loss decreased (0.501604 --> 0.499639).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2415534
	speed: 0.2942s/iter; left time: 631.1385s
	iters: 200, epoch: 5 | loss: 0.2410612
	speed: 0.0903s/iter; left time: 184.7078s
	iters: 300, epoch: 5 | loss: 0.2573920
	speed: 0.0880s/iter; left time: 171.2152s
Epoch: 5 cost time: 33.423336029052734
Epoch: 5, Steps: 374 | Train Loss: 0.2404950 Vali Loss: 0.4975949 Test Loss: 0.6462715
Validation loss decreased (0.499639 --> 0.497595).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2255802
	speed: 0.2913s/iter; left time: 515.8671s
	iters: 200, epoch: 6 | loss: 0.2416737
	speed: 0.0876s/iter; left time: 146.4188s
	iters: 300, epoch: 6 | loss: 0.2384744
	speed: 0.0880s/iter; left time: 138.3015s
Epoch: 6 cost time: 32.79604744911194
Epoch: 6, Steps: 374 | Train Loss: 0.2380752 Vali Loss: 0.4936558 Test Loss: 0.6405880
Validation loss decreased (0.497595 --> 0.493656).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2316905
	speed: 0.2891s/iter; left time: 403.9028s
	iters: 200, epoch: 7 | loss: 0.2375621
	speed: 0.0894s/iter; left time: 115.9696s
	iters: 300, epoch: 7 | loss: 0.2346786
	speed: 0.0913s/iter; left time: 109.2853s
Epoch: 7 cost time: 33.57536792755127
Epoch: 7, Steps: 374 | Train Loss: 0.2369266 Vali Loss: 0.4899390 Test Loss: 0.6353933
Validation loss decreased (0.493656 --> 0.489939).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2438300
	speed: 0.2937s/iter; left time: 300.4757s
	iters: 200, epoch: 8 | loss: 0.2400700
	speed: 0.0868s/iter; left time: 80.1221s
	iters: 300, epoch: 8 | loss: 0.2322500
	speed: 0.0875s/iter; left time: 72.0111s
Epoch: 8 cost time: 32.68927335739136
Epoch: 8, Steps: 374 | Train Loss: 0.2360469 Vali Loss: 0.4910173 Test Loss: 0.6412152
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2132192
	speed: 0.2874s/iter; left time: 186.5448s
	iters: 200, epoch: 9 | loss: 0.2422407
	speed: 0.0876s/iter; left time: 48.0900s
	iters: 300, epoch: 9 | loss: 0.2363270
	speed: 0.0872s/iter; left time: 39.1670s
Epoch: 9 cost time: 32.6915020942688
Epoch: 9, Steps: 374 | Train Loss: 0.2357671 Vali Loss: 0.4903415 Test Loss: 0.6419303
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2241305
	speed: 0.2909s/iter; left time: 80.0041s
	iters: 200, epoch: 10 | loss: 0.2239425
	speed: 0.0922s/iter; left time: 16.1370s
	iters: 300, epoch: 10 | loss: 0.2451082
	speed: 0.0900s/iter; left time: 6.7529s
Epoch: 10 cost time: 33.949602127075195
Epoch: 10, Steps: 374 | Train Loss: 0.2357143 Vali Loss: 0.4894776 Test Loss: 0.6405362
Validation loss decreased (0.489939 --> 0.489478).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>testing : traffic_192_Autoformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed25565<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3317
mse:0.6411039233207703, mae:0.405549019575119
