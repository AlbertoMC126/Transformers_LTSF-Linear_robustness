Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm1', data_path='ETTm1.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Autoformer', model_id='ETTm1_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=96, root_path='./dataset/', seed=25565, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm1_96_Autoformer_ETTm1_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed25565>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34369
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.4414822
	speed: 0.0812s/iter; left time: 863.7477s
	iters: 200, epoch: 1 | loss: 0.4139578
	speed: 0.0473s/iter; left time: 498.6195s
	iters: 300, epoch: 1 | loss: 0.4182437
	speed: 0.0473s/iter; left time: 493.8859s
	iters: 400, epoch: 1 | loss: 0.3153016
	speed: 0.0472s/iter; left time: 488.5473s
	iters: 500, epoch: 1 | loss: 0.3344185
	speed: 0.0473s/iter; left time: 484.1037s
	iters: 600, epoch: 1 | loss: 0.2885038
	speed: 0.0472s/iter; left time: 478.5933s
	iters: 700, epoch: 1 | loss: 0.2422561
	speed: 0.0473s/iter; left time: 474.8668s
	iters: 800, epoch: 1 | loss: 0.2616374
	speed: 0.0478s/iter; left time: 475.3299s
	iters: 900, epoch: 1 | loss: 0.2911842
	speed: 0.0473s/iter; left time: 465.2669s
	iters: 1000, epoch: 1 | loss: 0.2435008
	speed: 0.0472s/iter; left time: 459.8354s
Epoch: 1 cost time: 54.23733401298523
Epoch: 1, Steps: 1074 | Train Loss: 0.3334125 Vali Loss: 0.6693948 Test Loss: 0.6010209
Validation loss decreased (inf --> 0.669395).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2636493
	speed: 0.2780s/iter; left time: 2659.9633s
	iters: 200, epoch: 2 | loss: 0.2792473
	speed: 0.0473s/iter; left time: 448.2622s
	iters: 300, epoch: 2 | loss: 0.3089216
	speed: 0.0474s/iter; left time: 444.1130s
	iters: 400, epoch: 2 | loss: 0.2914771
	speed: 0.0473s/iter; left time: 438.2453s
	iters: 500, epoch: 2 | loss: 0.2245383
	speed: 0.0473s/iter; left time: 433.8051s
	iters: 600, epoch: 2 | loss: 0.2274529
	speed: 0.0474s/iter; left time: 429.6071s
	iters: 700, epoch: 2 | loss: 0.2623580
	speed: 0.0472s/iter; left time: 423.5928s
	iters: 800, epoch: 2 | loss: 0.2538808
	speed: 0.0472s/iter; left time: 418.4131s
	iters: 900, epoch: 2 | loss: 0.1850984
	speed: 0.0473s/iter; left time: 414.7894s
	iters: 1000, epoch: 2 | loss: 0.2193056
	speed: 0.0473s/iter; left time: 409.9879s
Epoch: 2 cost time: 50.814690828323364
Epoch: 2, Steps: 1074 | Train Loss: 0.2512222 Vali Loss: 0.6703838 Test Loss: 0.5870718
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2105852
	speed: 0.2752s/iter; left time: 2336.9031s
	iters: 200, epoch: 3 | loss: 0.2348197
	speed: 0.0475s/iter; left time: 398.4235s
	iters: 300, epoch: 3 | loss: 0.2509146
	speed: 0.0473s/iter; left time: 392.2252s
	iters: 400, epoch: 3 | loss: 0.2021159
	speed: 0.0474s/iter; left time: 388.1675s
	iters: 500, epoch: 3 | loss: 0.1713051
	speed: 0.0473s/iter; left time: 382.8267s
	iters: 600, epoch: 3 | loss: 0.1914653
	speed: 0.0473s/iter; left time: 378.1445s
	iters: 700, epoch: 3 | loss: 0.1840467
	speed: 0.0472s/iter; left time: 372.6526s
	iters: 800, epoch: 3 | loss: 0.1821561
	speed: 0.0473s/iter; left time: 368.8092s
	iters: 900, epoch: 3 | loss: 0.1854078
	speed: 0.0473s/iter; left time: 363.7211s
	iters: 1000, epoch: 3 | loss: 0.1792004
	speed: 0.0473s/iter; left time: 359.1743s
Epoch: 3 cost time: 50.813063859939575
Epoch: 3, Steps: 1074 | Train Loss: 0.2076116 Vali Loss: 0.6302601 Test Loss: 0.5418827
Validation loss decreased (0.669395 --> 0.630260).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1908075
	speed: 0.2785s/iter; left time: 2065.8528s
	iters: 200, epoch: 4 | loss: 0.1642956
	speed: 0.0472s/iter; left time: 345.5386s
	iters: 300, epoch: 4 | loss: 0.1626508
	speed: 0.0472s/iter; left time: 340.5305s
	iters: 400, epoch: 4 | loss: 0.2378346
	speed: 0.0472s/iter; left time: 336.3157s
	iters: 500, epoch: 4 | loss: 0.2026328
	speed: 0.0473s/iter; left time: 332.2622s
	iters: 600, epoch: 4 | loss: 0.1606795
	speed: 0.0473s/iter; left time: 327.5267s
	iters: 700, epoch: 4 | loss: 0.1707023
	speed: 0.0473s/iter; left time: 322.8441s
	iters: 800, epoch: 4 | loss: 0.1546101
	speed: 0.0473s/iter; left time: 317.6016s
	iters: 900, epoch: 4 | loss: 0.1936681
	speed: 0.0473s/iter; left time: 313.3746s
	iters: 1000, epoch: 4 | loss: 0.1895074
	speed: 0.0472s/iter; left time: 307.7411s
Epoch: 4 cost time: 50.77467107772827
Epoch: 4, Steps: 1074 | Train Loss: 0.1843229 Vali Loss: 0.6330123 Test Loss: 0.5474166
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2164786
	speed: 0.2770s/iter; left time: 1757.5548s
	iters: 200, epoch: 5 | loss: 0.1501581
	speed: 0.0473s/iter; left time: 295.2369s
	iters: 300, epoch: 5 | loss: 0.1522676
	speed: 0.0473s/iter; left time: 290.6802s
	iters: 400, epoch: 5 | loss: 0.1364124
	speed: 0.0473s/iter; left time: 286.0742s
	iters: 500, epoch: 5 | loss: 0.2085379
	speed: 0.0474s/iter; left time: 281.7919s
	iters: 600, epoch: 5 | loss: 0.1625128
	speed: 0.0474s/iter; left time: 277.2233s
	iters: 700, epoch: 5 | loss: 0.1379012
	speed: 0.0475s/iter; left time: 272.9602s
	iters: 800, epoch: 5 | loss: 0.1482942
	speed: 0.0472s/iter; left time: 266.4865s
	iters: 900, epoch: 5 | loss: 0.1667551
	speed: 0.0472s/iter; left time: 261.5988s
	iters: 1000, epoch: 5 | loss: 0.1869118
	speed: 0.0473s/iter; left time: 257.4861s
Epoch: 5 cost time: 50.82550358772278
Epoch: 5, Steps: 1074 | Train Loss: 0.1730271 Vali Loss: 0.6289968 Test Loss: 0.5436035
Validation loss decreased (0.630260 --> 0.628997).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1276627
	speed: 0.2775s/iter; left time: 1462.4835s
	iters: 200, epoch: 6 | loss: 0.1713969
	speed: 0.0473s/iter; left time: 244.6636s
	iters: 300, epoch: 6 | loss: 0.1429631
	speed: 0.0473s/iter; left time: 239.7130s
	iters: 400, epoch: 6 | loss: 0.1766528
	speed: 0.0472s/iter; left time: 234.8247s
	iters: 500, epoch: 6 | loss: 0.1743209
	speed: 0.0473s/iter; left time: 230.4536s
	iters: 600, epoch: 6 | loss: 0.1758999
	speed: 0.0473s/iter; left time: 225.5567s
	iters: 700, epoch: 6 | loss: 0.1617827
	speed: 0.0474s/iter; left time: 221.2332s
	iters: 800, epoch: 6 | loss: 0.1778202
	speed: 0.0474s/iter; left time: 216.4568s
	iters: 900, epoch: 6 | loss: 0.1598412
	speed: 0.0472s/iter; left time: 211.2474s
	iters: 1000, epoch: 6 | loss: 0.1694995
	speed: 0.0474s/iter; left time: 206.9692s
Epoch: 6 cost time: 50.79435086250305
Epoch: 6, Steps: 1074 | Train Loss: 0.1673328 Vali Loss: 0.6305327 Test Loss: 0.5408613
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1980833
	speed: 0.2756s/iter; left time: 1156.5688s
	iters: 200, epoch: 7 | loss: 0.1559181
	speed: 0.0473s/iter; left time: 193.9849s
	iters: 300, epoch: 7 | loss: 0.1622435
	speed: 0.0473s/iter; left time: 188.9240s
	iters: 400, epoch: 7 | loss: 0.1526663
	speed: 0.0473s/iter; left time: 184.1375s
	iters: 500, epoch: 7 | loss: 0.1399548
	speed: 0.0472s/iter; left time: 179.3874s
	iters: 600, epoch: 7 | loss: 0.1520116
	speed: 0.0473s/iter; left time: 174.8634s
	iters: 700, epoch: 7 | loss: 0.1960915
	speed: 0.0473s/iter; left time: 170.2883s
	iters: 800, epoch: 7 | loss: 0.1494207
	speed: 0.0473s/iter; left time: 165.4059s
	iters: 900, epoch: 7 | loss: 0.1537748
	speed: 0.0473s/iter; left time: 160.6490s
	iters: 1000, epoch: 7 | loss: 0.1614549
	speed: 0.0472s/iter; left time: 155.7312s
Epoch: 7 cost time: 50.774904012680054
Epoch: 7, Steps: 1074 | Train Loss: 0.1645859 Vali Loss: 0.6299735 Test Loss: 0.5426871
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1583506
	speed: 0.2756s/iter; left time: 860.7495s
	iters: 200, epoch: 8 | loss: 0.1897707
	speed: 0.0472s/iter; left time: 142.6419s
	iters: 300, epoch: 8 | loss: 0.1628445
	speed: 0.0473s/iter; left time: 138.2659s
	iters: 400, epoch: 8 | loss: 0.1559683
	speed: 0.0473s/iter; left time: 133.3952s
	iters: 500, epoch: 8 | loss: 0.1651654
	speed: 0.0473s/iter; left time: 128.7600s
	iters: 600, epoch: 8 | loss: 0.1757002
	speed: 0.0473s/iter; left time: 124.1394s
	iters: 700, epoch: 8 | loss: 0.1662791
	speed: 0.0472s/iter; left time: 119.1972s
	iters: 800, epoch: 8 | loss: 0.1373455
	speed: 0.0473s/iter; left time: 114.6108s
	iters: 900, epoch: 8 | loss: 0.1528645
	speed: 0.0473s/iter; left time: 109.7688s
	iters: 1000, epoch: 8 | loss: 0.1665646
	speed: 0.0473s/iter; left time: 105.0554s
Epoch: 8 cost time: 50.75168013572693
Epoch: 8, Steps: 1074 | Train Loss: 0.1634840 Vali Loss: 0.6282189 Test Loss: 0.5386537
Validation loss decreased (0.628997 --> 0.628219).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1776450
	speed: 0.2767s/iter; left time: 566.9740s
	iters: 200, epoch: 9 | loss: 0.1596446
	speed: 0.0475s/iter; left time: 92.4862s
	iters: 300, epoch: 9 | loss: 0.1891458
	speed: 0.0473s/iter; left time: 87.3973s
	iters: 400, epoch: 9 | loss: 0.1882101
	speed: 0.0473s/iter; left time: 82.7859s
	iters: 500, epoch: 9 | loss: 0.1495918
	speed: 0.0474s/iter; left time: 78.1104s
	iters: 600, epoch: 9 | loss: 0.1408310
	speed: 0.0472s/iter; left time: 73.1453s
	iters: 700, epoch: 9 | loss: 0.1643882
	speed: 0.0473s/iter; left time: 68.6084s
	iters: 800, epoch: 9 | loss: 0.1641942
	speed: 0.0473s/iter; left time: 63.8551s
	iters: 900, epoch: 9 | loss: 0.1736071
	speed: 0.0472s/iter; left time: 58.9523s
	iters: 1000, epoch: 9 | loss: 0.1596225
	speed: 0.0472s/iter; left time: 54.2518s
Epoch: 9 cost time: 50.814019203186035
Epoch: 9, Steps: 1074 | Train Loss: 0.1627321 Vali Loss: 0.6268145 Test Loss: 0.5380695
Validation loss decreased (0.628219 --> 0.626815).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1475657
	speed: 0.2777s/iter; left time: 270.7132s
	iters: 200, epoch: 10 | loss: 0.1608751
	speed: 0.0473s/iter; left time: 41.3745s
	iters: 300, epoch: 10 | loss: 0.1539602
	speed: 0.0473s/iter; left time: 36.6223s
	iters: 400, epoch: 10 | loss: 0.1755784
	speed: 0.0472s/iter; left time: 31.8615s
	iters: 500, epoch: 10 | loss: 0.1708652
	speed: 0.0473s/iter; left time: 27.2018s
	iters: 600, epoch: 10 | loss: 0.1891790
	speed: 0.0473s/iter; left time: 22.4788s
	iters: 700, epoch: 10 | loss: 0.1637438
	speed: 0.0474s/iter; left time: 17.7760s
	iters: 800, epoch: 10 | loss: 0.1458232
	speed: 0.0473s/iter; left time: 13.0161s
	iters: 900, epoch: 10 | loss: 0.1502211
	speed: 0.0473s/iter; left time: 8.2860s
	iters: 1000, epoch: 10 | loss: 0.1688484
	speed: 0.0474s/iter; left time: 3.5557s
Epoch: 10 cost time: 50.839895725250244
Epoch: 10, Steps: 1074 | Train Loss: 0.1624136 Vali Loss: 0.6274341 Test Loss: 0.5390367
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : ETTm1_96_Autoformer_ETTm1_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed25565<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.5382426381111145, mae:0.4914337694644928
