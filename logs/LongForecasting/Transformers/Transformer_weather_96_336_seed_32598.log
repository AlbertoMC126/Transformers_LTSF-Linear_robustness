Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=21, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=21, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Transformer', model_id='weather_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=336, root_path='./dataset/', seed=32598, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_336_Transformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed32598>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36456
val 4935
test 10204
	iters: 100, epoch: 1 | loss: 0.5799538
	speed: 0.0745s/iter; left time: 840.8349s
	iters: 200, epoch: 1 | loss: 0.6302172
	speed: 0.0442s/iter; left time: 494.5645s
	iters: 300, epoch: 1 | loss: 0.6194396
	speed: 0.0442s/iter; left time: 489.7765s
	iters: 400, epoch: 1 | loss: 0.6211366
	speed: 0.0443s/iter; left time: 486.9184s
	iters: 500, epoch: 1 | loss: 0.4166760
	speed: 0.0443s/iter; left time: 482.6157s
	iters: 600, epoch: 1 | loss: 0.5445247
	speed: 0.0443s/iter; left time: 477.8450s
	iters: 700, epoch: 1 | loss: 0.5905926
	speed: 0.0443s/iter; left time: 473.5284s
	iters: 800, epoch: 1 | loss: 0.3265201
	speed: 0.0443s/iter; left time: 469.1355s
	iters: 900, epoch: 1 | loss: 0.2180228
	speed: 0.0442s/iter; left time: 463.8898s
	iters: 1000, epoch: 1 | loss: 0.2684428
	speed: 0.0442s/iter; left time: 459.5242s
	iters: 1100, epoch: 1 | loss: 0.2863026
	speed: 0.0442s/iter; left time: 454.9914s
Epoch: 1 cost time: 53.42831540107727
Epoch: 1, Steps: 1139 | Train Loss: 0.4273369 Vali Loss: 0.6930454 Test Loss: 0.7039716
Validation loss decreased (inf --> 0.693045).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2555581
	speed: 0.1337s/iter; left time: 1357.3175s
	iters: 200, epoch: 2 | loss: 0.2408201
	speed: 0.0442s/iter; left time: 444.0521s
	iters: 300, epoch: 2 | loss: 0.2698204
	speed: 0.0442s/iter; left time: 439.7672s
	iters: 400, epoch: 2 | loss: 0.4508148
	speed: 0.0442s/iter; left time: 435.1235s
	iters: 500, epoch: 2 | loss: 0.3161457
	speed: 0.0442s/iter; left time: 430.8621s
	iters: 600, epoch: 2 | loss: 0.2417115
	speed: 0.0442s/iter; left time: 426.2417s
	iters: 700, epoch: 2 | loss: 0.4726652
	speed: 0.0441s/iter; left time: 421.4876s
	iters: 800, epoch: 2 | loss: 0.4157181
	speed: 0.0441s/iter; left time: 417.2611s
	iters: 900, epoch: 2 | loss: 0.4042127
	speed: 0.0441s/iter; left time: 412.8467s
	iters: 1000, epoch: 2 | loss: 0.4728251
	speed: 0.0441s/iter; left time: 408.4231s
	iters: 1100, epoch: 2 | loss: 0.1938235
	speed: 0.0442s/iter; left time: 404.0712s
Epoch: 2 cost time: 50.28496170043945
Epoch: 2, Steps: 1139 | Train Loss: 0.2941271 Vali Loss: 0.7312076 Test Loss: 0.7285906
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1937679
	speed: 0.1309s/iter; left time: 1180.1272s
	iters: 200, epoch: 3 | loss: 0.1712253
	speed: 0.0442s/iter; left time: 394.3594s
	iters: 300, epoch: 3 | loss: 0.1543861
	speed: 0.0444s/iter; left time: 391.7199s
	iters: 400, epoch: 3 | loss: 0.1650621
	speed: 0.0445s/iter; left time: 387.4022s
	iters: 500, epoch: 3 | loss: 0.2424481
	speed: 0.0445s/iter; left time: 382.9040s
	iters: 600, epoch: 3 | loss: 0.3639260
	speed: 0.0445s/iter; left time: 378.4196s
	iters: 700, epoch: 3 | loss: 0.4232884
	speed: 0.0445s/iter; left time: 374.4158s
	iters: 800, epoch: 3 | loss: 0.4064820
	speed: 0.0445s/iter; left time: 369.8962s
	iters: 900, epoch: 3 | loss: 0.1869382
	speed: 0.0443s/iter; left time: 363.7236s
	iters: 1000, epoch: 3 | loss: 0.3134714
	speed: 0.0441s/iter; left time: 358.1320s
	iters: 1100, epoch: 3 | loss: 0.1779493
	speed: 0.0442s/iter; left time: 353.8957s
Epoch: 3 cost time: 50.48051881790161
Epoch: 3, Steps: 1139 | Train Loss: 0.2372251 Vali Loss: 0.7489622 Test Loss: 0.7478760
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1959734
	speed: 0.1309s/iter; left time: 1030.8266s
	iters: 200, epoch: 4 | loss: 0.2108263
	speed: 0.0441s/iter; left time: 342.8448s
	iters: 300, epoch: 4 | loss: 0.1849381
	speed: 0.0442s/iter; left time: 339.0080s
	iters: 400, epoch: 4 | loss: 0.1705653
	speed: 0.0442s/iter; left time: 335.0331s
	iters: 500, epoch: 4 | loss: 0.2029181
	speed: 0.0443s/iter; left time: 330.9708s
	iters: 600, epoch: 4 | loss: 0.3439211
	speed: 0.0444s/iter; left time: 327.0785s
	iters: 700, epoch: 4 | loss: 0.1425942
	speed: 0.0442s/iter; left time: 321.4775s
	iters: 800, epoch: 4 | loss: 0.3709680
	speed: 0.0441s/iter; left time: 316.6475s
	iters: 900, epoch: 4 | loss: 0.1557624
	speed: 0.0442s/iter; left time: 312.6512s
	iters: 1000, epoch: 4 | loss: 0.1779399
	speed: 0.0442s/iter; left time: 308.5007s
	iters: 1100, epoch: 4 | loss: 0.1529357
	speed: 0.0443s/iter; left time: 304.3210s
Epoch: 4 cost time: 50.34362316131592
Epoch: 4, Steps: 1139 | Train Loss: 0.2165751 Vali Loss: 0.7367371 Test Loss: 0.7187674
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : weather_336_Transformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed32598<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10204
mse:0.7039732336997986, mae:0.5894836783409119
