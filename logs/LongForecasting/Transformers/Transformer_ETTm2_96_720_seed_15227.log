Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Transformer', model_id='ETTm2_720', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=720, root_path='./dataset/', seed=15227, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm2_720_Transformer_ETTm2_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed15227>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33745
val 10801
test 10801
	iters: 100, epoch: 1 | loss: 0.4330680
	speed: 0.1221s/iter; left time: 1274.8299s
	iters: 200, epoch: 1 | loss: 0.3199625
	speed: 0.0917s/iter; left time: 948.4715s
	iters: 300, epoch: 1 | loss: 0.2540520
	speed: 0.0917s/iter; left time: 939.3207s
	iters: 400, epoch: 1 | loss: 0.2245469
	speed: 0.0919s/iter; left time: 931.6074s
	iters: 500, epoch: 1 | loss: 0.2764073
	speed: 0.0924s/iter; left time: 927.2970s
	iters: 600, epoch: 1 | loss: 0.2111813
	speed: 0.0925s/iter; left time: 919.4580s
	iters: 700, epoch: 1 | loss: 0.2361078
	speed: 0.0925s/iter; left time: 909.8453s
	iters: 800, epoch: 1 | loss: 0.1700398
	speed: 0.0922s/iter; left time: 898.1886s
	iters: 900, epoch: 1 | loss: 0.1784596
	speed: 0.0921s/iter; left time: 887.7036s
	iters: 1000, epoch: 1 | loss: 0.1578935
	speed: 0.0920s/iter; left time: 877.3518s
Epoch: 1 cost time: 100.06668305397034
Epoch: 1, Steps: 1054 | Train Loss: 0.2584738 Vali Loss: 1.1715852 Test Loss: 3.6703126
Validation loss decreased (inf --> 1.171585).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2178459
	speed: 0.3681s/iter; left time: 3454.9799s
	iters: 200, epoch: 2 | loss: 0.1851407
	speed: 0.0920s/iter; left time: 854.8072s
	iters: 300, epoch: 2 | loss: 0.1507104
	speed: 0.0919s/iter; left time: 844.5586s
	iters: 400, epoch: 2 | loss: 0.1331294
	speed: 0.0919s/iter; left time: 835.1008s
	iters: 500, epoch: 2 | loss: 0.1384864
	speed: 0.0923s/iter; left time: 829.2007s
	iters: 600, epoch: 2 | loss: 0.1663014
	speed: 0.0924s/iter; left time: 821.3572s
	iters: 700, epoch: 2 | loss: 0.1195937
	speed: 0.0925s/iter; left time: 812.8805s
	iters: 800, epoch: 2 | loss: 0.1308187
	speed: 0.0924s/iter; left time: 802.4130s
	iters: 900, epoch: 2 | loss: 0.1262612
	speed: 0.0919s/iter; left time: 788.7494s
	iters: 1000, epoch: 2 | loss: 0.1450559
	speed: 0.0918s/iter; left time: 779.4284s
Epoch: 2 cost time: 97.027423620224
Epoch: 2, Steps: 1054 | Train Loss: 0.1441679 Vali Loss: 1.4054476 Test Loss: 4.5805459
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1047890
	speed: 0.3659s/iter; left time: 3049.0792s
	iters: 200, epoch: 3 | loss: 0.0917052
	speed: 0.0918s/iter; left time: 755.9757s
	iters: 300, epoch: 3 | loss: 0.1002068
	speed: 0.0918s/iter; left time: 747.0084s
	iters: 400, epoch: 3 | loss: 0.1098011
	speed: 0.0917s/iter; left time: 736.9722s
	iters: 500, epoch: 3 | loss: 0.1004454
	speed: 0.0922s/iter; left time: 731.2626s
	iters: 600, epoch: 3 | loss: 0.1108556
	speed: 0.0926s/iter; left time: 724.9925s
	iters: 700, epoch: 3 | loss: 0.1073253
	speed: 0.0925s/iter; left time: 715.2354s
	iters: 800, epoch: 3 | loss: 0.0975551
	speed: 0.0921s/iter; left time: 703.0648s
	iters: 900, epoch: 3 | loss: 0.0938687
	speed: 0.0918s/iter; left time: 691.6706s
	iters: 1000, epoch: 3 | loss: 0.0869530
	speed: 0.0919s/iter; left time: 683.4471s
Epoch: 3 cost time: 96.96106481552124
Epoch: 3, Steps: 1054 | Train Loss: 0.1054624 Vali Loss: 0.9838252 Test Loss: 2.6473026
Validation loss decreased (1.171585 --> 0.983825).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1069288
	speed: 0.3683s/iter; left time: 2680.5393s
	iters: 200, epoch: 4 | loss: 0.0837650
	speed: 0.0921s/iter; left time: 661.4025s
	iters: 300, epoch: 4 | loss: 0.0927343
	speed: 0.0921s/iter; left time: 651.9418s
	iters: 400, epoch: 4 | loss: 0.0860735
	speed: 0.0919s/iter; left time: 641.4159s
	iters: 500, epoch: 4 | loss: 0.1021422
	speed: 0.0921s/iter; left time: 633.8461s
	iters: 600, epoch: 4 | loss: 0.0869845
	speed: 0.0923s/iter; left time: 625.8795s
	iters: 700, epoch: 4 | loss: 0.0787930
	speed: 0.0925s/iter; left time: 617.7164s
	iters: 800, epoch: 4 | loss: 0.0898034
	speed: 0.0922s/iter; left time: 606.4400s
	iters: 900, epoch: 4 | loss: 0.0810459
	speed: 0.0918s/iter; left time: 594.8230s
	iters: 1000, epoch: 4 | loss: 0.0894455
	speed: 0.0920s/iter; left time: 586.5580s
Epoch: 4 cost time: 97.01641726493835
Epoch: 4, Steps: 1054 | Train Loss: 0.0907427 Vali Loss: 1.0448580 Test Loss: 2.6963081
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0890464
	speed: 0.3649s/iter; left time: 2271.4440s
	iters: 200, epoch: 5 | loss: 0.0863389
	speed: 0.0918s/iter; left time: 562.3936s
	iters: 300, epoch: 5 | loss: 0.0809460
	speed: 0.0918s/iter; left time: 553.2185s
	iters: 400, epoch: 5 | loss: 0.0875379
	speed: 0.0919s/iter; left time: 544.5997s
	iters: 500, epoch: 5 | loss: 0.0908621
	speed: 0.0922s/iter; left time: 537.2693s
	iters: 600, epoch: 5 | loss: 0.0791723
	speed: 0.0924s/iter; left time: 528.8185s
	iters: 700, epoch: 5 | loss: 0.0734661
	speed: 0.0923s/iter; left time: 519.2320s
	iters: 800, epoch: 5 | loss: 0.0804862
	speed: 0.0921s/iter; left time: 508.8393s
	iters: 900, epoch: 5 | loss: 0.1046256
	speed: 0.0915s/iter; left time: 496.5917s
	iters: 1000, epoch: 5 | loss: 0.0910665
	speed: 0.0917s/iter; left time: 488.4761s
Epoch: 5 cost time: 96.8572428226471
Epoch: 5, Steps: 1054 | Train Loss: 0.0837517 Vali Loss: 1.0499325 Test Loss: 2.8552163
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0794931
	speed: 0.3645s/iter; left time: 1884.7966s
	iters: 200, epoch: 6 | loss: 0.0735421
	speed: 0.0918s/iter; left time: 465.3065s
	iters: 300, epoch: 6 | loss: 0.0793383
	speed: 0.0918s/iter; left time: 456.2925s
	iters: 400, epoch: 6 | loss: 0.0745000
	speed: 0.0918s/iter; left time: 447.0669s
	iters: 500, epoch: 6 | loss: 0.0776427
	speed: 0.0921s/iter; left time: 439.2060s
	iters: 600, epoch: 6 | loss: 0.0786913
	speed: 0.0924s/iter; left time: 431.4940s
	iters: 700, epoch: 6 | loss: 0.0766674
	speed: 0.0925s/iter; left time: 422.6574s
	iters: 800, epoch: 6 | loss: 0.0783502
	speed: 0.0923s/iter; left time: 412.5522s
	iters: 900, epoch: 6 | loss: 0.0724617
	speed: 0.0920s/iter; left time: 402.1238s
	iters: 1000, epoch: 6 | loss: 0.0761513
	speed: 0.0919s/iter; left time: 392.5800s
Epoch: 6 cost time: 96.95414447784424
Epoch: 6, Steps: 1054 | Train Loss: 0.0802670 Vali Loss: 1.0482223 Test Loss: 2.7611682
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : ETTm2_720_Transformer_ETTm2_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed15227<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10801
mse:2.6486196517944336, mae:1.220900535583496
