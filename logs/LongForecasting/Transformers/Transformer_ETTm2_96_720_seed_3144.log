Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Transformer', model_id='ETTm2_720', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=720, root_path='./dataset/', seed=3144, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm2_720_Transformer_ETTm2_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed3144>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33745
val 10801
test 10801
	iters: 100, epoch: 1 | loss: 0.2482518
	speed: 0.1218s/iter; left time: 1271.7554s
	iters: 200, epoch: 1 | loss: 0.2452478
	speed: 0.0917s/iter; left time: 948.0201s
	iters: 300, epoch: 1 | loss: 0.2911615
	speed: 0.0916s/iter; left time: 938.2256s
	iters: 400, epoch: 1 | loss: 0.2396318
	speed: 0.0917s/iter; left time: 930.4115s
	iters: 500, epoch: 1 | loss: 0.2083055
	speed: 0.0918s/iter; left time: 921.4253s
	iters: 600, epoch: 1 | loss: 0.2407479
	speed: 0.0918s/iter; left time: 912.1472s
	iters: 700, epoch: 1 | loss: 0.2119560
	speed: 0.0920s/iter; left time: 905.7522s
	iters: 800, epoch: 1 | loss: 0.2070576
	speed: 0.0923s/iter; left time: 898.9722s
	iters: 900, epoch: 1 | loss: 0.1865439
	speed: 0.0923s/iter; left time: 889.3973s
	iters: 1000, epoch: 1 | loss: 0.1975023
	speed: 0.0922s/iter; left time: 879.3088s
Epoch: 1 cost time: 99.8664300441742
Epoch: 1, Steps: 1054 | Train Loss: 0.2561248 Vali Loss: 1.1006482 Test Loss: 3.4269993
Validation loss decreased (inf --> 1.100648).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1448757
	speed: 0.3676s/iter; left time: 3450.2199s
	iters: 200, epoch: 2 | loss: 0.1661259
	speed: 0.0919s/iter; left time: 853.6876s
	iters: 300, epoch: 2 | loss: 0.1537661
	speed: 0.0919s/iter; left time: 844.1976s
	iters: 400, epoch: 2 | loss: 0.1240912
	speed: 0.0917s/iter; left time: 832.9912s
	iters: 500, epoch: 2 | loss: 0.1294862
	speed: 0.0918s/iter; left time: 824.7679s
	iters: 600, epoch: 2 | loss: 0.1282075
	speed: 0.0917s/iter; left time: 814.6974s
	iters: 700, epoch: 2 | loss: 0.1108703
	speed: 0.0919s/iter; left time: 807.4972s
	iters: 800, epoch: 2 | loss: 0.1383774
	speed: 0.0922s/iter; left time: 801.0992s
	iters: 900, epoch: 2 | loss: 0.1353330
	speed: 0.0923s/iter; left time: 792.9853s
	iters: 1000, epoch: 2 | loss: 0.1222641
	speed: 0.0921s/iter; left time: 781.6171s
Epoch: 2 cost time: 96.82925391197205
Epoch: 2, Steps: 1054 | Train Loss: 0.1430492 Vali Loss: 1.1755472 Test Loss: 3.5338705
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1041164
	speed: 0.3636s/iter; left time: 3029.9248s
	iters: 200, epoch: 3 | loss: 0.0943911
	speed: 0.0919s/iter; left time: 756.7419s
	iters: 300, epoch: 3 | loss: 0.1007255
	speed: 0.0920s/iter; left time: 748.1730s
	iters: 400, epoch: 3 | loss: 0.0940237
	speed: 0.0917s/iter; left time: 736.9532s
	iters: 500, epoch: 3 | loss: 0.0953938
	speed: 0.0917s/iter; left time: 727.6920s
	iters: 600, epoch: 3 | loss: 0.1095970
	speed: 0.0917s/iter; left time: 718.3237s
	iters: 700, epoch: 3 | loss: 0.1052782
	speed: 0.0919s/iter; left time: 710.5464s
	iters: 800, epoch: 3 | loss: 0.1224733
	speed: 0.0922s/iter; left time: 703.6098s
	iters: 900, epoch: 3 | loss: 0.1081893
	speed: 0.0923s/iter; left time: 695.5242s
	iters: 1000, epoch: 3 | loss: 0.0779594
	speed: 0.0924s/iter; left time: 686.4769s
Epoch: 3 cost time: 96.88436555862427
Epoch: 3, Steps: 1054 | Train Loss: 0.1059090 Vali Loss: 1.0462486 Test Loss: 3.0029361
Validation loss decreased (1.100648 --> 1.046249).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0890082
	speed: 0.3679s/iter; left time: 2678.0199s
	iters: 200, epoch: 4 | loss: 0.0821812
	speed: 0.0919s/iter; left time: 659.6786s
	iters: 300, epoch: 4 | loss: 0.0921054
	speed: 0.0919s/iter; left time: 650.2982s
	iters: 400, epoch: 4 | loss: 0.0796964
	speed: 0.0919s/iter; left time: 641.6959s
	iters: 500, epoch: 4 | loss: 0.0998728
	speed: 0.0917s/iter; left time: 631.0936s
	iters: 600, epoch: 4 | loss: 0.0838219
	speed: 0.0918s/iter; left time: 622.4693s
	iters: 700, epoch: 4 | loss: 0.0868239
	speed: 0.0919s/iter; left time: 614.0007s
	iters: 800, epoch: 4 | loss: 0.0853789
	speed: 0.0922s/iter; left time: 606.5654s
	iters: 900, epoch: 4 | loss: 0.0798087
	speed: 0.0923s/iter; left time: 597.7271s
	iters: 1000, epoch: 4 | loss: 0.0851284
	speed: 0.0923s/iter; left time: 588.4784s
Epoch: 4 cost time: 96.88420939445496
Epoch: 4, Steps: 1054 | Train Loss: 0.0904757 Vali Loss: 0.9995738 Test Loss: 2.8868821
Validation loss decreased (1.046249 --> 0.999574).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0791720
	speed: 0.3666s/iter; left time: 2282.1764s
	iters: 200, epoch: 5 | loss: 0.0802935
	speed: 0.0918s/iter; left time: 562.1032s
	iters: 300, epoch: 5 | loss: 0.0857608
	speed: 0.0918s/iter; left time: 552.9972s
	iters: 400, epoch: 5 | loss: 0.0835268
	speed: 0.0917s/iter; left time: 543.0985s
	iters: 500, epoch: 5 | loss: 0.0888230
	speed: 0.0916s/iter; left time: 533.6805s
	iters: 600, epoch: 5 | loss: 0.0847156
	speed: 0.0920s/iter; left time: 526.8363s
	iters: 700, epoch: 5 | loss: 0.0813412
	speed: 0.0926s/iter; left time: 520.6836s
	iters: 800, epoch: 5 | loss: 0.0942452
	speed: 0.0922s/iter; left time: 509.3842s
	iters: 900, epoch: 5 | loss: 0.0719236
	speed: 0.0923s/iter; left time: 500.7475s
	iters: 1000, epoch: 5 | loss: 0.0869504
	speed: 0.0923s/iter; left time: 491.5783s
Epoch: 5 cost time: 96.90349316596985
Epoch: 5, Steps: 1054 | Train Loss: 0.0832025 Vali Loss: 0.9990655 Test Loss: 2.7614594
Validation loss decreased (0.999574 --> 0.999065).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0777134
	speed: 0.3659s/iter; left time: 1892.1114s
	iters: 200, epoch: 6 | loss: 0.0770781
	speed: 0.0917s/iter; left time: 465.0140s
	iters: 300, epoch: 6 | loss: 0.0864995
	speed: 0.0916s/iter; left time: 455.3031s
	iters: 400, epoch: 6 | loss: 0.0809240
	speed: 0.0917s/iter; left time: 446.5441s
	iters: 500, epoch: 6 | loss: 0.0845612
	speed: 0.0916s/iter; left time: 437.0096s
	iters: 600, epoch: 6 | loss: 0.0674919
	speed: 0.0916s/iter; left time: 427.8121s
	iters: 700, epoch: 6 | loss: 0.0881368
	speed: 0.0917s/iter; left time: 419.1175s
	iters: 800, epoch: 6 | loss: 0.0882361
	speed: 0.0922s/iter; left time: 412.0807s
	iters: 900, epoch: 6 | loss: 0.0743400
	speed: 0.0922s/iter; left time: 403.0562s
	iters: 1000, epoch: 6 | loss: 0.0825840
	speed: 0.0923s/iter; left time: 394.2993s
Epoch: 6 cost time: 96.72600984573364
Epoch: 6, Steps: 1054 | Train Loss: 0.0797339 Vali Loss: 0.9648306 Test Loss: 2.6526868
Validation loss decreased (0.999065 --> 0.964831).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.0712861
	speed: 0.3691s/iter; left time: 1519.7005s
	iters: 200, epoch: 7 | loss: 0.0759483
	speed: 0.0919s/iter; left time: 369.2081s
	iters: 300, epoch: 7 | loss: 0.0815032
	speed: 0.0919s/iter; left time: 359.9452s
	iters: 400, epoch: 7 | loss: 0.0770589
	speed: 0.0917s/iter; left time: 349.9583s
	iters: 500, epoch: 7 | loss: 0.0783744
	speed: 0.0919s/iter; left time: 341.6794s
	iters: 600, epoch: 7 | loss: 0.0707425
	speed: 0.0919s/iter; left time: 332.2667s
	iters: 700, epoch: 7 | loss: 0.0874376
	speed: 0.0920s/iter; left time: 323.5426s
	iters: 800, epoch: 7 | loss: 0.0807617
	speed: 0.0923s/iter; left time: 315.4397s
	iters: 900, epoch: 7 | loss: 0.0782642
	speed: 0.0923s/iter; left time: 306.2248s
	iters: 1000, epoch: 7 | loss: 0.0740563
	speed: 0.0924s/iter; left time: 297.2104s
Epoch: 7 cost time: 96.9266312122345
Epoch: 7, Steps: 1054 | Train Loss: 0.0779668 Vali Loss: 0.9529049 Test Loss: 2.6463454
Validation loss decreased (0.964831 --> 0.952905).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.0777014
	speed: 0.3670s/iter; left time: 1123.9967s
	iters: 200, epoch: 8 | loss: 0.0758022
	speed: 0.0919s/iter; left time: 272.1734s
	iters: 300, epoch: 8 | loss: 0.0830356
	speed: 0.0918s/iter; left time: 262.9594s
	iters: 400, epoch: 8 | loss: 0.0668205
	speed: 0.0918s/iter; left time: 253.5667s
	iters: 500, epoch: 8 | loss: 0.0763417
	speed: 0.0917s/iter; left time: 244.3264s
	iters: 600, epoch: 8 | loss: 0.0854108
	speed: 0.0917s/iter; left time: 235.1026s
	iters: 700, epoch: 8 | loss: 0.0715336
	speed: 0.0918s/iter; left time: 226.0652s
	iters: 800, epoch: 8 | loss: 0.0724071
	speed: 0.0926s/iter; left time: 218.7350s
	iters: 900, epoch: 8 | loss: 0.0719873
	speed: 0.0923s/iter; left time: 208.9157s
	iters: 1000, epoch: 8 | loss: 0.0795060
	speed: 0.0924s/iter; left time: 199.7943s
Epoch: 8 cost time: 96.8999879360199
Epoch: 8, Steps: 1054 | Train Loss: 0.0770576 Vali Loss: 0.9528019 Test Loss: 2.6066535
Validation loss decreased (0.952905 --> 0.952802).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.0851640
	speed: 0.3668s/iter; left time: 736.8696s
	iters: 200, epoch: 9 | loss: 0.0714771
	speed: 0.0919s/iter; left time: 175.5151s
	iters: 300, epoch: 9 | loss: 0.0735653
	speed: 0.0920s/iter; left time: 166.3959s
	iters: 400, epoch: 9 | loss: 0.0768939
	speed: 0.0918s/iter; left time: 156.8591s
	iters: 500, epoch: 9 | loss: 0.0705849
	speed: 0.0918s/iter; left time: 147.7286s
	iters: 600, epoch: 9 | loss: 0.0713915
	speed: 0.0918s/iter; left time: 138.4569s
	iters: 700, epoch: 9 | loss: 0.0767113
	speed: 0.0917s/iter; left time: 129.2674s
	iters: 800, epoch: 9 | loss: 0.0907544
	speed: 0.0923s/iter; left time: 120.7730s
	iters: 900, epoch: 9 | loss: 0.0743589
	speed: 0.0924s/iter; left time: 111.6550s
	iters: 1000, epoch: 9 | loss: 0.0786995
	speed: 0.0923s/iter; left time: 102.3972s
Epoch: 9 cost time: 96.91278505325317
Epoch: 9, Steps: 1054 | Train Loss: 0.0765787 Vali Loss: 0.9508969 Test Loss: 2.6388664
Validation loss decreased (0.952802 --> 0.950897).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.0747688
	speed: 0.3683s/iter; left time: 351.6953s
	iters: 200, epoch: 10 | loss: 0.0805491
	speed: 0.0919s/iter; left time: 78.5801s
	iters: 300, epoch: 10 | loss: 0.0772528
	speed: 0.0919s/iter; left time: 69.4188s
	iters: 400, epoch: 10 | loss: 0.0709535
	speed: 0.0920s/iter; left time: 60.2873s
	iters: 500, epoch: 10 | loss: 0.0735363
	speed: 0.0919s/iter; left time: 51.0140s
	iters: 600, epoch: 10 | loss: 0.0736600
	speed: 0.0919s/iter; left time: 41.8065s
	iters: 700, epoch: 10 | loss: 0.0738664
	speed: 0.0920s/iter; left time: 32.6465s
	iters: 800, epoch: 10 | loss: 0.0831742
	speed: 0.0922s/iter; left time: 23.5060s
	iters: 900, epoch: 10 | loss: 0.0883835
	speed: 0.0923s/iter; left time: 14.3055s
	iters: 1000, epoch: 10 | loss: 0.0732483
	speed: 0.0924s/iter; left time: 5.0813s
Epoch: 10 cost time: 96.97897934913635
Epoch: 10, Steps: 1054 | Train Loss: 0.0763534 Vali Loss: 0.9550488 Test Loss: 2.6403599
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : ETTm2_720_Transformer_ETTm2_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed3144<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10801
mse:2.6409106254577637, mae:1.2059301137924194
