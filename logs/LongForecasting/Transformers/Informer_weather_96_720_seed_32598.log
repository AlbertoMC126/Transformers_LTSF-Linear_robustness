Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=21, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=21, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Informer', model_id='weather_720', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=720, root_path='./dataset/', seed=32598, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_720_Informer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed32598>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36072
val 4551
test 9820
	iters: 100, epoch: 1 | loss: 0.6542035
	speed: 0.0976s/iter; left time: 1090.1458s
	iters: 200, epoch: 1 | loss: 0.6477672
	speed: 0.0666s/iter; left time: 737.2780s
	iters: 300, epoch: 1 | loss: 0.6191396
	speed: 0.0663s/iter; left time: 727.6043s
	iters: 400, epoch: 1 | loss: 0.7145063
	speed: 0.0666s/iter; left time: 723.5504s
	iters: 500, epoch: 1 | loss: 0.4502740
	speed: 0.0669s/iter; left time: 720.1089s
	iters: 600, epoch: 1 | loss: 0.3876858
	speed: 0.0666s/iter; left time: 710.3242s
	iters: 700, epoch: 1 | loss: 0.5564101
	speed: 0.0664s/iter; left time: 701.7333s
	iters: 800, epoch: 1 | loss: 0.3750533
	speed: 0.0664s/iter; left time: 694.7664s
	iters: 900, epoch: 1 | loss: 0.6094046
	speed: 0.0663s/iter; left time: 687.9295s
	iters: 1000, epoch: 1 | loss: 0.3759355
	speed: 0.0664s/iter; left time: 681.5681s
	iters: 1100, epoch: 1 | loss: 0.4478011
	speed: 0.0664s/iter; left time: 675.0546s
Epoch: 1 cost time: 78.0757052898407
Epoch: 1, Steps: 1127 | Train Loss: 0.5184052 Vali Loss: 0.9125817 Test Loss: 1.1965350
Validation loss decreased (inf --> 0.912582).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3547616
	speed: 0.2191s/iter; left time: 2200.4523s
	iters: 200, epoch: 2 | loss: 0.4321368
	speed: 0.0678s/iter; left time: 674.6903s
	iters: 300, epoch: 2 | loss: 0.3634549
	speed: 0.0669s/iter; left time: 658.3390s
	iters: 400, epoch: 2 | loss: 0.3076472
	speed: 0.0665s/iter; left time: 648.2486s
	iters: 500, epoch: 2 | loss: 0.2997395
	speed: 0.0664s/iter; left time: 640.2794s
	iters: 600, epoch: 2 | loss: 0.3268827
	speed: 0.0667s/iter; left time: 636.8252s
	iters: 700, epoch: 2 | loss: 0.3769650
	speed: 0.0667s/iter; left time: 630.3807s
	iters: 800, epoch: 2 | loss: 0.2959131
	speed: 0.0665s/iter; left time: 621.0509s
	iters: 900, epoch: 2 | loss: 0.2826189
	speed: 0.0666s/iter; left time: 615.4443s
	iters: 1000, epoch: 2 | loss: 0.2834739
	speed: 0.0666s/iter; left time: 608.5879s
	iters: 1100, epoch: 2 | loss: 0.4011656
	speed: 0.0664s/iter; left time: 600.4976s
Epoch: 2 cost time: 75.27245998382568
Epoch: 2, Steps: 1127 | Train Loss: 0.3816945 Vali Loss: 0.8865328 Test Loss: 1.1741192
Validation loss decreased (0.912582 --> 0.886533).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3608857
	speed: 0.2178s/iter; left time: 1942.0171s
	iters: 200, epoch: 3 | loss: 0.3960753
	speed: 0.0664s/iter; left time: 585.8216s
	iters: 300, epoch: 3 | loss: 0.2682437
	speed: 0.0673s/iter; left time: 586.7201s
	iters: 400, epoch: 3 | loss: 0.4283667
	speed: 0.0683s/iter; left time: 588.5994s
	iters: 500, epoch: 3 | loss: 0.2224358
	speed: 0.0680s/iter; left time: 579.2146s
	iters: 600, epoch: 3 | loss: 0.2997707
	speed: 0.0685s/iter; left time: 576.2082s
	iters: 700, epoch: 3 | loss: 0.2179609
	speed: 0.0680s/iter; left time: 565.1553s
	iters: 800, epoch: 3 | loss: 0.3576892
	speed: 0.0664s/iter; left time: 545.6395s
	iters: 900, epoch: 3 | loss: 0.2180151
	speed: 0.0664s/iter; left time: 539.2662s
	iters: 1000, epoch: 3 | loss: 0.2498526
	speed: 0.0668s/iter; left time: 535.6374s
	iters: 1100, epoch: 3 | loss: 0.2696892
	speed: 0.0664s/iter; left time: 525.5342s
Epoch: 3 cost time: 75.69736576080322
Epoch: 3, Steps: 1127 | Train Loss: 0.3083253 Vali Loss: 0.8185516 Test Loss: 0.9637449
Validation loss decreased (0.886533 --> 0.818552).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2579783
	speed: 0.2174s/iter; left time: 1693.3531s
	iters: 200, epoch: 4 | loss: 0.2273921
	speed: 0.0667s/iter; left time: 512.7356s
	iters: 300, epoch: 4 | loss: 0.4039490
	speed: 0.0669s/iter; left time: 507.4743s
	iters: 400, epoch: 4 | loss: 0.3007023
	speed: 0.0666s/iter; left time: 498.9629s
	iters: 500, epoch: 4 | loss: 0.2196581
	speed: 0.0666s/iter; left time: 492.0787s
	iters: 600, epoch: 4 | loss: 0.2441369
	speed: 0.0667s/iter; left time: 485.9321s
	iters: 700, epoch: 4 | loss: 0.3155428
	speed: 0.0667s/iter; left time: 479.4735s
	iters: 800, epoch: 4 | loss: 0.2892415
	speed: 0.0673s/iter; left time: 477.2406s
	iters: 900, epoch: 4 | loss: 0.2152689
	speed: 0.0674s/iter; left time: 470.8583s
	iters: 1000, epoch: 4 | loss: 0.1851179
	speed: 0.0675s/iter; left time: 465.2407s
	iters: 1100, epoch: 4 | loss: 0.1929751
	speed: 0.0674s/iter; left time: 457.7568s
Epoch: 4 cost time: 75.46960878372192
Epoch: 4, Steps: 1127 | Train Loss: 0.2789431 Vali Loss: 0.8282081 Test Loss: 0.9872883
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2650816
	speed: 0.2160s/iter; left time: 1439.3588s
	iters: 200, epoch: 5 | loss: 0.2645626
	speed: 0.0666s/iter; left time: 437.3004s
	iters: 300, epoch: 5 | loss: 0.3222164
	speed: 0.0667s/iter; left time: 430.7600s
	iters: 400, epoch: 5 | loss: 0.2190326
	speed: 0.0667s/iter; left time: 424.4611s
	iters: 500, epoch: 5 | loss: 0.3797077
	speed: 0.0667s/iter; left time: 417.6851s
	iters: 600, epoch: 5 | loss: 0.2944008
	speed: 0.0665s/iter; left time: 410.0597s
	iters: 700, epoch: 5 | loss: 0.2150703
	speed: 0.0667s/iter; left time: 404.4975s
	iters: 800, epoch: 5 | loss: 0.3273349
	speed: 0.0666s/iter; left time: 396.9180s
	iters: 900, epoch: 5 | loss: 0.2501976
	speed: 0.0664s/iter; left time: 389.4700s
	iters: 1000, epoch: 5 | loss: 0.2536947
	speed: 0.0664s/iter; left time: 382.7709s
	iters: 1100, epoch: 5 | loss: 0.2121440
	speed: 0.0664s/iter; left time: 376.2828s
Epoch: 5 cost time: 75.05148434638977
Epoch: 5, Steps: 1127 | Train Loss: 0.2659704 Vali Loss: 0.8135075 Test Loss: 0.9531955
Validation loss decreased (0.818552 --> 0.813507).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1979729
	speed: 0.2189s/iter; left time: 1212.0743s
	iters: 200, epoch: 6 | loss: 0.1869028
	speed: 0.0680s/iter; left time: 369.6411s
	iters: 300, epoch: 6 | loss: 0.3055117
	speed: 0.0680s/iter; left time: 362.6648s
	iters: 400, epoch: 6 | loss: 0.2066421
	speed: 0.0666s/iter; left time: 348.5977s
	iters: 500, epoch: 6 | loss: 0.3675962
	speed: 0.0667s/iter; left time: 342.5534s
	iters: 600, epoch: 6 | loss: 0.3764405
	speed: 0.0666s/iter; left time: 335.5421s
	iters: 700, epoch: 6 | loss: 0.2540153
	speed: 0.0666s/iter; left time: 328.5297s
	iters: 800, epoch: 6 | loss: 0.1965402
	speed: 0.0666s/iter; left time: 321.9280s
	iters: 900, epoch: 6 | loss: 0.3021059
	speed: 0.0665s/iter; left time: 314.9230s
	iters: 1000, epoch: 6 | loss: 0.2458288
	speed: 0.0666s/iter; left time: 308.5527s
	iters: 1100, epoch: 6 | loss: 0.2663208
	speed: 0.0665s/iter; left time: 301.6247s
Epoch: 6 cost time: 75.39931511878967
Epoch: 6, Steps: 1127 | Train Loss: 0.2595020 Vali Loss: 0.8279020 Test Loss: 1.0094841
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3088227
	speed: 0.2151s/iter; left time: 948.1631s
	iters: 200, epoch: 7 | loss: 0.2187565
	speed: 0.0664s/iter; left time: 285.9837s
	iters: 300, epoch: 7 | loss: 0.2901291
	speed: 0.0665s/iter; left time: 279.6921s
	iters: 400, epoch: 7 | loss: 0.4443625
	speed: 0.0674s/iter; left time: 277.0438s
	iters: 500, epoch: 7 | loss: 0.2347399
	speed: 0.0678s/iter; left time: 271.7293s
	iters: 600, epoch: 7 | loss: 0.2572207
	speed: 0.0681s/iter; left time: 266.1750s
	iters: 700, epoch: 7 | loss: 0.4830010
	speed: 0.0682s/iter; left time: 259.8495s
	iters: 800, epoch: 7 | loss: 0.1866380
	speed: 0.0677s/iter; left time: 251.0912s
	iters: 900, epoch: 7 | loss: 0.2806481
	speed: 0.0666s/iter; left time: 240.5335s
	iters: 1000, epoch: 7 | loss: 0.3390150
	speed: 0.0665s/iter; left time: 233.4287s
	iters: 1100, epoch: 7 | loss: 0.2034010
	speed: 0.0666s/iter; left time: 227.1001s
Epoch: 7 cost time: 75.6245949268341
Epoch: 7, Steps: 1127 | Train Loss: 0.2564116 Vali Loss: 0.8215910 Test Loss: 0.9838450
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2361763
	speed: 0.2157s/iter; left time: 707.9056s
	iters: 200, epoch: 8 | loss: 0.2288948
	speed: 0.0668s/iter; left time: 212.6990s
	iters: 300, epoch: 8 | loss: 0.2246123
	speed: 0.0666s/iter; left time: 205.3757s
	iters: 400, epoch: 8 | loss: 0.2393990
	speed: 0.0667s/iter; left time: 198.8856s
	iters: 500, epoch: 8 | loss: 0.3398854
	speed: 0.0667s/iter; left time: 192.3546s
	iters: 600, epoch: 8 | loss: 0.3419507
	speed: 0.0667s/iter; left time: 185.6257s
	iters: 700, epoch: 8 | loss: 0.1977645
	speed: 0.0666s/iter; left time: 178.6754s
	iters: 800, epoch: 8 | loss: 0.1974207
	speed: 0.0669s/iter; left time: 172.6157s
	iters: 900, epoch: 8 | loss: 0.2779308
	speed: 0.0675s/iter; left time: 167.5759s
	iters: 1000, epoch: 8 | loss: 0.5333562
	speed: 0.0673s/iter; left time: 160.2827s
	iters: 1100, epoch: 8 | loss: 0.1756596
	speed: 0.0677s/iter; left time: 154.5433s
Epoch: 8 cost time: 75.47917795181274
Epoch: 8, Steps: 1127 | Train Loss: 0.2547908 Vali Loss: 0.8217335 Test Loss: 0.9870473
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : weather_720_Informer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed32598<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9820
mse:0.9529170393943787, mae:0.727849006652832
