Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=321, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', dec_in=321, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Transformer', model_id='electricity_720', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=720, root_path='./dataset/', seed=15726, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : electricity_720_Transformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed15726>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17597
val 1913
test 4541
	iters: 100, epoch: 1 | loss: 0.3521266
	speed: 0.1358s/iter; left time: 731.9459s
	iters: 200, epoch: 1 | loss: 0.2773106
	speed: 0.1035s/iter; left time: 547.4191s
	iters: 300, epoch: 1 | loss: 0.2690142
	speed: 0.1030s/iter; left time: 534.7678s
	iters: 400, epoch: 1 | loss: 0.2520518
	speed: 0.1032s/iter; left time: 525.5168s
	iters: 500, epoch: 1 | loss: 0.2226048
	speed: 0.1029s/iter; left time: 513.5902s
Epoch: 1 cost time: 59.902687788009644
Epoch: 1, Steps: 549 | Train Loss: 0.3157016 Vali Loss: 0.2712750 Test Loss: 0.3415433
Validation loss decreased (inf --> 0.271275).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2072357
	speed: 0.3268s/iter; left time: 1582.4265s
	iters: 200, epoch: 2 | loss: 0.2020894
	speed: 0.1033s/iter; left time: 489.6380s
	iters: 300, epoch: 2 | loss: 0.2005177
	speed: 0.1033s/iter; left time: 479.4461s
	iters: 400, epoch: 2 | loss: 0.1686733
	speed: 0.1037s/iter; left time: 470.8318s
	iters: 500, epoch: 2 | loss: 0.1667374
	speed: 0.1038s/iter; left time: 461.1440s
Epoch: 2 cost time: 56.78829741477966
Epoch: 2, Steps: 549 | Train Loss: 0.1971447 Vali Loss: 0.2450785 Test Loss: 0.2914270
Validation loss decreased (0.271275 --> 0.245079).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1551062
	speed: 0.3256s/iter; left time: 1397.9619s
	iters: 200, epoch: 3 | loss: 0.1526403
	speed: 0.1033s/iter; left time: 432.9834s
	iters: 300, epoch: 3 | loss: 0.1605617
	speed: 0.1032s/iter; left time: 422.3545s
	iters: 400, epoch: 3 | loss: 0.1457713
	speed: 0.1033s/iter; left time: 412.5680s
	iters: 500, epoch: 3 | loss: 0.1451682
	speed: 0.1031s/iter; left time: 401.1780s
Epoch: 3 cost time: 56.61751747131348
Epoch: 3, Steps: 549 | Train Loss: 0.1516920 Vali Loss: 0.2348157 Test Loss: 0.2812946
Validation loss decreased (0.245079 --> 0.234816).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1394229
	speed: 0.3256s/iter; left time: 1219.1746s
	iters: 200, epoch: 4 | loss: 0.1358309
	speed: 0.1040s/iter; left time: 379.1270s
	iters: 300, epoch: 4 | loss: 0.1410840
	speed: 0.1039s/iter; left time: 368.1456s
	iters: 400, epoch: 4 | loss: 0.1406248
	speed: 0.1038s/iter; left time: 357.3295s
	iters: 500, epoch: 4 | loss: 0.1311638
	speed: 0.1030s/iter; left time: 344.5068s
Epoch: 4 cost time: 56.791016578674316
Epoch: 4, Steps: 549 | Train Loss: 0.1382675 Vali Loss: 0.2324274 Test Loss: 0.2821186
Validation loss decreased (0.234816 --> 0.232427).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1350686
	speed: 0.3247s/iter; left time: 1037.2990s
	iters: 200, epoch: 5 | loss: 0.1335528
	speed: 0.1034s/iter; left time: 319.9138s
	iters: 300, epoch: 5 | loss: 0.1325756
	speed: 0.1032s/iter; left time: 308.9818s
	iters: 400, epoch: 5 | loss: 0.1337178
	speed: 0.1032s/iter; left time: 298.7715s
	iters: 500, epoch: 5 | loss: 0.1285039
	speed: 0.1037s/iter; left time: 289.8142s
Epoch: 5 cost time: 56.72408866882324
Epoch: 5, Steps: 549 | Train Loss: 0.1324364 Vali Loss: 0.2333938 Test Loss: 0.2828321
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1332650
	speed: 0.3249s/iter; left time: 859.5632s
	iters: 200, epoch: 6 | loss: 0.1313528
	speed: 0.1034s/iter; left time: 263.1681s
	iters: 300, epoch: 6 | loss: 0.1295556
	speed: 0.1031s/iter; left time: 252.3011s
	iters: 400, epoch: 6 | loss: 0.1294151
	speed: 0.1032s/iter; left time: 242.0451s
	iters: 500, epoch: 6 | loss: 0.1322450
	speed: 0.1035s/iter; left time: 232.3733s
Epoch: 6 cost time: 56.72500133514404
Epoch: 6, Steps: 549 | Train Loss: 0.1297344 Vali Loss: 0.2351171 Test Loss: 0.2831625
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1278032
	speed: 0.3217s/iter; left time: 674.5134s
	iters: 200, epoch: 7 | loss: 0.1285547
	speed: 0.1035s/iter; left time: 206.6303s
	iters: 300, epoch: 7 | loss: 0.1256924
	speed: 0.1036s/iter; left time: 196.4979s
	iters: 400, epoch: 7 | loss: 0.1322112
	speed: 0.1038s/iter; left time: 186.4758s
	iters: 500, epoch: 7 | loss: 0.1287672
	speed: 0.1037s/iter; left time: 176.0486s
Epoch: 7 cost time: 56.839229106903076
Epoch: 7, Steps: 549 | Train Loss: 0.1283169 Vali Loss: 0.2331161 Test Loss: 0.2827403
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : electricity_720_Transformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed15726<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4541
mse:0.28202134370803833, mae:0.3724174201488495
