Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=21, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=21, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Autoformer', model_id='weather_720', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=720, root_path='./dataset/', seed=3144, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_720_Autoformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed3144>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36072
val 4551
test 9820
	iters: 100, epoch: 1 | loss: 0.9544467
	speed: 0.1780s/iter; left time: 1988.7895s
	iters: 200, epoch: 1 | loss: 0.7492002
	speed: 0.1438s/iter; left time: 1591.8368s
	iters: 300, epoch: 1 | loss: 0.6105059
	speed: 0.1445s/iter; left time: 1585.7850s
	iters: 400, epoch: 1 | loss: 0.7626138
	speed: 0.1444s/iter; left time: 1570.1132s
	iters: 500, epoch: 1 | loss: 0.8494625
	speed: 0.1437s/iter; left time: 1548.2562s
	iters: 600, epoch: 1 | loss: 0.7442918
	speed: 0.1437s/iter; left time: 1533.7298s
	iters: 700, epoch: 1 | loss: 0.8029242
	speed: 0.1437s/iter; left time: 1519.3492s
	iters: 800, epoch: 1 | loss: 0.8171058
	speed: 0.1437s/iter; left time: 1505.0789s
	iters: 900, epoch: 1 | loss: 0.6706667
	speed: 0.1438s/iter; left time: 1491.2830s
	iters: 1000, epoch: 1 | loss: 0.6389189
	speed: 0.1437s/iter; left time: 1475.9884s
	iters: 1100, epoch: 1 | loss: 0.6221005
	speed: 0.1442s/iter; left time: 1466.7945s
Epoch: 1 cost time: 165.74477195739746
Epoch: 1, Steps: 1127 | Train Loss: 0.7419647 Vali Loss: 0.8381410 Test Loss: 0.4459549
Validation loss decreased (inf --> 0.838141).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6839495
	speed: 0.6708s/iter; left time: 6737.6400s
	iters: 200, epoch: 2 | loss: 0.7534226
	speed: 0.1440s/iter; left time: 1431.4567s
	iters: 300, epoch: 2 | loss: 0.7535096
	speed: 0.1444s/iter; left time: 1421.8141s
	iters: 400, epoch: 2 | loss: 0.6918482
	speed: 0.1444s/iter; left time: 1407.2646s
	iters: 500, epoch: 2 | loss: 0.6404376
	speed: 0.1445s/iter; left time: 1393.1124s
	iters: 600, epoch: 2 | loss: 0.9651135
	speed: 0.1444s/iter; left time: 1377.9141s
	iters: 700, epoch: 2 | loss: 0.7058197
	speed: 0.1440s/iter; left time: 1360.2492s
	iters: 800, epoch: 2 | loss: 0.6900414
	speed: 0.1440s/iter; left time: 1345.1837s
	iters: 900, epoch: 2 | loss: 0.7357470
	speed: 0.1439s/iter; left time: 1330.4447s
	iters: 1000, epoch: 2 | loss: 0.6946576
	speed: 0.1438s/iter; left time: 1314.5601s
	iters: 1100, epoch: 2 | loss: 0.7078691
	speed: 0.1440s/iter; left time: 1301.9124s
Epoch: 2 cost time: 162.39445185661316
Epoch: 2, Steps: 1127 | Train Loss: 0.7212881 Vali Loss: 0.8025600 Test Loss: 0.4334040
Validation loss decreased (0.838141 --> 0.802560).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5496894
	speed: 0.6676s/iter; left time: 5953.3149s
	iters: 200, epoch: 3 | loss: 0.5768946
	speed: 0.1436s/iter; left time: 1265.8398s
	iters: 300, epoch: 3 | loss: 0.7311329
	speed: 0.1436s/iter; left time: 1251.4917s
	iters: 400, epoch: 3 | loss: 0.6561015
	speed: 0.1437s/iter; left time: 1238.1603s
	iters: 500, epoch: 3 | loss: 0.7456126
	speed: 0.1437s/iter; left time: 1223.6321s
	iters: 600, epoch: 3 | loss: 0.6088734
	speed: 0.1437s/iter; left time: 1209.8122s
	iters: 700, epoch: 3 | loss: 0.7670196
	speed: 0.1447s/iter; left time: 1203.3484s
	iters: 800, epoch: 3 | loss: 0.5996526
	speed: 0.1446s/iter; left time: 1187.9180s
	iters: 900, epoch: 3 | loss: 0.6330192
	speed: 0.1441s/iter; left time: 1169.4059s
	iters: 1000, epoch: 3 | loss: 0.7069423
	speed: 0.1438s/iter; left time: 1152.7333s
	iters: 1100, epoch: 3 | loss: 0.5646847
	speed: 0.1440s/iter; left time: 1140.2009s
Epoch: 3 cost time: 162.18316626548767
Epoch: 3, Steps: 1127 | Train Loss: 0.7010786 Vali Loss: 0.8005794 Test Loss: 0.4331981
Validation loss decreased (0.802560 --> 0.800579).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.6130192
	speed: 0.6702s/iter; left time: 5220.8793s
	iters: 200, epoch: 4 | loss: 0.5805557
	speed: 0.1442s/iter; left time: 1109.2209s
	iters: 300, epoch: 4 | loss: 0.6641679
	speed: 0.1439s/iter; left time: 1091.9875s
	iters: 400, epoch: 4 | loss: 0.7013695
	speed: 0.1439s/iter; left time: 1077.6465s
	iters: 500, epoch: 4 | loss: 0.7563415
	speed: 0.1438s/iter; left time: 1062.5607s
	iters: 600, epoch: 4 | loss: 0.7445665
	speed: 0.1439s/iter; left time: 1048.8010s
	iters: 700, epoch: 4 | loss: 0.6158731
	speed: 0.1439s/iter; left time: 1034.6773s
	iters: 800, epoch: 4 | loss: 0.7232593
	speed: 0.1438s/iter; left time: 1019.4735s
	iters: 900, epoch: 4 | loss: 0.5889646
	speed: 0.1445s/iter; left time: 1009.9667s
	iters: 1000, epoch: 4 | loss: 0.7420745
	speed: 0.1443s/iter; left time: 994.4962s
	iters: 1100, epoch: 4 | loss: 0.7107240
	speed: 0.1438s/iter; left time: 976.6544s
Epoch: 4 cost time: 162.28936338424683
Epoch: 4, Steps: 1127 | Train Loss: 0.6944070 Vali Loss: 0.8020627 Test Loss: 0.4415942
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.6899861
	speed: 0.6660s/iter; left time: 4437.7508s
	iters: 200, epoch: 5 | loss: 0.6539474
	speed: 0.1439s/iter; left time: 944.1273s
	iters: 300, epoch: 5 | loss: 0.5598370
	speed: 0.1442s/iter; left time: 932.2005s
	iters: 400, epoch: 5 | loss: 0.6070030
	speed: 0.1445s/iter; left time: 919.1430s
	iters: 500, epoch: 5 | loss: 0.8031232
	speed: 0.1438s/iter; left time: 900.6790s
	iters: 600, epoch: 5 | loss: 0.6883017
	speed: 0.1437s/iter; left time: 885.7130s
	iters: 700, epoch: 5 | loss: 0.6237151
	speed: 0.1439s/iter; left time: 872.6048s
	iters: 800, epoch: 5 | loss: 0.5802203
	speed: 0.1440s/iter; left time: 858.4548s
	iters: 900, epoch: 5 | loss: 0.8652185
	speed: 0.1444s/iter; left time: 846.7297s
	iters: 1000, epoch: 5 | loss: 0.7150146
	speed: 0.1443s/iter; left time: 831.4638s
	iters: 1100, epoch: 5 | loss: 0.6909317
	speed: 0.1443s/iter; left time: 817.1176s
Epoch: 5 cost time: 162.3459599018097
Epoch: 5, Steps: 1127 | Train Loss: 0.6910238 Vali Loss: 0.8021899 Test Loss: 0.4413380
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.6581209
	speed: 0.6669s/iter; left time: 3691.8743s
	iters: 200, epoch: 6 | loss: 0.7504737
	speed: 0.1436s/iter; left time: 780.6107s
	iters: 300, epoch: 6 | loss: 0.6018905
	speed: 0.1438s/iter; left time: 767.4729s
	iters: 400, epoch: 6 | loss: 0.5793518
	speed: 0.1440s/iter; left time: 753.9941s
	iters: 500, epoch: 6 | loss: 0.5327676
	speed: 0.1444s/iter; left time: 741.7652s
	iters: 600, epoch: 6 | loss: 0.7907366
	speed: 0.1446s/iter; left time: 728.1646s
	iters: 700, epoch: 6 | loss: 0.7109301
	speed: 0.1437s/iter; left time: 709.3750s
	iters: 800, epoch: 6 | loss: 0.5342350
	speed: 0.1438s/iter; left time: 695.3549s
	iters: 900, epoch: 6 | loss: 0.5329586
	speed: 0.1437s/iter; left time: 680.7552s
	iters: 1000, epoch: 6 | loss: 0.5584047
	speed: 0.1437s/iter; left time: 666.1053s
	iters: 1100, epoch: 6 | loss: 0.5609419
	speed: 0.1436s/iter; left time: 651.5696s
Epoch: 6 cost time: 162.13552284240723
Epoch: 6, Steps: 1127 | Train Loss: 0.6902863 Vali Loss: 0.7982185 Test Loss: 0.4373150
Validation loss decreased (0.800579 --> 0.798219).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.7391192
	speed: 0.6677s/iter; left time: 2943.7995s
	iters: 200, epoch: 7 | loss: 0.5331184
	speed: 0.1437s/iter; left time: 619.3490s
	iters: 300, epoch: 7 | loss: 0.8001081
	speed: 0.1438s/iter; left time: 605.2030s
	iters: 400, epoch: 7 | loss: 0.5469303
	speed: 0.1440s/iter; left time: 591.8329s
	iters: 500, epoch: 7 | loss: 0.7293007
	speed: 0.1442s/iter; left time: 578.2117s
	iters: 600, epoch: 7 | loss: 0.6572878
	speed: 0.1443s/iter; left time: 563.9376s
	iters: 700, epoch: 7 | loss: 0.6826406
	speed: 0.1444s/iter; left time: 550.0426s
	iters: 800, epoch: 7 | loss: 0.6106790
	speed: 0.1441s/iter; left time: 534.6161s
	iters: 900, epoch: 7 | loss: 0.6318123
	speed: 0.1439s/iter; left time: 519.3368s
	iters: 1000, epoch: 7 | loss: 0.6070561
	speed: 0.1439s/iter; left time: 505.0306s
	iters: 1100, epoch: 7 | loss: 0.5859688
	speed: 0.1437s/iter; left time: 490.0428s
Epoch: 7 cost time: 162.2538583278656
Epoch: 7, Steps: 1127 | Train Loss: 0.6892398 Vali Loss: 0.7974352 Test Loss: 0.4355926
Validation loss decreased (0.798219 --> 0.797435).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.7719968
	speed: 0.6692s/iter; left time: 2196.2559s
	iters: 200, epoch: 8 | loss: 0.9680980
	speed: 0.1441s/iter; left time: 458.4646s
	iters: 300, epoch: 8 | loss: 0.5566617
	speed: 0.1436s/iter; left time: 442.4575s
	iters: 400, epoch: 8 | loss: 0.6022819
	speed: 0.1437s/iter; left time: 428.4297s
	iters: 500, epoch: 8 | loss: 0.5770504
	speed: 0.1437s/iter; left time: 414.0254s
	iters: 600, epoch: 8 | loss: 0.6311939
	speed: 0.1436s/iter; left time: 399.5949s
	iters: 700, epoch: 8 | loss: 0.8381422
	speed: 0.1437s/iter; left time: 385.2952s
	iters: 800, epoch: 8 | loss: 0.6879508
	speed: 0.1438s/iter; left time: 371.2753s
	iters: 900, epoch: 8 | loss: 0.9237353
	speed: 0.1446s/iter; left time: 358.9643s
	iters: 1000, epoch: 8 | loss: 0.8989270
	speed: 0.1444s/iter; left time: 343.9616s
	iters: 1100, epoch: 8 | loss: 0.6251898
	speed: 0.1437s/iter; left time: 327.8225s
Epoch: 8 cost time: 162.18882536888123
Epoch: 8, Steps: 1127 | Train Loss: 0.6886260 Vali Loss: 0.7965685 Test Loss: 0.4342504
Validation loss decreased (0.797435 --> 0.796569).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.6726406
	speed: 0.6690s/iter; left time: 1441.7967s
	iters: 200, epoch: 9 | loss: 0.8637673
	speed: 0.1444s/iter; left time: 296.6408s
	iters: 300, epoch: 9 | loss: 0.8498675
	speed: 0.1443s/iter; left time: 282.0960s
	iters: 400, epoch: 9 | loss: 0.5761232
	speed: 0.1442s/iter; left time: 267.4867s
	iters: 500, epoch: 9 | loss: 0.9450694
	speed: 0.1441s/iter; left time: 252.8399s
	iters: 600, epoch: 9 | loss: 0.7311983
	speed: 0.1438s/iter; left time: 238.0571s
	iters: 700, epoch: 9 | loss: 0.4972362
	speed: 0.1437s/iter; left time: 223.5301s
	iters: 800, epoch: 9 | loss: 0.7976950
	speed: 0.1438s/iter; left time: 209.2000s
	iters: 900, epoch: 9 | loss: 0.6533334
	speed: 0.1438s/iter; left time: 194.8241s
	iters: 1000, epoch: 9 | loss: 0.6487004
	speed: 0.1439s/iter; left time: 180.5864s
	iters: 1100, epoch: 9 | loss: 0.7195020
	speed: 0.1443s/iter; left time: 166.7141s
Epoch: 9 cost time: 162.32306504249573
Epoch: 9, Steps: 1127 | Train Loss: 0.6886718 Vali Loss: 0.7957751 Test Loss: 0.4328375
Validation loss decreased (0.796569 --> 0.795775).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.8306843
	speed: 0.6688s/iter; left time: 687.5040s
	iters: 200, epoch: 10 | loss: 0.6048974
	speed: 0.1436s/iter; left time: 133.2562s
	iters: 300, epoch: 10 | loss: 0.7107823
	speed: 0.1436s/iter; left time: 118.8901s
	iters: 400, epoch: 10 | loss: 0.8156458
	speed: 0.1439s/iter; left time: 104.7451s
	iters: 500, epoch: 10 | loss: 0.6510831
	speed: 0.1445s/iter; left time: 90.7709s
	iters: 600, epoch: 10 | loss: 0.6903894
	speed: 0.1444s/iter; left time: 76.2637s
	iters: 700, epoch: 10 | loss: 0.5537508
	speed: 0.1440s/iter; left time: 61.6200s
	iters: 800, epoch: 10 | loss: 0.7926112
	speed: 0.1438s/iter; left time: 47.1809s
	iters: 900, epoch: 10 | loss: 0.6685453
	speed: 0.1440s/iter; left time: 32.8425s
	iters: 1000, epoch: 10 | loss: 0.5664581
	speed: 0.1441s/iter; left time: 18.4434s
	iters: 1100, epoch: 10 | loss: 0.6545423
	speed: 0.1444s/iter; left time: 4.0421s
Epoch: 10 cost time: 162.29239296913147
Epoch: 10, Steps: 1127 | Train Loss: 0.6886916 Vali Loss: 0.7963883 Test Loss: 0.4340984
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : weather_720_Autoformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed3144<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9820
mse:0.43268078565597534, mae:0.43999144434928894
