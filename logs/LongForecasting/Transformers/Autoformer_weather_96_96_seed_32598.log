Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=21, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=21, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Autoformer', model_id='weather_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=96, root_path='./dataset/', seed=32598, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_96_Autoformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed32598>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36696
val 5175
test 10444
	iters: 100, epoch: 1 | loss: 0.8548767
	speed: 0.0841s/iter; left time: 955.6573s
	iters: 200, epoch: 1 | loss: 0.5964592
	speed: 0.0472s/iter; left time: 531.6105s
	iters: 300, epoch: 1 | loss: 0.3818096
	speed: 0.0473s/iter; left time: 528.3919s
	iters: 400, epoch: 1 | loss: 0.3193538
	speed: 0.0473s/iter; left time: 523.1316s
	iters: 500, epoch: 1 | loss: 0.3995156
	speed: 0.0473s/iter; left time: 518.5023s
	iters: 600, epoch: 1 | loss: 0.4079684
	speed: 0.0473s/iter; left time: 513.9998s
	iters: 700, epoch: 1 | loss: 0.5022894
	speed: 0.0473s/iter; left time: 508.7079s
	iters: 800, epoch: 1 | loss: 0.4752158
	speed: 0.0473s/iter; left time: 504.0137s
	iters: 900, epoch: 1 | loss: 0.3994885
	speed: 0.0473s/iter; left time: 499.2410s
	iters: 1000, epoch: 1 | loss: 0.4369145
	speed: 0.0473s/iter; left time: 494.5092s
	iters: 1100, epoch: 1 | loss: 0.2816763
	speed: 0.0473s/iter; left time: 489.6618s
Epoch: 1 cost time: 57.896079540252686
Epoch: 1, Steps: 1146 | Train Loss: 0.5031943 Vali Loss: 0.5057378 Test Loss: 0.2635740
Validation loss decreased (inf --> 0.505738).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 1.3835170
	speed: 0.2110s/iter; left time: 2155.7254s
	iters: 200, epoch: 2 | loss: 1.1265262
	speed: 0.0473s/iter; left time: 478.6343s
	iters: 300, epoch: 2 | loss: 0.3674127
	speed: 0.0472s/iter; left time: 472.8915s
	iters: 400, epoch: 2 | loss: 0.3257204
	speed: 0.0472s/iter; left time: 468.2839s
	iters: 500, epoch: 2 | loss: 0.5077271
	speed: 0.0473s/iter; left time: 464.6457s
	iters: 600, epoch: 2 | loss: 0.3965435
	speed: 0.0474s/iter; left time: 460.1873s
	iters: 700, epoch: 2 | loss: 0.2589882
	speed: 0.0473s/iter; left time: 454.5254s
	iters: 800, epoch: 2 | loss: 0.3738652
	speed: 0.0473s/iter; left time: 449.8800s
	iters: 900, epoch: 2 | loss: 0.2716405
	speed: 0.0473s/iter; left time: 445.2335s
	iters: 1000, epoch: 2 | loss: 1.2331213
	speed: 0.0473s/iter; left time: 440.4352s
	iters: 1100, epoch: 2 | loss: 0.5409297
	speed: 0.0473s/iter; left time: 435.8839s
Epoch: 2 cost time: 54.18332552909851
Epoch: 2, Steps: 1146 | Train Loss: 0.4268301 Vali Loss: 0.5042858 Test Loss: 0.2969413
Validation loss decreased (0.505738 --> 0.504286).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2667938
	speed: 0.2123s/iter; left time: 1925.2771s
	iters: 200, epoch: 3 | loss: 0.2930349
	speed: 0.0473s/iter; left time: 424.0492s
	iters: 300, epoch: 3 | loss: 0.2606842
	speed: 0.0473s/iter; left time: 419.3307s
	iters: 400, epoch: 3 | loss: 0.2991854
	speed: 0.0472s/iter; left time: 414.2153s
	iters: 500, epoch: 3 | loss: 0.2626390
	speed: 0.0473s/iter; left time: 409.9489s
	iters: 600, epoch: 3 | loss: 0.4145675
	speed: 0.0472s/iter; left time: 404.8588s
	iters: 700, epoch: 3 | loss: 0.2264912
	speed: 0.0472s/iter; left time: 399.9121s
	iters: 800, epoch: 3 | loss: 0.2978181
	speed: 0.0473s/iter; left time: 395.5399s
	iters: 900, epoch: 3 | loss: 0.3212648
	speed: 0.0473s/iter; left time: 390.9766s
	iters: 1000, epoch: 3 | loss: 0.4436446
	speed: 0.0473s/iter; left time: 386.4083s
	iters: 1100, epoch: 3 | loss: 0.2389289
	speed: 0.0473s/iter; left time: 381.4984s
Epoch: 3 cost time: 54.175522327423096
Epoch: 3, Steps: 1146 | Train Loss: 0.3879884 Vali Loss: 0.5160397 Test Loss: 0.2781283
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2645600
	speed: 0.2099s/iter; left time: 1663.0520s
	iters: 200, epoch: 4 | loss: 0.3654540
	speed: 0.0477s/iter; left time: 373.2365s
	iters: 300, epoch: 4 | loss: 0.2750880
	speed: 0.0480s/iter; left time: 370.5513s
	iters: 400, epoch: 4 | loss: 0.2487360
	speed: 0.0479s/iter; left time: 365.0384s
	iters: 500, epoch: 4 | loss: 0.2879021
	speed: 0.0476s/iter; left time: 358.1505s
	iters: 600, epoch: 4 | loss: 0.2244114
	speed: 0.0476s/iter; left time: 353.2849s
	iters: 700, epoch: 4 | loss: 0.2414454
	speed: 0.0479s/iter; left time: 350.5750s
	iters: 800, epoch: 4 | loss: 0.3067796
	speed: 0.0479s/iter; left time: 346.1910s
	iters: 900, epoch: 4 | loss: 0.2970817
	speed: 0.0480s/iter; left time: 341.9434s
	iters: 1000, epoch: 4 | loss: 0.3221025
	speed: 0.0476s/iter; left time: 334.4450s
	iters: 1100, epoch: 4 | loss: 0.3162301
	speed: 0.0477s/iter; left time: 330.3025s
Epoch: 4 cost time: 54.73281145095825
Epoch: 4, Steps: 1146 | Train Loss: 0.3611255 Vali Loss: 0.5111630 Test Loss: 0.2836305
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4652484
	speed: 0.2102s/iter; left time: 1424.6594s
	iters: 200, epoch: 5 | loss: 0.2042337
	speed: 0.0477s/iter; left time: 318.1702s
	iters: 300, epoch: 5 | loss: 0.4498204
	speed: 0.0476s/iter; left time: 313.2690s
	iters: 400, epoch: 5 | loss: 0.2609376
	speed: 0.0475s/iter; left time: 307.9309s
	iters: 500, epoch: 5 | loss: 0.2541638
	speed: 0.0474s/iter; left time: 302.5145s
	iters: 600, epoch: 5 | loss: 0.1916113
	speed: 0.0473s/iter; left time: 296.7304s
	iters: 700, epoch: 5 | loss: 0.2491859
	speed: 0.0472s/iter; left time: 291.5573s
	iters: 800, epoch: 5 | loss: 0.9346314
	speed: 0.0473s/iter; left time: 287.4552s
	iters: 900, epoch: 5 | loss: 0.2163594
	speed: 0.0472s/iter; left time: 282.1371s
	iters: 1000, epoch: 5 | loss: 0.2943719
	speed: 0.0473s/iter; left time: 277.9847s
	iters: 1100, epoch: 5 | loss: 0.1891714
	speed: 0.0473s/iter; left time: 273.3706s
Epoch: 5 cost time: 54.3236608505249
Epoch: 5, Steps: 1146 | Train Loss: 0.3452243 Vali Loss: 0.5200706 Test Loss: 0.2933961
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : weather_96_Autoformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed32598<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
mse:0.29729944467544556, mae:0.3551359176635742
