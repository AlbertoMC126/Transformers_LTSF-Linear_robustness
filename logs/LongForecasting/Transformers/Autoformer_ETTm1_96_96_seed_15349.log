Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm1', data_path='ETTm1.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Autoformer', model_id='ETTm1_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=96, root_path='./dataset/', seed=15349, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm1_96_Autoformer_ETTm1_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed15349>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34369
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.4061028
	speed: 0.0808s/iter; left time: 859.7426s
	iters: 200, epoch: 1 | loss: 0.4046492
	speed: 0.0473s/iter; left time: 499.0991s
	iters: 300, epoch: 1 | loss: 0.3503853
	speed: 0.0472s/iter; left time: 493.0900s
	iters: 400, epoch: 1 | loss: 0.3293529
	speed: 0.0473s/iter; left time: 488.9637s
	iters: 500, epoch: 1 | loss: 0.3183864
	speed: 0.0472s/iter; left time: 483.8842s
	iters: 600, epoch: 1 | loss: 0.3614049
	speed: 0.0474s/iter; left time: 480.3622s
	iters: 700, epoch: 1 | loss: 0.2779512
	speed: 0.0473s/iter; left time: 475.3489s
	iters: 800, epoch: 1 | loss: 0.3467778
	speed: 0.0474s/iter; left time: 470.9592s
	iters: 900, epoch: 1 | loss: 0.3629059
	speed: 0.0473s/iter; left time: 465.2023s
	iters: 1000, epoch: 1 | loss: 0.2636598
	speed: 0.0472s/iter; left time: 459.5594s
Epoch: 1 cost time: 54.1946222782135
Epoch: 1, Steps: 1074 | Train Loss: 0.3383885 Vali Loss: 0.5999936 Test Loss: 0.5074229
Validation loss decreased (inf --> 0.599994).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2591477
	speed: 0.2777s/iter; left time: 2657.0760s
	iters: 200, epoch: 2 | loss: 0.3052658
	speed: 0.0475s/iter; left time: 449.3603s
	iters: 300, epoch: 2 | loss: 0.2500446
	speed: 0.0471s/iter; left time: 441.5136s
	iters: 400, epoch: 2 | loss: 0.2820230
	speed: 0.0472s/iter; left time: 437.6613s
	iters: 500, epoch: 2 | loss: 0.2792752
	speed: 0.0473s/iter; left time: 433.6164s
	iters: 600, epoch: 2 | loss: 0.2700508
	speed: 0.0475s/iter; left time: 430.2409s
	iters: 700, epoch: 2 | loss: 0.1887650
	speed: 0.0473s/iter; left time: 423.7772s
	iters: 800, epoch: 2 | loss: 0.1869801
	speed: 0.0473s/iter; left time: 419.0842s
	iters: 900, epoch: 2 | loss: 0.2705097
	speed: 0.0472s/iter; left time: 414.1303s
	iters: 1000, epoch: 2 | loss: 0.2820925
	speed: 0.0473s/iter; left time: 409.8350s
Epoch: 2 cost time: 50.786425828933716
Epoch: 2, Steps: 1074 | Train Loss: 0.2514527 Vali Loss: 0.5929008 Test Loss: 0.4713640
Validation loss decreased (0.599994 --> 0.592901).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1835650
	speed: 0.2779s/iter; left time: 2360.5082s
	iters: 200, epoch: 3 | loss: 0.2090982
	speed: 0.0473s/iter; left time: 397.0199s
	iters: 300, epoch: 3 | loss: 0.2166665
	speed: 0.0473s/iter; left time: 392.5115s
	iters: 400, epoch: 3 | loss: 0.2216782
	speed: 0.0473s/iter; left time: 387.1829s
	iters: 500, epoch: 3 | loss: 0.2309317
	speed: 0.0473s/iter; left time: 382.6364s
	iters: 600, epoch: 3 | loss: 0.1854943
	speed: 0.0474s/iter; left time: 378.6841s
	iters: 700, epoch: 3 | loss: 0.1885751
	speed: 0.0473s/iter; left time: 373.0419s
	iters: 800, epoch: 3 | loss: 0.2252125
	speed: 0.0472s/iter; left time: 367.9623s
	iters: 900, epoch: 3 | loss: 0.1738577
	speed: 0.0474s/iter; left time: 364.7429s
	iters: 1000, epoch: 3 | loss: 0.2473391
	speed: 0.0474s/iter; left time: 359.7309s
Epoch: 3 cost time: 50.798956871032715
Epoch: 3, Steps: 1074 | Train Loss: 0.2073633 Vali Loss: 0.5891958 Test Loss: 0.4726872
Validation loss decreased (0.592901 --> 0.589196).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1912463
	speed: 0.2770s/iter; left time: 2055.0980s
	iters: 200, epoch: 4 | loss: 0.1494906
	speed: 0.0473s/iter; left time: 346.1356s
	iters: 300, epoch: 4 | loss: 0.1546931
	speed: 0.0472s/iter; left time: 340.5940s
	iters: 400, epoch: 4 | loss: 0.2088248
	speed: 0.0473s/iter; left time: 336.4395s
	iters: 500, epoch: 4 | loss: 0.1464632
	speed: 0.0473s/iter; left time: 331.6480s
	iters: 600, epoch: 4 | loss: 0.2457630
	speed: 0.0473s/iter; left time: 327.1552s
	iters: 700, epoch: 4 | loss: 0.1800129
	speed: 0.0473s/iter; left time: 322.3507s
	iters: 800, epoch: 4 | loss: 0.2078611
	speed: 0.0473s/iter; left time: 317.8073s
	iters: 900, epoch: 4 | loss: 0.2023426
	speed: 0.0472s/iter; left time: 312.6587s
	iters: 1000, epoch: 4 | loss: 0.1799390
	speed: 0.0474s/iter; left time: 308.9283s
Epoch: 4 cost time: 50.78302597999573
Epoch: 4, Steps: 1074 | Train Loss: 0.1837896 Vali Loss: 0.5856041 Test Loss: 0.4697927
Validation loss decreased (0.589196 --> 0.585604).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1864664
	speed: 0.2769s/iter; left time: 1756.8642s
	iters: 200, epoch: 5 | loss: 0.2103591
	speed: 0.0473s/iter; left time: 295.2479s
	iters: 300, epoch: 5 | loss: 0.1739001
	speed: 0.0473s/iter; left time: 290.4832s
	iters: 400, epoch: 5 | loss: 0.1551645
	speed: 0.0473s/iter; left time: 286.0635s
	iters: 500, epoch: 5 | loss: 0.1594064
	speed: 0.0473s/iter; left time: 281.2753s
	iters: 600, epoch: 5 | loss: 0.1790244
	speed: 0.0473s/iter; left time: 276.5666s
	iters: 700, epoch: 5 | loss: 0.1775603
	speed: 0.0472s/iter; left time: 271.4493s
	iters: 800, epoch: 5 | loss: 0.1586330
	speed: 0.0472s/iter; left time: 266.6444s
	iters: 900, epoch: 5 | loss: 0.1590770
	speed: 0.0472s/iter; left time: 261.6580s
	iters: 1000, epoch: 5 | loss: 0.1538136
	speed: 0.0472s/iter; left time: 257.2700s
Epoch: 5 cost time: 50.77748775482178
Epoch: 5, Steps: 1074 | Train Loss: 0.1726649 Vali Loss: 0.5931271 Test Loss: 0.4718892
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1541937
	speed: 0.2749s/iter; left time: 1448.8135s
	iters: 200, epoch: 6 | loss: 0.1522245
	speed: 0.0471s/iter; left time: 243.7695s
	iters: 300, epoch: 6 | loss: 0.1625379
	speed: 0.0473s/iter; left time: 239.8968s
	iters: 400, epoch: 6 | loss: 0.1985979
	speed: 0.0472s/iter; left time: 234.8344s
	iters: 500, epoch: 6 | loss: 0.1977131
	speed: 0.0473s/iter; left time: 230.4894s
	iters: 600, epoch: 6 | loss: 0.1909841
	speed: 0.0473s/iter; left time: 225.7424s
	iters: 700, epoch: 6 | loss: 0.1419106
	speed: 0.0472s/iter; left time: 220.3685s
	iters: 800, epoch: 6 | loss: 0.2054365
	speed: 0.0473s/iter; left time: 216.1259s
	iters: 900, epoch: 6 | loss: 0.1782478
	speed: 0.0473s/iter; left time: 211.2857s
	iters: 1000, epoch: 6 | loss: 0.1448334
	speed: 0.0472s/iter; left time: 206.4339s
Epoch: 6 cost time: 50.74654150009155
Epoch: 6, Steps: 1074 | Train Loss: 0.1670480 Vali Loss: 0.5804308 Test Loss: 0.4633279
Validation loss decreased (0.585604 --> 0.580431).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1440690
	speed: 0.2775s/iter; left time: 1164.8724s
	iters: 200, epoch: 7 | loss: 0.1624275
	speed: 0.0475s/iter; left time: 194.5056s
	iters: 300, epoch: 7 | loss: 0.2148831
	speed: 0.0474s/iter; left time: 189.3005s
	iters: 400, epoch: 7 | loss: 0.1771176
	speed: 0.0473s/iter; left time: 184.3175s
	iters: 500, epoch: 7 | loss: 0.1591654
	speed: 0.0474s/iter; left time: 179.8826s
	iters: 600, epoch: 7 | loss: 0.1876358
	speed: 0.0472s/iter; left time: 174.3317s
	iters: 700, epoch: 7 | loss: 0.1416123
	speed: 0.0473s/iter; left time: 169.9597s
	iters: 800, epoch: 7 | loss: 0.1521958
	speed: 0.0473s/iter; left time: 165.4319s
	iters: 900, epoch: 7 | loss: 0.1273575
	speed: 0.0472s/iter; left time: 160.4737s
	iters: 1000, epoch: 7 | loss: 0.1923527
	speed: 0.0473s/iter; left time: 156.0339s
Epoch: 7 cost time: 50.80134034156799
Epoch: 7, Steps: 1074 | Train Loss: 0.1644975 Vali Loss: 0.5794073 Test Loss: 0.4600122
Validation loss decreased (0.580431 --> 0.579407).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1932405
	speed: 0.2771s/iter; left time: 865.3861s
	iters: 200, epoch: 8 | loss: 0.1657150
	speed: 0.0473s/iter; left time: 142.9740s
	iters: 300, epoch: 8 | loss: 0.1640010
	speed: 0.0473s/iter; left time: 138.1573s
	iters: 400, epoch: 8 | loss: 0.1533888
	speed: 0.0472s/iter; left time: 133.3505s
	iters: 500, epoch: 8 | loss: 0.1485310
	speed: 0.0473s/iter; left time: 128.8780s
	iters: 600, epoch: 8 | loss: 0.1450106
	speed: 0.0473s/iter; left time: 124.1562s
	iters: 700, epoch: 8 | loss: 0.1372435
	speed: 0.0473s/iter; left time: 119.3609s
	iters: 800, epoch: 8 | loss: 0.1998712
	speed: 0.0473s/iter; left time: 114.6973s
	iters: 900, epoch: 8 | loss: 0.1844840
	speed: 0.0473s/iter; left time: 109.7824s
	iters: 1000, epoch: 8 | loss: 0.1741787
	speed: 0.0474s/iter; left time: 105.3805s
Epoch: 8 cost time: 50.795411825180054
Epoch: 8, Steps: 1074 | Train Loss: 0.1630818 Vali Loss: 0.5787090 Test Loss: 0.4608441
Validation loss decreased (0.579407 --> 0.578709).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1816518
	speed: 0.2772s/iter; left time: 568.0285s
	iters: 200, epoch: 9 | loss: 0.1436356
	speed: 0.0473s/iter; left time: 92.2122s
	iters: 300, epoch: 9 | loss: 0.1658894
	speed: 0.0472s/iter; left time: 87.3220s
	iters: 400, epoch: 9 | loss: 0.1681049
	speed: 0.0473s/iter; left time: 82.7030s
	iters: 500, epoch: 9 | loss: 0.1519971
	speed: 0.0472s/iter; left time: 77.7959s
	iters: 600, epoch: 9 | loss: 0.1689100
	speed: 0.0473s/iter; left time: 73.2000s
	iters: 700, epoch: 9 | loss: 0.1741763
	speed: 0.0472s/iter; left time: 68.4158s
	iters: 800, epoch: 9 | loss: 0.1698063
	speed: 0.0472s/iter; left time: 63.6581s
	iters: 900, epoch: 9 | loss: 0.1361120
	speed: 0.0473s/iter; left time: 59.0722s
	iters: 1000, epoch: 9 | loss: 0.1829266
	speed: 0.0473s/iter; left time: 54.3818s
Epoch: 9 cost time: 50.76996564865112
Epoch: 9, Steps: 1074 | Train Loss: 0.1621918 Vali Loss: 0.5791886 Test Loss: 0.4603983
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1478813
	speed: 0.2759s/iter; left time: 268.9926s
	iters: 200, epoch: 10 | loss: 0.1443618
	speed: 0.0473s/iter; left time: 41.3538s
	iters: 300, epoch: 10 | loss: 0.1476470
	speed: 0.0474s/iter; left time: 36.6973s
	iters: 400, epoch: 10 | loss: 0.1530640
	speed: 0.0473s/iter; left time: 31.9407s
	iters: 500, epoch: 10 | loss: 0.1723103
	speed: 0.0473s/iter; left time: 27.1887s
	iters: 600, epoch: 10 | loss: 0.1396840
	speed: 0.0473s/iter; left time: 22.4573s
	iters: 700, epoch: 10 | loss: 0.1346614
	speed: 0.0473s/iter; left time: 17.7523s
	iters: 800, epoch: 10 | loss: 0.1473098
	speed: 0.0475s/iter; left time: 13.0605s
	iters: 900, epoch: 10 | loss: 0.1386182
	speed: 0.0473s/iter; left time: 8.2724s
	iters: 1000, epoch: 10 | loss: 0.1432827
	speed: 0.0474s/iter; left time: 3.5518s
Epoch: 10 cost time: 50.81985020637512
Epoch: 10, Steps: 1074 | Train Loss: 0.1619746 Vali Loss: 0.5797191 Test Loss: 0.4606170
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : ETTm1_96_Autoformer_ETTm1_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed15349<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.46140941977500916, mae:0.4613156020641327
