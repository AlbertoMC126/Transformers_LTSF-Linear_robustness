Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=21, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=21, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Transformer', model_id='weather_192', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=192, root_path='./dataset/', seed=3293, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_192_Transformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed3293>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36600
val 5079
test 10348
	iters: 100, epoch: 1 | loss: 0.4401370
	speed: 0.0623s/iter; left time: 706.1951s
	iters: 200, epoch: 1 | loss: 0.9045643
	speed: 0.0321s/iter; left time: 360.1017s
	iters: 300, epoch: 1 | loss: 0.7942600
	speed: 0.0321s/iter; left time: 357.0038s
	iters: 400, epoch: 1 | loss: 0.7590618
	speed: 0.0320s/iter; left time: 353.3617s
	iters: 500, epoch: 1 | loss: 0.3162679
	speed: 0.0321s/iter; left time: 350.5742s
	iters: 600, epoch: 1 | loss: 0.4048621
	speed: 0.0321s/iter; left time: 347.4271s
	iters: 700, epoch: 1 | loss: 0.3262191
	speed: 0.0321s/iter; left time: 344.1872s
	iters: 800, epoch: 1 | loss: 0.3049914
	speed: 0.0322s/iter; left time: 341.8174s
	iters: 900, epoch: 1 | loss: 0.1933813
	speed: 0.0322s/iter; left time: 339.1196s
	iters: 1000, epoch: 1 | loss: 0.1805963
	speed: 0.0321s/iter; left time: 335.1639s
	iters: 1100, epoch: 1 | loss: 0.2341589
	speed: 0.0323s/iter; left time: 333.4048s
Epoch: 1 cost time: 39.743879556655884
Epoch: 1, Steps: 1143 | Train Loss: 0.3956854 Vali Loss: 0.6519484 Test Loss: 0.6904491
Validation loss decreased (inf --> 0.651948).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1938001
	speed: 0.0997s/iter; left time: 1015.3945s
	iters: 200, epoch: 2 | loss: 0.2771639
	speed: 0.0322s/iter; left time: 325.3187s
	iters: 300, epoch: 2 | loss: 0.2081268
	speed: 0.0322s/iter; left time: 322.0404s
	iters: 400, epoch: 2 | loss: 0.2302922
	speed: 0.0323s/iter; left time: 318.9637s
	iters: 500, epoch: 2 | loss: 0.2621726
	speed: 0.0322s/iter; left time: 315.5212s
	iters: 600, epoch: 2 | loss: 0.2540434
	speed: 0.0323s/iter; left time: 312.8311s
	iters: 700, epoch: 2 | loss: 0.1658263
	speed: 0.0323s/iter; left time: 309.4465s
	iters: 800, epoch: 2 | loss: 0.2179979
	speed: 0.0323s/iter; left time: 306.0214s
	iters: 900, epoch: 2 | loss: 0.2925636
	speed: 0.0322s/iter; left time: 302.2889s
	iters: 1000, epoch: 2 | loss: 0.1864499
	speed: 0.0321s/iter; left time: 298.3727s
	iters: 1100, epoch: 2 | loss: 0.2441885
	speed: 0.0321s/iter; left time: 295.2929s
Epoch: 2 cost time: 36.82650423049927
Epoch: 2, Steps: 1143 | Train Loss: 0.2742929 Vali Loss: 0.6330719 Test Loss: 0.6136889
Validation loss decreased (0.651948 --> 0.633072).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1816155
	speed: 0.1000s/iter; left time: 904.8220s
	iters: 200, epoch: 3 | loss: 0.2138357
	speed: 0.0323s/iter; left time: 288.6981s
	iters: 300, epoch: 3 | loss: 0.1923548
	speed: 0.0322s/iter; left time: 285.2087s
	iters: 400, epoch: 3 | loss: 0.1488085
	speed: 0.0322s/iter; left time: 281.7033s
	iters: 500, epoch: 3 | loss: 0.4394124
	speed: 0.0322s/iter; left time: 278.6580s
	iters: 600, epoch: 3 | loss: 0.1767726
	speed: 0.0322s/iter; left time: 275.5617s
	iters: 700, epoch: 3 | loss: 0.1493212
	speed: 0.0323s/iter; left time: 272.7212s
	iters: 800, epoch: 3 | loss: 0.1305956
	speed: 0.0322s/iter; left time: 269.0948s
	iters: 900, epoch: 3 | loss: 0.1794070
	speed: 0.0323s/iter; left time: 265.9902s
	iters: 1000, epoch: 3 | loss: 0.1380918
	speed: 0.0323s/iter; left time: 262.7259s
	iters: 1100, epoch: 3 | loss: 0.1853629
	speed: 0.0322s/iter; left time: 259.4316s
Epoch: 3 cost time: 36.848613023757935
Epoch: 3, Steps: 1143 | Train Loss: 0.2236507 Vali Loss: 0.6268017 Test Loss: 0.5769882
Validation loss decreased (0.633072 --> 0.626802).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1049656
	speed: 0.0997s/iter; left time: 787.6785s
	iters: 200, epoch: 4 | loss: 0.2693621
	speed: 0.0323s/iter; left time: 252.3360s
	iters: 300, epoch: 4 | loss: 0.1120978
	speed: 0.0323s/iter; left time: 248.7471s
	iters: 400, epoch: 4 | loss: 0.4288042
	speed: 0.0323s/iter; left time: 245.3900s
	iters: 500, epoch: 4 | loss: 0.1222809
	speed: 0.0323s/iter; left time: 242.2394s
	iters: 600, epoch: 4 | loss: 0.1056582
	speed: 0.0323s/iter; left time: 239.2447s
	iters: 700, epoch: 4 | loss: 0.2397321
	speed: 0.0323s/iter; left time: 235.8065s
	iters: 800, epoch: 4 | loss: 0.0967097
	speed: 0.0323s/iter; left time: 232.3280s
	iters: 900, epoch: 4 | loss: 0.1719004
	speed: 0.0323s/iter; left time: 229.1549s
	iters: 1000, epoch: 4 | loss: 0.5437803
	speed: 0.0324s/iter; left time: 226.6831s
	iters: 1100, epoch: 4 | loss: 0.1110496
	speed: 0.0323s/iter; left time: 223.1429s
Epoch: 4 cost time: 36.91642427444458
Epoch: 4, Steps: 1143 | Train Loss: 0.2031536 Vali Loss: 0.6546338 Test Loss: 0.6483302
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1355247
	speed: 0.0977s/iter; left time: 660.0243s
	iters: 200, epoch: 5 | loss: 0.1335728
	speed: 0.0323s/iter; left time: 214.9244s
	iters: 300, epoch: 5 | loss: 0.4606983
	speed: 0.0323s/iter; left time: 211.6933s
	iters: 400, epoch: 5 | loss: 0.1194793
	speed: 0.0323s/iter; left time: 208.7554s
	iters: 500, epoch: 5 | loss: 0.4044747
	speed: 0.0323s/iter; left time: 205.4022s
	iters: 600, epoch: 5 | loss: 0.4033082
	speed: 0.0322s/iter; left time: 201.4626s
	iters: 700, epoch: 5 | loss: 0.1380369
	speed: 0.0323s/iter; left time: 198.7950s
	iters: 800, epoch: 5 | loss: 0.1641560
	speed: 0.0323s/iter; left time: 195.8141s
	iters: 900, epoch: 5 | loss: 0.1170348
	speed: 0.0323s/iter; left time: 192.2420s
	iters: 1000, epoch: 5 | loss: 0.1471806
	speed: 0.0322s/iter; left time: 188.5028s
	iters: 1100, epoch: 5 | loss: 0.0968712
	speed: 0.0322s/iter; left time: 185.6133s
Epoch: 5 cost time: 36.86692571640015
Epoch: 5, Steps: 1143 | Train Loss: 0.1929556 Vali Loss: 0.6559010 Test Loss: 0.6359193
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1196617
	speed: 0.0974s/iter; left time: 546.7555s
	iters: 200, epoch: 6 | loss: 0.1283417
	speed: 0.0323s/iter; left time: 178.1284s
	iters: 300, epoch: 6 | loss: 0.1137743
	speed: 0.0323s/iter; left time: 174.9459s
	iters: 400, epoch: 6 | loss: 0.1326908
	speed: 0.0322s/iter; left time: 171.3005s
	iters: 500, epoch: 6 | loss: 0.1829111
	speed: 0.0322s/iter; left time: 168.0641s
	iters: 600, epoch: 6 | loss: 0.1108415
	speed: 0.0323s/iter; left time: 165.0180s
	iters: 700, epoch: 6 | loss: 0.1124341
	speed: 0.0323s/iter; left time: 161.7701s
	iters: 800, epoch: 6 | loss: 0.1301655
	speed: 0.0322s/iter; left time: 158.3966s
	iters: 900, epoch: 6 | loss: 0.4598295
	speed: 0.0323s/iter; left time: 155.3283s
	iters: 1000, epoch: 6 | loss: 0.4008614
	speed: 0.0323s/iter; left time: 152.1010s
	iters: 1100, epoch: 6 | loss: 0.1336377
	speed: 0.0322s/iter; left time: 148.4637s
Epoch: 6 cost time: 36.83738470077515
Epoch: 6, Steps: 1143 | Train Loss: 0.1879081 Vali Loss: 0.6517180 Test Loss: 0.6283643
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : weather_192_Transformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed3293<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10348
mse:0.5770624876022339, mae:0.5169392228126526
