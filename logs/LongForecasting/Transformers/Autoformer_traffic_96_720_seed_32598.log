Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=862, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=862, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Autoformer', model_id='traffic_720', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=720, root_path='./dataset/', seed=32598, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_720_Autoformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed32598>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11465
val 1037
test 2789
	iters: 100, epoch: 1 | loss: 0.4664948
	speed: 0.2570s/iter; left time: 894.5212s
	iters: 200, epoch: 1 | loss: 0.3737177
	speed: 0.2208s/iter; left time: 746.6432s
	iters: 300, epoch: 1 | loss: 0.3295735
	speed: 0.2213s/iter; left time: 726.1384s
Epoch: 1 cost time: 82.89207816123962
Epoch: 1, Steps: 358 | Train Loss: 0.4309446 Vali Loss: 0.5256297 Test Loss: 0.6883778
Validation loss decreased (inf --> 0.525630).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3040319
	speed: 0.6531s/iter; left time: 2039.7111s
	iters: 200, epoch: 2 | loss: 0.3025424
	speed: 0.2223s/iter; left time: 672.0305s
	iters: 300, epoch: 2 | loss: 0.2933994
	speed: 0.2217s/iter; left time: 648.0081s
Epoch: 2 cost time: 79.45968985557556
Epoch: 2, Steps: 358 | Train Loss: 0.3009696 Vali Loss: 0.5028397 Test Loss: 0.6599926
Validation loss decreased (0.525630 --> 0.502840).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2820323
	speed: 0.6498s/iter; left time: 1796.5963s
	iters: 200, epoch: 3 | loss: 0.2866275
	speed: 0.2220s/iter; left time: 591.7597s
	iters: 300, epoch: 3 | loss: 0.2768653
	speed: 0.2221s/iter; left time: 569.7275s
Epoch: 3 cost time: 79.45626878738403
Epoch: 3, Steps: 358 | Train Loss: 0.2818008 Vali Loss: 0.4937902 Test Loss: 0.6415070
Validation loss decreased (0.502840 --> 0.493790).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2734537
	speed: 0.6515s/iter; left time: 1568.1100s
	iters: 200, epoch: 4 | loss: 0.2756125
	speed: 0.2221s/iter; left time: 512.3622s
	iters: 300, epoch: 4 | loss: 0.2803061
	speed: 0.2223s/iter; left time: 490.5146s
Epoch: 4 cost time: 79.5572521686554
Epoch: 4, Steps: 358 | Train Loss: 0.2749084 Vali Loss: 0.4916481 Test Loss: 0.6417073
Validation loss decreased (0.493790 --> 0.491648).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2701090
	speed: 0.6499s/iter; left time: 1331.7355s
	iters: 200, epoch: 5 | loss: 0.2659387
	speed: 0.2220s/iter; left time: 432.5838s
	iters: 300, epoch: 5 | loss: 0.2705184
	speed: 0.2224s/iter; left time: 411.1564s
Epoch: 5 cost time: 79.42284941673279
Epoch: 5, Steps: 358 | Train Loss: 0.2714267 Vali Loss: 0.4863320 Test Loss: 0.6372262
Validation loss decreased (0.491648 --> 0.486332).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2727195
	speed: 0.6496s/iter; left time: 1098.5205s
	iters: 200, epoch: 6 | loss: 0.2737681
	speed: 0.2225s/iter; left time: 354.0252s
	iters: 300, epoch: 6 | loss: 0.2618437
	speed: 0.2223s/iter; left time: 331.4790s
Epoch: 6 cost time: 79.38488626480103
Epoch: 6, Steps: 358 | Train Loss: 0.2697782 Vali Loss: 0.4855547 Test Loss: 0.6356011
Validation loss decreased (0.486332 --> 0.485555).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2641889
	speed: 0.6471s/iter; left time: 862.5727s
	iters: 200, epoch: 7 | loss: 0.2614513
	speed: 0.2220s/iter; left time: 273.7736s
	iters: 300, epoch: 7 | loss: 0.2587020
	speed: 0.2213s/iter; left time: 250.7182s
Epoch: 7 cost time: 79.25146532058716
Epoch: 7, Steps: 358 | Train Loss: 0.2688714 Vali Loss: 0.4842843 Test Loss: 0.6351402
Validation loss decreased (0.485555 --> 0.484284).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2668183
	speed: 0.6507s/iter; left time: 634.4346s
	iters: 200, epoch: 8 | loss: 0.2678906
	speed: 0.2215s/iter; left time: 193.7853s
	iters: 300, epoch: 8 | loss: 0.2609646
	speed: 0.2221s/iter; left time: 172.1017s
Epoch: 8 cost time: 79.36151146888733
Epoch: 8, Steps: 358 | Train Loss: 0.2683137 Vali Loss: 0.4856955 Test Loss: 0.6356613
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2634010
	speed: 0.6486s/iter; left time: 400.2046s
	iters: 200, epoch: 9 | loss: 0.2693204
	speed: 0.2213s/iter; left time: 114.4170s
	iters: 300, epoch: 9 | loss: 0.2621625
	speed: 0.2211s/iter; left time: 92.2116s
Epoch: 9 cost time: 79.2875907421112
Epoch: 9, Steps: 358 | Train Loss: 0.2680441 Vali Loss: 0.4847465 Test Loss: 0.6356426
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2732149
	speed: 0.6478s/iter; left time: 167.7682s
	iters: 200, epoch: 10 | loss: 0.2711265
	speed: 0.2213s/iter; left time: 35.1800s
	iters: 300, epoch: 10 | loss: 0.2694684
	speed: 0.2211s/iter; left time: 13.0466s
Epoch: 10 cost time: 79.25843167304993
Epoch: 10, Steps: 358 | Train Loss: 0.2678549 Vali Loss: 0.4849256 Test Loss: 0.6358762
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : traffic_720_Autoformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed32598<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2789
mse:0.634976327419281, mae:0.3911658525466919
