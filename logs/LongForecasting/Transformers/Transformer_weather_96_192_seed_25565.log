Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=21, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=21, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Transformer', model_id='weather_192', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=192, root_path='./dataset/', seed=25565, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_192_Transformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed25565>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36600
val 5079
test 10348
	iters: 100, epoch: 1 | loss: 0.5164400
	speed: 0.0623s/iter; left time: 706.3605s
	iters: 200, epoch: 1 | loss: 0.8957324
	speed: 0.0321s/iter; left time: 360.7898s
	iters: 300, epoch: 1 | loss: 0.2777106
	speed: 0.0321s/iter; left time: 357.5485s
	iters: 400, epoch: 1 | loss: 0.3335924
	speed: 0.0321s/iter; left time: 354.5536s
	iters: 500, epoch: 1 | loss: 0.2693630
	speed: 0.0323s/iter; left time: 352.5519s
	iters: 600, epoch: 1 | loss: 0.3123790
	speed: 0.0322s/iter; left time: 349.2798s
	iters: 700, epoch: 1 | loss: 0.3245945
	speed: 0.0323s/iter; left time: 346.3965s
	iters: 800, epoch: 1 | loss: 0.3065603
	speed: 0.0323s/iter; left time: 343.2943s
	iters: 900, epoch: 1 | loss: 0.3690220
	speed: 0.0323s/iter; left time: 340.2284s
	iters: 1000, epoch: 1 | loss: 0.2132527
	speed: 0.0323s/iter; left time: 336.6363s
	iters: 1100, epoch: 1 | loss: 0.3184950
	speed: 0.0323s/iter; left time: 333.5906s
Epoch: 1 cost time: 39.86020016670227
Epoch: 1, Steps: 1143 | Train Loss: 0.3957403 Vali Loss: 0.6658159 Test Loss: 0.6337746
Validation loss decreased (inf --> 0.665816).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2206227
	speed: 0.1000s/iter; left time: 1018.8256s
	iters: 200, epoch: 2 | loss: 0.2254372
	speed: 0.0325s/iter; left time: 327.7262s
	iters: 300, epoch: 2 | loss: 0.2235904
	speed: 0.0324s/iter; left time: 323.9807s
	iters: 400, epoch: 2 | loss: 0.6418166
	speed: 0.0325s/iter; left time: 320.9646s
	iters: 500, epoch: 2 | loss: 0.1958457
	speed: 0.0323s/iter; left time: 316.5749s
	iters: 600, epoch: 2 | loss: 0.2207231
	speed: 0.0323s/iter; left time: 313.1949s
	iters: 700, epoch: 2 | loss: 0.1951523
	speed: 0.0324s/iter; left time: 311.0111s
	iters: 800, epoch: 2 | loss: 0.1735630
	speed: 0.0324s/iter; left time: 307.2478s
	iters: 900, epoch: 2 | loss: 0.2040688
	speed: 0.0323s/iter; left time: 303.4356s
	iters: 1000, epoch: 2 | loss: 0.1682653
	speed: 0.0323s/iter; left time: 299.9498s
	iters: 1100, epoch: 2 | loss: 0.2577569
	speed: 0.0323s/iter; left time: 296.7041s
Epoch: 2 cost time: 36.992613554000854
Epoch: 2, Steps: 1143 | Train Loss: 0.2749265 Vali Loss: 0.6645133 Test Loss: 0.6305224
Validation loss decreased (0.665816 --> 0.664513).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1288703
	speed: 0.0997s/iter; left time: 901.9347s
	iters: 200, epoch: 3 | loss: 0.4561507
	speed: 0.0324s/iter; left time: 289.3799s
	iters: 300, epoch: 3 | loss: 0.2645666
	speed: 0.0323s/iter; left time: 285.9693s
	iters: 400, epoch: 3 | loss: 0.1883073
	speed: 0.0323s/iter; left time: 282.6763s
	iters: 500, epoch: 3 | loss: 0.5231861
	speed: 0.0323s/iter; left time: 279.3696s
	iters: 600, epoch: 3 | loss: 0.1431932
	speed: 0.0323s/iter; left time: 276.1386s
	iters: 700, epoch: 3 | loss: 0.1716841
	speed: 0.0323s/iter; left time: 272.7867s
	iters: 800, epoch: 3 | loss: 0.1115468
	speed: 0.0324s/iter; left time: 270.1687s
	iters: 900, epoch: 3 | loss: 0.5466969
	speed: 0.0324s/iter; left time: 267.1296s
	iters: 1000, epoch: 3 | loss: 0.1691769
	speed: 0.0324s/iter; left time: 263.6373s
	iters: 1100, epoch: 3 | loss: 0.1406854
	speed: 0.0324s/iter; left time: 260.6923s
Epoch: 3 cost time: 36.95945119857788
Epoch: 3, Steps: 1143 | Train Loss: 0.2231155 Vali Loss: 0.6633202 Test Loss: 0.6679343
Validation loss decreased (0.664513 --> 0.663320).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1650911
	speed: 0.0998s/iter; left time: 788.8522s
	iters: 200, epoch: 4 | loss: 0.4182120
	speed: 0.0323s/iter; left time: 251.6321s
	iters: 300, epoch: 4 | loss: 0.1267172
	speed: 0.0323s/iter; left time: 248.4649s
	iters: 400, epoch: 4 | loss: 0.1258266
	speed: 0.0323s/iter; left time: 245.3307s
	iters: 500, epoch: 4 | loss: 0.1111358
	speed: 0.0322s/iter; left time: 241.8490s
	iters: 600, epoch: 4 | loss: 0.2045246
	speed: 0.0323s/iter; left time: 238.9230s
	iters: 700, epoch: 4 | loss: 0.1049352
	speed: 0.0323s/iter; left time: 235.7208s
	iters: 800, epoch: 4 | loss: 0.1792542
	speed: 0.0322s/iter; left time: 231.9720s
	iters: 900, epoch: 4 | loss: 0.1125442
	speed: 0.0322s/iter; left time: 228.7810s
	iters: 1000, epoch: 4 | loss: 0.1525850
	speed: 0.0322s/iter; left time: 225.4834s
	iters: 1100, epoch: 4 | loss: 0.1079177
	speed: 0.0322s/iter; left time: 222.2111s
Epoch: 4 cost time: 36.83722424507141
Epoch: 4, Steps: 1143 | Train Loss: 0.2028203 Vali Loss: 0.6559226 Test Loss: 0.6293178
Validation loss decreased (0.663320 --> 0.655923).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3973921
	speed: 0.0999s/iter; left time: 675.0554s
	iters: 200, epoch: 5 | loss: 0.1515952
	speed: 0.0323s/iter; left time: 214.8574s
	iters: 300, epoch: 5 | loss: 0.1449290
	speed: 0.0323s/iter; left time: 211.5625s
	iters: 400, epoch: 5 | loss: 0.1168933
	speed: 0.0322s/iter; left time: 207.9632s
	iters: 500, epoch: 5 | loss: 0.1202741
	speed: 0.0322s/iter; left time: 204.6320s
	iters: 600, epoch: 5 | loss: 0.1131334
	speed: 0.0322s/iter; left time: 201.6123s
	iters: 700, epoch: 5 | loss: 0.1505948
	speed: 0.0322s/iter; left time: 198.3937s
	iters: 800, epoch: 5 | loss: 0.4455968
	speed: 0.0322s/iter; left time: 195.2690s
	iters: 900, epoch: 5 | loss: 0.4239016
	speed: 0.0322s/iter; left time: 192.1083s
	iters: 1000, epoch: 5 | loss: 0.1297026
	speed: 0.0322s/iter; left time: 188.9080s
	iters: 1100, epoch: 5 | loss: 0.4549122
	speed: 0.0323s/iter; left time: 185.8603s
Epoch: 5 cost time: 36.826143741607666
Epoch: 5, Steps: 1143 | Train Loss: 0.1932662 Vali Loss: 0.6590016 Test Loss: 0.6314442
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1085003
	speed: 0.0976s/iter; left time: 548.2076s
	iters: 200, epoch: 6 | loss: 0.1110870
	speed: 0.0323s/iter; left time: 178.0762s
	iters: 300, epoch: 6 | loss: 0.1504044
	speed: 0.0323s/iter; left time: 174.8185s
	iters: 400, epoch: 6 | loss: 0.1063893
	speed: 0.0323s/iter; left time: 171.5132s
	iters: 500, epoch: 6 | loss: 0.4533641
	speed: 0.0323s/iter; left time: 168.2898s
	iters: 600, epoch: 6 | loss: 0.1446096
	speed: 0.0323s/iter; left time: 165.0123s
	iters: 700, epoch: 6 | loss: 0.7677052
	speed: 0.0323s/iter; left time: 161.8145s
	iters: 800, epoch: 6 | loss: 0.1771282
	speed: 0.0323s/iter; left time: 158.5524s
	iters: 900, epoch: 6 | loss: 0.1411629
	speed: 0.0322s/iter; left time: 155.1959s
	iters: 1000, epoch: 6 | loss: 0.1544173
	speed: 0.0322s/iter; left time: 152.0071s
	iters: 1100, epoch: 6 | loss: 0.4396729
	speed: 0.0322s/iter; left time: 148.7832s
Epoch: 6 cost time: 36.85644793510437
Epoch: 6, Steps: 1143 | Train Loss: 0.1879995 Vali Loss: 0.6622108 Test Loss: 0.6431355
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3752040
	speed: 0.0973s/iter; left time: 435.3143s
	iters: 200, epoch: 7 | loss: 0.1696699
	speed: 0.0322s/iter; left time: 140.6918s
	iters: 300, epoch: 7 | loss: 0.1648579
	speed: 0.0322s/iter; left time: 137.5608s
	iters: 400, epoch: 7 | loss: 0.1897726
	speed: 0.0322s/iter; left time: 134.3247s
	iters: 500, epoch: 7 | loss: 0.4229843
	speed: 0.0322s/iter; left time: 131.1016s
	iters: 600, epoch: 7 | loss: 0.1458928
	speed: 0.0322s/iter; left time: 127.9018s
	iters: 700, epoch: 7 | loss: 0.1236704
	speed: 0.0322s/iter; left time: 124.6275s
	iters: 800, epoch: 7 | loss: 0.1212646
	speed: 0.0322s/iter; left time: 121.4268s
	iters: 900, epoch: 7 | loss: 0.1381550
	speed: 0.0322s/iter; left time: 118.2432s
	iters: 1000, epoch: 7 | loss: 0.1522383
	speed: 0.0322s/iter; left time: 115.0239s
	iters: 1100, epoch: 7 | loss: 0.1107896
	speed: 0.0322s/iter; left time: 111.7564s
Epoch: 7 cost time: 36.78201699256897
Epoch: 7, Steps: 1143 | Train Loss: 0.1856259 Vali Loss: 0.6614556 Test Loss: 0.6372941
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : weather_192_Transformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed25565<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10348
mse:0.6296694278717041, mae:0.5442803502082825
