Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Autoformer', model_id='ETTm2_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=96, root_path='./dataset/', seed=32598, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm2_96_Autoformer_ETTm2_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed32598>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34369
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.2207057
	speed: 0.0822s/iter; left time: 875.1463s
	iters: 200, epoch: 1 | loss: 0.1962456
	speed: 0.0473s/iter; left time: 498.8259s
	iters: 300, epoch: 1 | loss: 0.2354082
	speed: 0.0472s/iter; left time: 493.0734s
	iters: 400, epoch: 1 | loss: 0.1462126
	speed: 0.0473s/iter; left time: 489.2332s
	iters: 500, epoch: 1 | loss: 0.2186101
	speed: 0.0473s/iter; left time: 484.3689s
	iters: 600, epoch: 1 | loss: 0.1322978
	speed: 0.0473s/iter; left time: 480.1505s
	iters: 700, epoch: 1 | loss: 0.4083425
	speed: 0.0475s/iter; left time: 477.3699s
	iters: 800, epoch: 1 | loss: 0.2085402
	speed: 0.0473s/iter; left time: 470.2942s
	iters: 900, epoch: 1 | loss: 0.1892798
	speed: 0.0474s/iter; left time: 466.3474s
	iters: 1000, epoch: 1 | loss: 0.2762229
	speed: 0.0474s/iter; left time: 461.3402s
Epoch: 1 cost time: 54.383824825286865
Epoch: 1, Steps: 1074 | Train Loss: 0.2734756 Vali Loss: 0.1615769 Test Loss: 0.2653388
Validation loss decreased (inf --> 0.161577).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1455948
	speed: 0.2768s/iter; left time: 2648.0684s
	iters: 200, epoch: 2 | loss: 0.1730323
	speed: 0.0473s/iter; left time: 447.5772s
	iters: 300, epoch: 2 | loss: 0.2104305
	speed: 0.0472s/iter; left time: 442.2215s
	iters: 400, epoch: 2 | loss: 0.2808852
	speed: 0.0473s/iter; left time: 438.1775s
	iters: 500, epoch: 2 | loss: 0.2095910
	speed: 0.0474s/iter; left time: 434.5005s
	iters: 600, epoch: 2 | loss: 0.1211406
	speed: 0.0473s/iter; left time: 428.9552s
	iters: 700, epoch: 2 | loss: 0.2573161
	speed: 0.0474s/iter; left time: 425.1315s
	iters: 800, epoch: 2 | loss: 0.3099355
	speed: 0.0473s/iter; left time: 419.3817s
	iters: 900, epoch: 2 | loss: 0.3641331
	speed: 0.0473s/iter; left time: 415.0781s
	iters: 1000, epoch: 2 | loss: 0.1915966
	speed: 0.0473s/iter; left time: 409.8656s
Epoch: 2 cost time: 50.78011775016785
Epoch: 2, Steps: 1074 | Train Loss: 0.2342327 Vali Loss: 0.1611670 Test Loss: 0.3156369
Validation loss decreased (0.161577 --> 0.161167).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2417719
	speed: 0.2761s/iter; left time: 2344.7664s
	iters: 200, epoch: 3 | loss: 0.1594788
	speed: 0.0474s/iter; left time: 397.6298s
	iters: 300, epoch: 3 | loss: 0.2350815
	speed: 0.0474s/iter; left time: 392.9908s
	iters: 400, epoch: 3 | loss: 0.1762616
	speed: 0.0472s/iter; left time: 387.0738s
	iters: 500, epoch: 3 | loss: 0.1397414
	speed: 0.0473s/iter; left time: 382.5374s
	iters: 600, epoch: 3 | loss: 0.2363650
	speed: 0.0472s/iter; left time: 377.5024s
	iters: 700, epoch: 3 | loss: 0.1818696
	speed: 0.0474s/iter; left time: 373.7538s
	iters: 800, epoch: 3 | loss: 0.1880163
	speed: 0.0472s/iter; left time: 367.6147s
	iters: 900, epoch: 3 | loss: 0.2503514
	speed: 0.0473s/iter; left time: 363.7447s
	iters: 1000, epoch: 3 | loss: 0.1374119
	speed: 0.0474s/iter; left time: 360.1837s
Epoch: 3 cost time: 50.77894067764282
Epoch: 3, Steps: 1074 | Train Loss: 0.2045907 Vali Loss: 0.2264139 Test Loss: 0.4484695
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1521383
	speed: 0.2766s/iter; left time: 2051.9740s
	iters: 200, epoch: 4 | loss: 0.1328891
	speed: 0.0472s/iter; left time: 345.6643s
	iters: 300, epoch: 4 | loss: 0.1266114
	speed: 0.0473s/iter; left time: 341.7192s
	iters: 400, epoch: 4 | loss: 0.2327452
	speed: 0.0474s/iter; left time: 337.2092s
	iters: 500, epoch: 4 | loss: 0.1716185
	speed: 0.0473s/iter; left time: 331.6619s
	iters: 600, epoch: 4 | loss: 0.2661287
	speed: 0.0474s/iter; left time: 327.7453s
	iters: 700, epoch: 4 | loss: 0.1464849
	speed: 0.0475s/iter; left time: 323.6241s
	iters: 800, epoch: 4 | loss: 0.1978506
	speed: 0.0472s/iter; left time: 317.3501s
	iters: 900, epoch: 4 | loss: 0.1828267
	speed: 0.0473s/iter; left time: 313.2757s
	iters: 1000, epoch: 4 | loss: 0.1416305
	speed: 0.0474s/iter; left time: 308.7933s
Epoch: 4 cost time: 50.822089433670044
Epoch: 4, Steps: 1074 | Train Loss: 0.1906674 Vali Loss: 0.2304510 Test Loss: 0.3937403
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1246773
	speed: 0.2735s/iter; left time: 1735.3406s
	iters: 200, epoch: 5 | loss: 0.2008288
	speed: 0.0474s/iter; left time: 295.7010s
	iters: 300, epoch: 5 | loss: 0.1716565
	speed: 0.0474s/iter; left time: 291.2174s
	iters: 400, epoch: 5 | loss: 0.1161348
	speed: 0.0473s/iter; left time: 286.0434s
	iters: 500, epoch: 5 | loss: 0.1350299
	speed: 0.0473s/iter; left time: 280.9117s
	iters: 600, epoch: 5 | loss: 0.2063890
	speed: 0.0473s/iter; left time: 276.5610s
	iters: 700, epoch: 5 | loss: 0.1571047
	speed: 0.0474s/iter; left time: 272.1089s
	iters: 800, epoch: 5 | loss: 0.1482228
	speed: 0.0473s/iter; left time: 266.9764s
	iters: 900, epoch: 5 | loss: 0.1706667
	speed: 0.0474s/iter; left time: 263.0109s
	iters: 1000, epoch: 5 | loss: 0.1220192
	speed: 0.0474s/iter; left time: 257.9382s
Epoch: 5 cost time: 50.8436164855957
Epoch: 5, Steps: 1074 | Train Loss: 0.1837378 Vali Loss: 0.2525871 Test Loss: 0.4394007
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : ETTm2_96_Autoformer_ETTm2_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed32598<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.3135623335838318, mae:0.34768199920654297
