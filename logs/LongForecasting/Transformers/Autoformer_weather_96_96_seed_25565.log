Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=21, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=21, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Autoformer', model_id='weather_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=96, root_path='./dataset/', seed=25565, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_96_Autoformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed25565>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36696
val 5175
test 10444
	iters: 100, epoch: 1 | loss: 0.4875412
	speed: 0.0815s/iter; left time: 925.9148s
	iters: 200, epoch: 1 | loss: 0.4216411
	speed: 0.0475s/iter; left time: 534.6095s
	iters: 300, epoch: 1 | loss: 0.4759579
	speed: 0.0473s/iter; left time: 528.2358s
	iters: 400, epoch: 1 | loss: 0.3669946
	speed: 0.0474s/iter; left time: 524.0004s
	iters: 500, epoch: 1 | loss: 0.4150200
	speed: 0.0474s/iter; left time: 519.9238s
	iters: 600, epoch: 1 | loss: 0.3734627
	speed: 0.0475s/iter; left time: 515.3545s
	iters: 700, epoch: 1 | loss: 0.3850385
	speed: 0.0475s/iter; left time: 510.9843s
	iters: 800, epoch: 1 | loss: 0.2714902
	speed: 0.0474s/iter; left time: 505.0071s
	iters: 900, epoch: 1 | loss: 0.3608850
	speed: 0.0473s/iter; left time: 499.2468s
	iters: 1000, epoch: 1 | loss: 0.5501000
	speed: 0.0473s/iter; left time: 494.4984s
	iters: 1100, epoch: 1 | loss: 0.3538285
	speed: 0.0473s/iter; left time: 489.7900s
Epoch: 1 cost time: 57.719717264175415
Epoch: 1, Steps: 1146 | Train Loss: 0.5083907 Vali Loss: 0.5202240 Test Loss: 0.2601603
Validation loss decreased (inf --> 0.520224).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3311617
	speed: 0.2106s/iter; left time: 2151.0773s
	iters: 200, epoch: 2 | loss: 0.3797309
	speed: 0.0473s/iter; left time: 477.9941s
	iters: 300, epoch: 2 | loss: 0.3717854
	speed: 0.0473s/iter; left time: 473.6839s
	iters: 400, epoch: 2 | loss: 0.2838574
	speed: 0.0472s/iter; left time: 468.1597s
	iters: 500, epoch: 2 | loss: 0.2448126
	speed: 0.0473s/iter; left time: 463.8624s
	iters: 600, epoch: 2 | loss: 0.4371520
	speed: 0.0473s/iter; left time: 459.5261s
	iters: 700, epoch: 2 | loss: 0.3907728
	speed: 0.0473s/iter; left time: 454.6703s
	iters: 800, epoch: 2 | loss: 0.6465285
	speed: 0.0473s/iter; left time: 449.7665s
	iters: 900, epoch: 2 | loss: 0.3904333
	speed: 0.0473s/iter; left time: 445.3628s
	iters: 1000, epoch: 2 | loss: 0.2354152
	speed: 0.0473s/iter; left time: 440.5014s
	iters: 1100, epoch: 2 | loss: 0.2421350
	speed: 0.0473s/iter; left time: 435.5084s
Epoch: 2 cost time: 54.175267696380615
Epoch: 2, Steps: 1146 | Train Loss: 0.4405345 Vali Loss: 0.4991335 Test Loss: 0.2694414
Validation loss decreased (0.520224 --> 0.499133).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4721687
	speed: 0.2110s/iter; left time: 1913.6956s
	iters: 200, epoch: 3 | loss: 0.3024610
	speed: 0.0473s/iter; left time: 424.1965s
	iters: 300, epoch: 3 | loss: 0.3980114
	speed: 0.0473s/iter; left time: 419.4513s
	iters: 400, epoch: 3 | loss: 0.5086239
	speed: 0.0473s/iter; left time: 415.1071s
	iters: 500, epoch: 3 | loss: 0.5078971
	speed: 0.0472s/iter; left time: 409.4728s
	iters: 600, epoch: 3 | loss: 0.2229303
	speed: 0.0473s/iter; left time: 405.5461s
	iters: 700, epoch: 3 | loss: 1.1508273
	speed: 0.0473s/iter; left time: 400.7607s
	iters: 800, epoch: 3 | loss: 0.4158480
	speed: 0.0473s/iter; left time: 395.9584s
	iters: 900, epoch: 3 | loss: 1.0923858
	speed: 0.0473s/iter; left time: 391.0180s
	iters: 1000, epoch: 3 | loss: 0.3572996
	speed: 0.0474s/iter; left time: 387.2573s
	iters: 1100, epoch: 3 | loss: 0.4564436
	speed: 0.0473s/iter; left time: 381.5070s
Epoch: 3 cost time: 54.221863985061646
Epoch: 3, Steps: 1146 | Train Loss: 0.4054279 Vali Loss: 0.5017848 Test Loss: 0.2453679
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3928443
	speed: 0.2095s/iter; left time: 1659.8282s
	iters: 200, epoch: 4 | loss: 0.1928713
	speed: 0.0473s/iter; left time: 370.2816s
	iters: 300, epoch: 4 | loss: 0.4605083
	speed: 0.0479s/iter; left time: 369.7797s
	iters: 400, epoch: 4 | loss: 0.3246899
	speed: 0.0477s/iter; left time: 363.5130s
	iters: 500, epoch: 4 | loss: 0.2295330
	speed: 0.0476s/iter; left time: 358.0286s
	iters: 600, epoch: 4 | loss: 0.5396454
	speed: 0.0476s/iter; left time: 353.1853s
	iters: 700, epoch: 4 | loss: 0.4666597
	speed: 0.0476s/iter; left time: 348.7974s
	iters: 800, epoch: 4 | loss: 0.2747844
	speed: 0.0479s/iter; left time: 345.7064s
	iters: 900, epoch: 4 | loss: 0.2672933
	speed: 0.0477s/iter; left time: 339.7730s
	iters: 1000, epoch: 4 | loss: 0.2157912
	speed: 0.0474s/iter; left time: 333.1846s
	iters: 1100, epoch: 4 | loss: 0.3130753
	speed: 0.0478s/iter; left time: 330.6525s
Epoch: 4 cost time: 54.56690859794617
Epoch: 4, Steps: 1146 | Train Loss: 0.3871254 Vali Loss: 0.5060163 Test Loss: 0.2512471
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2610400
	speed: 0.2096s/iter; left time: 1420.7249s
	iters: 200, epoch: 5 | loss: 0.2404799
	speed: 0.0476s/iter; left time: 317.9010s
	iters: 300, epoch: 5 | loss: 0.2228294
	speed: 0.0474s/iter; left time: 311.5494s
	iters: 400, epoch: 5 | loss: 0.2346892
	speed: 0.0474s/iter; left time: 306.8309s
	iters: 500, epoch: 5 | loss: 0.3123200
	speed: 0.0475s/iter; left time: 302.9175s
	iters: 600, epoch: 5 | loss: 0.3009374
	speed: 0.0476s/iter; left time: 298.6062s
	iters: 700, epoch: 5 | loss: 0.3106084
	speed: 0.0474s/iter; left time: 292.7311s
	iters: 800, epoch: 5 | loss: 1.0284737
	speed: 0.0472s/iter; left time: 286.7362s
	iters: 900, epoch: 5 | loss: 0.2422915
	speed: 0.0473s/iter; left time: 282.6992s
	iters: 1000, epoch: 5 | loss: 0.2226168
	speed: 0.0472s/iter; left time: 277.6729s
	iters: 1100, epoch: 5 | loss: 1.0671169
	speed: 0.0472s/iter; left time: 272.6200s
Epoch: 5 cost time: 54.292863845825195
Epoch: 5, Steps: 1146 | Train Loss: 0.3748590 Vali Loss: 0.5160046 Test Loss: 0.2650077
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : weather_96_Autoformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed25565<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
mse:0.26985132694244385, mae:0.3365170359611511
