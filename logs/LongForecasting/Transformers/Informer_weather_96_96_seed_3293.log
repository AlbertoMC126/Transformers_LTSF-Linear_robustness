Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=21, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=21, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Informer', model_id='weather_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=96, root_path='./dataset/', seed=3293, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_96_Informer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed3293>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36696
val 5175
test 10444
	iters: 100, epoch: 1 | loss: 0.3583507
	speed: 0.0586s/iter; left time: 665.2267s
	iters: 200, epoch: 1 | loss: 0.3260125
	speed: 0.0280s/iter; left time: 314.9120s
	iters: 300, epoch: 1 | loss: 0.3181754
	speed: 0.0281s/iter; left time: 313.9245s
	iters: 400, epoch: 1 | loss: 0.2729530
	speed: 0.0278s/iter; left time: 307.3338s
	iters: 500, epoch: 1 | loss: 0.4609911
	speed: 0.0278s/iter; left time: 304.4556s
	iters: 600, epoch: 1 | loss: 0.2976541
	speed: 0.0274s/iter; left time: 298.1260s
	iters: 700, epoch: 1 | loss: 0.3413051
	speed: 0.0275s/iter; left time: 295.5703s
	iters: 800, epoch: 1 | loss: 0.2438272
	speed: 0.0275s/iter; left time: 293.5616s
	iters: 900, epoch: 1 | loss: 0.3834056
	speed: 0.0276s/iter; left time: 291.5926s
	iters: 1000, epoch: 1 | loss: 0.2116932
	speed: 0.0280s/iter; left time: 292.4436s
	iters: 1100, epoch: 1 | loss: 0.4034478
	speed: 0.0281s/iter; left time: 291.0042s
Epoch: 1 cost time: 34.9327826499939
Epoch: 1, Steps: 1146 | Train Loss: 0.4023564 Vali Loss: 0.4828518 Test Loss: 0.4578178
Validation loss decreased (inf --> 0.482852).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3241768
	speed: 0.0885s/iter; left time: 903.9001s
	iters: 200, epoch: 2 | loss: 0.3137291
	speed: 0.0274s/iter; left time: 276.7456s
	iters: 300, epoch: 2 | loss: 0.2588817
	speed: 0.0273s/iter; left time: 273.8007s
	iters: 400, epoch: 2 | loss: 0.2902109
	speed: 0.0273s/iter; left time: 270.3808s
	iters: 500, epoch: 2 | loss: 0.3471050
	speed: 0.0274s/iter; left time: 268.5391s
	iters: 600, epoch: 2 | loss: 0.1948097
	speed: 0.0274s/iter; left time: 265.9648s
	iters: 700, epoch: 2 | loss: 0.2486108
	speed: 0.0274s/iter; left time: 263.4057s
	iters: 800, epoch: 2 | loss: 0.1473261
	speed: 0.0274s/iter; left time: 260.4873s
	iters: 900, epoch: 2 | loss: 0.1738064
	speed: 0.0274s/iter; left time: 258.1584s
	iters: 1000, epoch: 2 | loss: 0.2249957
	speed: 0.0279s/iter; left time: 260.0474s
	iters: 1100, epoch: 2 | loss: 0.2683349
	speed: 0.0294s/iter; left time: 271.1268s
Epoch: 2 cost time: 31.677375555038452
Epoch: 2, Steps: 1146 | Train Loss: 0.3239400 Vali Loss: 0.4802628 Test Loss: 0.3611900
Validation loss decreased (0.482852 --> 0.480263).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1807641
	speed: 0.0914s/iter; left time: 828.7028s
	iters: 200, epoch: 3 | loss: 0.9628644
	speed: 0.0291s/iter; left time: 261.4327s
	iters: 300, epoch: 3 | loss: 0.3817348
	speed: 0.0290s/iter; left time: 256.9467s
	iters: 400, epoch: 3 | loss: 0.1424411
	speed: 0.0290s/iter; left time: 253.9162s
	iters: 500, epoch: 3 | loss: 0.3168982
	speed: 0.0290s/iter; left time: 251.5972s
	iters: 600, epoch: 3 | loss: 0.1723934
	speed: 0.0290s/iter; left time: 248.5362s
	iters: 700, epoch: 3 | loss: 0.1945823
	speed: 0.0293s/iter; left time: 247.8297s
	iters: 800, epoch: 3 | loss: 0.3120253
	speed: 0.0275s/iter; left time: 230.3857s
	iters: 900, epoch: 3 | loss: 0.4259699
	speed: 0.0276s/iter; left time: 228.2679s
	iters: 1000, epoch: 3 | loss: 0.1452428
	speed: 0.0276s/iter; left time: 225.5316s
	iters: 1100, epoch: 3 | loss: 0.1686234
	speed: 0.0276s/iter; left time: 222.7697s
Epoch: 3 cost time: 32.6505172252655
Epoch: 3, Steps: 1146 | Train Loss: 0.2658796 Vali Loss: 0.4941931 Test Loss: 0.3804705
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1905625
	speed: 0.0861s/iter; left time: 682.2738s
	iters: 200, epoch: 4 | loss: 0.1398376
	speed: 0.0277s/iter; left time: 216.6037s
	iters: 300, epoch: 4 | loss: 0.2952012
	speed: 0.0276s/iter; left time: 213.1810s
	iters: 400, epoch: 4 | loss: 0.2243658
	speed: 0.0278s/iter; left time: 211.6070s
	iters: 500, epoch: 4 | loss: 0.1420061
	speed: 0.0279s/iter; left time: 209.5515s
	iters: 600, epoch: 4 | loss: 0.1565859
	speed: 0.0275s/iter; left time: 204.2668s
	iters: 700, epoch: 4 | loss: 0.1152508
	speed: 0.0276s/iter; left time: 202.3346s
	iters: 800, epoch: 4 | loss: 0.2520459
	speed: 0.0276s/iter; left time: 199.3278s
	iters: 900, epoch: 4 | loss: 0.1330470
	speed: 0.0276s/iter; left time: 196.7025s
	iters: 1000, epoch: 4 | loss: 0.1517215
	speed: 0.0276s/iter; left time: 193.6117s
	iters: 1100, epoch: 4 | loss: 0.2726723
	speed: 0.0276s/iter; left time: 191.1983s
Epoch: 4 cost time: 31.689666032791138
Epoch: 4, Steps: 1146 | Train Loss: 0.2397306 Vali Loss: 0.4941299 Test Loss: 0.3868156
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1182018
	speed: 0.0861s/iter; left time: 583.2951s
	iters: 200, epoch: 5 | loss: 0.1831588
	speed: 0.0276s/iter; left time: 184.1397s
	iters: 300, epoch: 5 | loss: 0.1695295
	speed: 0.0274s/iter; left time: 180.1233s
	iters: 400, epoch: 5 | loss: 0.1614061
	speed: 0.0274s/iter; left time: 177.6328s
	iters: 500, epoch: 5 | loss: 0.1815773
	speed: 0.0274s/iter; left time: 174.7222s
	iters: 600, epoch: 5 | loss: 0.1421581
	speed: 0.0274s/iter; left time: 172.1612s
	iters: 700, epoch: 5 | loss: 0.1815388
	speed: 0.0274s/iter; left time: 169.1179s
	iters: 800, epoch: 5 | loss: 0.1392506
	speed: 0.0274s/iter; left time: 166.4405s
	iters: 900, epoch: 5 | loss: 0.1402246
	speed: 0.0274s/iter; left time: 163.6421s
	iters: 1000, epoch: 5 | loss: 0.1380867
	speed: 0.0274s/iter; left time: 160.9655s
	iters: 1100, epoch: 5 | loss: 0.1240937
	speed: 0.0273s/iter; left time: 157.9990s
Epoch: 5 cost time: 31.422579765319824
Epoch: 5, Steps: 1146 | Train Loss: 0.2274375 Vali Loss: 0.4987040 Test Loss: 0.3775113
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : weather_96_Informer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed3293<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
mse:0.3612700402736664, mae:0.4254189431667328
