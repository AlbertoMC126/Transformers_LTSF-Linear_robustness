Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=21, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=21, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Transformer', model_id='weather_720', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=720, root_path='./dataset/', seed=3293, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_720_Transformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed3293>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36072
val 4551
test 9820
	iters: 100, epoch: 1 | loss: 0.7000422
	speed: 0.1229s/iter; left time: 1373.0940s
	iters: 200, epoch: 1 | loss: 0.8077254
	speed: 0.0925s/iter; left time: 1024.3662s
	iters: 300, epoch: 1 | loss: 0.5265634
	speed: 0.0927s/iter; left time: 1016.5321s
	iters: 400, epoch: 1 | loss: 0.6811824
	speed: 0.0928s/iter; left time: 1009.2544s
	iters: 500, epoch: 1 | loss: 0.4757795
	speed: 0.0927s/iter; left time: 998.8828s
	iters: 600, epoch: 1 | loss: 0.6371591
	speed: 0.0927s/iter; left time: 989.4782s
	iters: 700, epoch: 1 | loss: 0.5999615
	speed: 0.0927s/iter; left time: 980.4210s
	iters: 800, epoch: 1 | loss: 0.3693746
	speed: 0.0931s/iter; left time: 974.9222s
	iters: 900, epoch: 1 | loss: 0.2796055
	speed: 0.0934s/iter; left time: 968.7447s
	iters: 1000, epoch: 1 | loss: 0.4255530
	speed: 0.0935s/iter; left time: 959.9228s
	iters: 1100, epoch: 1 | loss: 0.3183363
	speed: 0.0932s/iter; left time: 947.5738s
Epoch: 1 cost time: 107.74529576301575
Epoch: 1, Steps: 1127 | Train Loss: 0.4733560 Vali Loss: 0.8765467 Test Loss: 1.0083503
Validation loss decreased (inf --> 0.876547).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4910662
	speed: 0.2825s/iter; left time: 2837.2505s
	iters: 200, epoch: 2 | loss: 0.3011866
	speed: 0.0929s/iter; left time: 923.3319s
	iters: 300, epoch: 2 | loss: 0.4483998
	speed: 0.0927s/iter; left time: 912.9642s
	iters: 400, epoch: 2 | loss: 0.3697045
	speed: 0.0927s/iter; left time: 903.2335s
	iters: 500, epoch: 2 | loss: 0.2945236
	speed: 0.0927s/iter; left time: 893.8082s
	iters: 600, epoch: 2 | loss: 0.4920708
	speed: 0.0927s/iter; left time: 884.7317s
	iters: 700, epoch: 2 | loss: 0.4496835
	speed: 0.0928s/iter; left time: 876.4770s
	iters: 800, epoch: 2 | loss: 0.1880643
	speed: 0.0931s/iter; left time: 870.1644s
	iters: 900, epoch: 2 | loss: 0.2488087
	speed: 0.0933s/iter; left time: 862.3725s
	iters: 1000, epoch: 2 | loss: 0.2377761
	speed: 0.0932s/iter; left time: 852.1015s
	iters: 1100, epoch: 2 | loss: 0.2283454
	speed: 0.0930s/iter; left time: 840.8687s
Epoch: 2 cost time: 104.6352744102478
Epoch: 2, Steps: 1127 | Train Loss: 0.3252209 Vali Loss: 0.9715536 Test Loss: 1.2308754
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2371908
	speed: 0.2799s/iter; left time: 2495.8872s
	iters: 200, epoch: 3 | loss: 0.3521821
	speed: 0.0927s/iter; left time: 817.6962s
	iters: 300, epoch: 3 | loss: 0.3014673
	speed: 0.0926s/iter; left time: 807.1996s
	iters: 400, epoch: 3 | loss: 0.3827755
	speed: 0.0927s/iter; left time: 798.5175s
	iters: 500, epoch: 3 | loss: 0.2367728
	speed: 0.0928s/iter; left time: 790.0350s
	iters: 600, epoch: 3 | loss: 0.2389235
	speed: 0.0971s/iter; left time: 817.4863s
	iters: 700, epoch: 3 | loss: 0.2436199
	speed: 0.0961s/iter; left time: 799.2389s
	iters: 800, epoch: 3 | loss: 0.1900484
	speed: 0.0943s/iter; left time: 774.9412s
	iters: 900, epoch: 3 | loss: 0.1739911
	speed: 0.0982s/iter; left time: 797.1621s
	iters: 1000, epoch: 3 | loss: 0.2017117
	speed: 0.1040s/iter; left time: 833.5058s
	iters: 1100, epoch: 3 | loss: 0.2152496
	speed: 0.1039s/iter; left time: 822.7623s
Epoch: 3 cost time: 108.29348182678223
Epoch: 3, Steps: 1127 | Train Loss: 0.2575041 Vali Loss: 0.9366790 Test Loss: 1.1630064
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2344011
	speed: 0.3112s/iter; left time: 2424.5034s
	iters: 200, epoch: 4 | loss: 0.2632909
	speed: 0.0967s/iter; left time: 743.3741s
	iters: 300, epoch: 4 | loss: 0.1801972
	speed: 0.0953s/iter; left time: 723.6057s
	iters: 400, epoch: 4 | loss: 0.3198744
	speed: 0.0954s/iter; left time: 714.3605s
	iters: 500, epoch: 4 | loss: 0.3741882
	speed: 0.0955s/iter; left time: 705.4054s
	iters: 600, epoch: 4 | loss: 0.1663849
	speed: 0.0954s/iter; left time: 695.1498s
	iters: 700, epoch: 4 | loss: 0.2204390
	speed: 0.0953s/iter; left time: 684.8595s
	iters: 800, epoch: 4 | loss: 0.2534448
	speed: 0.0955s/iter; left time: 677.1058s
	iters: 900, epoch: 4 | loss: 0.1912136
	speed: 0.0964s/iter; left time: 673.7461s
	iters: 1000, epoch: 4 | loss: 0.2582004
	speed: 0.0955s/iter; left time: 657.9498s
	iters: 1100, epoch: 4 | loss: 0.2004890
	speed: 0.0955s/iter; left time: 648.1195s
Epoch: 4 cost time: 107.90222334861755
Epoch: 4, Steps: 1127 | Train Loss: 0.2340923 Vali Loss: 0.9288530 Test Loss: 1.1141461
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : weather_720_Transformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed3293<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9820
mse:1.0082358121871948, mae:0.733215868473053
