Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=21, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=21, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Informer', model_id='weather_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=336, root_path='./dataset/', seed=25565, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_336_Informer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed25565>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36456
val 4935
test 10204
	iters: 100, epoch: 1 | loss: 0.4291968
	speed: 0.0741s/iter; left time: 836.7343s
	iters: 200, epoch: 1 | loss: 0.4691612
	speed: 0.0433s/iter; left time: 484.5541s
	iters: 300, epoch: 1 | loss: 0.3918550
	speed: 0.0431s/iter; left time: 477.4980s
	iters: 400, epoch: 1 | loss: 0.7033836
	speed: 0.0422s/iter; left time: 463.5461s
	iters: 500, epoch: 1 | loss: 0.7115357
	speed: 0.0421s/iter; left time: 458.0061s
	iters: 600, epoch: 1 | loss: 0.3053880
	speed: 0.0422s/iter; left time: 455.4560s
	iters: 700, epoch: 1 | loss: 0.6022080
	speed: 0.0427s/iter; left time: 456.2380s
	iters: 800, epoch: 1 | loss: 0.3498630
	speed: 0.0425s/iter; left time: 449.7874s
	iters: 900, epoch: 1 | loss: 0.3562220
	speed: 0.0423s/iter; left time: 443.9764s
	iters: 1000, epoch: 1 | loss: 0.3910696
	speed: 0.0423s/iter; left time: 439.3632s
	iters: 1100, epoch: 1 | loss: 0.2948415
	speed: 0.0422s/iter; left time: 434.1525s
Epoch: 1 cost time: 51.587398529052734
Epoch: 1, Steps: 1139 | Train Loss: 0.4758705 Vali Loss: 0.7114057 Test Loss: 0.7801105
Validation loss decreased (inf --> 0.711406).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5644199
	speed: 0.1383s/iter; left time: 1404.3880s
	iters: 200, epoch: 2 | loss: 0.3699814
	speed: 0.0425s/iter; left time: 427.1500s
	iters: 300, epoch: 2 | loss: 0.3332192
	speed: 0.0426s/iter; left time: 424.0361s
	iters: 400, epoch: 2 | loss: 0.3128349
	speed: 0.0425s/iter; left time: 418.8939s
	iters: 500, epoch: 2 | loss: 0.3983690
	speed: 0.0422s/iter; left time: 411.1407s
	iters: 600, epoch: 2 | loss: 0.4920727
	speed: 0.0422s/iter; left time: 407.2076s
	iters: 700, epoch: 2 | loss: 0.5328241
	speed: 0.0422s/iter; left time: 403.0875s
	iters: 800, epoch: 2 | loss: 0.2596064
	speed: 0.0422s/iter; left time: 398.5871s
	iters: 900, epoch: 2 | loss: 0.3126191
	speed: 0.0421s/iter; left time: 394.0873s
	iters: 1000, epoch: 2 | loss: 0.2492744
	speed: 0.0421s/iter; left time: 389.9298s
	iters: 1100, epoch: 2 | loss: 0.1919686
	speed: 0.0423s/iter; left time: 387.4772s
Epoch: 2 cost time: 48.216264486312866
Epoch: 2, Steps: 1139 | Train Loss: 0.3672580 Vali Loss: 0.6962572 Test Loss: 0.6537955
Validation loss decreased (0.711406 --> 0.696257).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2631502
	speed: 0.1409s/iter; left time: 1269.5460s
	iters: 200, epoch: 3 | loss: 0.2007898
	speed: 0.0440s/iter; left time: 392.5679s
	iters: 300, epoch: 3 | loss: 0.2385371
	speed: 0.0437s/iter; left time: 384.8434s
	iters: 400, epoch: 3 | loss: 0.2437452
	speed: 0.0437s/iter; left time: 380.7342s
	iters: 500, epoch: 3 | loss: 0.4370613
	speed: 0.0430s/iter; left time: 370.2474s
	iters: 600, epoch: 3 | loss: 0.1839326
	speed: 0.0423s/iter; left time: 360.4756s
	iters: 700, epoch: 3 | loss: 0.2167898
	speed: 0.0423s/iter; left time: 355.8660s
	iters: 800, epoch: 3 | loss: 0.2656156
	speed: 0.0425s/iter; left time: 353.4378s
	iters: 900, epoch: 3 | loss: 0.2367576
	speed: 0.0427s/iter; left time: 350.3241s
	iters: 1000, epoch: 3 | loss: 0.2642879
	speed: 0.0424s/iter; left time: 344.2029s
	iters: 1100, epoch: 3 | loss: 0.4290867
	speed: 0.0423s/iter; left time: 338.5579s
Epoch: 3 cost time: 48.89841175079346
Epoch: 3, Steps: 1139 | Train Loss: 0.2943045 Vali Loss: 0.6989429 Test Loss: 0.6429418
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1853522
	speed: 0.1359s/iter; left time: 1069.7208s
	iters: 200, epoch: 4 | loss: 0.4147246
	speed: 0.0423s/iter; left time: 328.8086s
	iters: 300, epoch: 4 | loss: 0.2632835
	speed: 0.0423s/iter; left time: 324.5981s
	iters: 400, epoch: 4 | loss: 0.2622637
	speed: 0.0424s/iter; left time: 321.4308s
	iters: 500, epoch: 4 | loss: 0.1895097
	speed: 0.0425s/iter; left time: 318.0046s
	iters: 600, epoch: 4 | loss: 0.2011609
	speed: 0.0422s/iter; left time: 310.9597s
	iters: 700, epoch: 4 | loss: 0.2509602
	speed: 0.0421s/iter; left time: 306.1713s
	iters: 800, epoch: 4 | loss: 0.1844032
	speed: 0.0421s/iter; left time: 302.1570s
	iters: 900, epoch: 4 | loss: 0.1843298
	speed: 0.0422s/iter; left time: 298.2855s
	iters: 1000, epoch: 4 | loss: 0.3683801
	speed: 0.0421s/iter; left time: 293.8704s
	iters: 1100, epoch: 4 | loss: 0.2147520
	speed: 0.0421s/iter; left time: 289.5301s
Epoch: 4 cost time: 48.11669874191284
Epoch: 4, Steps: 1139 | Train Loss: 0.2646465 Vali Loss: 0.7016706 Test Loss: 0.6766324
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1862424
	speed: 0.1378s/iter; left time: 928.0332s
	iters: 200, epoch: 5 | loss: 0.3755725
	speed: 0.0438s/iter; left time: 290.7692s
	iters: 300, epoch: 5 | loss: 0.1936231
	speed: 0.0440s/iter; left time: 287.2436s
	iters: 400, epoch: 5 | loss: 0.2338443
	speed: 0.0438s/iter; left time: 281.6224s
	iters: 500, epoch: 5 | loss: 0.2152753
	speed: 0.0440s/iter; left time: 278.5200s
	iters: 600, epoch: 5 | loss: 0.2155709
	speed: 0.0439s/iter; left time: 273.8185s
	iters: 700, epoch: 5 | loss: 0.2402713
	speed: 0.0426s/iter; left time: 261.4593s
	iters: 800, epoch: 5 | loss: 0.3718477
	speed: 0.0423s/iter; left time: 255.0187s
	iters: 900, epoch: 5 | loss: 0.2313089
	speed: 0.0423s/iter; left time: 251.1404s
	iters: 1000, epoch: 5 | loss: 0.2498624
	speed: 0.0423s/iter; left time: 246.5407s
	iters: 1100, epoch: 5 | loss: 0.2036695
	speed: 0.0424s/iter; left time: 243.2299s
Epoch: 5 cost time: 49.168193101882935
Epoch: 5, Steps: 1139 | Train Loss: 0.2513450 Vali Loss: 0.6946629 Test Loss: 0.6445721
Validation loss decreased (0.696257 --> 0.694663).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1988131
	speed: 0.1383s/iter; left time: 773.7888s
	iters: 200, epoch: 6 | loss: 0.1851635
	speed: 0.0425s/iter; left time: 233.5031s
	iters: 300, epoch: 6 | loss: 0.1539790
	speed: 0.0424s/iter; left time: 228.6303s
	iters: 400, epoch: 6 | loss: 0.1934557
	speed: 0.0427s/iter; left time: 226.1354s
	iters: 500, epoch: 6 | loss: 0.2554899
	speed: 0.0426s/iter; left time: 221.3412s
	iters: 600, epoch: 6 | loss: 0.1681536
	speed: 0.0424s/iter; left time: 216.0021s
	iters: 700, epoch: 6 | loss: 0.1629171
	speed: 0.0423s/iter; left time: 211.3846s
	iters: 800, epoch: 6 | loss: 0.1924817
	speed: 0.0424s/iter; left time: 207.6484s
	iters: 900, epoch: 6 | loss: 0.2085356
	speed: 0.0425s/iter; left time: 204.0264s
	iters: 1000, epoch: 6 | loss: 0.1638240
	speed: 0.0426s/iter; left time: 199.8961s
	iters: 1100, epoch: 6 | loss: 0.1768277
	speed: 0.0425s/iter; left time: 195.3241s
Epoch: 6 cost time: 48.37957215309143
Epoch: 6, Steps: 1139 | Train Loss: 0.2448623 Vali Loss: 0.6941375 Test Loss: 0.6531416
Validation loss decreased (0.694663 --> 0.694137).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1880232
	speed: 0.1381s/iter; left time: 615.7037s
	iters: 200, epoch: 7 | loss: 0.2402008
	speed: 0.0434s/iter; left time: 189.3056s
	iters: 300, epoch: 7 | loss: 0.1712511
	speed: 0.0436s/iter; left time: 185.5870s
	iters: 400, epoch: 7 | loss: 0.3227244
	speed: 0.0435s/iter; left time: 180.6385s
	iters: 500, epoch: 7 | loss: 0.1451029
	speed: 0.0435s/iter; left time: 176.4314s
	iters: 600, epoch: 7 | loss: 0.3393556
	speed: 0.0435s/iter; left time: 171.9560s
	iters: 700, epoch: 7 | loss: 0.3334566
	speed: 0.0435s/iter; left time: 167.9123s
	iters: 800, epoch: 7 | loss: 0.2095581
	speed: 0.0432s/iter; left time: 162.2338s
	iters: 900, epoch: 7 | loss: 0.1679896
	speed: 0.0424s/iter; left time: 155.2133s
	iters: 1000, epoch: 7 | loss: 0.1320913
	speed: 0.0426s/iter; left time: 151.4683s
	iters: 1100, epoch: 7 | loss: 0.1591803
	speed: 0.0426s/iter; left time: 147.4352s
Epoch: 7 cost time: 49.10916614532471
Epoch: 7, Steps: 1139 | Train Loss: 0.2417981 Vali Loss: 0.6965115 Test Loss: 0.6483429
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1606538
	speed: 0.1366s/iter; left time: 453.1131s
	iters: 200, epoch: 8 | loss: 0.3623043
	speed: 0.0425s/iter; left time: 136.6045s
	iters: 300, epoch: 8 | loss: 0.1759844
	speed: 0.0423s/iter; left time: 131.8563s
	iters: 400, epoch: 8 | loss: 0.1626701
	speed: 0.0424s/iter; left time: 127.9534s
	iters: 500, epoch: 8 | loss: 0.3950548
	speed: 0.0426s/iter; left time: 124.3981s
	iters: 600, epoch: 8 | loss: 0.2541720
	speed: 0.0427s/iter; left time: 120.2938s
	iters: 700, epoch: 8 | loss: 0.2307703
	speed: 0.0425s/iter; left time: 115.4500s
	iters: 800, epoch: 8 | loss: 0.1614215
	speed: 0.0423s/iter; left time: 110.8437s
	iters: 900, epoch: 8 | loss: 0.1944579
	speed: 0.0423s/iter; left time: 106.3990s
	iters: 1000, epoch: 8 | loss: 0.2536761
	speed: 0.0423s/iter; left time: 102.1938s
	iters: 1100, epoch: 8 | loss: 0.1871163
	speed: 0.0422s/iter; left time: 97.8018s
Epoch: 8 cost time: 48.32661747932434
Epoch: 8, Steps: 1139 | Train Loss: 0.2401193 Vali Loss: 0.6903262 Test Loss: 0.6502761
Validation loss decreased (0.694137 --> 0.690326).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2463553
	speed: 0.1382s/iter; left time: 301.1373s
	iters: 200, epoch: 9 | loss: 0.1791144
	speed: 0.0421s/iter; left time: 87.6197s
	iters: 300, epoch: 9 | loss: 0.2151151
	speed: 0.0430s/iter; left time: 85.1234s
	iters: 400, epoch: 9 | loss: 0.4052018
	speed: 0.0437s/iter; left time: 82.1835s
	iters: 500, epoch: 9 | loss: 0.2079479
	speed: 0.0437s/iter; left time: 77.8215s
	iters: 600, epoch: 9 | loss: 0.1838886
	speed: 0.0438s/iter; left time: 73.4808s
	iters: 700, epoch: 9 | loss: 0.3526233
	speed: 0.0437s/iter; left time: 69.0017s
	iters: 800, epoch: 9 | loss: 0.1660044
	speed: 0.0437s/iter; left time: 64.6166s
	iters: 900, epoch: 9 | loss: 0.1938399
	speed: 0.0430s/iter; left time: 59.2584s
	iters: 1000, epoch: 9 | loss: 0.2005240
	speed: 0.0429s/iter; left time: 54.8110s
	iters: 1100, epoch: 9 | loss: 0.2039021
	speed: 0.0425s/iter; left time: 50.1562s
Epoch: 9 cost time: 49.088497161865234
Epoch: 9, Steps: 1139 | Train Loss: 0.2394778 Vali Loss: 0.6988250 Test Loss: 0.6623599
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1631701
	speed: 0.1362s/iter; left time: 141.6441s
	iters: 200, epoch: 10 | loss: 0.1459448
	speed: 0.0427s/iter; left time: 40.1274s
	iters: 300, epoch: 10 | loss: 0.2039645
	speed: 0.0423s/iter; left time: 35.5104s
	iters: 400, epoch: 10 | loss: 0.1538726
	speed: 0.0422s/iter; left time: 31.2598s
	iters: 500, epoch: 10 | loss: 0.3856811
	speed: 0.0421s/iter; left time: 26.9535s
	iters: 600, epoch: 10 | loss: 0.2493523
	speed: 0.0421s/iter; left time: 22.7603s
	iters: 700, epoch: 10 | loss: 0.1989299
	speed: 0.0422s/iter; left time: 18.5698s
	iters: 800, epoch: 10 | loss: 0.2196590
	speed: 0.0423s/iter; left time: 14.3832s
	iters: 900, epoch: 10 | loss: 0.1984022
	speed: 0.0422s/iter; left time: 10.1328s
	iters: 1000, epoch: 10 | loss: 0.1560946
	speed: 0.0422s/iter; left time: 5.9149s
	iters: 1100, epoch: 10 | loss: 0.1559556
	speed: 0.0422s/iter; left time: 1.6877s
Epoch: 10 cost time: 48.15910458564758
Epoch: 10, Steps: 1139 | Train Loss: 0.2390625 Vali Loss: 0.6949266 Test Loss: 0.6629366
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : weather_336_Informer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed25565<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10204
mse:0.6504546999931335, mae:0.575876772403717
