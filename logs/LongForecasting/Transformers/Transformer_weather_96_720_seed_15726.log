Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=21, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=21, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Transformer', model_id='weather_720', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=720, root_path='./dataset/', seed=15726, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_720_Transformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed15726>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36072
val 4551
test 9820
	iters: 100, epoch: 1 | loss: 0.5493004
	speed: 0.1247s/iter; left time: 1393.5215s
	iters: 200, epoch: 1 | loss: 0.4633962
	speed: 0.0930s/iter; left time: 1030.1024s
	iters: 300, epoch: 1 | loss: 0.5290536
	speed: 0.0932s/iter; left time: 1022.3415s
	iters: 400, epoch: 1 | loss: 0.4018148
	speed: 0.0932s/iter; left time: 1013.5312s
	iters: 500, epoch: 1 | loss: 0.5330446
	speed: 0.0931s/iter; left time: 1002.8806s
	iters: 600, epoch: 1 | loss: 0.3489563
	speed: 0.0930s/iter; left time: 992.5081s
	iters: 700, epoch: 1 | loss: 0.3687906
	speed: 0.0933s/iter; left time: 986.1521s
	iters: 800, epoch: 1 | loss: 0.3306109
	speed: 0.0934s/iter; left time: 978.3669s
	iters: 900, epoch: 1 | loss: 0.2905880
	speed: 0.0938s/iter; left time: 972.3241s
	iters: 1000, epoch: 1 | loss: 0.3281083
	speed: 0.0938s/iter; left time: 963.7885s
	iters: 1100, epoch: 1 | loss: 0.4419568
	speed: 0.0937s/iter; left time: 953.2955s
Epoch: 1 cost time: 108.37243819236755
Epoch: 1, Steps: 1127 | Train Loss: 0.4735831 Vali Loss: 0.8345834 Test Loss: 0.8243892
Validation loss decreased (inf --> 0.834583).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2782729
	speed: 0.2850s/iter; left time: 2862.6610s
	iters: 200, epoch: 2 | loss: 0.2329917
	speed: 0.0932s/iter; left time: 926.6191s
	iters: 300, epoch: 2 | loss: 0.2556205
	speed: 0.0933s/iter; left time: 918.3323s
	iters: 400, epoch: 2 | loss: 0.2382975
	speed: 0.0931s/iter; left time: 907.1143s
	iters: 500, epoch: 2 | loss: 0.3294061
	speed: 0.0932s/iter; left time: 899.0675s
	iters: 600, epoch: 2 | loss: 0.2269536
	speed: 0.0932s/iter; left time: 889.7907s
	iters: 700, epoch: 2 | loss: 0.2558645
	speed: 0.0932s/iter; left time: 880.1407s
	iters: 800, epoch: 2 | loss: 0.2935572
	speed: 0.0934s/iter; left time: 872.4549s
	iters: 900, epoch: 2 | loss: 0.2321883
	speed: 0.0936s/iter; left time: 864.9614s
	iters: 1000, epoch: 2 | loss: 0.2156724
	speed: 0.0935s/iter; left time: 855.0799s
	iters: 1100, epoch: 2 | loss: 0.3959207
	speed: 0.0936s/iter; left time: 846.7426s
Epoch: 2 cost time: 105.11632513999939
Epoch: 2, Steps: 1127 | Train Loss: 0.3224228 Vali Loss: 0.9016736 Test Loss: 1.0280018
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3025960
	speed: 0.2810s/iter; left time: 2506.1004s
	iters: 200, epoch: 3 | loss: 0.1846037
	speed: 0.0929s/iter; left time: 819.2805s
	iters: 300, epoch: 3 | loss: 0.3741083
	speed: 0.0930s/iter; left time: 810.8137s
	iters: 400, epoch: 3 | loss: 0.1802488
	speed: 0.0930s/iter; left time: 801.2350s
	iters: 500, epoch: 3 | loss: 0.2074570
	speed: 0.0930s/iter; left time: 791.6821s
	iters: 600, epoch: 3 | loss: 0.2524596
	speed: 0.0930s/iter; left time: 782.9487s
	iters: 700, epoch: 3 | loss: 0.2739683
	speed: 0.0930s/iter; left time: 773.2396s
	iters: 800, epoch: 3 | loss: 0.2124158
	speed: 0.0932s/iter; left time: 765.8023s
	iters: 900, epoch: 3 | loss: 0.2353708
	speed: 0.0935s/iter; left time: 758.7994s
	iters: 1000, epoch: 3 | loss: 0.1955689
	speed: 0.0935s/iter; left time: 749.6833s
	iters: 1100, epoch: 3 | loss: 0.3021543
	speed: 0.0935s/iter; left time: 740.2925s
Epoch: 3 cost time: 104.90807723999023
Epoch: 3, Steps: 1127 | Train Loss: 0.2549865 Vali Loss: 0.8931745 Test Loss: 1.0125657
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2587792
	speed: 0.2800s/iter; left time: 2181.5236s
	iters: 200, epoch: 4 | loss: 0.2532387
	speed: 0.0930s/iter; left time: 715.5363s
	iters: 300, epoch: 4 | loss: 0.1724097
	speed: 0.0932s/iter; left time: 707.0869s
	iters: 400, epoch: 4 | loss: 0.2594965
	speed: 0.0931s/iter; left time: 697.6328s
	iters: 500, epoch: 4 | loss: 0.2443456
	speed: 0.0930s/iter; left time: 687.4766s
	iters: 600, epoch: 4 | loss: 0.3096100
	speed: 0.0931s/iter; left time: 678.4340s
	iters: 700, epoch: 4 | loss: 0.2125216
	speed: 0.0931s/iter; left time: 669.0404s
	iters: 800, epoch: 4 | loss: 0.2667817
	speed: 0.0933s/iter; left time: 661.7592s
	iters: 900, epoch: 4 | loss: 0.2470531
	speed: 0.0936s/iter; left time: 654.1864s
	iters: 1000, epoch: 4 | loss: 0.3282585
	speed: 0.0935s/iter; left time: 644.4165s
	iters: 1100, epoch: 4 | loss: 0.1881827
	speed: 0.0933s/iter; left time: 633.6823s
Epoch: 4 cost time: 104.97433686256409
Epoch: 4, Steps: 1127 | Train Loss: 0.2318977 Vali Loss: 0.8891404 Test Loss: 0.9674398
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : weather_720_Transformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed15726<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9820
mse:0.8242442011833191, mae:0.6631757020950317
