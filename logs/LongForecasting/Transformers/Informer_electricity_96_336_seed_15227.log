Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=321, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', dec_in=321, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Informer', model_id='electricity_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=336, root_path='./dataset/', seed=15227, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : electricity_336_Informer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed15227>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17981
val 2297
test 4925
	iters: 100, epoch: 1 | loss: 0.8287622
	speed: 0.0918s/iter; left time: 505.8652s
	iters: 200, epoch: 1 | loss: 0.7437659
	speed: 0.0593s/iter; left time: 320.8071s
	iters: 300, epoch: 1 | loss: 0.7527592
	speed: 0.0591s/iter; left time: 313.6829s
	iters: 400, epoch: 1 | loss: 0.7167869
	speed: 0.0584s/iter; left time: 304.4405s
	iters: 500, epoch: 1 | loss: 0.6870481
	speed: 0.0577s/iter; left time: 294.7394s
Epoch: 1 cost time: 36.165804862976074
Epoch: 1, Steps: 561 | Train Loss: 0.7595478 Vali Loss: 0.6561527 Test Loss: 0.8237218
Validation loss decreased (inf --> 0.656153).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5253717
	speed: 0.1898s/iter; left time: 939.7501s
	iters: 200, epoch: 2 | loss: 0.5290207
	speed: 0.0577s/iter; left time: 279.9104s
	iters: 300, epoch: 2 | loss: 0.3269316
	speed: 0.0577s/iter; left time: 274.1021s
	iters: 400, epoch: 2 | loss: 0.2708758
	speed: 0.0576s/iter; left time: 267.9100s
	iters: 500, epoch: 2 | loss: 0.2593042
	speed: 0.0579s/iter; left time: 263.2309s
Epoch: 2 cost time: 32.383458852767944
Epoch: 2, Steps: 561 | Train Loss: 0.4019821 Vali Loss: 0.2920659 Test Loss: 0.3729627
Validation loss decreased (0.656153 --> 0.292066).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2209460
	speed: 0.1908s/iter; left time: 837.5919s
	iters: 200, epoch: 3 | loss: 0.2481504
	speed: 0.0579s/iter; left time: 248.1483s
	iters: 300, epoch: 3 | loss: 0.2165039
	speed: 0.0577s/iter; left time: 241.5549s
	iters: 400, epoch: 3 | loss: 0.2058976
	speed: 0.0576s/iter; left time: 235.5524s
	iters: 500, epoch: 3 | loss: 0.2055998
	speed: 0.0584s/iter; left time: 233.0151s
Epoch: 3 cost time: 32.53924083709717
Epoch: 3, Steps: 561 | Train Loss: 0.2233626 Vali Loss: 0.2811510 Test Loss: 0.3567818
Validation loss decreased (0.292066 --> 0.281151).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2028875
	speed: 0.1944s/iter; left time: 744.0568s
	iters: 200, epoch: 4 | loss: 0.2061228
	speed: 0.0591s/iter; left time: 220.2022s
	iters: 300, epoch: 4 | loss: 0.1995066
	speed: 0.0581s/iter; left time: 210.6720s
	iters: 400, epoch: 4 | loss: 0.2097348
	speed: 0.0578s/iter; left time: 203.8483s
	iters: 500, epoch: 4 | loss: 0.1977589
	speed: 0.0579s/iter; left time: 198.4199s
Epoch: 4 cost time: 32.711164474487305
Epoch: 4, Steps: 561 | Train Loss: 0.2047649 Vali Loss: 0.2772330 Test Loss: 0.3524665
Validation loss decreased (0.281151 --> 0.277233).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1959083
	speed: 0.1907s/iter; left time: 622.9261s
	iters: 200, epoch: 5 | loss: 0.1937605
	speed: 0.0576s/iter; left time: 182.4101s
	iters: 300, epoch: 5 | loss: 0.1958298
	speed: 0.0577s/iter; left time: 176.8647s
	iters: 400, epoch: 5 | loss: 0.2121957
	speed: 0.0578s/iter; left time: 171.4852s
	iters: 500, epoch: 5 | loss: 0.1961850
	speed: 0.0579s/iter; left time: 165.9110s
Epoch: 5 cost time: 32.38941550254822
Epoch: 5, Steps: 561 | Train Loss: 0.1975943 Vali Loss: 0.2730854 Test Loss: 0.3530280
Validation loss decreased (0.277233 --> 0.273085).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1986014
	speed: 0.1902s/iter; left time: 514.5871s
	iters: 200, epoch: 6 | loss: 0.1976998
	speed: 0.0577s/iter; left time: 150.3828s
	iters: 300, epoch: 6 | loss: 0.1879956
	speed: 0.0576s/iter; left time: 144.3092s
	iters: 400, epoch: 6 | loss: 0.1926198
	speed: 0.0590s/iter; left time: 141.9851s
	iters: 500, epoch: 6 | loss: 0.2020951
	speed: 0.0587s/iter; left time: 135.3655s
Epoch: 6 cost time: 32.6605429649353
Epoch: 6, Steps: 561 | Train Loss: 0.1941167 Vali Loss: 0.2753136 Test Loss: 0.3541917
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2107569
	speed: 0.1904s/iter; left time: 408.3273s
	iters: 200, epoch: 7 | loss: 0.1910060
	speed: 0.0576s/iter; left time: 117.7321s
	iters: 300, epoch: 7 | loss: 0.1974421
	speed: 0.0578s/iter; left time: 112.3816s
	iters: 400, epoch: 7 | loss: 0.1978041
	speed: 0.0577s/iter; left time: 106.4165s
	iters: 500, epoch: 7 | loss: 0.1876147
	speed: 0.0577s/iter; left time: 100.6238s
Epoch: 7 cost time: 32.47906017303467
Epoch: 7, Steps: 561 | Train Loss: 0.1923851 Vali Loss: 0.2720872 Test Loss: 0.3519372
Validation loss decreased (0.273085 --> 0.272087).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1869457
	speed: 0.1904s/iter; left time: 301.5422s
	iters: 200, epoch: 8 | loss: 0.1819492
	speed: 0.0577s/iter; left time: 85.6800s
	iters: 300, epoch: 8 | loss: 0.1958698
	speed: 0.0577s/iter; left time: 79.8540s
	iters: 400, epoch: 8 | loss: 0.1859028
	speed: 0.0578s/iter; left time: 74.1653s
	iters: 500, epoch: 8 | loss: 0.2025254
	speed: 0.0578s/iter; left time: 68.3901s
Epoch: 8 cost time: 32.406744718551636
Epoch: 8, Steps: 561 | Train Loss: 0.1913575 Vali Loss: 0.2720609 Test Loss: 0.3537175
Validation loss decreased (0.272087 --> 0.272061).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1845742
	speed: 0.1903s/iter; left time: 194.7051s
	iters: 200, epoch: 9 | loss: 0.1945308
	speed: 0.0576s/iter; left time: 53.1402s
	iters: 300, epoch: 9 | loss: 0.1883983
	speed: 0.0595s/iter; left time: 49.0025s
	iters: 400, epoch: 9 | loss: 0.1910639
	speed: 0.0596s/iter; left time: 43.0750s
	iters: 500, epoch: 9 | loss: 0.1867198
	speed: 0.0597s/iter; left time: 37.2162s
Epoch: 9 cost time: 33.040690183639526
Epoch: 9, Steps: 561 | Train Loss: 0.1908693 Vali Loss: 0.2705247 Test Loss: 0.3505738
Validation loss decreased (0.272061 --> 0.270525).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1862122
	speed: 0.1928s/iter; left time: 89.0852s
	iters: 200, epoch: 10 | loss: 0.2007629
	speed: 0.0577s/iter; left time: 20.9051s
	iters: 300, epoch: 10 | loss: 0.1857001
	speed: 0.0576s/iter; left time: 15.0972s
	iters: 400, epoch: 10 | loss: 0.1914838
	speed: 0.0579s/iter; left time: 9.3769s
	iters: 500, epoch: 10 | loss: 0.1880902
	speed: 0.0579s/iter; left time: 3.5921s
Epoch: 10 cost time: 32.4390389919281
Epoch: 10, Steps: 561 | Train Loss: 0.1906121 Vali Loss: 0.2721942 Test Loss: 0.3521156
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : electricity_336_Informer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed15227<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4925
mse:0.35046300292015076, mae:0.43163174390792847
