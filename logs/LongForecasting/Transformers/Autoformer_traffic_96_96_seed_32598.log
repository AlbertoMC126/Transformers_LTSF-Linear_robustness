Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=862, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=862, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Autoformer', model_id='traffic_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=96, root_path='./dataset/', seed=32598, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_96_Autoformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed32598>>>>>>>>>>>>>>>>>>>>>>>>>>
train 12089
val 1661
test 3413
	iters: 100, epoch: 1 | loss: 0.4223247
	speed: 0.0981s/iter; left time: 360.1553s
	iters: 200, epoch: 1 | loss: 0.3020062
	speed: 0.0644s/iter; left time: 229.9136s
	iters: 300, epoch: 1 | loss: 0.3024638
	speed: 0.0644s/iter; left time: 223.4996s
Epoch: 1 cost time: 27.618072748184204
Epoch: 1, Steps: 377 | Train Loss: 0.3753826 Vali Loss: 0.4933187 Test Loss: 0.6159570
Validation loss decreased (inf --> 0.493319).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2699721
	speed: 0.2109s/iter; left time: 694.7220s
	iters: 200, epoch: 2 | loss: 0.2520945
	speed: 0.0639s/iter; left time: 204.2137s
	iters: 300, epoch: 2 | loss: 0.2237855
	speed: 0.0636s/iter; left time: 196.8526s
Epoch: 2 cost time: 24.07530689239502
Epoch: 2, Steps: 377 | Train Loss: 0.2543581 Vali Loss: 0.4734406 Test Loss: 0.6111921
Validation loss decreased (0.493319 --> 0.473441).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2382454
	speed: 0.2102s/iter; left time: 613.1534s
	iters: 200, epoch: 3 | loss: 0.2299720
	speed: 0.0636s/iter; left time: 179.1100s
	iters: 300, epoch: 3 | loss: 0.2353478
	speed: 0.0635s/iter; left time: 172.6032s
Epoch: 3 cost time: 24.024896383285522
Epoch: 3, Steps: 377 | Train Loss: 0.2307595 Vali Loss: 0.4684898 Test Loss: 0.6775582
Validation loss decreased (0.473441 --> 0.468490).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2340004
	speed: 0.2102s/iter; left time: 534.0012s
	iters: 200, epoch: 4 | loss: 0.2252886
	speed: 0.0639s/iter; left time: 156.0332s
	iters: 300, epoch: 4 | loss: 0.2220828
	speed: 0.0641s/iter; left time: 149.9715s
Epoch: 4 cost time: 24.102314710617065
Epoch: 4, Steps: 377 | Train Loss: 0.2213003 Vali Loss: 0.4656467 Test Loss: 0.6623349
Validation loss decreased (0.468490 --> 0.465647).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2362753
	speed: 0.2111s/iter; left time: 456.5583s
	iters: 200, epoch: 5 | loss: 0.2147923
	speed: 0.0639s/iter; left time: 131.7366s
	iters: 300, epoch: 5 | loss: 0.2253690
	speed: 0.0648s/iter; left time: 127.2992s
Epoch: 5 cost time: 24.29689884185791
Epoch: 5, Steps: 377 | Train Loss: 0.2169379 Vali Loss: 0.4633834 Test Loss: 0.6554391
Validation loss decreased (0.465647 --> 0.463383).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2156879
	speed: 0.2108s/iter; left time: 376.4877s
	iters: 200, epoch: 6 | loss: 0.2245948
	speed: 0.0644s/iter; left time: 108.5150s
	iters: 300, epoch: 6 | loss: 0.2103878
	speed: 0.0644s/iter; left time: 102.1357s
Epoch: 6 cost time: 24.21581196784973
Epoch: 6, Steps: 377 | Train Loss: 0.2146254 Vali Loss: 0.4643513 Test Loss: 0.6853239
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2245446
	speed: 0.2073s/iter; left time: 292.0949s
	iters: 200, epoch: 7 | loss: 0.2173431
	speed: 0.0643s/iter; left time: 84.1834s
	iters: 300, epoch: 7 | loss: 0.2140151
	speed: 0.0637s/iter; left time: 76.9867s
Epoch: 7 cost time: 24.08637571334839
Epoch: 7, Steps: 377 | Train Loss: 0.2134193 Vali Loss: 0.4621929 Test Loss: 0.6572207
Validation loss decreased (0.463383 --> 0.462193).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2032136
	speed: 0.2102s/iter; left time: 216.9531s
	iters: 200, epoch: 8 | loss: 0.2265337
	speed: 0.0636s/iter; left time: 59.2366s
	iters: 300, epoch: 8 | loss: 0.2271870
	speed: 0.0644s/iter; left time: 53.5691s
Epoch: 8 cost time: 24.062995195388794
Epoch: 8, Steps: 377 | Train Loss: 0.2126964 Vali Loss: 0.4630483 Test Loss: 0.6703367
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2209963
	speed: 0.2067s/iter; left time: 135.3581s
	iters: 200, epoch: 9 | loss: 0.2030745
	speed: 0.0642s/iter; left time: 35.6345s
	iters: 300, epoch: 9 | loss: 0.2116697
	speed: 0.0652s/iter; left time: 29.6489s
Epoch: 9 cost time: 24.466936588287354
Epoch: 9, Steps: 377 | Train Loss: 0.2124085 Vali Loss: 0.4633867 Test Loss: 0.6718948
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2222525
	speed: 0.2109s/iter; left time: 58.6164s
	iters: 200, epoch: 10 | loss: 0.2304196
	speed: 0.0654s/iter; left time: 11.6483s
	iters: 300, epoch: 10 | loss: 0.2095004
	speed: 0.0648s/iter; left time: 5.0553s
Epoch: 10 cost time: 24.563117742538452
Epoch: 10, Steps: 377 | Train Loss: 0.2121995 Vali Loss: 0.4642784 Test Loss: 0.6768169
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : traffic_96_Autoformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed32598<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3413
mse:0.6572243571281433, mae:0.420998215675354
