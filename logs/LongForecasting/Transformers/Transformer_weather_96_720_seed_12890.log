Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=21, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=21, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Transformer', model_id='weather_720', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=720, root_path='./dataset/', seed=12890, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_720_Transformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed12890>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36072
val 4551
test 9820
	iters: 100, epoch: 1 | loss: 0.8417103
	speed: 0.1289s/iter; left time: 1440.0815s
	iters: 200, epoch: 1 | loss: 0.5688921
	speed: 0.0957s/iter; left time: 1059.8712s
	iters: 300, epoch: 1 | loss: 0.4163343
	speed: 0.0957s/iter; left time: 1050.0655s
	iters: 400, epoch: 1 | loss: 0.3126631
	speed: 0.0957s/iter; left time: 1039.9024s
	iters: 500, epoch: 1 | loss: 0.3628331
	speed: 0.0957s/iter; left time: 1030.5444s
	iters: 600, epoch: 1 | loss: 0.4987588
	speed: 0.0957s/iter; left time: 1021.3021s
	iters: 700, epoch: 1 | loss: 0.4863380
	speed: 0.0955s/iter; left time: 1009.9722s
	iters: 800, epoch: 1 | loss: 0.2726013
	speed: 0.0954s/iter; left time: 998.9481s
	iters: 900, epoch: 1 | loss: 0.3239708
	speed: 0.0957s/iter; left time: 992.1140s
	iters: 1000, epoch: 1 | loss: 0.7808654
	speed: 0.0956s/iter; left time: 981.9407s
	iters: 1100, epoch: 1 | loss: 0.2998913
	speed: 0.0958s/iter; left time: 973.9186s
Epoch: 1 cost time: 111.12908053398132
Epoch: 1, Steps: 1127 | Train Loss: 0.4724538 Vali Loss: 0.9233014 Test Loss: 1.1431445
Validation loss decreased (inf --> 0.923301).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4065413
	speed: 0.3008s/iter; left time: 3020.7866s
	iters: 200, epoch: 2 | loss: 0.2700711
	speed: 0.0957s/iter; left time: 951.5834s
	iters: 300, epoch: 2 | loss: 0.3242769
	speed: 0.0957s/iter; left time: 942.0081s
	iters: 400, epoch: 2 | loss: 0.3800425
	speed: 0.0959s/iter; left time: 934.1710s
	iters: 500, epoch: 2 | loss: 0.2795088
	speed: 0.0958s/iter; left time: 924.3562s
	iters: 600, epoch: 2 | loss: 0.3284351
	speed: 0.0956s/iter; left time: 912.7390s
	iters: 700, epoch: 2 | loss: 0.2616900
	speed: 0.0953s/iter; left time: 900.4207s
	iters: 800, epoch: 2 | loss: 0.2959769
	speed: 0.0956s/iter; left time: 893.2953s
	iters: 900, epoch: 2 | loss: 0.2462033
	speed: 0.0955s/iter; left time: 882.8657s
	iters: 1000, epoch: 2 | loss: 0.3072465
	speed: 0.0957s/iter; left time: 874.8821s
	iters: 1100, epoch: 2 | loss: 0.2199262
	speed: 0.0958s/iter; left time: 866.3976s
Epoch: 2 cost time: 107.79550457000732
Epoch: 2, Steps: 1127 | Train Loss: 0.3260141 Vali Loss: 0.9160982 Test Loss: 1.0731603
Validation loss decreased (0.923301 --> 0.916098).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3549628
	speed: 0.3005s/iter; left time: 2679.7449s
	iters: 200, epoch: 3 | loss: 0.2560013
	speed: 0.0958s/iter; left time: 844.6283s
	iters: 300, epoch: 3 | loss: 0.3461285
	speed: 0.0959s/iter; left time: 836.3808s
	iters: 400, epoch: 3 | loss: 0.3750802
	speed: 0.0959s/iter; left time: 826.3390s
	iters: 500, epoch: 3 | loss: 0.2758870
	speed: 0.0959s/iter; left time: 817.0472s
	iters: 600, epoch: 3 | loss: 0.2222037
	speed: 0.0960s/iter; left time: 808.2202s
	iters: 700, epoch: 3 | loss: 0.1984458
	speed: 0.0958s/iter; left time: 797.0685s
	iters: 800, epoch: 3 | loss: 0.2004101
	speed: 0.0960s/iter; left time: 788.6002s
	iters: 900, epoch: 3 | loss: 0.2868642
	speed: 0.0960s/iter; left time: 779.5786s
	iters: 1000, epoch: 3 | loss: 0.2572351
	speed: 0.0961s/iter; left time: 770.2153s
	iters: 1100, epoch: 3 | loss: 0.2523550
	speed: 0.0960s/iter; left time: 760.0902s
Epoch: 3 cost time: 108.08564066886902
Epoch: 3, Steps: 1127 | Train Loss: 0.2580180 Vali Loss: 0.9394690 Test Loss: 1.1126757
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3532601
	speed: 0.2987s/iter; left time: 2327.1318s
	iters: 200, epoch: 4 | loss: 0.2680747
	speed: 0.0963s/iter; left time: 740.6736s
	iters: 300, epoch: 4 | loss: 0.1487826
	speed: 0.0963s/iter; left time: 730.8054s
	iters: 400, epoch: 4 | loss: 0.1730611
	speed: 0.0962s/iter; left time: 720.7301s
	iters: 500, epoch: 4 | loss: 0.1694276
	speed: 0.0963s/iter; left time: 711.5247s
	iters: 600, epoch: 4 | loss: 0.2493921
	speed: 0.0961s/iter; left time: 700.9272s
	iters: 700, epoch: 4 | loss: 0.1574777
	speed: 0.0962s/iter; left time: 691.3631s
	iters: 800, epoch: 4 | loss: 0.2740667
	speed: 0.0962s/iter; left time: 682.0246s
	iters: 900, epoch: 4 | loss: 0.1818343
	speed: 0.0961s/iter; left time: 671.9722s
	iters: 1000, epoch: 4 | loss: 0.1844902
	speed: 0.0961s/iter; left time: 662.4066s
	iters: 1100, epoch: 4 | loss: 0.3533932
	speed: 0.0961s/iter; left time: 652.6921s
Epoch: 4 cost time: 108.37911343574524
Epoch: 4, Steps: 1127 | Train Loss: 0.2352611 Vali Loss: 0.9148567 Test Loss: 1.0534770
Validation loss decreased (0.916098 --> 0.914857).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2117284
	speed: 0.3006s/iter; left time: 2002.7560s
	iters: 200, epoch: 5 | loss: 0.1509507
	speed: 0.0959s/iter; left time: 629.5740s
	iters: 300, epoch: 5 | loss: 0.1952429
	speed: 0.0960s/iter; left time: 620.2813s
	iters: 400, epoch: 5 | loss: 0.2754461
	speed: 0.0959s/iter; left time: 609.9176s
	iters: 500, epoch: 5 | loss: 0.1592298
	speed: 0.0957s/iter; left time: 599.3676s
	iters: 600, epoch: 5 | loss: 0.2224241
	speed: 0.0956s/iter; left time: 589.2560s
	iters: 700, epoch: 5 | loss: 0.2399621
	speed: 0.0957s/iter; left time: 580.4298s
	iters: 800, epoch: 5 | loss: 0.1717829
	speed: 0.0958s/iter; left time: 571.5167s
	iters: 900, epoch: 5 | loss: 0.2388586
	speed: 0.0958s/iter; left time: 561.7584s
	iters: 1000, epoch: 5 | loss: 0.3090820
	speed: 0.0959s/iter; left time: 552.7849s
	iters: 1100, epoch: 5 | loss: 0.1585464
	speed: 0.0958s/iter; left time: 542.4618s
Epoch: 5 cost time: 107.9464430809021
Epoch: 5, Steps: 1127 | Train Loss: 0.2253836 Vali Loss: 0.9092916 Test Loss: 1.0636123
Validation loss decreased (0.914857 --> 0.909292).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1476541
	speed: 0.2987s/iter; left time: 1653.5720s
	iters: 200, epoch: 6 | loss: 0.2507334
	speed: 0.0961s/iter; left time: 522.3306s
	iters: 300, epoch: 6 | loss: 0.1927088
	speed: 0.0960s/iter; left time: 512.2920s
	iters: 400, epoch: 6 | loss: 0.1694662
	speed: 0.0961s/iter; left time: 502.9844s
	iters: 500, epoch: 6 | loss: 0.1689076
	speed: 0.0960s/iter; left time: 493.0668s
	iters: 600, epoch: 6 | loss: 0.3151327
	speed: 0.0959s/iter; left time: 482.8024s
	iters: 700, epoch: 6 | loss: 0.1307096
	speed: 0.0962s/iter; left time: 474.6448s
	iters: 800, epoch: 6 | loss: 0.2717793
	speed: 0.0963s/iter; left time: 465.7574s
	iters: 900, epoch: 6 | loss: 0.2291311
	speed: 0.0964s/iter; left time: 456.3684s
	iters: 1000, epoch: 6 | loss: 0.2392612
	speed: 0.0962s/iter; left time: 445.9267s
	iters: 1100, epoch: 6 | loss: 0.2207994
	speed: 0.0964s/iter; left time: 437.1537s
Epoch: 6 cost time: 108.28924322128296
Epoch: 6, Steps: 1127 | Train Loss: 0.2203441 Vali Loss: 0.9043781 Test Loss: 1.0650166
Validation loss decreased (0.909292 --> 0.904378).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2336998
	speed: 0.3018s/iter; left time: 1330.7691s
	iters: 200, epoch: 7 | loss: 0.2632494
	speed: 0.0963s/iter; left time: 414.9206s
	iters: 300, epoch: 7 | loss: 0.1622552
	speed: 0.0960s/iter; left time: 404.0983s
	iters: 400, epoch: 7 | loss: 0.3279708
	speed: 0.0961s/iter; left time: 395.0548s
	iters: 500, epoch: 7 | loss: 0.1529290
	speed: 0.0960s/iter; left time: 384.7022s
	iters: 600, epoch: 7 | loss: 0.2622276
	speed: 0.0960s/iter; left time: 375.2105s
	iters: 700, epoch: 7 | loss: 0.1474121
	speed: 0.0960s/iter; left time: 365.4927s
	iters: 800, epoch: 7 | loss: 0.2224951
	speed: 0.0960s/iter; left time: 356.0766s
	iters: 900, epoch: 7 | loss: 0.1810606
	speed: 0.0962s/iter; left time: 347.2455s
	iters: 1000, epoch: 7 | loss: 0.1243491
	speed: 0.0959s/iter; left time: 336.5461s
	iters: 1100, epoch: 7 | loss: 0.2633877
	speed: 0.0959s/iter; left time: 326.8849s
Epoch: 7 cost time: 108.19736361503601
Epoch: 7, Steps: 1127 | Train Loss: 0.2178053 Vali Loss: 0.9072037 Test Loss: 1.0618817
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3363607
	speed: 0.2982s/iter; left time: 978.7989s
	iters: 200, epoch: 8 | loss: 0.2483443
	speed: 0.0961s/iter; left time: 305.6852s
	iters: 300, epoch: 8 | loss: 0.1765610
	speed: 0.0958s/iter; left time: 295.3954s
	iters: 400, epoch: 8 | loss: 0.3066920
	speed: 0.0958s/iter; left time: 285.7292s
	iters: 500, epoch: 8 | loss: 0.1446218
	speed: 0.0958s/iter; left time: 276.1691s
	iters: 600, epoch: 8 | loss: 0.1821296
	speed: 0.0959s/iter; left time: 266.8089s
	iters: 700, epoch: 8 | loss: 0.3372056
	speed: 0.0959s/iter; left time: 257.2191s
	iters: 800, epoch: 8 | loss: 0.1550129
	speed: 0.0959s/iter; left time: 247.6220s
	iters: 900, epoch: 8 | loss: 0.2998109
	speed: 0.0958s/iter; left time: 237.7036s
	iters: 1000, epoch: 8 | loss: 0.3625981
	speed: 0.0958s/iter; left time: 228.2874s
	iters: 1100, epoch: 8 | loss: 0.1413650
	speed: 0.0959s/iter; left time: 218.9523s
Epoch: 8 cost time: 108.05426239967346
Epoch: 8, Steps: 1127 | Train Loss: 0.2164546 Vali Loss: 0.9022246 Test Loss: 1.0520951
Validation loss decreased (0.904378 --> 0.902225).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1710275
	speed: 0.3008s/iter; left time: 648.2245s
	iters: 200, epoch: 9 | loss: 0.1483395
	speed: 0.0961s/iter; left time: 197.5512s
	iters: 300, epoch: 9 | loss: 0.2128118
	speed: 0.0960s/iter; left time: 187.7557s
	iters: 400, epoch: 9 | loss: 0.1367216
	speed: 0.0959s/iter; left time: 177.9592s
	iters: 500, epoch: 9 | loss: 0.3331538
	speed: 0.0961s/iter; left time: 168.7324s
	iters: 600, epoch: 9 | loss: 0.2071802
	speed: 0.0962s/iter; left time: 159.2621s
	iters: 700, epoch: 9 | loss: 0.3851638
	speed: 0.0959s/iter; left time: 149.1864s
	iters: 800, epoch: 9 | loss: 0.2665709
	speed: 0.0943s/iter; left time: 137.2631s
	iters: 900, epoch: 9 | loss: 0.1371232
	speed: 0.0945s/iter; left time: 128.0547s
	iters: 1000, epoch: 9 | loss: 0.3389924
	speed: 0.0945s/iter; left time: 118.6232s
	iters: 1100, epoch: 9 | loss: 0.2107021
	speed: 0.0944s/iter; left time: 109.0200s
Epoch: 9 cost time: 107.54235744476318
Epoch: 9, Steps: 1127 | Train Loss: 0.2158951 Vali Loss: 0.9067080 Test Loss: 1.0635234
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1566059
	speed: 0.2918s/iter; left time: 300.0005s
	iters: 200, epoch: 10 | loss: 0.1663041
	speed: 0.0946s/iter; left time: 87.7584s
	iters: 300, epoch: 10 | loss: 0.1342177
	speed: 0.0934s/iter; left time: 77.3116s
	iters: 400, epoch: 10 | loss: 0.2367885
	speed: 0.0932s/iter; left time: 67.8533s
	iters: 500, epoch: 10 | loss: 0.1858930
	speed: 0.0933s/iter; left time: 58.5692s
	iters: 600, epoch: 10 | loss: 0.2474048
	speed: 0.0932s/iter; left time: 49.2126s
	iters: 700, epoch: 10 | loss: 0.2503605
	speed: 0.0933s/iter; left time: 39.9146s
	iters: 800, epoch: 10 | loss: 0.2270617
	speed: 0.0933s/iter; left time: 30.5968s
	iters: 900, epoch: 10 | loss: 0.3086859
	speed: 0.0931s/iter; left time: 21.2311s
	iters: 1000, epoch: 10 | loss: 0.3540210
	speed: 0.0932s/iter; left time: 11.9281s
	iters: 1100, epoch: 10 | loss: 0.2460030
	speed: 0.0935s/iter; left time: 2.6170s
Epoch: 10 cost time: 105.43954014778137
Epoch: 10, Steps: 1127 | Train Loss: 0.2155244 Vali Loss: 0.9048558 Test Loss: 1.0602069
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : weather_720_Transformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed12890<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9820
mse:1.052008867263794, mae:0.7485455870628357
