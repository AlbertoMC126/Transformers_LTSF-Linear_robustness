Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=21, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=21, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Autoformer', model_id='weather_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=96, root_path='./dataset/', seed=15227, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_96_Autoformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed15227>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36696
val 5175
test 10444
	iters: 100, epoch: 1 | loss: 0.5685737
	speed: 0.0815s/iter; left time: 925.5427s
	iters: 200, epoch: 1 | loss: 0.6554554
	speed: 0.0472s/iter; left time: 531.5900s
	iters: 300, epoch: 1 | loss: 0.4987898
	speed: 0.0473s/iter; left time: 527.7446s
	iters: 400, epoch: 1 | loss: 0.3718103
	speed: 0.0473s/iter; left time: 523.4398s
	iters: 500, epoch: 1 | loss: 0.3806971
	speed: 0.0473s/iter; left time: 518.1512s
	iters: 600, epoch: 1 | loss: 0.3979733
	speed: 0.0473s/iter; left time: 513.6405s
	iters: 700, epoch: 1 | loss: 0.2772289
	speed: 0.0473s/iter; left time: 509.2688s
	iters: 800, epoch: 1 | loss: 1.1352593
	speed: 0.0473s/iter; left time: 504.0679s
	iters: 900, epoch: 1 | loss: 0.4251420
	speed: 0.0473s/iter; left time: 499.8783s
	iters: 1000, epoch: 1 | loss: 0.5312023
	speed: 0.0473s/iter; left time: 494.7932s
	iters: 1100, epoch: 1 | loss: 0.2587020
	speed: 0.0473s/iter; left time: 489.7208s
Epoch: 1 cost time: 57.63948440551758
Epoch: 1, Steps: 1146 | Train Loss: 0.5120722 Vali Loss: 0.5220501 Test Loss: 0.2592241
Validation loss decreased (inf --> 0.522050).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5309427
	speed: 0.2096s/iter; left time: 2141.4642s
	iters: 200, epoch: 2 | loss: 0.3865734
	speed: 0.0474s/iter; left time: 479.9480s
	iters: 300, epoch: 2 | loss: 0.3279934
	speed: 0.0475s/iter; left time: 475.5375s
	iters: 400, epoch: 2 | loss: 0.4055715
	speed: 0.0475s/iter; left time: 471.3943s
	iters: 500, epoch: 2 | loss: 0.2971185
	speed: 0.0481s/iter; left time: 471.6933s
	iters: 600, epoch: 2 | loss: 0.2369295
	speed: 0.0477s/iter; left time: 463.5040s
	iters: 700, epoch: 2 | loss: 0.3646491
	speed: 0.0477s/iter; left time: 458.6961s
	iters: 800, epoch: 2 | loss: 1.2251183
	speed: 0.0476s/iter; left time: 452.9063s
	iters: 900, epoch: 2 | loss: 0.2980526
	speed: 0.0477s/iter; left time: 449.1335s
	iters: 1000, epoch: 2 | loss: 0.5015960
	speed: 0.0478s/iter; left time: 445.1807s
	iters: 1100, epoch: 2 | loss: 0.3392490
	speed: 0.0475s/iter; left time: 437.3463s
Epoch: 2 cost time: 54.58517122268677
Epoch: 2, Steps: 1146 | Train Loss: 0.4350377 Vali Loss: 0.5229530 Test Loss: 0.2460687
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3893828
	speed: 0.2070s/iter; left time: 1877.6525s
	iters: 200, epoch: 3 | loss: 0.3504131
	speed: 0.0473s/iter; left time: 423.8119s
	iters: 300, epoch: 3 | loss: 0.3987519
	speed: 0.0473s/iter; left time: 419.1054s
	iters: 400, epoch: 3 | loss: 0.2994576
	speed: 0.0473s/iter; left time: 415.0554s
	iters: 500, epoch: 3 | loss: 0.2837979
	speed: 0.0473s/iter; left time: 409.7690s
	iters: 600, epoch: 3 | loss: 0.2436770
	speed: 0.0473s/iter; left time: 405.1381s
	iters: 700, epoch: 3 | loss: 0.3590655
	speed: 0.0472s/iter; left time: 400.1449s
	iters: 800, epoch: 3 | loss: 0.4541551
	speed: 0.0473s/iter; left time: 395.9177s
	iters: 900, epoch: 3 | loss: 0.2761246
	speed: 0.0473s/iter; left time: 390.7722s
	iters: 1000, epoch: 3 | loss: 0.3945931
	speed: 0.0473s/iter; left time: 386.1739s
	iters: 1100, epoch: 3 | loss: 0.8453773
	speed: 0.0473s/iter; left time: 381.4115s
Epoch: 3 cost time: 54.17557740211487
Epoch: 3, Steps: 1146 | Train Loss: 0.3949108 Vali Loss: 0.5212117 Test Loss: 0.2609328
Validation loss decreased (0.522050 --> 0.521212).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2935399
	speed: 0.2098s/iter; left time: 1661.9139s
	iters: 200, epoch: 4 | loss: 0.3939500
	speed: 0.0478s/iter; left time: 373.5640s
	iters: 300, epoch: 4 | loss: 0.3044663
	speed: 0.0478s/iter; left time: 369.1752s
	iters: 400, epoch: 4 | loss: 0.2655624
	speed: 0.0477s/iter; left time: 363.5025s
	iters: 500, epoch: 4 | loss: 0.3404472
	speed: 0.0477s/iter; left time: 359.1283s
	iters: 600, epoch: 4 | loss: 0.2319252
	speed: 0.0478s/iter; left time: 354.6259s
	iters: 700, epoch: 4 | loss: 0.2675473
	speed: 0.0474s/iter; left time: 347.4526s
	iters: 800, epoch: 4 | loss: 0.2616492
	speed: 0.0474s/iter; left time: 342.0313s
	iters: 900, epoch: 4 | loss: 0.2405326
	speed: 0.0473s/iter; left time: 336.7044s
	iters: 1000, epoch: 4 | loss: 0.2362919
	speed: 0.0473s/iter; left time: 331.9078s
	iters: 1100, epoch: 4 | loss: 0.2742332
	speed: 0.0473s/iter; left time: 327.1849s
Epoch: 4 cost time: 54.47101902961731
Epoch: 4, Steps: 1146 | Train Loss: 0.3667239 Vali Loss: 0.5144950 Test Loss: 0.2521519
Validation loss decreased (0.521212 --> 0.514495).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3113894
	speed: 0.2092s/iter; left time: 1417.5257s
	iters: 200, epoch: 5 | loss: 0.2455116
	speed: 0.0473s/iter; left time: 315.6018s
	iters: 300, epoch: 5 | loss: 0.3886640
	speed: 0.0473s/iter; left time: 311.0873s
	iters: 400, epoch: 5 | loss: 0.5548141
	speed: 0.0473s/iter; left time: 306.3810s
	iters: 500, epoch: 5 | loss: 0.3926672
	speed: 0.0473s/iter; left time: 301.5631s
	iters: 600, epoch: 5 | loss: 0.2648703
	speed: 0.0472s/iter; left time: 296.3856s
	iters: 700, epoch: 5 | loss: 0.8264806
	speed: 0.0473s/iter; left time: 291.9833s
	iters: 800, epoch: 5 | loss: 0.3086644
	speed: 0.0473s/iter; left time: 287.4377s
	iters: 900, epoch: 5 | loss: 0.2200843
	speed: 0.0472s/iter; left time: 282.2301s
	iters: 1000, epoch: 5 | loss: 0.2572260
	speed: 0.0473s/iter; left time: 277.9333s
	iters: 1100, epoch: 5 | loss: 0.4439664
	speed: 0.0472s/iter; left time: 272.7805s
Epoch: 5 cost time: 54.17283844947815
Epoch: 5, Steps: 1146 | Train Loss: 0.3536603 Vali Loss: 0.5191317 Test Loss: 0.2536814
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2849700
	speed: 0.2113s/iter; left time: 1189.6833s
	iters: 200, epoch: 6 | loss: 0.3105548
	speed: 0.0478s/iter; left time: 264.2750s
	iters: 300, epoch: 6 | loss: 0.2632795
	speed: 0.0478s/iter; left time: 259.3886s
	iters: 400, epoch: 6 | loss: 0.2213468
	speed: 0.0474s/iter; left time: 252.8706s
	iters: 500, epoch: 6 | loss: 0.9448224
	speed: 0.0472s/iter; left time: 247.1274s
	iters: 600, epoch: 6 | loss: 0.3677076
	speed: 0.0473s/iter; left time: 242.8144s
	iters: 700, epoch: 6 | loss: 0.2145408
	speed: 0.0472s/iter; left time: 237.5948s
	iters: 800, epoch: 6 | loss: 0.3987614
	speed: 0.0473s/iter; left time: 233.2933s
	iters: 900, epoch: 6 | loss: 0.4129702
	speed: 0.0473s/iter; left time: 228.4211s
	iters: 1000, epoch: 6 | loss: 0.3258502
	speed: 0.0473s/iter; left time: 223.8857s
	iters: 1100, epoch: 6 | loss: 0.3044266
	speed: 0.0472s/iter; left time: 218.5994s
Epoch: 6 cost time: 54.33542275428772
Epoch: 6, Steps: 1146 | Train Loss: 0.3471718 Vali Loss: 0.5203732 Test Loss: 0.2579124
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2732478
	speed: 0.2073s/iter; left time: 929.8721s
	iters: 200, epoch: 7 | loss: 0.2292749
	speed: 0.0472s/iter; left time: 207.1577s
	iters: 300, epoch: 7 | loss: 0.8508005
	speed: 0.0473s/iter; left time: 202.7590s
	iters: 400, epoch: 7 | loss: 0.3491923
	speed: 0.0473s/iter; left time: 198.0081s
	iters: 500, epoch: 7 | loss: 0.8051287
	speed: 0.0474s/iter; left time: 193.4856s
	iters: 600, epoch: 7 | loss: 0.2690177
	speed: 0.0473s/iter; left time: 188.5751s
	iters: 700, epoch: 7 | loss: 0.3129523
	speed: 0.0473s/iter; left time: 183.7217s
	iters: 800, epoch: 7 | loss: 0.2871614
	speed: 0.0474s/iter; left time: 179.3082s
	iters: 900, epoch: 7 | loss: 0.3893057
	speed: 0.0478s/iter; left time: 176.1561s
	iters: 1000, epoch: 7 | loss: 0.1968161
	speed: 0.0479s/iter; left time: 171.8100s
	iters: 1100, epoch: 7 | loss: 0.2951539
	speed: 0.0477s/iter; left time: 166.3631s
Epoch: 7 cost time: 54.390551805496216
Epoch: 7, Steps: 1146 | Train Loss: 0.3435660 Vali Loss: 0.5187086 Test Loss: 0.2544332
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : weather_96_Autoformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed15227<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
mse:0.25240692496299744, mae:0.32436642050743103
