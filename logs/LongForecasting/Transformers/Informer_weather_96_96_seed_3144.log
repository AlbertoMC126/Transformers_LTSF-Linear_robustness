Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=21, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=21, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Informer', model_id='weather_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=96, root_path='./dataset/', seed=3144, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_96_Informer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed3144>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36696
val 5175
test 10444
	iters: 100, epoch: 1 | loss: 0.3359562
	speed: 0.0587s/iter; left time: 666.5041s
	iters: 200, epoch: 1 | loss: 0.2303773
	speed: 0.0281s/iter; left time: 316.0949s
	iters: 300, epoch: 1 | loss: 1.2420136
	speed: 0.0281s/iter; left time: 313.3637s
	iters: 400, epoch: 1 | loss: 0.2595741
	speed: 0.0280s/iter; left time: 309.2338s
	iters: 500, epoch: 1 | loss: 0.3146020
	speed: 0.0279s/iter; left time: 305.7821s
	iters: 600, epoch: 1 | loss: 0.2593676
	speed: 0.0278s/iter; left time: 302.1502s
	iters: 700, epoch: 1 | loss: 0.4007621
	speed: 0.0278s/iter; left time: 298.8873s
	iters: 800, epoch: 1 | loss: 0.3754760
	speed: 0.0277s/iter; left time: 295.7964s
	iters: 900, epoch: 1 | loss: 0.2547759
	speed: 0.0280s/iter; left time: 295.3567s
	iters: 1000, epoch: 1 | loss: 0.2736811
	speed: 0.0280s/iter; left time: 293.3055s
	iters: 1100, epoch: 1 | loss: 0.3330485
	speed: 0.0279s/iter; left time: 289.3250s
Epoch: 1 cost time: 35.09837102890015
Epoch: 1, Steps: 1146 | Train Loss: 0.4010296 Vali Loss: 0.5386158 Test Loss: 0.4822751
Validation loss decreased (inf --> 0.538616).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3203124
	speed: 0.0891s/iter; left time: 910.4591s
	iters: 200, epoch: 2 | loss: 0.2201217
	speed: 0.0278s/iter; left time: 281.2912s
	iters: 300, epoch: 2 | loss: 0.3061752
	speed: 0.0279s/iter; left time: 279.2724s
	iters: 400, epoch: 2 | loss: 0.1883253
	speed: 0.0280s/iter; left time: 277.1522s
	iters: 500, epoch: 2 | loss: 0.1771142
	speed: 0.0281s/iter; left time: 275.4719s
	iters: 600, epoch: 2 | loss: 0.1826568
	speed: 0.0286s/iter; left time: 277.9018s
	iters: 700, epoch: 2 | loss: 0.2118129
	speed: 0.0285s/iter; left time: 274.3705s
	iters: 800, epoch: 2 | loss: 0.2363919
	speed: 0.0292s/iter; left time: 277.4871s
	iters: 900, epoch: 2 | loss: 0.2987186
	speed: 0.0292s/iter; left time: 274.4782s
	iters: 1000, epoch: 2 | loss: 0.1949323
	speed: 0.0292s/iter; left time: 271.9939s
	iters: 1100, epoch: 2 | loss: 0.2789460
	speed: 0.0292s/iter; left time: 268.6442s
Epoch: 2 cost time: 32.66320061683655
Epoch: 2, Steps: 1146 | Train Loss: 0.3258262 Vali Loss: 0.5256255 Test Loss: 0.4537180
Validation loss decreased (0.538616 --> 0.525625).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2144369
	speed: 0.0911s/iter; left time: 826.6375s
	iters: 200, epoch: 3 | loss: 0.1730999
	speed: 0.0291s/iter; left time: 261.0236s
	iters: 300, epoch: 3 | loss: 0.2310492
	speed: 0.0289s/iter; left time: 256.6336s
	iters: 400, epoch: 3 | loss: 0.2222698
	speed: 0.0282s/iter; left time: 247.2212s
	iters: 500, epoch: 3 | loss: 0.1346932
	speed: 0.0286s/iter; left time: 247.8019s
	iters: 600, epoch: 3 | loss: 0.1973500
	speed: 0.0280s/iter; left time: 239.8907s
	iters: 700, epoch: 3 | loss: 0.2133766
	speed: 0.0279s/iter; left time: 236.5224s
	iters: 800, epoch: 3 | loss: 0.1199357
	speed: 0.0277s/iter; left time: 231.9696s
	iters: 900, epoch: 3 | loss: 0.2450504
	speed: 0.0279s/iter; left time: 230.3265s
	iters: 1000, epoch: 3 | loss: 0.1713745
	speed: 0.0280s/iter; left time: 228.9958s
	iters: 1100, epoch: 3 | loss: 0.2013834
	speed: 0.0282s/iter; left time: 227.9148s
Epoch: 3 cost time: 32.48289370536804
Epoch: 3, Steps: 1146 | Train Loss: 0.2681550 Vali Loss: 0.5163552 Test Loss: 0.4020088
Validation loss decreased (0.525625 --> 0.516355).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2788675
	speed: 0.0899s/iter; left time: 712.0716s
	iters: 200, epoch: 4 | loss: 0.1879145
	speed: 0.0280s/iter; left time: 218.8491s
	iters: 300, epoch: 4 | loss: 0.1335385
	speed: 0.0282s/iter; left time: 217.6777s
	iters: 400, epoch: 4 | loss: 0.1587439
	speed: 0.0283s/iter; left time: 215.5645s
	iters: 500, epoch: 4 | loss: 0.1380802
	speed: 0.0283s/iter; left time: 212.8084s
	iters: 600, epoch: 4 | loss: 0.1589413
	speed: 0.0284s/iter; left time: 210.5510s
	iters: 700, epoch: 4 | loss: 0.8124516
	speed: 0.0280s/iter; left time: 205.2219s
	iters: 800, epoch: 4 | loss: 0.7988859
	speed: 0.0279s/iter; left time: 201.8479s
	iters: 900, epoch: 4 | loss: 0.1451402
	speed: 0.0280s/iter; left time: 199.3313s
	iters: 1000, epoch: 4 | loss: 0.2535115
	speed: 0.0280s/iter; left time: 196.9105s
	iters: 1100, epoch: 4 | loss: 0.1730786
	speed: 0.0281s/iter; left time: 194.6482s
Epoch: 4 cost time: 32.191718101501465
Epoch: 4, Steps: 1146 | Train Loss: 0.2419399 Vali Loss: 0.4969292 Test Loss: 0.3929517
Validation loss decreased (0.516355 --> 0.496929).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1807765
	speed: 0.0882s/iter; left time: 597.7428s
	iters: 200, epoch: 5 | loss: 0.1486161
	speed: 0.0275s/iter; left time: 183.7379s
	iters: 300, epoch: 5 | loss: 0.1788704
	speed: 0.0276s/iter; left time: 181.3818s
	iters: 400, epoch: 5 | loss: 0.2056302
	speed: 0.0275s/iter; left time: 178.4247s
	iters: 500, epoch: 5 | loss: 0.1467987
	speed: 0.0276s/iter; left time: 175.8680s
	iters: 600, epoch: 5 | loss: 0.1382834
	speed: 0.0275s/iter; left time: 172.7955s
	iters: 700, epoch: 5 | loss: 0.1692384
	speed: 0.0276s/iter; left time: 170.3548s
	iters: 800, epoch: 5 | loss: 0.1983501
	speed: 0.0276s/iter; left time: 167.6584s
	iters: 900, epoch: 5 | loss: 0.1790647
	speed: 0.0290s/iter; left time: 173.2493s
	iters: 1000, epoch: 5 | loss: 0.3764908
	speed: 0.0288s/iter; left time: 169.5151s
	iters: 1100, epoch: 5 | loss: 0.1460771
	speed: 0.0298s/iter; left time: 172.2642s
Epoch: 5 cost time: 32.1772518157959
Epoch: 5, Steps: 1146 | Train Loss: 0.2294540 Vali Loss: 0.4979194 Test Loss: 0.3965106
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1601529
	speed: 0.0890s/iter; left time: 501.0791s
	iters: 200, epoch: 6 | loss: 0.1517552
	speed: 0.0291s/iter; left time: 161.0608s
	iters: 300, epoch: 6 | loss: 0.1426694
	speed: 0.0290s/iter; left time: 157.5183s
	iters: 400, epoch: 6 | loss: 0.8458391
	speed: 0.0295s/iter; left time: 157.4062s
	iters: 500, epoch: 6 | loss: 0.1375975
	speed: 0.0294s/iter; left time: 153.5993s
	iters: 600, epoch: 6 | loss: 0.2617435
	speed: 0.0289s/iter; left time: 148.0488s
	iters: 700, epoch: 6 | loss: 0.1679993
	speed: 0.0280s/iter; left time: 140.8058s
	iters: 800, epoch: 6 | loss: 0.1479604
	speed: 0.0280s/iter; left time: 138.1021s
	iters: 900, epoch: 6 | loss: 0.1866097
	speed: 0.0278s/iter; left time: 134.3977s
	iters: 1000, epoch: 6 | loss: 0.1646930
	speed: 0.0278s/iter; left time: 131.6991s
	iters: 1100, epoch: 6 | loss: 0.1411301
	speed: 0.0278s/iter; left time: 128.7293s
Epoch: 6 cost time: 32.70999765396118
Epoch: 6, Steps: 1146 | Train Loss: 0.2235829 Vali Loss: 0.5003650 Test Loss: 0.3947518
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1134970
	speed: 0.0867s/iter; left time: 388.8419s
	iters: 200, epoch: 7 | loss: 0.1448807
	speed: 0.0278s/iter; left time: 122.0220s
	iters: 300, epoch: 7 | loss: 0.1394717
	speed: 0.0277s/iter; left time: 118.5569s
	iters: 400, epoch: 7 | loss: 0.1036691
	speed: 0.0278s/iter; left time: 116.1500s
	iters: 500, epoch: 7 | loss: 0.2346889
	speed: 0.0278s/iter; left time: 113.3911s
	iters: 600, epoch: 7 | loss: 0.1105228
	speed: 0.0278s/iter; left time: 110.8884s
	iters: 700, epoch: 7 | loss: 0.1173543
	speed: 0.0278s/iter; left time: 108.1783s
	iters: 800, epoch: 7 | loss: 0.1307224
	speed: 0.0280s/iter; left time: 106.0893s
	iters: 900, epoch: 7 | loss: 0.1643602
	speed: 0.0279s/iter; left time: 102.6926s
	iters: 1000, epoch: 7 | loss: 0.2793301
	speed: 0.0278s/iter; left time: 99.6442s
	iters: 1100, epoch: 7 | loss: 0.1829912
	speed: 0.0277s/iter; left time: 96.5426s
Epoch: 7 cost time: 31.897682905197144
Epoch: 7, Steps: 1146 | Train Loss: 0.2205319 Vali Loss: 0.5006690 Test Loss: 0.3998294
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : weather_96_Informer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed3144<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
mse:0.3920363783836365, mae:0.4322318136692047
