Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=21, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=21, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Transformer', model_id='weather_720', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=720, root_path='./dataset/', seed=15349, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_720_Transformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed15349>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36072
val 4551
test 9820
	iters: 100, epoch: 1 | loss: 0.4852022
	speed: 0.1235s/iter; left time: 1379.4818s
	iters: 200, epoch: 1 | loss: 0.5007054
	speed: 0.0924s/iter; left time: 1023.4790s
	iters: 300, epoch: 1 | loss: 0.6376550
	speed: 0.0927s/iter; left time: 1017.2234s
	iters: 400, epoch: 1 | loss: 0.6581023
	speed: 0.0928s/iter; left time: 1009.2577s
	iters: 500, epoch: 1 | loss: 0.4157425
	speed: 0.0928s/iter; left time: 999.4963s
	iters: 600, epoch: 1 | loss: 0.3761088
	speed: 0.0928s/iter; left time: 990.0631s
	iters: 700, epoch: 1 | loss: 0.6231824
	speed: 0.0929s/iter; left time: 982.0210s
	iters: 800, epoch: 1 | loss: 0.4643243
	speed: 0.0934s/iter; left time: 978.4620s
	iters: 900, epoch: 1 | loss: 0.3631656
	speed: 0.0935s/iter; left time: 969.3204s
	iters: 1000, epoch: 1 | loss: 0.3144343
	speed: 0.0934s/iter; left time: 959.7119s
	iters: 1100, epoch: 1 | loss: 0.4559060
	speed: 0.0931s/iter; left time: 946.7155s
Epoch: 1 cost time: 107.8560118675232
Epoch: 1, Steps: 1127 | Train Loss: 0.4726406 Vali Loss: 0.8579618 Test Loss: 1.0085177
Validation loss decreased (inf --> 0.857962).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3656705
	speed: 0.2824s/iter; left time: 2836.5908s
	iters: 200, epoch: 2 | loss: 0.2948571
	speed: 0.0930s/iter; left time: 924.3747s
	iters: 300, epoch: 2 | loss: 0.2778919
	speed: 0.0928s/iter; left time: 913.5022s
	iters: 400, epoch: 2 | loss: 0.4094513
	speed: 0.0929s/iter; left time: 904.9470s
	iters: 500, epoch: 2 | loss: 0.3605360
	speed: 0.0929s/iter; left time: 895.7710s
	iters: 600, epoch: 2 | loss: 0.2556680
	speed: 0.0929s/iter; left time: 886.7521s
	iters: 700, epoch: 2 | loss: 0.2592552
	speed: 0.0929s/iter; left time: 877.4504s
	iters: 800, epoch: 2 | loss: 0.4106105
	speed: 0.0934s/iter; left time: 872.6831s
	iters: 900, epoch: 2 | loss: 0.2385065
	speed: 0.0935s/iter; left time: 864.0279s
	iters: 1000, epoch: 2 | loss: 0.1856631
	speed: 0.0934s/iter; left time: 854.1924s
	iters: 1100, epoch: 2 | loss: 0.3325121
	speed: 0.0930s/iter; left time: 841.2392s
Epoch: 2 cost time: 104.80642700195312
Epoch: 2, Steps: 1127 | Train Loss: 0.3250317 Vali Loss: 0.8643693 Test Loss: 1.0860970
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1981664
	speed: 0.2795s/iter; left time: 2491.9341s
	iters: 200, epoch: 3 | loss: 0.4451236
	speed: 0.0927s/iter; left time: 817.7620s
	iters: 300, epoch: 3 | loss: 0.1904719
	speed: 0.0927s/iter; left time: 808.2909s
	iters: 400, epoch: 3 | loss: 0.2171158
	speed: 0.0928s/iter; left time: 799.3460s
	iters: 500, epoch: 3 | loss: 0.2828453
	speed: 0.0927s/iter; left time: 789.8392s
	iters: 600, epoch: 3 | loss: 0.1658225
	speed: 0.0927s/iter; left time: 780.3426s
	iters: 700, epoch: 3 | loss: 0.1971299
	speed: 0.0927s/iter; left time: 771.3636s
	iters: 800, epoch: 3 | loss: 0.3353866
	speed: 0.0932s/iter; left time: 766.0684s
	iters: 900, epoch: 3 | loss: 0.2004462
	speed: 0.0932s/iter; left time: 756.7971s
	iters: 1000, epoch: 3 | loss: 0.1851355
	speed: 0.0933s/iter; left time: 747.8802s
	iters: 1100, epoch: 3 | loss: 0.1633952
	speed: 0.0927s/iter; left time: 734.2504s
Epoch: 3 cost time: 104.62553691864014
Epoch: 3, Steps: 1127 | Train Loss: 0.2557112 Vali Loss: 0.8846404 Test Loss: 1.0898806
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1728777
	speed: 0.2790s/iter; left time: 2173.4041s
	iters: 200, epoch: 4 | loss: 0.2535162
	speed: 0.0928s/iter; left time: 713.4766s
	iters: 300, epoch: 4 | loss: 0.2097241
	speed: 0.0929s/iter; left time: 704.7546s
	iters: 400, epoch: 4 | loss: 0.2772188
	speed: 0.0927s/iter; left time: 694.4930s
	iters: 500, epoch: 4 | loss: 0.3750460
	speed: 0.0927s/iter; left time: 684.9566s
	iters: 600, epoch: 4 | loss: 0.1843010
	speed: 0.0927s/iter; left time: 675.8349s
	iters: 700, epoch: 4 | loss: 0.2100583
	speed: 0.0929s/iter; left time: 667.8622s
	iters: 800, epoch: 4 | loss: 0.3137867
	speed: 0.0934s/iter; left time: 661.9889s
	iters: 900, epoch: 4 | loss: 0.2067321
	speed: 0.0934s/iter; left time: 652.8634s
	iters: 1000, epoch: 4 | loss: 0.3575160
	speed: 0.0933s/iter; left time: 643.1159s
	iters: 1100, epoch: 4 | loss: 0.2572961
	speed: 0.0928s/iter; left time: 630.2890s
Epoch: 4 cost time: 104.6977026462555
Epoch: 4, Steps: 1127 | Train Loss: 0.2330832 Vali Loss: 0.8585849 Test Loss: 1.0114726
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : weather_720_Transformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed15349<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9820
mse:1.0083755254745483, mae:0.7456706166267395
