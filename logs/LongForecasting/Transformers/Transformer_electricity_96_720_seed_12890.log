Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=321, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', dec_in=321, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Transformer', model_id='electricity_720', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=720, root_path='./dataset/', seed=12890, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : electricity_720_Transformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed12890>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17597
val 1913
test 4541
	iters: 100, epoch: 1 | loss: 0.3515461
	speed: 0.1338s/iter; left time: 721.3099s
	iters: 200, epoch: 1 | loss: 0.2879306
	speed: 0.1029s/iter; left time: 544.6065s
	iters: 300, epoch: 1 | loss: 0.2586726
	speed: 0.1031s/iter; left time: 535.4138s
	iters: 400, epoch: 1 | loss: 0.2368062
	speed: 0.1033s/iter; left time: 525.7995s
	iters: 500, epoch: 1 | loss: 0.2306004
	speed: 0.1029s/iter; left time: 513.6880s
Epoch: 1 cost time: 59.68658185005188
Epoch: 1, Steps: 549 | Train Loss: 0.3153261 Vali Loss: 0.2593153 Test Loss: 0.3291962
Validation loss decreased (inf --> 0.259315).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2224397
	speed: 0.3258s/iter; left time: 1577.7407s
	iters: 200, epoch: 2 | loss: 0.2325350
	speed: 0.1033s/iter; left time: 489.6917s
	iters: 300, epoch: 2 | loss: 0.1994843
	speed: 0.1032s/iter; left time: 478.8954s
	iters: 400, epoch: 2 | loss: 0.1988374
	speed: 0.1032s/iter; left time: 468.6075s
	iters: 500, epoch: 2 | loss: 0.1945287
	speed: 0.1031s/iter; left time: 458.1700s
Epoch: 2 cost time: 56.67997932434082
Epoch: 2, Steps: 549 | Train Loss: 0.2140339 Vali Loss: 0.2602270 Test Loss: 0.3224388
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2020962
	speed: 0.3223s/iter; left time: 1383.5150s
	iters: 200, epoch: 3 | loss: 0.1901700
	speed: 0.1035s/iter; left time: 433.7872s
	iters: 300, epoch: 3 | loss: 0.1858093
	speed: 0.1037s/iter; left time: 424.4958s
	iters: 400, epoch: 3 | loss: 0.1785735
	speed: 0.1037s/iter; left time: 414.2576s
	iters: 500, epoch: 3 | loss: 0.1759008
	speed: 0.1036s/iter; left time: 403.3684s
Epoch: 3 cost time: 56.82859921455383
Epoch: 3, Steps: 549 | Train Loss: 0.1896709 Vali Loss: 0.2532741 Test Loss: 0.3191399
Validation loss decreased (0.259315 --> 0.253274).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1749009
	speed: 0.3246s/iter; left time: 1215.3075s
	iters: 200, epoch: 4 | loss: 0.1592195
	speed: 0.1036s/iter; left time: 377.4271s
	iters: 300, epoch: 4 | loss: 0.1651774
	speed: 0.1032s/iter; left time: 365.7130s
	iters: 400, epoch: 4 | loss: 0.1633468
	speed: 0.1034s/iter; left time: 356.1370s
	iters: 500, epoch: 4 | loss: 0.1500351
	speed: 0.1036s/iter; left time: 346.5399s
Epoch: 4 cost time: 56.75305151939392
Epoch: 4, Steps: 549 | Train Loss: 0.1644687 Vali Loss: 0.2410657 Test Loss: 0.3115505
Validation loss decreased (0.253274 --> 0.241066).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1530735
	speed: 0.3260s/iter; left time: 1041.6157s
	iters: 200, epoch: 5 | loss: 0.1520126
	speed: 0.1040s/iter; left time: 321.8599s
	iters: 300, epoch: 5 | loss: 0.1510812
	speed: 0.1036s/iter; left time: 310.4041s
	iters: 400, epoch: 5 | loss: 0.1469744
	speed: 0.1028s/iter; left time: 297.7358s
	iters: 500, epoch: 5 | loss: 0.1607170
	speed: 0.1030s/iter; left time: 287.9973s
Epoch: 5 cost time: 56.802483558654785
Epoch: 5, Steps: 549 | Train Loss: 0.1543473 Vali Loss: 0.2371532 Test Loss: 0.3102655
Validation loss decreased (0.241066 --> 0.237153).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1500001
	speed: 0.3245s/iter; left time: 858.6813s
	iters: 200, epoch: 6 | loss: 0.1592728
	speed: 0.1034s/iter; left time: 263.2092s
	iters: 300, epoch: 6 | loss: 0.1397445
	speed: 0.1032s/iter; left time: 252.5327s
	iters: 400, epoch: 6 | loss: 0.1486787
	speed: 0.1032s/iter; left time: 242.0094s
	iters: 500, epoch: 6 | loss: 0.1498575
	speed: 0.1037s/iter; left time: 232.9391s
Epoch: 6 cost time: 56.72321391105652
Epoch: 6, Steps: 549 | Train Loss: 0.1501040 Vali Loss: 0.2386565 Test Loss: 0.3086310
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1453368
	speed: 0.3243s/iter; left time: 680.0313s
	iters: 200, epoch: 7 | loss: 0.1434618
	speed: 0.1032s/iter; left time: 206.1618s
	iters: 300, epoch: 7 | loss: 0.1419844
	speed: 0.1030s/iter; left time: 195.4265s
	iters: 400, epoch: 7 | loss: 0.1529047
	speed: 0.1034s/iter; left time: 185.8106s
	iters: 500, epoch: 7 | loss: 0.1422592
	speed: 0.1035s/iter; left time: 175.5975s
Epoch: 7 cost time: 56.66284656524658
Epoch: 7, Steps: 549 | Train Loss: 0.1478791 Vali Loss: 0.2379341 Test Loss: 0.3090593
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1510465
	speed: 0.3222s/iter; left time: 498.7534s
	iters: 200, epoch: 8 | loss: 0.1498652
	speed: 0.1031s/iter; left time: 149.3061s
	iters: 300, epoch: 8 | loss: 0.1494974
	speed: 0.1041s/iter; left time: 140.3312s
	iters: 400, epoch: 8 | loss: 0.1462924
	speed: 0.1041s/iter; left time: 129.9706s
	iters: 500, epoch: 8 | loss: 0.1435806
	speed: 0.1039s/iter; left time: 119.2487s
Epoch: 8 cost time: 56.87183356285095
Epoch: 8, Steps: 549 | Train Loss: 0.1466996 Vali Loss: 0.2371293 Test Loss: 0.3100827
Validation loss decreased (0.237153 --> 0.237129).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1486223
	speed: 0.3246s/iter; left time: 324.2730s
	iters: 200, epoch: 9 | loss: 0.1440346
	speed: 0.1035s/iter; left time: 93.0819s
	iters: 300, epoch: 9 | loss: 0.1507502
	speed: 0.1033s/iter; left time: 82.5626s
	iters: 400, epoch: 9 | loss: 0.1418789
	speed: 0.1033s/iter; left time: 72.1781s
	iters: 500, epoch: 9 | loss: 0.1452094
	speed: 0.1035s/iter; left time: 61.9931s
Epoch: 9 cost time: 56.7362265586853
Epoch: 9, Steps: 549 | Train Loss: 0.1460651 Vali Loss: 0.2372728 Test Loss: 0.3104840
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1454097
	speed: 0.3238s/iter; left time: 145.7204s
	iters: 200, epoch: 10 | loss: 0.1495006
	speed: 0.1040s/iter; left time: 36.3944s
	iters: 300, epoch: 10 | loss: 0.1452592
	speed: 0.1030s/iter; left time: 25.7499s
	iters: 400, epoch: 10 | loss: 0.1416063
	speed: 0.1030s/iter; left time: 15.4474s
	iters: 500, epoch: 10 | loss: 0.1467973
	speed: 0.1029s/iter; left time: 5.1457s
Epoch: 10 cost time: 56.71966600418091
Epoch: 10, Steps: 549 | Train Loss: 0.1457093 Vali Loss: 0.2374537 Test Loss: 0.3100129
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : electricity_720_Transformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed12890<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4541
mse:0.3100287616252899, mae:0.39232608675956726
