Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=21, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=21, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Autoformer', model_id='weather_192', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=192, root_path='./dataset/', seed=3293, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_192_Autoformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed3293>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36600
val 5079
test 10348
	iters: 100, epoch: 1 | loss: 0.7711300
	speed: 0.0963s/iter; left time: 1090.9940s
	iters: 200, epoch: 1 | loss: 0.4691803
	speed: 0.0619s/iter; left time: 695.7465s
	iters: 300, epoch: 1 | loss: 0.9254704
	speed: 0.0621s/iter; left time: 690.7127s
	iters: 400, epoch: 1 | loss: 0.4368052
	speed: 0.0620s/iter; left time: 684.3714s
	iters: 500, epoch: 1 | loss: 0.8883606
	speed: 0.0621s/iter; left time: 678.3873s
	iters: 600, epoch: 1 | loss: 0.4893590
	speed: 0.0622s/iter; left time: 673.4435s
	iters: 700, epoch: 1 | loss: 0.4889332
	speed: 0.0622s/iter; left time: 667.8859s
	iters: 800, epoch: 1 | loss: 0.4538540
	speed: 0.0622s/iter; left time: 661.4415s
	iters: 900, epoch: 1 | loss: 0.4796711
	speed: 0.0621s/iter; left time: 653.5145s
	iters: 1000, epoch: 1 | loss: 0.5580048
	speed: 0.0618s/iter; left time: 644.9800s
	iters: 1100, epoch: 1 | loss: 0.6120164
	speed: 0.0618s/iter; left time: 638.5006s
Epoch: 1 cost time: 74.3644015789032
Epoch: 1, Steps: 1143 | Train Loss: 0.6256098 Vali Loss: 0.6303517 Test Loss: 0.3114235
Validation loss decreased (inf --> 0.630352).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6151230
	speed: 0.2840s/iter; left time: 2893.8429s
	iters: 200, epoch: 2 | loss: 0.4938190
	speed: 0.0618s/iter; left time: 623.7228s
	iters: 300, epoch: 2 | loss: 0.3807539
	speed: 0.0617s/iter; left time: 616.6838s
	iters: 400, epoch: 2 | loss: 0.5551906
	speed: 0.0619s/iter; left time: 611.9126s
	iters: 500, epoch: 2 | loss: 0.3835431
	speed: 0.0618s/iter; left time: 604.5506s
	iters: 600, epoch: 2 | loss: 0.5072175
	speed: 0.0618s/iter; left time: 598.2748s
	iters: 700, epoch: 2 | loss: 0.5032865
	speed: 0.0618s/iter; left time: 592.2877s
	iters: 800, epoch: 2 | loss: 0.4563567
	speed: 0.0618s/iter; left time: 586.7721s
	iters: 900, epoch: 2 | loss: 0.4186696
	speed: 0.0619s/iter; left time: 580.8699s
	iters: 1000, epoch: 2 | loss: 0.4310440
	speed: 0.0619s/iter; left time: 574.6509s
	iters: 1100, epoch: 2 | loss: 0.8970423
	speed: 0.0619s/iter; left time: 568.2956s
Epoch: 2 cost time: 70.65798997879028
Epoch: 2, Steps: 1143 | Train Loss: 0.5656466 Vali Loss: 0.5913430 Test Loss: 0.3067656
Validation loss decreased (0.630352 --> 0.591343).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.6283672
	speed: 0.2845s/iter; left time: 2573.3162s
	iters: 200, epoch: 3 | loss: 0.4903543
	speed: 0.0618s/iter; left time: 553.1102s
	iters: 300, epoch: 3 | loss: 0.6145832
	speed: 0.0619s/iter; left time: 547.0900s
	iters: 400, epoch: 3 | loss: 0.3263334
	speed: 0.0618s/iter; left time: 540.6137s
	iters: 500, epoch: 3 | loss: 0.4058167
	speed: 0.0619s/iter; left time: 535.1597s
	iters: 600, epoch: 3 | loss: 1.3122203
	speed: 0.0620s/iter; left time: 529.7132s
	iters: 700, epoch: 3 | loss: 0.2935261
	speed: 0.0620s/iter; left time: 523.3558s
	iters: 800, epoch: 3 | loss: 0.5354204
	speed: 0.0621s/iter; left time: 518.0303s
	iters: 900, epoch: 3 | loss: 0.4442673
	speed: 0.0621s/iter; left time: 512.3490s
	iters: 1000, epoch: 3 | loss: 0.3909224
	speed: 0.0623s/iter; left time: 507.3764s
	iters: 1100, epoch: 3 | loss: 0.5148439
	speed: 0.0623s/iter; left time: 501.4639s
Epoch: 3 cost time: 70.86201691627502
Epoch: 3, Steps: 1143 | Train Loss: 0.5362022 Vali Loss: 0.5928175 Test Loss: 0.3097754
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4435368
	speed: 0.2833s/iter; left time: 2238.5772s
	iters: 200, epoch: 4 | loss: 0.4205452
	speed: 0.0622s/iter; left time: 484.9866s
	iters: 300, epoch: 4 | loss: 0.3963277
	speed: 0.0621s/iter; left time: 478.5760s
	iters: 400, epoch: 4 | loss: 0.3677590
	speed: 0.0622s/iter; left time: 472.9527s
	iters: 500, epoch: 4 | loss: 0.6393647
	speed: 0.0620s/iter; left time: 464.7713s
	iters: 600, epoch: 4 | loss: 0.4425305
	speed: 0.0621s/iter; left time: 459.5138s
	iters: 700, epoch: 4 | loss: 0.3906783
	speed: 0.0620s/iter; left time: 452.5390s
	iters: 800, epoch: 4 | loss: 0.4168482
	speed: 0.0620s/iter; left time: 446.5072s
	iters: 900, epoch: 4 | loss: 1.0208569
	speed: 0.0620s/iter; left time: 440.6114s
	iters: 1000, epoch: 4 | loss: 0.4227259
	speed: 0.0619s/iter; left time: 433.3993s
	iters: 1100, epoch: 4 | loss: 0.3799608
	speed: 0.0619s/iter; left time: 427.0605s
Epoch: 4 cost time: 70.90494847297668
Epoch: 4, Steps: 1143 | Train Loss: 0.5171402 Vali Loss: 0.5938880 Test Loss: 0.3108121
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.6208428
	speed: 0.2827s/iter; left time: 1911.0471s
	iters: 200, epoch: 5 | loss: 0.4297229
	speed: 0.0621s/iter; left time: 413.2497s
	iters: 300, epoch: 5 | loss: 0.3860465
	speed: 0.0621s/iter; left time: 407.4093s
	iters: 400, epoch: 5 | loss: 0.4964768
	speed: 0.0621s/iter; left time: 400.8224s
	iters: 500, epoch: 5 | loss: 0.7116925
	speed: 0.0620s/iter; left time: 394.1786s
	iters: 600, epoch: 5 | loss: 0.4323099
	speed: 0.0621s/iter; left time: 388.4813s
	iters: 700, epoch: 5 | loss: 0.5710455
	speed: 0.0621s/iter; left time: 382.6661s
	iters: 800, epoch: 5 | loss: 0.6942421
	speed: 0.0621s/iter; left time: 376.5106s
	iters: 900, epoch: 5 | loss: 0.3233958
	speed: 0.0620s/iter; left time: 369.7335s
	iters: 1000, epoch: 5 | loss: 0.4746659
	speed: 0.0618s/iter; left time: 361.8042s
	iters: 1100, epoch: 5 | loss: 0.4184924
	speed: 0.0619s/iter; left time: 356.2161s
Epoch: 5 cost time: 70.8731939792633
Epoch: 5, Steps: 1143 | Train Loss: 0.5066698 Vali Loss: 0.5910981 Test Loss: 0.3183229
Validation loss decreased (0.591343 --> 0.591098).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.8004300
	speed: 0.2841s/iter; left time: 1595.5581s
	iters: 200, epoch: 6 | loss: 0.6437014
	speed: 0.0618s/iter; left time: 340.6244s
	iters: 300, epoch: 6 | loss: 0.4225790
	speed: 0.0617s/iter; left time: 334.2274s
	iters: 400, epoch: 6 | loss: 0.4670564
	speed: 0.0618s/iter; left time: 328.4653s
	iters: 500, epoch: 6 | loss: 0.4202596
	speed: 0.0618s/iter; left time: 322.2519s
	iters: 600, epoch: 6 | loss: 0.4073709
	speed: 0.0618s/iter; left time: 315.9883s
	iters: 700, epoch: 6 | loss: 0.5196379
	speed: 0.0617s/iter; left time: 309.6405s
	iters: 800, epoch: 6 | loss: 0.8995118
	speed: 0.0618s/iter; left time: 303.8276s
	iters: 900, epoch: 6 | loss: 0.6991324
	speed: 0.0619s/iter; left time: 297.9833s
	iters: 1000, epoch: 6 | loss: 0.5579956
	speed: 0.0618s/iter; left time: 291.3271s
	iters: 1100, epoch: 6 | loss: 1.0056020
	speed: 0.0618s/iter; left time: 285.3017s
Epoch: 6 cost time: 70.61256408691406
Epoch: 6, Steps: 1143 | Train Loss: 0.5023062 Vali Loss: 0.5933197 Test Loss: 0.3156689
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.4840353
	speed: 0.2824s/iter; left time: 1263.2832s
	iters: 200, epoch: 7 | loss: 0.3373909
	speed: 0.0619s/iter; left time: 270.5204s
	iters: 300, epoch: 7 | loss: 0.3409006
	speed: 0.0617s/iter; left time: 263.6648s
	iters: 400, epoch: 7 | loss: 1.0295626
	speed: 0.0618s/iter; left time: 258.0123s
	iters: 500, epoch: 7 | loss: 0.5135974
	speed: 0.0619s/iter; left time: 251.9359s
	iters: 600, epoch: 7 | loss: 0.4773787
	speed: 0.0622s/iter; left time: 247.2769s
	iters: 700, epoch: 7 | loss: 0.4598372
	speed: 0.0621s/iter; left time: 240.5795s
	iters: 800, epoch: 7 | loss: 0.3501990
	speed: 0.0618s/iter; left time: 233.2586s
	iters: 900, epoch: 7 | loss: 0.4705169
	speed: 0.0618s/iter; left time: 226.9664s
	iters: 1000, epoch: 7 | loss: 0.3340217
	speed: 0.0618s/iter; left time: 220.7515s
	iters: 1100, epoch: 7 | loss: 0.3923138
	speed: 0.0618s/iter; left time: 214.5404s
Epoch: 7 cost time: 70.70545029640198
Epoch: 7, Steps: 1143 | Train Loss: 0.4992044 Vali Loss: 0.5948983 Test Loss: 0.3184777
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3080216
	speed: 0.2806s/iter; left time: 934.3887s
	iters: 200, epoch: 8 | loss: 0.7311366
	speed: 0.0623s/iter; left time: 201.1852s
	iters: 300, epoch: 8 | loss: 1.6002600
	speed: 0.0623s/iter; left time: 195.1306s
	iters: 400, epoch: 8 | loss: 0.9733717
	speed: 0.0621s/iter; left time: 188.0619s
	iters: 500, epoch: 8 | loss: 0.8145796
	speed: 0.0619s/iter; left time: 181.3937s
	iters: 600, epoch: 8 | loss: 0.4725129
	speed: 0.0618s/iter; left time: 174.8485s
	iters: 700, epoch: 8 | loss: 0.4620627
	speed: 0.0617s/iter; left time: 168.5122s
	iters: 800, epoch: 8 | loss: 0.4392029
	speed: 0.0618s/iter; left time: 162.5333s
	iters: 900, epoch: 8 | loss: 0.9590033
	speed: 0.0617s/iter; left time: 156.1698s
	iters: 1000, epoch: 8 | loss: 0.3406789
	speed: 0.0617s/iter; left time: 149.8555s
	iters: 1100, epoch: 8 | loss: 0.4720083
	speed: 0.0618s/iter; left time: 143.9851s
Epoch: 8 cost time: 70.77473211288452
Epoch: 8, Steps: 1143 | Train Loss: 0.4984246 Vali Loss: 0.5952455 Test Loss: 0.3174702
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : weather_192_Autoformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed3293<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10348
mse:0.3187776207923889, mae:0.3765355944633484
