Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=21, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=21, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Informer', model_id='weather_720', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=720, root_path='./dataset/', seed=28649, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_720_Informer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed28649>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36072
val 4551
test 9820
	iters: 100, epoch: 1 | loss: 0.5522842
	speed: 0.0968s/iter; left time: 1081.2285s
	iters: 200, epoch: 1 | loss: 0.5049346
	speed: 0.0663s/iter; left time: 733.5204s
	iters: 300, epoch: 1 | loss: 0.4888080
	speed: 0.0662s/iter; left time: 726.5555s
	iters: 400, epoch: 1 | loss: 0.7994562
	speed: 0.0666s/iter; left time: 723.5563s
	iters: 500, epoch: 1 | loss: 0.7435257
	speed: 0.0667s/iter; left time: 718.4137s
	iters: 600, epoch: 1 | loss: 0.3815913
	speed: 0.0665s/iter; left time: 710.1353s
	iters: 700, epoch: 1 | loss: 0.5265208
	speed: 0.0665s/iter; left time: 703.3469s
	iters: 800, epoch: 1 | loss: 0.3571408
	speed: 0.0667s/iter; left time: 698.1093s
	iters: 900, epoch: 1 | loss: 0.3470365
	speed: 0.0666s/iter; left time: 691.2249s
	iters: 1000, epoch: 1 | loss: 0.4867080
	speed: 0.0666s/iter; left time: 684.1738s
	iters: 1100, epoch: 1 | loss: 0.3465837
	speed: 0.0669s/iter; left time: 680.7694s
Epoch: 1 cost time: 78.11440372467041
Epoch: 1, Steps: 1127 | Train Loss: 0.5173272 Vali Loss: 0.9290420 Test Loss: 1.4788541
Validation loss decreased (inf --> 0.929042).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3174300
	speed: 0.2194s/iter; left time: 2203.5192s
	iters: 200, epoch: 2 | loss: 0.2927844
	speed: 0.0675s/iter; left time: 671.1296s
	iters: 300, epoch: 2 | loss: 0.4061010
	speed: 0.0668s/iter; left time: 657.3296s
	iters: 400, epoch: 2 | loss: 0.2926550
	speed: 0.0666s/iter; left time: 648.9616s
	iters: 500, epoch: 2 | loss: 0.5227689
	speed: 0.0666s/iter; left time: 642.0900s
	iters: 600, epoch: 2 | loss: 0.3901055
	speed: 0.0667s/iter; left time: 636.2557s
	iters: 700, epoch: 2 | loss: 0.3122117
	speed: 0.0665s/iter; left time: 628.3507s
	iters: 800, epoch: 2 | loss: 0.5384522
	speed: 0.0664s/iter; left time: 620.3874s
	iters: 900, epoch: 2 | loss: 0.2887128
	speed: 0.0666s/iter; left time: 615.7064s
	iters: 1000, epoch: 2 | loss: 0.4317980
	speed: 0.0667s/iter; left time: 610.1536s
	iters: 1100, epoch: 2 | loss: 0.4740843
	speed: 0.0665s/iter; left time: 601.8604s
Epoch: 2 cost time: 75.22364211082458
Epoch: 2, Steps: 1127 | Train Loss: 0.3807268 Vali Loss: 0.7971437 Test Loss: 0.9950393
Validation loss decreased (0.929042 --> 0.797144).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2630808
	speed: 0.2177s/iter; left time: 1941.5274s
	iters: 200, epoch: 3 | loss: 0.4602679
	speed: 0.0664s/iter; left time: 585.2832s
	iters: 300, epoch: 3 | loss: 0.4643671
	speed: 0.0676s/iter; left time: 589.0770s
	iters: 400, epoch: 3 | loss: 0.3105175
	speed: 0.0675s/iter; left time: 582.0309s
	iters: 500, epoch: 3 | loss: 0.2374394
	speed: 0.0676s/iter; left time: 576.1082s
	iters: 600, epoch: 3 | loss: 0.2117776
	speed: 0.0674s/iter; left time: 567.0474s
	iters: 700, epoch: 3 | loss: 0.3738309
	speed: 0.0670s/iter; left time: 557.3366s
	iters: 800, epoch: 3 | loss: 0.3791730
	speed: 0.0666s/iter; left time: 547.3547s
	iters: 900, epoch: 3 | loss: 0.2820177
	speed: 0.0664s/iter; left time: 539.0973s
	iters: 1000, epoch: 3 | loss: 0.2221009
	speed: 0.0665s/iter; left time: 532.7555s
	iters: 1100, epoch: 3 | loss: 0.2260260
	speed: 0.0667s/iter; left time: 527.7320s
Epoch: 3 cost time: 75.40826916694641
Epoch: 3, Steps: 1127 | Train Loss: 0.3058009 Vali Loss: 0.8441538 Test Loss: 1.1948575
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2523265
	speed: 0.2149s/iter; left time: 1673.9176s
	iters: 200, epoch: 4 | loss: 0.3028986
	speed: 0.0665s/iter; left time: 511.2016s
	iters: 300, epoch: 4 | loss: 0.2089919
	speed: 0.0664s/iter; left time: 503.6650s
	iters: 400, epoch: 4 | loss: 0.1923496
	speed: 0.0663s/iter; left time: 496.4837s
	iters: 500, epoch: 4 | loss: 0.3118823
	speed: 0.0663s/iter; left time: 489.6276s
	iters: 600, epoch: 4 | loss: 0.2819234
	speed: 0.0664s/iter; left time: 484.1872s
	iters: 700, epoch: 4 | loss: 0.2016715
	speed: 0.0666s/iter; left time: 478.7021s
	iters: 800, epoch: 4 | loss: 0.3951713
	speed: 0.0680s/iter; left time: 482.2366s
	iters: 900, epoch: 4 | loss: 0.3742163
	speed: 0.0684s/iter; left time: 477.8608s
	iters: 1000, epoch: 4 | loss: 0.2377060
	speed: 0.0679s/iter; left time: 468.0120s
	iters: 1100, epoch: 4 | loss: 0.2576132
	speed: 0.0683s/iter; left time: 463.4808s
Epoch: 4 cost time: 75.582594871521
Epoch: 4, Steps: 1127 | Train Loss: 0.2767798 Vali Loss: 0.7945771 Test Loss: 1.0970656
Validation loss decreased (0.797144 --> 0.794577).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2853423
	speed: 0.2179s/iter; left time: 1451.5916s
	iters: 200, epoch: 5 | loss: 0.2216539
	speed: 0.0667s/iter; left time: 437.7790s
	iters: 300, epoch: 5 | loss: 0.2573681
	speed: 0.0668s/iter; left time: 431.4170s
	iters: 400, epoch: 5 | loss: 0.2633876
	speed: 0.0668s/iter; left time: 425.0424s
	iters: 500, epoch: 5 | loss: 0.2301090
	speed: 0.0668s/iter; left time: 418.0856s
	iters: 600, epoch: 5 | loss: 0.2990236
	speed: 0.0665s/iter; left time: 409.9113s
	iters: 700, epoch: 5 | loss: 0.3168383
	speed: 0.0667s/iter; left time: 404.6815s
	iters: 800, epoch: 5 | loss: 0.2252576
	speed: 0.0667s/iter; left time: 397.7874s
	iters: 900, epoch: 5 | loss: 0.2161661
	speed: 0.0667s/iter; left time: 390.7754s
	iters: 1000, epoch: 5 | loss: 0.1872172
	speed: 0.0667s/iter; left time: 384.5508s
	iters: 1100, epoch: 5 | loss: 0.2851576
	speed: 0.0667s/iter; left time: 377.8351s
Epoch: 5 cost time: 75.16050243377686
Epoch: 5, Steps: 1127 | Train Loss: 0.2636616 Vali Loss: 0.8238775 Test Loss: 1.1414349
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2194674
	speed: 0.2169s/iter; left time: 1200.9615s
	iters: 200, epoch: 6 | loss: 0.3672494
	speed: 0.0678s/iter; left time: 368.5620s
	iters: 300, epoch: 6 | loss: 0.2019719
	speed: 0.0673s/iter; left time: 358.9440s
	iters: 400, epoch: 6 | loss: 0.2190579
	speed: 0.0666s/iter; left time: 348.6525s
	iters: 500, epoch: 6 | loss: 0.2808575
	speed: 0.0667s/iter; left time: 342.4190s
	iters: 600, epoch: 6 | loss: 0.3535924
	speed: 0.0667s/iter; left time: 335.7320s
	iters: 700, epoch: 6 | loss: 0.2413472
	speed: 0.0665s/iter; left time: 328.4440s
	iters: 800, epoch: 6 | loss: 0.1841307
	speed: 0.0664s/iter; left time: 321.3249s
	iters: 900, epoch: 6 | loss: 0.2012263
	speed: 0.0668s/iter; left time: 316.4018s
	iters: 1000, epoch: 6 | loss: 0.4044078
	speed: 0.0666s/iter; left time: 308.7924s
	iters: 1100, epoch: 6 | loss: 0.1920102
	speed: 0.0666s/iter; left time: 301.9722s
Epoch: 6 cost time: 75.3657398223877
Epoch: 6, Steps: 1127 | Train Loss: 0.2576050 Vali Loss: 0.8203417 Test Loss: 1.1264223
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1854021
	speed: 0.2151s/iter; left time: 948.4123s
	iters: 200, epoch: 7 | loss: 0.1932171
	speed: 0.0664s/iter; left time: 286.2617s
	iters: 300, epoch: 7 | loss: 0.2805043
	speed: 0.0664s/iter; left time: 279.5276s
	iters: 400, epoch: 7 | loss: 0.2924619
	speed: 0.0679s/iter; left time: 278.8011s
	iters: 500, epoch: 7 | loss: 0.2467311
	speed: 0.0680s/iter; left time: 272.6822s
	iters: 600, epoch: 7 | loss: 0.1728459
	speed: 0.0678s/iter; left time: 265.1415s
	iters: 700, epoch: 7 | loss: 0.2765689
	speed: 0.0677s/iter; left time: 257.9083s
	iters: 800, epoch: 7 | loss: 0.2020633
	speed: 0.0669s/iter; left time: 248.3025s
	iters: 900, epoch: 7 | loss: 0.4000264
	speed: 0.0664s/iter; left time: 239.6632s
	iters: 1000, epoch: 7 | loss: 0.1670553
	speed: 0.0665s/iter; left time: 233.3523s
	iters: 1100, epoch: 7 | loss: 0.3337949
	speed: 0.0667s/iter; left time: 227.5256s
Epoch: 7 cost time: 75.5271167755127
Epoch: 7, Steps: 1127 | Train Loss: 0.2545774 Vali Loss: 0.8212274 Test Loss: 1.1315910
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : weather_720_Informer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed28649<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9820
mse:1.0969350337982178, mae:0.7760292291641235
