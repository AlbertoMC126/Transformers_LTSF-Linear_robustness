Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=21, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=21, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Autoformer', model_id='weather_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=96, root_path='./dataset/', seed=28649, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_96_Autoformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed28649>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36696
val 5175
test 10444
	iters: 100, epoch: 1 | loss: 0.4861250
	speed: 0.0816s/iter; left time: 927.0181s
	iters: 200, epoch: 1 | loss: 0.3893061
	speed: 0.0473s/iter; left time: 532.2126s
	iters: 300, epoch: 1 | loss: 0.3879397
	speed: 0.0474s/iter; left time: 528.6041s
	iters: 400, epoch: 1 | loss: 0.4373428
	speed: 0.0473s/iter; left time: 523.0827s
	iters: 500, epoch: 1 | loss: 0.3623227
	speed: 0.0475s/iter; left time: 520.6802s
	iters: 600, epoch: 1 | loss: 0.3311864
	speed: 0.0473s/iter; left time: 513.9480s
	iters: 700, epoch: 1 | loss: 0.5336343
	speed: 0.0474s/iter; left time: 510.1547s
	iters: 800, epoch: 1 | loss: 0.5542794
	speed: 0.0472s/iter; left time: 503.7166s
	iters: 900, epoch: 1 | loss: 0.4182816
	speed: 0.0473s/iter; left time: 499.4503s
	iters: 1000, epoch: 1 | loss: 0.4340695
	speed: 0.0473s/iter; left time: 494.3972s
	iters: 1100, epoch: 1 | loss: 0.3491731
	speed: 0.0473s/iter; left time: 490.3404s
Epoch: 1 cost time: 57.688074350357056
Epoch: 1, Steps: 1146 | Train Loss: 0.5172911 Vali Loss: 0.5188013 Test Loss: 0.2325968
Validation loss decreased (inf --> 0.518801).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2890676
	speed: 0.2116s/iter; left time: 2161.1179s
	iters: 200, epoch: 2 | loss: 0.3664849
	speed: 0.0473s/iter; left time: 478.2828s
	iters: 300, epoch: 2 | loss: 0.5975124
	speed: 0.0474s/iter; left time: 475.0977s
	iters: 400, epoch: 2 | loss: 0.2503292
	speed: 0.0472s/iter; left time: 468.4528s
	iters: 500, epoch: 2 | loss: 0.3441806
	speed: 0.0472s/iter; left time: 463.5633s
	iters: 600, epoch: 2 | loss: 0.2520729
	speed: 0.0472s/iter; left time: 459.0164s
	iters: 700, epoch: 2 | loss: 0.3191077
	speed: 0.0473s/iter; left time: 454.6578s
	iters: 800, epoch: 2 | loss: 0.3955224
	speed: 0.0474s/iter; left time: 451.0475s
	iters: 900, epoch: 2 | loss: 0.2743828
	speed: 0.0474s/iter; left time: 446.1648s
	iters: 1000, epoch: 2 | loss: 0.3147267
	speed: 0.0474s/iter; left time: 441.4059s
	iters: 1100, epoch: 2 | loss: 0.2489401
	speed: 0.0474s/iter; left time: 436.9334s
Epoch: 2 cost time: 54.26400971412659
Epoch: 2, Steps: 1146 | Train Loss: 0.4442873 Vali Loss: 0.4893033 Test Loss: 0.2320390
Validation loss decreased (0.518801 --> 0.489303).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3211442
	speed: 0.2118s/iter; left time: 1921.2660s
	iters: 200, epoch: 3 | loss: 0.2523603
	speed: 0.0473s/iter; left time: 424.3226s
	iters: 300, epoch: 3 | loss: 0.2883545
	speed: 0.0474s/iter; left time: 420.6759s
	iters: 400, epoch: 3 | loss: 0.3096300
	speed: 0.0474s/iter; left time: 415.4468s
	iters: 500, epoch: 3 | loss: 0.2291704
	speed: 0.0474s/iter; left time: 410.7264s
	iters: 600, epoch: 3 | loss: 0.3178128
	speed: 0.0474s/iter; left time: 406.2654s
	iters: 700, epoch: 3 | loss: 0.2457091
	speed: 0.0476s/iter; left time: 403.1232s
	iters: 800, epoch: 3 | loss: 0.3059674
	speed: 0.0476s/iter; left time: 398.1671s
	iters: 900, epoch: 3 | loss: 0.4414960
	speed: 0.0474s/iter; left time: 392.2778s
	iters: 1000, epoch: 3 | loss: 1.2166450
	speed: 0.0473s/iter; left time: 386.6936s
	iters: 1100, epoch: 3 | loss: 0.2981894
	speed: 0.0475s/iter; left time: 383.1160s
Epoch: 3 cost time: 54.37055683135986
Epoch: 3, Steps: 1146 | Train Loss: 0.4064303 Vali Loss: 0.4975014 Test Loss: 0.2511548
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2643958
	speed: 0.2103s/iter; left time: 1666.4369s
	iters: 200, epoch: 4 | loss: 0.3700685
	speed: 0.0476s/iter; left time: 372.0348s
	iters: 300, epoch: 4 | loss: 0.3130233
	speed: 0.0480s/iter; left time: 370.4075s
	iters: 400, epoch: 4 | loss: 0.3594264
	speed: 0.0475s/iter; left time: 362.1329s
	iters: 500, epoch: 4 | loss: 0.2059007
	speed: 0.0476s/iter; left time: 358.1752s
	iters: 600, epoch: 4 | loss: 0.2283546
	speed: 0.0476s/iter; left time: 353.1214s
	iters: 700, epoch: 4 | loss: 0.2789214
	speed: 0.0474s/iter; left time: 347.3408s
	iters: 800, epoch: 4 | loss: 0.2865361
	speed: 0.0475s/iter; left time: 342.8908s
	iters: 900, epoch: 4 | loss: 0.2962033
	speed: 0.0476s/iter; left time: 338.9997s
	iters: 1000, epoch: 4 | loss: 0.4261461
	speed: 0.0477s/iter; left time: 334.9777s
	iters: 1100, epoch: 4 | loss: 0.3136745
	speed: 0.0474s/iter; left time: 328.4761s
Epoch: 4 cost time: 54.52787256240845
Epoch: 4, Steps: 1146 | Train Loss: 0.3768333 Vali Loss: 0.4982150 Test Loss: 0.2511287
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2073121
	speed: 0.2099s/iter; left time: 1422.3996s
	iters: 200, epoch: 5 | loss: 0.3078378
	speed: 0.0473s/iter; left time: 315.5896s
	iters: 300, epoch: 5 | loss: 0.2984814
	speed: 0.0475s/iter; left time: 312.6853s
	iters: 400, epoch: 5 | loss: 0.2777833
	speed: 0.0475s/iter; left time: 307.4338s
	iters: 500, epoch: 5 | loss: 0.5270371
	speed: 0.0474s/iter; left time: 302.2293s
	iters: 600, epoch: 5 | loss: 0.2763232
	speed: 0.0472s/iter; left time: 296.3438s
	iters: 700, epoch: 5 | loss: 0.4639900
	speed: 0.0473s/iter; left time: 291.9364s
	iters: 800, epoch: 5 | loss: 0.3279198
	speed: 0.0475s/iter; left time: 288.5835s
	iters: 900, epoch: 5 | loss: 0.2890817
	speed: 0.0472s/iter; left time: 282.1239s
	iters: 1000, epoch: 5 | loss: 0.2942150
	speed: 0.0474s/iter; left time: 278.4066s
	iters: 1100, epoch: 5 | loss: 0.4460377
	speed: 0.0473s/iter; left time: 273.0952s
Epoch: 5 cost time: 54.248717308044434
Epoch: 5, Steps: 1146 | Train Loss: 0.3600865 Vali Loss: 0.4982504 Test Loss: 0.2494020
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : weather_96_Autoformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed28649<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
mse:0.2323465794324875, mae:0.30930501222610474
