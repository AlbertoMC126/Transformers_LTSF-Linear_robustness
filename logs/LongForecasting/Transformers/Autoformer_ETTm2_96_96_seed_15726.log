Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Autoformer', model_id='ETTm2_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=96, root_path='./dataset/', seed=15726, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm2_96_Autoformer_ETTm2_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed15726>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34369
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.2053617
	speed: 0.0812s/iter; left time: 864.4103s
	iters: 200, epoch: 1 | loss: 0.1607571
	speed: 0.0472s/iter; left time: 497.4912s
	iters: 300, epoch: 1 | loss: 0.2121074
	speed: 0.0472s/iter; left time: 493.1123s
	iters: 400, epoch: 1 | loss: 0.2268355
	speed: 0.0472s/iter; left time: 488.0324s
	iters: 500, epoch: 1 | loss: 0.2590539
	speed: 0.0473s/iter; left time: 484.6636s
	iters: 600, epoch: 1 | loss: 0.1656737
	speed: 0.0472s/iter; left time: 478.6638s
	iters: 700, epoch: 1 | loss: 0.2899669
	speed: 0.0473s/iter; left time: 475.0154s
	iters: 800, epoch: 1 | loss: 0.2939672
	speed: 0.0473s/iter; left time: 469.7501s
	iters: 900, epoch: 1 | loss: 0.5307626
	speed: 0.0473s/iter; left time: 465.6934s
	iters: 1000, epoch: 1 | loss: 0.1842485
	speed: 0.0473s/iter; left time: 460.8708s
Epoch: 1 cost time: 54.17817139625549
Epoch: 1, Steps: 1074 | Train Loss: 0.2777312 Vali Loss: 0.1546789 Test Loss: 0.2350134
Validation loss decreased (inf --> 0.154679).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1946528
	speed: 0.2772s/iter; left time: 2651.5236s
	iters: 200, epoch: 2 | loss: 0.1756309
	speed: 0.0472s/iter; left time: 447.0541s
	iters: 300, epoch: 2 | loss: 0.1614152
	speed: 0.0473s/iter; left time: 442.8709s
	iters: 400, epoch: 2 | loss: 0.2899228
	speed: 0.0472s/iter; left time: 437.0054s
	iters: 500, epoch: 2 | loss: 0.2584098
	speed: 0.0473s/iter; left time: 433.2781s
	iters: 600, epoch: 2 | loss: 0.1068362
	speed: 0.0472s/iter; left time: 428.3985s
	iters: 700, epoch: 2 | loss: 0.1640499
	speed: 0.0473s/iter; left time: 424.2422s
	iters: 800, epoch: 2 | loss: 0.1486297
	speed: 0.0473s/iter; left time: 419.4124s
	iters: 900, epoch: 2 | loss: 0.3227157
	speed: 0.0473s/iter; left time: 414.6148s
	iters: 1000, epoch: 2 | loss: 0.2501021
	speed: 0.0473s/iter; left time: 409.9383s
Epoch: 2 cost time: 50.75467300415039
Epoch: 2, Steps: 1074 | Train Loss: 0.2455214 Vali Loss: 0.1840707 Test Loss: 0.4518879
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2106181
	speed: 0.2742s/iter; left time: 2328.6218s
	iters: 200, epoch: 3 | loss: 0.2056663
	speed: 0.0472s/iter; left time: 396.3400s
	iters: 300, epoch: 3 | loss: 0.1840140
	speed: 0.0473s/iter; left time: 392.1531s
	iters: 400, epoch: 3 | loss: 0.1572034
	speed: 0.0471s/iter; left time: 386.0928s
	iters: 500, epoch: 3 | loss: 0.2046346
	speed: 0.0472s/iter; left time: 382.1564s
	iters: 600, epoch: 3 | loss: 0.1166290
	speed: 0.0473s/iter; left time: 377.7795s
	iters: 700, epoch: 3 | loss: 0.2049329
	speed: 0.0473s/iter; left time: 373.1298s
	iters: 800, epoch: 3 | loss: 0.1428294
	speed: 0.0474s/iter; left time: 369.0004s
	iters: 900, epoch: 3 | loss: 0.1371629
	speed: 0.0473s/iter; left time: 363.5654s
	iters: 1000, epoch: 3 | loss: 0.2958957
	speed: 0.0473s/iter; left time: 358.9650s
Epoch: 3 cost time: 50.72525334358215
Epoch: 3, Steps: 1074 | Train Loss: 0.2209248 Vali Loss: 0.1688738 Test Loss: 0.3485692
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1676524
	speed: 0.2739s/iter; left time: 2031.6943s
	iters: 200, epoch: 4 | loss: 0.1958585
	speed: 0.0472s/iter; left time: 345.3955s
	iters: 300, epoch: 4 | loss: 0.1945626
	speed: 0.0473s/iter; left time: 341.6680s
	iters: 400, epoch: 4 | loss: 0.2057184
	speed: 0.0473s/iter; left time: 336.5628s
	iters: 500, epoch: 4 | loss: 0.3353646
	speed: 0.0473s/iter; left time: 332.2101s
	iters: 600, epoch: 4 | loss: 0.1705841
	speed: 0.0472s/iter; left time: 326.7622s
	iters: 700, epoch: 4 | loss: 0.2809678
	speed: 0.0471s/iter; left time: 321.5120s
	iters: 800, epoch: 4 | loss: 0.2038553
	speed: 0.0472s/iter; left time: 317.3934s
	iters: 900, epoch: 4 | loss: 0.1813036
	speed: 0.0474s/iter; left time: 313.7315s
	iters: 1000, epoch: 4 | loss: 0.1540318
	speed: 0.0472s/iter; left time: 307.7843s
Epoch: 4 cost time: 50.7468535900116
Epoch: 4, Steps: 1074 | Train Loss: 0.2084622 Vali Loss: 0.1889260 Test Loss: 0.4840067
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : ETTm2_96_Autoformer_ETTm2_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed15726<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.23533985018730164, mae:0.32073748111724854
