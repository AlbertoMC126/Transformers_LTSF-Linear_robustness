Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=21, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=21, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Autoformer', model_id='weather_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=96, root_path='./dataset/', seed=3293, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_96_Autoformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed3293>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36696
val 5175
test 10444
	iters: 100, epoch: 1 | loss: 1.3673228
	speed: 0.0822s/iter; left time: 933.4970s
	iters: 200, epoch: 1 | loss: 0.4447323
	speed: 0.0472s/iter; left time: 531.7835s
	iters: 300, epoch: 1 | loss: 0.4011677
	speed: 0.0474s/iter; left time: 529.2898s
	iters: 400, epoch: 1 | loss: 0.4005536
	speed: 0.0474s/iter; left time: 523.7711s
	iters: 500, epoch: 1 | loss: 0.5536591
	speed: 0.0474s/iter; left time: 519.1082s
	iters: 600, epoch: 1 | loss: 0.3988974
	speed: 0.0475s/iter; left time: 515.9104s
	iters: 700, epoch: 1 | loss: 0.2867347
	speed: 0.0474s/iter; left time: 510.3938s
	iters: 800, epoch: 1 | loss: 0.3428838
	speed: 0.0473s/iter; left time: 503.7594s
	iters: 900, epoch: 1 | loss: 0.3125368
	speed: 0.0474s/iter; left time: 500.8201s
	iters: 1000, epoch: 1 | loss: 0.3236183
	speed: 0.0474s/iter; left time: 495.6846s
	iters: 1100, epoch: 1 | loss: 0.5911800
	speed: 0.0476s/iter; left time: 493.5997s
Epoch: 1 cost time: 57.81922149658203
Epoch: 1, Steps: 1146 | Train Loss: 0.5125339 Vali Loss: 0.5396407 Test Loss: 0.2970995
Validation loss decreased (inf --> 0.539641).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3265402
	speed: 0.2096s/iter; left time: 2140.9407s
	iters: 200, epoch: 2 | loss: 0.3031107
	speed: 0.0479s/iter; left time: 484.6106s
	iters: 300, epoch: 2 | loss: 0.3238614
	speed: 0.0480s/iter; left time: 480.9152s
	iters: 400, epoch: 2 | loss: 1.2579547
	speed: 0.0479s/iter; left time: 474.5682s
	iters: 500, epoch: 2 | loss: 0.4342736
	speed: 0.0478s/iter; left time: 468.8522s
	iters: 600, epoch: 2 | loss: 0.3317623
	speed: 0.0480s/iter; left time: 466.3828s
	iters: 700, epoch: 2 | loss: 0.3196879
	speed: 0.0480s/iter; left time: 461.4111s
	iters: 800, epoch: 2 | loss: 0.3516682
	speed: 0.0473s/iter; left time: 450.0170s
	iters: 900, epoch: 2 | loss: 0.3539829
	speed: 0.0473s/iter; left time: 444.8806s
	iters: 1000, epoch: 2 | loss: 0.9878404
	speed: 0.0473s/iter; left time: 440.6665s
	iters: 1100, epoch: 2 | loss: 0.3241977
	speed: 0.0474s/iter; left time: 436.7795s
Epoch: 2 cost time: 54.59963846206665
Epoch: 2, Steps: 1146 | Train Loss: 0.4407410 Vali Loss: 0.5071453 Test Loss: 0.2472751
Validation loss decreased (0.539641 --> 0.507145).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 1.2224560
	speed: 0.2101s/iter; left time: 1905.3089s
	iters: 200, epoch: 3 | loss: 1.1824485
	speed: 0.0472s/iter; left time: 423.7030s
	iters: 300, epoch: 3 | loss: 1.2007990
	speed: 0.0473s/iter; left time: 419.4860s
	iters: 400, epoch: 3 | loss: 0.3917640
	speed: 0.0473s/iter; left time: 414.6037s
	iters: 500, epoch: 3 | loss: 0.2904098
	speed: 0.0474s/iter; left time: 410.6529s
	iters: 600, epoch: 3 | loss: 0.3405637
	speed: 0.0474s/iter; left time: 405.7859s
	iters: 700, epoch: 3 | loss: 1.5174598
	speed: 0.0474s/iter; left time: 401.3790s
	iters: 800, epoch: 3 | loss: 0.3247573
	speed: 0.0474s/iter; left time: 397.0490s
	iters: 900, epoch: 3 | loss: 0.3603488
	speed: 0.0474s/iter; left time: 391.9398s
	iters: 1000, epoch: 3 | loss: 0.4297965
	speed: 0.0474s/iter; left time: 386.9673s
	iters: 1100, epoch: 3 | loss: 0.2577134
	speed: 0.0473s/iter; left time: 381.9463s
Epoch: 3 cost time: 54.25520181655884
Epoch: 3, Steps: 1146 | Train Loss: 0.4150384 Vali Loss: 0.5235573 Test Loss: 0.2552437
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2246263
	speed: 0.2120s/iter; left time: 1679.4792s
	iters: 200, epoch: 4 | loss: 0.4065126
	speed: 0.0481s/iter; left time: 376.2998s
	iters: 300, epoch: 4 | loss: 0.2007250
	speed: 0.0483s/iter; left time: 373.1933s
	iters: 400, epoch: 4 | loss: 0.2461836
	speed: 0.0476s/iter; left time: 362.5964s
	iters: 500, epoch: 4 | loss: 0.5013412
	speed: 0.0474s/iter; left time: 356.6137s
	iters: 600, epoch: 4 | loss: 0.2395459
	speed: 0.0474s/iter; left time: 352.2205s
	iters: 700, epoch: 4 | loss: 0.2719084
	speed: 0.0473s/iter; left time: 346.1729s
	iters: 800, epoch: 4 | loss: 0.3788779
	speed: 0.0474s/iter; left time: 342.1341s
	iters: 900, epoch: 4 | loss: 0.2830098
	speed: 0.0476s/iter; left time: 338.8403s
	iters: 1000, epoch: 4 | loss: 1.0893862
	speed: 0.0475s/iter; left time: 333.9361s
	iters: 1100, epoch: 4 | loss: 0.2670560
	speed: 0.0475s/iter; left time: 328.7610s
Epoch: 4 cost time: 54.57142972946167
Epoch: 4, Steps: 1146 | Train Loss: 0.3920433 Vali Loss: 0.5062710 Test Loss: 0.2411271
Validation loss decreased (0.507145 --> 0.506271).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3290198
	speed: 0.2112s/iter; left time: 1431.1346s
	iters: 200, epoch: 5 | loss: 0.9845330
	speed: 0.0474s/iter; left time: 316.5067s
	iters: 300, epoch: 5 | loss: 0.3853265
	speed: 0.0473s/iter; left time: 311.1120s
	iters: 400, epoch: 5 | loss: 0.2307543
	speed: 0.0474s/iter; left time: 306.8837s
	iters: 500, epoch: 5 | loss: 0.2925692
	speed: 0.0474s/iter; left time: 302.3023s
	iters: 600, epoch: 5 | loss: 1.1249529
	speed: 0.0477s/iter; left time: 299.2447s
	iters: 700, epoch: 5 | loss: 0.3562100
	speed: 0.0476s/iter; left time: 294.2950s
	iters: 800, epoch: 5 | loss: 0.2649356
	speed: 0.0476s/iter; left time: 289.3687s
	iters: 900, epoch: 5 | loss: 1.0692095
	speed: 0.0480s/iter; left time: 287.0785s
	iters: 1000, epoch: 5 | loss: 0.2407246
	speed: 0.0478s/iter; left time: 280.9277s
	iters: 1100, epoch: 5 | loss: 0.2818057
	speed: 0.0479s/iter; left time: 276.8189s
Epoch: 5 cost time: 54.57440447807312
Epoch: 5, Steps: 1146 | Train Loss: 0.3798123 Vali Loss: 0.5128694 Test Loss: 0.2504317
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4110505
	speed: 0.2103s/iter; left time: 1184.0031s
	iters: 200, epoch: 6 | loss: 0.2797608
	speed: 0.0473s/iter; left time: 261.5636s
	iters: 300, epoch: 6 | loss: 0.2556009
	speed: 0.0473s/iter; left time: 257.0898s
	iters: 400, epoch: 6 | loss: 0.2290879
	speed: 0.0474s/iter; left time: 252.7523s
	iters: 500, epoch: 6 | loss: 0.2885546
	speed: 0.0476s/iter; left time: 248.8735s
	iters: 600, epoch: 6 | loss: 0.2951305
	speed: 0.0475s/iter; left time: 243.9314s
	iters: 700, epoch: 6 | loss: 0.2339221
	speed: 0.0473s/iter; left time: 237.9164s
	iters: 800, epoch: 6 | loss: 0.2695722
	speed: 0.0474s/iter; left time: 233.6429s
	iters: 900, epoch: 6 | loss: 0.3016924
	speed: 0.0475s/iter; left time: 229.6305s
	iters: 1000, epoch: 6 | loss: 0.3071087
	speed: 0.0472s/iter; left time: 223.5251s
	iters: 1100, epoch: 6 | loss: 0.5055192
	speed: 0.0474s/iter; left time: 219.5019s
Epoch: 6 cost time: 54.31447911262512
Epoch: 6, Steps: 1146 | Train Loss: 0.3725055 Vali Loss: 0.5154047 Test Loss: 0.2542507
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3225217
	speed: 0.2072s/iter; left time: 929.2936s
	iters: 200, epoch: 7 | loss: 0.2791714
	speed: 0.0473s/iter; left time: 207.3166s
	iters: 300, epoch: 7 | loss: 0.3830981
	speed: 0.0472s/iter; left time: 202.4530s
	iters: 400, epoch: 7 | loss: 0.4045758
	speed: 0.0473s/iter; left time: 198.1332s
	iters: 500, epoch: 7 | loss: 0.3701570
	speed: 0.0478s/iter; left time: 195.4177s
	iters: 600, epoch: 7 | loss: 0.3647752
	speed: 0.0479s/iter; left time: 190.9055s
	iters: 700, epoch: 7 | loss: 0.2057847
	speed: 0.0479s/iter; left time: 186.0200s
	iters: 800, epoch: 7 | loss: 0.2859717
	speed: 0.0479s/iter; left time: 181.1528s
	iters: 900, epoch: 7 | loss: 0.2676421
	speed: 0.0477s/iter; left time: 175.9282s
	iters: 1000, epoch: 7 | loss: 0.2700560
	speed: 0.0479s/iter; left time: 171.7857s
	iters: 1100, epoch: 7 | loss: 0.4030504
	speed: 0.0476s/iter; left time: 165.9166s
Epoch: 7 cost time: 54.56752872467041
Epoch: 7, Steps: 1146 | Train Loss: 0.3693137 Vali Loss: 0.5166253 Test Loss: 0.2517393
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : weather_96_Autoformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed3293<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
mse:0.24143429100513458, mae:0.31522268056869507
