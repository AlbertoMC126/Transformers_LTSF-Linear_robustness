Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm1', data_path='ETTm1.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Autoformer', model_id='ETTm1_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=336, root_path='./dataset/', seed=28649, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm1_336_Autoformer_ETTm1_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed28649>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34129
val 11185
test 11185
	iters: 100, epoch: 1 | loss: 0.4174476
	speed: 0.1164s/iter; left time: 1229.1887s
	iters: 200, epoch: 1 | loss: 0.3936012
	speed: 0.0824s/iter; left time: 862.1790s
	iters: 300, epoch: 1 | loss: 0.3552342
	speed: 0.0825s/iter; left time: 854.3831s
	iters: 400, epoch: 1 | loss: 0.4389451
	speed: 0.0826s/iter; left time: 847.6548s
	iters: 500, epoch: 1 | loss: 0.4865621
	speed: 0.0826s/iter; left time: 839.1520s
	iters: 600, epoch: 1 | loss: 0.3747819
	speed: 0.0826s/iter; left time: 830.5872s
	iters: 700, epoch: 1 | loss: 0.4829674
	speed: 0.0826s/iter; left time: 822.3659s
	iters: 800, epoch: 1 | loss: 0.4157785
	speed: 0.0825s/iter; left time: 813.8380s
	iters: 900, epoch: 1 | loss: 0.3566237
	speed: 0.0827s/iter; left time: 807.5301s
	iters: 1000, epoch: 1 | loss: 0.3856878
	speed: 0.0832s/iter; left time: 803.4284s
Epoch: 1 cost time: 91.5162045955658
Epoch: 1, Steps: 1066 | Train Loss: 0.4161883 Vali Loss: 0.8433229 Test Loss: 0.5973319
Validation loss decreased (inf --> 0.843323).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3083535
	speed: 0.5190s/iter; left time: 4927.9727s
	iters: 200, epoch: 2 | loss: 0.3691003
	speed: 0.0828s/iter; left time: 777.4706s
	iters: 300, epoch: 2 | loss: 0.3200335
	speed: 0.0826s/iter; left time: 768.0062s
	iters: 400, epoch: 2 | loss: 0.3137233
	speed: 0.0826s/iter; left time: 759.5375s
	iters: 500, epoch: 2 | loss: 0.3287697
	speed: 0.0826s/iter; left time: 751.4408s
	iters: 600, epoch: 2 | loss: 0.3229692
	speed: 0.0827s/iter; left time: 743.9277s
	iters: 700, epoch: 2 | loss: 0.3080686
	speed: 0.0826s/iter; left time: 734.8106s
	iters: 800, epoch: 2 | loss: 0.2867495
	speed: 0.0826s/iter; left time: 726.7679s
	iters: 900, epoch: 2 | loss: 0.3936079
	speed: 0.0829s/iter; left time: 720.6257s
	iters: 1000, epoch: 2 | loss: 0.2747803
	speed: 0.0829s/iter; left time: 712.5405s
Epoch: 2 cost time: 88.16377902030945
Epoch: 2, Steps: 1066 | Train Loss: 0.3416636 Vali Loss: 0.8794153 Test Loss: 0.6513152
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2734665
	speed: 0.5162s/iter; left time: 4351.4245s
	iters: 200, epoch: 3 | loss: 0.3048412
	speed: 0.0825s/iter; left time: 687.2246s
	iters: 300, epoch: 3 | loss: 0.3327659
	speed: 0.0826s/iter; left time: 679.3754s
	iters: 400, epoch: 3 | loss: 0.2970642
	speed: 0.0825s/iter; left time: 670.4683s
	iters: 500, epoch: 3 | loss: 0.2871653
	speed: 0.0825s/iter; left time: 662.2790s
	iters: 600, epoch: 3 | loss: 0.2982966
	speed: 0.0825s/iter; left time: 653.9419s
	iters: 700, epoch: 3 | loss: 0.2909760
	speed: 0.0825s/iter; left time: 645.8147s
	iters: 800, epoch: 3 | loss: 0.2840346
	speed: 0.0826s/iter; left time: 638.5707s
	iters: 900, epoch: 3 | loss: 0.2718514
	speed: 0.0830s/iter; left time: 632.9253s
	iters: 1000, epoch: 3 | loss: 0.3411629
	speed: 0.0831s/iter; left time: 625.8164s
Epoch: 3 cost time: 88.10626935958862
Epoch: 3, Steps: 1066 | Train Loss: 0.3061996 Vali Loss: 0.8957644 Test Loss: 0.6479473
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2932449
	speed: 0.5151s/iter; left time: 3792.5076s
	iters: 200, epoch: 4 | loss: 0.2971318
	speed: 0.0824s/iter; left time: 598.6235s
	iters: 300, epoch: 4 | loss: 0.2677631
	speed: 0.0826s/iter; left time: 591.5280s
	iters: 400, epoch: 4 | loss: 0.3099010
	speed: 0.0824s/iter; left time: 581.9113s
	iters: 500, epoch: 4 | loss: 0.2804212
	speed: 0.0825s/iter; left time: 574.3197s
	iters: 600, epoch: 4 | loss: 0.2721293
	speed: 0.0825s/iter; left time: 566.1641s
	iters: 700, epoch: 4 | loss: 0.2864417
	speed: 0.0828s/iter; left time: 559.9673s
	iters: 800, epoch: 4 | loss: 0.2959054
	speed: 0.0831s/iter; left time: 553.4918s
	iters: 900, epoch: 4 | loss: 0.3001464
	speed: 0.0832s/iter; left time: 545.9283s
	iters: 1000, epoch: 4 | loss: 0.2401730
	speed: 0.0831s/iter; left time: 537.1501s
Epoch: 4 cost time: 88.15509939193726
Epoch: 4, Steps: 1066 | Train Loss: 0.2887800 Vali Loss: 0.8939518 Test Loss: 0.6606526
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : ETTm1_336_Autoformer_ETTm1_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed28649<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
mse:0.5969035625457764, mae:0.5196573734283447
