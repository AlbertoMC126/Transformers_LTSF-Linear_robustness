Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=21, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=21, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Informer', model_id='weather_720', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=720, root_path='./dataset/', seed=3293, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_720_Informer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed3293>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36072
val 4551
test 9820
	iters: 100, epoch: 1 | loss: 0.5678881
	speed: 0.1002s/iter; left time: 1118.8428s
	iters: 200, epoch: 1 | loss: 0.7525561
	speed: 0.0671s/iter; left time: 743.0459s
	iters: 300, epoch: 1 | loss: 0.6260383
	speed: 0.0665s/iter; left time: 729.9895s
	iters: 400, epoch: 1 | loss: 0.6213809
	speed: 0.0666s/iter; left time: 724.0877s
	iters: 500, epoch: 1 | loss: 0.4997895
	speed: 0.0666s/iter; left time: 717.3392s
	iters: 600, epoch: 1 | loss: 0.3349539
	speed: 0.0666s/iter; left time: 710.2393s
	iters: 700, epoch: 1 | loss: 0.3810449
	speed: 0.0666s/iter; left time: 703.6698s
	iters: 800, epoch: 1 | loss: 0.4244730
	speed: 0.0666s/iter; left time: 697.7584s
	iters: 900, epoch: 1 | loss: 0.4793400
	speed: 0.0667s/iter; left time: 691.6967s
	iters: 1000, epoch: 1 | loss: 0.5084574
	speed: 0.0667s/iter; left time: 684.7240s
	iters: 1100, epoch: 1 | loss: 0.2981926
	speed: 0.0666s/iter; left time: 677.8284s
Epoch: 1 cost time: 78.51795506477356
Epoch: 1, Steps: 1127 | Train Loss: 0.5188097 Vali Loss: 1.0000358 Test Loss: 1.5662979
Validation loss decreased (inf --> 1.000036).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3519042
	speed: 0.2178s/iter; left time: 2187.6661s
	iters: 200, epoch: 2 | loss: 0.5387019
	speed: 0.0671s/iter; left time: 666.7973s
	iters: 300, epoch: 2 | loss: 0.4803272
	speed: 0.0683s/iter; left time: 671.9613s
	iters: 400, epoch: 2 | loss: 0.6641367
	speed: 0.0676s/iter; left time: 658.9830s
	iters: 500, epoch: 2 | loss: 0.3264956
	speed: 0.0676s/iter; left time: 651.7580s
	iters: 600, epoch: 2 | loss: 0.4224181
	speed: 0.0677s/iter; left time: 646.2246s
	iters: 700, epoch: 2 | loss: 0.2686879
	speed: 0.0669s/iter; left time: 631.5531s
	iters: 800, epoch: 2 | loss: 0.4291157
	speed: 0.0666s/iter; left time: 622.6676s
	iters: 900, epoch: 2 | loss: 0.4043259
	speed: 0.0668s/iter; left time: 617.8157s
	iters: 1000, epoch: 2 | loss: 0.3097061
	speed: 0.0668s/iter; left time: 611.0949s
	iters: 1100, epoch: 2 | loss: 0.2946487
	speed: 0.0667s/iter; left time: 602.8514s
Epoch: 2 cost time: 75.68711853027344
Epoch: 2, Steps: 1127 | Train Loss: 0.3816734 Vali Loss: 0.8288278 Test Loss: 1.0247719
Validation loss decreased (1.000036 --> 0.828828).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2836085
	speed: 0.2179s/iter; left time: 1943.2279s
	iters: 200, epoch: 3 | loss: 0.4470825
	speed: 0.0667s/iter; left time: 588.0673s
	iters: 300, epoch: 3 | loss: 0.4202775
	speed: 0.0665s/iter; left time: 579.3232s
	iters: 400, epoch: 3 | loss: 0.3554519
	speed: 0.0665s/iter; left time: 573.4328s
	iters: 500, epoch: 3 | loss: 0.2709641
	speed: 0.0665s/iter; left time: 566.5777s
	iters: 600, epoch: 3 | loss: 0.3500746
	speed: 0.0664s/iter; left time: 558.6915s
	iters: 700, epoch: 3 | loss: 0.3089779
	speed: 0.0673s/iter; left time: 559.4979s
	iters: 800, epoch: 3 | loss: 0.2436015
	speed: 0.0676s/iter; left time: 555.3388s
	iters: 900, epoch: 3 | loss: 0.3695282
	speed: 0.0675s/iter; left time: 547.9520s
	iters: 1000, epoch: 3 | loss: 0.4119687
	speed: 0.0673s/iter; left time: 539.8279s
	iters: 1100, epoch: 3 | loss: 0.3235158
	speed: 0.0674s/iter; left time: 533.8028s
Epoch: 3 cost time: 75.45398783683777
Epoch: 3, Steps: 1127 | Train Loss: 0.3087492 Vali Loss: 0.8549173 Test Loss: 1.1004736
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2166985
	speed: 0.2150s/iter; left time: 1674.6599s
	iters: 200, epoch: 4 | loss: 0.2767027
	speed: 0.0666s/iter; left time: 512.1911s
	iters: 300, epoch: 4 | loss: 0.2135869
	speed: 0.0665s/iter; left time: 504.8110s
	iters: 400, epoch: 4 | loss: 0.2028219
	speed: 0.0664s/iter; left time: 497.6250s
	iters: 500, epoch: 4 | loss: 0.3301574
	speed: 0.0665s/iter; left time: 491.0678s
	iters: 600, epoch: 4 | loss: 0.2225721
	speed: 0.0665s/iter; left time: 484.7129s
	iters: 700, epoch: 4 | loss: 0.2574047
	speed: 0.0664s/iter; left time: 477.3410s
	iters: 800, epoch: 4 | loss: 0.2867362
	speed: 0.0664s/iter; left time: 470.6194s
	iters: 900, epoch: 4 | loss: 0.2992636
	speed: 0.0664s/iter; left time: 463.8586s
	iters: 1000, epoch: 4 | loss: 0.1861951
	speed: 0.0663s/iter; left time: 457.0694s
	iters: 1100, epoch: 4 | loss: 0.1882364
	speed: 0.0664s/iter; left time: 450.6347s
Epoch: 4 cost time: 74.90447115898132
Epoch: 4, Steps: 1127 | Train Loss: 0.2793718 Vali Loss: 0.8032973 Test Loss: 1.0170584
Validation loss decreased (0.828828 --> 0.803297).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1666966
	speed: 0.2213s/iter; left time: 1474.8206s
	iters: 200, epoch: 5 | loss: 0.3021170
	speed: 0.0681s/iter; left time: 446.8323s
	iters: 300, epoch: 5 | loss: 0.2855258
	speed: 0.0671s/iter; left time: 433.9133s
	iters: 400, epoch: 5 | loss: 0.2668772
	speed: 0.0667s/iter; left time: 424.3846s
	iters: 500, epoch: 5 | loss: 0.3733796
	speed: 0.0666s/iter; left time: 417.3252s
	iters: 600, epoch: 5 | loss: 0.2970305
	speed: 0.0668s/iter; left time: 411.4886s
	iters: 700, epoch: 5 | loss: 0.2216545
	speed: 0.0666s/iter; left time: 404.0152s
	iters: 800, epoch: 5 | loss: 0.3052136
	speed: 0.0666s/iter; left time: 397.3627s
	iters: 900, epoch: 5 | loss: 0.2024146
	speed: 0.0666s/iter; left time: 390.7237s
	iters: 1000, epoch: 5 | loss: 0.1982659
	speed: 0.0667s/iter; left time: 384.5439s
	iters: 1100, epoch: 5 | loss: 0.2114215
	speed: 0.0668s/iter; left time: 378.1057s
Epoch: 5 cost time: 75.52843737602234
Epoch: 5, Steps: 1127 | Train Loss: 0.2665787 Vali Loss: 0.8116300 Test Loss: 1.0409659
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3773192
	speed: 0.2156s/iter; left time: 1193.4101s
	iters: 200, epoch: 6 | loss: 0.2167321
	speed: 0.0667s/iter; left time: 362.8032s
	iters: 300, epoch: 6 | loss: 0.1974191
	speed: 0.0671s/iter; left time: 358.0629s
	iters: 400, epoch: 6 | loss: 0.2566055
	speed: 0.0676s/iter; left time: 353.8614s
	iters: 500, epoch: 6 | loss: 0.2016236
	speed: 0.0676s/iter; left time: 347.2847s
	iters: 600, epoch: 6 | loss: 0.4792423
	speed: 0.0675s/iter; left time: 339.8037s
	iters: 700, epoch: 6 | loss: 0.1555558
	speed: 0.0675s/iter; left time: 333.0428s
	iters: 800, epoch: 6 | loss: 0.1778725
	speed: 0.0666s/iter; left time: 322.2539s
	iters: 900, epoch: 6 | loss: 0.1961453
	speed: 0.0668s/iter; left time: 316.2073s
	iters: 1000, epoch: 6 | loss: 0.1839283
	speed: 0.0666s/iter; left time: 308.8956s
	iters: 1100, epoch: 6 | loss: 0.1865926
	speed: 0.0666s/iter; left time: 302.2743s
Epoch: 6 cost time: 75.54090929031372
Epoch: 6, Steps: 1127 | Train Loss: 0.2602627 Vali Loss: 0.8119296 Test Loss: 1.0420918
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.4221176
	speed: 0.2155s/iter; left time: 949.9603s
	iters: 200, epoch: 7 | loss: 0.1898442
	speed: 0.0665s/iter; left time: 286.6140s
	iters: 300, epoch: 7 | loss: 0.3839594
	speed: 0.0665s/iter; left time: 280.0578s
	iters: 400, epoch: 7 | loss: 0.2015312
	speed: 0.0664s/iter; left time: 272.9381s
	iters: 500, epoch: 7 | loss: 0.2095957
	speed: 0.0665s/iter; left time: 266.4649s
	iters: 600, epoch: 7 | loss: 0.1777200
	speed: 0.0665s/iter; left time: 260.0982s
	iters: 700, epoch: 7 | loss: 0.1855574
	speed: 0.0666s/iter; left time: 253.5565s
	iters: 800, epoch: 7 | loss: 0.2848408
	speed: 0.0674s/iter; left time: 249.9701s
	iters: 900, epoch: 7 | loss: 0.2263591
	speed: 0.0679s/iter; left time: 244.9266s
	iters: 1000, epoch: 7 | loss: 0.3494885
	speed: 0.0675s/iter; left time: 237.0132s
	iters: 1100, epoch: 7 | loss: 0.2744251
	speed: 0.0677s/iter; left time: 230.9185s
Epoch: 7 cost time: 75.4349753856659
Epoch: 7, Steps: 1127 | Train Loss: 0.2573390 Vali Loss: 0.8037508 Test Loss: 1.0326362
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : weather_720_Informer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed3293<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9820
mse:1.0169250965118408, mae:0.7528036236763
