Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=21, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=21, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Autoformer', model_id='weather_720', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=720, root_path='./dataset/', seed=15349, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_720_Autoformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed15349>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36072
val 4551
test 9820
	iters: 100, epoch: 1 | loss: 0.9881455
	speed: 0.1788s/iter; left time: 1997.0781s
	iters: 200, epoch: 1 | loss: 0.8495594
	speed: 0.1436s/iter; left time: 1589.4803s
	iters: 300, epoch: 1 | loss: 0.6739987
	speed: 0.1436s/iter; left time: 1575.4131s
	iters: 400, epoch: 1 | loss: 0.6906419
	speed: 0.1439s/iter; left time: 1564.1370s
	iters: 500, epoch: 1 | loss: 0.8462510
	speed: 0.1441s/iter; left time: 1551.7580s
	iters: 600, epoch: 1 | loss: 0.8436414
	speed: 0.1439s/iter; left time: 1536.0876s
	iters: 700, epoch: 1 | loss: 0.6415708
	speed: 0.1437s/iter; left time: 1519.1947s
	iters: 800, epoch: 1 | loss: 0.5692440
	speed: 0.1438s/iter; left time: 1505.6705s
	iters: 900, epoch: 1 | loss: 0.6345814
	speed: 0.1437s/iter; left time: 1490.1924s
	iters: 1000, epoch: 1 | loss: 0.6347245
	speed: 0.1438s/iter; left time: 1477.1339s
	iters: 1100, epoch: 1 | loss: 0.6259349
	speed: 0.1440s/iter; left time: 1464.2371s
Epoch: 1 cost time: 165.65763974189758
Epoch: 1, Steps: 1127 | Train Loss: 0.7420335 Vali Loss: 0.8416642 Test Loss: 0.4540537
Validation loss decreased (inf --> 0.841664).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6488979
	speed: 0.6654s/iter; left time: 6683.0694s
	iters: 200, epoch: 2 | loss: 0.7904926
	speed: 0.1438s/iter; left time: 1430.3901s
	iters: 300, epoch: 2 | loss: 0.7291037
	speed: 0.1437s/iter; left time: 1414.4788s
	iters: 400, epoch: 2 | loss: 0.7124721
	speed: 0.1438s/iter; left time: 1400.8895s
	iters: 500, epoch: 2 | loss: 0.7814894
	speed: 0.1438s/iter; left time: 1386.3466s
	iters: 600, epoch: 2 | loss: 0.6657252
	speed: 0.1439s/iter; left time: 1373.1125s
	iters: 700, epoch: 2 | loss: 0.5561415
	speed: 0.1438s/iter; left time: 1358.2676s
	iters: 800, epoch: 2 | loss: 0.6918018
	speed: 0.1440s/iter; left time: 1345.0990s
	iters: 900, epoch: 2 | loss: 0.5902406
	speed: 0.1441s/iter; left time: 1331.7538s
	iters: 1000, epoch: 2 | loss: 0.7186064
	speed: 0.1438s/iter; left time: 1314.5520s
	iters: 1100, epoch: 2 | loss: 0.7435025
	speed: 0.1439s/iter; left time: 1301.2162s
Epoch: 2 cost time: 162.1050260066986
Epoch: 2, Steps: 1127 | Train Loss: 0.7102275 Vali Loss: 0.8059804 Test Loss: 0.4088278
Validation loss decreased (0.841664 --> 0.805980).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.6123633
	speed: 0.6619s/iter; left time: 5901.8665s
	iters: 200, epoch: 3 | loss: 0.6560110
	speed: 0.1437s/iter; left time: 1266.7079s
	iters: 300, epoch: 3 | loss: 0.6454060
	speed: 0.1436s/iter; left time: 1252.1240s
	iters: 400, epoch: 3 | loss: 0.5824787
	speed: 0.1438s/iter; left time: 1238.9375s
	iters: 500, epoch: 3 | loss: 0.7134125
	speed: 0.1437s/iter; left time: 1224.2995s
	iters: 600, epoch: 3 | loss: 0.5226712
	speed: 0.1435s/iter; left time: 1207.9899s
	iters: 700, epoch: 3 | loss: 0.8067526
	speed: 0.1435s/iter; left time: 1193.5037s
	iters: 800, epoch: 3 | loss: 0.6038170
	speed: 0.1437s/iter; left time: 1180.4003s
	iters: 900, epoch: 3 | loss: 0.8466945
	speed: 0.1439s/iter; left time: 1167.8166s
	iters: 1000, epoch: 3 | loss: 0.7027031
	speed: 0.1440s/iter; left time: 1154.4997s
	iters: 1100, epoch: 3 | loss: 0.6119541
	speed: 0.1436s/iter; left time: 1137.2365s
Epoch: 3 cost time: 161.99119806289673
Epoch: 3, Steps: 1127 | Train Loss: 0.6963093 Vali Loss: 0.8306965 Test Loss: 0.4419610
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.5895612
	speed: 0.6573s/iter; left time: 5120.5626s
	iters: 200, epoch: 4 | loss: 0.6304987
	speed: 0.1437s/iter; left time: 1105.3764s
	iters: 300, epoch: 4 | loss: 0.8317363
	speed: 0.1439s/iter; left time: 1092.0281s
	iters: 400, epoch: 4 | loss: 0.9243963
	speed: 0.1437s/iter; left time: 1076.6330s
	iters: 500, epoch: 4 | loss: 0.5613192
	speed: 0.1438s/iter; left time: 1062.3332s
	iters: 600, epoch: 4 | loss: 0.4876119
	speed: 0.1438s/iter; left time: 1048.2566s
	iters: 700, epoch: 4 | loss: 0.9713550
	speed: 0.1438s/iter; left time: 1033.9221s
	iters: 800, epoch: 4 | loss: 0.5772257
	speed: 0.1437s/iter; left time: 1019.1359s
	iters: 900, epoch: 4 | loss: 0.6908416
	speed: 0.1435s/iter; left time: 1003.0420s
	iters: 1000, epoch: 4 | loss: 0.6275935
	speed: 0.1436s/iter; left time: 989.1076s
	iters: 1100, epoch: 4 | loss: 0.5431663
	speed: 0.1438s/iter; left time: 976.0877s
Epoch: 4 cost time: 161.95988416671753
Epoch: 4, Steps: 1127 | Train Loss: 0.6910434 Vali Loss: 0.8124939 Test Loss: 0.4312214
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.5897224
	speed: 0.6580s/iter; left time: 4384.0703s
	iters: 200, epoch: 5 | loss: 0.6684383
	speed: 0.1438s/iter; left time: 943.6803s
	iters: 300, epoch: 5 | loss: 0.8216566
	speed: 0.1438s/iter; left time: 929.4957s
	iters: 400, epoch: 5 | loss: 0.7588365
	speed: 0.1440s/iter; left time: 916.4644s
	iters: 500, epoch: 5 | loss: 0.7731143
	speed: 0.1439s/iter; left time: 901.0149s
	iters: 600, epoch: 5 | loss: 1.0667011
	speed: 0.1439s/iter; left time: 886.7440s
	iters: 700, epoch: 5 | loss: 0.6980550
	speed: 0.1437s/iter; left time: 871.4092s
	iters: 800, epoch: 5 | loss: 0.7814701
	speed: 0.1438s/iter; left time: 857.7070s
	iters: 900, epoch: 5 | loss: 0.7757937
	speed: 0.1438s/iter; left time: 843.2804s
	iters: 1000, epoch: 5 | loss: 0.7530869
	speed: 0.1438s/iter; left time: 828.9450s
	iters: 1100, epoch: 5 | loss: 0.6644741
	speed: 0.1437s/iter; left time: 813.9607s
Epoch: 5 cost time: 162.0647382736206
Epoch: 5, Steps: 1127 | Train Loss: 0.6877662 Vali Loss: 0.8047237 Test Loss: 0.4281660
Validation loss decreased (0.805980 --> 0.804724).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.7682493
	speed: 0.6630s/iter; left time: 3670.1989s
	iters: 200, epoch: 6 | loss: 0.6047512
	speed: 0.1439s/iter; left time: 781.9976s
	iters: 300, epoch: 6 | loss: 0.6612136
	speed: 0.1438s/iter; left time: 767.3437s
	iters: 400, epoch: 6 | loss: 0.6125643
	speed: 0.1436s/iter; left time: 752.0084s
	iters: 500, epoch: 6 | loss: 0.6738843
	speed: 0.1436s/iter; left time: 737.4752s
	iters: 600, epoch: 6 | loss: 0.8750525
	speed: 0.1437s/iter; left time: 723.8422s
	iters: 700, epoch: 6 | loss: 0.6223643
	speed: 0.1440s/iter; left time: 710.7137s
	iters: 800, epoch: 6 | loss: 0.5372402
	speed: 0.1439s/iter; left time: 695.8728s
	iters: 900, epoch: 6 | loss: 0.7422556
	speed: 0.1436s/iter; left time: 680.1907s
	iters: 1000, epoch: 6 | loss: 0.9319729
	speed: 0.1438s/iter; left time: 666.7458s
	iters: 1100, epoch: 6 | loss: 0.6260648
	speed: 0.1439s/iter; left time: 652.6581s
Epoch: 6 cost time: 162.02106714248657
Epoch: 6, Steps: 1127 | Train Loss: 0.6851667 Vali Loss: 0.8046790 Test Loss: 0.4272405
Validation loss decreased (0.804724 --> 0.804679).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.7671902
	speed: 0.6621s/iter; left time: 2919.0649s
	iters: 200, epoch: 7 | loss: 0.5098260
	speed: 0.1436s/iter; left time: 618.8246s
	iters: 300, epoch: 7 | loss: 0.7165231
	speed: 0.1437s/iter; left time: 604.6578s
	iters: 400, epoch: 7 | loss: 0.5967463
	speed: 0.1436s/iter; left time: 589.9165s
	iters: 500, epoch: 7 | loss: 0.5876725
	speed: 0.1437s/iter; left time: 576.1686s
	iters: 600, epoch: 7 | loss: 0.6647050
	speed: 0.1437s/iter; left time: 561.9006s
	iters: 700, epoch: 7 | loss: 0.7339736
	speed: 0.1437s/iter; left time: 547.2235s
	iters: 800, epoch: 7 | loss: 0.7258995
	speed: 0.1437s/iter; left time: 533.0041s
	iters: 900, epoch: 7 | loss: 0.5901100
	speed: 0.1439s/iter; left time: 519.2005s
	iters: 1000, epoch: 7 | loss: 0.5551132
	speed: 0.1437s/iter; left time: 504.2495s
	iters: 1100, epoch: 7 | loss: 0.6554003
	speed: 0.1437s/iter; left time: 489.8451s
Epoch: 7 cost time: 161.93826508522034
Epoch: 7, Steps: 1127 | Train Loss: 0.6841418 Vali Loss: 0.8048388 Test Loss: 0.4293092
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.7901236
	speed: 0.6574s/iter; left time: 2157.4680s
	iters: 200, epoch: 8 | loss: 0.5517954
	speed: 0.1435s/iter; left time: 456.6955s
	iters: 300, epoch: 8 | loss: 0.6253036
	speed: 0.1439s/iter; left time: 443.4214s
	iters: 400, epoch: 8 | loss: 0.8338508
	speed: 0.1438s/iter; left time: 428.8751s
	iters: 500, epoch: 8 | loss: 0.5214227
	speed: 0.1438s/iter; left time: 414.3281s
	iters: 600, epoch: 8 | loss: 0.6917831
	speed: 0.1437s/iter; left time: 399.8082s
	iters: 700, epoch: 8 | loss: 0.6742729
	speed: 0.1437s/iter; left time: 385.3075s
	iters: 800, epoch: 8 | loss: 0.7003468
	speed: 0.1437s/iter; left time: 371.0787s
	iters: 900, epoch: 8 | loss: 0.7577377
	speed: 0.1436s/iter; left time: 356.3149s
	iters: 1000, epoch: 8 | loss: 0.6902134
	speed: 0.1436s/iter; left time: 341.9666s
	iters: 1100, epoch: 8 | loss: 0.6953582
	speed: 0.1440s/iter; left time: 328.6248s
Epoch: 8 cost time: 161.9431254863739
Epoch: 8, Steps: 1127 | Train Loss: 0.6831158 Vali Loss: 0.8035310 Test Loss: 0.4258909
Validation loss decreased (0.804679 --> 0.803531).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.7108623
	speed: 0.6612s/iter; left time: 1424.9679s
	iters: 200, epoch: 9 | loss: 0.6697257
	speed: 0.1440s/iter; left time: 295.9543s
	iters: 300, epoch: 9 | loss: 0.7356465
	speed: 0.1443s/iter; left time: 282.1503s
	iters: 400, epoch: 9 | loss: 0.7896234
	speed: 0.1442s/iter; left time: 267.5607s
	iters: 500, epoch: 9 | loss: 0.6921991
	speed: 0.1440s/iter; left time: 252.6633s
	iters: 600, epoch: 9 | loss: 0.7503492
	speed: 0.1442s/iter; left time: 238.6379s
	iters: 700, epoch: 9 | loss: 0.6994903
	speed: 0.1437s/iter; left time: 223.4573s
	iters: 800, epoch: 9 | loss: 1.0275233
	speed: 0.1438s/iter; left time: 209.2625s
	iters: 900, epoch: 9 | loss: 0.7051413
	speed: 0.1436s/iter; left time: 194.5266s
	iters: 1000, epoch: 9 | loss: 0.6174877
	speed: 0.1436s/iter; left time: 180.1672s
	iters: 1100, epoch: 9 | loss: 0.5207931
	speed: 0.1437s/iter; left time: 165.9777s
Epoch: 9 cost time: 162.14934968948364
Epoch: 9, Steps: 1127 | Train Loss: 0.6828189 Vali Loss: 0.8032520 Test Loss: 0.4279563
Validation loss decreased (0.803531 --> 0.803252).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.6029161
	speed: 0.6670s/iter; left time: 685.6385s
	iters: 200, epoch: 10 | loss: 0.6808368
	speed: 0.1435s/iter; left time: 133.1933s
	iters: 300, epoch: 10 | loss: 0.6579744
	speed: 0.1435s/iter; left time: 118.8409s
	iters: 400, epoch: 10 | loss: 0.5375997
	speed: 0.1436s/iter; left time: 104.5478s
	iters: 500, epoch: 10 | loss: 1.0695742
	speed: 0.1436s/iter; left time: 90.1846s
	iters: 600, epoch: 10 | loss: 0.6417557
	speed: 0.1439s/iter; left time: 75.9852s
	iters: 700, epoch: 10 | loss: 0.7737348
	speed: 0.1445s/iter; left time: 61.8272s
	iters: 800, epoch: 10 | loss: 0.5751997
	speed: 0.1442s/iter; left time: 47.2881s
	iters: 900, epoch: 10 | loss: 0.9021466
	speed: 0.1437s/iter; left time: 32.7640s
	iters: 1000, epoch: 10 | loss: 0.5818172
	speed: 0.1437s/iter; left time: 18.3929s
	iters: 1100, epoch: 10 | loss: 0.6781940
	speed: 0.1438s/iter; left time: 4.0273s
Epoch: 10 cost time: 162.0146608352661
Epoch: 10, Steps: 1127 | Train Loss: 0.6831867 Vali Loss: 0.8033933 Test Loss: 0.4271770
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : weather_720_Autoformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed15349<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9820
mse:0.42780980467796326, mae:0.43509992957115173
