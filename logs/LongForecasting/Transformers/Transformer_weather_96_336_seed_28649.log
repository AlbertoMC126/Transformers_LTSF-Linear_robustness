Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=21, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=21, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Transformer', model_id='weather_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=336, root_path='./dataset/', seed=28649, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_336_Transformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed28649>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36456
val 4935
test 10204
	iters: 100, epoch: 1 | loss: 0.4276750
	speed: 0.0747s/iter; left time: 843.5592s
	iters: 200, epoch: 1 | loss: 0.3518465
	speed: 0.0440s/iter; left time: 492.9046s
	iters: 300, epoch: 1 | loss: 0.3807502
	speed: 0.0440s/iter; left time: 488.3718s
	iters: 400, epoch: 1 | loss: 1.2762004
	speed: 0.0442s/iter; left time: 485.2857s
	iters: 500, epoch: 1 | loss: 0.3170072
	speed: 0.0442s/iter; left time: 480.9741s
	iters: 600, epoch: 1 | loss: 0.2828347
	speed: 0.0442s/iter; left time: 476.7604s
	iters: 700, epoch: 1 | loss: 0.3497756
	speed: 0.0443s/iter; left time: 473.2115s
	iters: 800, epoch: 1 | loss: 0.5246860
	speed: 0.0443s/iter; left time: 468.7200s
	iters: 900, epoch: 1 | loss: 0.2248143
	speed: 0.0443s/iter; left time: 464.5469s
	iters: 1000, epoch: 1 | loss: 0.2361064
	speed: 0.0443s/iter; left time: 460.5351s
	iters: 1100, epoch: 1 | loss: 0.2429355
	speed: 0.0443s/iter; left time: 456.2439s
Epoch: 1 cost time: 53.40920948982239
Epoch: 1, Steps: 1139 | Train Loss: 0.4245482 Vali Loss: 0.7686039 Test Loss: 0.7179794
Validation loss decreased (inf --> 0.768604).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2237448
	speed: 0.1334s/iter; left time: 1353.8290s
	iters: 200, epoch: 2 | loss: 0.2131580
	speed: 0.0444s/iter; left time: 445.8098s
	iters: 300, epoch: 2 | loss: 0.5063562
	speed: 0.0443s/iter; left time: 441.1894s
	iters: 400, epoch: 2 | loss: 0.2129657
	speed: 0.0444s/iter; left time: 437.0599s
	iters: 500, epoch: 2 | loss: 0.2915772
	speed: 0.0444s/iter; left time: 433.1216s
	iters: 600, epoch: 2 | loss: 0.2252580
	speed: 0.0444s/iter; left time: 428.4310s
	iters: 700, epoch: 2 | loss: 0.2348383
	speed: 0.0444s/iter; left time: 424.2019s
	iters: 800, epoch: 2 | loss: 0.2958454
	speed: 0.0443s/iter; left time: 418.7378s
	iters: 900, epoch: 2 | loss: 0.2211935
	speed: 0.0442s/iter; left time: 413.0032s
	iters: 1000, epoch: 2 | loss: 0.2215103
	speed: 0.0442s/iter; left time: 408.8107s
	iters: 1100, epoch: 2 | loss: 0.1726866
	speed: 0.0442s/iter; left time: 404.4569s
Epoch: 2 cost time: 50.4458065032959
Epoch: 2, Steps: 1139 | Train Loss: 0.2887956 Vali Loss: 0.7799373 Test Loss: 0.7489004
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3427840
	speed: 0.1310s/iter; left time: 1180.2600s
	iters: 200, epoch: 3 | loss: 0.1686288
	speed: 0.0442s/iter; left time: 393.6296s
	iters: 300, epoch: 3 | loss: 0.2297220
	speed: 0.0442s/iter; left time: 389.0997s
	iters: 400, epoch: 3 | loss: 0.2334319
	speed: 0.0441s/iter; left time: 384.6180s
	iters: 500, epoch: 3 | loss: 0.3883650
	speed: 0.0442s/iter; left time: 380.8886s
	iters: 600, epoch: 3 | loss: 0.3902028
	speed: 0.0442s/iter; left time: 376.0884s
	iters: 700, epoch: 3 | loss: 0.1917718
	speed: 0.0442s/iter; left time: 371.5182s
	iters: 800, epoch: 3 | loss: 0.1815739
	speed: 0.0442s/iter; left time: 367.1914s
	iters: 900, epoch: 3 | loss: 0.1454779
	speed: 0.0443s/iter; left time: 363.4455s
	iters: 1000, epoch: 3 | loss: 0.3460003
	speed: 0.0441s/iter; left time: 357.7151s
	iters: 1100, epoch: 3 | loss: 0.1643976
	speed: 0.0441s/iter; left time: 353.3984s
Epoch: 3 cost time: 50.28518724441528
Epoch: 3, Steps: 1139 | Train Loss: 0.2350844 Vali Loss: 0.7547544 Test Loss: 0.7433111
Validation loss decreased (0.768604 --> 0.754754).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.5155683
	speed: 0.1330s/iter; left time: 1047.5837s
	iters: 200, epoch: 4 | loss: 0.2256582
	speed: 0.0441s/iter; left time: 343.1975s
	iters: 300, epoch: 4 | loss: 0.1418268
	speed: 0.0443s/iter; left time: 340.1619s
	iters: 400, epoch: 4 | loss: 0.1587360
	speed: 0.0444s/iter; left time: 336.2880s
	iters: 500, epoch: 4 | loss: 0.1513768
	speed: 0.0444s/iter; left time: 331.7140s
	iters: 600, epoch: 4 | loss: 0.1407542
	speed: 0.0443s/iter; left time: 326.7620s
	iters: 700, epoch: 4 | loss: 0.1336766
	speed: 0.0443s/iter; left time: 322.2407s
	iters: 800, epoch: 4 | loss: 0.3071426
	speed: 0.0444s/iter; left time: 318.8268s
	iters: 900, epoch: 4 | loss: 0.1525067
	speed: 0.0444s/iter; left time: 314.1880s
	iters: 1000, epoch: 4 | loss: 0.1926580
	speed: 0.0442s/iter; left time: 308.3639s
	iters: 1100, epoch: 4 | loss: 0.1674230
	speed: 0.0442s/iter; left time: 303.7277s
Epoch: 4 cost time: 50.42994427680969
Epoch: 4, Steps: 1139 | Train Loss: 0.2149141 Vali Loss: 0.7561537 Test Loss: 0.7249335
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1691654
	speed: 0.1306s/iter; left time: 879.4365s
	iters: 200, epoch: 5 | loss: 0.1156400
	speed: 0.0441s/iter; left time: 292.7970s
	iters: 300, epoch: 5 | loss: 0.3156106
	speed: 0.0441s/iter; left time: 287.9945s
	iters: 400, epoch: 5 | loss: 0.1449503
	speed: 0.0441s/iter; left time: 284.0332s
	iters: 500, epoch: 5 | loss: 0.1345090
	speed: 0.0441s/iter; left time: 279.5794s
	iters: 600, epoch: 5 | loss: 0.1629325
	speed: 0.0441s/iter; left time: 275.1888s
	iters: 700, epoch: 5 | loss: 0.1359070
	speed: 0.0441s/iter; left time: 270.7724s
	iters: 800, epoch: 5 | loss: 0.1530707
	speed: 0.0441s/iter; left time: 266.0838s
	iters: 900, epoch: 5 | loss: 0.3205425
	speed: 0.0441s/iter; left time: 261.9028s
	iters: 1000, epoch: 5 | loss: 0.3671487
	speed: 0.0442s/iter; left time: 257.6749s
	iters: 1100, epoch: 5 | loss: 0.3214250
	speed: 0.0442s/iter; left time: 253.5447s
Epoch: 5 cost time: 50.246586561203
Epoch: 5, Steps: 1139 | Train Loss: 0.2058474 Vali Loss: 0.7549677 Test Loss: 0.7266074
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1714897
	speed: 0.1307s/iter; left time: 731.4635s
	iters: 200, epoch: 6 | loss: 0.2772419
	speed: 0.0441s/iter; left time: 242.6301s
	iters: 300, epoch: 6 | loss: 0.1481632
	speed: 0.0441s/iter; left time: 238.1645s
	iters: 400, epoch: 6 | loss: 0.2882856
	speed: 0.0443s/iter; left time: 234.7249s
	iters: 500, epoch: 6 | loss: 0.1254193
	speed: 0.0445s/iter; left time: 231.4372s
	iters: 600, epoch: 6 | loss: 0.1384281
	speed: 0.0445s/iter; left time: 226.8328s
	iters: 700, epoch: 6 | loss: 0.1346968
	speed: 0.0445s/iter; left time: 222.4283s
	iters: 800, epoch: 6 | loss: 0.1304206
	speed: 0.0445s/iter; left time: 217.6955s
	iters: 900, epoch: 6 | loss: 0.1220023
	speed: 0.0444s/iter; left time: 212.8940s
	iters: 1000, epoch: 6 | loss: 0.2967876
	speed: 0.0444s/iter; left time: 208.7116s
	iters: 1100, epoch: 6 | loss: 0.1795795
	speed: 0.0442s/iter; left time: 203.3426s
Epoch: 6 cost time: 50.48800301551819
Epoch: 6, Steps: 1139 | Train Loss: 0.2012870 Vali Loss: 0.7642925 Test Loss: 0.7353844
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : weather_336_Transformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed28649<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10204
mse:0.7433139085769653, mae:0.5969394445419312
