Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=21, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=21, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Autoformer', model_id='weather_720', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=720, root_path='./dataset/', seed=12890, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_720_Autoformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed12890>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36072
val 4551
test 9820
	iters: 100, epoch: 1 | loss: 0.8346010
	speed: 0.1792s/iter; left time: 2001.9305s
	iters: 200, epoch: 1 | loss: 0.5740644
	speed: 0.1434s/iter; left time: 1587.1843s
	iters: 300, epoch: 1 | loss: 0.7643534
	speed: 0.1436s/iter; left time: 1575.1488s
	iters: 400, epoch: 1 | loss: 0.9598312
	speed: 0.1436s/iter; left time: 1560.9982s
	iters: 500, epoch: 1 | loss: 0.6024320
	speed: 0.1436s/iter; left time: 1547.0305s
	iters: 600, epoch: 1 | loss: 0.7704365
	speed: 0.1436s/iter; left time: 1532.4005s
	iters: 700, epoch: 1 | loss: 0.6983515
	speed: 0.1443s/iter; left time: 1525.5661s
	iters: 800, epoch: 1 | loss: 0.7260244
	speed: 0.1442s/iter; left time: 1510.2400s
	iters: 900, epoch: 1 | loss: 0.6446070
	speed: 0.1439s/iter; left time: 1491.9948s
	iters: 1000, epoch: 1 | loss: 0.6958545
	speed: 0.1436s/iter; left time: 1474.7851s
	iters: 1100, epoch: 1 | loss: 0.7976175
	speed: 0.1438s/iter; left time: 1462.3678s
Epoch: 1 cost time: 165.6505138874054
Epoch: 1, Steps: 1127 | Train Loss: 0.7730196 Vali Loss: 0.8282639 Test Loss: 0.4152037
Validation loss decreased (inf --> 0.828264).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6674899
	speed: 0.6684s/iter; left time: 6713.1592s
	iters: 200, epoch: 2 | loss: 0.6196798
	speed: 0.1441s/iter; left time: 1433.1416s
	iters: 300, epoch: 2 | loss: 0.8992540
	speed: 0.1437s/iter; left time: 1414.4275s
	iters: 400, epoch: 2 | loss: 0.9490713
	speed: 0.1437s/iter; left time: 1399.8168s
	iters: 500, epoch: 2 | loss: 0.6381897
	speed: 0.1436s/iter; left time: 1384.4726s
	iters: 600, epoch: 2 | loss: 0.7239688
	speed: 0.1436s/iter; left time: 1370.2848s
	iters: 700, epoch: 2 | loss: 1.0199338
	speed: 0.1436s/iter; left time: 1356.3570s
	iters: 800, epoch: 2 | loss: 0.6483827
	speed: 0.1437s/iter; left time: 1342.7223s
	iters: 900, epoch: 2 | loss: 0.8603306
	speed: 0.1441s/iter; left time: 1331.8801s
	iters: 1000, epoch: 2 | loss: 0.7886466
	speed: 0.1443s/iter; left time: 1319.5422s
	iters: 1100, epoch: 2 | loss: 0.7015865
	speed: 0.1440s/iter; left time: 1302.0359s
Epoch: 2 cost time: 162.12450170516968
Epoch: 2, Steps: 1127 | Train Loss: 0.7332955 Vali Loss: 0.8365761 Test Loss: 0.4275302
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.6476299
	speed: 0.6638s/iter; left time: 5919.2591s
	iters: 200, epoch: 3 | loss: 0.6879413
	speed: 0.1434s/iter; left time: 1264.6729s
	iters: 300, epoch: 3 | loss: 0.8370191
	speed: 0.1441s/iter; left time: 1256.4901s
	iters: 400, epoch: 3 | loss: 0.5583972
	speed: 0.1443s/iter; left time: 1243.1612s
	iters: 500, epoch: 3 | loss: 0.6633713
	speed: 0.1438s/iter; left time: 1224.8049s
	iters: 600, epoch: 3 | loss: 1.0523226
	speed: 0.1436s/iter; left time: 1208.3395s
	iters: 700, epoch: 3 | loss: 0.6642457
	speed: 0.1437s/iter; left time: 1195.0323s
	iters: 800, epoch: 3 | loss: 0.4965249
	speed: 0.1438s/iter; left time: 1181.2079s
	iters: 900, epoch: 3 | loss: 0.6950936
	speed: 0.1441s/iter; left time: 1169.7758s
	iters: 1000, epoch: 3 | loss: 0.6063191
	speed: 0.1443s/iter; left time: 1157.1742s
	iters: 1100, epoch: 3 | loss: 0.6041710
	speed: 0.1441s/iter; left time: 1140.8849s
Epoch: 3 cost time: 162.13104796409607
Epoch: 3, Steps: 1127 | Train Loss: 0.7009825 Vali Loss: 0.8205747 Test Loss: 0.4263552
Validation loss decreased (0.828264 --> 0.820575).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.5735721
	speed: 0.6674s/iter; left time: 5199.1110s
	iters: 200, epoch: 4 | loss: 0.6900644
	speed: 0.1434s/iter; left time: 1102.8265s
	iters: 300, epoch: 4 | loss: 0.6363434
	speed: 0.1435s/iter; left time: 1089.1127s
	iters: 400, epoch: 4 | loss: 0.6172313
	speed: 0.1437s/iter; left time: 1076.2714s
	iters: 500, epoch: 4 | loss: 0.6714457
	speed: 0.1443s/iter; left time: 1066.4964s
	iters: 600, epoch: 4 | loss: 0.8036624
	speed: 0.1441s/iter; left time: 1050.6981s
	iters: 700, epoch: 4 | loss: 0.6380109
	speed: 0.1437s/iter; left time: 1032.9256s
	iters: 800, epoch: 4 | loss: 0.7009677
	speed: 0.1436s/iter; left time: 1017.8618s
	iters: 900, epoch: 4 | loss: 0.8335117
	speed: 0.1437s/iter; left time: 1004.5669s
	iters: 1000, epoch: 4 | loss: 1.0522751
	speed: 0.1435s/iter; left time: 988.5115s
	iters: 1100, epoch: 4 | loss: 0.6798902
	speed: 0.1436s/iter; left time: 974.7915s
Epoch: 4 cost time: 161.92113733291626
Epoch: 4, Steps: 1127 | Train Loss: 0.6869576 Vali Loss: 0.8257159 Test Loss: 0.4298852
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.5917765
	speed: 0.6644s/iter; left time: 4426.7608s
	iters: 200, epoch: 5 | loss: 0.6750992
	speed: 0.1435s/iter; left time: 941.8572s
	iters: 300, epoch: 5 | loss: 0.7778500
	speed: 0.1437s/iter; left time: 928.7693s
	iters: 400, epoch: 5 | loss: 0.8174011
	speed: 0.1438s/iter; left time: 914.9092s
	iters: 500, epoch: 5 | loss: 0.5609456
	speed: 0.1442s/iter; left time: 903.3019s
	iters: 600, epoch: 5 | loss: 0.8162767
	speed: 0.1442s/iter; left time: 888.9969s
	iters: 700, epoch: 5 | loss: 0.6102293
	speed: 0.1442s/iter; left time: 874.2030s
	iters: 800, epoch: 5 | loss: 0.5529643
	speed: 0.1442s/iter; left time: 859.9816s
	iters: 900, epoch: 5 | loss: 0.5485876
	speed: 0.1440s/iter; left time: 844.0493s
	iters: 1000, epoch: 5 | loss: 0.6767120
	speed: 0.1438s/iter; left time: 828.6524s
	iters: 1100, epoch: 5 | loss: 0.5383354
	speed: 0.1437s/iter; left time: 813.5601s
Epoch: 5 cost time: 162.15956091880798
Epoch: 5, Steps: 1127 | Train Loss: 0.6809670 Vali Loss: 0.8272172 Test Loss: 0.4361800
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.5109338
	speed: 0.6658s/iter; left time: 3685.9547s
	iters: 200, epoch: 6 | loss: 0.5454196
	speed: 0.1442s/iter; left time: 783.7898s
	iters: 300, epoch: 6 | loss: 0.5337490
	speed: 0.1435s/iter; left time: 765.6693s
	iters: 400, epoch: 6 | loss: 0.6397903
	speed: 0.1435s/iter; left time: 751.6134s
	iters: 500, epoch: 6 | loss: 0.5848288
	speed: 0.1436s/iter; left time: 737.6986s
	iters: 600, epoch: 6 | loss: 0.5726333
	speed: 0.1435s/iter; left time: 722.6196s
	iters: 700, epoch: 6 | loss: 0.5595580
	speed: 0.1435s/iter; left time: 708.4554s
	iters: 800, epoch: 6 | loss: 0.6448573
	speed: 0.1435s/iter; left time: 693.9751s
	iters: 900, epoch: 6 | loss: 0.6632942
	speed: 0.1442s/iter; left time: 682.6957s
	iters: 1000, epoch: 6 | loss: 0.7068610
	speed: 0.1442s/iter; left time: 668.7305s
	iters: 1100, epoch: 6 | loss: 0.5460302
	speed: 0.1439s/iter; left time: 652.7621s
Epoch: 6 cost time: 162.05429434776306
Epoch: 6, Steps: 1127 | Train Loss: 0.6776050 Vali Loss: 0.8300266 Test Loss: 0.4385318
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : weather_720_Autoformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed12890<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9820
mse:0.42611777782440186, mae:0.43055349588394165
