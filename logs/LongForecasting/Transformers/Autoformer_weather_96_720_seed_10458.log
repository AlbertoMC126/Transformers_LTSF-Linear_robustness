Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=21, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=21, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Autoformer', model_id='weather_720', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=720, root_path='./dataset/', seed=10458, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_720_Autoformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed10458>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36072
val 4551
test 9820
	iters: 100, epoch: 1 | loss: 0.8246995
	speed: 0.1793s/iter; left time: 2003.2391s
	iters: 200, epoch: 1 | loss: 0.9597236
	speed: 0.1447s/iter; left time: 1602.2412s
	iters: 300, epoch: 1 | loss: 0.7925650
	speed: 0.1444s/iter; left time: 1583.6659s
	iters: 400, epoch: 1 | loss: 0.8826312
	speed: 0.1441s/iter; left time: 1566.5316s
	iters: 500, epoch: 1 | loss: 0.8096344
	speed: 0.1440s/iter; left time: 1550.6355s
	iters: 600, epoch: 1 | loss: 0.8182659
	speed: 0.1438s/iter; left time: 1534.2192s
	iters: 700, epoch: 1 | loss: 1.0943689
	speed: 0.1438s/iter; left time: 1520.0721s
	iters: 800, epoch: 1 | loss: 1.0061941
	speed: 0.1438s/iter; left time: 1505.3526s
	iters: 900, epoch: 1 | loss: 0.6450611
	speed: 0.1437s/iter; left time: 1490.7652s
	iters: 1000, epoch: 1 | loss: 0.6939341
	speed: 0.1438s/iter; left time: 1477.4389s
	iters: 1100, epoch: 1 | loss: 0.7762737
	speed: 0.1438s/iter; left time: 1462.5104s
Epoch: 1 cost time: 165.88790464401245
Epoch: 1, Steps: 1127 | Train Loss: 0.7879468 Vali Loss: 0.8234724 Test Loss: 0.4155255
Validation loss decreased (inf --> 0.823472).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6303279
	speed: 0.6466s/iter; left time: 6494.1946s
	iters: 200, epoch: 2 | loss: 0.8559690
	speed: 0.1442s/iter; left time: 1433.9284s
	iters: 300, epoch: 2 | loss: 0.7638065
	speed: 0.1446s/iter; left time: 1423.8007s
	iters: 400, epoch: 2 | loss: 0.7991902
	speed: 0.1441s/iter; left time: 1404.2192s
	iters: 500, epoch: 2 | loss: 0.6033449
	speed: 0.1443s/iter; left time: 1391.6946s
	iters: 600, epoch: 2 | loss: 0.8291078
	speed: 0.1439s/iter; left time: 1373.3902s
	iters: 700, epoch: 2 | loss: 0.5402691
	speed: 0.1439s/iter; left time: 1358.5241s
	iters: 800, epoch: 2 | loss: 0.8500753
	speed: 0.1440s/iter; left time: 1345.9252s
	iters: 900, epoch: 2 | loss: 0.6210496
	speed: 0.1440s/iter; left time: 1331.3912s
	iters: 1000, epoch: 2 | loss: 0.7598373
	speed: 0.1443s/iter; left time: 1319.7293s
	iters: 1100, epoch: 2 | loss: 0.7431947
	speed: 0.1441s/iter; left time: 1303.6852s
Epoch: 2 cost time: 162.51288032531738
Epoch: 2, Steps: 1127 | Train Loss: 0.7372783 Vali Loss: 0.7933016 Test Loss: 0.4213473
Validation loss decreased (0.823472 --> 0.793302).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.6934088
	speed: 0.6459s/iter; left time: 5759.2350s
	iters: 200, epoch: 3 | loss: 0.6263852
	speed: 0.1438s/iter; left time: 1267.8052s
	iters: 300, epoch: 3 | loss: 0.7845134
	speed: 0.1438s/iter; left time: 1253.0883s
	iters: 400, epoch: 3 | loss: 0.6558369
	speed: 0.1437s/iter; left time: 1238.4917s
	iters: 500, epoch: 3 | loss: 0.7117221
	speed: 0.1438s/iter; left time: 1225.0465s
	iters: 600, epoch: 3 | loss: 0.7826731
	speed: 0.1439s/iter; left time: 1210.8504s
	iters: 700, epoch: 3 | loss: 0.6697762
	speed: 0.1439s/iter; left time: 1196.8016s
	iters: 800, epoch: 3 | loss: 0.9034696
	speed: 0.1439s/iter; left time: 1182.7730s
	iters: 900, epoch: 3 | loss: 0.5861776
	speed: 0.1439s/iter; left time: 1167.9476s
	iters: 1000, epoch: 3 | loss: 0.8391306
	speed: 0.1439s/iter; left time: 1153.8913s
	iters: 1100, epoch: 3 | loss: 0.8621181
	speed: 0.1439s/iter; left time: 1138.8615s
Epoch: 3 cost time: 162.10855650901794
Epoch: 3, Steps: 1127 | Train Loss: 0.7027765 Vali Loss: 0.7901467 Test Loss: 0.4176241
Validation loss decreased (0.793302 --> 0.790147).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.6831284
	speed: 0.6477s/iter; left time: 5045.6321s
	iters: 200, epoch: 4 | loss: 0.7482293
	speed: 0.1439s/iter; left time: 1106.7849s
	iters: 300, epoch: 4 | loss: 0.7698315
	speed: 0.1438s/iter; left time: 1091.6360s
	iters: 400, epoch: 4 | loss: 0.7109409
	speed: 0.1438s/iter; left time: 1077.2741s
	iters: 500, epoch: 4 | loss: 0.6627129
	speed: 0.1438s/iter; left time: 1062.5735s
	iters: 600, epoch: 4 | loss: 0.8498237
	speed: 0.1444s/iter; left time: 1052.4392s
	iters: 700, epoch: 4 | loss: 0.9627256
	speed: 0.1442s/iter; left time: 1036.6829s
	iters: 800, epoch: 4 | loss: 0.7129595
	speed: 0.1445s/iter; left time: 1024.8069s
	iters: 900, epoch: 4 | loss: 0.6003503
	speed: 0.1445s/iter; left time: 1009.8513s
	iters: 1000, epoch: 4 | loss: 0.7274898
	speed: 0.1440s/iter; left time: 992.2153s
	iters: 1100, epoch: 4 | loss: 0.7286325
	speed: 0.1437s/iter; left time: 976.0364s
Epoch: 4 cost time: 162.36632657051086
Epoch: 4, Steps: 1127 | Train Loss: 0.6955551 Vali Loss: 0.7901174 Test Loss: 0.4129441
Validation loss decreased (0.790147 --> 0.790117).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4856311
	speed: 0.6456s/iter; left time: 4301.7431s
	iters: 200, epoch: 5 | loss: 0.6284199
	speed: 0.1439s/iter; left time: 944.2384s
	iters: 300, epoch: 5 | loss: 0.7723073
	speed: 0.1439s/iter; left time: 929.8731s
	iters: 400, epoch: 5 | loss: 0.5823118
	speed: 0.1439s/iter; left time: 915.8497s
	iters: 500, epoch: 5 | loss: 0.9432521
	speed: 0.1440s/iter; left time: 901.6987s
	iters: 600, epoch: 5 | loss: 0.6603725
	speed: 0.1440s/iter; left time: 887.1764s
	iters: 700, epoch: 5 | loss: 0.6656038
	speed: 0.1441s/iter; left time: 873.4212s
	iters: 800, epoch: 5 | loss: 0.6736246
	speed: 0.1445s/iter; left time: 861.4795s
	iters: 900, epoch: 5 | loss: 0.6350962
	speed: 0.1442s/iter; left time: 845.6367s
	iters: 1000, epoch: 5 | loss: 0.7377134
	speed: 0.1443s/iter; left time: 831.5320s
	iters: 1100, epoch: 5 | loss: 0.6595707
	speed: 0.1446s/iter; left time: 818.6474s
Epoch: 5 cost time: 162.40301251411438
Epoch: 5, Steps: 1127 | Train Loss: 0.6926642 Vali Loss: 0.7870044 Test Loss: 0.4201663
Validation loss decreased (0.790117 --> 0.787004).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.6972263
	speed: 0.6472s/iter; left time: 3582.7126s
	iters: 200, epoch: 6 | loss: 0.6113433
	speed: 0.1441s/iter; left time: 783.5470s
	iters: 300, epoch: 6 | loss: 0.6848314
	speed: 0.1442s/iter; left time: 769.2334s
	iters: 400, epoch: 6 | loss: 0.6165016
	speed: 0.1444s/iter; left time: 756.0732s
	iters: 500, epoch: 6 | loss: 0.6294029
	speed: 0.1448s/iter; left time: 743.7892s
	iters: 600, epoch: 6 | loss: 0.8604425
	speed: 0.1439s/iter; left time: 724.6608s
	iters: 700, epoch: 6 | loss: 0.5889398
	speed: 0.1439s/iter; left time: 710.0576s
	iters: 800, epoch: 6 | loss: 1.0768924
	speed: 0.1437s/iter; left time: 695.0316s
	iters: 900, epoch: 6 | loss: 0.8345399
	speed: 0.1437s/iter; left time: 680.5464s
	iters: 1000, epoch: 6 | loss: 0.5831537
	speed: 0.1437s/iter; left time: 666.2232s
	iters: 1100, epoch: 6 | loss: 0.7291503
	speed: 0.1438s/iter; left time: 652.2756s
Epoch: 6 cost time: 162.3207573890686
Epoch: 6, Steps: 1127 | Train Loss: 0.6907696 Vali Loss: 0.7899827 Test Loss: 0.4187708
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.7375340
	speed: 0.6435s/iter; left time: 2837.4005s
	iters: 200, epoch: 7 | loss: 0.7784255
	speed: 0.1438s/iter; left time: 619.7723s
	iters: 300, epoch: 7 | loss: 0.5729108
	speed: 0.1437s/iter; left time: 604.9938s
	iters: 400, epoch: 7 | loss: 0.5938802
	speed: 0.1442s/iter; left time: 592.3538s
	iters: 500, epoch: 7 | loss: 0.7554074
	speed: 0.1444s/iter; left time: 578.9077s
	iters: 600, epoch: 7 | loss: 0.8048853
	speed: 0.1443s/iter; left time: 563.9140s
	iters: 700, epoch: 7 | loss: 0.9328027
	speed: 0.1445s/iter; left time: 550.2774s
	iters: 800, epoch: 7 | loss: 0.7132190
	speed: 0.1441s/iter; left time: 534.3583s
	iters: 900, epoch: 7 | loss: 0.7083015
	speed: 0.1438s/iter; left time: 519.0517s
	iters: 1000, epoch: 7 | loss: 0.6807170
	speed: 0.1439s/iter; left time: 504.9822s
	iters: 1100, epoch: 7 | loss: 0.5894045
	speed: 0.1438s/iter; left time: 490.1686s
Epoch: 7 cost time: 162.316321849823
Epoch: 7, Steps: 1127 | Train Loss: 0.6894385 Vali Loss: 0.7907580 Test Loss: 0.4198526
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.8563248
	speed: 0.6457s/iter; left time: 2119.1238s
	iters: 200, epoch: 8 | loss: 0.6297144
	speed: 0.1439s/iter; left time: 457.9830s
	iters: 300, epoch: 8 | loss: 0.6035199
	speed: 0.1437s/iter; left time: 442.9133s
	iters: 400, epoch: 8 | loss: 0.7199535
	speed: 0.1436s/iter; left time: 428.2845s
	iters: 500, epoch: 8 | loss: 0.6021023
	speed: 0.1438s/iter; left time: 414.4167s
	iters: 600, epoch: 8 | loss: 0.7925948
	speed: 0.1437s/iter; left time: 399.7079s
	iters: 700, epoch: 8 | loss: 0.5465501
	speed: 0.1438s/iter; left time: 385.5445s
	iters: 800, epoch: 8 | loss: 0.9115109
	speed: 0.1438s/iter; left time: 371.2710s
	iters: 900, epoch: 8 | loss: 0.7569733
	speed: 0.1439s/iter; left time: 357.1058s
	iters: 1000, epoch: 8 | loss: 0.5541003
	speed: 0.1440s/iter; left time: 343.0236s
	iters: 1100, epoch: 8 | loss: 0.5742012
	speed: 0.1446s/iter; left time: 329.9020s
Epoch: 8 cost time: 162.26129341125488
Epoch: 8, Steps: 1127 | Train Loss: 0.6891866 Vali Loss: 0.7904861 Test Loss: 0.4188765
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : weather_720_Autoformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed10458<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9820
mse:0.4200122058391571, mae:0.4290185272693634
