Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=21, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=21, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Informer', model_id='weather_720', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=720, root_path='./dataset/', seed=15726, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_720_Informer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed15726>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36072
val 4551
test 9820
	iters: 100, epoch: 1 | loss: 0.5499452
	speed: 0.0976s/iter; left time: 1090.1017s
	iters: 200, epoch: 1 | loss: 0.4897373
	speed: 0.0662s/iter; left time: 733.4528s
	iters: 300, epoch: 1 | loss: 0.6775569
	speed: 0.0666s/iter; left time: 731.1496s
	iters: 400, epoch: 1 | loss: 0.6070804
	speed: 0.0665s/iter; left time: 722.7126s
	iters: 500, epoch: 1 | loss: 0.4109522
	speed: 0.0667s/iter; left time: 718.7099s
	iters: 600, epoch: 1 | loss: 0.4100685
	speed: 0.0666s/iter; left time: 710.9717s
	iters: 700, epoch: 1 | loss: 0.6363137
	speed: 0.0666s/iter; left time: 704.4524s
	iters: 800, epoch: 1 | loss: 0.5052825
	speed: 0.0668s/iter; left time: 699.9575s
	iters: 900, epoch: 1 | loss: 0.4568299
	speed: 0.0668s/iter; left time: 692.6970s
	iters: 1000, epoch: 1 | loss: 0.5943195
	speed: 0.0667s/iter; left time: 685.2599s
	iters: 1100, epoch: 1 | loss: 0.3517837
	speed: 0.0668s/iter; left time: 679.0925s
Epoch: 1 cost time: 78.2512514591217
Epoch: 1, Steps: 1127 | Train Loss: 0.5200061 Vali Loss: 0.9307172 Test Loss: 1.4245081
Validation loss decreased (inf --> 0.930717).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4080611
	speed: 0.2201s/iter; left time: 2210.7034s
	iters: 200, epoch: 2 | loss: 0.4922623
	speed: 0.0682s/iter; left time: 678.1629s
	iters: 300, epoch: 2 | loss: 0.4110933
	speed: 0.0681s/iter; left time: 670.2019s
	iters: 400, epoch: 2 | loss: 0.3232724
	speed: 0.0669s/iter; left time: 651.7760s
	iters: 500, epoch: 2 | loss: 0.4392648
	speed: 0.0667s/iter; left time: 643.2175s
	iters: 600, epoch: 2 | loss: 0.6553338
	speed: 0.0670s/iter; left time: 639.3002s
	iters: 700, epoch: 2 | loss: 0.3043734
	speed: 0.0669s/iter; left time: 631.7062s
	iters: 800, epoch: 2 | loss: 0.2732287
	speed: 0.0666s/iter; left time: 622.7193s
	iters: 900, epoch: 2 | loss: 0.3440848
	speed: 0.0668s/iter; left time: 617.5362s
	iters: 1000, epoch: 2 | loss: 0.2748197
	speed: 0.0669s/iter; left time: 612.1284s
	iters: 1100, epoch: 2 | loss: 0.4458667
	speed: 0.0667s/iter; left time: 603.0687s
Epoch: 2 cost time: 75.66940903663635
Epoch: 2, Steps: 1127 | Train Loss: 0.3801123 Vali Loss: 0.8222674 Test Loss: 1.0027403
Validation loss decreased (0.930717 --> 0.822267).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2545141
	speed: 0.2184s/iter; left time: 1947.1830s
	iters: 200, epoch: 3 | loss: 0.3706094
	speed: 0.0666s/iter; left time: 587.6125s
	iters: 300, epoch: 3 | loss: 0.2429516
	speed: 0.0667s/iter; left time: 581.4819s
	iters: 400, epoch: 3 | loss: 0.2780782
	speed: 0.0675s/iter; left time: 581.9958s
	iters: 500, epoch: 3 | loss: 0.3269970
	speed: 0.0677s/iter; left time: 576.6613s
	iters: 600, epoch: 3 | loss: 0.5253142
	speed: 0.0677s/iter; left time: 570.0355s
	iters: 700, epoch: 3 | loss: 0.1881059
	speed: 0.0673s/iter; left time: 559.9438s
	iters: 800, epoch: 3 | loss: 0.3002504
	speed: 0.0676s/iter; left time: 555.7815s
	iters: 900, epoch: 3 | loss: 0.2098379
	speed: 0.0666s/iter; left time: 540.7953s
	iters: 1000, epoch: 3 | loss: 0.3973798
	speed: 0.0666s/iter; left time: 534.2446s
	iters: 1100, epoch: 3 | loss: 0.2578829
	speed: 0.0668s/iter; left time: 528.5674s
Epoch: 3 cost time: 75.59381103515625
Epoch: 3, Steps: 1127 | Train Loss: 0.3055152 Vali Loss: 0.8349326 Test Loss: 1.0671642
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2621992
	speed: 0.2148s/iter; left time: 1673.2258s
	iters: 200, epoch: 4 | loss: 0.3119784
	speed: 0.0665s/iter; left time: 511.6077s
	iters: 300, epoch: 4 | loss: 0.2289813
	speed: 0.0665s/iter; left time: 505.0510s
	iters: 400, epoch: 4 | loss: 0.2234543
	speed: 0.0664s/iter; left time: 497.5029s
	iters: 500, epoch: 4 | loss: 0.4203318
	speed: 0.0665s/iter; left time: 491.0932s
	iters: 600, epoch: 4 | loss: 0.1687611
	speed: 0.0666s/iter; left time: 485.2079s
	iters: 700, epoch: 4 | loss: 0.2180401
	speed: 0.0665s/iter; left time: 477.8276s
	iters: 800, epoch: 4 | loss: 0.2765156
	speed: 0.0665s/iter; left time: 471.2263s
	iters: 900, epoch: 4 | loss: 0.3013348
	speed: 0.0683s/iter; left time: 477.4124s
	iters: 1000, epoch: 4 | loss: 0.3874111
	speed: 0.0683s/iter; left time: 470.5985s
	iters: 1100, epoch: 4 | loss: 0.3019359
	speed: 0.0682s/iter; left time: 462.7473s
Epoch: 4 cost time: 75.514568567276
Epoch: 4, Steps: 1127 | Train Loss: 0.2768511 Vali Loss: 0.8202163 Test Loss: 1.0154258
Validation loss decreased (0.822267 --> 0.820216).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2180493
	speed: 0.2194s/iter; left time: 1461.9600s
	iters: 200, epoch: 5 | loss: 0.2124062
	speed: 0.0668s/iter; left time: 438.5980s
	iters: 300, epoch: 5 | loss: 0.2281956
	speed: 0.0667s/iter; left time: 431.1303s
	iters: 400, epoch: 5 | loss: 0.2866338
	speed: 0.0668s/iter; left time: 424.7784s
	iters: 500, epoch: 5 | loss: 0.2633960
	speed: 0.0667s/iter; left time: 417.5395s
	iters: 600, epoch: 5 | loss: 0.2436182
	speed: 0.0668s/iter; left time: 411.9173s
	iters: 700, epoch: 5 | loss: 0.4326083
	speed: 0.0669s/iter; left time: 405.7374s
	iters: 800, epoch: 5 | loss: 0.2159002
	speed: 0.0668s/iter; left time: 398.4285s
	iters: 900, epoch: 5 | loss: 0.2356644
	speed: 0.0669s/iter; left time: 391.9748s
	iters: 1000, epoch: 5 | loss: 0.3204280
	speed: 0.0668s/iter; left time: 384.9549s
	iters: 1100, epoch: 5 | loss: 0.2285602
	speed: 0.0669s/iter; left time: 378.6651s
Epoch: 5 cost time: 75.27406358718872
Epoch: 5, Steps: 1127 | Train Loss: 0.2641045 Vali Loss: 0.8086098 Test Loss: 0.9951209
Validation loss decreased (0.820216 --> 0.808610).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2751999
	speed: 0.2194s/iter; left time: 1214.5558s
	iters: 200, epoch: 6 | loss: 0.2981692
	speed: 0.0678s/iter; left time: 368.7579s
	iters: 300, epoch: 6 | loss: 0.1610101
	speed: 0.0681s/iter; left time: 363.5604s
	iters: 400, epoch: 6 | loss: 0.1614552
	speed: 0.0675s/iter; left time: 353.6142s
	iters: 500, epoch: 6 | loss: 0.1986856
	speed: 0.0670s/iter; left time: 344.2959s
	iters: 600, epoch: 6 | loss: 0.2020051
	speed: 0.0668s/iter; left time: 336.6028s
	iters: 700, epoch: 6 | loss: 0.2525173
	speed: 0.0666s/iter; left time: 328.9335s
	iters: 800, epoch: 6 | loss: 0.2138523
	speed: 0.0669s/iter; left time: 323.6138s
	iters: 900, epoch: 6 | loss: 0.2897178
	speed: 0.0670s/iter; left time: 317.2255s
	iters: 1000, epoch: 6 | loss: 0.2134215
	speed: 0.0667s/iter; left time: 309.0681s
	iters: 1100, epoch: 6 | loss: 0.4640237
	speed: 0.0668s/iter; left time: 303.0846s
Epoch: 6 cost time: 75.77509665489197
Epoch: 6, Steps: 1127 | Train Loss: 0.2580934 Vali Loss: 0.8298565 Test Loss: 1.0418819
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1919918
	speed: 0.2154s/iter; left time: 949.9062s
	iters: 200, epoch: 7 | loss: 0.2865398
	speed: 0.0666s/iter; left time: 287.1629s
	iters: 300, epoch: 7 | loss: 0.2075635
	speed: 0.0666s/iter; left time: 280.5202s
	iters: 400, epoch: 7 | loss: 0.2304956
	speed: 0.0665s/iter; left time: 273.4040s
	iters: 500, epoch: 7 | loss: 0.3323912
	speed: 0.0677s/iter; left time: 271.3470s
	iters: 600, epoch: 7 | loss: 0.2845985
	speed: 0.0678s/iter; left time: 265.1866s
	iters: 700, epoch: 7 | loss: 0.3012499
	speed: 0.0676s/iter; left time: 257.3880s
	iters: 800, epoch: 7 | loss: 0.3767789
	speed: 0.0681s/iter; left time: 252.7421s
	iters: 900, epoch: 7 | loss: 0.2201427
	speed: 0.0672s/iter; left time: 242.6549s
	iters: 1000, epoch: 7 | loss: 0.1752577
	speed: 0.0668s/iter; left time: 234.5555s
	iters: 1100, epoch: 7 | loss: 0.2063919
	speed: 0.0667s/iter; left time: 227.3998s
Epoch: 7 cost time: 75.63829803466797
Epoch: 7, Steps: 1127 | Train Loss: 0.2549192 Vali Loss: 0.8220013 Test Loss: 1.0233648
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1767926
	speed: 0.2151s/iter; left time: 705.9096s
	iters: 200, epoch: 8 | loss: 0.2796797
	speed: 0.0666s/iter; left time: 211.9440s
	iters: 300, epoch: 8 | loss: 0.1774184
	speed: 0.0665s/iter; left time: 205.0580s
	iters: 400, epoch: 8 | loss: 0.1657990
	speed: 0.0667s/iter; left time: 198.8127s
	iters: 500, epoch: 8 | loss: 0.3262356
	speed: 0.0665s/iter; left time: 191.7118s
	iters: 600, epoch: 8 | loss: 0.3018560
	speed: 0.0666s/iter; left time: 185.3907s
	iters: 700, epoch: 8 | loss: 0.2408709
	speed: 0.0667s/iter; left time: 178.7558s
	iters: 800, epoch: 8 | loss: 0.2082905
	speed: 0.0666s/iter; left time: 171.8693s
	iters: 900, epoch: 8 | loss: 0.2937124
	speed: 0.0670s/iter; left time: 166.3673s
	iters: 1000, epoch: 8 | loss: 0.1818726
	speed: 0.0681s/iter; left time: 162.2025s
	iters: 1100, epoch: 8 | loss: 0.2684709
	speed: 0.0688s/iter; left time: 156.8941s
Epoch: 8 cost time: 75.52750492095947
Epoch: 8, Steps: 1127 | Train Loss: 0.2536589 Vali Loss: 0.8189547 Test Loss: 1.0137039
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : weather_720_Informer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed15726<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9820
mse:0.9949865937232971, mae:0.7396668791770935
