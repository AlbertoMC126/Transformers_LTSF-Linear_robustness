Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=21, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=21, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Autoformer', model_id='weather_192', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=192, root_path='./dataset/', seed=28649, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_192_Autoformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed28649>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36600
val 5079
test 10348
	iters: 100, epoch: 1 | loss: 1.1140680
	speed: 0.0960s/iter; left time: 1087.8611s
	iters: 200, epoch: 1 | loss: 1.0291302
	speed: 0.0620s/iter; left time: 696.7905s
	iters: 300, epoch: 1 | loss: 0.5960329
	speed: 0.0621s/iter; left time: 691.6566s
	iters: 400, epoch: 1 | loss: 1.0888547
	speed: 0.0624s/iter; left time: 688.5789s
	iters: 500, epoch: 1 | loss: 0.3977868
	speed: 0.0627s/iter; left time: 684.9733s
	iters: 600, epoch: 1 | loss: 0.4863975
	speed: 0.0626s/iter; left time: 677.6967s
	iters: 700, epoch: 1 | loss: 0.4397058
	speed: 0.0625s/iter; left time: 670.6175s
	iters: 800, epoch: 1 | loss: 0.5067391
	speed: 0.0626s/iter; left time: 665.8689s
	iters: 900, epoch: 1 | loss: 0.5867029
	speed: 0.0621s/iter; left time: 654.4701s
	iters: 1000, epoch: 1 | loss: 0.5225022
	speed: 0.0623s/iter; left time: 649.5542s
	iters: 1100, epoch: 1 | loss: 0.4281962
	speed: 0.0621s/iter; left time: 641.4147s
Epoch: 1 cost time: 74.65220904350281
Epoch: 1, Steps: 1143 | Train Loss: 0.6138239 Vali Loss: 0.6355074 Test Loss: 0.3265262
Validation loss decreased (inf --> 0.635507).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4889858
	speed: 0.2829s/iter; left time: 2882.0848s
	iters: 200, epoch: 2 | loss: 0.5525053
	speed: 0.0620s/iter; left time: 625.3602s
	iters: 300, epoch: 2 | loss: 0.4723932
	speed: 0.0620s/iter; left time: 619.4914s
	iters: 400, epoch: 2 | loss: 0.5644816
	speed: 0.0619s/iter; left time: 612.0185s
	iters: 500, epoch: 2 | loss: 0.8984875
	speed: 0.0618s/iter; left time: 605.1787s
	iters: 600, epoch: 2 | loss: 1.0176752
	speed: 0.0619s/iter; left time: 599.3169s
	iters: 700, epoch: 2 | loss: 0.4613751
	speed: 0.0618s/iter; left time: 592.7118s
	iters: 800, epoch: 2 | loss: 0.4317653
	speed: 0.0620s/iter; left time: 588.4987s
	iters: 900, epoch: 2 | loss: 0.8588988
	speed: 0.0625s/iter; left time: 586.5483s
	iters: 1000, epoch: 2 | loss: 0.4178196
	speed: 0.0625s/iter; left time: 580.4460s
	iters: 1100, epoch: 2 | loss: 0.4961623
	speed: 0.0627s/iter; left time: 576.2514s
Epoch: 2 cost time: 70.9937572479248
Epoch: 2, Steps: 1143 | Train Loss: 0.5561882 Vali Loss: 0.6329415 Test Loss: 0.3272932
Validation loss decreased (0.635507 --> 0.632942).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 1.0778801
	speed: 0.2838s/iter; left time: 2566.7829s
	iters: 200, epoch: 3 | loss: 0.3761249
	speed: 0.0618s/iter; left time: 552.9864s
	iters: 300, epoch: 3 | loss: 0.4287060
	speed: 0.0618s/iter; left time: 546.7140s
	iters: 400, epoch: 3 | loss: 0.5378621
	speed: 0.0620s/iter; left time: 541.8378s
	iters: 500, epoch: 3 | loss: 1.0626887
	speed: 0.0618s/iter; left time: 534.0387s
	iters: 600, epoch: 3 | loss: 0.4068124
	speed: 0.0619s/iter; left time: 529.3031s
	iters: 700, epoch: 3 | loss: 0.4798679
	speed: 0.0619s/iter; left time: 522.6076s
	iters: 800, epoch: 3 | loss: 0.8871891
	speed: 0.0618s/iter; left time: 516.1053s
	iters: 900, epoch: 3 | loss: 0.7074978
	speed: 0.0618s/iter; left time: 509.5346s
	iters: 1000, epoch: 3 | loss: 0.8109512
	speed: 0.0618s/iter; left time: 503.4560s
	iters: 1100, epoch: 3 | loss: 0.5646675
	speed: 0.0618s/iter; left time: 497.4931s
Epoch: 3 cost time: 70.678395986557
Epoch: 3, Steps: 1143 | Train Loss: 0.5346533 Vali Loss: 0.6287174 Test Loss: 0.3394765
Validation loss decreased (0.632942 --> 0.628717).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3964144
	speed: 0.2868s/iter; left time: 2266.6651s
	iters: 200, epoch: 4 | loss: 0.5000154
	speed: 0.0628s/iter; left time: 489.6936s
	iters: 300, epoch: 4 | loss: 0.4246286
	speed: 0.0626s/iter; left time: 482.1923s
	iters: 400, epoch: 4 | loss: 0.8630000
	speed: 0.0619s/iter; left time: 470.8280s
	iters: 500, epoch: 4 | loss: 0.4204023
	speed: 0.0618s/iter; left time: 463.7887s
	iters: 600, epoch: 4 | loss: 0.4478878
	speed: 0.0619s/iter; left time: 458.0221s
	iters: 700, epoch: 4 | loss: 0.3723485
	speed: 0.0619s/iter; left time: 452.0855s
	iters: 800, epoch: 4 | loss: 0.3595398
	speed: 0.0620s/iter; left time: 446.5520s
	iters: 900, epoch: 4 | loss: 0.4368210
	speed: 0.0621s/iter; left time: 441.2851s
	iters: 1000, epoch: 4 | loss: 0.3853257
	speed: 0.0621s/iter; left time: 434.7343s
	iters: 1100, epoch: 4 | loss: 0.3701118
	speed: 0.0620s/iter; left time: 427.9846s
Epoch: 4 cost time: 71.04143214225769
Epoch: 4, Steps: 1143 | Train Loss: 0.5231237 Vali Loss: 0.6298333 Test Loss: 0.3449645
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4956236
	speed: 0.2805s/iter; left time: 1895.5910s
	iters: 200, epoch: 5 | loss: 0.3619760
	speed: 0.0621s/iter; left time: 413.7751s
	iters: 300, epoch: 5 | loss: 0.8689226
	speed: 0.0622s/iter; left time: 408.2392s
	iters: 400, epoch: 5 | loss: 0.3915007
	speed: 0.0627s/iter; left time: 404.7237s
	iters: 500, epoch: 5 | loss: 0.3892003
	speed: 0.0628s/iter; left time: 399.2417s
	iters: 600, epoch: 5 | loss: 0.3833014
	speed: 0.0628s/iter; left time: 393.2568s
	iters: 700, epoch: 5 | loss: 0.4777359
	speed: 0.0625s/iter; left time: 384.7855s
	iters: 800, epoch: 5 | loss: 0.3308797
	speed: 0.0623s/iter; left time: 377.7262s
	iters: 900, epoch: 5 | loss: 0.8844524
	speed: 0.0621s/iter; left time: 370.1796s
	iters: 1000, epoch: 5 | loss: 0.4189813
	speed: 0.0620s/iter; left time: 363.4057s
	iters: 1100, epoch: 5 | loss: 0.5157244
	speed: 0.0620s/iter; left time: 356.9079s
Epoch: 5 cost time: 71.23068189620972
Epoch: 5, Steps: 1143 | Train Loss: 0.5146546 Vali Loss: 0.6306481 Test Loss: 0.3437657
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4921235
	speed: 0.2804s/iter; left time: 1574.4552s
	iters: 200, epoch: 6 | loss: 0.4285516
	speed: 0.0621s/iter; left time: 342.5581s
	iters: 300, epoch: 6 | loss: 0.4271857
	speed: 0.0620s/iter; left time: 335.5237s
	iters: 400, epoch: 6 | loss: 0.4313343
	speed: 0.0619s/iter; left time: 329.2381s
	iters: 500, epoch: 6 | loss: 0.4042559
	speed: 0.0620s/iter; left time: 323.2484s
	iters: 600, epoch: 6 | loss: 0.8346235
	speed: 0.0619s/iter; left time: 316.7263s
	iters: 700, epoch: 6 | loss: 0.4022049
	speed: 0.0620s/iter; left time: 310.8967s
	iters: 800, epoch: 6 | loss: 0.3948234
	speed: 0.0623s/iter; left time: 306.4498s
	iters: 900, epoch: 6 | loss: 0.3981232
	speed: 0.0626s/iter; left time: 301.2472s
	iters: 1000, epoch: 6 | loss: 0.3526699
	speed: 0.0628s/iter; left time: 296.1404s
	iters: 1100, epoch: 6 | loss: 0.3870911
	speed: 0.0625s/iter; left time: 288.3969s
Epoch: 6 cost time: 71.09095191955566
Epoch: 6, Steps: 1143 | Train Loss: 0.5108170 Vali Loss: 0.6338187 Test Loss: 0.3440275
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : weather_192_Autoformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed28649<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10348
mse:0.33985915780067444, mae:0.3857561945915222
