Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=21, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=21, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Autoformer', model_id='weather_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=96, root_path='./dataset/', seed=15349, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_96_Autoformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed15349>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36696
val 5175
test 10444
	iters: 100, epoch: 1 | loss: 1.3557038
	speed: 0.0816s/iter; left time: 927.0155s
	iters: 200, epoch: 1 | loss: 0.4297531
	speed: 0.0473s/iter; left time: 532.9643s
	iters: 300, epoch: 1 | loss: 0.3961297
	speed: 0.0473s/iter; left time: 527.4931s
	iters: 400, epoch: 1 | loss: 0.3902214
	speed: 0.0473s/iter; left time: 523.0663s
	iters: 500, epoch: 1 | loss: 0.5943545
	speed: 0.0473s/iter; left time: 518.7772s
	iters: 600, epoch: 1 | loss: 0.4311916
	speed: 0.0473s/iter; left time: 513.5459s
	iters: 700, epoch: 1 | loss: 0.3441204
	speed: 0.0473s/iter; left time: 509.4793s
	iters: 800, epoch: 1 | loss: 0.3421963
	speed: 0.0474s/iter; left time: 505.5742s
	iters: 900, epoch: 1 | loss: 0.5408732
	speed: 0.0473s/iter; left time: 499.4680s
	iters: 1000, epoch: 1 | loss: 0.3768004
	speed: 0.0473s/iter; left time: 494.3782s
	iters: 1100, epoch: 1 | loss: 0.6167578
	speed: 0.0472s/iter; left time: 489.2554s
Epoch: 1 cost time: 57.648693799972534
Epoch: 1, Steps: 1146 | Train Loss: 0.5058000 Vali Loss: 0.5189917 Test Loss: 0.2894699
Validation loss decreased (inf --> 0.518992).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3478589
	speed: 0.2108s/iter; left time: 2153.7171s
	iters: 200, epoch: 2 | loss: 0.4092554
	speed: 0.0473s/iter; left time: 478.0617s
	iters: 300, epoch: 2 | loss: 0.2982514
	speed: 0.0473s/iter; left time: 473.4430s
	iters: 400, epoch: 2 | loss: 0.6475913
	speed: 0.0473s/iter; left time: 468.8094s
	iters: 500, epoch: 2 | loss: 0.4693799
	speed: 0.0473s/iter; left time: 464.2226s
	iters: 600, epoch: 2 | loss: 0.5579917
	speed: 0.0473s/iter; left time: 459.2901s
	iters: 700, epoch: 2 | loss: 1.1622669
	speed: 0.0473s/iter; left time: 454.3446s
	iters: 800, epoch: 2 | loss: 0.2588075
	speed: 0.0473s/iter; left time: 449.9537s
	iters: 900, epoch: 2 | loss: 0.3243816
	speed: 0.0473s/iter; left time: 445.4464s
	iters: 1000, epoch: 2 | loss: 0.7152892
	speed: 0.0473s/iter; left time: 440.1580s
	iters: 1100, epoch: 2 | loss: 0.3203726
	speed: 0.0472s/iter; left time: 435.3203s
Epoch: 2 cost time: 54.18422818183899
Epoch: 2, Steps: 1146 | Train Loss: 0.4453182 Vali Loss: 0.5044653 Test Loss: 0.2429659
Validation loss decreased (0.518992 --> 0.504465).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4970793
	speed: 0.2132s/iter; left time: 1933.9403s
	iters: 200, epoch: 3 | loss: 0.2606721
	speed: 0.0479s/iter; left time: 429.8887s
	iters: 300, epoch: 3 | loss: 0.2405943
	speed: 0.0477s/iter; left time: 422.6905s
	iters: 400, epoch: 3 | loss: 0.2567034
	speed: 0.0477s/iter; left time: 418.5692s
	iters: 500, epoch: 3 | loss: 0.3253001
	speed: 0.0472s/iter; left time: 409.6029s
	iters: 600, epoch: 3 | loss: 0.3597475
	speed: 0.0472s/iter; left time: 404.8491s
	iters: 700, epoch: 3 | loss: 0.2399375
	speed: 0.0473s/iter; left time: 400.7499s
	iters: 800, epoch: 3 | loss: 0.5364727
	speed: 0.0473s/iter; left time: 396.2332s
	iters: 900, epoch: 3 | loss: 0.2773324
	speed: 0.0473s/iter; left time: 390.9412s
	iters: 1000, epoch: 3 | loss: 0.5115211
	speed: 0.0472s/iter; left time: 385.4417s
	iters: 1100, epoch: 3 | loss: 0.2758464
	speed: 0.0473s/iter; left time: 381.5928s
Epoch: 3 cost time: 54.42492175102234
Epoch: 3, Steps: 1146 | Train Loss: 0.4131898 Vali Loss: 0.4975429 Test Loss: 0.2718104
Validation loss decreased (0.504465 --> 0.497543).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2553300
	speed: 0.2112s/iter; left time: 1673.0909s
	iters: 200, epoch: 4 | loss: 0.3295597
	speed: 0.0472s/iter; left time: 369.6268s
	iters: 300, epoch: 4 | loss: 0.2740417
	speed: 0.0475s/iter; left time: 366.4742s
	iters: 400, epoch: 4 | loss: 0.2638789
	speed: 0.0473s/iter; left time: 360.7493s
	iters: 500, epoch: 4 | loss: 1.2579223
	speed: 0.0472s/iter; left time: 355.0266s
	iters: 600, epoch: 4 | loss: 0.3118343
	speed: 0.0473s/iter; left time: 350.7655s
	iters: 700, epoch: 4 | loss: 0.3249578
	speed: 0.0473s/iter; left time: 346.4532s
	iters: 800, epoch: 4 | loss: 0.3652190
	speed: 0.0473s/iter; left time: 341.4482s
	iters: 900, epoch: 4 | loss: 0.2653015
	speed: 0.0473s/iter; left time: 336.5992s
	iters: 1000, epoch: 4 | loss: 0.8373484
	speed: 0.0473s/iter; left time: 331.9903s
	iters: 1100, epoch: 4 | loss: 0.3317244
	speed: 0.0472s/iter; left time: 327.0393s
Epoch: 4 cost time: 54.190037965774536
Epoch: 4, Steps: 1146 | Train Loss: 0.3885217 Vali Loss: 0.4951030 Test Loss: 0.2732374
Validation loss decreased (0.497543 --> 0.495103).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3221087
	speed: 0.2127s/iter; left time: 1441.7397s
	iters: 200, epoch: 5 | loss: 0.4394583
	speed: 0.0473s/iter; left time: 315.8124s
	iters: 300, epoch: 5 | loss: 0.2209874
	speed: 0.0474s/iter; left time: 311.6195s
	iters: 400, epoch: 5 | loss: 0.2154620
	speed: 0.0474s/iter; left time: 306.7522s
	iters: 500, epoch: 5 | loss: 0.2706281
	speed: 0.0473s/iter; left time: 301.9080s
	iters: 600, epoch: 5 | loss: 0.5028406
	speed: 0.0472s/iter; left time: 296.3402s
	iters: 700, epoch: 5 | loss: 0.4477387
	speed: 0.0473s/iter; left time: 292.2174s
	iters: 800, epoch: 5 | loss: 0.3265260
	speed: 0.0472s/iter; left time: 286.8495s
	iters: 900, epoch: 5 | loss: 0.3942166
	speed: 0.0473s/iter; left time: 282.4285s
	iters: 1000, epoch: 5 | loss: 0.4798677
	speed: 0.0474s/iter; left time: 278.2815s
	iters: 1100, epoch: 5 | loss: 0.2418474
	speed: 0.0473s/iter; left time: 273.0344s
Epoch: 5 cost time: 54.20523476600647
Epoch: 5, Steps: 1146 | Train Loss: 0.3734490 Vali Loss: 0.5013265 Test Loss: 0.2830620
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2400922
	speed: 0.2091s/iter; left time: 1177.2437s
	iters: 200, epoch: 6 | loss: 0.9977573
	speed: 0.0472s/iter; left time: 261.3355s
	iters: 300, epoch: 6 | loss: 0.2258091
	speed: 0.0476s/iter; left time: 258.5190s
	iters: 400, epoch: 6 | loss: 0.1848902
	speed: 0.0478s/iter; left time: 254.6336s
	iters: 500, epoch: 6 | loss: 0.2597154
	speed: 0.0474s/iter; left time: 248.1536s
	iters: 600, epoch: 6 | loss: 0.2901070
	speed: 0.0474s/iter; left time: 243.2432s
	iters: 700, epoch: 6 | loss: 0.2854412
	speed: 0.0476s/iter; left time: 239.4336s
	iters: 800, epoch: 6 | loss: 0.3626637
	speed: 0.0475s/iter; left time: 234.3244s
	iters: 900, epoch: 6 | loss: 0.3909482
	speed: 0.0475s/iter; left time: 229.5760s
	iters: 1000, epoch: 6 | loss: 0.2655562
	speed: 0.0475s/iter; left time: 224.4981s
	iters: 1100, epoch: 6 | loss: 0.2085129
	speed: 0.0474s/iter; left time: 219.5640s
Epoch: 6 cost time: 54.408692598342896
Epoch: 6, Steps: 1146 | Train Loss: 0.3661390 Vali Loss: 0.5007117 Test Loss: 0.2868511
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2336118
	speed: 0.2088s/iter; left time: 936.5625s
	iters: 200, epoch: 7 | loss: 0.2754423
	speed: 0.0473s/iter; left time: 207.3797s
	iters: 300, epoch: 7 | loss: 0.2800939
	speed: 0.0473s/iter; left time: 202.5189s
	iters: 400, epoch: 7 | loss: 0.2502704
	speed: 0.0472s/iter; left time: 197.7400s
	iters: 500, epoch: 7 | loss: 0.2251620
	speed: 0.0473s/iter; left time: 193.1889s
	iters: 600, epoch: 7 | loss: 0.2262172
	speed: 0.0473s/iter; left time: 188.3878s
	iters: 700, epoch: 7 | loss: 0.1991949
	speed: 0.0474s/iter; left time: 184.0012s
	iters: 800, epoch: 7 | loss: 0.2886177
	speed: 0.0472s/iter; left time: 178.7772s
	iters: 900, epoch: 7 | loss: 0.2859915
	speed: 0.0473s/iter; left time: 174.3461s
	iters: 1000, epoch: 7 | loss: 0.2308879
	speed: 0.0472s/iter; left time: 169.3123s
	iters: 1100, epoch: 7 | loss: 0.3938612
	speed: 0.0473s/iter; left time: 164.8946s
Epoch: 7 cost time: 54.188443422317505
Epoch: 7, Steps: 1146 | Train Loss: 0.3614685 Vali Loss: 0.5005093 Test Loss: 0.2910137
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : weather_96_Autoformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed15349<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
mse:0.2736135721206665, mae:0.34601879119873047
