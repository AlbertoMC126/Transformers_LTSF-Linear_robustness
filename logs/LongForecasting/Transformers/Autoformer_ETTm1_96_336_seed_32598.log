Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm1', data_path='ETTm1.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Autoformer', model_id='ETTm1_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=336, root_path='./dataset/', seed=32598, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm1_336_Autoformer_ETTm1_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed32598>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34129
val 11185
test 11185
	iters: 100, epoch: 1 | loss: 0.4192847
	speed: 0.1169s/iter; left time: 1234.0983s
	iters: 200, epoch: 1 | loss: 0.4692745
	speed: 0.0825s/iter; left time: 862.7651s
	iters: 300, epoch: 1 | loss: 0.4370093
	speed: 0.0826s/iter; left time: 856.0843s
	iters: 400, epoch: 1 | loss: 0.4581811
	speed: 0.0827s/iter; left time: 849.0904s
	iters: 500, epoch: 1 | loss: 0.4838284
	speed: 0.0828s/iter; left time: 841.0508s
	iters: 600, epoch: 1 | loss: 0.4127918
	speed: 0.0832s/iter; left time: 836.9954s
	iters: 700, epoch: 1 | loss: 0.3618922
	speed: 0.0830s/iter; left time: 827.0941s
	iters: 800, epoch: 1 | loss: 0.3250155
	speed: 0.0831s/iter; left time: 819.5974s
	iters: 900, epoch: 1 | loss: 0.3796480
	speed: 0.0830s/iter; left time: 810.3286s
	iters: 1000, epoch: 1 | loss: 0.3314220
	speed: 0.0827s/iter; left time: 799.2841s
Epoch: 1 cost time: 91.75432300567627
Epoch: 1, Steps: 1066 | Train Loss: 0.4215144 Vali Loss: 0.9352500 Test Loss: 0.7058142
Validation loss decreased (inf --> 0.935250).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3708334
	speed: 0.5170s/iter; left time: 4908.9103s
	iters: 200, epoch: 2 | loss: 0.3700203
	speed: 0.0825s/iter; left time: 775.0514s
	iters: 300, epoch: 2 | loss: 0.3201374
	speed: 0.0825s/iter; left time: 766.8094s
	iters: 400, epoch: 2 | loss: 0.3722712
	speed: 0.0825s/iter; left time: 758.5668s
	iters: 500, epoch: 2 | loss: 0.3401098
	speed: 0.0830s/iter; left time: 755.0035s
	iters: 600, epoch: 2 | loss: 0.3491180
	speed: 0.0830s/iter; left time: 746.3333s
	iters: 700, epoch: 2 | loss: 0.3493760
	speed: 0.0830s/iter; left time: 738.5506s
	iters: 800, epoch: 2 | loss: 0.3467964
	speed: 0.0827s/iter; left time: 727.5943s
	iters: 900, epoch: 2 | loss: 0.3411245
	speed: 0.0825s/iter; left time: 717.6868s
	iters: 1000, epoch: 2 | loss: 0.3344061
	speed: 0.0825s/iter; left time: 709.4002s
Epoch: 2 cost time: 88.12597584724426
Epoch: 2, Steps: 1066 | Train Loss: 0.3481423 Vali Loss: 0.9661845 Test Loss: 0.7515965
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2949112
	speed: 0.5149s/iter; left time: 4340.2840s
	iters: 200, epoch: 3 | loss: 0.3466431
	speed: 0.0824s/iter; left time: 686.1653s
	iters: 300, epoch: 3 | loss: 0.3437601
	speed: 0.0824s/iter; left time: 678.1377s
	iters: 400, epoch: 3 | loss: 0.2607329
	speed: 0.0828s/iter; left time: 672.9858s
	iters: 500, epoch: 3 | loss: 0.2945798
	speed: 0.0831s/iter; left time: 666.9517s
	iters: 600, epoch: 3 | loss: 0.3360910
	speed: 0.0829s/iter; left time: 657.3040s
	iters: 700, epoch: 3 | loss: 0.2971917
	speed: 0.0830s/iter; left time: 650.0616s
	iters: 800, epoch: 3 | loss: 0.3829432
	speed: 0.0826s/iter; left time: 638.2800s
	iters: 900, epoch: 3 | loss: 0.3756200
	speed: 0.0825s/iter; left time: 629.5788s
	iters: 1000, epoch: 3 | loss: 0.2804858
	speed: 0.0825s/iter; left time: 621.3289s
Epoch: 3 cost time: 88.1023178100586
Epoch: 3, Steps: 1066 | Train Loss: 0.3122388 Vali Loss: 0.9876009 Test Loss: 0.7958138
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3043867
	speed: 0.5167s/iter; left time: 3804.2700s
	iters: 200, epoch: 4 | loss: 0.2858861
	speed: 0.0826s/iter; left time: 600.0667s
	iters: 300, epoch: 4 | loss: 0.2991966
	speed: 0.0828s/iter; left time: 593.4288s
	iters: 400, epoch: 4 | loss: 0.3908359
	speed: 0.0830s/iter; left time: 586.5188s
	iters: 500, epoch: 4 | loss: 0.2842759
	speed: 0.0831s/iter; left time: 578.4095s
	iters: 600, epoch: 4 | loss: 0.2536339
	speed: 0.0832s/iter; left time: 571.3248s
	iters: 700, epoch: 4 | loss: 0.2336470
	speed: 0.0827s/iter; left time: 559.4994s
	iters: 800, epoch: 4 | loss: 0.3208310
	speed: 0.0827s/iter; left time: 550.9897s
	iters: 900, epoch: 4 | loss: 0.3203042
	speed: 0.0827s/iter; left time: 542.7766s
	iters: 1000, epoch: 4 | loss: 0.3363177
	speed: 0.0826s/iter; left time: 534.0683s
Epoch: 4 cost time: 88.25789475440979
Epoch: 4, Steps: 1066 | Train Loss: 0.2949499 Vali Loss: 1.0425128 Test Loss: 0.8144941
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : ETTm1_336_Autoformer_ETTm1_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed32598<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
mse:0.7058076858520508, mae:0.5572046041488647
