Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=21, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=21, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Informer', model_id='weather_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=336, root_path='./dataset/', seed=32598, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_336_Informer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed32598>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36456
val 4935
test 10204
	iters: 100, epoch: 1 | loss: 0.4698192
	speed: 0.0725s/iter; left time: 818.8291s
	iters: 200, epoch: 1 | loss: 0.4541272
	speed: 0.0424s/iter; left time: 474.2377s
	iters: 300, epoch: 1 | loss: 0.4415727
	speed: 0.0421s/iter; left time: 466.8370s
	iters: 400, epoch: 1 | loss: 0.5848262
	speed: 0.0421s/iter; left time: 462.3469s
	iters: 500, epoch: 1 | loss: 0.6702403
	speed: 0.0422s/iter; left time: 459.8186s
	iters: 600, epoch: 1 | loss: 0.4148479
	speed: 0.0421s/iter; left time: 454.8400s
	iters: 700, epoch: 1 | loss: 0.3309631
	speed: 0.0423s/iter; left time: 451.7894s
	iters: 800, epoch: 1 | loss: 0.6689050
	speed: 0.0423s/iter; left time: 448.2058s
	iters: 900, epoch: 1 | loss: 0.3090487
	speed: 0.0423s/iter; left time: 443.3751s
	iters: 1000, epoch: 1 | loss: 0.3505829
	speed: 0.0421s/iter; left time: 437.6675s
	iters: 1100, epoch: 1 | loss: 0.2737831
	speed: 0.0421s/iter; left time: 432.9418s
Epoch: 1 cost time: 51.11473536491394
Epoch: 1, Steps: 1139 | Train Loss: 0.4731876 Vali Loss: 0.7126411 Test Loss: 0.7938384
Validation loss decreased (inf --> 0.712641).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5447838
	speed: 0.1375s/iter; left time: 1395.7350s
	iters: 200, epoch: 2 | loss: 0.6712548
	speed: 0.0421s/iter; left time: 422.8574s
	iters: 300, epoch: 2 | loss: 0.3104421
	speed: 0.0421s/iter; left time: 418.9591s
	iters: 400, epoch: 2 | loss: 0.2845731
	speed: 0.0442s/iter; left time: 434.9840s
	iters: 500, epoch: 2 | loss: 0.2968122
	speed: 0.0440s/iter; left time: 428.6915s
	iters: 600, epoch: 2 | loss: 0.5006739
	speed: 0.0439s/iter; left time: 423.7500s
	iters: 700, epoch: 2 | loss: 0.2584177
	speed: 0.0442s/iter; left time: 422.4147s
	iters: 800, epoch: 2 | loss: 0.3373005
	speed: 0.0441s/iter; left time: 416.5857s
	iters: 900, epoch: 2 | loss: 0.2223937
	speed: 0.0441s/iter; left time: 412.0788s
	iters: 1000, epoch: 2 | loss: 0.2278202
	speed: 0.0439s/iter; left time: 405.7688s
	iters: 1100, epoch: 2 | loss: 0.2170375
	speed: 0.0425s/iter; left time: 388.8359s
Epoch: 2 cost time: 49.36466646194458
Epoch: 2, Steps: 1139 | Train Loss: 0.3629371 Vali Loss: 0.6651310 Test Loss: 0.5949835
Validation loss decreased (0.712641 --> 0.665131).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3051668
	speed: 0.1387s/iter; left time: 1250.2257s
	iters: 200, epoch: 3 | loss: 0.2134684
	speed: 0.0425s/iter; left time: 379.0519s
	iters: 300, epoch: 3 | loss: 0.2478247
	speed: 0.0424s/iter; left time: 373.8160s
	iters: 400, epoch: 3 | loss: 0.1838940
	speed: 0.0424s/iter; left time: 369.2412s
	iters: 500, epoch: 3 | loss: 0.4736397
	speed: 0.0425s/iter; left time: 366.1839s
	iters: 600, epoch: 3 | loss: 0.4115437
	speed: 0.0424s/iter; left time: 361.1385s
	iters: 700, epoch: 3 | loss: 0.2058654
	speed: 0.0425s/iter; left time: 357.3741s
	iters: 800, epoch: 3 | loss: 0.4366704
	speed: 0.0426s/iter; left time: 353.9022s
	iters: 900, epoch: 3 | loss: 0.1969130
	speed: 0.0426s/iter; left time: 349.6132s
	iters: 1000, epoch: 3 | loss: 0.2491903
	speed: 0.0425s/iter; left time: 344.4129s
	iters: 1100, epoch: 3 | loss: 0.2366220
	speed: 0.0424s/iter; left time: 339.7850s
Epoch: 3 cost time: 48.387551069259644
Epoch: 3, Steps: 1139 | Train Loss: 0.2901146 Vali Loss: 0.6349822 Test Loss: 0.5463223
Validation loss decreased (0.665131 --> 0.634982).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2035308
	speed: 0.1379s/iter; left time: 1086.0189s
	iters: 200, epoch: 4 | loss: 0.2397484
	speed: 0.0423s/iter; left time: 328.5602s
	iters: 300, epoch: 4 | loss: 0.2056816
	speed: 0.0424s/iter; left time: 325.2444s
	iters: 400, epoch: 4 | loss: 0.1496412
	speed: 0.0425s/iter; left time: 321.9636s
	iters: 500, epoch: 4 | loss: 0.2424199
	speed: 0.0429s/iter; left time: 320.8386s
	iters: 600, epoch: 4 | loss: 0.2436321
	speed: 0.0434s/iter; left time: 319.6874s
	iters: 700, epoch: 4 | loss: 0.2491583
	speed: 0.0431s/iter; left time: 313.8685s
	iters: 800, epoch: 4 | loss: 0.2462501
	speed: 0.0433s/iter; left time: 310.7847s
	iters: 900, epoch: 4 | loss: 0.1759197
	speed: 0.0432s/iter; left time: 305.7572s
	iters: 1000, epoch: 4 | loss: 0.3738079
	speed: 0.0433s/iter; left time: 301.8308s
	iters: 1100, epoch: 4 | loss: 0.1611460
	speed: 0.0432s/iter; left time: 297.2014s
Epoch: 4 cost time: 48.89063787460327
Epoch: 4, Steps: 1139 | Train Loss: 0.2613917 Vali Loss: 0.6423773 Test Loss: 0.5863612
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1809602
	speed: 0.1365s/iter; left time: 919.1814s
	iters: 200, epoch: 5 | loss: 0.3772041
	speed: 0.0423s/iter; left time: 280.5227s
	iters: 300, epoch: 5 | loss: 0.1219009
	speed: 0.0423s/iter; left time: 276.6696s
	iters: 400, epoch: 5 | loss: 0.3365317
	speed: 0.0425s/iter; left time: 273.6442s
	iters: 500, epoch: 5 | loss: 0.2021380
	speed: 0.0426s/iter; left time: 269.9828s
	iters: 600, epoch: 5 | loss: 0.1996239
	speed: 0.0424s/iter; left time: 264.3079s
	iters: 700, epoch: 5 | loss: 0.1581482
	speed: 0.0422s/iter; left time: 259.0435s
	iters: 800, epoch: 5 | loss: 0.2815236
	speed: 0.0424s/iter; left time: 255.9358s
	iters: 900, epoch: 5 | loss: 0.1487463
	speed: 0.0424s/iter; left time: 251.8788s
	iters: 1000, epoch: 5 | loss: 0.1682281
	speed: 0.0424s/iter; left time: 247.2239s
	iters: 1100, epoch: 5 | loss: 0.2256374
	speed: 0.0424s/iter; left time: 243.4406s
Epoch: 5 cost time: 48.28429460525513
Epoch: 5, Steps: 1139 | Train Loss: 0.2486036 Vali Loss: 0.6478967 Test Loss: 0.6011832
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1681023
	speed: 0.1357s/iter; left time: 759.5943s
	iters: 200, epoch: 6 | loss: 0.1644012
	speed: 0.0421s/iter; left time: 231.2510s
	iters: 300, epoch: 6 | loss: 0.3748491
	speed: 0.0421s/iter; left time: 227.1718s
	iters: 400, epoch: 6 | loss: 0.1700675
	speed: 0.0420s/iter; left time: 222.6756s
	iters: 500, epoch: 6 | loss: 0.3492472
	speed: 0.0421s/iter; left time: 218.8112s
	iters: 600, epoch: 6 | loss: 0.3251649
	speed: 0.0421s/iter; left time: 214.5592s
	iters: 700, epoch: 6 | loss: 0.2115903
	speed: 0.0430s/iter; left time: 214.8667s
	iters: 800, epoch: 6 | loss: 0.1588458
	speed: 0.0437s/iter; left time: 213.7452s
	iters: 900, epoch: 6 | loss: 0.2815408
	speed: 0.0434s/iter; left time: 208.2335s
	iters: 1000, epoch: 6 | loss: 0.3952240
	speed: 0.0435s/iter; left time: 204.1344s
	iters: 1100, epoch: 6 | loss: 0.3870519
	speed: 0.0437s/iter; left time: 201.0393s
Epoch: 6 cost time: 48.68262577056885
Epoch: 6, Steps: 1139 | Train Loss: 0.2423100 Vali Loss: 0.6591094 Test Loss: 0.6114036
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : weather_336_Informer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed32598<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10204
mse:0.5464956760406494, mae:0.5145759582519531
