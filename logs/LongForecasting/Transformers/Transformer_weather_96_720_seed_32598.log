Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=21, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=21, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Transformer', model_id='weather_720', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=720, root_path='./dataset/', seed=32598, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_720_Transformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed32598>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36072
val 4551
test 9820
	iters: 100, epoch: 1 | loss: 0.5485950
	speed: 0.1243s/iter; left time: 1388.6945s
	iters: 200, epoch: 1 | loss: 0.4344521
	speed: 0.0926s/iter; left time: 1024.8762s
	iters: 300, epoch: 1 | loss: 0.4923791
	speed: 0.0926s/iter; left time: 1015.8333s
	iters: 400, epoch: 1 | loss: 0.5398977
	speed: 0.0926s/iter; left time: 1006.9347s
	iters: 500, epoch: 1 | loss: 0.4649103
	speed: 0.0928s/iter; left time: 999.5546s
	iters: 600, epoch: 1 | loss: 0.4917964
	speed: 0.0928s/iter; left time: 990.2643s
	iters: 700, epoch: 1 | loss: 0.3225960
	speed: 0.0928s/iter; left time: 980.5821s
	iters: 800, epoch: 1 | loss: 0.4508807
	speed: 0.0927s/iter; left time: 970.1872s
	iters: 900, epoch: 1 | loss: 0.4347152
	speed: 0.0931s/iter; left time: 965.9211s
	iters: 1000, epoch: 1 | loss: 0.3177422
	speed: 0.0930s/iter; left time: 955.0362s
	iters: 1100, epoch: 1 | loss: 0.2975930
	speed: 0.0933s/iter; left time: 949.3723s
Epoch: 1 cost time: 107.78574204444885
Epoch: 1, Steps: 1127 | Train Loss: 0.4721281 Vali Loss: 0.8819223 Test Loss: 1.0195022
Validation loss decreased (inf --> 0.881922).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4500519
	speed: 0.2866s/iter; left time: 2878.7691s
	iters: 200, epoch: 2 | loss: 0.5366240
	speed: 0.0926s/iter; left time: 920.5869s
	iters: 300, epoch: 2 | loss: 0.2319588
	speed: 0.0926s/iter; left time: 911.6850s
	iters: 400, epoch: 2 | loss: 0.5548694
	speed: 0.0926s/iter; left time: 902.2638s
	iters: 500, epoch: 2 | loss: 0.2884896
	speed: 0.0928s/iter; left time: 895.2710s
	iters: 600, epoch: 2 | loss: 0.4110277
	speed: 0.0930s/iter; left time: 887.1283s
	iters: 700, epoch: 2 | loss: 0.2014167
	speed: 0.0928s/iter; left time: 876.6997s
	iters: 800, epoch: 2 | loss: 0.3895456
	speed: 0.0928s/iter; left time: 866.7318s
	iters: 900, epoch: 2 | loss: 0.4398108
	speed: 0.0928s/iter; left time: 857.6678s
	iters: 1000, epoch: 2 | loss: 0.3062028
	speed: 0.0931s/iter; left time: 851.0535s
	iters: 1100, epoch: 2 | loss: 0.2846505
	speed: 0.0934s/iter; left time: 845.1069s
Epoch: 2 cost time: 104.5838532447815
Epoch: 2, Steps: 1127 | Train Loss: 0.3242667 Vali Loss: 0.8957564 Test Loss: 1.0234122
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2284249
	speed: 0.2829s/iter; left time: 2522.7975s
	iters: 200, epoch: 3 | loss: 0.2406260
	speed: 0.0928s/iter; left time: 817.9945s
	iters: 300, epoch: 3 | loss: 0.4096536
	speed: 0.0928s/iter; left time: 809.0180s
	iters: 400, epoch: 3 | loss: 0.1631858
	speed: 0.0927s/iter; left time: 798.4573s
	iters: 500, epoch: 3 | loss: 0.2221992
	speed: 0.0927s/iter; left time: 789.2717s
	iters: 600, epoch: 3 | loss: 0.3221305
	speed: 0.0927s/iter; left time: 780.2830s
	iters: 700, epoch: 3 | loss: 0.2321856
	speed: 0.0928s/iter; left time: 772.1270s
	iters: 800, epoch: 3 | loss: 0.2369362
	speed: 0.0928s/iter; left time: 762.7015s
	iters: 900, epoch: 3 | loss: 0.3162464
	speed: 0.0928s/iter; left time: 753.5183s
	iters: 1000, epoch: 3 | loss: 0.1871548
	speed: 0.0929s/iter; left time: 744.5352s
	iters: 1100, epoch: 3 | loss: 0.2436140
	speed: 0.0932s/iter; left time: 738.0384s
Epoch: 3 cost time: 104.56541061401367
Epoch: 3, Steps: 1127 | Train Loss: 0.2561878 Vali Loss: 0.9476767 Test Loss: 1.0629185
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3969704
	speed: 0.2820s/iter; left time: 2197.0127s
	iters: 200, epoch: 4 | loss: 0.4224057
	speed: 0.0926s/iter; left time: 712.0383s
	iters: 300, epoch: 4 | loss: 0.2100510
	speed: 0.0926s/iter; left time: 702.6650s
	iters: 400, epoch: 4 | loss: 0.3446746
	speed: 0.0926s/iter; left time: 693.7696s
	iters: 500, epoch: 4 | loss: 0.1645924
	speed: 0.0926s/iter; left time: 684.4955s
	iters: 600, epoch: 4 | loss: 0.2441482
	speed: 0.0926s/iter; left time: 674.8386s
	iters: 700, epoch: 4 | loss: 0.1675989
	speed: 0.0927s/iter; left time: 666.3770s
	iters: 800, epoch: 4 | loss: 0.2442540
	speed: 0.0927s/iter; left time: 657.0861s
	iters: 900, epoch: 4 | loss: 0.1718846
	speed: 0.0926s/iter; left time: 647.3206s
	iters: 1000, epoch: 4 | loss: 0.1776808
	speed: 0.0929s/iter; left time: 640.0833s
	iters: 1100, epoch: 4 | loss: 0.2021708
	speed: 0.0932s/iter; left time: 633.1324s
Epoch: 4 cost time: 104.43699383735657
Epoch: 4, Steps: 1127 | Train Loss: 0.2335847 Vali Loss: 0.9402224 Test Loss: 1.0287337
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : weather_720_Transformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed32598<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9820
mse:1.0193700790405273, mae:0.7399287223815918
