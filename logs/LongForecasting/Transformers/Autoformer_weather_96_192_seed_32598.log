Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=21, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=21, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Autoformer', model_id='weather_192', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=192, root_path='./dataset/', seed=32598, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_192_Autoformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed32598>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36600
val 5079
test 10348
	iters: 100, epoch: 1 | loss: 0.5174281
	speed: 0.0977s/iter; left time: 1107.0806s
	iters: 200, epoch: 1 | loss: 0.5500005
	speed: 0.0623s/iter; left time: 699.2151s
	iters: 300, epoch: 1 | loss: 1.1482443
	speed: 0.0619s/iter; left time: 688.7430s
	iters: 400, epoch: 1 | loss: 0.6406122
	speed: 0.0620s/iter; left time: 684.0295s
	iters: 500, epoch: 1 | loss: 0.6127176
	speed: 0.0619s/iter; left time: 677.0232s
	iters: 600, epoch: 1 | loss: 0.5232567
	speed: 0.0619s/iter; left time: 670.9793s
	iters: 700, epoch: 1 | loss: 1.4277722
	speed: 0.0620s/iter; left time: 665.2443s
	iters: 800, epoch: 1 | loss: 0.6828735
	speed: 0.0621s/iter; left time: 659.9622s
	iters: 900, epoch: 1 | loss: 0.5333021
	speed: 0.0620s/iter; left time: 652.5499s
	iters: 1000, epoch: 1 | loss: 0.5120836
	speed: 0.0619s/iter; left time: 645.5713s
	iters: 1100, epoch: 1 | loss: 0.4782160
	speed: 0.0619s/iter; left time: 639.5804s
Epoch: 1 cost time: 74.45577931404114
Epoch: 1, Steps: 1143 | Train Loss: 0.6298187 Vali Loss: 0.6220667 Test Loss: 0.3062801
Validation loss decreased (inf --> 0.622067).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4851667
	speed: 0.2829s/iter; left time: 2882.3133s
	iters: 200, epoch: 2 | loss: 0.8589910
	speed: 0.0627s/iter; left time: 632.3589s
	iters: 300, epoch: 2 | loss: 0.6231568
	speed: 0.0628s/iter; left time: 627.6904s
	iters: 400, epoch: 2 | loss: 0.4640680
	speed: 0.0628s/iter; left time: 621.0714s
	iters: 500, epoch: 2 | loss: 0.4355665
	speed: 0.0629s/iter; left time: 615.1769s
	iters: 600, epoch: 2 | loss: 0.5295022
	speed: 0.0629s/iter; left time: 609.8575s
	iters: 700, epoch: 2 | loss: 0.9889184
	speed: 0.0620s/iter; left time: 594.5877s
	iters: 800, epoch: 2 | loss: 0.9506835
	speed: 0.0619s/iter; left time: 587.2606s
	iters: 900, epoch: 2 | loss: 0.5376617
	speed: 0.0619s/iter; left time: 581.4231s
	iters: 1000, epoch: 2 | loss: 0.5333490
	speed: 0.0621s/iter; left time: 576.5629s
	iters: 1100, epoch: 2 | loss: 0.3735776
	speed: 0.0620s/iter; left time: 569.9414s
Epoch: 2 cost time: 71.26432371139526
Epoch: 2, Steps: 1143 | Train Loss: 0.5742224 Vali Loss: 0.6107417 Test Loss: 0.3064594
Validation loss decreased (0.622067 --> 0.610742).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5401826
	speed: 0.2823s/iter; left time: 2552.9536s
	iters: 200, epoch: 3 | loss: 0.8322707
	speed: 0.0620s/iter; left time: 554.4826s
	iters: 300, epoch: 3 | loss: 0.8350797
	speed: 0.0620s/iter; left time: 548.5943s
	iters: 400, epoch: 3 | loss: 0.4681782
	speed: 0.0620s/iter; left time: 542.5515s
	iters: 500, epoch: 3 | loss: 0.5690608
	speed: 0.0621s/iter; left time: 537.0773s
	iters: 600, epoch: 3 | loss: 0.4288239
	speed: 0.0621s/iter; left time: 530.5785s
	iters: 700, epoch: 3 | loss: 0.4043481
	speed: 0.0626s/iter; left time: 528.9406s
	iters: 800, epoch: 3 | loss: 0.8647820
	speed: 0.0626s/iter; left time: 522.3216s
	iters: 900, epoch: 3 | loss: 0.4521299
	speed: 0.0627s/iter; left time: 516.8180s
	iters: 1000, epoch: 3 | loss: 0.3754557
	speed: 0.0625s/iter; left time: 508.9610s
	iters: 1100, epoch: 3 | loss: 0.3966764
	speed: 0.0624s/iter; left time: 501.9869s
Epoch: 3 cost time: 71.15246081352234
Epoch: 3, Steps: 1143 | Train Loss: 0.5508779 Vali Loss: 0.6115477 Test Loss: 0.3101069
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4218926
	speed: 0.2799s/iter; left time: 2212.0028s
	iters: 200, epoch: 4 | loss: 0.3564265
	speed: 0.0620s/iter; left time: 483.4810s
	iters: 300, epoch: 4 | loss: 0.5371904
	speed: 0.0620s/iter; left time: 477.3698s
	iters: 400, epoch: 4 | loss: 0.5515752
	speed: 0.0618s/iter; left time: 470.0518s
	iters: 500, epoch: 4 | loss: 0.5119866
	speed: 0.0619s/iter; left time: 464.1453s
	iters: 600, epoch: 4 | loss: 0.4995955
	speed: 0.0619s/iter; left time: 457.8963s
	iters: 700, epoch: 4 | loss: 0.4546430
	speed: 0.0618s/iter; left time: 451.0576s
	iters: 800, epoch: 4 | loss: 0.4481265
	speed: 0.0618s/iter; left time: 445.3720s
	iters: 900, epoch: 4 | loss: 0.4124977
	speed: 0.0619s/iter; left time: 439.4824s
	iters: 1000, epoch: 4 | loss: 0.4907480
	speed: 0.0618s/iter; left time: 432.6996s
	iters: 1100, epoch: 4 | loss: 0.5214435
	speed: 0.0620s/iter; left time: 428.1010s
Epoch: 4 cost time: 70.78605508804321
Epoch: 4, Steps: 1143 | Train Loss: 0.5342544 Vali Loss: 0.6152188 Test Loss: 0.3286533
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4785737
	speed: 0.2861s/iter; left time: 1933.6548s
	iters: 200, epoch: 5 | loss: 0.4875420
	speed: 0.0620s/iter; left time: 412.6017s
	iters: 300, epoch: 5 | loss: 0.9651979
	speed: 0.0618s/iter; left time: 405.2730s
	iters: 400, epoch: 5 | loss: 0.8792724
	speed: 0.0618s/iter; left time: 399.1920s
	iters: 500, epoch: 5 | loss: 0.3569972
	speed: 0.0618s/iter; left time: 392.9301s
	iters: 600, epoch: 5 | loss: 0.4716097
	speed: 0.0618s/iter; left time: 387.0908s
	iters: 700, epoch: 5 | loss: 0.4599469
	speed: 0.0618s/iter; left time: 380.3275s
	iters: 800, epoch: 5 | loss: 0.4290009
	speed: 0.0618s/iter; left time: 374.3079s
	iters: 900, epoch: 5 | loss: 0.4001736
	speed: 0.0620s/iter; left time: 369.3524s
	iters: 1000, epoch: 5 | loss: 0.4849652
	speed: 0.0619s/iter; left time: 362.7871s
	iters: 1100, epoch: 5 | loss: 0.4569555
	speed: 0.0618s/iter; left time: 355.9827s
Epoch: 5 cost time: 70.73830533027649
Epoch: 5, Steps: 1143 | Train Loss: 0.5241473 Vali Loss: 0.6160316 Test Loss: 0.3265025
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : weather_192_Autoformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed32598<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10348
mse:0.30684414505958557, mae:0.3610638976097107
