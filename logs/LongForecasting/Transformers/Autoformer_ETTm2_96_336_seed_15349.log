Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Autoformer', model_id='ETTm2_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=336, root_path='./dataset/', seed=15349, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm2_336_Autoformer_ETTm2_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed15349>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34129
val 11185
test 11185
	iters: 100, epoch: 1 | loss: 0.5641142
	speed: 0.1163s/iter; left time: 1228.6918s
	iters: 200, epoch: 1 | loss: 0.3077950
	speed: 0.0823s/iter; left time: 861.4333s
	iters: 300, epoch: 1 | loss: 0.3932525
	speed: 0.0825s/iter; left time: 854.3206s
	iters: 400, epoch: 1 | loss: 0.3716376
	speed: 0.0824s/iter; left time: 845.7529s
	iters: 500, epoch: 1 | loss: 0.4189504
	speed: 0.0825s/iter; left time: 838.2716s
	iters: 600, epoch: 1 | loss: 0.2901599
	speed: 0.0827s/iter; left time: 831.8633s
	iters: 700, epoch: 1 | loss: 0.3329729
	speed: 0.0829s/iter; left time: 825.7993s
	iters: 800, epoch: 1 | loss: 0.1609285
	speed: 0.0829s/iter; left time: 817.3241s
	iters: 900, epoch: 1 | loss: 0.9282143
	speed: 0.0827s/iter; left time: 807.4407s
	iters: 1000, epoch: 1 | loss: 0.3572402
	speed: 0.0824s/iter; left time: 796.4822s
Epoch: 1 cost time: 91.45453310012817
Epoch: 1, Steps: 1066 | Train Loss: 0.4541571 Vali Loss: 0.2499469 Test Loss: 0.3441580
Validation loss decreased (inf --> 0.249947).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.7706119
	speed: 0.5152s/iter; left time: 4892.1209s
	iters: 200, epoch: 2 | loss: 0.5183336
	speed: 0.0824s/iter; left time: 773.7490s
	iters: 300, epoch: 2 | loss: 0.6001472
	speed: 0.0824s/iter; left time: 765.6960s
	iters: 400, epoch: 2 | loss: 0.6363713
	speed: 0.0823s/iter; left time: 757.0071s
	iters: 500, epoch: 2 | loss: 0.5097572
	speed: 0.0825s/iter; left time: 750.4373s
	iters: 600, epoch: 2 | loss: 0.4697450
	speed: 0.0827s/iter; left time: 744.2469s
	iters: 700, epoch: 2 | loss: 0.4094851
	speed: 0.0827s/iter; left time: 735.4723s
	iters: 800, epoch: 2 | loss: 0.7886739
	speed: 0.0827s/iter; left time: 727.6209s
	iters: 900, epoch: 2 | loss: 0.4153242
	speed: 0.0824s/iter; left time: 716.3324s
	iters: 1000, epoch: 2 | loss: 0.2806135
	speed: 0.0824s/iter; left time: 708.5700s
Epoch: 2 cost time: 87.9229211807251
Epoch: 2, Steps: 1066 | Train Loss: 0.4268643 Vali Loss: 0.2791210 Test Loss: 0.3917721
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2035619
	speed: 0.5139s/iter; left time: 4331.6215s
	iters: 200, epoch: 3 | loss: 0.4478278
	speed: 0.0823s/iter; left time: 685.3861s
	iters: 300, epoch: 3 | loss: 0.4778228
	speed: 0.0823s/iter; left time: 677.4329s
	iters: 400, epoch: 3 | loss: 0.4147265
	speed: 0.0825s/iter; left time: 670.4932s
	iters: 500, epoch: 3 | loss: 0.3517872
	speed: 0.0827s/iter; left time: 664.1017s
	iters: 600, epoch: 3 | loss: 0.2499470
	speed: 0.0829s/iter; left time: 656.9185s
	iters: 700, epoch: 3 | loss: 0.3652951
	speed: 0.0829s/iter; left time: 648.9813s
	iters: 800, epoch: 3 | loss: 0.2225956
	speed: 0.0825s/iter; left time: 637.3905s
	iters: 900, epoch: 3 | loss: 0.2565424
	speed: 0.0823s/iter; left time: 627.6083s
	iters: 1000, epoch: 3 | loss: 0.2436239
	speed: 0.0824s/iter; left time: 620.0339s
Epoch: 3 cost time: 87.92540717124939
Epoch: 3, Steps: 1066 | Train Loss: 0.3865413 Vali Loss: 0.2732392 Test Loss: 0.3825102
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2799421
	speed: 0.5142s/iter; left time: 3786.3680s
	iters: 200, epoch: 4 | loss: 0.1641146
	speed: 0.0825s/iter; left time: 599.5229s
	iters: 300, epoch: 4 | loss: 0.5460039
	speed: 0.0826s/iter; left time: 591.5788s
	iters: 400, epoch: 4 | loss: 0.2872988
	speed: 0.0828s/iter; left time: 584.6226s
	iters: 500, epoch: 4 | loss: 0.4008585
	speed: 0.0827s/iter; left time: 576.0418s
	iters: 600, epoch: 4 | loss: 0.4388305
	speed: 0.0829s/iter; left time: 568.7752s
	iters: 700, epoch: 4 | loss: 0.3077406
	speed: 0.0826s/iter; left time: 558.4355s
	iters: 800, epoch: 4 | loss: 0.2646158
	speed: 0.0824s/iter; left time: 549.3405s
	iters: 900, epoch: 4 | loss: 0.2661950
	speed: 0.0825s/iter; left time: 541.1915s
	iters: 1000, epoch: 4 | loss: 0.3680651
	speed: 0.0824s/iter; left time: 532.5261s
Epoch: 4 cost time: 88.02498435974121
Epoch: 4, Steps: 1066 | Train Loss: 0.3652143 Vali Loss: 0.2777977 Test Loss: 0.3885303
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : ETTm2_336_Autoformer_ETTm2_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed15349<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
mse:0.3441254198551178, mae:0.37548643350601196
