Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm1', data_path='ETTm1.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Autoformer', model_id='ETTm1_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=96, root_path='./dataset/', seed=32598, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm1_96_Autoformer_ETTm1_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed32598>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34369
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.4308703
	speed: 0.0812s/iter; left time: 864.0598s
	iters: 200, epoch: 1 | loss: 0.3782987
	speed: 0.0473s/iter; left time: 498.4417s
	iters: 300, epoch: 1 | loss: 0.3875826
	speed: 0.0473s/iter; left time: 493.4014s
	iters: 400, epoch: 1 | loss: 0.3768021
	speed: 0.0472s/iter; left time: 488.3902s
	iters: 500, epoch: 1 | loss: 0.3387424
	speed: 0.0472s/iter; left time: 483.7787s
	iters: 600, epoch: 1 | loss: 0.3083088
	speed: 0.0472s/iter; left time: 479.0930s
	iters: 700, epoch: 1 | loss: 0.3291831
	speed: 0.0473s/iter; left time: 475.2084s
	iters: 800, epoch: 1 | loss: 0.2861585
	speed: 0.0473s/iter; left time: 470.0130s
	iters: 900, epoch: 1 | loss: 0.2334431
	speed: 0.0473s/iter; left time: 465.4314s
	iters: 1000, epoch: 1 | loss: 0.3366045
	speed: 0.0472s/iter; left time: 459.6812s
Epoch: 1 cost time: 54.17449593544006
Epoch: 1, Steps: 1074 | Train Loss: 0.3348124 Vali Loss: 0.5552138 Test Loss: 0.4539560
Validation loss decreased (inf --> 0.555214).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2960870
	speed: 0.2771s/iter; left time: 2650.7517s
	iters: 200, epoch: 2 | loss: 0.3186850
	speed: 0.0473s/iter; left time: 447.4401s
	iters: 300, epoch: 2 | loss: 0.2211254
	speed: 0.0474s/iter; left time: 444.0358s
	iters: 400, epoch: 2 | loss: 0.2678497
	speed: 0.0473s/iter; left time: 437.9813s
	iters: 500, epoch: 2 | loss: 0.2743201
	speed: 0.0473s/iter; left time: 433.3192s
	iters: 600, epoch: 2 | loss: 0.2618734
	speed: 0.0473s/iter; left time: 428.7549s
	iters: 700, epoch: 2 | loss: 0.2333782
	speed: 0.0473s/iter; left time: 424.3459s
	iters: 800, epoch: 2 | loss: 0.2324732
	speed: 0.0471s/iter; left time: 418.0605s
	iters: 900, epoch: 2 | loss: 0.1877207
	speed: 0.0473s/iter; left time: 414.4839s
	iters: 1000, epoch: 2 | loss: 0.1933811
	speed: 0.0472s/iter; left time: 409.1930s
Epoch: 2 cost time: 50.76517295837402
Epoch: 2, Steps: 1074 | Train Loss: 0.2458233 Vali Loss: 0.5703663 Test Loss: 0.4422444
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1658015
	speed: 0.2747s/iter; left time: 2333.1336s
	iters: 200, epoch: 3 | loss: 0.1663140
	speed: 0.0473s/iter; left time: 396.6776s
	iters: 300, epoch: 3 | loss: 0.1939843
	speed: 0.0473s/iter; left time: 392.0875s
	iters: 400, epoch: 3 | loss: 0.2203369
	speed: 0.0473s/iter; left time: 387.3677s
	iters: 500, epoch: 3 | loss: 0.2316391
	speed: 0.0471s/iter; left time: 381.5456s
	iters: 600, epoch: 3 | loss: 0.1813332
	speed: 0.0473s/iter; left time: 378.0032s
	iters: 700, epoch: 3 | loss: 0.1837895
	speed: 0.0473s/iter; left time: 373.4081s
	iters: 800, epoch: 3 | loss: 0.2259601
	speed: 0.0473s/iter; left time: 368.3502s
	iters: 900, epoch: 3 | loss: 0.1762262
	speed: 0.0474s/iter; left time: 364.3746s
	iters: 1000, epoch: 3 | loss: 0.2183528
	speed: 0.0473s/iter; left time: 358.8356s
Epoch: 3 cost time: 50.7476749420166
Epoch: 3, Steps: 1074 | Train Loss: 0.2008868 Vali Loss: 0.5469469 Test Loss: 0.4467572
Validation loss decreased (0.555214 --> 0.546947).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2331552
	speed: 0.2767s/iter; left time: 2052.5563s
	iters: 200, epoch: 4 | loss: 0.1560705
	speed: 0.0472s/iter; left time: 345.5683s
	iters: 300, epoch: 4 | loss: 0.1593884
	speed: 0.0472s/iter; left time: 340.9623s
	iters: 400, epoch: 4 | loss: 0.1689233
	speed: 0.0473s/iter; left time: 336.7848s
	iters: 500, epoch: 4 | loss: 0.1721440
	speed: 0.0472s/iter; left time: 331.6059s
	iters: 600, epoch: 4 | loss: 0.1654720
	speed: 0.0473s/iter; left time: 327.5512s
	iters: 700, epoch: 4 | loss: 0.1567148
	speed: 0.0474s/iter; left time: 322.9461s
	iters: 800, epoch: 4 | loss: 0.1818500
	speed: 0.0473s/iter; left time: 317.9911s
	iters: 900, epoch: 4 | loss: 0.2330897
	speed: 0.0472s/iter; left time: 312.4135s
	iters: 1000, epoch: 4 | loss: 0.1548718
	speed: 0.0473s/iter; left time: 308.1496s
Epoch: 4 cost time: 50.78680896759033
Epoch: 4, Steps: 1074 | Train Loss: 0.1781800 Vali Loss: 0.5596124 Test Loss: 0.4593396
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1478738
	speed: 0.2746s/iter; left time: 1742.2513s
	iters: 200, epoch: 5 | loss: 0.1494168
	speed: 0.0472s/iter; left time: 294.9670s
	iters: 300, epoch: 5 | loss: 0.1617089
	speed: 0.0472s/iter; left time: 290.0244s
	iters: 400, epoch: 5 | loss: 0.1382948
	speed: 0.0473s/iter; left time: 285.7272s
	iters: 500, epoch: 5 | loss: 0.1628775
	speed: 0.0472s/iter; left time: 280.4445s
	iters: 600, epoch: 5 | loss: 0.1803033
	speed: 0.0472s/iter; left time: 275.8041s
	iters: 700, epoch: 5 | loss: 0.1778552
	speed: 0.0472s/iter; left time: 271.2971s
	iters: 800, epoch: 5 | loss: 0.1724673
	speed: 0.0473s/iter; left time: 266.7896s
	iters: 900, epoch: 5 | loss: 0.1443949
	speed: 0.0472s/iter; left time: 261.9580s
	iters: 1000, epoch: 5 | loss: 0.1350951
	speed: 0.0473s/iter; left time: 257.4942s
Epoch: 5 cost time: 50.73714280128479
Epoch: 5, Steps: 1074 | Train Loss: 0.1673837 Vali Loss: 0.5649168 Test Loss: 0.4665934
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1437300
	speed: 0.2750s/iter; left time: 1449.6945s
	iters: 200, epoch: 6 | loss: 0.1531796
	speed: 0.0472s/iter; left time: 244.1249s
	iters: 300, epoch: 6 | loss: 0.1466883
	speed: 0.0472s/iter; left time: 239.3298s
	iters: 400, epoch: 6 | loss: 0.1565641
	speed: 0.0473s/iter; left time: 234.9728s
	iters: 500, epoch: 6 | loss: 0.1556436
	speed: 0.0472s/iter; left time: 229.7854s
	iters: 600, epoch: 6 | loss: 0.2017695
	speed: 0.0472s/iter; left time: 225.2172s
	iters: 700, epoch: 6 | loss: 0.1601073
	speed: 0.0473s/iter; left time: 220.8091s
	iters: 800, epoch: 6 | loss: 0.1755855
	speed: 0.0471s/iter; left time: 215.2513s
	iters: 900, epoch: 6 | loss: 0.1480770
	speed: 0.0473s/iter; left time: 211.3039s
	iters: 1000, epoch: 6 | loss: 0.1435330
	speed: 0.0472s/iter; left time: 206.4749s
Epoch: 6 cost time: 50.712308168411255
Epoch: 6, Steps: 1074 | Train Loss: 0.1615759 Vali Loss: 0.5577916 Test Loss: 0.4583021
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : ETTm1_96_Autoformer_ETTm1_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed32598<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.44673800468444824, mae:0.4510892331600189
