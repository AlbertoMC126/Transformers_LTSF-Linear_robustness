Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=21, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=21, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Informer', model_id='weather_192', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=192, root_path='./dataset/', seed=25565, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_192_Informer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed25565>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36600
val 5079
test 10348
	iters: 100, epoch: 1 | loss: 0.4077134
	speed: 0.0645s/iter; left time: 731.2418s
	iters: 200, epoch: 1 | loss: 0.4546084
	speed: 0.0341s/iter; left time: 382.5041s
	iters: 300, epoch: 1 | loss: 0.5737715
	speed: 0.0340s/iter; left time: 378.3013s
	iters: 400, epoch: 1 | loss: 0.3966538
	speed: 0.0338s/iter; left time: 373.0573s
	iters: 500, epoch: 1 | loss: 0.3217739
	speed: 0.0334s/iter; left time: 365.6056s
	iters: 600, epoch: 1 | loss: 0.3755870
	speed: 0.0333s/iter; left time: 361.2019s
	iters: 700, epoch: 1 | loss: 0.2839599
	speed: 0.0334s/iter; left time: 358.4656s
	iters: 800, epoch: 1 | loss: 0.2976299
	speed: 0.0334s/iter; left time: 355.1723s
	iters: 900, epoch: 1 | loss: 0.2742393
	speed: 0.0335s/iter; left time: 352.4595s
	iters: 1000, epoch: 1 | loss: 0.3386167
	speed: 0.0336s/iter; left time: 350.4100s
	iters: 1100, epoch: 1 | loss: 0.3372871
	speed: 0.0335s/iter; left time: 346.3442s
Epoch: 1 cost time: 41.51752972602844
Epoch: 1, Steps: 1143 | Train Loss: 0.4398757 Vali Loss: 0.6055645 Test Loss: 0.6893492
Validation loss decreased (inf --> 0.605565).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3369664
	speed: 0.1115s/iter; left time: 1136.2085s
	iters: 200, epoch: 2 | loss: 0.3306139
	speed: 0.0351s/iter; left time: 353.6082s
	iters: 300, epoch: 2 | loss: 0.4433178
	speed: 0.0351s/iter; left time: 350.2083s
	iters: 400, epoch: 2 | loss: 0.3146321
	speed: 0.0349s/iter; left time: 345.5082s
	iters: 500, epoch: 2 | loss: 0.2426599
	speed: 0.0352s/iter; left time: 344.4994s
	iters: 600, epoch: 2 | loss: 0.2910286
	speed: 0.0348s/iter; left time: 337.1886s
	iters: 700, epoch: 2 | loss: 0.3450472
	speed: 0.0349s/iter; left time: 334.2987s
	iters: 800, epoch: 2 | loss: 0.2391283
	speed: 0.0352s/iter; left time: 333.5338s
	iters: 900, epoch: 2 | loss: 0.3040902
	speed: 0.0336s/iter; left time: 315.3336s
	iters: 1000, epoch: 2 | loss: 0.1814699
	speed: 0.0337s/iter; left time: 312.8008s
	iters: 1100, epoch: 2 | loss: 0.2633672
	speed: 0.0336s/iter; left time: 308.8637s
Epoch: 2 cost time: 39.52350115776062
Epoch: 2, Steps: 1143 | Train Loss: 0.3451203 Vali Loss: 0.5464836 Test Loss: 0.4657774
Validation loss decreased (0.605565 --> 0.546484).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5162923
	speed: 0.1108s/iter; left time: 1001.8719s
	iters: 200, epoch: 3 | loss: 0.2714590
	speed: 0.0338s/iter; left time: 302.0981s
	iters: 300, epoch: 3 | loss: 0.1958643
	speed: 0.0335s/iter; left time: 296.3768s
	iters: 400, epoch: 3 | loss: 0.2421116
	speed: 0.0339s/iter; left time: 296.2406s
	iters: 500, epoch: 3 | loss: 0.1998497
	speed: 0.0338s/iter; left time: 292.1500s
	iters: 600, epoch: 3 | loss: 0.1593785
	speed: 0.0340s/iter; left time: 290.8998s
	iters: 700, epoch: 3 | loss: 0.7251895
	speed: 0.0336s/iter; left time: 283.4695s
	iters: 800, epoch: 3 | loss: 0.2206017
	speed: 0.0336s/iter; left time: 280.3192s
	iters: 900, epoch: 3 | loss: 0.1787567
	speed: 0.0335s/iter; left time: 276.1751s
	iters: 1000, epoch: 3 | loss: 0.2783798
	speed: 0.0338s/iter; left time: 275.2797s
	iters: 1100, epoch: 3 | loss: 0.2685923
	speed: 0.0338s/iter; left time: 271.8432s
Epoch: 3 cost time: 38.54091811180115
Epoch: 3, Steps: 1143 | Train Loss: 0.2790523 Vali Loss: 0.5225824 Test Loss: 0.4323124
Validation loss decreased (0.546484 --> 0.522582).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2003239
	speed: 0.1107s/iter; left time: 874.9242s
	iters: 200, epoch: 4 | loss: 0.4715424
	speed: 0.0334s/iter; left time: 260.6391s
	iters: 300, epoch: 4 | loss: 0.2271732
	speed: 0.0334s/iter; left time: 257.0355s
	iters: 400, epoch: 4 | loss: 0.2822044
	speed: 0.0334s/iter; left time: 254.2673s
	iters: 500, epoch: 4 | loss: 0.1892748
	speed: 0.0334s/iter; left time: 250.9176s
	iters: 600, epoch: 4 | loss: 0.2694852
	speed: 0.0334s/iter; left time: 247.3527s
	iters: 700, epoch: 4 | loss: 0.1570240
	speed: 0.0335s/iter; left time: 244.5467s
	iters: 800, epoch: 4 | loss: 0.1798933
	speed: 0.0334s/iter; left time: 240.8761s
	iters: 900, epoch: 4 | loss: 0.1546881
	speed: 0.0351s/iter; left time: 249.6037s
	iters: 1000, epoch: 4 | loss: 0.1832151
	speed: 0.0352s/iter; left time: 246.6157s
	iters: 1100, epoch: 4 | loss: 0.1516973
	speed: 0.0352s/iter; left time: 243.0917s
Epoch: 4 cost time: 38.81868267059326
Epoch: 4, Steps: 1143 | Train Loss: 0.2520708 Vali Loss: 0.5451165 Test Loss: 0.4458185
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1502393
	speed: 0.1115s/iter; left time: 753.9571s
	iters: 200, epoch: 5 | loss: 0.1562418
	speed: 0.0351s/iter; left time: 233.7510s
	iters: 300, epoch: 5 | loss: 0.1543972
	speed: 0.0351s/iter; left time: 230.1753s
	iters: 400, epoch: 5 | loss: 0.1934788
	speed: 0.0344s/iter; left time: 222.4851s
	iters: 500, epoch: 5 | loss: 0.4726427
	speed: 0.0338s/iter; left time: 214.6699s
	iters: 600, epoch: 5 | loss: 0.2766258
	speed: 0.0336s/iter; left time: 210.0531s
	iters: 700, epoch: 5 | loss: 0.1845869
	speed: 0.0336s/iter; left time: 206.7937s
	iters: 800, epoch: 5 | loss: 0.1800581
	speed: 0.0336s/iter; left time: 203.7490s
	iters: 900, epoch: 5 | loss: 0.1690741
	speed: 0.0339s/iter; left time: 201.8084s
	iters: 1000, epoch: 5 | loss: 0.1388124
	speed: 0.0340s/iter; left time: 199.2335s
	iters: 1100, epoch: 5 | loss: 0.4050638
	speed: 0.0341s/iter; left time: 196.5773s
Epoch: 5 cost time: 39.08347177505493
Epoch: 5, Steps: 1143 | Train Loss: 0.2395402 Vali Loss: 0.5444395 Test Loss: 0.4620655
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1669530
	speed: 0.1084s/iter; left time: 608.9961s
	iters: 200, epoch: 6 | loss: 0.1614098
	speed: 0.0337s/iter; left time: 185.7827s
	iters: 300, epoch: 6 | loss: 0.1482793
	speed: 0.0339s/iter; left time: 183.5280s
	iters: 400, epoch: 6 | loss: 0.1554035
	speed: 0.0340s/iter; left time: 180.9863s
	iters: 500, epoch: 6 | loss: 0.1875762
	speed: 0.0339s/iter; left time: 176.9188s
	iters: 600, epoch: 6 | loss: 0.1839828
	speed: 0.0339s/iter; left time: 173.3604s
	iters: 700, epoch: 6 | loss: 0.1847009
	speed: 0.0337s/iter; left time: 169.1641s
	iters: 800, epoch: 6 | loss: 0.1795656
	speed: 0.0338s/iter; left time: 166.0433s
	iters: 900, epoch: 6 | loss: 0.1530947
	speed: 0.0338s/iter; left time: 163.0069s
	iters: 1000, epoch: 6 | loss: 0.5462853
	speed: 0.0338s/iter; left time: 159.4834s
	iters: 1100, epoch: 6 | loss: 0.1344228
	speed: 0.0339s/iter; left time: 156.5233s
Epoch: 6 cost time: 38.68579649925232
Epoch: 6, Steps: 1143 | Train Loss: 0.2337336 Vali Loss: 0.5417804 Test Loss: 0.4359364
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : weather_192_Informer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed25565<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10348
mse:0.43240609765052795, mae:0.434949666261673
