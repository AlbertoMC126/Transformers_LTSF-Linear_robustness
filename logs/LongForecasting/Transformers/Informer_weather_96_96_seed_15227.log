Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=21, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=21, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Informer', model_id='weather_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=96, root_path='./dataset/', seed=15227, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_96_Informer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed15227>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36696
val 5175
test 10444
	iters: 100, epoch: 1 | loss: 0.3911940
	speed: 0.0576s/iter; left time: 654.0785s
	iters: 200, epoch: 1 | loss: 0.3067564
	speed: 0.0273s/iter; left time: 307.4130s
	iters: 300, epoch: 1 | loss: 0.2865141
	speed: 0.0275s/iter; left time: 306.7965s
	iters: 400, epoch: 1 | loss: 0.2890228
	speed: 0.0289s/iter; left time: 319.7076s
	iters: 500, epoch: 1 | loss: 0.3089910
	speed: 0.0284s/iter; left time: 311.7536s
	iters: 600, epoch: 1 | loss: 0.3454765
	speed: 0.0284s/iter; left time: 308.8384s
	iters: 700, epoch: 1 | loss: 0.2934852
	speed: 0.0289s/iter; left time: 311.0964s
	iters: 800, epoch: 1 | loss: 0.4417644
	speed: 0.0289s/iter; left time: 308.5743s
	iters: 900, epoch: 1 | loss: 0.1853039
	speed: 0.0285s/iter; left time: 300.7241s
	iters: 1000, epoch: 1 | loss: 0.4218794
	speed: 0.0286s/iter; left time: 298.8264s
	iters: 1100, epoch: 1 | loss: 0.2474232
	speed: 0.0284s/iter; left time: 293.8930s
Epoch: 1 cost time: 35.46072292327881
Epoch: 1, Steps: 1146 | Train Loss: 0.4025479 Vali Loss: 0.5243880 Test Loss: 0.4662648
Validation loss decreased (inf --> 0.524388).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2749173
	speed: 0.0896s/iter; left time: 915.3132s
	iters: 200, epoch: 2 | loss: 0.2431958
	speed: 0.0276s/iter; left time: 279.3502s
	iters: 300, epoch: 2 | loss: 0.4259591
	speed: 0.0276s/iter; left time: 276.7709s
	iters: 400, epoch: 2 | loss: 0.1963378
	speed: 0.0277s/iter; left time: 274.5291s
	iters: 500, epoch: 2 | loss: 0.1970030
	speed: 0.0278s/iter; left time: 273.0433s
	iters: 600, epoch: 2 | loss: 0.3070796
	speed: 0.0278s/iter; left time: 269.8609s
	iters: 700, epoch: 2 | loss: 0.8066661
	speed: 0.0276s/iter; left time: 264.9587s
	iters: 800, epoch: 2 | loss: 0.1702535
	speed: 0.0275s/iter; left time: 262.1241s
	iters: 900, epoch: 2 | loss: 0.1602342
	speed: 0.0276s/iter; left time: 260.2117s
	iters: 1000, epoch: 2 | loss: 0.8835544
	speed: 0.0277s/iter; left time: 257.6141s
	iters: 1100, epoch: 2 | loss: 0.8612866
	speed: 0.0277s/iter; left time: 254.8510s
Epoch: 2 cost time: 31.738802671432495
Epoch: 2, Steps: 1146 | Train Loss: 0.3271749 Vali Loss: 0.5222258 Test Loss: 0.3314602
Validation loss decreased (0.524388 --> 0.522226).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2187434
	speed: 0.0907s/iter; left time: 823.0097s
	iters: 200, epoch: 3 | loss: 0.2843714
	speed: 0.0274s/iter; left time: 245.6898s
	iters: 300, epoch: 3 | loss: 0.1578057
	speed: 0.0277s/iter; left time: 245.4763s
	iters: 400, epoch: 3 | loss: 0.2414791
	speed: 0.0278s/iter; left time: 243.3554s
	iters: 500, epoch: 3 | loss: 0.2831136
	speed: 0.0276s/iter; left time: 239.4171s
	iters: 600, epoch: 3 | loss: 0.3441640
	speed: 0.0280s/iter; left time: 239.7338s
	iters: 700, epoch: 3 | loss: 0.1778091
	speed: 0.0276s/iter; left time: 233.8653s
	iters: 800, epoch: 3 | loss: 0.2112139
	speed: 0.0275s/iter; left time: 230.0374s
	iters: 900, epoch: 3 | loss: 0.1369845
	speed: 0.0275s/iter; left time: 227.0666s
	iters: 1000, epoch: 3 | loss: 0.2741382
	speed: 0.0273s/iter; left time: 223.0665s
	iters: 1100, epoch: 3 | loss: 0.1592356
	speed: 0.0273s/iter; left time: 220.5656s
Epoch: 3 cost time: 31.561707019805908
Epoch: 3, Steps: 1146 | Train Loss: 0.2680369 Vali Loss: 0.5432567 Test Loss: 0.3987945
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1942769
	speed: 0.0855s/iter; left time: 677.2539s
	iters: 200, epoch: 4 | loss: 0.2544753
	speed: 0.0273s/iter; left time: 213.7135s
	iters: 300, epoch: 4 | loss: 0.3251271
	speed: 0.0273s/iter; left time: 210.8393s
	iters: 400, epoch: 4 | loss: 0.1661509
	speed: 0.0273s/iter; left time: 208.2609s
	iters: 500, epoch: 4 | loss: 0.9922383
	speed: 0.0273s/iter; left time: 205.3983s
	iters: 600, epoch: 4 | loss: 0.1774351
	speed: 0.0273s/iter; left time: 202.9626s
	iters: 700, epoch: 4 | loss: 0.1552505
	speed: 0.0284s/iter; left time: 207.9556s
	iters: 800, epoch: 4 | loss: 0.2424542
	speed: 0.0292s/iter; left time: 210.9892s
	iters: 900, epoch: 4 | loss: 0.1494101
	speed: 0.0292s/iter; left time: 208.1288s
	iters: 1000, epoch: 4 | loss: 0.1591849
	speed: 0.0293s/iter; left time: 205.9897s
	iters: 1100, epoch: 4 | loss: 0.1230159
	speed: 0.0294s/iter; left time: 203.1997s
Epoch: 4 cost time: 32.28879427909851
Epoch: 4, Steps: 1146 | Train Loss: 0.2401701 Vali Loss: 0.5060232 Test Loss: 0.3955078
Validation loss decreased (0.522226 --> 0.506023).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1608183
	speed: 0.0934s/iter; left time: 632.8594s
	iters: 200, epoch: 5 | loss: 0.1581162
	speed: 0.0292s/iter; left time: 194.8939s
	iters: 300, epoch: 5 | loss: 0.1294420
	speed: 0.0295s/iter; left time: 194.0878s
	iters: 400, epoch: 5 | loss: 0.1346539
	speed: 0.0287s/iter; left time: 185.8264s
	iters: 500, epoch: 5 | loss: 0.1359601
	speed: 0.0275s/iter; left time: 175.3887s
	iters: 600, epoch: 5 | loss: 0.1627990
	speed: 0.0275s/iter; left time: 172.4985s
	iters: 700, epoch: 5 | loss: 0.1601424
	speed: 0.0274s/iter; left time: 169.4961s
	iters: 800, epoch: 5 | loss: 0.1892961
	speed: 0.0276s/iter; left time: 167.6451s
	iters: 900, epoch: 5 | loss: 0.3187024
	speed: 0.0277s/iter; left time: 165.7808s
	iters: 1000, epoch: 5 | loss: 0.1471558
	speed: 0.0277s/iter; left time: 162.6522s
	iters: 1100, epoch: 5 | loss: 0.1886512
	speed: 0.0277s/iter; left time: 160.2955s
Epoch: 5 cost time: 32.2897834777832
Epoch: 5, Steps: 1146 | Train Loss: 0.2278317 Vali Loss: 0.5050818 Test Loss: 0.3911307
Validation loss decreased (0.506023 --> 0.505082).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1052150
	speed: 0.0885s/iter; left time: 498.5159s
	iters: 200, epoch: 6 | loss: 0.1323832
	speed: 0.0276s/iter; left time: 152.6449s
	iters: 300, epoch: 6 | loss: 0.1428112
	speed: 0.0275s/iter; left time: 149.6148s
	iters: 400, epoch: 6 | loss: 0.1179041
	speed: 0.0278s/iter; left time: 147.9422s
	iters: 500, epoch: 6 | loss: 0.1525589
	speed: 0.0277s/iter; left time: 144.8436s
	iters: 600, epoch: 6 | loss: 0.1323767
	speed: 0.0278s/iter; left time: 142.8626s
	iters: 700, epoch: 6 | loss: 0.1634551
	speed: 0.0278s/iter; left time: 139.9467s
	iters: 800, epoch: 6 | loss: 0.2295556
	speed: 0.0277s/iter; left time: 136.6162s
	iters: 900, epoch: 6 | loss: 0.1654727
	speed: 0.0278s/iter; left time: 134.2425s
	iters: 1000, epoch: 6 | loss: 0.1669423
	speed: 0.0277s/iter; left time: 130.8486s
	iters: 1100, epoch: 6 | loss: 0.1035877
	speed: 0.0277s/iter; left time: 128.2022s
Epoch: 6 cost time: 31.74254322052002
Epoch: 6, Steps: 1146 | Train Loss: 0.2215910 Vali Loss: 0.5134303 Test Loss: 0.4037188
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1310610
	speed: 0.0864s/iter; left time: 387.3504s
	iters: 200, epoch: 7 | loss: 0.2403893
	speed: 0.0278s/iter; left time: 122.1215s
	iters: 300, epoch: 7 | loss: 0.1643940
	speed: 0.0277s/iter; left time: 118.6792s
	iters: 400, epoch: 7 | loss: 0.1355542
	speed: 0.0279s/iter; left time: 116.5882s
	iters: 500, epoch: 7 | loss: 0.1359796
	speed: 0.0276s/iter; left time: 112.6184s
	iters: 600, epoch: 7 | loss: 0.1448528
	speed: 0.0276s/iter; left time: 109.8585s
	iters: 700, epoch: 7 | loss: 0.1418434
	speed: 0.0277s/iter; left time: 107.7274s
	iters: 800, epoch: 7 | loss: 0.1516554
	speed: 0.0278s/iter; left time: 105.0733s
	iters: 900, epoch: 7 | loss: 0.1406409
	speed: 0.0278s/iter; left time: 102.4743s
	iters: 1000, epoch: 7 | loss: 0.1682604
	speed: 0.0280s/iter; left time: 100.2223s
	iters: 1100, epoch: 7 | loss: 0.1412836
	speed: 0.0290s/iter; left time: 100.9454s
Epoch: 7 cost time: 31.957945823669434
Epoch: 7, Steps: 1146 | Train Loss: 0.2187899 Vali Loss: 0.5112785 Test Loss: 0.4093003
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2423267
	speed: 0.0882s/iter; left time: 294.6169s
	iters: 200, epoch: 8 | loss: 0.1058476
	speed: 0.0287s/iter; left time: 93.0306s
	iters: 300, epoch: 8 | loss: 0.2703809
	speed: 0.0285s/iter; left time: 89.6021s
	iters: 400, epoch: 8 | loss: 0.1283835
	speed: 0.0288s/iter; left time: 87.3935s
	iters: 500, epoch: 8 | loss: 0.1145767
	speed: 0.0287s/iter; left time: 84.4115s
	iters: 600, epoch: 8 | loss: 0.2591004
	speed: 0.0287s/iter; left time: 81.6082s
	iters: 700, epoch: 8 | loss: 0.1276230
	speed: 0.0286s/iter; left time: 78.2347s
	iters: 800, epoch: 8 | loss: 0.1073930
	speed: 0.0279s/iter; left time: 73.5946s
	iters: 900, epoch: 8 | loss: 0.1383004
	speed: 0.0278s/iter; left time: 70.5539s
	iters: 1000, epoch: 8 | loss: 0.7423587
	speed: 0.0278s/iter; left time: 67.8888s
	iters: 1100, epoch: 8 | loss: 0.1486613
	speed: 0.0275s/iter; left time: 64.4304s
Epoch: 8 cost time: 32.44832491874695
Epoch: 8, Steps: 1146 | Train Loss: 0.2166789 Vali Loss: 0.5137294 Test Loss: 0.4198793
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : weather_96_Informer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed15227<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
mse:0.390583336353302, mae:0.43109190464019775
