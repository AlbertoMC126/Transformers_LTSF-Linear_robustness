Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=321, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', dec_in=321, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Autoformer', model_id='electricity_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=336, root_path='./dataset/', seed=32598, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : electricity_336_Autoformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed32598>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17981
val 2297
test 4925
	iters: 100, epoch: 1 | loss: 0.3754805
	speed: 0.1293s/iter; left time: 712.5821s
	iters: 200, epoch: 1 | loss: 0.3351258
	speed: 0.0947s/iter; left time: 512.4469s
	iters: 300, epoch: 1 | loss: 0.2557079
	speed: 0.0944s/iter; left time: 501.4089s
	iters: 400, epoch: 1 | loss: 0.2448397
	speed: 0.0945s/iter; left time: 492.3946s
	iters: 500, epoch: 1 | loss: 0.2457770
	speed: 0.0945s/iter; left time: 482.9424s
Epoch: 1 cost time: 56.57388257980347
Epoch: 1, Steps: 561 | Train Loss: 0.3127126 Vali Loss: 0.2336007 Test Loss: 0.2560345
Validation loss decreased (inf --> 0.233601).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2061697
	speed: 0.3472s/iter; left time: 1718.8147s
	iters: 200, epoch: 2 | loss: 0.2276810
	speed: 0.0979s/iter; left time: 474.7924s
	iters: 300, epoch: 2 | loss: 0.1910188
	speed: 0.0977s/iter; left time: 464.0467s
	iters: 400, epoch: 2 | loss: 0.1827768
	speed: 0.0966s/iter; left time: 449.2854s
	iters: 500, epoch: 2 | loss: 0.1712991
	speed: 0.0947s/iter; left time: 431.0316s
Epoch: 2 cost time: 54.061580419540405
Epoch: 2, Steps: 561 | Train Loss: 0.2019682 Vali Loss: 0.3355082 Test Loss: 0.4190307
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1928777
	speed: 0.3434s/iter; left time: 1507.1220s
	iters: 200, epoch: 3 | loss: 0.1696223
	speed: 0.0949s/iter; left time: 407.0016s
	iters: 300, epoch: 3 | loss: 0.1698836
	speed: 0.0946s/iter; left time: 396.2612s
	iters: 400, epoch: 3 | loss: 0.1794323
	speed: 0.0950s/iter; left time: 388.5580s
	iters: 500, epoch: 3 | loss: 0.1826764
	speed: 0.0948s/iter; left time: 378.0183s
Epoch: 3 cost time: 53.191951274871826
Epoch: 3, Steps: 561 | Train Loss: 0.1925132 Vali Loss: 0.2005089 Test Loss: 0.2403752
Validation loss decreased (0.233601 --> 0.200509).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1705614
	speed: 0.3499s/iter; left time: 1339.2472s
	iters: 200, epoch: 4 | loss: 0.1654881
	speed: 0.0946s/iter; left time: 352.7201s
	iters: 300, epoch: 4 | loss: 0.1861799
	speed: 0.0948s/iter; left time: 344.0019s
	iters: 400, epoch: 4 | loss: 0.1592776
	speed: 0.0950s/iter; left time: 334.9850s
	iters: 500, epoch: 4 | loss: 0.1629044
	speed: 0.0950s/iter; left time: 325.6003s
Epoch: 4 cost time: 53.38038206100464
Epoch: 4, Steps: 561 | Train Loss: 0.1717762 Vali Loss: 0.1966142 Test Loss: 0.2906063
Validation loss decreased (0.200509 --> 0.196614).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1927325
	speed: 0.3453s/iter; left time: 1128.1448s
	iters: 200, epoch: 5 | loss: 0.1690878
	speed: 0.0945s/iter; left time: 299.2834s
	iters: 300, epoch: 5 | loss: 0.1673053
	speed: 0.0948s/iter; left time: 290.6365s
	iters: 400, epoch: 5 | loss: 0.1694359
	speed: 0.0971s/iter; left time: 288.0053s
	iters: 500, epoch: 5 | loss: 0.1631128
	speed: 0.0970s/iter; left time: 278.0468s
Epoch: 5 cost time: 53.679930686950684
Epoch: 5, Steps: 561 | Train Loss: 0.1678019 Vali Loss: 0.1941812 Test Loss: 0.2345031
Validation loss decreased (0.196614 --> 0.194181).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1594998
	speed: 0.3469s/iter; left time: 938.6884s
	iters: 200, epoch: 6 | loss: 0.1646675
	speed: 0.0952s/iter; left time: 248.0323s
	iters: 300, epoch: 6 | loss: 0.1789519
	speed: 0.0950s/iter; left time: 238.0573s
	iters: 400, epoch: 6 | loss: 0.1641638
	speed: 0.0946s/iter; left time: 227.5362s
	iters: 500, epoch: 6 | loss: 0.1470288
	speed: 0.0952s/iter; left time: 219.6075s
Epoch: 6 cost time: 53.253121852874756
Epoch: 6, Steps: 561 | Train Loss: 0.1656139 Vali Loss: 0.1931514 Test Loss: 0.2308261
Validation loss decreased (0.194181 --> 0.193151).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1595793
	speed: 0.3487s/iter; left time: 747.9115s
	iters: 200, epoch: 7 | loss: 0.1781060
	speed: 0.0976s/iter; left time: 199.6120s
	iters: 300, epoch: 7 | loss: 0.1574582
	speed: 0.0973s/iter; left time: 189.1774s
	iters: 400, epoch: 7 | loss: 0.1692158
	speed: 0.0960s/iter; left time: 177.1552s
	iters: 500, epoch: 7 | loss: 0.1685192
	speed: 0.0948s/iter; left time: 165.5087s
Epoch: 7 cost time: 54.11727452278137
Epoch: 7, Steps: 561 | Train Loss: 0.1643247 Vali Loss: 0.1925256 Test Loss: 0.2341455
Validation loss decreased (0.193151 --> 0.192526).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1614958
	speed: 0.3463s/iter; left time: 548.5283s
	iters: 200, epoch: 8 | loss: 0.1632216
	speed: 0.0946s/iter; left time: 140.3174s
	iters: 300, epoch: 8 | loss: 0.1713390
	speed: 0.0948s/iter; left time: 131.1902s
	iters: 400, epoch: 8 | loss: 0.1783215
	speed: 0.0946s/iter; left time: 121.4417s
	iters: 500, epoch: 8 | loss: 0.1616101
	speed: 0.0946s/iter; left time: 111.9551s
Epoch: 8 cost time: 53.1593713760376
Epoch: 8, Steps: 561 | Train Loss: 0.1637101 Vali Loss: 0.1931610 Test Loss: 0.2368081
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1642987
	speed: 0.3468s/iter; left time: 354.8057s
	iters: 200, epoch: 9 | loss: 0.1508887
	speed: 0.0948s/iter; left time: 87.4741s
	iters: 300, epoch: 9 | loss: 0.1615337
	speed: 0.0946s/iter; left time: 77.8915s
	iters: 400, epoch: 9 | loss: 0.1620779
	speed: 0.0948s/iter; left time: 68.5565s
	iters: 500, epoch: 9 | loss: 0.1539280
	speed: 0.0948s/iter; left time: 59.0369s
Epoch: 9 cost time: 53.20335054397583
Epoch: 9, Steps: 561 | Train Loss: 0.1633602 Vali Loss: 0.1928323 Test Loss: 0.2387369
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1641551
	speed: 0.3427s/iter; left time: 158.3371s
	iters: 200, epoch: 10 | loss: 0.1538907
	speed: 0.0945s/iter; left time: 34.2267s
	iters: 300, epoch: 10 | loss: 0.1671531
	speed: 0.0961s/iter; left time: 25.1894s
	iters: 400, epoch: 10 | loss: 0.1686088
	speed: 0.0967s/iter; left time: 15.6732s
	iters: 500, epoch: 10 | loss: 0.1742448
	speed: 0.0980s/iter; left time: 6.0748s
Epoch: 10 cost time: 54.01713228225708
Epoch: 10, Steps: 561 | Train Loss: 0.1631432 Vali Loss: 0.1926517 Test Loss: 0.2399721
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : electricity_336_Autoformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed32598<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4925
mse:0.23403400182724, mae:0.34120941162109375
