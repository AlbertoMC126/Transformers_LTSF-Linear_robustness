Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=21, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=21, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Informer', model_id='weather_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=96, root_path='./dataset/', seed=28649, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_96_Informer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed28649>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36696
val 5175
test 10444
	iters: 100, epoch: 1 | loss: 0.2941165
	speed: 0.0613s/iter; left time: 695.9845s
	iters: 200, epoch: 1 | loss: 0.9210654
	speed: 0.0295s/iter; left time: 332.6902s
	iters: 300, epoch: 1 | loss: 0.2450248
	speed: 0.0294s/iter; left time: 328.5744s
	iters: 400, epoch: 1 | loss: 0.2446318
	speed: 0.0293s/iter; left time: 324.4146s
	iters: 500, epoch: 1 | loss: 1.3793364
	speed: 0.0296s/iter; left time: 324.3495s
	iters: 600, epoch: 1 | loss: 2.2075844
	speed: 0.0294s/iter; left time: 319.6608s
	iters: 700, epoch: 1 | loss: 0.3165953
	speed: 0.0292s/iter; left time: 313.7122s
	iters: 800, epoch: 1 | loss: 0.1983778
	speed: 0.0295s/iter; left time: 314.6947s
	iters: 900, epoch: 1 | loss: 1.1441176
	speed: 0.0296s/iter; left time: 312.3025s
	iters: 1000, epoch: 1 | loss: 0.2991399
	speed: 0.0280s/iter; left time: 292.7678s
	iters: 1100, epoch: 1 | loss: 0.3008017
	speed: 0.0276s/iter; left time: 286.4437s
Epoch: 1 cost time: 36.538899421691895
Epoch: 1, Steps: 1146 | Train Loss: 0.3997167 Vali Loss: 0.5121502 Test Loss: 0.4791036
Validation loss decreased (inf --> 0.512150).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2836078
	speed: 0.0902s/iter; left time: 921.7583s
	iters: 200, epoch: 2 | loss: 0.2468009
	speed: 0.0280s/iter; left time: 282.7237s
	iters: 300, epoch: 2 | loss: 0.3858390
	speed: 0.0276s/iter; left time: 276.1287s
	iters: 400, epoch: 2 | loss: 0.2076107
	speed: 0.0275s/iter; left time: 273.1330s
	iters: 500, epoch: 2 | loss: 0.2364655
	speed: 0.0276s/iter; left time: 271.3292s
	iters: 600, epoch: 2 | loss: 0.1527523
	speed: 0.0275s/iter; left time: 266.9502s
	iters: 700, epoch: 2 | loss: 0.3982379
	speed: 0.0278s/iter; left time: 267.4224s
	iters: 800, epoch: 2 | loss: 0.1839307
	speed: 0.0277s/iter; left time: 263.3821s
	iters: 900, epoch: 2 | loss: 0.1601019
	speed: 0.0275s/iter; left time: 259.2691s
	iters: 1000, epoch: 2 | loss: 0.2524236
	speed: 0.0274s/iter; left time: 255.2156s
	iters: 1100, epoch: 2 | loss: 0.2237149
	speed: 0.0275s/iter; left time: 252.9727s
Epoch: 2 cost time: 31.676412105560303
Epoch: 2, Steps: 1146 | Train Loss: 0.3230207 Vali Loss: 0.4980327 Test Loss: 0.4039534
Validation loss decreased (0.512150 --> 0.498033).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2854304
	speed: 0.0894s/iter; left time: 810.8654s
	iters: 200, epoch: 3 | loss: 0.1469946
	speed: 0.0275s/iter; left time: 246.8929s
	iters: 300, epoch: 3 | loss: 0.1955812
	speed: 0.0277s/iter; left time: 245.7475s
	iters: 400, epoch: 3 | loss: 0.1710052
	speed: 0.0279s/iter; left time: 245.0670s
	iters: 500, epoch: 3 | loss: 0.3862151
	speed: 0.0277s/iter; left time: 240.3790s
	iters: 600, epoch: 3 | loss: 0.1771995
	speed: 0.0278s/iter; left time: 237.8369s
	iters: 700, epoch: 3 | loss: 0.1835954
	speed: 0.0275s/iter; left time: 233.2786s
	iters: 800, epoch: 3 | loss: 0.1113419
	speed: 0.0275s/iter; left time: 229.7789s
	iters: 900, epoch: 3 | loss: 0.2463243
	speed: 0.0275s/iter; left time: 227.1219s
	iters: 1000, epoch: 3 | loss: 0.1215420
	speed: 0.0276s/iter; left time: 225.0918s
	iters: 1100, epoch: 3 | loss: 0.1674387
	speed: 0.0276s/iter; left time: 223.0761s
Epoch: 3 cost time: 31.66969394683838
Epoch: 3, Steps: 1146 | Train Loss: 0.2662088 Vali Loss: 0.5136390 Test Loss: 0.4533011
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2392374
	speed: 0.0862s/iter; left time: 683.0269s
	iters: 200, epoch: 4 | loss: 0.2149718
	speed: 0.0276s/iter; left time: 215.9037s
	iters: 300, epoch: 4 | loss: 0.1590021
	speed: 0.0281s/iter; left time: 217.2803s
	iters: 400, epoch: 4 | loss: 0.2525462
	speed: 0.0285s/iter; left time: 217.3661s
	iters: 500, epoch: 4 | loss: 0.1862054
	speed: 0.0284s/iter; left time: 213.3724s
	iters: 600, epoch: 4 | loss: 0.2008825
	speed: 0.0288s/iter; left time: 213.7943s
	iters: 700, epoch: 4 | loss: 0.2056431
	speed: 0.0288s/iter; left time: 211.1438s
	iters: 800, epoch: 4 | loss: 0.2104306
	speed: 0.0285s/iter; left time: 206.1066s
	iters: 900, epoch: 4 | loss: 0.2487138
	speed: 0.0287s/iter; left time: 204.3840s
	iters: 1000, epoch: 4 | loss: 0.1954627
	speed: 0.0289s/iter; left time: 203.1908s
	iters: 1100, epoch: 4 | loss: 0.2972036
	speed: 0.0290s/iter; left time: 200.9224s
Epoch: 4 cost time: 32.655168533325195
Epoch: 4, Steps: 1146 | Train Loss: 0.2404626 Vali Loss: 0.4977608 Test Loss: 0.4567508
Validation loss decreased (0.498033 --> 0.497761).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1620166
	speed: 0.0900s/iter; left time: 609.7999s
	iters: 200, epoch: 5 | loss: 0.8934115
	speed: 0.0276s/iter; left time: 184.3311s
	iters: 300, epoch: 5 | loss: 0.1879710
	speed: 0.0275s/iter; left time: 180.9994s
	iters: 400, epoch: 5 | loss: 0.2195969
	speed: 0.0277s/iter; left time: 179.4240s
	iters: 500, epoch: 5 | loss: 0.1430557
	speed: 0.0280s/iter; left time: 178.3213s
	iters: 600, epoch: 5 | loss: 0.1701739
	speed: 0.0278s/iter; left time: 174.7574s
	iters: 700, epoch: 5 | loss: 0.1812923
	speed: 0.0281s/iter; left time: 173.6564s
	iters: 800, epoch: 5 | loss: 0.1234594
	speed: 0.0283s/iter; left time: 172.0611s
	iters: 900, epoch: 5 | loss: 0.2350509
	speed: 0.0277s/iter; left time: 165.7186s
	iters: 1000, epoch: 5 | loss: 0.1440765
	speed: 0.0275s/iter; left time: 161.6836s
	iters: 1100, epoch: 5 | loss: 0.1492870
	speed: 0.0275s/iter; left time: 159.1394s
Epoch: 5 cost time: 31.824764728546143
Epoch: 5, Steps: 1146 | Train Loss: 0.2283332 Vali Loss: 0.5048171 Test Loss: 0.4479731
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1388858
	speed: 0.0862s/iter; left time: 485.1911s
	iters: 200, epoch: 6 | loss: 0.1340893
	speed: 0.0276s/iter; left time: 152.8099s
	iters: 300, epoch: 6 | loss: 0.1907312
	speed: 0.0277s/iter; left time: 150.2204s
	iters: 400, epoch: 6 | loss: 0.1772141
	speed: 0.0276s/iter; left time: 147.3374s
	iters: 500, epoch: 6 | loss: 0.1082755
	speed: 0.0277s/iter; left time: 144.8338s
	iters: 600, epoch: 6 | loss: 0.1776347
	speed: 0.0277s/iter; left time: 142.1174s
	iters: 700, epoch: 6 | loss: 0.1636308
	speed: 0.0279s/iter; left time: 140.3505s
	iters: 800, epoch: 6 | loss: 0.1578707
	speed: 0.0275s/iter; left time: 135.7904s
	iters: 900, epoch: 6 | loss: 0.2188649
	speed: 0.0274s/iter; left time: 132.4338s
	iters: 1000, epoch: 6 | loss: 0.1644508
	speed: 0.0274s/iter; left time: 129.6910s
	iters: 1100, epoch: 6 | loss: 0.1388621
	speed: 0.0274s/iter; left time: 126.7616s
Epoch: 6 cost time: 31.648024320602417
Epoch: 6, Steps: 1146 | Train Loss: 0.2222223 Vali Loss: 0.5016323 Test Loss: 0.4524435
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2494724
	speed: 0.0856s/iter; left time: 383.8493s
	iters: 200, epoch: 7 | loss: 0.1986063
	speed: 0.0274s/iter; left time: 120.0564s
	iters: 300, epoch: 7 | loss: 0.2163462
	speed: 0.0274s/iter; left time: 117.2798s
	iters: 400, epoch: 7 | loss: 0.1548321
	speed: 0.0274s/iter; left time: 114.7473s
	iters: 500, epoch: 7 | loss: 0.7887711
	speed: 0.0274s/iter; left time: 111.8160s
	iters: 600, epoch: 7 | loss: 0.1474679
	speed: 0.0276s/iter; left time: 110.0580s
	iters: 700, epoch: 7 | loss: 0.1788067
	speed: 0.0284s/iter; left time: 110.2389s
	iters: 800, epoch: 7 | loss: 0.1517903
	speed: 0.0289s/iter; left time: 109.4384s
	iters: 900, epoch: 7 | loss: 0.1966027
	speed: 0.0286s/iter; left time: 105.2489s
	iters: 1000, epoch: 7 | loss: 0.1170556
	speed: 0.0287s/iter; left time: 102.9332s
	iters: 1100, epoch: 7 | loss: 0.1641613
	speed: 0.0290s/iter; left time: 100.9008s
Epoch: 7 cost time: 32.12881827354431
Epoch: 7, Steps: 1146 | Train Loss: 0.2192600 Vali Loss: 0.5002682 Test Loss: 0.4545212
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : weather_96_Informer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed28649<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
mse:0.4562061131000519, mae:0.48431676626205444
