Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Transformer', model_id='ETTm2_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=96, root_path='./dataset/', seed=10458, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm2_96_Transformer_ETTm2_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed10458>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34369
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.2608737
	speed: 0.0548s/iter; left time: 582.9757s
	iters: 200, epoch: 1 | loss: 0.1874753
	speed: 0.0249s/iter; left time: 262.2555s
	iters: 300, epoch: 1 | loss: 0.2502757
	speed: 0.0248s/iter; left time: 258.4583s
	iters: 400, epoch: 1 | loss: 0.2284924
	speed: 0.0247s/iter; left time: 255.8388s
	iters: 500, epoch: 1 | loss: 0.1318519
	speed: 0.0248s/iter; left time: 253.5594s
	iters: 600, epoch: 1 | loss: 0.1324395
	speed: 0.0248s/iter; left time: 251.4801s
	iters: 700, epoch: 1 | loss: 0.1495230
	speed: 0.0248s/iter; left time: 249.0378s
	iters: 800, epoch: 1 | loss: 0.1455967
	speed: 0.0248s/iter; left time: 246.2995s
	iters: 900, epoch: 1 | loss: 0.1561921
	speed: 0.0248s/iter; left time: 244.5466s
	iters: 1000, epoch: 1 | loss: 0.1173999
	speed: 0.0249s/iter; left time: 242.2746s
Epoch: 1 cost time: 29.6512668132782
Epoch: 1, Steps: 1074 | Train Loss: 0.1789311 Vali Loss: 0.3453321 Test Loss: 0.4594779
Validation loss decreased (inf --> 0.345332).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1066879
	speed: 0.1009s/iter; left time: 965.7475s
	iters: 200, epoch: 2 | loss: 0.0909436
	speed: 0.0248s/iter; left time: 234.7644s
	iters: 300, epoch: 2 | loss: 0.1374799
	speed: 0.0248s/iter; left time: 232.0570s
	iters: 400, epoch: 2 | loss: 0.1219542
	speed: 0.0247s/iter; left time: 229.0404s
	iters: 500, epoch: 2 | loss: 0.1133700
	speed: 0.0247s/iter; left time: 226.5396s
	iters: 600, epoch: 2 | loss: 0.1224327
	speed: 0.0247s/iter; left time: 223.9389s
	iters: 700, epoch: 2 | loss: 0.1118294
	speed: 0.0247s/iter; left time: 221.5382s
	iters: 800, epoch: 2 | loss: 0.1039072
	speed: 0.0247s/iter; left time: 218.9719s
	iters: 900, epoch: 2 | loss: 0.0963568
	speed: 0.0247s/iter; left time: 216.3297s
	iters: 1000, epoch: 2 | loss: 0.1235092
	speed: 0.0247s/iter; left time: 214.1495s
Epoch: 2 cost time: 26.54986023902893
Epoch: 2, Steps: 1074 | Train Loss: 0.1092443 Vali Loss: 0.3494484 Test Loss: 0.6548198
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.0810555
	speed: 0.0982s/iter; left time: 834.0599s
	iters: 200, epoch: 3 | loss: 0.0664697
	speed: 0.0247s/iter; left time: 207.2908s
	iters: 300, epoch: 3 | loss: 0.0740207
	speed: 0.0247s/iter; left time: 204.6375s
	iters: 400, epoch: 3 | loss: 0.0695853
	speed: 0.0247s/iter; left time: 202.2677s
	iters: 500, epoch: 3 | loss: 0.0690516
	speed: 0.0247s/iter; left time: 200.1080s
	iters: 600, epoch: 3 | loss: 0.0565971
	speed: 0.0248s/iter; left time: 198.4476s
	iters: 700, epoch: 3 | loss: 0.1242369
	speed: 0.0248s/iter; left time: 195.9689s
	iters: 800, epoch: 3 | loss: 0.0747570
	speed: 0.0248s/iter; left time: 193.2556s
	iters: 900, epoch: 3 | loss: 0.0670868
	speed: 0.0249s/iter; left time: 191.2542s
	iters: 1000, epoch: 3 | loss: 0.0590838
	speed: 0.0248s/iter; left time: 188.4913s
Epoch: 3 cost time: 26.588464736938477
Epoch: 3, Steps: 1074 | Train Loss: 0.0741519 Vali Loss: 0.3541792 Test Loss: 0.6006183
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0990585
	speed: 0.0986s/iter; left time: 731.2885s
	iters: 200, epoch: 4 | loss: 0.0579752
	speed: 0.0249s/iter; left time: 181.9305s
	iters: 300, epoch: 4 | loss: 0.0653860
	speed: 0.0249s/iter; left time: 179.5218s
	iters: 400, epoch: 4 | loss: 0.0640258
	speed: 0.0249s/iter; left time: 177.2966s
	iters: 500, epoch: 4 | loss: 0.0641290
	speed: 0.0248s/iter; left time: 174.3787s
	iters: 600, epoch: 4 | loss: 0.0577940
	speed: 0.0249s/iter; left time: 171.9891s
	iters: 700, epoch: 4 | loss: 0.0860899
	speed: 0.0248s/iter; left time: 169.3800s
	iters: 800, epoch: 4 | loss: 0.0578099
	speed: 0.0249s/iter; left time: 167.0244s
	iters: 900, epoch: 4 | loss: 0.0619817
	speed: 0.0249s/iter; left time: 164.5397s
	iters: 1000, epoch: 4 | loss: 0.0641075
	speed: 0.0248s/iter; left time: 161.9022s
Epoch: 4 cost time: 26.687354803085327
Epoch: 4, Steps: 1074 | Train Loss: 0.0622276 Vali Loss: 0.3218729 Test Loss: 0.6186050
Validation loss decreased (0.345332 --> 0.321873).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0622537
	speed: 0.1009s/iter; left time: 640.0927s
	iters: 200, epoch: 5 | loss: 0.0600061
	speed: 0.0247s/iter; left time: 154.0244s
	iters: 300, epoch: 5 | loss: 0.0561455
	speed: 0.0247s/iter; left time: 151.5784s
	iters: 400, epoch: 5 | loss: 0.0491112
	speed: 0.0247s/iter; left time: 149.1635s
	iters: 500, epoch: 5 | loss: 0.0653094
	speed: 0.0246s/iter; left time: 146.4895s
	iters: 600, epoch: 5 | loss: 0.0543925
	speed: 0.0247s/iter; left time: 144.1703s
	iters: 700, epoch: 5 | loss: 0.0502258
	speed: 0.0247s/iter; left time: 141.6209s
	iters: 800, epoch: 5 | loss: 0.0718448
	speed: 0.0247s/iter; left time: 139.2550s
	iters: 900, epoch: 5 | loss: 0.0573976
	speed: 0.0248s/iter; left time: 137.4492s
	iters: 1000, epoch: 5 | loss: 0.0568485
	speed: 0.0248s/iter; left time: 134.9266s
Epoch: 5 cost time: 26.51093101501465
Epoch: 5, Steps: 1074 | Train Loss: 0.0568654 Vali Loss: 0.3205024 Test Loss: 0.6008658
Validation loss decreased (0.321873 --> 0.320502).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0656853
	speed: 0.1004s/iter; left time: 528.9665s
	iters: 200, epoch: 6 | loss: 0.0504732
	speed: 0.0247s/iter; left time: 127.8931s
	iters: 300, epoch: 6 | loss: 0.0633570
	speed: 0.0248s/iter; left time: 125.7430s
	iters: 400, epoch: 6 | loss: 0.0550956
	speed: 0.0248s/iter; left time: 123.1817s
	iters: 500, epoch: 6 | loss: 0.0552465
	speed: 0.0248s/iter; left time: 120.8445s
	iters: 600, epoch: 6 | loss: 0.0622598
	speed: 0.0248s/iter; left time: 118.2890s
	iters: 700, epoch: 6 | loss: 0.0602682
	speed: 0.0248s/iter; left time: 115.7961s
	iters: 800, epoch: 6 | loss: 0.0446009
	speed: 0.0248s/iter; left time: 113.3578s
	iters: 900, epoch: 6 | loss: 0.0545223
	speed: 0.0248s/iter; left time: 110.8708s
	iters: 1000, epoch: 6 | loss: 0.0548028
	speed: 0.0248s/iter; left time: 108.4016s
Epoch: 6 cost time: 26.600242137908936
Epoch: 6, Steps: 1074 | Train Loss: 0.0542859 Vali Loss: 0.3180493 Test Loss: 0.5924324
Validation loss decreased (0.320502 --> 0.318049).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.0516491
	speed: 0.1000s/iter; left time: 419.5843s
	iters: 200, epoch: 7 | loss: 0.0504216
	speed: 0.0249s/iter; left time: 102.0077s
	iters: 300, epoch: 7 | loss: 0.0496965
	speed: 0.0248s/iter; left time: 99.2672s
	iters: 400, epoch: 7 | loss: 0.0559108
	speed: 0.0248s/iter; left time: 96.5524s
	iters: 500, epoch: 7 | loss: 0.0567789
	speed: 0.0248s/iter; left time: 94.1670s
	iters: 600, epoch: 7 | loss: 0.0576204
	speed: 0.0249s/iter; left time: 91.9641s
	iters: 700, epoch: 7 | loss: 0.0528320
	speed: 0.0248s/iter; left time: 89.3392s
	iters: 800, epoch: 7 | loss: 0.0635547
	speed: 0.0248s/iter; left time: 86.7479s
	iters: 900, epoch: 7 | loss: 0.0475369
	speed: 0.0248s/iter; left time: 84.2292s
	iters: 1000, epoch: 7 | loss: 0.0546570
	speed: 0.0248s/iter; left time: 81.8929s
Epoch: 7 cost time: 26.65784764289856
Epoch: 7, Steps: 1074 | Train Loss: 0.0530095 Vali Loss: 0.3190508 Test Loss: 0.5974362
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.0571242
	speed: 0.0986s/iter; left time: 308.0423s
	iters: 200, epoch: 8 | loss: 0.0525076
	speed: 0.0247s/iter; left time: 74.7572s
	iters: 300, epoch: 8 | loss: 0.0476063
	speed: 0.0247s/iter; left time: 72.2823s
	iters: 400, epoch: 8 | loss: 0.0510852
	speed: 0.0247s/iter; left time: 69.8148s
	iters: 500, epoch: 8 | loss: 0.0572539
	speed: 0.0247s/iter; left time: 67.2793s
	iters: 600, epoch: 8 | loss: 0.0487286
	speed: 0.0247s/iter; left time: 64.8225s
	iters: 700, epoch: 8 | loss: 0.0532522
	speed: 0.0247s/iter; left time: 62.3120s
	iters: 800, epoch: 8 | loss: 0.0542333
	speed: 0.0247s/iter; left time: 59.9556s
	iters: 900, epoch: 8 | loss: 0.0502982
	speed: 0.0247s/iter; left time: 57.4534s
	iters: 1000, epoch: 8 | loss: 0.0504177
	speed: 0.0247s/iter; left time: 54.9789s
Epoch: 8 cost time: 26.545891523361206
Epoch: 8, Steps: 1074 | Train Loss: 0.0523764 Vali Loss: 0.3174511 Test Loss: 0.6109830
Validation loss decreased (0.318049 --> 0.317451).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.0464812
	speed: 0.1012s/iter; left time: 207.4464s
	iters: 200, epoch: 9 | loss: 0.0450317
	speed: 0.0248s/iter; left time: 48.3801s
	iters: 300, epoch: 9 | loss: 0.0480113
	speed: 0.0248s/iter; left time: 45.8141s
	iters: 400, epoch: 9 | loss: 0.0571109
	speed: 0.0248s/iter; left time: 43.3708s
	iters: 500, epoch: 9 | loss: 0.0544346
	speed: 0.0248s/iter; left time: 40.8269s
	iters: 600, epoch: 9 | loss: 0.0556035
	speed: 0.0248s/iter; left time: 38.4298s
	iters: 700, epoch: 9 | loss: 0.0478201
	speed: 0.0249s/iter; left time: 36.0114s
	iters: 800, epoch: 9 | loss: 0.0552598
	speed: 0.0248s/iter; left time: 33.4133s
	iters: 900, epoch: 9 | loss: 0.0588146
	speed: 0.0248s/iter; left time: 30.9596s
	iters: 1000, epoch: 9 | loss: 0.0509041
	speed: 0.0248s/iter; left time: 28.4603s
Epoch: 9 cost time: 26.625871419906616
Epoch: 9, Steps: 1074 | Train Loss: 0.0520545 Vali Loss: 0.3188616 Test Loss: 0.6109900
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.0511081
	speed: 0.0983s/iter; left time: 95.7979s
	iters: 200, epoch: 10 | loss: 0.0552080
	speed: 0.0247s/iter; left time: 21.6549s
	iters: 300, epoch: 10 | loss: 0.0533956
	speed: 0.0248s/iter; left time: 19.2181s
	iters: 400, epoch: 10 | loss: 0.0490622
	speed: 0.0248s/iter; left time: 16.7316s
	iters: 500, epoch: 10 | loss: 0.0444032
	speed: 0.0248s/iter; left time: 14.2584s
	iters: 600, epoch: 10 | loss: 0.0499035
	speed: 0.0247s/iter; left time: 11.7512s
	iters: 700, epoch: 10 | loss: 0.0515843
	speed: 0.0247s/iter; left time: 9.2729s
	iters: 800, epoch: 10 | loss: 0.0531862
	speed: 0.0248s/iter; left time: 6.8086s
	iters: 900, epoch: 10 | loss: 0.0567431
	speed: 0.0248s/iter; left time: 4.3380s
	iters: 1000, epoch: 10 | loss: 0.0497880
	speed: 0.0248s/iter; left time: 1.8570s
Epoch: 10 cost time: 26.599227905273438
Epoch: 10, Steps: 1074 | Train Loss: 0.0518606 Vali Loss: 0.3176651 Test Loss: 0.6077208
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : ETTm2_96_Transformer_ETTm2_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed10458<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.6121447682380676, mae:0.574273943901062
