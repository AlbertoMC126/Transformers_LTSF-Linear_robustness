Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=21, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=21, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Autoformer', model_id='weather_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=336, root_path='./dataset/', seed=32598, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_336_Autoformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed32598>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36456
val 4935
test 10204
	iters: 100, epoch: 1 | loss: 0.7639422
	speed: 0.1174s/iter; left time: 1325.0765s
	iters: 200, epoch: 1 | loss: 0.8994008
	speed: 0.0830s/iter; left time: 929.3875s
	iters: 300, epoch: 1 | loss: 0.5566064
	speed: 0.0832s/iter; left time: 922.2907s
	iters: 400, epoch: 1 | loss: 0.6110471
	speed: 0.0832s/iter; left time: 914.4428s
	iters: 500, epoch: 1 | loss: 0.6112832
	speed: 0.0834s/iter; left time: 907.8491s
	iters: 600, epoch: 1 | loss: 0.6509764
	speed: 0.0835s/iter; left time: 900.9933s
	iters: 700, epoch: 1 | loss: 0.6249921
	speed: 0.0835s/iter; left time: 892.5603s
	iters: 800, epoch: 1 | loss: 0.9028839
	speed: 0.0834s/iter; left time: 883.7337s
	iters: 900, epoch: 1 | loss: 0.9427915
	speed: 0.0833s/iter; left time: 874.2161s
	iters: 1000, epoch: 1 | loss: 0.8422049
	speed: 0.0834s/iter; left time: 866.5384s
	iters: 1100, epoch: 1 | loss: 0.6068316
	speed: 0.0833s/iter; left time: 857.0054s
Epoch: 1 cost time: 98.35224747657776
Epoch: 1, Steps: 1139 | Train Loss: 0.6987625 Vali Loss: 0.7163153 Test Loss: 0.3459878
Validation loss decreased (inf --> 0.716315).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5331392
	speed: 0.3919s/iter; left time: 3978.2967s
	iters: 200, epoch: 2 | loss: 0.5181379
	speed: 0.0837s/iter; left time: 841.3904s
	iters: 300, epoch: 2 | loss: 0.5125329
	speed: 0.0837s/iter; left time: 832.8392s
	iters: 400, epoch: 2 | loss: 0.5785178
	speed: 0.0838s/iter; left time: 825.3885s
	iters: 500, epoch: 2 | loss: 0.7667919
	speed: 0.0836s/iter; left time: 815.0882s
	iters: 600, epoch: 2 | loss: 0.6167642
	speed: 0.0836s/iter; left time: 806.8033s
	iters: 700, epoch: 2 | loss: 0.5939342
	speed: 0.0836s/iter; left time: 798.8435s
	iters: 800, epoch: 2 | loss: 0.8173819
	speed: 0.0836s/iter; left time: 790.1979s
	iters: 900, epoch: 2 | loss: 0.7832178
	speed: 0.0834s/iter; left time: 780.1112s
	iters: 1000, epoch: 2 | loss: 0.8099310
	speed: 0.0834s/iter; left time: 771.8450s
	iters: 1100, epoch: 2 | loss: 0.6650795
	speed: 0.0834s/iter; left time: 763.5872s
Epoch: 2 cost time: 95.20060992240906
Epoch: 2, Steps: 1139 | Train Loss: 0.6530434 Vali Loss: 0.7161080 Test Loss: 0.3624135
Validation loss decreased (0.716315 --> 0.716108).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5783800
	speed: 0.3907s/iter; left time: 3521.4104s
	iters: 200, epoch: 3 | loss: 0.5520962
	speed: 0.0834s/iter; left time: 743.4043s
	iters: 300, epoch: 3 | loss: 0.5941381
	speed: 0.0834s/iter; left time: 735.2553s
	iters: 400, epoch: 3 | loss: 0.5299831
	speed: 0.0835s/iter; left time: 727.5219s
	iters: 500, epoch: 3 | loss: 0.7814816
	speed: 0.0837s/iter; left time: 720.6368s
	iters: 600, epoch: 3 | loss: 0.5718657
	speed: 0.0834s/iter; left time: 709.7202s
	iters: 700, epoch: 3 | loss: 0.8692788
	speed: 0.0836s/iter; left time: 703.2303s
	iters: 800, epoch: 3 | loss: 1.4900234
	speed: 0.0832s/iter; left time: 691.6410s
	iters: 900, epoch: 3 | loss: 0.6109577
	speed: 0.0832s/iter; left time: 682.9523s
	iters: 1000, epoch: 3 | loss: 0.7822933
	speed: 0.0831s/iter; left time: 674.2964s
	iters: 1100, epoch: 3 | loss: 0.8031597
	speed: 0.0832s/iter; left time: 666.4294s
Epoch: 3 cost time: 94.93525671958923
Epoch: 3, Steps: 1139 | Train Loss: 0.6381656 Vali Loss: 0.7180100 Test Loss: 0.3632039
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.6185719
	speed: 0.3886s/iter; left time: 3059.8060s
	iters: 200, epoch: 4 | loss: 0.6338057
	speed: 0.0831s/iter; left time: 646.3670s
	iters: 300, epoch: 4 | loss: 0.4605991
	speed: 0.0832s/iter; left time: 638.1176s
	iters: 400, epoch: 4 | loss: 0.4588252
	speed: 0.0834s/iter; left time: 631.9401s
	iters: 500, epoch: 4 | loss: 0.5594862
	speed: 0.0834s/iter; left time: 623.5684s
	iters: 600, epoch: 4 | loss: 0.8625750
	speed: 0.0832s/iter; left time: 613.7776s
	iters: 700, epoch: 4 | loss: 0.5492898
	speed: 0.0832s/iter; left time: 605.2845s
	iters: 800, epoch: 4 | loss: 0.7551966
	speed: 0.0833s/iter; left time: 597.7515s
	iters: 900, epoch: 4 | loss: 0.5967141
	speed: 0.0833s/iter; left time: 589.2366s
	iters: 1000, epoch: 4 | loss: 0.5464386
	speed: 0.0834s/iter; left time: 581.2986s
	iters: 1100, epoch: 4 | loss: 0.5865238
	speed: 0.0834s/iter; left time: 573.3438s
Epoch: 4 cost time: 94.86041116714478
Epoch: 4, Steps: 1139 | Train Loss: 0.6273101 Vali Loss: 0.7162895 Test Loss: 0.3623203
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.7059216
	speed: 0.3899s/iter; left time: 2625.8744s
	iters: 200, epoch: 5 | loss: 0.4798158
	speed: 0.0837s/iter; left time: 555.6659s
	iters: 300, epoch: 5 | loss: 0.4514894
	speed: 0.0837s/iter; left time: 547.2452s
	iters: 400, epoch: 5 | loss: 0.5726786
	speed: 0.0836s/iter; left time: 538.2798s
	iters: 500, epoch: 5 | loss: 0.8853094
	speed: 0.0837s/iter; left time: 530.4983s
	iters: 600, epoch: 5 | loss: 0.6075244
	speed: 0.0836s/iter; left time: 521.1012s
	iters: 700, epoch: 5 | loss: 0.7544429
	speed: 0.0835s/iter; left time: 512.2766s
	iters: 800, epoch: 5 | loss: 0.6894638
	speed: 0.0834s/iter; left time: 503.2025s
	iters: 900, epoch: 5 | loss: 0.8007568
	speed: 0.0834s/iter; left time: 494.9900s
	iters: 1000, epoch: 5 | loss: 0.5562384
	speed: 0.0835s/iter; left time: 487.3079s
	iters: 1100, epoch: 5 | loss: 0.7722139
	speed: 0.0833s/iter; left time: 477.8373s
Epoch: 5 cost time: 95.16898488998413
Epoch: 5, Steps: 1139 | Train Loss: 0.6222838 Vali Loss: 0.7118145 Test Loss: 0.3624128
Validation loss decreased (0.716108 --> 0.711814).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.8821462
	speed: 0.3917s/iter; left time: 2191.7739s
	iters: 200, epoch: 6 | loss: 0.9710968
	speed: 0.0834s/iter; left time: 458.1248s
	iters: 300, epoch: 6 | loss: 0.5659600
	speed: 0.0835s/iter; left time: 450.3063s
	iters: 400, epoch: 6 | loss: 0.6226293
	speed: 0.0837s/iter; left time: 443.3691s
	iters: 500, epoch: 6 | loss: 0.5179963
	speed: 0.0835s/iter; left time: 433.6077s
	iters: 600, epoch: 6 | loss: 0.5421377
	speed: 0.0836s/iter; left time: 426.2168s
	iters: 700, epoch: 6 | loss: 0.7618853
	speed: 0.0833s/iter; left time: 416.3462s
	iters: 800, epoch: 6 | loss: 0.5264255
	speed: 0.0831s/iter; left time: 407.0129s
	iters: 900, epoch: 6 | loss: 0.6863795
	speed: 0.0832s/iter; left time: 399.1154s
	iters: 1000, epoch: 6 | loss: 0.5636495
	speed: 0.0833s/iter; left time: 391.1037s
	iters: 1100, epoch: 6 | loss: 0.4979821
	speed: 0.0831s/iter; left time: 382.1255s
Epoch: 6 cost time: 94.96106505393982
Epoch: 6, Steps: 1139 | Train Loss: 0.6193132 Vali Loss: 0.7128335 Test Loss: 0.3628131
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.5893098
	speed: 0.3886s/iter; left time: 1731.8528s
	iters: 200, epoch: 7 | loss: 0.7073066
	speed: 0.0833s/iter; left time: 362.7493s
	iters: 300, epoch: 7 | loss: 0.4491085
	speed: 0.0832s/iter; left time: 354.3178s
	iters: 400, epoch: 7 | loss: 0.6317121
	speed: 0.0834s/iter; left time: 346.8326s
	iters: 500, epoch: 7 | loss: 0.4508025
	speed: 0.0833s/iter; left time: 337.8850s
	iters: 600, epoch: 7 | loss: 0.5239308
	speed: 0.0834s/iter; left time: 330.1033s
	iters: 700, epoch: 7 | loss: 0.5566899
	speed: 0.0834s/iter; left time: 321.5145s
	iters: 800, epoch: 7 | loss: 0.6655708
	speed: 0.0833s/iter; left time: 312.9043s
	iters: 900, epoch: 7 | loss: 0.7619989
	speed: 0.0833s/iter; left time: 304.5988s
	iters: 1000, epoch: 7 | loss: 0.8881770
	speed: 0.0833s/iter; left time: 296.2518s
	iters: 1100, epoch: 7 | loss: 0.6827474
	speed: 0.0834s/iter; left time: 288.2396s
Epoch: 7 cost time: 94.88373565673828
Epoch: 7, Steps: 1139 | Train Loss: 0.6181519 Vali Loss: 0.7136055 Test Loss: 0.3632067
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.7643038
	speed: 0.3892s/iter; left time: 1291.3132s
	iters: 200, epoch: 8 | loss: 0.4858176
	speed: 0.0835s/iter; left time: 268.8516s
	iters: 300, epoch: 8 | loss: 0.5634559
	speed: 0.0836s/iter; left time: 260.6715s
	iters: 400, epoch: 8 | loss: 0.4306126
	speed: 0.0835s/iter; left time: 251.9219s
	iters: 500, epoch: 8 | loss: 0.5758427
	speed: 0.0835s/iter; left time: 243.6003s
	iters: 600, epoch: 8 | loss: 0.5957082
	speed: 0.0835s/iter; left time: 235.3753s
	iters: 700, epoch: 8 | loss: 0.7683818
	speed: 0.0834s/iter; left time: 226.7397s
	iters: 800, epoch: 8 | loss: 0.5474390
	speed: 0.0834s/iter; left time: 218.3779s
	iters: 900, epoch: 8 | loss: 0.4933646
	speed: 0.0833s/iter; left time: 209.7396s
	iters: 1000, epoch: 8 | loss: 0.9199769
	speed: 0.0833s/iter; left time: 201.5006s
	iters: 1100, epoch: 8 | loss: 0.8278813
	speed: 0.0832s/iter; left time: 192.9051s
Epoch: 8 cost time: 95.01707553863525
Epoch: 8, Steps: 1139 | Train Loss: 0.6165356 Vali Loss: 0.7139800 Test Loss: 0.3635267
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : weather_336_Autoformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed32598<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10204
mse:0.362419068813324, mae:0.39568832516670227
