Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm1', data_path='ETTm1.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Autoformer', model_id='ETTm1_192', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=192, root_path='./dataset/', seed=10458, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm1_192_Autoformer_ETTm1_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed10458>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34273
val 11329
test 11329
	iters: 100, epoch: 1 | loss: 0.4162762
	speed: 0.0966s/iter; left time: 1024.7376s
	iters: 200, epoch: 1 | loss: 0.4803122
	speed: 0.0619s/iter; left time: 650.2067s
	iters: 300, epoch: 1 | loss: 0.5647907
	speed: 0.0616s/iter; left time: 641.0498s
	iters: 400, epoch: 1 | loss: 0.3509413
	speed: 0.0618s/iter; left time: 637.1270s
	iters: 500, epoch: 1 | loss: 0.4245928
	speed: 0.0617s/iter; left time: 630.2571s
	iters: 600, epoch: 1 | loss: 0.3920682
	speed: 0.0618s/iter; left time: 624.4695s
	iters: 700, epoch: 1 | loss: 0.3638055
	speed: 0.0618s/iter; left time: 618.8791s
	iters: 800, epoch: 1 | loss: 0.3046380
	speed: 0.0619s/iter; left time: 613.8587s
	iters: 900, epoch: 1 | loss: 0.4690776
	speed: 0.0620s/iter; left time: 608.2079s
	iters: 1000, epoch: 1 | loss: 0.3841441
	speed: 0.0617s/iter; left time: 599.5394s
Epoch: 1 cost time: 69.69200277328491
Epoch: 1, Steps: 1071 | Train Loss: 0.4108975 Vali Loss: 0.7289923 Test Loss: 0.5718423
Validation loss decreased (inf --> 0.728992).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3568589
	speed: 0.3861s/iter; left time: 3683.1901s
	iters: 200, epoch: 2 | loss: 0.2850590
	speed: 0.0618s/iter; left time: 583.3650s
	iters: 300, epoch: 2 | loss: 0.3325973
	speed: 0.0620s/iter; left time: 579.4467s
	iters: 400, epoch: 2 | loss: 0.4129772
	speed: 0.0618s/iter; left time: 571.2018s
	iters: 500, epoch: 2 | loss: 0.4838115
	speed: 0.0616s/iter; left time: 563.3376s
	iters: 600, epoch: 2 | loss: 0.3244920
	speed: 0.0616s/iter; left time: 557.2268s
	iters: 700, epoch: 2 | loss: 0.3978950
	speed: 0.0617s/iter; left time: 551.7207s
	iters: 800, epoch: 2 | loss: 0.3472565
	speed: 0.0617s/iter; left time: 545.6962s
	iters: 900, epoch: 2 | loss: 0.3358697
	speed: 0.0615s/iter; left time: 537.8155s
	iters: 1000, epoch: 2 | loss: 0.3382296
	speed: 0.0616s/iter; left time: 532.3298s
Epoch: 2 cost time: 66.12262082099915
Epoch: 2, Steps: 1071 | Train Loss: 0.3454858 Vali Loss: 0.7214065 Test Loss: 0.5576753
Validation loss decreased (0.728992 --> 0.721407).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3442880
	speed: 0.3838s/iter; left time: 3250.7982s
	iters: 200, epoch: 3 | loss: 0.3332114
	speed: 0.0617s/iter; left time: 516.4122s
	iters: 300, epoch: 3 | loss: 0.3728065
	speed: 0.0617s/iter; left time: 510.3314s
	iters: 400, epoch: 3 | loss: 0.3042616
	speed: 0.0616s/iter; left time: 502.8686s
	iters: 500, epoch: 3 | loss: 0.2972325
	speed: 0.0618s/iter; left time: 498.4241s
	iters: 600, epoch: 3 | loss: 0.3104357
	speed: 0.0615s/iter; left time: 489.7157s
	iters: 700, epoch: 3 | loss: 0.3006510
	speed: 0.0614s/iter; left time: 483.1614s
	iters: 800, epoch: 3 | loss: 0.2392302
	speed: 0.0618s/iter; left time: 480.0054s
	iters: 900, epoch: 3 | loss: 0.2753475
	speed: 0.0615s/iter; left time: 471.7616s
	iters: 1000, epoch: 3 | loss: 0.2910176
	speed: 0.0616s/iter; left time: 466.4331s
Epoch: 3 cost time: 66.00753808021545
Epoch: 3, Steps: 1071 | Train Loss: 0.3144788 Vali Loss: 0.7203826 Test Loss: 0.5579544
Validation loss decreased (0.721407 --> 0.720383).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3192091
	speed: 0.3851s/iter; left time: 2848.6607s
	iters: 200, epoch: 4 | loss: 0.3146949
	speed: 0.0616s/iter; left time: 449.8969s
	iters: 300, epoch: 4 | loss: 0.3174378
	speed: 0.0623s/iter; left time: 448.6853s
	iters: 400, epoch: 4 | loss: 0.3203601
	speed: 0.0622s/iter; left time: 441.6680s
	iters: 500, epoch: 4 | loss: 0.2819503
	speed: 0.0618s/iter; left time: 432.5281s
	iters: 600, epoch: 4 | loss: 0.2684250
	speed: 0.0618s/iter; left time: 426.3752s
	iters: 700, epoch: 4 | loss: 0.3082803
	speed: 0.0619s/iter; left time: 421.0196s
	iters: 800, epoch: 4 | loss: 0.2849337
	speed: 0.0620s/iter; left time: 415.2856s
	iters: 900, epoch: 4 | loss: 0.2773057
	speed: 0.0620s/iter; left time: 409.2956s
	iters: 1000, epoch: 4 | loss: 0.2900602
	speed: 0.0621s/iter; left time: 403.2926s
Epoch: 4 cost time: 66.34370613098145
Epoch: 4, Steps: 1071 | Train Loss: 0.2994244 Vali Loss: 0.7145556 Test Loss: 0.5531823
Validation loss decreased (0.720383 --> 0.714556).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3184030
	speed: 0.3845s/iter; left time: 2433.0424s
	iters: 200, epoch: 5 | loss: 0.3042474
	speed: 0.0616s/iter; left time: 383.5762s
	iters: 300, epoch: 5 | loss: 0.3118159
	speed: 0.0617s/iter; left time: 377.9927s
	iters: 400, epoch: 5 | loss: 0.2819825
	speed: 0.0621s/iter; left time: 374.2100s
	iters: 500, epoch: 5 | loss: 0.2489637
	speed: 0.0618s/iter; left time: 366.2739s
	iters: 600, epoch: 5 | loss: 0.2874460
	speed: 0.0617s/iter; left time: 359.3540s
	iters: 700, epoch: 5 | loss: 0.3160252
	speed: 0.0618s/iter; left time: 354.2071s
	iters: 800, epoch: 5 | loss: 0.2705318
	speed: 0.0617s/iter; left time: 346.9990s
	iters: 900, epoch: 5 | loss: 0.3464873
	speed: 0.0616s/iter; left time: 340.5483s
	iters: 1000, epoch: 5 | loss: 0.2660306
	speed: 0.0616s/iter; left time: 334.4576s
Epoch: 5 cost time: 66.13761281967163
Epoch: 5, Steps: 1071 | Train Loss: 0.2906538 Vali Loss: 0.7159622 Test Loss: 0.5463063
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2713576
	speed: 0.3820s/iter; left time: 2007.7964s
	iters: 200, epoch: 6 | loss: 0.2356167
	speed: 0.0617s/iter; left time: 318.3547s
	iters: 300, epoch: 6 | loss: 0.2896477
	speed: 0.0618s/iter; left time: 312.4063s
	iters: 400, epoch: 6 | loss: 0.2440378
	speed: 0.0616s/iter; left time: 305.4219s
	iters: 500, epoch: 6 | loss: 0.2388927
	speed: 0.0616s/iter; left time: 299.1382s
	iters: 600, epoch: 6 | loss: 0.2164344
	speed: 0.0617s/iter; left time: 293.3801s
	iters: 700, epoch: 6 | loss: 0.2713951
	speed: 0.0617s/iter; left time: 287.3186s
	iters: 800, epoch: 6 | loss: 0.2467206
	speed: 0.0615s/iter; left time: 280.3571s
	iters: 900, epoch: 6 | loss: 0.2639588
	speed: 0.0615s/iter; left time: 274.0222s
	iters: 1000, epoch: 6 | loss: 0.2935074
	speed: 0.0619s/iter; left time: 269.5132s
Epoch: 6 cost time: 66.03369355201721
Epoch: 6, Steps: 1071 | Train Loss: 0.2739287 Vali Loss: 0.7413089 Test Loss: 0.5958157
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3683266
	speed: 0.3817s/iter; left time: 1597.6173s
	iters: 200, epoch: 7 | loss: 0.2438802
	speed: 0.0618s/iter; left time: 252.5513s
	iters: 300, epoch: 7 | loss: 0.2191800
	speed: 0.0614s/iter; left time: 244.6487s
	iters: 400, epoch: 7 | loss: 0.2438368
	speed: 0.0615s/iter; left time: 238.9357s
	iters: 500, epoch: 7 | loss: 0.2672482
	speed: 0.0616s/iter; left time: 233.1721s
	iters: 600, epoch: 7 | loss: 0.2283120
	speed: 0.0615s/iter; left time: 226.7558s
	iters: 700, epoch: 7 | loss: 0.2818675
	speed: 0.0616s/iter; left time: 220.9815s
	iters: 800, epoch: 7 | loss: 0.2714321
	speed: 0.0618s/iter; left time: 215.3031s
	iters: 900, epoch: 7 | loss: 0.2414530
	speed: 0.0618s/iter; left time: 209.1820s
	iters: 1000, epoch: 7 | loss: 0.2136258
	speed: 0.0616s/iter; left time: 202.2006s
Epoch: 7 cost time: 66.00725746154785
Epoch: 7, Steps: 1071 | Train Loss: 0.2605206 Vali Loss: 0.7481450 Test Loss: 0.5972239
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : ETTm1_192_Autoformer_ETTm1_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed10458<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
mse:0.5534862279891968, mae:0.4979640245437622
