Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=321, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', dec_in=321, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Autoformer', model_id='electricity_192', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=192, root_path='./dataset/', seed=15227, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : electricity_192_Autoformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed15227>>>>>>>>>>>>>>>>>>>>>>>>>>
train 18125
val 2441
test 5069
	iters: 100, epoch: 1 | loss: 0.3104746
	speed: 0.1054s/iter; left time: 586.1365s
	iters: 200, epoch: 1 | loss: 0.2580888
	speed: 0.0705s/iter; left time: 384.9816s
	iters: 300, epoch: 1 | loss: 0.2437117
	speed: 0.0703s/iter; left time: 377.1426s
	iters: 400, epoch: 1 | loss: 0.2199090
	speed: 0.0704s/iter; left time: 370.3816s
	iters: 500, epoch: 1 | loss: 0.1935132
	speed: 0.0705s/iter; left time: 363.7763s
Epoch: 1 cost time: 43.405346393585205
Epoch: 1, Steps: 566 | Train Loss: 0.2720553 Vali Loss: 0.2024751 Test Loss: 0.2623030
Validation loss decreased (inf --> 0.202475).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2194299
	speed: 0.2532s/iter; left time: 1264.9477s
	iters: 200, epoch: 2 | loss: 0.1945414
	speed: 0.0703s/iter; left time: 344.1608s
	iters: 300, epoch: 2 | loss: 0.1790898
	speed: 0.0704s/iter; left time: 337.7251s
	iters: 400, epoch: 2 | loss: 0.1713742
	speed: 0.0700s/iter; left time: 328.7074s
	iters: 500, epoch: 2 | loss: 0.1787496
	speed: 0.0700s/iter; left time: 321.5064s
Epoch: 2 cost time: 39.68141055107117
Epoch: 2, Steps: 566 | Train Loss: 0.1835874 Vali Loss: 0.1842331 Test Loss: 0.2689347
Validation loss decreased (0.202475 --> 0.184233).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1660596
	speed: 0.2523s/iter; left time: 1117.3292s
	iters: 200, epoch: 3 | loss: 0.1659970
	speed: 0.0705s/iter; left time: 305.2727s
	iters: 300, epoch: 3 | loss: 0.1718722
	speed: 0.0701s/iter; left time: 296.3090s
	iters: 400, epoch: 3 | loss: 0.1519935
	speed: 0.0701s/iter; left time: 289.5574s
	iters: 500, epoch: 3 | loss: 0.1538687
	speed: 0.0702s/iter; left time: 282.7322s
Epoch: 3 cost time: 39.72307062149048
Epoch: 3, Steps: 566 | Train Loss: 0.1613677 Vali Loss: 0.1810855 Test Loss: 0.2431129
Validation loss decreased (0.184233 --> 0.181085).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1586678
	speed: 0.2526s/iter; left time: 975.7347s
	iters: 200, epoch: 4 | loss: 0.1487015
	speed: 0.0699s/iter; left time: 263.1524s
	iters: 300, epoch: 4 | loss: 0.1530051
	speed: 0.0697s/iter; left time: 255.3969s
	iters: 400, epoch: 4 | loss: 0.1567421
	speed: 0.0713s/iter; left time: 253.8896s
	iters: 500, epoch: 4 | loss: 0.1468397
	speed: 0.0722s/iter; left time: 250.0597s
Epoch: 4 cost time: 40.03928065299988
Epoch: 4, Steps: 566 | Train Loss: 0.1531493 Vali Loss: 0.1824154 Test Loss: 0.2315443
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1478672
	speed: 0.2514s/iter; left time: 828.9291s
	iters: 200, epoch: 5 | loss: 0.1468780
	speed: 0.0698s/iter; left time: 223.2571s
	iters: 300, epoch: 5 | loss: 0.1401906
	speed: 0.0704s/iter; left time: 218.0912s
	iters: 400, epoch: 5 | loss: 0.1325805
	speed: 0.0699s/iter; left time: 209.6256s
	iters: 500, epoch: 5 | loss: 0.1404097
	speed: 0.0702s/iter; left time: 203.4113s
Epoch: 5 cost time: 39.675403118133545
Epoch: 5, Steps: 566 | Train Loss: 0.1490877 Vali Loss: 0.1804878 Test Loss: 0.2259877
Validation loss decreased (0.181085 --> 0.180488).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1415536
	speed: 0.2528s/iter; left time: 690.4830s
	iters: 200, epoch: 6 | loss: 0.1587767
	speed: 0.0699s/iter; left time: 183.9670s
	iters: 300, epoch: 6 | loss: 0.1448145
	speed: 0.0703s/iter; left time: 178.0466s
	iters: 400, epoch: 6 | loss: 0.1424245
	speed: 0.0703s/iter; left time: 170.9130s
	iters: 500, epoch: 6 | loss: 0.1388971
	speed: 0.0704s/iter; left time: 164.1829s
Epoch: 6 cost time: 39.79671573638916
Epoch: 6, Steps: 566 | Train Loss: 0.1468941 Vali Loss: 0.1805889 Test Loss: 0.2270789
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1468803
	speed: 0.2518s/iter; left time: 545.1261s
	iters: 200, epoch: 7 | loss: 0.1607490
	speed: 0.0707s/iter; left time: 146.0088s
	iters: 300, epoch: 7 | loss: 0.1471637
	speed: 0.0705s/iter; left time: 138.5080s
	iters: 400, epoch: 7 | loss: 0.1445965
	speed: 0.0704s/iter; left time: 131.2824s
	iters: 500, epoch: 7 | loss: 0.1362818
	speed: 0.0709s/iter; left time: 125.0514s
Epoch: 7 cost time: 39.95162916183472
Epoch: 7, Steps: 566 | Train Loss: 0.1456893 Vali Loss: 0.1809368 Test Loss: 0.2287231
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1471383
	speed: 0.2509s/iter; left time: 401.1566s
	iters: 200, epoch: 8 | loss: 0.1437069
	speed: 0.0708s/iter; left time: 106.1752s
	iters: 300, epoch: 8 | loss: 0.1343448
	speed: 0.0703s/iter; left time: 98.3715s
	iters: 400, epoch: 8 | loss: 0.1467418
	speed: 0.0704s/iter; left time: 91.4542s
	iters: 500, epoch: 8 | loss: 0.1437679
	speed: 0.0704s/iter; left time: 84.4030s
Epoch: 8 cost time: 39.8615403175354
Epoch: 8, Steps: 566 | Train Loss: 0.1450455 Vali Loss: 0.1803129 Test Loss: 0.2266557
Validation loss decreased (0.180488 --> 0.180313).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1396074
	speed: 0.2537s/iter; left time: 262.0314s
	iters: 200, epoch: 9 | loss: 0.1357033
	speed: 0.0703s/iter; left time: 65.5837s
	iters: 300, epoch: 9 | loss: 0.1393564
	speed: 0.0698s/iter; left time: 58.1251s
	iters: 400, epoch: 9 | loss: 0.1519255
	speed: 0.0697s/iter; left time: 51.1202s
	iters: 500, epoch: 9 | loss: 0.1523523
	speed: 0.0699s/iter; left time: 44.2287s
Epoch: 9 cost time: 39.69168210029602
Epoch: 9, Steps: 566 | Train Loss: 0.1447375 Vali Loss: 0.1796211 Test Loss: 0.2254767
Validation loss decreased (0.180313 --> 0.179621).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1477552
	speed: 0.2526s/iter; left time: 117.9756s
	iters: 200, epoch: 10 | loss: 0.1558866
	speed: 0.0703s/iter; left time: 25.7994s
	iters: 300, epoch: 10 | loss: 0.1440321
	speed: 0.0701s/iter; left time: 18.7063s
	iters: 400, epoch: 10 | loss: 0.1496909
	speed: 0.0704s/iter; left time: 11.7534s
	iters: 500, epoch: 10 | loss: 0.1523006
	speed: 0.0702s/iter; left time: 4.7053s
Epoch: 10 cost time: 39.72564148902893
Epoch: 10, Steps: 566 | Train Loss: 0.1445088 Vali Loss: 0.1799441 Test Loss: 0.2268359
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : electricity_192_Autoformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed15227<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5069
mse:0.2242496907711029, mae:0.3340089023113251
