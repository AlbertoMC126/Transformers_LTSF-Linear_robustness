Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Transformer', model_id='ETTm2_720', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=720, root_path='./dataset/', seed=28649, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm2_720_Transformer_ETTm2_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed28649>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33745
val 10801
test 10801
	iters: 100, epoch: 1 | loss: 0.2705691
	speed: 0.1242s/iter; left time: 1296.3353s
	iters: 200, epoch: 1 | loss: 0.3856168
	speed: 0.0919s/iter; left time: 949.8798s
	iters: 300, epoch: 1 | loss: 0.2259669
	speed: 0.0917s/iter; left time: 939.2238s
	iters: 400, epoch: 1 | loss: 0.2881932
	speed: 0.0917s/iter; left time: 930.3519s
	iters: 500, epoch: 1 | loss: 0.2694246
	speed: 0.0919s/iter; left time: 922.8424s
	iters: 600, epoch: 1 | loss: 0.1800638
	speed: 0.0920s/iter; left time: 914.6341s
	iters: 700, epoch: 1 | loss: 0.2455035
	speed: 0.0920s/iter; left time: 905.8299s
	iters: 800, epoch: 1 | loss: 0.1586259
	speed: 0.0919s/iter; left time: 895.6000s
	iters: 900, epoch: 1 | loss: 0.2032455
	speed: 0.0918s/iter; left time: 885.0328s
	iters: 1000, epoch: 1 | loss: 0.1719731
	speed: 0.0919s/iter; left time: 877.1612s
Epoch: 1 cost time: 100.09796166419983
Epoch: 1, Steps: 1054 | Train Loss: 0.2524433 Vali Loss: 1.1589819 Test Loss: 3.5980926
Validation loss decreased (inf --> 1.158982).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1339951
	speed: 0.3714s/iter; left time: 3485.9580s
	iters: 200, epoch: 2 | loss: 0.1675912
	speed: 0.0918s/iter; left time: 852.9670s
	iters: 300, epoch: 2 | loss: 0.1317062
	speed: 0.0917s/iter; left time: 842.1623s
	iters: 400, epoch: 2 | loss: 0.1463407
	speed: 0.0918s/iter; left time: 833.9299s
	iters: 500, epoch: 2 | loss: 0.1483783
	speed: 0.0918s/iter; left time: 824.8886s
	iters: 600, epoch: 2 | loss: 0.1238409
	speed: 0.0917s/iter; left time: 814.5231s
	iters: 700, epoch: 2 | loss: 0.1136585
	speed: 0.0917s/iter; left time: 805.9741s
	iters: 800, epoch: 2 | loss: 0.1240752
	speed: 0.0923s/iter; left time: 801.5013s
	iters: 900, epoch: 2 | loss: 0.1419401
	speed: 0.0923s/iter; left time: 792.5495s
	iters: 1000, epoch: 2 | loss: 0.1076431
	speed: 0.0923s/iter; left time: 783.1231s
Epoch: 2 cost time: 96.86939907073975
Epoch: 2, Steps: 1054 | Train Loss: 0.1400215 Vali Loss: 1.1824560 Test Loss: 3.4683282
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1034098
	speed: 0.3688s/iter; left time: 3073.0970s
	iters: 200, epoch: 3 | loss: 0.1180034
	speed: 0.0917s/iter; left time: 754.7617s
	iters: 300, epoch: 3 | loss: 0.1228880
	speed: 0.0916s/iter; left time: 745.3658s
	iters: 400, epoch: 3 | loss: 0.0881913
	speed: 0.0917s/iter; left time: 736.3854s
	iters: 500, epoch: 3 | loss: 0.0923659
	speed: 0.0917s/iter; left time: 727.2017s
	iters: 600, epoch: 3 | loss: 0.0928837
	speed: 0.0919s/iter; left time: 719.8604s
	iters: 700, epoch: 3 | loss: 0.0823509
	speed: 0.0919s/iter; left time: 710.8996s
	iters: 800, epoch: 3 | loss: 0.0999707
	speed: 0.0918s/iter; left time: 700.5001s
	iters: 900, epoch: 3 | loss: 0.1109739
	speed: 0.0917s/iter; left time: 690.8163s
	iters: 1000, epoch: 3 | loss: 0.1008784
	speed: 0.0917s/iter; left time: 681.2395s
Epoch: 3 cost time: 96.6884217262268
Epoch: 3, Steps: 1054 | Train Loss: 0.0999216 Vali Loss: 1.1471747 Test Loss: 2.9938643
Validation loss decreased (1.158982 --> 1.147175).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0883348
	speed: 0.3716s/iter; left time: 2704.9773s
	iters: 200, epoch: 4 | loss: 0.0820042
	speed: 0.0918s/iter; left time: 659.3490s
	iters: 300, epoch: 4 | loss: 0.0841504
	speed: 0.0919s/iter; left time: 650.3559s
	iters: 400, epoch: 4 | loss: 0.0818296
	speed: 0.0918s/iter; left time: 640.8610s
	iters: 500, epoch: 4 | loss: 0.0885155
	speed: 0.0919s/iter; left time: 631.9306s
	iters: 600, epoch: 4 | loss: 0.0880385
	speed: 0.0919s/iter; left time: 622.8298s
	iters: 700, epoch: 4 | loss: 0.0933536
	speed: 0.0918s/iter; left time: 613.0025s
	iters: 800, epoch: 4 | loss: 0.0799493
	speed: 0.0918s/iter; left time: 603.8960s
	iters: 900, epoch: 4 | loss: 0.0765556
	speed: 0.0919s/iter; left time: 595.2577s
	iters: 1000, epoch: 4 | loss: 0.0881793
	speed: 0.0919s/iter; left time: 586.1353s
Epoch: 4 cost time: 96.80555033683777
Epoch: 4, Steps: 1054 | Train Loss: 0.0854839 Vali Loss: 1.1820284 Test Loss: 3.0073907
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0690845
	speed: 0.3689s/iter; left time: 2296.3227s
	iters: 200, epoch: 5 | loss: 0.0810133
	speed: 0.0918s/iter; left time: 562.3232s
	iters: 300, epoch: 5 | loss: 0.0851340
	speed: 0.0920s/iter; left time: 554.0233s
	iters: 400, epoch: 5 | loss: 0.0739118
	speed: 0.0917s/iter; left time: 543.5734s
	iters: 500, epoch: 5 | loss: 0.0851567
	speed: 0.0918s/iter; left time: 534.5444s
	iters: 600, epoch: 5 | loss: 0.0794854
	speed: 0.0918s/iter; left time: 525.3259s
	iters: 700, epoch: 5 | loss: 0.0717528
	speed: 0.0917s/iter; left time: 515.9316s
	iters: 800, epoch: 5 | loss: 0.0794476
	speed: 0.0918s/iter; left time: 507.0264s
	iters: 900, epoch: 5 | loss: 0.0674093
	speed: 0.0917s/iter; left time: 497.5864s
	iters: 1000, epoch: 5 | loss: 0.0784870
	speed: 0.0918s/iter; left time: 489.0621s
Epoch: 5 cost time: 96.72305130958557
Epoch: 5, Steps: 1054 | Train Loss: 0.0788044 Vali Loss: 1.1542045 Test Loss: 2.8093908
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0743789
	speed: 0.3687s/iter; left time: 1906.4615s
	iters: 200, epoch: 6 | loss: 0.0744343
	speed: 0.0918s/iter; left time: 465.2706s
	iters: 300, epoch: 6 | loss: 0.0662258
	speed: 0.0917s/iter; left time: 456.0676s
	iters: 400, epoch: 6 | loss: 0.0715097
	speed: 0.0917s/iter; left time: 446.4663s
	iters: 500, epoch: 6 | loss: 0.0747579
	speed: 0.0917s/iter; left time: 437.3272s
	iters: 600, epoch: 6 | loss: 0.0713305
	speed: 0.0919s/iter; left time: 429.2126s
	iters: 700, epoch: 6 | loss: 0.0722087
	speed: 0.0919s/iter; left time: 420.1729s
	iters: 800, epoch: 6 | loss: 0.0676673
	speed: 0.0918s/iter; left time: 410.2961s
	iters: 900, epoch: 6 | loss: 0.0666040
	speed: 0.0918s/iter; left time: 401.1110s
	iters: 1000, epoch: 6 | loss: 0.0641997
	speed: 0.0918s/iter; left time: 391.9044s
Epoch: 6 cost time: 96.72884607315063
Epoch: 6, Steps: 1054 | Train Loss: 0.0755084 Vali Loss: 1.1568460 Test Loss: 2.8843641
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : ETTm2_720_Transformer_ETTm2_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed28649<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10801
mse:2.9960224628448486, mae:1.291143774986267
