Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=862, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=862, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Informer', model_id='traffic_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=336, root_path='./dataset/', seed=3144, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_336_Informer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed3144>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11849
val 1421
test 3173
	iters: 100, epoch: 1 | loss: 0.9317236
	speed: 0.1125s/iter; left time: 405.2381s
	iters: 200, epoch: 1 | loss: 0.8917825
	speed: 0.0805s/iter; left time: 281.7199s
	iters: 300, epoch: 1 | loss: 0.8963982
	speed: 0.0806s/iter; left time: 274.1609s
Epoch: 1 cost time: 32.994683265686035
Epoch: 1, Steps: 370 | Train Loss: 0.9124942 Vali Loss: 1.1657037 Test Loss: 1.3790060
Validation loss decreased (inf --> 1.165704).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.8008910
	speed: 0.2727s/iter; left time: 881.0275s
	iters: 200, epoch: 2 | loss: 0.6451097
	speed: 0.0804s/iter; left time: 251.6725s
	iters: 300, epoch: 2 | loss: 0.4788551
	speed: 0.0817s/iter; left time: 247.4959s
Epoch: 2 cost time: 30.111225366592407
Epoch: 2, Steps: 370 | Train Loss: 0.6661017 Vali Loss: 0.8109723 Test Loss: 0.9440452
Validation loss decreased (1.165704 --> 0.810972).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4053109
	speed: 0.2768s/iter; left time: 791.7907s
	iters: 200, epoch: 3 | loss: 0.3957272
	speed: 0.0808s/iter; left time: 223.0828s
	iters: 300, epoch: 3 | loss: 0.3617947
	speed: 0.0807s/iter; left time: 214.6194s
Epoch: 3 cost time: 29.97920799255371
Epoch: 3, Steps: 370 | Train Loss: 0.3905764 Vali Loss: 0.7160397 Test Loss: 0.8470410
Validation loss decreased (0.810972 --> 0.716040).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3307636
	speed: 0.2732s/iter; left time: 680.6540s
	iters: 200, epoch: 4 | loss: 0.3281576
	speed: 0.0811s/iter; left time: 193.9994s
	iters: 300, epoch: 4 | loss: 0.3168375
	speed: 0.0809s/iter; left time: 185.3236s
Epoch: 4 cost time: 29.924851179122925
Epoch: 4, Steps: 370 | Train Loss: 0.3269396 Vali Loss: 0.7068633 Test Loss: 0.8430789
Validation loss decreased (0.716040 --> 0.706863).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3176217
	speed: 0.2725s/iter; left time: 578.0729s
	iters: 200, epoch: 5 | loss: 0.3128225
	speed: 0.0823s/iter; left time: 166.3616s
	iters: 300, epoch: 5 | loss: 0.2943970
	speed: 0.0818s/iter; left time: 157.0889s
Epoch: 5 cost time: 30.233707189559937
Epoch: 5, Steps: 370 | Train Loss: 0.3099194 Vali Loss: 0.7047230 Test Loss: 0.8367175
Validation loss decreased (0.706863 --> 0.704723).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3108017
	speed: 0.2735s/iter; left time: 478.9550s
	iters: 200, epoch: 6 | loss: 0.3048821
	speed: 0.0806s/iter; left time: 133.0233s
	iters: 300, epoch: 6 | loss: 0.3132547
	speed: 0.0810s/iter; left time: 125.5641s
Epoch: 6 cost time: 29.93795132637024
Epoch: 6, Steps: 370 | Train Loss: 0.3028417 Vali Loss: 0.6890031 Test Loss: 0.8296819
Validation loss decreased (0.704723 --> 0.689003).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3022655
	speed: 0.2728s/iter; left time: 376.7170s
	iters: 200, epoch: 7 | loss: 0.3027013
	speed: 0.0807s/iter; left time: 103.3302s
	iters: 300, epoch: 7 | loss: 0.2996542
	speed: 0.0806s/iter; left time: 95.1953s
Epoch: 7 cost time: 29.875831842422485
Epoch: 7, Steps: 370 | Train Loss: 0.2996917 Vali Loss: 0.6883292 Test Loss: 0.8297234
Validation loss decreased (0.689003 --> 0.688329).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2955353
	speed: 0.2750s/iter; left time: 278.0567s
	iters: 200, epoch: 8 | loss: 0.2983532
	speed: 0.0816s/iter; left time: 74.3086s
	iters: 300, epoch: 8 | loss: 0.3025165
	speed: 0.0817s/iter; left time: 66.2334s
Epoch: 8 cost time: 30.223402738571167
Epoch: 8, Steps: 370 | Train Loss: 0.2979867 Vali Loss: 0.6904359 Test Loss: 0.8296087
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2926274
	speed: 0.2702s/iter; left time: 173.1676s
	iters: 200, epoch: 9 | loss: 0.2990573
	speed: 0.0804s/iter; left time: 43.5139s
	iters: 300, epoch: 9 | loss: 0.3037097
	speed: 0.0803s/iter; left time: 35.4244s
Epoch: 9 cost time: 29.803399562835693
Epoch: 9, Steps: 370 | Train Loss: 0.2971674 Vali Loss: 0.6904099 Test Loss: 0.8298547
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2890174
	speed: 0.2704s/iter; left time: 73.2909s
	iters: 200, epoch: 10 | loss: 0.2988623
	speed: 0.0800s/iter; left time: 13.6770s
	iters: 300, epoch: 10 | loss: 0.3047817
	speed: 0.0807s/iter; left time: 5.7276s
Epoch: 10 cost time: 29.804155349731445
Epoch: 10, Steps: 370 | Train Loss: 0.2966249 Vali Loss: 0.6891976 Test Loss: 0.8290236
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : traffic_336_Informer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed3144<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3173
mse:0.8313450813293457, mae:0.4629324674606323
