Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=862, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=862, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Autoformer', model_id='traffic_192', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=192, root_path='./dataset/', seed=28649, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_192_Autoformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed28649>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11993
val 1565
test 3317
	iters: 100, epoch: 1 | loss: 0.4475234
	speed: 0.1234s/iter; left time: 449.2340s
	iters: 200, epoch: 1 | loss: 0.3802755
	speed: 0.0880s/iter; left time: 311.7179s
	iters: 300, epoch: 1 | loss: 0.3415657
	speed: 0.0884s/iter; left time: 304.2945s
Epoch: 1 cost time: 36.49399995803833
Epoch: 1, Steps: 374 | Train Loss: 0.4335911 Vali Loss: 0.5290008 Test Loss: 0.6833188
Validation loss decreased (inf --> 0.529001).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2992756
	speed: 0.2885s/iter; left time: 942.6858s
	iters: 200, epoch: 2 | loss: 0.2730885
	speed: 0.0874s/iter; left time: 276.7526s
	iters: 300, epoch: 2 | loss: 0.2674357
	speed: 0.0867s/iter; left time: 266.0520s
Epoch: 2 cost time: 32.750648498535156
Epoch: 2, Steps: 374 | Train Loss: 0.2861065 Vali Loss: 0.5325923 Test Loss: 0.7344758
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2749919
	speed: 0.2928s/iter; left time: 847.1354s
	iters: 200, epoch: 3 | loss: 0.2473489
	speed: 0.0879s/iter; left time: 245.4657s
	iters: 300, epoch: 3 | loss: 0.2673945
	speed: 0.0880s/iter; left time: 236.9554s
Epoch: 3 cost time: 33.15796232223511
Epoch: 3, Steps: 374 | Train Loss: 0.2567914 Vali Loss: 0.5225422 Test Loss: 0.6968576
Validation loss decreased (0.529001 --> 0.522542).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2446713
	speed: 0.2890s/iter; left time: 728.1025s
	iters: 200, epoch: 4 | loss: 0.2501705
	speed: 0.0877s/iter; left time: 212.0844s
	iters: 300, epoch: 4 | loss: 0.2443096
	speed: 0.0880s/iter; left time: 204.1360s
Epoch: 4 cost time: 32.78342604637146
Epoch: 4, Steps: 374 | Train Loss: 0.2462483 Vali Loss: 0.5251409 Test Loss: 0.7130789
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2435988
	speed: 0.2862s/iter; left time: 613.9462s
	iters: 200, epoch: 5 | loss: 0.2348338
	speed: 0.0924s/iter; left time: 188.9257s
	iters: 300, epoch: 5 | loss: 0.2373151
	speed: 0.0922s/iter; left time: 179.3231s
Epoch: 5 cost time: 34.01555681228638
Epoch: 5, Steps: 374 | Train Loss: 0.2422004 Vali Loss: 0.5157650 Test Loss: 0.6964093
Validation loss decreased (0.522542 --> 0.515765).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2417827
	speed: 0.2932s/iter; left time: 519.1703s
	iters: 200, epoch: 6 | loss: 0.2322130
	speed: 0.0877s/iter; left time: 146.5721s
	iters: 300, epoch: 6 | loss: 0.2397710
	speed: 0.0883s/iter; left time: 138.6963s
Epoch: 6 cost time: 32.89006423950195
Epoch: 6, Steps: 374 | Train Loss: 0.2400307 Vali Loss: 0.5241009 Test Loss: 0.7038284
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2296146
	speed: 0.2860s/iter; left time: 399.5981s
	iters: 200, epoch: 7 | loss: 0.2341311
	speed: 0.0870s/iter; left time: 112.8103s
	iters: 300, epoch: 7 | loss: 0.2369491
	speed: 0.0873s/iter; left time: 104.4577s
Epoch: 7 cost time: 32.5775465965271
Epoch: 7, Steps: 374 | Train Loss: 0.2385980 Vali Loss: 0.5220630 Test Loss: 0.7010972
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2436822
	speed: 0.2907s/iter; left time: 297.3563s
	iters: 200, epoch: 8 | loss: 0.2374117
	speed: 0.0906s/iter; left time: 83.5859s
	iters: 300, epoch: 8 | loss: 0.2459577
	speed: 0.0878s/iter; left time: 72.2321s
Epoch: 8 cost time: 33.470306634902954
Epoch: 8, Steps: 374 | Train Loss: 0.2380534 Vali Loss: 0.5152305 Test Loss: 0.6912587
Validation loss decreased (0.515765 --> 0.515230).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2390291
	speed: 0.2893s/iter; left time: 187.7404s
	iters: 200, epoch: 9 | loss: 0.2484080
	speed: 0.0874s/iter; left time: 47.9969s
	iters: 300, epoch: 9 | loss: 0.2392975
	speed: 0.0881s/iter; left time: 39.5546s
Epoch: 9 cost time: 32.783965826034546
Epoch: 9, Steps: 374 | Train Loss: 0.2377043 Vali Loss: 0.5168620 Test Loss: 0.6915703
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2317338
	speed: 0.2949s/iter; left time: 81.1088s
	iters: 200, epoch: 10 | loss: 0.2428266
	speed: 0.0923s/iter; left time: 16.1556s
	iters: 300, epoch: 10 | loss: 0.2376934
	speed: 0.0916s/iter; left time: 6.8710s
Epoch: 10 cost time: 34.48280382156372
Epoch: 10, Steps: 374 | Train Loss: 0.2373413 Vali Loss: 0.5174556 Test Loss: 0.6922999
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : traffic_192_Autoformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed28649<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3317
mse:0.6919386386871338, mae:0.4378875494003296
