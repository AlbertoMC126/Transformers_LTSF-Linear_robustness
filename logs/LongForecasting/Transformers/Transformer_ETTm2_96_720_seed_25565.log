Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Transformer', model_id='ETTm2_720', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=720, root_path='./dataset/', seed=25565, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm2_720_Transformer_ETTm2_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed25565>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33745
val 10801
test 10801
	iters: 100, epoch: 1 | loss: 0.3239549
	speed: 0.1224s/iter; left time: 1277.5269s
	iters: 200, epoch: 1 | loss: 0.3388757
	speed: 0.0916s/iter; left time: 947.5867s
	iters: 300, epoch: 1 | loss: 0.2587591
	speed: 0.0916s/iter; left time: 937.8706s
	iters: 400, epoch: 1 | loss: 0.2503792
	speed: 0.0918s/iter; left time: 930.7333s
	iters: 500, epoch: 1 | loss: 0.3285179
	speed: 0.0918s/iter; left time: 921.9580s
	iters: 600, epoch: 1 | loss: 0.2517939
	speed: 0.0918s/iter; left time: 912.3713s
	iters: 700, epoch: 1 | loss: 0.1961718
	speed: 0.0919s/iter; left time: 903.9278s
	iters: 800, epoch: 1 | loss: 0.1879721
	speed: 0.0918s/iter; left time: 894.6275s
	iters: 900, epoch: 1 | loss: 0.1835708
	speed: 0.0922s/iter; left time: 888.5794s
	iters: 1000, epoch: 1 | loss: 0.1618522
	speed: 0.0923s/iter; left time: 880.6011s
Epoch: 1 cost time: 99.9080216884613
Epoch: 1, Steps: 1054 | Train Loss: 0.2581069 Vali Loss: 1.1808060 Test Loss: 4.3944216
Validation loss decreased (inf --> 1.180806).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1862706
	speed: 0.3699s/iter; left time: 3471.9327s
	iters: 200, epoch: 2 | loss: 0.1402815
	speed: 0.0920s/iter; left time: 854.5401s
	iters: 300, epoch: 2 | loss: 0.1259081
	speed: 0.0918s/iter; left time: 843.6585s
	iters: 400, epoch: 2 | loss: 0.1432369
	speed: 0.0919s/iter; left time: 834.7725s
	iters: 500, epoch: 2 | loss: 0.1417729
	speed: 0.0918s/iter; left time: 825.2288s
	iters: 600, epoch: 2 | loss: 0.1739348
	speed: 0.0919s/iter; left time: 816.3981s
	iters: 700, epoch: 2 | loss: 0.1539422
	speed: 0.0918s/iter; left time: 806.6241s
	iters: 800, epoch: 2 | loss: 0.1094139
	speed: 0.0918s/iter; left time: 797.3988s
	iters: 900, epoch: 2 | loss: 0.1290830
	speed: 0.0922s/iter; left time: 791.7746s
	iters: 1000, epoch: 2 | loss: 0.1134885
	speed: 0.0922s/iter; left time: 782.7015s
Epoch: 2 cost time: 96.87770533561707
Epoch: 2, Steps: 1054 | Train Loss: 0.1455125 Vali Loss: 1.1020975 Test Loss: 3.7210748
Validation loss decreased (1.180806 --> 1.102098).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1301257
	speed: 0.3706s/iter; left time: 3088.1966s
	iters: 200, epoch: 3 | loss: 0.1089087
	speed: 0.0918s/iter; left time: 755.6924s
	iters: 300, epoch: 3 | loss: 0.0997119
	speed: 0.0919s/iter; left time: 747.2408s
	iters: 400, epoch: 3 | loss: 0.1010225
	speed: 0.0917s/iter; left time: 736.8408s
	iters: 500, epoch: 3 | loss: 0.1020197
	speed: 0.0916s/iter; left time: 726.9346s
	iters: 600, epoch: 3 | loss: 0.0965462
	speed: 0.0916s/iter; left time: 717.8024s
	iters: 700, epoch: 3 | loss: 0.0954402
	speed: 0.0917s/iter; left time: 708.9968s
	iters: 800, epoch: 3 | loss: 0.0982867
	speed: 0.0917s/iter; left time: 699.8202s
	iters: 900, epoch: 3 | loss: 0.0992763
	speed: 0.0922s/iter; left time: 694.3409s
	iters: 1000, epoch: 3 | loss: 0.0841972
	speed: 0.0923s/iter; left time: 686.1373s
Epoch: 3 cost time: 96.76739430427551
Epoch: 3, Steps: 1054 | Train Loss: 0.1065309 Vali Loss: 1.0385469 Test Loss: 3.0657265
Validation loss decreased (1.102098 --> 1.038547).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1111806
	speed: 0.3709s/iter; left time: 2700.1142s
	iters: 200, epoch: 4 | loss: 0.0888792
	speed: 0.0921s/iter; left time: 661.0206s
	iters: 300, epoch: 4 | loss: 0.0939229
	speed: 0.0919s/iter; left time: 650.3837s
	iters: 400, epoch: 4 | loss: 0.0944086
	speed: 0.0920s/iter; left time: 641.7300s
	iters: 500, epoch: 4 | loss: 0.0813073
	speed: 0.0919s/iter; left time: 632.1070s
	iters: 600, epoch: 4 | loss: 0.0896218
	speed: 0.0918s/iter; left time: 622.1285s
	iters: 700, epoch: 4 | loss: 0.0934342
	speed: 0.0918s/iter; left time: 613.0690s
	iters: 800, epoch: 4 | loss: 0.0957510
	speed: 0.0919s/iter; left time: 604.4146s
	iters: 900, epoch: 4 | loss: 0.0770708
	speed: 0.0922s/iter; left time: 597.3485s
	iters: 1000, epoch: 4 | loss: 0.0823675
	speed: 0.0923s/iter; left time: 589.0496s
Epoch: 4 cost time: 96.92496275901794
Epoch: 4, Steps: 1054 | Train Loss: 0.0914018 Vali Loss: 0.9912992 Test Loss: 3.1214261
Validation loss decreased (1.038547 --> 0.991299).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0823916
	speed: 0.3694s/iter; left time: 2299.8166s
	iters: 200, epoch: 5 | loss: 0.0892516
	speed: 0.0919s/iter; left time: 563.1689s
	iters: 300, epoch: 5 | loss: 0.0809077
	speed: 0.0919s/iter; left time: 553.6358s
	iters: 400, epoch: 5 | loss: 0.0893487
	speed: 0.0918s/iter; left time: 544.0078s
	iters: 500, epoch: 5 | loss: 0.0886726
	speed: 0.0917s/iter; left time: 534.0747s
	iters: 600, epoch: 5 | loss: 0.0859320
	speed: 0.0917s/iter; left time: 525.2229s
	iters: 700, epoch: 5 | loss: 0.0855163
	speed: 0.0917s/iter; left time: 515.9517s
	iters: 800, epoch: 5 | loss: 0.0889602
	speed: 0.0916s/iter; left time: 506.2475s
	iters: 900, epoch: 5 | loss: 0.0682179
	speed: 0.0921s/iter; left time: 499.5852s
	iters: 1000, epoch: 5 | loss: 0.0878972
	speed: 0.0922s/iter; left time: 490.7733s
Epoch: 5 cost time: 96.77210712432861
Epoch: 5, Steps: 1054 | Train Loss: 0.0843739 Vali Loss: 1.0099474 Test Loss: 3.1375163
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0749918
	speed: 0.3657s/iter; left time: 1890.9994s
	iters: 200, epoch: 6 | loss: 0.0831595
	speed: 0.0917s/iter; left time: 464.7991s
	iters: 300, epoch: 6 | loss: 0.0759242
	speed: 0.0917s/iter; left time: 455.9785s
	iters: 400, epoch: 6 | loss: 0.0784448
	speed: 0.0918s/iter; left time: 447.1487s
	iters: 500, epoch: 6 | loss: 0.0754137
	speed: 0.0918s/iter; left time: 438.2045s
	iters: 600, epoch: 6 | loss: 0.0789201
	speed: 0.0918s/iter; left time: 428.6042s
	iters: 700, epoch: 6 | loss: 0.0893228
	speed: 0.0916s/iter; left time: 418.8057s
	iters: 800, epoch: 6 | loss: 0.0758370
	speed: 0.0917s/iter; left time: 409.8804s
	iters: 900, epoch: 6 | loss: 0.0822235
	speed: 0.0921s/iter; left time: 402.6482s
	iters: 1000, epoch: 6 | loss: 0.0738720
	speed: 0.0922s/iter; left time: 393.8082s
Epoch: 6 cost time: 96.73756623268127
Epoch: 6, Steps: 1054 | Train Loss: 0.0807699 Vali Loss: 0.9664370 Test Loss: 2.9694872
Validation loss decreased (0.991299 --> 0.966437).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.0870032
	speed: 0.3686s/iter; left time: 1517.7035s
	iters: 200, epoch: 7 | loss: 0.0758136
	speed: 0.0919s/iter; left time: 369.0884s
	iters: 300, epoch: 7 | loss: 0.0829328
	speed: 0.0919s/iter; left time: 359.8318s
	iters: 400, epoch: 7 | loss: 0.0726160
	speed: 0.0919s/iter; left time: 350.7115s
	iters: 500, epoch: 7 | loss: 0.0710460
	speed: 0.0918s/iter; left time: 341.3420s
	iters: 600, epoch: 7 | loss: 0.0866908
	speed: 0.0919s/iter; left time: 332.2681s
	iters: 700, epoch: 7 | loss: 0.0799821
	speed: 0.0919s/iter; left time: 323.0483s
	iters: 800, epoch: 7 | loss: 0.0963995
	speed: 0.0918s/iter; left time: 313.7002s
	iters: 900, epoch: 7 | loss: 0.0769666
	speed: 0.0921s/iter; left time: 305.6482s
	iters: 1000, epoch: 7 | loss: 0.0864997
	speed: 0.0923s/iter; left time: 296.9657s
Epoch: 7 cost time: 96.85800218582153
Epoch: 7, Steps: 1054 | Train Loss: 0.0789005 Vali Loss: 0.9731458 Test Loss: 3.0009065
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.0756319
	speed: 0.3670s/iter; left time: 1124.2188s
	iters: 200, epoch: 8 | loss: 0.0815412
	speed: 0.0917s/iter; left time: 271.8138s
	iters: 300, epoch: 8 | loss: 0.0723826
	speed: 0.0917s/iter; left time: 262.6363s
	iters: 400, epoch: 8 | loss: 0.0773262
	speed: 0.0919s/iter; left time: 253.8827s
	iters: 500, epoch: 8 | loss: 0.0756768
	speed: 0.0917s/iter; left time: 244.0955s
	iters: 600, epoch: 8 | loss: 0.0778904
	speed: 0.0917s/iter; left time: 235.0372s
	iters: 700, epoch: 8 | loss: 0.0770359
	speed: 0.0917s/iter; left time: 225.9180s
	iters: 800, epoch: 8 | loss: 0.0748345
	speed: 0.0917s/iter; left time: 216.6562s
	iters: 900, epoch: 8 | loss: 0.0842293
	speed: 0.0920s/iter; left time: 208.1022s
	iters: 1000, epoch: 8 | loss: 0.0860125
	speed: 0.0922s/iter; left time: 199.5113s
Epoch: 8 cost time: 96.73595261573792
Epoch: 8, Steps: 1054 | Train Loss: 0.0779216 Vali Loss: 0.9706289 Test Loss: 3.0317633
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.0690028
	speed: 0.3681s/iter; left time: 739.4637s
	iters: 200, epoch: 9 | loss: 0.0791555
	speed: 0.0928s/iter; left time: 177.1714s
	iters: 300, epoch: 9 | loss: 0.0793594
	speed: 0.0921s/iter; left time: 166.6575s
	iters: 400, epoch: 9 | loss: 0.0700259
	speed: 0.0917s/iter; left time: 156.6452s
	iters: 500, epoch: 9 | loss: 0.0811504
	speed: 0.0919s/iter; left time: 147.8767s
	iters: 600, epoch: 9 | loss: 0.0775756
	speed: 0.0919s/iter; left time: 138.6023s
	iters: 700, epoch: 9 | loss: 0.0853683
	speed: 0.0919s/iter; left time: 129.4204s
	iters: 800, epoch: 9 | loss: 0.0803185
	speed: 0.0917s/iter; left time: 120.0904s
	iters: 900, epoch: 9 | loss: 0.0754028
	speed: 0.0921s/iter; left time: 111.3212s
	iters: 1000, epoch: 9 | loss: 0.0735044
	speed: 0.0924s/iter; left time: 102.5117s
Epoch: 9 cost time: 97.05991172790527
Epoch: 9, Steps: 1054 | Train Loss: 0.0774157 Vali Loss: 0.9681009 Test Loss: 3.0066867
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : ETTm2_720_Transformer_ETTm2_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed25565<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10801
mse:2.9716873168945312, mae:1.2784159183502197
