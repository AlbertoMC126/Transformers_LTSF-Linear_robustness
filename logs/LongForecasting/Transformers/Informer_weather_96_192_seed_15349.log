Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=21, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=21, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Informer', model_id='weather_192', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=192, root_path='./dataset/', seed=15349, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_192_Informer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed15349>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36600
val 5079
test 10348
	iters: 100, epoch: 1 | loss: 0.5545548
	speed: 0.0645s/iter; left time: 730.4696s
	iters: 200, epoch: 1 | loss: 0.4276038
	speed: 0.0335s/iter; left time: 375.7476s
	iters: 300, epoch: 1 | loss: 0.2913250
	speed: 0.0347s/iter; left time: 385.9599s
	iters: 400, epoch: 1 | loss: 0.7408563
	speed: 0.0350s/iter; left time: 385.6886s
	iters: 500, epoch: 1 | loss: 0.3161526
	speed: 0.0346s/iter; left time: 378.6594s
	iters: 600, epoch: 1 | loss: 0.3886492
	speed: 0.0350s/iter; left time: 379.4290s
	iters: 700, epoch: 1 | loss: 1.0119257
	speed: 0.0346s/iter; left time: 371.7780s
	iters: 800, epoch: 1 | loss: 0.4052850
	speed: 0.0348s/iter; left time: 369.7896s
	iters: 900, epoch: 1 | loss: 0.2537445
	speed: 0.0350s/iter; left time: 368.3770s
	iters: 1000, epoch: 1 | loss: 0.2977180
	speed: 0.0352s/iter; left time: 367.6648s
	iters: 1100, epoch: 1 | loss: 0.2680886
	speed: 0.0347s/iter; left time: 358.9502s
Epoch: 1 cost time: 42.625693798065186
Epoch: 1, Steps: 1143 | Train Loss: 0.4393037 Vali Loss: 0.5552095 Test Loss: 0.5481512
Validation loss decreased (inf --> 0.555209).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3155446
	speed: 0.1112s/iter; left time: 1132.5458s
	iters: 200, epoch: 2 | loss: 0.4761582
	speed: 0.0339s/iter; left time: 341.9182s
	iters: 300, epoch: 2 | loss: 0.3285724
	speed: 0.0337s/iter; left time: 336.5240s
	iters: 400, epoch: 2 | loss: 0.2759737
	speed: 0.0336s/iter; left time: 332.7125s
	iters: 500, epoch: 2 | loss: 0.3029949
	speed: 0.0337s/iter; left time: 329.7378s
	iters: 600, epoch: 2 | loss: 0.2190878
	speed: 0.0340s/iter; left time: 329.6305s
	iters: 700, epoch: 2 | loss: 0.6388879
	speed: 0.0340s/iter; left time: 325.6351s
	iters: 800, epoch: 2 | loss: 0.6631020
	speed: 0.0338s/iter; left time: 320.4836s
	iters: 900, epoch: 2 | loss: 0.2605255
	speed: 0.0336s/iter; left time: 315.4184s
	iters: 1000, epoch: 2 | loss: 0.2708279
	speed: 0.0336s/iter; left time: 312.4819s
	iters: 1100, epoch: 2 | loss: 0.2068952
	speed: 0.0336s/iter; left time: 308.5162s
Epoch: 2 cost time: 38.61141347885132
Epoch: 2, Steps: 1143 | Train Loss: 0.3429346 Vali Loss: 0.5324517 Test Loss: 0.4618619
Validation loss decreased (0.555209 --> 0.532452).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5223029
	speed: 0.1106s/iter; left time: 1000.7220s
	iters: 200, epoch: 3 | loss: 0.2390632
	speed: 0.0335s/iter; left time: 299.9060s
	iters: 300, epoch: 3 | loss: 0.2137609
	speed: 0.0335s/iter; left time: 296.1975s
	iters: 400, epoch: 3 | loss: 0.1589845
	speed: 0.0335s/iter; left time: 293.2713s
	iters: 500, epoch: 3 | loss: 0.2624444
	speed: 0.0335s/iter; left time: 289.7500s
	iters: 600, epoch: 3 | loss: 0.2552172
	speed: 0.0335s/iter; left time: 286.4173s
	iters: 700, epoch: 3 | loss: 0.3015767
	speed: 0.0334s/iter; left time: 282.2972s
	iters: 800, epoch: 3 | loss: 0.1982426
	speed: 0.0334s/iter; left time: 278.9998s
	iters: 900, epoch: 3 | loss: 0.2069877
	speed: 0.0334s/iter; left time: 275.1959s
	iters: 1000, epoch: 3 | loss: 0.1905583
	speed: 0.0334s/iter; left time: 272.1862s
	iters: 1100, epoch: 3 | loss: 0.2103200
	speed: 0.0335s/iter; left time: 269.1127s
Epoch: 3 cost time: 38.35677671432495
Epoch: 3, Steps: 1143 | Train Loss: 0.2769196 Vali Loss: 0.5511268 Test Loss: 0.4174307
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4690298
	speed: 0.1118s/iter; left time: 883.2833s
	iters: 200, epoch: 4 | loss: 0.2151121
	speed: 0.0351s/iter; left time: 274.0820s
	iters: 300, epoch: 4 | loss: 0.1467518
	speed: 0.0352s/iter; left time: 270.7973s
	iters: 400, epoch: 4 | loss: 0.1588320
	speed: 0.0352s/iter; left time: 267.9224s
	iters: 500, epoch: 4 | loss: 0.1513922
	speed: 0.0350s/iter; left time: 262.9095s
	iters: 600, epoch: 4 | loss: 0.1876650
	speed: 0.0351s/iter; left time: 259.5903s
	iters: 700, epoch: 4 | loss: 0.8727322
	speed: 0.0344s/iter; left time: 251.2532s
	iters: 800, epoch: 4 | loss: 0.1843565
	speed: 0.0336s/iter; left time: 241.6967s
	iters: 900, epoch: 4 | loss: 0.4735607
	speed: 0.0336s/iter; left time: 238.3292s
	iters: 1000, epoch: 4 | loss: 0.2053596
	speed: 0.0335s/iter; left time: 234.6962s
	iters: 1100, epoch: 4 | loss: 0.1730927
	speed: 0.0338s/iter; left time: 233.2726s
Epoch: 4 cost time: 39.45476269721985
Epoch: 4, Steps: 1143 | Train Loss: 0.2502251 Vali Loss: 0.5569833 Test Loss: 0.4167957
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4305976
	speed: 0.1085s/iter; left time: 733.1406s
	iters: 200, epoch: 5 | loss: 0.2452072
	speed: 0.0338s/iter; left time: 224.8392s
	iters: 300, epoch: 5 | loss: 0.4290410
	speed: 0.0336s/iter; left time: 220.5014s
	iters: 400, epoch: 5 | loss: 0.1358658
	speed: 0.0337s/iter; left time: 217.5258s
	iters: 500, epoch: 5 | loss: 0.1510218
	speed: 0.0337s/iter; left time: 214.1486s
	iters: 600, epoch: 5 | loss: 0.2084163
	speed: 0.0340s/iter; left time: 212.8469s
	iters: 700, epoch: 5 | loss: 0.3323344
	speed: 0.0339s/iter; left time: 208.5288s
	iters: 800, epoch: 5 | loss: 0.4628213
	speed: 0.0339s/iter; left time: 205.3209s
	iters: 900, epoch: 5 | loss: 0.2752701
	speed: 0.0337s/iter; left time: 200.7506s
	iters: 1000, epoch: 5 | loss: 0.4719870
	speed: 0.0336s/iter; left time: 197.1309s
	iters: 1100, epoch: 5 | loss: 0.1907291
	speed: 0.0337s/iter; left time: 193.9512s
Epoch: 5 cost time: 38.5780074596405
Epoch: 5, Steps: 1143 | Train Loss: 0.2384483 Vali Loss: 0.5574444 Test Loss: 0.4143225
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : weather_192_Informer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed15349<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10348
mse:0.4621686041355133, mae:0.4811115860939026
