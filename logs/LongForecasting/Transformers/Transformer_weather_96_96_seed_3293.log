Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=21, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=21, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Transformer', model_id='weather_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=96, root_path='./dataset/', seed=3293, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_96_Transformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed3293>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36696
val 5175
test 10444
	iters: 100, epoch: 1 | loss: 0.3389332
	speed: 0.0554s/iter; left time: 628.9658s
	iters: 200, epoch: 1 | loss: 0.3430680
	speed: 0.0253s/iter; left time: 285.0321s
	iters: 300, epoch: 1 | loss: 0.4235332
	speed: 0.0253s/iter; left time: 282.7752s
	iters: 400, epoch: 1 | loss: 1.1860253
	speed: 0.0253s/iter; left time: 280.3564s
	iters: 500, epoch: 1 | loss: 0.2893268
	speed: 0.0253s/iter; left time: 277.8428s
	iters: 600, epoch: 1 | loss: 0.2448242
	speed: 0.0254s/iter; left time: 275.3483s
	iters: 700, epoch: 1 | loss: 0.1875968
	speed: 0.0253s/iter; left time: 271.7654s
	iters: 800, epoch: 1 | loss: 0.2412422
	speed: 0.0252s/iter; left time: 268.8880s
	iters: 900, epoch: 1 | loss: 0.2531631
	speed: 0.0252s/iter; left time: 266.1028s
	iters: 1000, epoch: 1 | loss: 0.1529970
	speed: 0.0252s/iter; left time: 263.9850s
	iters: 1100, epoch: 1 | loss: 0.1582759
	speed: 0.0253s/iter; left time: 262.2278s
Epoch: 1 cost time: 31.997553825378418
Epoch: 1, Steps: 1146 | Train Loss: 0.3563695 Vali Loss: 0.5638846 Test Loss: 0.4666199
Validation loss decreased (inf --> 0.563885).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2085117
	speed: 0.0788s/iter; left time: 805.2175s
	iters: 200, epoch: 2 | loss: 0.1733880
	speed: 0.0254s/iter; left time: 256.5381s
	iters: 300, epoch: 2 | loss: 0.1551539
	speed: 0.0253s/iter; left time: 253.3213s
	iters: 400, epoch: 2 | loss: 0.9053633
	speed: 0.0252s/iter; left time: 250.2521s
	iters: 500, epoch: 2 | loss: 0.1391047
	speed: 0.0252s/iter; left time: 247.6704s
	iters: 600, epoch: 2 | loss: 0.8237067
	speed: 0.0253s/iter; left time: 245.4580s
	iters: 700, epoch: 2 | loss: 0.1429651
	speed: 0.0252s/iter; left time: 242.5278s
	iters: 800, epoch: 2 | loss: 0.1890094
	speed: 0.0252s/iter; left time: 239.6747s
	iters: 900, epoch: 2 | loss: 0.2234859
	speed: 0.0252s/iter; left time: 237.5178s
	iters: 1000, epoch: 2 | loss: 0.1240626
	speed: 0.0253s/iter; left time: 235.8317s
	iters: 1100, epoch: 2 | loss: 0.1312595
	speed: 0.0253s/iter; left time: 233.2488s
Epoch: 2 cost time: 28.96158194541931
Epoch: 2, Steps: 1146 | Train Loss: 0.2541233 Vali Loss: 0.5303073 Test Loss: 0.4506927
Validation loss decreased (0.563885 --> 0.530307).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1413193
	speed: 0.0781s/iter; left time: 708.3243s
	iters: 200, epoch: 3 | loss: 0.1145463
	speed: 0.0253s/iter; left time: 226.8442s
	iters: 300, epoch: 3 | loss: 0.1299694
	speed: 0.0252s/iter; left time: 223.4282s
	iters: 400, epoch: 3 | loss: 0.1194647
	speed: 0.0252s/iter; left time: 220.9247s
	iters: 500, epoch: 3 | loss: 0.1157313
	speed: 0.0252s/iter; left time: 218.5872s
	iters: 600, epoch: 3 | loss: 0.3038037
	speed: 0.0253s/iter; left time: 216.4677s
	iters: 700, epoch: 3 | loss: 0.2273158
	speed: 0.0253s/iter; left time: 213.9562s
	iters: 800, epoch: 3 | loss: 0.1467030
	speed: 0.0252s/iter; left time: 211.2856s
	iters: 900, epoch: 3 | loss: 0.0915451
	speed: 0.0253s/iter; left time: 208.9081s
	iters: 1000, epoch: 3 | loss: 0.1497132
	speed: 0.0253s/iter; left time: 206.4433s
	iters: 1100, epoch: 3 | loss: 0.2253722
	speed: 0.0252s/iter; left time: 203.5843s
Epoch: 3 cost time: 28.930651426315308
Epoch: 3, Steps: 1146 | Train Loss: 0.2090917 Vali Loss: 0.5545181 Test Loss: 0.5077611
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1602261
	speed: 0.0754s/iter; left time: 597.0345s
	iters: 200, epoch: 4 | loss: 0.1587868
	speed: 0.0252s/iter; left time: 197.2574s
	iters: 300, epoch: 4 | loss: 0.1704269
	speed: 0.0252s/iter; left time: 194.7568s
	iters: 400, epoch: 4 | loss: 0.1084372
	speed: 0.0252s/iter; left time: 192.2310s
	iters: 500, epoch: 4 | loss: 0.1294494
	speed: 0.0252s/iter; left time: 189.5668s
	iters: 600, epoch: 4 | loss: 0.1622150
	speed: 0.0251s/iter; left time: 186.6665s
	iters: 700, epoch: 4 | loss: 0.1328359
	speed: 0.0251s/iter; left time: 183.9770s
	iters: 800, epoch: 4 | loss: 0.1587796
	speed: 0.0251s/iter; left time: 181.5993s
	iters: 900, epoch: 4 | loss: 0.7189665
	speed: 0.0251s/iter; left time: 179.0853s
	iters: 1000, epoch: 4 | loss: 0.0836287
	speed: 0.0251s/iter; left time: 176.4549s
	iters: 1100, epoch: 4 | loss: 0.1461498
	speed: 0.0252s/iter; left time: 174.7641s
Epoch: 4 cost time: 28.85254955291748
Epoch: 4, Steps: 1146 | Train Loss: 0.1886109 Vali Loss: 0.5552784 Test Loss: 0.5371494
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1324808
	speed: 0.0753s/iter; left time: 510.3873s
	iters: 200, epoch: 5 | loss: 0.0927900
	speed: 0.0251s/iter; left time: 167.8103s
	iters: 300, epoch: 5 | loss: 0.1483877
	speed: 0.0251s/iter; left time: 165.3202s
	iters: 400, epoch: 5 | loss: 0.0943783
	speed: 0.0252s/iter; left time: 163.0664s
	iters: 500, epoch: 5 | loss: 0.1521630
	speed: 0.0252s/iter; left time: 160.8582s
	iters: 600, epoch: 5 | loss: 0.0917166
	speed: 0.0252s/iter; left time: 158.2814s
	iters: 700, epoch: 5 | loss: 0.1179345
	speed: 0.0253s/iter; left time: 156.0742s
	iters: 800, epoch: 5 | loss: 0.0834479
	speed: 0.0253s/iter; left time: 153.5396s
	iters: 900, epoch: 5 | loss: 0.1520140
	speed: 0.0252s/iter; left time: 150.6748s
	iters: 1000, epoch: 5 | loss: 0.0888353
	speed: 0.0252s/iter; left time: 148.3240s
	iters: 1100, epoch: 5 | loss: 0.1285761
	speed: 0.0253s/iter; left time: 145.9023s
Epoch: 5 cost time: 28.879221439361572
Epoch: 5, Steps: 1146 | Train Loss: 0.1782204 Vali Loss: 0.5497551 Test Loss: 0.5497156
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : weather_96_Transformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed3293<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
mse:0.4500182867050171, mae:0.4716220498085022
