Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Autoformer', model_id='ETTm2_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=336, root_path='./dataset/', seed=28649, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm2_336_Autoformer_ETTm2_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed28649>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34129
val 11185
test 11185
	iters: 100, epoch: 1 | loss: 0.3062470
	speed: 0.1163s/iter; left time: 1228.4103s
	iters: 200, epoch: 1 | loss: 0.5835754
	speed: 0.0822s/iter; left time: 860.1837s
	iters: 300, epoch: 1 | loss: 0.2777423
	speed: 0.0829s/iter; left time: 858.7052s
	iters: 400, epoch: 1 | loss: 0.2957954
	speed: 0.0828s/iter; left time: 849.9570s
	iters: 500, epoch: 1 | loss: 0.1947088
	speed: 0.0830s/iter; left time: 843.5957s
	iters: 600, epoch: 1 | loss: 0.4139265
	speed: 0.0828s/iter; left time: 833.0028s
	iters: 700, epoch: 1 | loss: 0.1885264
	speed: 0.0824s/iter; left time: 821.2054s
	iters: 800, epoch: 1 | loss: 0.3664418
	speed: 0.0825s/iter; left time: 813.2270s
	iters: 900, epoch: 1 | loss: 0.6104822
	speed: 0.0825s/iter; left time: 805.0295s
	iters: 1000, epoch: 1 | loss: 0.3564044
	speed: 0.0824s/iter; left time: 796.0175s
Epoch: 1 cost time: 91.47111463546753
Epoch: 1, Steps: 1066 | Train Loss: 0.4487665 Vali Loss: 0.2480988 Test Loss: 0.3531995
Validation loss decreased (inf --> 0.248099).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4155523
	speed: 0.5144s/iter; left time: 4884.1224s
	iters: 200, epoch: 2 | loss: 0.4284025
	speed: 0.0827s/iter; left time: 776.9790s
	iters: 300, epoch: 2 | loss: 0.6745330
	speed: 0.0829s/iter; left time: 770.6436s
	iters: 400, epoch: 2 | loss: 0.4673216
	speed: 0.0829s/iter; left time: 761.9288s
	iters: 500, epoch: 2 | loss: 0.2560145
	speed: 0.0828s/iter; left time: 753.0782s
	iters: 600, epoch: 2 | loss: 0.1710804
	speed: 0.0824s/iter; left time: 741.3148s
	iters: 700, epoch: 2 | loss: 0.4577307
	speed: 0.0824s/iter; left time: 732.8500s
	iters: 800, epoch: 2 | loss: 0.3056490
	speed: 0.0823s/iter; left time: 724.2188s
	iters: 900, epoch: 2 | loss: 0.2631929
	speed: 0.0825s/iter; left time: 716.9302s
	iters: 1000, epoch: 2 | loss: 0.3961523
	speed: 0.0825s/iter; left time: 709.0699s
Epoch: 2 cost time: 88.00422525405884
Epoch: 2, Steps: 1066 | Train Loss: 0.4182395 Vali Loss: 0.2493567 Test Loss: 0.3441088
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3236060
	speed: 0.5136s/iter; left time: 4329.5265s
	iters: 200, epoch: 3 | loss: 0.5209037
	speed: 0.0828s/iter; left time: 690.0138s
	iters: 300, epoch: 3 | loss: 0.2826147
	speed: 0.0827s/iter; left time: 680.8113s
	iters: 400, epoch: 3 | loss: 0.4916312
	speed: 0.0829s/iter; left time: 673.8126s
	iters: 500, epoch: 3 | loss: 0.2220666
	speed: 0.0825s/iter; left time: 662.7503s
	iters: 600, epoch: 3 | loss: 0.5156937
	speed: 0.0824s/iter; left time: 653.6863s
	iters: 700, epoch: 3 | loss: 0.5306637
	speed: 0.0825s/iter; left time: 645.7494s
	iters: 800, epoch: 3 | loss: 0.1826842
	speed: 0.0825s/iter; left time: 637.6649s
	iters: 900, epoch: 3 | loss: 0.4034194
	speed: 0.0824s/iter; left time: 628.7334s
	iters: 1000, epoch: 3 | loss: 0.2090245
	speed: 0.0825s/iter; left time: 621.1673s
Epoch: 3 cost time: 88.03134775161743
Epoch: 3, Steps: 1066 | Train Loss: 0.3593481 Vali Loss: 0.2396519 Test Loss: 0.3451211
Validation loss decreased (0.248099 --> 0.239652).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2618152
	speed: 0.5160s/iter; left time: 3799.4444s
	iters: 200, epoch: 4 | loss: 0.5097481
	speed: 0.0827s/iter; left time: 600.8557s
	iters: 300, epoch: 4 | loss: 0.3675102
	speed: 0.0828s/iter; left time: 593.0507s
	iters: 400, epoch: 4 | loss: 0.5594000
	speed: 0.0827s/iter; left time: 584.3198s
	iters: 500, epoch: 4 | loss: 0.1957346
	speed: 0.0823s/iter; left time: 573.2424s
	iters: 600, epoch: 4 | loss: 0.2743347
	speed: 0.0824s/iter; left time: 565.3147s
	iters: 700, epoch: 4 | loss: 0.4325605
	speed: 0.0824s/iter; left time: 557.4623s
	iters: 800, epoch: 4 | loss: 0.3546995
	speed: 0.0823s/iter; left time: 548.5611s
	iters: 900, epoch: 4 | loss: 0.5881045
	speed: 0.0826s/iter; left time: 541.8008s
	iters: 1000, epoch: 4 | loss: 0.4580390
	speed: 0.0824s/iter; left time: 532.6162s
Epoch: 4 cost time: 88.00598692893982
Epoch: 4, Steps: 1066 | Train Loss: 0.3373463 Vali Loss: 0.2514628 Test Loss: 0.3554132
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2081745
	speed: 0.5137s/iter; left time: 3234.9548s
	iters: 200, epoch: 5 | loss: 0.3339523
	speed: 0.0828s/iter; left time: 513.1911s
	iters: 300, epoch: 5 | loss: 0.3235036
	speed: 0.0827s/iter; left time: 504.2090s
	iters: 400, epoch: 5 | loss: 0.2182091
	speed: 0.0825s/iter; left time: 494.6000s
	iters: 500, epoch: 5 | loss: 0.2111370
	speed: 0.0825s/iter; left time: 486.4598s
	iters: 600, epoch: 5 | loss: 0.1882747
	speed: 0.0823s/iter; left time: 477.3599s
	iters: 700, epoch: 5 | loss: 0.2872083
	speed: 0.0824s/iter; left time: 469.6463s
	iters: 800, epoch: 5 | loss: 0.2378960
	speed: 0.0825s/iter; left time: 461.4861s
	iters: 900, epoch: 5 | loss: 0.3132825
	speed: 0.0825s/iter; left time: 453.6665s
	iters: 1000, epoch: 5 | loss: 0.1353768
	speed: 0.0826s/iter; left time: 445.8074s
Epoch: 5 cost time: 87.99891209602356
Epoch: 5, Steps: 1066 | Train Loss: 0.3278759 Vali Loss: 0.2521809 Test Loss: 0.3550746
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3496533
	speed: 0.5148s/iter; left time: 2692.7332s
	iters: 200, epoch: 6 | loss: 0.2831868
	speed: 0.0827s/iter; left time: 424.5667s
	iters: 300, epoch: 6 | loss: 0.4364695
	speed: 0.0826s/iter; left time: 415.6829s
	iters: 400, epoch: 6 | loss: 0.1943339
	speed: 0.0825s/iter; left time: 406.9702s
	iters: 500, epoch: 6 | loss: 0.3097382
	speed: 0.0825s/iter; left time: 398.4516s
	iters: 600, epoch: 6 | loss: 0.2538012
	speed: 0.0825s/iter; left time: 390.2004s
	iters: 700, epoch: 6 | loss: 0.2519042
	speed: 0.0825s/iter; left time: 382.2409s
	iters: 800, epoch: 6 | loss: 0.3310780
	speed: 0.0825s/iter; left time: 373.7219s
	iters: 900, epoch: 6 | loss: 0.2358504
	speed: 0.0824s/iter; left time: 365.3126s
	iters: 1000, epoch: 6 | loss: 0.1960911
	speed: 0.0824s/iter; left time: 356.8642s
Epoch: 6 cost time: 87.99972105026245
Epoch: 6, Steps: 1066 | Train Loss: 0.3252242 Vali Loss: 0.2610163 Test Loss: 0.3648541
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : ETTm2_336_Autoformer_ETTm2_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed28649<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
mse:0.34541264176368713, mae:0.37762004137039185
