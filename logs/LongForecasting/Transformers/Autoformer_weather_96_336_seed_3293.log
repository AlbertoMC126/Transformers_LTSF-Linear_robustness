Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=21, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=21, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Autoformer', model_id='weather_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=336, root_path='./dataset/', seed=3293, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_336_Autoformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed3293>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36456
val 4935
test 10204
	iters: 100, epoch: 1 | loss: 0.9316415
	speed: 0.1178s/iter; left time: 1330.5702s
	iters: 200, epoch: 1 | loss: 0.6344988
	speed: 0.0832s/iter; left time: 931.4229s
	iters: 300, epoch: 1 | loss: 0.6454204
	speed: 0.0834s/iter; left time: 924.8555s
	iters: 400, epoch: 1 | loss: 0.6082786
	speed: 0.0834s/iter; left time: 916.1972s
	iters: 500, epoch: 1 | loss: 0.7265837
	speed: 0.0835s/iter; left time: 908.9888s
	iters: 600, epoch: 1 | loss: 1.2571379
	speed: 0.0836s/iter; left time: 902.4630s
	iters: 700, epoch: 1 | loss: 0.4950039
	speed: 0.0837s/iter; left time: 894.5374s
	iters: 800, epoch: 1 | loss: 0.5284811
	speed: 0.0835s/iter; left time: 884.6452s
	iters: 900, epoch: 1 | loss: 0.5358776
	speed: 0.0836s/iter; left time: 876.7827s
	iters: 1000, epoch: 1 | loss: 0.7698537
	speed: 0.0834s/iter; left time: 866.8575s
	iters: 1100, epoch: 1 | loss: 0.8716585
	speed: 0.0833s/iter; left time: 857.1284s
Epoch: 1 cost time: 98.53692030906677
Epoch: 1, Steps: 1139 | Train Loss: 0.6993929 Vali Loss: 0.7171288 Test Loss: 0.3537949
Validation loss decreased (inf --> 0.717129).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6363711
	speed: 0.3900s/iter; left time: 3959.1244s
	iters: 200, epoch: 2 | loss: 0.5976950
	speed: 0.0833s/iter; left time: 837.5227s
	iters: 300, epoch: 2 | loss: 0.6427355
	speed: 0.0833s/iter; left time: 829.2869s
	iters: 400, epoch: 2 | loss: 1.2027433
	speed: 0.0832s/iter; left time: 819.9778s
	iters: 500, epoch: 2 | loss: 0.5544963
	speed: 0.0833s/iter; left time: 812.2181s
	iters: 600, epoch: 2 | loss: 0.6876937
	speed: 0.0834s/iter; left time: 804.8616s
	iters: 700, epoch: 2 | loss: 0.6450090
	speed: 0.0835s/iter; left time: 797.5697s
	iters: 800, epoch: 2 | loss: 0.5989242
	speed: 0.0834s/iter; left time: 787.9248s
	iters: 900, epoch: 2 | loss: 0.8124781
	speed: 0.0832s/iter; left time: 778.2810s
	iters: 1000, epoch: 2 | loss: 0.8713468
	speed: 0.0833s/iter; left time: 771.0919s
	iters: 1100, epoch: 2 | loss: 0.5813157
	speed: 0.0833s/iter; left time: 762.5529s
Epoch: 2 cost time: 94.90053200721741
Epoch: 2, Steps: 1139 | Train Loss: 0.6516743 Vali Loss: 0.7133567 Test Loss: 0.3519338
Validation loss decreased (0.717129 --> 0.713357).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.8273619
	speed: 0.3913s/iter; left time: 3526.8077s
	iters: 200, epoch: 3 | loss: 0.4409340
	speed: 0.0837s/iter; left time: 745.8802s
	iters: 300, epoch: 3 | loss: 0.4889057
	speed: 0.0838s/iter; left time: 738.4382s
	iters: 400, epoch: 3 | loss: 0.6893827
	speed: 0.0838s/iter; left time: 730.3060s
	iters: 500, epoch: 3 | loss: 0.4674678
	speed: 0.0836s/iter; left time: 720.2185s
	iters: 600, epoch: 3 | loss: 0.6723577
	speed: 0.0837s/iter; left time: 712.7860s
	iters: 700, epoch: 3 | loss: 0.7713377
	speed: 0.0836s/iter; left time: 703.3906s
	iters: 800, epoch: 3 | loss: 0.5318155
	speed: 0.0834s/iter; left time: 693.5604s
	iters: 900, epoch: 3 | loss: 0.9303890
	speed: 0.0835s/iter; left time: 686.1677s
	iters: 1000, epoch: 3 | loss: 0.5019269
	speed: 0.0836s/iter; left time: 678.3770s
	iters: 1100, epoch: 3 | loss: 0.5813328
	speed: 0.0835s/iter; left time: 668.8372s
Epoch: 3 cost time: 95.23180532455444
Epoch: 3, Steps: 1139 | Train Loss: 0.6340943 Vali Loss: 0.7161502 Test Loss: 0.3520286
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.6358491
	speed: 0.3880s/iter; left time: 3055.0397s
	iters: 200, epoch: 4 | loss: 0.5449226
	speed: 0.0833s/iter; left time: 647.2823s
	iters: 300, epoch: 4 | loss: 0.6020384
	speed: 0.0834s/iter; left time: 639.7292s
	iters: 400, epoch: 4 | loss: 0.4905438
	speed: 0.0834s/iter; left time: 631.7189s
	iters: 500, epoch: 4 | loss: 0.5779288
	speed: 0.0834s/iter; left time: 623.5372s
	iters: 600, epoch: 4 | loss: 0.9732380
	speed: 0.0835s/iter; left time: 615.7544s
	iters: 700, epoch: 4 | loss: 0.6133187
	speed: 0.0833s/iter; left time: 605.9343s
	iters: 800, epoch: 4 | loss: 0.4995256
	speed: 0.0833s/iter; left time: 597.5161s
	iters: 900, epoch: 4 | loss: 0.6086228
	speed: 0.0832s/iter; left time: 588.2181s
	iters: 1000, epoch: 4 | loss: 0.4464525
	speed: 0.0831s/iter; left time: 579.8345s
	iters: 1100, epoch: 4 | loss: 0.5028954
	speed: 0.0831s/iter; left time: 571.2346s
Epoch: 4 cost time: 94.85127329826355
Epoch: 4, Steps: 1139 | Train Loss: 0.6222063 Vali Loss: 0.7144638 Test Loss: 0.3502194
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.5849873
	speed: 0.3886s/iter; left time: 2616.9546s
	iters: 200, epoch: 5 | loss: 0.4964330
	speed: 0.0832s/iter; left time: 551.7463s
	iters: 300, epoch: 5 | loss: 0.5124644
	speed: 0.0831s/iter; left time: 542.9410s
	iters: 400, epoch: 5 | loss: 0.6461109
	speed: 0.0831s/iter; left time: 534.9973s
	iters: 500, epoch: 5 | loss: 0.5085795
	speed: 0.0832s/iter; left time: 526.8879s
	iters: 600, epoch: 5 | loss: 0.5773492
	speed: 0.0834s/iter; left time: 519.7273s
	iters: 700, epoch: 5 | loss: 0.5010476
	speed: 0.0833s/iter; left time: 511.2871s
	iters: 800, epoch: 5 | loss: 0.4920290
	speed: 0.0832s/iter; left time: 502.3318s
	iters: 900, epoch: 5 | loss: 0.6110627
	speed: 0.0831s/iter; left time: 493.4609s
	iters: 1000, epoch: 5 | loss: 0.5126795
	speed: 0.0831s/iter; left time: 484.9464s
	iters: 1100, epoch: 5 | loss: 0.6424797
	speed: 0.0832s/iter; left time: 477.3775s
Epoch: 5 cost time: 94.76169347763062
Epoch: 5, Steps: 1139 | Train Loss: 0.6163511 Vali Loss: 0.7137785 Test Loss: 0.3563885
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : weather_336_Autoformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed3293<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10204
mse:0.351960688829422, mae:0.38693806529045105
