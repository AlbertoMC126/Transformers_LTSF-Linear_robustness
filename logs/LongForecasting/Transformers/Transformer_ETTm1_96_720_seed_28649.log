Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm1', data_path='ETTm1.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Transformer', model_id='ETTm1_720', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=720, root_path='./dataset/', seed=28649, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm1_720_Transformer_ETTm1_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed28649>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33745
val 10801
test 10801
	iters: 100, epoch: 1 | loss: 0.4350813
	speed: 0.1223s/iter; left time: 1276.8873s
	iters: 200, epoch: 1 | loss: 0.4200436
	speed: 0.0918s/iter; left time: 949.0582s
	iters: 300, epoch: 1 | loss: 0.3438243
	speed: 0.0917s/iter; left time: 938.8793s
	iters: 400, epoch: 1 | loss: 0.3575667
	speed: 0.0917s/iter; left time: 929.7718s
	iters: 500, epoch: 1 | loss: 0.3182898
	speed: 0.0919s/iter; left time: 922.2877s
	iters: 600, epoch: 1 | loss: 0.3039060
	speed: 0.0923s/iter; left time: 917.2678s
	iters: 700, epoch: 1 | loss: 0.2679601
	speed: 0.0925s/iter; left time: 910.5796s
	iters: 800, epoch: 1 | loss: 0.2727150
	speed: 0.0924s/iter; left time: 899.6098s
	iters: 900, epoch: 1 | loss: 0.2381784
	speed: 0.0919s/iter; left time: 886.3302s
	iters: 1000, epoch: 1 | loss: 0.2316370
	speed: 0.0918s/iter; left time: 875.9343s
Epoch: 1 cost time: 99.98614430427551
Epoch: 1, Steps: 1054 | Train Loss: 0.3386028 Vali Loss: 1.1930656 Test Loss: 1.1155297
Validation loss decreased (inf --> 1.193066).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2244506
	speed: 0.3697s/iter; left time: 3470.5255s
	iters: 200, epoch: 2 | loss: 0.2270505
	speed: 0.0919s/iter; left time: 853.3557s
	iters: 300, epoch: 2 | loss: 0.2192410
	speed: 0.0919s/iter; left time: 843.8672s
	iters: 400, epoch: 2 | loss: 0.1956118
	speed: 0.0920s/iter; left time: 835.5958s
	iters: 500, epoch: 2 | loss: 0.2007126
	speed: 0.0920s/iter; left time: 827.0854s
	iters: 600, epoch: 2 | loss: 0.1942952
	speed: 0.0924s/iter; left time: 820.9867s
	iters: 700, epoch: 2 | loss: 0.1710059
	speed: 0.0925s/iter; left time: 812.4697s
	iters: 800, epoch: 2 | loss: 0.1643463
	speed: 0.0924s/iter; left time: 802.7823s
	iters: 900, epoch: 2 | loss: 0.1760540
	speed: 0.0919s/iter; left time: 789.3722s
	iters: 1000, epoch: 2 | loss: 0.1585005
	speed: 0.0918s/iter; left time: 779.5268s
Epoch: 2 cost time: 96.97684359550476
Epoch: 2, Steps: 1054 | Train Loss: 0.1957862 Vali Loss: 1.2349262 Test Loss: 0.9910010
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1489438
	speed: 0.3661s/iter; left time: 3050.4826s
	iters: 200, epoch: 3 | loss: 0.1439285
	speed: 0.0920s/iter; left time: 757.0963s
	iters: 300, epoch: 3 | loss: 0.1440567
	speed: 0.0919s/iter; left time: 747.1466s
	iters: 400, epoch: 3 | loss: 0.1399350
	speed: 0.0919s/iter; left time: 737.8673s
	iters: 500, epoch: 3 | loss: 0.1299956
	speed: 0.0923s/iter; left time: 732.4116s
	iters: 600, epoch: 3 | loss: 0.1380716
	speed: 0.0924s/iter; left time: 723.3915s
	iters: 700, epoch: 3 | loss: 0.1305881
	speed: 0.0923s/iter; left time: 713.8697s
	iters: 800, epoch: 3 | loss: 0.1341900
	speed: 0.0924s/iter; left time: 705.2293s
	iters: 900, epoch: 3 | loss: 0.1309241
	speed: 0.0921s/iter; left time: 694.0305s
	iters: 1000, epoch: 3 | loss: 0.1228870
	speed: 0.0917s/iter; left time: 681.6277s
Epoch: 3 cost time: 96.98106050491333
Epoch: 3, Steps: 1054 | Train Loss: 0.1387943 Vali Loss: 1.2112674 Test Loss: 0.9723819
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1165868
	speed: 0.3662s/iter; left time: 2665.2310s
	iters: 200, epoch: 4 | loss: 0.1254652
	speed: 0.0921s/iter; left time: 661.0932s
	iters: 300, epoch: 4 | loss: 0.1230254
	speed: 0.0919s/iter; left time: 650.8209s
	iters: 400, epoch: 4 | loss: 0.1165664
	speed: 0.0919s/iter; left time: 641.5534s
	iters: 500, epoch: 4 | loss: 0.1138261
	speed: 0.0920s/iter; left time: 632.9571s
	iters: 600, epoch: 4 | loss: 0.1116483
	speed: 0.0924s/iter; left time: 626.3372s
	iters: 700, epoch: 4 | loss: 0.1183685
	speed: 0.0925s/iter; left time: 617.9402s
	iters: 800, epoch: 4 | loss: 0.1104211
	speed: 0.0925s/iter; left time: 608.7838s
	iters: 900, epoch: 4 | loss: 0.1039256
	speed: 0.0922s/iter; left time: 597.1465s
	iters: 1000, epoch: 4 | loss: 0.1156982
	speed: 0.0921s/iter; left time: 587.1900s
Epoch: 4 cost time: 97.11939287185669
Epoch: 4, Steps: 1054 | Train Loss: 0.1152870 Vali Loss: 1.2185750 Test Loss: 0.9638479
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : ETTm1_720_Transformer_ETTm1_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed28649<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10801
mse:1.1158770322799683, mae:0.8254201412200928
