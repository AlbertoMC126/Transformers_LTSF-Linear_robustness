Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=321, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', dec_in=321, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Informer', model_id='electricity_720', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=720, root_path='./dataset/', seed=3144, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : electricity_720_Informer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed3144>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17597
val 1913
test 4541
	iters: 100, epoch: 1 | loss: 0.8410599
	speed: 0.1239s/iter; left time: 668.1202s
	iters: 200, epoch: 1 | loss: 0.7969375
	speed: 0.0934s/iter; left time: 494.2923s
	iters: 300, epoch: 1 | loss: 0.8108579
	speed: 0.0937s/iter; left time: 486.5973s
	iters: 400, epoch: 1 | loss: 0.7544085
	speed: 0.0927s/iter; left time: 471.7540s
	iters: 500, epoch: 1 | loss: 0.7795289
	speed: 0.0926s/iter; left time: 462.1262s
Epoch: 1 cost time: 54.20686316490173
Epoch: 1, Steps: 549 | Train Loss: 0.8171766 Vali Loss: 0.7663950 Test Loss: 0.8893640
Validation loss decreased (inf --> 0.766395).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.7375514
	speed: 0.2956s/iter; left time: 1431.0639s
	iters: 200, epoch: 2 | loss: 0.7689761
	speed: 0.0927s/iter; left time: 439.6247s
	iters: 300, epoch: 2 | loss: 0.6891375
	speed: 0.0926s/iter; left time: 429.7836s
	iters: 400, epoch: 2 | loss: 0.6078697
	speed: 0.0926s/iter; left time: 420.6205s
	iters: 500, epoch: 2 | loss: 0.4845772
	speed: 0.0928s/iter; left time: 412.3163s
Epoch: 2 cost time: 50.85401511192322
Epoch: 2, Steps: 549 | Train Loss: 0.6716217 Vali Loss: 0.4923035 Test Loss: 0.5406870
Validation loss decreased (0.766395 --> 0.492303).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3466249
	speed: 0.2972s/iter; left time: 1276.0472s
	iters: 200, epoch: 3 | loss: 0.3109953
	speed: 0.0940s/iter; left time: 394.0870s
	iters: 300, epoch: 3 | loss: 0.3078605
	speed: 0.0925s/iter; left time: 378.8061s
	iters: 400, epoch: 3 | loss: 0.2796495
	speed: 0.0926s/iter; left time: 369.6999s
	iters: 500, epoch: 3 | loss: 0.2853940
	speed: 0.0926s/iter; left time: 360.5115s
Epoch: 3 cost time: 51.1197452545166
Epoch: 3, Steps: 549 | Train Loss: 0.3072686 Vali Loss: 0.3709199 Test Loss: 0.4246915
Validation loss decreased (0.492303 --> 0.370920).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2585537
	speed: 0.2943s/iter; left time: 1101.7747s
	iters: 200, epoch: 4 | loss: 0.2428851
	speed: 0.0924s/iter; left time: 336.6927s
	iters: 300, epoch: 4 | loss: 0.2423691
	speed: 0.0926s/iter; left time: 328.1031s
	iters: 400, epoch: 4 | loss: 0.2415205
	speed: 0.0925s/iter; left time: 318.4879s
	iters: 500, epoch: 4 | loss: 0.2313950
	speed: 0.0936s/iter; left time: 313.0685s
Epoch: 4 cost time: 51.031381130218506
Epoch: 4, Steps: 549 | Train Loss: 0.2465960 Vali Loss: 0.3446185 Test Loss: 0.4049626
Validation loss decreased (0.370920 --> 0.344619).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2560801
	speed: 0.2990s/iter; left time: 955.3092s
	iters: 200, epoch: 5 | loss: 0.2260860
	speed: 0.0927s/iter; left time: 286.9744s
	iters: 300, epoch: 5 | loss: 0.2358634
	speed: 0.0928s/iter; left time: 278.0171s
	iters: 400, epoch: 5 | loss: 0.2245763
	speed: 0.0929s/iter; left time: 269.0348s
	iters: 500, epoch: 5 | loss: 0.2232469
	speed: 0.0927s/iter; left time: 259.2043s
Epoch: 5 cost time: 51.0282027721405
Epoch: 5, Steps: 549 | Train Loss: 0.2309372 Vali Loss: 0.3414570 Test Loss: 0.3938700
Validation loss decreased (0.344619 --> 0.341457).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2129509
	speed: 0.2952s/iter; left time: 781.2036s
	iters: 200, epoch: 6 | loss: 0.2220004
	speed: 0.0927s/iter; left time: 235.9690s
	iters: 300, epoch: 6 | loss: 0.2328663
	speed: 0.0927s/iter; left time: 226.6765s
	iters: 400, epoch: 6 | loss: 0.2219826
	speed: 0.0938s/iter; left time: 220.0407s
	iters: 500, epoch: 6 | loss: 0.2211380
	speed: 0.0939s/iter; left time: 210.8673s
Epoch: 6 cost time: 51.16484975814819
Epoch: 6, Steps: 549 | Train Loss: 0.2244697 Vali Loss: 0.3390624 Test Loss: 0.3903795
Validation loss decreased (0.341457 --> 0.339062).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2282881
	speed: 0.2954s/iter; left time: 619.4034s
	iters: 200, epoch: 7 | loss: 0.2247071
	speed: 0.0927s/iter; left time: 185.2180s
	iters: 300, epoch: 7 | loss: 0.2193223
	speed: 0.0928s/iter; left time: 176.0103s
	iters: 400, epoch: 7 | loss: 0.2249345
	speed: 0.0926s/iter; left time: 166.4079s
	iters: 500, epoch: 7 | loss: 0.2136776
	speed: 0.0928s/iter; left time: 157.3985s
Epoch: 7 cost time: 50.91699934005737
Epoch: 7, Steps: 549 | Train Loss: 0.2211892 Vali Loss: 0.3413191 Test Loss: 0.3895871
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2158381
	speed: 0.2927s/iter; left time: 453.1084s
	iters: 200, epoch: 8 | loss: 0.2198313
	speed: 0.0930s/iter; left time: 134.6514s
	iters: 300, epoch: 8 | loss: 0.2233358
	speed: 0.0936s/iter; left time: 126.2373s
	iters: 400, epoch: 8 | loss: 0.2233522
	speed: 0.0939s/iter; left time: 117.1421s
	iters: 500, epoch: 8 | loss: 0.2213447
	speed: 0.0934s/iter; left time: 107.2156s
Epoch: 8 cost time: 51.19647192955017
Epoch: 8, Steps: 549 | Train Loss: 0.2194811 Vali Loss: 0.3398699 Test Loss: 0.3878129
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2160870
	speed: 0.2916s/iter; left time: 291.3237s
	iters: 200, epoch: 9 | loss: 0.2198817
	speed: 0.0924s/iter; left time: 83.0299s
	iters: 300, epoch: 9 | loss: 0.2108350
	speed: 0.0924s/iter; left time: 73.8561s
	iters: 400, epoch: 9 | loss: 0.2182558
	speed: 0.0927s/iter; left time: 64.7893s
	iters: 500, epoch: 9 | loss: 0.2192566
	speed: 0.0926s/iter; left time: 55.4558s
Epoch: 9 cost time: 50.78158783912659
Epoch: 9, Steps: 549 | Train Loss: 0.2185703 Vali Loss: 0.3397351 Test Loss: 0.3879330
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : electricity_720_Informer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed3144<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4541
mse:0.3903156518936157, mae:0.454027384519577
