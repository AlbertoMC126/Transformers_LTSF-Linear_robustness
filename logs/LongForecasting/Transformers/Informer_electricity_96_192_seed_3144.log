Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=321, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', dec_in=321, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Informer', model_id='electricity_192', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=192, root_path='./dataset/', seed=3144, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : electricity_192_Informer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed3144>>>>>>>>>>>>>>>>>>>>>>>>>>
train 18125
val 2441
test 5069
	iters: 100, epoch: 1 | loss: 0.7444681
	speed: 0.0759s/iter; left time: 421.9781s
	iters: 200, epoch: 1 | loss: 0.6811107
	speed: 0.0448s/iter; left time: 244.6489s
	iters: 300, epoch: 1 | loss: 0.6164169
	speed: 0.0445s/iter; left time: 238.7782s
	iters: 400, epoch: 1 | loss: 0.4885501
	speed: 0.0445s/iter; left time: 234.3215s
	iters: 500, epoch: 1 | loss: 0.3635907
	speed: 0.0446s/iter; left time: 230.1581s
Epoch: 1 cost time: 28.396953344345093
Epoch: 1, Steps: 566 | Train Loss: 0.6179192 Vali Loss: 0.3580076 Test Loss: 0.4346395
Validation loss decreased (inf --> 0.358008).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2526256
	speed: 0.1466s/iter; left time: 732.4259s
	iters: 200, epoch: 2 | loss: 0.2425598
	speed: 0.0448s/iter; left time: 219.0974s
	iters: 300, epoch: 2 | loss: 0.2282046
	speed: 0.0446s/iter; left time: 213.8998s
	iters: 400, epoch: 2 | loss: 0.2264398
	speed: 0.0448s/iter; left time: 210.2020s
	iters: 500, epoch: 2 | loss: 0.1989587
	speed: 0.0468s/iter; left time: 214.9323s
Epoch: 2 cost time: 25.620429515838623
Epoch: 2, Steps: 566 | Train Loss: 0.2307859 Vali Loss: 0.2690388 Test Loss: 0.3591730
Validation loss decreased (0.358008 --> 0.269039).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1941267
	speed: 0.1500s/iter; left time: 664.2327s
	iters: 200, epoch: 3 | loss: 0.1946726
	speed: 0.0464s/iter; left time: 200.6787s
	iters: 300, epoch: 3 | loss: 0.1830641
	speed: 0.0465s/iter; left time: 196.7459s
	iters: 400, epoch: 3 | loss: 0.1839225
	speed: 0.0451s/iter; left time: 186.0328s
	iters: 500, epoch: 3 | loss: 0.1780927
	speed: 0.0447s/iter; left time: 180.2637s
Epoch: 3 cost time: 25.923216342926025
Epoch: 3, Steps: 566 | Train Loss: 0.1884830 Vali Loss: 0.2604630 Test Loss: 0.3523734
Validation loss decreased (0.269039 --> 0.260463).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1784211
	speed: 0.1462s/iter; left time: 564.7398s
	iters: 200, epoch: 4 | loss: 0.1952647
	speed: 0.0451s/iter; left time: 169.6690s
	iters: 300, epoch: 4 | loss: 0.1693578
	speed: 0.0450s/iter; left time: 165.0140s
	iters: 400, epoch: 4 | loss: 0.1669986
	speed: 0.0450s/iter; left time: 160.3232s
	iters: 500, epoch: 4 | loss: 0.1764347
	speed: 0.0451s/iter; left time: 156.3532s
Epoch: 4 cost time: 25.482139110565186
Epoch: 4, Steps: 566 | Train Loss: 0.1774640 Vali Loss: 0.2536957 Test Loss: 0.3477843
Validation loss decreased (0.260463 --> 0.253696).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1709078
	speed: 0.1467s/iter; left time: 483.6118s
	iters: 200, epoch: 5 | loss: 0.1627051
	speed: 0.0450s/iter; left time: 143.7790s
	iters: 300, epoch: 5 | loss: 0.1733496
	speed: 0.0451s/iter; left time: 139.5224s
	iters: 400, epoch: 5 | loss: 0.1711075
	speed: 0.0449s/iter; left time: 134.5986s
	iters: 500, epoch: 5 | loss: 0.1748500
	speed: 0.0449s/iter; left time: 130.1203s
Epoch: 5 cost time: 25.454782009124756
Epoch: 5, Steps: 566 | Train Loss: 0.1720710 Vali Loss: 0.2463898 Test Loss: 0.3443916
Validation loss decreased (0.253696 --> 0.246390).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1631387
	speed: 0.1472s/iter; left time: 402.0586s
	iters: 200, epoch: 6 | loss: 0.1690032
	speed: 0.0455s/iter; left time: 119.7613s
	iters: 300, epoch: 6 | loss: 0.1755343
	speed: 0.0461s/iter; left time: 116.5704s
	iters: 400, epoch: 6 | loss: 0.1713840
	speed: 0.0462s/iter; left time: 112.3290s
	iters: 500, epoch: 6 | loss: 0.1730480
	speed: 0.0460s/iter; left time: 107.2850s
Epoch: 6 cost time: 25.911845684051514
Epoch: 6, Steps: 566 | Train Loss: 0.1692787 Vali Loss: 0.2463297 Test Loss: 0.3455410
Validation loss decreased (0.246390 --> 0.246330).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1699942
	speed: 0.1492s/iter; left time: 322.9811s
	iters: 200, epoch: 7 | loss: 0.1785087
	speed: 0.0450s/iter; left time: 92.9262s
	iters: 300, epoch: 7 | loss: 0.1735650
	speed: 0.0450s/iter; left time: 88.3831s
	iters: 400, epoch: 7 | loss: 0.1617440
	speed: 0.0450s/iter; left time: 83.9944s
	iters: 500, epoch: 7 | loss: 0.1651272
	speed: 0.0448s/iter; left time: 79.1327s
Epoch: 7 cost time: 25.519229650497437
Epoch: 7, Steps: 566 | Train Loss: 0.1678125 Vali Loss: 0.2448673 Test Loss: 0.3432770
Validation loss decreased (0.246330 --> 0.244867).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1618124
	speed: 0.1466s/iter; left time: 234.4729s
	iters: 200, epoch: 8 | loss: 0.1712378
	speed: 0.0451s/iter; left time: 67.6556s
	iters: 300, epoch: 8 | loss: 0.1703551
	speed: 0.0451s/iter; left time: 63.0820s
	iters: 400, epoch: 8 | loss: 0.1608535
	speed: 0.0448s/iter; left time: 58.2290s
	iters: 500, epoch: 8 | loss: 0.1745508
	speed: 0.0448s/iter; left time: 53.7528s
Epoch: 8 cost time: 25.45329189300537
Epoch: 8, Steps: 566 | Train Loss: 0.1670825 Vali Loss: 0.2455311 Test Loss: 0.3453713
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1664313
	speed: 0.1435s/iter; left time: 148.2505s
	iters: 200, epoch: 9 | loss: 0.1671453
	speed: 0.0447s/iter; left time: 41.6621s
	iters: 300, epoch: 9 | loss: 0.1619279
	speed: 0.0447s/iter; left time: 37.2268s
	iters: 400, epoch: 9 | loss: 0.1723822
	speed: 0.0445s/iter; left time: 32.6341s
	iters: 500, epoch: 9 | loss: 0.1671115
	speed: 0.0446s/iter; left time: 28.2578s
Epoch: 9 cost time: 25.26381278038025
Epoch: 9, Steps: 566 | Train Loss: 0.1666672 Vali Loss: 0.2455208 Test Loss: 0.3444045
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1643379
	speed: 0.1453s/iter; left time: 67.8474s
	iters: 200, epoch: 10 | loss: 0.1589109
	speed: 0.0461s/iter; left time: 16.9290s
	iters: 300, epoch: 10 | loss: 0.1716904
	speed: 0.0462s/iter; left time: 12.3348s
	iters: 400, epoch: 10 | loss: 0.1632498
	speed: 0.0464s/iter; left time: 7.7487s
	iters: 500, epoch: 10 | loss: 0.1677513
	speed: 0.0461s/iter; left time: 3.0913s
Epoch: 10 cost time: 26.122025728225708
Epoch: 10, Steps: 566 | Train Loss: 0.1664580 Vali Loss: 0.2460579 Test Loss: 0.3459893
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : electricity_192_Informer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed3144<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5069
mse:0.341816246509552, mae:0.42464229464530945
