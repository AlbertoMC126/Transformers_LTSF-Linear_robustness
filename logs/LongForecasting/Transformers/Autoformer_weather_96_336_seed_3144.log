Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=21, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=21, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Autoformer', model_id='weather_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=336, root_path='./dataset/', seed=3144, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_336_Autoformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed3144>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36456
val 4935
test 10204
	iters: 100, epoch: 1 | loss: 0.8754928
	speed: 0.1172s/iter; left time: 1323.0304s
	iters: 200, epoch: 1 | loss: 0.5681065
	speed: 0.0833s/iter; left time: 931.9663s
	iters: 300, epoch: 1 | loss: 0.5434132
	speed: 0.0834s/iter; left time: 924.9853s
	iters: 400, epoch: 1 | loss: 0.6806124
	speed: 0.0836s/iter; left time: 918.4204s
	iters: 500, epoch: 1 | loss: 0.9040070
	speed: 0.0834s/iter; left time: 908.6535s
	iters: 600, epoch: 1 | loss: 0.8413013
	speed: 0.0838s/iter; left time: 903.7772s
	iters: 700, epoch: 1 | loss: 0.5332264
	speed: 0.0838s/iter; left time: 896.2359s
	iters: 800, epoch: 1 | loss: 1.0921457
	speed: 0.0837s/iter; left time: 886.8150s
	iters: 900, epoch: 1 | loss: 0.5700603
	speed: 0.0838s/iter; left time: 878.6955s
	iters: 1000, epoch: 1 | loss: 0.5514323
	speed: 0.0836s/iter; left time: 868.5230s
	iters: 1100, epoch: 1 | loss: 0.6313725
	speed: 0.0836s/iter; left time: 860.4824s
Epoch: 1 cost time: 98.61587882041931
Epoch: 1, Steps: 1139 | Train Loss: 0.6906922 Vali Loss: 0.7064539 Test Loss: 0.3621216
Validation loss decreased (inf --> 0.706454).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5356521
	speed: 0.3913s/iter; left time: 3972.2049s
	iters: 200, epoch: 2 | loss: 0.6696988
	speed: 0.0833s/iter; left time: 836.9973s
	iters: 300, epoch: 2 | loss: 0.8567664
	speed: 0.0832s/iter; left time: 828.3825s
	iters: 400, epoch: 2 | loss: 0.6228578
	speed: 0.0832s/iter; left time: 819.6500s
	iters: 500, epoch: 2 | loss: 0.6305780
	speed: 0.0833s/iter; left time: 812.7194s
	iters: 600, epoch: 2 | loss: 0.6401529
	speed: 0.0833s/iter; left time: 803.8332s
	iters: 700, epoch: 2 | loss: 0.4673981
	speed: 0.0834s/iter; left time: 797.0528s
	iters: 800, epoch: 2 | loss: 0.4786792
	speed: 0.0833s/iter; left time: 787.7479s
	iters: 900, epoch: 2 | loss: 0.6252477
	speed: 0.0835s/iter; left time: 780.8250s
	iters: 1000, epoch: 2 | loss: 0.5164814
	speed: 0.0836s/iter; left time: 773.0534s
	iters: 1100, epoch: 2 | loss: 0.5405144
	speed: 0.0836s/iter; left time: 764.7009s
Epoch: 2 cost time: 94.96650195121765
Epoch: 2, Steps: 1139 | Train Loss: 0.6409156 Vali Loss: 0.7004308 Test Loss: 0.3697369
Validation loss decreased (0.706454 --> 0.700431).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5498229
	speed: 0.3909s/iter; left time: 3523.2996s
	iters: 200, epoch: 3 | loss: 0.5244883
	speed: 0.0831s/iter; left time: 740.2729s
	iters: 300, epoch: 3 | loss: 0.4621283
	speed: 0.0831s/iter; left time: 732.2182s
	iters: 400, epoch: 3 | loss: 0.8340083
	speed: 0.0831s/iter; left time: 723.8343s
	iters: 500, epoch: 3 | loss: 0.5720280
	speed: 0.0831s/iter; left time: 716.0011s
	iters: 600, epoch: 3 | loss: 0.5928082
	speed: 0.0831s/iter; left time: 707.5740s
	iters: 700, epoch: 3 | loss: 0.5969306
	speed: 0.0831s/iter; left time: 698.7610s
	iters: 800, epoch: 3 | loss: 1.1044769
	speed: 0.0831s/iter; left time: 690.9956s
	iters: 900, epoch: 3 | loss: 0.5202776
	speed: 0.0833s/iter; left time: 683.9046s
	iters: 1000, epoch: 3 | loss: 0.5317087
	speed: 0.0834s/iter; left time: 676.5578s
	iters: 1100, epoch: 3 | loss: 0.6388515
	speed: 0.0834s/iter; left time: 667.9534s
Epoch: 3 cost time: 94.71309161186218
Epoch: 3, Steps: 1139 | Train Loss: 0.6200381 Vali Loss: 0.7119984 Test Loss: 0.3746541
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.5118989
	speed: 0.3885s/iter; left time: 3058.8707s
	iters: 200, epoch: 4 | loss: 0.5698161
	speed: 0.0834s/iter; left time: 648.3265s
	iters: 300, epoch: 4 | loss: 0.5791216
	speed: 0.0834s/iter; left time: 640.0595s
	iters: 400, epoch: 4 | loss: 1.0790209
	speed: 0.0834s/iter; left time: 631.5007s
	iters: 500, epoch: 4 | loss: 0.8831835
	speed: 0.0835s/iter; left time: 623.7869s
	iters: 600, epoch: 4 | loss: 0.5429910
	speed: 0.0835s/iter; left time: 615.8419s
	iters: 700, epoch: 4 | loss: 0.6377128
	speed: 0.0837s/iter; left time: 608.9939s
	iters: 800, epoch: 4 | loss: 1.0455220
	speed: 0.0834s/iter; left time: 598.3474s
	iters: 900, epoch: 4 | loss: 0.5295879
	speed: 0.0837s/iter; left time: 592.3403s
	iters: 1000, epoch: 4 | loss: 0.5010330
	speed: 0.0835s/iter; left time: 582.1115s
	iters: 1100, epoch: 4 | loss: 0.5249536
	speed: 0.0836s/iter; left time: 574.4976s
Epoch: 4 cost time: 95.08338904380798
Epoch: 4, Steps: 1139 | Train Loss: 0.6091628 Vali Loss: 0.7048814 Test Loss: 0.3724028
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4671542
	speed: 0.3893s/iter; left time: 2621.7445s
	iters: 200, epoch: 5 | loss: 0.9389650
	speed: 0.0832s/iter; left time: 552.0138s
	iters: 300, epoch: 5 | loss: 0.7448649
	speed: 0.0832s/iter; left time: 543.9642s
	iters: 400, epoch: 5 | loss: 0.5917172
	speed: 0.0833s/iter; left time: 536.0018s
	iters: 500, epoch: 5 | loss: 0.4919003
	speed: 0.0833s/iter; left time: 527.8528s
	iters: 600, epoch: 5 | loss: 0.6361977
	speed: 0.0834s/iter; left time: 519.8768s
	iters: 700, epoch: 5 | loss: 0.8104876
	speed: 0.0834s/iter; left time: 511.7694s
	iters: 800, epoch: 5 | loss: 0.7231832
	speed: 0.0833s/iter; left time: 502.8476s
	iters: 900, epoch: 5 | loss: 0.6355190
	speed: 0.0835s/iter; left time: 495.8258s
	iters: 1000, epoch: 5 | loss: 0.4801112
	speed: 0.0834s/iter; left time: 486.6525s
	iters: 1100, epoch: 5 | loss: 0.5635959
	speed: 0.0835s/iter; left time: 479.0882s
Epoch: 5 cost time: 94.92837977409363
Epoch: 5, Steps: 1139 | Train Loss: 0.6022896 Vali Loss: 0.7093739 Test Loss: 0.3732444
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : weather_336_Autoformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed3144<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10204
mse:0.3697606325149536, mae:0.3992563486099243
