Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Transformer', model_id='ETTm2_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=336, root_path='./dataset/', seed=10458, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm2_336_Transformer_ETTm2_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed10458>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34129
val 11185
test 11185
	iters: 100, epoch: 1 | loss: 0.2963844
	speed: 0.0732s/iter; left time: 772.8331s
	iters: 200, epoch: 1 | loss: 0.2432234
	speed: 0.0435s/iter; left time: 454.6520s
	iters: 300, epoch: 1 | loss: 0.1632403
	speed: 0.0435s/iter; left time: 450.9543s
	iters: 400, epoch: 1 | loss: 0.1822361
	speed: 0.0435s/iter; left time: 446.4918s
	iters: 500, epoch: 1 | loss: 0.2691948
	speed: 0.0435s/iter; left time: 442.1112s
	iters: 600, epoch: 1 | loss: 0.1989704
	speed: 0.0435s/iter; left time: 437.7102s
	iters: 700, epoch: 1 | loss: 0.1972024
	speed: 0.0436s/iter; left time: 434.7663s
	iters: 800, epoch: 1 | loss: 0.1726728
	speed: 0.0436s/iter; left time: 429.6568s
	iters: 900, epoch: 1 | loss: 0.1673735
	speed: 0.0436s/iter; left time: 425.2499s
	iters: 1000, epoch: 1 | loss: 0.1517581
	speed: 0.0437s/iter; left time: 422.2492s
Epoch: 1 cost time: 49.40806484222412
Epoch: 1, Steps: 1066 | Train Loss: 0.2195888 Vali Loss: 0.5458359 Test Loss: 1.0412599
Validation loss decreased (inf --> 0.545836).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1294754
	speed: 0.1724s/iter; left time: 1637.3014s
	iters: 200, epoch: 2 | loss: 0.1125330
	speed: 0.0436s/iter; left time: 409.2925s
	iters: 300, epoch: 2 | loss: 0.1374746
	speed: 0.0435s/iter; left time: 404.6567s
	iters: 400, epoch: 2 | loss: 0.1730286
	speed: 0.0435s/iter; left time: 400.0253s
	iters: 500, epoch: 2 | loss: 0.0995262
	speed: 0.0435s/iter; left time: 395.3817s
	iters: 600, epoch: 2 | loss: 0.1355716
	speed: 0.0435s/iter; left time: 391.1520s
	iters: 700, epoch: 2 | loss: 0.0857872
	speed: 0.0435s/iter; left time: 386.6257s
	iters: 800, epoch: 2 | loss: 0.1027294
	speed: 0.0435s/iter; left time: 382.3255s
	iters: 900, epoch: 2 | loss: 0.1065169
	speed: 0.0434s/iter; left time: 377.6904s
	iters: 1000, epoch: 2 | loss: 0.1047043
	speed: 0.0434s/iter; left time: 373.4343s
Epoch: 2 cost time: 46.33782458305359
Epoch: 2, Steps: 1066 | Train Loss: 0.1235340 Vali Loss: 0.6828519 Test Loss: 1.3476897
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.0935293
	speed: 0.1693s/iter; left time: 1426.8179s
	iters: 200, epoch: 3 | loss: 0.0815856
	speed: 0.0435s/iter; left time: 362.1144s
	iters: 300, epoch: 3 | loss: 0.0855466
	speed: 0.0435s/iter; left time: 357.7068s
	iters: 400, epoch: 3 | loss: 0.0908116
	speed: 0.0434s/iter; left time: 353.0872s
	iters: 500, epoch: 3 | loss: 0.0779398
	speed: 0.0434s/iter; left time: 348.8174s
	iters: 600, epoch: 3 | loss: 0.0822858
	speed: 0.0435s/iter; left time: 344.7597s
	iters: 700, epoch: 3 | loss: 0.0843205
	speed: 0.0434s/iter; left time: 340.1627s
	iters: 800, epoch: 3 | loss: 0.0785580
	speed: 0.0435s/iter; left time: 336.5012s
	iters: 900, epoch: 3 | loss: 0.0774154
	speed: 0.0437s/iter; left time: 333.7221s
	iters: 1000, epoch: 3 | loss: 0.0812866
	speed: 0.0437s/iter; left time: 328.8626s
Epoch: 3 cost time: 46.3921754360199
Epoch: 3, Steps: 1066 | Train Loss: 0.0861279 Vali Loss: 0.7145638 Test Loss: 1.4598156
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0801583
	speed: 0.1704s/iter; left time: 1254.7664s
	iters: 200, epoch: 4 | loss: 0.0649645
	speed: 0.0436s/iter; left time: 316.6574s
	iters: 300, epoch: 4 | loss: 0.0842230
	speed: 0.0435s/iter; left time: 311.3969s
	iters: 400, epoch: 4 | loss: 0.0725444
	speed: 0.0434s/iter; left time: 306.8595s
	iters: 500, epoch: 4 | loss: 0.0685667
	speed: 0.0435s/iter; left time: 302.6975s
	iters: 600, epoch: 4 | loss: 0.0775622
	speed: 0.0434s/iter; left time: 298.1176s
	iters: 700, epoch: 4 | loss: 0.0729433
	speed: 0.0435s/iter; left time: 293.8767s
	iters: 800, epoch: 4 | loss: 0.0740009
	speed: 0.0435s/iter; left time: 289.8564s
	iters: 900, epoch: 4 | loss: 0.0654309
	speed: 0.0435s/iter; left time: 285.1744s
	iters: 1000, epoch: 4 | loss: 0.0765088
	speed: 0.0434s/iter; left time: 280.3506s
Epoch: 4 cost time: 46.34048318862915
Epoch: 4, Steps: 1066 | Train Loss: 0.0739510 Vali Loss: 0.7297258 Test Loss: 1.4404743
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : ETTm2_336_Transformer_ETTm2_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed10458<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
mse:1.0420751571655273, mae:0.7730615735054016
