Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=21, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=21, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Transformer', model_id='weather_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=336, root_path='./dataset/', seed=3293, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_336_Transformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed3293>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36456
val 4935
test 10204
	iters: 100, epoch: 1 | loss: 0.4976632
	speed: 0.0740s/iter; left time: 835.1305s
	iters: 200, epoch: 1 | loss: 0.4122290
	speed: 0.0440s/iter; left time: 492.4820s
	iters: 300, epoch: 1 | loss: 0.6449115
	speed: 0.0440s/iter; left time: 488.1075s
	iters: 400, epoch: 1 | loss: 0.3580376
	speed: 0.0441s/iter; left time: 484.3938s
	iters: 500, epoch: 1 | loss: 0.3349331
	speed: 0.0441s/iter; left time: 480.2574s
	iters: 600, epoch: 1 | loss: 0.4350983
	speed: 0.0442s/iter; left time: 476.4786s
	iters: 700, epoch: 1 | loss: 0.3158275
	speed: 0.0442s/iter; left time: 472.3648s
	iters: 800, epoch: 1 | loss: 0.2788536
	speed: 0.0442s/iter; left time: 468.1302s
	iters: 900, epoch: 1 | loss: 0.3324858
	speed: 0.0442s/iter; left time: 463.4190s
	iters: 1000, epoch: 1 | loss: 0.3105060
	speed: 0.0442s/iter; left time: 458.9249s
	iters: 1100, epoch: 1 | loss: 0.3329121
	speed: 0.0442s/iter; left time: 454.3815s
Epoch: 1 cost time: 53.24543070793152
Epoch: 1, Steps: 1139 | Train Loss: 0.4299446 Vali Loss: 0.7646979 Test Loss: 0.7554933
Validation loss decreased (inf --> 0.764698).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2740037
	speed: 0.1329s/iter; left time: 1349.1446s
	iters: 200, epoch: 2 | loss: 0.2237192
	speed: 0.0444s/iter; left time: 446.2764s
	iters: 300, epoch: 2 | loss: 0.2945947
	speed: 0.0445s/iter; left time: 442.7716s
	iters: 400, epoch: 2 | loss: 0.2543873
	speed: 0.0445s/iter; left time: 438.5235s
	iters: 500, epoch: 2 | loss: 0.2297591
	speed: 0.0446s/iter; left time: 434.6432s
	iters: 600, epoch: 2 | loss: 0.2725607
	speed: 0.0445s/iter; left time: 429.4509s
	iters: 700, epoch: 2 | loss: 0.2286179
	speed: 0.0445s/iter; left time: 425.1310s
	iters: 800, epoch: 2 | loss: 0.3849977
	speed: 0.0446s/iter; left time: 421.4503s
	iters: 900, epoch: 2 | loss: 0.1616655
	speed: 0.0443s/iter; left time: 414.7012s
	iters: 1000, epoch: 2 | loss: 0.2001277
	speed: 0.0443s/iter; left time: 409.7087s
	iters: 1100, epoch: 2 | loss: 0.1847784
	speed: 0.0443s/iter; left time: 405.3121s
Epoch: 2 cost time: 50.5776150226593
Epoch: 2, Steps: 1139 | Train Loss: 0.2926525 Vali Loss: 0.7688929 Test Loss: 0.7539755
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4304346
	speed: 0.1311s/iter; left time: 1181.3490s
	iters: 200, epoch: 3 | loss: 0.1565404
	speed: 0.0442s/iter; left time: 394.1430s
	iters: 300, epoch: 3 | loss: 0.3856184
	speed: 0.0443s/iter; left time: 390.0172s
	iters: 400, epoch: 3 | loss: 0.5936862
	speed: 0.0442s/iter; left time: 385.4844s
	iters: 500, epoch: 3 | loss: 0.1933520
	speed: 0.0443s/iter; left time: 381.4000s
	iters: 600, epoch: 3 | loss: 0.1378510
	speed: 0.0443s/iter; left time: 376.7604s
	iters: 700, epoch: 3 | loss: 0.1451859
	speed: 0.0442s/iter; left time: 372.2277s
	iters: 800, epoch: 3 | loss: 0.5169470
	speed: 0.0442s/iter; left time: 367.8039s
	iters: 900, epoch: 3 | loss: 0.1610841
	speed: 0.0442s/iter; left time: 363.2170s
	iters: 1000, epoch: 3 | loss: 0.3472116
	speed: 0.0443s/iter; left time: 359.3638s
	iters: 1100, epoch: 3 | loss: 0.3772624
	speed: 0.0443s/iter; left time: 355.1613s
Epoch: 3 cost time: 50.38719964027405
Epoch: 3, Steps: 1139 | Train Loss: 0.2365762 Vali Loss: 0.7415256 Test Loss: 0.7624157
Validation loss decreased (0.764698 --> 0.741526).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1572674
	speed: 0.1335s/iter; left time: 1051.0927s
	iters: 200, epoch: 4 | loss: 0.1979733
	speed: 0.0443s/iter; left time: 344.4940s
	iters: 300, epoch: 4 | loss: 0.2253026
	speed: 0.0444s/iter; left time: 340.5190s
	iters: 400, epoch: 4 | loss: 0.3545266
	speed: 0.0444s/iter; left time: 336.3632s
	iters: 500, epoch: 4 | loss: 0.1580599
	speed: 0.0444s/iter; left time: 331.8150s
	iters: 600, epoch: 4 | loss: 0.1514517
	speed: 0.0444s/iter; left time: 327.4185s
	iters: 700, epoch: 4 | loss: 0.1327998
	speed: 0.0443s/iter; left time: 322.5728s
	iters: 800, epoch: 4 | loss: 0.1178680
	speed: 0.0443s/iter; left time: 318.0474s
	iters: 900, epoch: 4 | loss: 0.1303754
	speed: 0.0444s/iter; left time: 313.7647s
	iters: 1000, epoch: 4 | loss: 0.1649361
	speed: 0.0442s/iter; left time: 308.4494s
	iters: 1100, epoch: 4 | loss: 0.1967226
	speed: 0.0442s/iter; left time: 303.9740s
Epoch: 4 cost time: 50.46916699409485
Epoch: 4, Steps: 1139 | Train Loss: 0.2161450 Vali Loss: 0.7573285 Test Loss: 0.7620676
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1620048
	speed: 0.1308s/iter; left time: 881.0865s
	iters: 200, epoch: 5 | loss: 0.1373211
	speed: 0.0441s/iter; left time: 292.9300s
	iters: 300, epoch: 5 | loss: 0.2229205
	speed: 0.0442s/iter; left time: 288.5918s
	iters: 400, epoch: 5 | loss: 0.1736035
	speed: 0.0442s/iter; left time: 284.1998s
	iters: 500, epoch: 5 | loss: 0.1382461
	speed: 0.0442s/iter; left time: 279.7076s
	iters: 600, epoch: 5 | loss: 0.1229260
	speed: 0.0442s/iter; left time: 275.6141s
	iters: 700, epoch: 5 | loss: 0.1991466
	speed: 0.0442s/iter; left time: 271.0673s
	iters: 800, epoch: 5 | loss: 0.1534619
	speed: 0.0442s/iter; left time: 266.5817s
	iters: 900, epoch: 5 | loss: 0.2048706
	speed: 0.0442s/iter; left time: 262.3686s
	iters: 1000, epoch: 5 | loss: 0.1123447
	speed: 0.0442s/iter; left time: 257.8665s
	iters: 1100, epoch: 5 | loss: 0.1678752
	speed: 0.0442s/iter; left time: 253.2838s
Epoch: 5 cost time: 50.29592823982239
Epoch: 5, Steps: 1139 | Train Loss: 0.2071740 Vali Loss: 0.7788243 Test Loss: 0.8111145
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1601090
	speed: 0.1308s/iter; left time: 731.7521s
	iters: 200, epoch: 6 | loss: 0.1584552
	speed: 0.0441s/iter; left time: 242.6101s
	iters: 300, epoch: 6 | loss: 0.1283192
	speed: 0.0441s/iter; left time: 238.0581s
	iters: 400, epoch: 6 | loss: 0.1423408
	speed: 0.0442s/iter; left time: 233.8857s
	iters: 500, epoch: 6 | loss: 0.1441870
	speed: 0.0443s/iter; left time: 230.2499s
	iters: 600, epoch: 6 | loss: 0.1855083
	speed: 0.0443s/iter; left time: 225.7235s
	iters: 700, epoch: 6 | loss: 0.1369399
	speed: 0.0444s/iter; left time: 221.6588s
	iters: 800, epoch: 6 | loss: 0.1660240
	speed: 0.0443s/iter; left time: 217.0230s
	iters: 900, epoch: 6 | loss: 0.1388594
	speed: 0.0443s/iter; left time: 212.2854s
	iters: 1000, epoch: 6 | loss: 0.4415199
	speed: 0.0443s/iter; left time: 207.9784s
	iters: 1100, epoch: 6 | loss: 0.2850675
	speed: 0.0443s/iter; left time: 203.5727s
Epoch: 6 cost time: 50.37006664276123
Epoch: 6, Steps: 1139 | Train Loss: 0.2022056 Vali Loss: 0.7792965 Test Loss: 0.8069925
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : weather_336_Transformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed3293<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10204
mse:0.7624037861824036, mae:0.6073959469795227
