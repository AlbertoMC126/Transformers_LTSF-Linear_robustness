Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=21, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=21, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Autoformer', model_id='weather_720', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=720, root_path='./dataset/', seed=28649, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_720_Autoformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed28649>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36072
val 4551
test 9820
	iters: 100, epoch: 1 | loss: 0.7122962
	speed: 0.1790s/iter; left time: 1999.2854s
	iters: 200, epoch: 1 | loss: 0.8268745
	speed: 0.1437s/iter; left time: 1590.7912s
	iters: 300, epoch: 1 | loss: 0.6906232
	speed: 0.1440s/iter; left time: 1579.4661s
	iters: 400, epoch: 1 | loss: 0.9031025
	speed: 0.1440s/iter; left time: 1565.3201s
	iters: 500, epoch: 1 | loss: 0.6496883
	speed: 0.1437s/iter; left time: 1547.8514s
	iters: 600, epoch: 1 | loss: 0.7623447
	speed: 0.1437s/iter; left time: 1533.3146s
	iters: 700, epoch: 1 | loss: 0.8039656
	speed: 0.1438s/iter; left time: 1520.0140s
	iters: 800, epoch: 1 | loss: 0.7750005
	speed: 0.1441s/iter; left time: 1509.1215s
	iters: 900, epoch: 1 | loss: 0.8073417
	speed: 0.1438s/iter; left time: 1491.0938s
	iters: 1000, epoch: 1 | loss: 0.5904252
	speed: 0.1439s/iter; left time: 1477.5667s
	iters: 1100, epoch: 1 | loss: 0.6866179
	speed: 0.1438s/iter; left time: 1462.2797s
Epoch: 1 cost time: 165.69616222381592
Epoch: 1, Steps: 1127 | Train Loss: 0.7890304 Vali Loss: 0.8316196 Test Loss: 0.4175230
Validation loss decreased (inf --> 0.831620).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6726446
	speed: 0.6618s/iter; left time: 6647.4565s
	iters: 200, epoch: 2 | loss: 0.7080312
	speed: 0.1441s/iter; left time: 1433.4102s
	iters: 300, epoch: 2 | loss: 0.7885647
	speed: 0.1439s/iter; left time: 1416.4418s
	iters: 400, epoch: 2 | loss: 0.6964509
	speed: 0.1439s/iter; left time: 1402.0064s
	iters: 500, epoch: 2 | loss: 0.7171814
	speed: 0.1439s/iter; left time: 1387.7217s
	iters: 600, epoch: 2 | loss: 0.7299018
	speed: 0.1440s/iter; left time: 1374.1273s
	iters: 700, epoch: 2 | loss: 0.9636663
	speed: 0.1439s/iter; left time: 1358.6588s
	iters: 800, epoch: 2 | loss: 0.7323380
	speed: 0.1438s/iter; left time: 1343.8560s
	iters: 900, epoch: 2 | loss: 0.9086038
	speed: 0.1440s/iter; left time: 1331.4154s
	iters: 1000, epoch: 2 | loss: 0.6867255
	speed: 0.1439s/iter; left time: 1315.8588s
	iters: 1100, epoch: 2 | loss: 0.7138318
	speed: 0.1439s/iter; left time: 1300.9863s
Epoch: 2 cost time: 162.2050507068634
Epoch: 2, Steps: 1127 | Train Loss: 0.7505210 Vali Loss: 0.8206992 Test Loss: 0.4201298
Validation loss decreased (0.831620 --> 0.820699).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.7019198
	speed: 0.6600s/iter; left time: 5885.1748s
	iters: 200, epoch: 3 | loss: 0.8129001
	speed: 0.1435s/iter; left time: 1265.3129s
	iters: 300, epoch: 3 | loss: 0.9399498
	speed: 0.1439s/iter; left time: 1254.1925s
	iters: 400, epoch: 3 | loss: 0.7501580
	speed: 0.1438s/iter; left time: 1239.5469s
	iters: 500, epoch: 3 | loss: 0.5900644
	speed: 0.1439s/iter; left time: 1225.3381s
	iters: 600, epoch: 3 | loss: 0.6533478
	speed: 0.1438s/iter; left time: 1210.6003s
	iters: 700, epoch: 3 | loss: 0.8007363
	speed: 0.1439s/iter; left time: 1196.8957s
	iters: 800, epoch: 3 | loss: 0.7703343
	speed: 0.1439s/iter; left time: 1182.6661s
	iters: 900, epoch: 3 | loss: 0.6627621
	speed: 0.1437s/iter; left time: 1166.2775s
	iters: 1000, epoch: 3 | loss: 0.6774396
	speed: 0.1436s/iter; left time: 1151.6235s
	iters: 1100, epoch: 3 | loss: 0.8595352
	speed: 0.1438s/iter; left time: 1138.7636s
Epoch: 3 cost time: 162.0331516265869
Epoch: 3, Steps: 1127 | Train Loss: 0.7351709 Vali Loss: 0.8142506 Test Loss: 0.4163955
Validation loss decreased (0.820699 --> 0.814251).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.6597670
	speed: 0.6648s/iter; left time: 5178.7237s
	iters: 200, epoch: 4 | loss: 0.7053068
	speed: 0.1437s/iter; left time: 1105.3120s
	iters: 300, epoch: 4 | loss: 0.6581604
	speed: 0.1437s/iter; left time: 1090.7261s
	iters: 400, epoch: 4 | loss: 0.5829250
	speed: 0.1438s/iter; left time: 1077.3398s
	iters: 500, epoch: 4 | loss: 0.6511516
	speed: 0.1439s/iter; left time: 1063.6262s
	iters: 600, epoch: 4 | loss: 0.6696435
	speed: 0.1440s/iter; left time: 1049.9450s
	iters: 700, epoch: 4 | loss: 0.6823381
	speed: 0.1438s/iter; left time: 1034.1766s
	iters: 800, epoch: 4 | loss: 0.6894692
	speed: 0.1439s/iter; left time: 1020.5538s
	iters: 900, epoch: 4 | loss: 0.5219697
	speed: 0.1438s/iter; left time: 1005.2400s
	iters: 1000, epoch: 4 | loss: 0.7835184
	speed: 0.1438s/iter; left time: 991.0056s
	iters: 1100, epoch: 4 | loss: 0.8529249
	speed: 0.1437s/iter; left time: 975.7861s
Epoch: 4 cost time: 162.079975605011
Epoch: 4, Steps: 1127 | Train Loss: 0.7291340 Vali Loss: 0.8078337 Test Loss: 0.4099312
Validation loss decreased (0.814251 --> 0.807834).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.7840099
	speed: 0.6645s/iter; left time: 4427.5263s
	iters: 200, epoch: 5 | loss: 0.6962480
	speed: 0.1438s/iter; left time: 944.0484s
	iters: 300, epoch: 5 | loss: 0.5819055
	speed: 0.1438s/iter; left time: 929.2507s
	iters: 400, epoch: 5 | loss: 0.5578113
	speed: 0.1440s/iter; left time: 915.9987s
	iters: 500, epoch: 5 | loss: 0.7402508
	speed: 0.1436s/iter; left time: 899.6339s
	iters: 600, epoch: 5 | loss: 0.9104084
	speed: 0.1436s/iter; left time: 885.1139s
	iters: 700, epoch: 5 | loss: 0.6253219
	speed: 0.1438s/iter; left time: 872.1474s
	iters: 800, epoch: 5 | loss: 0.8423233
	speed: 0.1441s/iter; left time: 859.1993s
	iters: 900, epoch: 5 | loss: 0.7733374
	speed: 0.1440s/iter; left time: 844.2946s
	iters: 1000, epoch: 5 | loss: 0.7750137
	speed: 0.1440s/iter; left time: 829.7101s
	iters: 1100, epoch: 5 | loss: 0.7604405
	speed: 0.1439s/iter; left time: 814.6346s
Epoch: 5 cost time: 162.10042262077332
Epoch: 5, Steps: 1127 | Train Loss: 0.7250931 Vali Loss: 0.8100739 Test Loss: 0.4120357
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.8462555
	speed: 0.6589s/iter; left time: 3647.5427s
	iters: 200, epoch: 6 | loss: 0.6596390
	speed: 0.1439s/iter; left time: 782.2394s
	iters: 300, epoch: 6 | loss: 0.6058137
	speed: 0.1438s/iter; left time: 767.1595s
	iters: 400, epoch: 6 | loss: 0.8152230
	speed: 0.1439s/iter; left time: 753.4541s
	iters: 500, epoch: 6 | loss: 0.8196062
	speed: 0.1438s/iter; left time: 738.4580s
	iters: 600, epoch: 6 | loss: 0.8453866
	speed: 0.1439s/iter; left time: 724.5579s
	iters: 700, epoch: 6 | loss: 0.8075445
	speed: 0.1437s/iter; left time: 709.3974s
	iters: 800, epoch: 6 | loss: 0.8082893
	speed: 0.1436s/iter; left time: 694.3690s
	iters: 900, epoch: 6 | loss: 1.0359906
	speed: 0.1437s/iter; left time: 680.7436s
	iters: 1000, epoch: 6 | loss: 0.8759754
	speed: 0.1440s/iter; left time: 667.4185s
	iters: 1100, epoch: 6 | loss: 0.8025060
	speed: 0.1438s/iter; left time: 652.2414s
Epoch: 6 cost time: 162.0614206790924
Epoch: 6, Steps: 1127 | Train Loss: 0.7235693 Vali Loss: 0.8074763 Test Loss: 0.4100839
Validation loss decreased (0.807834 --> 0.807476).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.6258275
	speed: 0.6614s/iter; left time: 2916.2792s
	iters: 200, epoch: 7 | loss: 0.7067989
	speed: 0.1436s/iter; left time: 618.6347s
	iters: 300, epoch: 7 | loss: 0.7648600
	speed: 0.1440s/iter; left time: 605.9103s
	iters: 400, epoch: 7 | loss: 0.9578699
	speed: 0.1440s/iter; left time: 591.7675s
	iters: 500, epoch: 7 | loss: 0.7201017
	speed: 0.1439s/iter; left time: 576.7050s
	iters: 600, epoch: 7 | loss: 0.8760588
	speed: 0.1439s/iter; left time: 562.4599s
	iters: 700, epoch: 7 | loss: 0.7074200
	speed: 0.1440s/iter; left time: 548.3636s
	iters: 800, epoch: 7 | loss: 0.6143695
	speed: 0.1438s/iter; left time: 533.4334s
	iters: 900, epoch: 7 | loss: 0.8606569
	speed: 0.1440s/iter; left time: 519.5165s
	iters: 1000, epoch: 7 | loss: 0.5755343
	speed: 0.1438s/iter; left time: 504.6574s
	iters: 1100, epoch: 7 | loss: 0.5515921
	speed: 0.1439s/iter; left time: 490.5748s
Epoch: 7 cost time: 162.10147356987
Epoch: 7, Steps: 1127 | Train Loss: 0.7231212 Vali Loss: 0.8086478 Test Loss: 0.4104081
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.8543859
	speed: 0.6609s/iter; left time: 2169.1230s
	iters: 200, epoch: 8 | loss: 0.8425140
	speed: 0.1437s/iter; left time: 457.1195s
	iters: 300, epoch: 8 | loss: 0.5636169
	speed: 0.1435s/iter; left time: 442.3005s
	iters: 400, epoch: 8 | loss: 0.6084447
	speed: 0.1435s/iter; left time: 427.9832s
	iters: 500, epoch: 8 | loss: 0.6934754
	speed: 0.1438s/iter; left time: 414.4369s
	iters: 600, epoch: 8 | loss: 0.6147044
	speed: 0.1439s/iter; left time: 400.2433s
	iters: 700, epoch: 8 | loss: 0.7296915
	speed: 0.1439s/iter; left time: 385.9173s
	iters: 800, epoch: 8 | loss: 0.6704957
	speed: 0.1439s/iter; left time: 371.5386s
	iters: 900, epoch: 8 | loss: 0.7920384
	speed: 0.1441s/iter; left time: 357.6231s
	iters: 1000, epoch: 8 | loss: 0.9150349
	speed: 0.1438s/iter; left time: 342.6330s
	iters: 1100, epoch: 8 | loss: 0.6588852
	speed: 0.1438s/iter; left time: 328.0878s
Epoch: 8 cost time: 162.03089141845703
Epoch: 8, Steps: 1127 | Train Loss: 0.7236060 Vali Loss: 0.8093437 Test Loss: 0.4099489
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.8905328
	speed: 0.6633s/iter; left time: 1429.5181s
	iters: 200, epoch: 9 | loss: 0.6966900
	speed: 0.1439s/iter; left time: 295.6580s
	iters: 300, epoch: 9 | loss: 0.7054752
	speed: 0.1438s/iter; left time: 281.0363s
	iters: 400, epoch: 9 | loss: 0.7644998
	speed: 0.1438s/iter; left time: 266.8395s
	iters: 500, epoch: 9 | loss: 0.7101244
	speed: 0.1438s/iter; left time: 252.4102s
	iters: 600, epoch: 9 | loss: 0.5862535
	speed: 0.1437s/iter; left time: 237.8634s
	iters: 700, epoch: 9 | loss: 0.7012670
	speed: 0.1441s/iter; left time: 224.0172s
	iters: 800, epoch: 9 | loss: 0.7439824
	speed: 0.1439s/iter; left time: 209.3624s
	iters: 900, epoch: 9 | loss: 0.7754323
	speed: 0.1439s/iter; left time: 195.0310s
	iters: 1000, epoch: 9 | loss: 0.6991742
	speed: 0.1438s/iter; left time: 180.4459s
	iters: 1100, epoch: 9 | loss: 0.8164037
	speed: 0.1437s/iter; left time: 165.9945s
Epoch: 9 cost time: 162.1182222366333
Epoch: 9, Steps: 1127 | Train Loss: 0.7245919 Vali Loss: 0.8104482 Test Loss: 0.4110584
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : weather_720_Autoformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed28649<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9820
mse:0.4099424183368683, mae:0.4197229743003845
