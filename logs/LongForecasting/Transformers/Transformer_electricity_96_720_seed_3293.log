Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=321, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', dec_in=321, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Transformer', model_id='electricity_720', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=720, root_path='./dataset/', seed=3293, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : electricity_720_Transformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed3293>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17597
val 1913
test 4541
	iters: 100, epoch: 1 | loss: 0.3259752
	speed: 0.1349s/iter; left time: 727.1374s
	iters: 200, epoch: 1 | loss: 0.2550294
	speed: 0.1036s/iter; left time: 548.1951s
	iters: 300, epoch: 1 | loss: 0.2524029
	speed: 0.1033s/iter; left time: 536.1736s
	iters: 400, epoch: 1 | loss: 0.2435912
	speed: 0.1029s/iter; left time: 523.8668s
	iters: 500, epoch: 1 | loss: 0.2249249
	speed: 0.1030s/iter; left time: 513.9063s
Epoch: 1 cost time: 59.827510595321655
Epoch: 1, Steps: 549 | Train Loss: 0.3114136 Vali Loss: 0.2773824 Test Loss: 0.3471499
Validation loss decreased (inf --> 0.277382).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2172095
	speed: 0.3244s/iter; left time: 1570.5983s
	iters: 200, epoch: 2 | loss: 0.1986199
	speed: 0.1032s/iter; left time: 489.3337s
	iters: 300, epoch: 2 | loss: 0.1737437
	speed: 0.1033s/iter; left time: 479.7264s
	iters: 400, epoch: 2 | loss: 0.1765077
	speed: 0.1031s/iter; left time: 468.5054s
	iters: 500, epoch: 2 | loss: 0.1622454
	speed: 0.1039s/iter; left time: 461.3240s
Epoch: 2 cost time: 56.77173852920532
Epoch: 2, Steps: 549 | Train Loss: 0.1927390 Vali Loss: 0.2303085 Test Loss: 0.3009247
Validation loss decreased (0.277382 --> 0.230308).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1477387
	speed: 0.3267s/iter; left time: 1402.3843s
	iters: 200, epoch: 3 | loss: 0.1565863
	speed: 0.1033s/iter; left time: 432.9725s
	iters: 300, epoch: 3 | loss: 0.1453578
	speed: 0.1032s/iter; left time: 422.4124s
	iters: 400, epoch: 3 | loss: 0.1488099
	speed: 0.1031s/iter; left time: 411.7518s
	iters: 500, epoch: 3 | loss: 0.1433604
	speed: 0.1033s/iter; left time: 402.1601s
Epoch: 3 cost time: 56.62403059005737
Epoch: 3, Steps: 549 | Train Loss: 0.1524692 Vali Loss: 0.2279213 Test Loss: 0.2946407
Validation loss decreased (0.230308 --> 0.227921).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1455254
	speed: 0.3252s/iter; left time: 1217.5497s
	iters: 200, epoch: 4 | loss: 0.1442854
	speed: 0.1037s/iter; left time: 377.7889s
	iters: 300, epoch: 4 | loss: 0.1412560
	speed: 0.1041s/iter; left time: 368.8951s
	iters: 400, epoch: 4 | loss: 0.1415374
	speed: 0.1039s/iter; left time: 357.6839s
	iters: 500, epoch: 4 | loss: 0.1342598
	speed: 0.1035s/iter; left time: 345.9819s
Epoch: 4 cost time: 56.84669494628906
Epoch: 4, Steps: 549 | Train Loss: 0.1410223 Vali Loss: 0.2231477 Test Loss: 0.2960766
Validation loss decreased (0.227921 --> 0.223148).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1328094
	speed: 0.3257s/iter; left time: 1040.4570s
	iters: 200, epoch: 5 | loss: 0.1360344
	speed: 0.1034s/iter; left time: 319.9778s
	iters: 300, epoch: 5 | loss: 0.1266244
	speed: 0.1032s/iter; left time: 309.1385s
	iters: 400, epoch: 5 | loss: 0.1327906
	speed: 0.1032s/iter; left time: 298.7779s
	iters: 500, epoch: 5 | loss: 0.1352720
	speed: 0.1035s/iter; left time: 289.3584s
Epoch: 5 cost time: 56.68783640861511
Epoch: 5, Steps: 549 | Train Loss: 0.1346134 Vali Loss: 0.2197315 Test Loss: 0.2970666
Validation loss decreased (0.223148 --> 0.219731).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1247065
	speed: 0.3269s/iter; left time: 864.9793s
	iters: 200, epoch: 6 | loss: 0.1357390
	speed: 0.1039s/iter; left time: 264.4629s
	iters: 300, epoch: 6 | loss: 0.1340176
	speed: 0.1030s/iter; left time: 251.9112s
	iters: 400, epoch: 6 | loss: 0.1299628
	speed: 0.1033s/iter; left time: 242.2666s
	iters: 500, epoch: 6 | loss: 0.1397698
	speed: 0.1033s/iter; left time: 231.9563s
Epoch: 6 cost time: 56.758522510528564
Epoch: 6, Steps: 549 | Train Loss: 0.1313399 Vali Loss: 0.2192695 Test Loss: 0.2952314
Validation loss decreased (0.219731 --> 0.219270).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1321045
	speed: 0.3238s/iter; left time: 678.9965s
	iters: 200, epoch: 7 | loss: 0.1310454
	speed: 0.1037s/iter; left time: 206.9892s
	iters: 300, epoch: 7 | loss: 0.1348428
	speed: 0.1036s/iter; left time: 196.5229s
	iters: 400, epoch: 7 | loss: 0.1288403
	speed: 0.1039s/iter; left time: 186.7068s
	iters: 500, epoch: 7 | loss: 0.1357995
	speed: 0.1038s/iter; left time: 176.1715s
Epoch: 7 cost time: 56.887126207351685
Epoch: 7, Steps: 549 | Train Loss: 0.1296819 Vali Loss: 0.2185576 Test Loss: 0.2983045
Validation loss decreased (0.219270 --> 0.218558).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1324441
	speed: 0.3255s/iter; left time: 503.8326s
	iters: 200, epoch: 8 | loss: 0.1270895
	speed: 0.1034s/iter; left time: 149.7164s
	iters: 300, epoch: 8 | loss: 0.1290933
	speed: 0.1035s/iter; left time: 139.4689s
	iters: 400, epoch: 8 | loss: 0.1306425
	speed: 0.1034s/iter; left time: 129.0295s
	iters: 500, epoch: 8 | loss: 0.1251781
	speed: 0.1035s/iter; left time: 118.8519s
Epoch: 8 cost time: 56.73335385322571
Epoch: 8, Steps: 549 | Train Loss: 0.1288372 Vali Loss: 0.2182225 Test Loss: 0.2968299
Validation loss decreased (0.218558 --> 0.218222).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1286154
	speed: 0.3252s/iter; left time: 324.8778s
	iters: 200, epoch: 9 | loss: 0.1316578
	speed: 0.1042s/iter; left time: 93.6447s
	iters: 300, epoch: 9 | loss: 0.1288564
	speed: 0.1041s/iter; left time: 83.1438s
	iters: 400, epoch: 9 | loss: 0.1295253
	speed: 0.1035s/iter; left time: 72.3771s
	iters: 500, epoch: 9 | loss: 0.1296735
	speed: 0.1032s/iter; left time: 61.8457s
Epoch: 9 cost time: 56.91610550880432
Epoch: 9, Steps: 549 | Train Loss: 0.1283905 Vali Loss: 0.2187567 Test Loss: 0.2981886
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1268849
	speed: 0.3226s/iter; left time: 145.1520s
	iters: 200, epoch: 10 | loss: 0.1273553
	speed: 0.1032s/iter; left time: 36.1353s
	iters: 300, epoch: 10 | loss: 0.1286013
	speed: 0.1031s/iter; left time: 25.7679s
	iters: 400, epoch: 10 | loss: 0.1315876
	speed: 0.1035s/iter; left time: 15.5257s
	iters: 500, epoch: 10 | loss: 0.1264370
	speed: 0.1032s/iter; left time: 5.1613s
Epoch: 10 cost time: 56.68849778175354
Epoch: 10, Steps: 549 | Train Loss: 0.1281143 Vali Loss: 0.2189027 Test Loss: 0.2972296
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : electricity_720_Transformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed3293<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4541
mse:0.2967553436756134, mae:0.3813842833042145
