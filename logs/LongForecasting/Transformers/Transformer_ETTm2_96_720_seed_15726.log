Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Transformer', model_id='ETTm2_720', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=720, root_path='./dataset/', seed=15726, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm2_720_Transformer_ETTm2_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed15726>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33745
val 10801
test 10801
	iters: 100, epoch: 1 | loss: 0.2922785
	speed: 0.1233s/iter; left time: 1287.5212s
	iters: 200, epoch: 1 | loss: 0.3465286
	speed: 0.0921s/iter; left time: 952.8639s
	iters: 300, epoch: 1 | loss: 0.2706169
	speed: 0.0917s/iter; left time: 939.3871s
	iters: 400, epoch: 1 | loss: 0.3791644
	speed: 0.0915s/iter; left time: 927.7108s
	iters: 500, epoch: 1 | loss: 0.1920980
	speed: 0.0915s/iter; left time: 918.8928s
	iters: 600, epoch: 1 | loss: 0.2283204
	speed: 0.0917s/iter; left time: 911.5271s
	iters: 700, epoch: 1 | loss: 0.1848102
	speed: 0.0919s/iter; left time: 904.0868s
	iters: 800, epoch: 1 | loss: 0.1831917
	speed: 0.0921s/iter; left time: 897.1989s
	iters: 900, epoch: 1 | loss: 0.1887820
	speed: 0.0919s/iter; left time: 886.3438s
	iters: 1000, epoch: 1 | loss: 0.1760350
	speed: 0.0918s/iter; left time: 875.4847s
Epoch: 1 cost time: 99.91553258895874
Epoch: 1, Steps: 1054 | Train Loss: 0.2522527 Vali Loss: 1.1794858 Test Loss: 4.0883074
Validation loss decreased (inf --> 1.179486).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1289586
	speed: 0.3692s/iter; left time: 3465.8603s
	iters: 200, epoch: 2 | loss: 0.1522062
	speed: 0.0924s/iter; left time: 858.4085s
	iters: 300, epoch: 2 | loss: 0.1302145
	speed: 0.0921s/iter; left time: 846.1306s
	iters: 400, epoch: 2 | loss: 0.1319912
	speed: 0.0919s/iter; left time: 835.4686s
	iters: 500, epoch: 2 | loss: 0.1508763
	speed: 0.0919s/iter; left time: 825.7058s
	iters: 600, epoch: 2 | loss: 0.1163329
	speed: 0.0918s/iter; left time: 815.9515s
	iters: 700, epoch: 2 | loss: 0.1621573
	speed: 0.0918s/iter; left time: 806.6514s
	iters: 800, epoch: 2 | loss: 0.1696556
	speed: 0.0918s/iter; left time: 797.6401s
	iters: 900, epoch: 2 | loss: 0.1271175
	speed: 0.0920s/iter; left time: 790.2178s
	iters: 1000, epoch: 2 | loss: 0.1085417
	speed: 0.0919s/iter; left time: 780.0098s
Epoch: 2 cost time: 96.93974494934082
Epoch: 2, Steps: 1054 | Train Loss: 0.1412427 Vali Loss: 1.1816695 Test Loss: 4.2394829
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1200101
	speed: 0.3673s/iter; left time: 3060.4912s
	iters: 200, epoch: 3 | loss: 0.1030865
	speed: 0.0924s/iter; left time: 760.4731s
	iters: 300, epoch: 3 | loss: 0.1278497
	speed: 0.0920s/iter; left time: 748.1228s
	iters: 400, epoch: 3 | loss: 0.1150202
	speed: 0.0918s/iter; left time: 737.3054s
	iters: 500, epoch: 3 | loss: 0.1051331
	speed: 0.0918s/iter; left time: 728.0604s
	iters: 600, epoch: 3 | loss: 0.0946062
	speed: 0.0918s/iter; left time: 719.2664s
	iters: 700, epoch: 3 | loss: 0.1100328
	speed: 0.0917s/iter; left time: 709.4764s
	iters: 800, epoch: 3 | loss: 0.0957766
	speed: 0.0919s/iter; left time: 701.1256s
	iters: 900, epoch: 3 | loss: 0.1269852
	speed: 0.0918s/iter; left time: 691.2037s
	iters: 1000, epoch: 3 | loss: 0.0954565
	speed: 0.0917s/iter; left time: 681.4944s
Epoch: 3 cost time: 96.81515574455261
Epoch: 3, Steps: 1054 | Train Loss: 0.1029388 Vali Loss: 1.3221866 Test Loss: 4.6443405
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0787431
	speed: 0.3648s/iter; left time: 2655.5432s
	iters: 200, epoch: 4 | loss: 0.0866279
	speed: 0.0917s/iter; left time: 658.3677s
	iters: 300, epoch: 4 | loss: 0.0763566
	speed: 0.0916s/iter; left time: 648.7039s
	iters: 400, epoch: 4 | loss: 0.1131596
	speed: 0.0917s/iter; left time: 639.9275s
	iters: 500, epoch: 4 | loss: 0.0882898
	speed: 0.0917s/iter; left time: 630.9829s
	iters: 600, epoch: 4 | loss: 0.0850882
	speed: 0.0917s/iter; left time: 621.8863s
	iters: 700, epoch: 4 | loss: 0.0772606
	speed: 0.0919s/iter; left time: 614.0302s
	iters: 800, epoch: 4 | loss: 0.0947235
	speed: 0.0918s/iter; left time: 604.2425s
	iters: 900, epoch: 4 | loss: 0.0831645
	speed: 0.0919s/iter; left time: 595.5797s
	iters: 1000, epoch: 4 | loss: 0.0864567
	speed: 0.0918s/iter; left time: 585.5850s
Epoch: 4 cost time: 96.6801540851593
Epoch: 4, Steps: 1054 | Train Loss: 0.0875286 Vali Loss: 1.2157218 Test Loss: 4.3027143
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : ETTm2_720_Transformer_ETTm2_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed15726<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10801
mse:4.090100288391113, mae:1.5220979452133179
