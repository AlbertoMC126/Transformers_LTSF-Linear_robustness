Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=21, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=21, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Autoformer', model_id='weather_720', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=720, root_path='./dataset/', seed=32598, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_720_Autoformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed32598>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36072
val 4551
test 9820
	iters: 100, epoch: 1 | loss: 0.8332570
	speed: 0.1780s/iter; left time: 1988.9568s
	iters: 200, epoch: 1 | loss: 0.7527578
	speed: 0.1438s/iter; left time: 1591.5951s
	iters: 300, epoch: 1 | loss: 0.6941153
	speed: 0.1443s/iter; left time: 1583.0246s
	iters: 400, epoch: 1 | loss: 0.5943186
	speed: 0.1449s/iter; left time: 1575.4746s
	iters: 500, epoch: 1 | loss: 0.6403143
	speed: 0.1442s/iter; left time: 1552.7159s
	iters: 600, epoch: 1 | loss: 0.9232492
	speed: 0.1436s/iter; left time: 1532.7562s
	iters: 700, epoch: 1 | loss: 0.6771911
	speed: 0.1437s/iter; left time: 1518.8214s
	iters: 800, epoch: 1 | loss: 0.6725222
	speed: 0.1435s/iter; left time: 1503.0406s
	iters: 900, epoch: 1 | loss: 0.7540514
	speed: 0.1435s/iter; left time: 1488.7503s
	iters: 1000, epoch: 1 | loss: 0.7555826
	speed: 0.1436s/iter; left time: 1475.2163s
	iters: 1100, epoch: 1 | loss: 0.7684129
	speed: 0.1436s/iter; left time: 1460.8376s
Epoch: 1 cost time: 165.67043089866638
Epoch: 1, Steps: 1127 | Train Loss: 0.7450243 Vali Loss: 0.8283774 Test Loss: 0.4350103
Validation loss decreased (inf --> 0.828377).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.7666218
	speed: 0.6686s/iter; left time: 6715.8144s
	iters: 200, epoch: 2 | loss: 0.6511193
	speed: 0.1440s/iter; left time: 1431.7101s
	iters: 300, epoch: 2 | loss: 0.6413730
	speed: 0.1439s/iter; left time: 1416.9302s
	iters: 400, epoch: 2 | loss: 0.5982680
	speed: 0.1439s/iter; left time: 1401.9530s
	iters: 500, epoch: 2 | loss: 0.6122031
	speed: 0.1440s/iter; left time: 1388.7708s
	iters: 600, epoch: 2 | loss: 0.6124265
	speed: 0.1441s/iter; left time: 1374.8475s
	iters: 700, epoch: 2 | loss: 0.6670702
	speed: 0.1440s/iter; left time: 1360.3713s
	iters: 800, epoch: 2 | loss: 0.6895379
	speed: 0.1440s/iter; left time: 1345.3224s
	iters: 900, epoch: 2 | loss: 0.7383683
	speed: 0.1440s/iter; left time: 1330.8906s
	iters: 1000, epoch: 2 | loss: 0.6749738
	speed: 0.1439s/iter; left time: 1315.9452s
	iters: 1100, epoch: 2 | loss: 0.7594438
	speed: 0.1438s/iter; left time: 1300.6312s
Epoch: 2 cost time: 162.1993534564972
Epoch: 2, Steps: 1127 | Train Loss: 0.7135475 Vali Loss: 0.8250541 Test Loss: 0.4353860
Validation loss decreased (0.828377 --> 0.825054).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.7341294
	speed: 0.6627s/iter; left time: 5909.6289s
	iters: 200, epoch: 3 | loss: 0.6138421
	speed: 0.1439s/iter; left time: 1268.5330s
	iters: 300, epoch: 3 | loss: 0.5907246
	speed: 0.1439s/iter; left time: 1254.2487s
	iters: 400, epoch: 3 | loss: 0.9042317
	speed: 0.1439s/iter; left time: 1240.0313s
	iters: 500, epoch: 3 | loss: 0.7464899
	speed: 0.1438s/iter; left time: 1224.7668s
	iters: 600, epoch: 3 | loss: 0.6741724
	speed: 0.1436s/iter; left time: 1208.4380s
	iters: 700, epoch: 3 | loss: 0.8120590
	speed: 0.1437s/iter; left time: 1194.9869s
	iters: 800, epoch: 3 | loss: 0.8030586
	speed: 0.1439s/iter; left time: 1182.3257s
	iters: 900, epoch: 3 | loss: 0.6158267
	speed: 0.1440s/iter; left time: 1168.5796s
	iters: 1000, epoch: 3 | loss: 0.6843495
	speed: 0.1439s/iter; left time: 1153.9538s
	iters: 1100, epoch: 3 | loss: 0.6100661
	speed: 0.1440s/iter; left time: 1140.1794s
Epoch: 3 cost time: 162.10956692695618
Epoch: 3, Steps: 1127 | Train Loss: 0.7013653 Vali Loss: 0.8092601 Test Loss: 0.4227029
Validation loss decreased (0.825054 --> 0.809260).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.5874006
	speed: 0.6616s/iter; left time: 5153.9752s
	iters: 200, epoch: 4 | loss: 0.8360342
	speed: 0.1440s/iter; left time: 1107.1410s
	iters: 300, epoch: 4 | loss: 0.6044402
	speed: 0.1439s/iter; left time: 1092.1917s
	iters: 400, epoch: 4 | loss: 0.7049276
	speed: 0.1438s/iter; left time: 1077.1593s
	iters: 500, epoch: 4 | loss: 0.7383223
	speed: 0.1439s/iter; left time: 1063.0884s
	iters: 600, epoch: 4 | loss: 0.5688465
	speed: 0.1439s/iter; left time: 1048.6763s
	iters: 700, epoch: 4 | loss: 0.8116239
	speed: 0.1439s/iter; left time: 1034.5642s
	iters: 800, epoch: 4 | loss: 0.7562764
	speed: 0.1436s/iter; left time: 1018.1111s
	iters: 900, epoch: 4 | loss: 0.6659609
	speed: 0.1437s/iter; left time: 1004.5805s
	iters: 1000, epoch: 4 | loss: 0.7573081
	speed: 0.1441s/iter; left time: 992.5561s
	iters: 1100, epoch: 4 | loss: 0.7001411
	speed: 0.1440s/iter; left time: 978.0017s
Epoch: 4 cost time: 162.137140750885
Epoch: 4, Steps: 1127 | Train Loss: 0.6958534 Vali Loss: 0.8082062 Test Loss: 0.4300522
Validation loss decreased (0.809260 --> 0.808206).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.6429182
	speed: 0.6611s/iter; left time: 4404.7455s
	iters: 200, epoch: 5 | loss: 0.7063667
	speed: 0.1437s/iter; left time: 943.0239s
	iters: 300, epoch: 5 | loss: 0.7280697
	speed: 0.1437s/iter; left time: 928.9779s
	iters: 400, epoch: 5 | loss: 0.6833562
	speed: 0.1442s/iter; left time: 917.3220s
	iters: 500, epoch: 5 | loss: 0.5493938
	speed: 0.1441s/iter; left time: 902.4792s
	iters: 600, epoch: 5 | loss: 0.5384136
	speed: 0.1441s/iter; left time: 888.0030s
	iters: 700, epoch: 5 | loss: 0.6368812
	speed: 0.1441s/iter; left time: 873.3947s
	iters: 800, epoch: 5 | loss: 0.8161142
	speed: 0.1438s/iter; left time: 857.6504s
	iters: 900, epoch: 5 | loss: 0.7500452
	speed: 0.1440s/iter; left time: 844.4749s
	iters: 1000, epoch: 5 | loss: 0.6629675
	speed: 0.1440s/iter; left time: 829.7252s
	iters: 1100, epoch: 5 | loss: 0.5894574
	speed: 0.1439s/iter; left time: 815.0051s
Epoch: 5 cost time: 162.2063183784485
Epoch: 5, Steps: 1127 | Train Loss: 0.6931647 Vali Loss: 0.8014893 Test Loss: 0.4260647
Validation loss decreased (0.808206 --> 0.801489).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.6631494
	speed: 0.6644s/iter; left time: 3677.9738s
	iters: 200, epoch: 6 | loss: 0.5993124
	speed: 0.1438s/iter; left time: 781.5227s
	iters: 300, epoch: 6 | loss: 0.8350024
	speed: 0.1437s/iter; left time: 766.7433s
	iters: 400, epoch: 6 | loss: 0.7467443
	speed: 0.1438s/iter; left time: 752.7428s
	iters: 500, epoch: 6 | loss: 0.7588309
	speed: 0.1438s/iter; left time: 738.6200s
	iters: 600, epoch: 6 | loss: 0.6255181
	speed: 0.1441s/iter; left time: 725.7120s
	iters: 700, epoch: 6 | loss: 0.6818004
	speed: 0.1440s/iter; left time: 710.5894s
	iters: 800, epoch: 6 | loss: 0.6615230
	speed: 0.1439s/iter; left time: 696.0571s
	iters: 900, epoch: 6 | loss: 0.6530476
	speed: 0.1439s/iter; left time: 681.4404s
	iters: 1000, epoch: 6 | loss: 0.6185803
	speed: 0.1439s/iter; left time: 667.1208s
	iters: 1100, epoch: 6 | loss: 0.9780825
	speed: 0.1439s/iter; left time: 652.5648s
Epoch: 6 cost time: 162.17756938934326
Epoch: 6, Steps: 1127 | Train Loss: 0.6914033 Vali Loss: 0.8001708 Test Loss: 0.4219415
Validation loss decreased (0.801489 --> 0.800171).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.5862052
	speed: 0.6647s/iter; left time: 2930.8524s
	iters: 200, epoch: 7 | loss: 0.7442492
	speed: 0.1440s/iter; left time: 620.4420s
	iters: 300, epoch: 7 | loss: 0.8080603
	speed: 0.1439s/iter; left time: 605.4910s
	iters: 400, epoch: 7 | loss: 0.6672275
	speed: 0.1439s/iter; left time: 591.2309s
	iters: 500, epoch: 7 | loss: 0.6999526
	speed: 0.1439s/iter; left time: 576.9341s
	iters: 600, epoch: 7 | loss: 0.5670158
	speed: 0.1439s/iter; left time: 562.4644s
	iters: 700, epoch: 7 | loss: 0.5799411
	speed: 0.1439s/iter; left time: 548.2296s
	iters: 800, epoch: 7 | loss: 0.8499391
	speed: 0.1440s/iter; left time: 534.1598s
	iters: 900, epoch: 7 | loss: 0.6079912
	speed: 0.1439s/iter; left time: 519.4556s
	iters: 1000, epoch: 7 | loss: 0.7378163
	speed: 0.1438s/iter; left time: 504.5936s
	iters: 1100, epoch: 7 | loss: 0.6252200
	speed: 0.1438s/iter; left time: 490.2563s
Epoch: 7 cost time: 162.17744779586792
Epoch: 7, Steps: 1127 | Train Loss: 0.6902753 Vali Loss: 0.8013506 Test Loss: 0.4257453
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.7076430
	speed: 0.6590s/iter; left time: 2162.7928s
	iters: 200, epoch: 8 | loss: 0.5677775
	speed: 0.1441s/iter; left time: 458.4566s
	iters: 300, epoch: 8 | loss: 0.7935595
	speed: 0.1440s/iter; left time: 443.9388s
	iters: 400, epoch: 8 | loss: 0.6791698
	speed: 0.1439s/iter; left time: 429.1154s
	iters: 500, epoch: 8 | loss: 0.6389436
	speed: 0.1440s/iter; left time: 414.8669s
	iters: 600, epoch: 8 | loss: 0.8011249
	speed: 0.1440s/iter; left time: 400.6893s
	iters: 700, epoch: 8 | loss: 0.8587520
	speed: 0.1440s/iter; left time: 386.1512s
	iters: 800, epoch: 8 | loss: 0.6328665
	speed: 0.1441s/iter; left time: 371.9567s
	iters: 900, epoch: 8 | loss: 0.4982739
	speed: 0.1441s/iter; left time: 357.7021s
	iters: 1000, epoch: 8 | loss: 0.7539694
	speed: 0.1441s/iter; left time: 343.3364s
	iters: 1100, epoch: 8 | loss: 0.7031355
	speed: 0.1441s/iter; left time: 328.8545s
Epoch: 8 cost time: 162.28441333770752
Epoch: 8, Steps: 1127 | Train Loss: 0.6894000 Vali Loss: 0.8000409 Test Loss: 0.4264258
Validation loss decreased (0.800171 --> 0.800041).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.7478482
	speed: 0.6603s/iter; left time: 1422.9835s
	iters: 200, epoch: 9 | loss: 0.6448289
	speed: 0.1438s/iter; left time: 295.5397s
	iters: 300, epoch: 9 | loss: 0.6172968
	speed: 0.1440s/iter; left time: 281.4552s
	iters: 400, epoch: 9 | loss: 0.5445891
	speed: 0.1440s/iter; left time: 267.1094s
	iters: 500, epoch: 9 | loss: 0.5764935
	speed: 0.1441s/iter; left time: 252.8898s
	iters: 600, epoch: 9 | loss: 0.5847288
	speed: 0.1439s/iter; left time: 238.1071s
	iters: 700, epoch: 9 | loss: 0.7290091
	speed: 0.1440s/iter; left time: 223.8738s
	iters: 800, epoch: 9 | loss: 0.7579366
	speed: 0.1439s/iter; left time: 209.3561s
	iters: 900, epoch: 9 | loss: 0.9945162
	speed: 0.1437s/iter; left time: 194.7413s
	iters: 1000, epoch: 9 | loss: 0.5342829
	speed: 0.1438s/iter; left time: 180.4207s
	iters: 1100, epoch: 9 | loss: 0.7043725
	speed: 0.1437s/iter; left time: 166.0027s
Epoch: 9 cost time: 162.1480634212494
Epoch: 9, Steps: 1127 | Train Loss: 0.6891910 Vali Loss: 0.7993631 Test Loss: 0.4261592
Validation loss decreased (0.800041 --> 0.799363).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.5549406
	speed: 0.6632s/iter; left time: 681.8012s
	iters: 200, epoch: 10 | loss: 0.5840629
	speed: 0.1440s/iter; left time: 133.6272s
	iters: 300, epoch: 10 | loss: 0.6470445
	speed: 0.1437s/iter; left time: 119.0045s
	iters: 400, epoch: 10 | loss: 0.9115420
	speed: 0.1437s/iter; left time: 104.6305s
	iters: 500, epoch: 10 | loss: 0.6512407
	speed: 0.1439s/iter; left time: 90.3768s
	iters: 600, epoch: 10 | loss: 0.6329879
	speed: 0.1442s/iter; left time: 76.1211s
	iters: 700, epoch: 10 | loss: 0.5690055
	speed: 0.1441s/iter; left time: 61.6799s
	iters: 800, epoch: 10 | loss: 0.6748625
	speed: 0.1439s/iter; left time: 47.1903s
	iters: 900, epoch: 10 | loss: 0.7024342
	speed: 0.1440s/iter; left time: 32.8398s
	iters: 1000, epoch: 10 | loss: 0.7203760
	speed: 0.1440s/iter; left time: 18.4293s
	iters: 1100, epoch: 10 | loss: 0.7187561
	speed: 0.1440s/iter; left time: 4.0308s
Epoch: 10 cost time: 162.22347164154053
Epoch: 10, Steps: 1127 | Train Loss: 0.6892576 Vali Loss: 0.8009921 Test Loss: 0.4265424
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : weather_720_Autoformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed32598<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9820
mse:0.42601534724235535, mae:0.43621379137039185
