Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm1', data_path='ETTm1.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Autoformer', model_id='ETTm1_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=336, root_path='./dataset/', seed=3144, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm1_336_Autoformer_ETTm1_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed3144>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34129
val 11185
test 11185
	iters: 100, epoch: 1 | loss: 0.5394253
	speed: 0.1180s/iter; left time: 1245.7509s
	iters: 200, epoch: 1 | loss: 0.4872571
	speed: 0.0824s/iter; left time: 862.4811s
	iters: 300, epoch: 1 | loss: 0.4104241
	speed: 0.0825s/iter; left time: 854.8887s
	iters: 400, epoch: 1 | loss: 0.4832745
	speed: 0.0826s/iter; left time: 847.2752s
	iters: 500, epoch: 1 | loss: 0.3239288
	speed: 0.0826s/iter; left time: 839.5530s
	iters: 600, epoch: 1 | loss: 0.3778730
	speed: 0.0827s/iter; left time: 832.1420s
	iters: 700, epoch: 1 | loss: 0.3627375
	speed: 0.0827s/iter; left time: 823.5716s
	iters: 800, epoch: 1 | loss: 0.3501224
	speed: 0.0825s/iter; left time: 813.9183s
	iters: 900, epoch: 1 | loss: 0.3695675
	speed: 0.0825s/iter; left time: 805.0852s
	iters: 1000, epoch: 1 | loss: 0.3837134
	speed: 0.0825s/iter; left time: 796.5526s
Epoch: 1 cost time: 91.58414387702942
Epoch: 1, Steps: 1066 | Train Loss: 0.4161120 Vali Loss: 1.0171299 Test Loss: 0.6964031
Validation loss decreased (inf --> 1.017130).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3895971
	speed: 0.5198s/iter; left time: 4935.5744s
	iters: 200, epoch: 2 | loss: 0.4011236
	speed: 0.0825s/iter; left time: 775.3779s
	iters: 300, epoch: 2 | loss: 0.3287579
	speed: 0.0826s/iter; left time: 767.5248s
	iters: 400, epoch: 2 | loss: 0.3738021
	speed: 0.0826s/iter; left time: 759.8230s
	iters: 500, epoch: 2 | loss: 0.3635438
	speed: 0.0826s/iter; left time: 751.2360s
	iters: 600, epoch: 2 | loss: 0.2768163
	speed: 0.0826s/iter; left time: 743.3042s
	iters: 700, epoch: 2 | loss: 0.3684277
	speed: 0.0826s/iter; left time: 735.0755s
	iters: 800, epoch: 2 | loss: 0.3094136
	speed: 0.0826s/iter; left time: 726.6246s
	iters: 900, epoch: 2 | loss: 0.3833026
	speed: 0.0827s/iter; left time: 719.1193s
	iters: 1000, epoch: 2 | loss: 0.3577865
	speed: 0.0827s/iter; left time: 710.4483s
Epoch: 2 cost time: 88.06231021881104
Epoch: 2, Steps: 1066 | Train Loss: 0.3484323 Vali Loss: 1.0254357 Test Loss: 0.8274353
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2968383
	speed: 0.5178s/iter; left time: 4364.7483s
	iters: 200, epoch: 3 | loss: 0.3118861
	speed: 0.0826s/iter; left time: 687.6373s
	iters: 300, epoch: 3 | loss: 0.3291558
	speed: 0.0826s/iter; left time: 680.1255s
	iters: 400, epoch: 3 | loss: 0.3221340
	speed: 0.0825s/iter; left time: 670.9332s
	iters: 500, epoch: 3 | loss: 0.2941999
	speed: 0.0826s/iter; left time: 663.0828s
	iters: 600, epoch: 3 | loss: 0.2935253
	speed: 0.0825s/iter; left time: 654.5177s
	iters: 700, epoch: 3 | loss: 0.2758441
	speed: 0.0825s/iter; left time: 645.9664s
	iters: 800, epoch: 3 | loss: 0.2795102
	speed: 0.0825s/iter; left time: 637.6182s
	iters: 900, epoch: 3 | loss: 0.2821762
	speed: 0.0825s/iter; left time: 629.4630s
	iters: 1000, epoch: 3 | loss: 0.3231108
	speed: 0.0827s/iter; left time: 622.6856s
Epoch: 3 cost time: 88.02832770347595
Epoch: 3, Steps: 1066 | Train Loss: 0.3149982 Vali Loss: 1.0706513 Test Loss: 0.8316144
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3095343
	speed: 0.5168s/iter; left time: 3805.1269s
	iters: 200, epoch: 4 | loss: 0.2683262
	speed: 0.0825s/iter; left time: 598.8545s
	iters: 300, epoch: 4 | loss: 0.2657784
	speed: 0.0826s/iter; left time: 591.4200s
	iters: 400, epoch: 4 | loss: 0.2996835
	speed: 0.0829s/iter; left time: 585.5792s
	iters: 500, epoch: 4 | loss: 0.2752588
	speed: 0.0825s/iter; left time: 574.7830s
	iters: 600, epoch: 4 | loss: 0.2423192
	speed: 0.0824s/iter; left time: 565.6932s
	iters: 700, epoch: 4 | loss: 0.2827927
	speed: 0.0825s/iter; left time: 558.0580s
	iters: 800, epoch: 4 | loss: 0.2974325
	speed: 0.0824s/iter; left time: 549.2599s
	iters: 900, epoch: 4 | loss: 0.3042993
	speed: 0.0827s/iter; left time: 542.5332s
	iters: 1000, epoch: 4 | loss: 0.2832250
	speed: 0.0832s/iter; left time: 537.5059s
Epoch: 4 cost time: 88.08340311050415
Epoch: 4, Steps: 1066 | Train Loss: 0.2964910 Vali Loss: 1.0563031 Test Loss: 0.7797047
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : ETTm1_336_Autoformer_ETTm1_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed3144<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
mse:0.6960908770561218, mae:0.5472326278686523
