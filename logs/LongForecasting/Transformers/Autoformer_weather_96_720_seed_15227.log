Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=21, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=21, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Autoformer', model_id='weather_720', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=720, root_path='./dataset/', seed=15227, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_720_Autoformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed15227>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36072
val 4551
test 9820
	iters: 100, epoch: 1 | loss: 0.9758281
	speed: 0.1788s/iter; left time: 1997.6105s
	iters: 200, epoch: 1 | loss: 0.6862755
	speed: 0.1437s/iter; left time: 1590.5264s
	iters: 300, epoch: 1 | loss: 0.7536203
	speed: 0.1440s/iter; left time: 1579.8869s
	iters: 400, epoch: 1 | loss: 0.9272053
	speed: 0.1439s/iter; left time: 1564.0748s
	iters: 500, epoch: 1 | loss: 0.8517717
	speed: 0.1439s/iter; left time: 1550.2469s
	iters: 600, epoch: 1 | loss: 0.6977562
	speed: 0.1442s/iter; left time: 1538.7372s
	iters: 700, epoch: 1 | loss: 0.8447909
	speed: 0.1442s/iter; left time: 1524.4682s
	iters: 800, epoch: 1 | loss: 0.7015157
	speed: 0.1439s/iter; left time: 1506.6160s
	iters: 900, epoch: 1 | loss: 0.6390609
	speed: 0.1439s/iter; left time: 1492.2147s
	iters: 1000, epoch: 1 | loss: 0.7809209
	speed: 0.1440s/iter; left time: 1478.5409s
	iters: 1100, epoch: 1 | loss: 0.7594003
	speed: 0.1438s/iter; left time: 1462.8367s
Epoch: 1 cost time: 165.78199195861816
Epoch: 1, Steps: 1127 | Train Loss: 0.7895685 Vali Loss: 0.8254790 Test Loss: 0.4117279
Validation loss decreased (inf --> 0.825479).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.8720083
	speed: 0.6634s/iter; left time: 6663.0846s
	iters: 200, epoch: 2 | loss: 0.8176208
	speed: 0.1439s/iter; left time: 1430.7891s
	iters: 300, epoch: 2 | loss: 0.6817950
	speed: 0.1440s/iter; left time: 1417.0807s
	iters: 400, epoch: 2 | loss: 0.7280966
	speed: 0.1442s/iter; left time: 1405.2603s
	iters: 500, epoch: 2 | loss: 0.6191621
	speed: 0.1448s/iter; left time: 1396.5619s
	iters: 600, epoch: 2 | loss: 0.7550197
	speed: 0.1445s/iter; left time: 1378.8947s
	iters: 700, epoch: 2 | loss: 0.6925966
	speed: 0.1446s/iter; left time: 1365.4929s
	iters: 800, epoch: 2 | loss: 0.6368762
	speed: 0.1445s/iter; left time: 1350.0252s
	iters: 900, epoch: 2 | loss: 0.7745426
	speed: 0.1444s/iter; left time: 1335.2853s
	iters: 1000, epoch: 2 | loss: 0.8778669
	speed: 0.1441s/iter; left time: 1317.7963s
	iters: 1100, epoch: 2 | loss: 0.7461202
	speed: 0.1439s/iter; left time: 1301.0843s
Epoch: 2 cost time: 162.56659412384033
Epoch: 2, Steps: 1127 | Train Loss: 0.7525796 Vali Loss: 0.8225198 Test Loss: 0.4118954
Validation loss decreased (0.825479 --> 0.822520).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.8501784
	speed: 0.6686s/iter; left time: 5961.9822s
	iters: 200, epoch: 3 | loss: 0.6747560
	speed: 0.1443s/iter; left time: 1272.2201s
	iters: 300, epoch: 3 | loss: 0.6550088
	speed: 0.1442s/iter; left time: 1256.9864s
	iters: 400, epoch: 3 | loss: 0.7693456
	speed: 0.1437s/iter; left time: 1238.6751s
	iters: 500, epoch: 3 | loss: 0.7010817
	speed: 0.1437s/iter; left time: 1223.9644s
	iters: 600, epoch: 3 | loss: 0.7361086
	speed: 0.1437s/iter; left time: 1209.5955s
	iters: 700, epoch: 3 | loss: 0.6499478
	speed: 0.1437s/iter; left time: 1194.7614s
	iters: 800, epoch: 3 | loss: 0.6909344
	speed: 0.1437s/iter; left time: 1181.1082s
	iters: 900, epoch: 3 | loss: 0.6948563
	speed: 0.1439s/iter; left time: 1167.8661s
	iters: 1000, epoch: 3 | loss: 0.7696922
	speed: 0.1443s/iter; left time: 1157.2474s
	iters: 1100, epoch: 3 | loss: 0.6241363
	speed: 0.1447s/iter; left time: 1145.3855s
Epoch: 3 cost time: 162.28558468818665
Epoch: 3, Steps: 1127 | Train Loss: 0.7341224 Vali Loss: 0.7958330 Test Loss: 0.4030155
Validation loss decreased (0.822520 --> 0.795833).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.5638143
	speed: 0.6695s/iter; left time: 5215.6548s
	iters: 200, epoch: 4 | loss: 0.7447209
	speed: 0.1445s/iter; left time: 1111.4540s
	iters: 300, epoch: 4 | loss: 0.6148621
	speed: 0.1444s/iter; left time: 1096.3482s
	iters: 400, epoch: 4 | loss: 0.7741256
	speed: 0.1444s/iter; left time: 1081.4801s
	iters: 500, epoch: 4 | loss: 0.5380850
	speed: 0.1442s/iter; left time: 1065.4223s
	iters: 600, epoch: 4 | loss: 0.6074831
	speed: 0.1441s/iter; left time: 1050.3277s
	iters: 700, epoch: 4 | loss: 0.6430604
	speed: 0.1439s/iter; left time: 1034.5005s
	iters: 800, epoch: 4 | loss: 0.5333207
	speed: 0.1439s/iter; left time: 1019.9707s
	iters: 900, epoch: 4 | loss: 0.6519189
	speed: 0.1439s/iter; left time: 1005.6742s
	iters: 1000, epoch: 4 | loss: 0.8820456
	speed: 0.1437s/iter; left time: 990.2749s
	iters: 1100, epoch: 4 | loss: 0.6734076
	speed: 0.1440s/iter; left time: 977.7795s
Epoch: 4 cost time: 162.4175410270691
Epoch: 4, Steps: 1127 | Train Loss: 0.7035139 Vali Loss: 0.7923648 Test Loss: 0.4072626
Validation loss decreased (0.795833 --> 0.792365).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.8233911
	speed: 0.6681s/iter; left time: 4451.4546s
	iters: 200, epoch: 5 | loss: 0.6062106
	speed: 0.1435s/iter; left time: 941.8997s
	iters: 300, epoch: 5 | loss: 0.7271939
	speed: 0.1437s/iter; left time: 928.6773s
	iters: 400, epoch: 5 | loss: 0.6941808
	speed: 0.1437s/iter; left time: 914.3417s
	iters: 500, epoch: 5 | loss: 0.6933703
	speed: 0.1442s/iter; left time: 902.8198s
	iters: 600, epoch: 5 | loss: 0.8394806
	speed: 0.1445s/iter; left time: 890.6248s
	iters: 700, epoch: 5 | loss: 0.6418672
	speed: 0.1443s/iter; left time: 875.0937s
	iters: 800, epoch: 5 | loss: 0.5457602
	speed: 0.1438s/iter; left time: 857.4168s
	iters: 900, epoch: 5 | loss: 0.7666012
	speed: 0.1438s/iter; left time: 843.0892s
	iters: 1000, epoch: 5 | loss: 0.8064877
	speed: 0.1439s/iter; left time: 829.3339s
	iters: 1100, epoch: 5 | loss: 0.6969719
	speed: 0.1440s/iter; left time: 815.7357s
Epoch: 5 cost time: 162.17854642868042
Epoch: 5, Steps: 1127 | Train Loss: 0.6969146 Vali Loss: 0.7909870 Test Loss: 0.4061348
Validation loss decreased (0.792365 --> 0.790987).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.7487538
	speed: 0.6704s/iter; left time: 3711.4070s
	iters: 200, epoch: 6 | loss: 0.6070496
	speed: 0.1437s/iter; left time: 780.9935s
	iters: 300, epoch: 6 | loss: 0.5928035
	speed: 0.1437s/iter; left time: 766.6588s
	iters: 400, epoch: 6 | loss: 0.8459717
	speed: 0.1436s/iter; left time: 751.9988s
	iters: 500, epoch: 6 | loss: 0.7708693
	speed: 0.1439s/iter; left time: 738.9940s
	iters: 600, epoch: 6 | loss: 0.7686418
	speed: 0.1440s/iter; left time: 725.2145s
	iters: 700, epoch: 6 | loss: 0.7079200
	speed: 0.1441s/iter; left time: 711.3145s
	iters: 800, epoch: 6 | loss: 0.8421090
	speed: 0.1446s/iter; left time: 699.3656s
	iters: 900, epoch: 6 | loss: 0.7427924
	speed: 0.1445s/iter; left time: 684.5145s
	iters: 1000, epoch: 6 | loss: 0.6356393
	speed: 0.1437s/iter; left time: 666.0988s
	iters: 1100, epoch: 6 | loss: 0.7313251
	speed: 0.1437s/iter; left time: 651.7800s
Epoch: 6 cost time: 162.1951563358307
Epoch: 6, Steps: 1127 | Train Loss: 0.6937483 Vali Loss: 0.7915923 Test Loss: 0.4069066
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.7279741
	speed: 0.6661s/iter; left time: 2936.7628s
	iters: 200, epoch: 7 | loss: 0.5611598
	speed: 0.1445s/iter; left time: 622.7316s
	iters: 300, epoch: 7 | loss: 0.7826908
	speed: 0.1440s/iter; left time: 606.0171s
	iters: 400, epoch: 7 | loss: 0.7014399
	speed: 0.1437s/iter; left time: 590.3308s
	iters: 500, epoch: 7 | loss: 0.6522316
	speed: 0.1437s/iter; left time: 576.1662s
	iters: 600, epoch: 7 | loss: 0.6358643
	speed: 0.1439s/iter; left time: 562.6785s
	iters: 700, epoch: 7 | loss: 0.6481987
	speed: 0.1441s/iter; left time: 548.7173s
	iters: 800, epoch: 7 | loss: 0.5988848
	speed: 0.1443s/iter; left time: 535.3455s
	iters: 900, epoch: 7 | loss: 0.5834777
	speed: 0.1444s/iter; left time: 521.2461s
	iters: 1000, epoch: 7 | loss: 0.7465797
	speed: 0.1444s/iter; left time: 506.7940s
	iters: 1100, epoch: 7 | loss: 0.8019450
	speed: 0.1444s/iter; left time: 492.1515s
Epoch: 7 cost time: 162.44887018203735
Epoch: 7, Steps: 1127 | Train Loss: 0.6925385 Vali Loss: 0.7911903 Test Loss: 0.4069678
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.6143104
	speed: 0.6663s/iter; left time: 2186.6550s
	iters: 200, epoch: 8 | loss: 0.7487746
	speed: 0.1439s/iter; left time: 457.8541s
	iters: 300, epoch: 8 | loss: 0.6790711
	speed: 0.1443s/iter; left time: 444.7080s
	iters: 400, epoch: 8 | loss: 0.8297198
	speed: 0.1446s/iter; left time: 431.0723s
	iters: 500, epoch: 8 | loss: 0.7638209
	speed: 0.1441s/iter; left time: 415.1957s
	iters: 600, epoch: 8 | loss: 0.6754456
	speed: 0.1437s/iter; left time: 399.8544s
	iters: 700, epoch: 8 | loss: 0.8106951
	speed: 0.1436s/iter; left time: 385.2648s
	iters: 800, epoch: 8 | loss: 0.5097837
	speed: 0.1437s/iter; left time: 370.9656s
	iters: 900, epoch: 8 | loss: 0.5778346
	speed: 0.1437s/iter; left time: 356.7375s
	iters: 1000, epoch: 8 | loss: 0.5793490
	speed: 0.1438s/iter; left time: 342.5141s
	iters: 1100, epoch: 8 | loss: 0.5890414
	speed: 0.1441s/iter; left time: 328.8801s
Epoch: 8 cost time: 162.23178052902222
Epoch: 8, Steps: 1127 | Train Loss: 0.6917073 Vali Loss: 0.7911293 Test Loss: 0.4068656
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : weather_720_Autoformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed15227<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9820
mse:0.4059925377368927, mae:0.4150450825691223
