Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=21, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=21, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Autoformer', model_id='weather_192', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=192, root_path='./dataset/', seed=12890, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_192_Autoformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed12890>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36600
val 5079
test 10348
	iters: 100, epoch: 1 | loss: 0.5842049
	speed: 0.0960s/iter; left time: 1088.3161s
	iters: 200, epoch: 1 | loss: 0.4740855
	speed: 0.0622s/iter; left time: 698.6356s
	iters: 300, epoch: 1 | loss: 0.4465604
	speed: 0.0622s/iter; left time: 692.5516s
	iters: 400, epoch: 1 | loss: 0.9500969
	speed: 0.0622s/iter; left time: 686.6494s
	iters: 500, epoch: 1 | loss: 0.5331140
	speed: 0.0622s/iter; left time: 680.1599s
	iters: 600, epoch: 1 | loss: 0.4081821
	speed: 0.0619s/iter; left time: 669.9455s
	iters: 700, epoch: 1 | loss: 0.4871845
	speed: 0.0618s/iter; left time: 663.1558s
	iters: 800, epoch: 1 | loss: 1.0279796
	speed: 0.0618s/iter; left time: 656.8288s
	iters: 900, epoch: 1 | loss: 0.5940995
	speed: 0.0618s/iter; left time: 650.4015s
	iters: 1000, epoch: 1 | loss: 0.4719914
	speed: 0.0617s/iter; left time: 644.0058s
	iters: 1100, epoch: 1 | loss: 0.4005247
	speed: 0.0617s/iter; left time: 637.0257s
Epoch: 1 cost time: 74.2371916770935
Epoch: 1, Steps: 1143 | Train Loss: 0.6292284 Vali Loss: 0.6140672 Test Loss: 0.2898785
Validation loss decreased (inf --> 0.614067).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5238366
	speed: 0.2815s/iter; left time: 2867.9787s
	iters: 200, epoch: 2 | loss: 0.4881690
	speed: 0.0617s/iter; left time: 622.3128s
	iters: 300, epoch: 2 | loss: 0.8976614
	speed: 0.0617s/iter; left time: 616.4116s
	iters: 400, epoch: 2 | loss: 0.5652447
	speed: 0.0616s/iter; left time: 609.5520s
	iters: 500, epoch: 2 | loss: 0.8618557
	speed: 0.0616s/iter; left time: 603.3248s
	iters: 600, epoch: 2 | loss: 0.4042609
	speed: 0.0623s/iter; left time: 603.6700s
	iters: 700, epoch: 2 | loss: 0.3989860
	speed: 0.0623s/iter; left time: 597.8024s
	iters: 800, epoch: 2 | loss: 0.5043411
	speed: 0.0628s/iter; left time: 595.5227s
	iters: 900, epoch: 2 | loss: 0.5746085
	speed: 0.0625s/iter; left time: 587.0675s
	iters: 1000, epoch: 2 | loss: 0.7220865
	speed: 0.0625s/iter; left time: 580.3715s
	iters: 1100, epoch: 2 | loss: 0.5811932
	speed: 0.0617s/iter; left time: 566.9772s
Epoch: 2 cost time: 70.90820550918579
Epoch: 2, Steps: 1143 | Train Loss: 0.5848026 Vali Loss: 0.6219862 Test Loss: 0.2838739
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5580222
	speed: 0.2796s/iter; left time: 2529.0699s
	iters: 200, epoch: 3 | loss: 0.8877378
	speed: 0.0618s/iter; left time: 552.9460s
	iters: 300, epoch: 3 | loss: 0.3309670
	speed: 0.0617s/iter; left time: 545.9275s
	iters: 400, epoch: 3 | loss: 0.9809870
	speed: 0.0617s/iter; left time: 539.7973s
	iters: 500, epoch: 3 | loss: 0.9110570
	speed: 0.0618s/iter; left time: 534.6185s
	iters: 600, epoch: 3 | loss: 0.5889095
	speed: 0.0618s/iter; left time: 528.4544s
	iters: 700, epoch: 3 | loss: 0.4319731
	speed: 0.0619s/iter; left time: 522.7814s
	iters: 800, epoch: 3 | loss: 0.5320122
	speed: 0.0618s/iter; left time: 515.9632s
	iters: 900, epoch: 3 | loss: 0.4754048
	speed: 0.0620s/iter; left time: 511.4108s
	iters: 1000, epoch: 3 | loss: 0.7906886
	speed: 0.0619s/iter; left time: 503.9066s
	iters: 1100, epoch: 3 | loss: 0.7484934
	speed: 0.0622s/iter; left time: 500.1331s
Epoch: 3 cost time: 70.72683095932007
Epoch: 3, Steps: 1143 | Train Loss: 0.5570942 Vali Loss: 0.6259778 Test Loss: 0.3047551
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.5396809
	speed: 0.2838s/iter; left time: 2242.8296s
	iters: 200, epoch: 4 | loss: 0.4511413
	speed: 0.0618s/iter; left time: 482.4721s
	iters: 300, epoch: 4 | loss: 0.4742904
	speed: 0.0618s/iter; left time: 476.2033s
	iters: 400, epoch: 4 | loss: 0.3980646
	speed: 0.0617s/iter; left time: 469.2136s
	iters: 500, epoch: 4 | loss: 0.4635863
	speed: 0.0618s/iter; left time: 463.4346s
	iters: 600, epoch: 4 | loss: 0.9195498
	speed: 0.0618s/iter; left time: 457.2468s
	iters: 700, epoch: 4 | loss: 0.4554872
	speed: 0.0617s/iter; left time: 450.8121s
	iters: 800, epoch: 4 | loss: 0.5170617
	speed: 0.0617s/iter; left time: 444.6227s
	iters: 900, epoch: 4 | loss: 0.4632558
	speed: 0.0618s/iter; left time: 438.9526s
	iters: 1000, epoch: 4 | loss: 0.3563556
	speed: 0.0617s/iter; left time: 432.1898s
	iters: 1100, epoch: 4 | loss: 0.5109785
	speed: 0.0617s/iter; left time: 425.6478s
Epoch: 4 cost time: 70.59556174278259
Epoch: 4, Steps: 1143 | Train Loss: 0.5395617 Vali Loss: 0.6309288 Test Loss: 0.3094312
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : weather_192_Autoformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed12890<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10348
mse:0.2902284860610962, mae:0.34795817732810974
