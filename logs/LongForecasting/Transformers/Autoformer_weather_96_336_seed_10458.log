Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=21, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=21, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Autoformer', model_id='weather_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=336, root_path='./dataset/', seed=10458, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_336_Autoformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed10458>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36456
val 4935
test 10204
	iters: 100, epoch: 1 | loss: 0.5669912
	speed: 0.1176s/iter; left time: 1327.6422s
	iters: 200, epoch: 1 | loss: 0.7747712
	speed: 0.0834s/iter; left time: 933.6197s
	iters: 300, epoch: 1 | loss: 0.6579581
	speed: 0.0841s/iter; left time: 932.2981s
	iters: 400, epoch: 1 | loss: 0.7431350
	speed: 0.0837s/iter; left time: 919.8422s
	iters: 500, epoch: 1 | loss: 0.6581856
	speed: 0.0836s/iter; left time: 910.7509s
	iters: 600, epoch: 1 | loss: 0.6203251
	speed: 0.0839s/iter; left time: 905.4088s
	iters: 700, epoch: 1 | loss: 0.5491134
	speed: 0.0840s/iter; left time: 898.3232s
	iters: 800, epoch: 1 | loss: 0.6504803
	speed: 0.0843s/iter; left time: 892.4486s
	iters: 900, epoch: 1 | loss: 0.5219661
	speed: 0.0839s/iter; left time: 880.6758s
	iters: 1000, epoch: 1 | loss: 0.7898197
	speed: 0.0834s/iter; left time: 866.3507s
	iters: 1100, epoch: 1 | loss: 0.5860959
	speed: 0.0833s/iter; left time: 857.2554s
Epoch: 1 cost time: 98.81851029396057
Epoch: 1, Steps: 1139 | Train Loss: 0.6606534 Vali Loss: 0.6848031 Test Loss: 0.3433507
Validation loss decreased (inf --> 0.684803).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5970330
	speed: 0.3770s/iter; left time: 3827.0750s
	iters: 200, epoch: 2 | loss: 0.5036889
	speed: 0.0833s/iter; left time: 837.3321s
	iters: 300, epoch: 2 | loss: 0.4731865
	speed: 0.0832s/iter; left time: 828.2109s
	iters: 400, epoch: 2 | loss: 0.5493834
	speed: 0.0831s/iter; left time: 818.8822s
	iters: 500, epoch: 2 | loss: 0.4709608
	speed: 0.0832s/iter; left time: 810.9939s
	iters: 600, epoch: 2 | loss: 0.5695279
	speed: 0.0832s/iter; left time: 803.3581s
	iters: 700, epoch: 2 | loss: 0.6036435
	speed: 0.0832s/iter; left time: 794.8371s
	iters: 800, epoch: 2 | loss: 0.5490632
	speed: 0.0832s/iter; left time: 786.7579s
	iters: 900, epoch: 2 | loss: 0.5363021
	speed: 0.0833s/iter; left time: 778.9569s
	iters: 1000, epoch: 2 | loss: 0.8010461
	speed: 0.0831s/iter; left time: 768.3885s
	iters: 1100, epoch: 2 | loss: 0.5945560
	speed: 0.0832s/iter; left time: 761.5929s
Epoch: 2 cost time: 94.79774260520935
Epoch: 2, Steps: 1139 | Train Loss: 0.6198784 Vali Loss: 0.6811854 Test Loss: 0.3550036
Validation loss decreased (0.684803 --> 0.681185).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.6178858
	speed: 0.3777s/iter; left time: 3404.0737s
	iters: 200, epoch: 3 | loss: 0.5662359
	speed: 0.0833s/iter; left time: 742.7860s
	iters: 300, epoch: 3 | loss: 0.6867118
	speed: 0.0835s/iter; left time: 735.7720s
	iters: 400, epoch: 3 | loss: 0.4499076
	speed: 0.0834s/iter; left time: 726.4372s
	iters: 500, epoch: 3 | loss: 0.4468731
	speed: 0.0834s/iter; left time: 717.9130s
	iters: 600, epoch: 3 | loss: 0.8496702
	speed: 0.0835s/iter; left time: 710.9210s
	iters: 700, epoch: 3 | loss: 0.7095426
	speed: 0.0836s/iter; left time: 703.1986s
	iters: 800, epoch: 3 | loss: 0.6345702
	speed: 0.0835s/iter; left time: 694.2658s
	iters: 900, epoch: 3 | loss: 0.7417987
	speed: 0.0834s/iter; left time: 684.9573s
	iters: 1000, epoch: 3 | loss: 0.5009091
	speed: 0.0834s/iter; left time: 676.6501s
	iters: 1100, epoch: 3 | loss: 0.4434896
	speed: 0.0833s/iter; left time: 667.6576s
Epoch: 3 cost time: 95.0071051120758
Epoch: 3, Steps: 1139 | Train Loss: 0.5997723 Vali Loss: 0.6797569 Test Loss: 0.3644452
Validation loss decreased (0.681185 --> 0.679757).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.6159297
	speed: 0.3768s/iter; left time: 2967.2462s
	iters: 200, epoch: 4 | loss: 1.0315009
	speed: 0.0833s/iter; left time: 647.5299s
	iters: 300, epoch: 4 | loss: 0.5193093
	speed: 0.0835s/iter; left time: 641.1567s
	iters: 400, epoch: 4 | loss: 0.7721656
	speed: 0.0835s/iter; left time: 632.3408s
	iters: 500, epoch: 4 | loss: 0.4920903
	speed: 0.0836s/iter; left time: 624.6224s
	iters: 600, epoch: 4 | loss: 0.5477300
	speed: 0.0836s/iter; left time: 616.2294s
	iters: 700, epoch: 4 | loss: 1.2620609
	speed: 0.0838s/iter; left time: 609.8750s
	iters: 800, epoch: 4 | loss: 0.8569797
	speed: 0.0836s/iter; left time: 600.0409s
	iters: 900, epoch: 4 | loss: 0.5959885
	speed: 0.0835s/iter; left time: 590.8851s
	iters: 1000, epoch: 4 | loss: 0.5417860
	speed: 0.0831s/iter; left time: 579.2826s
	iters: 1100, epoch: 4 | loss: 0.6777167
	speed: 0.0831s/iter; left time: 571.2268s
Epoch: 4 cost time: 95.03951001167297
Epoch: 4, Steps: 1139 | Train Loss: 0.5726793 Vali Loss: 0.6715282 Test Loss: 0.3744842
Validation loss decreased (0.679757 --> 0.671528).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4460777
	speed: 0.3773s/iter; left time: 2541.4214s
	iters: 200, epoch: 5 | loss: 0.4290249
	speed: 0.0831s/iter; left time: 551.5397s
	iters: 300, epoch: 5 | loss: 0.5142715
	speed: 0.0834s/iter; left time: 544.7359s
	iters: 400, epoch: 5 | loss: 0.4447044
	speed: 0.0832s/iter; left time: 535.0836s
	iters: 500, epoch: 5 | loss: 0.7240213
	speed: 0.0833s/iter; left time: 527.5363s
	iters: 600, epoch: 5 | loss: 0.4874002
	speed: 0.0833s/iter; left time: 519.2518s
	iters: 700, epoch: 5 | loss: 0.3631572
	speed: 0.0833s/iter; left time: 510.8041s
	iters: 800, epoch: 5 | loss: 0.5438117
	speed: 0.0832s/iter; left time: 502.0427s
	iters: 900, epoch: 5 | loss: 0.4370975
	speed: 0.0832s/iter; left time: 493.7162s
	iters: 1000, epoch: 5 | loss: 0.4445123
	speed: 0.0834s/iter; left time: 486.3690s
	iters: 1100, epoch: 5 | loss: 0.7952627
	speed: 0.0832s/iter; left time: 477.0965s
Epoch: 5 cost time: 94.82019901275635
Epoch: 5, Steps: 1139 | Train Loss: 0.5585226 Vali Loss: 0.6714615 Test Loss: 0.3689686
Validation loss decreased (0.671528 --> 0.671462).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4750784
	speed: 0.3783s/iter; left time: 2116.7064s
	iters: 200, epoch: 6 | loss: 0.6578743
	speed: 0.0833s/iter; left time: 458.0606s
	iters: 300, epoch: 6 | loss: 0.4768535
	speed: 0.0835s/iter; left time: 450.7965s
	iters: 400, epoch: 6 | loss: 0.6673058
	speed: 0.0835s/iter; left time: 442.4557s
	iters: 500, epoch: 6 | loss: 0.6021258
	speed: 0.0834s/iter; left time: 433.2986s
	iters: 600, epoch: 6 | loss: 0.7615869
	speed: 0.0835s/iter; left time: 425.4628s
	iters: 700, epoch: 6 | loss: 0.8985102
	speed: 0.0834s/iter; left time: 416.8363s
	iters: 800, epoch: 6 | loss: 0.3807491
	speed: 0.0835s/iter; left time: 408.9978s
	iters: 900, epoch: 6 | loss: 0.4762823
	speed: 0.0834s/iter; left time: 399.9932s
	iters: 1000, epoch: 6 | loss: 0.4308940
	speed: 0.0834s/iter; left time: 391.4815s
	iters: 1100, epoch: 6 | loss: 0.7148967
	speed: 0.0833s/iter; left time: 382.8092s
Epoch: 6 cost time: 95.00720047950745
Epoch: 6, Steps: 1139 | Train Loss: 0.5519319 Vali Loss: 0.6703650 Test Loss: 0.3725816
Validation loss decreased (0.671462 --> 0.670365).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.4258664
	speed: 0.3769s/iter; left time: 1679.7936s
	iters: 200, epoch: 7 | loss: 0.6790486
	speed: 0.0836s/iter; left time: 364.1482s
	iters: 300, epoch: 7 | loss: 0.5212431
	speed: 0.0836s/iter; left time: 355.8218s
	iters: 400, epoch: 7 | loss: 0.4706030
	speed: 0.0835s/iter; left time: 347.0689s
	iters: 500, epoch: 7 | loss: 0.4421008
	speed: 0.0837s/iter; left time: 339.7317s
	iters: 600, epoch: 7 | loss: 0.3823729
	speed: 0.0842s/iter; left time: 333.1273s
	iters: 700, epoch: 7 | loss: 0.8689986
	speed: 0.0838s/iter; left time: 323.2289s
	iters: 800, epoch: 7 | loss: 0.4780305
	speed: 0.0838s/iter; left time: 314.9378s
	iters: 900, epoch: 7 | loss: 0.5202481
	speed: 0.0834s/iter; left time: 304.9305s
	iters: 1000, epoch: 7 | loss: 0.5586212
	speed: 0.0832s/iter; left time: 295.7718s
	iters: 1100, epoch: 7 | loss: 0.4660369
	speed: 0.0833s/iter; left time: 287.9250s
Epoch: 7 cost time: 95.17798972129822
Epoch: 7, Steps: 1139 | Train Loss: 0.5489855 Vali Loss: 0.6705748 Test Loss: 0.3713986
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.6161574
	speed: 0.3746s/iter; left time: 1242.7773s
	iters: 200, epoch: 8 | loss: 0.4006999
	speed: 0.0831s/iter; left time: 267.3237s
	iters: 300, epoch: 8 | loss: 0.8718874
	speed: 0.0832s/iter; left time: 259.3623s
	iters: 400, epoch: 8 | loss: 0.4584212
	speed: 0.0832s/iter; left time: 250.9568s
	iters: 500, epoch: 8 | loss: 0.4201355
	speed: 0.0833s/iter; left time: 243.0058s
	iters: 600, epoch: 8 | loss: 0.6823243
	speed: 0.0834s/iter; left time: 234.9006s
	iters: 700, epoch: 8 | loss: 0.4303791
	speed: 0.0834s/iter; left time: 226.5539s
	iters: 800, epoch: 8 | loss: 0.7755233
	speed: 0.0833s/iter; left time: 217.9530s
	iters: 900, epoch: 8 | loss: 0.4711978
	speed: 0.0832s/iter; left time: 209.4410s
	iters: 1000, epoch: 8 | loss: 0.4498101
	speed: 0.0833s/iter; left time: 201.3936s
	iters: 1100, epoch: 8 | loss: 0.6320679
	speed: 0.0834s/iter; left time: 193.2765s
Epoch: 8 cost time: 94.79667067527771
Epoch: 8, Steps: 1139 | Train Loss: 0.5471119 Vali Loss: 0.6725551 Test Loss: 0.3729212
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.5436534
	speed: 0.3757s/iter; left time: 818.5993s
	iters: 200, epoch: 9 | loss: 0.4878138
	speed: 0.0835s/iter; left time: 173.5340s
	iters: 300, epoch: 9 | loss: 0.4596496
	speed: 0.0836s/iter; left time: 165.4786s
	iters: 400, epoch: 9 | loss: 0.5399277
	speed: 0.0836s/iter; left time: 156.9955s
	iters: 500, epoch: 9 | loss: 0.4679491
	speed: 0.0836s/iter; left time: 148.7839s
	iters: 600, epoch: 9 | loss: 0.3980473
	speed: 0.0836s/iter; left time: 140.3580s
	iters: 700, epoch: 9 | loss: 0.7235601
	speed: 0.0835s/iter; left time: 131.9230s
	iters: 800, epoch: 9 | loss: 0.5380499
	speed: 0.0836s/iter; left time: 123.5830s
	iters: 900, epoch: 9 | loss: 0.3791445
	speed: 0.0833s/iter; left time: 114.8509s
	iters: 1000, epoch: 9 | loss: 0.4578556
	speed: 0.0835s/iter; left time: 106.7393s
	iters: 1100, epoch: 9 | loss: 0.4318716
	speed: 0.0833s/iter; left time: 98.1863s
Epoch: 9 cost time: 95.08031582832336
Epoch: 9, Steps: 1139 | Train Loss: 0.5463503 Vali Loss: 0.6725715 Test Loss: 0.3745114
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : weather_336_Autoformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed10458<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10204
mse:0.3726108968257904, mae:0.40908950567245483
