Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=21, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=21, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Transformer', model_id='weather_192', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=192, root_path='./dataset/', seed=15227, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_192_Transformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed15227>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36600
val 5079
test 10348
	iters: 100, epoch: 1 | loss: 0.2862886
	speed: 0.0627s/iter; left time: 710.7878s
	iters: 200, epoch: 1 | loss: 0.3431012
	speed: 0.0323s/iter; left time: 362.2784s
	iters: 300, epoch: 1 | loss: 0.7822262
	speed: 0.0323s/iter; left time: 359.3693s
	iters: 400, epoch: 1 | loss: 0.4211346
	speed: 0.0323s/iter; left time: 355.8992s
	iters: 500, epoch: 1 | loss: 0.7022198
	speed: 0.0323s/iter; left time: 352.7780s
	iters: 600, epoch: 1 | loss: 0.5974786
	speed: 0.0323s/iter; left time: 349.8625s
	iters: 700, epoch: 1 | loss: 0.2508547
	speed: 0.0322s/iter; left time: 345.9892s
	iters: 800, epoch: 1 | loss: 0.2300997
	speed: 0.0322s/iter; left time: 342.5600s
	iters: 900, epoch: 1 | loss: 0.2975420
	speed: 0.0323s/iter; left time: 339.8215s
	iters: 1000, epoch: 1 | loss: 0.2959594
	speed: 0.0322s/iter; left time: 335.9156s
	iters: 1100, epoch: 1 | loss: 0.2329792
	speed: 0.0323s/iter; left time: 333.3432s
Epoch: 1 cost time: 39.924755811691284
Epoch: 1, Steps: 1143 | Train Loss: 0.3927522 Vali Loss: 0.6484640 Test Loss: 0.5593992
Validation loss decreased (inf --> 0.648464).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2841841
	speed: 0.0999s/iter; left time: 1017.7637s
	iters: 200, epoch: 2 | loss: 0.2569023
	speed: 0.0324s/iter; left time: 327.1140s
	iters: 300, epoch: 2 | loss: 0.2664896
	speed: 0.0323s/iter; left time: 323.0797s
	iters: 400, epoch: 2 | loss: 0.3609323
	speed: 0.0323s/iter; left time: 319.1988s
	iters: 500, epoch: 2 | loss: 0.2057846
	speed: 0.0323s/iter; left time: 315.7120s
	iters: 600, epoch: 2 | loss: 0.5854471
	speed: 0.0322s/iter; left time: 312.0951s
	iters: 700, epoch: 2 | loss: 0.1631376
	speed: 0.0322s/iter; left time: 308.9895s
	iters: 800, epoch: 2 | loss: 0.4990657
	speed: 0.0323s/iter; left time: 306.1945s
	iters: 900, epoch: 2 | loss: 0.1560017
	speed: 0.0323s/iter; left time: 302.9556s
	iters: 1000, epoch: 2 | loss: 0.2306759
	speed: 0.0322s/iter; left time: 299.0077s
	iters: 1100, epoch: 2 | loss: 0.1878373
	speed: 0.0322s/iter; left time: 296.0673s
Epoch: 2 cost time: 36.87876296043396
Epoch: 2, Steps: 1143 | Train Loss: 0.2765307 Vali Loss: 0.6652958 Test Loss: 0.7011787
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2565658
	speed: 0.0973s/iter; left time: 880.3785s
	iters: 200, epoch: 3 | loss: 0.2620458
	speed: 0.0322s/iter; left time: 287.7050s
	iters: 300, epoch: 3 | loss: 0.1587655
	speed: 0.0322s/iter; left time: 284.4803s
	iters: 400, epoch: 3 | loss: 0.1880587
	speed: 0.0322s/iter; left time: 281.1771s
	iters: 500, epoch: 3 | loss: 0.1663266
	speed: 0.0322s/iter; left time: 278.3675s
	iters: 600, epoch: 3 | loss: 0.2077482
	speed: 0.0322s/iter; left time: 275.4124s
	iters: 700, epoch: 3 | loss: 0.2400937
	speed: 0.0322s/iter; left time: 272.1184s
	iters: 800, epoch: 3 | loss: 0.1432119
	speed: 0.0322s/iter; left time: 268.6523s
	iters: 900, epoch: 3 | loss: 0.2347874
	speed: 0.0322s/iter; left time: 265.4501s
	iters: 1000, epoch: 3 | loss: 0.1151248
	speed: 0.0322s/iter; left time: 262.2690s
	iters: 1100, epoch: 3 | loss: 0.4159742
	speed: 0.0322s/iter; left time: 258.9952s
Epoch: 3 cost time: 36.781951665878296
Epoch: 3, Steps: 1143 | Train Loss: 0.2242347 Vali Loss: 0.6367643 Test Loss: 0.6403725
Validation loss decreased (0.648464 --> 0.636764).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1306657
	speed: 0.0989s/iter; left time: 781.5503s
	iters: 200, epoch: 4 | loss: 0.1645974
	speed: 0.0322s/iter; left time: 251.2085s
	iters: 300, epoch: 4 | loss: 0.1426470
	speed: 0.0322s/iter; left time: 247.7339s
	iters: 400, epoch: 4 | loss: 0.1320231
	speed: 0.0322s/iter; left time: 244.5343s
	iters: 500, epoch: 4 | loss: 0.1672569
	speed: 0.0322s/iter; left time: 241.6635s
	iters: 600, epoch: 4 | loss: 0.1958026
	speed: 0.0322s/iter; left time: 238.0315s
	iters: 700, epoch: 4 | loss: 0.1597057
	speed: 0.0321s/iter; left time: 234.4182s
	iters: 800, epoch: 4 | loss: 0.1057367
	speed: 0.0321s/iter; left time: 230.9893s
	iters: 900, epoch: 4 | loss: 0.1237145
	speed: 0.0321s/iter; left time: 227.8687s
	iters: 1000, epoch: 4 | loss: 0.1469083
	speed: 0.0321s/iter; left time: 224.7158s
	iters: 1100, epoch: 4 | loss: 0.1876207
	speed: 0.0321s/iter; left time: 221.4441s
Epoch: 4 cost time: 36.72002553939819
Epoch: 4, Steps: 1143 | Train Loss: 0.2036553 Vali Loss: 0.6475940 Test Loss: 0.6423830
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1281219
	speed: 0.0970s/iter; left time: 655.5885s
	iters: 200, epoch: 5 | loss: 0.1519931
	speed: 0.0321s/iter; left time: 213.5293s
	iters: 300, epoch: 5 | loss: 0.1591471
	speed: 0.0322s/iter; left time: 211.0868s
	iters: 400, epoch: 5 | loss: 0.1786974
	speed: 0.0322s/iter; left time: 207.8867s
	iters: 500, epoch: 5 | loss: 0.4203145
	speed: 0.0322s/iter; left time: 204.5925s
	iters: 600, epoch: 5 | loss: 0.4014212
	speed: 0.0321s/iter; left time: 201.1231s
	iters: 700, epoch: 5 | loss: 0.1505761
	speed: 0.0322s/iter; left time: 198.3500s
	iters: 800, epoch: 5 | loss: 0.1864645
	speed: 0.0322s/iter; left time: 195.0962s
	iters: 900, epoch: 5 | loss: 0.1008036
	speed: 0.0322s/iter; left time: 191.5982s
	iters: 1000, epoch: 5 | loss: 0.1981467
	speed: 0.0322s/iter; left time: 188.6495s
	iters: 1100, epoch: 5 | loss: 0.2332669
	speed: 0.0323s/iter; left time: 186.1169s
Epoch: 5 cost time: 36.76512002944946
Epoch: 5, Steps: 1143 | Train Loss: 0.1935204 Vali Loss: 0.6377190 Test Loss: 0.6138006
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1821298
	speed: 0.0970s/iter; left time: 544.8020s
	iters: 200, epoch: 6 | loss: 0.1381346
	speed: 0.0321s/iter; left time: 177.1351s
	iters: 300, epoch: 6 | loss: 0.1224820
	speed: 0.0321s/iter; left time: 174.0333s
	iters: 400, epoch: 6 | loss: 0.1062724
	speed: 0.0321s/iter; left time: 170.6236s
	iters: 500, epoch: 6 | loss: 0.1812890
	speed: 0.0321s/iter; left time: 167.5850s
	iters: 600, epoch: 6 | loss: 0.1207251
	speed: 0.0321s/iter; left time: 164.4564s
	iters: 700, epoch: 6 | loss: 0.0973511
	speed: 0.0321s/iter; left time: 161.1595s
	iters: 800, epoch: 6 | loss: 0.2044094
	speed: 0.0321s/iter; left time: 157.9409s
	iters: 900, epoch: 6 | loss: 0.3739273
	speed: 0.0321s/iter; left time: 154.3580s
	iters: 1000, epoch: 6 | loss: 0.1379905
	speed: 0.0321s/iter; left time: 151.3056s
	iters: 1100, epoch: 6 | loss: 0.1404279
	speed: 0.0321s/iter; left time: 148.0976s
Epoch: 6 cost time: 36.690388679504395
Epoch: 6, Steps: 1143 | Train Loss: 0.1879779 Vali Loss: 0.6424893 Test Loss: 0.6210006
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : weather_192_Transformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed15227<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10348
mse:0.6405823230743408, mae:0.5515969395637512
