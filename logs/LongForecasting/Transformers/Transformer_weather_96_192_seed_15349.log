Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=21, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=21, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Transformer', model_id='weather_192', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=192, root_path='./dataset/', seed=15349, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_192_Transformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed15349>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36600
val 5079
test 10348
	iters: 100, epoch: 1 | loss: 0.3323655
	speed: 0.0621s/iter; left time: 703.9428s
	iters: 200, epoch: 1 | loss: 0.3734286
	speed: 0.0322s/iter; left time: 361.0780s
	iters: 300, epoch: 1 | loss: 0.4650337
	speed: 0.0322s/iter; left time: 358.5847s
	iters: 400, epoch: 1 | loss: 0.3121342
	speed: 0.0323s/iter; left time: 356.6588s
	iters: 500, epoch: 1 | loss: 0.2639456
	speed: 0.0323s/iter; left time: 352.9369s
	iters: 600, epoch: 1 | loss: 0.4371521
	speed: 0.0324s/iter; left time: 350.7736s
	iters: 700, epoch: 1 | loss: 0.7589712
	speed: 0.0324s/iter; left time: 347.6393s
	iters: 800, epoch: 1 | loss: 0.2390739
	speed: 0.0324s/iter; left time: 344.2016s
	iters: 900, epoch: 1 | loss: 0.3104122
	speed: 0.0324s/iter; left time: 340.8913s
	iters: 1000, epoch: 1 | loss: 0.1921818
	speed: 0.0324s/iter; left time: 337.8261s
	iters: 1100, epoch: 1 | loss: 0.2689591
	speed: 0.0324s/iter; left time: 334.2292s
Epoch: 1 cost time: 39.939797163009644
Epoch: 1, Steps: 1143 | Train Loss: 0.3941965 Vali Loss: 0.6313751 Test Loss: 0.5749894
Validation loss decreased (inf --> 0.631375).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1902229
	speed: 0.1001s/iter; left time: 1020.1731s
	iters: 200, epoch: 2 | loss: 0.2015956
	speed: 0.0322s/iter; left time: 324.8234s
	iters: 300, epoch: 2 | loss: 0.5684814
	speed: 0.0322s/iter; left time: 322.0340s
	iters: 400, epoch: 2 | loss: 0.1840127
	speed: 0.0322s/iter; left time: 318.4777s
	iters: 500, epoch: 2 | loss: 0.2062023
	speed: 0.0322s/iter; left time: 315.4806s
	iters: 600, epoch: 2 | loss: 0.1939640
	speed: 0.0322s/iter; left time: 312.1752s
	iters: 700, epoch: 2 | loss: 0.2164194
	speed: 0.0323s/iter; left time: 309.3679s
	iters: 800, epoch: 2 | loss: 0.1584200
	speed: 0.0322s/iter; left time: 305.8584s
	iters: 900, epoch: 2 | loss: 0.1923797
	speed: 0.0323s/iter; left time: 302.7849s
	iters: 1000, epoch: 2 | loss: 0.2180723
	speed: 0.0323s/iter; left time: 299.5596s
	iters: 1100, epoch: 2 | loss: 0.4689254
	speed: 0.0323s/iter; left time: 296.5190s
Epoch: 2 cost time: 36.83613634109497
Epoch: 2, Steps: 1143 | Train Loss: 0.2746277 Vali Loss: 0.6791057 Test Loss: 0.6141085
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4718711
	speed: 0.0975s/iter; left time: 882.0393s
	iters: 200, epoch: 3 | loss: 0.1520724
	speed: 0.0322s/iter; left time: 288.0799s
	iters: 300, epoch: 3 | loss: 0.7661583
	speed: 0.0322s/iter; left time: 285.0362s
	iters: 400, epoch: 3 | loss: 0.1851721
	speed: 0.0322s/iter; left time: 281.8809s
	iters: 500, epoch: 3 | loss: 0.1151709
	speed: 0.0322s/iter; left time: 278.7282s
	iters: 600, epoch: 3 | loss: 0.2142517
	speed: 0.0323s/iter; left time: 275.6163s
	iters: 700, epoch: 3 | loss: 0.1270431
	speed: 0.0323s/iter; left time: 272.6882s
	iters: 800, epoch: 3 | loss: 0.1268923
	speed: 0.0323s/iter; left time: 269.4539s
	iters: 900, epoch: 3 | loss: 0.4459691
	speed: 0.0322s/iter; left time: 265.7610s
	iters: 1000, epoch: 3 | loss: 0.1337960
	speed: 0.0323s/iter; left time: 263.0217s
	iters: 1100, epoch: 3 | loss: 0.2170350
	speed: 0.0323s/iter; left time: 259.9530s
Epoch: 3 cost time: 36.85560917854309
Epoch: 3, Steps: 1143 | Train Loss: 0.2229926 Vali Loss: 0.6583876 Test Loss: 0.6221770
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1662291
	speed: 0.0975s/iter; left time: 770.2433s
	iters: 200, epoch: 4 | loss: 0.1840558
	speed: 0.0323s/iter; left time: 251.9505s
	iters: 300, epoch: 4 | loss: 0.1613168
	speed: 0.0322s/iter; left time: 248.2556s
	iters: 400, epoch: 4 | loss: 0.1505626
	speed: 0.0323s/iter; left time: 245.2361s
	iters: 500, epoch: 4 | loss: 0.1586589
	speed: 0.0323s/iter; left time: 242.0962s
	iters: 600, epoch: 4 | loss: 0.1089474
	speed: 0.0323s/iter; left time: 238.7984s
	iters: 700, epoch: 4 | loss: 0.1728746
	speed: 0.0323s/iter; left time: 235.5793s
	iters: 800, epoch: 4 | loss: 0.1310761
	speed: 0.0323s/iter; left time: 232.3349s
	iters: 900, epoch: 4 | loss: 0.2082940
	speed: 0.0323s/iter; left time: 229.0576s
	iters: 1000, epoch: 4 | loss: 0.1850123
	speed: 0.0323s/iter; left time: 225.9006s
	iters: 1100, epoch: 4 | loss: 0.1523820
	speed: 0.0322s/iter; left time: 222.3890s
Epoch: 4 cost time: 36.86138296127319
Epoch: 4, Steps: 1143 | Train Loss: 0.2026919 Vali Loss: 0.6517837 Test Loss: 0.5897707
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : weather_192_Transformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed15349<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10348
mse:0.5752285718917847, mae:0.5452607274055481
