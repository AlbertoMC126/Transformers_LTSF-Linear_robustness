Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=21, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=21, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Autoformer', model_id='weather_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=336, root_path='./dataset/', seed=15726, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_336_Autoformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed15726>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36456
val 4935
test 10204
	iters: 100, epoch: 1 | loss: 0.8831581
	speed: 0.1169s/iter; left time: 1319.4063s
	iters: 200, epoch: 1 | loss: 0.6956688
	speed: 0.0828s/iter; left time: 926.9782s
	iters: 300, epoch: 1 | loss: 0.5772908
	speed: 0.0830s/iter; left time: 920.1821s
	iters: 400, epoch: 1 | loss: 0.6451089
	speed: 0.0830s/iter; left time: 911.7166s
	iters: 500, epoch: 1 | loss: 0.8239362
	speed: 0.0830s/iter; left time: 904.1778s
	iters: 600, epoch: 1 | loss: 0.4717421
	speed: 0.0831s/iter; left time: 896.7605s
	iters: 700, epoch: 1 | loss: 0.8254200
	speed: 0.0831s/iter; left time: 888.3254s
	iters: 800, epoch: 1 | loss: 0.8674917
	speed: 0.0831s/iter; left time: 880.1324s
	iters: 900, epoch: 1 | loss: 0.8865789
	speed: 0.0831s/iter; left time: 872.0738s
	iters: 1000, epoch: 1 | loss: 0.5602515
	speed: 0.0834s/iter; left time: 866.0926s
	iters: 1100, epoch: 1 | loss: 0.6117833
	speed: 0.0833s/iter; left time: 857.5943s
Epoch: 1 cost time: 98.0661838054657
Epoch: 1, Steps: 1139 | Train Loss: 0.6609929 Vali Loss: 0.6962359 Test Loss: 0.3892842
Validation loss decreased (inf --> 0.696236).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6789538
	speed: 0.3901s/iter; left time: 3960.1043s
	iters: 200, epoch: 2 | loss: 0.5526640
	speed: 0.0832s/iter; left time: 836.7545s
	iters: 300, epoch: 2 | loss: 0.4445899
	speed: 0.0833s/iter; left time: 828.5929s
	iters: 400, epoch: 2 | loss: 0.4956146
	speed: 0.0833s/iter; left time: 821.0624s
	iters: 500, epoch: 2 | loss: 0.5400876
	speed: 0.0834s/iter; left time: 813.4085s
	iters: 600, epoch: 2 | loss: 0.7707552
	speed: 0.0835s/iter; left time: 805.6787s
	iters: 700, epoch: 2 | loss: 0.4481042
	speed: 0.0835s/iter; left time: 797.7245s
	iters: 800, epoch: 2 | loss: 0.5996217
	speed: 0.0834s/iter; left time: 788.0697s
	iters: 900, epoch: 2 | loss: 0.4099532
	speed: 0.0833s/iter; left time: 779.3102s
	iters: 1000, epoch: 2 | loss: 0.4761670
	speed: 0.0834s/iter; left time: 771.1816s
	iters: 1100, epoch: 2 | loss: 0.6372821
	speed: 0.0834s/iter; left time: 763.4554s
Epoch: 2 cost time: 94.93614292144775
Epoch: 2, Steps: 1139 | Train Loss: 0.5955088 Vali Loss: 0.6793965 Test Loss: 0.3776730
Validation loss decreased (0.696236 --> 0.679397).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5533525
	speed: 0.3898s/iter; left time: 3512.9937s
	iters: 200, epoch: 3 | loss: 0.4487376
	speed: 0.0831s/iter; left time: 740.9714s
	iters: 300, epoch: 3 | loss: 0.4249686
	speed: 0.0831s/iter; left time: 732.1248s
	iters: 400, epoch: 3 | loss: 0.4585770
	speed: 0.0833s/iter; left time: 725.6168s
	iters: 500, epoch: 3 | loss: 0.7645379
	speed: 0.0832s/iter; left time: 716.4658s
	iters: 600, epoch: 3 | loss: 0.5165442
	speed: 0.0832s/iter; left time: 707.9521s
	iters: 700, epoch: 3 | loss: 0.6970412
	speed: 0.0832s/iter; left time: 699.6755s
	iters: 800, epoch: 3 | loss: 0.7036099
	speed: 0.0831s/iter; left time: 691.0209s
	iters: 900, epoch: 3 | loss: 0.4582021
	speed: 0.0833s/iter; left time: 684.1172s
	iters: 1000, epoch: 3 | loss: 0.4909039
	speed: 0.0833s/iter; left time: 675.9602s
	iters: 1100, epoch: 3 | loss: 0.5356496
	speed: 0.0833s/iter; left time: 667.2335s
Epoch: 3 cost time: 94.75866103172302
Epoch: 3, Steps: 1139 | Train Loss: 0.5677949 Vali Loss: 0.6866250 Test Loss: 0.3877166
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.6765113
	speed: 0.3924s/iter; left time: 3089.6103s
	iters: 200, epoch: 4 | loss: 0.4429943
	speed: 0.0852s/iter; left time: 662.5448s
	iters: 300, epoch: 4 | loss: 0.4766955
	speed: 0.0837s/iter; left time: 642.4700s
	iters: 400, epoch: 4 | loss: 0.3880701
	speed: 0.0837s/iter; left time: 633.9281s
	iters: 500, epoch: 4 | loss: 0.7040049
	speed: 0.0834s/iter; left time: 623.4640s
	iters: 600, epoch: 4 | loss: 0.4052803
	speed: 0.0838s/iter; left time: 617.6966s
	iters: 700, epoch: 4 | loss: 0.4365691
	speed: 0.0847s/iter; left time: 616.3332s
	iters: 800, epoch: 4 | loss: 0.7863981
	speed: 0.0838s/iter; left time: 600.9978s
	iters: 900, epoch: 4 | loss: 0.4050529
	speed: 0.0841s/iter; left time: 594.5935s
	iters: 1000, epoch: 4 | loss: 0.4972569
	speed: 0.0842s/iter; left time: 587.0596s
	iters: 1100, epoch: 4 | loss: 0.6800061
	speed: 0.0843s/iter; left time: 579.7687s
Epoch: 4 cost time: 96.18560671806335
Epoch: 4, Steps: 1139 | Train Loss: 0.5536163 Vali Loss: 0.6919255 Test Loss: 0.3980687
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4399786
	speed: 0.3910s/iter; left time: 2633.2772s
	iters: 200, epoch: 5 | loss: 0.4269003
	speed: 0.0832s/iter; left time: 552.1344s
	iters: 300, epoch: 5 | loss: 0.4794837
	speed: 0.0832s/iter; left time: 543.9438s
	iters: 400, epoch: 5 | loss: 0.4235803
	speed: 0.0834s/iter; left time: 536.3956s
	iters: 500, epoch: 5 | loss: 0.5142429
	speed: 0.0835s/iter; left time: 529.0431s
	iters: 600, epoch: 5 | loss: 0.3797536
	speed: 0.0836s/iter; left time: 521.1639s
	iters: 700, epoch: 5 | loss: 0.7740735
	speed: 0.0835s/iter; left time: 512.5518s
	iters: 800, epoch: 5 | loss: 0.5059714
	speed: 0.0836s/iter; left time: 504.3375s
	iters: 900, epoch: 5 | loss: 0.7892550
	speed: 0.0834s/iter; left time: 495.0231s
	iters: 1000, epoch: 5 | loss: 0.3914552
	speed: 0.0835s/iter; left time: 487.3311s
	iters: 1100, epoch: 5 | loss: 0.4785953
	speed: 0.0837s/iter; left time: 479.7435s
Epoch: 5 cost time: 95.03794264793396
Epoch: 5, Steps: 1139 | Train Loss: 0.5455256 Vali Loss: 0.6799025 Test Loss: 0.3794836
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : weather_336_Autoformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed15726<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10204
mse:0.3777119517326355, mae:0.41006192564964294
