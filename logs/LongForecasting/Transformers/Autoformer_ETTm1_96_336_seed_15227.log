Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm1', data_path='ETTm1.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Autoformer', model_id='ETTm1_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=336, root_path='./dataset/', seed=15227, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm1_336_Autoformer_ETTm1_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed15227>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34129
val 11185
test 11185
	iters: 100, epoch: 1 | loss: 0.4802444
	speed: 0.1166s/iter; left time: 1230.9508s
	iters: 200, epoch: 1 | loss: 0.4423513
	speed: 0.0823s/iter; left time: 861.2049s
	iters: 300, epoch: 1 | loss: 0.4323321
	speed: 0.0823s/iter; left time: 852.5951s
	iters: 400, epoch: 1 | loss: 0.3394867
	speed: 0.0824s/iter; left time: 845.3253s
	iters: 500, epoch: 1 | loss: 0.3914924
	speed: 0.0825s/iter; left time: 838.1793s
	iters: 600, epoch: 1 | loss: 0.3922800
	speed: 0.0829s/iter; left time: 833.6096s
	iters: 700, epoch: 1 | loss: 0.3196594
	speed: 0.0832s/iter; left time: 828.4100s
	iters: 800, epoch: 1 | loss: 0.3614846
	speed: 0.0828s/iter; left time: 816.0043s
	iters: 900, epoch: 1 | loss: 0.3626206
	speed: 0.0825s/iter; left time: 805.5377s
	iters: 1000, epoch: 1 | loss: 0.3716232
	speed: 0.0824s/iter; left time: 796.4319s
Epoch: 1 cost time: 91.4569046497345
Epoch: 1, Steps: 1066 | Train Loss: 0.4169852 Vali Loss: 0.9389503 Test Loss: 0.7491045
Validation loss decreased (inf --> 0.938950).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3913471
	speed: 0.5167s/iter; left time: 4905.8682s
	iters: 200, epoch: 2 | loss: 0.3483929
	speed: 0.0825s/iter; left time: 774.6758s
	iters: 300, epoch: 2 | loss: 0.3852431
	speed: 0.0823s/iter; left time: 764.9153s
	iters: 400, epoch: 2 | loss: 0.3374005
	speed: 0.0822s/iter; left time: 756.1195s
	iters: 500, epoch: 2 | loss: 0.3188781
	speed: 0.0827s/iter; left time: 752.4221s
	iters: 600, epoch: 2 | loss: 0.2844168
	speed: 0.0827s/iter; left time: 743.9681s
	iters: 700, epoch: 2 | loss: 0.3190214
	speed: 0.0830s/iter; left time: 738.2594s
	iters: 800, epoch: 2 | loss: 0.3556997
	speed: 0.0827s/iter; left time: 727.1448s
	iters: 900, epoch: 2 | loss: 0.3649271
	speed: 0.0824s/iter; left time: 716.5660s
	iters: 1000, epoch: 2 | loss: 0.3099460
	speed: 0.0823s/iter; left time: 707.6683s
Epoch: 2 cost time: 87.95838952064514
Epoch: 2, Steps: 1066 | Train Loss: 0.3491627 Vali Loss: 0.8886320 Test Loss: 0.7320516
Validation loss decreased (0.938950 --> 0.888632).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3410841
	speed: 0.5152s/iter; left time: 4342.7977s
	iters: 200, epoch: 3 | loss: 0.2809799
	speed: 0.0825s/iter; left time: 687.2871s
	iters: 300, epoch: 3 | loss: 0.4003498
	speed: 0.0825s/iter; left time: 679.1261s
	iters: 400, epoch: 3 | loss: 0.3116674
	speed: 0.0826s/iter; left time: 671.3858s
	iters: 500, epoch: 3 | loss: 0.3609064
	speed: 0.0827s/iter; left time: 664.1896s
	iters: 600, epoch: 3 | loss: 0.3197048
	speed: 0.0826s/iter; left time: 655.0226s
	iters: 700, epoch: 3 | loss: 0.2960776
	speed: 0.0827s/iter; left time: 647.8484s
	iters: 800, epoch: 3 | loss: 0.3021795
	speed: 0.0826s/iter; left time: 638.0454s
	iters: 900, epoch: 3 | loss: 0.2934707
	speed: 0.0824s/iter; left time: 628.4242s
	iters: 1000, epoch: 3 | loss: 0.3456303
	speed: 0.0825s/iter; left time: 621.1338s
Epoch: 3 cost time: 87.9971911907196
Epoch: 3, Steps: 1066 | Train Loss: 0.3168211 Vali Loss: 0.9219593 Test Loss: 0.7290146
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3214051
	speed: 0.5129s/iter; left time: 3776.7182s
	iters: 200, epoch: 4 | loss: 0.2942937
	speed: 0.0823s/iter; left time: 598.0962s
	iters: 300, epoch: 4 | loss: 0.2670625
	speed: 0.0826s/iter; left time: 591.4109s
	iters: 400, epoch: 4 | loss: 0.2813838
	speed: 0.0827s/iter; left time: 584.2041s
	iters: 500, epoch: 4 | loss: 0.3227512
	speed: 0.0828s/iter; left time: 576.7738s
	iters: 600, epoch: 4 | loss: 0.2766350
	speed: 0.0828s/iter; left time: 568.0489s
	iters: 700, epoch: 4 | loss: 0.2893176
	speed: 0.0823s/iter; left time: 556.9009s
	iters: 800, epoch: 4 | loss: 0.3146490
	speed: 0.0824s/iter; left time: 548.7169s
	iters: 900, epoch: 4 | loss: 0.2900543
	speed: 0.0824s/iter; left time: 540.6610s
	iters: 1000, epoch: 4 | loss: 0.3093531
	speed: 0.0823s/iter; left time: 531.9794s
Epoch: 4 cost time: 87.90929746627808
Epoch: 4, Steps: 1066 | Train Loss: 0.3004743 Vali Loss: 0.9405661 Test Loss: 0.7646747
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3098028
	speed: 0.5133s/iter; left time: 3232.4352s
	iters: 200, epoch: 5 | loss: 0.3111535
	speed: 0.0823s/iter; left time: 510.2233s
	iters: 300, epoch: 5 | loss: 0.3387590
	speed: 0.0829s/iter; left time: 505.2538s
	iters: 400, epoch: 5 | loss: 0.2977781
	speed: 0.0829s/iter; left time: 497.1906s
	iters: 500, epoch: 5 | loss: 0.3142903
	speed: 0.0828s/iter; left time: 488.1748s
	iters: 600, epoch: 5 | loss: 0.3100162
	speed: 0.0828s/iter; left time: 479.7813s
	iters: 700, epoch: 5 | loss: 0.2950483
	speed: 0.0824s/iter; left time: 469.3232s
	iters: 800, epoch: 5 | loss: 0.2600831
	speed: 0.0824s/iter; left time: 461.2755s
	iters: 900, epoch: 5 | loss: 0.2780160
	speed: 0.0824s/iter; left time: 452.8716s
	iters: 1000, epoch: 5 | loss: 0.2748906
	speed: 0.0823s/iter; left time: 444.3980s
Epoch: 5 cost time: 87.97632884979248
Epoch: 5, Steps: 1066 | Train Loss: 0.2916504 Vali Loss: 0.9509825 Test Loss: 0.7382045
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : ETTm1_336_Autoformer_ETTm1_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed15227<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
mse:0.7317323684692383, mae:0.5753436088562012
