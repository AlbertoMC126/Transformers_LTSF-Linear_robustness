Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=21, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=21, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Autoformer', model_id='weather_720', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=720, root_path='./dataset/', seed=25565, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_720_Autoformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed25565>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36072
val 4551
test 9820
	iters: 100, epoch: 1 | loss: 0.7343439
	speed: 0.1781s/iter; left time: 1989.7591s
	iters: 200, epoch: 1 | loss: 0.8899536
	speed: 0.1438s/iter; left time: 1592.4581s
	iters: 300, epoch: 1 | loss: 0.9473381
	speed: 0.1439s/iter; left time: 1578.8456s
	iters: 400, epoch: 1 | loss: 0.8770291
	speed: 0.1438s/iter; left time: 1562.9668s
	iters: 500, epoch: 1 | loss: 0.6914315
	speed: 0.1436s/iter; left time: 1547.0369s
	iters: 600, epoch: 1 | loss: 0.6035982
	speed: 0.1440s/iter; left time: 1536.3359s
	iters: 700, epoch: 1 | loss: 0.7953609
	speed: 0.1441s/iter; left time: 1523.6374s
	iters: 800, epoch: 1 | loss: 0.6608728
	speed: 0.1439s/iter; left time: 1506.4606s
	iters: 900, epoch: 1 | loss: 0.5734105
	speed: 0.1438s/iter; left time: 1491.2614s
	iters: 1000, epoch: 1 | loss: 0.7253894
	speed: 0.1438s/iter; left time: 1476.7289s
	iters: 1100, epoch: 1 | loss: 0.5399141
	speed: 0.1437s/iter; left time: 1461.2500s
Epoch: 1 cost time: 165.61656022071838
Epoch: 1, Steps: 1127 | Train Loss: 0.7356035 Vali Loss: 0.8644435 Test Loss: 0.4494074
Validation loss decreased (inf --> 0.864444).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.7619231
	speed: 0.6609s/iter; left time: 6638.3607s
	iters: 200, epoch: 2 | loss: 0.5945134
	speed: 0.1439s/iter; left time: 1431.1966s
	iters: 300, epoch: 2 | loss: 0.7596433
	speed: 0.1438s/iter; left time: 1415.7110s
	iters: 400, epoch: 2 | loss: 0.9277021
	speed: 0.1437s/iter; left time: 1399.9666s
	iters: 500, epoch: 2 | loss: 0.8398803
	speed: 0.1438s/iter; left time: 1386.4020s
	iters: 600, epoch: 2 | loss: 0.6734837
	speed: 0.1437s/iter; left time: 1371.0778s
	iters: 700, epoch: 2 | loss: 0.7954223
	speed: 0.1436s/iter; left time: 1355.9008s
	iters: 800, epoch: 2 | loss: 0.7212197
	speed: 0.1438s/iter; left time: 1344.0061s
	iters: 900, epoch: 2 | loss: 0.7309399
	speed: 0.1439s/iter; left time: 1330.0976s
	iters: 1000, epoch: 2 | loss: 0.8036079
	speed: 0.1439s/iter; left time: 1315.8747s
	iters: 1100, epoch: 2 | loss: 0.9146550
	speed: 0.1437s/iter; left time: 1299.8212s
Epoch: 2 cost time: 162.06053733825684
Epoch: 2, Steps: 1127 | Train Loss: 0.7084156 Vali Loss: 0.8234692 Test Loss: 0.4236252
Validation loss decreased (0.864444 --> 0.823469).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.7089699
	speed: 0.6579s/iter; left time: 5866.6621s
	iters: 200, epoch: 3 | loss: 0.6700383
	speed: 0.1439s/iter; left time: 1269.0620s
	iters: 300, epoch: 3 | loss: 0.6235925
	speed: 0.1439s/iter; left time: 1254.4454s
	iters: 400, epoch: 3 | loss: 0.6147876
	speed: 0.1438s/iter; left time: 1238.8216s
	iters: 500, epoch: 3 | loss: 0.8470694
	speed: 0.1437s/iter; left time: 1223.8049s
	iters: 600, epoch: 3 | loss: 0.8319644
	speed: 0.1437s/iter; left time: 1209.6744s
	iters: 700, epoch: 3 | loss: 0.8272365
	speed: 0.1438s/iter; left time: 1195.8021s
	iters: 800, epoch: 3 | loss: 0.7248384
	speed: 0.1441s/iter; left time: 1184.0441s
	iters: 900, epoch: 3 | loss: 0.5820398
	speed: 0.1442s/iter; left time: 1170.8539s
	iters: 1000, epoch: 3 | loss: 0.6524945
	speed: 0.1441s/iter; left time: 1155.2615s
	iters: 1100, epoch: 3 | loss: 0.6447396
	speed: 0.1440s/iter; left time: 1140.4294s
Epoch: 3 cost time: 162.17780876159668
Epoch: 3, Steps: 1127 | Train Loss: 0.6962850 Vali Loss: 0.8345029 Test Loss: 0.4444284
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.6396823
	speed: 0.6661s/iter; left time: 5188.9060s
	iters: 200, epoch: 4 | loss: 0.6720637
	speed: 0.1437s/iter; left time: 1105.1816s
	iters: 300, epoch: 4 | loss: 0.9958609
	speed: 0.1437s/iter; left time: 1090.3842s
	iters: 400, epoch: 4 | loss: 0.6239108
	speed: 0.1442s/iter; left time: 1080.0350s
	iters: 500, epoch: 4 | loss: 0.7176018
	speed: 0.1443s/iter; left time: 1066.5675s
	iters: 600, epoch: 4 | loss: 0.6185107
	speed: 0.1437s/iter; left time: 1047.5442s
	iters: 700, epoch: 4 | loss: 0.7041849
	speed: 0.1435s/iter; left time: 1031.9590s
	iters: 800, epoch: 4 | loss: 0.5609627
	speed: 0.1435s/iter; left time: 1017.5779s
	iters: 900, epoch: 4 | loss: 0.5568524
	speed: 0.1435s/iter; left time: 1003.2418s
	iters: 1000, epoch: 4 | loss: 0.9335078
	speed: 0.1435s/iter; left time: 988.8872s
	iters: 1100, epoch: 4 | loss: 0.9146253
	speed: 0.1436s/iter; left time: 974.7089s
Epoch: 4 cost time: 161.96692991256714
Epoch: 4, Steps: 1127 | Train Loss: 0.6910420 Vali Loss: 0.8411134 Test Loss: 0.4491848
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.6940590
	speed: 0.6656s/iter; left time: 4434.7305s
	iters: 200, epoch: 5 | loss: 0.7010052
	speed: 0.1436s/iter; left time: 942.3041s
	iters: 300, epoch: 5 | loss: 0.6108930
	speed: 0.1436s/iter; left time: 928.0186s
	iters: 400, epoch: 5 | loss: 0.6342125
	speed: 0.1441s/iter; left time: 916.7673s
	iters: 500, epoch: 5 | loss: 0.6105092
	speed: 0.1441s/iter; left time: 902.8043s
	iters: 600, epoch: 5 | loss: 0.6117261
	speed: 0.1441s/iter; left time: 888.3331s
	iters: 700, epoch: 5 | loss: 0.6911958
	speed: 0.1440s/iter; left time: 873.2682s
	iters: 800, epoch: 5 | loss: 0.7681642
	speed: 0.1438s/iter; left time: 857.5864s
	iters: 900, epoch: 5 | loss: 0.7147092
	speed: 0.1438s/iter; left time: 843.1276s
	iters: 1000, epoch: 5 | loss: 0.7874451
	speed: 0.1437s/iter; left time: 828.1463s
	iters: 1100, epoch: 5 | loss: 0.5898527
	speed: 0.1438s/iter; left time: 814.2010s
Epoch: 5 cost time: 162.08951210975647
Epoch: 5, Steps: 1127 | Train Loss: 0.6887318 Vali Loss: 0.8231769 Test Loss: 0.4392383
Validation loss decreased (0.823469 --> 0.823177).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.6662719
	speed: 0.6681s/iter; left time: 3698.6214s
	iters: 200, epoch: 6 | loss: 0.8160216
	speed: 0.1435s/iter; left time: 779.8288s
	iters: 300, epoch: 6 | loss: 0.6194003
	speed: 0.1434s/iter; left time: 765.2093s
	iters: 400, epoch: 6 | loss: 0.7921404
	speed: 0.1435s/iter; left time: 751.4073s
	iters: 500, epoch: 6 | loss: 0.7410823
	speed: 0.1434s/iter; left time: 736.7206s
	iters: 600, epoch: 6 | loss: 0.7440843
	speed: 0.1435s/iter; left time: 722.5977s
	iters: 700, epoch: 6 | loss: 0.7690746
	speed: 0.1435s/iter; left time: 708.4880s
	iters: 800, epoch: 6 | loss: 0.6247205
	speed: 0.1442s/iter; left time: 697.1419s
	iters: 900, epoch: 6 | loss: 0.5778375
	speed: 0.1444s/iter; left time: 683.7828s
	iters: 1000, epoch: 6 | loss: 0.7059361
	speed: 0.1439s/iter; left time: 667.0297s
	iters: 1100, epoch: 6 | loss: 0.8640119
	speed: 0.1437s/iter; left time: 651.7133s
Epoch: 6 cost time: 161.97843647003174
Epoch: 6, Steps: 1127 | Train Loss: 0.6873368 Vali Loss: 0.8321667 Test Loss: 0.4402026
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.8282104
	speed: 0.6667s/iter; left time: 2939.3377s
	iters: 200, epoch: 7 | loss: 0.6566277
	speed: 0.1440s/iter; left time: 620.3498s
	iters: 300, epoch: 7 | loss: 0.7073171
	speed: 0.1441s/iter; left time: 606.3676s
	iters: 400, epoch: 7 | loss: 0.7232265
	speed: 0.1437s/iter; left time: 590.4078s
	iters: 500, epoch: 7 | loss: 0.7084919
	speed: 0.1437s/iter; left time: 576.1047s
	iters: 600, epoch: 7 | loss: 0.6225397
	speed: 0.1436s/iter; left time: 561.3262s
	iters: 700, epoch: 7 | loss: 0.6032938
	speed: 0.1437s/iter; left time: 547.1867s
	iters: 800, epoch: 7 | loss: 0.5736219
	speed: 0.1437s/iter; left time: 532.8993s
	iters: 900, epoch: 7 | loss: 0.7177970
	speed: 0.1437s/iter; left time: 518.6660s
	iters: 1000, epoch: 7 | loss: 0.7007947
	speed: 0.1440s/iter; left time: 505.2391s
	iters: 1100, epoch: 7 | loss: 0.6718757
	speed: 0.1443s/iter; left time: 491.9484s
Epoch: 7 cost time: 162.13722610473633
Epoch: 7, Steps: 1127 | Train Loss: 0.6861325 Vali Loss: 0.8339073 Test Loss: 0.4422530
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.5741187
	speed: 0.6651s/iter; left time: 2182.7812s
	iters: 200, epoch: 8 | loss: 0.7256445
	speed: 0.1435s/iter; left time: 456.5417s
	iters: 300, epoch: 8 | loss: 0.5829908
	speed: 0.1435s/iter; left time: 442.2035s
	iters: 400, epoch: 8 | loss: 0.6466867
	speed: 0.1443s/iter; left time: 430.2791s
	iters: 500, epoch: 8 | loss: 0.6800388
	speed: 0.1444s/iter; left time: 416.0177s
	iters: 600, epoch: 8 | loss: 0.5439643
	speed: 0.1438s/iter; left time: 400.1872s
	iters: 700, epoch: 8 | loss: 0.7753319
	speed: 0.1436s/iter; left time: 385.0688s
	iters: 800, epoch: 8 | loss: 0.5696144
	speed: 0.1438s/iter; left time: 371.2740s
	iters: 900, epoch: 8 | loss: 0.5820972
	speed: 0.1437s/iter; left time: 356.5868s
	iters: 1000, epoch: 8 | loss: 0.8306523
	speed: 0.1442s/iter; left time: 343.3948s
	iters: 1100, epoch: 8 | loss: 0.6044078
	speed: 0.1443s/iter; left time: 329.3254s
Epoch: 8 cost time: 162.13694787025452
Epoch: 8, Steps: 1127 | Train Loss: 0.6859428 Vali Loss: 0.8319899 Test Loss: 0.4432948
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : weather_720_Autoformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed25565<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9820
mse:0.43909934163093567, mae:0.4395723044872284
