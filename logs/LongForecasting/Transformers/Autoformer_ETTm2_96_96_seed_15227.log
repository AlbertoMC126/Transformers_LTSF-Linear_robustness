Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Autoformer', model_id='ETTm2_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=96, root_path='./dataset/', seed=15227, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm2_96_Autoformer_ETTm2_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed15227>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34369
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.2367118
	speed: 0.0813s/iter; left time: 865.4073s
	iters: 200, epoch: 1 | loss: 0.1522936
	speed: 0.0473s/iter; left time: 498.6633s
	iters: 300, epoch: 1 | loss: 0.3187893
	speed: 0.0471s/iter; left time: 492.2417s
	iters: 400, epoch: 1 | loss: 0.3300338
	speed: 0.0473s/iter; left time: 488.9488s
	iters: 500, epoch: 1 | loss: 0.2091545
	speed: 0.0473s/iter; left time: 484.4248s
	iters: 600, epoch: 1 | loss: 0.2382941
	speed: 0.0473s/iter; left time: 479.7591s
	iters: 700, epoch: 1 | loss: 0.1355423
	speed: 0.0473s/iter; left time: 475.2261s
	iters: 800, epoch: 1 | loss: 0.2912860
	speed: 0.0475s/iter; left time: 471.9378s
	iters: 900, epoch: 1 | loss: 0.4621944
	speed: 0.0472s/iter; left time: 464.4165s
	iters: 1000, epoch: 1 | loss: 0.2729066
	speed: 0.0473s/iter; left time: 460.5803s
Epoch: 1 cost time: 54.22437047958374
Epoch: 1, Steps: 1074 | Train Loss: 0.2747320 Vali Loss: 0.1636140 Test Loss: 0.2451378
Validation loss decreased (inf --> 0.163614).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4942108
	speed: 0.2766s/iter; left time: 2646.5959s
	iters: 200, epoch: 2 | loss: 0.1972601
	speed: 0.0472s/iter; left time: 446.9783s
	iters: 300, epoch: 2 | loss: 0.2030174
	speed: 0.0473s/iter; left time: 442.9136s
	iters: 400, epoch: 2 | loss: 0.1965023
	speed: 0.0473s/iter; left time: 437.9338s
	iters: 500, epoch: 2 | loss: 0.1491368
	speed: 0.0472s/iter; left time: 432.7425s
	iters: 600, epoch: 2 | loss: 0.1736913
	speed: 0.0472s/iter; left time: 428.2425s
	iters: 700, epoch: 2 | loss: 0.3232023
	speed: 0.0473s/iter; left time: 424.3174s
	iters: 800, epoch: 2 | loss: 0.1650212
	speed: 0.0474s/iter; left time: 419.9791s
	iters: 900, epoch: 2 | loss: 0.1509891
	speed: 0.0473s/iter; left time: 414.2424s
	iters: 1000, epoch: 2 | loss: 0.1940375
	speed: 0.0472s/iter; left time: 409.4944s
Epoch: 2 cost time: 50.75609993934631
Epoch: 2, Steps: 1074 | Train Loss: 0.2490622 Vali Loss: 0.1597275 Test Loss: 0.2476046
Validation loss decreased (0.163614 --> 0.159727).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1989326
	speed: 0.2769s/iter; left time: 2351.5291s
	iters: 200, epoch: 3 | loss: 0.1629509
	speed: 0.0472s/iter; left time: 396.4237s
	iters: 300, epoch: 3 | loss: 0.2290844
	speed: 0.0472s/iter; left time: 391.2867s
	iters: 400, epoch: 3 | loss: 0.1830693
	speed: 0.0472s/iter; left time: 386.3096s
	iters: 500, epoch: 3 | loss: 0.4483601
	speed: 0.0472s/iter; left time: 382.1528s
	iters: 600, epoch: 3 | loss: 0.1224304
	speed: 0.0472s/iter; left time: 377.5848s
	iters: 700, epoch: 3 | loss: 0.2117706
	speed: 0.0473s/iter; left time: 373.1884s
	iters: 800, epoch: 3 | loss: 0.2157520
	speed: 0.0471s/iter; left time: 367.2737s
	iters: 900, epoch: 3 | loss: 0.1609817
	speed: 0.0472s/iter; left time: 362.7493s
	iters: 1000, epoch: 3 | loss: 0.2023101
	speed: 0.0472s/iter; left time: 358.5326s
Epoch: 3 cost time: 50.71131348609924
Epoch: 3, Steps: 1074 | Train Loss: 0.2256748 Vali Loss: 0.1529367 Test Loss: 0.2596669
Validation loss decreased (0.159727 --> 0.152937).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1459828
	speed: 0.2771s/iter; left time: 2056.1754s
	iters: 200, epoch: 4 | loss: 0.1704595
	speed: 0.0472s/iter; left time: 345.6284s
	iters: 300, epoch: 4 | loss: 0.2272581
	speed: 0.0473s/iter; left time: 341.4828s
	iters: 400, epoch: 4 | loss: 0.1969909
	speed: 0.0472s/iter; left time: 335.8484s
	iters: 500, epoch: 4 | loss: 0.1256083
	speed: 0.0472s/iter; left time: 331.1456s
	iters: 600, epoch: 4 | loss: 0.2078438
	speed: 0.0472s/iter; left time: 326.5252s
	iters: 700, epoch: 4 | loss: 0.2254290
	speed: 0.0472s/iter; left time: 322.0101s
	iters: 800, epoch: 4 | loss: 0.2266051
	speed: 0.0472s/iter; left time: 317.3712s
	iters: 900, epoch: 4 | loss: 0.1772977
	speed: 0.0473s/iter; left time: 313.0944s
	iters: 1000, epoch: 4 | loss: 0.2323017
	speed: 0.0473s/iter; left time: 308.1523s
Epoch: 4 cost time: 50.75683283805847
Epoch: 4, Steps: 1074 | Train Loss: 0.2064316 Vali Loss: 0.1639324 Test Loss: 0.3077970
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2124467
	speed: 0.2736s/iter; left time: 1736.1352s
	iters: 200, epoch: 5 | loss: 0.1136870
	speed: 0.0473s/iter; left time: 295.5236s
	iters: 300, epoch: 5 | loss: 0.1409008
	speed: 0.0473s/iter; left time: 290.4724s
	iters: 400, epoch: 5 | loss: 0.1780571
	speed: 0.0472s/iter; left time: 285.5641s
	iters: 500, epoch: 5 | loss: 0.1445066
	speed: 0.0470s/iter; left time: 279.6736s
	iters: 600, epoch: 5 | loss: 0.1701439
	speed: 0.0472s/iter; left time: 276.1438s
	iters: 700, epoch: 5 | loss: 0.1779771
	speed: 0.0472s/iter; left time: 271.3188s
	iters: 800, epoch: 5 | loss: 0.1815127
	speed: 0.0472s/iter; left time: 266.6878s
	iters: 900, epoch: 5 | loss: 0.1723615
	speed: 0.0472s/iter; left time: 261.4854s
	iters: 1000, epoch: 5 | loss: 0.1206812
	speed: 0.0472s/iter; left time: 256.7738s
Epoch: 5 cost time: 50.690370321273804
Epoch: 5, Steps: 1074 | Train Loss: 0.1964777 Vali Loss: 0.1722649 Test Loss: 0.3307715
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1500929
	speed: 0.2741s/iter; left time: 1444.9431s
	iters: 200, epoch: 6 | loss: 0.1965654
	speed: 0.0473s/iter; left time: 244.6309s
	iters: 300, epoch: 6 | loss: 0.1607527
	speed: 0.0472s/iter; left time: 239.4748s
	iters: 400, epoch: 6 | loss: 0.1813810
	speed: 0.0473s/iter; left time: 234.9747s
	iters: 500, epoch: 6 | loss: 0.1096475
	speed: 0.0472s/iter; left time: 230.0893s
	iters: 600, epoch: 6 | loss: 0.1470520
	speed: 0.0472s/iter; left time: 225.4225s
	iters: 700, epoch: 6 | loss: 0.1172894
	speed: 0.0473s/iter; left time: 221.0737s
	iters: 800, epoch: 6 | loss: 0.1751215
	speed: 0.0473s/iter; left time: 216.0607s
	iters: 900, epoch: 6 | loss: 0.1341188
	speed: 0.0473s/iter; left time: 211.4362s
	iters: 1000, epoch: 6 | loss: 0.2612008
	speed: 0.0472s/iter; left time: 206.4050s
Epoch: 6 cost time: 50.757383584976196
Epoch: 6, Steps: 1074 | Train Loss: 0.1918360 Vali Loss: 0.1760873 Test Loss: 0.3324685
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : ETTm2_96_Autoformer_ETTm2_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed15227<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.260047972202301, mae:0.32424601912498474
