Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=21, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=21, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Autoformer', model_id='weather_192', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=192, root_path='./dataset/', seed=25565, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_192_Autoformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed25565>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36600
val 5079
test 10348
	iters: 100, epoch: 1 | loss: 0.5269433
	speed: 0.0963s/iter; left time: 1090.8878s
	iters: 200, epoch: 1 | loss: 0.7653717
	speed: 0.0618s/iter; left time: 694.2427s
	iters: 300, epoch: 1 | loss: 0.4908796
	speed: 0.0619s/iter; left time: 688.7821s
	iters: 400, epoch: 1 | loss: 0.4404854
	speed: 0.0619s/iter; left time: 682.6294s
	iters: 500, epoch: 1 | loss: 0.5328624
	speed: 0.0619s/iter; left time: 677.1067s
	iters: 600, epoch: 1 | loss: 0.6011836
	speed: 0.0619s/iter; left time: 670.9180s
	iters: 700, epoch: 1 | loss: 0.4549029
	speed: 0.0621s/iter; left time: 666.2087s
	iters: 800, epoch: 1 | loss: 0.6227750
	speed: 0.0620s/iter; left time: 658.9378s
	iters: 900, epoch: 1 | loss: 0.4925824
	speed: 0.0622s/iter; left time: 655.4562s
	iters: 1000, epoch: 1 | loss: 0.4106996
	speed: 0.0626s/iter; left time: 653.3567s
	iters: 1100, epoch: 1 | loss: 0.5270942
	speed: 0.0627s/iter; left time: 647.8494s
Epoch: 1 cost time: 74.46510624885559
Epoch: 1, Steps: 1143 | Train Loss: 0.6387375 Vali Loss: 0.6194410 Test Loss: 0.2902812
Validation loss decreased (inf --> 0.619441).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.9766812
	speed: 0.2871s/iter; left time: 2925.1711s
	iters: 200, epoch: 2 | loss: 0.3951924
	speed: 0.0619s/iter; left time: 624.2838s
	iters: 300, epoch: 2 | loss: 0.5980777
	speed: 0.0620s/iter; left time: 618.9200s
	iters: 400, epoch: 2 | loss: 0.4506376
	speed: 0.0620s/iter; left time: 613.4197s
	iters: 500, epoch: 2 | loss: 0.9741801
	speed: 0.0620s/iter; left time: 607.0826s
	iters: 600, epoch: 2 | loss: 0.4830445
	speed: 0.0621s/iter; left time: 601.6268s
	iters: 700, epoch: 2 | loss: 0.4213030
	speed: 0.0620s/iter; left time: 594.6918s
	iters: 800, epoch: 2 | loss: 0.6569472
	speed: 0.0621s/iter; left time: 588.9395s
	iters: 900, epoch: 2 | loss: 0.3920147
	speed: 0.0622s/iter; left time: 583.5786s
	iters: 1000, epoch: 2 | loss: 0.3979460
	speed: 0.0623s/iter; left time: 578.3936s
	iters: 1100, epoch: 2 | loss: 0.5517872
	speed: 0.0621s/iter; left time: 571.0294s
Epoch: 2 cost time: 70.9250316619873
Epoch: 2, Steps: 1143 | Train Loss: 0.5959770 Vali Loss: 0.6151863 Test Loss: 0.2861876
Validation loss decreased (0.619441 --> 0.615186).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5083538
	speed: 0.2832s/iter; left time: 2561.6375s
	iters: 200, epoch: 3 | loss: 0.4452164
	speed: 0.0626s/iter; left time: 559.7701s
	iters: 300, epoch: 3 | loss: 0.4515982
	speed: 0.0626s/iter; left time: 553.6148s
	iters: 400, epoch: 3 | loss: 0.5265993
	speed: 0.0624s/iter; left time: 545.3433s
	iters: 500, epoch: 3 | loss: 0.4474761
	speed: 0.0620s/iter; left time: 535.9179s
	iters: 600, epoch: 3 | loss: 0.5570547
	speed: 0.0622s/iter; left time: 531.1756s
	iters: 700, epoch: 3 | loss: 0.5734855
	speed: 0.0620s/iter; left time: 523.5001s
	iters: 800, epoch: 3 | loss: 0.7195034
	speed: 0.0620s/iter; left time: 517.0167s
	iters: 900, epoch: 3 | loss: 0.4611739
	speed: 0.0621s/iter; left time: 511.7538s
	iters: 1000, epoch: 3 | loss: 0.4168826
	speed: 0.0619s/iter; left time: 504.0556s
	iters: 1100, epoch: 3 | loss: 0.4073163
	speed: 0.0619s/iter; left time: 497.6787s
Epoch: 3 cost time: 71.06648826599121
Epoch: 3, Steps: 1143 | Train Loss: 0.5703981 Vali Loss: 0.6173487 Test Loss: 0.2938503
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.6157078
	speed: 0.2797s/iter; left time: 2210.2590s
	iters: 200, epoch: 4 | loss: 0.9270778
	speed: 0.0619s/iter; left time: 482.8695s
	iters: 300, epoch: 4 | loss: 0.6236471
	speed: 0.0618s/iter; left time: 476.0115s
	iters: 400, epoch: 4 | loss: 0.3722792
	speed: 0.0619s/iter; left time: 470.8162s
	iters: 500, epoch: 4 | loss: 0.4817073
	speed: 0.0625s/iter; left time: 468.9558s
	iters: 600, epoch: 4 | loss: 0.4264378
	speed: 0.0628s/iter; left time: 464.8598s
	iters: 700, epoch: 4 | loss: 0.4763537
	speed: 0.0624s/iter; left time: 455.8786s
	iters: 800, epoch: 4 | loss: 0.4710838
	speed: 0.0624s/iter; left time: 449.4925s
	iters: 900, epoch: 4 | loss: 0.5524155
	speed: 0.0625s/iter; left time: 443.5382s
	iters: 1000, epoch: 4 | loss: 0.8247247
	speed: 0.0619s/iter; left time: 433.3709s
	iters: 1100, epoch: 4 | loss: 0.4011092
	speed: 0.0619s/iter; left time: 427.4010s
Epoch: 4 cost time: 71.04388856887817
Epoch: 4, Steps: 1143 | Train Loss: 0.5516586 Vali Loss: 0.6179556 Test Loss: 0.2946372
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3996425
	speed: 0.2793s/iter; left time: 1888.0387s
	iters: 200, epoch: 5 | loss: 0.4345480
	speed: 0.0619s/iter; left time: 411.9348s
	iters: 300, epoch: 5 | loss: 0.5239852
	speed: 0.0619s/iter; left time: 405.7321s
	iters: 400, epoch: 5 | loss: 0.4537855
	speed: 0.0618s/iter; left time: 398.9081s
	iters: 500, epoch: 5 | loss: 0.6673136
	speed: 0.0619s/iter; left time: 393.6294s
	iters: 600, epoch: 5 | loss: 0.4183425
	speed: 0.0619s/iter; left time: 387.5224s
	iters: 700, epoch: 5 | loss: 0.6361817
	speed: 0.0618s/iter; left time: 380.9019s
	iters: 800, epoch: 5 | loss: 0.5123550
	speed: 0.0618s/iter; left time: 374.4049s
	iters: 900, epoch: 5 | loss: 0.4535902
	speed: 0.0622s/iter; left time: 370.3742s
	iters: 1000, epoch: 5 | loss: 0.5687855
	speed: 0.0626s/iter; left time: 366.6524s
	iters: 1100, epoch: 5 | loss: 0.8743334
	speed: 0.0625s/iter; left time: 360.2009s
Epoch: 5 cost time: 70.87942862510681
Epoch: 5, Steps: 1143 | Train Loss: 0.5432660 Vali Loss: 0.6191666 Test Loss: 0.3010774
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : weather_192_Autoformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed25565<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10348
mse:0.28655800223350525, mae:0.34555044770240784
