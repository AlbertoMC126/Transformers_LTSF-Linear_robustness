Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm1', data_path='ETTm1.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Transformer', model_id='ETTm1_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=336, root_path='./dataset/', seed=12890, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm1_336_Transformer_ETTm1_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed12890>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34129
val 11185
test 11185
	iters: 100, epoch: 1 | loss: 0.4632980
	speed: 0.0735s/iter; left time: 775.8565s
	iters: 200, epoch: 1 | loss: 0.3477489
	speed: 0.0433s/iter; left time: 453.1106s
	iters: 300, epoch: 1 | loss: 0.3134293
	speed: 0.0434s/iter; left time: 450.0323s
	iters: 400, epoch: 1 | loss: 0.3412303
	speed: 0.0435s/iter; left time: 446.4211s
	iters: 500, epoch: 1 | loss: 0.2518959
	speed: 0.0435s/iter; left time: 441.7139s
	iters: 600, epoch: 1 | loss: 0.2681206
	speed: 0.0434s/iter; left time: 436.9476s
	iters: 700, epoch: 1 | loss: 0.2452776
	speed: 0.0434s/iter; left time: 432.7662s
	iters: 800, epoch: 1 | loss: 0.2410876
	speed: 0.0434s/iter; left time: 428.2173s
	iters: 900, epoch: 1 | loss: 0.2289870
	speed: 0.0434s/iter; left time: 424.0375s
	iters: 1000, epoch: 1 | loss: 0.2209277
	speed: 0.0435s/iter; left time: 420.0346s
Epoch: 1 cost time: 49.321770906448364
Epoch: 1, Steps: 1066 | Train Loss: 0.3058440 Vali Loss: 0.9764732 Test Loss: 1.0389733
Validation loss decreased (inf --> 0.976473).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1955586
	speed: 0.1726s/iter; left time: 1638.7709s
	iters: 200, epoch: 2 | loss: 0.2102596
	speed: 0.0439s/iter; left time: 412.2163s
	iters: 300, epoch: 2 | loss: 0.1816691
	speed: 0.0437s/iter; left time: 406.3140s
	iters: 400, epoch: 2 | loss: 0.1901280
	speed: 0.0438s/iter; left time: 402.7231s
	iters: 500, epoch: 2 | loss: 0.1875943
	speed: 0.0438s/iter; left time: 398.3287s
	iters: 600, epoch: 2 | loss: 0.1719664
	speed: 0.0436s/iter; left time: 391.9680s
	iters: 700, epoch: 2 | loss: 0.1601364
	speed: 0.0435s/iter; left time: 386.8877s
	iters: 800, epoch: 2 | loss: 0.1591578
	speed: 0.0435s/iter; left time: 382.7997s
	iters: 900, epoch: 2 | loss: 0.1510981
	speed: 0.0435s/iter; left time: 378.3657s
	iters: 1000, epoch: 2 | loss: 0.1539897
	speed: 0.0435s/iter; left time: 374.0941s
Epoch: 2 cost time: 46.52165341377258
Epoch: 2, Steps: 1066 | Train Loss: 0.1725232 Vali Loss: 0.9878452 Test Loss: 1.0731508
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1163916
	speed: 0.1695s/iter; left time: 1428.9458s
	iters: 200, epoch: 3 | loss: 0.1180351
	speed: 0.0436s/iter; left time: 362.9334s
	iters: 300, epoch: 3 | loss: 0.1124187
	speed: 0.0436s/iter; left time: 358.6336s
	iters: 400, epoch: 3 | loss: 0.1175807
	speed: 0.0436s/iter; left time: 354.5688s
	iters: 500, epoch: 3 | loss: 0.1199267
	speed: 0.0436s/iter; left time: 350.0081s
	iters: 600, epoch: 3 | loss: 0.1183827
	speed: 0.0436s/iter; left time: 345.7326s
	iters: 700, epoch: 3 | loss: 0.1109809
	speed: 0.0436s/iter; left time: 341.3875s
	iters: 800, epoch: 3 | loss: 0.1050880
	speed: 0.0436s/iter; left time: 337.2587s
	iters: 900, epoch: 3 | loss: 0.1060242
	speed: 0.0436s/iter; left time: 332.9820s
	iters: 1000, epoch: 3 | loss: 0.1040197
	speed: 0.0436s/iter; left time: 328.4321s
Epoch: 3 cost time: 46.465455770492554
Epoch: 3, Steps: 1066 | Train Loss: 0.1143902 Vali Loss: 1.0104096 Test Loss: 1.0360973
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1011462
	speed: 0.1695s/iter; left time: 1247.9523s
	iters: 200, epoch: 4 | loss: 0.1008483
	speed: 0.0437s/iter; left time: 317.1192s
	iters: 300, epoch: 4 | loss: 0.0959151
	speed: 0.0438s/iter; left time: 313.5929s
	iters: 400, epoch: 4 | loss: 0.0899649
	speed: 0.0437s/iter; left time: 308.5433s
	iters: 500, epoch: 4 | loss: 0.0948276
	speed: 0.0437s/iter; left time: 304.4608s
	iters: 600, epoch: 4 | loss: 0.0884942
	speed: 0.0438s/iter; left time: 300.6278s
	iters: 700, epoch: 4 | loss: 0.0913822
	speed: 0.0437s/iter; left time: 295.3343s
	iters: 800, epoch: 4 | loss: 0.0918610
	speed: 0.0436s/iter; left time: 290.2654s
	iters: 900, epoch: 4 | loss: 0.0937939
	speed: 0.0436s/iter; left time: 286.0172s
	iters: 1000, epoch: 4 | loss: 0.0855922
	speed: 0.0436s/iter; left time: 281.5148s
Epoch: 4 cost time: 46.51890277862549
Epoch: 4, Steps: 1066 | Train Loss: 0.0935287 Vali Loss: 1.0268214 Test Loss: 0.9819067
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : ETTm1_336_Transformer_ETTm1_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed12890<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
mse:1.038935661315918, mae:0.8034675717353821
