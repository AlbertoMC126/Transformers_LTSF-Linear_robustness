Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=321, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', dec_in=321, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Transformer', model_id='electricity_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=96, root_path='./dataset/', seed=15227, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : electricity_96_Transformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed15227>>>>>>>>>>>>>>>>>>>>>>>>>>
train 18221
val 2537
test 5165
	iters: 100, epoch: 1 | loss: 0.3590756
	speed: 0.0594s/iter; left time: 331.8581s
	iters: 200, epoch: 1 | loss: 0.2675274
	speed: 0.0275s/iter; left time: 150.7807s
	iters: 300, epoch: 1 | loss: 0.2136968
	speed: 0.0275s/iter; left time: 148.0862s
	iters: 400, epoch: 1 | loss: 0.1994993
	speed: 0.0276s/iter; left time: 145.8660s
	iters: 500, epoch: 1 | loss: 0.1702312
	speed: 0.0275s/iter; left time: 142.7583s
Epoch: 1 cost time: 18.843686819076538
Epoch: 1, Steps: 569 | Train Loss: 0.2814767 Vali Loss: 0.1960969 Test Loss: 0.2797114
Validation loss decreased (inf --> 0.196097).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1640143
	speed: 0.0933s/iter; left time: 468.4240s
	iters: 200, epoch: 2 | loss: 0.1515740
	speed: 0.0277s/iter; left time: 136.1845s
	iters: 300, epoch: 2 | loss: 0.1464253
	speed: 0.0277s/iter; left time: 133.5137s
	iters: 400, epoch: 2 | loss: 0.1350125
	speed: 0.0276s/iter; left time: 130.5377s
	iters: 500, epoch: 2 | loss: 0.1357607
	speed: 0.0276s/iter; left time: 127.7160s
Epoch: 2 cost time: 15.721931219100952
Epoch: 2, Steps: 569 | Train Loss: 0.1501419 Vali Loss: 0.1907138 Test Loss: 0.2586962
Validation loss decreased (0.196097 --> 0.190714).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1309149
	speed: 0.0938s/iter; left time: 417.7078s
	iters: 200, epoch: 3 | loss: 0.1263251
	speed: 0.0277s/iter; left time: 120.7586s
	iters: 300, epoch: 3 | loss: 0.1406829
	speed: 0.0277s/iter; left time: 117.7046s
	iters: 400, epoch: 3 | loss: 0.1220906
	speed: 0.0277s/iter; left time: 115.0460s
	iters: 500, epoch: 3 | loss: 0.1238097
	speed: 0.0276s/iter; left time: 111.9230s
Epoch: 3 cost time: 15.745174407958984
Epoch: 3, Steps: 569 | Train Loss: 0.1258582 Vali Loss: 0.1888835 Test Loss: 0.2546228
Validation loss decreased (0.190714 --> 0.188883).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1187901
	speed: 0.0944s/iter; left time: 366.4749s
	iters: 200, epoch: 4 | loss: 0.1181159
	speed: 0.0277s/iter; left time: 104.9551s
	iters: 300, epoch: 4 | loss: 0.1244898
	speed: 0.0277s/iter; left time: 102.0429s
	iters: 400, epoch: 4 | loss: 0.1139646
	speed: 0.0276s/iter; left time: 99.0087s
	iters: 500, epoch: 4 | loss: 0.1120746
	speed: 0.0276s/iter; left time: 96.2600s
Epoch: 4 cost time: 15.74446988105774
Epoch: 4, Steps: 569 | Train Loss: 0.1161655 Vali Loss: 0.1875435 Test Loss: 0.2516958
Validation loss decreased (0.188883 --> 0.187544).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1081626
	speed: 0.0935s/iter; left time: 310.1034s
	iters: 200, epoch: 5 | loss: 0.1105892
	speed: 0.0276s/iter; left time: 88.5839s
	iters: 300, epoch: 5 | loss: 0.1145890
	speed: 0.0276s/iter; left time: 85.8550s
	iters: 400, epoch: 5 | loss: 0.1144066
	speed: 0.0276s/iter; left time: 83.1923s
	iters: 500, epoch: 5 | loss: 0.1095043
	speed: 0.0276s/iter; left time: 80.5566s
Epoch: 5 cost time: 15.694147109985352
Epoch: 5, Steps: 569 | Train Loss: 0.1117429 Vali Loss: 0.1863632 Test Loss: 0.2510824
Validation loss decreased (0.187544 --> 0.186363).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1087379
	speed: 0.0937s/iter; left time: 257.1878s
	iters: 200, epoch: 6 | loss: 0.1113093
	speed: 0.0277s/iter; left time: 73.2509s
	iters: 300, epoch: 6 | loss: 0.1098440
	speed: 0.0278s/iter; left time: 70.7068s
	iters: 400, epoch: 6 | loss: 0.1098964
	speed: 0.0277s/iter; left time: 67.6918s
	iters: 500, epoch: 6 | loss: 0.1082696
	speed: 0.0278s/iter; left time: 65.1790s
Epoch: 6 cost time: 15.77851939201355
Epoch: 6, Steps: 569 | Train Loss: 0.1094694 Vali Loss: 0.1862557 Test Loss: 0.2516769
Validation loss decreased (0.186363 --> 0.186256).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1032313
	speed: 0.0947s/iter; left time: 206.1328s
	iters: 200, epoch: 7 | loss: 0.1080627
	speed: 0.0278s/iter; left time: 57.6498s
	iters: 300, epoch: 7 | loss: 0.1061413
	speed: 0.0278s/iter; left time: 54.9980s
	iters: 400, epoch: 7 | loss: 0.1055419
	speed: 0.0278s/iter; left time: 52.0932s
	iters: 500, epoch: 7 | loss: 0.1118911
	speed: 0.0278s/iter; left time: 49.3430s
Epoch: 7 cost time: 15.814316749572754
Epoch: 7, Steps: 569 | Train Loss: 0.1082643 Vali Loss: 0.1870362 Test Loss: 0.2513554
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1129745
	speed: 0.0916s/iter; left time: 147.2698s
	iters: 200, epoch: 8 | loss: 0.1144244
	speed: 0.0276s/iter; left time: 41.6630s
	iters: 300, epoch: 8 | loss: 0.1018994
	speed: 0.0278s/iter; left time: 39.1105s
	iters: 400, epoch: 8 | loss: 0.1022312
	speed: 0.0277s/iter; left time: 36.2548s
	iters: 500, epoch: 8 | loss: 0.1115996
	speed: 0.0276s/iter; left time: 33.3884s
Epoch: 8 cost time: 15.747099876403809
Epoch: 8, Steps: 569 | Train Loss: 0.1076045 Vali Loss: 0.1869473 Test Loss: 0.2516885
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1047628
	speed: 0.0913s/iter; left time: 94.8724s
	iters: 200, epoch: 9 | loss: 0.1131972
	speed: 0.0278s/iter; left time: 26.0627s
	iters: 300, epoch: 9 | loss: 0.1089372
	speed: 0.0278s/iter; left time: 23.2891s
	iters: 400, epoch: 9 | loss: 0.1072540
	speed: 0.0277s/iter; left time: 20.4894s
	iters: 500, epoch: 9 | loss: 0.1049397
	speed: 0.0278s/iter; left time: 17.7483s
Epoch: 9 cost time: 15.805718660354614
Epoch: 9, Steps: 569 | Train Loss: 0.1072533 Vali Loss: 0.1872835 Test Loss: 0.2515845
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : electricity_96_Transformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed15227<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5165
mse:0.25122636556625366, mae:0.3524797856807709
