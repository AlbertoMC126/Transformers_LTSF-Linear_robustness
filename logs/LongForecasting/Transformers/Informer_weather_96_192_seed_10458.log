Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=21, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=21, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Informer', model_id='weather_192', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=192, root_path='./dataset/', seed=10458, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_192_Informer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed10458>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36600
val 5079
test 10348
	iters: 100, epoch: 1 | loss: 0.3657518
	speed: 0.0643s/iter; left time: 728.7228s
	iters: 200, epoch: 1 | loss: 0.4401303
	speed: 0.0339s/iter; left time: 380.9231s
	iters: 300, epoch: 1 | loss: 0.4048429
	speed: 0.0338s/iter; left time: 376.1813s
	iters: 400, epoch: 1 | loss: 0.3540877
	speed: 0.0337s/iter; left time: 371.6177s
	iters: 500, epoch: 1 | loss: 0.3163484
	speed: 0.0336s/iter; left time: 367.3659s
	iters: 600, epoch: 1 | loss: 0.8489225
	speed: 0.0336s/iter; left time: 363.9462s
	iters: 700, epoch: 1 | loss: 0.4219813
	speed: 0.0336s/iter; left time: 360.8616s
	iters: 800, epoch: 1 | loss: 0.4771487
	speed: 0.0339s/iter; left time: 360.7963s
	iters: 900, epoch: 1 | loss: 0.3512117
	speed: 0.0339s/iter; left time: 356.5501s
	iters: 1000, epoch: 1 | loss: 0.2385649
	speed: 0.0338s/iter; left time: 352.7509s
	iters: 1100, epoch: 1 | loss: 0.3192486
	speed: 0.0337s/iter; left time: 347.8238s
Epoch: 1 cost time: 41.65640926361084
Epoch: 1, Steps: 1143 | Train Loss: 0.4411312 Vali Loss: 0.6306039 Test Loss: 0.6756198
Validation loss decreased (inf --> 0.630604).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3542044
	speed: 0.1131s/iter; left time: 1152.0236s
	iters: 200, epoch: 2 | loss: 0.2316475
	speed: 0.0349s/iter; left time: 352.4962s
	iters: 300, epoch: 2 | loss: 0.7449288
	speed: 0.0348s/iter; left time: 347.1775s
	iters: 400, epoch: 2 | loss: 0.4586894
	speed: 0.0345s/iter; left time: 340.6443s
	iters: 500, epoch: 2 | loss: 0.3003840
	speed: 0.0346s/iter; left time: 338.7209s
	iters: 600, epoch: 2 | loss: 0.2466089
	speed: 0.0347s/iter; left time: 336.2021s
	iters: 700, epoch: 2 | loss: 0.2182700
	speed: 0.0347s/iter; left time: 332.3002s
	iters: 800, epoch: 2 | loss: 0.2580816
	speed: 0.0338s/iter; left time: 321.1391s
	iters: 900, epoch: 2 | loss: 0.2500850
	speed: 0.0336s/iter; left time: 315.4813s
	iters: 1000, epoch: 2 | loss: 0.2590406
	speed: 0.0337s/iter; left time: 312.7374s
	iters: 1100, epoch: 2 | loss: 0.4426241
	speed: 0.0337s/iter; left time: 309.3087s
Epoch: 2 cost time: 39.26178431510925
Epoch: 2, Steps: 1143 | Train Loss: 0.3468253 Vali Loss: 0.5683386 Test Loss: 0.4629337
Validation loss decreased (0.630604 --> 0.568339).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.6154845
	speed: 0.1108s/iter; left time: 1002.4578s
	iters: 200, epoch: 3 | loss: 0.5044988
	speed: 0.0337s/iter; left time: 301.1305s
	iters: 300, epoch: 3 | loss: 0.1757437
	speed: 0.0339s/iter; left time: 299.5617s
	iters: 400, epoch: 3 | loss: 0.2063428
	speed: 0.0341s/iter; left time: 298.1898s
	iters: 500, epoch: 3 | loss: 0.2086094
	speed: 0.0343s/iter; left time: 296.5346s
	iters: 600, epoch: 3 | loss: 0.2097398
	speed: 0.0339s/iter; left time: 289.6119s
	iters: 700, epoch: 3 | loss: 0.6550908
	speed: 0.0337s/iter; left time: 284.9226s
	iters: 800, epoch: 3 | loss: 0.2040166
	speed: 0.0337s/iter; left time: 281.3928s
	iters: 900, epoch: 3 | loss: 0.2229664
	speed: 0.0338s/iter; left time: 278.4190s
	iters: 1000, epoch: 3 | loss: 0.1686955
	speed: 0.0340s/iter; left time: 276.5767s
	iters: 1100, epoch: 3 | loss: 0.1640135
	speed: 0.0339s/iter; left time: 272.8809s
Epoch: 3 cost time: 38.724568605422974
Epoch: 3, Steps: 1143 | Train Loss: 0.2808391 Vali Loss: 0.5714463 Test Loss: 0.4605797
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1868563
	speed: 0.1081s/iter; left time: 854.1990s
	iters: 200, epoch: 4 | loss: 0.2078912
	speed: 0.0335s/iter; left time: 261.5894s
	iters: 300, epoch: 4 | loss: 0.1558480
	speed: 0.0335s/iter; left time: 257.7838s
	iters: 400, epoch: 4 | loss: 0.2400005
	speed: 0.0335s/iter; left time: 254.3562s
	iters: 500, epoch: 4 | loss: 0.5421127
	speed: 0.0335s/iter; left time: 251.0516s
	iters: 600, epoch: 4 | loss: 0.2148693
	speed: 0.0335s/iter; left time: 247.8199s
	iters: 700, epoch: 4 | loss: 0.2220532
	speed: 0.0335s/iter; left time: 244.5308s
	iters: 800, epoch: 4 | loss: 0.2163269
	speed: 0.0349s/iter; left time: 251.0921s
	iters: 900, epoch: 4 | loss: 0.5220206
	speed: 0.0347s/iter; left time: 246.7284s
	iters: 1000, epoch: 4 | loss: 0.4977175
	speed: 0.0350s/iter; left time: 244.7754s
	iters: 1100, epoch: 4 | loss: 0.6037427
	speed: 0.0345s/iter; left time: 238.2122s
Epoch: 4 cost time: 38.86606431007385
Epoch: 4, Steps: 1143 | Train Loss: 0.2535248 Vali Loss: 0.5664583 Test Loss: 0.4619998
Validation loss decreased (0.568339 --> 0.566458).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1897693
	speed: 0.1136s/iter; left time: 767.8993s
	iters: 200, epoch: 5 | loss: 0.1974800
	speed: 0.0349s/iter; left time: 232.4765s
	iters: 300, epoch: 5 | loss: 0.2045161
	speed: 0.0341s/iter; left time: 223.9256s
	iters: 400, epoch: 5 | loss: 0.1460754
	speed: 0.0337s/iter; left time: 217.7823s
	iters: 500, epoch: 5 | loss: 0.1743364
	speed: 0.0336s/iter; left time: 213.8054s
	iters: 600, epoch: 5 | loss: 0.1857267
	speed: 0.0339s/iter; left time: 212.0489s
	iters: 700, epoch: 5 | loss: 0.1147751
	speed: 0.0341s/iter; left time: 210.3079s
	iters: 800, epoch: 5 | loss: 0.1767820
	speed: 0.0338s/iter; left time: 205.0828s
	iters: 900, epoch: 5 | loss: 0.2012408
	speed: 0.0337s/iter; left time: 200.7246s
	iters: 1000, epoch: 5 | loss: 0.2070625
	speed: 0.0337s/iter; left time: 197.6123s
	iters: 1100, epoch: 5 | loss: 0.1608369
	speed: 0.0337s/iter; left time: 193.8355s
Epoch: 5 cost time: 38.88367199897766
Epoch: 5, Steps: 1143 | Train Loss: 0.2408550 Vali Loss: 0.5582153 Test Loss: 0.4689645
Validation loss decreased (0.566458 --> 0.558215).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1667229
	speed: 0.1103s/iter; left time: 619.3810s
	iters: 200, epoch: 6 | loss: 0.1698470
	speed: 0.0336s/iter; left time: 185.0735s
	iters: 300, epoch: 6 | loss: 0.1817923
	speed: 0.0336s/iter; left time: 181.7519s
	iters: 400, epoch: 6 | loss: 0.1487886
	speed: 0.0337s/iter; left time: 179.1700s
	iters: 500, epoch: 6 | loss: 0.5026067
	speed: 0.0338s/iter; left time: 176.4218s
	iters: 600, epoch: 6 | loss: 0.1934392
	speed: 0.0337s/iter; left time: 172.3936s
	iters: 700, epoch: 6 | loss: 0.1547388
	speed: 0.0336s/iter; left time: 168.6971s
	iters: 800, epoch: 6 | loss: 0.1951997
	speed: 0.0335s/iter; left time: 164.7504s
	iters: 900, epoch: 6 | loss: 0.5299389
	speed: 0.0335s/iter; left time: 161.2829s
	iters: 1000, epoch: 6 | loss: 0.1333439
	speed: 0.0335s/iter; left time: 157.9454s
	iters: 1100, epoch: 6 | loss: 0.7782551
	speed: 0.0335s/iter; left time: 154.7061s
Epoch: 6 cost time: 38.400681257247925
Epoch: 6, Steps: 1143 | Train Loss: 0.2346738 Vali Loss: 0.5650734 Test Loss: 0.4803646
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.4916999
	speed: 0.1082s/iter; left time: 484.0559s
	iters: 200, epoch: 7 | loss: 0.1685183
	speed: 0.0336s/iter; left time: 146.7960s
	iters: 300, epoch: 7 | loss: 0.1379289
	speed: 0.0346s/iter; left time: 147.6419s
	iters: 400, epoch: 7 | loss: 0.1527707
	speed: 0.0353s/iter; left time: 147.4666s
	iters: 500, epoch: 7 | loss: 0.1358832
	speed: 0.0352s/iter; left time: 143.2995s
	iters: 600, epoch: 7 | loss: 0.1563022
	speed: 0.0352s/iter; left time: 139.7060s
	iters: 700, epoch: 7 | loss: 0.2270841
	speed: 0.0354s/iter; left time: 137.0564s
	iters: 800, epoch: 7 | loss: 0.1492336
	speed: 0.0351s/iter; left time: 132.3593s
	iters: 900, epoch: 7 | loss: 0.1714403
	speed: 0.0355s/iter; left time: 130.4990s
	iters: 1000, epoch: 7 | loss: 0.1949712
	speed: 0.0351s/iter; left time: 125.2411s
	iters: 1100, epoch: 7 | loss: 0.2401622
	speed: 0.0355s/iter; left time: 123.1721s
Epoch: 7 cost time: 39.854418992996216
Epoch: 7, Steps: 1143 | Train Loss: 0.2315082 Vali Loss: 0.5654255 Test Loss: 0.4795099
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2108966
	speed: 0.1083s/iter; left time: 360.7763s
	iters: 200, epoch: 8 | loss: 0.1842260
	speed: 0.0338s/iter; left time: 109.2854s
	iters: 300, epoch: 8 | loss: 0.1966171
	speed: 0.0338s/iter; left time: 105.6579s
	iters: 400, epoch: 8 | loss: 0.2320656
	speed: 0.0337s/iter; left time: 102.2172s
	iters: 500, epoch: 8 | loss: 0.1995884
	speed: 0.0336s/iter; left time: 98.5217s
	iters: 600, epoch: 8 | loss: 0.4852640
	speed: 0.0336s/iter; left time: 95.0814s
	iters: 700, epoch: 8 | loss: 0.1507505
	speed: 0.0336s/iter; left time: 91.8000s
	iters: 800, epoch: 8 | loss: 0.1721482
	speed: 0.0338s/iter; left time: 88.9347s
	iters: 900, epoch: 8 | loss: 0.2313896
	speed: 0.0337s/iter; left time: 85.2727s
	iters: 1000, epoch: 8 | loss: 0.4730925
	speed: 0.0338s/iter; left time: 82.1746s
	iters: 1100, epoch: 8 | loss: 0.1428417
	speed: 0.0338s/iter; left time: 78.8539s
Epoch: 8 cost time: 38.56833839416504
Epoch: 8, Steps: 1143 | Train Loss: 0.2296285 Vali Loss: 0.5708641 Test Loss: 0.4985824
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : weather_192_Informer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed10458<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10348
mse:0.46931660175323486, mae:0.44401025772094727
