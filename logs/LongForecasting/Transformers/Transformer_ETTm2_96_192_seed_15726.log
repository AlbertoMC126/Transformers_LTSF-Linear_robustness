Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Transformer', model_id='ETTm2_192', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=192, root_path='./dataset/', seed=15726, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm2_192_Transformer_ETTm2_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed15726>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34273
val 11329
test 11329
	iters: 100, epoch: 1 | loss: 0.2619791
	speed: 0.0617s/iter; left time: 655.2004s
	iters: 200, epoch: 1 | loss: 0.3080410
	speed: 0.0316s/iter; left time: 332.3101s
	iters: 300, epoch: 1 | loss: 0.1896257
	speed: 0.0317s/iter; left time: 329.5817s
	iters: 400, epoch: 1 | loss: 0.1657398
	speed: 0.0317s/iter; left time: 326.8485s
	iters: 500, epoch: 1 | loss: 0.1981302
	speed: 0.0316s/iter; left time: 322.9088s
	iters: 600, epoch: 1 | loss: 0.1898851
	speed: 0.0316s/iter; left time: 319.7357s
	iters: 700, epoch: 1 | loss: 0.1891909
	speed: 0.0317s/iter; left time: 316.8713s
	iters: 800, epoch: 1 | loss: 0.1652738
	speed: 0.0319s/iter; left time: 315.7001s
	iters: 900, epoch: 1 | loss: 0.1466851
	speed: 0.0318s/iter; left time: 312.0208s
	iters: 1000, epoch: 1 | loss: 0.1321522
	speed: 0.0318s/iter; left time: 308.9351s
Epoch: 1 cost time: 36.97076773643494
Epoch: 1, Steps: 1071 | Train Loss: 0.2045638 Vali Loss: 0.5535803 Test Loss: 1.0888318
Validation loss decreased (inf --> 0.553580).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1043182
	speed: 0.1290s/iter; left time: 1230.2792s
	iters: 200, epoch: 2 | loss: 0.1095132
	speed: 0.0317s/iter; left time: 299.1310s
	iters: 300, epoch: 2 | loss: 0.1325717
	speed: 0.0317s/iter; left time: 295.9814s
	iters: 400, epoch: 2 | loss: 0.1074628
	speed: 0.0317s/iter; left time: 292.7307s
	iters: 500, epoch: 2 | loss: 0.1158831
	speed: 0.0316s/iter; left time: 289.2357s
	iters: 600, epoch: 2 | loss: 0.0921000
	speed: 0.0317s/iter; left time: 286.4101s
	iters: 700, epoch: 2 | loss: 0.1102053
	speed: 0.0317s/iter; left time: 283.0971s
	iters: 800, epoch: 2 | loss: 0.1002444
	speed: 0.0317s/iter; left time: 280.2582s
	iters: 900, epoch: 2 | loss: 0.0902525
	speed: 0.0317s/iter; left time: 276.9943s
	iters: 1000, epoch: 2 | loss: 0.0903207
	speed: 0.0317s/iter; left time: 273.6657s
Epoch: 2 cost time: 33.91646337509155
Epoch: 2, Steps: 1071 | Train Loss: 0.1169340 Vali Loss: 0.4887861 Test Loss: 0.8332943
Validation loss decreased (0.553580 --> 0.488786).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.0918273
	speed: 0.1289s/iter; left time: 1091.5337s
	iters: 200, epoch: 3 | loss: 0.0858120
	speed: 0.0317s/iter; left time: 265.1831s
	iters: 300, epoch: 3 | loss: 0.0953638
	speed: 0.0317s/iter; left time: 261.9989s
	iters: 400, epoch: 3 | loss: 0.0706238
	speed: 0.0317s/iter; left time: 258.9026s
	iters: 500, epoch: 3 | loss: 0.0748418
	speed: 0.0317s/iter; left time: 255.6620s
	iters: 600, epoch: 3 | loss: 0.0707594
	speed: 0.0317s/iter; left time: 252.5422s
	iters: 700, epoch: 3 | loss: 0.0746393
	speed: 0.0317s/iter; left time: 249.3301s
	iters: 800, epoch: 3 | loss: 0.0683753
	speed: 0.0317s/iter; left time: 246.0041s
	iters: 900, epoch: 3 | loss: 0.0711775
	speed: 0.0316s/iter; left time: 242.5386s
	iters: 1000, epoch: 3 | loss: 0.0779129
	speed: 0.0317s/iter; left time: 239.9521s
Epoch: 3 cost time: 33.919854164123535
Epoch: 3, Steps: 1071 | Train Loss: 0.0814668 Vali Loss: 0.5665627 Test Loss: 1.2432666
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0716481
	speed: 0.1264s/iter; left time: 934.8593s
	iters: 200, epoch: 4 | loss: 0.0640035
	speed: 0.0317s/iter; left time: 231.3365s
	iters: 300, epoch: 4 | loss: 0.0681142
	speed: 0.0317s/iter; left time: 227.8410s
	iters: 400, epoch: 4 | loss: 0.0738874
	speed: 0.0317s/iter; left time: 224.8695s
	iters: 500, epoch: 4 | loss: 0.0860259
	speed: 0.0317s/iter; left time: 221.6008s
	iters: 600, epoch: 4 | loss: 0.0712520
	speed: 0.0317s/iter; left time: 218.4224s
	iters: 700, epoch: 4 | loss: 0.0732619
	speed: 0.0317s/iter; left time: 215.4082s
	iters: 800, epoch: 4 | loss: 0.0653184
	speed: 0.0317s/iter; left time: 212.0939s
	iters: 900, epoch: 4 | loss: 0.0641893
	speed: 0.0317s/iter; left time: 209.1183s
	iters: 1000, epoch: 4 | loss: 0.0662632
	speed: 0.0317s/iter; left time: 205.8313s
Epoch: 4 cost time: 33.90786528587341
Epoch: 4, Steps: 1071 | Train Loss: 0.0694138 Vali Loss: 0.5707474 Test Loss: 1.2293342
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0659039
	speed: 0.1261s/iter; left time: 797.5250s
	iters: 200, epoch: 5 | loss: 0.0654771
	speed: 0.0316s/iter; left time: 196.7999s
	iters: 300, epoch: 5 | loss: 0.0659960
	speed: 0.0316s/iter; left time: 193.7282s
	iters: 400, epoch: 5 | loss: 0.0607209
	speed: 0.0316s/iter; left time: 190.3663s
	iters: 500, epoch: 5 | loss: 0.0651942
	speed: 0.0316s/iter; left time: 187.3808s
	iters: 600, epoch: 5 | loss: 0.0696895
	speed: 0.0316s/iter; left time: 184.0225s
	iters: 700, epoch: 5 | loss: 0.0564208
	speed: 0.0316s/iter; left time: 180.8975s
	iters: 800, epoch: 5 | loss: 0.0622552
	speed: 0.0316s/iter; left time: 177.6184s
	iters: 900, epoch: 5 | loss: 0.0622559
	speed: 0.0317s/iter; left time: 175.2114s
	iters: 1000, epoch: 5 | loss: 0.0668579
	speed: 0.0317s/iter; left time: 172.1163s
Epoch: 5 cost time: 33.85428738594055
Epoch: 5, Steps: 1071 | Train Loss: 0.0640923 Vali Loss: 0.5853600 Test Loss: 1.2251600
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : ETTm2_192_Transformer_ETTm2_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed15726<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
mse:0.8347240090370178, mae:0.657805860042572
