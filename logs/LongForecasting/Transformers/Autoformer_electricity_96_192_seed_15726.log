Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=321, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', dec_in=321, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Autoformer', model_id='electricity_192', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=192, root_path='./dataset/', seed=15726, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : electricity_192_Autoformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed15726>>>>>>>>>>>>>>>>>>>>>>>>>>
train 18125
val 2441
test 5069
	iters: 100, epoch: 1 | loss: 0.2960245
	speed: 0.1055s/iter; left time: 586.6127s
	iters: 200, epoch: 1 | loss: 0.2511399
	speed: 0.0702s/iter; left time: 383.4097s
	iters: 300, epoch: 1 | loss: 0.2029886
	speed: 0.0702s/iter; left time: 376.1726s
	iters: 400, epoch: 1 | loss: 0.2080343
	speed: 0.0704s/iter; left time: 370.4023s
	iters: 500, epoch: 1 | loss: 0.1959605
	speed: 0.0704s/iter; left time: 363.3563s
Epoch: 1 cost time: 43.344884395599365
Epoch: 1, Steps: 566 | Train Loss: 0.2603124 Vali Loss: 0.2709931 Test Loss: 0.3267210
Validation loss decreased (inf --> 0.270993).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1744449
	speed: 0.2596s/iter; left time: 1296.7465s
	iters: 200, epoch: 2 | loss: 0.1732347
	speed: 0.0706s/iter; left time: 345.7231s
	iters: 300, epoch: 2 | loss: 0.1655947
	speed: 0.0711s/iter; left time: 341.1569s
	iters: 400, epoch: 2 | loss: 0.1597031
	speed: 0.0709s/iter; left time: 332.7450s
	iters: 500, epoch: 2 | loss: 0.1638433
	speed: 0.0711s/iter; left time: 326.5243s
Epoch: 2 cost time: 40.11620306968689
Epoch: 2, Steps: 566 | Train Loss: 0.1788334 Vali Loss: 0.1743465 Test Loss: 0.2129799
Validation loss decreased (0.270993 --> 0.174346).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1573104
	speed: 0.2611s/iter; left time: 1156.5440s
	iters: 200, epoch: 3 | loss: 0.1511672
	speed: 0.0710s/iter; left time: 307.4401s
	iters: 300, epoch: 3 | loss: 0.1585667
	speed: 0.0712s/iter; left time: 300.9461s
	iters: 400, epoch: 3 | loss: 0.1549648
	speed: 0.0706s/iter; left time: 291.3661s
	iters: 500, epoch: 3 | loss: 0.1555676
	speed: 0.0711s/iter; left time: 286.6317s
Epoch: 3 cost time: 40.21673369407654
Epoch: 3, Steps: 566 | Train Loss: 0.1565188 Vali Loss: 0.1735980 Test Loss: 0.2097569
Validation loss decreased (0.174346 --> 0.173598).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1437500
	speed: 0.2613s/iter; left time: 1009.4146s
	iters: 200, epoch: 4 | loss: 0.1392657
	speed: 0.0707s/iter; left time: 266.0867s
	iters: 300, epoch: 4 | loss: 0.1465207
	speed: 0.0709s/iter; left time: 259.5887s
	iters: 400, epoch: 4 | loss: 0.1442697
	speed: 0.0711s/iter; left time: 253.2600s
	iters: 500, epoch: 4 | loss: 0.1381422
	speed: 0.0705s/iter; left time: 244.2500s
Epoch: 4 cost time: 40.10100245475769
Epoch: 4, Steps: 566 | Train Loss: 0.1476146 Vali Loss: 0.1722211 Test Loss: 0.2078282
Validation loss decreased (0.173598 --> 0.172221).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1492939
	speed: 0.2607s/iter; left time: 859.3802s
	iters: 200, epoch: 5 | loss: 0.1466415
	speed: 0.0709s/iter; left time: 226.5278s
	iters: 300, epoch: 5 | loss: 0.1548501
	speed: 0.0714s/iter; left time: 221.0156s
	iters: 400, epoch: 5 | loss: 0.1458062
	speed: 0.0715s/iter; left time: 214.2040s
	iters: 500, epoch: 5 | loss: 0.1398289
	speed: 0.0714s/iter; left time: 206.9038s
Epoch: 5 cost time: 40.340731143951416
Epoch: 5, Steps: 566 | Train Loss: 0.1434592 Vali Loss: 0.1727300 Test Loss: 0.2087456
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1365556
	speed: 0.2574s/iter; left time: 702.8667s
	iters: 200, epoch: 6 | loss: 0.1602570
	speed: 0.0705s/iter; left time: 185.3901s
	iters: 300, epoch: 6 | loss: 0.1329898
	speed: 0.0702s/iter; left time: 177.5499s
	iters: 400, epoch: 6 | loss: 0.1394560
	speed: 0.0707s/iter; left time: 171.9518s
	iters: 500, epoch: 6 | loss: 0.1426293
	speed: 0.0706s/iter; left time: 164.5026s
Epoch: 6 cost time: 39.92459487915039
Epoch: 6, Steps: 566 | Train Loss: 0.1412791 Vali Loss: 0.1721232 Test Loss: 0.2094917
Validation loss decreased (0.172221 --> 0.172123).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1288872
	speed: 0.2599s/iter; left time: 562.7688s
	iters: 200, epoch: 7 | loss: 0.1505447
	speed: 0.0706s/iter; left time: 145.8216s
	iters: 300, epoch: 7 | loss: 0.1402978
	speed: 0.0708s/iter; left time: 139.1046s
	iters: 400, epoch: 7 | loss: 0.1360980
	speed: 0.0706s/iter; left time: 131.6963s
	iters: 500, epoch: 7 | loss: 0.1392938
	speed: 0.0707s/iter; left time: 124.7235s
Epoch: 7 cost time: 39.981180906295776
Epoch: 7, Steps: 566 | Train Loss: 0.1401349 Vali Loss: 0.1722803 Test Loss: 0.2098927
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1542111
	speed: 0.2593s/iter; left time: 414.5416s
	iters: 200, epoch: 8 | loss: 0.1359489
	speed: 0.0705s/iter; left time: 105.7004s
	iters: 300, epoch: 8 | loss: 0.1375245
	speed: 0.0708s/iter; left time: 99.0028s
	iters: 400, epoch: 8 | loss: 0.1407230
	speed: 0.0707s/iter; left time: 91.7861s
	iters: 500, epoch: 8 | loss: 0.1384654
	speed: 0.0711s/iter; left time: 85.2033s
Epoch: 8 cost time: 40.06785988807678
Epoch: 8, Steps: 566 | Train Loss: 0.1394932 Vali Loss: 0.1718277 Test Loss: 0.2101046
Validation loss decreased (0.172123 --> 0.171828).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1326476
	speed: 0.2611s/iter; left time: 269.6755s
	iters: 200, epoch: 9 | loss: 0.1444110
	speed: 0.0708s/iter; left time: 66.0166s
	iters: 300, epoch: 9 | loss: 0.1409724
	speed: 0.0708s/iter; left time: 58.9561s
	iters: 400, epoch: 9 | loss: 0.1401451
	speed: 0.0711s/iter; left time: 52.1275s
	iters: 500, epoch: 9 | loss: 0.1381712
	speed: 0.0711s/iter; left time: 44.9981s
Epoch: 9 cost time: 40.224467515945435
Epoch: 9, Steps: 566 | Train Loss: 0.1392089 Vali Loss: 0.1731044 Test Loss: 0.2106821
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1373953
	speed: 0.2591s/iter; left time: 120.9778s
	iters: 200, epoch: 10 | loss: 0.1350392
	speed: 0.0712s/iter; left time: 26.1143s
	iters: 300, epoch: 10 | loss: 0.1321878
	speed: 0.0710s/iter; left time: 18.9440s
	iters: 400, epoch: 10 | loss: 0.1414577
	speed: 0.0711s/iter; left time: 11.8748s
	iters: 500, epoch: 10 | loss: 0.1402792
	speed: 0.0710s/iter; left time: 4.7559s
Epoch: 10 cost time: 40.179537296295166
Epoch: 10, Steps: 566 | Train Loss: 0.1390054 Vali Loss: 0.1723411 Test Loss: 0.2108738
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : electricity_192_Autoformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed15726<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5069
mse:0.20905324816703796, mae:0.31895989179611206
