Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=21, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=21, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Informer', model_id='weather_720', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=720, root_path='./dataset/', seed=10458, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_720_Informer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed10458>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36072
val 4551
test 9820
	iters: 100, epoch: 1 | loss: 0.5610217
	speed: 0.0973s/iter; left time: 1087.4871s
	iters: 200, epoch: 1 | loss: 0.5280640
	speed: 0.0665s/iter; left time: 735.8710s
	iters: 300, epoch: 1 | loss: 0.4701653
	speed: 0.0663s/iter; left time: 727.0344s
	iters: 400, epoch: 1 | loss: 0.7666480
	speed: 0.0664s/iter; left time: 721.3753s
	iters: 500, epoch: 1 | loss: 0.5992256
	speed: 0.0664s/iter; left time: 714.8567s
	iters: 600, epoch: 1 | loss: 0.5504971
	speed: 0.0664s/iter; left time: 708.0621s
	iters: 700, epoch: 1 | loss: 0.5161443
	speed: 0.0662s/iter; left time: 700.3266s
	iters: 800, epoch: 1 | loss: 0.3591004
	speed: 0.0664s/iter; left time: 695.4356s
	iters: 900, epoch: 1 | loss: 0.3369024
	speed: 0.0664s/iter; left time: 688.3091s
	iters: 1000, epoch: 1 | loss: 0.3624496
	speed: 0.0664s/iter; left time: 681.6074s
	iters: 1100, epoch: 1 | loss: 0.3787984
	speed: 0.0664s/iter; left time: 674.9520s
Epoch: 1 cost time: 77.92109441757202
Epoch: 1, Steps: 1127 | Train Loss: 0.5212024 Vali Loss: 0.9540854 Test Loss: 1.3899530
Validation loss decreased (inf --> 0.954085).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4507532
	speed: 0.2213s/iter; left time: 2222.5347s
	iters: 200, epoch: 2 | loss: 0.3741770
	speed: 0.0682s/iter; left time: 677.9785s
	iters: 300, epoch: 2 | loss: 0.3424009
	speed: 0.0683s/iter; left time: 672.8318s
	iters: 400, epoch: 2 | loss: 0.2964990
	speed: 0.0681s/iter; left time: 663.1034s
	iters: 500, epoch: 2 | loss: 0.6424779
	speed: 0.0666s/iter; left time: 642.5328s
	iters: 600, epoch: 2 | loss: 0.4043491
	speed: 0.0665s/iter; left time: 634.7370s
	iters: 700, epoch: 2 | loss: 0.6400445
	speed: 0.0665s/iter; left time: 627.8880s
	iters: 800, epoch: 2 | loss: 0.2445159
	speed: 0.0667s/iter; left time: 623.2997s
	iters: 900, epoch: 2 | loss: 0.3597951
	speed: 0.0667s/iter; left time: 616.8168s
	iters: 1000, epoch: 2 | loss: 0.2614489
	speed: 0.0668s/iter; left time: 610.9024s
	iters: 1100, epoch: 2 | loss: 0.3847040
	speed: 0.0666s/iter; left time: 602.1799s
Epoch: 2 cost time: 75.71388268470764
Epoch: 2, Steps: 1127 | Train Loss: 0.3819692 Vali Loss: 0.8529263 Test Loss: 1.1760747
Validation loss decreased (0.954085 --> 0.852926).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4012984
	speed: 0.2175s/iter; left time: 1939.6367s
	iters: 200, epoch: 3 | loss: 0.3352140
	speed: 0.0667s/iter; left time: 588.4059s
	iters: 300, epoch: 3 | loss: 0.3513443
	speed: 0.0667s/iter; left time: 581.1647s
	iters: 400, epoch: 3 | loss: 0.4643067
	speed: 0.0668s/iter; left time: 575.2202s
	iters: 500, epoch: 3 | loss: 0.3602572
	speed: 0.0674s/iter; left time: 573.9194s
	iters: 600, epoch: 3 | loss: 0.2194581
	speed: 0.0673s/iter; left time: 566.3285s
	iters: 700, epoch: 3 | loss: 0.2568477
	speed: 0.0673s/iter; left time: 559.6141s
	iters: 800, epoch: 3 | loss: 0.3226685
	speed: 0.0674s/iter; left time: 553.9496s
	iters: 900, epoch: 3 | loss: 0.3061218
	speed: 0.0672s/iter; left time: 545.1454s
	iters: 1000, epoch: 3 | loss: 0.2725939
	speed: 0.0666s/iter; left time: 534.0466s
	iters: 1100, epoch: 3 | loss: 0.2234764
	speed: 0.0668s/iter; left time: 529.0238s
Epoch: 3 cost time: 75.48509073257446
Epoch: 3, Steps: 1127 | Train Loss: 0.3079418 Vali Loss: 0.8775654 Test Loss: 1.2679150
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2284563
	speed: 0.2150s/iter; left time: 1674.7280s
	iters: 200, epoch: 4 | loss: 0.4380914
	speed: 0.0666s/iter; left time: 512.0088s
	iters: 300, epoch: 4 | loss: 0.2910249
	speed: 0.0668s/iter; left time: 506.9707s
	iters: 400, epoch: 4 | loss: 0.3242336
	speed: 0.0665s/iter; left time: 497.9953s
	iters: 500, epoch: 4 | loss: 0.2920501
	speed: 0.0664s/iter; left time: 490.8027s
	iters: 600, epoch: 4 | loss: 0.1955174
	speed: 0.0663s/iter; left time: 483.4871s
	iters: 700, epoch: 4 | loss: 0.1921104
	speed: 0.0663s/iter; left time: 476.3864s
	iters: 800, epoch: 4 | loss: 0.3993659
	speed: 0.0663s/iter; left time: 470.2806s
	iters: 900, epoch: 4 | loss: 0.2233548
	speed: 0.0667s/iter; left time: 466.5400s
	iters: 1000, epoch: 4 | loss: 0.3189736
	speed: 0.0678s/iter; left time: 466.8883s
	iters: 1100, epoch: 4 | loss: 0.3060854
	speed: 0.0676s/iter; left time: 459.2990s
Epoch: 4 cost time: 75.20364475250244
Epoch: 4, Steps: 1127 | Train Loss: 0.2789685 Vali Loss: 0.8386377 Test Loss: 1.1483411
Validation loss decreased (0.852926 --> 0.838638).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3759930
	speed: 0.2183s/iter; left time: 1454.5624s
	iters: 200, epoch: 5 | loss: 0.2253832
	speed: 0.0665s/iter; left time: 436.3446s
	iters: 300, epoch: 5 | loss: 0.3944156
	speed: 0.0665s/iter; left time: 429.5918s
	iters: 400, epoch: 5 | loss: 0.2678655
	speed: 0.0667s/iter; left time: 424.4553s
	iters: 500, epoch: 5 | loss: 0.1950241
	speed: 0.0665s/iter; left time: 416.6263s
	iters: 600, epoch: 5 | loss: 0.4740474
	speed: 0.0664s/iter; left time: 408.9726s
	iters: 700, epoch: 5 | loss: 0.2185408
	speed: 0.0666s/iter; left time: 403.5872s
	iters: 800, epoch: 5 | loss: 0.2156168
	speed: 0.0664s/iter; left time: 396.1939s
	iters: 900, epoch: 5 | loss: 0.2025851
	speed: 0.0664s/iter; left time: 389.3365s
	iters: 1000, epoch: 5 | loss: 0.2786467
	speed: 0.0663s/iter; left time: 382.2911s
	iters: 1100, epoch: 5 | loss: 0.1891978
	speed: 0.0664s/iter; left time: 375.8021s
Epoch: 5 cost time: 74.94832849502563
Epoch: 5, Steps: 1127 | Train Loss: 0.2663026 Vali Loss: 0.8605548 Test Loss: 1.1889849
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1648065
	speed: 0.2163s/iter; left time: 1197.5407s
	iters: 200, epoch: 6 | loss: 0.1956540
	speed: 0.0681s/iter; left time: 370.2577s
	iters: 300, epoch: 6 | loss: 0.2559201
	speed: 0.0682s/iter; left time: 363.9061s
	iters: 400, epoch: 6 | loss: 0.1559097
	speed: 0.0681s/iter; left time: 356.7352s
	iters: 500, epoch: 6 | loss: 0.2980471
	speed: 0.0676s/iter; left time: 347.4486s
	iters: 600, epoch: 6 | loss: 0.1791599
	speed: 0.0665s/iter; left time: 334.7011s
	iters: 700, epoch: 6 | loss: 0.1650973
	speed: 0.0665s/iter; left time: 328.3329s
	iters: 800, epoch: 6 | loss: 0.2143775
	speed: 0.0666s/iter; left time: 322.1586s
	iters: 900, epoch: 6 | loss: 0.2882116
	speed: 0.0665s/iter; left time: 314.7554s
	iters: 1000, epoch: 6 | loss: 0.1823334
	speed: 0.0666s/iter; left time: 308.6057s
	iters: 1100, epoch: 6 | loss: 0.3467018
	speed: 0.0665s/iter; left time: 301.6811s
Epoch: 6 cost time: 75.68432116508484
Epoch: 6, Steps: 1127 | Train Loss: 0.2600516 Vali Loss: 0.8533605 Test Loss: 1.1726681
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2127484
	speed: 0.2154s/iter; left time: 949.8246s
	iters: 200, epoch: 7 | loss: 0.1932934
	speed: 0.0667s/iter; left time: 287.2301s
	iters: 300, epoch: 7 | loss: 0.2773186
	speed: 0.0667s/iter; left time: 280.6821s
	iters: 400, epoch: 7 | loss: 0.2068928
	speed: 0.0667s/iter; left time: 274.2065s
	iters: 500, epoch: 7 | loss: 0.2686082
	speed: 0.0666s/iter; left time: 266.9862s
	iters: 600, epoch: 7 | loss: 0.1663581
	speed: 0.0672s/iter; left time: 262.7804s
	iters: 700, epoch: 7 | loss: 0.2049981
	speed: 0.0676s/iter; left time: 257.5464s
	iters: 800, epoch: 7 | loss: 0.1704483
	speed: 0.0676s/iter; left time: 250.6547s
	iters: 900, epoch: 7 | loss: 0.4756081
	speed: 0.0676s/iter; left time: 243.9012s
	iters: 1000, epoch: 7 | loss: 0.1725201
	speed: 0.0672s/iter; left time: 235.9233s
	iters: 1100, epoch: 7 | loss: 0.2751862
	speed: 0.0666s/iter; left time: 227.0637s
Epoch: 7 cost time: 75.51436352729797
Epoch: 7, Steps: 1127 | Train Loss: 0.2571085 Vali Loss: 0.8414618 Test Loss: 1.1596200
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : weather_720_Informer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed10458<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9820
mse:1.1482280492782593, mae:0.7955976724624634
