Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=321, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', dec_in=321, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Informer', model_id='electricity_720', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=720, root_path='./dataset/', seed=28649, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : electricity_720_Informer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed28649>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17597
val 1913
test 4541
	iters: 100, epoch: 1 | loss: 0.8487364
	speed: 0.1256s/iter; left time: 677.2646s
	iters: 200, epoch: 1 | loss: 0.8442092
	speed: 0.0924s/iter; left time: 488.9215s
	iters: 300, epoch: 1 | loss: 0.7706625
	speed: 0.0925s/iter; left time: 480.0935s
	iters: 400, epoch: 1 | loss: 0.7939318
	speed: 0.0925s/iter; left time: 470.7617s
	iters: 500, epoch: 1 | loss: 0.7698618
	speed: 0.0928s/iter; left time: 463.0176s
Epoch: 1 cost time: 54.15717315673828
Epoch: 1, Steps: 549 | Train Loss: 0.8205738 Vali Loss: 0.7627382 Test Loss: 0.9130582
Validation loss decreased (inf --> 0.762738).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.7534835
	speed: 0.2943s/iter; left time: 1425.1368s
	iters: 200, epoch: 2 | loss: 0.7670628
	speed: 0.0924s/iter; left time: 438.0174s
	iters: 300, epoch: 2 | loss: 0.6230389
	speed: 0.0926s/iter; left time: 429.6751s
	iters: 400, epoch: 2 | loss: 0.5185359
	speed: 0.0929s/iter; left time: 421.7777s
	iters: 500, epoch: 2 | loss: 0.4468304
	speed: 0.0940s/iter; left time: 417.7654s
Epoch: 2 cost time: 51.03535747528076
Epoch: 2, Steps: 549 | Train Loss: 0.6403512 Vali Loss: 0.4311294 Test Loss: 0.5089670
Validation loss decreased (0.762738 --> 0.431129).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3066962
	speed: 0.2969s/iter; left time: 1274.4878s
	iters: 200, epoch: 3 | loss: 0.2974817
	speed: 0.0926s/iter; left time: 388.3698s
	iters: 300, epoch: 3 | loss: 0.2704365
	speed: 0.0927s/iter; left time: 379.5213s
	iters: 400, epoch: 3 | loss: 0.2553421
	speed: 0.0927s/iter; left time: 370.2088s
	iters: 500, epoch: 3 | loss: 0.2451646
	speed: 0.0927s/iter; left time: 360.8377s
Epoch: 3 cost time: 50.89698386192322
Epoch: 3, Steps: 549 | Train Loss: 0.2806622 Vali Loss: 0.3427214 Test Loss: 0.4116389
Validation loss decreased (0.431129 --> 0.342721).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2395771
	speed: 0.2942s/iter; left time: 1101.5932s
	iters: 200, epoch: 4 | loss: 0.2410067
	speed: 0.0926s/iter; left time: 337.3838s
	iters: 300, epoch: 4 | loss: 0.2278772
	speed: 0.0949s/iter; left time: 336.1501s
	iters: 400, epoch: 4 | loss: 0.2268255
	speed: 0.0945s/iter; left time: 325.4651s
	iters: 500, epoch: 4 | loss: 0.2256341
	speed: 0.0943s/iter; left time: 315.3470s
Epoch: 4 cost time: 51.49096155166626
Epoch: 4, Steps: 549 | Train Loss: 0.2324167 Vali Loss: 0.3439561 Test Loss: 0.4087663
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2204819
	speed: 0.2922s/iter; left time: 933.6796s
	iters: 200, epoch: 5 | loss: 0.2154434
	speed: 0.0928s/iter; left time: 287.1368s
	iters: 300, epoch: 5 | loss: 0.2114503
	speed: 0.0928s/iter; left time: 277.9509s
	iters: 400, epoch: 5 | loss: 0.2147262
	speed: 0.0927s/iter; left time: 268.4198s
	iters: 500, epoch: 5 | loss: 0.2175325
	speed: 0.0927s/iter; left time: 259.2276s
Epoch: 5 cost time: 50.91652750968933
Epoch: 5, Steps: 549 | Train Loss: 0.2196637 Vali Loss: 0.3418904 Test Loss: 0.4022705
Validation loss decreased (0.342721 --> 0.341890).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2163024
	speed: 0.2945s/iter; left time: 779.3204s
	iters: 200, epoch: 6 | loss: 0.2172868
	speed: 0.0941s/iter; left time: 239.6797s
	iters: 300, epoch: 6 | loss: 0.2180628
	speed: 0.0939s/iter; left time: 229.6582s
	iters: 400, epoch: 6 | loss: 0.2152870
	speed: 0.0938s/iter; left time: 220.1529s
	iters: 500, epoch: 6 | loss: 0.2117522
	speed: 0.0927s/iter; left time: 208.1170s
Epoch: 6 cost time: 51.32437825202942
Epoch: 6, Steps: 549 | Train Loss: 0.2142627 Vali Loss: 0.3366854 Test Loss: 0.4029653
Validation loss decreased (0.341890 --> 0.336685).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2078988
	speed: 0.2946s/iter; left time: 617.8725s
	iters: 200, epoch: 7 | loss: 0.2164630
	speed: 0.0929s/iter; left time: 185.4503s
	iters: 300, epoch: 7 | loss: 0.2191000
	speed: 0.0927s/iter; left time: 175.9417s
	iters: 400, epoch: 7 | loss: 0.2059058
	speed: 0.0929s/iter; left time: 166.8848s
	iters: 500, epoch: 7 | loss: 0.2032716
	speed: 0.0930s/iter; left time: 157.7838s
Epoch: 7 cost time: 50.97436547279358
Epoch: 7, Steps: 549 | Train Loss: 0.2114964 Vali Loss: 0.3369206 Test Loss: 0.4029051
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2063057
	speed: 0.2944s/iter; left time: 455.7212s
	iters: 200, epoch: 8 | loss: 0.2095926
	speed: 0.0939s/iter; left time: 135.9771s
	iters: 300, epoch: 8 | loss: 0.2153979
	speed: 0.0930s/iter; left time: 125.3042s
	iters: 400, epoch: 8 | loss: 0.2207404
	speed: 0.0925s/iter; left time: 115.4246s
	iters: 500, epoch: 8 | loss: 0.2037806
	speed: 0.0926s/iter; left time: 106.3170s
Epoch: 8 cost time: 51.12951421737671
Epoch: 8, Steps: 549 | Train Loss: 0.2101590 Vali Loss: 0.3380181 Test Loss: 0.4023766
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2123746
	speed: 0.2916s/iter; left time: 291.2960s
	iters: 200, epoch: 9 | loss: 0.1978981
	speed: 0.0928s/iter; left time: 83.4643s
	iters: 300, epoch: 9 | loss: 0.2076816
	speed: 0.0928s/iter; left time: 74.1221s
	iters: 400, epoch: 9 | loss: 0.2036507
	speed: 0.0923s/iter; left time: 64.5332s
	iters: 500, epoch: 9 | loss: 0.2022209
	speed: 0.0926s/iter; left time: 55.4829s
Epoch: 9 cost time: 50.94031810760498
Epoch: 9, Steps: 549 | Train Loss: 0.2094623 Vali Loss: 0.3340403 Test Loss: 0.4011540
Validation loss decreased (0.336685 --> 0.334040).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1997517
	speed: 0.3003s/iter; left time: 135.1519s
	iters: 200, epoch: 10 | loss: 0.2051703
	speed: 0.0929s/iter; left time: 32.5092s
	iters: 300, epoch: 10 | loss: 0.2083841
	speed: 0.0935s/iter; left time: 23.3739s
	iters: 400, epoch: 10 | loss: 0.2078631
	speed: 0.0927s/iter; left time: 13.8994s
	iters: 500, epoch: 10 | loss: 0.2003216
	speed: 0.0927s/iter; left time: 4.6332s
Epoch: 10 cost time: 51.20194053649902
Epoch: 10, Steps: 549 | Train Loss: 0.2089651 Vali Loss: 0.3372627 Test Loss: 0.4015890
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : electricity_720_Informer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed28649<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4541
mse:0.40107470750808716, mae:0.4583560824394226
