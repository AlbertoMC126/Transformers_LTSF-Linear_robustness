Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=21, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=21, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Autoformer', model_id='weather_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=336, root_path='./dataset/', seed=25565, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_336_Autoformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed25565>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36456
val 4935
test 10204
	iters: 100, epoch: 1 | loss: 0.6149717
	speed: 0.1192s/iter; left time: 1346.4470s
	iters: 200, epoch: 1 | loss: 0.6561681
	speed: 0.0833s/iter; left time: 932.6213s
	iters: 300, epoch: 1 | loss: 0.5665269
	speed: 0.0833s/iter; left time: 924.1057s
	iters: 400, epoch: 1 | loss: 0.5997283
	speed: 0.0834s/iter; left time: 916.2809s
	iters: 500, epoch: 1 | loss: 0.5064395
	speed: 0.0834s/iter; left time: 908.2377s
	iters: 600, epoch: 1 | loss: 0.4394766
	speed: 0.0834s/iter; left time: 900.1185s
	iters: 700, epoch: 1 | loss: 0.7564761
	speed: 0.0834s/iter; left time: 891.1417s
	iters: 800, epoch: 1 | loss: 0.5897497
	speed: 0.0832s/iter; left time: 881.4703s
	iters: 900, epoch: 1 | loss: 0.6799740
	speed: 0.0833s/iter; left time: 874.1426s
	iters: 1000, epoch: 1 | loss: 0.5194938
	speed: 0.0833s/iter; left time: 865.3893s
	iters: 1100, epoch: 1 | loss: 0.4436047
	speed: 0.0833s/iter; left time: 856.9753s
Epoch: 1 cost time: 98.54243731498718
Epoch: 1, Steps: 1139 | Train Loss: 0.6931689 Vali Loss: 0.7049334 Test Loss: 0.3455473
Validation loss decreased (inf --> 0.704933).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6241282
	speed: 0.3897s/iter; left time: 3955.7760s
	iters: 200, epoch: 2 | loss: 0.8545785
	speed: 0.0833s/iter; left time: 837.1784s
	iters: 300, epoch: 2 | loss: 0.6830003
	speed: 0.0832s/iter; left time: 827.6222s
	iters: 400, epoch: 2 | loss: 1.2449564
	speed: 0.0830s/iter; left time: 818.1947s
	iters: 500, epoch: 2 | loss: 0.5988821
	speed: 0.0830s/iter; left time: 809.3628s
	iters: 600, epoch: 2 | loss: 0.4691927
	speed: 0.0830s/iter; left time: 801.5639s
	iters: 700, epoch: 2 | loss: 0.5280471
	speed: 0.0830s/iter; left time: 792.4157s
	iters: 800, epoch: 2 | loss: 0.9272531
	speed: 0.0830s/iter; left time: 784.6998s
	iters: 900, epoch: 2 | loss: 0.4816214
	speed: 0.0830s/iter; left time: 776.3590s
	iters: 1000, epoch: 2 | loss: 0.8860014
	speed: 0.0831s/iter; left time: 768.7111s
	iters: 1100, epoch: 2 | loss: 0.7381145
	speed: 0.0831s/iter; left time: 760.4734s
Epoch: 2 cost time: 94.63241672515869
Epoch: 2, Steps: 1139 | Train Loss: 0.6502493 Vali Loss: 0.7032753 Test Loss: 0.3615433
Validation loss decreased (0.704933 --> 0.703275).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.6734114
	speed: 0.3903s/iter; left time: 3517.5961s
	iters: 200, epoch: 3 | loss: 0.8489748
	speed: 0.0833s/iter; left time: 742.1118s
	iters: 300, epoch: 3 | loss: 0.7449326
	speed: 0.0831s/iter; left time: 732.7115s
	iters: 400, epoch: 3 | loss: 0.5810395
	speed: 0.0831s/iter; left time: 724.4202s
	iters: 500, epoch: 3 | loss: 0.6430534
	speed: 0.0831s/iter; left time: 715.6799s
	iters: 600, epoch: 3 | loss: 0.7259649
	speed: 0.0832s/iter; left time: 708.0275s
	iters: 700, epoch: 3 | loss: 1.1839186
	speed: 0.0834s/iter; left time: 701.4951s
	iters: 800, epoch: 3 | loss: 0.4923749
	speed: 0.0834s/iter; left time: 693.4013s
	iters: 900, epoch: 3 | loss: 0.5312108
	speed: 0.0834s/iter; left time: 684.6771s
	iters: 1000, epoch: 3 | loss: 0.5385360
	speed: 0.0836s/iter; left time: 678.1076s
	iters: 1100, epoch: 3 | loss: 0.4354759
	speed: 0.0835s/iter; left time: 669.2567s
Epoch: 3 cost time: 94.8791937828064
Epoch: 3, Steps: 1139 | Train Loss: 0.6323380 Vali Loss: 0.7115291 Test Loss: 0.3607133
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.6654668
	speed: 0.3886s/iter; left time: 3059.5725s
	iters: 200, epoch: 4 | loss: 0.5856208
	speed: 0.0835s/iter; left time: 649.1327s
	iters: 300, epoch: 4 | loss: 0.6061144
	speed: 0.0833s/iter; left time: 639.2747s
	iters: 400, epoch: 4 | loss: 0.7810646
	speed: 0.0834s/iter; left time: 631.4891s
	iters: 500, epoch: 4 | loss: 0.5194812
	speed: 0.0833s/iter; left time: 622.2304s
	iters: 600, epoch: 4 | loss: 0.7101387
	speed: 0.0832s/iter; left time: 613.5462s
	iters: 700, epoch: 4 | loss: 0.4874009
	speed: 0.0832s/iter; left time: 604.9642s
	iters: 800, epoch: 4 | loss: 0.5168823
	speed: 0.0832s/iter; left time: 596.7283s
	iters: 900, epoch: 4 | loss: 0.8480697
	speed: 0.0832s/iter; left time: 588.3996s
	iters: 1000, epoch: 4 | loss: 0.5157233
	speed: 0.0833s/iter; left time: 581.0889s
	iters: 1100, epoch: 4 | loss: 0.8027067
	speed: 0.0834s/iter; left time: 573.5168s
Epoch: 4 cost time: 94.87863755226135
Epoch: 4, Steps: 1139 | Train Loss: 0.6216563 Vali Loss: 0.7094382 Test Loss: 0.3644274
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.7425035
	speed: 0.3879s/iter; left time: 2612.7970s
	iters: 200, epoch: 5 | loss: 1.1579120
	speed: 0.0833s/iter; left time: 552.8749s
	iters: 300, epoch: 5 | loss: 0.7575316
	speed: 0.0831s/iter; left time: 542.9217s
	iters: 400, epoch: 5 | loss: 0.6497011
	speed: 0.0830s/iter; left time: 534.4105s
	iters: 500, epoch: 5 | loss: 0.7163915
	speed: 0.0830s/iter; left time: 525.9825s
	iters: 600, epoch: 5 | loss: 0.5385510
	speed: 0.0831s/iter; left time: 517.9410s
	iters: 700, epoch: 5 | loss: 0.4095557
	speed: 0.0830s/iter; left time: 509.0739s
	iters: 800, epoch: 5 | loss: 0.4878181
	speed: 0.0831s/iter; left time: 501.2321s
	iters: 900, epoch: 5 | loss: 0.4358516
	speed: 0.0830s/iter; left time: 492.8799s
	iters: 1000, epoch: 5 | loss: 0.5493564
	speed: 0.0831s/iter; left time: 484.8408s
	iters: 1100, epoch: 5 | loss: 0.7479976
	speed: 0.0831s/iter; left time: 476.7698s
Epoch: 5 cost time: 94.67157530784607
Epoch: 5, Steps: 1139 | Train Loss: 0.6155264 Vali Loss: 0.7069843 Test Loss: 0.3611500
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : weather_336_Autoformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed25565<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10204
mse:0.36156851053237915, mae:0.39273399114608765
