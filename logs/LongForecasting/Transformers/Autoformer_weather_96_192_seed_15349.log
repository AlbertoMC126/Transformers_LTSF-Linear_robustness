Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=21, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=21, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Autoformer', model_id='weather_192', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=192, root_path='./dataset/', seed=15349, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_192_Autoformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed15349>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36600
val 5079
test 10348
	iters: 100, epoch: 1 | loss: 0.5559351
	speed: 0.0979s/iter; left time: 1109.0333s
	iters: 200, epoch: 1 | loss: 0.7151030
	speed: 0.0627s/iter; left time: 704.0244s
	iters: 300, epoch: 1 | loss: 0.9983174
	speed: 0.0622s/iter; left time: 691.9249s
	iters: 400, epoch: 1 | loss: 0.4443900
	speed: 0.0617s/iter; left time: 681.0089s
	iters: 500, epoch: 1 | loss: 0.6960433
	speed: 0.0617s/iter; left time: 674.7515s
	iters: 600, epoch: 1 | loss: 0.6629657
	speed: 0.0617s/iter; left time: 667.9816s
	iters: 700, epoch: 1 | loss: 0.4523602
	speed: 0.0619s/iter; left time: 663.7409s
	iters: 800, epoch: 1 | loss: 0.4041060
	speed: 0.0620s/iter; left time: 659.3206s
	iters: 900, epoch: 1 | loss: 0.4810275
	speed: 0.0620s/iter; left time: 652.4619s
	iters: 1000, epoch: 1 | loss: 0.6115230
	speed: 0.0619s/iter; left time: 646.1884s
	iters: 1100, epoch: 1 | loss: 1.5777092
	speed: 0.0618s/iter; left time: 638.7460s
Epoch: 1 cost time: 74.44331526756287
Epoch: 1, Steps: 1143 | Train Loss: 0.6264299 Vali Loss: 0.6000571 Test Loss: 0.2966811
Validation loss decreased (inf --> 0.600057).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.9530855
	speed: 0.2823s/iter; left time: 2876.3597s
	iters: 200, epoch: 2 | loss: 0.4546487
	speed: 0.0621s/iter; left time: 626.5717s
	iters: 300, epoch: 2 | loss: 1.0723895
	speed: 0.0623s/iter; left time: 622.1017s
	iters: 400, epoch: 2 | loss: 0.3837741
	speed: 0.0621s/iter; left time: 614.1693s
	iters: 500, epoch: 2 | loss: 0.5603532
	speed: 0.0622s/iter; left time: 608.8042s
	iters: 600, epoch: 2 | loss: 0.4358832
	speed: 0.0624s/iter; left time: 604.9672s
	iters: 700, epoch: 2 | loss: 0.5359209
	speed: 0.0623s/iter; left time: 596.9609s
	iters: 800, epoch: 2 | loss: 0.3948767
	speed: 0.0619s/iter; left time: 586.9945s
	iters: 900, epoch: 2 | loss: 0.3984894
	speed: 0.0618s/iter; left time: 580.2202s
	iters: 1000, epoch: 2 | loss: 0.8401675
	speed: 0.0618s/iter; left time: 574.2889s
	iters: 1100, epoch: 2 | loss: 0.3518832
	speed: 0.0618s/iter; left time: 567.6123s
Epoch: 2 cost time: 70.92101311683655
Epoch: 2, Steps: 1143 | Train Loss: 0.5486164 Vali Loss: 0.6244445 Test Loss: 0.3381796
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.7239240
	speed: 0.2787s/iter; left time: 2520.6065s
	iters: 200, epoch: 3 | loss: 0.3563296
	speed: 0.0618s/iter; left time: 553.1879s
	iters: 300, epoch: 3 | loss: 0.4538884
	speed: 0.0617s/iter; left time: 546.1241s
	iters: 400, epoch: 3 | loss: 0.4061634
	speed: 0.0617s/iter; left time: 539.6483s
	iters: 500, epoch: 3 | loss: 0.3643109
	speed: 0.0617s/iter; left time: 533.3431s
	iters: 600, epoch: 3 | loss: 0.3476761
	speed: 0.0619s/iter; left time: 528.7042s
	iters: 700, epoch: 3 | loss: 0.3589154
	speed: 0.0618s/iter; left time: 521.6557s
	iters: 800, epoch: 3 | loss: 0.4381754
	speed: 0.0623s/iter; left time: 519.9113s
	iters: 900, epoch: 3 | loss: 0.3509775
	speed: 0.0624s/iter; left time: 514.3413s
	iters: 1000, epoch: 3 | loss: 1.0592349
	speed: 0.0624s/iter; left time: 507.9852s
	iters: 1100, epoch: 3 | loss: 0.4541537
	speed: 0.0622s/iter; left time: 500.7140s
Epoch: 3 cost time: 70.85342907905579
Epoch: 3, Steps: 1143 | Train Loss: 0.5156505 Vali Loss: 0.6020458 Test Loss: 0.3407269
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4528016
	speed: 0.2795s/iter; left time: 2209.0000s
	iters: 200, epoch: 4 | loss: 0.8135778
	speed: 0.0617s/iter; left time: 481.1166s
	iters: 300, epoch: 4 | loss: 0.3680251
	speed: 0.0617s/iter; left time: 474.9497s
	iters: 400, epoch: 4 | loss: 0.3295852
	speed: 0.0617s/iter; left time: 468.9663s
	iters: 500, epoch: 4 | loss: 0.3082338
	speed: 0.0618s/iter; left time: 463.4238s
	iters: 600, epoch: 4 | loss: 0.4108736
	speed: 0.0617s/iter; left time: 456.7266s
	iters: 700, epoch: 4 | loss: 0.4101883
	speed: 0.0617s/iter; left time: 450.7620s
	iters: 800, epoch: 4 | loss: 0.4251558
	speed: 0.0616s/iter; left time: 443.9784s
	iters: 900, epoch: 4 | loss: 0.3592362
	speed: 0.0616s/iter; left time: 437.7349s
	iters: 1000, epoch: 4 | loss: 0.4494447
	speed: 0.0617s/iter; left time: 431.9689s
	iters: 1100, epoch: 4 | loss: 0.4427283
	speed: 0.0617s/iter; left time: 425.5168s
Epoch: 4 cost time: 70.49007368087769
Epoch: 4, Steps: 1143 | Train Loss: 0.4940813 Vali Loss: 0.6069899 Test Loss: 0.3414559
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : weather_192_Autoformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed15349<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10348
mse:0.2970883846282959, mae:0.3579223155975342
