Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=321, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', dec_in=321, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Informer', model_id='electricity_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=96, root_path='./dataset/', seed=10458, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : electricity_96_Informer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed10458>>>>>>>>>>>>>>>>>>>>>>>>>>
train 18221
val 2537
test 5165
	iters: 100, epoch: 1 | loss: 0.6498145
	speed: 0.0933s/iter; left time: 521.5592s
	iters: 200, epoch: 1 | loss: 0.5073348
	speed: 0.0387s/iter; left time: 212.2325s
	iters: 300, epoch: 1 | loss: 0.4538206
	speed: 0.0385s/iter; left time: 207.7446s
	iters: 400, epoch: 1 | loss: 0.3200211
	speed: 0.0385s/iter; left time: 203.4652s
	iters: 500, epoch: 1 | loss: 0.2934938
	speed: 0.0396s/iter; left time: 205.8062s
Epoch: 1 cost time: 27.62782382965088
Epoch: 1, Steps: 569 | Train Loss: 0.4892765 Vali Loss: 0.3059059 Test Loss: 0.4071483
Validation loss decreased (inf --> 0.305906).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2373804
	speed: 0.1286s/iter; left time: 645.8375s
	iters: 200, epoch: 2 | loss: 0.2146292
	speed: 0.0387s/iter; left time: 190.5511s
	iters: 300, epoch: 2 | loss: 0.1986190
	speed: 0.0389s/iter; left time: 187.5285s
	iters: 400, epoch: 2 | loss: 0.1889572
	speed: 0.0378s/iter; left time: 178.4012s
	iters: 500, epoch: 2 | loss: 0.1887783
	speed: 0.0392s/iter; left time: 181.2667s
Epoch: 2 cost time: 22.37480401992798
Epoch: 2, Steps: 569 | Train Loss: 0.2136387 Vali Loss: 0.2377521 Test Loss: 0.3467693
Validation loss decreased (0.305906 --> 0.237752).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1865601
	speed: 0.1226s/iter; left time: 546.0458s
	iters: 200, epoch: 3 | loss: 0.1696372
	speed: 0.0378s/iter; left time: 164.4293s
	iters: 300, epoch: 3 | loss: 0.1701781
	speed: 0.0374s/iter; left time: 158.9628s
	iters: 400, epoch: 3 | loss: 0.1658521
	speed: 0.0390s/iter; left time: 162.0429s
	iters: 500, epoch: 3 | loss: 0.1669650
	speed: 0.0372s/iter; left time: 150.8726s
Epoch: 3 cost time: 21.506017923355103
Epoch: 3, Steps: 569 | Train Loss: 0.1766434 Vali Loss: 0.2290282 Test Loss: 0.3431017
Validation loss decreased (0.237752 --> 0.229028).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1696835
	speed: 0.1208s/iter; left time: 469.3088s
	iters: 200, epoch: 4 | loss: 0.1611990
	speed: 0.0378s/iter; left time: 143.0397s
	iters: 300, epoch: 4 | loss: 0.1668022
	speed: 0.0376s/iter; left time: 138.3904s
	iters: 400, epoch: 4 | loss: 0.1732728
	speed: 0.0382s/iter; left time: 136.9088s
	iters: 500, epoch: 4 | loss: 0.1631909
	speed: 0.0372s/iter; left time: 129.6187s
Epoch: 4 cost time: 21.463847875595093
Epoch: 4, Steps: 569 | Train Loss: 0.1650895 Vali Loss: 0.2289987 Test Loss: 0.3463101
Validation loss decreased (0.229028 --> 0.228999).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1589247
	speed: 0.1186s/iter; left time: 393.1430s
	iters: 200, epoch: 5 | loss: 0.1674360
	speed: 0.0373s/iter; left time: 119.8618s
	iters: 300, epoch: 5 | loss: 0.1579955
	speed: 0.0385s/iter; left time: 120.0512s
	iters: 400, epoch: 5 | loss: 0.1640237
	speed: 0.0389s/iter; left time: 117.3880s
	iters: 500, epoch: 5 | loss: 0.1599795
	speed: 0.0392s/iter; left time: 114.3460s
Epoch: 5 cost time: 21.785564422607422
Epoch: 5, Steps: 569 | Train Loss: 0.1595822 Vali Loss: 0.2279613 Test Loss: 0.3448933
Validation loss decreased (0.228999 --> 0.227961).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1714920
	speed: 0.1229s/iter; left time: 337.5762s
	iters: 200, epoch: 6 | loss: 0.1531314
	speed: 0.0392s/iter; left time: 103.7699s
	iters: 300, epoch: 6 | loss: 0.1658348
	speed: 0.0387s/iter; left time: 98.6276s
	iters: 400, epoch: 6 | loss: 0.1515946
	speed: 0.0377s/iter; left time: 92.2886s
	iters: 500, epoch: 6 | loss: 0.1475239
	speed: 0.0375s/iter; left time: 87.9823s
Epoch: 6 cost time: 21.803959131240845
Epoch: 6, Steps: 569 | Train Loss: 0.1567712 Vali Loss: 0.2302393 Test Loss: 0.3476976
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1650620
	speed: 0.1172s/iter; left time: 255.2439s
	iters: 200, epoch: 7 | loss: 0.1524415
	speed: 0.0382s/iter; left time: 79.3713s
	iters: 300, epoch: 7 | loss: 0.1559102
	speed: 0.0380s/iter; left time: 75.1784s
	iters: 400, epoch: 7 | loss: 0.1550935
	speed: 0.0374s/iter; left time: 70.1634s
	iters: 500, epoch: 7 | loss: 0.1659454
	speed: 0.0376s/iter; left time: 66.7522s
Epoch: 7 cost time: 21.51792049407959
Epoch: 7, Steps: 569 | Train Loss: 0.1553664 Vali Loss: 0.2301724 Test Loss: 0.3479213
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1611948
	speed: 0.1180s/iter; left time: 189.6723s
	iters: 200, epoch: 8 | loss: 0.1518688
	speed: 0.0375s/iter; left time: 56.5946s
	iters: 300, epoch: 8 | loss: 0.1529897
	speed: 0.0369s/iter; left time: 52.0149s
	iters: 400, epoch: 8 | loss: 0.1498693
	speed: 0.0376s/iter; left time: 49.2384s
	iters: 500, epoch: 8 | loss: 0.1622874
	speed: 0.0379s/iter; left time: 45.8205s
Epoch: 8 cost time: 21.240451335906982
Epoch: 8, Steps: 569 | Train Loss: 0.1544817 Vali Loss: 0.2298821 Test Loss: 0.3465615
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : electricity_96_Informer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed10458<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5165
mse:0.3437155783176422, mae:0.4226532280445099
