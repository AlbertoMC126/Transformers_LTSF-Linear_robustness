Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=21, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=21, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Autoformer', model_id='weather_192', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=192, root_path='./dataset/', seed=10458, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_192_Autoformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed10458>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36600
val 5079
test 10348
	iters: 100, epoch: 1 | loss: 1.0030478
	speed: 0.0970s/iter; left time: 1099.3634s
	iters: 200, epoch: 1 | loss: 0.6050286
	speed: 0.0626s/iter; left time: 702.6836s
	iters: 300, epoch: 1 | loss: 0.4489715
	speed: 0.0628s/iter; left time: 699.1640s
	iters: 400, epoch: 1 | loss: 0.7113485
	speed: 0.0630s/iter; left time: 695.1083s
	iters: 500, epoch: 1 | loss: 0.9825311
	speed: 0.0628s/iter; left time: 686.0135s
	iters: 600, epoch: 1 | loss: 0.4658052
	speed: 0.0630s/iter; left time: 682.1373s
	iters: 700, epoch: 1 | loss: 0.4261767
	speed: 0.0628s/iter; left time: 674.0187s
	iters: 800, epoch: 1 | loss: 0.4541842
	speed: 0.0630s/iter; left time: 669.2734s
	iters: 900, epoch: 1 | loss: 0.5886309
	speed: 0.0629s/iter; left time: 662.5231s
	iters: 1000, epoch: 1 | loss: 0.5174286
	speed: 0.0626s/iter; left time: 652.8863s
	iters: 1100, epoch: 1 | loss: 0.4611801
	speed: 0.0627s/iter; left time: 647.7592s
Epoch: 1 cost time: 75.22637748718262
Epoch: 1, Steps: 1143 | Train Loss: 0.5941505 Vali Loss: 0.6107764 Test Loss: 0.3195416
Validation loss decreased (inf --> 0.610776).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4974757
	speed: 0.2803s/iter; left time: 2855.3313s
	iters: 200, epoch: 2 | loss: 0.4239707
	speed: 0.0625s/iter; left time: 630.3975s
	iters: 300, epoch: 2 | loss: 0.4691232
	speed: 0.0625s/iter; left time: 623.7622s
	iters: 400, epoch: 2 | loss: 0.6616063
	speed: 0.0625s/iter; left time: 617.5648s
	iters: 500, epoch: 2 | loss: 0.4046882
	speed: 0.0624s/iter; left time: 610.9743s
	iters: 600, epoch: 2 | loss: 0.4110412
	speed: 0.0624s/iter; left time: 604.7570s
	iters: 700, epoch: 2 | loss: 0.5453110
	speed: 0.0629s/iter; left time: 603.3630s
	iters: 800, epoch: 2 | loss: 0.4086740
	speed: 0.0627s/iter; left time: 595.2653s
	iters: 900, epoch: 2 | loss: 0.9259529
	speed: 0.0631s/iter; left time: 592.2789s
	iters: 1000, epoch: 2 | loss: 0.8867763
	speed: 0.0628s/iter; left time: 583.5874s
	iters: 1100, epoch: 2 | loss: 0.4892194
	speed: 0.0631s/iter; left time: 579.5366s
Epoch: 2 cost time: 71.66344738006592
Epoch: 2, Steps: 1143 | Train Loss: 0.5397043 Vali Loss: 0.5994979 Test Loss: 0.3029138
Validation loss decreased (0.610776 --> 0.599498).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4416311
	speed: 0.2807s/iter; left time: 2539.1656s
	iters: 200, epoch: 3 | loss: 0.4520460
	speed: 0.0624s/iter; left time: 557.8966s
	iters: 300, epoch: 3 | loss: 0.4486722
	speed: 0.0624s/iter; left time: 551.8953s
	iters: 400, epoch: 3 | loss: 0.8005219
	speed: 0.0624s/iter; left time: 545.5753s
	iters: 500, epoch: 3 | loss: 0.5369933
	speed: 0.0626s/iter; left time: 540.8289s
	iters: 600, epoch: 3 | loss: 0.4339641
	speed: 0.0624s/iter; left time: 532.9350s
	iters: 700, epoch: 3 | loss: 0.4374771
	speed: 0.0624s/iter; left time: 526.8262s
	iters: 800, epoch: 3 | loss: 0.4432496
	speed: 0.0624s/iter; left time: 521.0623s
	iters: 900, epoch: 3 | loss: 0.3894170
	speed: 0.0625s/iter; left time: 515.2975s
	iters: 1000, epoch: 3 | loss: 0.3259197
	speed: 0.0624s/iter; left time: 507.9617s
	iters: 1100, epoch: 3 | loss: 0.4230700
	speed: 0.0624s/iter; left time: 501.8182s
Epoch: 3 cost time: 71.3747546672821
Epoch: 3, Steps: 1143 | Train Loss: 0.5070397 Vali Loss: 0.6129968 Test Loss: 0.3661713
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3454052
	speed: 0.2775s/iter; left time: 2192.5902s
	iters: 200, epoch: 4 | loss: 0.3861494
	speed: 0.0625s/iter; left time: 487.7720s
	iters: 300, epoch: 4 | loss: 0.4081382
	speed: 0.0623s/iter; left time: 479.8865s
	iters: 400, epoch: 4 | loss: 0.3996808
	speed: 0.0623s/iter; left time: 473.4744s
	iters: 500, epoch: 4 | loss: 0.8111913
	speed: 0.0623s/iter; left time: 467.7033s
	iters: 600, epoch: 4 | loss: 0.4859078
	speed: 0.0623s/iter; left time: 461.4193s
	iters: 700, epoch: 4 | loss: 0.3363486
	speed: 0.0624s/iter; left time: 455.3073s
	iters: 800, epoch: 4 | loss: 0.4248302
	speed: 0.0623s/iter; left time: 448.5139s
	iters: 900, epoch: 4 | loss: 0.3193582
	speed: 0.0623s/iter; left time: 442.2060s
	iters: 1000, epoch: 4 | loss: 0.8162760
	speed: 0.0622s/iter; left time: 435.8349s
	iters: 1100, epoch: 4 | loss: 0.3813396
	speed: 0.0622s/iter; left time: 429.5544s
Epoch: 4 cost time: 71.23370337486267
Epoch: 4, Steps: 1143 | Train Loss: 0.4733485 Vali Loss: 0.6178613 Test Loss: 0.4291007
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4117729
	speed: 0.2774s/iter; left time: 1875.1700s
	iters: 200, epoch: 5 | loss: 0.3957093
	speed: 0.0625s/iter; left time: 416.1331s
	iters: 300, epoch: 5 | loss: 0.3838462
	speed: 0.0628s/iter; left time: 412.1747s
	iters: 400, epoch: 5 | loss: 0.3752520
	speed: 0.0629s/iter; left time: 405.9542s
	iters: 500, epoch: 5 | loss: 0.3383289
	speed: 0.0627s/iter; left time: 398.5832s
	iters: 600, epoch: 5 | loss: 0.5016086
	speed: 0.0627s/iter; left time: 392.1733s
	iters: 700, epoch: 5 | loss: 0.4613075
	speed: 0.0627s/iter; left time: 386.0361s
	iters: 800, epoch: 5 | loss: 0.3304444
	speed: 0.0626s/iter; left time: 379.1054s
	iters: 900, epoch: 5 | loss: 0.4734705
	speed: 0.0626s/iter; left time: 373.0336s
	iters: 1000, epoch: 5 | loss: 0.3575847
	speed: 0.0625s/iter; left time: 366.1127s
	iters: 1100, epoch: 5 | loss: 0.7175510
	speed: 0.0625s/iter; left time: 360.1769s
Epoch: 5 cost time: 71.56105780601501
Epoch: 5, Steps: 1143 | Train Loss: 0.4560798 Vali Loss: 0.6178188 Test Loss: 0.4325075
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : weather_192_Autoformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed10458<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10348
mse:0.3033693730831146, mae:0.36315470933914185
