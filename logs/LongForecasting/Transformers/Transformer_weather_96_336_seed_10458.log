Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=21, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=21, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Transformer', model_id='weather_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=336, root_path='./dataset/', seed=10458, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_336_Transformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed10458>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36456
val 4935
test 10204
	iters: 100, epoch: 1 | loss: 0.4193597
	speed: 0.0749s/iter; left time: 845.6696s
	iters: 200, epoch: 1 | loss: 0.4650238
	speed: 0.0440s/iter; left time: 492.7588s
	iters: 300, epoch: 1 | loss: 0.3678033
	speed: 0.0441s/iter; left time: 488.7032s
	iters: 400, epoch: 1 | loss: 0.4002945
	speed: 0.0441s/iter; left time: 484.9541s
	iters: 500, epoch: 1 | loss: 0.2415825
	speed: 0.0441s/iter; left time: 480.6086s
	iters: 600, epoch: 1 | loss: 0.4148749
	speed: 0.0441s/iter; left time: 476.3050s
	iters: 700, epoch: 1 | loss: 0.3741113
	speed: 0.0442s/iter; left time: 472.0261s
	iters: 800, epoch: 1 | loss: 0.2868972
	speed: 0.0441s/iter; left time: 467.3150s
	iters: 900, epoch: 1 | loss: 0.2476613
	speed: 0.0441s/iter; left time: 463.1151s
	iters: 1000, epoch: 1 | loss: 0.2285171
	speed: 0.0441s/iter; left time: 458.2532s
	iters: 1100, epoch: 1 | loss: 0.2341576
	speed: 0.0441s/iter; left time: 454.2870s
Epoch: 1 cost time: 53.333826303482056
Epoch: 1, Steps: 1139 | Train Loss: 0.4266015 Vali Loss: 0.7425659 Test Loss: 0.6722210
Validation loss decreased (inf --> 0.742566).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6293637
	speed: 0.1347s/iter; left time: 1367.5574s
	iters: 200, epoch: 2 | loss: 0.2239270
	speed: 0.0442s/iter; left time: 444.1713s
	iters: 300, epoch: 2 | loss: 0.2633892
	speed: 0.0443s/iter; left time: 440.6265s
	iters: 400, epoch: 2 | loss: 0.2066673
	speed: 0.0444s/iter; left time: 437.6462s
	iters: 500, epoch: 2 | loss: 0.2640039
	speed: 0.0444s/iter; left time: 432.9249s
	iters: 600, epoch: 2 | loss: 0.4482696
	speed: 0.0444s/iter; left time: 428.7202s
	iters: 700, epoch: 2 | loss: 0.2794942
	speed: 0.0444s/iter; left time: 424.0014s
	iters: 800, epoch: 2 | loss: 0.4116478
	speed: 0.0443s/iter; left time: 418.7906s
	iters: 900, epoch: 2 | loss: 0.2086585
	speed: 0.0444s/iter; left time: 415.1401s
	iters: 1000, epoch: 2 | loss: 0.2287219
	speed: 0.0443s/iter; left time: 409.4222s
	iters: 1100, epoch: 2 | loss: 0.1620946
	speed: 0.0442s/iter; left time: 404.0685s
Epoch: 2 cost time: 50.44369459152222
Epoch: 2, Steps: 1139 | Train Loss: 0.2897867 Vali Loss: 0.7594437 Test Loss: 0.7858790
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1918943
	speed: 0.1307s/iter; left time: 1178.1734s
	iters: 200, epoch: 3 | loss: 0.2051814
	speed: 0.0442s/iter; left time: 393.6972s
	iters: 300, epoch: 3 | loss: 0.4573921
	speed: 0.0442s/iter; left time: 389.1163s
	iters: 400, epoch: 3 | loss: 0.2060161
	speed: 0.0442s/iter; left time: 384.7027s
	iters: 500, epoch: 3 | loss: 0.3393286
	speed: 0.0441s/iter; left time: 380.2324s
	iters: 600, epoch: 3 | loss: 0.1809610
	speed: 0.0441s/iter; left time: 375.7341s
	iters: 700, epoch: 3 | loss: 0.1797205
	speed: 0.0441s/iter; left time: 371.2801s
	iters: 800, epoch: 3 | loss: 0.2245497
	speed: 0.0441s/iter; left time: 366.8979s
	iters: 900, epoch: 3 | loss: 0.4459661
	speed: 0.0441s/iter; left time: 362.5768s
	iters: 1000, epoch: 3 | loss: 0.1597564
	speed: 0.0441s/iter; left time: 358.0513s
	iters: 1100, epoch: 3 | loss: 0.1849576
	speed: 0.0441s/iter; left time: 353.4393s
Epoch: 3 cost time: 50.260419845581055
Epoch: 3, Steps: 1139 | Train Loss: 0.2349175 Vali Loss: 0.7691745 Test Loss: 0.7635882
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3874946
	speed: 0.1306s/iter; left time: 1028.4014s
	iters: 200, epoch: 4 | loss: 0.1482429
	speed: 0.0441s/iter; left time: 342.9648s
	iters: 300, epoch: 4 | loss: 0.1617395
	speed: 0.0441s/iter; left time: 338.2967s
	iters: 400, epoch: 4 | loss: 0.1303473
	speed: 0.0441s/iter; left time: 334.1646s
	iters: 500, epoch: 4 | loss: 0.3064078
	speed: 0.0443s/iter; left time: 331.4629s
	iters: 600, epoch: 4 | loss: 0.1498418
	speed: 0.0444s/iter; left time: 327.1524s
	iters: 700, epoch: 4 | loss: 0.2464750
	speed: 0.0444s/iter; left time: 323.2400s
	iters: 800, epoch: 4 | loss: 0.1367289
	speed: 0.0443s/iter; left time: 318.0520s
	iters: 900, epoch: 4 | loss: 0.1080410
	speed: 0.0444s/iter; left time: 313.9646s
	iters: 1000, epoch: 4 | loss: 0.1635136
	speed: 0.0444s/iter; left time: 309.5924s
	iters: 1100, epoch: 4 | loss: 0.3126679
	speed: 0.0443s/iter; left time: 304.5430s
Epoch: 4 cost time: 50.4058039188385
Epoch: 4, Steps: 1139 | Train Loss: 0.2143111 Vali Loss: 0.7602281 Test Loss: 0.7347532
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : weather_336_Transformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed10458<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10204
mse:0.6722710728645325, mae:0.5849737524986267
