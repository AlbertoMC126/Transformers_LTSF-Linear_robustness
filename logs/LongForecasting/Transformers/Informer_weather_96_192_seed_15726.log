Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=21, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=21, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Informer', model_id='weather_192', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=192, root_path='./dataset/', seed=15726, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_192_Informer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed15726>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36600
val 5079
test 10348
	iters: 100, epoch: 1 | loss: 0.6425651
	speed: 0.0639s/iter; left time: 724.1964s
	iters: 200, epoch: 1 | loss: 0.6518745
	speed: 0.0335s/iter; left time: 376.6563s
	iters: 300, epoch: 1 | loss: 0.3570636
	speed: 0.0357s/iter; left time: 397.3326s
	iters: 400, epoch: 1 | loss: 0.3120386
	speed: 0.0355s/iter; left time: 391.6366s
	iters: 500, epoch: 1 | loss: 0.4295063
	speed: 0.0352s/iter; left time: 384.3732s
	iters: 600, epoch: 1 | loss: 0.3079936
	speed: 0.0354s/iter; left time: 382.8773s
	iters: 700, epoch: 1 | loss: 0.3630707
	speed: 0.0353s/iter; left time: 379.1487s
	iters: 800, epoch: 1 | loss: 0.4138351
	speed: 0.0354s/iter; left time: 375.9385s
	iters: 900, epoch: 1 | loss: 0.2903310
	speed: 0.0353s/iter; left time: 372.0467s
	iters: 1000, epoch: 1 | loss: 0.3116240
	speed: 0.0353s/iter; left time: 368.1097s
	iters: 1100, epoch: 1 | loss: 0.3048912
	speed: 0.0342s/iter; left time: 353.7955s
Epoch: 1 cost time: 42.954076051712036
Epoch: 1, Steps: 1143 | Train Loss: 0.4404873 Vali Loss: 0.6215791 Test Loss: 0.5734556
Validation loss decreased (inf --> 0.621579).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3242804
	speed: 0.1106s/iter; left time: 1126.7139s
	iters: 200, epoch: 2 | loss: 0.3381704
	speed: 0.0336s/iter; left time: 339.0007s
	iters: 300, epoch: 2 | loss: 0.2757825
	speed: 0.0340s/iter; left time: 339.4407s
	iters: 400, epoch: 2 | loss: 0.3199524
	speed: 0.0338s/iter; left time: 334.4937s
	iters: 500, epoch: 2 | loss: 0.3313603
	speed: 0.0337s/iter; left time: 329.8201s
	iters: 600, epoch: 2 | loss: 0.2477052
	speed: 0.0336s/iter; left time: 325.4991s
	iters: 700, epoch: 2 | loss: 0.6766327
	speed: 0.0339s/iter; left time: 324.7250s
	iters: 800, epoch: 2 | loss: 0.2352805
	speed: 0.0338s/iter; left time: 321.1216s
	iters: 900, epoch: 2 | loss: 0.6577145
	speed: 0.0340s/iter; left time: 319.0807s
	iters: 1000, epoch: 2 | loss: 0.2886060
	speed: 0.0337s/iter; left time: 313.0237s
	iters: 1100, epoch: 2 | loss: 0.2576463
	speed: 0.0336s/iter; left time: 308.8834s
Epoch: 2 cost time: 38.6027717590332
Epoch: 2, Steps: 1143 | Train Loss: 0.3461530 Vali Loss: 0.5565451 Test Loss: 0.4186604
Validation loss decreased (0.621579 --> 0.556545).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2754191
	speed: 0.1107s/iter; left time: 1001.5272s
	iters: 200, epoch: 3 | loss: 0.6220176
	speed: 0.0336s/iter; left time: 300.6295s
	iters: 300, epoch: 3 | loss: 0.1760040
	speed: 0.0337s/iter; left time: 297.9702s
	iters: 400, epoch: 3 | loss: 0.3320606
	speed: 0.0339s/iter; left time: 296.3446s
	iters: 500, epoch: 3 | loss: 0.2025185
	speed: 0.0339s/iter; left time: 293.2336s
	iters: 600, epoch: 3 | loss: 0.2585144
	speed: 0.0339s/iter; left time: 289.4956s
	iters: 700, epoch: 3 | loss: 0.1716273
	speed: 0.0338s/iter; left time: 285.7631s
	iters: 800, epoch: 3 | loss: 0.1871604
	speed: 0.0336s/iter; left time: 280.7917s
	iters: 900, epoch: 3 | loss: 0.3277928
	speed: 0.0338s/iter; left time: 278.9100s
	iters: 1000, epoch: 3 | loss: 0.3104388
	speed: 0.0338s/iter; left time: 275.6454s
	iters: 1100, epoch: 3 | loss: 0.1900534
	speed: 0.0342s/iter; left time: 275.3337s
Epoch: 3 cost time: 38.709174156188965
Epoch: 3, Steps: 1143 | Train Loss: 0.2798346 Vali Loss: 0.5454985 Test Loss: 0.4037093
Validation loss decreased (0.556545 --> 0.545499).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.5052944
	speed: 0.1127s/iter; left time: 890.5094s
	iters: 200, epoch: 4 | loss: 0.5192686
	speed: 0.0352s/iter; left time: 274.3648s
	iters: 300, epoch: 4 | loss: 0.1631265
	speed: 0.0348s/iter; left time: 268.1968s
	iters: 400, epoch: 4 | loss: 0.2028839
	speed: 0.0349s/iter; left time: 265.5169s
	iters: 500, epoch: 4 | loss: 0.1808916
	speed: 0.0348s/iter; left time: 260.8761s
	iters: 600, epoch: 4 | loss: 0.1957588
	speed: 0.0343s/iter; left time: 254.1732s
	iters: 700, epoch: 4 | loss: 0.1970794
	speed: 0.0337s/iter; left time: 246.2912s
	iters: 800, epoch: 4 | loss: 0.1694796
	speed: 0.0341s/iter; left time: 245.5287s
	iters: 900, epoch: 4 | loss: 0.2091405
	speed: 0.0341s/iter; left time: 242.1386s
	iters: 1000, epoch: 4 | loss: 0.1943843
	speed: 0.0340s/iter; left time: 238.1149s
	iters: 1100, epoch: 4 | loss: 0.2126327
	speed: 0.0338s/iter; left time: 233.2040s
Epoch: 4 cost time: 39.32354950904846
Epoch: 4, Steps: 1143 | Train Loss: 0.2520727 Vali Loss: 0.5761401 Test Loss: 0.4863552
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1736309
	speed: 0.1087s/iter; left time: 734.4524s
	iters: 200, epoch: 5 | loss: 0.4725052
	speed: 0.0339s/iter; left time: 225.9205s
	iters: 300, epoch: 5 | loss: 0.1632623
	speed: 0.0338s/iter; left time: 221.4484s
	iters: 400, epoch: 5 | loss: 0.1400274
	speed: 0.0337s/iter; left time: 217.3593s
	iters: 500, epoch: 5 | loss: 0.1789431
	speed: 0.0338s/iter; left time: 215.0896s
	iters: 600, epoch: 5 | loss: 0.1449908
	speed: 0.0340s/iter; left time: 213.0994s
	iters: 700, epoch: 5 | loss: 0.1367995
	speed: 0.0339s/iter; left time: 208.5889s
	iters: 800, epoch: 5 | loss: 0.4961624
	speed: 0.0337s/iter; left time: 204.3570s
	iters: 900, epoch: 5 | loss: 0.5232387
	speed: 0.0336s/iter; left time: 200.3729s
	iters: 1000, epoch: 5 | loss: 0.2022460
	speed: 0.0338s/iter; left time: 198.1651s
	iters: 1100, epoch: 5 | loss: 0.1352938
	speed: 0.0336s/iter; left time: 193.6047s
Epoch: 5 cost time: 38.6273672580719
Epoch: 5, Steps: 1143 | Train Loss: 0.2398193 Vali Loss: 0.5662434 Test Loss: 0.4501680
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1490380
	speed: 0.1079s/iter; left time: 605.8868s
	iters: 200, epoch: 6 | loss: 0.1875331
	speed: 0.0335s/iter; left time: 184.7759s
	iters: 300, epoch: 6 | loss: 0.1432445
	speed: 0.0335s/iter; left time: 181.4015s
	iters: 400, epoch: 6 | loss: 0.2128526
	speed: 0.0335s/iter; left time: 177.9206s
	iters: 500, epoch: 6 | loss: 0.1350643
	speed: 0.0335s/iter; left time: 174.5704s
	iters: 600, epoch: 6 | loss: 0.5209442
	speed: 0.0335s/iter; left time: 171.5738s
	iters: 700, epoch: 6 | loss: 0.1511374
	speed: 0.0345s/iter; left time: 173.1896s
	iters: 800, epoch: 6 | loss: 0.2065359
	speed: 0.0349s/iter; left time: 171.6438s
	iters: 900, epoch: 6 | loss: 0.2155367
	speed: 0.0347s/iter; left time: 166.9021s
	iters: 1000, epoch: 6 | loss: 0.1904322
	speed: 0.0353s/iter; left time: 166.2479s
	iters: 1100, epoch: 6 | loss: 0.7577928
	speed: 0.0353s/iter; left time: 162.7343s
Epoch: 6 cost time: 39.07143831253052
Epoch: 6, Steps: 1143 | Train Loss: 0.2338406 Vali Loss: 0.5653566 Test Loss: 0.4470719
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : weather_192_Informer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed15726<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10348
mse:0.40397998690605164, mae:0.42186224460601807
