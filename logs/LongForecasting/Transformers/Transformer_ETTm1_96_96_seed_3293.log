Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm1', data_path='ETTm1.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Transformer', model_id='ETTm1_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=96, root_path='./dataset/', seed=3293, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm1_96_Transformer_ETTm1_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed3293>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34369
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.3159213
	speed: 0.0544s/iter; left time: 579.3137s
	iters: 200, epoch: 1 | loss: 0.2651550
	speed: 0.0246s/iter; left time: 259.4977s
	iters: 300, epoch: 1 | loss: 0.3165804
	speed: 0.0246s/iter; left time: 256.9654s
	iters: 400, epoch: 1 | loss: 0.2366316
	speed: 0.0247s/iter; left time: 255.0926s
	iters: 500, epoch: 1 | loss: 0.2179191
	speed: 0.0247s/iter; left time: 252.9093s
	iters: 600, epoch: 1 | loss: 0.2003897
	speed: 0.0248s/iter; left time: 251.2733s
	iters: 700, epoch: 1 | loss: 0.1998698
	speed: 0.0249s/iter; left time: 249.9314s
	iters: 800, epoch: 1 | loss: 0.2095779
	speed: 0.0249s/iter; left time: 247.8917s
	iters: 900, epoch: 1 | loss: 0.1749059
	speed: 0.0249s/iter; left time: 245.0322s
	iters: 1000, epoch: 1 | loss: 0.1780426
	speed: 0.0249s/iter; left time: 242.9198s
Epoch: 1 cost time: 29.59576153755188
Epoch: 1, Steps: 1074 | Train Loss: 0.2425249 Vali Loss: 0.7041835 Test Loss: 0.5688562
Validation loss decreased (inf --> 0.704184).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1247132
	speed: 0.1004s/iter; left time: 960.4460s
	iters: 200, epoch: 2 | loss: 0.1319860
	speed: 0.0248s/iter; left time: 234.5766s
	iters: 300, epoch: 2 | loss: 0.1354136
	speed: 0.0248s/iter; left time: 231.9994s
	iters: 400, epoch: 2 | loss: 0.1316585
	speed: 0.0247s/iter; left time: 229.2794s
	iters: 500, epoch: 2 | loss: 0.1340427
	speed: 0.0247s/iter; left time: 226.8606s
	iters: 600, epoch: 2 | loss: 0.1341461
	speed: 0.0247s/iter; left time: 224.3732s
	iters: 700, epoch: 2 | loss: 0.1092504
	speed: 0.0249s/iter; left time: 223.0317s
	iters: 800, epoch: 2 | loss: 0.0946788
	speed: 0.0249s/iter; left time: 220.4852s
	iters: 900, epoch: 2 | loss: 0.1212876
	speed: 0.0247s/iter; left time: 216.9254s
	iters: 1000, epoch: 2 | loss: 0.0979575
	speed: 0.0248s/iter; left time: 214.6650s
Epoch: 2 cost time: 26.613574504852295
Epoch: 2, Steps: 1074 | Train Loss: 0.1251985 Vali Loss: 0.7473242 Test Loss: 0.5327604
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.0732257
	speed: 0.0983s/iter; left time: 834.7822s
	iters: 200, epoch: 3 | loss: 0.0846406
	speed: 0.0247s/iter; left time: 207.6635s
	iters: 300, epoch: 3 | loss: 0.0729901
	speed: 0.0248s/iter; left time: 205.3306s
	iters: 400, epoch: 3 | loss: 0.0823617
	speed: 0.0248s/iter; left time: 202.8597s
	iters: 500, epoch: 3 | loss: 0.0847764
	speed: 0.0249s/iter; left time: 201.5981s
	iters: 600, epoch: 3 | loss: 0.0778486
	speed: 0.0249s/iter; left time: 199.2894s
	iters: 700, epoch: 3 | loss: 0.0780747
	speed: 0.0249s/iter; left time: 196.4709s
	iters: 800, epoch: 3 | loss: 0.0695246
	speed: 0.0248s/iter; left time: 193.1989s
	iters: 900, epoch: 3 | loss: 0.0746595
	speed: 0.0248s/iter; left time: 190.6100s
	iters: 1000, epoch: 3 | loss: 0.0768854
	speed: 0.0248s/iter; left time: 188.2134s
Epoch: 3 cost time: 26.63462257385254
Epoch: 3, Steps: 1074 | Train Loss: 0.0800012 Vali Loss: 0.7812806 Test Loss: 0.5236542
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0686616
	speed: 0.0986s/iter; left time: 731.7297s
	iters: 200, epoch: 4 | loss: 0.0733019
	speed: 0.0248s/iter; left time: 181.5764s
	iters: 300, epoch: 4 | loss: 0.0657951
	speed: 0.0248s/iter; left time: 178.8774s
	iters: 400, epoch: 4 | loss: 0.0623394
	speed: 0.0248s/iter; left time: 176.4620s
	iters: 500, epoch: 4 | loss: 0.0624126
	speed: 0.0248s/iter; left time: 174.1739s
	iters: 600, epoch: 4 | loss: 0.0610028
	speed: 0.0248s/iter; left time: 171.3605s
	iters: 700, epoch: 4 | loss: 0.0627625
	speed: 0.0249s/iter; left time: 169.6170s
	iters: 800, epoch: 4 | loss: 0.0594996
	speed: 0.0249s/iter; left time: 167.0693s
	iters: 900, epoch: 4 | loss: 0.0723570
	speed: 0.0249s/iter; left time: 164.7221s
	iters: 1000, epoch: 4 | loss: 0.0719779
	speed: 0.0249s/iter; left time: 162.1429s
Epoch: 4 cost time: 26.663898229599
Epoch: 4, Steps: 1074 | Train Loss: 0.0664987 Vali Loss: 0.7951467 Test Loss: 0.5129969
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : ETTm1_96_Transformer_ETTm1_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed3293<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.5694493651390076, mae:0.5436180830001831
