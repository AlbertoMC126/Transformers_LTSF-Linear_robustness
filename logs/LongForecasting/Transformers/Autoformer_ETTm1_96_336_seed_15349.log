Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm1', data_path='ETTm1.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Autoformer', model_id='ETTm1_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=336, root_path='./dataset/', seed=15349, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm1_336_Autoformer_ETTm1_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed15349>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34129
val 11185
test 11185
	iters: 100, epoch: 1 | loss: 0.4976568
	speed: 0.1179s/iter; left time: 1245.0235s
	iters: 200, epoch: 1 | loss: 0.4511746
	speed: 0.0829s/iter; left time: 867.2818s
	iters: 300, epoch: 1 | loss: 0.3839423
	speed: 0.0826s/iter; left time: 855.8915s
	iters: 400, epoch: 1 | loss: 0.3549973
	speed: 0.0825s/iter; left time: 846.5307s
	iters: 500, epoch: 1 | loss: 0.4137930
	speed: 0.0825s/iter; left time: 838.5537s
	iters: 600, epoch: 1 | loss: 0.3744657
	speed: 0.0826s/iter; left time: 831.0928s
	iters: 700, epoch: 1 | loss: 0.3182303
	speed: 0.0827s/iter; left time: 823.8525s
	iters: 800, epoch: 1 | loss: 0.3888724
	speed: 0.0826s/iter; left time: 814.3080s
	iters: 900, epoch: 1 | loss: 0.3742011
	speed: 0.0824s/iter; left time: 804.6603s
	iters: 1000, epoch: 1 | loss: 0.3655359
	speed: 0.0825s/iter; left time: 797.4022s
Epoch: 1 cost time: 91.61799097061157
Epoch: 1, Steps: 1066 | Train Loss: 0.4169676 Vali Loss: 0.9123165 Test Loss: 0.7535502
Validation loss decreased (inf --> 0.912317).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3463531
	speed: 0.5188s/iter; left time: 4926.2635s
	iters: 200, epoch: 2 | loss: 0.4206985
	speed: 0.0828s/iter; left time: 778.0671s
	iters: 300, epoch: 2 | loss: 0.3254077
	speed: 0.0826s/iter; left time: 767.6825s
	iters: 400, epoch: 2 | loss: 0.3494780
	speed: 0.0826s/iter; left time: 759.2661s
	iters: 500, epoch: 2 | loss: 0.3841346
	speed: 0.0825s/iter; left time: 750.0750s
	iters: 600, epoch: 2 | loss: 0.3032258
	speed: 0.0826s/iter; left time: 742.6065s
	iters: 700, epoch: 2 | loss: 0.3545697
	speed: 0.0828s/iter; left time: 736.3923s
	iters: 800, epoch: 2 | loss: 0.4011946
	speed: 0.0826s/iter; left time: 726.8955s
	iters: 900, epoch: 2 | loss: 0.3033193
	speed: 0.0827s/iter; left time: 718.6767s
	iters: 1000, epoch: 2 | loss: 0.3744690
	speed: 0.0827s/iter; left time: 710.8176s
Epoch: 2 cost time: 88.14238333702087
Epoch: 2, Steps: 1066 | Train Loss: 0.3501472 Vali Loss: 0.9512803 Test Loss: 0.7113560
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3198673
	speed: 0.5172s/iter; left time: 4359.8499s
	iters: 200, epoch: 3 | loss: 0.2782056
	speed: 0.0826s/iter; left time: 687.7743s
	iters: 300, epoch: 3 | loss: 0.3898402
	speed: 0.0826s/iter; left time: 679.3962s
	iters: 400, epoch: 3 | loss: 0.3035071
	speed: 0.0826s/iter; left time: 671.7056s
	iters: 500, epoch: 3 | loss: 0.2995114
	speed: 0.0826s/iter; left time: 663.1668s
	iters: 600, epoch: 3 | loss: 0.3214468
	speed: 0.0826s/iter; left time: 654.7123s
	iters: 700, epoch: 3 | loss: 0.3025974
	speed: 0.0826s/iter; left time: 646.5420s
	iters: 800, epoch: 3 | loss: 0.3346852
	speed: 0.0825s/iter; left time: 637.8689s
	iters: 900, epoch: 3 | loss: 0.3183905
	speed: 0.0825s/iter; left time: 629.2540s
	iters: 1000, epoch: 3 | loss: 0.2628707
	speed: 0.0825s/iter; left time: 621.0753s
Epoch: 3 cost time: 88.02858114242554
Epoch: 3, Steps: 1066 | Train Loss: 0.3152645 Vali Loss: 0.9943337 Test Loss: 0.7902854
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2853712
	speed: 0.5174s/iter; left time: 3809.8350s
	iters: 200, epoch: 4 | loss: 0.2669613
	speed: 0.0825s/iter; left time: 598.9978s
	iters: 300, epoch: 4 | loss: 0.3092562
	speed: 0.0824s/iter; left time: 590.3723s
	iters: 400, epoch: 4 | loss: 0.2858165
	speed: 0.0825s/iter; left time: 582.3445s
	iters: 500, epoch: 4 | loss: 0.2526266
	speed: 0.0825s/iter; left time: 574.5250s
	iters: 600, epoch: 4 | loss: 0.2538965
	speed: 0.0826s/iter; left time: 566.6464s
	iters: 700, epoch: 4 | loss: 0.2903942
	speed: 0.0825s/iter; left time: 558.0397s
	iters: 800, epoch: 4 | loss: 0.3108044
	speed: 0.0825s/iter; left time: 549.4862s
	iters: 900, epoch: 4 | loss: 0.2812193
	speed: 0.0825s/iter; left time: 541.3198s
	iters: 1000, epoch: 4 | loss: 0.3114121
	speed: 0.0825s/iter; left time: 533.1020s
Epoch: 4 cost time: 87.92272782325745
Epoch: 4, Steps: 1066 | Train Loss: 0.2977976 Vali Loss: 0.9877241 Test Loss: 0.7989566
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : ETTm1_336_Autoformer_ETTm1_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed15349<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
mse:0.7533814907073975, mae:0.5728219151496887
