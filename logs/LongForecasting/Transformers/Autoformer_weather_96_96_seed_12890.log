Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=21, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=21, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Autoformer', model_id='weather_96', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=96, root_path='./dataset/', seed=12890, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_96_Autoformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed12890>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36696
val 5175
test 10444
	iters: 100, epoch: 1 | loss: 0.5948361
	speed: 0.0819s/iter; left time: 930.5912s
	iters: 200, epoch: 1 | loss: 0.4591317
	speed: 0.0473s/iter; left time: 532.2695s
	iters: 300, epoch: 1 | loss: 0.4191419
	speed: 0.0473s/iter; left time: 528.0362s
	iters: 400, epoch: 1 | loss: 0.4819561
	speed: 0.0473s/iter; left time: 523.4226s
	iters: 500, epoch: 1 | loss: 0.3675059
	speed: 0.0473s/iter; left time: 518.1610s
	iters: 600, epoch: 1 | loss: 0.4756469
	speed: 0.0473s/iter; left time: 513.8470s
	iters: 700, epoch: 1 | loss: 0.4001629
	speed: 0.0473s/iter; left time: 509.0033s
	iters: 800, epoch: 1 | loss: 0.5021977
	speed: 0.0473s/iter; left time: 504.2218s
	iters: 900, epoch: 1 | loss: 0.3267306
	speed: 0.0474s/iter; left time: 500.8683s
	iters: 1000, epoch: 1 | loss: 1.3430613
	speed: 0.0473s/iter; left time: 495.2241s
	iters: 1100, epoch: 1 | loss: 0.3050121
	speed: 0.0474s/iter; left time: 490.6965s
Epoch: 1 cost time: 57.723002910614014
Epoch: 1, Steps: 1146 | Train Loss: 0.5094093 Vali Loss: 0.5246836 Test Loss: 0.2645800
Validation loss decreased (inf --> 0.524684).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2913781
	speed: 0.2151s/iter; left time: 2197.1067s
	iters: 200, epoch: 2 | loss: 0.3621663
	speed: 0.0480s/iter; left time: 485.7023s
	iters: 300, epoch: 2 | loss: 0.3580263
	speed: 0.0484s/iter; left time: 484.3022s
	iters: 400, epoch: 2 | loss: 0.6484987
	speed: 0.0478s/iter; left time: 473.8353s
	iters: 500, epoch: 2 | loss: 0.2623660
	speed: 0.0473s/iter; left time: 464.5056s
	iters: 600, epoch: 2 | loss: 0.4780162
	speed: 0.0474s/iter; left time: 460.7215s
	iters: 700, epoch: 2 | loss: 0.4076507
	speed: 0.0473s/iter; left time: 454.7913s
	iters: 800, epoch: 2 | loss: 0.3300540
	speed: 0.0473s/iter; left time: 449.6846s
	iters: 900, epoch: 2 | loss: 0.3358536
	speed: 0.0473s/iter; left time: 445.4028s
	iters: 1000, epoch: 2 | loss: 0.3823719
	speed: 0.0473s/iter; left time: 440.8814s
	iters: 1100, epoch: 2 | loss: 0.3413632
	speed: 0.0473s/iter; left time: 436.0742s
Epoch: 2 cost time: 54.523991107940674
Epoch: 2, Steps: 1146 | Train Loss: 0.4535067 Vali Loss: 0.5064175 Test Loss: 0.2505210
Validation loss decreased (0.524684 --> 0.506417).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3773986
	speed: 0.2347s/iter; left time: 2128.6276s
	iters: 200, epoch: 3 | loss: 0.4160076
	speed: 0.0477s/iter; left time: 427.6363s
	iters: 300, epoch: 3 | loss: 0.2126957
	speed: 0.0476s/iter; left time: 422.2580s
	iters: 400, epoch: 3 | loss: 1.0801522
	speed: 0.0480s/iter; left time: 420.5379s
	iters: 500, epoch: 3 | loss: 0.3212271
	speed: 0.0478s/iter; left time: 414.7091s
	iters: 600, epoch: 3 | loss: 0.5173337
	speed: 0.0478s/iter; left time: 409.9476s
	iters: 700, epoch: 3 | loss: 0.3973322
	speed: 0.0479s/iter; left time: 405.2665s
	iters: 800, epoch: 3 | loss: 0.2568020
	speed: 0.0478s/iter; left time: 400.0647s
	iters: 900, epoch: 3 | loss: 0.2186690
	speed: 0.0476s/iter; left time: 393.3018s
	iters: 1000, epoch: 3 | loss: 0.2887633
	speed: 0.0478s/iter; left time: 390.7449s
	iters: 1100, epoch: 3 | loss: 0.3394388
	speed: 0.0478s/iter; left time: 385.6094s
Epoch: 3 cost time: 56.59396576881409
Epoch: 3, Steps: 1146 | Train Loss: 0.4157349 Vali Loss: 0.5092931 Test Loss: 0.2760712
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3509458
	speed: 0.2104s/iter; left time: 1667.3476s
	iters: 200, epoch: 4 | loss: 0.3053450
	speed: 0.0475s/iter; left time: 371.8920s
	iters: 300, epoch: 4 | loss: 0.3365661
	speed: 0.0475s/iter; left time: 366.9178s
	iters: 400, epoch: 4 | loss: 0.3740539
	speed: 0.0476s/iter; left time: 362.7318s
	iters: 500, epoch: 4 | loss: 0.2236012
	speed: 0.0476s/iter; left time: 357.8691s
	iters: 600, epoch: 4 | loss: 0.4940149
	speed: 0.0475s/iter; left time: 352.6786s
	iters: 700, epoch: 4 | loss: 0.3009059
	speed: 0.0474s/iter; left time: 347.4238s
	iters: 800, epoch: 4 | loss: 0.2886879
	speed: 0.0473s/iter; left time: 341.9524s
	iters: 900, epoch: 4 | loss: 0.2552273
	speed: 0.0472s/iter; left time: 336.3785s
	iters: 1000, epoch: 4 | loss: 0.2858949
	speed: 0.0474s/iter; left time: 332.9550s
	iters: 1100, epoch: 4 | loss: 0.3299074
	speed: 0.0474s/iter; left time: 327.8889s
Epoch: 4 cost time: 54.37316393852234
Epoch: 4, Steps: 1146 | Train Loss: 0.3904619 Vali Loss: 0.5151350 Test Loss: 0.2722286
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3780476
	speed: 0.2105s/iter; left time: 1426.8808s
	iters: 200, epoch: 5 | loss: 0.2144264
	speed: 0.0477s/iter; left time: 318.6145s
	iters: 300, epoch: 5 | loss: 0.2640693
	speed: 0.0478s/iter; left time: 314.0577s
	iters: 400, epoch: 5 | loss: 0.2707136
	speed: 0.0476s/iter; left time: 308.0967s
	iters: 500, epoch: 5 | loss: 0.2563092
	speed: 0.0477s/iter; left time: 303.9033s
	iters: 600, epoch: 5 | loss: 0.2486009
	speed: 0.0478s/iter; left time: 299.7920s
	iters: 700, epoch: 5 | loss: 0.2736680
	speed: 0.0477s/iter; left time: 294.3987s
	iters: 800, epoch: 5 | loss: 0.4065934
	speed: 0.0475s/iter; left time: 288.9036s
	iters: 900, epoch: 5 | loss: 0.2338219
	speed: 0.0473s/iter; left time: 282.8984s
	iters: 1000, epoch: 5 | loss: 0.2406915
	speed: 0.0476s/iter; left time: 279.9863s
	iters: 1100, epoch: 5 | loss: 0.5119790
	speed: 0.0474s/iter; left time: 273.8561s
Epoch: 5 cost time: 54.56202697753906
Epoch: 5, Steps: 1146 | Train Loss: 0.3771629 Vali Loss: 0.5172499 Test Loss: 0.2694719
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : weather_96_Autoformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed12890<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
mse:0.25080984830856323, mae:0.3212963342666626
