Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=21, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=21, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Informer', model_id='weather_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=336, root_path='./dataset/', seed=12890, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_336_Informer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed12890>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36456
val 4935
test 10204
	iters: 100, epoch: 1 | loss: 0.9608471
	speed: 0.0727s/iter; left time: 820.6181s
	iters: 200, epoch: 1 | loss: 0.4562879
	speed: 0.0420s/iter; left time: 469.5740s
	iters: 300, epoch: 1 | loss: 0.6552303
	speed: 0.0420s/iter; left time: 466.1807s
	iters: 400, epoch: 1 | loss: 0.3939509
	speed: 0.0420s/iter; left time: 461.5058s
	iters: 500, epoch: 1 | loss: 0.6375972
	speed: 0.0420s/iter; left time: 457.9423s
	iters: 600, epoch: 1 | loss: 0.9295195
	speed: 0.0421s/iter; left time: 454.5025s
	iters: 700, epoch: 1 | loss: 0.3484448
	speed: 0.0428s/iter; left time: 457.1889s
	iters: 800, epoch: 1 | loss: 0.3237563
	speed: 0.0438s/iter; left time: 464.1486s
	iters: 900, epoch: 1 | loss: 0.3536331
	speed: 0.0438s/iter; left time: 459.5030s
	iters: 1000, epoch: 1 | loss: 0.4114947
	speed: 0.0438s/iter; left time: 454.8582s
	iters: 1100, epoch: 1 | loss: 0.2983517
	speed: 0.0440s/iter; left time: 452.3087s
Epoch: 1 cost time: 51.82342863082886
Epoch: 1, Steps: 1139 | Train Loss: 0.4770251 Vali Loss: 0.7546843 Test Loss: 0.9331810
Validation loss decreased (inf --> 0.754684).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2536473
	speed: 0.1408s/iter; left time: 1429.3184s
	iters: 200, epoch: 2 | loss: 0.5620201
	speed: 0.0424s/iter; left time: 426.0929s
	iters: 300, epoch: 2 | loss: 0.3653647
	speed: 0.0424s/iter; left time: 421.8986s
	iters: 400, epoch: 2 | loss: 0.3514660
	speed: 0.0425s/iter; left time: 418.7031s
	iters: 500, epoch: 2 | loss: 0.3657998
	speed: 0.0425s/iter; left time: 414.5543s
	iters: 600, epoch: 2 | loss: 0.2988544
	speed: 0.0426s/iter; left time: 411.0763s
	iters: 700, epoch: 2 | loss: 0.5873829
	speed: 0.0425s/iter; left time: 405.6600s
	iters: 800, epoch: 2 | loss: 0.7283422
	speed: 0.0424s/iter; left time: 400.6553s
	iters: 900, epoch: 2 | loss: 0.4873491
	speed: 0.0424s/iter; left time: 396.9758s
	iters: 1000, epoch: 2 | loss: 0.7083065
	speed: 0.0422s/iter; left time: 390.8490s
	iters: 1100, epoch: 2 | loss: 0.2960254
	speed: 0.0423s/iter; left time: 387.0653s
Epoch: 2 cost time: 48.37779092788696
Epoch: 2, Steps: 1139 | Train Loss: 0.3656513 Vali Loss: 0.6504263 Test Loss: 0.5613629
Validation loss decreased (0.754684 --> 0.650426).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2192831
	speed: 0.1384s/iter; left time: 1247.6635s
	iters: 200, epoch: 3 | loss: 0.2327046
	speed: 0.0424s/iter; left time: 378.2366s
	iters: 300, epoch: 3 | loss: 0.2552438
	speed: 0.0425s/iter; left time: 374.4161s
	iters: 400, epoch: 3 | loss: 0.2954412
	speed: 0.0425s/iter; left time: 370.5473s
	iters: 500, epoch: 3 | loss: 0.2230422
	speed: 0.0425s/iter; left time: 365.7010s
	iters: 600, epoch: 3 | loss: 0.2794122
	speed: 0.0425s/iter; left time: 361.4155s
	iters: 700, epoch: 3 | loss: 0.2153264
	speed: 0.0424s/iter; left time: 357.0391s
	iters: 800, epoch: 3 | loss: 0.1855903
	speed: 0.0426s/iter; left time: 353.9744s
	iters: 900, epoch: 3 | loss: 0.2374874
	speed: 0.0432s/iter; left time: 354.5594s
	iters: 1000, epoch: 3 | loss: 0.2955486
	speed: 0.0432s/iter; left time: 350.7208s
	iters: 1100, epoch: 3 | loss: 0.4340656
	speed: 0.0437s/iter; left time: 349.7819s
Epoch: 3 cost time: 48.700461626052856
Epoch: 3, Steps: 1139 | Train Loss: 0.2926345 Vali Loss: 0.6903538 Test Loss: 0.5988302
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1801722
	speed: 0.1385s/iter; left time: 1090.7451s
	iters: 200, epoch: 4 | loss: 0.4453231
	speed: 0.0434s/iter; left time: 337.5081s
	iters: 300, epoch: 4 | loss: 0.2531027
	speed: 0.0426s/iter; left time: 326.5495s
	iters: 400, epoch: 4 | loss: 0.1502730
	speed: 0.0427s/iter; left time: 323.2396s
	iters: 500, epoch: 4 | loss: 0.3444298
	speed: 0.0425s/iter; left time: 317.5507s
	iters: 600, epoch: 4 | loss: 0.3954963
	speed: 0.0422s/iter; left time: 311.1807s
	iters: 700, epoch: 4 | loss: 0.1868939
	speed: 0.0423s/iter; left time: 307.4070s
	iters: 800, epoch: 4 | loss: 0.1611650
	speed: 0.0424s/iter; left time: 304.4373s
	iters: 900, epoch: 4 | loss: 0.1919064
	speed: 0.0424s/iter; left time: 300.2088s
	iters: 1000, epoch: 4 | loss: 0.2326695
	speed: 0.0426s/iter; left time: 297.0307s
	iters: 1100, epoch: 4 | loss: 0.1818556
	speed: 0.0424s/iter; left time: 291.5168s
Epoch: 4 cost time: 48.55679392814636
Epoch: 4, Steps: 1139 | Train Loss: 0.2623943 Vali Loss: 0.6742223 Test Loss: 0.6403404
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2089102
	speed: 0.1361s/iter; left time: 916.8134s
	iters: 200, epoch: 5 | loss: 0.1466241
	speed: 0.0423s/iter; left time: 280.8383s
	iters: 300, epoch: 5 | loss: 0.3488655
	speed: 0.0425s/iter; left time: 278.0152s
	iters: 400, epoch: 5 | loss: 0.2538258
	speed: 0.0422s/iter; left time: 271.3329s
	iters: 500, epoch: 5 | loss: 0.1774278
	speed: 0.0421s/iter; left time: 266.9972s
	iters: 600, epoch: 5 | loss: 0.1941007
	speed: 0.0422s/iter; left time: 263.1187s
	iters: 700, epoch: 5 | loss: 0.1724059
	speed: 0.0422s/iter; left time: 258.5959s
	iters: 800, epoch: 5 | loss: 0.4045829
	speed: 0.0423s/iter; left time: 255.0092s
	iters: 900, epoch: 5 | loss: 0.2877334
	speed: 0.0422s/iter; left time: 250.6043s
	iters: 1000, epoch: 5 | loss: 0.3721413
	speed: 0.0422s/iter; left time: 246.1153s
	iters: 1100, epoch: 5 | loss: 0.1993424
	speed: 0.0436s/iter; left time: 250.1372s
Epoch: 5 cost time: 48.32385754585266
Epoch: 5, Steps: 1139 | Train Loss: 0.2490373 Vali Loss: 0.6667089 Test Loss: 0.6131895
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : weather_336_Informer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed12890<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10204
mse:0.5613828897476196, mae:0.517927885055542
