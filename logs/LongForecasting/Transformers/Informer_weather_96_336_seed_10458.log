Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=21, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=21, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Informer', model_id='weather_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=336, root_path='./dataset/', seed=10458, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_336_Informer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed10458>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36456
val 4935
test 10204
	iters: 100, epoch: 1 | loss: 0.4860760
	speed: 0.0728s/iter; left time: 821.9714s
	iters: 200, epoch: 1 | loss: 0.4870879
	speed: 0.0424s/iter; left time: 474.0047s
	iters: 300, epoch: 1 | loss: 0.3634210
	speed: 0.0429s/iter; left time: 476.0893s
	iters: 400, epoch: 1 | loss: 0.4384679
	speed: 0.0433s/iter; left time: 475.7090s
	iters: 500, epoch: 1 | loss: 0.3586686
	speed: 0.0435s/iter; left time: 473.7015s
	iters: 600, epoch: 1 | loss: 0.3212553
	speed: 0.0433s/iter; left time: 467.6957s
	iters: 700, epoch: 1 | loss: 0.3631589
	speed: 0.0435s/iter; left time: 465.5185s
	iters: 800, epoch: 1 | loss: 0.8930817
	speed: 0.0435s/iter; left time: 461.0618s
	iters: 900, epoch: 1 | loss: 0.3591570
	speed: 0.0432s/iter; left time: 453.3989s
	iters: 1000, epoch: 1 | loss: 0.3154319
	speed: 0.0428s/iter; left time: 444.9156s
	iters: 1100, epoch: 1 | loss: 0.3237519
	speed: 0.0423s/iter; left time: 435.1025s
Epoch: 1 cost time: 52.035388708114624
Epoch: 1, Steps: 1139 | Train Loss: 0.4758169 Vali Loss: 0.6635901 Test Loss: 0.7138514
Validation loss decreased (inf --> 0.663590).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6301178
	speed: 0.1387s/iter; left time: 1408.0097s
	iters: 200, epoch: 2 | loss: 0.2679811
	speed: 0.0426s/iter; left time: 428.2990s
	iters: 300, epoch: 2 | loss: 0.2973775
	speed: 0.0425s/iter; left time: 423.3008s
	iters: 400, epoch: 2 | loss: 0.2571937
	speed: 0.0424s/iter; left time: 418.1108s
	iters: 500, epoch: 2 | loss: 0.5750156
	speed: 0.0422s/iter; left time: 411.5600s
	iters: 600, epoch: 2 | loss: 0.2866227
	speed: 0.0423s/iter; left time: 407.8804s
	iters: 700, epoch: 2 | loss: 0.5938971
	speed: 0.0425s/iter; left time: 406.1076s
	iters: 800, epoch: 2 | loss: 0.3081797
	speed: 0.0426s/iter; left time: 402.7953s
	iters: 900, epoch: 2 | loss: 0.7322296
	speed: 0.0425s/iter; left time: 397.2355s
	iters: 1000, epoch: 2 | loss: 0.2539025
	speed: 0.0423s/iter; left time: 391.6280s
	iters: 1100, epoch: 2 | loss: 0.2416511
	speed: 0.0422s/iter; left time: 386.2167s
Epoch: 2 cost time: 48.30232763290405
Epoch: 2, Steps: 1139 | Train Loss: 0.3659385 Vali Loss: 0.6541899 Test Loss: 0.5670460
Validation loss decreased (0.663590 --> 0.654190).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2648949
	speed: 0.1380s/iter; left time: 1244.1312s
	iters: 200, epoch: 3 | loss: 0.4021276
	speed: 0.0421s/iter; left time: 375.5914s
	iters: 300, epoch: 3 | loss: 0.2383789
	speed: 0.0422s/iter; left time: 371.6192s
	iters: 400, epoch: 3 | loss: 0.4443123
	speed: 0.0422s/iter; left time: 367.5126s
	iters: 500, epoch: 3 | loss: 0.2053679
	speed: 0.0435s/iter; left time: 374.7733s
	iters: 600, epoch: 3 | loss: 0.1922094
	speed: 0.0434s/iter; left time: 369.0890s
	iters: 700, epoch: 3 | loss: 0.2797373
	speed: 0.0436s/iter; left time: 366.8415s
	iters: 800, epoch: 3 | loss: 0.1839757
	speed: 0.0439s/iter; left time: 364.6272s
	iters: 900, epoch: 3 | loss: 0.3830435
	speed: 0.0430s/iter; left time: 353.2482s
	iters: 1000, epoch: 3 | loss: 0.2167679
	speed: 0.0431s/iter; left time: 349.4004s
	iters: 1100, epoch: 3 | loss: 0.2298501
	speed: 0.0432s/iter; left time: 346.4395s
Epoch: 3 cost time: 48.88187623023987
Epoch: 3, Steps: 1139 | Train Loss: 0.2925155 Vali Loss: 0.6388639 Test Loss: 0.5636504
Validation loss decreased (0.654190 --> 0.638864).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2623281
	speed: 0.1381s/iter; left time: 1087.1551s
	iters: 200, epoch: 4 | loss: 0.4247446
	speed: 0.0421s/iter; left time: 327.6390s
	iters: 300, epoch: 4 | loss: 0.2337038
	speed: 0.0424s/iter; left time: 325.1875s
	iters: 400, epoch: 4 | loss: 0.4101386
	speed: 0.0425s/iter; left time: 322.1336s
	iters: 500, epoch: 4 | loss: 0.1766506
	speed: 0.0423s/iter; left time: 315.8103s
	iters: 600, epoch: 4 | loss: 0.1689412
	speed: 0.0421s/iter; left time: 310.5061s
	iters: 700, epoch: 4 | loss: 0.3932474
	speed: 0.0422s/iter; left time: 306.8932s
	iters: 800, epoch: 4 | loss: 0.3847294
	speed: 0.0422s/iter; left time: 302.7954s
	iters: 900, epoch: 4 | loss: 0.3756143
	speed: 0.0423s/iter; left time: 299.4341s
	iters: 1000, epoch: 4 | loss: 0.3590584
	speed: 0.0422s/iter; left time: 294.2746s
	iters: 1100, epoch: 4 | loss: 0.2289170
	speed: 0.0421s/iter; left time: 289.6017s
Epoch: 4 cost time: 48.11335301399231
Epoch: 4, Steps: 1139 | Train Loss: 0.2627483 Vali Loss: 0.6492064 Test Loss: 0.5939978
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2041747
	speed: 0.1357s/iter; left time: 914.0000s
	iters: 200, epoch: 5 | loss: 0.2170731
	speed: 0.0421s/iter; left time: 279.1314s
	iters: 300, epoch: 5 | loss: 0.2691539
	speed: 0.0422s/iter; left time: 275.5118s
	iters: 400, epoch: 5 | loss: 0.3847512
	speed: 0.0421s/iter; left time: 270.9835s
	iters: 500, epoch: 5 | loss: 0.2053179
	speed: 0.0422s/iter; left time: 267.4879s
	iters: 600, epoch: 5 | loss: 0.1985620
	speed: 0.0422s/iter; left time: 263.2872s
	iters: 700, epoch: 5 | loss: 0.2063550
	speed: 0.0439s/iter; left time: 269.1309s
	iters: 800, epoch: 5 | loss: 0.1637692
	speed: 0.0440s/iter; left time: 265.3993s
	iters: 900, epoch: 5 | loss: 0.2292547
	speed: 0.0438s/iter; left time: 259.8900s
	iters: 1000, epoch: 5 | loss: 0.1773114
	speed: 0.0438s/iter; left time: 255.4411s
	iters: 1100, epoch: 5 | loss: 0.1695920
	speed: 0.0440s/iter; left time: 252.2216s
Epoch: 5 cost time: 48.922359228134155
Epoch: 5, Steps: 1139 | Train Loss: 0.2495759 Vali Loss: 0.6572713 Test Loss: 0.5999588
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1606812
	speed: 0.1377s/iter; left time: 770.4716s
	iters: 200, epoch: 6 | loss: 0.1992820
	speed: 0.0425s/iter; left time: 233.7879s
	iters: 300, epoch: 6 | loss: 0.3280035
	speed: 0.0426s/iter; left time: 229.7722s
	iters: 400, epoch: 6 | loss: 0.1861397
	speed: 0.0423s/iter; left time: 224.2255s
	iters: 500, epoch: 6 | loss: 0.2417417
	speed: 0.0422s/iter; left time: 219.3800s
	iters: 600, epoch: 6 | loss: 0.2045121
	speed: 0.0424s/iter; left time: 215.8602s
	iters: 700, epoch: 6 | loss: 0.3378969
	speed: 0.0423s/iter; left time: 211.5605s
	iters: 800, epoch: 6 | loss: 0.1503915
	speed: 0.0423s/iter; left time: 207.0680s
	iters: 900, epoch: 6 | loss: 0.1612264
	speed: 0.0426s/iter; left time: 204.1575s
	iters: 1000, epoch: 6 | loss: 0.1665212
	speed: 0.0424s/iter; left time: 199.2734s
	iters: 1100, epoch: 6 | loss: 0.1968258
	speed: 0.0424s/iter; left time: 194.8325s
Epoch: 6 cost time: 48.318142890930176
Epoch: 6, Steps: 1139 | Train Loss: 0.2428545 Vali Loss: 0.6503500 Test Loss: 0.5877186
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : weather_336_Informer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed10458<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10204
mse:0.5638670921325684, mae:0.5294106602668762
