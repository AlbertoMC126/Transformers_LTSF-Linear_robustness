Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=21, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=21, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Autoformer', model_id='weather_192', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=192, root_path='./dataset/', seed=15726, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_192_Autoformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed15726>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36600
val 5079
test 10348
	iters: 100, epoch: 1 | loss: 0.6000438
	speed: 0.0981s/iter; left time: 1111.0379s
	iters: 200, epoch: 1 | loss: 0.4398407
	speed: 0.0624s/iter; left time: 701.1752s
	iters: 300, epoch: 1 | loss: 0.4572483
	speed: 0.0618s/iter; left time: 687.9949s
	iters: 400, epoch: 1 | loss: 0.4295458
	speed: 0.0618s/iter; left time: 681.7299s
	iters: 500, epoch: 1 | loss: 0.5686535
	speed: 0.0618s/iter; left time: 675.5379s
	iters: 600, epoch: 1 | loss: 0.4262723
	speed: 0.0619s/iter; left time: 670.2491s
	iters: 700, epoch: 1 | loss: 0.5287172
	speed: 0.0619s/iter; left time: 664.0525s
	iters: 800, epoch: 1 | loss: 1.4312785
	speed: 0.0619s/iter; left time: 658.2823s
	iters: 900, epoch: 1 | loss: 0.3884878
	speed: 0.0619s/iter; left time: 651.9248s
	iters: 1000, epoch: 1 | loss: 0.4468749
	speed: 0.0619s/iter; left time: 646.0325s
	iters: 1100, epoch: 1 | loss: 0.5282455
	speed: 0.0618s/iter; left time: 638.5491s
Epoch: 1 cost time: 74.41587328910828
Epoch: 1, Steps: 1143 | Train Loss: 0.6216386 Vali Loss: 0.6199037 Test Loss: 0.2994849
Validation loss decreased (inf --> 0.619904).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4052184
	speed: 0.2817s/iter; left time: 2869.5233s
	iters: 200, epoch: 2 | loss: 0.9057062
	speed: 0.0620s/iter; left time: 625.7589s
	iters: 300, epoch: 2 | loss: 0.6177723
	speed: 0.0629s/iter; left time: 627.7954s
	iters: 400, epoch: 2 | loss: 0.5704246
	speed: 0.0629s/iter; left time: 621.4932s
	iters: 500, epoch: 2 | loss: 0.4040446
	speed: 0.0626s/iter; left time: 613.1855s
	iters: 600, epoch: 2 | loss: 0.5850385
	speed: 0.0627s/iter; left time: 607.4287s
	iters: 700, epoch: 2 | loss: 0.4490920
	speed: 0.0621s/iter; left time: 595.6604s
	iters: 800, epoch: 2 | loss: 0.6293019
	speed: 0.0618s/iter; left time: 586.7213s
	iters: 900, epoch: 2 | loss: 0.3451325
	speed: 0.0617s/iter; left time: 579.5618s
	iters: 1000, epoch: 2 | loss: 0.9837881
	speed: 0.0618s/iter; left time: 574.3181s
	iters: 1100, epoch: 2 | loss: 0.5187034
	speed: 0.0619s/iter; left time: 568.6780s
Epoch: 2 cost time: 71.08575201034546
Epoch: 2, Steps: 1143 | Train Loss: 0.5676417 Vali Loss: 0.6178911 Test Loss: 0.3150656
Validation loss decreased (0.619904 --> 0.617891).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5797451
	speed: 0.2815s/iter; left time: 2545.9748s
	iters: 200, epoch: 3 | loss: 0.4978656
	speed: 0.0621s/iter; left time: 555.4261s
	iters: 300, epoch: 3 | loss: 0.3979203
	speed: 0.0621s/iter; left time: 548.9911s
	iters: 400, epoch: 3 | loss: 0.8632131
	speed: 0.0620s/iter; left time: 541.9290s
	iters: 500, epoch: 3 | loss: 0.4286805
	speed: 0.0620s/iter; left time: 535.6659s
	iters: 600, epoch: 3 | loss: 0.4505109
	speed: 0.0620s/iter; left time: 530.0824s
	iters: 700, epoch: 3 | loss: 0.4640872
	speed: 0.0622s/iter; left time: 525.6974s
	iters: 800, epoch: 3 | loss: 0.4079888
	speed: 0.0626s/iter; left time: 522.2864s
	iters: 900, epoch: 3 | loss: 0.4362048
	speed: 0.0625s/iter; left time: 515.0506s
	iters: 1000, epoch: 3 | loss: 0.4652691
	speed: 0.0626s/iter; left time: 509.9965s
	iters: 1100, epoch: 3 | loss: 0.8736948
	speed: 0.0624s/iter; left time: 501.8298s
Epoch: 3 cost time: 71.10571575164795
Epoch: 3, Steps: 1143 | Train Loss: 0.5423448 Vali Loss: 0.6104565 Test Loss: 0.3096705
Validation loss decreased (0.617891 --> 0.610457).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3850911
	speed: 0.2828s/iter; left time: 2234.6687s
	iters: 200, epoch: 4 | loss: 0.4153572
	speed: 0.0619s/iter; left time: 483.2178s
	iters: 300, epoch: 4 | loss: 0.4830821
	speed: 0.0619s/iter; left time: 476.6308s
	iters: 400, epoch: 4 | loss: 0.6100727
	speed: 0.0618s/iter; left time: 469.7616s
	iters: 500, epoch: 4 | loss: 0.8988894
	speed: 0.0619s/iter; left time: 464.4502s
	iters: 600, epoch: 4 | loss: 0.4028921
	speed: 0.0618s/iter; left time: 457.5502s
	iters: 700, epoch: 4 | loss: 0.3329663
	speed: 0.0618s/iter; left time: 451.4193s
	iters: 800, epoch: 4 | loss: 0.5204884
	speed: 0.0618s/iter; left time: 444.7813s
	iters: 900, epoch: 4 | loss: 0.4840555
	speed: 0.0618s/iter; left time: 438.8464s
	iters: 1000, epoch: 4 | loss: 0.8634847
	speed: 0.0619s/iter; left time: 433.0863s
	iters: 1100, epoch: 4 | loss: 0.4604162
	speed: 0.0619s/iter; left time: 427.1992s
Epoch: 4 cost time: 70.70227026939392
Epoch: 4, Steps: 1143 | Train Loss: 0.5250644 Vali Loss: 0.6143231 Test Loss: 0.3085492
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3615179
	speed: 0.2854s/iter; left time: 1928.7692s
	iters: 200, epoch: 5 | loss: 0.3733599
	speed: 0.0625s/iter; left time: 416.0112s
	iters: 300, epoch: 5 | loss: 0.3811230
	speed: 0.0617s/iter; left time: 404.8547s
	iters: 400, epoch: 5 | loss: 0.4520432
	speed: 0.0617s/iter; left time: 398.5921s
	iters: 500, epoch: 5 | loss: 0.3979461
	speed: 0.0617s/iter; left time: 392.6591s
	iters: 600, epoch: 5 | loss: 0.3801549
	speed: 0.0617s/iter; left time: 386.3545s
	iters: 700, epoch: 5 | loss: 0.4643980
	speed: 0.0617s/iter; left time: 380.2596s
	iters: 800, epoch: 5 | loss: 0.3999278
	speed: 0.0618s/iter; left time: 374.4862s
	iters: 900, epoch: 5 | loss: 0.5249174
	speed: 0.0618s/iter; left time: 368.3632s
	iters: 1000, epoch: 5 | loss: 0.3850978
	speed: 0.0617s/iter; left time: 361.5366s
	iters: 1100, epoch: 5 | loss: 0.3916227
	speed: 0.0617s/iter; left time: 355.3339s
Epoch: 5 cost time: 70.69865894317627
Epoch: 5, Steps: 1143 | Train Loss: 0.5198447 Vali Loss: 0.6131176 Test Loss: 0.3109189
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3683159
	speed: 0.2795s/iter; left time: 1569.7015s
	iters: 200, epoch: 6 | loss: 0.4236650
	speed: 0.0622s/iter; left time: 343.2472s
	iters: 300, epoch: 6 | loss: 0.4024138
	speed: 0.0628s/iter; left time: 339.9184s
	iters: 400, epoch: 6 | loss: 0.3368385
	speed: 0.0625s/iter; left time: 332.3149s
	iters: 500, epoch: 6 | loss: 0.3302270
	speed: 0.0625s/iter; left time: 325.9974s
	iters: 600, epoch: 6 | loss: 0.9257376
	speed: 0.0627s/iter; left time: 320.5960s
	iters: 700, epoch: 6 | loss: 0.4210475
	speed: 0.0622s/iter; left time: 311.8666s
	iters: 800, epoch: 6 | loss: 0.7479121
	speed: 0.0618s/iter; left time: 303.8547s
	iters: 900, epoch: 6 | loss: 0.3198521
	speed: 0.0619s/iter; left time: 297.9625s
	iters: 1000, epoch: 6 | loss: 0.4191294
	speed: 0.0619s/iter; left time: 291.7398s
	iters: 1100, epoch: 6 | loss: 0.4117213
	speed: 0.0619s/iter; left time: 285.9475s
Epoch: 6 cost time: 71.05860900878906
Epoch: 6, Steps: 1143 | Train Loss: 0.5116646 Vali Loss: 0.6140670 Test Loss: 0.3098842
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : weather_192_Autoformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed15726<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10348
mse:0.31006520986557007, mae:0.3665279746055603
