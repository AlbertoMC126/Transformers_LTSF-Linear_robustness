Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=21, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=21, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=3, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='Informer', model_id='weather_336', moving_avg=25, n_heads=8, num_workers=0, output_attention=False, patience=3, pred_len=336, root_path='./dataset/', seed=15227, seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_336_Informer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed15227>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36456
val 4935
test 10204
	iters: 100, epoch: 1 | loss: 0.4075081
	speed: 0.0726s/iter; left time: 819.4756s
	iters: 200, epoch: 1 | loss: 0.7054893
	speed: 0.0423s/iter; left time: 473.3017s
	iters: 300, epoch: 1 | loss: 0.4641601
	speed: 0.0424s/iter; left time: 469.7088s
	iters: 400, epoch: 1 | loss: 0.6796560
	speed: 0.0422s/iter; left time: 464.0120s
	iters: 500, epoch: 1 | loss: 0.3844419
	speed: 0.0427s/iter; left time: 465.1176s
	iters: 600, epoch: 1 | loss: 0.3513759
	speed: 0.0435s/iter; left time: 469.5309s
	iters: 700, epoch: 1 | loss: 0.3858951
	speed: 0.0433s/iter; left time: 462.7152s
	iters: 800, epoch: 1 | loss: 0.3934704
	speed: 0.0434s/iter; left time: 459.8226s
	iters: 900, epoch: 1 | loss: 0.3319097
	speed: 0.0433s/iter; left time: 454.6988s
	iters: 1000, epoch: 1 | loss: 0.3769662
	speed: 0.0431s/iter; left time: 448.3335s
	iters: 1100, epoch: 1 | loss: 0.3482828
	speed: 0.0431s/iter; left time: 443.2963s
Epoch: 1 cost time: 51.9003427028656
Epoch: 1, Steps: 1139 | Train Loss: 0.4749648 Vali Loss: 0.7017707 Test Loss: 0.7856197
Validation loss decreased (inf --> 0.701771).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3065503
	speed: 0.1398s/iter; left time: 1418.8438s
	iters: 200, epoch: 2 | loss: 0.3602091
	speed: 0.0426s/iter; left time: 428.3329s
	iters: 300, epoch: 2 | loss: 0.5296044
	speed: 0.0425s/iter; left time: 422.7032s
	iters: 400, epoch: 2 | loss: 0.2773130
	speed: 0.0425s/iter; left time: 418.6212s
	iters: 500, epoch: 2 | loss: 0.2498781
	speed: 0.0423s/iter; left time: 412.7713s
	iters: 600, epoch: 2 | loss: 0.7532275
	speed: 0.0423s/iter; left time: 408.3558s
	iters: 700, epoch: 2 | loss: 0.5759049
	speed: 0.0426s/iter; left time: 406.8978s
	iters: 800, epoch: 2 | loss: 0.5461808
	speed: 0.0425s/iter; left time: 401.6649s
	iters: 900, epoch: 2 | loss: 0.2333525
	speed: 0.0425s/iter; left time: 397.8511s
	iters: 1000, epoch: 2 | loss: 0.2812081
	speed: 0.0423s/iter; left time: 391.3182s
	iters: 1100, epoch: 2 | loss: 0.2613981
	speed: 0.0422s/iter; left time: 386.6530s
Epoch: 2 cost time: 48.32738018035889
Epoch: 2, Steps: 1139 | Train Loss: 0.3650005 Vali Loss: 0.6442629 Test Loss: 0.5656089
Validation loss decreased (0.701771 --> 0.644263).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2266940
	speed: 0.1386s/iter; left time: 1248.7515s
	iters: 200, epoch: 3 | loss: 0.2865717
	speed: 0.0422s/iter; left time: 375.9273s
	iters: 300, epoch: 3 | loss: 0.1790000
	speed: 0.0422s/iter; left time: 371.5010s
	iters: 400, epoch: 3 | loss: 0.3783388
	speed: 0.0421s/iter; left time: 367.0784s
	iters: 500, epoch: 3 | loss: 0.2397920
	speed: 0.0421s/iter; left time: 363.0210s
	iters: 600, epoch: 3 | loss: 0.3989580
	speed: 0.0422s/iter; left time: 358.9088s
	iters: 700, epoch: 3 | loss: 0.2025838
	speed: 0.0432s/iter; left time: 363.0789s
	iters: 800, epoch: 3 | loss: 0.2970922
	speed: 0.0436s/iter; left time: 362.1736s
	iters: 900, epoch: 3 | loss: 0.1859672
	speed: 0.0434s/iter; left time: 356.6510s
	iters: 1000, epoch: 3 | loss: 0.2161277
	speed: 0.0434s/iter; left time: 352.0941s
	iters: 1100, epoch: 3 | loss: 0.1998202
	speed: 0.0433s/iter; left time: 347.2490s
Epoch: 3 cost time: 48.65866303443909
Epoch: 3, Steps: 1139 | Train Loss: 0.2934765 Vali Loss: 0.6614687 Test Loss: 0.6022307
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4033824
	speed: 0.1368s/iter; left time: 1077.4549s
	iters: 200, epoch: 4 | loss: 0.1983685
	speed: 0.0421s/iter; left time: 327.5061s
	iters: 300, epoch: 4 | loss: 0.2284310
	speed: 0.0427s/iter; left time: 327.3317s
	iters: 400, epoch: 4 | loss: 0.4688683
	speed: 0.0425s/iter; left time: 321.8883s
	iters: 500, epoch: 4 | loss: 0.2046288
	speed: 0.0424s/iter; left time: 317.2412s
	iters: 600, epoch: 4 | loss: 0.3739110
	speed: 0.0422s/iter; left time: 310.8360s
	iters: 700, epoch: 4 | loss: 0.1804669
	speed: 0.0422s/iter; left time: 307.2684s
	iters: 800, epoch: 4 | loss: 0.2113336
	speed: 0.0421s/iter; left time: 302.0421s
	iters: 900, epoch: 4 | loss: 0.2437943
	speed: 0.0423s/iter; left time: 299.0778s
	iters: 1000, epoch: 4 | loss: 0.2019741
	speed: 0.0422s/iter; left time: 294.5758s
	iters: 1100, epoch: 4 | loss: 0.1809812
	speed: 0.0422s/iter; left time: 290.0779s
Epoch: 4 cost time: 48.15703797340393
Epoch: 4, Steps: 1139 | Train Loss: 0.2634631 Vali Loss: 0.6563529 Test Loss: 0.6206425
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2636358
	speed: 0.1357s/iter; left time: 913.7889s
	iters: 200, epoch: 5 | loss: 0.2327002
	speed: 0.0421s/iter; left time: 279.3434s
	iters: 300, epoch: 5 | loss: 0.2081528
	speed: 0.0421s/iter; left time: 275.1287s
	iters: 400, epoch: 5 | loss: 0.2138081
	speed: 0.0421s/iter; left time: 270.8589s
	iters: 500, epoch: 5 | loss: 0.1706565
	speed: 0.0421s/iter; left time: 266.6303s
	iters: 600, epoch: 5 | loss: 0.3979737
	speed: 0.0420s/iter; left time: 262.1073s
	iters: 700, epoch: 5 | loss: 0.2024394
	speed: 0.0420s/iter; left time: 257.9280s
	iters: 800, epoch: 5 | loss: 0.1525532
	speed: 0.0422s/iter; left time: 254.9086s
	iters: 900, epoch: 5 | loss: 0.3326830
	speed: 0.0440s/iter; left time: 261.2198s
	iters: 1000, epoch: 5 | loss: 0.2260416
	speed: 0.0440s/iter; left time: 257.0222s
	iters: 1100, epoch: 5 | loss: 0.1862593
	speed: 0.0440s/iter; left time: 252.3508s
Epoch: 5 cost time: 48.602556467056274
Epoch: 5, Steps: 1139 | Train Loss: 0.2505960 Vali Loss: 0.6618300 Test Loss: 0.6227641
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : weather_336_Informer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0_seed15227<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10204
mse:0.5658396482467651, mae:0.522135317325592
